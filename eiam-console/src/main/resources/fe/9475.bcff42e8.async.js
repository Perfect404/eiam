/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2023 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[9475],{95742:function(dn){"use strict";(function(Pt,nt){dn.exports=nt()})(this,function(){function Pt(pt){var et=[];return pt.AMapUI&&et.push(nt(pt.AMapUI)),pt.Loca&&et.push(kt(pt.Loca)),Promise.all(et)}function nt(pt){return new Promise(function(et,be){var ot=[];if(pt.plugins)for(var ut=0;ut<pt.plugins.length;ut+=1)k.AMapUI.plugins.indexOf(pt.plugins[ut])==-1&&ot.push(pt.plugins[ut]);if(Et.AMapUI===mt.failed)be("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Et.AMapUI===mt.notload){Et.AMapUI=mt.loading,k.AMapUI.version=pt.version||k.AMapUI.version,ut=k.AMapUI.version;var zt=document.body||document.head,P=document.createElement("script");P.type="text/javascript",P.src="https://webapi.amap.com/ui/"+ut+"/main.js",P.onerror=function(b){Et.AMapUI=mt.failed,be("\u8BF7\u6C42 AMapUI \u5931\u8D25")},P.onload=function(){if(Et.AMapUI=mt.loaded,ot.length)window.AMapUI.loadUI(ot,function(){for(var b=0,W=ot.length;b<W;b++){var le=ot[b].split("/").slice(-1)[0];window.AMapUI[le]=arguments[b]}for(et();K.AMapUI.length;)K.AMapUI.splice(0,1)[0]()});else for(et();K.AMapUI.length;)K.AMapUI.splice(0,1)[0]()},zt.appendChild(P)}else Et.AMapUI===mt.loaded?pt.version&&pt.version!==k.AMapUI.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):ot.length?window.AMapUI.loadUI(ot,function(){for(var b=0,W=ot.length;b<W;b++){var le=ot[b].split("/").slice(-1)[0];window.AMapUI[le]=arguments[b]}et()}):et():pt.version&&pt.version!==k.AMapUI.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):K.AMapUI.push(function(b){b?be(b):ot.length?window.AMapUI.loadUI(ot,function(){for(var W=0,le=ot.length;W<le;W++){var Ee=ot[W].split("/").slice(-1)[0];window.AMapUI[Ee]=arguments[W]}et()}):et()})})}function kt(pt){return new Promise(function(et,be){if(Et.Loca===mt.failed)be("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Et.Loca===mt.notload){Et.Loca=mt.loading,k.Loca.version=pt.version||k.Loca.version;var ot=k.Loca.version,ut=k.AMap.version.startsWith("2"),zt=ot.startsWith("2");if(ut&&!zt||!ut&&zt)be("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{ut=k.key,zt=document.body||document.head;var P=document.createElement("script");P.type="text/javascript",P.src="https://webapi.amap.com/loca?v="+ot+"&key="+ut,P.onerror=function(b){Et.Loca=mt.failed,be("\u8BF7\u6C42 AMapUI \u5931\u8D25")},P.onload=function(){for(Et.Loca=mt.loaded,et();K.Loca.length;)K.Loca.splice(0,1)[0]()},zt.appendChild(P)}}else Et.Loca===mt.loaded?pt.version&&pt.version!==k.Loca.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):et():pt.version&&pt.version!==k.Loca.version?be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):K.Loca.push(function(b){b?be(b):be()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var mt;(function(pt){pt.notload="notload",pt.loading="loading",pt.loaded="loaded",pt.failed="failed"})(mt||(mt={}));var k={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Et={AMap:mt.notload,AMapUI:mt.notload,Loca:mt.notload},K={AMap:[],AMapUI:[],Loca:[]},yt=[],J=function(pt){typeof pt=="function"&&(Et.AMap===mt.loaded?pt(window.AMap):yt.push(pt))};return{load:function(pt){return new Promise(function(et,be){if(Et.AMap==mt.failed)be("");else if(Et.AMap==mt.notload){var ot=pt.key,ut=pt.version,zt=pt.plugins;ot?(window.AMap&&location.host!=="lbs.amap.com"&&be("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),k.key=ot,k.AMap.version=ut||k.AMap.version,k.AMap.plugins=zt||k.AMap.plugins,Et.AMap=mt.loading,ut=document.body||document.head,window.___onAPILoaded=function(b){if(delete window.___onAPILoaded,b)Et.AMap=mt.failed,be(b);else for(Et.AMap=mt.loaded,Pt(pt).then(function(){et(window.AMap)}).catch(be);yt.length;)yt.splice(0,1)[0]()},zt=document.createElement("script"),zt.type="text/javascript",zt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+k.AMap.version+"&key="+ot+"&plugin="+k.AMap.plugins.join(","),zt.onerror=function(b){Et.AMap=mt.failed,be(b)},ut.appendChild(zt)):be("\u8BF7\u586B\u5199key")}else if(Et.AMap==mt.loaded)if(pt.key&&pt.key!==k.key)be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(pt.version&&pt.version!==k.AMap.version)be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(ot=[],pt.plugins)for(ut=0;ut<pt.plugins.length;ut+=1)k.AMap.plugins.indexOf(pt.plugins[ut])==-1&&ot.push(pt.plugins[ut]);ot.length?window.AMap.plugin(ot,function(){Pt(pt).then(function(){et(window.AMap)}).catch(be)}):Pt(pt).then(function(){et(window.AMap)}).catch(be)}else if(pt.key&&pt.key!==k.key)be("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(pt.version&&pt.version!==k.AMap.version)be("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var P=[];if(pt.plugins)for(ut=0;ut<pt.plugins.length;ut+=1)k.AMap.plugins.indexOf(pt.plugins[ut])==-1&&P.push(pt.plugins[ut]);J(function(){P.length?window.AMap.plugin(P,function(){Pt(pt).then(function(){et(window.AMap)}).catch(be)}):Pt(pt).then(function(){et(window.AMap)}).catch(be)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,k={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Et={AMap:mt.notload,AMapUI:mt.notload,Loca:mt.notload},K={AMap:[],AMapUI:[],Loca:[]}}}})},59258:function(dn,Pt,nt){"use strict";var kt=nt(5543),mt=nt(79685),k=nt(80568),Et=nt(20165),K=function(J,pt){return mt.createElement(Et.Z,(0,kt.Z)((0,kt.Z)({},J),{},{ref:pt,icon:k.Z}))};K.displayName="AppstoreOutlined",Pt.Z=mt.forwardRef(K)},92432:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return J}});var kt=nt(5543),mt=nt(79685),k={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},Et=k,K=nt(20165),yt=function(et,be){return mt.createElement(K.Z,(0,kt.Z)((0,kt.Z)({},et),{},{ref:be,icon:Et}))};yt.displayName="RocketOutlined";var J=mt.forwardRef(yt)},16228:function(dn,Pt,nt){"use strict";var kt=nt(5543),mt=nt(79685),k=nt(53353),Et=nt(20165),K=function(J,pt){return mt.createElement(Et.Z,(0,kt.Z)((0,kt.Z)({},J),{},{ref:pt,icon:k.Z}))};K.displayName="SafetyCertificateOutlined",Pt.Z=mt.forwardRef(K)},49669:function(dn,Pt,nt){"use strict";var kt=nt(5543),mt=nt(79685),k=nt(58934),Et=nt(20165),K=function(J,pt){return mt.createElement(Et.Z,(0,kt.Z)((0,kt.Z)({},J),{},{ref:pt,icon:k.Z}))};K.displayName="TeamOutlined",Pt.Z=mt.forwardRef(K)},59679:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return o8}});var kt={};nt.r(kt),nt.d(kt,{add:function(){return d_},adjoint:function(){return qr},clone:function(){return Ar},copy:function(){return Ye},create:function(){return $r},determinant:function(){return Bn},equals:function(){return d},exactEquals:function(){return f},frob:function(){return vy},fromQuat:function(){return ih},fromQuat2:function(){return Of},fromRotation:function(){return ba},fromRotationTranslation:function(){return Lo},fromRotationTranslationScale:function(){return vv},fromRotationTranslationScaleOrigin:function(){return Xl},fromScaling:function(){return Hi},fromTranslation:function(){return Ui},fromValues:function(){return Rr},fromXRotation:function(){return Xo},fromYRotation:function(){return Ou},fromZRotation:function(){return fs},frustum:function(){return Dp},getRotation:function(){return Ec},getScaling:function(){return Dc},getTranslation:function(){return ll},identity:function(){return mr},invert:function(){return Mr},lookAt:function(){return bd},mul:function(){return y},multiply:function(){return ti},multiplyScalar:function(){return Np},multiplyScalarAndAdd:function(){return gy},ortho:function(){return Th},orthoNO:function(){return Bp},orthoZO:function(){return py},perspective:function(){return su},perspectiveFromFieldOfView:function(){return ah},perspectiveNO:function(){return u0},perspectiveZO:function(){return l0},rotate:function(){return di},rotateX:function(){return Ni},rotateY:function(){return Oi},rotateZ:function(){return zi},scale:function(){return wi},set:function(){return je},str:function(){return dy},sub:function(){return T},subtract:function(){return fo},targetTo:function(){return qh},translate:function(){return li},transpose:function(){return rr}});var mt=nt(79685),k=nt(29268),Et=nt(22374),K=nt(5543),yt=nt(88222),J=nt(81033),pt=nt(3836),et=nt(71320),be=nt(34001),ot=nt.n(be),ut=nt(55659),zt=nt(78001),P=nt(154),b=nt(26010),W=nt(16431),le=nt(14299),Ee=nt(11488),ke=nt.n(Ee),Tt=nt(31331),rt=nt(82615),Dt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")};function Se(n){var l=131,a=137,s=0;n+="x";for(var u=Math.floor(9007199254740991/a),h=0;h<n.length;h++)s>u&&(s=Math.floor(s/a)),s=s*l+n.charCodeAt(h);return s}function _e(n){n=n.toString();for(var l=5381,a=n.length;a;)l=l*33^n.charCodeAt(--a);return l>>>0}var ve=nt(23570),ne=nt(97207),xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Je(n){this.message=n}Je.prototype=new Error,Je.prototype.name="InvalidCharacterError";function Ot(n){var l=String(n).replace(/=+$/,"");if(l.length%4===1)throw new Je("'atob' failed: The string to be decoded is not correctly encoded.");for(var a="",s=0,u,h,v=0;h=l.charAt(v++);~h&&(u=s%4?u*64+h:h,s++%4)?a+=String.fromCharCode(255&u>>(-2*s&6)):0)h=xe.indexOf(h);return a}function te(n){n=String(n);for(var l,a,s,u,h="",v=0,m=n.length%3;v<n.length;){if((a=n.charCodeAt(v++))>255||(s=n.charCodeAt(v++))>255||(u=n.charCodeAt(v++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");l=a<<16|s<<8|u,h+=xe.charAt(l>>18&63)+xe.charAt(l>>12&63)+xe.charAt(l>>6&63)+xe.charAt(l&63)}return m?h.slice(0,m-3)+"===".substring(m):h}var ft=function(){function n(l,a){(0,pt.Z)(this,n),this.buffers=l,this.type=a}return(0,et.Z)(n,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(a,s,u){throw new Error("not implemented")}}]),n}(),wt,Y=function(){return wt||(wt=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof nt.g!="undefined"?nt.g:{})};wt=Y();var gt;typeof window=="undefined"?gt={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(l){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(l){return null},clearMeasures:function(l){return null},clearMarks:function(l){return null},measure:function(l,a,s){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(l){return!0},Event:function(l,a){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:gt=window;var he=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Oe=he?my.getSystemInfoSync().pixelRatio:gt.devicePixelRatio,Le=(0,et.Z)(function n(l,a){(0,pt.Z)(this,n),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=l,this.timeStamp=Date.now()});function Ve(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Bt(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Bt(n,l){if(n){if(typeof n=="string")return re(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return re(n,l)}}function re(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var ye=new WeakMap,Yt=function(){function n(){(0,pt.Z)(this,n),ye.set(this,{})}return(0,et.Z)(n,[{key:"addEventListener",value:function(a,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=ye.get(this);h||(h={}),h[a]||(h[a]=[]),h[a].push(s),ye.set(this,h),u.capture,u.once,u.passive}},{key:"removeEventListener",value:function(a,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=ye.get(this);if(h){var v=h[a];if(v&&v.length>0){for(var m=v.length;m--;m>0)if(v[m]===s){v.splice(m,1);break}}}}},{key:"dispatchEvent",value:function(a){var s=ye.get(this)[a.type];if(s){var u=Ve(s),h;try{for(u.s();!(h=u.n()).done;){var v=h.value;v(a)}}catch(m){u.e(m)}finally{u.f()}}}}]),n}();function qe(n){var l=vr();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function vr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var oe=function(n){(0,zt.Z)(a,n);var l=qe(a);function a(){var s;return(0,pt.Z)(this,a),s=l.call(this),s.childNodes=[],s}return(0,et.Z)(a,[{key:"appendChild",value:function(u){this.childNodes.push(u)}},{key:"cloneNode",value:function(){var u=Object.create(this);return Object.assign(u,this),u}},{key:"removeChild",value:function(u){var h=this.childNodes.findIndex(function(v){return v===u});return h>-1?this.childNodes.splice(h,1):null}}]),a}(Yt);function qt(n){var l=bt();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function bt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wt=function(n){(0,zt.Z)(a,n);var l=qt(a);function a(){var s;return(0,pt.Z)(this,a),s=l.call(this),s.className="",s.children=[],s}return(0,et.Z)(a,[{key:"setAttribute",value:function(u,h){this[u]=h}},{key:"getAttribute",value:function(u){return this[u]}},{key:"setAttributeNS",value:function(u,h){this[u]=h}},{key:"getAttributeNS",value:function(u){return this[u]}}]),a}(oe),$t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,xt,St,ue,Pe;if($t){var ze=my.getSystemInfoSync();xt=ze.screenWidth,St=ze.screenHeight,ue=ze.windowWidth,Pe=ze.windowHeight}else{var Vt=gt.innerWidth,Ct=gt.innerHeight;xt=Vt,St=Ct,ue=Vt,Pe=Ct}var At={width:xt,height:St,availWidth:ue,availHeight:Pe,availLeft:0,availTop:0},Nt=At.availWidth,tt=At.availHeight,vt={style:[]};function Ht(n,l){if(!("parentNode"in n)){var a;l===0?a=function(){return null}:l===1?a=function(){return vt}:a=function(){return null},Object.defineProperty(n,"parentNode",{enumerable:!0,get:a})}if(!("parentElement"in n)){var s;l===0?s=function(){return null}:l===1?s=function(){return vt}:s=function(){return null},Object.defineProperty(n,"parentElement",{enumerable:!0,get:s})}}function de(n){n.style=n.style||{},Object.assign(n.style,{top:"0px",left:"0px",width:Nt+"px",height:tt+"px",margin:"0px",padding:"0px"})}function jt(n){"clientLeft"in n||(n.clientLeft=0,n.clientTop=0),"clientWidth"in n||(n.clientWidth=Nt,n.clientHeight=tt),"getBoundingClientRect"in n||(n.getBoundingClientRect=function(){var l={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return l})}function Ie(n){"offsetLeft"in n||(n.offsetLeft=0,n.offsetTop=0),"offsetWidth"in n||(n.offsetWidth=Nt,n.offsetHeight=tt)}function We(n){"scrollLeft"in n||(n.scrollLeft=0,n.scrollTop=0),"scrollWidth"in n||(n.scrollWidth=Nt,n.scrollHeight=tt)}function Ke(n){var l=function(){return!0};n.classList=[],n.classList.add=l,n.classList.remove=l,n.classList.contains=l,n.classList.toggle=l}function pr(n){var l=lr();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function lr(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function Nr(){}var Pr=function(n){(0,zt.Z)(a,n);var l=pr(a);function a(){var s,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",h=arguments.length>1?arguments[1]:void 0;return(0,pt.Z)(this,a),s=l.call(this),s.className="",s.children=[],s.focus=Nr,s.blur=Nr,s.insertBefore=Nr,s.appendChild=Nr,s.removeChild=Nr,s.remove=Nr,s.innerHTML="",s.tagName=u.toUpperCase(),Ht((0,ut.Z)(s),h),de((0,ut.Z)(s)),Ke((0,ut.Z)(s)),jt((0,ut.Z)(s)),Ie((0,ut.Z)(s)),We((0,ut.Z)(s)),s}return(0,et.Z)(a)}(Wt);function Gr(n){var l=Sn();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Sn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var nn=function(n){(0,zt.Z)(a,n);var l=Gr(a);function a(s){return(0,pt.Z)(this,a),l.call(this,s)}return(0,et.Z)(a,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),a}(Pr);function Nn(n){var l=Zn();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Zn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Hn=function(n){(0,zt.Z)(a,n);var l=Nn(a);function a(){return(0,pt.Z)(this,a),l.call(this,"video")}return(0,et.Z)(a)}(nn),An={},$n={};function Rt(n,l){An=n,An.id=l,"tagName"in An||(An.tagName="CANVAS"),An.type="canvas",Mixin.parentNode(An),Mixin.style(An),Mixin.classList(An),Mixin.clientRegion(An),Mixin.offsetRegion(An),An.focus=function(){},An.blur=function(){}}function Xt(n,l){var a=1024,s=1024;$n={width:a,height:s,clientWidth:a/devicePixelRatio,clientHeight:s/devicePixelRatio,id:l,type:"canvas"},"tagName"in $n||($n.tagName="CANVAS"),Mixin.parentNode($n),Mixin.style($n),Mixin.classList($n),Mixin.clientRegion($n),Mixin.offsetRegion($n),$n.getContext=function(u){if(u==="2d")return n},$n.focus=function(){},$n.blur=function(){}}function ae(){return An}function we(){return $n}var Ge=(0,et.Z)(function n(){(0,pt.Z)(this,n);var l=ae(),a=l.createImage&&l.createImage()||{};return"tagName"in a||(a.tagName="IMG",a.__proto__=n.prototype),Ht(a),Ke(a),Object.assign(a,{addEventListener:function(u,h){a["on".concat(u)]=h.bind(a)},removeEventListener:function(u){a["on".concat(u)]=null}}),a}),cr={href:"",protocol:"",host:""};function br(n){var l=Ce();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Ce(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ar=function(n){(0,zt.Z)(a,n);var l=br(a);function a(){return(0,pt.Z)(this,a),l.call(this,"body",0)}return(0,et.Z)(a,[{key:"addEventListener",value:function(u,h){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(u,h,v){}},{key:"dispatchEvent",value:function(u){}}]),a}(Pr),Hr=function(n){(0,zt.Z)(a,n);var l=br(a);function a(){return(0,pt.Z)(this,a),l.call(this,"html",0)}return(0,et.Z)(a,[{key:"addEventListener",value:function(u,h){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(u,h){}},{key:"dispatchEvent",value:function(u){}}]),a}(Pr),Tn={},Kr={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:cr,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(l){return l=l.toLowerCase(),l==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):l==="img"?new Ge:l==="video"?new Hn:new Pr(l)},createElementNS:function(l,a){return this.createElement(a)},createTextNode:function(l){return l},getElementById:function(l){return null},getElementsByTagName:function(l){return l=l.toLowerCase(),[]},getElementsByTagNameNS:function(l,a){return this.getElementsByTagName(a)},getElementsByName:function(l){return[]},querySelector:function(l){return null},querySelectorAll:function(l){return[]},addEventListener:function(l,a,s){Tn[l]||(Tn[l]=[]),Tn[l].push(a)},removeEventListener:function(l,a){var s=Tn[l];if(s&&s.length>0){for(var u=s.length;u--;u>0)if(s[u]===a){s.splice(u,1);break}}},dispatchEvent:function(l){var a=l.type,s=Tn[a];if(s)for(var u=0;u<s.length;u++)s[u](l);l.target&&typeof l.target["on"+a]=="function"&&l.target["on"+a](l)},createEvent:function(l){return new Le(l)}};Kr.documentElement=new Hr,Kr.head=new Pr("head"),Kr.body=new ar;var an=Object,Pn=nt(56151),xi=function(){function n(){(0,pt.Z)(this,n);var l=arguments.length;if(l===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else l===3&&(0,Pn.Z)(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return(0,et.Z)(n,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),n}(),Ci=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Qr,Kn,ai;if(Ci){var fi=my.getSystemInfoSync();Qr=fi.system,Kn=fi.platform,ai=fi.language}else{var oa={versions:function(){var n=gt.navigator.userAgent;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")===-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1||n.indexOf("Linux")>-1,iPhone:n.indexOf("iPhone")>-1,iPad:n.indexOf("iPad")>-1,webApp:n.indexOf("Safari")===-1,weixin:n.indexOf("MicroMessenger")>-1,qq:n.match(/\sQQ/i)===" qq"}}(),language:(gt.navigator.browserLanguage||gt.navigator.language).toLowerCase()};oa.versions.android?Kn="android":oa.versions.trident?Kn="IE":oa.versions.presto?Kn="Opera":oa.versions.webKit?Kn="webKit":oa.versions.gecko?Kn="Firefox":oa.versions.mobile?Kn="mobile":oa.versions.ios?Kn="ios":oa.versions.iPhone?Kn="iPhone":oa.versions.iPad?Kn="ipad":oa.versions.webApp?Kn="webApp":oa.versions.weixin?Kn="weixin":oa.versions.qq&&(Kn="qq"),Qr=gt.navigator.userAgent,ai=oa.language}var Ai=Qr.toLowerCase().indexOf("android")!==-1,Ca=Ai?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",po="Mozilla/5.0 (".concat(Ca,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(ai),La={platform:Kn,language:ai,appVersion:"5.0 (".concat(Ca,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:po},Va={mark:function(l){return null},clearMeasures:function(l){return null},clearMarks:function(l){return null},measure:function(l,a,s){return{duration:0}},now:function(){}},_a=0,ma=0;function Qa(n){var l=Date.now(),a=Math.max(_a+23,l);return ma=setTimeout(function(){n(_a=a)},a-l),ma}function Uo(n){var l=ae();return l.requestAnimationFrame?l.requestAnimationFrame(n):Qa(n)}function vo(n){var l=ae();return l.cancelAnimationFrame?l.cancelAnimationFrame(n):clearTimeout(n)}var Ua=function(){function n(l){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if((0,pt.Z)(this,n),l.indexOf("http://")==0||l.indexOf("https://")==0){this.href=l;return}this.href=a+l}return(0,et.Z)(n,null,[{key:"createObjectURL",value:function(a){var s=a.buffers[0],u=a.type,h=Xa(s),v="data:".concat(u,";base64, ");return v+h}}]),n}();function Xa(n){for(var l="",a=new Uint8Array(n),s=a.byteLength,u=0;u<s;u++)l+=String.fromCharCode(a[u]);return te(l)}var Oo={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},Du={};function Yo(n){var l=_o();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function _o(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ir=new Map,ge=new Map,He=new Map,Ir={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function en(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(n)]=="function"&&this["on".concat(n)].call(this,l)}function On(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:n};this.readyState=n,en.call(this,"readystatechange",l)}var zn=function(n){(0,zt.Z)(a,n);var l=Yo(a);function a(){var s;return(0,pt.Z)(this,a),s=l.call(this),s.onabort=null,s.onerror=null,s.onload=null,s.onloadstart=null,s.onprogress=null,s.ontimeout=null,s.onloadend=null,s.onreadystatechange=null,s.readyState=0,s.response=null,s.responseText=null,s._responseType="text",s.responseXML=null,s.status=0,s.statusText="",s.upload={},s.withCredentials=!1,ir.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),s}return(0,et.Z)(a,[{key:"responseType",set:function(u){this._responseType=u}},{key:"abort",value:function(){var u=He.get("requestTask");u&&u.abort()}},{key:"getAllResponseHeaders",value:function(){var u=ge.get("responseHeader");return Object.keys(u).map(function(h){return"".concat(h,": ").concat(u[h])}).join(`
`)}},{key:"getResponseHeader",value:function(u){return ge.get("responseHeader")[u]}},{key:"open",value:function(u,h,v){this._method=u,this._url=h}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(u,h){var v=ir.get("requestHeader");v[u]=h,ir.set("requestHeader",v)}},{key:"addEventListener",value:function(u,h){var v=this;typeof h=="function"&&(this["on"+u]=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.target=m.target||v,h.call(v,m)})}},{key:"removeEventListener",value:function(u,h){this["on"+u]===h&&(this["on"+u]=null)}}]),a}(Yt);zn.UNSEND=0,zn.OPENED=1,zn.HEADERS_RECEIVED=2,zn.LOADING=3,zn.DONE=4;function kn(n){var l=qi();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function qi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Oa=function(n){(0,zt.Z)(a,n);var l=kn(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this,s),u.touches=[],u.targetTouches=[],u.changedTouches=[],u.target=ae(),u.currentTarget=ae(),u}return(0,et.Z)(a)}(Le);function us(n){var l=n||{},a=l.x,s=a===void 0?0:a,u=l.y,h=u===void 0?0:u,v=l.clientX,m=v===void 0?0:v,w=l.clientY,A=w===void 0?0:w;Object.keys(n).indexOf("x")!==-1?(n.pageX=n.clientX=s,n.pageY=n.clientY=h):(n.x=m,n.y=A)}function Ao(n){return function(l){var a=new Oa(n);a.changedTouches=l.changedTouches,a.touches=l.touches,a.targetTouches=Array.prototype.slice.call(l.touches),a.timeStamp=l.timeStamp,a.changedTouches.forEach(function(s){return us(s)}),a.touches.forEach(function(s){return us(s)}),a.targetTouches.forEach(function(s){return us(s)}),Kr.dispatchEvent(a)}}function Ho(n){return function(l){l.type=n,Kr.dispatchEvent(l)}}var uo=Ao("touchstart"),Zo=Ao("touchmove"),Qs=Ao("touchend"),jo=Ho("mapCameaParams");function _l(n){var l=Hc();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Hc(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $u=function(n){(0,zt.Z)(a,n);var l=_l(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this,s),u.target=ae(),u.currentTarget=ae(),u}return(0,et.Z)(a)}(Le),Ae=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],Xe=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],Cr="touch";function sn(n,l,a){for(var s=new $u(n),u=0;u<Ae.length;u++){var h=Ae[u];s[h]=l[h]||Xe[u]}return s.type=n,s.target=ae(),s.currentTarget=ae(),s.buttons=si(n),s.which=s.buttons,s.pointerId=(l.identifier||0)+2,s.bubbles=!0,s.cancelable=!0,s.button=0,s.width=(l.radiusX||.5)*2,s.height=(l.radiusY||.5)*2,s.pressure=l.force||.5,s.isPrimary=ja(l),s.pointerType=Cr,s.altKey=a.altKey,s.ctrlKey=a.ctrlKey,s.metaKey=a.metaKey,s.shiftKey=a.shiftKey,a.preventDefault&&(s.preventDefault=function(){a.preventDefault()}),s}function si(n){var l=0;return(n==="touchstart"||n==="touchmove"||n==="pointerdown"||n==="pointermove")&&(l=1),l}var Pi=null;function ja(n){return Pi===n.identifier}function vs(n){Pi===null&&(Pi=n.identifier)}function $o(n){Pi===n.identifier&&(Pi=null)}function qo(n){return function(l){for(var a=l.changedTouches,s=0;s<a.length;s++){var u=a[s];s===0&&n==="pointerdown"?vs(u):(n==="pointerup"||n==="pointercancel")&&$o(u);var h=sn(n,u,l);Kr.dispatchEvent(h)}}}var Js=qo("pointerdown"),qu=qo("pointermove"),yu=qo("pointerup");function Zs(n){var l=_u();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function _u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ku=function(n){(0,zt.Z)(a,n);var l=Zs(a);function a(s){return(0,pt.Z)(this,a),l.call(this,s)}return(0,et.Z)(a)}(Le);function Bu(n){return function(l){l.type=n,Kr.dispatchEvent(l)}}var xl=Bu("mousedown"),Nu=Bu("mousemove"),Fo=Bu("mouseup"),Ts=!1;function jc(n){Ts=n}var Wc=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,xu=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),Ms=(Wc||xu)&&Ts,pl={atob:Ot,btoa:te,devicePixelRatio:Oe,Blob:ft,document:Kr,Element:Wt,Event:Le,EventTarget:Yt,HTMLCanvasElement:an,HTMLElement:Pr,HTMLMediaElement:nn,HTMLVideoElement:Hn,Image:Ge,ImageData:xi,navigator:La,Node:oe,requestAnimationFrame:Uo,cancelAnimationFrame:vo,screen:At,XMLHttpRequest:zn,performance:Va,URL:Ua,WebGLRenderingContext:Oo,WebGL2RenderingContext:Du,addEventListener:function(l,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Kr.addEventListener(l,a,s)},removeEventListener:function(l,a,s){Kr.removeEventListener(l,a)},dispatchEvent:function(l){Kr.dispatchEvent(l)},innerWidth:At.availWidth,innerHeight:At.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},Ga=Ms?pl:gt,zu=Ms?zn:gt.XMLHttpRequest,Xc=Ms?cr:gt.location;function D(n){var l=n;return typeof n=="string"&&(l=Ga.document.getElementById(n)),l}function X(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function Mt(n){return X(n).split(/\s+/)}function it(n){var l,a,s=Ga==null||(l=Ga.document)===null||l===void 0||(a=l.documentElement)===null||a===void 0?void 0:a.style;if(!s)return n[0];for(var u in n)if(n[u]&&n[u]in s)return n[u];return n[0]}function Jt(n,l,a){var s=Ga.document.createElement(n);return l&&(s.className=l||""),a&&a.appendChild(s),s}function Ue(n){var l=n.parentNode;l&&l.removeChild(n)}function yr(n,l){if(n.classList!==void 0)for(var a=Mt(l),s=0,u=a.length;s<u;s++)n.classList.add(a[s]);else if(!zr(n,l)){var h=Vn(n);Cn(n,(h?h+" ":"")+l)}}function Br(n,l){n.classList!==void 0?n.classList.remove(l):Cn(n,X((" "+Vn(n)+" ").replace(" "+l+" "," ")))}function zr(n,l){if(n.classList!==void 0)return n.classList.contains(l);var a=Vn(n);return a.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(a)}function Cn(n,l){n instanceof HTMLElement?n.className=l:n.className.baseVal=l}function Vn(n){return n instanceof SVGElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Ki(n){for(;n&&n.firstChild;)n.removeChild(n.firstChild)}var Ma=it(["transform","WebkitTransform"]);function xa(n,l){n.style[Ma]=l}function lo(){if(typeof Event=="function")Ga.dispatchEvent(new Event("resize"));else{var n=Ga.document.createEvent("UIEvents");n.initUIEvent("resize",!0,!1,Ga,0),Ga.dispatchEvent(n)}}function Ro(n){var l=["padding: "+(n.height/2-8)+"px "+n.width/2+"px;","line-height: "+n.height+"px;","background-image: url("+n.toDataURL()+");"];console.log(`%c
`,l.join(""))}function Io(){var n,l=Ga.document.querySelector('meta[name="viewport"]');if(!l)return 1;var a=(n=l.content)===null||n===void 0?void 0:n.split(","),s=a.find(function(u){var h=u.split("="),v=(0,yt.Z)(h,1),m=v[0];return m==="initial-scale"});return s?s.split("=")[1]*1:1}var fa=Io()<1?1:Ga.devicePixelRatio;function bu(n,l){n.setAttribute("style","".concat(n.style.cssText).concat(l))}function bl(n){return n.split(";").map(function(l){return l.trim()}).filter(function(l){return l})}function Ic(n,l){var a,s=bl((a=n.getAttribute("style"))!==null&&a!==void 0?a:""),u=bl(l),h=ne.pull.apply(void 0,[s].concat((0,ve.Z)(u)));n.setAttribute("style",h.join(";"))}function Yc(n){return Object.entries(n).map(function(l){var a=(0,yt.Z)(l,2),s=a[0],u=a[1];return"".concat(s,": ").concat(u)}).join(";")}function Fl(n,l){return{left:n.left-l.left,top:n.top-l.top,right:l.left+l.width-n.left-n.width,bottom:l.top+l.height-n.top-n.height}}function kc(n,l){n.checked=l,l?n.setAttribute("checked","true"):n.removeAttribute("checked")}function Uu(n){n.innerHTML=""}function js(n){n.setAttribute("draggable","false")}function ce(n,l){if(typeof l=="string"){var a=document.createElement("div");for(a.innerHTML=l;a.firstChild;)n.append(a.firstChild)}else Array.isArray(l)?n.append.apply(n,(0,ve.Z)(l)):n.append(l)}function or(n){if(n.length===0)throw new Error("max requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]>l&&(l=n[a]);return l*1}function Fr(n){if(n.length===0)throw new Error("min requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]<l&&(l=n[a]);return l*1}function Xr(n){if(n.length===0)return 0;for(var l=n[0]*1,a=1;a<n.length;a++)l+=n[a]*1;return l}function xn(n){if(n.length===0)throw new Error("mean requires at least one data point");return Xr(n)/n.length}function Ii(n){if(n.length===0)throw new Error("mean requires at least one data point");if(n.length<3)return n[0];n.sort();for(var l=n[0],a=NaN,s=0,u=1,h=1;h<n.length+1;h++)n[h]!==l?(u>s&&(s=u,a=l),u=1,l=n[h]):u++;return a*1}var ra={min:Fr,max:or,mean:xn,sum:Xr,mode:Ii};function Wa(n,l){return n.map(function(a){return a[l]})}function Eu(n,l){return ra[n](l)}var Ws=nt(52446);function Ya(n){return Function.toString.call(n).indexOf("[native code]")!==-1}var Jl=nt(79172);function $c(n,l,a){return(0,Jl.Z)()?$c=Reflect.construct.bind():$c=function(u,h,v){var m=[null];m.push.apply(m,h);var w=Function.bind.apply(u,m),A=new w;return v&&(0,Ws.Z)(A,v.prototype),A},$c.apply(null,arguments)}function tc(n){var l=typeof Map=="function"?new Map:void 0;return tc=function(s){if(s===null||!Ya(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l!="undefined"){if(l.has(s))return l.get(s);l.set(s,u)}function u(){return $c(s,arguments,(0,b.Z)(this).constructor)}return u.prototype=Object.create(s.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),(0,Ws.Z)(u,s)},tc(n)}function rd(n){var l=zf();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function zf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tv=function(n){(0,zt.Z)(a,n);var l=rd(a);function a(s,u,h,v){var m;return(0,pt.Z)(this,a),m=l.call(this,"AJAXError: ".concat(u," (").concat(s,"): ").concat(h)),m.status=s,m.statusText=u,m.url=h,m.body=v,m}return(0,et.Z)(a)}(tc(Error));function Ep(n,l){var a=new zu,s=Array.isArray(n.url)?n.url[0]:n.url;a.open(n.method||"GET",s,!0),n.type==="arrayBuffer"&&(a.responseType="arraybuffer");for(var u in n.headers)n.headers.hasOwnProperty(u)&&a.setRequestHeader(u,n.headers[u]);return n.type==="json"&&(a.responseType="text",a.setRequestHeader("Accept","application/json")),a.withCredentials=n.credentials==="include",a.onerror=function(){l(new Error(a.statusText))},a.onload=function(){if((a.status>=200&&a.status<300||a.status===0)&&a.response!==null){var h=a.response;if(n.type==="json")try{h=JSON.parse(a.response)}catch(m){return l(m)}l(null,h,a.getResponseHeader("Cache-Control"),a.getResponseHeader("Expires"),a)}else{var v=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});l(new tv(a.status,a.statusText,s.toString(),v))}},a.send(n.body),a}function Uf(n){return new Promise(function(l,a){Ep(n,function(s,u,h,v,m){s?a({err:s,data:null,xhr:m}):l({err:null,data:u,cacheControl:h,expires:v,xhr:m})})})}function qc(n,l){return Ep(n,l)}var Zf=function(l,a){return qc((0,K.Z)((0,K.Z)({},l),{},{type:"json"}),a)},Kc=function(l,a){return qc((0,K.Z)((0,K.Z)({},l),{},{type:"arrayBuffer"}),a)},Vf=function(l,a){return qc(_objectSpread(_objectSpread({},l),{},{method:"POST"}),a)};function fh(n){var l=$window.document.createElement("a");return l.href=n,l.protocol===$window.document.location.protocol&&l.host===$window.document.location.host}var Qc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Rl(n,l){var a=new Ga.Image,s=Ga.URL||Ga.webkitURL;a.crossOrigin="anonymous",a.onload=function(){l(null,a),s.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(function(){a.src=Qc})},a.onerror=function(){return l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var u=new Blob([new Uint8Array(n)],{type:"image/png"});a.src=n.byteLength?s.createObjectURL(u):Qc}function wp(n,l){var a=new Blob([new Uint8Array(n)],{type:"image/png"});createImageBitmap(a).then(function(s){l(null,s)}).catch(function(s){l(new Error("Could not load image because of ".concat(s.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var hh=function(l,a,s){var u=function(v,m){if(v)a(v);else if(m){var w=typeof createImageBitmap=="function",A=s?s(m):m;w?wp(A,a):Rl(A,a)}};return l.type==="json"?Zf(l,u):Kc(l,u)},Qu=63710088e-1,Jc={centimeters:Qu*100,centimetres:Qu*100,degrees:Qu/111325,feet:Qu*3.28084,inches:Qu*39.37,kilometers:Qu/1e3,kilometres:Qu/1e3,meters:Qu,metres:Qu,miles:Qu/1609.344,millimeters:Qu*1e3,millimetres:Qu*1e3,nauticalmiles:Qu/1852,radians:1,yards:Qu*1.0936},Zh={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Qu,yards:1.0936133},Gf={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function ec(n,l,a){a===void 0&&(a={});var s={type:"Feature"};return(a.id===0||a.id)&&(s.id=a.id),a.bbox&&(s.bbox=a.bbox),s.properties=l||{},s.geometry=n,s}function Sp(n,l,a){switch(a===void 0&&(a={}),n){case"Point":return nd(l).geometry;case"LineString":return tf(l).geometry;case"Polygon":return rc(l).geometry;case"MultiPoint":return od(l).geometry;case"MultiLineString":return ad(l).geometry;case"MultiPolygon":return mf(l).geometry;default:throw new Error(n+" is invalid")}}function nd(n,l,a){if(a===void 0&&(a={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Bl(n[0])||!Bl(n[1]))throw new Error("coordinates must contain numbers");var s={type:"Point",coordinates:n};return ec(s,l,a)}function Cp(n,l,a){return a===void 0&&(a={}),gf(n.map(function(s){return nd(s,l)}),a)}function rc(n,l,a){a===void 0&&(a={});for(var s=0,u=n;s<u.length;s++){var h=u[s];if(h.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var v=0;v<h[h.length-1].length;v++)if(h[h.length-1][v]!==h[0][v])throw new Error("First and last Position are not equivalent.")}var m={type:"Polygon",coordinates:n};return ec(m,l,a)}function id(n,l,a){return a===void 0&&(a={}),gf(n.map(function(s){return rc(s,l)}),a)}function tf(n,l,a){if(a===void 0&&(a={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var s={type:"LineString",coordinates:n};return ec(s,l,a)}function Hf(n,l,a){return a===void 0&&(a={}),gf(n.map(function(s){return tf(s,l)}),a)}function gf(n,l){l===void 0&&(l={});var a={type:"FeatureCollection"};return l.id&&(a.id=l.id),l.bbox&&(a.bbox=l.bbox),a.features=n,a}function ad(n,l,a){a===void 0&&(a={});var s={type:"MultiLineString",coordinates:n};return ec(s,l,a)}function od(n,l,a){a===void 0&&(a={});var s={type:"MultiPoint",coordinates:n};return ec(s,l,a)}function mf(n,l,a){a===void 0&&(a={});var s={type:"MultiPolygon",coordinates:n};return ec(s,l,a)}function $v(n,l,a){a===void 0&&(a={});var s={type:"GeometryCollection",geometries:n};return ec(s,l,a)}function ph(n,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var a=Math.pow(10,l||0);return Math.round(n*a)/a}function gs(n,l){l===void 0&&(l="kilometers");var a=Jc[l];if(!a)throw new Error(l+" units is invalid");return n*a}function yf(n,l){l===void 0&&(l="kilometers");var a=Jc[l];if(!a)throw new Error(l+" units is invalid");return n/a}function jf(n,l){return Ja(yf(n,l))}function Dl(n){var l=n%360;return l<0&&(l+=360),l}function Ja(n){var l=n%(2*Math.PI);return l*180/Math.PI}function Wo(n){var l=n%360;return l*Math.PI/180}function ro(n,l,a){if(l===void 0&&(l="kilometers"),a===void 0&&(a="kilometers"),!(n>=0))throw new Error("length must be a positive number");return gs(yf(n,l),a)}function Ap(n,l,a){if(l===void 0&&(l="meters"),a===void 0&&(a="kilometers"),!(n>=0))throw new Error("area must be a positive number");var s=Gf[l];if(!s)throw new Error("invalid original units");var u=Gf[a];if(!u)throw new Error("invalid final units");return n/s*u}function Bl(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Tp(n){return!!n&&n.constructor===Object}function qv(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(l){if(!Bl(l))throw new Error("bbox must only contain numbers")})}function Ia(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}function Wf(n){return typeof n=="number"}function ef(n,l,a){if(n!==null)for(var s,u,h,v,m,w,A,R=0,B=0,G,j=n.type,lt=j==="FeatureCollection",ct=j==="Feature",_t=lt?n.features.length:1,Zt=0;Zt<_t;Zt++){A=lt?n.features[Zt].geometry:ct?n.geometry:n,G=A?A.type==="GeometryCollection":!1,m=G?A.geometries.length:1;for(var pe=0;pe<m;pe++){var fe=0,Ze=0;if(v=G?A.geometries[pe]:A,v!==null){w=v.coordinates;var Qe=v.type;switch(R=a&&(Qe==="Polygon"||Qe==="MultiPolygon")?1:0,Qe){case null:break;case"Point":if(l(w,B,Zt,fe,Ze)===!1)return!1;B++,fe++;break;case"LineString":case"MultiPoint":for(s=0;s<w.length;s++){if(l(w[s],B,Zt,fe,Ze)===!1)return!1;B++,Qe==="MultiPoint"&&fe++}Qe==="LineString"&&fe++;break;case"Polygon":case"MultiLineString":for(s=0;s<w.length;s++){for(u=0;u<w[s].length-R;u++){if(l(w[s][u],B,Zt,fe,Ze)===!1)return!1;B++}Qe==="MultiLineString"&&fe++,Qe==="Polygon"&&Ze++}Qe==="Polygon"&&fe++;break;case"MultiPolygon":for(s=0;s<w.length;s++){for(Ze=0,u=0;u<w[s].length;u++){for(h=0;h<w[s][u].length-R;h++){if(l(w[s][u][h],B,Zt,fe,Ze)===!1)return!1;B++}Ze++}fe++}break;case"GeometryCollection":for(s=0;s<v.geometries.length;s++)if(ef(v.geometries[s],l,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function _f(n,l,a,s){var u=a;return ef(n,function(h,v,m,w,A){v===0&&a===void 0?u=h:u=l(u,h,v,m,w,A)},s),u}function tu(n,l){var a;switch(n.type){case"FeatureCollection":for(a=0;a<n.features.length&&l(n.features[a].properties,a)!==!1;a++);break;case"Feature":l(n.properties,0);break}}function dh(n,l,a){var s=a;return tu(n,function(u,h){h===0&&a===void 0?s=u:s=l(s,u,h)}),s}function vh(n,l){if(n.type==="Feature")l(n,0);else if(n.type==="FeatureCollection")for(var a=0;a<n.features.length&&l(n.features[a],a)!==!1;a++);}function Fs(n,l,a){var s=a;return vh(n,function(u,h){h===0&&a===void 0?s=u:s=l(s,u,h)}),s}function ji(n){var l=[];return ef(n,function(a){l.push(a)}),l}function _s(n,l){var a,s,u,h,v,m,w,A,R,B,G=0,j=n.type==="FeatureCollection",lt=n.type==="Feature",ct=j?n.features.length:1;for(a=0;a<ct;a++){for(m=j?n.features[a].geometry:lt?n.geometry:n,A=j?n.features[a].properties:lt?n.properties:{},R=j?n.features[a].bbox:lt?n.bbox:void 0,B=j?n.features[a].id:lt?n.id:void 0,w=m?m.type==="GeometryCollection":!1,v=w?m.geometries.length:1,u=0;u<v;u++){if(h=w?m.geometries[u]:m,h===null){if(l(null,G,A,R,B)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(h,G,A,R,B)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<h.geometries.length;s++)if(l(h.geometries[s],G,A,R,B)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}G++}}function El(n,l,a){var s=a;return _s(n,function(u,h,v,m,w){h===0&&a===void 0?s=u:s=l(s,u,h,v,m,w)}),s}function Nl(n,l){_s(n,function(a,s,u,h,v){var m=a===null?null:a.type;switch(m){case null:case"Point":case"LineString":case"Polygon":return l(ec(a,u,{bbox:h,id:v}),s,0)===!1?!1:void 0}var w;switch(m){case"MultiPoint":w="Point";break;case"MultiLineString":w="LineString";break;case"MultiPolygon":w="Polygon";break}for(var A=0;A<a.coordinates.length;A++){var R=a.coordinates[A],B={type:w,coordinates:R};if(l(ec(B,u),s,A)===!1)return!1}})}function vc(n,l,a){var s=a;return Nl(n,function(u,h,v){h===0&&v===0&&a===void 0?s=u:s=l(s,u,h,v)}),s}function Zu(n,l){Nl(n,function(a,s,u){var h=0;if(a.geometry){var v=a.geometry.type;if(!(v==="Point"||v==="MultiPoint")){var m,w=0,A=0,R=0;if(ef(a,function(B,G,j,lt,ct){if(m===void 0||s>w||lt>A||ct>R){m=B,w=s,A=lt,R=ct,h=0;return}var _t=lineString([m,B],a.properties);if(l(_t,s,u,ct,h)===!1)return!1;h++,m=B})===!1)return!1}}})}function sd(n,l,a){var s=a,u=!1;return Zu(n,function(h,v,m,w,A){u===!1&&a===void 0?s=h:s=l(s,h,v,m,w,A),u=!0}),s}function Ti(n,l){if(!n)throw new Error("geojson is required");Nl(n,function(a,s,u){if(a.geometry!==null){var h=a.geometry.type,v=a.geometry.coordinates;switch(h){case"LineString":if(l(a,s,u,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<v.length;m++)if(l(lineString(v[m],a.properties),s,u,m)===!1)return!1;break}}})}function Xf(n,l,a){var s=a;return Ti(n,function(u,h,v,m){h===0&&a===void 0?s=u:s=l(s,u,h,v,m)}),s}function gh(n,l){if(l=l||{},!isObject(l))throw new Error("options is invalid");var a=l.featureIndex||0,s=l.multiFeatureIndex||0,u=l.geometryIndex||0,h=l.segmentIndex||0,v=l.properties,m;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),v=v||n.features[a].properties,m=n.features[a].geometry;break;case"Feature":v=v||n.properties,m=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=n;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var w=m.coordinates;switch(m.type){case"Point":case"MultiPoint":return null;case"LineString":return h<0&&(h=w.length+h-1),lineString([w[h],w[h+1]],v,l);case"Polygon":return u<0&&(u=w.length+u),h<0&&(h=w[u].length+h-1),lineString([w[u][h],w[u][h+1]],v,l);case"MultiLineString":return s<0&&(s=w.length+s),h<0&&(h=w[s].length+h-1),lineString([w[s][h],w[s][h+1]],v,l);case"MultiPolygon":return s<0&&(s=w.length+s),u<0&&(u=w[s].length+u),h<0&&(h=w[s][u].length-h-1),lineString([w[s][u][h],w[s][u][h+1]],v,l)}throw new Error("geojson is invalid")}function rf(n,l){if(l=l||{},!isObject(l))throw new Error("options is invalid");var a=l.featureIndex||0,s=l.multiFeatureIndex||0,u=l.geometryIndex||0,h=l.coordIndex||0,v=l.properties,m;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),v=v||n.features[a].properties,m=n.features[a].geometry;break;case"Feature":v=v||n.properties,m=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=n;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var w=m.coordinates;switch(m.type){case"Point":return point(w,v,l);case"MultiPoint":return s<0&&(s=w.length+s),point(w[s],v,l);case"LineString":return h<0&&(h=w.length+h),point(w[h],v,l);case"Polygon":return u<0&&(u=w.length+u),h<0&&(h=w[u].length+h),point(w[u][h],v,l);case"MultiLineString":return s<0&&(s=w.length+s),h<0&&(h=w[s].length+h),point(w[s][h],v,l);case"MultiPolygon":return s<0&&(s=w.length+s),u<0&&(u=w[s].length+u),h<0&&(h=w[s][u].length-h),point(w[s][u][h],v,l)}throw new Error("geojson is invalid")}function es(n){var l=[1/0,1/0,-1/0,-1/0];return ef(n,function(a){l[0]>a[0]&&(l[0]=a[0]),l[1]>a[1]&&(l[1]=a[1]),l[2]<a[0]&&(l[2]=a[0]),l[3]<a[1]&&(l[3]=a[1])}),l}es.default=es;var wu=es,xf=2*Math.PI*6378137/2;function wl(n,l){var a=(0,yt.Z)(l,4),s=a[0],u=a[1],h=a[2],v=a[3];return n.lng>s&&n.lng<=h&&n.lat>u&&n.lat<=v}function eu(n){var l=[1/0,1/0,-1/0,-1/0];return n.forEach(function(a){var s=a.coordinates;nl(l,s)}),l}function nl(n,l){return Array.isArray(l[0])?l.forEach(function(a){nl(n,a)}):(n[0]>l[0]&&(n[0]=l[0]),n[1]>l[1]&&(n[1]=l[1]),n[2]<l[0]&&(n[2]=l[0]),n[3]<l[1]&&(n[3]=l[1])),n}function Kv(n,l){return Vh(n,l)}function Vh(n,l){return Array.isArray(n[0])?n.map(function(a){return Vh(a,l)}):l(n)}function bf(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};n=to(n,l);var s=n[0],u=n[1],h=s*xf/180,v=Math.log(Math.tan((90+u)*Math.PI/360))/(Math.PI/180);return v=v*xf/180,a.enable&&(h=Number(h.toFixed(a.decimal)),v=Number(v.toFixed(a.decimal))),n.length===3?[h,v,n[2]]:[h,v]}function ev(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=n[0],s=n[1],u=a/xf*180,h=s/xf*180;return h=180/Math.PI*(2*Math.atan(Math.exp(h*Math.PI/180))-Math.PI/2),l!=null&&(u=Number(u.toFixed(l)),h=Number(h.toFixed(l))),n.length===3?[u,h,n[2]]:[u,h]}function nc(n){if(n==null)throw new Error("lng is required");return(n>180||n<-180)&&(n=n%360,n>180&&(n=-360+n),n<-180&&(n=360+n),n===0&&(n=0)),n}function dl(n){if(n==null)throw new Error("lat is required");return(n>90||n<-90)&&(n=n%180,n>90&&(n=-180+n),n<-90&&(n=180+n),n===0&&(n=0)),n}function to(n,l){if(l===!1)return n;var a=nc(n[0]),s=dl(n[1]);return s>85&&(s=85),s<-85&&(s=-85),n.length===3?[a,s,n[2]]:[a,s]}function mo(n){var l=85.0511287798,a=Math.max(Math.min(l,n[1]),-l),s=256<<20,u=Math.PI/180,h=n[0]*u,v=a*u;v=Math.log(Math.tan(Math.PI/4+v/2));var m=.5/Math.PI,w=.5,A=-.5/Math.PI;return u=.5,h=s*(m*h+w),v=s*(A*v+u),[Math.floor(h),Math.floor(v)]}function ic(n){var l=.5/Math.PI,a=.5,s=-.5/Math.PI,u=.5,h=256<<20,v=_slicedToArray(n,2),m=v[0],w=v[1];m=(m/h-a)/l,w=(w/h-u)/s,w=(Math.atan(Math.pow(Math.E,w))-Math.PI/4)*2,u=Math.PI/180;var A=w/u,R=m/u;return[R,A]}function Xs(n,l){var a=85.0511287798,s=Math.PI/180,u=6378137;return l=Math.max(Math.min(a,l),-a),n*=s,l*=s,l=Math.log(Math.tan(Math.PI/4+l/2)),[n*u,l*u]}function Yf(n,l){var a=Math.PI/180,s=6378137,u=n/s/a,h=2*(Math.atan(Math.exp(l/s))-Math.PI/4)/a;return[u,h]}function nf(n,l,a){var s=Wo(l[1]-n[1]),u=Wo(l[0]-n[0]),h=Wo(n[1]),v=Wo(l[1]),m=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(h)*Math.cos(v);return gs(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),a="meters")}function Su(n){var l=Math.PI/180,a=85.0511287798,s=6378137,u=Math.max(Math.min(a,n[1]),-a),h=Math.sin(u*l),v=s*n[0]*l,m=s*Math.log((1+h)/(1-h))/2;return[v,m]}function fu(n,l){var a=Math.abs(n[1][1]-n[0][1])*l,s=Math.abs(n[1][0]-n[0][0])*l;return[[n[0][0]-s,n[0][1]-a],[n[1][0]+s,n[1][1]+a]]}function Sl(n,l){return n[0][0]<=l[0][0]&&n[0][1]<=l[0][1]&&n[1][0]>=l[1][0]&&n[1][1]>=l[1][1]}function Qi(n){return[[n[0],n[1]],[n[2],n[3]]]}function ki(n){var l=Ef(n,[0,0]);return[n[0]/l,n[1]/l]}function Ef(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function Ju(n,l){return n[0]*l[0]+n[1]*l[1]}function Cu(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Vu(n,l){return Math.acos(Ju(n,l)/(Cu(n)*Cu(l)))*180/Math.PI}function gc(n,l){return l[0]>0?l[1]>0?90-Math.atan(l[1]/l[0])*180/Math.PI:90+Math.atan(-l[1]/l[0])*180/Math.PI:l[1]<0?180+(90-Math.atan(l[1]/l[0])*180/Math.PI):270+Math.atan(l[1]/-l[0])*180/Math.PI}function ud(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!n||n.length<2)){for(var a=[0,1],s=0,u=[],h=0;h<n.length-1;h++){var v=n[h],m=n[h+1],w=Ef(v,m);s+=w;var A=[v[0]-m[0],v[1]-m[1]],R=gc(a,A);if(h>0){var B=u[h-1].rotation;B-R>360-B+R&&(R=R+360)}u.push({start:v,end:m,dis:w,rotation:R,duration:0})}return u.map(function(G){G.duration=l*(G.dis/s)}),u}}function zl(n){if(Wf(n[0]))return n;if(Wf(n[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(Wf(n[0][0][0])){var l=n,a=0,s=0,u=0;return l.forEach(function(h){h.forEach(function(v){a+=v[0],s+=v[1],u++})}),[a/u,s/u,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Do(n){for(var l=n[0],a=n[1],s=n[0],u=n[1],h=0,v=0,m=0,w=0;w<n.length;w+=2){var A=n[w],R=n[w+1];A&&R&&(l=Math.max(A,l),a=Math.max(R,a),s=Math.min(A,s),u=Math.min(R,u),h+=A,v+=R,m++)}return{center:[h/m,v/m],radius:Math.sqrt(Math.pow(l-s,2)+Math.pow(a-u,2))/2}}function rs(n){return wu(gf([tf(n)]))}var ld=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,a=arguments.length>1?arguments[1]:void 0;(0,pt.Z)(this,n),this.limit=l,this.destroy=a||this.defaultDestroy,this.order=[],this.clear()}return(0,et.Z)(n,[{key:"clear",value:function(){var a=this;this.order.forEach(function(s){a.delete(s)}),this.cache={},this.order=[]}},{key:"get",value:function(a){var s=this.cache[a];return s&&(this.deleteOrder(a),this.appendOrder(a)),s}},{key:"set",value:function(a,s){this.cache[a]?(this.delete(a),this.cache[a]=s,this.appendOrder(a)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[a]=s,this.appendOrder(a))}},{key:"delete",value:function(a){var s=this.cache[a];s&&(this.deleteCache(a),this.deleteOrder(a),this.destroy(s,a))}},{key:"deleteCache",value:function(a){delete this.cache[a]}},{key:"deleteOrder",value:function(a){var s=this.order.findIndex(function(u){return u===a});s>=0&&this.order.splice(s,1)}},{key:"appendOrder",value:function(a){this.order.push(a)}},{key:"defaultDestroy",value:function(a,s){return null}}]),n}();function $f(n,l){n.forEach(function(a){l[a]&&(l[a]=l[a].bind(l))})}var Cl=null;function il(n,l,a){n.prototype=l.prototype=a,a.constructor=n}function va(n,l){var a=Object.create(n.prototype);for(var s in l)a[s]=l[s];return a}function Ul(){}var vl=.7,wf=1/vl,ac="\\s*([+-]?\\d+)\\s*",Lc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",mh=/^#([0-9a-f]{3,8})$/,qf=new RegExp("^rgb\\("+[ac,ac,ac]+"\\)$"),cd=new RegExp("^rgb\\("+[Zl,Zl,Zl]+"\\)$"),Sf=new RegExp("^rgba\\("+[ac,ac,ac,Lc]+"\\)$"),Cf=new RegExp("^rgba\\("+[Zl,Zl,Zl,Lc]+"\\)$"),Mp=new RegExp("^hsl\\("+[Lc,Zl,Zl]+"\\)$"),Af=new RegExp("^hsla\\("+[Lc,Zl,Zl,Lc]+"\\)$"),Al={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};il(Ul,oc,{copy:function(n){return Object.assign(new this.constructor,this,n)},displayable:function(){return this.rgb().displayable()},hex:Gh,formatHex:Gh,formatHsl:Hh,formatRgb:Ip,toString:Ip});function Gh(){return this.rgb().formatHex()}function Hh(){return ie(this).formatHsl()}function Ip(){return this.rgb().formatRgb()}function oc(n){var l,a;return n=(n+"").trim().toLowerCase(),(l=mh.exec(n))?(a=l[1].length,l=parseInt(l[1],16),a===6?x(l):a===3?new U(l>>8&15|l>>4&240,l>>4&15|l&240,(l&15)<<4|l&15,1):a===8?C(l>>24&255,l>>16&255,l>>8&255,(l&255)/255):a===4?C(l>>12&15|l>>8&240,l>>8&15|l>>4&240,l>>4&15|l&240,((l&15)<<4|l&15)/255):null):(l=qf.exec(n))?new U(l[1],l[2],l[3],1):(l=cd.exec(n))?new U(l[1]*255/100,l[2]*255/100,l[3]*255/100,1):(l=Sf.exec(n))?C(l[1],l[2],l[3],l[4]):(l=Cf.exec(n))?C(l[1]*255/100,l[2]*255/100,l[3]*255/100,l[4]):(l=Mp.exec(n))?Ut(l[1],l[2]/100,l[3]/100,1):(l=Af.exec(n))?Ut(l[1],l[2]/100,l[3]/100,l[4]):Al.hasOwnProperty(n)?x(Al[n]):n==="transparent"?new U(NaN,NaN,NaN,0):null}function x(n){return new U(n>>16&255,n>>8&255,n&255,1)}function C(n,l,a,s){return s<=0&&(n=l=a=NaN),new U(n,l,a,s)}function E(n){return n instanceof Ul||(n=oc(n)),n?(n=n.rgb(),new U(n.r,n.g,n.b,n.opacity)):new U}function M(n,l,a,s){return arguments.length===1?E(n):new U(n,l,a,s==null?1:s)}function U(n,l,a,s){this.r=+n,this.g=+l,this.b=+a,this.opacity=+s}il(U,M,va(Ul,{brighter:function(n){return n=n==null?wf:Math.pow(wf,n),new U(this.r*n,this.g*n,this.b*n,this.opacity)},darker:function(n){return n=n==null?vl:Math.pow(vl,n),new U(this.r*n,this.g*n,this.b*n,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:H,formatHex:H,formatRgb:$,toString:$}));function H(){return"#"+ht(this.r)+ht(this.g)+ht(this.b)}function $(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(n===1?")":", "+n+")")}function ht(n){return n=Math.max(0,Math.min(255,Math.round(n)||0)),(n<16?"0":"")+n.toString(16)}function Ut(n,l,a,s){return s<=0?n=l=a=NaN:a<=0||a>=1?n=l=NaN:l<=0&&(n=NaN),new De(n,l,a,s)}function ie(n){if(n instanceof De)return new De(n.h,n.s,n.l,n.opacity);if(n instanceof Ul||(n=oc(n)),!n)return new De;if(n instanceof De)return n;n=n.rgb();var l=n.r/255,a=n.g/255,s=n.b/255,u=Math.min(l,a,s),h=Math.max(l,a,s),v=NaN,m=h-u,w=(h+u)/2;return m?(l===h?v=(a-s)/m+(a<s)*6:a===h?v=(s-l)/m+2:v=(l-a)/m+4,m/=w<.5?h+u:2-h-u,v*=60):m=w>0&&w<1?0:v,new De(v,m,w,n.opacity)}function Be(n,l,a,s){return arguments.length===1?ie(n):new De(n,l,a,s==null?1:s)}function De(n,l,a,s){this.h=+n,this.s=+l,this.l=+a,this.opacity=+s}il(De,Be,va(Ul,{brighter:function(n){return n=n==null?wf:Math.pow(wf,n),new De(this.h,this.s,this.l*n,this.opacity)},darker:function(n){return n=n==null?vl:Math.pow(vl,n),new De(this.h,this.s,this.l*n,this.opacity)},rgb:function(){var n=this.h%360+(this.h<0)*360,l=isNaN(n)||isNaN(this.s)?0:this.s,a=this.l,s=a+(a<.5?a:1-a)*l,u=2*a-s;return new U(Ne(n>=240?n-240:n+120,u,s),Ne(n,u,s),Ne(n<120?n+240:n-120,u,s),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(n===1?")":", "+n+")")}}));function Ne(n,l,a){return(n<60?l+(a-l)*n/60:n<180?a:n<240?l+(a-l)*(240-n)/60:l)*255}function fr(n){return typeof n=="string"?!!d3.color(n):!1}function $e(n){var l=oc(n),a=[0,0,0,0];return l!=null&&(a[0]=l.r/255,a[1]=l.g/255,a[2]=l.b/255,a[3]=l.opacity),a}function _r(n){var l=n&&n[0],a=n&&n[1],s=n&&n[2],u=l+a*256+s*65536-1;return u}function er(n){return[n+1&255,n+1>>8&255,n+1>>8>>8&255]}function Er(n){var l=Ga.document.createElement("canvas"),a=l.getContext("2d");l.width=256,l.height=1;for(var s=null,u=a.createLinearGradient(0,0,256,1),h=n.positions[0],v=n.positions[n.positions.length-1],m=0;m<n.colors.length;++m){var w=(n.positions[m]-h)/(v-h);u.addColorStop(w,n.colors[m])}if(a.fillStyle=u,a.fillRect(0,0,256,1),Ms)return s=new Uint8ClampedArray(a.getImageData(0,0,256,1).data),l=null,a=null,{data:s,width:256,height:1};s=a.getImageData(0,0,256,1).data;for(var A=a.createImageData(256,1),R=0;R<A.data.length;R+=4)A.data[R+0]=s[R+0],A.data[R+1]=s[R+1],A.data[R+2]=s[R+2],A.data[R+3]=s[R+3];return l=null,a=null,A}function Or(n,l){var a=Ga.document.createElement("canvas"),s=a.getContext("2d");a.width=256,a.height=1;for(var u=s.createLinearGradient(0,0,256,1),h=l[1]-l[0],v=0;v<n.colors.length;++v){var m=Math.max((n.positions[v]-l[0])/h,0);console.log(m),u.addColorStop(m,n.colors[v])}s.fillStyle=u,s.fillRect(0,0,256,1);var w=s.getImageData(0,0,256,1).data,A=_n(s,w);return a=null,s=null,A}function Yr(n){var l=Ga.document.createElement("canvas"),a=l.getContext("2d");l.width=256,l.height=1;var s=a.createImageData(256,1);return s.data.fill(0),n.positions.forEach(function(u,h){var v=$e(n.colors[h]);s.data[u*4+0]=v[0]*255,s.data[u*4+1]=v[1]*255,s.data[u*4+2]=v[2]*255,s.data[u*4+3]=v[3]*255}),l=null,a=null,s}function gn(n){var l=Ga.document.createElement("canvas"),a=l.getContext("2d");a.globalAlpha=1,l.width=256,l.height=1;for(var s=256/n.colors.length,u=0;u<n.colors.length;u++)a.beginPath(),a.lineWidth=2,a.strokeStyle=n.colors[u],a.moveTo(u*s,0),a.lineTo((u+1)*s,0),a.stroke();var h=a.getImageData(0,0,256,1).data,v=_n(a,h);return l=null,a=null,v}function vn(n,l){var a=Ga.document.createElement("canvas"),s=a.getContext("2d");s.globalAlpha=1,a.width=256,a.height=1;var u=l[1]-l[0];n.positions.length-n.colors.length!==1&&console.warn("positions \u7684\u6570\u5B57\u4E2A\u6570\u5E94\u5F53\u6BD4 colors \u7684\u6837\u5F0F\u591A\u4E00\u4E2A,poisitions \u7684\u9996\u5C3E\u503C\u4E00\u822C\u4E3A\u6570\u636E\u7684\u6700\u5927\u6700\u65B0\u503C");for(var h=0;h<n.colors.length;h++)s.beginPath(),s.lineWidth=2,s.strokeStyle=n.colors[h],s.moveTo((n.positions[h]-l[0])/u*255,0),s.lineTo((n.positions[h+1]-l[0])/u*255,0),s.stroke();var v=s.getImageData(0,0,256,1).data,m=_n(s,v);return a=null,s=null,m}function _n(n,l){for(var a=n.createImageData(256,1),s=0;s<a.data.length;s+=4)a.data[s+0]=l[s+0],a.data[s+1]=l[s+1],a.data[s+2]=l[s+2],a.data[s+3]=l[s+3];return a}function Un(n){switch(n.type){case"cat":return[0,255];default:}}var ui;(function(n){n.CENTER="center",n.TOP="top",n["TOP-LEFT"]="top-left",n["TOP-RIGHT"]="top-right",n.BOTTOM="bottom",n["BOTTOM-LEFT"]="bottom-left",n["BOTTOM-RIGHT"]="bottom-right",n.LEFT="left",n.RIGHT="right"})(ui||(ui={}));var oi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Ri(n,l,a){var s=n.classList;for(var u in oi)oi.hasOwnProperty(u)&&s.remove("l7-".concat(a,"-anchor-").concat(u));s.add("l7-".concat(a,"-anchor-").concat(l))}function Di(n,l){return{enable:n,mask:255,func:{cmp:514,ref:l?1:0,mask:255}}}function ia(n,l){if(!n)throw new Error(l||"web worker helper assertion failed.")}var na={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},co=na.self||na.window||{},Bi=na.window||na.self||{},Pa=na.self||na.window||{},Ra=na.document||{},Aa=typeof importScripts=="function",ya=typeof window!="undefined"&&typeof window.orientation!="undefined",Ba=function(){function n(l,a){var s=this;this.name=l,this.workerThread=a,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(u,h){s.resolve=u,s.reject=h})}return n.prototype.postMessage=function(l,a){this.workerThread.postMessage({source:"Main thread",type:l,payload:a})},n.prototype.done=function(l){ia(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(l)},n.prototype.error=function(l){ia(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(l)},n}(),Ea=Ba,ca=new Map;function Ys(n){ia(n.source&&!n.url||!n.source&&n.url);var l=ca.get(n.source||n.url);return l||(n.url&&(l=xs(n.url),ca.set(n.url,l)),n.source&&(l=ru(n.source),ca.set(n.source,l))),ia(l),l}function xs(n){if(!n.startsWith("http"))return n;var l=hu(n);return ru(l)}function ru(n){var l=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(l)}function hu(n){return`try {
  importScripts('`+n+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function Ko(n,l,a){l===void 0&&(l=!0);var s=a||new Set;if(n){if(bs(n))s.add(n);else if(bs(n.buffer))s.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(l&&typeof n=="object")for(var u in n)Ko(n[u],l,s)}}return a===void 0?Array.from(s):[]}function bs(n){return n?n instanceof ArrayBuffer||typeof MessagePort!="undefined"&&n instanceof MessagePort||typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&n instanceof OffscreenCanvas:!1}var Au=function(){},nu=function(){function n(l){this.terminated=!1,this.loadableURL="";var a=l.name,s=l.source,u=l.url;ia(s||u),this.name=a,this.source=s,this.url=u,this.onMessage=Au,this.onError=function(h){return console.log(h)},this.worker=this.createBrowserWorker()}return n.isSupported=function(){return typeof Worker!="undefined"},n.prototype.destroy=function(){this.onMessage=Au,this.onError=Au,this.worker.terminate(),this.terminated=!0},Object.defineProperty(n.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),n.prototype.postMessage=function(l,a){a=a||Ko(l),this.worker.postMessage(l,a)},n.prototype.getErrorFromErrorEvent=function(l){var a="Failed to load ";return a+="worker "+this.name+" from "+this.url+". ",l.message&&(a+=l.message+" in "),l.lineno&&(a+=":"+l.lineno+":"+l.colno),new Error(a)},n.prototype.createBrowserWorker=function(){var l=this;this.loadableURL=Ys({source:this.source,url:this.url});var a=new Worker(this.loadableURL,{name:this.name});return a.onmessage=function(s){s.data?l.onMessage(s.data):l.onError(new Error("No data received"))},a.onerror=function(s){l.onError(l.getErrorFromErrorEvent(s)),l.terminated=!0},a.onmessageerror=function(s){return console.error("worker "+l.name+", message error: "+s)},a},n}(),mc=nu,pu=function(){return pu=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(n[u]=l[u])}return n},pu.apply(this,arguments)},Vl=function(n,l,a,s){function u(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(R){try{A(s.next(R))}catch(B){v(B)}}function w(R){try{A(s.throw(R))}catch(B){v(B)}}function A(R){R.done?h(R.value):u(R.value).then(m,w)}A((s=s.apply(n,l||[])).next())})},Tl=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,u,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(R){return w([A,R])}}function w(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,u&&(h=A[0]&2?u.return:A[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,A[1])).done)return h;switch(u=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,u=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(R){A=[6,R],u=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Kf=function(){function n(l){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=l.source,this.url=l.url,this.setProps(l)}return n.prototype.destroy=function(){this.idleQueue.forEach(function(l){return l.destroy()}),this.isDestroyed=!0},n.prototype.setProps=function(l){this.props=pu(pu({},this.props),l),l.name!==void 0&&(this.name=l.name),l.maxConcurrency!==void 0&&(this.maxConcurrency=l.maxConcurrency),l.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=l.maxMobileConcurrency),l.reuseWorkers!==void 0&&(this.reuseWorkers=l.reuseWorkers),l.onDebug!==void 0&&(this.onDebug=l.onDebug)},n.prototype.startJob=function(l,a,s){return a===void 0&&(a=function(u,h,v){return u.done(v)}),s===void 0&&(s=function(u,h){return u.error(h)}),Vl(this,void 0,void 0,function(){var u,h=this;return Tl(this,function(v){switch(v.label){case 0:return u=new Promise(function(m){return h.jobQueue.push({name:l,onMessage:a,onError:s,onStart:m}),h}),this.startQueuedJob(),[4,u];case 1:return[2,v.sent()]}})})},n.prototype.startQueuedJob=function(){return Vl(this,void 0,void 0,function(){var l,a,s;return Tl(this,function(u){switch(u.label){case 0:if(!this.jobQueue.length)return[2];if(l=this.getAvailableWorker(),!l)return[2];if(a=this.jobQueue.shift(),!a)return[3,4];this.onDebug({message:"Starting job",name:a.name,backlog:this.jobQueue.length,workerThread:l}),s=new Ea(a.name,l),l.onMessage=function(h){return a.onMessage(s,h.type,h.payload)},l.onError=function(h){return a.onError(s,h)},a.onStart(s),u.label=1;case 1:return u.trys.push([1,,3,4]),[4,s.result];case 2:return u.sent(),[3,4];case 3:return this.returnWorkerToQueue(l),[7];case 4:return[2]}})})},n.prototype.returnWorkerToQueue=function(l){var a=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();a?(l.destroy(),this.count--):this.idleQueue.push(l),this.isDestroyed||this.startQueuedJob()},n.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var l=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new mc({name:l,source:this.source,url:this.url})}return null},n.prototype.getMaxConcurrency=function(){return ya?this.maxMobileConcurrency:this.maxConcurrency},n}(),Qf=Kf,Ml=function(){return Ml=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(n[u]=l[u])}return n},Ml.apply(this,arguments)},Tf=function(n){var l=typeof Symbol=="function"&&Symbol.iterator,a=l&&n[l],s=0;if(a)return a.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")},yh={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},sc=function(){function n(l){this.workerPools=new Map,this.props=Ml({},yh),this.setProps(l),this.workerPools=new Map}return n.isSupported=function(){return mc.isSupported()},n.getWorkerFarm=function(l){return l===void 0&&(l={}),n.workerFarm=n.workerFarm||new n({}),n.workerFarm.setProps(l),n.workerFarm},n.prototype.destroy=function(){var l,a;try{for(var s=Tf(this.workerPools.values()),u=s.next();!u.done;u=s.next()){var h=u.value;h.destroy()}}catch(v){l={error:v}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(l)throw l.error}}},n.prototype.setProps=function(l){var a,s;this.props=Ml(Ml({},this.props),l);try{for(var u=Tf(this.workerPools.values()),h=u.next();!h.done;h=u.next()){var v=h.value;v.setProps(this.getWorkerPoolProps())}}catch(m){a={error:m}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(a)throw a.error}}},n.prototype.getWorkerPool=function(l){var a=l.name,s=l.source,u=l.url,h=this.workerPools.get(a);return h||(h=new Qf({name:a,source:s,url:u}),h.setProps(this.getWorkerPoolProps()),this.workerPools.set(a,h)),h},n.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},n}(),Jf=sc,Il=new Map,Rs=function(){function n(){}return Object.defineProperty(n,"onmessage",{set:function(l){self.onmessage=function(a){if(uc(a)){var s=a.data,u=s.type,h=s.payload;l(u,h)}}},enumerable:!1,configurable:!0}),n.addEventListener=function(l){var a=Il.get(l);a||(a=function(s){if(uc(s)){var u=s.data,h=u.type,v=u.payload;l(h,v)}}),self.addEventListener("message",a)},n.removeEventListener=function(l){var a=Il.get(l);Il.delete(l),self.removeEventListener("message",a)},n.postMessage=function(l,a){if(self){var s={source:"Worker thread",type:l,payload:a},u=Ko(a);self.postMessage(s,u)}},n}(),iu=Rs;function uc(n){var l=n.type,a=n.data;return l==="message"&&a&&typeof a.source=="string"&&a.source==="Main thread"}function Pc(n){return JSON.parse(Eo(n))}function Eo(n){var l=new Set;return JSON.stringify(n,function(a,s){if(typeof s=="object"&&s!==null){if(l.has(s))try{return JSON.parse(JSON.stringify(s))}catch(u){return}l.add(s)}return s})}function Gl(n){return""+n.name}function al(n,l){l===void 0&&(l={});var a=l[n.id]||{},s=n.name+".worker.js",u=a.workerUrl;return l._workerType==="test"&&(u=n.module+"/dist/"+s),u||(u="https://unpkg.com/"+n.module+"/dist/"+s),assert(u),u}var Oc=function(n,l,a,s){function u(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(R){try{A(s.next(R))}catch(B){v(B)}}function w(R){try{A(s.throw(R))}catch(B){v(B)}}function A(R){R.done?h(R.value):u(R.value).then(m,w)}A((s=s.apply(n,l||[])).next())})},th=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,u,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(R){return w([A,R])}}function w(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,u&&(h=A[0]&2?u.return:A[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,A[1])).done)return h;switch(u=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,u=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(R){A=[6,R],u=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};function kp(n,l){return WorkerFarm.isSupported()?n.worker&&(l==null?void 0:l.worker):!1}function fd(n,l,a,s){return a===void 0&&(a={}),s===void 0&&(s={}),Oc(this,void 0,void 0,function(){var u,h,v,m,w,A,R,B;return th(this,function(G){switch(G.label){case 0:return u=getWorkerName(n),h=getWorkerURL(n,a),v=WorkerFarm.getWorkerFarm(a),m=v.getWorkerPool({name:u,url:h}),w=a.jobName||n.name,[4,m.startJob(w,au.bind(null,s))];case 1:return A=G.sent(),R=removeNontransferableOptions(a),A.postMessage("process",{input:l,options:R}),[4,A.result];case 2:return B=G.sent(),[2,B.result]}})})}function au(n,l,a,s){return Oc(this,void 0,void 0,function(){var u,h,v,m,w,A,R;return th(this,function(B){switch(B.label){case 0:switch(u=a,u){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return l.done(s),[3,9];case 2:return l.error(new Error(s.error)),[3,9];case 3:h=s.id,v=s.input,m=s.options,B.label=4;case 4:return B.trys.push([4,6,,7]),n.process?[4,n.process(v,m)]:(l.postMessage("error",{id:h,error:"Worker not set up to process on main thread"}),[2]);case 5:return w=B.sent(),l.postMessage("done",{id:h,result:w}),[3,7];case 6:return A=B.sent(),R=A instanceof Error?A.message:"unknown error",l.postMessage("error",{id:h,error:R}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+a),B.label=9;case 9:return[2]}})})}var kl=function(){function n(){this._values=[],this._settlers=[],this._closed=!1}return n.prototype[Symbol.asyncIterator]=function(){return this},n.prototype.push=function(l){return this.enqueue(l)},n.prototype.enqueue=function(l){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var a=this._settlers.shift();l instanceof Error?a.reject(l):a.resolve({value:l})}else this._values.push(l)},n.prototype.close=function(){for(;this._settlers.length>0;){var l=this._settlers.shift();l.resolve({done:!0})}this._closed=!0},n.prototype.next=function(){var l=this;if(this._values.length>0){var a=this._values.shift();return a instanceof Error?Promise.reject(a):Promise.resolve({done:!1,value:a})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(s,u){l._settlers.push({resolve:s,reject:u})})},n}(),ol=kl,yc=function(n,l,a,s){function u(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(R){try{A(s.next(R))}catch(B){v(B)}}function w(R){try{A(s.throw(R))}catch(B){v(B)}}function A(R){R.done?h(R.value):u(R.value).then(m,w)}A((s=s.apply(n,l||[])).next())})},Mf=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,u,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(R){return w([A,R])}}function w(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,u&&(h=A[0]&2?u.return:A[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,A[1])).done)return h;switch(u=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,u=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(R){A=[6,R],u=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Ll=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=n[Symbol.asyncIterator],a;return l?l.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a);function s(h){a[h]=n[h]&&function(v){return new Promise(function(m,w){v=n[h](v),u(m,w,v.done,v.value)})}}function u(h,v,m,w){Promise.resolve(w).then(function(A){h({value:A,done:m})},v)}},ou=0,Fc,_h;function _c(n,l){var a=this;if(typeof self!="undefined"){var s={process:hd};iu.onmessage=function(u,h){return yc(a,void 0,void 0,function(){var v,m,w,A,R,B,G,j,lt,ct,_t;return Mf(this,function(Zt){switch(Zt.label){case 0:switch(Zt.trys.push([0,19,,20]),v=u,v){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!n)throw new Error("Worker does not support atomic processing");return[4,n(h.input,h.options||{},s)];case 2:return m=Zt.sent(),iu.postMessage("done",{result:m}),[3,18];case 3:if(!l)throw new Error("Worker does not support batched processing");Fc=new ol,_h=h.options||{},w=l(Fc,_h,s),Zt.label=4;case 4:Zt.trys.push([4,9,10,15]),A=Ll(w),Zt.label=5;case 5:return[4,A.next()];case 6:if(R=Zt.sent(),!!R.done)return[3,8];B=R.value,iu.postMessage("output-batch",{result:B}),Zt.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return G=Zt.sent(),ct={error:G},[3,15];case 10:return Zt.trys.push([10,,13,14]),R&&!R.done&&(_t=A.return)?[4,_t.call(A)]:[3,12];case 11:Zt.sent(),Zt.label=12;case 12:return[3,14];case 13:if(ct)throw ct.error;return[7];case 14:return[7];case 15:return iu.postMessage("done",{}),[3,18];case 16:return Fc.push(h.input),[3,18];case 17:return Fc.close(),[3,18];case 18:return[3,20];case 19:return j=Zt.sent(),lt=j instanceof Error?j.message:"",iu.postMessage("error",{error:lt}),[3,20];case 20:return[2]}})})}}}function hd(n,l){return l===void 0&&(l={}),new Promise(function(a,s){var u=ou++,h=function(m,w){if(w.id===u)switch(m){case"done":iu.removeEventListener(h),a(w.result);break;case"error":iu.removeEventListener(h),s(w.error);break;default:}};iu.addEventListener(h);var v={id:u,input:n,options:l};iu.postMessage("process",v)})}var rv=function(n,l,a,s){function u(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(R){try{A(s.next(R))}catch(B){v(B)}}function w(R){try{A(s.throw(R))}catch(B){v(B)}}function A(R){R.done?h(R.value):u(R.value).then(m,w)}A((s=s.apply(n,l||[])).next())})},nv=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,u,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(R){return w([A,R])}}function w(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,u&&(h=A[0]&2?u.return:A[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,A[1])).done)return h;switch(u=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,u=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(R){A=[6,R],u=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},If={};function pd(n,l,a){return l===void 0&&(l=null),a===void 0&&(a={}),rv(this,void 0,void 0,function(){return nv(this,function(s){switch(s.label){case 0:return l&&(n=iv(n,l,a)),If[n]=If[n]||W0(n),[4,If[n]];case 1:return[2,s.sent()]}})})}function iv(n,l,a){if(n.startsWith("http"))return n;var s=a.modules||{};return s[n]?s[n]:a.CDN?(assert(a.CDN.startsWith("http")),a.CDN+"/"+l+"/dist/libs/"+n):isWorker?"../src/libs/"+n:"modules/"+l+"/src/libs/"+n}function W0(n){return rv(this,void 0,void 0,function(){var l,a,s;return nv(this,function(u){switch(u.label){case 0:return n.endsWith("wasm")?[4,fetch(n)]:[3,3];case 1:return l=u.sent(),[4,l.arrayBuffer()];case 2:return[2,u.sent()];case 3:return isWorker?[2,importScripts(n)]:[4,fetch(n)];case 4:return a=u.sent(),[4,a.text()];case 5:return s=u.sent(),[2,eh(s,n)]}})})}function eh(n,l){if(isWorker)return eval.call(global,n),null;var a=document.createElement("script");a.id=l;try{a.appendChild(document.createTextNode(n))}catch(s){a.text=n}return document.body.appendChild(a),null}var dd="0.0.3",Og={id:"null",name:"null",module:"web-worker-helper",options:{}};function xh(n){var l=n.color;return!l||!l.length?[1,1,1,1]:l}function bh(n,l,a){return a.length===2?[a[0],a[1],0]:[a[0],a[1],a[2]]}function Lp(n){var l=n.filter;return l?[1]:[0]}function Qv(n,l){return[l]}var Fg=nt(89675),rh=nt.n(Fg),ei=nt(1153),av=ei.Ue(),ov=ei.Ue(),Tu=ei.Ue(),ls=ei.Ue(),Eh=ei.Ue();function sv(n,l,a,s,u){ei.IH(n,a,s),ei.Fv(n,n),l=ei.al(-n[1],n[0]);var h=ei.al(-a[1],a[0]);return[u/ei.AK(l,h),l]}function af(n,l){return ei.t8(n,-l[1],l[0])}function Rc(n,l,a){return ei.lu(n,l,a),ei.Fv(n,n),n}function jh(n,l){return n[0]===l[0]&&n[1]===l[1]}function Jv(n){for(var l=new Map,a=0;a<n.length;a++){var s=n[0].toString()+"-"+n[1].toString();l.get(s)?(n.splice(a,1),a++):l.set(s,s)}return n}var vd=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,pt.Z)(this,n),(0,W.Z)(this,"lastFlip",-1),(0,W.Z)(this,"miter",ei.al(0,0)),(0,W.Z)(this,"started",!1),(0,W.Z)(this,"dash",!1),(0,W.Z)(this,"totalDistance",0),(0,W.Z)(this,"currentIndex",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,et.Z)(n,[{key:"extrude_gaode2",value:function(a,s){var u=this.complex;if(a.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=u.startIndex,m=1;m<h;m++){var w,A,R,B=a[m-1];B.push((w=s[m-1][2])!==null&&w!==void 0?w:0);var G=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var lt=s[m],ct=m<a.length-1?[].concat((0,ve.Z)(a[m+1]),[(R=s[m+1][2])!==null&&R!==void 0?R:0]):null,_t=m<s.length-1?s[m+1]:null,Zt=this.segment_gaode2(u,v,B,j,ct,G,lt,_t);v+=Zt}if(this.dash)for(var pe=0;pe<u.positions.length/6;pe++)u.positions[pe*6+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"simpleExtrude_gaode2",value:function(a,s){var u=this.complex;if(a.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=u.startIndex,m=1;m<h;m++){var w,A,R,B=a[m-1];B.push((w=s[m-1][2])!==null&&w!==void 0?w:0);var G=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var lt=s[m],ct=m<a.length-1?[].concat((0,ve.Z)(a[m+1]),[(R=s[m+1][2])!==null&&R!==void 0?R:0]):null,_t=m<s.length-1?s[m+1]:null,Zt=this.simpleSegment(u,v,B,j,ct,G,lt,_t);v+=Zt}if(this.dash)for(var pe=0;pe<u.positions.length/6;pe++)u.positions[pe*6+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"extrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var u=a.length,h=s.startIndex,v=1;v<u;v++){var m=a[v-1],w=a[v],A=v<a.length-1?a[v+1]:null,R=this.segment(s,h,m,w,A);h+=R}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleExtrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var u=a.length,h=s.startIndex,v=1;v<u;v++){var m=a[v-1],w=a[v],A=v<a.length-1?a[v+1]:null,R=this.simpleSegment(s,h,m,w,A);h+=R}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"segment_gaode2",value:function(a,s,u,h,v,m,w,A){var R=0,B=a.indices,G=a.positions,j=a.normals,lt=this.cap==="square",ct=this.join==="bevel",_t=mo([w[0],w[1]]),Zt=mo([m[0],m[1]]);Rc(Tu,h,u);var pe=0;if(this.dash&&(pe=this.lineSegmentDistance(_t,Zt),this.totalDistance+=pe),this.normal||(this.normal=ei.Ue(),af(this.normal,Tu)),!this.started)if(this.started=!0,lt){var fe=ei.Ue(),Ze=ei.Ue();ei.IH(fe,this.normal,Tu),ei.IH(Ze,this.normal,Tu),j.push(Ze[0],Ze[1],0),j.push(fe[0],fe[1],0),G.push(u[0],u[1],u[2]|0,this.totalDistance-pe,-this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),G.push(u[0],u[1],u[2]|0,this.totalDistance-pe,this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(G,j,u,this.normal,this.thickness,this.totalDistance-pe);if(B.push(s+0,s+1,s+2),v){jh(h,v)&&ei.IH(v,h,ei.Fv(v,ei.$X(v,h,u))),Rc(ls,v,h);var Lr=sv(Eh,ei.Ue(),Tu,ls,this.thickness),Vr=(0,yt.Z)(Lr,2),Wr=Vr[0],bn=Vr[1],hn=ei.AK(Eh,this.normal)<0?-1:1,Wn=ct;if(!Wn&&this.join==="miter"){var vi=Wr;vi>this.miterLimit&&(Wn=!0)}Wn?(j.push(this.normal[0],this.normal[1],0),j.push(bn[0],bn[1],0),G.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*hn,h[2]|0),this.complex.indexes.push(this.currentIndex),G.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*hn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,B.push.apply(B,(0,ve.Z)(this.lastFlip!==-hn?[s,s+2,s+3]:[s+2,s+1,s+3])),B.push(s+2,s+3,s+4),af(av,ls),ei.JG(this.normal,av),j.push(this.normal[0],this.normal[1],0),G.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*hn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,R+=3):(this.extrusions(G,j,h,bn,Wr,this.totalDistance),B.push.apply(B,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),hn=-1,ei.JG(this.normal,bn),R+=2),this.lastFlip=hn}else{if(af(this.normal,Tu),lt){var Qe=ei.Ue(),wr=ei.Ue();ei.lu(wr,Tu,this.normal),ei.IH(Qe,Tu,this.normal),j.push(wr[0],wr[1],0),j.push(Qe[0],Qe[1],0),G.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),G.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(G,j,h,this.normal,this.thickness,this.totalDistance);B.push.apply(B,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),R+=2}return R}},{key:"simpleSegment",value:function(a,s,u,h,v){var m=0,w=a.indices,A=a.positions,R=a.normals,B=mo([h[0],h[1]]),G=mo([u[0],u[1]]);Rc(Tu,B,G);var j=0;if(this.dash&&(j=this.lineSegmentDistance(B,G),this.totalDistance+=j),this.normal||(this.normal=ei.Ue(),af(this.normal,Tu)),this.started||(this.started=!0,this.extrusions(A,R,u,this.normal,this.thickness,this.totalDistance-j)),w.push(s+0,s+1,s+2),!v)af(this.normal,Tu),this.extrusions(A,R,h,this.normal,this.thickness,this.totalDistance),w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2;else{var lt=mo([v[0],v[1]]);jh(B,lt)&&ei.IH(lt,B,ei.Fv(lt,ei.$X(lt,B,G))),Rc(ls,lt,B);var ct=sv(Eh,ei.Ue(),Tu,ls,this.thickness),_t=(0,yt.Z)(ct,2),Zt=_t[0],pe=_t[1],fe=ei.AK(Eh,this.normal)<0?-1:1;this.extrusions(A,R,h,pe,Zt,this.totalDistance),w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fe=-1,ei.JG(this.normal,pe),m+=2,this.lastFlip=fe}return m}},{key:"segment",value:function(a,s,u,h,v){var m=0,w=a.indices,A=a.positions,R=a.normals,B=this.cap==="square",G=this.join==="bevel",j=mo([h[0],h[1]]),lt=mo([u[0],u[1]]);Rc(Tu,j,lt);var ct=0;if(this.dash&&(ct=this.lineSegmentDistance(j,lt),this.totalDistance+=ct),this.normal||(this.normal=ei.Ue(),af(this.normal,Tu)),!this.started)if(this.started=!0,B){var _t=ei.Ue(),Zt=ei.Ue();ei.IH(_t,this.normal,Tu),ei.IH(Zt,this.normal,Tu),R.push(Zt[0],Zt[1],0),R.push(_t[0],_t[1],0),A.push(u[0],u[1],u[2]|0,this.totalDistance-ct,-this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),A.push(u[0],u[1],u[2]|0,this.totalDistance-ct,this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,R,u,this.normal,this.thickness,this.totalDistance-ct);if(w.push(s+0,s+1,s+2),v){var Ze=mo([v[0],v[1]]);jh(j,Ze)&&ei.IH(Ze,j,ei.Fv(Ze,ei.$X(Ze,j,lt))),Rc(ls,Ze,j);var Qe=sv(Eh,ei.Ue(),Tu,ls,this.thickness),wr=(0,yt.Z)(Qe,2),Lr=wr[0],Vr=wr[1],Wr=ei.AK(Eh,this.normal)<0?-1:1,bn=G;if(!bn&&this.join==="miter"){var hn=Lr;hn>this.miterLimit&&(bn=!0)}bn?(R.push(this.normal[0],this.normal[1],0),R.push(Vr[0],Vr[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Wr,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*Wr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,w.push.apply(w,(0,ve.Z)(this.lastFlip!==-Wr?[s,s+2,s+3]:[s+2,s+1,s+3])),w.push(s+2,s+3,s+4),af(av,ls),ei.JG(this.normal,av),R.push(this.normal[0],this.normal[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Wr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,m+=3):(this.extrusions(A,R,h,Vr,Lr,this.totalDistance),w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),Wr=-1,ei.JG(this.normal,Vr),m+=2),this.lastFlip=Wr}else{if(af(this.normal,Tu),B){var pe=ei.Ue(),fe=ei.Ue();ei.lu(fe,Tu,this.normal),ei.IH(pe,Tu,this.normal),R.push(fe[0],fe[1],0),R.push(pe[0],pe[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,R,h,this.normal,this.thickness,this.totalDistance);w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2}return m}},{key:"extrusions",value:function(a,s,u,h,v,m){s.push(h[0],h[1],0),s.push(h[0],h[1],0),a.push(u[0],u[1],u[2]|0,m,-v,u[2]|0),this.complex.indexes.push(this.currentIndex),a.push(u[0],u[1],u[2]|0,m,v,u[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(a,s){var u=s[0]-a[0],h=s[1]-a[1];return Math.sqrt(u*u+h*h)}}]),n}(),of=85.0511287798;function Wh(n){var l=n.coordinates,a=n.originCoordinates,s=n.version,u=new vd({dash:!0,join:"bevel"});if(s==="GAODE2.x"){var h=l;Array.isArray(h[0][0])||(h=[l]);var v=a;Array.isArray(v[0][0])||(v=[a]);for(var m=0;m<h.length;m++){var w=h[m],A=v[m];u.extrude_gaode2(w,A)}}else{var R=l;R[0]&&!Array.isArray(R[0][0])&&(R=[l]),R.forEach(function(G){u.extrude(G)})}var B=u.complex;return{vertices:B.positions,indices:B.indices,normals:B.normals,indexes:B.indexes,size:6}}function xc(n){var l=zl(n.coordinates);return{vertices:[].concat((0,ve.Z)(l),(0,ve.Z)(l),(0,ve.Z)(l),(0,ve.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function gd(n){var l=n.coordinates,a=rh().flatten(l),s=a.vertices,u=a.dimensions,h=a.holes,v=rh()(s,h,u);return{indices:v,vertices:s,size:u}}function nh(n,l){var a=l;return l>of&&(a=of),l<-of&&(a=-of),[Math.PI*n/180+Math.PI,Math.PI-Math.log(Math.tan(Math.PI*.25+Math.PI*a/180*.5))]}function t0(n,l){return[(n-Math.PI)*180/Math.PI,(Math.atan(Math.exp(Math.PI-l))-Math.PI*.25)*2*180/Math.PI]}var md=function(){var n=(0,J.Z)(ot().mark(function l(a){var s,u,h,v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=a.descriptors,u=a.features,h=a.enablePicking,v=a.iconMap,m={a_Color:xh,a_Position:bh,filter:Lp,a_vertexId:Qv,a_PickingColor:function(ct){var _t=ct.id;return h?er(_t):[0,0,0]},a_DistanceAndIndex:function(ct,_t,Zt,pe,fe,Ze){return Ze===void 0?[Zt[3],10]:[Zt[3],Ze]},a_Total_Distance:function(ct,_t,Zt){return[Zt[5]]},a_Size:function(ct){var _t=ct.size,Zt=_t===void 0?1:_t;return Array.isArray(Zt)?[Zt[0],Zt[1]]:[Zt,0]},a_Normal:function(ct,_t,Zt,pe,fe){return fe},a_Miter:function(ct,_t,Zt){return[Zt[4]]},a_iconMapUV:function(ct){var _t=ct.texture,Zt=v[_t]||{x:0,y:0},pe=Zt.x,fe=Zt.y;return[pe,fe]}},w={sizePerElement:0,elements:[]},A=0,R=[],B=3,u.forEach(function(lt,ct){var _t=Wh(lt),Zt=_t.indices,pe=_t.vertices,fe=_t.normals,Ze=_t.size,Qe=_t.indexes;Zt.forEach(function(Wr){R.push(Wr+A)}),B=Ze;var wr=pe.length/Ze;w.sizePerElement=B,w.elements.push({featureIdx:ct,vertices:pe,normals:fe,offset:A}),A+=wr;for(var Lr=function(bn){var hn=(fe==null?void 0:fe.slice(bn*3,bn*3+3))||[],Wn=pe.slice(bn*Ze,bn*Ze+Ze),vi=0;Qe&&Qe[bn]!==void 0&&(vi=Qe[bn]),s.forEach(function($i){if($i&&m[$i.name]){var go;(go=$i.buffer.data).push.apply(go,(0,ve.Z)(m[$i.name](lt,ct,Wn,bn,hn,vi)))}})},Vr=0;Vr<wr;Vr++)Lr(Vr)}),j.abrupt("return",{descriptors:s,featureLayout:w,indices:R});case 8:case"end":return j.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),uv=function(){var n=(0,J.Z)(ot().mark(function l(a){var s,u,h,v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=a.descriptors,u=a.features,h=a.enablePicking,v=a.shape2d,m={a_Color:xh,a_Position:bh,filter:Lp,a_vertexId:Qv,a_PickingColor:function(ct){var _t=ct.id;return h?er(_t):[0,0,0]},a_Shape:function(ct){var _t=ct.shape,Zt=_t===void 0?2:_t,pe=v.indexOf(Zt);return[pe]},a_Extrude:function(ct,_t,Zt,pe){var fe=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],Ze=pe%4*3;return[fe[Ze],fe[Ze+1],fe[Ze+2]]},a_Size:function(ct){var _t=ct.size,Zt=_t===void 0?5:_t;return Array.isArray(Zt)?[Zt[0]]:[Zt]}},w={sizePerElement:0,elements:[]},A=0,R=[],B=3,u.forEach(function(lt,ct){var _t=xc(lt),Zt=_t.indices,pe=_t.vertices,fe=_t.normals,Ze=_t.size,Qe=_t.indexes;Zt.forEach(function(Wr){R.push(Wr+A)}),B=Ze;var wr=pe.length/Ze;w.sizePerElement=B,w.elements.push({featureIdx:ct,vertices:pe,normals:fe,offset:A}),A+=wr;for(var Lr=function(bn){var hn=(fe==null?void 0:fe.slice(bn*3,bn*3+3))||[],Wn=pe.slice(bn*Ze,bn*Ze+Ze),vi=0;Qe&&Qe[bn]!==void 0&&(vi=Qe[bn]),s.forEach(function($i){if($i&&m[$i.name]){var go;(go=$i.buffer.data).push.apply(go,(0,ve.Z)(m[$i.name](lt,ct,Wn,bn,hn,vi)))}})},Vr=0;Vr<wr;Vr++)Lr(Vr)}),j.abrupt("return",{descriptors:s,featureLayout:w,indices:R});case 8:case"end":return j.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),Pp=function(){var n=(0,J.Z)(ot().mark(function l(a){var s,u,h,v,m,w,A,R;return ot().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return s=a.descriptors,u=a.features,h=a.enablePicking,v={a_Color:xh,a_Position:bh,filter:Lp,a_vertexId:Qv,a_PickingColor:function(lt){var ct=lt.id;return h?er(ct):[0,0,0]}},m={sizePerElement:0,elements:[]},w=0,A=[],R=3,u.forEach(function(j,lt){var ct=gd(j),_t=ct.indices,Zt=ct.vertices,pe=ct.normals,fe=ct.size,Ze=ct.indexes;_t.forEach(function(Vr){A.push(Vr+w)}),R=fe;var Qe=Zt.length/fe;m.sizePerElement=R,m.elements.push({featureIdx:lt,vertices:Zt,normals:pe,offset:w}),w+=Qe;for(var wr=function(Wr){var bn=(pe==null?void 0:pe.slice(Wr*3,Wr*3+3))||[],hn=Zt.slice(Wr*fe,Wr*fe+fe),Wn=0;Ze&&Ze[Wr]!==void 0&&(Wn=Ze[Wr]),s.forEach(function(vi){if(vi&&v[vi.name]){var $i;($i=vi.buffer.data).push.apply($i,(0,ve.Z)(v[vi.name](j,lt,hn,Wr,bn,Wn)))}})},Lr=0;Lr<Qe;Lr++)wr(Lr)}),G.abrupt("return",{descriptors:s,featureLayout:m,indices:A});case 8:case"end":return G.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),Xh={pointFill:uv,line:md,polygonFill:Pp},gl=(0,K.Z)({},Xh);function yd(n){return kf.apply(this,arguments)}function kf(){return kf=(0,J.Z)(ot().mark(function n(l){var a,s;return ot().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=l.workerType,s=l.data,!gl[a]){h.next=3;break}return h.abrupt("return",gl[a](s));case 3:return h.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(a,'" non-existent.'))));case 4:case"end":return h.stop()}},n)})),kf.apply(this,arguments)}_c(yd);var Op=new Map;function Fp(n,l){Op.set(n,l)}function _d(n){var l=Op.get(n);return l}var cs=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h={};function p(){}function v(){}function d(){}var y={};c(y,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(k([])));m&&m!==e&&n.call(m,a)&&(y=m);var x=d.prototype=p.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var r;o(this,"_invoke",{value:function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=A(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function A(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,h;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=d,o(x,"constructor",{value:d,configurable:!0}),o(d,"constructor",{value:v,configurable:!0}),v.displayName=c(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.call,L=P&&_.bind.bind(M,M),R=P?L:function(t){return function(){return M.apply(t,arguments)}},C=function(t){return null==t},N=TypeError,D=function(t){if(C(t))throw N("Can't call method on "+t);return t},F=Object,W=function(t){return F(D(t))},z=R({}.hasOwnProperty),B=Object.hasOwn||function(t,e){return z(W(t),e)},U=0,G=Math.random(),H=R(1..toString),V=function(t){return"Symbol("+(void 0===t?"":t)+")_"+H(++U+G,36)},q="object"==typeof document&&document.all,Z={all:q,IS_HTMLDDA:void 0===q&&void 0!==q},Y=Z.all,$=Z.IS_HTMLDDA?function(t){return"function"==typeof t||t===Y}:function(t){return"function"==typeof t},K=function(t){return $(t)?t:void 0},Q=function(t,e){return arguments.length<2?K(O[t]):O[t]&&O[t][e]},X=Q("navigator","userAgent")||"",J=O.process,tt=O.Deno,et=J&&J.versions||tt&&tt.version,rt=et&&et.v8;rt&&(E=(w=rt.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&X&&(!(w=X.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=X.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var nt=E,ot=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),it=ot&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,at=I("wks"),ut=O.Symbol,st=ut&&ut.for,ct=it?ut:ut&&ut.withoutSetter||V,ft=function(t){if(!B(at,t)||!ot&&"string"!=typeof at[t]){var e="Symbol."+t;ot&&B(ut,t)?at[t]=ut[t]:at[t]=it&&st?st(e):ct(e)}return at[t]},lt={};lt[ft("toStringTag")]="z";var ht="[object z]"===String(lt),pt=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),vt=Z.all,dt=Z.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:$(t)||t===vt}:function(t){return"object"==typeof t?null!==t:$(t)},yt=O.document,gt=dt(yt)&&dt(yt.createElement),mt=function(t){return gt?yt.createElement(t):{}},xt=!pt&&!j((function(){return 7!=Object.defineProperty(mt("div"),"a",{get:function(){return 7}}).a})),bt=pt&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),wt=String,Et=TypeError,At=function(t){if(dt(t))return t;throw Et(wt(t)+" is not an object")},Ot=Function.prototype.call,St=P?Ot.bind(Ot):function(){return Ot.apply(Ot,arguments)},Tt=R({}.isPrototypeOf),kt=Object,It=it?function(t){return"symbol"==typeof t}:function(t){var e=Q("Symbol");return $(e)&&Tt(e.prototype,kt(t))},jt=String,Pt=function(t){try{return jt(t)}catch(t){return"Object"}},_t=TypeError,Mt=function(t){if($(t))return t;throw _t(Pt(t)+" is not a function")},Lt=function(t,e){var r=t[e];return C(r)?void 0:Mt(r)},Rt=TypeError,Ct=TypeError,Nt=ft("toPrimitive"),Dt=function(t,e){if(!dt(t)||It(t))return t;var r,n=Lt(t,Nt);if(n){if(void 0===e&&(e="default"),r=St(n,t,e),!dt(r)||It(r))return r;throw Ct("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;if($(r=t.valueOf)&&!dt(n=St(r,t)))return n;if("string"!==e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;throw Rt("Can't convert object to primitive value")}(t,e)},Ft=function(t){var e=Dt(t,"string");return It(e)?e:e+""},Wt=TypeError,zt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,Ut={f:pt?bt?function(t,e,r){if(At(t),e=Ft(e),At(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Bt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return zt(t,e,r)}:zt:function(t,e,r){if(At(t),e=Ft(e),At(r),xt)try{return zt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Wt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Gt=Function.prototype,Ht=pt&&Object.getOwnPropertyDescriptor,Vt=B(Gt,"name"),qt={EXISTS:Vt,PROPER:Vt&&"something"===function(){}.name,CONFIGURABLE:Vt&&(!pt||pt&&Ht(Gt,"name").configurable)},Zt=R(Function.toString);$(k.inspectSource)||(k.inspectSource=function(t){return Zt(t)});var Yt,$t,Kt,Qt=k.inspectSource,Xt=O.WeakMap,Jt=$(Xt)&&/native code/.test(String(Xt)),te=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ee=pt?function(t,e,r){return Ut.f(t,e,te(1,r))}:function(t,e,r){return t[e]=r,t},re=I("keys"),ne=function(t){return re[t]||(re[t]=V(t))},oe={},ie=O.TypeError,ae=O.WeakMap;if(Jt||k.state){var ue=k.state||(k.state=new ae);ue.get=ue.get,ue.has=ue.has,ue.set=ue.set,Yt=function(t,e){if(ue.has(t))throw ie("Object already initialized");return e.facade=t,ue.set(t,e),e},$t=function(t){return ue.get(t)||{}},Kt=function(t){return ue.has(t)}}else{var se=ne("state");oe[se]=!0,Yt=function(t,e){if(B(t,se))throw ie("Object already initialized");return e.facade=t,ee(t,se,e),e},$t=function(t){return B(t,se)?t[se]:{}},Kt=function(t){return B(t,se)}}var ce={set:Yt,get:$t,has:Kt,enforce:function(t){return Kt(t)?$t(t):Yt(t,{})},getterFor:function(t){return function(e){var r;if(!dt(e)||(r=$t(e)).type!==t)throw ie("Incompatible receiver, "+t+" required");return r}}},fe=b((function(t){var e=qt.CONFIGURABLE,r=ce.enforce,n=ce.get,o=Object.defineProperty,i=pt&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!B(t,"name")||e&&t.name!==n)&&(pt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&B(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&B(u,"constructor")&&u.constructor?pt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return B(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return $(this)&&n(this).source||Qt(this)}),"toString")})),le=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if($(r)&&fe(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Ut.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},he=R({}.toString),pe=R("".slice),ve=function(t){return pe(he(t),8,-1)},de=ft("toStringTag"),ye=Object,ge="Arguments"==ve(function(){return arguments}()),me=ht?ve:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ye(t),de))?r:ge?ve(e):"Object"==(n=ve(e))&&$(e.callee)?"Arguments":n},xe=ht?{}.toString:function(){return"[object "+me(this)+"]"};ht||le(Object.prototype,"toString",xe,{unsafe:!0});var be={}.propertyIsEnumerable,we=Object.getOwnPropertyDescriptor,Ee={f:we&&!be.call({1:2},1)?function(t){var e=we(this,t);return!!e&&e.enumerable}:be},Ae=Object,Oe=R("".split),Se=j((function(){return!Ae("z").propertyIsEnumerable(0)}))?function(t){return"String"==ve(t)?Oe(t,""):Ae(t)}:Ae,Te=function(t){return Se(D(t))},ke=Object.getOwnPropertyDescriptor,Ie={f:pt?ke:function(t,e){if(t=Te(t),e=Ft(e),xt)try{return ke(t,e)}catch(t){}if(B(t,e))return te(!St(Ee.f,t,e),t[e])}},je=Math.ceil,Pe=Math.floor,_e=Math.trunc||function(t){var e=+t;return(e>0?Pe:je)(e)},Me=function(t){var e=+t;return e!=e||0===e?0:_e(e)},Le=Math.max,Re=Math.min,Ce=function(t,e){var r=Me(t);return r<0?Le(r+e,0):Re(r,e)},Ne=Math.min,De=function(t){return t>0?Ne(Me(t),9007199254740991):0},Fe=function(t){return De(t.length)},We=function(t){return function(e,r,n){var o,i=Te(e),a=Fe(i),u=Ce(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},ze={includes:We(!0),indexOf:We(!1)},Be=ze.indexOf,Ue=R([].push),Ge=function(t,e){var r,n=Te(t),o=0,i=[];for(r in n)!B(oe,r)&&B(n,r)&&Ue(i,r);for(;e.length>o;)B(n,r=e[o++])&&(~Be(i,r)||Ue(i,r));return i},He=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ve=He.concat("length","prototype"),qe={f:Object.getOwnPropertyNames||function(t){return Ge(t,Ve)}},Ze={f:Object.getOwnPropertySymbols},Ye=R([].concat),$e=Q("Reflect","ownKeys")||function(t){var e=qe.f(At(t)),r=Ze.f;return r?Ye(e,r(t)):e},Ke=function(t,e,r){for(var n=$e(e),o=Ut.f,i=Ie.f,a=0;a<n.length;a++){var u=n[a];B(t,u)||r&&B(r,u)||o(t,u,i(e,u))}},Qe=/#|\\.prototype\\./,Xe=function(t,e){var r=tr[Je(t)];return r==rr||r!=er&&($(e)?j(e):!!e)},Je=Xe.normalize=function(t){return String(t).replace(Qe,".").toLowerCase()},tr=Xe.data={},er=Xe.NATIVE="N",rr=Xe.POLYFILL="P",nr=Xe,or=Ie.f,ir=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=or(r,n))&&a.value:r[n],!nr(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ke(i,o)}(t.sham||o&&o.sham)&&ee(i,"sham",!0),le(r,n,i,t)}},ar="process"==ve(O.process),ur=String,sr=TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=R(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return At(r),function(t){if("object"==typeof t||$(t))return t;throw sr("Can't set "+ur(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),fr=Ut.f,lr=ft("toStringTag"),hr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!B(t,lr)&&fr(t,lr,{configurable:!0,value:e})},pr=ft("species"),vr=function(t){var e=Q(t),r=Ut.f;pt&&e&&!e[pr]&&r(e,pr,{configurable:!0,get:function(){return this}})},dr=TypeError,yr=function(t,e){if(Tt(e,t))return t;throw dr("Incorrect invocation")},gr=function(){},mr=[],xr=Q("Reflect","construct"),br=/^\\s*(?:class|function)\\b/,wr=R(br.exec),Er=!br.exec(gr),Ar=function(t){if(!$(t))return!1;try{return xr(gr,mr,t),!0}catch(t){return!1}},Or=function(t){if(!$(t))return!1;switch(me(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Er||!!wr(br,Qt(t))}catch(t){return!0}};Or.sham=!0;var Sr,Tr,kr,Ir,jr=!xr||j((function(){var t;return Ar(Ar.call)||!Ar(Object)||!Ar((function(){t=!0}))||t}))?Or:Ar,Pr=TypeError,_r=function(t){if(jr(t))return t;throw Pr(Pt(t)+" is not a constructor")},Mr=ft("species"),Lr=function(t,e){var r,n=At(t).constructor;return void 0===n||C(r=At(n)[Mr])?e:_r(r)},Rr=Function.prototype,Cr=Rr.apply,Nr=Rr.call,Dr="object"==typeof Reflect&&Reflect.apply||(P?Nr.bind(Cr):function(){return Nr.apply(Cr,arguments)}),Fr=function(t){if("Function"===ve(t))return R(t)},Wr=Fr(Fr.bind),zr=function(t,e){return Mt(t),void 0===e?t:P?Wr(t,e):function(){return t.apply(e,arguments)}},Br=Q("document","documentElement"),Ur=R([].slice),Gr=TypeError,Hr=function(t,e){if(t<e)throw Gr("Not enough arguments");return t},Vr=/(?:ipad|iphone|ipod).*applewebkit/i.test(X),qr=O.setImmediate,Zr=O.clearImmediate,Yr=O.process,$r=O.Dispatch,Kr=O.Function,Qr=O.MessageChannel,Xr=O.String,Jr=0,tn={};try{Sr=O.location}catch(t){}var en=function(t){if(B(tn,t)){var e=tn[t];delete tn[t],e()}},rn=function(t){return function(){en(t)}},nn=function(t){en(t.data)},on=function(t){O.postMessage(Xr(t),Sr.protocol+"//"+Sr.host)};qr&&Zr||(qr=function(t){Hr(arguments.length,1);var e=$(t)?t:Kr(t),r=Ur(arguments,1);return tn[++Jr]=function(){Dr(e,void 0,r)},Tr(Jr),Jr},Zr=function(t){delete tn[t]},ar?Tr=function(t){Yr.nextTick(rn(t))}:$r&&$r.now?Tr=function(t){$r.now(rn(t))}:Qr&&!Vr?(Ir=(kr=new Qr).port2,kr.port1.onmessage=nn,Tr=zr(Ir.postMessage,Ir)):O.addEventListener&&$(O.postMessage)&&!O.importScripts&&Sr&&"file:"!==Sr.protocol&&!j(on)?(Tr=on,O.addEventListener("message",nn,!1)):Tr="onreadystatechange"in mt("script")?function(t){Br.appendChild(mt("script")).onreadystatechange=function(){Br.removeChild(this),en(t)}}:function(t){setTimeout(rn(t),0)});var an,un,sn,cn,fn,ln,hn,pn,vn={set:qr,clear:Zr},dn=/ipad|iphone|ipod/i.test(X)&&void 0!==O.Pebble,yn=/web0s(?!.*chrome)/i.test(X),gn=Ie.f,mn=vn.set,xn=O.MutationObserver||O.WebKitMutationObserver,bn=O.document,wn=O.process,En=O.Promise,An=gn(O,"queueMicrotask"),On=An&&An.value;On||(an=function(){var t,e;for(ar&&(t=wn.domain)&&t.exit();un;){e=un.fn,un=un.next;try{e()}catch(t){throw un?cn():sn=void 0,t}}sn=void 0,t&&t.enter()},Vr||ar||yn||!xn||!bn?!dn&&En&&En.resolve?((hn=En.resolve(void 0)).constructor=En,pn=zr(hn.then,hn),cn=function(){pn(an)}):ar?cn=function(){wn.nextTick(an)}:(mn=zr(mn,O),cn=function(){mn(an)}):(fn=!0,ln=bn.createTextNode(""),new xn(an).observe(ln,{characterData:!0}),cn=function(){ln.data=fn=!fn}));var Sn=On||function(t){var e={fn:t,next:void 0};sn&&(sn.next=e),un||(un=e,cn()),sn=e},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},kn=function(){this.head=null,this.tail=null};kn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var In,jn,Pn,_n=kn,Mn=O.Promise,Ln="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Rn=!Ln&&!ar&&"object"==typeof window&&"object"==typeof document,Cn=(Mn&&Mn.prototype,ft("species")),Nn=!1,Dn=$(O.PromiseRejectionEvent),Fn={CONSTRUCTOR:nr("Promise",(function(){var t=Qt(Mn),e=t!==String(Mn);if(!e&&66===nt)return!0;if(!nt||nt<51||!/native code/.test(t)){var r=new Mn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Cn]=n,!(Nn=r.then((function(){}))instanceof n))return!0}return!e&&(Rn||Ln)&&!Dn})),REJECTION_EVENT:Dn,SUBCLASSING:Nn},Wn=TypeError,zn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw Wn("Bad Promise constructor");e=t,r=n})),this.resolve=Mt(e),this.reject=Mt(r)},Bn={f:function(t){return new zn(t)}},Un=vn.set,Gn=Fn.CONSTRUCTOR,Hn=Fn.REJECTION_EVENT,Vn=Fn.SUBCLASSING,qn=ce.getterFor("Promise"),Zn=ce.set,Yn=Mn&&Mn.prototype,$n=Mn,Kn=Yn,Qn=O.TypeError,Xn=O.document,Jn=O.process,to=Bn.f,eo=to,ro=!!(Xn&&Xn.createEvent&&O.dispatchEvent),no=function(t){var e;return!(!dt(t)||!$(e=t.then))&&e},oo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&co(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Qn("Promise-chain cycle")):(n=no(r))?St(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},io=function(t,e){t.notified||(t.notified=!0,Sn((function(){for(var r,n=t.reactions;r=n.get();)oo(r,t);t.notified=!1,e&&!t.rejection&&uo(t)})))},ao=function(t,e,r){var n,o;ro?((n=Xn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Hn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},uo=function(t){St(Un,O,(function(){var e,r=t.facade,n=t.value;if(so(t)&&(e=Tn((function(){ar?Jn.emit("unhandledRejection",n,r):ao("unhandledrejection",r,n)})),t.rejection=ar||so(t)?2:1,e.error))throw e.value}))},so=function(t){return 1!==t.rejection&&!t.parent},co=function(t){St(Un,O,(function(){var e=t.facade;ar?Jn.emit("rejectionHandled",e):ao("rejectionhandled",e,t.value)}))},fo=function(t,e,r){return function(n){t(e,n,r)}},lo=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,io(t,!0))},ho=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Qn("Promise can't be resolved itself");var n=no(e);n?Sn((function(){var r={done:!1};try{St(n,e,fo(ho,r,t),fo(lo,r,t))}catch(e){lo(r,e,t)}})):(t.value=e,t.state=1,io(t,!1))}catch(e){lo({done:!1},e,t)}}};if(Gn&&(Kn=($n=function(t){yr(this,Kn),Mt(t),St(In,this);var e=qn(this);try{t(fo(ho,e),fo(lo,e))}catch(t){lo(e,t)}}).prototype,(In=function(t){Zn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new _n,rejection:!1,state:0,value:void 0})}).prototype=le(Kn,"then",(function(t,e){var r=qn(this),n=to(Lr(this,$n));return r.parent=!0,n.ok=!$(t)||t,n.fail=$(e)&&e,n.domain=ar?Jn.domain:void 0,0==r.state?r.reactions.add(n):Sn((function(){oo(n,r)})),n.promise})),jn=function(){var t=new In,e=qn(t);this.promise=t,this.resolve=fo(ho,e),this.reject=fo(lo,e)},Bn.f=to=function(t){return t===$n||void 0===t?new jn(t):eo(t)},$(Mn)&&Yn!==Object.prototype)){Pn=Yn.then,Vn||le(Yn,"then",(function(t,e){var r=this;return new $n((function(t,e){St(Pn,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yn.constructor}catch(t){}cr&&cr(Yn,Kn)}ir({global:!0,constructor:!0,wrap:!0,forced:Gn},{Promise:$n}),hr($n,"Promise",!1),vr("Promise");var po={},vo=ft("iterator"),yo=Array.prototype,go=function(t){return void 0!==t&&(po.Array===t||yo[vo]===t)},mo=ft("iterator"),xo=function(t){if(!C(t))return Lt(t,mo)||Lt(t,"@@iterator")||po[me(t)]},bo=TypeError,wo=function(t,e){var r=arguments.length<2?xo(t):e;if(Mt(r))return At(St(r,t));throw bo(Pt(t)+" is not iterable")},Eo=function(t,e,r){var n,o;At(t);try{if(!(n=Lt(t,"return"))){if("throw"===e)throw r;return r}n=St(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return At(n),r},Ao=TypeError,Oo=function(t,e){this.stopped=t,this.result=e},So=Oo.prototype,To=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=zr(e,f),y=function(t){return n&&Eo(n,"normal",t),new Oo(!0,t)},g=function(t){return l?(At(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Ao(Pt(t)+" is not iterable");if(go(o)){for(i=0,a=Fe(t);a>i;i++)if((u=g(t[i]))&&Tt(So,u))return u;return new Oo(!1)}n=wo(t,o)}for(s=h?t.next:n.next;!(c=St(s,n)).done;){try{u=g(c.value)}catch(t){Eo(n,"throw",t)}if("object"==typeof u&&u&&Tt(So,u))return u}return new Oo(!1)},ko=ft("iterator"),Io=!1;try{var jo=0,Po={next:function(){return{done:!!jo++}},return:function(){Io=!0}};Po[ko]=function(){return this},Array.from(Po,(function(){throw 2}))}catch(t){}var _o=function(t,e){if(!e&&!Io)return!1;var r=!1;try{var n={};n[ko]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Mo=Fn.CONSTRUCTOR||!_o((function(t){Mn.all(t).then(void 0,(function(){}))}));ir({target:"Promise",stat:!0,forced:Mo},{all:function(t){var e=this,r=Bn.f(e),n=r.resolve,o=r.reject,i=Tn((function(){var r=Mt(e.resolve),i=[],a=0,u=1;To(t,(function(t){var s=a++,c=!1;u++,St(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Lo=Fn.CONSTRUCTOR,Ro=Mn&&Mn.prototype;if(ir({target:"Promise",proto:!0,forced:Lo,real:!0},{catch:function(t){return this.then(void 0,t)}}),$(Mn)){var Co=Q("Promise").prototype.catch;Ro.catch!==Co&&le(Ro,"catch",Co,{unsafe:!0})}ir({target:"Promise",stat:!0,forced:Mo},{race:function(t){var e=this,r=Bn.f(e),n=r.reject,o=Tn((function(){var o=Mt(e.resolve);To(t,(function(t){St(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ir({target:"Promise",stat:!0,forced:Fn.CONSTRUCTOR},{reject:function(t){var e=Bn.f(this);return St(e.reject,void 0,t),e.promise}});var No=Fn.CONSTRUCTOR;Q("Promise");function Do(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ir({target:"Promise",stat:!0,forced:No},{resolve:function(t){return function(t,e){if(At(t),dt(e)&&e.constructor===t)return e;var r=Bn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Fo="undefined"!=typeof window&&void 0!==window.orientation,Wo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),zo=new Map;function Bo(t){Do(t.source&&!t.url||!t.source&&t.url);var e=zo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Uo((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),zo.set(t.url,e)),t.source&&(e=Uo(t.source),zo.set(t.source,e))),Do(e),e}function Uo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Go(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Ho(t))n.add(t);else if(Ho(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Go(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Ho(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Vo=function(){},qo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Do(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Vo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Vo,this.onError=Vo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Go(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Bo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Zo=self&&self.__assign||function(){return(Zo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},$o=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ko=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Zo(Zo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),Yo(this,void 0,void 0,(function(){var n,o=this;return $o(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return Yo(this,void 0,void 0,(function(){var t,e,r;return $o(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new Wo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Fo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Qo=self&&self.__assign||function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jo={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ti=(function(){function t(t){this.workerPools=new Map,this.props=Qo({},Jo),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return qo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Xo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Qo(Qo({},this.props),t);try{for(var n=Xo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Ko({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ei=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ti.get(t);e||(e=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ti.get(t);ti.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Go(e);self.postMessage(r,n)}},t}();function ri(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ni,oi,ii=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ai=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},ui=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},si=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ci=0;function fi(t,e){var r=this;if("undefined"!=typeof self){var n={process:li};ei.onmessage=function(o,i){return ai(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return ui(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ei.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ni=new ii,oi=i.options||{},a=e(ni,oi,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=si(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ei.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ei.postMessage("done",{}),[3,18];case 16:return ni.push(i.input),[3,18];case 17:return ni.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ei.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function li(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ci++,i=function(t,e){if(e.id===o)switch(t){case"done":ei.removeEventListener(i),r(e.result);break;case"error":ei.removeEventListener(i),n(e.error)}};ei.addEventListener(i);var a={id:o,input:t,options:e};ei.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var hi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pi=mt("span").classList,vi=pi&&pi.constructor&&pi.constructor.prototype,di=vi===Object.prototype?void 0:vi,yi=Array.isArray||function(t){return"Array"==ve(t)},gi=ft("species"),mi=Array,xi=function(t,e){return new(function(t){var e;return yi(t)&&(e=t.constructor,(jr(e)&&(e===mi||yi(e.prototype))||dt(e)&&null===(e=e[gi]))&&(e=void 0)),void 0===e?mi:e}(t))(0===e?0:e)},bi=R([].push),wi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=W(s),d=Se(v),y=zr(c,f),g=Fe(d),m=0,x=l||xi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:bi(b,h)}else switch(t){case 4:return!1;case 7:bi(b,h)}return i?-1:n||o?o:b}},Ei={forEach:wi(0),map:wi(1),filter:wi(2),some:wi(3),every:wi(4),find:wi(5),findIndex:wi(6),filterReject:wi(7)},Ai=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},Oi=Ei.forEach,Si=Ai("forEach")?[].forEach:function(t){return Oi(this,t,arguments.length>1?arguments[1]:void 0)},Ti=function(t){if(t&&t.forEach!==Si)try{ee(t,"forEach",Si)}catch(e){t.forEach=Si}};for(var ki in hi)hi[ki]&&Ti(O[ki]&&O[ki].prototype);Ti(di);var Ii=function(t,e,r){var n=Ft(e);n in t?Ut.f(t,n,te(0,r)):t[n]=r},ji=ft("species"),Pi=function(t){return nt>=51||!j((function(){var e=[];return(e.constructor={})[ji]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},_i=Pi("slice"),Mi=ft("species"),Li=Array,Ri=Math.max;ir({target:"Array",proto:!0,forced:!_i},{slice:function(t,e){var r,n,o,i=Te(this),a=Fe(i),u=Ce(t,a),s=Ce(void 0===e?a:e,a);if(yi(i)&&(r=i.constructor,(jr(r)&&(r===Li||yi(r.prototype))||dt(r)&&null===(r=r[Mi]))&&(r=void 0),r===Li||void 0===r))return Ur(i,u,s);for(n=new(void 0===r?Li:r)(Ri(s-u,0)),o=0;u<s;u++,o++)u in i&&Ii(n,o,i[u]);return n.length=o,n}});var Ci=qt.EXISTS,Ni=Ut.f,Di=Function.prototype,Fi=R(Di.toString),Wi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,zi=R(Wi.exec);pt&&!Ci&&Ni(Di,"name",{configurable:!0,get:function(){try{return zi(Wi,Fi(this))[1]}catch(t){return""}}});var Bi=Ei.map,Ui=Pi("map");ir({target:"Array",proto:!0,forced:!Ui},{map:function(t){return Bi(this,t,arguments.length>1?arguments[1]:void 0)}});var Gi,Hi=Object.keys||function(t){return Ge(t,He)},Vi={f:pt&&!bt?Object.defineProperties:function(t,e){At(t);for(var r,n=Te(e),o=Hi(e),i=o.length,a=0;i>a;)Ut.f(t,r=o[a++],n[r]);return t}},qi=ne("IE_PROTO"),Zi=function(){},Yi=function(t){return"<script>"+t+"<\\/script>"},$i=function(t){t.write(Yi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ki=function(){try{Gi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ki="undefined"!=typeof document?document.domain&&Gi?$i(Gi):((e=mt("iframe")).style.display="none",Br.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Yi("document.F=Object")),t.close(),t.F):$i(Gi);for(var r=He.length;r--;)delete Ki.prototype[He[r]];return Ki()};oe[qi]=!0;var Qi=Object.create||function(t,e){var r;return null!==t?(Zi.prototype=At(t),r=new Zi,Zi.prototype=null,r[qi]=t):r=Ki(),void 0===e?r:Vi.f(r,e)},Xi=Ut.f,Ji=ft("unscopables"),ta=Array.prototype;null==ta[Ji]&&Xi(ta,Ji,{configurable:!0,value:Qi(null)});var ea,ra,na,oa=function(t){ta[Ji][t]=!0},ia=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=ne("IE_PROTO"),ua=Object,sa=ua.prototype,ca=ia?ua.getPrototypeOf:function(t){var e=W(t);if(B(e,aa))return e[aa];var r=e.constructor;return $(r)&&e instanceof r?r.prototype:e instanceof ua?sa:null},fa=ft("iterator"),la=!1;[].keys&&("next"in(na=[].keys())?(ra=ca(ca(na)))!==Object.prototype&&(ea=ra):la=!0),(!dt(ea)||j((function(){var t={};return ea[fa].call(t)!==t})))&&(ea={}),$(ea[fa])||le(ea,fa,(function(){return this}));var ha={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:la},pa=ha.IteratorPrototype,va=function(){return this},da=qt.PROPER,ya=qt.CONFIGURABLE,ga=ha.IteratorPrototype,ma=ha.BUGGY_SAFARI_ITERATORS,xa=ft("iterator"),ba=function(){return this},wa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Qi(pa,{next:te(+!n,r)}),hr(t,o,!1),po[o]=va}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ma&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[xa]||p["@@iterator"]||o&&p[o],d=!ma&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=ca(y.call(new t)))!==Object.prototype&&u.next&&(ca(u)!==ga&&(cr?cr(u,ga):$(u[xa])||le(u,xa,ba)),hr(u,l,!0)),da&&"values"==o&&v&&"values"!==v.name&&(ya?ee(p,"name","values"):(h=!0,d=function(){return St(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ma||h||!(c in p))&&le(p,c,s[c]);else ir({target:e,proto:!0,forced:ma||h},s);return p[xa]!==d&&le(p,xa,d,{name:o}),po[e]=d,s},Ea=function(t,e){return{value:t,done:e}},Aa=Ut.f,Oa=ce.set,Sa=ce.getterFor("Array Iterator"),Ta=wa(Array,"Array",(function(t,e){Oa(this,{type:"Array Iterator",target:Te(t),index:0,kind:e})}),(function(){var t=Sa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Ea(void 0,!0)):Ea("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),ka=po.Arguments=po.Array;if(oa("keys"),oa("values"),oa("entries"),pt&&"values"!==ka.name)try{Aa(ka,"name",{value:"values"})}catch(t){}var Ia,ja,Pa,_a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ma=Ut.f,La=ce.enforce,Ra=ce.get,Ca=O.Int8Array,Na=Ca&&Ca.prototype,Da=O.Uint8ClampedArray,Fa=Da&&Da.prototype,Wa=Ca&&ca(Ca),za=Na&&ca(Na),Ba=Object.prototype,Ua=O.TypeError,Ga=ft("toStringTag"),Ha=V("TYPED_ARRAY_TAG"),Va=_a&&!!cr&&"Opera"!==me(O.opera),qa=!1,Za={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ya={BigInt64Array:8,BigUint64Array:8},$a=function(t){var e=ca(t);if(dt(e)){var r=Ra(e);return r&&B(r,"TypedArrayConstructor")?r.TypedArrayConstructor:$a(e)}},Ka=function(t){if(!dt(t))return!1;var e=me(t);return B(Za,e)||B(Ya,e)};for(Ia in Za)(Pa=(ja=O[Ia])&&ja.prototype)?La(Pa).TypedArrayConstructor=ja:Va=!1;for(Ia in Ya)(Pa=(ja=O[Ia])&&ja.prototype)&&(La(Pa).TypedArrayConstructor=ja);if((!Va||!$(Wa)||Wa===Function.prototype)&&(Wa=function(){throw Ua("Incorrect invocation")},Va))for(Ia in Za)O[Ia]&&cr(O[Ia],Wa);if((!Va||!za||za===Ba)&&(za=Wa.prototype,Va))for(Ia in Za)O[Ia]&&cr(O[Ia].prototype,za);if(Va&&ca(Fa)!==za&&cr(Fa,za),pt&&!B(za,Ga))for(Ia in qa=!0,Ma(za,Ga,{get:function(){return dt(this)?this[Ha]:void 0}}),Za)O[Ia]&&ee(O[Ia],Ha,Ia);var Qa={NATIVE_ARRAY_BUFFER_VIEWS:Va,TYPED_ARRAY_TAG:qa&&Ha,aTypedArray:function(t){if(Ka(t))return t;throw Ua("Target is not a typed array")},aTypedArrayConstructor:function(t){if($(t)&&(!cr||Tt(Wa,t)))return t;throw Ua(Pt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(pt){if(r)for(var o in Za){var i=O[o];if(i&&B(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}za[t]&&!r||le(za,t,r?e:Va&&Na[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(pt){if(cr){if(r)for(n in Za)if((o=O[n])&&B(o,t))try{delete o[t]}catch(t){}if(Wa[t]&&!r)return;try{return le(Wa,t,r?e:Va&&Wa[t]||e)}catch(t){}}for(n in Za)!(o=O[n])||o[t]&&!r||le(o,t,e)}},getTypedArrayConstructor:$a,isView:function(t){if(!dt(t))return!1;var e=me(t);return"DataView"===e||B(Za,e)||B(Ya,e)},isTypedArray:Ka,TypedArray:Wa,TypedArrayPrototype:za},Xa=Qa.NATIVE_ARRAY_BUFFER_VIEWS,Ja=O.ArrayBuffer,tu=O.Int8Array,eu=!Xa||!j((function(){tu(1)}))||!j((function(){new tu(-1)}))||!_o((function(t){new tu,new tu(null),new tu(1.5),new tu(t)}),!0)||j((function(){return 1!==new tu(new Ja(2),1,void 0).length})),ru=function(t,e,r){for(var n in e)le(t,n,e[n],r);return t},nu=RangeError,ou=function(t){if(void 0===t)return 0;var e=Me(t),r=De(e);if(e!==r)throw nu("Wrong length or index");return r},iu=Array,au=Math.abs,uu=Math.pow,su=Math.floor,cu=Math.log,fu=Math.LN2,lu=function(t,e,r){var n,o,i,a=iu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?uu(2,-24)-uu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=au(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=su(cu(t)/fu),t*(i=uu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*uu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*uu(2,e),n+=c):(o=t*uu(2,c-1)*uu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},hu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=uu(2,e),f-=a}return(c?-1:1)*r*uu(2,f-e)},pu=function(t){for(var e=W(this),r=Fe(e),n=arguments.length,o=Ce(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ce(i,r);a>o;)e[o++]=t;return e},vu=Array,du=Math.max,yu=function(t,e,r){for(var n=Fe(t),o=Ce(e,n),i=Ce(void 0===r?n:r,n),a=vu(du(i-o,0)),u=0;o<i;o++,u++)Ii(a,u,t[o]);return a.length=u,a},gu=qe.f,mu=Ut.f,xu=qt.PROPER,bu=qt.CONFIGURABLE,wu=ce.get,Eu=ce.set,Au=O.ArrayBuffer,Ou=Au,Su=Ou&&Ou.prototype,Tu=O.DataView,ku=Tu&&Tu.prototype,Iu=Object.prototype,ju=O.Array,Pu=O.RangeError,_u=R(pu),Mu=R([].reverse),Lu=lu,Ru=hu,Cu=function(t){return[255&t]},Nu=function(t){return[255&t,t>>8&255]},Du=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Fu=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Wu=function(t){return Lu(t,23,4)},zu=function(t){return Lu(t,52,8)},Bu=function(t,e){mu(t.prototype,e,{get:function(){return wu(this)[e]}})},Uu=function(t,e,r,n){var o=ou(r),i=wu(t);if(o+e>i.byteLength)throw Pu("Wrong index");var a=wu(i.buffer).bytes,u=o+i.byteOffset,s=yu(a,u,u+e);return n?s:Mu(s)},Gu=function(t,e,r,n,o,i){var a=ou(r),u=wu(t);if(a+e>u.byteLength)throw Pu("Wrong index");for(var s=wu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(_a){var Hu=xu&&"ArrayBuffer"!==Au.name;if(j((function(){Au(1)}))&&j((function(){new Au(-1)}))&&!j((function(){return new Au,new Au(1.5),new Au(NaN),1!=Au.length||Hu&&!bu})))Hu&&bu&&ee(Au,"name","ArrayBuffer");else{(Ou=function(t){return yr(this,Su),new Au(ou(t))}).prototype=Su;for(var Vu,qu=gu(Au),Zu=0;qu.length>Zu;)(Vu=qu[Zu++])in Ou||ee(Ou,Vu,Au[Vu]);Su.constructor=Ou}cr&&ca(ku)!==Iu&&cr(ku,Iu);var Yu=new Tu(new Ou(2)),$u=R(ku.setInt8);Yu.setInt8(0,2147483648),Yu.setInt8(1,2147483649),!Yu.getInt8(0)&&Yu.getInt8(1)||ru(ku,{setInt8:function(t,e){$u(this,t,e<<24>>24)},setUint8:function(t,e){$u(this,t,e<<24>>24)}},{unsafe:!0})}else Su=(Ou=function(t){yr(this,Su);var e=ou(t);Eu(this,{bytes:_u(ju(e),0),byteLength:e}),pt||(this.byteLength=e)}).prototype,ku=(Tu=function(t,e,r){yr(this,ku),yr(t,Su);var n=wu(t).byteLength,o=Me(e);if(o<0||o>n)throw Pu("Wrong offset");if(o+(r=void 0===r?n-o:De(r))>n)throw Pu("Wrong length");Eu(this,{buffer:t,byteLength:r,byteOffset:o}),pt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,pt&&(Bu(Ou,"byteLength"),Bu(Tu,"buffer"),Bu(Tu,"byteLength"),Bu(Tu,"byteOffset")),ru(ku,{getInt8:function(t){return Uu(this,1,t)[0]<<24>>24},getUint8:function(t){return Uu(this,1,t)[0]},getInt16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Ru(Uu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Ru(Uu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Gu(this,1,t,Cu,e)},setUint8:function(t,e){Gu(this,1,t,Cu,e)},setInt16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Gu(this,4,t,Wu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Gu(this,8,t,zu,e,arguments.length>2?arguments[2]:void 0)}});hr(Ou,"ArrayBuffer"),hr(Tu,"DataView");var Ku={ArrayBuffer:Ou,DataView:Tu},Qu=Math.floor,Xu=Number.isInteger||function(t){return!dt(t)&&isFinite(t)&&Qu(t)===t},Ju=RangeError,ts=RangeError,es=function(t,e){var r=function(t){var e=Me(t);if(e<0)throw Ju("The argument can't be less than 0");return e}(t);if(r%e)throw ts("Wrong offset");return r},rs=R("".slice),ns=function(t){return"Big"===rs(me(t),0,3)},os=TypeError,is=function(t){var e=Dt(t,"number");if("number"==typeof e)throw os("Can't convert number to bigint");return BigInt(e)},as=Qa.aTypedArrayConstructor,us=function(t){var e,r,n,o,i,a,u,s,c=_r(this),f=W(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!go(v))for(s=(u=wo(f,v)).next,f=[];!(a=St(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=zr(h,arguments[2])),r=Fe(f),n=new(as(c))(r),o=ns(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?is(i):+i;return n},ss=function(t,e,r){var n,o;return cr&&$(n=e.constructor)&&n!==r&&dt(o=n.prototype)&&o!==r.prototype&&cr(t,o),t},cs=b((function(t){var e=qe.f,r=Ei.forEach,n=ce.get,o=ce.set,i=ce.enforce,a=Ut.f,u=Ie.f,s=Math.round,c=O.RangeError,f=Ku.ArrayBuffer,l=f.prototype,h=Ku.DataView,p=Qa.NATIVE_ARRAY_BUFFER_VIEWS,v=Qa.TYPED_ARRAY_TAG,d=Qa.TypedArray,y=Qa.TypedArrayPrototype,g=Qa.aTypedArrayConstructor,m=Qa.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Tt(l,t)||"ArrayBuffer"==(e=me(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!It(e)&&e in t&&Xu(+e)&&e>=0},A=function(t,e){return e=Ft(e),E(t,e)?te(2,t[e]):u(t,e)},S=function(t,e,r){return e=Ft(e),!(E(t,e)&&dt(r)&&B(r,"value"))||B(r,"get")||B(r,"set")||r.configurable||B(r,"writable")&&!r.writable||B(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};pt?(p||(Ie.f=A,Ut.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),ir({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?eu&&(T=u((function(t,e,r,n){return yr(t,k),ss(dt(e)?w(e)?void 0!==n?new S(e,es(r,g),n):void 0!==r?new S(e,es(r,g)):new S(e):m(e)?x(T,e):St(us,T,e):new S(ou(e)),t,T)})),cr&&cr(T,d),r(e(S),(function(t){t in T||ee(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){yr(t,k);var i,a,u,s=0,l=0;if(dt(e)){if(!w(e))return m(e)?x(T,e):St(us,T,e);i=e,l=es(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=De(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=ou(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),cr&&cr(T,d),k=T.prototype=Qi(y)),k.constructor!==T&&ee(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&ee(k,v,b);var P=T!=S;I[b]=T,ir({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||ee(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||ee(k,"BYTES_PER_ELEMENT",g),vr(b)}):t.exports=function(){}}));cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var fs=TypeError,ls=function(t,e){if(!delete t[e])throw fs("Cannot delete property "+Pt(e)+" of "+Pt(t))},hs=Math.min,ps=R([].copyWithin||function(t,e){var r=W(this),n=Fe(r),o=Ce(t,n),i=Ce(e,n),a=arguments.length>2?arguments[2]:void 0,u=hs((void 0===a?n:Ce(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ls(r,o),o+=s,i+=s;return r}),vs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("copyWithin",(function(t,e){return ps(vs(this),t,e,arguments.length>2?arguments[2]:void 0)}));var ds=Ei.every,ys=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("every",(function(t){return ds(ys(this),t,arguments.length>1?arguments[1]:void 0)}));var gs=Qa.aTypedArray,ms=Qa.exportTypedArrayMethod,xs=R("".slice);ms("fill",(function(t){var e=arguments.length;gs(this);var r="Big"===xs(me(this),0,3)?is(t):+t;return St(pu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Qa.aTypedArrayConstructor,ws=Qa.getTypedArrayConstructor,Es=function(t){return bs(Lr(t,ws(t)))},As=function(t,e){return function(t,e){for(var r=0,n=Fe(e),o=new t(n);n>r;)o[r]=e[r++];return o}(Es(t),e)},Os=Ei.filter,Ss=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("filter",(function(t){var e=Os(Ss(this),t,arguments.length>1?arguments[1]:void 0);return As(this,e)}));var Ts=Ei.find,ks=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("find",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=Ei.findIndex,js=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("findIndex",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=Ei.forEach,_s=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("forEach",(function(t){Ps(_s(this),t,arguments.length>1?arguments[1]:void 0)}));var Ms=ze.includes,Ls=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("includes",(function(t){return Ms(Ls(this),t,arguments.length>1?arguments[1]:void 0)}));var Rs=ze.indexOf,Cs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("indexOf",(function(t){return Rs(Cs(this),t,arguments.length>1?arguments[1]:void 0)}));var Ns=ft("iterator"),Ds=O.Uint8Array,Fs=R(Ta.values),Ws=R(Ta.keys),zs=R(Ta.entries),Bs=Qa.aTypedArray,Us=Qa.exportTypedArrayMethod,Gs=Ds&&Ds.prototype,Hs=!j((function(){Gs[Ns].call([1])})),Vs=!!Gs&&Gs.values&&Gs[Ns]===Gs.values&&"values"===Gs.values.name,qs=function(){return Fs(Bs(this))};Us("entries",(function(){return zs(Bs(this))}),Hs),Us("keys",(function(){return Ws(Bs(this))}),Hs),Us("values",qs,Hs||!Vs,{name:"values"}),Us(Ns,qs,Hs||!Vs,{name:"values"});var Zs=Qa.aTypedArray,Ys=Qa.exportTypedArrayMethod,$s=R([].join);Ys("join",(function(t){return $s(Zs(this),t)}));var Ks=Math.min,Qs=[].lastIndexOf,Xs=!!Qs&&1/[1].lastIndexOf(1,-0)<0,Js=Ai("lastIndexOf"),tc=Xs||!Js?function(t){if(Xs)return Dr(Qs,this,arguments)||0;var e=Te(this),r=Fe(e),n=r-1;for(arguments.length>1&&(n=Ks(n,Me(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Qs,ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Dr(tc,ec(this),e>1?[t,arguments[1]]:[t])}));var rc=Ei.map,nc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("map",(function(t){return rc(nc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(Es(t))(e)}))}));var oc=TypeError,ic=function(t){return function(e,r,n,o){Mt(r);var i=W(e),a=Se(i),u=Fe(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw oc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ac={left:ic(!1),right:ic(!0)},uc=ac.left,sc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return uc(sc(this),t,e,e>1?arguments[1]:void 0)}));var cc=ac.right,fc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return cc(fc(this),t,e,e>1?arguments[1]:void 0)}));var lc=Qa.aTypedArray,hc=Qa.exportTypedArrayMethod,pc=Math.floor;hc("reverse",(function(){for(var t,e=lc(this).length,r=pc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var vc=O.RangeError,dc=O.Int8Array,yc=dc&&dc.prototype,gc=yc&&yc.set,mc=Qa.aTypedArray,xc=Qa.exportTypedArrayMethod,bc=!j((function(){var t=new Uint8ClampedArray(2);return St(gc,t,{length:1,0:3},1),3!==t[1]})),wc=bc&&Qa.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new dc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));xc("set",(function(t){mc(this);var e=es(arguments.length>1?arguments[1]:void 0,1),r=W(t);if(bc)return St(gc,this,r,e);var n=this.length,o=Fe(r),i=0;if(o+e>n)throw vc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||wc);var Ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Ur(Ec(this),t,e),n=Es(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var Ac=Ei.some,Oc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("some",(function(t){return Ac(Oc(this),t,arguments.length>1?arguments[1]:void 0)}));var Sc=Math.floor,Tc=function(t,e){var r=t.length,n=Sc(r/2);return r<8?kc(t,e):Ic(t,Tc(yu(t,0,n),e),Tc(yu(t,n),e),e)},kc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ic=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},jc=Tc,Pc=X.match(/firefox\\/(\\d+)/i),_c=!!Pc&&+Pc[1],Mc=/MSIE|Trident/.test(X),Lc=X.match(/AppleWebKit\\/(\\d+)\\./),Rc=!!Lc&&+Lc[1],Cc=Qa.aTypedArray,Nc=Qa.exportTypedArrayMethod,Dc=O.Uint16Array,Fc=Dc&&Fr(Dc.prototype.sort),Wc=!(!Fc||j((function(){Fc(new Dc(2),null)}))&&j((function(){Fc(new Dc(2),{})}))),zc=!!Fc&&!j((function(){if(nt)return nt<74;if(_c)return _c<67;if(Mc)return!0;if(Rc)return Rc<602;var t,e,r=new Dc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Fc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Nc("sort",(function(t){return void 0!==t&&Mt(t),zc?Fc(this,t):jc(Cc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!zc||Wc);var Bc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("subarray",(function(t,e){var r=Bc(this),n=r.length,o=Ce(t,n);return new(Es(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,De((void 0===e?n:Ce(e,n))-o))}));var Uc=O.Int8Array,Gc=Qa.aTypedArray,Hc=Qa.exportTypedArrayMethod,Vc=[].toLocaleString,qc=!!Uc&&j((function(){Vc.call(new Uc(1))}));Hc("toLocaleString",(function(){return Dr(Vc,qc?Ur(Gc(this)):Gc(this),Ur(arguments))}),j((function(){return[1,2].toLocaleString()!=new Uc([1,2]).toLocaleString()}))||!j((function(){Uc.prototype.toLocaleString.call([1,2])})));var Zc=Qa.exportTypedArrayMethod,Yc=O.Uint8Array,$c=Yc&&Yc.prototype||{},Kc=[].toString,Qc=R([].join);j((function(){Kc.call({})}))&&(Kc=function(){return Qc(this)});var Xc=$c.toString!=Kc;Zc("toString",Kc,Xc);var Jc,tf,ef=String,rf=function(t){if("Symbol"===me(t))throw TypeError("Cannot convert a Symbol value to a string");return ef(t)},nf=function(){var t=At(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},of=O.RegExp,af=j((function(){var t=of("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),uf=af||j((function(){return!of("a","y").sticky})),sf={BROKEN_CARET:af||j((function(){var t=of("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:uf,UNSUPPORTED_Y:af},cf=O.RegExp,ff=j((function(){var t=cf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),lf=O.RegExp,hf=j((function(){var t=lf("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),pf=ce.get,vf=I("native-string-replace",String.prototype.replace),df=RegExp.prototype.exec,yf=df,gf=R("".charAt),mf=R("".indexOf),xf=R("".replace),bf=R("".slice),wf=(tf=/b*/g,St(df,Jc=/a/,"a"),St(df,tf,"a"),0!==Jc.lastIndex||0!==tf.lastIndex),Ef=sf.BROKEN_CARET,Af=void 0!==/()??/.exec("")[1];(wf||Af||Ef||ff||hf)&&(yf=function(t){var e,r,n,o,i,a,u,s=this,c=pf(s),f=rf(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=St(yf,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=Ef&&s.sticky,v=St(nf,s),d=s.source,y=0,g=f;if(p&&(v=xf(v,"y",""),-1===mf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==gf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Af&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),wf&&(n=s.lastIndex),o=St(df,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:wf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Af&&o&&o.length>1&&St(vf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Qi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Of=yf;ir({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Sf,Tf=ft("species"),kf=RegExp.prototype,If=function(t,e,r,n){var o=ft(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Tf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=Fr(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=Fr(t),s=e.exec;return s===Of||s===kf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));le(String.prototype,t,s[0]),le(kf,o,s[1])}n&&ee(kf[o],"sham",!0)},jf=R("".charAt),Pf=R("".charCodeAt),_f=R("".slice),Mf=function(t){return function(e,r){var n,o,i=rf(D(e)),a=Me(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Pf(i,a))<55296||n>56319||a+1===u||(o=Pf(i,a+1))<56320||o>57343?t?jf(i,a):n:t?_f(i,a,a+2):o-56320+(n-55296<<10)+65536}},Lf={codeAt:Mf(!1),charAt:Mf(!0)},Rf=Lf.charAt,Cf=function(t,e,r){return e+(r?Rf(t,e).length:1)},Nf=Math.floor,Df=R("".charAt),Ff=R("".replace),Wf=R("".slice),zf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,Bf=/\\$([$&'\`]|\\d{1,2})/g,Uf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Bf;return void 0!==o&&(o=W(o),s=zf),Ff(i,s,(function(i,s){var c;switch(Df(s,0)){case"$":return"$";case"&":return t;case"\`":return Wf(e,0,r);case"'":return Wf(e,a);case"<":c=o[Wf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Nf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Df(s,1):n[l-1]+Df(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Gf=TypeError,Hf=function(t,e){var r=t.exec;if($(r)){var n=St(r,t,e);return null!==n&&At(n),n}if("RegExp"===ve(t))return St(Of,t,e);throw Gf("RegExp#exec called on incompatible receiver")},Vf=ft("replace"),qf=Math.max,Zf=Math.min,Yf=R([].concat),$f=R([].push),Kf=R("".indexOf),Qf=R("".slice),Xf="$0"==="a".replace(/./,"$0"),Jf=!!/./[Vf]&&""===/./[Vf]("a","$0");function tl(t){this.message=t}If("replace",(function(t,e,r){var n=Jf?"$":"$0";return[function(t,r){var n=D(this),o=C(t)?void 0:Lt(t,Vf);return o?St(o,t,n,r):St(e,rf(n),t,r)},function(t,o){var i=At(this),a=rf(t);if("string"==typeof o&&-1===Kf(o,n)&&-1===Kf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=$(o);s||(o=rf(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Hf(i,a);if(null===h)break;if($f(l,h),!c)break;""===rf(h[0])&&(i.lastIndex=Cf(a,De(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=rf((h=l[y])[0]),m=qf(Zf(Me(h.index),a.length),0),x=[],b=1;b<h.length;b++)$f(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Yf([g],x,m,a);void 0!==w&&$f(E,w);var A=rf(Dr(o,void 0,E))}else A=Uf(g,a,m,x,w,o);m>=d&&(v+=Qf(a,d,m)+A,d=m+g.length)}return v+Qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Xf||Jf),tl.prototype=new Error,tl.prototype.name="InvalidCharacterError",ir({global:!0,forced:O.globalThis!==O},{globalThis:O}),Sf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Sf.devicePixelRatio;var el=TypeError,rl=Object.getOwnPropertyDescriptor,nl=pt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(yi(t)&&!rl(t,"length").writable)throw el("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ol=TypeError,il=function(t){if(t>9007199254740991)throw ol("Maximum allowed index exceeded");return t},al=Pi("splice"),ul=Math.max,sl=Math.min;ir({target:"Array",proto:!0,forced:!al},{splice:function(t,e){var r,n,o,i,a,u,s=W(this),c=Fe(s),f=Ce(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=sl(ul(Me(e),0),c-f)),il(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&Ii(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ls(s,u);for(i=c;i>c-n+r;i--)ls(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ls(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return nl(s,c-n+r),o}});var cl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),fl=Object.assign,ll=Object.defineProperty,hl=R([].concat),pl=!fl||j((function(){if(pt&&1!==fl({b:1},fl(ll({},"a",{enumerable:!0,get:function(){ll(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=fl({},t)[r]||"abcdefghijklmnopqrst"!=Hi(fl({},e)).join("")}))?function(t,e){for(var r=W(t),n=arguments.length,o=1,i=Ze.f,a=Ee.f;n>o;)for(var u,s=Se(arguments[o++]),c=i?hl(Hi(s),i(s)):Hi(s),f=c.length,l=0;f>l;)u=c[l++],pt&&!St(a,s,u)||(r[u]=s[u]);return r}:fl;ir({target:"Object",stat:!0,arity:2,forced:Object.assign!==pl},{assign:pl});var vl=Ei.findIndex,dl=!0;"findIndex"in[]&&Array(1).findIndex((function(){dl=!1})),ir({target:"Array",proto:!0,forced:dl},{findIndex:function(t){return vl(this,t,arguments.length>1?arguments[1]:void 0)}}),oa("findIndex");var yl=Lf.charAt,gl=ce.set,ml=ce.getterFor("String Iterator");wa(String,"String",(function(t){gl(this,{type:"String Iterator",string:rf(t),index:0})}),(function(){var t,e=ml(this),r=e.string,n=e.index;return n>=r.length?Ea(void 0,!0):(t=yl(r,n),e.index+=t.length,Ea(t,!1))}));var xl=qe.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],wl={f:function(t){return bl&&"Window"==ve(t)?function(t){try{return xl(t)}catch(t){return yu(bl)}}(t):xl(Te(t))}},El=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Al=Object.isExtensible,Ol=j((function(){Al(1)}))||El?function(t){return!!dt(t)&&((!El||"ArrayBuffer"!=ve(t))&&(!Al||Al(t)))}:Al,Sl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),Tl=b((function(t){var e=Ut.f,r=!1,n=V("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=qe.f,e=R([].splice),o={};o[n]=1,t(o).length&&(qe.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ir({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wl.f}))},fastKey:function(t,e){if(!dt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!B(t,n)){if(!Ol(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!B(t,n)){if(!Ol(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Sl&&r&&Ol(t)&&!B(t,n)&&i(t),t}};oe[n]=!0})),kl=(Tl.enable,Tl.fastKey,Tl.getWeakData,Tl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=R(u[t]);le(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!dt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(nr(t,!$(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Tl.enable();else if(nr(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=_o((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){yr(t,u);var r=ss(new a,t,s);return C(e)||To(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ir({global:!0,constructor:!0,forced:s!=a},c),hr(s,t),o||r.setStrong(s,t,n),s}),Il=Tl.getWeakData,jl=ce.set,Pl=ce.getterFor,_l=Ei.find,Ml=Ei.findIndex,Ll=R([].splice),Rl=0,Cl=function(t){return t.frozen||(t.frozen=new Nl)},Nl=function(){this.entries=[]},Dl=function(t,e){return _l(t.entries,(function(t){return t[0]===e}))};Nl.prototype={get:function(t){var e=Dl(this,t);if(e)return e[1]},has:function(t){return!!Dl(this,t)},set:function(t,e){var r=Dl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ml(this.entries,(function(e){return e[0]===t}));return~e&&Ll(this.entries,e,1),!!~e}};var Fl,Wl={getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),jl(t,{type:e,id:Rl++,frozen:void 0}),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Pl(e),u=function(t,e,r){var n=a(t),o=Il(At(e),!0);return!0===o?Cl(n).set(e,r):o[n.id]=r,t};return ru(i,{delete:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).delete(t):r&&B(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).has(t):r&&B(r,e.id)}}),ru(i,r?{get:function(t){var e=a(this);if(dt(t)){var r=Il(t);return!0===r?Cl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},zl=ce.enforce,Bl=!O.ActiveXObject&&"ActiveXObject"in O,Ul=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gl=kl("WeakMap",Ul,Wl);if(Jt&&Bl){Fl=Wl.getConstructor(Ul,"WeakMap",!0),Tl.enable();var Hl=Gl.prototype,Vl=R(Hl.delete),ql=R(Hl.has),Zl=R(Hl.get),Yl=R(Hl.set);ru(Hl,{delete:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),Vl(this,t)||e.frozen.delete(t)}return Vl(this,t)},has:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)||e.frozen.has(t)}return ql(this,t)},get:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)?Zl(this,t):e.frozen.get(t)}return Zl(this,t)},set:function(t,e){if(dt(t)&&!Ol(t)){var r=zl(this);r.frozen||(r.frozen=new Fl),ql(this,t)?Yl(this,t,e):r.frozen.set(t,e)}else Yl(this,t,e);return this}})}var $l=ft("iterator"),Kl=ft("toStringTag"),Ql=Ta.values,Xl=function(t,e){if(t){if(t[$l]!==Ql)try{ee(t,$l,Ql)}catch(e){t[$l]=Ql}if(t[Kl]||ee(t,Kl,e),hi[e])for(var r in Ta)if(t[r]!==Ta[r])try{ee(t,r,Ta[r])}catch(e){t[r]=Ta[r]}}};for(var Jl in hi)Xl(O[Jl]&&O[Jl].prototype,Jl);Xl(di,"DOMTokenList");var th,eh,rh,nh,oh=new WeakMap,ih=function(){function t(){i(this,t),oh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=oh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),oh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=oh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=oh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ah=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(ih));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var uh=my.getSystemInfoSync();th=uh.screenWidth,eh=uh.screenHeight,rh=uh.windowWidth,nh=uh.windowHeight}else{var sh=Sf.innerWidth,ch=Sf.innerHeight;th=sh,eh=ch,rh=sh,nh=ch}var fh={width:th,height:eh,availWidth:rh,availHeight:nh,availLeft:0,availTop:0},lh=fh.availWidth,hh=fh.availHeight,ph={style:[]};function vh(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function dh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:lh+"px",height:hh+"px",margin:"0px",padding:"0px"})}function yh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=lh,t.clientHeight=hh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function gh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=lh,t.offsetHeight=hh)}function mh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=lh,t.scrollHeight=hh)}function xh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var wh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),vh(h(t),o),dh(h(t)),xh(h(t)),yh(h(t)),gh(h(t)),mh(h(t)),t}return u(r)}(ah),Eh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(wh)),Ah={};function Oh(){return Ah}var Sh=u((function t(){i(this,t);var e=Oh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),vh(r),xh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Th={href:"",protocol:"",host:""},kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),Ih=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),jh={},Ph={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Th,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Sh:"video"===t?new Eh:new wh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){jh[t]||(jh[t]=[]),jh[t].push(e)},removeEventListener:function(t,e){var r=jh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=jh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new cl(t)}};Ph.documentElement=new Ih,Ph.head=new wh("head"),Ph.body=new kh,If("match",(function(t,e,r){return[function(e){var r=D(this),n=C(e)?void 0:Lt(e,t);return n?St(n,e,r):new RegExp(e)[t](rf(r))},function(t){var n=At(this),o=rf(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Hf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Hf(n,o));){var f=rf(u[0]);s[c]=f,""===f&&(n.lastIndex=Cf(o,De(n.lastIndex),a)),c++}return 0===c?null:s}]}));var _h,Mh,Lh=ft("isConcatSpreadable"),Rh=nt>=51||!j((function(){var t=[];return t[Lh]=!1,t.concat()[0]!==t})),Ch=Pi("concat"),Nh=function(t){if(!dt(t))return!1;var e=t[Lh];return void 0!==e?!!e:yi(t)};if(ir({target:"Array",proto:!0,arity:1,forced:!Rh||!Ch},{concat:function(t){var e,r,n,o,i,a=W(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Nh(i=-1===e?a:arguments[e]))for(o=Fe(i),il(s+o),r=0;r<o;r++,s++)r in i&&Ii(u,s,i[r]);else il(s+1),Ii(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Dh=my.getSystemInfoSync();_h=Dh.system,Dh.platform,Dh.language}else{var Fh={versions:(Mh=Sf.navigator.userAgent,{trident:Mh.indexOf("Trident")>-1,presto:Mh.indexOf("Presto")>-1,webKit:Mh.indexOf("AppleWebKit")>-1,gecko:Mh.indexOf("Gecko")>-1&&-1===Mh.indexOf("KHTML"),mobile:!!Mh.match(/AppleWebKit.*Mobile.*/),ios:!!Mh.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Mh.indexOf("Android")>-1||Mh.indexOf("Linux")>-1,iPhone:Mh.indexOf("iPhone")>-1,iPad:Mh.indexOf("iPad")>-1,webApp:-1===Mh.indexOf("Safari"),weixin:Mh.indexOf("MicroMessenger")>-1,qq:" qq"===Mh.match(/\\sQQ/i)}),language:(Sf.navigator.browserLanguage||Sf.navigator.language).toLowerCase()};Fh.versions.android?"android":Fh.versions.trident?"IE":Fh.versions.presto?"Opera":Fh.versions.webKit?"webKit":Fh.versions.gecko?"Firefox":Fh.versions.mobile?"mobile":Fh.versions.ios?"ios":Fh.versions.iPhone?"iPhone":Fh.versions.iPad?"ipad":Fh.versions.webApp?"webApp":Fh.versions.weixin?"weixin":Fh.versions.qq&&"qq",_h=Sf.navigator.userAgent,Fh.language}_h.toLowerCase().indexOf("android");cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Wh=Ut.f,zh=Tl.fastKey,Bh=ce.set,Uh=ce.getterFor;kl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),Bh(t,{type:e,index:Qi(null),first:void 0,last:void 0,size:0}),pt||(t.size=0),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Uh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=zh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),pt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=zh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return ru(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,pt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),pt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=zr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),ru(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),pt&&Wh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Uh(e),i=Uh(n);wa(t,e,(function(t,e){Bh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?Ea("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,Ea(void 0,!0))}),r?"entries":"values",!r,!0),vr(e)}});var Gh=R([].join),Hh=Se!=Object,Vh=Ai("join",",");ir({target:"Array",proto:!0,forced:Hh||!Vh},{join:function(t){return Gh(Te(this),void 0===t?",":t)}});var qh=j((function(){Hi(1)}));ir({target:"Object",stat:!0,forced:qh},{keys:function(t){return Hi(W(t))}});var Zh=new Map,Yh=new Map,$h=new Map,Kh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Zh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=$h.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Yh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Yh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Zh.get("requestHeader");r[t]=e,Zh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(ih);s(Kh,"UNSEND",void 0),s(Kh,"OPENED",void 0),s(Kh,"HEADERS_RECEIVED",void 0),s(Kh,"LOADING",void 0),s(Kh,"DONE",void 0),Kh.UNSEND=0,Kh.OPENED=1,Kh.HEADERS_RECEIVED=2,Kh.LOADING=3,Kh.DONE=4;var Qh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Xh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Jh=Qh||Xh;Jh||Sf.XMLHttpRequest,Jh||Sf.location;function tp(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var ep=Ei.filter,rp=Pi("filter");function np(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function op(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ip(t){return t.filter?[1]:[0]}function ap(t,e){return[e]}ir({target:"Array",proto:!0,forced:!rp},{filter:function(t){return ep(this,t,arguments.length>1?arguments[1]:void 0)}});var up=cp,sp=cp;function cp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=fp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=fp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(wp(s));for(c.sort(gp),o=0;o<c.length;o++)r=mp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return hp(h,p,r,n,o,c,0),p}function fp(t,e,r,n,o){var i,a;if(o===Rp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=_p(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=_p(i,t[i],t[i+1],a);return a&&Sp(a,a.next)&&(Mp(a),a=a.next),a}function lp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Sp(n,n.next)&&0!==Op(n.prev,n,n.next))n=n.next;else{if(Mp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function hp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=bp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?vp(t,n,o,i):pp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Mp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?hp(t=dp(lp(t),e,r),e,r,n,o,i,2):2===a&&yp(t,e,r,n,o,i):hp(lp(t),e,r,n,o,i,1);break}}}function pp(t){var e=t.prev,r=t,n=t.next;if(Op(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ep(o,u,i,s,a,c,v.x,v.y)&&Op(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Op(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=bp(p,v,e,r,n),m=bp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Sp(o,i)&&Tp(o,n,n.next,i)&&jp(o,i)&&jp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Mp(n),Mp(n.next),n=t=i),n=n.next}while(n!==t);return lp(n)}function yp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Ap(a,u)){var s=Pp(a,u);return a=lp(a,a.next),s=lp(s,s.next),hp(a,e,r,n,o,i,0),void hp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function gp(t,e){return t.x-e.x}function mp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ep(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),jp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=Pp(r,t);return lp(n,n.next),lp(r,r.next)}function xp(t,e){return Op(t.prev,t,e.prev)<0&&Op(e.next,t,t.next)<0}function bp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ep(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Ap(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Tp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Op(t.prev,t,e.prev)||Op(t,e.prev,e))||Sp(t,e)&&Op(t.prev,t,t.next)>0&&Op(e.prev,e,e.next)>0)}function Op(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Sp(t,e){return t.x===e.x&&t.y===e.y}function Tp(t,e,r,n){var o=Ip(Op(t,e,r)),i=Ip(Op(t,e,n)),a=Ip(Op(r,n,t)),u=Ip(Op(r,n,e));return o!==i&&a!==u||(!(0!==o||!kp(t,r,e))||(!(0!==i||!kp(t,n,e))||(!(0!==a||!kp(r,t,n))||!(0!==u||!kp(r,e,n)))))}function kp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ip(t){return t>0?1:t<0?-1:0}function jp(t,e){return Op(t.prev,t,t.next)<0?Op(t,e,t.next)>=0&&Op(t,t.prev,e)>=0:Op(t,e,t.prev)<0||Op(t,t.next,e)<0}function Pp(t,e){var r=new Lp(t.i,t.x,t.y),n=new Lp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function _p(t,e,r,n){var o=new Lp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Mp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}cp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Rp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Rp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},cp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},up.default=sp;var Cp=R(1..valueOf),Np=R("".replace),Dp="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",Fp=RegExp("^"+Dp+Dp+"*"),Wp=RegExp(Dp+Dp+"*$"),zp=function(t){return function(e){var r=rf(D(e));return 1&t&&(r=Np(r,Fp,"")),2&t&&(r=Np(r,Wp,"")),r}},Bp={start:zp(1),end:zp(2),trim:zp(3)},Up=qe.f,Gp=Ie.f,Hp=Ut.f,Vp=Bp.trim,qp=O.Number,Zp=qp.prototype,Yp=O.TypeError,$p=R("".slice),Kp=R("".charCodeAt),Qp=function(t){var e=Dt(t,"number");return"bigint"==typeof e?e:Xp(e)},Xp=function(t){var e,r,n,o,i,a,u,s,c=Dt(t,"number");if(It(c))throw Yp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Vp(c),43===(e=Kp(c,0))||45===e){if(88===(r=Kp(c,2))||120===r)return NaN}else if(48===e){switch(Kp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=$p(c,2)).length,u=0;u<a;u++)if((s=Kp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(nr("Number",!qp(" 0o1")||!qp("0b1")||qp("+0x1"))){for(var Jp,tv=function(t){var e=arguments.length<1?0:qp(Qp(t)),r=this;return Tt(Zp,r)&&j((function(){Cp(r)}))?ss(Object(e),r,tv):e},ev=pt?Up(qp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),rv=0;ev.length>rv;rv++)B(qp,Jp=ev[rv])&&!B(tv,Jp)&&Hp(tv,Jp,Gp(qp,Jp));tv.prototype=Zp,Zp.constructor=tv,le(O,"Number",tv,{constructor:!0})}var nv=RangeError,ov=RangeError,iv=String,av=Math.floor,uv=R((function(t){var e=rf(D(this)),r="",n=Me(t);if(n<0||n==1/0)throw nv("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),sv=R("".slice),cv=R(1..toFixed),fv=function(t,e,r){return 0===e?r:e%2==1?fv(t,e-1,r*t):fv(t*t,e/2,r)},lv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=av(o/1e7)},hv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=av(n/e),n=n%e*1e7},pv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=iv(t[e]);r=""===r?n:r+uv("0",7-n.length)+n}return r},vv=j((function(){return"0.000"!==cv(8e-5,3)||"1"!==cv(.9,0)||"1.25"!==cv(1.255,2)||"1000000000000000128"!==cv(0xde0b6b3a7640080,0)}))||!j((function(){cv({})}));function dv(t){return"number"==typeof t}function yv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ir({target:"Number",proto:!0,forced:vv},{toFixed:function(t){var e,r,n,o,i=Cp(this),a=Me(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw ov("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return iv(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*fv(2,69,1))-69)<0?i*fv(2,-e,1):i/fv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(lv(u,0,r),n=a;n>=7;)lv(u,1e7,0),n-=7;for(lv(u,fv(10,n,1),0),n=e-1;n>=23;)hv(u,1<<23),n-=23;hv(u,1<<n),lv(u,1,1),hv(u,2),c=pv(u)}else lv(u,0,r),lv(u,1<<-e,0),c=pv(u)+uv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+uv("0",a-o)+c:sv(c,0,o-a)+"."+sv(c,o-a)):s+c}});var gv,mv=/"/g,xv=R("".replace);ir({target:"String",proto:!0,forced:(gv="sub",j((function(){var t=""[gv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=rf(D(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+xv(rf(r),mv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var bv=RegExp.prototype,wv=qt.PROPER,Ev=RegExp.prototype.toString,Av=j((function(){return"/a/b"!=Ev.call({source:"a",flags:"b"})})),Ov=wv&&"toString"!=Ev.name;(Av||Ov)&&le(RegExp.prototype,"toString",(function(){var t=At(this);return"/"+rf(t.source)+"/"+rf(function(t){var e=t.flags;return void 0!==e||"flags"in bv||B(t,"flags")||!Tt(bv,t)?e:St(nf,t)}(t))}),{unsafe:!0});var Sv="undefined"!=typeof Float32Array?Float32Array:Array;function Tv(){var t=new Sv(2);return Sv!=Float32Array&&(t[0]=0,t[1]=0),t}function kv(t,e){var r=new Sv(2);return r[0]=t,r[1]=e,r}function Iv(t,e){return t[0]=e[0],t[1]=e[1],t}function jv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Pv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function _v(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Mv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Lv,Rv=Pv,Cv=(Lv=Tv(),Tv()),Nv=(Tv(),Tv()),Dv=Tv(),Fv=Tv();function Wv(t,e,r,n,o){return jv(t,r,n),_v(t,t),[o/Mv(e=kv(-t[1],t[0]),kv(-r[1],r[0])),e]}function zv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Bv(t,e,r){return Rv(t,e,r),_v(t,t),t}function Uv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Gv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",kv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=yv([a[0],a[1]]),g=yv([i[0],i[1]]);Bv(Nv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,h){var x=Tv(),b=Tv();jv(x,this.normal,Nv),jv(b,this.normal,Nv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Uv(n,o)&&jv(o,n,_v(o,Pv(o,n,r))),Bv(Dv,o,n);var w=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),E=w[0],A=w[1],O=Mv(Fv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,Iv(this.normal,A),s+=2),this.lastFlip=O}else{if(zv(this.normal,Nv),h){var T=Tv(),k=Tv();Rv(k,Nv,this.normal),jv(T,Nv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=yv([n[0],n[1]]),f=yv([r[0],r[1]]);Bv(Nv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=yv([o[0],o[1]]);Uv(c,h)&&jv(h,c,_v(h,Pv(h,c,f))),Bv(Dv,h,c);var p=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),v=p[0],g=p[1];Mv(Fv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,Iv(this.normal,g),i+=2,this.lastFlip=-1}else zv(this.normal,Nv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=yv([n[0],n[1]]),h=yv([r[0],r[1]]);Bv(Nv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,c){var v=Tv(),g=Tv();jv(v,this.normal,Nv),jv(g,this.normal,Nv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=yv([o[0],o[1]]);Uv(l,m)&&jv(m,l,_v(m,Pv(m,l,h))),Bv(Dv,m,l);var x=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),b=x[0],w=x[1],E=Mv(Fv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,Iv(this.normal,w),i+=2),this.lastFlip=E}else{if(zv(this.normal,Nv),c){var O=Tv(),S=Tv();Rv(S,Nv,this.normal),jv(O,Nv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Hv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Gv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Vv(t){var e=function(t){if(dv(t[0]))return t;if(dv(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(dv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function qv(t){var e=t.coordinates,r=up.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:up(n,i,o),vertices:n,size:o}}var Zv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Hv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Zv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},$v=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Yv);function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!$v[n]){t.next=3;break}return t.abrupt("return",$v[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return fi(Kv),t.WorkerSourceMap=Yv,t.createWorker=fi,t.worker=Kv,t}({});
`,sl="l7-worker",e0=3,wh=!0;function X0(n){Fp(sl,n)}function Y0(){var n=_d(sl);if(!n)throw new Error("get worker failed by workerName: ".concat(sl,"."));return n}function Rp(n,l){return Hl.apply(this,arguments)}function Hl(){return Hl=(0,J.Z)(ot().mark(function n(l,a){var s,u,h,v,m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return s=Y0(),u=Jf.getWorkerFarm({maxConcurrency:e0,reuseWorkers:wh}),h=u.getWorkerPool({name:sl,source:s}),A.next=5,h.startJob(sl,function(R,B,G){return R.done(G)});case 5:return v=A.sent,v.postMessage("process",{input:{workerType:l,data:a}}),A.next=9,v.result;case 9:return m=A.sent,A.abrupt("return",m.result);case 11:case"end":return A.stop()}},n)})),Hl.apply(this,arguments)}X0(cs);var Mu={BACK:1029,FRONT:1028};function bc(n){switch(n){case"GAODE1.x":return Mu.BACK;case"GAODE2.x":return Mu.BACK;case"MAPBOX":return Mu.FRONT;case"SIMPLE":return Mu.FRONT;case"GLOBEL":return Mu.BACK;case"DEBAULT":return Mu.FRONT;default:return Mu.FRONT}}function Iu(n){return typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap}function Lf(){return typeof importScripts=="function"}var Rg=Lf()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href};function xd(n,l){l===void 0&&(l={});var a=Number(n[0]),s=Number(n[1]),u=Number(n[2]),h=Number(n[3]);if(n.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var v=[a,s],m=[a,h],w=[u,h],A=[u,s];return rc([[v,A,w,m,v]],l.properties,{bbox:n,id:l.id})}var jl;(function(n){n.Realtime="realtime",n.Overlap="overlap",n.Replace="replace"})(jl||(jl={}));var ku;(function(n){n.Loading="Loading",n.Loaded="Loaded",n.Failure="Failure",n.Cancelled="Cancelled"})(ku||(ku={}));var Sh=0,lc=1,Yh=2;function r0(n){n.forEach(function(l){l.isCurrent&&(l.isVisible=l.isLoaded)})}function lv(n){n.forEach(function(l){l.properties.state=Sh}),n.forEach(function(l){l.isCurrent&&!ko(l)&&Pf(l)}),n.forEach(function(l){l.isVisible=Boolean(l.properties.state&Yh)})}function n0(n){n.forEach(function(a){a.properties.state=Sh}),n.forEach(function(a){a.isCurrent&&ko(a)});var l=n.slice().sort(function(a,s){return a.z-s.z});l.forEach(function(a){a.isVisible=Boolean(a.properties.state&Yh),a.children.length&&(a.isVisible||a.properties.state&lc)?a.children.forEach(function(s){s.properties.state=lc}):a.isCurrent&&Pf(a)})}function ko(n){for(;n;){if(n.isLoaded)return n.properties.state|=Yh,!0;n=n.parent}return!1}function Pf(n){n.children.forEach(function(l){l.isLoaded?l.properties.state|=Yh:Pf(l)})}var Is,ul=256,cv=[-1/0,-1/0,1/0,1/0],$0=.2,Dg=5,Bg=(Is={},(0,W.Z)(Is,jl.Realtime,r0),(0,W.Z)(Is,jl.Overlap,lv),(0,W.Z)(Is,jl.Replace,n0),Is),fv=function(){};function hv(n,l,a){var s=Math.floor((n+180)/360*Math.pow(2,a)),u=Math.floor((1-Math.log(Math.tan(l*Math.PI/180)+1/Math.cos(l*Math.PI/180))/Math.PI)/2*Math.pow(2,a));return[s,u]}function i0(n,l,a){var s=n/Math.pow(2,a)*360-180,u=Math.PI-2*Math.PI*l/Math.pow(2,a),h=180/Math.PI*Math.atan(.5*(Math.exp(u)-Math.exp(-u)));return[s,h]}var a0=function(l,a,s){var u=i0(l,a,s),h=(0,yt.Z)(u,2),v=h[0],m=h[1],w=i0(l+1,a+1,s),A=(0,yt.Z)(w,2),R=A[0],B=A[1];return[v,B,R,m]};function Ch(n){var l=n.zoom,a=n.latLonBounds,s=n.maxZoom,u=s===void 0?1/0:s,h=n.minZoom,v=h===void 0?0:h,m=n.zoomOffset,w=m===void 0?0:m,A=n.extent,R=A===void 0?cv:A,B=Math.ceil(l)+w;if(Number.isFinite(v)&&B<v)return[];Number.isFinite(u)&&B>u&&(B=u);for(var G=(0,yt.Z)(a,4),j=G[0],lt=G[1],ct=G[2],_t=G[3],Zt=[Math.max(j,R[0]),Math.max(lt,R[1]),Math.min(ct,R[2]),Math.min(_t,R[3])],pe=[],fe=hv(Zt[0],Zt[1],B),Ze=(0,yt.Z)(fe,2),Qe=Ze[0],wr=Ze[1],Lr=hv(Zt[2],Zt[3],B),Vr=(0,yt.Z)(Lr,2),Wr=Vr[0],bn=Vr[1],hn=Qe;hn<=Wr;hn++)for(var Wn=bn;Wn<=wr;Wn++)pe.push({x:hn,y:Wn,z:B});var vi=(Wr+Qe)/2,$i=(wr+bn)/2,go=function(zs,cu){return Math.abs(zs-vi)+Math.abs(cu-$i)};return pe.sort(function(zo,zs){return go(zo.x,zo.y)-go(zs.x,zs.y)}),pe}var o0=function(l,a,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,h=Math.pow(2,s),v=h-1,m=h,w=l,A=a;return u&&(w<0?w=w+m:w>v&&(w=w%m)),{warpX:w,warpY:A}};function pv(n){var l=Ah();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Ah(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ns=function(n){(0,zt.Z)(a,n);var l=pv(a);function a(s){var u;(0,pt.Z)(this,a),u=l.call(this),(0,W.Z)((0,ut.Z)(u),"tileSize",256),(0,W.Z)((0,ut.Z)(u),"isVisible",!1),(0,W.Z)((0,ut.Z)(u),"isCurrent",!1),(0,W.Z)((0,ut.Z)(u),"isVisibleChange",!1),(0,W.Z)((0,ut.Z)(u),"loadedLayers",0),(0,W.Z)((0,ut.Z)(u),"isLayerLoaded",!1),(0,W.Z)((0,ut.Z)(u),"isLoad",!1),(0,W.Z)((0,ut.Z)(u),"isChildLoad",!1),(0,W.Z)((0,ut.Z)(u),"parent",null),(0,W.Z)((0,ut.Z)(u),"children",[]),(0,W.Z)((0,ut.Z)(u),"data",null),(0,W.Z)((0,ut.Z)(u),"properties",{}),(0,W.Z)((0,ut.Z)(u),"loadDataId",0);var h=s.x,v=s.y,m=s.z,w=s.tileSize,A=s.warp,R=A===void 0?!0:A;return u.x=h,u.y=v,u.z=m,u.warp=R||!0,u.tileSize=w,u}return(0,et.Z)(a,[{key:"isLoading",get:function(){return this.loadStatus===ku.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===ku.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===ku.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===ku.Cancelled}},{key:"isDone",get:function(){return[ku.Loaded,ku.Cancelled,ku.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return a0(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var u=(0,yt.Z)(this.bounds,4),h=u[0],v=u[1],m=u[2],w=u[3],A=[(m-h)/2,(w-v)/2],R=xd(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:A,meta:`
      `.concat(this.key,`
      `)}});return R}},{key:"key",get:function(){var u="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return u}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze,Qe,wr,Lr;return ot().wrap(function(Wr){for(;;)switch(Wr.prev=Wr.next){case 0:return m=v.getData,w=v.onLoad,A=v.onError,this.loadDataId++,R=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=ku.Loading,B=null,Wr.prev=7,j=this.x,lt=this.y,ct=this.z,_t=this.bounds,Zt=this.tileSize,pe=this.warp,fe=o0(j,lt,ct,pe),Ze=fe.warpX,Qe=fe.warpY,wr=this.abortController.signal,Lr={x:Ze,y:Qe,z:ct,bounds:_t,tileSize:Zt,signal:wr,warp:pe},Wr.next=14,m(Lr,this);case 14:B=Wr.sent,Wr.next=20;break;case 17:Wr.prev=17,Wr.t0=Wr.catch(7),G=Wr.t0;case 20:if(R===this.loadDataId){Wr.next=22;break}return Wr.abrupt("return");case 22:if(!(this.isCancelled&&!B)){Wr.next=24;break}return Wr.abrupt("return");case 24:if(!(G||!B)){Wr.next=28;break}return this.loadStatus=ku.Failure,A(G,this),Wr.abrupt("return");case 28:this.loadStatus=ku.Loaded,this.data=B,w(this);case 31:case"end":return Wr.stop()}},h,this,[[7,17]])}));function u(h){return s.apply(this,arguments)}return u}()},{key:"reloadData",value:function(u){this.isLoading&&this.abortLoad(),this.loadData(u)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=ku.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),a}(Ee.EventEmitter),dv=function(l,a){var s=Qi(l),u=fu(s,a),h=360*3-180,v=85.0511287798065,m=[Math.max(u[0][0],-h),Math.max(u[0][1],-v),Math.min(u[1][0],h),Math.min(u[1][1],v)];return m},cc=function(l,a){var s=Qi(l),u=Qi(a),h=Sl(s,u);return h};function fc(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=s0(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function s0(n,l){if(n){if(typeof n=="string")return $h(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $h(n,l)}}function $h(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function It(n){var l=Re();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Re(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dr=function(n){(0,zt.Z)(a,n);var l=It(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this),(0,W.Z)((0,ut.Z)(u),"currentTiles",[]),(0,W.Z)((0,ut.Z)(u),"cacheTiles",new Map),(0,W.Z)((0,ut.Z)(u),"throttleUpdate",(0,ne.throttle)(function(h,v){u.update(h,v)},16)),(0,W.Z)((0,ut.Z)(u),"onTileLoad",function(h){u.emit("tile-loaded",h),u.updateTileVisible()}),(0,W.Z)((0,ut.Z)(u),"onTileError",function(h,v){u.emit("tile-error",{error:h,tile:v}),u.updateTileVisible()}),(0,W.Z)((0,ut.Z)(u),"onTileUnload",function(h){u.emit("tile-unload",h)}),u.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:cv,getTileData:fv,warp:!0,updateStrategy:jl.Overlap},u.updateOptions(s),u}return(0,et.Z)(a,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(u){return u.isDone})}},{key:"tiles",get:function(){var u=Array.from(this.cacheTiles.values()).sort(function(h,v){return h.z-v.z});return u}},{key:"updateOptions",value:function(u){var h=u.minZoom===void 0?this.options.minZoom:Math.ceil(u.minZoom),v=u.maxZoom===void 0?this.options.maxZoom:Math.floor(u.maxZoom);this.options=(0,K.Z)((0,K.Z)((0,K.Z)({},this.options),u),{},{minZoom:h,maxZoom:v})}},{key:"update",value:function(u,h){var v=this,m=Math.max(0,Math.ceil(u));if(!(this.lastViewStates&&this.lastViewStates.zoom===m&&cc(this.lastViewStates.latLonBoundsBuffer,h))){var w=dv(h,$0);this.lastViewStates={zoom:m,latLonBounds:h,latLonBoundsBuffer:w};var A=!1,R=this.getTileIndices(m,w).filter(function(B){return v.options.warp||B.x>=0&&B.x<Math.pow(2,m)});this.currentTiles=R.map(function(B){var G=B.x,j=B.y,lt=B.z,ct=v.getTile(G,j,lt);if(ct){var _t,Zt,pe=((_t=ct)===null||_t===void 0?void 0:_t.isFailure)||((Zt=ct)===null||Zt===void 0?void 0:Zt.isCancelled);return pe&&ct.loadData({getData:v.options.getTileData,onLoad:v.onTileLoad,onError:v.onTileError}),ct}return ct=v.createTile(G,j,lt),A=!0,ct}),A&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var u=fc(this.cacheTiles),h;try{for(u.s();!(h=u.n()).done;){var v=(0,yt.Z)(h.value,2),m=v[0],w=v[1];this.currentTiles.includes(w)||(this.cacheTiles.delete(m),this.onTileUnload(w)),this.onTileUnload(w),w.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(A){u.e(A)}finally{u.f()}}},{key:"pruneRequests",value:function(){var u=[],h=fc(this.cacheTiles.values()),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;m.isLoading&&!m.isCurrent&&!m.isVisible&&u.push(m)}}catch(A){h.e(A)}finally{h.f()}for(;u.length>0;){var w=u.shift();w.abortLoad()}}},{key:"getTileByLngLat",value:function(u,h,v){var m=this.options.zoomOffset,w=Math.ceil(v)+m,A=hv(u,h,w),R=this.tiles.filter(function(B){return B.key==="".concat(A[0],"_").concat(A[1],"_").concat(w)});return R[0]}},{key:"destroy",value:function(){var u=fc(this.cacheTiles.values()),h;try{for(u.s();!(h=u.n()).done;){var v=h.value;v.isLoading&&v.abortLoad()}}catch(m){u.e(m)}finally{u.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var u=this.options.updateStrategy,h=new Map,v=fc(this.cacheTiles.values()),m;try{for(v.s();!(m=v.n()).done;){var w=m.value;h.set(w.key,w.isVisible),w.isCurrent=!1,w.isVisible=!1}}catch(lt){v.e(lt)}finally{v.f()}var A=fc(this.currentTiles),R;try{for(A.s();!(R=A.n()).done;){var B=R.value;B.isCurrent=!0,B.isVisible=!0}}catch(lt){A.e(lt)}finally{A.f()}var G=Array.from(this.cacheTiles.values());typeof u=="function"?u(G):Bg[u](G);var j=!1;Array.from(this.cacheTiles.values()).forEach(function(lt){lt.isVisible!==h.get(lt.key)?(lt.isVisibleChange=!0,j=!0):lt.isVisibleChange=!1}),j&&this.emit("tile-update")}},{key:"getTileIndices",value:function(u,h){var v=this.options,m=v.tileSize,w=v.extent,A=v.zoomOffset,R=Math.floor(this.options.maxZoom),B=Math.ceil(this.options.minZoom),G=Ch({maxZoom:R,minZoom:B,zoomOffset:A,tileSize:m,zoom:u,latLonBounds:h,extent:w});return G}},{key:"getTileId",value:function(u,h,v){var m="".concat(u,",").concat(h,",").concat(v);return m}},{key:"getTile",value:function(u,h,v){var m=this.getTileId(u,h,v),w=this.cacheTiles.get(m);return w}},{key:"createTile",value:function(u,h,v){var m=this.getTileId(u,h,v),w=new ns({x:u,y:h,z:v,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(m,w),w.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),w}},{key:"resizeCacheTiles",value:function(){var u=Dg*this.currentTiles.length,h=this.cacheTiles.size>u;if(h){var v=fc(this.cacheTiles),m;try{for(v.s();!(m=v.n()).done;){var w=(0,yt.Z)(m.value,2),A=w[0],R=w[1];if(!R.isVisible&&!this.currentTiles.includes(R)&&(this.cacheTiles.delete(A),this.onTileUnload(R)),this.cacheTiles.size<=u)break}}catch(B){v.e(B)}finally{v.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var u=fc(this.cacheTiles.values()),h;try{for(u.s();!(h=u.n()).done;){var v=h.value;v.parent=null,v.children.length=0}}catch(B){u.e(B)}finally{u.f()}var m=fc(this.cacheTiles.values()),w;try{for(m.s();!(w=m.n()).done;){var A=w.value,R=this.getNearestAncestor(A.x,A.y,A.z);A.parent=R,R!=null&&R.children&&R.children.push(A)}}catch(B){m.e(B)}finally{m.f()}}},{key:"getNearestAncestor",value:function(u,h,v){for(;v>this.options.minZoom;){u=Math.floor(u/2),h=Math.floor(h/2),v=v-1;var m=this.getTile(u,h,v);if(m)return m}return null}}]),a}(ke());function ln(n){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(n)}function Ln(n){var l=[],a=/\{([a-z])-([a-z])\}/.exec(n);if(a){var s=a[1].charCodeAt(0),u=a[2].charCodeAt(0),h;for(h=s;h<=u;++h)l.push(n.replace(a[0],String.fromCharCode(h)));return l}if(a=/\{(\d+)-(\d+)\}/.exec(n),a){for(var v=parseInt(a[2],10),m=parseInt(a[1],10);m<=v;m++)l.push(n.replace(a[0],m.toString()));return l}return l.push(n),l}function on(n,l){if(!n||!n.length)throw new Error("url is not allowed to be empty");var a=l.x,s=l.y,u=l.z,h=Ln(n),v=Math.abs(a+s)%h.length,m=h[v];return m.replace(/\{x\}/g,a.toString()).replace(/\{y\}/g,s.toString()).replace(/\{z\}/g,u.toString()).replace(/\{bbox\}/g,a0(a,s,u).join(",")).replace(/\{-y\}/g,(Math.pow(2,u)-s-1).toString())}function En(n,l){var a=l.x,s=l.y,u=l.z,h=l.layer,v=l.version,m=v===void 0?"1.0.0":v,w=l.style,A=w===void 0?"default":w,R=l.format,B=l.service,G=B===void 0?"WMTS":B,j=l.tileMatrixset,lt="".concat(n,"&SERVICE=").concat(G,"&REQUEST=GetTile&VERSION=").concat(m,"&LAYER=").concat(h,"&STYLE=").concat(A,"&TILEMATRIXSET=").concat(j,"&FORMAT=").concat(R,"&TILECOL=").concat(a,"&TILEROW=").concat(s,"&TILEMATRIX=").concat(u);return lt}var jr;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.DEFAULT="DEFAUlTMAP",n.SIMPLE="SIMPLE",n.GLOBEL="GLOBEL"})(jr||(jr={}));function Xn(n,l,a,s,u){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,v=arguments.length>6?arguments[6]:void 0,m=a;return v&&(m=Math.round(a*(h-1))/(h-1)),s?yi(n,l,m,s,u):yi(n,l,m,.314,u)}function Yn(n,l){var a=1-l;return(n[0]*a+n[1]*l)*a+(n[1]*a+n[2]*l)*l}function ni(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function Jn(n,l,a){var s=[l[0]-n[0],l[1]-n[1]],u=ni(s,[0,0]),h=Math.atan2(s[1],s[0]),v=u/2/Math.cos(a),m=h+a,w=[v*Math.cos(m)+n[0],v*Math.sin(m)+n[1]];return w}function yi(n,l,a,s,u){if(u===Version["GAODE2.x"]){var h=amap2Project(n[0],n[1]),v=amap2Project(l[0],l[1]),m=Jn(h,v,s),w=[h[0],m[0],v[0]],A=[h[1],m[1],v[1]];return[].concat(_toConsumableArray(amap2UnProject(Yn(w,a),Yn(A,a))),[0])}else{var R=Jn(n,l,s),B=[n[0],R[0],l[0]],G=[n[1],R[1],l[1]];return[Yn(B,a),Yn(G,a),0]}}function qn(n,l,a,s,u){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,v=arguments.length>6?arguments[6]:void 0,m=a;return v&&(m=Math.round(a*29)/29),jn(n,l,m,u)}function ri(n,l){var a=[l[0]-n[0],l[1]-n[1]],s=calDistance(a,[0,0]),u=Math.atan2(a[1],a[0]),h=.314,v=s/2/Math.cos(h),m=u+h,w=[v*Math.cos(m)+n[0],v*Math.sin(m)+n[1]];return w}function Zr(n,l){var a=1-l;return(n[0]*a+n[1]*l)*a+(n[1]*a+n[2]*l)*l}function mn(n,l){var a=[n[0]-l[0],n[1]-l[1]],s=[Math.sin(a[0]/2),Math.sin(a[1]/2)],u=s[1]*s[1]+Math.cos(n[1])*Math.cos(l[1])*s[0]*s[0];return 2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}function jn(n,l,a,s){var u=[degreesToRadians(n[0]),degreesToRadians(n[1])],h=[degreesToRadians(l[0]),degreesToRadians(l[1])];if(s==="GAODE2.x"){var v=ri(u,h),m=[u[0],v[0],h[0]],w=[u[1],v[1],h[1]];return[Zr(m,a),Zr(w,a),0]}else{var A=mn(u,h);if(Math.abs(A-Math.PI)<.001)return[(1-a)*u[0]+a*h[0],(1-a)*u[1]+a*h[1]];var R=Math.sin((1-a)*A)/Math.sin(A),B=Math.sin(a*A)/Math.sin(A),G=[Math.sin(u[0]),Math.sin(u[1])],j=[Math.cos(u[0]),Math.cos(u[1])],lt=[Math.sin(h[0]),Math.sin(h[1])],ct=[Math.cos(h[0]),Math.cos(h[1])],_t=R*j[1]*j[0]+B*ct[1]*ct[0],Zt=R*j[1]*G[0]+B*ct[1]*lt[0],pe=R*G[1]+B*lt[1];return[radiansToDegrees(Math.atan2(Zt,_t)),radiansToDegrees(Math.atan2(pe,Math.sqrt(_t*_t+Zt*Zt)))]}}function gi(n,l){for(var a=0,s=[],u=0;u<n.length-1;u++){var h=n[u],v=n[u+1],m=ci(h,v),w=a;a+=m,s.push({p1:h,p2:v,totalDistance:a,distance:m,lastTotalDistance:w})}for(var A=a*l,R,B,G=0,j=s;G<j.length;G++){var lt=j[G],ct=lt.totalDistance;if(ct>A){var _t=lt.p1,Zt=lt.p2,pe=(A-lt.lastTotalDistance)/lt.distance,fe=Dn(Zt,_t,pe);R=fe[0],B=fe[1];break}}return{lng:R,lat:B,height:0}}function Dn(n,l,a){return[n[0]*a+l[0]*(1-a),n[1]*a+l[1]*(1-a)]}function ci(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function Mi(n,l){var a=l.featureId,s=n.data.dataArray;return typeof a=="number"&&(s=s.filter(function(u){var h=u.id;return h===a})),s.map(function(u){var h=wn(u,l);return _objectSpread(_objectSpread({},u),h)})}function la(n,l){return new Promise(function(a){n.inited?a(Mi(n,l)):n.once("update",function(){a(Mi(n,l))})})}function wn(n,l){var a=l.offset,s=l.shape,u=l.thetaOffset,h=l.mapVersion,v=l.segmentNumber,m=v===void 0?30:v,w=l.autoFit,A=w===void 0?!0:w,R=n.coordinates;if(s==="line")return pathLineAtOffset(R,a);var B=R[0],G=R[1],j=typeof u=="string"?n[u]||0:u,lt;switch(s){case"arc":lt=arcLineAtOffset;break;case"greatcircle":lt=greatCircleLineAtOffset;break;default:lt=arcLineAtOffset}var ct=lt(B,G,a,j,h,m,A),_t=_slicedToArray(ct,3),Zt=_t[0],pe=_t[1],fe=_t[2];return{lng:Zt,lat:pe,height:fe}}var In=nt(78962),Wi=nt.n(In);function bi(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Qn(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Qn(n,l){if(n){if(typeof n=="string")return pi(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return pi(n,l)}}function pi(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var hi=30;function Na(n){var l=n.characterSet,a=n.getFontWidth,s=n.fontHeight,u=n.buffer,h=n.maxCanvasWidth,v=n.mapping,m=v===void 0?{}:v,w=n.xOffset,A=w===void 0?0:w,R=n.yOffset,B=R===void 0?0:R,G=0,j=A;Array.from(l).forEach(function(ct,_t){if(!m[ct]){var Zt=a(ct,_t);j+hi>h&&(j=0,G++),m[ct]={x:j,y:B+G*hi,width:hi,height:hi,advance:Zt},j+=hi}});var lt=s+u*2;return{mapping:m,xOffset:j,yOffset:B+G*lt,canvasHeight:Li(B+(G+1)*lt)}}function wa(n,l,a){var s=0,u=0,h=0,v=[],m={},w=bi(n),A;try{for(w.s();!(A=w.n()).done;){var R=A.value;if(!m[R.id]){var B=R.size;s+B+l>a&&(Ei(m,v,u),s=0,u=h+u+l,h=0,v=[]),v.push({icon:R,xOffset:s}),s=s+B+l,h=Math.max(h,B)}}}catch(j){w.e(j)}finally{w.f()}v.length>0&&Ei(m,v,u);var G=Li(h+u+l);return{mapping:m,canvasHeight:G}}function Ei(n,l,a){var s=bi(l),u;try{for(s.s();!(u=s.n()).done;){var h=u.value,v=h.icon,m=h.xOffset;n[v.id]=(0,K.Z)((0,K.Z)({},v),{},{x:m,y:a,image:v.image,width:v.width,height:v.height})}}catch(w){s.e(w)}finally{s.f()}}function Li(n){return Math.pow(2,Math.ceil(Math.log2(n)))}var ga,Ta;function no(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=ws(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function ws(n,l){if(n){if(typeof n=="string")return Ss(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ss(n,l)}}function Ss(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function io(n){var l=Bo();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Bo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Es=ao(),du="sans-serif",Qo="normal",Lu=24,Vs=3,Gu=.25,ks=8,Da=1024,$s=1,bo=1,Pu=3,ha=null;function ao(){for(var n=[],l=32;l<128;l++)n.push(String.fromCharCode(l));return n}function wo(n,l,a,s){n.font="".concat(s," ").concat(a,"px ").concat(l),n.fillStyle="black",n.textBaseline="middle"}function Ds(n,l){for(var a=0;a<n.length;a++)l.data[4*a+3]=n[a]}var Wl=(ga=(0,Tt.b2)(),ga(Ta=function(n){(0,zt.Z)(a,n);var l=io(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"fontAtlas",void 0),(0,W.Z)((0,ut.Z)(s),"iconFontMap",void 0),(0,W.Z)((0,ut.Z)(s),"iconFontGlyphs",{}),(0,W.Z)((0,ut.Z)(s),"fontOptions",void 0),(0,W.Z)((0,ut.Z)(s),"key",void 0),(0,W.Z)((0,ut.Z)(s),"cache",new ld(Pu)),s}return(0,et.Z)(a,[{key:"scale",get:function(){return bo}},{key:"canvas",get:function(){var u=this.cache.get(this.key);return u&&u.data}},{key:"mapping",get:function(){var u=this.cache.get(this.key);return u&&u.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:du,fontWeight:Qo,characterSet:Es,fontSize:Lu,buffer:Vs,sdf:!0,cutoff:Gu,radius:ks,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(u){var h=this;u.forEach(function(v){h.iconFontGlyphs[v.name]=v.unicode})}},{key:"addIconFont",value:function(u,h){this.iconFontMap.set(u,h)}},{key:"getIconFontKey",value:function(u){return this.iconFontMap.get(u)||u}},{key:"getGlyph",value:function(u){return this.iconFontGlyphs[u]?String.fromCharCode(parseInt(this.iconFontGlyphs[u],16)):""}},{key:"setFontOptions",value:function(u){this.fontOptions=(0,K.Z)((0,K.Z)({},this.fontOptions),u),this.key=this.getKey();var h=this.getNewChars(this.key,this.fontOptions.characterSet),v=this.cache.get(this.key);if(!(v&&h.length===0)){var m=this.generateFontAtlas(this.key,h,v);this.fontAtlas=m,this.cache.set(this.key,m)}}},{key:"addFontFace",value:function(u,h){var v=this,m=document.createElement("style");m.type="text/css",m.innerText=`
        @font-face{
            font-family: '`.concat(u,`';
            src: url('`).concat(h,`') format('woff2'),
            url('`).concat(h,`') format('woff'),
            url('`).concat(h,`') format('truetype');
        }`),m.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(u),"L7text"),document.fonts.ready.then(function(){v.emit("fontloaded",{fontFamily:u})})}catch(w){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(w)}},document.getElementsByTagName("head")[0].appendChild(m)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(u,h,v){var m=this.fontOptions,w=m.fontFamily,A=m.fontWeight,R=m.fontSize,B=m.buffer,G=m.sdf,j=m.radius,lt=m.cutoff,ct=m.iconfont,_t=v&&v.data;_t||(_t=Ga.document.createElement("canvas"),_t.width=Da);var Zt=_t.getContext("2d",{willReadFrequently:!0});wo(Zt,w,R,A);var pe=Na((0,K.Z)({getFontWidth:function(Xu){return Zt.measureText(Xu).width},fontHeight:R*bo,buffer:B,characterSet:h,maxCanvasWidth:Da},v&&{mapping:v.mapping,xOffset:v.xOffset,yOffset:v.yOffset})),fe=pe.mapping,Ze=pe.canvasHeight,Qe=pe.xOffset,wr=pe.yOffset,Lr=Zt.getImageData(0,0,_t.width,_t.height);if(_t.height=Ze,Zt.putImageData(Lr,0,0),wo(Zt,w,R,A),G){var Vr=new(Wi())(R,B,j,lt,w,A),Wr=Zt.getImageData(0,0,Vr.size,Vr.size),bn=no(h),hn;try{for(bn.s();!(hn=bn.n()).done;){var Wn=hn.value;if(ct){var vi=String.fromCharCode(parseInt(Wn.replace("&#x","").replace(";",""),16)),$i=Vr.draw(vi);Ds($i,Wr)}else Ds(Vr.draw(Wn),Wr);Zt.putImageData(Wr,fe[Wn].x,fe[Wn].y)}}catch(cu){bn.e(cu)}finally{bn.f()}}else{var go=no(h),zo;try{for(go.s();!(zo=go.n()).done;){var zs=zo.value;Zt.fillText(zs,fe[zs].x,fe[zs].y+R*$s)}}catch(cu){go.e(cu)}finally{go.f()}}return{xOffset:Qe,yOffset:wr,mapping:fe,data:_t,width:_t.width,height:_t.height}}},{key:"getKey",value:function(){return"key";var u,h,v,m,w,A,R,B}},{key:"getNewChars",value:function(u,h){var v=this.cache.get(u);if(!v)return h;var m=[],w=v.mapping,A=new Set(Object.keys(w)),R=new Set(h);return R.forEach(function(B){A.has(B)||m.push(B)}),m}}]),a}(Ee.EventEmitter))||Ta),sr,fn;function rn(n){var l=Gi();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Gi(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var oo=3,tr=1024,Te=64,xr=(sr=(0,Tt.b2)(),sr(fn=function(n){(0,zt.Z)(a,n);var l=rn(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"canvasHeight",128),(0,W.Z)((0,ut.Z)(s),"texture",void 0),(0,W.Z)((0,ut.Z)(s),"canvas",void 0),(0,W.Z)((0,ut.Z)(s),"iconData",void 0),(0,W.Z)((0,ut.Z)(s),"iconMap",void 0),(0,W.Z)((0,ut.Z)(s),"ctx",void 0),(0,W.Z)((0,ut.Z)(s),"loadingImageCount",0),s}return(0,et.Z)(a,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=Ga.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var s=(0,J.Z)(ot().mark(function h(v,m){var w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return w=new Image,this.loadingImageCount++,this.hasImage(v)?console.warn("Image Id already exists"):this.iconData.push({id:v,size:Te}),this.updateIconMap(),B.next=6,this.loadImage(m);case 6:w=B.sent,A=this.iconData.find(function(G){return G.id===v}),A&&(A.image=w,A.width=w.width,A.height=w.height),this.update();case 10:case"end":return B.stop()}},h,this)}));function u(h,v){return s.apply(this,arguments)}return u}()},{key:"addImageMini",value:function(u,h,v){var m=this,w=v.getSceneConfig().canvas,A=w.createImage();if(this.loadingImageCount++,this.hasImage(u))throw new Error("Image Id already exists");this.iconData.push({id:u,size:Te}),this.updateIconMap(),this.loadImageMini(h,w).then(function(R){A=R;var B=m.iconData.find(function(G){return G.id===u});B&&(B.image=A,B.width=A.width,B.height=A.height),m.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(u){return this.iconMap.hasOwnProperty(u)}},{key:"removeImage",value:function(u){this.hasImage(u)&&(this.iconData=this.iconData.filter(function(h){return h.id!==u}),delete this.iconMap[u],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(u){return new Promise(function(h,v){if(u instanceof HTMLImageElement){h(u);return}var m=new Image;m.crossOrigin="anonymous",m.onload=function(){h(m)},m.onerror=function(){v(new Error("Could not load image at "+u))},m.src=u instanceof File?URL.createObjectURL(u):u})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var u=this;this.canvas.width=tr,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(h){var v=u.iconMap[h],m=v.x,w=v.y,A=v.image,R=v.width,B=R===void 0?64:R,G=v.height,j=G===void 0?64:G,lt=Math.max(B,j),ct=lt/Te,_t=j/ct,Zt=B/ct;A&&u.ctx.drawImage(A,m+(Te-Zt)/2,w+(Te-_t)/2,Zt,_t)})}},{key:"updateIconMap",value:function(){var u=wa(this.iconData,oo,tr),h=u.mapping,v=u.canvasHeight;this.iconMap=h,this.canvasHeight=v}},{key:"loadImageMini",value:function(u,h){return new Promise(function(v,m){var w=h.createImage();w.crossOrigin="anonymous",w.onload=function(){v(w)},w.onerror=function(){m(new Error("Could not load image at "+u))},w.src=u})}}]),a}(Ee.EventEmitter))||fn),kr=nt(96140);function $r(){var n=new kr.WT(16);return kr.WT!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function Ar(n){var l=new kr.WT(16);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l}function Ye(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n}function Rr(n,l,a,s,u,h,v,m,w,A,R,B,G,j,lt,ct){var _t=new kr.WT(16);return _t[0]=n,_t[1]=l,_t[2]=a,_t[3]=s,_t[4]=u,_t[5]=h,_t[6]=v,_t[7]=m,_t[8]=w,_t[9]=A,_t[10]=R,_t[11]=B,_t[12]=G,_t[13]=j,_t[14]=lt,_t[15]=ct,_t}function je(n,l,a,s,u,h,v,m,w,A,R,B,G,j,lt,ct,_t){return n[0]=l,n[1]=a,n[2]=s,n[3]=u,n[4]=h,n[5]=v,n[6]=m,n[7]=w,n[8]=A,n[9]=R,n[10]=B,n[11]=G,n[12]=j,n[13]=lt,n[14]=ct,n[15]=_t,n}function mr(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function rr(n,l){if(n===l){var a=l[1],s=l[2],u=l[3],h=l[6],v=l[7],m=l[11];n[1]=l[4],n[2]=l[8],n[3]=l[12],n[4]=a,n[6]=l[9],n[7]=l[13],n[8]=s,n[9]=h,n[11]=l[14],n[12]=u,n[13]=v,n[14]=m}else n[0]=l[0],n[1]=l[4],n[2]=l[8],n[3]=l[12],n[4]=l[1],n[5]=l[5],n[6]=l[9],n[7]=l[13],n[8]=l[2],n[9]=l[6],n[10]=l[10],n[11]=l[14],n[12]=l[3],n[13]=l[7],n[14]=l[11],n[15]=l[15];return n}function Mr(n,l){var a=l[0],s=l[1],u=l[2],h=l[3],v=l[4],m=l[5],w=l[6],A=l[7],R=l[8],B=l[9],G=l[10],j=l[11],lt=l[12],ct=l[13],_t=l[14],Zt=l[15],pe=a*m-s*v,fe=a*w-u*v,Ze=a*A-h*v,Qe=s*w-u*m,wr=s*A-h*m,Lr=u*A-h*w,Vr=R*ct-B*lt,Wr=R*_t-G*lt,bn=R*Zt-j*lt,hn=B*_t-G*ct,Wn=B*Zt-j*ct,vi=G*Zt-j*_t,$i=pe*vi-fe*Wn+Ze*hn+Qe*bn-wr*Wr+Lr*Vr;return $i?($i=1/$i,n[0]=(m*vi-w*Wn+A*hn)*$i,n[1]=(u*Wn-s*vi-h*hn)*$i,n[2]=(ct*Lr-_t*wr+Zt*Qe)*$i,n[3]=(G*wr-B*Lr-j*Qe)*$i,n[4]=(w*bn-v*vi-A*Wr)*$i,n[5]=(a*vi-u*bn+h*Wr)*$i,n[6]=(_t*Ze-lt*Lr-Zt*fe)*$i,n[7]=(R*Lr-G*Ze+j*fe)*$i,n[8]=(v*Wn-m*bn+A*Vr)*$i,n[9]=(s*bn-a*Wn-h*Vr)*$i,n[10]=(lt*wr-ct*Ze+Zt*pe)*$i,n[11]=(B*Ze-R*wr-j*pe)*$i,n[12]=(m*Wr-v*hn-w*Vr)*$i,n[13]=(a*hn-s*Wr+u*Vr)*$i,n[14]=(ct*fe-lt*Qe-_t*pe)*$i,n[15]=(R*Qe-B*fe+G*pe)*$i,n):null}function qr(n,l){var a=l[0],s=l[1],u=l[2],h=l[3],v=l[4],m=l[5],w=l[6],A=l[7],R=l[8],B=l[9],G=l[10],j=l[11],lt=l[12],ct=l[13],_t=l[14],Zt=l[15];return n[0]=m*(G*Zt-j*_t)-B*(w*Zt-A*_t)+ct*(w*j-A*G),n[1]=-(s*(G*Zt-j*_t)-B*(u*Zt-h*_t)+ct*(u*j-h*G)),n[2]=s*(w*Zt-A*_t)-m*(u*Zt-h*_t)+ct*(u*A-h*w),n[3]=-(s*(w*j-A*G)-m*(u*j-h*G)+B*(u*A-h*w)),n[4]=-(v*(G*Zt-j*_t)-R*(w*Zt-A*_t)+lt*(w*j-A*G)),n[5]=a*(G*Zt-j*_t)-R*(u*Zt-h*_t)+lt*(u*j-h*G),n[6]=-(a*(w*Zt-A*_t)-v*(u*Zt-h*_t)+lt*(u*A-h*w)),n[7]=a*(w*j-A*G)-v*(u*j-h*G)+R*(u*A-h*w),n[8]=v*(B*Zt-j*ct)-R*(m*Zt-A*ct)+lt*(m*j-A*B),n[9]=-(a*(B*Zt-j*ct)-R*(s*Zt-h*ct)+lt*(s*j-h*B)),n[10]=a*(m*Zt-A*ct)-v*(s*Zt-h*ct)+lt*(s*A-h*m),n[11]=-(a*(m*j-A*B)-v*(s*j-h*B)+R*(s*A-h*m)),n[12]=-(v*(B*_t-G*ct)-R*(m*_t-w*ct)+lt*(m*G-w*B)),n[13]=a*(B*_t-G*ct)-R*(s*_t-u*ct)+lt*(s*G-u*B),n[14]=-(a*(m*_t-w*ct)-v*(s*_t-u*ct)+lt*(s*w-u*m)),n[15]=a*(m*G-w*B)-v*(s*G-u*B)+R*(s*w-u*m),n}function Bn(n){var l=n[0],a=n[1],s=n[2],u=n[3],h=n[4],v=n[5],m=n[6],w=n[7],A=n[8],R=n[9],B=n[10],G=n[11],j=n[12],lt=n[13],ct=n[14],_t=n[15],Zt=l*v-a*h,pe=l*m-s*h,fe=l*w-u*h,Ze=a*m-s*v,Qe=a*w-u*v,wr=s*w-u*m,Lr=A*lt-R*j,Vr=A*ct-B*j,Wr=A*_t-G*j,bn=R*ct-B*lt,hn=R*_t-G*lt,Wn=B*_t-G*ct;return Zt*Wn-pe*hn+fe*bn+Ze*Wr-Qe*Vr+wr*Lr}function ti(n,l,a){var s=l[0],u=l[1],h=l[2],v=l[3],m=l[4],w=l[5],A=l[6],R=l[7],B=l[8],G=l[9],j=l[10],lt=l[11],ct=l[12],_t=l[13],Zt=l[14],pe=l[15],fe=a[0],Ze=a[1],Qe=a[2],wr=a[3];return n[0]=fe*s+Ze*m+Qe*B+wr*ct,n[1]=fe*u+Ze*w+Qe*G+wr*_t,n[2]=fe*h+Ze*A+Qe*j+wr*Zt,n[3]=fe*v+Ze*R+Qe*lt+wr*pe,fe=a[4],Ze=a[5],Qe=a[6],wr=a[7],n[4]=fe*s+Ze*m+Qe*B+wr*ct,n[5]=fe*u+Ze*w+Qe*G+wr*_t,n[6]=fe*h+Ze*A+Qe*j+wr*Zt,n[7]=fe*v+Ze*R+Qe*lt+wr*pe,fe=a[8],Ze=a[9],Qe=a[10],wr=a[11],n[8]=fe*s+Ze*m+Qe*B+wr*ct,n[9]=fe*u+Ze*w+Qe*G+wr*_t,n[10]=fe*h+Ze*A+Qe*j+wr*Zt,n[11]=fe*v+Ze*R+Qe*lt+wr*pe,fe=a[12],Ze=a[13],Qe=a[14],wr=a[15],n[12]=fe*s+Ze*m+Qe*B+wr*ct,n[13]=fe*u+Ze*w+Qe*G+wr*_t,n[14]=fe*h+Ze*A+Qe*j+wr*Zt,n[15]=fe*v+Ze*R+Qe*lt+wr*pe,n}function li(n,l,a){var s=a[0],u=a[1],h=a[2],v,m,w,A,R,B,G,j,lt,ct,_t,Zt;return l===n?(n[12]=l[0]*s+l[4]*u+l[8]*h+l[12],n[13]=l[1]*s+l[5]*u+l[9]*h+l[13],n[14]=l[2]*s+l[6]*u+l[10]*h+l[14],n[15]=l[3]*s+l[7]*u+l[11]*h+l[15]):(v=l[0],m=l[1],w=l[2],A=l[3],R=l[4],B=l[5],G=l[6],j=l[7],lt=l[8],ct=l[9],_t=l[10],Zt=l[11],n[0]=v,n[1]=m,n[2]=w,n[3]=A,n[4]=R,n[5]=B,n[6]=G,n[7]=j,n[8]=lt,n[9]=ct,n[10]=_t,n[11]=Zt,n[12]=v*s+R*u+lt*h+l[12],n[13]=m*s+B*u+ct*h+l[13],n[14]=w*s+G*u+_t*h+l[14],n[15]=A*s+j*u+Zt*h+l[15]),n}function wi(n,l,a){var s=a[0],u=a[1],h=a[2];return n[0]=l[0]*s,n[1]=l[1]*s,n[2]=l[2]*s,n[3]=l[3]*s,n[4]=l[4]*u,n[5]=l[5]*u,n[6]=l[6]*u,n[7]=l[7]*u,n[8]=l[8]*h,n[9]=l[9]*h,n[10]=l[10]*h,n[11]=l[11]*h,n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n}function di(n,l,a,s){var u=s[0],h=s[1],v=s[2],m=Math.hypot(u,h,v),w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze,Qe,wr,Lr,Vr,Wr,bn,hn,Wn,vi,$i,go;return m<kr.Ib?null:(m=1/m,u*=m,h*=m,v*=m,w=Math.sin(a),A=Math.cos(a),R=1-A,B=l[0],G=l[1],j=l[2],lt=l[3],ct=l[4],_t=l[5],Zt=l[6],pe=l[7],fe=l[8],Ze=l[9],Qe=l[10],wr=l[11],Lr=u*u*R+A,Vr=h*u*R+v*w,Wr=v*u*R-h*w,bn=u*h*R-v*w,hn=h*h*R+A,Wn=v*h*R+u*w,vi=u*v*R+h*w,$i=h*v*R-u*w,go=v*v*R+A,n[0]=B*Lr+ct*Vr+fe*Wr,n[1]=G*Lr+_t*Vr+Ze*Wr,n[2]=j*Lr+Zt*Vr+Qe*Wr,n[3]=lt*Lr+pe*Vr+wr*Wr,n[4]=B*bn+ct*hn+fe*Wn,n[5]=G*bn+_t*hn+Ze*Wn,n[6]=j*bn+Zt*hn+Qe*Wn,n[7]=lt*bn+pe*hn+wr*Wn,n[8]=B*vi+ct*$i+fe*go,n[9]=G*vi+_t*$i+Ze*go,n[10]=j*vi+Zt*$i+Qe*go,n[11]=lt*vi+pe*$i+wr*go,l!==n&&(n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n)}function Ni(n,l,a){var s=Math.sin(a),u=Math.cos(a),h=l[4],v=l[5],m=l[6],w=l[7],A=l[8],R=l[9],B=l[10],G=l[11];return l!==n&&(n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[4]=h*u+A*s,n[5]=v*u+R*s,n[6]=m*u+B*s,n[7]=w*u+G*s,n[8]=A*u-h*s,n[9]=R*u-v*s,n[10]=B*u-m*s,n[11]=G*u-w*s,n}function Oi(n,l,a){var s=Math.sin(a),u=Math.cos(a),h=l[0],v=l[1],m=l[2],w=l[3],A=l[8],R=l[9],B=l[10],G=l[11];return l!==n&&(n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[0]=h*u-A*s,n[1]=v*u-R*s,n[2]=m*u-B*s,n[3]=w*u-G*s,n[8]=h*s+A*u,n[9]=v*s+R*u,n[10]=m*s+B*u,n[11]=w*s+G*u,n}function zi(n,l,a){var s=Math.sin(a),u=Math.cos(a),h=l[0],v=l[1],m=l[2],w=l[3],A=l[4],R=l[5],B=l[6],G=l[7];return l!==n&&(n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[0]=h*u+A*s,n[1]=v*u+R*s,n[2]=m*u+B*s,n[3]=w*u+G*s,n[4]=A*u-h*s,n[5]=R*u-v*s,n[6]=B*u-m*s,n[7]=G*u-w*s,n}function Ui(n,l){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=l[0],n[13]=l[1],n[14]=l[2],n[15]=1,n}function Hi(n,l){return n[0]=l[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=l[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=l[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function ba(n,l,a){var s=a[0],u=a[1],h=a[2],v=Math.hypot(s,u,h),m,w,A;return v<kr.Ib?null:(v=1/v,s*=v,u*=v,h*=v,m=Math.sin(l),w=Math.cos(l),A=1-w,n[0]=s*s*A+w,n[1]=u*s*A+h*m,n[2]=h*s*A-u*m,n[3]=0,n[4]=s*u*A-h*m,n[5]=u*u*A+w,n[6]=h*u*A+s*m,n[7]=0,n[8]=s*h*A+u*m,n[9]=u*h*A-s*m,n[10]=h*h*A+w,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function Xo(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=a,n[7]=0,n[8]=0,n[9]=-a,n[10]=s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Ou(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=s,n[1]=0,n[2]=-a,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=a,n[9]=0,n[10]=s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function fs(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=s,n[1]=a,n[2]=0,n[3]=0,n[4]=-a,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Lo(n,l,a){var s=l[0],u=l[1],h=l[2],v=l[3],m=s+s,w=u+u,A=h+h,R=s*m,B=s*w,G=s*A,j=u*w,lt=u*A,ct=h*A,_t=v*m,Zt=v*w,pe=v*A;return n[0]=1-(j+ct),n[1]=B+pe,n[2]=G-Zt,n[3]=0,n[4]=B-pe,n[5]=1-(R+ct),n[6]=lt+_t,n[7]=0,n[8]=G+Zt,n[9]=lt-_t,n[10]=1-(R+j),n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n}function Of(n,l){var a=new kr.WT(3),s=-l[0],u=-l[1],h=-l[2],v=l[3],m=l[4],w=l[5],A=l[6],R=l[7],B=s*s+u*u+h*h+v*v;return B>0?(a[0]=(m*v+R*s+w*h-A*u)*2/B,a[1]=(w*v+R*u+A*s-m*h)*2/B,a[2]=(A*v+R*h+m*u-w*s)*2/B):(a[0]=(m*v+R*s+w*h-A*u)*2,a[1]=(w*v+R*u+A*s-m*h)*2,a[2]=(A*v+R*h+m*u-w*s)*2),Lo(n,l,a),n}function ll(n,l){return n[0]=l[12],n[1]=l[13],n[2]=l[14],n}function Dc(n,l){var a=l[0],s=l[1],u=l[2],h=l[4],v=l[5],m=l[6],w=l[8],A=l[9],R=l[10];return n[0]=Math.hypot(a,s,u),n[1]=Math.hypot(h,v,m),n[2]=Math.hypot(w,A,R),n}function Ec(n,l){var a=new kr.WT(3);Dc(a,l);var s=1/a[0],u=1/a[1],h=1/a[2],v=l[0]*s,m=l[1]*u,w=l[2]*h,A=l[4]*s,R=l[5]*u,B=l[6]*h,G=l[8]*s,j=l[9]*u,lt=l[10]*h,ct=v+R+lt,_t=0;return ct>0?(_t=Math.sqrt(ct+1)*2,n[3]=.25*_t,n[0]=(B-j)/_t,n[1]=(G-w)/_t,n[2]=(m-A)/_t):v>R&&v>lt?(_t=Math.sqrt(1+v-R-lt)*2,n[3]=(B-j)/_t,n[0]=.25*_t,n[1]=(m+A)/_t,n[2]=(G+w)/_t):R>lt?(_t=Math.sqrt(1+R-v-lt)*2,n[3]=(G-w)/_t,n[0]=(m+A)/_t,n[1]=.25*_t,n[2]=(B+j)/_t):(_t=Math.sqrt(1+lt-v-R)*2,n[3]=(m-A)/_t,n[0]=(G+w)/_t,n[1]=(B+j)/_t,n[2]=.25*_t),n}function vv(n,l,a,s){var u=l[0],h=l[1],v=l[2],m=l[3],w=u+u,A=h+h,R=v+v,B=u*w,G=u*A,j=u*R,lt=h*A,ct=h*R,_t=v*R,Zt=m*w,pe=m*A,fe=m*R,Ze=s[0],Qe=s[1],wr=s[2];return n[0]=(1-(lt+_t))*Ze,n[1]=(G+fe)*Ze,n[2]=(j-pe)*Ze,n[3]=0,n[4]=(G-fe)*Qe,n[5]=(1-(B+_t))*Qe,n[6]=(ct+Zt)*Qe,n[7]=0,n[8]=(j+pe)*wr,n[9]=(ct-Zt)*wr,n[10]=(1-(B+lt))*wr,n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n}function Xl(n,l,a,s,u){var h=l[0],v=l[1],m=l[2],w=l[3],A=h+h,R=v+v,B=m+m,G=h*A,j=h*R,lt=h*B,ct=v*R,_t=v*B,Zt=m*B,pe=w*A,fe=w*R,Ze=w*B,Qe=s[0],wr=s[1],Lr=s[2],Vr=u[0],Wr=u[1],bn=u[2],hn=(1-(ct+Zt))*Qe,Wn=(j+Ze)*Qe,vi=(lt-fe)*Qe,$i=(j-Ze)*wr,go=(1-(G+Zt))*wr,zo=(_t+pe)*wr,zs=(lt+fe)*Lr,cu=(_t-pe)*Lr,Xu=(1-(G+ct))*Lr;return n[0]=hn,n[1]=Wn,n[2]=vi,n[3]=0,n[4]=$i,n[5]=go,n[6]=zo,n[7]=0,n[8]=zs,n[9]=cu,n[10]=Xu,n[11]=0,n[12]=a[0]+Vr-(hn*Vr+$i*Wr+zs*bn),n[13]=a[1]+Wr-(Wn*Vr+go*Wr+cu*bn),n[14]=a[2]+bn-(vi*Vr+zo*Wr+Xu*bn),n[15]=1,n}function ih(n,l){var a=l[0],s=l[1],u=l[2],h=l[3],v=a+a,m=s+s,w=u+u,A=a*v,R=s*v,B=s*m,G=u*v,j=u*m,lt=u*w,ct=h*v,_t=h*m,Zt=h*w;return n[0]=1-B-lt,n[1]=R+Zt,n[2]=G-_t,n[3]=0,n[4]=R-Zt,n[5]=1-A-lt,n[6]=j+ct,n[7]=0,n[8]=G+_t,n[9]=j-ct,n[10]=1-A-B,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Dp(n,l,a,s,u,h,v){var m=1/(a-l),w=1/(u-s),A=1/(h-v);return n[0]=h*2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h*2*w,n[6]=0,n[7]=0,n[8]=(a+l)*m,n[9]=(u+s)*w,n[10]=(v+h)*A,n[11]=-1,n[12]=0,n[13]=0,n[14]=v*h*2*A,n[15]=0,n}function u0(n,l,a,s,u){var h=1/Math.tan(l/2),v;return n[0]=h/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,u!=null&&u!==1/0?(v=1/(s-u),n[10]=(u+s)*v,n[14]=2*u*s*v):(n[10]=-1,n[14]=-2*s),n}var su=u0;function l0(n,l,a,s,u){var h=1/Math.tan(l/2),v;return n[0]=h/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,u!=null&&u!==1/0?(v=1/(s-u),n[10]=u*v,n[14]=u*s*v):(n[10]=-1,n[14]=-s),n}function ah(n,l,a,s){var u=Math.tan(l.upDegrees*Math.PI/180),h=Math.tan(l.downDegrees*Math.PI/180),v=Math.tan(l.leftDegrees*Math.PI/180),m=Math.tan(l.rightDegrees*Math.PI/180),w=2/(v+m),A=2/(u+h);return n[0]=w,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=A,n[6]=0,n[7]=0,n[8]=-((v-m)*w*.5),n[9]=(u-h)*A*.5,n[10]=s/(a-s),n[11]=-1,n[12]=0,n[13]=0,n[14]=s*a/(a-s),n[15]=0,n}function Bp(n,l,a,s,u,h,v){var m=1/(l-a),w=1/(s-u),A=1/(h-v);return n[0]=-2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*w,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*A,n[11]=0,n[12]=(l+a)*m,n[13]=(u+s)*w,n[14]=(v+h)*A,n[15]=1,n}var Th=Bp;function py(n,l,a,s,u,h,v){var m=1/(l-a),w=1/(s-u),A=1/(h-v);return n[0]=-2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*w,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=A,n[11]=0,n[12]=(l+a)*m,n[13]=(u+s)*w,n[14]=h*A,n[15]=1,n}function bd(n,l,a,s){var u,h,v,m,w,A,R,B,G,j,lt=l[0],ct=l[1],_t=l[2],Zt=s[0],pe=s[1],fe=s[2],Ze=a[0],Qe=a[1],wr=a[2];return Math.abs(lt-Ze)<kr.Ib&&Math.abs(ct-Qe)<kr.Ib&&Math.abs(_t-wr)<kr.Ib?mr(n):(R=lt-Ze,B=ct-Qe,G=_t-wr,j=1/Math.hypot(R,B,G),R*=j,B*=j,G*=j,u=pe*G-fe*B,h=fe*R-Zt*G,v=Zt*B-pe*R,j=Math.hypot(u,h,v),j?(j=1/j,u*=j,h*=j,v*=j):(u=0,h=0,v=0),m=B*v-G*h,w=G*u-R*v,A=R*h-B*u,j=Math.hypot(m,w,A),j?(j=1/j,m*=j,w*=j,A*=j):(m=0,w=0,A=0),n[0]=u,n[1]=m,n[2]=R,n[3]=0,n[4]=h,n[5]=w,n[6]=B,n[7]=0,n[8]=v,n[9]=A,n[10]=G,n[11]=0,n[12]=-(u*lt+h*ct+v*_t),n[13]=-(m*lt+w*ct+A*_t),n[14]=-(R*lt+B*ct+G*_t),n[15]=1,n)}function qh(n,l,a,s){var u=l[0],h=l[1],v=l[2],m=s[0],w=s[1],A=s[2],R=u-a[0],B=h-a[1],G=v-a[2],j=R*R+B*B+G*G;j>0&&(j=1/Math.sqrt(j),R*=j,B*=j,G*=j);var lt=w*G-A*B,ct=A*R-m*G,_t=m*B-w*R;return j=lt*lt+ct*ct+_t*_t,j>0&&(j=1/Math.sqrt(j),lt*=j,ct*=j,_t*=j),n[0]=lt,n[1]=ct,n[2]=_t,n[3]=0,n[4]=B*_t-G*ct,n[5]=G*lt-R*_t,n[6]=R*ct-B*lt,n[7]=0,n[8]=R,n[9]=B,n[10]=G,n[11]=0,n[12]=u,n[13]=h,n[14]=v,n[15]=1,n}function dy(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function vy(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function d_(n,l,a){return n[0]=l[0]+a[0],n[1]=l[1]+a[1],n[2]=l[2]+a[2],n[3]=l[3]+a[3],n[4]=l[4]+a[4],n[5]=l[5]+a[5],n[6]=l[6]+a[6],n[7]=l[7]+a[7],n[8]=l[8]+a[8],n[9]=l[9]+a[9],n[10]=l[10]+a[10],n[11]=l[11]+a[11],n[12]=l[12]+a[12],n[13]=l[13]+a[13],n[14]=l[14]+a[14],n[15]=l[15]+a[15],n}function fo(n,l,a){return n[0]=l[0]-a[0],n[1]=l[1]-a[1],n[2]=l[2]-a[2],n[3]=l[3]-a[3],n[4]=l[4]-a[4],n[5]=l[5]-a[5],n[6]=l[6]-a[6],n[7]=l[7]-a[7],n[8]=l[8]-a[8],n[9]=l[9]-a[9],n[10]=l[10]-a[10],n[11]=l[11]-a[11],n[12]=l[12]-a[12],n[13]=l[13]-a[13],n[14]=l[14]-a[14],n[15]=l[15]-a[15],n}function Np(n,l,a){return n[0]=l[0]*a,n[1]=l[1]*a,n[2]=l[2]*a,n[3]=l[3]*a,n[4]=l[4]*a,n[5]=l[5]*a,n[6]=l[6]*a,n[7]=l[7]*a,n[8]=l[8]*a,n[9]=l[9]*a,n[10]=l[10]*a,n[11]=l[11]*a,n[12]=l[12]*a,n[13]=l[13]*a,n[14]=l[14]*a,n[15]=l[15]*a,n}function gy(n,l,a,s){return n[0]=l[0]+a[0]*s,n[1]=l[1]+a[1]*s,n[2]=l[2]+a[2]*s,n[3]=l[3]+a[3]*s,n[4]=l[4]+a[4]*s,n[5]=l[5]+a[5]*s,n[6]=l[6]+a[6]*s,n[7]=l[7]+a[7]*s,n[8]=l[8]+a[8]*s,n[9]=l[9]+a[9]*s,n[10]=l[10]+a[10]*s,n[11]=l[11]+a[11]*s,n[12]=l[12]+a[12]*s,n[13]=l[13]+a[13]*s,n[14]=l[14]+a[14]*s,n[15]=l[15]+a[15]*s,n}function f(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]&&n[3]===l[3]&&n[4]===l[4]&&n[5]===l[5]&&n[6]===l[6]&&n[7]===l[7]&&n[8]===l[8]&&n[9]===l[9]&&n[10]===l[10]&&n[11]===l[11]&&n[12]===l[12]&&n[13]===l[13]&&n[14]===l[14]&&n[15]===l[15]}function d(n,l){var a=n[0],s=n[1],u=n[2],h=n[3],v=n[4],m=n[5],w=n[6],A=n[7],R=n[8],B=n[9],G=n[10],j=n[11],lt=n[12],ct=n[13],_t=n[14],Zt=n[15],pe=l[0],fe=l[1],Ze=l[2],Qe=l[3],wr=l[4],Lr=l[5],Vr=l[6],Wr=l[7],bn=l[8],hn=l[9],Wn=l[10],vi=l[11],$i=l[12],go=l[13],zo=l[14],zs=l[15];return Math.abs(a-pe)<=kr.Ib*Math.max(1,Math.abs(a),Math.abs(pe))&&Math.abs(s-fe)<=kr.Ib*Math.max(1,Math.abs(s),Math.abs(fe))&&Math.abs(u-Ze)<=kr.Ib*Math.max(1,Math.abs(u),Math.abs(Ze))&&Math.abs(h-Qe)<=kr.Ib*Math.max(1,Math.abs(h),Math.abs(Qe))&&Math.abs(v-wr)<=kr.Ib*Math.max(1,Math.abs(v),Math.abs(wr))&&Math.abs(m-Lr)<=kr.Ib*Math.max(1,Math.abs(m),Math.abs(Lr))&&Math.abs(w-Vr)<=kr.Ib*Math.max(1,Math.abs(w),Math.abs(Vr))&&Math.abs(A-Wr)<=kr.Ib*Math.max(1,Math.abs(A),Math.abs(Wr))&&Math.abs(R-bn)<=kr.Ib*Math.max(1,Math.abs(R),Math.abs(bn))&&Math.abs(B-hn)<=kr.Ib*Math.max(1,Math.abs(B),Math.abs(hn))&&Math.abs(G-Wn)<=kr.Ib*Math.max(1,Math.abs(G),Math.abs(Wn))&&Math.abs(j-vi)<=kr.Ib*Math.max(1,Math.abs(j),Math.abs(vi))&&Math.abs(lt-$i)<=kr.Ib*Math.max(1,Math.abs(lt),Math.abs($i))&&Math.abs(ct-go)<=kr.Ib*Math.max(1,Math.abs(ct),Math.abs(go))&&Math.abs(_t-zo)<=kr.Ib*Math.max(1,Math.abs(_t),Math.abs(zo))&&Math.abs(Zt-zs)<=kr.Ib*Math.max(1,Math.abs(Zt),Math.abs(zs))}var y=ti,T=fo,O,N,Z=(O=(0,Tt.b2)(),O(N=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"viewport",void 0),(0,W.Z)(this,"overridedViewProjectionMatrix",void 0),(0,W.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,W.Z)(this,"jitteredProjectionMatrix",void 0),(0,W.Z)(this,"viewMatrixInverse",void 0),(0,W.Z)(this,"cameraPosition",void 0)}return(0,et.Z)(n,[{key:"init",value:function(){}},{key:"update",value:function(a){this.viewport=a,this.viewMatrixInverse=$r(),Mr(this.viewMatrixInverse,a.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var a=this.viewport.getCenter(),s=(0,yt.Z)(a,2),u=s[0],h=s[1];return[u,h]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}},{key:"setViewProjectionMatrix",value:function(a){this.overridedViewProjectionMatrix=a}},{key:"jitterProjectionMatrix",value:function(a,s){var u=Ui($r(),[a,s,0]);this.jitteredProjectionMatrix=ti($r(),u,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=ti($r(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),n}())||N),q;(function(n){n.TOPRIGHT="topright",n.TOPLEFT="topleft",n.BOTTOMRIGHT="bottomright",n.BOTTOMLEFT="bottomleft",n.TOPCENTER="topcenter",n.BOTTOMCENTER="bottomcenter",n.LEFTCENTER="leftcenter",n.RIGHTCENTER="rightcenter",n.LEFTTOP="lefttop",n.RIGHTTOP="righttop",n.LEFTBOTTOM="leftbottom",n.RIGHTBOTTOM="rightbottom"})(q||(q={}));var dt,Lt;function Gt(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Qt(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Qt(n,l){if(n){if(typeof n=="string")return me(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return me(n,l)}}function me(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Fe={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},nr=(dt=(0,Tt.b2)(),dt(Lt=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"container",void 0),(0,W.Z)(this,"controlCorners",void 0),(0,W.Z)(this,"controlContainer",void 0),(0,W.Z)(this,"scene",void 0),(0,W.Z)(this,"mapsService",void 0),(0,W.Z)(this,"controls",[]),(0,W.Z)(this,"unAddControls",[])}return(0,et.Z)(n,[{key:"init",value:function(a,s){this.container=a.container,this.scene=s,this.mapsService=s.get(Dt.IMapService),this.initControlPos()}},{key:"addControl",value:function(a,s){var u=s.get(Dt.IMapService);u.map?(a.addTo(this.scene),this.controls.push(a)):this.unAddControls.push(a)}},{key:"getControlByName",value:function(a){return this.controls.find(function(s){return s.controlOption.name===a})}},{key:"removeControl",value:function(a){var s=this.controls.indexOf(a);return s>-1&&this.controls.splice(s,1),a.remove(),this}},{key:"addControls",value:function(){var a=this;this.unAddControls.forEach(function(s){s.addTo(a.scene),a.controls.push(s)}),this.unAddControls=[]}},{key:"destroy",value:function(){var a=Gt(this.controls),s;try{for(a.s();!(s=a.n()).done;){var u=s.value;u.remove()}}catch(h){a.e(h)}finally{a.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var a=this.controlCorners={},s="l7-",u=this.controlContainer=Jt("div",s+"control-container",this.container);function h(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],w=m.map(function(A){return s+A}).join(" ");a[m.filter(function(A){return!["row","column"].includes(A)}).join("")]=Jt("div",w,u)}function v(m){var w=m.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,ve.Z)(w),[Fe[m]])}Object.values(q).forEach(function(m){h(v(m))})}},{key:"clearControlPos",value:function(){for(var a in this.controlCorners)this.controlCorners[a]&&Ue(this.controlCorners[a]);this.controlContainer&&Ue(this.controlContainer)}}]),n}())||Lt),ur,Sr,gr=(ur=(0,Tt.b2)(),ur(Sr=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"container",void 0),(0,W.Z)(this,"scene",void 0),(0,W.Z)(this,"mapsService",void 0),(0,W.Z)(this,"markers",[]),(0,W.Z)(this,"markerLayers",[]),(0,W.Z)(this,"unAddMarkers",[]),(0,W.Z)(this,"unAddMarkerLayers",[])}return(0,et.Z)(n,[{key:"addMarkerLayer",value:function(a){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(a),a.addTo(this.scene)):this.unAddMarkerLayers.push(a)}},{key:"removeMarkerLayer",value:function(a){a.destroy(),this.markerLayers.indexOf(a);var s=this.markerLayers.indexOf(a);s>-1&&this.markerLayers.splice(s,1)}},{key:"addMarker",value:function(a){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(a),a.addTo(this.scene)):this.unAddMarkers.push(a)}},{key:"addMarkers",value:function(){var a=this;this.unAddMarkers.forEach(function(s){s.addTo(a.scene),a.markers.push(s)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var a=this;this.unAddMarkerLayers.forEach(function(s){a.markerLayers.push(s),s.addTo(a.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(a){a.remove(),this.markers.indexOf(a);var s=this.markers.indexOf(a);s>-1&&this.markers.splice(s,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(a){this.scene=a,this.mapsService=a.get(Dt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(a){a.remove()}),this.markers=[],this.markerLayers.forEach(function(a){a.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(a){a.destroy()}}]),n}())||Sr),Ur,tn,un=(Ur=(0,Tt.b2)(),Ur(tn=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"scene",void 0),(0,W.Z)(this,"mapsService",void 0),(0,W.Z)(this,"popups",[]),(0,W.Z)(this,"unAddPopups",[])}return(0,et.Z)(n,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(a){a!=null&&a.isOpen()&&a.remove();var s=this.popups.indexOf(a);s>-1&&this.popups.splice(s,1);var u=this.unAddPopups.indexOf(a);u>-1&&this.unAddPopups.splice(u,1)}},{key:"destroy",value:function(){this.popups.forEach(function(a){return a.remove()})}},{key:"addPopup",value:function(a){var s=this;a&&a.getOptions().autoClose&&[].concat((0,ve.Z)(this.popups),(0,ve.Z)(this.unAddPopups)).forEach(function(u){u.getOptions().autoClose&&s.removePopup(u)}),this.isMarkerReady?(a.addTo(this.scene),this.popups.push(a)):this.unAddPopups.push(a),a.on("close",function(){s.removePopup(a)})}},{key:"initPopup",value:function(){var a=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(s){a.addPopup(s),a.unAddPopups=[]})}},{key:"init",value:function(a){this.scene=a,this.mapsService=a.get(Dt.IMapService)}}]),n}())||tn),yn={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Fn=yn,ii,Si,sa={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,isMini:!1,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},Zi={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},pa=(ii=(0,Tt.b2)(),ii(Si=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"sceneConfigCache",{}),(0,W.Z)(this,"layerConfigCache",{}),(0,W.Z)(this,"layerAttributeConfigCache",{})}return(0,et.Z)(n,[{key:"getSceneConfig",value:function(a){return this.sceneConfigCache[a]}},{key:"getSceneWarninfo",value:function(a){return Fn[a]}},{key:"setSceneConfig",value:function(a,s){this.sceneConfigCache[a]=(0,K.Z)((0,K.Z)({},sa),s)}},{key:"getLayerConfig",value:function(a){return this.layerConfigCache[a]}},{key:"setLayerConfig",value:function(a,s,u){this.layerConfigCache[s]=(0,K.Z)({},(0,ne.merge)({},this.sceneConfigCache[a],Zi,u))}},{key:"getAttributeConfig",value:function(a){return this.layerAttributeConfigCache[a]}},{key:"setAttributeConfig",value:function(a,s){this.layerAttributeConfigCache[a]=(0,K.Z)((0,K.Z)({},this.layerAttributeConfigCache[a]),s)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),n}())||Si);function Rn(n,l,a,s){a&&Object.defineProperty(n,l,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0})}function Fi(n,l,a,s,u){var h={};return Object.keys(s).forEach(function(v){h[v]=s[v]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=a.slice().reverse().reduce(function(v,m){return m(n,l,v)||v},h),u&&h.initializer!==void 0&&(h.value=h.initializer?h.initializer.call(u):void 0,h.initializer=void 0),h.initializer===void 0&&(Object.defineProperty(n,l,h),h=null),h}function aa(){var n=new kr.WT(4);return kr.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Ji(n){var l=new glMatrix.ARRAY_TYPE(4);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l}function ho(n,l,a,s){var u=new kr.WT(4);return u[0]=n,u[1]=l,u[2]=a,u[3]=s,u}function Ha(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n}function so(n,l,a,s,u){return n[0]=l,n[1]=a,n[2]=s,n[3]=u,n}function _i(n,l,a){return n[0]=l[0]+a[0],n[1]=l[1]+a[1],n[2]=l[2]+a[2],n[3]=l[3]+a[3],n}function No(n,l,a){return n[0]=l[0]-a[0],n[1]=l[1]-a[1],n[2]=l[2]-a[2],n[3]=l[3]-a[3],n}function Bs(n,l,a){return n[0]=l[0]*a[0],n[1]=l[1]*a[1],n[2]=l[2]*a[2],n[3]=l[3]*a[3],n}function qs(n,l,a){return n[0]=l[0]/a[0],n[1]=l[1]/a[1],n[2]=l[2]/a[2],n[3]=l[3]/a[3],n}function Cs(n,l){return n[0]=Math.ceil(l[0]),n[1]=Math.ceil(l[1]),n[2]=Math.ceil(l[2]),n[3]=Math.ceil(l[3]),n}function Ls(n,l){return n[0]=Math.floor(l[0]),n[1]=Math.floor(l[1]),n[2]=Math.floor(l[2]),n[3]=Math.floor(l[3]),n}function uu(n,l,a){return n[0]=Math.min(l[0],a[0]),n[1]=Math.min(l[1],a[1]),n[2]=Math.min(l[2],a[2]),n[3]=Math.min(l[3],a[3]),n}function Ns(n,l,a){return n[0]=Math.max(l[0],a[0]),n[1]=Math.max(l[1],a[1]),n[2]=Math.max(l[2],a[2]),n[3]=Math.max(l[3],a[3]),n}function vu(n,l){return n[0]=Math.round(l[0]),n[1]=Math.round(l[1]),n[2]=Math.round(l[2]),n[3]=Math.round(l[3]),n}function Hu(n,l,a){return n[0]=l[0]*a,n[1]=l[1]*a,n[2]=l[2]*a,n[3]=l[3]*a,n}function cl(n,l,a,s){return n[0]=l[0]+a[0]*s,n[1]=l[1]+a[1]*s,n[2]=l[2]+a[2]*s,n[3]=l[3]+a[3]*s,n}function ml(n,l){var a=l[0]-n[0],s=l[1]-n[1],u=l[2]-n[2],h=l[3]-n[3];return Math.hypot(a,s,u,h)}function Fu(n,l){var a=l[0]-n[0],s=l[1]-n[1],u=l[2]-n[2],h=l[3]-n[3];return a*a+s*s+u*u+h*h}function fl(n){var l=n[0],a=n[1],s=n[2],u=n[3];return Math.hypot(l,a,s,u)}function qa(n){var l=n[0],a=n[1],s=n[2],u=n[3];return l*l+a*a+s*s+u*u}function hs(n,l){return n[0]=-l[0],n[1]=-l[1],n[2]=-l[2],n[3]=-l[3],n}function as(n,l){return n[0]=1/l[0],n[1]=1/l[1],n[2]=1/l[2],n[3]=1/l[3],n}function Po(n,l){var a=l[0],s=l[1],u=l[2],h=l[3],v=a*a+s*s+u*u+h*h;return v>0&&(v=1/Math.sqrt(v)),n[0]=a*v,n[1]=s*v,n[2]=u*v,n[3]=h*v,n}function Yl(n,l){return n[0]*l[0]+n[1]*l[1]+n[2]*l[2]+n[3]*l[3]}function Pl(n,l,a,s){var u=a[0]*s[1]-a[1]*s[0],h=a[0]*s[2]-a[2]*s[0],v=a[0]*s[3]-a[3]*s[0],m=a[1]*s[2]-a[2]*s[1],w=a[1]*s[3]-a[3]*s[1],A=a[2]*s[3]-a[3]*s[2],R=l[0],B=l[1],G=l[2],j=l[3];return n[0]=B*A-G*w+j*m,n[1]=-(R*A)+G*v-j*h,n[2]=R*w-B*v+j*u,n[3]=-(R*m)+B*h-G*u,n}function Ps(n,l,a,s){var u=l[0],h=l[1],v=l[2],m=l[3];return n[0]=u+s*(a[0]-u),n[1]=h+s*(a[1]-h),n[2]=v+s*(a[2]-v),n[3]=m+s*(a[3]-m),n}function gu(n,l){l=l||1;var a,s,u,h,v,m;do a=glMatrix.RANDOM()*2-1,s=glMatrix.RANDOM()*2-1,v=a*a+s*s;while(v>=1);do u=glMatrix.RANDOM()*2-1,h=glMatrix.RANDOM()*2-1,m=u*u+h*h;while(m>=1);var w=Math.sqrt((1-v)/m);return n[0]=l*a,n[1]=l*s,n[2]=l*u*w,n[3]=l*h*w,n}function tl(n,l,a){var s=l[0],u=l[1],h=l[2],v=l[3];return n[0]=a[0]*s+a[4]*u+a[8]*h+a[12]*v,n[1]=a[1]*s+a[5]*u+a[9]*h+a[13]*v,n[2]=a[2]*s+a[6]*u+a[10]*h+a[14]*v,n[3]=a[3]*s+a[7]*u+a[11]*h+a[15]*v,n}function To(n,l,a){var s=l[0],u=l[1],h=l[2],v=a[0],m=a[1],w=a[2],A=a[3],R=A*s+m*h-w*u,B=A*u+w*s-v*h,G=A*h+v*u-m*s,j=-v*s-m*u-w*h;return n[0]=R*A+j*-v+B*-w-G*-m,n[1]=B*A+j*-m+G*-v-R*-w,n[2]=G*A+j*-w+R*-m-B*-v,n[3]=l[3],n}function oh(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function yl(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}function Kh(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]&&n[3]===l[3]}function mu(n,l){var a=n[0],s=n[1],u=n[2],h=n[3],v=l[0],m=l[1],w=l[2],A=l[3];return Math.abs(a-v)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-w)<=glMatrix.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-A)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))}var Qh=null,Ff=null,Ed=null,wd=null,c0=null,Jh=null,Sd=null,q0=function(){var n=aa();return function(l,a,s,u,h,v){var m,w;for(a||(a=4),s||(s=0),u?w=Math.min(u*a+s,l.length):w=l.length,m=s;m<w;m+=a)n[0]=l[m],n[1]=l[m+1],n[2]=l[m+2],n[3]=l[m+3],h(n,n,v),l[m]=n[0],l[m+1]=n[1],l[m+2]=n[2],l[m+3]=n[3];return l}}(),sh=Math.PI/180,gv=512,mv=4003e4;function Gs(n){var l=n.latitude,a=l===void 0?0:l,s=n.zoom,u=s===void 0?0:s,h=n.scale,v=n.highPrecision,m=v===void 0?!1:v,w=n.flipY,A=w===void 0?!1:w;h=h!==void 0?h:Math.pow(2,u);var R={},B=gv*h,G=Math.cos(a*sh),j=B/360,lt=j/G,ct=B/mv/G;if(R.pixelsPerMeter=[ct,-ct,ct],R.metersPerPixel=[1/ct,-1/ct,1/ct],R.pixelsPerDegree=[j,-lt,ct],R.degreesPerPixel=[1/j,-1/lt,1/ct],m){var _t=sh*Math.tan(a*sh)/G,Zt=j*_t/2,pe=B/mv*_t,fe=pe/lt*ct;R.pixelsPerDegree2=[0,-Zt,pe],R.pixelsPerMeter2=[fe,0,fe],A&&(R.pixelsPerDegree2[1]=-R.pixelsPerDegree2[1],R.pixelsPerMeter2[1]=-R.pixelsPerMeter2[1])}return A&&(R.pixelsPerMeter[1]=-R.pixelsPerMeter[1],R.metersPerPixel[1]=-R.metersPerPixel[1],R.pixelsPerDegree[1]=-R.pixelsPerDegree[1],R.degreesPerPixel[1]=-R.degreesPerPixel[1]),R}var el;(function(n){n[n.LNGLAT=1]="LNGLAT",n[n.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",n[n.VECTOR_TILE=3]="VECTOR_TILE",n[n.IDENTITY=4]="IDENTITY",n[n.P20=5]="P20",n[n.P20_OFFSET=6]="P20_OFFSET",n[n.METER_OFFSET=7]="METER_OFFSET",n[n.P20_2=8]="P20_2"})(el||(el={}));var sf={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},Cd,Mh,Ad,zp,f0,yv=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],K0=(Cd=(0,Tt.b2)(),Mh=(0,Tt.f3)(Dt.ICameraService),Cd(Ad=(zp=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"needRefresh",!0),Rn(this,"cameraService",f0,this),(0,W.Z)(this,"coordinateSystem",void 0),(0,W.Z)(this,"viewportCenter",void 0),(0,W.Z)(this,"viewportCenterProjection",void 0),(0,W.Z)(this,"pixelsPerDegree",void 0),(0,W.Z)(this,"pixelsPerDegree2",void 0),(0,W.Z)(this,"pixelsPerMeter",void 0)}return(0,et.Z)(n,[{key:"refresh",value:function(a){var s=this.cameraService.getZoom(),u=this.cameraService.getZoomScale(),h=a||this.cameraService.getCenter(),v=Gs({latitude:h[1],zoom:s}),m=v.pixelsPerMeter,w=v.pixelsPerDegree;this.viewportCenter=h,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=m,this.pixelsPerDegree=w,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===el.LNGLAT||this.coordinateSystem===el.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===el.LNGLAT_OFFSET?this.calculateLnglatOffset(h,s):this.coordinateSystem===el.P20_OFFSET&&this.calculateLnglatOffset(h,s,u,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(a){this.coordinateSystem=a}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(a,s,u,h){var v=Gs({latitude:a[1],zoom:s,scale:u,flipY:h,highPrecision:!0}),m=v.pixelsPerMeter,w=v.pixelsPerDegree,A=v.pixelsPerDegree2,R=this.cameraService.getViewMatrix(),B=this.cameraService.getProjectionMatrix(),G=ti([],B,R),j=this.cameraService.projectFlat([Math.fround(a[0]),Math.fround(a[1])],Math.pow(2,s));this.viewportCenterProjection=tl([],[j[0],j[1],0,1],G),R=this.cameraService.getViewMatrixUncentered()||R,G=ti([],B,R),G=ti([],G,yv),this.cameraService.setViewProjectionMatrix(G),this.pixelsPerMeter=m,this.pixelsPerDegree=w,this.pixelsPerDegree2=A}}]),n}(),f0=Fi(zp.prototype,"cameraService",[Mh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zp))||Ad),Ng=nt(86105),Up=nt.n(Ng),os;(function(n){n.Hover="hover",n.Click="click",n.Select="select",n.Active="active",n.Drag="drag"})(os||(os={}));var uf,Jo,$l,_v,Td;function h0(n){var l=Md();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Md(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var p0={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},Id=(uf=(0,Tt.b2)(),Jo=(0,Tt.f3)(Dt.IMapService),uf($l=(_v=function(n){(0,zt.Z)(a,n);var l=h0(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"indragging",!1),Rn((0,ut.Z)(s),"mapService",Td,(0,ut.Z)(s)),(0,W.Z)((0,ut.Z)(s),"hammertime",void 0),(0,W.Z)((0,ut.Z)(s),"lastClickTime",0),(0,W.Z)((0,ut.Z)(s),"lastClickXY",[-1,-1]),(0,W.Z)((0,ut.Z)(s),"clickTimer",void 0),(0,W.Z)((0,ut.Z)(s),"$containter",void 0),(0,W.Z)((0,ut.Z)(s),"onDrag",function(m){var w=s.interactionEvent(m);w.type=p0[w.type],w.type==="dragging"?s.indragging=!0:s.indragging=!1,s.emit(os.Drag,w)}),(0,W.Z)((0,ut.Z)(s),"onHammer",function(m){m.srcEvent.stopPropagation();var w=s.interactionEvent(m);s.emit(os.Hover,w)}),(0,W.Z)((0,ut.Z)(s),"onTouch",function(m){var w=m.touches[0];s.onHover({x:w.pageX,y:w.pageY,type:"touch"})}),(0,W.Z)((0,ut.Z)(s),"onHover",function(m){var w=m.clientX,A=m.clientY,R=w,B=A,G=m.type,j=s.mapService.getMapContainer();if(j)if(Ms)R=R-j.left-0,B=B-j.top-0;else{var lt=j.getBoundingClientRect(),ct=lt.top,_t=lt.left;R=R-_t-j.clientLeft,B=B-ct-j.clientTop}var Zt=s.mapService.containerToLngLat([R,B]);if(G==="click"){if(!Ms&&"ontouchstart"in document.documentElement)return;s.isDoubleTap(R,B,Zt);return}if(G==="touch"){s.isDoubleTap(R,B,Zt);return}G!=="click"&&G!=="dblclick"&&s.emit(os.Hover,{x:R,y:B,lngLat:Zt,type:G,target:m})}),s}return(0,et.Z)(a,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(os.Hover)}},{key:"triggerHover",value:function(u){var h=u.x,v=u.y;this.emit(os.Hover,{x:h,y:v})}},{key:"triggerSelect",value:function(u){this.emit(os.Select,{featureId:u})}},{key:"triggerActive",value:function(u){this.emit(os.Active,{featureId:u})}},{key:"handleMiniEvent",value:function(u){this.onHover({clientX:u.touches[0].pageX,clientY:u.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var u=this.mapService.getMapContainer();if(u)if(Ms)Ga.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var h=new(Up()).Manager(u);h.add(new(Up()).Tap({event:"dblclick",taps:2})),h.add(new(Up()).Tap({event:"click"})),h.add(new(Up()).Pan({threshold:0,pointers:0})),h.add(new(Up()).Press({})),h.on("dblclick click",this.onHammer),h.on("panstart panmove panend pancancel",this.onDrag),u.addEventListener("mousemove",this.onHover),u.addEventListener("mousedown",this.onHover,!0),u.addEventListener("mouseup",this.onHover),u.addEventListener("contextmenu",this.onHover),this.hammertime=h}}},{key:"removeEventListenerOnMap",value:function(){if(Ms)Ga.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var u=this.mapService.getMapContainer();u&&(u.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),u.removeEventListener("mousedown",this.onHover),u.removeEventListener("mouseup",this.onHover),u.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(u){var h=u.type,v=u.pointerType,m,w;v==="touch"?(w=Math.floor(u.pointers[0].clientY),m=Math.floor(u.pointers[0].clientX)):(w=Math.floor(u.srcEvent.y),m=Math.floor(u.srcEvent.x));var A=this.mapService.getMapContainer();if(A){var R=A.getBoundingClientRect(),B=R.top,G=R.left;m-=G,w-=B}var j=this.mapService.containerToLngLat([m,w]);return{x:m,y:w,lngLat:j,type:h,target:u.srcEvent}}},{key:"isDoubleTap",value:function(u,h,v){var m=this,w=new Date().getTime(),A="click";w-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-u)<10&&Math.abs(this.lastClickXY[1]-h)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),A="dblclick",this.emit(os.Hover,{x:u,y:h,lngLat:v,type:A})):(this.lastClickTime=w,this.lastClickXY=[u,h],this.clickTimer=setTimeout(function(){A="click",m.emit(os.Hover,{x:u,y:h,lngLat:v,type:A})},400))}}]),a}(ke()),Td=Fi(_v.prototype,"mapService",[Jo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_v))||$l),tp=0;function xv(n){if(Ms)return null;var l=n;if(typeof n=="string"&&(l=document.getElementById(n)),l){var a=document.createElement("div");return a.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,a.id="l7-scene-".concat(tp++),a.classList.add("l7-scene"),l.appendChild(a),a}return null}function zg(n){var l,a,s=!0;return n==null||(l=n.target)===null||l===void 0||(a=l.path)===null||a===void 0||a.map(function(u){if(u!=null&&u.classList){var h;u==null||(h=u.classList)===null||h===void 0||h.forEach(function(v){(v==="l7-marker"||v==="l7-popup")&&(s=!1)})}}),s}var se;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.MAX_EXT=32776]="MAX_EXT",n[n.MIN_EXT=32775]="MIN_EXT",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.CULL_FACE=2884]="CULL_FACE",n[n.BLEND=3042]="BLEND",n[n.DITHER=3024]="DITHER",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.TEXTURE1=33985]="TEXTURE1",n[n.TEXTURE2=33986]="TEXTURE2",n[n.TEXTURE3=33987]="TEXTURE3",n[n.TEXTURE4=33988]="TEXTURE4",n[n.TEXTURE5=33989]="TEXTURE5",n[n.TEXTURE6=33990]="TEXTURE6",n[n.TEXTURE7=33991]="TEXTURE7",n[n.TEXTURE8=33992]="TEXTURE8",n[n.TEXTURE9=33993]="TEXTURE9",n[n.TEXTURE10=33994]="TEXTURE10",n[n.TEXTURE11=33995]="TEXTURE11",n[n.TEXTURE12=33996]="TEXTURE12",n[n.TEXTURE13=33997]="TEXTURE13",n[n.TEXTURE14=33998]="TEXTURE14",n[n.TEXTURE15=33999]="TEXTURE15",n[n.TEXTURE16=34e3]="TEXTURE16",n[n.TEXTURE17=34001]="TEXTURE17",n[n.TEXTURE18=34002]="TEXTURE18",n[n.TEXTURE19=34003]="TEXTURE19",n[n.TEXTURE20=34004]="TEXTURE20",n[n.TEXTURE21=34005]="TEXTURE21",n[n.TEXTURE22=34006]="TEXTURE22",n[n.TEXTURE23=34007]="TEXTURE23",n[n.TEXTURE24=34008]="TEXTURE24",n[n.TEXTURE25=34009]="TEXTURE25",n[n.TEXTURE26=34010]="TEXTURE26",n[n.TEXTURE27=34011]="TEXTURE27",n[n.TEXTURE28=34012]="TEXTURE28",n[n.TEXTURE29=34013]="TEXTURE29",n[n.TEXTURE30=34014]="TEXTURE30",n[n.TEXTURE31=34015]="TEXTURE31",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(se||(se={}));var Q0,yy,bv,Hs,lf,_y,ep,rp,Ug,d0,Bc,kd,Ld,Pd=(Q0=(0,Tt.b2)(),yy=(0,Tt.f3)(Dt.IMapService),bv=(0,Tt.f3)(Dt.IRendererService),Hs=(0,Tt.f3)(Dt.IGlobalConfigService),lf=(0,Tt.f3)(Dt.IInteractionService),_y=(0,Tt.f3)(Dt.ILayerService),Q0(ep=(rp=function(){function n(){var l=this;(0,pt.Z)(this,n),(0,W.Z)(this,"pickedColors",void 0),(0,W.Z)(this,"pickedTileLayers",[]),Rn(this,"mapService",Ug,this),Rn(this,"rendererService",d0,this),Rn(this,"configService",Bc,this),Rn(this,"interactionService",kd,this),Rn(this,"layerService",Ld,this),(0,W.Z)(this,"pickingFBO",void 0),(0,W.Z)(this,"width",0),(0,W.Z)(this,"height",0),(0,W.Z)(this,"alreadyInPicking",!1),(0,W.Z)(this,"pickBufferScale",1),(0,W.Z)(this,"pickFromPickingFBO",function(a,s){var u=s.x,h=s.y,v=s.lngLat,m=s.type,w=s.target,A=!1,R=l.rendererService,B=R.readPixels,G=R.getContainer,j=l.getContainerSize(G()),lt=j.width,ct=j.height;lt*=fa,ct*=fa;var _t=a.getLayerConfig(),Zt=_t.enableHighlight,pe=_t.enableSelect,fe=u*fa,Ze=h*fa;if(fe>lt-1*fa||fe<0||Ze>ct-1*fa||Ze<0)return!1;var Qe=B({x:Math.floor(fe/l.pickBufferScale),y:Math.floor((ct-(h+1)*fa)/l.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:l.pickingFBO});if(l.pickedColors=Qe,Qe[0]!==0||Qe[1]!==0||Qe[2]!==0){var wr=_r(Qe),Lr=a.layerPickService.getFeatureById(wr);wr!==a.getCurrentPickId()&&m==="mousemove"&&(m="mouseenter");var Vr={x:u,y:h,type:m,lngLat:v,featureId:wr,feature:Lr,target:w};Lr&&(A=!0,a.setCurrentPickId(wr),l.triggerHoverOnLayer(a,Vr))}else{var Wr={x:u,y:h,lngLat:v,type:a.getCurrentPickId()!==null&&m==="mousemove"?"mouseout":"un"+m,featureId:null,target:w,feature:null};l.triggerHoverOnLayer(a,(0,K.Z)((0,K.Z)({},Wr),{},{type:"unpick"})),l.triggerHoverOnLayer(a,Wr),a.setCurrentPickId(null)}if(Zt&&a.layerPickService.highlightPickedFeature(Qe),pe&&m==="click"&&(Qe==null?void 0:Qe.toString())!==[0,0,0,0].toString()){var bn=_r(Qe);a.getCurrentSelectedId()===null||bn!==a.getCurrentSelectedId()?(a.layerPickService.selectFeature(Qe),a.setCurrentSelectedId(bn)):(a.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),a.setCurrentSelectedId(null))}return A})}return(0,et.Z)(n,[{key:"init",value:function(a){var s=this.rendererService,u=s.createTexture2D,h=s.createFramebuffer,v=s.getContainer,m=this.getContainerSize(v()),w=m.width,A=m.height;w*=fa,A*=fa,this.pickBufferScale=this.configService.getSceneConfig(a).pickBufferScale||1,this.pickingFBO=h({color:u({width:Math.round(w/this.pickBufferScale),height:Math.round(A/this.pickBufferScale),wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})}),this.interactionService.on(os.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var l=(0,J.Z)(ot().mark(function s(u,h,v){var m=this,w,A,R;return ot().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:w=this.rendererService,A=w.useFramebuffer,R=w.clear,this.resizePickingFBO(),A(this.pickingFBO,function(){R({framebuffer:m.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),u.hooks.beforePickingEncode.call(),u.renderModels(),u.hooks.afterPickingEncode.call();var j=m.pickBox(u,h);v(j)});case 3:case"end":return G.stop()}},s,this)}));function a(s,u,h){return l.apply(this,arguments)}return a}()},{key:"pickBox",value:function(a,s){var u=this,h=s.map(function(bn){var hn=bn<0?0:bn;return Math.floor(hn*fa/u.pickBufferScale)}),v=(0,yt.Z)(h,4),m=v[0],w=v[1],A=v[2],R=v[3],B=this.rendererService,G=B.readPixels,j=B.getContainer,lt=this.getContainerSize(j()),ct=lt.width,_t=lt.height;if(ct*=fa,_t*=fa,m>(ct-1)*fa/this.pickBufferScale||A<0||w>(_t-1)*fa/this.pickBufferScale||R<0)return[];for(var Zt=Math.min(ct/this.pickBufferScale,A)-m,pe=Math.min(_t/this.pickBufferScale,R)-w,fe=G({x:m,y:Math.floor(_t/this.pickBufferScale-(R+1)),width:Zt,height:pe,data:new Uint8Array(Zt*pe*4),framebuffer:this.pickingFBO}),Ze=[],Qe={},wr=0;wr<fe.length/4;wr=wr+1){var Lr=fe.slice(wr*4,wr*4+4),Vr=_r(Lr);if(Vr!==-1&&!Qe[Vr]){var Wr=a.layerPickService.getFeatureById(Vr);Ze.push((0,K.Z)((0,K.Z)({},Wr),{},{pickedFeatureIdx:Vr})),Qe[Vr]=!0}}return Ze}},{key:"handleCursor",value:function(a,s){var u=a.getLayerConfig(),h=u.cursor,v=h===void 0?"":h,m=u.cursorEnabled;if(m){var w=this.mapService.version,A=w==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),R=A==null?void 0:A.style.getPropertyValue("cursor");s==="unmousemove"&&R!==""?A==null||A.style.setProperty("cursor",""):s==="mousemove"&&(A==null||A.style.setProperty("cursor",v))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(a){return a.getContext?{width:a.width/fa,height:a.height/fa}:a.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var l=(0,J.Z)(ot().mark(function s(u){return ot().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(!this.layerService.needPick(u.type)||!this.isPickingAllLayer())){v.next=2;break}return v.abrupt("return");case 2:return this.alreadyInPicking=!0,v.next=5,this.pickingLayers(u);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return v.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var a=this.rendererService.getContainer,s=this.getContainerSize(a()),u=s.width,h=s.height;u*=fa,h*=fa,(this.width!==u||this.height!==h)&&(this.pickingFBO.resize({width:Math.round(u/this.pickBufferScale),height:Math.round(h/this.pickBufferScale)}),this.width=u,this.height=h)}},{key:"pickingLayers",value:function(){var l=(0,J.Z)(ot().mark(function s(u){var h=this,v,m,w;return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:v=this.rendererService,m=v.useFramebuffer,w=v.clear,this.resizePickingFBO(),m(this.pickingFBO,function(){var B=h.layerService.getRenderList();B.filter(function(G){return G.needPick(u.type)}).reverse().some(function(G){w({framebuffer:h.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),G.layerPickService.pickRender(u);var j=h.pickFromPickingFBO(G,u);return h.layerService.pickedLayerId=j?+G.id:-1,j&&!G.getLayerConfig().enablePropagation})});case 3:case"end":return R.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"triggerHoverOnLayer",value:function(a,s){zg(s)&&(this.handleCursor(a,s.type),a.emit(s.type,s))}}]),n}(),Ug=Fi(rp.prototype,"mapService",[yy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d0=Fi(rp.prototype,"rendererService",[bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bc=Fi(rp.prototype,"configService",[Hs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kd=Fi(rp.prototype,"interactionService",[lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ld=Fi(rp.prototype,"layerService",[_y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rp))||ep),Od=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,pt.Z)(this,n),(0,W.Z)(this,"autoStart",void 0),(0,W.Z)(this,"startTime",0),(0,W.Z)(this,"oldTime",0),(0,W.Z)(this,"running",!1),(0,W.Z)(this,"elapsedTime",0),this.autoStart=l}return(0,et.Z)(n,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var s=(typeof performance=="undefined"?Date:performance).now();a=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=a}return a}}]),n}(),Fd,v0,np,J0,Ev,ip,g0;function tg(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=wc(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function wc(n,l){if(n){if(typeof n=="string")return Ih(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ih(n,l)}}function Ih(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function eg(n){var l=kh();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function kh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Zg=(Fd=(0,Tt.b2)(),v0=(0,Tt.f3)(Dt.IRendererService),np=(0,Tt.f3)(Dt.IMapService),Fd(J0=(Ev=function(n){(0,zt.Z)(a,n);var l=eg(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"pickedLayerId",-1),(0,W.Z)((0,ut.Z)(s),"clock",new Od),(0,W.Z)((0,ut.Z)(s),"alreadyInRendering",!1),(0,W.Z)((0,ut.Z)(s),"layers",[]),(0,W.Z)((0,ut.Z)(s),"layerList",[]),(0,W.Z)((0,ut.Z)(s),"layerRenderID",void 0),(0,W.Z)((0,ut.Z)(s),"sceneInited",!1),(0,W.Z)((0,ut.Z)(s),"animateInstanceCount",0),(0,W.Z)((0,ut.Z)(s),"shaderPicking",!0),(0,W.Z)((0,ut.Z)(s),"enableRender",!0),Rn((0,ut.Z)(s),"renderService",ip,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"mapService",g0,(0,ut.Z)(s)),(0,W.Z)((0,ut.Z)(s),"reRender",(0,ne.throttle)(function(){s.updateLayerRenderList(),s.renderLayers()},32)),(0,W.Z)((0,ut.Z)(s),"throttleRenderLayers",(0,ne.throttle)(function(){s.renderLayers()},16)),s}return(0,et.Z)(a,[{key:"needPick",value:function(u){return this.layerList.some(function(h){return h.needPick(u)})}},{key:"add",value:function(u){var h=this;this.layers.push(u),this.sceneInited&&u.init().then(function(){h.updateLayerRenderList(),h.renderLayers()})}},{key:"addMask",value:function(u){var h=this;this.sceneInited&&u.init().then(function(){h.renderLayers()})}},{key:"initLayers",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v=this;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var A=(0,J.Z)(ot().mark(function R(B){return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(B.startInit){j.next=4;break}return j.next=3,B.init();case 3:v.updateLayerRenderList();case 4:case"end":return j.stop()}},R)}));return function(R){return A.apply(this,arguments)}}());case 2:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(u){return this.layers.find(function(h){return h.id===u})}},{key:"getLayerByName",value:function(u){return this.layers.find(function(h){return h.name===u})}},{key:"remove",value:function(){var s=(0,J.Z)(ot().mark(function h(v,m){var w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:m?(w=m.layerChildren.indexOf(v),w>-1&&m.layerChildren.splice(w,1)):(A=this.layers.indexOf(v),A>-1&&this.layers.splice(A,1)),this.updateLayerRenderList(),v.destroy(),this.reRender(),this.emit("layerChange",this.layers);case 5:case"end":return B.stop()}},h,this)}));function u(h,v){return s.apply(this,arguments)}return u}()},{key:"removeAllLayers",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:this.destroy(),this.reRender();case 2:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"setEnableRender",value:function(u){this.enableRender=u}},{key:"renderLayers",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w;return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){R.next=2;break}return R.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),v=tg(this.layerList),R.prev=5,v.s();case 7:if((m=v.n()).done){R.next=19;break}if(w=m.value,w.masks.filter(function(B){return B.inited}).length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),w.masks.map(function(){var B=(0,J.Z)(ot().mark(function G(j){return ot().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:j.render();case 1:case"end":return ct.stop()}},G)}));return function(G){return B.apply(this,arguments)}}())),!w.getLayerConfig().enableMultiPassRenderer){R.next=15;break}return R.next=13,w.renderMultiPass();case 13:R.next=17;break;case 15:return R.next=17,w.render();case 17:R.next=7;break;case 19:R.next=24;break;case 21:R.prev=21,R.t0=R.catch(5),v.e(R.t0);case 24:return R.prev=24,v.f(),R.finish(24);case 27:this.alreadyInRendering=!1;case 28:case"end":return R.stop()}},h,this,[[5,21,24,27]])}));function u(){return s.apply(this,arguments)}return u}()},{key:"renderMask",value:function(u){u.filter(function(h){return h.inited}).map(function(h){h.render()})}},{key:"beforeRenderData",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,v.hooks.beforeRenderData.promise();case 2:m=A.sent,m&&this.renderLayers();case 4:case"end":return A.stop()}},h,this)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"renderLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m=this;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(v.masks.filter(function(R){return R.inited}).length>0&&v.masks.map(function(R){m.renderService.clear({stencil:0,depth:1,framebuffer:null}),R.render()}),!v.getLayerConfig().enableMultiPassRenderer){A.next=6;break}return A.next=4,v.renderMultiPass();case 4:A.next=8;break;case 6:return A.next=8,v.render();case 8:case"end":return A.stop()}},h)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"updateLayerRenderList",value:function(){var u=this;this.layerList=[],this.layers.filter(function(h){return h.inited}).filter(function(h){return h.isVisible()}).sort(function(h,v){return h.zIndex-v.zIndex}).forEach(function(h){u.layerList.push(h)})}},{key:"destroy",value:function(){this.layers.forEach(function(u){u.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var u=$e(this.mapService.bgColor);this.renderService.clear({color:u,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=Ga.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){Ga.cancelAnimationFrame(this.layerRenderID)}}]),a}(Ee.EventEmitter),ip=Fi(Ev.prototype,"renderService",[v0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g0=Fi(Ev.prototype,"mapService",[np],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ev))||J0),ql=nt(66105),ap=function(){function n(l){var a=this;(0,pt.Z)(this,n),(0,W.Z)(this,"name",void 0),(0,W.Z)(this,"type",void 0),(0,W.Z)(this,"scale",void 0),(0,W.Z)(this,"descriptor",void 0),(0,W.Z)(this,"featureBufferLayout",[]),(0,W.Z)(this,"needRescale",!1),(0,W.Z)(this,"needRemapping",!1),(0,W.Z)(this,"needRegenerateVertices",!1),(0,W.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,W.Z)(this,"vertexAttribute",void 0),(0,W.Z)(this,"defaultCallback",function(s){if(s.length===0){var u;return((u=a.scale)===null||u===void 0?void 0:u.defaultValues)||[]}return s.map(function(h,v){var m,w=(m=a.scale)===null||m===void 0?void 0:m.scalers[v].func,A=w(h);return A})}),this.setProps(l)}return(0,et.Z)(n,[{key:"setProps",value:function(a){Object.assign(this,a)}},{key:"mapping",value:function(a){var s;if((s=this.scale)!==null&&s!==void 0&&s.callback){var u,h=(u=this.scale)===null||u===void 0?void 0:u.callback.apply(u,(0,ve.Z)(a));if(!(0,ne.isNil)(h))return[h]}return this.defaultCallback(a)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),n}(),wv=["modelType"],Rd=["buffer","update","name"],Dd=["buffer","update","name"],Sv=["buffer","update","name"],Cv,Vg,Gg,m0,y0,Nc,op=(Cv={},(0,W.Z)(Cv,se.FLOAT,4),(0,W.Z)(Cv,se.UNSIGNED_BYTE,1),(0,W.Z)(Cv,se.UNSIGNED_SHORT,2),Cv),xy=(Vg=(0,Tt.b2)(),Gg=(0,Tt.f3)(Dt.IRendererService),Vg(m0=(y0=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"attributesAndIndices",void 0),Rn(this,"rendererService",Nc,this),(0,W.Z)(this,"attributes",[]),(0,W.Z)(this,"triangulation",void 0),(0,W.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,et.Z)(n,[{key:"registerStyleAttribute",value:function(a){var s=this.getLayerStyleAttribute(a.name||"");return s?s.setProps(a):(s=new ap(a),this.attributes.push(s)),s}},{key:"updateScaleAttribute",value:function(a){this.attributes.forEach(function(s){var u,h=s.name,v=(u=s.scale)===null||u===void 0?void 0:u.field;(a[h]||v&&a[v])&&(s.needRescale=!0,s.needRemapping=!0,s.needRegenerateVertices=!0)})}},{key:"updateStyleAttribute",value:function(a,s,u){var h=this.getLayerStyleAttribute(a);h||(h=this.registerStyleAttribute((0,K.Z)((0,K.Z)({},s),{},{name:a})));var v=s.scale;v&&h&&(h.scale=v,h.needRescale=!0,h.needRemapping=!0,h.needRegenerateVertices=!0,u&&u.featureRange&&(h.featureRange=u.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(a){return this.attributes.find(function(s){return s.name===a})}},{key:"getLayerAttributeScale",value:function(a){var s,u=this.getLayerStyleAttribute(a),h=u==null||(s=u.scale)===null||s===void 0?void 0:s.scalers;return h&&h[0]?h[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(a,s){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=arguments.length>3?arguments[3]:void 0,v=arguments.length>4?arguments[4]:void 0,m=this.attributes.find(function(Qe){return Qe.name===a});if(m&&m.descriptor){var w=m.descriptor,A=w.update,R=w.buffer,B=w.size,G=B===void 0?0:B,j=op[R.type||se.FLOAT];if(A){var lt=this.featureLayout,ct=lt.elements,_t=lt.sizePerElement,Zt=ct.slice(u,h);if(!Zt.length)return;var pe=Zt[0].offset,fe=pe*G*j,Ze=Zt.map(function(Qe,wr){for(var Lr=Qe.featureIdx,Vr=Qe.vertices,Wr=Qe.normals,bn=Vr.length/_t,hn=[],Wn=0;Wn<bn;Wn++){var vi=Wr?Wr.slice(Wn*3,Wn*3+3):[];hn.push.apply(hn,(0,ve.Z)(A(s[Lr],Lr,Vr.slice(Wn*_t,Wn*_t+_t),wr,vi)))}return hn}).reduce(function(Qe,wr){return Qe.push.apply(Qe,(0,ve.Z)(wr)),Qe},[]);m.vertexAttribute.updateBuffer({data:Ze,offset:fe}),v==null||v.emit("legend:".concat(a),{type:a,attr:m})}}}},{key:"createAttributesAndIndicesAscy",value:function(a,s,u){var h=this;this.featureLayout={sizePerElement:0,elements:[]};var v=this.attributes.map(function(lt){return lt.resetDescriptor(),lt.descriptor}).filter(function(lt){return lt}),m=u.modelType,w=(0,ql.Z)(u,wv),A=this.rendererService,R=A.createAttribute,B=A.createBuffer,G=A.createElements,j={};return new Promise(function(lt,ct){Rp(m,(0,K.Z)({descriptors:h.getDescriptorsWithOutFunc(v),features:a,segmentNumber:s},w)).then(function(_t){_t.descriptors.forEach(function(pe,fe){if(pe){var Ze=pe.buffer,Qe=pe.update,wr=pe.name,Lr=(0,ql.Z)(pe,Rd),Vr=R((0,K.Z)({buffer:B(Ze)},Lr));j[pe.name||""]=Vr,h.attributes[fe].vertexAttribute=Vr}}),h.featureLayout=_t.featureLayout;var Zt=G({data:_t.indices,type:se.UNSIGNED_INT,count:_t.indices.length});h.attributesAndIndices={attributes:j,elements:Zt,count:null},lt(h.attributesAndIndices)}).catch(function(_t){console.warn(_t),ct(_t)})})}},{key:"createAttributesAndIndices",value:function(a,s,u){var h=this;this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);var v=this.attributes.map(function(fe){return fe.resetDescriptor(),fe.descriptor}),m=0,w=0,A=[],R=[],B=[],G=3;a.forEach(function(fe,Ze){var Qe=h.triangulation(fe,u),wr=Qe.indices,Lr=Qe.vertices,Vr=Qe.normals,Wr=Qe.size,bn=Qe.indexes,hn=Qe.count;typeof hn=="number"&&(w+=hn),wr.forEach(function(go){R.push(go+m)}),G=Wr;var Wn=Lr.length/Wr;h.featureLayout.sizePerElement=G,h.featureLayout.elements.push({featureIdx:Ze,vertices:Lr,normals:Vr,offset:m}),m+=Wn;for(var vi=function(zo){var zs=(Vr==null?void 0:Vr.slice(zo*3,zo*3+3))||[],cu=Lr.slice(zo*Wr,zo*Wr+Wr),Xu=0;bn&&bn[zo]!==void 0&&(Xu=bn[zo]),v.forEach(function(zh,m2){if(zh&&zh.update){var p_;(p_=zh.buffer.data).push.apply(p_,(0,ve.Z)(zh.update(fe,Ze,cu,zo,zs,Xu)))}})},$i=0;$i<Wn;$i++)vi($i)});var j=this.rendererService,lt=j.createAttribute,ct=j.createBuffer,_t=j.createElements,Zt={};v.forEach(function(fe,Ze){if(fe){var Qe=fe.buffer,wr=fe.update,Lr=fe.name,Vr=(0,ql.Z)(fe,Dd),Wr=lt((0,K.Z)({buffer:ct(Qe)},Vr));Zt[fe.name||""]=Wr,h.attributes[Ze].vertexAttribute=Wr}});var pe=_t({data:R,type:se.UNSIGNED_INT,count:R.length});return this.attributesAndIndices={attributes:Zt,elements:pe,count:w},this.attributesAndIndices}},{key:"createAttributes",value:function(a,s){var u=this;this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);var h=this.attributes.map(function(j){return j.resetDescriptor(),j.descriptor}),v=0,m=[],w=3;a.forEach(function(j,lt){var ct=u.triangulation(j),_t=ct.indices,Zt=ct.vertices,pe=ct.normals,fe=ct.size,Ze=ct.indexes;_t.forEach(function(Vr){m.push(Vr+v)}),w=fe;var Qe=Zt.length/fe;u.featureLayout.sizePerElement=w,u.featureLayout.elements.push({featureIdx:lt,vertices:Zt,normals:pe,offset:v}),v+=Qe;for(var wr=function(Wr){var bn=(pe==null?void 0:pe.slice(Wr*3,Wr*3+3))||[],hn=Zt.slice(Wr*fe,Wr*fe+fe),Wn=0;Ze&&Ze[Wr]!==void 0&&(Wn=Ze[Wr]),h.forEach(function(vi,$i){if(vi&&vi.update){var go;(go=vi.buffer.data).push.apply(go,(0,ve.Z)(vi.update(j,lt,hn,Wr,bn,Wn)))}})},Lr=0;Lr<Qe;Lr++)wr(Lr)});var A=this.rendererService,R=A.createAttribute,B=A.createBuffer,G={};return h.forEach(function(j,lt){if(j){var ct=j.buffer,_t=j.update,Zt=j.name,pe=(0,ql.Z)(j,Sv),fe=R((0,K.Z)({buffer:B(ct)},pe));G[j.name||""]=fe,u.attributes[lt].vertexAttribute=fe}}),{attributes:G}}},{key:"clearAllAttributes",value:function(){var a;this.attributes.forEach(function(s){s.vertexAttribute&&s.vertexAttribute.destroy()}),(a=this.attributesAndIndices)===null||a===void 0||a.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(a){return a.map(function(s){return{buffer:s.buffer,name:s.name,size:s.size}})}}]),n}(),Nc=Fi(y0.prototype,"rendererService",[Gg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y0))||m0),Zp=nt(93738);function _0(n,l,a,s){function u(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(R){try{A(s.next(R))}catch(B){v(B)}}function w(R){try{A(s.throw(R))}catch(B){v(B)}}function A(R){R.done?h(R.value):u(R.value).then(m,w)}A((s=s.apply(n,l||[])).next())})}function rg(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,u,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(R){return w([A,R])}}function w(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,u&&(h=A[0]&2?u.return:A[0]?u.throw||((h=u.return)&&h.call(u),0):u.next)&&!(h=h.call(u,A[1])).done)return h;switch(u=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,u=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(R){A=[6,R],u=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Bd(n,l){var a=typeof Symbol=="function"&&n[Symbol.iterator];if(!a)return n;var s=a.call(n),u,h=[],v;try{for(;(l===void 0||l-- >0)&&!(u=s.next()).done;)h.push(u.value)}catch(m){v={error:m}}finally{try{u&&!u.done&&(a=s.return)&&a.call(s)}finally{if(v)throw v.error}}return h}function x0(n,l,a){if(a||arguments.length===2)for(var s=0,u=l.length,h;s<u;s++)(h||!(s in l))&&(h||(h=Array.prototype.slice.call(l,0,s)),h[s]=l[s]);return n.concat(h||Array.prototype.slice.call(l))}function ng(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var hl={exports:{}},Rf={exports:{}},sp={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){return s&&typeof s.length=="number"&&s.length>=0&&s.length%1===0}n.exports=l.default})(sp,sp.exports);var Sc={},Av={exports:{}},Hg={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(a){return function(){for(var s=[],u=arguments.length;u--;)s[u]=arguments[u];var h=s.pop();return a.call(this,s,h)}},n.exports=l.default})(Hg,Hg.exports);var up={};Object.defineProperty(up,"__esModule",{value:!0}),up.fallback=Ey,up.wrap=Wg;var by=up.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,v_=up.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,jg=up.hasNextTick=typeof Zp=="object"&&typeof Zp.nextTick=="function";function Ey(n){setTimeout(n,0)}function Wg(n){return function(l){for(var a=[],s=arguments.length-1;s-- >0;)a[s]=arguments[s+1];return n(function(){return l.apply(void 0,a)})}}var lp;by?lp=queueMicrotask:v_?lp=setImmediate:jg?lp=Zp.nextTick:lp=Ey,up.default=Wg(lp),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=w;var a=Hg.exports,s=m(a),u=up,h=m(u),v=Sc;function m(B){return B&&B.__esModule?B:{default:B}}function w(B){return(0,v.isAsync)(B)?function(){for(var G=[],j=arguments.length;j--;)G[j]=arguments[j];var lt=G.pop(),ct=B.apply(this,G);return A(ct,lt)}:(0,s.default)(function(G,j){var lt;try{lt=B.apply(this,G)}catch(ct){return j(ct)}if(lt&&typeof lt.then=="function")return A(lt,j);j(null,lt)})}function A(B,G){return B.then(function(j){R(G,null,j)},function(j){R(G,j&&j.message?j:new Error(j))})}function R(B,G,j){try{B(G,j)}catch(lt){(0,h.default)(function(ct){throw ct},lt)}}n.exports=l.default}(Av,Av.exports),Object.defineProperty(Sc,"__esModule",{value:!0}),Sc.isAsyncIterable=Sc.isAsyncGenerator=Sc.isAsync=void 0;var g_=Av.exports,m_=Lh(g_);function Lh(n){return n&&n.__esModule?n:{default:n}}function b0(n){return n[Symbol.toStringTag]==="AsyncFunction"}function E0(n){return n[Symbol.toStringTag]==="AsyncGenerator"}function Tv(n){return typeof n[Symbol.asyncIterator]=="function"}function wy(n){if(typeof n!="function")throw new Error("expected a function");return b0(n)?(0,m_.default)(n):n}Sc.default=wy,Sc.isAsync=b0,Sc.isAsyncGenerator=E0,Sc.isAsyncIterable=Tv;var Nd={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s,u){if(u===void 0&&(u=s.length),!u)throw new Error("arity is undefined");function h(){for(var v=this,m=[],w=arguments.length;w--;)m[w]=arguments[w];return typeof m[u-1]=="function"?s.apply(this,m):new Promise(function(A,R){m[u-1]=function(B){for(var G=[],j=arguments.length-1;j-- >0;)G[j]=arguments[j+1];if(B)return R(B);A(G.length>1?G:G[0])},s.apply(v,m)})}return h}n.exports=l.default})(Nd,Nd.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=sp.exports,s=w(a),u=Sc,h=w(u),v=Nd.exports,m=w(v);function w(A){return A&&A.__esModule?A:{default:A}}l.default=(0,m.default)(function(A,R,B){var G=(0,s.default)(R)?[]:{};A(R,function(j,lt,ct){(0,h.default)(j)(function(_t){for(var Zt,pe=[],fe=arguments.length-1;fe-- >0;)pe[fe]=arguments[fe+1];pe.length<2&&(Zt=pe,pe=Zt[0]),G[lt]=pe,ct(_t)})},function(j){return B(j,G)})},3),n.exports=l.default}(Rf,Rf.exports);var Sy={exports:{}},Cy={exports:{}},y_={exports:{}},Xg={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){function u(){for(var h=[],v=arguments.length;v--;)h[v]=arguments[v];if(s!==null){var m=s;s=null,m.apply(this,h)}}return Object.assign(u,s),u}n.exports=l.default})(Xg,Xg.exports);var __={exports:{}},x_={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(a){return a[Symbol.iterator]&&a[Symbol.iterator]()},n.exports=l.default})(x_,x_.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=R;var a=sp.exports,s=v(a),u=x_.exports,h=v(u);function v(B){return B&&B.__esModule?B:{default:B}}function m(B){var G=-1,j=B.length;return function(){return++G<j?{value:B[G],key:G}:null}}function w(B){var G=-1;return function(){var lt=B.next();return lt.done?null:(G++,{value:lt.value,key:G})}}function A(B){var G=B?Object.keys(B):[],j=-1,lt=G.length;return function ct(){var _t=G[++j];return _t==="__proto__"?ct():j<lt?{value:B[_t],key:_t}:null}}function R(B){if((0,s.default)(B))return m(B);var G=(0,h.default)(B);return G?w(G):A(B)}n.exports=l.default}(__,__.exports);var Yg={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){return function(){for(var u=[],h=arguments.length;h--;)u[h]=arguments[h];if(s===null)throw new Error("Callback was already called.");var v=s;s=null,v.apply(this,u)}}n.exports=l.default})(Yg,Yg.exports);var b_={exports:{}},$g={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a={};l.default=a,n.exports=l.default})($g,$g.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=h;var a=$g.exports,s=u(a);function u(v){return v&&v.__esModule?v:{default:v}}function h(v,m,w,A){var R=!1,B=!1,G=!1,j=0,lt=0;function ct(){j>=m||G||R||(G=!0,v.next().then(function(pe){var fe=pe.value,Ze=pe.done;if(!(B||R)){if(G=!1,Ze){R=!0,j<=0&&A(null);return}j++,w(fe,lt,_t),lt++,ct()}}).catch(Zt))}function _t(pe,fe){if(j-=1,!B){if(pe)return Zt(pe);if(pe===!1){R=!0,B=!0;return}if(fe===s.default||R&&j<=0)return R=!0,A(null);ct()}}function Zt(pe){B||(G=!1,R=!0,A(pe))}ct()}n.exports=l.default}(b_,b_.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Xg.exports,s=j(a),u=__.exports,h=j(u),v=Yg.exports,m=j(v),w=Sc,A=b_.exports,R=j(A),B=$g.exports,G=j(B);function j(lt){return lt&&lt.__esModule?lt:{default:lt}}l.default=function(lt){return function(ct,_t,Zt){if(Zt=(0,s.default)(Zt),lt<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!ct)return Zt(null);if((0,w.isAsyncGenerator)(ct))return(0,R.default)(ct,lt,_t,Zt);if((0,w.isAsyncIterable)(ct))return(0,R.default)(ct[Symbol.asyncIterator](),lt,_t,Zt);var pe=(0,h.default)(ct),fe=!1,Ze=!1,Qe=0,wr=!1;function Lr(Wr,bn){if(!Ze)if(Qe-=1,Wr)fe=!0,Zt(Wr);else if(Wr===!1)fe=!0,Ze=!0;else{if(bn===G.default||fe&&Qe<=0)return fe=!0,Zt(null);wr||Vr()}}function Vr(){for(wr=!0;Qe<lt&&!fe;){var Wr=pe();if(Wr===null){fe=!0,Qe<=0&&Zt(null);return}Qe+=1,_t(Wr.value,Wr.key,(0,m.default)(Lr))}wr=!1}Vr()}},n.exports=l.default}(y_,y_.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=y_.exports,s=w(a),u=Sc,h=w(u),v=Nd.exports,m=w(v);function w(R){return R&&R.__esModule?R:{default:R}}function A(R,B,G,j){return(0,s.default)(B)(R,(0,h.default)(G),j)}l.default=(0,m.default)(A,4),n.exports=l.default}(Cy,Cy.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Cy.exports,s=v(a),u=Nd.exports,h=v(u);function v(w){return w&&w.__esModule?w:{default:w}}function m(w,A,R){return(0,s.default)(w,1,A,R)}l.default=(0,h.default)(m,3),n.exports=l.default}(Sy,Sy.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=m;var a=Rf.exports,s=v(a),u=Sy.exports,h=v(u);function v(w){return w&&w.__esModule?w:{default:w}}function m(w,A){return(0,s.default)(h.default,w,A)}n.exports=l.default}(hl,hl.exports);var Ay=ng(hl.exports),Vp=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.call=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Ay(this.tasks)},n.prototype.tap=function(l,a){var s=this;this.tasks.push(function(u){a.apply(void 0,x0([],Bd(s.args),!1)),u(null,l)})},n}(),E_={exports:{}},Ty={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=sp.exports,s=_t(a),u=$g.exports,h=_t(u),v=Cy.exports,m=_t(v),w=Xg.exports,A=_t(w),R=Yg.exports,B=_t(R),G=Sc,j=_t(G),lt=Nd.exports,ct=_t(lt);function _t(Ze){return Ze&&Ze.__esModule?Ze:{default:Ze}}function Zt(Ze,Qe,wr){wr=(0,A.default)(wr);var Lr=0,Vr=0,Wr=Ze.length,bn=!1;Wr===0&&wr(null);function hn(Wn,vi){Wn===!1&&(bn=!0),bn!==!0&&(Wn?wr(Wn):(++Vr===Wr||vi===h.default)&&wr(null))}for(;Lr<Wr;Lr++)Qe(Ze[Lr],Lr,(0,B.default)(hn))}function pe(Ze,Qe,wr){return(0,m.default)(Ze,1/0,Qe,wr)}function fe(Ze,Qe,wr){var Lr=(0,s.default)(Ze)?Zt:pe;return Lr(Ze,(0,j.default)(Qe),wr)}l.default=(0,ct.default)(fe,3),n.exports=l.default})(Ty,Ty.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=m;var a=Ty.exports,s=v(a),u=Rf.exports,h=v(u);function v(w){return w&&w.__esModule?w:{default:w}}function m(w,A){return(0,h.default)(s.default,w,A)}n.exports=l.default}(E_,E_.exports);var _2=ng(E_.exports),OT=function(){function n(){this.tasks=[]}return n.prototype.promise=function(){return _2(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(u){return _0(s,void 0,void 0,function(){return rg(this,function(h){switch(h.label){case 0:return[4,a()];case 1:return h.sent(),u(null,l),[2]}})})})},n}(),w_={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Xg.exports,s=R(a),u=Yg.exports,h=R(u),v=Sc,m=R(v),w=Nd.exports,A=R(w);function R(G){return G&&G.__esModule?G:{default:G}}function B(G,j){if(j=(0,s.default)(j),!Array.isArray(G))return j(new Error("First argument to waterfall must be an array of functions"));if(!G.length)return j();var lt=0;function ct(Zt){var pe=(0,m.default)(G[lt++]);pe.apply(void 0,Zt.concat([(0,h.default)(_t)]))}function _t(Zt){for(var pe=[],fe=arguments.length-1;fe-- >0;)pe[fe]=arguments[fe+1];if(Zt!==!1){if(Zt||lt===G.length)return j.apply(void 0,[Zt].concat(pe));ct(pe)}}ct([])}l.default=(0,A.default)(B),n.exports=l.default})(w_,w_.exports);var x2=ng(w_.exports),fO=function(){function n(){this.tasks=[]}return n.prototype.call=function(){return x2(this.tasks)},n.prototype.tap=function(l,a){this.tasks.length===0?this.tasks.push(function(s){var u=a();s(u?null:!1,u)}):this.tasks.push(function(s,u){var h=a.apply(void 0,x0([],Bd(s),!1));u(h?null:!1,l)})},n}(),My=function(){function n(){this.tasks=[]}return n.prototype.call=function(){return Ay(this.tasks)},n.prototype.tap=function(l,a){this.tasks.push(function(s){var u=a();s(u,l)})},n}(),is=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.promise=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Ay(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(u){return _0(s,void 0,void 0,function(){return rg(this,function(h){switch(h.label){case 0:return[4,a.apply(void 0,x0([],Bd(this.args),!1))];case 1:return h.sent(),u(null,l),[2]}})})})},n}(),hO=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.promise=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Ay(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(u){return _0(s,void 0,void 0,function(){var h;return rg(this,function(v){switch(v.label){case 0:return[4,a.apply(void 0,x0([],Bd(this.args),!1))];case 1:return h=v.sent(),u(h,l),[2]}})})})},n}(),Ph=function(){function n(){this.tasks=[]}return n.prototype.promise=function(){return x2(this.tasks)},n.prototype.tapPromise=function(l,a){this.tasks.length===0?this.tasks.push(function(s){a().then(function(u){s(null,u)})}):this.tasks.push(function(s,u){a(s).then(function(h){u(null,h)})})},n}(),S_=nt(73827),b2=nt.n(S_),E2,w2,ig,ag,C_,A_,S2,Iy,C2,uh,A2,T2,M2,I2,k2,L2,P2,Cc,O2,F2,qg,T_,R2,D2,B2,N2,z2,U2,Z2,V2,G2,H2,j2;function pO(n){var l=FT();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function FT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var RT=(E2=(0,Tt.b2)(),w2=(0,Tt.f3)(Dt.SceneID),ig=(0,Tt.f3)(Dt.IIconService),ag=(0,Tt.f3)(Dt.IFontService),C_=(0,Tt.f3)(Dt.IControlService),A_=(0,Tt.f3)(Dt.IGlobalConfigService),S2=(0,Tt.f3)(Dt.IMapService),Iy=(0,Tt.f3)(Dt.ICoordinateSystemService),C2=(0,Tt.f3)(Dt.IRendererService),uh=(0,Tt.f3)(Dt.ILayerService),A2=(0,Tt.f3)(Dt.ICameraService),T2=(0,Tt.f3)(Dt.IInteractionService),M2=(0,Tt.f3)(Dt.IPickingService),I2=(0,Tt.f3)(Dt.IShaderModuleService),k2=(0,Tt.f3)(Dt.IMarkerService),L2=(0,Tt.f3)(Dt.IPopupService),E2(P2=(Cc=function(n){(0,zt.Z)(a,n);var l=pO(a);function a(){var s;return(0,pt.Z)(this,a),s=l.call(this),(0,W.Z)((0,ut.Z)(s),"destroyed",!1),(0,W.Z)((0,ut.Z)(s),"loaded",!1),Rn((0,ut.Z)(s),"id",O2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"iconService",F2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"fontService",qg,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"controlService",T_,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"configService",R2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"map",D2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"coordinateSystemService",B2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"rendererService",N2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"layerService",z2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"cameraService",U2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"interactionService",Z2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"pickingService",V2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"shaderModuleService",G2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"markerService",H2,(0,ut.Z)(s)),Rn((0,ut.Z)(s),"popupService",j2,(0,ut.Z)(s)),(0,W.Z)((0,ut.Z)(s),"inited",!1),(0,W.Z)((0,ut.Z)(s),"initPromise",void 0),(0,W.Z)((0,ut.Z)(s),"rendering",!1),(0,W.Z)((0,ut.Z)(s),"$container",void 0),(0,W.Z)((0,ut.Z)(s),"canvas",void 0),(0,W.Z)((0,ut.Z)(s),"markerContainer",void 0),(0,W.Z)((0,ut.Z)(s),"hooks",void 0),(0,W.Z)((0,ut.Z)(s),"handleWindowResized",function(){s.emit("resize"),s.$container&&(s.initContainer(),lo(),s.coordinateSystemService.needRefresh=!0,s.render())}),(0,W.Z)((0,ut.Z)(s),"handleMapCameraChanged",function(u){s.cameraService.update(u),s.render()}),s.hooks={init:new is},s}return(0,et.Z)(a,[{key:"init",value:function(u){var h=this;this.configService.setSceneConfig(this.id,u),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return h.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,J.Z)(ot().mark(function v(){return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,new Promise(function(A){h.map.onCameraChanged(function(R){h.cameraService.init(),h.cameraService.update(R),A()}),h.map.init()});case 2:h.map.onCameraChanged(h.handleMapCameraChanged),h.map.addMarkerContainer(),h.markerService.addMarkers(),h.markerService.addMarkerLayers(),h.popupService.initPopup(),h.interactionService.init(),h.interactionService.on(os.Drag,h.addSceneEvent.bind(h));case 9:case"end":return w.stop()}},v)}))),this.hooks.init.tapPromise("initRenderer",(0,J.Z)(ot().mark(function v(){var m,w;return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(m=h.map.getOverlayContainer(),m?h.$container=m:h.$container=xv(h.configService.getSceneConfig(h.id).id||""),!h.$container){R.next=12;break}return h.canvas=Jt("canvas","",h.$container),h.setCanvas(),R.next=7,h.rendererService.init(h.canvas,h.configService.getSceneConfig(h.id),u.gl);case 7:h.initContainer(),b2()(h.$container,h.handleWindowResized),Ga.matchMedia&&((w=Ga.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||w===void 0||w.addListener(h.handleWindowResized)),R.next=13;break;case 12:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 13:h.pickingService.init(h.id);case 14:case"end":return R.stop()}},v)}))),this.render()}},{key:"initMiniScene",value:function(u){var h=this;this.configService.setSceneConfig(this.id,u),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return h.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,J.Z)(ot().mark(function v(){return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,new Promise(function(A){h.map.onCameraChanged(function(R){h.cameraService.init(),h.cameraService.update(R),h.map.version!=="GAODE2.x"&&A()}),h.map.initMiniMap()});case 2:h.map.onCameraChanged(h.handleMapCameraChanged),h.interactionService.init(),h.interactionService.on(os.Drag,h.addSceneEvent.bind(h));case 5:case"end":return w.stop()}},v)}))),this.hooks.init.tapPromise("initRenderer",(0,J.Z)(ot().mark(function v(){var m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(m=u.canvas,h.$container=m||null,!h.$container){A.next=7;break}return A.next=5,h.rendererService.init(u.canvas,h.configService.getSceneConfig(h.id),void 0);case 5:A.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:h.pickingService.init(h.id);case 9:case"end":return A.stop()}},v)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(u){this.layerService.sceneService=this,this.layerService.add(u)}},{key:"addMask",value:function(u){this.layerService.sceneService=this,this.layerService.addMask(u)}},{key:"render",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.rendering||this.destroyed)){m.next=2;break}return m.abrupt("return");case 2:if(this.rendering=!0,this.inited){m.next=16;break}return m.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),m.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,m.next=20;break;case 16:return m.next=18,this.layerService.initLayers();case 18:return m.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"addFontFace",value:function(u,h){this.fontService.addFontFace(u,h)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return w=(m=this.$container)===null||m===void 0?void 0:m.getElementsByTagName("canvas")[0],B.next=3,this.render();case 3:return A=v==="jpg"?w==null?void 0:w.toDataURL("image/jpeg"):w==null?void 0:w.toDataURL("image/png"),B.abrupt("return",A);case 5:case"end":return B.stop()}},h,this)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var u=this.$container.parentElement;u!==null&&(this.markerContainer=Jt("div","l7-marker-container",u))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var u=this,h,v;if(!this.inited){this.destroyed=!0;return}if((0,S_.unbind)(this.$container,this.handleWindowResized),Ga.matchMedia){var m;(m=Ga.matchMedia("screen and (min-resolution: 2dppx)"))===null||m===void 0||m.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var w;(w=u.$container)===null||w===void 0||w.removeChild(u.canvas),u.canvas=null,u.rendererService.destroy()}),(h=this.$container)===null||h===void 0||(v=h.parentNode)===null||v===void 0||v.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var u,h,v=fa,m=((u=this.$container)===null||u===void 0?void 0:u.clientWidth)||400,w=((h=this.$container)===null||h===void 0?void 0:h.clientHeight)||300,A=this.canvas;A&&(A.width=m*v,A.height=w*v),this.rendererService.viewport({x:0,y:0,width:v*m,height:v*w})}},{key:"setCanvas",value:function(){var u,h,v=fa,m=((u=this.$container)===null||u===void 0?void 0:u.clientWidth)||400,w=((h=this.$container)===null||h===void 0?void 0:h.clientHeight)||300,A=this.canvas;A.width=m*v,A.height=w*v,A.style.width="100%",A.style.height="100%"}},{key:"addSceneEvent",value:function(u){this.emit(u.type,u)}}]),a}(Ee.EventEmitter),O2=Fi(Cc.prototype,"id",[w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F2=Fi(Cc.prototype,"iconService",[ig],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qg=Fi(Cc.prototype,"fontService",[ag],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T_=Fi(Cc.prototype,"controlService",[C_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R2=Fi(Cc.prototype,"configService",[A_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D2=Fi(Cc.prototype,"map",[S2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B2=Fi(Cc.prototype,"coordinateSystemService",[Iy],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N2=Fi(Cc.prototype,"rendererService",[C2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z2=Fi(Cc.prototype,"layerService",[uh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U2=Fi(Cc.prototype,"cameraService",[A2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z2=Fi(Cc.prototype,"interactionService",[T2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V2=Fi(Cc.prototype,"pickingService",[M2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G2=Fi(Cc.prototype,"shaderModuleService",[I2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H2=Fi(Cc.prototype,"markerService",[k2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j2=Fi(Cc.prototype,"popupService",[L2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc))||P2);function DT(n){var l=0;switch(n){case"vec2":case"ivec2":l=2;break;case"vec3":case"ivec3":l=3;break;case"vec4":case"ivec4":case"mat2":l=4;break;case"mat3":l=9;break;case"mat4":l=16;break;default:}return l}var W2=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function X2(n){var l={};return n=n.replace(W2,function(a,s,u){var h=u.split(":"),v=h[0].trim(),m="";switch(h.length>1&&(m=h[1].trim()),s){case"bool":m=m==="true";break;case"float":case"int":m=Number(m);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":m?m=m.replace("[","").replace("]","").split(",").reduce(function(w,A){return w.push(Number(A.trim())),w},[]):m=new Array(DT(s)).fill(0);break;default:}return l[v]=m,"uniform ".concat(s," ").concat(v,`;
`)}),{content:n,uniforms:l}}var Y2,$2,q2="#define PI 3.14159265359",BT=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,NT=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,zT=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,UT=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,K2=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,ZT=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,VT=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel * u_FocalDistance ;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance ;
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom)* u_FocalDistance ;
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * 2.0 *  u_FocalDistance;;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom))  * u_FocalDistance ;
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))* u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * u_FocalDistance;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) * u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom)) * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom)) *  u_FocalDistance ;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom))  * u_FocalDistance ;
  }
  return pixel * -1. * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,GT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,HT=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,jT=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,WT=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,XT=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,YT=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,$T=/precision\s+(high|low|medium)p\s+float/,Q2=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,qT=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,KT=(Y2=(0,Tt.b2)(),Y2($2=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"moduleCache",{}),(0,W.Z)(this,"rawContentCache",{})}return(0,et.Z)(n,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:q2,fs:q2}),this.registerModule("decode",{vs:BT,fs:""}),this.registerModule("projection",{vs:VT,fs:""}),this.registerModule("project",{vs:ZT,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:GT}),this.registerModule("lighting",{vs:zT,fs:""}),this.registerModule("light",{vs:NT,fs:""}),this.registerModule("picking",{vs:K2,fs:UT}),this.registerModule("styleMapping",{vs:HT,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:YT,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:jT,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:WT,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:XT,fs:""})}},{key:"registerModule",value:function(a,s){if(!this.rawContentCache[a]){var u=s.vs,h=s.fs,v=s.uniforms,m=X2(u),w=m.content,A=m.uniforms,R=X2(h),B=R.content,G=R.uniforms;this.rawContentCache[a]={fs:B,uniforms:(0,K.Z)((0,K.Z)((0,K.Z)({},A),G),v),vs:w}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(a){var s=this;if(this.moduleCache[a])return this.moduleCache[a];var u=this.rawContentCache[a].vs,h=this.rawContentCache[a].fs,v=this.processModule(u,[],"vs"),m=v.content,w=v.includeList,A=this.processModule(h,[],"fs"),R=A.content,B=A.includeList,G=R,j=(0,ne.uniq)(w.concat(B).concat(a)).reduce(function(lt,ct){return(0,K.Z)((0,K.Z)({},lt),s.rawContentCache[ct].uniforms)},{});return $T.test(R)||(G=Q2+R),this.moduleCache[a]={fs:G.trim(),uniforms:j,vs:m.trim()},this.moduleCache[a]}},{key:"processModule",value:function(a,s,u){var h=this,v=a.replace(qT,function(m,w){var A=w.split(" "),R=A[0].replace(/"/g,"");if(s.indexOf(R)>-1)return"";var B=h.rawContentCache[R][u];s.push(R);var G=h.processModule(B,s,u),j=G.content;return j});return{content:v,includeList:s}}}]),n}())||$2);function QT(n,l){for(;!Object.prototype.hasOwnProperty.call(n,l)&&(n=(0,b.Z)(n),n!==null););return n}function ts(){return typeof Reflect!="undefined"&&Reflect.get?ts=Reflect.get.bind():ts=function(l,a,s){var u=QT(l,a);if(u){var h=Object.getOwnPropertyDescriptor(u,a);return h.get?h.get.call(arguments.length<3?l:s):h.value}},ts.apply(this,arguments)}var Mv;(function(n){n.Normal="normal",n.PostProcessing="post-processing"})(Mv||(Mv={}));var J2,tE,ky=(J2=(0,Tt.b2)(),J2(tE=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"shaderModuleService",void 0),(0,W.Z)(this,"rendererService",void 0),(0,W.Z)(this,"cameraService",void 0),(0,W.Z)(this,"mapService",void 0),(0,W.Z)(this,"interactionService",void 0),(0,W.Z)(this,"layerService",void 0),(0,W.Z)(this,"config",void 0)}return(0,et.Z)(n,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Mv.Normal}},{key:"init",value:function(a,s){this.config=s,this.rendererService=a.getContainer().get(Dt.IRendererService),this.cameraService=a.getContainer().get(Dt.ICameraService),this.mapService=a.getContainer().get(Dt.IMapService),this.interactionService=a.getContainer().get(Dt.IInteractionService),this.layerService=a.getContainer().get(Dt.ILayerService),this.shaderModuleService=a.getContainer().get(Dt.IShaderModuleService)}},{key:"render",value:function(a){}}]),n}())||tE),eE,rE;function JT(n){var l=M_();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function M_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tM=(eE=(0,Tt.b2)(),eE(rE=function(n){(0,zt.Z)(a,n);var l=JT(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(u,h){ts((0,b.Z)(a.prototype),"init",this).call(this,u,h)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),a}(ky))||rE),Kg,I_,eM,nE,iE;function rM(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=dO(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function dO(n,l){if(n){if(typeof n=="string")return nM(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return nM(n,l)}}function nM(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var iM=(Kg=(0,Tt.b2)(),I_=(0,Tt.f3)(Dt.IPostProcessor),Kg(eM=(nE=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"passes",[]),Rn(this,"postProcessor",iE,this),(0,W.Z)(this,"layer",void 0),(0,W.Z)(this,"renderFlag",void 0),(0,W.Z)(this,"width",0),(0,W.Z)(this,"height",0)}return(0,et.Z)(n,[{key:"setLayer",value:function(a){this.layer=a}},{key:"setRenderFlag",value:function(a){this.renderFlag=a}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var l=(0,J.Z)(ot().mark(function s(){var u,h,v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:u=rM(this.passes),w.prev=1,u.s();case 3:if((h=u.n()).done){w.next=9;break}return v=h.value,w.next=7,v.render(this.layer);case 7:w.next=3;break;case 9:w.next=14;break;case 11:w.prev=11,w.t0=w.catch(1),u.e(w.t0);case 14:return w.prev=14,u.f(),w.finish(14);case 17:return w.next=19,this.postProcessor.render(this.layer);case 19:case"end":return w.stop()}},s,this,[[1,11,14,17]])}));function a(){return l.apply(this,arguments)}return a}()},{key:"resize",value:function(a,s){(this.width!==a||this.height!==s)&&(this.postProcessor.resize(a,s),this.width=a,this.height=s)}},{key:"add",value:function(a,s){a.getType()===Mv.PostProcessing?this.postProcessor.add(a,this.layer,s):(a.init(this.layer,s),this.passes.push(a))}},{key:"insert",value:function(a,s,u){a.init(this.layer,s),this.passes.splice(u,0,a)}},{key:"destroy",value:function(){this.passes.length=0}}]),n}(),iE=Fi(nE.prototype,"postProcessor",[I_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nE))||eM),aE,oE;function aM(n){var l=k_();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function k_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var L_=(aE=(0,Tt.b2)(),aE(oE=function(n){(0,zt.Z)(a,n);var l=aM(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"pickingFBO",void 0),(0,W.Z)((0,ut.Z)(s),"layer",void 0),(0,W.Z)((0,ut.Z)(s),"width",0),(0,W.Z)((0,ut.Z)(s),"height",0),(0,W.Z)((0,ut.Z)(s),"alreadyInRendering",!1),(0,W.Z)((0,ut.Z)(s),"pickFromPickingFBO",function(m){var w=m.x,A=m.y,R=m.lngLat,B=m.type;if(!(!s.layer.isVisible()||!s.layer.needPick(B))){var G=s.rendererService,j=G.getViewportSize,lt=G.readPixels,ct=G.useFramebuffer,_t=j(),Zt=_t.width,pe=_t.height,fe=s.layer.getLayerConfig(),Ze=fe.enableHighlight,Qe=fe.enableSelect,wr=w*fa,Lr=A*fa;if(!(wr>Zt||wr<0||Lr>pe||Lr<0)){var Vr;ct(s.pickingFBO,function(){var Wr;if(Vr=lt({x:Math.round(wr),y:Math.round(pe-(A+1)*fa),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:s.pickingFBO}),Vr[0]!==0||Vr[1]!==0||Vr[2]!==0){var bn=_r(Vr),hn=s.layer.getSource().getFeatureById(bn),Wn={x:w,y:A,type:B,lngLat:R,featureId:bn,feature:hn};hn&&(s.layer.setCurrentPickId(bn),s.triggerHoverOnLayer(Wn))}else{var vi={x:w,y:A,lngLat:R,type:s.layer.getCurrentPickId()===null?"un"+B:"mouseout",featureId:null,feature:null};s.triggerHoverOnLayer((0,K.Z)((0,K.Z)({},vi),{},{type:"unpick"})),s.triggerHoverOnLayer(vi),s.layer.setCurrentPickId(null)}Ze&&s.highlightPickedFeature(Vr),Qe&&B==="click"&&((Wr=Vr)===null||Wr===void 0?void 0:Wr.toString())!==[0,0,0,0].toString()&&s.selectFeature(Vr)})}}}),s}return(0,et.Z)(a,[{key:"getType",value:function(){return Mv.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(u,h){ts((0,b.Z)(a.prototype),"init",this).call(this,u,h),this.layer=u;var v=this.rendererService,m=v.createTexture2D,w=v.createFramebuffer,A=v.getViewportSize,R=A(),B=R.width,G=R.height;this.pickingFBO=w({color:m({width:B,height:G,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})}),this.interactionService.on(os.Hover,this.pickFromPickingFBO),this.interactionService.on(os.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(os.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(u){var h=this;if(!this.alreadyInRendering){var v=this.rendererService,m=v.getViewportSize,w=v.useFramebuffer,A=v.clear,R=m(),B=R.width,G=R.height;this.alreadyInRendering=!0,(this.width!==B||this.height!==G)&&(this.pickingFBO.resize({width:B,height:G}),this.width=B,this.height=G),w(this.pickingFBO,function(){A({framebuffer:h.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var j=h.layer.multiPassRenderer.getRenderFlag();h.layer.multiPassRenderer.setRenderFlag(!1),u.hooks.beforePickingEncode.call(),u.render(),u.hooks.afterPickingEncode.call(),h.layer.multiPassRenderer.setRenderFlag(j),h.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(u){this.layer.emit(u.type,u)}},{key:"highlightPickedFeature",value:function(u){var h=(0,yt.Z)(u,3),v=h[0],m=h[1],w=h[2];this.layer.hooks.beforeHighlight.call([v,m,w]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(u){var h=(0,yt.Z)(u,3),v=h[0],m=h[1],w=h[2];this.layer.hooks.beforeSelect.call([v,m,w]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(u){var h=u.featureId,v=er(h);this.selectFeature(new Uint8Array(v))}},{key:"highlightFeatureHandle",value:function(u){var h=u.featureId,v=er(h);this.highlightPickedFeature(new Uint8Array(v))}}]),a}(ky))||oE),P_,O_,sE,Ly,og,oM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Iv=(P_=(0,Tt.b2)(),O_=(0,Tt.f3)(Dt.IShaderModuleService),P_(sE=(Ly=function(){function n(){(0,pt.Z)(this,n),Rn(this,"shaderModuleService",og,this),(0,W.Z)(this,"rendererService",void 0),(0,W.Z)(this,"config",void 0),(0,W.Z)(this,"quad",oM),(0,W.Z)(this,"enabled",!0),(0,W.Z)(this,"renderToScreen",!1),(0,W.Z)(this,"model",void 0),(0,W.Z)(this,"name",void 0),(0,W.Z)(this,"optionsToUpdate",{})}return(0,et.Z)(n,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(a){this.name=a}},{key:"getType",value:function(){return Mv.PostProcessing}},{key:"init",value:function(a,s){this.config=s,this.rendererService=a.getContainer().get(Dt.IRendererService),this.shaderModuleService=a.getContainer().get(Dt.IShaderModuleService);var u=this.rendererService,h=u.createAttribute,v=u.createBuffer,m=u.createModel,w=this.setupShaders(),A=w.vs,R=w.fs,B=w.uniforms;this.model=m({vs:A,fs:R,attributes:{a_Position:h({buffer:v({data:[-4,-4,4,-4,0,4],type:se.FLOAT}),size:2})},uniforms:(0,K.Z)((0,K.Z)({u_Texture:null},B),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(a,s){var u=this,h=a.multiPassRenderer.getPostProcessor(),v=this.rendererService,m=v.useFramebuffer,w=v.getViewportSize,A=v.clear,R=w(),B=R.width,G=R.height;m(this.renderToScreen?null:h.getWriteFBO(),function(){A({framebuffer:h.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var j=(0,K.Z)({u_BloomFinal:0,u_Texture:h.getReadFBO(),u_ViewportSize:[B,G]},u.convertOptionsToUniforms(u.optionsToUpdate));s&&(j.u_BloomFinal=1,j.u_Texture2=s),u.model.draw({uniforms:j})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(a){this.enabled=a}},{key:"setRenderToScreen",value:function(a){this.renderToScreen=a}},{key:"updateOptions",value:function(a){this.optionsToUpdate=(0,K.Z)((0,K.Z)({},this.optionsToUpdate),a)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(a){var s={};return Object.keys(a).forEach(function(u){(0,ne.isNil)(a[u])||(s["u_".concat((0,ne.upperFirst)((0,ne.camelCase)(u)))]=a[u])}),s}}]),n}(),og=Fi(Ly.prototype,"shaderModuleService",[O_],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ly))||sE),sM,uE;function uM(n){var l=F_();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function F_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var lM=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,cM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,fM=(sM=(0,Tt.b2)(),sM(uE=function(n){(0,zt.Z)(a,n);var l=uM(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:cM,fs:lM});var u=this.shaderModuleService.getModule("blur-pass"),h=u.vs,v=u.fs,m=u.uniforms,w=this.rendererService.getViewportSize(),A=w.width,R=w.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,R]})}}},{key:"convertOptionsToUniforms",value:function(u){var h={};return(0,ne.isNil)(u.bloomRadius)||(h.u_radius=u.bloomRadius),(0,ne.isNil)(u.bloomIntensity)||(h.u_intensity=u.bloomIntensity),(0,ne.isNil)(u.bloomBaseRadio)||(h.u_baseRadio=u.bloomBaseRadio),h}}]),a}(Iv))||uE),lE,R_;function hM(n){var l=D_();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function D_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var vO=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,gO=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,pM=(lE=(0,Tt.b2)(),lE(R_=function(n){(0,zt.Z)(a,n);var l=hM(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:gO,fs:vO});var u=this.shaderModuleService.getModule("blur-pass"),h=u.vs,v=u.fs,m=u.uniforms,w=this.rendererService.getViewportSize(),A=w.width,R=w.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,R]})}}},{key:"convertOptionsToUniforms",value:function(u){var h={};return(0,ne.isNil)(u.blurRadius)||(h.u_BlurDir=[u.blurRadius,0]),h}}]),a}(Iv))||R_),cE,fE;function mO(n){var l=yO();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function yO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dM=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,vM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,_O=(cE=(0,Tt.b2)(),cE(fE=function(n){(0,zt.Z)(a,n);var l=mO(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:vM,fs:dM});var u=this.shaderModuleService.getModule("blur-pass"),h=u.vs,v=u.fs,m=u.uniforms,w=this.rendererService.getViewportSize(),A=w.width,R=w.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,R]})}}},{key:"convertOptionsToUniforms",value:function(u){var h={};return(0,ne.isNil)(u.blurRadius)||(h.u_BlurDir=[0,u.blurRadius]),h}}]),a}(Iv))||fE),gM,hE;function mM(n){var l=yM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function yM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var xO=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,bO=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,_M=(gM=(0,Tt.b2)(),gM(hE=function(n){(0,zt.Z)(a,n);var l=mM(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:bO,fs:xO});var u=this.shaderModuleService.getModule("colorhalftone-pass"),h=u.vs,v=u.fs,m=u.uniforms,w=this.rendererService.getViewportSize(),A=w.width,R=w.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,R]})}}}]),a}(Iv))||hE),pE,Py;function B_(n){var l=xM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function xM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var bM=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,EM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Oy=(pE=(0,Tt.b2)(),pE(Py=function(n){(0,zt.Z)(a,n);var l=B_(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:EM,fs:bM}),this.shaderModuleService.getModule("copy-pass")}}]),a}(Iv))||Py),dE,vE;function wM(n){var l=SM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function SM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var CM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,AM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,TM=(dE=(0,Tt.b2)(),dE(vE=function(n){(0,zt.Z)(a,n);var l=wM(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:AM,fs:CM});var u=this.shaderModuleService.getModule("hexagonalpixelate-pass"),h=u.vs,v=u.fs,m=u.uniforms,w=this.rendererService.getViewportSize(),A=w.width,R=w.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,R]})}}}]),a}(Iv))||vE),gE,N_;function mE(n){var l=MM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function MM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var IM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,yE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,kM=(gE=(0,Tt.b2)(),gE(N_=function(n){(0,zt.Z)(a,n);var l=mE(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:yE,fs:IM});var u=this.shaderModuleService.getModule("ink-pass"),h=u.vs,v=u.fs,m=u.uniforms,w=this.rendererService.getViewportSize(),A=w.width,R=w.height;return{vs:h,fs:v,uniforms:(0,K.Z)((0,K.Z)({},m),{},{u_ViewportSize:[A,R]})}}}]),a}(Iv))||N_),_E,xE;function LM(n){var l=Fy();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Fy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,bE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,OM=(_E=(0,Tt.b2)(),_E(xE=function(n){(0,zt.Z)(a,n);var l=LM(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:bE,fs:PM}),this.shaderModuleService.getModule("noise-pass")}}]),a}(Iv))||xE),EE,z_;function FM(n){var l=RM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function RM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,SE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,DM=(EE=(0,Tt.b2)(),EE(z_=function(n){(0,zt.Z)(a,n);var l=FM(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:wE,fs:SE}),this.shaderModuleService.getModule("sepia-pass")}}]),a}(Iv))||z_),CE,Ry,AE,U_,sg,TE,BM=(CE=(0,Tt.b2)(),Ry=(0,Tt.f3)(Dt.IRendererService),AE=(0,Tt.zY)(),CE(U_=(sg=function(){function n(){(0,pt.Z)(this,n),Rn(this,"rendererService",TE,this),(0,W.Z)(this,"passes",[]),(0,W.Z)(this,"readFBO",void 0),(0,W.Z)(this,"writeFBO",void 0)}return(0,et.Z)(n,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var a=this.rendererService,s=a.getViewportSize,u=a.createTexture2D,h=s(),v=h.width,m=h.height;return u({x:0,y:0,width:v,height:m,copy:!0})}},{key:"getReadFBOTex",value:function(){var a=this,s=this.rendererService.useFramebuffer;return new Promise(function(u){s(a.readFBO,(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:u(a.getCurrentFBOTex());case 1:case"end":return m.stop()}},h)})))})}},{key:"renderBloomPass",value:function(){var l=(0,J.Z)(ot().mark(function s(u,h){var v,m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.getReadFBOTex();case 2:v=A.sent,m=0;case 4:if(!(m<4)){A.next=11;break}return A.next=7,h.render(u,v);case 7:this.swap(),m++,A.next=4;break;case 11:case"end":return A.stop()}},s,this)}));function a(s,u){return l.apply(this,arguments)}return a}()},{key:"render",value:function(){var l=(0,J.Z)(ot().mark(function s(u){var h,v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:h=0;case 1:if(!(h<this.passes.length)){w.next=15;break}if(v=this.passes[h],v.setRenderToScreen(this.isLastEnabledPass(h)),v.getName()!=="bloom"){w.next=9;break}return w.next=7,this.renderBloomPass(u,v);case 7:w.next=12;break;case 9:return w.next=11,v.render(u);case 11:h!==this.passes.length-1&&this.swap();case 12:h++,w.next=1;break;case 15:case"end":return w.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"resize",value:function(a,s){this.readFBO.resize({width:a,height:s}),this.writeFBO.resize({width:a,height:s})}},{key:"add",value:function(a,s,u){a.init(s,u),this.passes.push(a)}},{key:"insert",value:function(a,s,u,h){a.init(u,h),this.passes.splice(s,0,a)}},{key:"getPostProcessingPassByName",value:function(a){return this.passes.find(function(s){return s.getName()===a})}},{key:"init",value:function(){var a=this.rendererService,s=a.createFramebuffer,u=a.createTexture2D;this.readFBO=s({color:u({width:1,height:1,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})}),this.writeFBO=s({color:u({width:1,height:1,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(a){for(var s=a+1;s<this.passes.length;s++)if(this.passes[s].isEnabled())return!1;return!0}},{key:"swap",value:function(){var a=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=a}}]),n}(),TE=Fi(sg.prototype,"rendererService",[Ry],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fi(sg.prototype,"init",[AE],Object.getOwnPropertyDescriptor(sg.prototype,"init"),sg.prototype),sg))||U_),ME,IE;function kE(n){var l=NM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function NM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var zM=(ME=(0,Tt.b2)(),ME(IE=function(n){(0,zt.Z)(a,n);var l=kE(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getType",value:function(){return Mv.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(u,h){ts((0,b.Z)(a.prototype),"init",this).call(this,u,h)}},{key:"render",value:function(u){var h=this.rendererService,v=h.useFramebuffer,m=h.clear,w=u.multiPassRenderer.getPostProcessor().getReadFBO();v(w,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:w}),u.multiPassRenderer.setRenderFlag(!1),u.models.forEach(function(A){A.draw({uniforms:u.layerModel.getUninforms()})}),u.multiPassRenderer.setRenderFlag(!0)})}}]),a}(ky))||IE),LE,PE,OE,Dy,Qg;function FE(n){var l=RE();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function RE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var UM=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,DE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,BE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function NE(n,l){for(var a=0,s=1/l,u=n;u>0;)a=a+s*(u%l),u=Math.floor(u/l),s=s/l;return a}var ZM=1,VM=(LE=(0,Tt.b2)(),PE=(0,Tt.f3)(Dt.IShaderModuleService),LE(OE=(Dy=function(n){(0,zt.Z)(a,n);var l=FE(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),Rn((0,ut.Z)(s),"shaderModuleService",Qg,(0,ut.Z)(s)),(0,W.Z)((0,ut.Z)(s),"haltonSequence",[]),(0,W.Z)((0,ut.Z)(s),"accumulatingId",0),(0,W.Z)((0,ut.Z)(s),"frame",0),(0,W.Z)((0,ut.Z)(s),"timer",void 0),(0,W.Z)((0,ut.Z)(s),"sampleRenderTarget",void 0),(0,W.Z)((0,ut.Z)(s),"prevRenderTarget",void 0),(0,W.Z)((0,ut.Z)(s),"outputRenderTarget",void 0),(0,W.Z)((0,ut.Z)(s),"copyRenderTarget",void 0),(0,W.Z)((0,ut.Z)(s),"blendModel",void 0),(0,W.Z)((0,ut.Z)(s),"outputModel",void 0),(0,W.Z)((0,ut.Z)(s),"copyModel",void 0),s}return(0,et.Z)(a,[{key:"getType",value:function(){return Mv.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(u,h){ts((0,b.Z)(a.prototype),"init",this).call(this,u,h);var v=this.rendererService,m=v.createFramebuffer,w=v.createTexture2D;this.sampleRenderTarget=m({color:w({width:1,height:1,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})}),this.prevRenderTarget=m({color:w({width:1,height:1,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})}),this.outputRenderTarget=m({color:w({width:1,height:1,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})}),this.copyRenderTarget=m({color:w({width:1,height:1,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE})});for(var A=0;A<30;A++)this.haltonSequence.push([NE(A,2),NE(A,3)]);this.blendModel=this.createTriangleModel("blend-pass",UM),this.outputModel=this.createTriangleModel("copy-pass",DE,{blend:{enable:!0,func:{srcRGB:se.ONE,dstRGB:se.ONE_MINUS_SRC_ALPHA,srcAlpha:se.ONE,dstAlpha:se.ONE_MINUS_SRC_ALPHA},equation:{rgb:se.FUNC_ADD,alpha:se.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",DE)}},{key:"render",value:function(u){var h=this,v=this.rendererService,m=v.clear,w=v.getViewportSize,A=v.useFramebuffer,R=w(),B=R.width,G=R.height;this.sampleRenderTarget.resize({width:B,height:G}),this.prevRenderTarget.resize({width:B,height:G}),this.outputRenderTarget.resize({width:B,height:G}),this.copyRenderTarget.resize({width:B,height:G}),this.resetFrame(),this.stopAccumulating();var j=u.multiPassRenderer.getPostProcessor().getReadFBO();A(j,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:j}),u.multiPassRenderer.setRenderFlag(!1),u.render(),u.multiPassRenderer.setRenderFlag(!0)});var lt=function ct(_t){!h.accumulatingId||_t!==h.accumulatingId||h.isFinished()||(h.doRender(u),Ga.requestAnimationFrame(function(){ct(_t)}))};this.accumulatingId=ZM++,this.timer=Ga.setTimeout(function(){lt(h.accumulatingId)},50)}},{key:"doRender",value:function(u){var h=this,v=this.rendererService,m=v.clear,w=v.getViewportSize,A=v.useFramebuffer,R=w(),B=R.width,G=R.height,j=u.getLayerConfig(),lt=j.jitterScale,ct=lt===void 0?1:lt,_t=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((_t[0]*2-1)/B*ct,(_t[1]*2-1)/G*ct),u.multiPassRenderer.setRenderFlag(!1),u.hooks.beforeRender.call(),A(this.sampleRenderTarget,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:h.sampleRenderTarget}),u.render()}),u.hooks.afterRender.call(),u.multiPassRenderer.setRenderFlag(!0);var Zt=u.getLayerConfig();A(this.outputRenderTarget,function(){h.blendModel.draw({uniforms:{u_opacity:Zt.opacity||1,u_MixRatio:h.frame===0?1:.9,u_Diffuse1:h.sampleRenderTarget,u_Diffuse2:h.frame===0?u.multiPassRenderer.getPostProcessor().getReadFBO():h.prevRenderTarget}})}),this.frame===0&&m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(A(this.copyRenderTarget,function(){h.outputModel.draw({uniforms:{u_Texture:h.outputRenderTarget}})}),A(u.multiPassRenderer.getPostProcessor().getReadFBO(),function(){h.copyModel.draw({uniforms:{u_Texture:h.copyRenderTarget}})}),u.multiPassRenderer.getPostProcessor().render(u));var pe=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=pe,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,Ga.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(u,h,v){this.shaderModuleService.registerModule(u,{vs:BE,fs:h});var m=this.shaderModuleService.getModule(u),w=m.vs,A=m.fs,R=m.uniforms,B=this.rendererService,G=B.createAttribute,j=B.createBuffer,lt=B.createModel;return lt((0,K.Z)({vs:w,fs:A,attributes:{a_Position:G({buffer:j({data:[-4,-4,4,-4,0,4],type:se.FLOAT}),size:2})},uniforms:(0,K.Z)({},R),depth:{enable:!1},count:3},v))}}]),a}(ky),Qg=Fi(Dy.prototype,"shaderModuleService",[PE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dy))||OE),Jg=new Tt.W2;Jg.bind(Dt.IGlobalConfigService).to(pa).inSingletonScope(),(0,Tt.GW)((0,Tt.b2)(),Ee.EventEmitter),Jg.bind(Dt.IEventEmitter).to(Ee.EventEmitter);var zE=(0,rt.Z)(Jg,!1),Z_=function(l){var a=zE.lazyInject(l);return function(s,u,h){a.call(this,s,u),h&&(h.initializer=function(){return s[u]})}},UE=function(l){var a=zE.lazyMultiInject(l);return function(s,u,h){a.call(this,s,u),h&&(h.initializer=function(){return s[u]})}},cf=Jg,ZE=0;function GM(){var n=new Tt.W2;return n.parent=Jg,n.bind(Dt.SceneID).toConstantValue("".concat(ZE++)),n.bind(Dt.IShaderModuleService).to(KT).inSingletonScope(),n.bind(Dt.ILayerService).to(Zg).inSingletonScope(),n.bind(Dt.ISceneService).to(RT).inSingletonScope(),n.bind(Dt.ICameraService).to(Z).inSingletonScope(),n.bind(Dt.ICoordinateSystemService).to(K0).inSingletonScope(),n.bind(Dt.IInteractionService).to(Id).inSingletonScope(),n.bind(Dt.IPickingService).to(Pd).inSingletonScope(),n.bind(Dt.IControlService).to(nr).inSingletonScope(),n.bind(Dt.IMarkerService).to(gr).inSingletonScope(),n.bind(Dt.IIconService).to(xr).inSingletonScope(),n.bind(Dt.IFontService).to(Wl).inSingletonScope(),n.bind(Dt.IPopupService).to(un).inSingletonScope(),n.bind(Dt.INormalPass).to(tM).whenTargetNamed("clear"),n.bind(Dt.INormalPass).to(L_).whenTargetNamed("pixelPicking"),n.bind(Dt.INormalPass).to(zM).whenTargetNamed("render"),n.bind(Dt.INormalPass).to(VM).whenTargetNamed("taa"),n.bind(Dt.IFactoryNormalPass).toFactory(function(l){return function(a){return l.container.getNamed(Dt.INormalPass,a)}}),n.bind(Dt.IPostProcessingPass).to(Oy).whenTargetNamed("copy"),n.bind(Dt.IPostProcessingPass).to(fM).whenTargetNamed("bloom"),n.bind(Dt.IPostProcessingPass).to(pM).whenTargetNamed("blurH"),n.bind(Dt.IPostProcessingPass).to(_O).whenTargetNamed("blurV"),n.bind(Dt.IPostProcessingPass).to(OM).whenTargetNamed("noise"),n.bind(Dt.IPostProcessingPass).to(DM).whenTargetNamed("sepia"),n.bind(Dt.IPostProcessingPass).to(_M).whenTargetNamed("colorHalftone"),n.bind(Dt.IPostProcessingPass).to(TM).whenTargetNamed("hexagonalPixelate"),n.bind(Dt.IPostProcessingPass).to(kM).whenTargetNamed("ink"),n.bind(Dt.IFactoryPostProcessingPass).toFactory(function(l){return function(a){var s=l.container.getNamed(Dt.IPostProcessingPass,a);return s.setName(a),s}}),n}function tm(n){var l=new Tt.W2;return l.parent=n,l.bind(Dt.IStyleAttributeService).to(xy).inSingletonScope(),l.bind(Dt.IMultiPassRenderer).to(iM).inSingletonScope(),l.bind(Dt.IPostProcessor).to(BM).inSingletonScope(),l}var HM=null;function EO(n){return HM.indexOf(n)}var jM=2,wO=4,WM=64,SO=128,XM=256,YM=512,CO=8192,$M=16384,AO=32768,VE=null,GE=131072,TO=262144,HE=524288,MO=1048576,jE=2097152,IO=4194304,V_=8388608,qM=16777216,By=null;function Ny(n,l){return n=clamp(Math.floor(n),0,255),l=clamp(Math.floor(l),0,255),256*n+l}function kO(n){var l=n.color,a=n.radius,s=n.tileX,u=n.tileY,h=n.shape,v=n.opacity,m=n.stroke,w=n.strokeWidth,A=n.strokeOpacity,R=[],B=[],G=[],j=[Ny(l[0],l[1]),Ny(l[2],l[3])],lt=[Ny(m[0],m[1]),Ny(m[2],m[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ct){var _t=_slicedToArray(ct,2),Zt=_t[0],pe=_t[1];R.push([].concat(j,[(Zt+1)*V_+(pe+1)*jE+getShapeIndex(h)*GE+a,(s+512)*HE+(u+512)*WM])),B.push([].concat(lt,[w,A])),G.push([v,0,0,0])}),{packedBuffer:R,packedBuffer2:B,packedBuffer3:G}}function LO(n,l){if(n===0&&!l)return 0;if(n===1&&l)return 4294967295;var a=l?1:0,s=Math.floor(n*127);return s*By+a*qM+s*GE+a*VE+s*YM+a*XM+s*jM+a}var cp;(function(n){n.normal="normal",n.additive="additive",n.subtractive="subtractive",n.min="min",n.max="max",n.none="none"})(cp||(cp={}));var Os;(function(n){n.LINEAR="linear",n.SEQUENTIAL="sequential",n.POWER="power",n.LOG="log",n.IDENTITY="identity",n.TIME="time",n.QUANTILE="quantile",n.QUANTIZE="quantize",n.THRESHOLD="threshold",n.CAT="cat",n.DIVERGING="diverging"})(Os||(Os={}));var Gp;(function(n){n.CONSTANT="constant",n.VARIABLE="variable"})(Gp||(Gp={}));var ta;(function(n){n[n.Attribute=0]="Attribute",n[n.InstancedAttribute=1]="InstancedAttribute",n[n.Uniform=2]="Uniform"})(ta||(ta={}));var fp;(function(n){n.IMAGE="image",n.ARRAYBUFFER="arraybuffer",n.RGB="rgb",n.CUSTOMRGB="customRGB",n.CUSTOMARRAYBUFFER="customArrayBuffer"})(fp||(fp={}));var G_=["mapload","mapchange","mapAfterFrameChange"],w0={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},zy=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];function KM(n){var l=QM();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function QM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Uy=function(n){(0,zt.Z)(a,n);var l=KM(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this),(0,W.Z)((0,ut.Z)(u),"added",!1),(0,W.Z)((0,ut.Z)(u),"eventHandle",function(h){u.emit(h.type,{target:h,data:u.markerOption.extData,lngLat:u.lngLat})}),u.markerOption=(0,K.Z)((0,K.Z)({},u.getDefault()),s),$f(["update","onMove","onMapClick"],(0,ut.Z)(u)),u.init(),u}return(0,et.Z)(a,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:ui.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(u){this.scene=u,this.mapsService=u.get(Dt.IMapService),this.sceneSerive=u.get(Dt.ISceneService);var h=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(h),this.registerMarkerEvent(h),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var u=this.markerOption.element;return u&&Ue(u),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(u){return this.lngLat=u,Array.isArray(u)&&(this.lngLat={lng:u[0],lat:u[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(u){var h=this;if(!this.added)return this.once("added",function(){h.setElement(u)}),this;var v=this.markerOption.element;return v&&Ue(v),this.markerOption.element=u,this.init(),this.mapsService.getMarkerContainer().appendChild(u),this.registerMarkerEvent(u),this.update(),this}},{key:"openPopup",value:function(){var u=this;if(!this.added)return this.once("added",function(){u.openPopup()}),this;var h=this.popup;return h?(h.isOpen()||h.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var u=this;this.added||this.once("added",function(){u.closePopup()});var h=this.popup;return h&&h.remove(),this}},{key:"setPopup",value:function(u){return this.popup=u,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var u=this.popup;if(u)u.isOpen()?u.remove():u.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(u){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(u){this.markerOption.extData=u}},{key:"update",value:function(){if(this.mapsService){var u=this.markerOption,h=u.element,v=u.anchor;this.updatePosition(),xa(h,"".concat(oi[v]))}}},{key:"onMapClick",value:function(u){var h=this.markerOption.element;this.popup&&h&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var u=this.mapsService.getContainer();return{containerHeight:(u==null?void 0:u.scrollHeight)||0,containerWidth:(u==null?void 0:u.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(this.mapsService){var u=this.markerOption,h=u.element,v=u.offsets,m=this.lngLat,w=m.lng,A=m.lat,R=this.mapsService.lngLatToContainer([w,A]);if(h){h.style.display="block",h.style.whiteSpace="nowrap";var B=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),G=B.containerHeight,j=B.containerWidth,lt=B.bounds;if(!lt)return;if(Math.abs(lt[0][0])>180||Math.abs(lt[1][0])>180){if(R.x>j){var ct=this.mapsService.lngLatToContainer([w-360,A]);R.x=ct.x}if(R.x<0){var _t=this.mapsService.lngLatToContainer([w+360,A]);R.x=_t.x}}(R.x>j||R.x<0||R.y>G||R.y<0)&&(h.style.display="none"),h.style.left=R.x+v[0]+"px",h.style.top=R.y-v[1]+"px"}}}},{key:"init",value:function(){var u=this,h=this.markerOption.element,v=this.markerOption,m=v.color,w=v.anchor;if(!h){this.defaultMarker=!0,h=Jt("div"),this.markerOption.element=h;var A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height","48px"),A.setAttributeNS(null,"width","48px"),A.setAttributeNS(null,"viewBox","0 0 1024 1024");var R=document.createElementNS("http://www.w3.org/2000/svg","path");R.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),R.setAttributeNS(null,"fill",m),A.appendChild(R),h.appendChild(A)}yr(h,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(B){var G,j,lt=((G=u.markerOption)===null||G===void 0?void 0:G.style)&&((j=u.markerOption)===null||j===void 0?void 0:j.style[B]);h&&(h.style[B]=lt)}),h.addEventListener("click",function(B){u.onMapClick(B)}),h.addEventListener("click",this.eventHandle),Ri(h,w,"marker")}},{key:"registerMarkerEvent",value:function(u){u.addEventListener("mousemove",this.eventHandle),u.addEventListener("click",this.eventHandle),u.addEventListener("mousedown",this.eventHandle),u.addEventListener("mouseup",this.eventHandle),u.addEventListener("dblclick",this.eventHandle),u.addEventListener("contextmenu",this.eventHandle),u.addEventListener("mouseover",this.eventHandle),u.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var u=this.getElement();u.removeEventListener("mousemove",this.eventHandle),u.removeEventListener("click",this.eventHandle),u.removeEventListener("mousedown",this.eventHandle),u.removeEventListener("mouseup",this.eventHandle),u.removeEventListener("dblclick",this.eventHandle),u.removeEventListener("contextmenu",this.eventHandle),u.removeEventListener("mouseover",this.eventHandle),u.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(u){return null}},{key:"onUp",value:function(u){throw new Error("Method not implemented.")}}]),a}(Ee.EventEmitter),WE=nt(39720),H_=nt.n(WE);function JM(n){var l=t3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function t3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var XE=function(n){(0,zt.Z)(a,n);var l=JM(a);function a(s){var u,h;return(0,pt.Z)(this,a),h=l.call(this),(0,W.Z)((0,ut.Z)(h),"markers",[]),(0,W.Z)((0,ut.Z)(h),"points",[]),(0,W.Z)((0,ut.Z)(h),"clusterMarkers",[]),h.markerLayerOption=(0,ne.merge)(h.getDefault(),s),$f(["update"],(0,ut.Z)(h)),h.zoom=((u=h.markerLayerOption.clusterOption)===null||u===void 0?void 0:u.zoom)||-99,h}return(0,et.Z)(a,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(u){return this.scene=u,this.mapsService=u.get(Dt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(this.mapsService){var u=this.mapsService.getContainer();this.containerSize={containerWidth:(u==null?void 0:u.scrollWidth)||0,containerHeight:(u==null?void 0:u.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(u){var h=this.markerLayerOption.cluster;if(u.getMarkerLayerContainerSize=this.getContainerSize.bind(this),h&&(this.addPoint(u,this.markers.length),this.mapsService)){var v=this.mapsService.getZoom(),m=this.mapsService.getBounds();this.bbox=fu(m,.5),this.zoom=Math.floor(v),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(u)}},{key:"removeMarker",value:function(u){this.markers.indexOf(u);var h=this.markers.indexOf(u);h>-1&&this.markers.splice(h,1)}},{key:"hide",value:function(){this.markers.map(function(u){u.getElement().style.opacity="0"}),this.clusterMarkers.map(function(u){u.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(u){u.getElement().style.opacity="1"}),this.clusterMarkers.map(function(u){u.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var u=this.markerLayerOption.cluster;return u?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var u=this;this.getMarkers().forEach(function(h){h.addTo(u.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(u){u.remove()}),this.clusterMarkers.forEach(function(u){u.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(u,h){var v=u.getLnglat(),m=v.lng,w=v.lat,A={geometry:{type:"Point",coordinates:[m,w]},properties:(0,K.Z)((0,K.Z)({},u.getExtData()),{},{marker_id:h})};this.points.push(A),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var u=this.markerLayerOption.clusterOption,h=u.radius,v=u.minZoom,m=v===void 0?0:v,w=u.maxZoom;this.clusterIndex=new(H_())({radius:h,minZoom:m,maxZoom:w}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(u,h){var v=this,m=u[0].concat(u[1]),w=this.clusterIndex.getClusters(m,h);this.clusterMarkers.forEach(function(A){A.remove()}),this.clusterMarkers=[],w.forEach(function(A){var R,B=v.markerLayerOption.clusterOption,G=B.field,j=B.method;if((R=A.properties)!==null&&R!==void 0&&R.cluster_id){var lt,ct=v.getLeaves((lt=A.properties)===null||lt===void 0?void 0:lt.cluster_id);if(A.properties.clusterData=ct,G&&j){var _t=ct==null?void 0:ct.map(function(Qe){var wr=(0,W.Z)({},G,Qe.properties[G]);return wr}),Zt=Wa(_t,G),pe=Eu(j,Zt),fe="point_"+j;A.properties[fe]=pe.toFixed(2)}}var Ze=v.clusterMarker(A);v.clusterMarkers.push(Ze),Ze.addTo(v.scene)})}},{key:"getLeaves",value:function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return u?this.clusterIndex.getLeaves(u,h,v):null}},{key:"clusterMarker",value:function(u){var h=this.markerLayerOption.clusterOption,v=h,m=v.element,w=m===void 0?this.generateElement.bind(this):m,A=new Uy({element:w(u)}).setLnglat({lng:u.geometry.coordinates[0],lat:u.geometry.coordinates[1]});return A}},{key:"normalMarker",value:function(u){var h=u.properties.marker_id;return this.markers[h]}},{key:"update",value:function(){if(this.mapsService&&this.markers.length!==0){var u=this.mapsService.getZoom(),h=this.mapsService.getBounds();(!this.bbox||Math.abs(u-this.zoom)>=1||!Sl(this.bbox,h))&&(this.bbox=fu(h,.5),this.zoom=Math.floor(u),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(u){var h=Jt("div","l7-marker-cluster"),v=Jt("div","",h),m=Jt("span","",v),w=this.markerLayerOption.clusterOption,A=w.field,R=w.method;u.properties.point_count=u.properties.point_count||1;var B=A&&R?u.properties["point_"+R]||u.properties[A]:u.properties.point_count;return m.textContent=B,h}}]),a}(Ee.EventEmitter),PO=nt(21934);function e3(n){var l=zd();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function zd(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ud=function(n){(0,zt.Z)(a,n);var l=e3(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this),a.controlCount++,u.controlOption=(0,K.Z)((0,K.Z)({},u.getDefault(s)),s||{}),u}return(0,et.Z)(a,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(u){var h=this.getDefault(u);Object.entries(u).forEach(function(v){var m=(0,yt.Z)(v,2),w=m[0],A=m[1];A===void 0&&(u[w]=h[w])}),"position"in u&&this.setPosition(u.position),"className"in u&&this.setClassName(u.className),"style"in u&&this.setStyle(u.style),this.controlOption=(0,K.Z)((0,K.Z)({},this.controlOption),u)}},{key:"addTo",value:function(u){this.mapsService=u.get(Dt.IMapService),this.renderService=u.get(Dt.IRendererService),this.layerService=u.get(Dt.ILayerService),this.controlService=u.get(Dt.IControlService),this.configService=u.get(Dt.IGlobalConfigService),this.scene=u.get(Dt.ISceneService),this.sceneContainer=u,this.isShow=!0,this.container=this.onAdd(),yr(this.container,"l7-control");var h=this.controlOption,v=h.className,m=h.style;return v&&this.setClassName(v),m&&this.setStyle(m),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;Ue(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return Jt("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var u=this.container;Br(u,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var u=this.container;yr(u,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(u){return{position:q.TOPRIGHT,name:"".concat(a.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(u){if(this.mapsService&&u&&u.screenX>0&&u.screenY>0){var h=this.mapsService.getContainer();h!==null&&h.focus()}}},{key:"setPosition",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:q.TOPLEFT,h=this.controlService;return h&&h.removeControl(this),this.controlOption.position=u,h&&h.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(u){var h=this.container,v=this.controlOption.className;v&&Br(h,v),u&&yr(h,u)}},{key:"setStyle",value:function(u){var h=this.container;u?h.setAttribute("style",u):h.removeAttribute("style")}},{key:"insertContainer",value:function(){var u=this.controlOption.position,h=this.container;if(u instanceof Element)u.appendChild(h);else{var v=this.controlService.controlCorners[u];u.indexOf("bottom")!==-1?v.insertBefore(h,v.firstChild):v.appendChild(h)}}},{key:"checkUpdateOption",value:function(u,h){return h.some(function(v){return v in u})}}]),a}(ke());(0,W.Z)(Ud,"controlCount",0);function r3(n){var l=n3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function n3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Zy=function(n){(0,zt.Z)(a,n);var l=r3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"isDisable",!1),s}return(0,et.Z)(a,[{key:"setIsDisable",value:function(u){if(this.isDisable=u,u){var h;(h=this.button)===null||h===void 0||h.setAttribute("disabled","true")}else{var v;(v=this.button)===null||v===void 0||v.removeAttribute("disabled")}}},{key:"createButton",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return Jt("button","l7-button-control ".concat(u))}},{key:"onAdd",value:function(){this.button=this.createButton(),this.isDisable=!1;var u=this.controlOption,h=u.title,v=u.btnText,m=u.btnIcon;return this.setBtnTitle(h),this.setBtnText(v),this.setBtnIcon(m),this.button}},{key:"onRemove",value:function(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}},{key:"setOptions",value:function(u){var h=u.title,v=u.btnText,m=u.btnIcon;this.checkUpdateOption(u,["title"])&&this.setBtnTitle(h),this.checkUpdateOption(u,["btnIcon"])&&this.setBtnIcon(m),this.checkUpdateOption(u,["btnText"])&&this.setBtnText(v),ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u)}},{key:"setBtnTitle",value:function(u){var h;(h=this.button)===null||h===void 0||h.setAttribute("title",u!=null?u:"")}},{key:"setBtnIcon",value:function(u){if(this.buttonIcon&&Ue(this.buttonIcon),u){var h,v=(h=this.button)===null||h===void 0?void 0:h.firstChild;if(v){var m;(m=this.button)===null||m===void 0||m.insertBefore(u,v)}else{var w;(w=this.button)===null||w===void 0||w.appendChild(u)}this.buttonIcon=u}}},{key:"setBtnText",value:function(u){if(this.button)if(Br(this.button,"l7-button-control--row"),Br(this.button,"l7-button-control--column"),u){var h=this.buttonText;if(!h){var v;h=Jt("div","l7-button-control__text"),(v=this.button)===null||v===void 0||v.appendChild(h),this.buttonText=h}h.innerText=u,yr(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!u&&this.buttonText&&(Ue(this.buttonText),this.buttonText=void 0)}}]),a}(Ud);function i3(n){var l=a3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function a3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var YE=function(n){(0,zt.Z)(a,n);var l=i3(a);function a(s,u){var h;return(0,pt.Z)(this,a),h=l.call(this),(0,W.Z)((0,ut.Z)(h),"isShow",!1),(0,W.Z)((0,ut.Z)(h),"timeout",null),(0,W.Z)((0,ut.Z)(h),"show",function(){return h.isShow||!h.contentDOM.innerHTML||(h.resetPopperPosition(),Br(h.popperDOM,"l7-popper-hide"),h.isShow=!0,h.option.unique&&a.conflictPopperList.forEach(function(v){v!==(0,ut.Z)(h)&&v.isShow&&v.hide()}),h.emit("show")),(0,ut.Z)(h)}),(0,W.Z)((0,ut.Z)(h),"hide",function(){return h.isShow&&(yr(h.popperDOM,"l7-popper-hide"),h.isShow=!1,h.emit("hide")),(0,ut.Z)(h)}),(0,W.Z)((0,ut.Z)(h),"setHideTimeout",function(){h.timeout||(h.timeout=window.setTimeout(function(){h.isShow&&(h.hide(),h.timeout=null)},300))}),(0,W.Z)((0,ut.Z)(h),"clearHideTimeout",function(){h.timeout&&(window.clearTimeout(h.timeout),h.timeout=null)}),(0,W.Z)((0,ut.Z)(h),"onBtnClick",function(){h.isShow?h.hide():h.show()}),(0,W.Z)((0,ut.Z)(h),"onBtnMouseLeave",function(){h.setHideTimeout()}),(0,W.Z)((0,ut.Z)(h),"onBtnMouseMove",function(){h.clearHideTimeout(),!h.isShow&&h.show()}),h.button=s,h.option=u,h.init(),u.unique&&a.conflictPopperList.push((0,ut.Z)(h)),h}return(0,et.Z)(a,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(u){typeof u=="string"?this.contentDOM.innerHTML=u:u instanceof HTMLElement&&(Uu(this.contentDOM),this.contentDOM.appendChild(u)),this.content=u}},{key:"init",value:function(){var u=this.option.trigger;this.popperDOM=this.createPopper(),u==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),Ue(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var u={},h=this.option,v=h.container,m=h.offset,w=m===void 0?[0,0]:m,A=h.placement,R=(0,yt.Z)(w,2),B=R[0],G=R[1],j=this.button.getBoundingClientRect(),lt=v.getBoundingClientRect(),ct=Fl(j,lt),_t=ct.left,Zt=ct.right,pe=ct.top,fe=ct.bottom,Ze=!1,Qe=!1;/^(left|right)/.test(A)?(A.includes("left")?u.right="".concat(j.width+Zt,"px"):A.includes("right")&&(u.left="".concat(j.width+_t,"px")),A.includes("start")?u.top="".concat(pe,"px"):A.includes("end")?u.bottom="".concat(fe,"px"):(u.top="".concat(pe+j.height/2,"px"),Qe=!0,u.transform="translate(".concat(B,"px, calc(").concat(G,"px - 50%))"))):/^(top|bottom)/.test(A)&&(A.includes("top")?u.bottom="".concat(j.height+fe,"px"):A.includes("bottom")&&(u.top="".concat(j.height+pe,"px")),A.includes("start")?u.left="".concat(_t,"px"):A.includes("end")?u.right="".concat(Zt,"px"):(u.left="".concat(_t+j.width/2,"px"),Ze=!0,u.transform="translate(calc(".concat(B,"px - 50%), ").concat(G,"px)"))),u.transform="translate(calc(".concat(B,"px - ").concat(Ze?"50%":"0%","), calc(").concat(G,"px - ").concat(Qe?"50%":"0%",")");var wr=A.split("-");wr.length&&yr(this.popperDOM,wr.map(function(Lr){return"l7-popper-".concat(Lr)}).join(" ")),bu(this.popperDOM,Yc(u))}},{key:"createPopper",value:function(){var u=this.option,h=u.container,v=u.className,m=v===void 0?"":v,w=u.content,A=Jt("div","l7-popper l7-popper-hide ".concat(m)),R=Jt("div","l7-popper-content"),B=Jt("div","l7-popper-arrow");return A.appendChild(R),A.appendChild(B),h.appendChild(A),this.popperDOM=A,this.contentDOM=R,w&&this.setContent(w),A}}]),a}(Ee.EventEmitter);(0,W.Z)(YE,"conflictPopperList",[]);function o3(n){var l=s3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function s3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var u3={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},l3=function(n){(0,zt.Z)(a,n);var l=o3(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getPopper",value:function(){return this.popper}},{key:"hide",value:function(){this.popper.hide(),ts((0,b.Z)(a.prototype),"hide",this).call(this)}},{key:"getDefault",value:function(u){var h,v=ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u),m=(h=u==null?void 0:u.position)!==null&&h!==void 0?h:v.position;return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{popperPlacement:m instanceof Element?"bottom":u3[m],popperTrigger:"click"})}},{key:"onAdd",value:function(){var u=ts((0,b.Z)(a.prototype),"onAdd",this).call(this);return this.initPopper(),u}},{key:"onRemove",value:function(){this.popper.destroy()}},{key:"initPopper",value:function(){var u=this,h=this.controlOption,v=h.popperClassName,m=h.popperPlacement,w=h.popperTrigger,A=this.mapsService.getMapContainer();return this.popper=new YE(this.button,{className:v,placement:m,trigger:w,container:A,unique:!0}),this.popper.on("show",function(){u.emit("popperShow",u)}).on("hide",function(){u.emit("popperHide",u)}),this.popper}},{key:"setOptions",value:function(u){if(ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u),this.checkUpdateOption(u,["popperPlacement","popperTrigger","popperClassName"])){var h=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(h)}}}]),a}(Zy);function c3(n){var l=f3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function f3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Hp;(function(n){n.ActiveOptionClassName="l7-select-control-item-active",n.OptionValueAttrKey="data-option-value",n.OptionIndexAttrKey="data-option-index"})(Hp||(Hp={}));var $E=function(n){(0,zt.Z)(a,n);var l=c3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"selectValue",[]),(0,W.Z)((0,ut.Z)(s),"createNormalOption",function(m){var w=s.selectValue.includes(m.value),A=Jt("div","l7-select-control-item ".concat(w?Hp.ActiveOptionClassName:""));s.getIsMultiple()&&A.appendChild(s.createCheckbox(w)),m.icon&&A.appendChild(m.icon);var R=Jt("span");return R.innerText=m.text,A.appendChild(R),A}),(0,W.Z)((0,ut.Z)(s),"onItemClick",function(m){if(s.getIsMultiple()){var w=s.selectValue.findIndex(function(A){return A===m.value});w>-1?s.selectValue.splice(w,1):s.selectValue=[].concat((0,ve.Z)(s.selectValue),[m.value])}else s.selectValue=[m.value];s.setSelectValue(s.selectValue)}),s}return(0,et.Z)(a,[{key:"setOptions",value:function(u){ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u);var h=u.options;h&&this.popper.setContent(this.getPopperContent(h))}},{key:"onAdd",value:function(){var u=ts((0,b.Z)(a.prototype),"onAdd",this).call(this),h=this.controlOption.defaultValue;return h&&(this.selectValue=this.transSelectValue(h)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),u}},{key:"getSelectValue",value:function(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}},{key:"setSelectValue",value:function(u){var h=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=this.transSelectValue(u);this.optionDOMList.forEach(function(w){var A=w.getAttribute(Hp.OptionValueAttrKey),R=h.getIsMultiple()?w.querySelector("input[type=checkbox]"):void 0;m.includes(A)?(yr(w,Hp.ActiveOptionClassName),R&&kc(R,!0)):(Br(w,Hp.ActiveOptionClassName),R&&kc(R,!1))}),this.selectValue=m,v&&this.emit("selectChange",this.getIsMultiple()?m:m[0])}},{key:"getIsMultiple",value:function(){return!1}},{key:"getPopperContent",value:function(u){var h=this,v=this.isImageOptions(),m=Jt("div",v?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&yr(m,"l7-select-control--multiple");var w=u.map(function(A,R){var B=v?h.createImageOption(A):h.createNormalOption(A);return B.setAttribute(Hp.OptionValueAttrKey,A.value),B.setAttribute(Hp.OptionIndexAttrKey,window.String(R)),B.addEventListener("click",h.onItemClick.bind(h,A)),B});return m.append.apply(m,(0,ve.Z)(w)),this.optionDOMList=w,m}},{key:"createImageOption",value:function(u){var h=this.selectValue.includes(u.value),v=Jt("div","l7-select-control-item ".concat(h?Hp.ActiveOptionClassName:"")),m=Jt("img");m.setAttribute("src",u.img),js(m),v.appendChild(m);var w=Jt("div","l7-select-control-item-row");this.getIsMultiple()&&v.appendChild(this.createCheckbox(h));var A=Jt("span");return A.innerText=u.text,w.appendChild(A),v.appendChild(w),v}},{key:"createCheckbox",value:function(u){var h=Jt("input");return h.setAttribute("type","checkbox"),u&&kc(h,!0),h}},{key:"isImageOptions",value:function(){return!!this.controlOption.options.find(function(u){return u.img})}},{key:"transSelectValue",value:function(u){return Array.isArray(u)?u:[u]}}]),a}(l3);function Vy(n){var l=Gy();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Gy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var h3=function(n){(0,zt.Z)(a,n);var l=Vy(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getDefault",value:function(){return{position:q.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var u=Jt("div","l7-control-logo");return this.setLogoContent(u),u}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(u){ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u),this.checkUpdateOption(u,["img","href"])&&(Uu(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(u){var h=this.controlOption,v=h.href,m=h.img,w=Jt("img");if(w.setAttribute("src",m),w.setAttribute("aria-label","AntV logo"),js(w),v){var A=Jt("a","l7-control-logo-link");A.target="_blank",A.href=v,A.rel="noopener nofollow",A.setAttribute("rel","noopener nofollow"),A.appendChild(w),u.appendChild(A)}else u.appendChild(w)}}]),a}(Ud),Zd=function(l){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.classList.add("l7-iconfont"),a.setAttribute("aria-hidden","true");var s=document.createElementNS("http://www.w3.org/2000/svg","use");return s.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(l)),a.appendChild(s),a};function j_(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Hy(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Hy(n,l){if(n){if(typeof n=="string")return jy(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return jy(n,l)}}function jy(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var W_=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],zc=function(){if(typeof document=="undefined")return!1;var n=W_[0],l={},a=j_(W_),s;try{for(a.s();!(s=a.n()).done;){var u=s.value,h=u==null?void 0:u[1];if(h in document){var v=j_(u.entries()),m;try{for(v.s();!(m=v.n()).done;){var w=(0,yt.Z)(m.value,2),A=w[0],R=w[1];l[n[A]]=R}}catch(B){v.e(B)}finally{v.f()}return l}}}catch(B){a.e(B)}finally{a.f()}return!1}(),X_={change:zc.fullscreenchange,error:zc.fullscreenerror},lh={request:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,a=arguments.length>1?arguments[1]:void 0;return new Promise(function(s,u){var h=function m(){lh.off("change",m),s()};lh.on("change",h);var v=l[zc.requestFullscreen](a);v instanceof Promise&&v.then(h).catch(u)})},exit:function(){return new Promise(function(l,a){if(!lh.isFullscreen){l();return}var s=function h(){lh.off("change",h),l()};lh.on("change",s);var u=document[zc.exitFullscreen]();u instanceof Promise&&u.then(s).catch(a)})},toggle:function(l,a){return lh.isFullscreen?lh.exit():lh.request(l,a)},onchange:function(l){lh.on("change",l)},onerror:function(l){lh.on("error",l)},on:function(l,a){var s=X_[l];s&&document.addEventListener(s,a,!1)},off:function(l,a){var s=X_[l];s&&document.removeEventListener(s,a,!1)},raw:zc};Object.defineProperties(lh,{isFullscreen:{get:function(){return Boolean(document[zc.fullscreenElement])}},element:{enumerable:!0,get:function(){var l;return(l=document[zc.fullscreenElement])!==null&&l!==void 0?l:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[zc.fullscreenEnabled])}}}),zc||(lh={isEnabled:!1});var Y_=lh;function kv(n){var l=p3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function p3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var v3=function(n){(0,zt.Z)(a,n);var l=kv(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this,s),(0,W.Z)((0,ut.Z)(u),"isFullscreen",!1),(0,W.Z)((0,ut.Z)(u),"toggleFullscreen",(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!Y_.isEnabled){m.next=3;break}return m.next=3,Y_.toggle(u.mapContainer);case 3:case"end":return m.stop()}},h)}))),(0,W.Z)((0,ut.Z)(u),"onClick",function(){u.toggleFullscreen()}),(0,W.Z)((0,ut.Z)(u),"onFullscreenChange",function(){u.isFullscreen=!!document.fullscreenElement;var h=u.controlOption,v=h.btnText,m=h.btnIcon,w=h.title,A=h.exitBtnText,R=h.exitBtnIcon,B=h.exitTitle;u.isFullscreen?(u.setBtnTitle(B),u.setBtnText(A),u.setBtnIcon(R)):(u.setBtnTitle(w),u.setBtnText(v),u.setBtnIcon(m)),u.emit("fullscreenChange",u.isFullscreen)}),Y_.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316"),u}return(0,et.Z)(a,[{key:"setOptions",value:function(u){var h=u.exitBtnText,v=u.exitBtnIcon,m=u.exitTitle;this.isFullscreen&&(this.checkUpdateOption(u,["exitBtnIcon"])&&this.setBtnIcon(v),this.checkUpdateOption(u,["exitBtnText"])&&this.setBtnText(h),this.checkUpdateOption(u,["exitTitle"])&&this.setBtnTitle(m)),ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u)}},{key:"onAdd",value:function(){var u=ts((0,b.Z)(a.prototype),"onAdd",this).call(this);return u.addEventListener("click",this.onClick),this.mapContainer=D(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),u}},{key:"onRemove",value:function(){ts((0,b.Z)(a.prototype),"onRemove",this).call(this),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{title:"\u5168\u5C4F",btnIcon:Zd("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:Zd("l7-icon-exit-fullscreen")})}}]),a}(Zy);function qE(n){var l=g3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function g3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var OO=function(n){(0,zt.Z)(a,n);var l=qE(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"onClick",(0,J.Z)(ot().mark(function m(){var w;return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(w=s.controlOption.onExport,w!=null){R.next=5;break}R.next=10;break;case 5:return R.t0=w,R.next=8,s.getImage();case 8:R.t1=R.sent,(0,R.t0)(R.t1);case 10:case"end":return R.stop()}},m)}))),(0,W.Z)((0,ut.Z)(s),"mergeImage",(0,J.Z)(ot().mark(function m(){var w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze,Qe,wr=arguments;return ot().wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:for(R=s.controlOption.imageType,B=(w=(A=s.mapsService.getContainer())===null||A===void 0?void 0:A.getBoundingClientRect())!==null&&w!==void 0?w:{},G=B.width,j=G===void 0?0:G,lt=B.height,ct=lt===void 0?0:lt,_t=document.createElement("canvas"),_t.width=j,_t.height=ct,Zt=_t.getContext("2d"),pe=wr.length,fe=new Array(pe),Ze=0;Ze<pe;Ze++)fe[Ze]=wr[Ze];return Vr.next=9,Promise.all(fe.map(function(Wr){return new Promise(function(bn){var hn=new Image;hn.onload=function(){bn(hn)},hn.src=Wr})}));case 9:return Qe=Vr.sent,Qe.forEach(function(Wr){Zt==null||Zt.drawImage(Wr,0,0,j,ct)}),Vr.abrupt("return",_t.toDataURL("image/".concat(R)));case 12:case"end":return Vr.stop()}},m)}))),s}return(0,et.Z)(a,[{key:"onAdd",value:function(){var u=ts((0,b.Z)(a.prototype),"onAdd",this).call(this);return u.addEventListener("click",this.onClick),u}},{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:Zd("l7-icon-export-picture"),imageType:"png"})}},{key:"getImage",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.mapsService.exportMap("png");case 2:return v=A.sent,A.next=5,this.scene.exportPng("png");case 5:return m=A.sent,A.abrupt("return",this.mergeImage(v,m));case 7:case"end":return A.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()}]),a}(Zy);function FO(n){var l=KE();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function KE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $_=function(n){(0,zt.Z)(a,n);var l=FO(a);function a(s){var u;return(0,pt.Z)(this,a),u=l.call(this,s),(0,W.Z)((0,ut.Z)(u),"getGeoLocation",function(){return new Promise(function(h,v){window.navigator.geolocation.getCurrentPosition(function(m){var w=m.coords,A=w!=null?w:{},R=A.longitude,B=A.latitude;!(0,ne.isNaN)(R)&&!(0,ne.isNaN)(B)?h([R,B]):v()},function(m){v(m)})})}),(0,W.Z)((0,ut.Z)(u),"onClick",(0,J.Z)(ot().mark(function h(){var v,m,w;return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(window.navigator.geolocation){R.next=2;break}return R.abrupt("return");case 2:return v=u.controlOption.transform,R.next=5,u.getGeoLocation();case 5:if(m=R.sent,w=u.mapsService.getZoom(),R.t0=u.mapsService,R.t1=w>15?w:15,!v){R.next=15;break}return R.next=12,v(m);case 12:R.t2=R.sent,R.next=16;break;case 15:R.t2=m;case 16:R.t3=R.t2,R.t0.setZoomAndCenter.call(R.t0,R.t1,R.t3);case 18:case"end":return R.stop()}},h)}))),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D"),u}return(0,et.Z)(a,[{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{title:"\u5B9A\u4F4D",btnIcon:Zd("l7-icon-reposition")})}},{key:"onAdd",value:function(){var u=ts((0,b.Z)(a.prototype),"onAdd",this).call(this);return u.addEventListener("click",this.onClick),u}}]),a}(Zy),m3={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*qdFDSbvIalgAAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u6708\u5149\u94F6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d-vcRLzu8WIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*HMbRTI3XnpIAAAAAAAAAAAAADmJ7AQ/original"},fresh:{text:"\u8349\u8272\u9752",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kqaGQ5kjSiAAAAAAAAAAAAAADmJ7AQ/original"},grey:{text:"\u96C5\u58EB\u7070",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*XegrTpZIbqAAAAAAAAAAAAAADmJ7AQ/original"},graffiti:{text:"\u6D82\u9E26",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*G5g9SZ_Jg4cAAAAAAAAAAAAADmJ7AQ/original"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*irVvQbDpQMwAAAAAAAAAAAAADmJ7AQ/original"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*lKRzQYB4iR0AAAAAAAAAAAAADmJ7AQ/original"},wine:{text:"\u9171\u7C7D",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*orY0T7QL-lwAAAAAAAAAAAAADmJ7AQ/original"}},y3={normal:{text:"\u6807\u51C6",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*kIyZTok4Uk0AAAAAAAAAAAAADmJ7AQ/original"},light:{text:"\u4EAE",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*Z3JRQKDI-cIAAAAAAAAAAAAADmJ7AQ/original"},dark:{text:"\u6697",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*d7HCQbfmyaoAAAAAAAAAAAAADmJ7AQ/original"},satellite:{text:"\u536B\u661F",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*TytUT6pS9okAAAAAAAAAAAAADmJ7AQ/original"},outdoors:{text:"\u6237\u5916",img:"https://mdn.alipayobjects.com/huamei_qa8qxu/afts/img/A*hWwFSYJEFWsAAAAAAAAAAAAADmJ7AQ/original"}};function _3(n){var l=x3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function x3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var q_=function(n){(0,zt.Z)(a,n);var l=_3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"onMapThemeChange",function(){s.mapsService.setMapStyle(s.selectValue[0])}),s}return(0,et.Z)(a,[{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:Zd("l7-icon-color"),options:[]})}},{key:"getStyleOptions",value:function(){var u=this.mapsService.getType()==="mapbox"?y3:m3;return Object.entries(this.mapsService.getMapStyleConfig()).filter(function(h){var v=(0,yt.Z)(h,2),m=v[0],w=v[1];return typeof w=="string"&&m!=="blank"}).map(function(h){var v,m=(0,yt.Z)(h,2),w=m[0],A=m[1],R=(v=u[w])!==null&&v!==void 0?v:{},B=R.text,G=R.img;return{text:B!=null?B:w,value:A,img:G,key:w}})}},{key:"getMapStyle",value:function(){return this.mapsService.getMapStyle()}},{key:"onAdd",value:function(){var u,h=this;if((u=this.controlOption.options)!==null&&u!==void 0&&u.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var v,m,w=this.controlOption.defaultValue;this.controlOption.defaultValue=(v=(m=this.controlOption.options.find(function(R){return R.key===w}))===null||m===void 0?void 0:m.value)!==null&&v!==void 0?v:w}else{var A=this.getMapStyle();A?this.controlOption.defaultValue=A:this.mapsService.map.once("styledata",function(){var R=h.mapsService.getMapStyle();h.controlOption.defaultValue=R,h.setSelectValue(R,!1)})}return this.on("selectChange",this.onMapThemeChange),ts((0,b.Z)(a.prototype),"onAdd",this).call(this)}},{key:"getIsMultiple",value:function(){return!1}}]),a}($E);function QE(n){var l=b3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function b3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var RO=function(n){(0,zt.Z)(a,n);var l=QE(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"onLayerChange",function(){var m;(m=s.controlOption.layers)!==null&&m!==void 0&&m.length||(s.selectValue=s.getLayerVisible(),s.setOptions({options:s.getLayerOptions()}))}),(0,W.Z)((0,ut.Z)(s),"onLayerVisibleChane",function(){s.setSelectValue(s.getLayerVisible())}),(0,W.Z)((0,ut.Z)(s),"onSelectChange",function(){s.layers.forEach(function(m){var w=s.selectValue.includes(m.name),A=m.isVisible();w&&!A&&m.show(),!w&&A&&m.hide()})}),s}return(0,et.Z)(a,[{key:"layers",get:function(){var u=this.layerService,h=this.controlOption.layers;if(Array.isArray(h)&&h.length){var v=[];return h.forEach(function(m){if(m instanceof Object&&v.push(m),typeof m=="string"){var w=u.getLayer(m)||u.getLayerByName(m);w&&v.push(w)}}),v}return u.getLayers()||[]}},{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:Zd("l7-icon-layer"),options:[]})}},{key:"getLayerVisible",value:function(){return this.layers.filter(function(u){return u.isVisible()}).map(function(u){return u.name})}},{key:"getLayerOptions",value:function(){return this.layers.map(function(u){return{text:u.name,value:u.name}})}},{key:"setOptions",value:function(u){var h=this.checkUpdateOption(u,["layers"]);ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u),h&&(this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}},{key:"onAdd",value:function(){var u;return(u=this.controlOption.options)!==null&&u!==void 0&&u.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),ts((0,b.Z)(a.prototype),"onAdd",this).call(this)}},{key:"onRemove",value:function(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}},{key:"getIsMultiple",value:function(){return!0}}]),a}($E);function E3(n){var l=w3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function w3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var DO=function(n){(0,zt.Z)(a,n);var l=E3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"location",[0,0]),(0,W.Z)((0,ut.Z)(s),"onMouseMove",function(m){var w=s.location,A=m.lngLat||m.lnglat,R=s.controlOption.transform;A&&(w=[A.lng,A.lat]),s.location=w,R&&(w=R(w)),s.insertLocation2HTML(w),s.emit("locationChange",w)}),s}return(0,et.Z)(a,[{key:"getLocation",value:function(){return this.location}},{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{position:q.BOTTOMLEFT,transform:function(v){var m=(0,yt.Z)(v,2),w=m[0],A=m[1];return[+(+w).toFixed(6),+(+A).toFixed(6)]}})}},{key:"onAdd",value:function(){var u=Jt("div","l7-control-mouse-location");return u.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),u}},{key:"onRemove",value:function(){this.mapsService.off("mousemove",this.onMouseMove)}},{key:"insertLocation2HTML",value:function(u){this.container.innerText=u.join(", ")}}]),a}(Ud);function S3(n){var l=C3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function C3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var A3=function(n){(0,zt.Z)(a,n);var l=S3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"zoomIn",function(){!s.disabled&&s.mapsService.getZoom()<s.mapsService.getMaxZoom()&&s.mapsService.zoomIn()}),(0,W.Z)((0,ut.Z)(s),"zoomOut",function(){!s.disabled&&s.mapsService.getZoom()>s.mapsService.getMinZoom()&&s.mapsService.zoomOut()}),(0,W.Z)((0,ut.Z)(s),"updateDisabled",function(){var m=s.mapsService;s.zoomInButton.removeAttribute("disabled"),s.zoomOutButton.removeAttribute("disabled"),(s.disabled||m.getZoom()<=m.getMinZoom())&&s.zoomOutButton.setAttribute("disabled","true"),(s.disabled||m.getZoom()>=m.getMaxZoom())&&s.zoomInButton.setAttribute("disabled","true")}),s}return(0,et.Z)(a,[{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{position:q.BOTTOMRIGHT,name:"zoom",zoomInText:Zd("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:Zd("l7-icon-narrow"),zoomOutTitle:"Zoom out"})}},{key:"setOptions",value:function(u){ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u),this.checkUpdateOption(u,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle"])&&this.resetButtonGroup(this.container)}},{key:"onAdd",value:function(){var u=Jt("div","l7-control-zoom");return this.resetButtonGroup(u),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),u}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"resetButtonGroup",value:function(u){Uu(u),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",u,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",u,this.zoomOut),this.updateDisabled()}},{key:"createButton",value:function(u,h,v,m,w){var A=Jt("button",v,m);return typeof u=="string"?A.innerHTML=u:A.append(u),A.title=h,A.addEventListener("click",w),A}}]),a}(Ud);function T3(n){var l=JE();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function JE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var M3=function(n){(0,zt.Z)(a,n);var l=T3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"update",function(){var m=s.mapsService,w=s.controlOption.maxWidth,A=m.getSize()[1]/2,R=m.containerToLngLat([0,A]),B=m.containerToLngLat([w,A]),G=nf([R.lng,R.lat],[B.lng,B.lat]);s.updateScales(G)}),s}return(0,et.Z)(a,[{key:"getDefault",value:function(u){return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{name:"scale",position:q.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}},{key:"onAdd",value:function(){var u="l7-control-scale",h=Jt("div",u);this.resetScaleLines(h);var v=this.controlOption.updateWhenIdle;return this.mapsService.on(v?"moveend":"mapmove",this.update),this.mapsService.on(v?"zoomend":"zoomchange",this.update),h}},{key:"onRemove",value:function(){var u=this.controlOption.updateWhenIdle;this.mapsService.off(u?"zoomend":"zoomchange",this.update),this.mapsService.off(u?"moveend":"mapmove",this.update)}},{key:"setOptions",value:function(u){ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u),this.checkUpdateOption(u,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}},{key:"updateScales",value:function(u){var h=this.controlOption,v=h.metric,m=h.imperial;v&&u&&this.updateMetric(u),m&&u&&this.updateImperial(u)}},{key:"resetScaleLines",value:function(u){Uu(u);var h=this.controlOption,v=h.metric,m=h.imperial,w=h.maxWidth,A=h.lockWidth;A&&bu(u,"width: ".concat(w,"px")),v&&(this.mScale=Jt("div","l7-control-scale-line",u)),m&&(this.iScale=Jt("div","l7-control-scale-line",u)),this.update()}},{key:"updateScale",value:function(u,h,v){var m=this.controlOption.maxWidth;u.style.width=Math.round(m*v)+"px",u.innerHTML=h}},{key:"getRoundNum",value:function(u){var h=Math.pow(10,(Math.floor(u)+"").length-1),v=u/h;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,h*v}},{key:"updateMetric",value:function(u){var h=this.getRoundNum(u),v=h<1e3?h+" m":h/1e3+" km";this.updateScale(this.mScale,v,h/u)}},{key:"updateImperial",value:function(u){var h=u*3.2808399,v,m,w;h>5280?(v=h/5280,m=this.getRoundNum(v),this.updateScale(this.iScale,m+" mi",m/v)):(w=this.getRoundNum(h),this.updateScale(this.iScale,w+" ft",w/h))}}]),a}(Ud);function I3(n){var l=k3();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function k3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var L3=function(n){(0,zt.Z)(a,n);var l=I3(a);function a(s){var u;(0,pt.Z)(this,a),u=l.call(this),(0,W.Z)((0,ut.Z)(u),"isShow",!0),(0,W.Z)((0,ut.Z)(u),"onMouseMove",function(v){var m,w=u.mapsService.getMapContainer(),A=(m=w==null?void 0:w.getBoundingClientRect())!==null&&m!==void 0?m:{},R=A.left,B=R===void 0?0:R,G=A.top,j=G===void 0?0:G;u.setPopupPosition(v.clientX-B,v.clientY-j)}),(0,W.Z)((0,ut.Z)(u),"updateLngLatPosition",function(){if(!(!u.mapsService||u.popupOption.followCursor)){var v=u.lngLat,m=v.lng,w=v.lat,A=u.mapsService.lngLatToContainer([m,w]),R=A.x,B=A.y;u.setPopupPosition(R,B)}}),(0,W.Z)((0,ut.Z)(u),"onKeyDown",function(v){v.keyCode===27&&u.remove()}),(0,W.Z)((0,ut.Z)(u),"onCloseButtonClick",function(v){v.stopPropagation&&v.stopPropagation(),u.hide()}),(0,W.Z)((0,ut.Z)(u),"update",function(){var v=!!u.lngLat,m=u.popupOption,w=m.className,A=m.style,R=m.maxWidth,B=m.anchor,G=m.stopPropagation;if(!(!u.mapsService||!v||!u.content)){var j=u.mapsService.getMarkerContainer();if(!u.container&&j&&(u.container=Jt("div","l7-popup ".concat(w!=null?w:""," ").concat(u.isShow?"":"l7-popup-hide"),j),A&&u.container.setAttribute("style",A),u.tip=Jt("div","l7-popup-tip",u.container),u.container.appendChild(u.content),G&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(_t){u.container.addEventListener(_t,function(Zt){Zt.stopPropagation()})}),u.container.style.whiteSpace="nowrap"),u.updateLngLatPosition(),xa(u.container,"".concat(oi[B])),Ri(u.container,B,"popup"),R){var lt=u.container.getBoundingClientRect(),ct=lt.width;ct>parseFloat(R)&&(u.container.style.width=R)}else u.container.style.removeProperty("width")}}),u.popupOption=(0,K.Z)((0,K.Z)({},u.getDefault(s!=null?s:{})),s);var h=u.popupOption.lngLat;return h&&(u.lngLat=h),u}return(0,et.Z)(a,[{key:"lngLat",get:function(){var u;return(u=this.popupOption.lngLat)!==null&&u!==void 0?u:{lng:0,lat:0}},set:function(u){this.popupOption.lngLat=u}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(u){this.mapsService=u.get(Dt.IMapService),this.sceneService=u.get(Dt.ISceneService),this.layerService=u.get(Dt.ILayerService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=u,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var h=this.popupOption,v=h.html,m=h.text,w=h.title;return v?this.setHTML(v):m&&this.setText(m),w&&this.setTitle(w),this.emit("open"),this}},{key:"remove",value:function(){if(this!==null&&this!==void 0&&this.isOpen())return this.content&&Ue(this.content),this.container&&(Ue(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(u){return this.show(),this.popupOption=(0,K.Z)((0,K.Z)({},this.popupOption),u),this.checkUpdateOption(u,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(Ue(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(u,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(u,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(u,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(u,["html"])&&u.html?this.setHTML(u.html):this.checkUpdateOption(u,["text"])&&u.text&&this.setText(u.text),this.checkUpdateOption(u,["lngLat"])&&u.lngLat&&this.setLnglat(u.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&Br(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(this.isShow)return this.container&&yr(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(u){return this.popupOption.html=u,this.setDOMContent(u)}},{key:"setText",value:function(u){return this.popupOption.text=u,this.setDOMContent(window.document.createTextNode(u))}},{key:"setTitle",value:function(u){this.show(),this.popupOption.title=u,u?(this.contentTitle||(this.contentTitle=Jt("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),Uu(this.contentTitle),ce(this.contentTitle,u)):this.contentTitle&&(Ue(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var u=this.lngLat,h=u.lng,v=u.lat;return this.popupOption.autoPan&&this.mapsService.panTo([h,v]),this}},{key:"setLngLat",value:function(u){return this.setLnglat(u)}},{key:"setLnglat",value:function(u){var h=this;return this.show(),this.lngLat=u,Array.isArray(u)&&(this.lngLat={lng:u[0],lat:u[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){h.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(u){return this.popupOption.maxWidth=u,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(u){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:ui.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(u){return this.show(),this.createContent(),ce(this.contentPanel,u),this.update(),this}},{key:"updateCloseOnClick",value:function(u){var h=this,v=this.mapsService;v&&(v==null||v.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!u&&requestAnimationFrame(function(){v==null||v.on("click",h.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(u){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!u&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(u){var h,v=(h=this.mapsService)===null||h===void 0?void 0:h.getContainer();v&&(v==null||v.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!u&&(v==null||v.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var u=this;if(this.content&&Ue(this.content),this.contentTitle=void 0,this.content=Jt("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var h=Zd("l7-icon-guanbi");yr(h,"l7-popup-close-button"),this.content.appendChild(h),this.popupOption.closeButtonOffsets&&(h.style.right=this.popupOption.closeButtonOffsets[0]+"px",h.style.top=this.popupOption.closeButtonOffsets[1]+"px"),h.setAttribute("aria-label","Close popup"),h.addEventListener("click",function(){u.hide()}),this.closeButton=h}else this.closeButton=void 0;this.contentPanel=Jt("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(u,h){if(this.container){var v=this.popupOption.offsets;this.container.style.left=u+v[0]+"px",this.container.style.top=h-v[1]+"px"}}},{key:"checkUpdateOption",value:function(u,h){return h.some(function(v){return v in u})}}]),a}(Ee.EventEmitter);function P3(n){var l=K_();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function K_(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var O3=function(n){(0,zt.Z)(a,n);var l=P3(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"layerConfigMap",new WeakMap),s}return(0,et.Z)(a,[{key:"layerConfigItems",get:function(){var u,h=this.popupOption,v=h.config,m=h.items;return(u=v!=null?v:m)!==null&&u!==void 0?u:[]}},{key:"addTo",value:function(u){return ts((0,b.Z)(a.prototype),"addTo",this).call(this,u),this.bindLayerEvent(),this.hide(),this}},{key:"remove",value:function(){return ts((0,b.Z)(a.prototype),"remove",this).call(this),this.unbindLayerEvent(),this}},{key:"setOptions",value:function(u){return this.unbindLayerEvent(),ts((0,b.Z)(a.prototype),"setOptions",this).call(this,u),this.bindLayerEvent(),this}},{key:"getDefault",value:function(u){var h=u.trigger==="click";return(0,K.Z)((0,K.Z)({},ts((0,b.Z)(a.prototype),"getDefault",this).call(this,u)),{},{trigger:"hover",followCursor:!h,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!1,autoClose:!1,closeOnEsc:!1})}},{key:"bindLayerEvent",value:function(){var u=this,h=this.popupOption.trigger;this.layerConfigItems.forEach(function(v){var m,w=u.getLayerByConfig(v);if(w){var A=(0,K.Z)({},v);if(h==="hover"){var R=u.onLayerMouseMove.bind(u,w),B=u.onLayerMouseOut.bind(u,w);A.onMouseMove=R,A.onMouseOut=B,w==null||w.on("mousemove",R),w==null||w.on("mouseout",B)}else{var G=u.onLayerClick.bind(u,w);A.onClick=G,w==null||w.on("click",G)}var j=w==null||(m=w.getSource)===null||m===void 0?void 0:m.call(w),lt=u.onSourceUpdate.bind(u,w);j==null||j.on("update",lt),A.onSourceUpdate=lt,u.layerConfigMap.set(w,A)}})}},{key:"unbindLayerEvent",value:function(){var u=this;this.layerConfigItems.forEach(function(h){var v=u.getLayerByConfig(h),m=v&&u.layerConfigMap.get(v);if(m){var w=m.onMouseMove,A=m.onMouseOut,R=m.onClick,B=m.onSourceUpdate;if(w&&v.off("mousemove",w),A&&v.off("mouseout",A),R&&v.off("click",R),B){var G;v==null||(G=v.getSource())===null||G===void 0||G.off("update",B)}}})}},{key:"onLayerMouseMove",value:function(u,h){if(!this.isSameFeature(u,h.featureId)){var v=this.getLayerInfoFrag(u,h),m=v.title,w=v.content;this.setDOMContent(w),this.setTitle(m),this.displayFeatureInfo={layer:u,featureId:h.featureId},this.show()}}},{key:"onLayerMouseOut",value:function(u,h){this.displayFeatureInfo=void 0,this.isShow&&this.hide()}},{key:"onLayerClick",value:function(u,h){if(this.isShow&&this.isSameFeature(u,h.featureId))this.hide();else{var v=this.getLayerInfoFrag(u,h),m=v.title,w=v.content;this.setDOMContent(w),this.setLnglat(h.lngLat),this.setTitle(m),this.displayFeatureInfo={layer:u,featureId:h.featureId},this.show()}}},{key:"onSourceUpdate",value:function(u){var h;((h=this.displayFeatureInfo)===null||h===void 0?void 0:h.layer)===u&&(this.hide(),this.displayFeatureInfo=void 0)}},{key:"getLayerInfoFrag",value:function(u,h){var v=this.layerConfigMap.get(u),m,w=document.createDocumentFragment();if(v){var A=h.feature;A.type==="Feature"&&"properties"in A&&"geometry"in A&&(A=A.properties);var R=v.title,B=v.fields,G=v.customContent;if(R){m=document.createDocumentFragment();var j=R instanceof Function?R(A):R;ce(m,j)}if(G){var lt=G instanceof Function?G(A):G;ce(w,lt)}else B!=null&&B.length&&(B==null||B.forEach(function(ct){var _t,Zt,pe=typeof ct=="string"?{field:ct}:ct,fe=pe.field,Ze=pe.formatField,Qe=pe.formatValue,wr=pe.getValue,Lr=Jt("div","l7-layer-popup__row"),Vr=wr?wr(h.feature):(0,ne.get)(A,fe),Wr=(_t=Ze instanceof Function?Ze(fe,A):Ze)!==null&&_t!==void 0?_t:fe,bn=(Zt=Qe instanceof Function?Qe(Vr,A):Qe)!==null&&Zt!==void 0?Zt:Vr,hn=Jt("span","l7-layer-popup__key",Lr);ce(hn,Wr),ce(hn,document.createTextNode("\uFF1A"));var Wn=Jt("span","l7-layer-popup__value",Lr);ce(Wn,bn),w.appendChild(Lr)}))}return{title:m,content:w}}},{key:"getLayerByConfig",value:function(u){var h=u.layer;if(h instanceof Object)return h;if(typeof h=="string")return this.layerService.getLayer(h)||this.layerService.getLayerByName(h)}},{key:"isSameFeature",value:function(u,h){var v=this.displayFeatureInfo;return v&&u===v.layer&&h===v.featureId}}]),a}(L3);function F3(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var u=l.head||l.getElementsByTagName("head")[0];if(!u){u=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(u,h):l.documentElement.appendChild(u)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),u.appendChild(v),v}}F3(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 800;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  overflow: hidden;
}
.l7-control-zoom .l7-button-control {
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
  border-radius: 0;
  font-size: 16px;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:first-child {
  border-bottom: 1px solid #f0f0f0;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var Wy={},tw={},ew=function(l){return tw[l]},jp=function(l,a){tw[l]=a},R3=function(l){return Wy[l]},ug=function(l,a){Wy[l]=a},Xy={},Q_={},J_=34,em=10,rm=13;function rw(n){return new Function("d","return {"+n.map(function(l,a){return JSON.stringify(l)+": d["+a+'] || ""'}).join(",")+"}")}function D3(n,l){var a=rw(n);return function(s,u){return l(a(s),u,n)}}function lg(n){var l=Object.create(null),a=[];return n.forEach(function(s){for(var u in s)u in l||a.push(l[u]=u)}),a}function hc(n,l){var a=n+"",s=a.length;return s<l?new Array(l-s+1).join(0)+a:a}function tx(n){return n<0?"-"+hc(-n,6):n>9999?"+"+hc(n,6):hc(n,4)}function nw(n){var l=n.getUTCHours(),a=n.getUTCMinutes(),s=n.getUTCSeconds(),u=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":tx(n.getUTCFullYear(),4)+"-"+hc(n.getUTCMonth()+1,2)+"-"+hc(n.getUTCDate(),2)+(u?"T"+hc(l,2)+":"+hc(a,2)+":"+hc(s,2)+"."+hc(u,3)+"Z":s?"T"+hc(l,2)+":"+hc(a,2)+":"+hc(s,2)+"Z":a||l?"T"+hc(l,2)+":"+hc(a,2)+"Z":"")}function S0(n){var l=new RegExp('["'+n+`
\r]`),a=n.charCodeAt(0);function s(B,G){var j,lt,ct=u(B,function(_t,Zt){if(j)return j(_t,Zt-1);lt=_t,j=G?D3(_t,G):rw(_t)});return ct.columns=lt||[],ct}function u(B,G){var j=[],lt=B.length,ct=0,_t=0,Zt,pe=lt<=0,fe=!1;B.charCodeAt(lt-1)===em&&--lt,B.charCodeAt(lt-1)===rm&&--lt;function Ze(){if(pe)return Q_;if(fe)return fe=!1,Xy;var wr,Lr=ct,Vr;if(B.charCodeAt(Lr)===J_){for(;ct++<lt&&B.charCodeAt(ct)!==J_||B.charCodeAt(++ct)===J_;);return(wr=ct)>=lt?pe=!0:(Vr=B.charCodeAt(ct++))===em?fe=!0:Vr===rm&&(fe=!0,B.charCodeAt(ct)===em&&++ct),B.slice(Lr+1,wr-1).replace(/""/g,'"')}for(;ct<lt;){if((Vr=B.charCodeAt(wr=ct++))===em)fe=!0;else if(Vr===rm)fe=!0,B.charCodeAt(ct)===em&&++ct;else if(Vr!==a)continue;return B.slice(Lr,wr)}return pe=!0,B.slice(Lr,lt)}for(;(Zt=Ze())!==Q_;){for(var Qe=[];Zt!==Xy&&Zt!==Q_;)Qe.push(Zt),Zt=Ze();G&&(Qe=G(Qe,_t++))==null||j.push(Qe)}return j}function h(B,G){return B.map(function(j){return G.map(function(lt){return R(j[lt])}).join(n)})}function v(B,G){return G==null&&(G=lg(B)),[G.map(R).join(n)].concat(h(B,G)).join(`
`)}function m(B,G){return G==null&&(G=lg(B)),h(B,G).join(`
`)}function w(B){return B.map(A).join(`
`)}function A(B){return B.map(R).join(n)}function R(B){return B==null?"":B instanceof Date?nw(B):l.test(B+="")?'"'+B.replace(/"/g,'""')+'"':B}return{parse:s,parseRows:u,format:v,formatBody:m,formatRows:w,formatRow:A,formatValue:R}}var ff=S0(","),B3=ff.parse,iw=ff.parseRows,BO=ff.format,NO=ff.formatBody,zO=ff.formatRows,UO=ff.formatRow,Vd=ff.formatValue,N3=nt(70309),Yy=nt.n(N3);function ZO(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function aw(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function z3(n){if(n.length>1&&isNumber(n[0])&&isNumber(n[1]))return!0;if(Array.isArray(n[0])&&n[0].length)return z3(n[0]);throw new Error("coordinates must only contain numbers")}function VO(n,l,a){if(!l||!a)throw new Error("type and name required");if(!n||n.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+n.type)}function GO(n,l,a){if(!n)throw new Error("No feature passed");if(!a)throw new Error(".featureOf() requires a name");if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!n.geometry||n.geometry.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+n.geometry.type)}function HO(n,l,a){if(!n)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!n||n.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var s=0,u=n.features;s<u.length;s++){var h=u[s];if(!h||h.type!=="Feature"||!h.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!h.geometry||h.geometry.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+h.geometry.type)}}function ow(n){return n.type==="Feature"?n.geometry:n}function jO(n,l){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function sw(n,l){var a=l.x,s=l.y,u=l.x1,h=l.y1,v=l.coordinates,m=l.geometry,w=[];if(!Array.isArray(n))return{dataArray:[]};if(m)return n.filter(function(Zt){return Zt[m]&&Zt[m].type&&Zt[m].coordinates&&Zt[m].coordinates.length>0}).forEach(function(Zt,pe){var fe=Yy()((0,K.Z)({},Zt[m]),!0);Nl(fe,function(Ze){var Qe=aw(Ze),wr=(0,K.Z)((0,K.Z)({},Zt),{},{_id:pe,coordinates:Qe});w.push(wr)})}),{dataArray:w};for(var A=0;A<n.length;A++){var R=n[A],B=[];if(v){var G="Polygon";Array.isArray(v[0])||(G="Point"),Array.isArray(v[0])&&!Array.isArray(v[0][0])&&(G="LineString");var j=Yy()({type:G,coordinates:(0,ve.Z)(R[v])},!0);B=j.coordinates}else if(a&&s&&u&&h){var lt=[parseFloat(R[a]),parseFloat(R[s])],ct=[parseFloat(R[u]),parseFloat(R[h])];B=[lt,ct]}else a&&s&&(B=[parseFloat(R[a]),parseFloat(R[s])]);var _t=(0,K.Z)((0,K.Z)({},R),{},{_id:A,coordinates:B});w.push(_t)}return{dataArray:w}}function C0(n,l){var a=B3(n);return sw(a,l)}function U3(n){for(var l=n.toString(),a=5381,s=l.length;s;)a=a*33^l.charCodeAt(--s);return a>>>0}function Z3(n,l){return l===void 0?null:n.properties[l]?n.properties[l]:n.properties&&n.properties[l]?U3(n.properties[l]+"")%1000019:null}function uw(n,l){var a=[],s={};return n.features?(n.features=n.features.filter(function(u){var h=u.geometry;return u!=null&&h&&h.type&&h.coordinates&&h.coordinates.length>0}),Yy()(n,!0),n.features.length===0?{dataArray:[],featureKeys:s}:(Nl(n,function(u,h){var v=Z3(u,l==null?void 0:l.featureId);v===null&&(v=h);var m=v,w=aw(u),A=(0,K.Z)((0,K.Z)({},u.properties),{},{coordinates:w,_id:m});a.push(A)}),{dataArray:a,featureKeys:s})):(n.features=[],{dataArray:[]})}function ex(n,l){var a=l.extent,s=a===void 0?[121.168,30.2828,121.384,30.4219]:a,u=new Promise(function(v){n instanceof HTMLImageElement||Iu(n)?v([n]):V3(n,function(m){v(m)})}),h={originData:n,images:u,_id:1,dataArray:[{_id:0,coordinates:[[s[0],s[1]],[s[2],s[3]]]}]};return h}function V3(n,l){var a=n,s=[];if(typeof a=="string")hh({url:a},function(v,m){m&&(s.push(m),l(s))});else{var u=a.length,h=0;a.forEach(function(v){hh({url:v},function(m,w){h++,w&&s.push(w),h===u&&l(s)})})}return ex}var nm=nt(85143),A0=nt(43548),G3=nt.n(A0),$y=function(){function n(l,a,s,u){(0,pt.Z)(this,n),(0,W.Z)(this,"vectorLayerCache",{}),this.x=a,this.y=s,this.z=u,this.vectorTile=new nm.VectorTile(new(G3())(l))}return(0,et.Z)(n,[{key:"getTileData",value:function(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];var s=this.vectorTile.layers[a];if(Array.isArray(s.features))return this.vectorLayerCache[a]=s.features,s.features;for(var u=[],h=0;h<s.length;h++){var v=s.feature(h),m=v.toGeoJSON(this.x,this.y,this.z);u.push((0,K.Z)((0,K.Z)({},m),{},{properties:(0,K.Z)({id:m.id},m.properties)}))}return this.vectorLayerCache[a]=u,u}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),n}(),H3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},j3=function(){var n=(0,J.Z)(ot().mark(function l(a,s,u,h,v){var m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m=on(a,s),A.abrupt("return",new Promise(function(R){if(v)v({x:u.x,y:u.y,z:u.z},function(G,j){if(G||!j)R(void 0);else{var lt=new $y(j,u.x,u.y,u.z);R(lt)}});else{var B=Kc((0,K.Z)((0,K.Z)({},h),{},{url:m}),function(G,j){if(G||!j)R(void 0);else{var lt=new $y(j,u.x,u.y,u.z);R(lt)}});u.xhrCancel=function(){return B.abort()}}}));case 2:case"end":return A.stop()}},l)}));return function(a,s,u,h,v){return n.apply(this,arguments)}}();function W3(n,l){var a=Array.isArray(n)?n[0]:n,s=function(v,m){return j3(a,v,m,l==null?void 0:l.requestParameters,l==null?void 0:l.getCustomData)},u=(0,K.Z)((0,K.Z)((0,K.Z)({},H3),l),{},{getTileData:s});return{data:a,dataArray:[],tilesetOptions:u,isTile:!0}}function rx(n,l,a,s){for(var u=s,h=a-l>>1,v=a-l,m,w=n[l],A=n[l+1],R=n[a],B=n[a+1],G=l+3;G<a;G+=3){var j=cg(n[G],n[G+1],w,A,R,B);if(j>u)m=G,u=j;else if(j===u){var lt=Math.abs(G-h);lt<v&&(m=G,v=lt)}}u>s&&(m-l>3&&rx(n,l,m,s),n[m+2]=u,a-m>3&&rx(n,m,a,s))}function cg(n,l,a,s,u,h){var v=u-a,m=h-s;if(v!==0||m!==0){var w=((n-a)*v+(l-s)*m)/(v*v+m*m);w>1?(a=u,s=h):w>0&&(a+=v*w,s+=m*w)}return v=n-a,m=l-s,v*v+m*m}function Lv(n,l,a,s){var u={id:typeof n=="undefined"?null:n,type:l,geometry:a,tags:s,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return X3(u),u}function X3(n){var l=n.geometry,a=n.type;if(a==="Point"||a==="MultiPoint"||a==="LineString")nx(n,l);else if(a==="Polygon"||a==="MultiLineString")for(var s=0;s<l.length;s++)nx(n,l[s]);else if(a==="MultiPolygon")for(s=0;s<l.length;s++)for(var u=0;u<l[s].length;u++)nx(n,l[s][u])}function nx(n,l){for(var a=0;a<l.length;a+=3)n.minX=Math.min(n.minX,l[a]),n.minY=Math.min(n.minY,l[a+1]),n.maxX=Math.max(n.maxX,l[a]),n.maxY=Math.max(n.maxY,l[a+1])}function fg(n,l){var a=[];if(n.type==="FeatureCollection")for(var s=0;s<n.features.length;s++)qy(a,n.features[s],l,s);else n.type==="Feature"?qy(a,n,l):qy(a,{geometry:n},l);return a}function qy(n,l,a,s){if(l.geometry){var u=l.geometry.coordinates,h=l.geometry.type,v=Math.pow(a.tolerance/((1<<a.maxZoom)*a.extent),2),m=[],w=l.id;if(a.promoteId?w=l.properties[a.promoteId]:a.generateId&&(w=s||0),h==="Point")lw(u,m);else if(h==="MultiPoint")for(var A=0;A<u.length;A++)lw(u[A],m);else if(h==="LineString")Ky(u,m,v,!1);else if(h==="MultiLineString")if(a.lineMetrics){for(A=0;A<u.length;A++)m=[],Ky(u[A],m,v,!1),n.push(Lv(w,"LineString",m,l.properties));return}else im(u,m,v,!1);else if(h==="Polygon")im(u,m,v,!0);else if(h==="MultiPolygon")for(A=0;A<u.length;A++){var R=[];im(u[A],R,v,!0),m.push(R)}else if(h==="GeometryCollection"){for(A=0;A<l.geometry.geometries.length;A++)qy(n,{id:w,geometry:l.geometry.geometries[A],properties:l.properties},a,s);return}else throw new Error("Input data is not a valid GeoJSON object.");n.push(Lv(w,h,m,l.properties))}}function lw(n,l){l.push(cw(n[0])),l.push(fw(n[1])),l.push(0)}function Ky(n,l,a,s){for(var u,h,v=0,m=0;m<n.length;m++){var w=cw(n[m][0]),A=fw(n[m][1]);l.push(w),l.push(A),l.push(0),m>0&&(s?v+=(u*A-w*h)/2:v+=Math.sqrt(Math.pow(w-u,2)+Math.pow(A-h,2))),u=w,h=A}var R=l.length-3;l[2]=1,rx(l,0,R,a),l[R+2]=1,l.size=Math.abs(v),l.start=0,l.end=l.size}function im(n,l,a,s){for(var u=0;u<n.length;u++){var h=[];Ky(n[u],h,a,s),l.push(h)}}function cw(n){return n/360+.5}function fw(n){var l=Math.sin(n*Math.PI/180),a=.5-.25*Math.log((1+l)/(1-l))/Math.PI;return a<0?0:a>1?1:a}function Gd(n,l,a,s,u,h,v,m){if(a/=l,s/=l,h>=a&&v<s)return n;if(v<a||h>=s)return null;for(var w=[],A=0;A<n.length;A++){var R=n[A],B=R.geometry,G=R.type,j=u===0?R.minX:R.minY,lt=u===0?R.maxX:R.maxY;if(j>=a&&lt<s){w.push(R);continue}else if(lt<a||j>=s)continue;var ct=[];if(G==="Point"||G==="MultiPoint")ix(B,ct,a,s,u);else if(G==="LineString")ax(B,ct,a,s,u,!1,m.lineMetrics);else if(G==="MultiLineString")ox(B,ct,a,s,u,!1);else if(G==="Polygon")ox(B,ct,a,s,u,!0);else if(G==="MultiPolygon")for(var _t=0;_t<B.length;_t++){var Zt=[];ox(B[_t],Zt,a,s,u,!0),Zt.length&&ct.push(Zt)}if(ct.length){if(m.lineMetrics&&G==="LineString"){for(_t=0;_t<ct.length;_t++)w.push(Lv(R.id,G,ct[_t],R.tags));continue}(G==="LineString"||G==="MultiLineString")&&(ct.length===1?(G="LineString",ct=ct[0]):G="MultiLineString"),(G==="Point"||G==="MultiPoint")&&(G=ct.length===3?"Point":"MultiPoint"),w.push(Lv(R.id,G,ct,R.tags))}}return w.length?w:null}function ix(n,l,a,s,u){for(var h=0;h<n.length;h+=3){var v=n[h+u];v>=a&&v<=s&&(l.push(n[h]),l.push(n[h+1]),l.push(n[h+2]))}}function ax(n,l,a,s,u,h,v){for(var m=hw(n),w=u===0?pw:Y3,A=n.start,R,B,G=0;G<n.length-3;G+=3){var j=n[G],lt=n[G+1],ct=n[G+2],_t=n[G+3],Zt=n[G+4],pe=u===0?j:lt,fe=u===0?_t:Zt,Ze=!1;v&&(R=Math.sqrt(Math.pow(j-_t,2)+Math.pow(lt-Zt,2))),pe<a?fe>a&&(B=w(m,j,lt,_t,Zt,a),v&&(m.start=A+R*B)):pe>s?fe<s&&(B=w(m,j,lt,_t,Zt,s),v&&(m.start=A+R*B)):Qy(m,j,lt,ct),fe<a&&pe>=a&&(B=w(m,j,lt,_t,Zt,a),Ze=!0),fe>s&&pe<=s&&(B=w(m,j,lt,_t,Zt,s),Ze=!0),!h&&Ze&&(v&&(m.end=A+R*B),l.push(m),m=hw(n)),v&&(A+=R)}var Qe=n.length-3;j=n[Qe],lt=n[Qe+1],ct=n[Qe+2],pe=u===0?j:lt,pe>=a&&pe<=s&&Qy(m,j,lt,ct),Qe=m.length-3,h&&Qe>=3&&(m[Qe]!==m[0]||m[Qe+1]!==m[1])&&Qy(m,m[0],m[1],m[2]),m.length&&l.push(m)}function hw(n){var l=[];return l.size=n.size,l.start=n.start,l.end=n.end,l}function ox(n,l,a,s,u,h){for(var v=0;v<n.length;v++)ax(n[v],l,a,s,u,h,!1)}function Qy(n,l,a,s){n.push(l),n.push(a),n.push(s)}function pw(n,l,a,s,u,h){var v=(h-l)/(s-l);return n.push(h),n.push(a+(u-a)*v),n.push(1),v}function Y3(n,l,a,s,u,h){var v=(h-a)/(u-a);return n.push(l+(s-l)*v),n.push(h),n.push(1),v}function dw(n,l){var a=l.buffer/l.extent,s=n,u=Gd(n,1,-1-a,a,0,-1,2,l),h=Gd(n,1,1-a,2+a,0,-1,2,l);return(u||h)&&(s=Gd(n,1,-a,1+a,0,-1,2,l)||[],u&&(s=sx(u,1).concat(s)),h&&(s=s.concat(sx(h,-1)))),s}function sx(n,l){for(var a=[],s=0;s<n.length;s++){var u=n[s],h=u.type,v;if(h==="Point"||h==="MultiPoint"||h==="LineString")v=Jy(u.geometry,l);else if(h==="MultiLineString"||h==="Polygon"){v=[];for(var m=0;m<u.geometry.length;m++)v.push(Jy(u.geometry[m],l))}else if(h==="MultiPolygon")for(v=[],m=0;m<u.geometry.length;m++){for(var w=[],A=0;A<u.geometry[m].length;A++)w.push(Jy(u.geometry[m][A],l));v.push(w)}a.push(Lv(u.id,h,v,u.tags))}return a}function Jy(n,l){var a=[];a.size=n.size,n.start!==void 0&&(a.start=n.start,a.end=n.end);for(var s=0;s<n.length;s+=3)a.push(n[s]+l,n[s+1],n[s+2]);return a}function vw(n,l){if(n.transformed)return n;var a=1<<n.z,s=n.x,u=n.y,h,v,m;for(h=0;h<n.features.length;h++){var w=n.features[h],A=w.geometry,R=w.type;if(w.geometry=[],R===1)for(v=0;v<A.length;v+=2)w.geometry.push(ux(A[v],A[v+1],l,a,s,u));else for(v=0;v<A.length;v++){var B=[];for(m=0;m<A[v].length;m+=2)B.push(ux(A[v][m],A[v][m+1],l,a,s,u));w.geometry.push(B)}}return n.transformed=!0,n}function ux(n,l,a,s,u,h){return[Math.round(a*(n*s-u)),Math.round(a*(l*s-h))]}function lx(n,l,a,s,u){for(var h=l===u.maxZoom?0:u.tolerance/((1<<l)*u.extent),v={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:a,y:s,z:l,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},m=0;m<n.length;m++){v.numFeatures++,gw(v,n[m],h,u);var w=n[m].minX,A=n[m].minY,R=n[m].maxX,B=n[m].maxY;w<v.minX&&(v.minX=w),A<v.minY&&(v.minY=A),R>v.maxX&&(v.maxX=R),B>v.maxY&&(v.maxY=B)}return v}function gw(n,l,a,s){var u=l.geometry,h=l.type,v=[];if(h==="Point"||h==="MultiPoint")for(var m=0;m<u.length;m+=3)v.push(u[m]),v.push(u[m+1]),n.numPoints++,n.numSimplified++;else if(h==="LineString")cx(v,u,n,a,!1,!1);else if(h==="MultiLineString"||h==="Polygon")for(m=0;m<u.length;m++)cx(v,u[m],n,a,h==="Polygon",m===0);else if(h==="MultiPolygon")for(var w=0;w<u.length;w++){var A=u[w];for(m=0;m<A.length;m++)cx(v,A[m],n,a,!0,m===0)}if(v.length){var R=l.tags||null;if(h==="LineString"&&s.lineMetrics){R={};for(var B in l.tags)R[B]=l.tags[B];R.mapbox_clip_start=u.start/u.size,R.mapbox_clip_end=u.end/u.size}var G={geometry:v,type:h==="Polygon"||h==="MultiPolygon"?3:h==="LineString"||h==="MultiLineString"?2:1,tags:R};l.id!==null&&(G.id=l.id),n.features.push(G)}}function cx(n,l,a,s,u,h){var v=s*s;if(s>0&&l.size<(u?v:s)){a.numPoints+=l.length/3;return}for(var m=[],w=0;w<l.length;w+=3)(s===0||l[w+2]>v)&&(a.numSimplified++,m.push(l[w]),m.push(l[w+1])),a.numPoints++;u&&mw(m,h),n.push(m)}function mw(n,l){for(var a=0,s=0,u=n.length,h=u-2;s<u;h=s,s+=2)a+=(n[s]-n[h])*(n[s+1]+n[h+1]);if(a>0===l)for(s=0,u=n.length;s<u/2;s+=2){var v=n[s],m=n[s+1];n[s]=n[u-2-s],n[s+1]=n[u-1-s],n[u-2-s]=v,n[u-1-s]=m}}function fx(n,l){return new am(n,l)}function am(n,l){l=this.options=$3(Object.create(this.options),l);var a=l.debug;if(a&&console.time("preprocess data"),l.maxZoom<0||l.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(l.promoteId&&l.generateId)throw new Error("promoteId and generateId cannot be used together.");var s=fg(n,l);this.tiles={},this.tileCoords=[],a&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",l.indexMaxZoom,l.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),s=dw(s,l),s.length&&this.splitTile(s,0,0,0),a&&(s.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}am.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},am.prototype.splitTile=function(n,l,a,s,u,h,v){for(var m=[n,l,a,s],w=this.options,A=w.debug;m.length;){s=m.pop(),a=m.pop(),l=m.pop(),n=m.pop();var R=1<<l,B=hx(l,a,s),G=this.tiles[B];if(!G&&(A>1&&console.time("creation"),G=this.tiles[B]=lx(n,l,a,s,w),this.tileCoords.push({z:l,x:a,y:s}),A)){A>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",l,a,s,G.numFeatures,G.numPoints,G.numSimplified),console.timeEnd("creation"));var j="z"+l;this.stats[j]=(this.stats[j]||0)+1,this.total++}if(G.source=n,u){if(l===w.maxZoom||l===u)continue;var lt=1<<u-l;if(a!==Math.floor(h/lt)||s!==Math.floor(v/lt))continue}else if(l===w.indexMaxZoom||G.numPoints<=w.indexMaxPoints)continue;if(G.source=null,n.length!==0){A>1&&console.time("clipping");var ct=.5*w.buffer/w.extent,_t=.5-ct,Zt=.5+ct,pe=1+ct,fe,Ze,Qe,wr,Lr,Vr;fe=Ze=Qe=wr=null,Lr=Gd(n,R,a-ct,a+Zt,0,G.minX,G.maxX,w),Vr=Gd(n,R,a+_t,a+pe,0,G.minX,G.maxX,w),n=null,Lr&&(fe=Gd(Lr,R,s-ct,s+Zt,1,G.minY,G.maxY,w),Ze=Gd(Lr,R,s+_t,s+pe,1,G.minY,G.maxY,w),Lr=null),Vr&&(Qe=Gd(Vr,R,s-ct,s+Zt,1,G.minY,G.maxY,w),wr=Gd(Vr,R,s+_t,s+pe,1,G.minY,G.maxY,w),Vr=null),A>1&&console.timeEnd("clipping"),m.push(fe||[],l+1,a*2,s*2),m.push(Ze||[],l+1,a*2,s*2+1),m.push(Qe||[],l+1,a*2+1,s*2),m.push(wr||[],l+1,a*2+1,s*2+1)}}},am.prototype.getTile=function(n,l,a){var s=this.options,u=s.extent,h=s.debug;if(n<0||n>24)return null;var v=1<<n;l=(l%v+v)%v;var m=hx(n,l,a);if(this.tiles[m])return vw(this.tiles[m],u);h>1&&console.log("drilling down to z%d-%d-%d",n,l,a);for(var w=n,A=l,R=a,B;!B&&w>0;)w--,A=Math.floor(A/2),R=Math.floor(R/2),B=this.tiles[hx(w,A,R)];return!B||!B.source?null:(h>1&&console.log("found parent tile z%d-%d-%d",w,A,R),h>1&&console.time("drilling down"),this.splitTile(B.source,w,A,R,n,l,a),h>1&&console.timeEnd("drilling down"),this.tiles[m]?vw(this.tiles[m],u):null)};function hx(n,l,a){return((1<<n)*a+l)*32+n}function $3(n,l){for(var a in l)n[a]=l[a];return n}var q3=function(){function n(l,a,s,u){(0,pt.Z)(this,n),(0,W.Z)(this,"vectorLayerCache",{}),this.x=a,this.y=s,this.z=u,this.vectorTile=l}return(0,et.Z)(n,[{key:"getTileData",value:function(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];var s=this.vectorTile.layers[a];return s.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),n}(),px={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function K3(n){for(var l=0,a=0,s=n.length,u=s-1,h,v;a<s;u=a++)h=n[a],v=n[u],l+=(v.x-h.x)*(h.y+v.y);return l}function yw(n){var l=n.length;if(l<=1)return[n];for(var a=[],s,u,h=0;h<l;h++){var v=K3(n[h]);v!==0&&(u===void 0&&(u=v<0),u===v<0?(s&&a.push(s),s=[n[h]]):s.push(n[h]))}return s&&a.push(s),a}var Q3=["Unknown","Point","LineString","Polygon"];function _w(n,l,a,s,u){var h=u.geometry,v=u.type,m=u.tags,w=u.id,A=n*Math.pow(2,s),R=n*l,B=n*a,G=Q3[v],j,lt;function ct(pe){for(var fe=0;fe<pe.length;fe++){var Ze=pe[fe];if(Ze[3])break;var Qe=180-(Ze[1]+B)*360/A,wr=(Ze[0]+R)*360/A-180,Lr=360/Math.PI*Math.atan(Math.exp(Qe*Math.PI/180))-90;pe[fe]=[wr,Lr,0,1]}}switch(v){case 1:var _t=[];for(j=0;j<h.length;j++)_t[j]=h[j][0];h=_t,ct(h);break;case 2:for(j=0;j<h.length;j++)ct(h[j]);break;case 3:for(h=yw(h),j=0;j<h.length;j++)for(lt=0;lt<h[j].length;lt++)ct(h[j][lt]);break}h.length===1?h=h[0]:G="Multi"+G;var Zt={type:"Feature",geometry:{type:G,coordinates:h},properties:m,id:w,tileOrigin:[0,0],coord:""};return Zt}var J3=function(){var n=(0,J.Z)(ot().mark(function l(a,s,u,h){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(w){var A=s.getTile(a.z,a.x,a.y),R=A?A.features.map(function(j){return _w(h,u.x,u.y,u.z,j)}):[],B={layers:{defaultLayer:{features:R}}},G=new q3(B,a.x,a.y,a.z);w(G)}));case 1:case"end":return m.stop()}},l)}));return function(a,s,u,h){return n.apply(this,arguments)}}();function t5(n){var l={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return n===void 0||typeof n.geojsonvtOptions=="undefined"?l:(0,K.Z)((0,K.Z)({},l),n.geojsonvtOptions)}function e5(n,l){var a=t5(l),s=a.extent||4096,u=fx(n,a),h=function(w,A){return J3(A,u,w,s)},v=(0,K.Z)((0,K.Z)((0,K.Z)({},px),l),{},{getTileData:h});return{data:n,dataArray:[],tilesetOptions:v,isTile:!0}}function xw(n,l,a){switch(n){case"+":return l+a;case"-":return l-a;case"*":return l*a;case"/":return l/a;case"%":return l%a;case"^":return Math.pow(l,a);case"abs":return Math.abs(l);case"floor":return Math.floor(l);case"round":return Math.round(l);case"ceil":return Math.ceil(l);case"sin":return Math.sin(l);case"cos":return Math.cos(l);case"atan":return a===-1?Math.atan(l):Math.atan2(l,a);default:return console.warn("Calculate symbol err! Return default 0"),0}}function om(n,l){for(var a=l[0],s=a.width,u=a.height,h=l.map(function(j){return j.rasterData}),v=s*u,m=[],w=JSON.stringify(n),A=0;A<v;A++){var R=JSON.parse(w),B=bw(R,h,A);if(typeof B=="number")m.push(B);else{var G=dx(R);m.push(G)}}return m}function bw(n,l,a){if(n.length===2&&n[0]==="band"&&typeof n[1]=="number")try{return l[n[1]][a]}catch(s){return console.warn("Raster Data err!"),0}n.map(function(s,u){if(Array.isArray(s)&&s.length>0)switch(s[0]){case"band":try{n[u]=l[s[1]][a]}catch(h){console.warn("Raster Data err!"),n[u]=0}break;default:bw(s,l,a)}})}function r5(n){var l=(0,yt.Z)(n,3),a=l[0],s=l[1],u=s===void 0?-1:s,h=l[2],v=h===void 0?-1:h;if(a===void 0)return console.warn("Express err!"),["+",0,0];var m=a.replace(/\s+/g,"");return[m,u,v]}function dx(n){var l=r5(n),a=l[0],s=l[1],u=l[2];return Array.isArray(s)&&(s=dx(n[1])),Array.isArray(u)&&(u=dx(n[2])),xw(a,s,u)}var n5={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:i5}};function i5(n,l){for(var a=n[0].rasterData,s=n[1].rasterData,u=n[2].rasterData,h=[],v=(l==null?void 0:l.countCut)||[2,98],m=(0,yt.Z)(v,2),w=m[0],A=m[1],R=(l==null?void 0:l.RMinMax)||t1(a,w,A),B=(l==null?void 0:l.GMinMax)||t1(s,w,A),G=(l==null?void 0:l.BMinMax)||t1(u,w,A),j=0;j<a.length;j++)h.push(Math.max(0,a[j]-R[0])),h.push(Math.max(0,s[j]-B[0])),h.push(Math.max(0,u[j]-G[0]));return{rasterData:h,rMinMax:R,gMinMax:B,bMinMax:G}}function t1(n,l,a){var s=n.slice().sort(function(m,w){return m-w}),u=s.length,h=s[Math.ceil(u*l/100)],v=s[Math.ceil(u*a/100)];return[h,v]}function Uc(n,l,a){return vx.apply(this,arguments)}function vx(){return vx=(0,J.Z)(ot().mark(function n(l,a,s){var u,h,v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(l.length!==0){B.next=2;break}return B.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return B.next=4,Promise.all(l.map(function(G){var j=G.data,lt=G.bands,ct=lt===void 0?[0]:lt;return a(j,ct)}));case 4:u=B.sent,h=[],u.forEach(function(G){Array.isArray(G)?h.push.apply(h,(0,ve.Z)(G)):h.push(G)}),v=h[0],m=v.width,w=v.height,B.t0=(0,Pn.Z)(s),B.next=B.t0==="function"?11:B.t0==="object"?13:15;break;case 11:return A=s(h),B.abrupt("break",16);case 13:return Array.isArray(s)?A={rasterData:om(s,h)}:A=e1(s,h),B.abrupt("break",16);case 15:A={rasterData:h[0].rasterData};case 16:return B.abrupt("return",(0,K.Z)((0,K.Z)({},A),{},{width:m,height:w}));case 17:case"end":return B.stop()}},n)})),vx.apply(this,arguments)}function e1(n,l){var a=n5[n.type];if(a.type==="function")return a.method(l,n==null?void 0:n.options);if(a.type==="operation")return n.type==="rgb"?a5(a.expression,l):{rasterData:om(a.expression,l)}}function a5(n,l){n.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),n.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),n.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var a=om(n.r||["band",0],l),s=om(n.g||["band",0],l),u=om(n.b||["band",0],l);return[a,s,u]}function sm(n,l,a,s){return gx.apply(this,arguments)}function gx(){return gx=(0,J.Z)(ot().mark(function n(l,a,s,u){var h;return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,Uc(l,a,s);case 2:h=m.sent,u(null,{data:h});case 4:case"end":return m.stop()}},n)})),gx.apply(this,arguments)}function o5(n,l){return n.map(function(a){return a[l]*1})}function s5(n){return n===void 0?!1:!Array.isArray(n)&&n.data!==void 0}function u5(n){return Array.isArray(n)?n.length===0?!1:!!s5(n[0]):!1}function Ew(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":!1}function l5(n,l){var a=l.extent,s=l.width,u=l.height,h=l.min,v=l.max,m=l.format,w=l.operation,A,R,B;if(m===void 0||Ew(n))A=Array.from(n),R=s,B=u;else{var G=Array.isArray(n)?n:[n];A=Uc(G,m,w)}var j={_id:1,dataArray:[{_id:1,data:A,width:R,height:B,min:h,max:v,coordinates:[[a[0],a[1]],[a[2],a[3]]]}]};return j}var c5=["extent","min","max","width","height","format","operation"];function f5(n,l){var a=l.extent,s=l.min,u=l.max,h=l.width,v=l.height,m=l.format,w=l.operation,A=(0,ql.Z)(l,c5),R;if(m===void 0||Ew(n))R=Array.from(n);else{var B=Array.isArray(n)?n:[n];R=Uc(B,m,w)}var G={_id:1,dataArray:[(0,K.Z)((0,K.Z)({_id:1,data:R,width:h,height:v},A),{},{min:s,max:u,coordinates:[[a[0],a[1]],[a[2],a[3]]]})]};return G}var h5=function(){var n=(0,J.Z)(ot().mark(function l(a,s,u,h){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(w,A){s({x:a.x,y:a.y,z:a.z},function(R,B){if(R||B.length===0){A(R);return}B&&sm([{data:B,bands:[0]}],u,h,function(G,j){G?A(G):j&&w(j)})})}));case 1:case"end":return m.stop()}},l)}));return function(a,s,u,h){return n.apply(this,arguments)}}();function p5(n,l){return Array.isArray(n)?typeof n[0]=="string"?n.map(function(a){return on(a,l)}):n.map(function(a){return{url:on(a.url,l),bands:a.bands||[0]}}):on(n,l)}function d5(n){return typeof n=="string"?[{url:n,bands:[0]}]:typeof n[0]=="string"?n.map(function(l){return{url:l,bands:[0]}}):n}function ww(n,l){n.xhrCancel=function(){l.map(function(a){a.abort()})}}var v5=function(){var n=(0,J.Z)(ot().mark(function l(a,s,u,h,v){var m,w,A,R,B,G;return ot().wrap(function(lt){for(;;)switch(lt.prev=lt.next){case 0:if(m=d5(s.url),!(m.length>1)){lt.next=15;break}return lt.next=4,g5(m,s);case 4:if(w=lt.sent,A=w.rasterFiles,R=w.xhrList,B=w.errList,ww(a,R),!(B.length>0)){lt.next=12;break}return u(B,null),lt.abrupt("return");case 12:sm(A,h,v,u),lt.next=17;break;case 15:G=Kc(s,function(ct,_t){if(ct)u(ct);else if(_t){var Zt=[{data:_t,bands:m[0].bands}];sm(Zt,h,v,u)}}),ww(a,[G]);case 17:case"end":return lt.stop()}},l)}));return function(a,s,u,h,v){return n.apply(this,arguments)}}();function g5(n,l){return r1.apply(this,arguments)}function r1(){return r1=(0,J.Z)(ot().mark(function n(l,a){var s,u,h,v,m,w,A,R,B,G,j;return ot().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:s=[],u=[],h=[],v=0;case 4:if(!(v<l.length)){ct.next=20;break}return m=l[v],w=(0,K.Z)((0,K.Z)({},a),{},{url:m.url}),A=m.bands,ct.next=10,Uf((0,K.Z)((0,K.Z)({},w),{},{type:"arrayBuffer"}));case 10:R=ct.sent,B=R.err,G=R.data,j=R.xhr,B&&h.push(B),u.push(j),s.push({data:G,bands:A});case 17:v++,ct.next=4;break;case 20:return ct.abrupt("return",{rasterFiles:s,xhrList:u,errList:h});case 21:case"end":return ct.stop()}},n)})),r1.apply(this,arguments)}var Sw=function(){var n=(0,J.Z)(ot().mark(function l(a,s,u,h,v){var m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m={url:p5(a,s)},A.abrupt("return",new Promise(function(R,B){v5(u,m,function(G,j){G?B(G):j&&R(j)},h,v)}));case 2:case"end":return A.stop()}},l)}));return function(a,s,u,h,v){return n.apply(this,arguments)}}(),Cw=function(){var n=(0,J.Z)(ot().mark(function l(a,s,u,h){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return m=Array.isArray(a)?a[0]:a,h.wmtsOptions?(w=(h==null?void 0:h.getURLFromTemplate)||En,v=w(m,(0,K.Z)((0,K.Z)({},s),h.wmtsOptions))):(A=(h==null?void 0:h.getURLFromTemplate)||on,v=A(m,s)),B.abrupt("return",new Promise(function(G,j){var lt,ct=hh({url:v,type:(h==null||(lt=h.requestParameters)===null||lt===void 0?void 0:lt.type)||"arrayBuffer"},function(_t,Zt){_t?j(_t):Zt&&G(Zt)},h.transformResponse);u.xhrCancel=function(){return ct.abort()}}));case 3:case"end":return B.stop()}},l)}));return function(a,s,u,h){return n.apply(this,arguments)}}(),mx=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},m5={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},WO=[fp.ARRAYBUFFER,fp.RGB];function y5(n){return!!(Array.isArray(n)&&n.length===0||!Array.isArray(n)&&typeof n!="string")}function _5(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(y5(n))throw new Error("tile server url is error");var a=(l==null?void 0:l.dataType)||fp.IMAGE;a===fp.RGB&&(a=fp.ARRAYBUFFER);var s=function(v,m){switch(a){case fp.IMAGE:return Cw(n,v,m,l);case fp.ARRAYBUFFER:return Sw(n,v,m,(l==null?void 0:l.format)||mx,l==null?void 0:l.operation);case fp.CUSTOMARRAYBUFFER:case fp.CUSTOMRGB:return h5(m,l==null?void 0:l.getCustomData,(l==null?void 0:l.format)||mx,l==null?void 0:l.operation);default:return Cw(n,v,m,l)}},u=(0,K.Z)((0,K.Z)((0,K.Z)({},m5),l),{},{getTileData:s});return{data:n,dataArray:[],tilesetOptions:u,isTile:!0}}var x5={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},b5=function(){var n=(0,J.Z)(ot().mark(function l(a){return ot().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",new Promise(function(h){var v=(0,yt.Z)(a.bounds,4),m=v[0],w=v[1],A=v[2],R=v[3],B={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,textLng:(m+A)/2,textLat:(w+R)/2},geometry:{type:"LineString",coordinates:[[A,R],[A,w],[m,w],[m,w]]}}]}}};h(B)}));case 1:case"end":return u.stop()}},l)}));return function(a){return n.apply(this,arguments)}}();function E5(n,l){var a=function(h){return b5(h)},s=(0,K.Z)((0,K.Z)((0,K.Z)({},x5),l),{},{getTileData:a});return{data:n,dataArray:[],tilesetOptions:s,isTile:!0}}function Aw(n,l){var a=l.radius,s=a===void 0?40:a,u=l.maxZoom,h=u===void 0?18:u,v=l.minZoom,m=v===void 0?0:v,w=l.zoom,A=w===void 0?2:w;if(n.pointIndex){var R=n.pointIndex.getClusters(n.extent,Math.floor(A));return n.dataArray=w5(R),n}var B=new(H_())({radius:s,minZoom:m,maxZoom:h}),G={type:"FeatureCollection",features:[]};return G.features=n.dataArray.map(function(j){return{type:"Feature",geometry:{type:"Point",coordinates:j.coordinates},properties:(0,K.Z)({},j)}}),B.load(G.features),B}function w5(n){return n.map(function(l,a){return(0,K.Z)({coordinates:l.geometry.coordinates,_id:a+1},l.properties)})}function S5(n){if(n.length===0)throw new Error("max requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]>l&&(l=n[a]);return l}function C5(n){if(n.length===0)throw new Error("min requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]<l&&(l=n[a]);return l}function Wp(n){if(n.length===0)return 0;for(var l=n[0],a=0,s,u=1;u<n.length;u++)s=l+n[u]*1,Math.abs(l)>=Math.abs(n[u])?a+=l-s+n[u]:a+=n[u]-s+l,l=s;return l+a*1}function Tw(n){if(n.length===0)throw new Error("mean requires at least one data point");return Wp(n)/n.length}var Df={min:C5,max:S5,mean:Tw,sum:Wp};function hp(n){var l=Mw();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Mw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function Iw(n,l){if(Array.isArray(l))return l}var XO=function(n){(0,zt.Z)(a,n);var l=hp(a);function a(s,u){var h;return(0,pt.Z)(this,a),h=l.call(this),(0,W.Z)((0,ut.Z)(h),"type","source"),(0,W.Z)((0,ut.Z)(h),"isTile",!1),(0,W.Z)((0,ut.Z)(h),"inited",!1),(0,W.Z)((0,ut.Z)(h),"hooks",{init:new Vp}),(0,W.Z)((0,ut.Z)(h),"parser",{type:"geojson"}),(0,W.Z)((0,ut.Z)(h),"transforms",[]),(0,W.Z)((0,ut.Z)(h),"cluster",!1),(0,W.Z)((0,ut.Z)(h),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,W.Z)((0,ut.Z)(h),"invalidExtent",!1),(0,W.Z)((0,ut.Z)(h),"dataArrayChanged",!1),(0,W.Z)((0,ut.Z)(h),"cfg",{autoRender:!0}),h.originData=s,h.initCfg(u),h.init().then(function(){h.inited=!0,h.emit("update",{type:"inited"})}),h}return(0,et.Z)(a,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(u){return this.clusterIndex.getClusters(this.caculClusterExtent(2),u)}},{key:"getClustersLeaves",value:function(u){return this.clusterIndex.getLeaves(u,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(u){var h=this,v=this.clusterOptions,m=v.method,w=m===void 0?"sum":m,A=v.field,R=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(u));this.clusterOptions.zoom=u,R.forEach(function(B){B.id||(B.properties.point_count=1)}),(A||(0,ne.isFunction)(w))&&(R=R.map(function(B){var G=B.id;if(G){var j=h.clusterIndex.getLeaves(G,1/0),lt=j.map(function(Zt){return Zt.properties}),ct;if((0,ne.isString)(w)&&A){var _t=o5(lt,A);ct=Df[w](_t)}(0,ne.isFunction)(w)&&(ct=w(lt)),B.properties.stat=ct}else B.properties.point_count=1;return B})),this.data=ew("geojson")({type:"FeatureCollection",features:R}),this.executeTrans()}},{key:"getFeatureById",value:function(u){var h=this.parser,v=h.type,m=v===void 0?"geojson":v,w=h.geometry;if(m==="geojson"&&!this.cluster){var A=u<this.originData.features.length?this.originData.features[u]:"null",R=(0,ne.cloneDeep)(A);if(R!=null&&R.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var B=this.data.dataArray.find(function(G){return G._id===u});R.properties=B}return R}else return m==="json"&&w?this.data.dataArray.find(function(G){return G._id===u}):u<this.data.dataArray.length?this.data.dataArray[u]:"null"}},{key:"updateFeaturePropertiesById",value:function(u,h){this.data.dataArray=this.data.dataArray.map(function(v){return v._id===u?(0,K.Z)((0,K.Z)({},v),h):v}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(u,h){var v=this.data.dataArray.find(function(m){return m[u]===h});return v==null?void 0:v._id}},{key:"setData",value:function(u,h){var v=this;this.originData=u,this.dataArrayChanged=!1,this.initCfg(h),this.init().then(function(){v.emit("update",{type:"update"})})}},{key:"destroy",value:function(){var u;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(u=this.tileset)===null||u===void 0||u.destroy()}},{key:"processData",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v=this;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,new Promise(function(A,R){try{v.excuteParser(),v.initCluster(),v.executeTrans(),A({})}catch(B){R(B)}});case 2:return w.abrupt("return",w.sent);case 3:case"end":return w.stop()}},h)}));function u(){return s.apply(this,arguments)}return u}()},{key:"initCfg",value:function(u){this.cfg=(0,ne.mergeWith)(this.cfg,u,Iw);var h=this.cfg;h&&(h.parser&&(this.parser=h.parser),h.transforms&&(this.transforms=h.transforms),this.cluster=h.cluster||!1,h.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,K.Z)((0,K.Z)({},this.clusterOptions),h.clusterOptions)))}},{key:"init",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.inited=!1,m.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"excuteParser",value:function(){var u=this.parser,h=u.type||"geojson",v=ew(h);this.data=v(this.originData,u),this.tileset=this.initTileset(),!u.cancelExtent&&(this.extent=eu(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(u){this.center=[(u[0]+u[2])/2,(u[1]+u[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var u=this.data.tilesetOptions;if(u){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(u),this.tileset;var h=new dr((0,K.Z)({},u));return h}}},{key:"executeTrans",value:function(){var u=this,h=this.transforms;h.forEach(function(v){var m=v.type,w=R3(m)(u.data,v);Object.assign(u.data,w)})}},{key:"initCluster",value:function(){if(this.cluster){var u=this.clusterOptions||{};this.clusterIndex=Aw(this.data,u)}}},{key:"caculClusterExtent",value:function(u){var h=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(h=fu(Qi(this.extent),u)),h[0].concat(h[1])}}]),a}(Ee.EventEmitter);function Hd(n,l){var a=l.callback;return a&&(n.dataArray=n.dataArray.filter(a)),n}function ps(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=yx(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function yx(n,l){if(n){if(typeof n=="string")return _x(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return _x(n,l)}}function _x(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Pv=6378e3;function A5(n,l){var a=n.dataArray,s=l.size,u=s===void 0?10:s,h=u/(2*Math.PI*Pv)*(256<<20)/2,v=T5(a,u),m=v.gridHash,w=v.gridOffset,A=Lw(m,w,l);return{yOffset:h,xOffset:h,radius:h,type:"grid",dataArray:A}}function T5(n,l){var a=1/0,s=-1/0,u,h=ps(n),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;u=m.coordinates[1],Number.isFinite(u)&&(a=u<a?u:a,s=u>s?u:s)}}catch(fe){h.e(fe)}finally{h.f()}var w=(a+s)/2,A=kw(l,w);if(A.xOffset<=0||A.yOffset<=0)return{gridHash:{},gridOffset:A};var R={},B=ps(n),G;try{for(B.s();!(G=B.n()).done;){var j=G.value,lt=j.coordinates[1],ct=j.coordinates[0];if(Number.isFinite(lt)&&Number.isFinite(ct)){var _t=Math.floor((lt+90)/A.yOffset),Zt=Math.floor((ct+180)/A.xOffset),pe="".concat(_t,"-").concat(Zt);R[pe]=R[pe]||{count:0,points:[]},R[pe].count+=1,R[pe].points.push(j)}}}catch(fe){B.e(fe)}finally{B.f()}return{gridHash:R,gridOffset:A}}function kw(n,l){var a=M5(n),s=I5(l,n);return{yOffset:a,xOffset:s}}function M5(n){return n/Pv*(180/Math.PI)}function I5(n,l){return l/Pv*(180/Math.PI)/Math.cos(n*Math.PI/180)}function Lw(n,l,a){return Object.keys(n).reduce(function(s,u,h){var v=u.split("-"),m=parseInt(v[0],10),w=parseInt(v[1],10),A={};if(a.field&&a.method){var R=Wa(n[u].points,a.field);A[a.method]=ra[a.method](R)}return Object.assign(A,{_id:h,coordinates:mo([-180+l.xOffset*(w+.5),-90+l.yOffset*(m+.5)]),rawData:n[u].points,count:n[u].count}),s.push(A),s},[])}var T0=Math.PI/3,pn=[0,T0,2*T0,3*T0,4*T0,5*T0];function xx(n){return n[0]}function za(n){return n[1]}function Ac(){var n=0,l=0,a=1,s=1,u=xx,h=za,v,m,w;function A(B){var G={},j=[],lt,ct=B.length;for(lt=0;lt<ct;++lt)if(!(isNaN(Zt=+u.call(null,_t=B[lt],lt,B))||isNaN(pe=+h.call(null,_t,lt,B)))){var _t,Zt,pe,fe=Math.round(pe=pe/w),Ze=Math.round(Zt=Zt/m-(fe&1)/2),Qe=pe-fe;if(Math.abs(Qe)*3>1){var wr=Zt-Ze,Lr=Ze+(Zt<Ze?-1:1)/2,Vr=fe+(pe<fe?-1:1),Wr=Zt-Lr,bn=pe-Vr;wr*wr+Qe*Qe>Wr*Wr+bn*bn&&(Ze=Lr+(fe&1?1:-1)/2,fe=Vr)}var hn=Ze+"-"+fe,Wn=G[hn];Wn?Wn.push(_t):(j.push(Wn=G[hn]=[_t]),Wn.x=(Ze+(fe&1)/2)*m,Wn.y=fe*w)}return j}function R(B){var G=0,j=0;return pn.map(function(lt){var ct=Math.sin(lt)*B,_t=-Math.cos(lt)*B,Zt=ct-G,pe=_t-j;return G=ct,j=_t,[Zt,pe]})}return A.hexagon=function(B){return"m"+R(B==null?v:+B).join("l")+"z"},A.centers=function(){for(var B=[],G=Math.round(l/w),j=Math.round(n/m),lt=G*w;lt<s+v;lt+=w,++G)for(var ct=j*m+(G&1)*m/2;ct<a+m/2;ct+=m)B.push([ct,lt]);return B},A.mesh=function(){var B=R(v).slice(0,4).join("l");return A.centers().map(function(G){return"M"+G+"m"+B}).join("")},A.x=function(B){return arguments.length?(u=B,A):u},A.y=function(B){return arguments.length?(h=B,A):h},A.radius=function(B){return arguments.length?(v=+B,m=v*2*Math.sin(T0),w=v*1.5,A):v},A.size=function(B){return arguments.length?(n=l=0,a=+B[0],s=+B[1],A):[a-n,s-l]},A.extent=function(B){return arguments.length?(n=+B[0][0],l=+B[0][1],a=+B[1][0],s=+B[1][1],A):[[n,l],[a,s]]},A.radius(1)}var n1=6378e3;function um(n,l){var a=n.dataArray,s=l.size,u=s===void 0?10:s,h=l.method,v=h===void 0?"sum":h,m=u/(2*Math.PI*n1)*(256<<20)/2,w=a.map(function(G){var j=mo(G.coordinates),lt=(0,yt.Z)(j,2),ct=lt[0],_t=lt[1];return(0,K.Z)((0,K.Z)({},G),{},{coordinates:[ct,_t]})}),A=Ac().radius(m).x(function(G){return G.coordinates[0]}).y(function(G){return G.coordinates[1]}),R=A(w),B={dataArray:R.map(function(G,j){var lt;if(l.field&&v){var ct=Wa(G,l.field);G[v]=ra[v](ct)}return lt={},(0,W.Z)(lt,l.method,G[v]),(0,W.Z)(lt,"count",G.length),(0,W.Z)(lt,"rawData",G),(0,W.Z)(lt,"coordinates",[G.x,G.y]),(0,W.Z)(lt,"_id",j),lt}),radius:m,xOffset:m,yOffset:m,type:"hexagon"};return B}function k5(n,l){var a=l.sourceField,s=l.targetField,u=l.data,h={};return u.forEach(function(v){h[v[a]]=v}),n.dataArray=n.dataArray.map(function(v){var m=v[s];return(0,K.Z)((0,K.Z)({},v),h[m])}),n}function Kl(n,l){var a=l.callback;return a&&(n.dataArray=n.dataArray.map(a)),n}jp("rasterTile",_5),jp("mvt",W3),jp("geojsonvt",e5),jp("testTile",E5),jp("geojson",uw),jp("image",ex),jp("csv",C0),jp("json",sw),jp("raster",l5),jp("rasterRgb",f5),ug("cluster",Aw),ug("filter",Hd),ug("join",k5),ug("map",Kl),ug("grid",A5),ug("hexagon",um);var M0=XO,Ov,Pw=(Ov={},(0,W.Z)(Ov,cp.additive,{enable:!0,func:{srcRGB:se.ONE,dstRGB:se.ONE,srcAlpha:1,dstAlpha:1}}),(0,W.Z)(Ov,cp.none,{enable:!1}),(0,W.Z)(Ov,cp.normal,{enable:!0,func:{srcRGB:se.SRC_ALPHA,dstRGB:se.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,W.Z)(Ov,cp.subtractive,{enable:!0,func:{srcRGB:se.ONE,dstRGB:se.ONE,srcAlpha:se.ZERO,dstAlpha:se.ONE_MINUS_SRC_COLOR},equation:{rgb:se.FUNC_SUBTRACT,alpha:se.FUNC_SUBTRACT}}),(0,W.Z)(Ov,cp.max,{enable:!0,func:{srcRGB:se.ONE,dstRGB:se.ONE},equation:{rgb:se.MAX_EXT}}),(0,W.Z)(Ov,cp.min,{enable:!0,func:{srcRGB:se.ONE,dstRGB:se.ONE},equation:{rgb:se.MIN_EXT}}),Ov);function Ql(n,l,a,s,u){l.updateStyleAttribute(n,a,s,u)}function L5(n,l){l.tileLayer||l.isTileLayer||(n.opacity&&pp("opacity",l,n.opacity),n.strokeWidth&&pp("strokeWidth",l,n.strokeWidth),n.strokeOpacity&&pp("strokeOpacity",l,n.strokeOpacity),n.stroke&&bx("stroke",l,n.stroke),n.offsets&&lm("offsets",l,n.offsets),n.textOffset&&lm("textOffset",l,n.textOffset),n.thetaOffset&&pp("thetaOffset",l,n.thetaOffset))}function pp(n,l,a){(0,ne.isString)(a)?Ql(n,l,a,function(s){return s}):(0,ne.isNumber)(a)||(Array.isArray(a)&&a.length===2?(0,ne.isString)(a[0])&&(0,ne.isFunction)(a[1])||(0,ne.isString)(a[0])&&Array.isArray(a[1])&&(0,ne.isNumber)(a[1][0])&&(0,ne.isNumber)(a[1][1])?Ql(n,l,a[0],a[1]):Ql(n,l,[1],void 0):Ql(n,l,[1],void 0))}function lm(n,l,a){(0,ne.isString)(a)?Ql(n,l,a,function(s){return s}):Array.isArray(a)&&a.length===2&&(0,ne.isString)(a[0])&&(0,ne.isFunction)(a[1])?Ql(n,l,a[0],a[1]):Array.isArray(a)&&a.length===2&&(0,ne.isNumber)(a[0])&&(0,ne.isNumber)(a[1])?Ql(n,l,a,void 0):Ql(n,l,[0,0],void 0)}function bx(n,l,a){(0,ne.isString)(a)||(Array.isArray(a)&&a.length===2&&((0,ne.isString)(a[0])&&(0,ne.isFunction)(a[1])||(0,ne.isString)(a[0])&&Array.isArray(a[1])&&a[1].length>0)?Ql(n,l,a[0],a[1]):Ql(n,l,"#fff",void 0))}var Tc;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.DEFUALT="DEFUALTMAP",n.SIMPLE="SIMPLE",n.GLOBEL="GLOBEL"})(Tc||(Tc={}));function P5(n,l){var a=[l[0]-n[0],l[1]-n[1]],s=ki(a),u=[n[0]+s[0]*1e-4,n[1]+s[1]*1e-4];return u}function O5(n,l,a){if(n.length>0&&l.version===Tc["GAODE2.x"]){var s=a.coordCenter;typeof n[0].coordinates[0]=="number"?n.filter(function(u){return!u.originCoordinates}).map(function(u){u.version=Tc["GAODE2.x"],u.originCoordinates=(0,ne.cloneDeep)(u.coordinates),u.coordinates=l.lngLatToCoordByLayer(u.coordinates,s)}):n.filter(function(u){return!u.originCoordinates}).map(function(u){u.version=Tc["GAODE2.x"],u.originCoordinates=(0,ne.cloneDeep)(u.coordinates),u.coordinates=l.lngLatToCoordsByLayer(u.coordinates,s)})}}function F5(n,l){n.length>0&&l.version===Tc.SIMPLE&&n.map(function(a){a.simpleCoordinate||(a.coordinates=Ow(a.coordinates,l),a.simpleCoordinate=!0)})}function Ow(n,l){if(typeof n[0]=="number")return l.simpleMapCoord.unproject(n);if(n[0]&&n[0][0]instanceof Array){var a=[];return n.map(function(u){var h=[];u.map(function(v){h.push(l.simpleMapCoord.unproject(v))}),a.push(h)}),a}else{var s=[];return n.map(function(u){s.push(l.simpleMapCoord.unproject(u))}),s}}function Fw(n,l){var a;if(!n.scale)return[];var s=(n==null||(a=n.scale)===null||a===void 0?void 0:a.scalers)||[],u=[];s.forEach(function(v){var m,w=v.field;(l.hasOwnProperty(w)||((m=n.scale)===null||m===void 0?void 0:m.type)==="variable")&&u.push(l[w])});var h=n.mapping?n.mapping(u):[];return h}function Rw(n,l,a,s,u){var h=u==null?void 0:u.getLayerConfig(),v=h.arrow,m=v===void 0?{enable:!1}:v,w=l.map(function(A){var R={id:A._id,coordinates:A.coordinates};if(n.filter(function(j){return j.scale!==void 0}).forEach(function(j){var lt=Fw(j,A);j.needRemapping=!1,j.name==="color"&&(lt=lt.map(function(ct){return $e(ct)})),R[j.name]=Array.isArray(lt)&&lt.length===1?lt[0]:lt,j.name==="shape"&&(R.shape=a.getIconFontKey(R[j.name]))}),R.shape==="line"&&m.enable){var B=R.coordinates,G=P5(B[0],B[1]);R.coordinates.splice(1,0,G,G)}return R});return O5(w,s,u),F5(w,s),w}function i1(n,l,a,s,u,h){var v=new M0(u,h),m=s.getLayerStyleAttributes()||[],w=v.data.dataArray,A=w,R=Rw(m,A,l,a,n);return v.destroy(),R}function Dw(n){return n.map(function(l){return typeof l=="string"&&(l=[l,{}]),l})}function Ex(n,l,a,s){var u=n.multiPassRenderer,h=n.getLayerConfig(),v=h.enableTAA;return v?u.add(s("taa")):u.add(s("render")),Dw(l).forEach(function(m){var w=(0,yt.Z)(m,2),A=w[0],R=w[1];u.add(a(A),R)}),u.add(a("copy")),u}var yo=function(){function n(l){(0,pt.Z)(this,n),this.layer=l}return(0,et.Z)(n,[{key:"pickRender",value:function(a){var s=this.layer;if(s.tileLayer)return s.tileLayer.pickRender(a);s.hooks.beforePickingEncode.call(),s.masks.length>0&&s.masks.filter(function(u){return u.inited}).forEach(function(){var u=(0,J.Z)(ot().mark(function h(v){return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:v.render();case 1:case"end":return w.stop()}},h)}));return function(h){return u.apply(this,arguments)}}()),s.renderModels(!0),s.hooks.afterPickingEncode.call()}},{key:"pick",value:function(a,s){var u=this.layer.getContainer(),h=u.get(Dt.IPickingService);return a.type==="RasterLayer"?this.pickRasterLayer(a,s):(this.pickRender(s),h.pickFromPickingFBO(a,s))}},{key:"pickRasterLayer",value:function(a,s,u){var h=this.layer.getContainer(),v=h.get(Dt.IPickingService),m=h.get(Dt.IMapService),w=this.layer.getSource().extent,A=wl(s.lngLat,w),R={x:s.x,y:s.y,type:s.type,lngLat:s.lngLat,target:s,rasterValue:null},B=u||a;if(A){var G=this.readRasterValue(a,w,m,s.x,s.y);return R.rasterValue=G,v.triggerHoverOnLayer(B,R),!0}else return R.type=s.type==="mousemove"?"mouseout":"un"+s.type,v.triggerHoverOnLayer(B,(0,K.Z)((0,K.Z)({},R),{},{type:"unpick"})),v.triggerHoverOnLayer(B,R),!1}},{key:"readRasterValue",value:function(a,s,u,h,v){var m=a.getSource().data.dataArray[0],w=(0,yt.Z)(s,4),A=w[0],R=A===void 0?0:A,B=w[1],G=B===void 0?0:B,j=w[2],lt=j===void 0?10:j,ct=w[3],_t=ct===void 0?-10:ct,Zt=u.lngLatToContainer([R,G]),pe=u.lngLatToContainer([lt,_t]),fe=pe.x-Zt.x,Ze=Zt.y-pe.y,Qe=[(h-Zt.x)/fe,(v-pe.y)/Ze],wr=m.width||1,Lr=m.height||1,Vr=Math.floor(Qe[0]*wr),Wr=Math.floor(Qe[1]*Lr),bn=Math.max(0,Wr-1)*wr+Vr,hn=m.data[bn];return hn}},{key:"selectFeature",value:function(a){var s=this.layer,u=(0,yt.Z)(a,3),h=u[0],v=u[1],m=u[2];s.hooks.beforeSelect.call([h,v,m])}},{key:"highlightPickedFeature",value:function(a){var s=(0,yt.Z)(a,3),u=s[0],h=s[1],v=s[2];this.layer.hooks.beforeHighlight.call([u,h,v])}},{key:"getFeatureById",value:function(a){return this.layer.getSource().getFeatureById(a)}}]),n}(),cm=function(){function n(l){(0,pt.Z)(this,n),this.layer=l;var a=this.layer.getContainer();this.rendererService=a.get(Dt.IRendererService)}return(0,et.Z)(n,[{key:"getColorTexture",value:function(a,s){var u=this.getTextureKey(a,s);return this.key===u?this.colorTexture:(this.createColorTexture(a,s),this.key=u,this.colorTexture)}},{key:"createColorTexture",value:function(a,s){var u=this.rendererService.createTexture2D,h=this.getColorRampBar(a,s),v=u({data:h.data,width:h.width,height:h.height,flipY:!1});return this.colorTexture=v,v}},{key:"setColorTexture",value:function(a,s,u){this.key=this.getTextureKey(s,u),this.colorTexture=a}},{key:"destroy",value:function(){var a;(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"getColorRampBar",value:function(a,s){switch(a.type){case"cat":return Yr(a);case"quantize":return gn(a);case"custom":return vn(a,s);case"linear":return Or(a,s);default:return Er(a)}}},{key:"getTextureKey",value:function(a,s){var u;return"".concat(a.colors.join("_"),"_").concat(a==null||(u=a.positions)===null||u===void 0?void 0:u.join("_"),"_").concat(a.type,"_").concat(s==null?void 0:s.join("_"))}}]),n}(),Bw=["passes"],fm=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"],hm,pm,a1;function Nw(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=zw(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function zw(n,l){if(n){if(typeof n=="string")return o1(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o1(n,l)}}function o1(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function R5(n){var l=D5();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function D5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Uw=0,hg=(hm=Z_(Dt.IGlobalConfigService),pm=function(n){(0,zt.Z)(a,n);var l=R5(a);function a(){var s,u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,pt.Z)(this,a),s=l.call(this),(0,W.Z)((0,ut.Z)(s),"id","".concat(Uw++)),(0,W.Z)((0,ut.Z)(s),"name","".concat(Uw)),(0,W.Z)((0,ut.Z)(s),"visible",!0),(0,W.Z)((0,ut.Z)(s),"zIndex",0),(0,W.Z)((0,ut.Z)(s),"inited",!1),(0,W.Z)((0,ut.Z)(s),"layerModelNeedUpdate",!1),(0,W.Z)((0,ut.Z)(s),"pickedFeatureID",null),(0,W.Z)((0,ut.Z)(s),"selectedFeatureID",null),(0,W.Z)((0,ut.Z)(s),"styleNeedUpdate",!1),(0,W.Z)((0,ut.Z)(s),"forceRender",!1),(0,W.Z)((0,ut.Z)(s),"clusterZoom",0),(0,W.Z)((0,ut.Z)(s),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,W.Z)((0,ut.Z)(s),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,W.Z)((0,ut.Z)(s),"hooks",{init:new hO,afterInit:new My,beforeRender:new My,beforeRenderData:new Ph,afterRender:new Vp,beforePickingEncode:new Vp,afterPickingEncode:new Vp,beforeHighlight:new Vp(["pickedColor"]),afterHighlight:new Vp,beforeSelect:new Vp(["pickedColor"]),afterSelect:new Vp,beforeDestroy:new Vp,afterDestroy:new Vp}),(0,W.Z)((0,ut.Z)(s),"models",[]),(0,W.Z)((0,ut.Z)(s),"startInit",!1),(0,W.Z)((0,ut.Z)(s),"layerChildren",[]),(0,W.Z)((0,ut.Z)(s),"masks",[]),Rn((0,ut.Z)(s),"configService",a1,(0,ut.Z)(s)),(0,W.Z)((0,ut.Z)(s),"animateOptions",{enable:!1}),(0,W.Z)((0,ut.Z)(s),"currentPickId",null),(0,W.Z)((0,ut.Z)(s),"pendingStyleAttributes",[]),(0,W.Z)((0,ut.Z)(s),"scaleOptions",{}),(0,W.Z)((0,ut.Z)(s),"animateStatus",!1),(0,W.Z)((0,ut.Z)(s),"isDestroyed",!1),(0,W.Z)((0,ut.Z)(s),"encodeDataLength",0),(0,W.Z)((0,ut.Z)(s),"sourceEvent",function(){s.dataState.dataSourceNeedUpdate=!0;var h=s.getLayerConfig();h&&h.autoFit&&s.fitBounds(h.fitBoundsOptions);var v=s.layerSource.getSourceCfg().autoRender;v&&s.reRender()}),s.name=u.name||s.id,s.zIndex=u.zIndex||0,s.rawConfig=u,s}return(0,et.Z)(a,[{key:"addMaskLayer",value:function(u){this.masks.push(u)}},{key:"removeMaskLayer",value:function(u){var h=this.masks.indexOf(u);h>-1&&this.masks.splice(h,1),u.destroy()}},{key:"getAttribute",value:function(u){return this.styleAttributeService.getLayerStyleAttribute(u)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(u){var h=this;if(Object.keys(u).map(function(m){m in h.rawConfig&&(h.rawConfig[m]=u[m])}),!this.startInit)this.needUpdateConfig=(0,K.Z)((0,K.Z)({},this.needUpdateConfig),u);else{var v=this.container.get(Dt.SceneID);L5(u,this),this.configService.setLayerConfig(v,this.id,(0,K.Z)((0,K.Z)((0,K.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),u)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(u,h){this.container=u,this.sceneContainer=h}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(u){return this.plugins.push(u),this}},{key:"init",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v=this,m,w,A,R,B,G,j;return ot().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:m=this.container.get(Dt.SceneID),this.startInit=!0,this.configService.setLayerConfig(m,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Dt.IIconService),this.fontService=this.container.get(Dt.IFontService),this.rendererService=this.container.get(Dt.IRendererService),this.layerService=this.container.get(Dt.ILayerService),this.interactionService=this.container.get(Dt.IInteractionService),this.pickingService=this.container.get(Dt.IPickingService),this.mapService=this.container.get(Dt.IMapService),w=this.getLayerConfig(),A=w.enableMultiPassRenderer,R=w.passes,A&&R!==null&&R!==void 0&&R.length&&R.length>0&&this.mapService.on("mapAfterFrameChange",function(){v.renderLayers()}),this.cameraService=this.container.get(Dt.ICameraService),this.coordinateService=this.container.get(Dt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Dt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Dt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Dt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Dt.IStyleAttributeService),A&&(this.multiPassRenderer=this.container.get(Dt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(_t){var Zt=_t.attributeName,pe=_t.attributeField,fe=_t.attributeValues,Ze=_t.updateOptions;v.styleAttributeService.updateStyleAttribute(Zt,{scale:(0,K.Z)({field:pe},v.splitValuesAndCallbackInAttribute(fe,v.getLayerConfig()[Zt]))},Ze)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Dt.ILayerPlugin),B=Nw(this.plugins);try{for(B.s();!(G=B.n()).done;)j=G.value,j.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(_t){B.e(_t)}finally{B.f()}return this.layerPickService=new yo(this),this.textureService=new cm(this),ct.next=29,this.hooks.init.promise();case 29:this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 33:case"end":return ct.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"updateModelData",value:function(u){u.attributes&&u.elements?this.models.map(function(h){h.updateAttributesAndElements(u.attributes,u.elements)}):console.warn("data error")}},{key:"createModelData",value:function(u,h){var v;if((v=this.layerModel)!==null&&v!==void 0&&v.createModelData)return this.layerModel.createModelData(h);var m=this.calculateEncodeData(u,h),w=this.triangulation;return m&&w?this.styleAttributeService.createAttributesAndIndices(m,w):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(u){this.layerPickService=u}},{key:"calculateEncodeData",value:function(u,h){return this.inited?i1(this,this.fontService,this.mapService,this.styleAttributeService,u,h):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){this.updateLayerConfig((0,K.Z)((0,K.Z)((0,K.Z)({},this.getDefaultConfig()),this.rawConfig),this.needUpdateConfig));var u=this.getLayerConfig(),h=u.animateOption;h!=null&&h.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(u,h,v){return this.updateStyleAttribute("color",u,h,v),this}},{key:"texture",value:function(u,h,v){return this.updateStyleAttribute("texture",u,h,v),this}},{key:"rotate",value:function(u,h,v){return this.updateStyleAttribute("rotate",u,h,v),this}},{key:"size",value:function(u,h,v){return this.updateStyleAttribute("size",u,h,v),this}},{key:"filter",value:function(u,h,v){var m=this.updateStyleAttribute("filter",u,h,v);return this.dataState.dataSourceNeedUpdate=m,this}},{key:"shape",value:function(u,h,v){this.shapeOption={field:u,values:h};var m=this.updateStyleAttribute("shape",u,h,v);return this.dataState.dataSourceNeedUpdate=m,this}},{key:"label",value:function(u,h,v){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:u,attributeValues:h,updateOptions:v}),this}},{key:"animate",value:function(u){var h={};return(0,ne.isObject)(u)?(h.enable=!0,h=(0,K.Z)((0,K.Z)({},h),u)):h.enable=u,this.updateLayerConfig({animateOption:h}),this}},{key:"source",value:function(u,h){return(u==null?void 0:u.type)==="source"?(this.setSource(u),this):(this.sourceOption={data:u,options:h},this.clusterZoom=0,this)}},{key:"setData",value:function(u,h){var v=this;return this.inited?this.layerSource.setData(u,h):this.on("inited",function(){var m=v.getSource();m?v.layerSource.setData(u,h):v.source(new M0(u,h))}),this}},{key:"style",value:function(u){var h=this,v=u.passes,m=(0,ql.Z)(u,Bw);return v&&Dw(v).forEach(function(w){var A=h.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(w[0]);A&&A.updateOptions(w[1])}),this.rawConfig=(0,K.Z)((0,K.Z)({},this.rawConfig),m),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(u,h){var v=(0,K.Z)({},this.scaleOptions);if((0,ne.isObject)(u)?this.scaleOptions=(0,K.Z)((0,K.Z)({},this.scaleOptions),u):this.scaleOptions[u]=h,this.styleAttributeService&&!(0,ne.isEqual)(v,this.scaleOptions)){var m=(0,ne.isObject)(u)?u:(0,W.Z)({},u,h);this.styleAttributeService.updateScaleAttribute(m)}return this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(),this))}},{key:"renderMultiPass",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){m.next=2;break}return m.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){m.next=7;break}return m.next=5,this.multiPassRenderer.render();case 5:m.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"active",value:function(u){var h={};return h.enableHighlight=(0,ne.isObject)(u)?!0:u,(0,ne.isObject)(u)?(h.enableHighlight=!0,u.color&&(h.highlightColor=u.color),u.mix&&(h.activeMix=u.mix)):h.enableHighlight=!!u,this.updateLayerConfig(h),this}},{key:"setActive",value:function(u,h){var v=this;if((0,ne.isObject)(u)){var m=u.x,w=m===void 0?0:m,A=u.y,R=A===void 0?0:A;this.updateLayerConfig({highlightColor:(0,ne.isObject)(h)?h.color:this.getLayerConfig().highlightColor,activeMix:(0,ne.isObject)(h)?h.mix:this.getLayerConfig().activeMix}),this.pick({x:w,y:R})}else this.updateLayerConfig({pickedFeatureID:u,highlightColor:(0,ne.isObject)(h)?h.color:this.getLayerConfig().highlightColor,activeMix:(0,ne.isObject)(h)?h.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(er(u)).then(function(){setTimeout(function(){v.reRender()},1)})}},{key:"select",value:function(u){var h={};return h.enableSelect=(0,ne.isObject)(u)?!0:u,(0,ne.isObject)(u)?(h.enableSelect=!0,u.color&&(h.selectColor=u.color),u.mix&&(h.selectMix=u.mix)):h.enableSelect=!!u,this.updateLayerConfig(h),this}},{key:"setSelect",value:function(u,h){var v=this;if((0,ne.isObject)(u)){var m=u.x,w=m===void 0?0:m,A=u.y,R=A===void 0?0:A;this.updateLayerConfig({selectColor:(0,ne.isObject)(h)?h.color:this.getLayerConfig().selectColor,selectMix:(0,ne.isObject)(h)?h.mix:this.getLayerConfig().selectMix}),this.pick({x:w,y:R})}else this.updateLayerConfig({pickedFeatureID:u,selectColor:(0,ne.isObject)(h)?h.color:this.getLayerConfig().selectColor,selectMix:(0,ne.isObject)(h)?h.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(er(u)).then(function(){setTimeout(function(){v.reRender()},1)})}},{key:"setBlend",value:function(u){return this.updateLayerConfig({blend:u}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(u){return this.zIndex=u,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(u){this.currentPickId=u}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(u){this.selectedFeatureID=u}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var u=this.mapService.getZoom(),h=this.getLayerConfig(),v=h.visible,m=h.minZoom,w=m===void 0?-1/0:m,A=h.maxZoom,R=A===void 0?1/0:A;return!!v&&u>=w&&u<R}},{key:"setMultiPass",value:function(u,h){if(this.updateLayerConfig({enableMultiPassRenderer:u}),h&&this.updateLayerConfig({passes:h}),u){var v=this.getLayerConfig(),m=v.passes,w=m===void 0?[]:m;this.multiPassRenderer=Ex(this,w,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var A=this.rendererService.getViewportSize(),R=A.width,B=A.height;this.multiPassRenderer.resize(R,B)}return this}},{key:"setMinZoom",value:function(u){return this.updateLayerConfig({minZoom:u}),this}},{key:"getMinZoom",value:function(){var u=this.getLayerConfig(),h=u.minZoom;return h}},{key:"getMaxZoom",value:function(){var u=this.getLayerConfig(),h=u.maxZoom;return h}},{key:"get",value:function(u){var h=this.getLayerConfig();return h[u]}},{key:"setMaxZoom",value:function(u){return this.updateLayerConfig({maxZoom:u}),this}},{key:"setAutoFit",value:function(u){return this.updateLayerConfig({autoFit:u}),this}},{key:"fitBounds",value:function(u){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var h=this.getSource(),v=h.extent,m=v.some(function(w){return Math.abs(w)===1/0});return m?this:(this.mapService.fitBounds([[v[0],v[1]],[v[2],v[3]]],u),this)}},{key:"destroy",value:function(){var u,h,v,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isDestroyed||(this.layerChildren.map(function(w){return w.destroy(!1)}),this.layerChildren=[],this.masks.map(function(w){return w.destroy(!1)}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(u=this.multiPassRenderer)===null||u===void 0||u.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(h=this.layerModel)===null||h===void 0||h.clearModels(m),(v=this.tileLayer)===null||v===void 0||v.destroy(),this.models=[],this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var u;this.models.forEach(function(h){return h.destroy()}),(u=this.layerModel)===null||u===void 0||u.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(u){return u.needRescale||u.needRemapping||u.needRegenerateVertices}).length}},{key:"setSource",value:function(u){var h=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=u,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var v=this.mapService.getZoom();this.layerSource.updateClusterData(v)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(m){var w=m.type;if(h.coordCenter===void 0){var A,R=h.layerSource.center;h.coordCenter=R,(A=h.mapService)!==null&&A!==void 0&&A.setCoordCenter&&h.mapService.setCoordCenter(R)}w==="update"&&h.sourceEvent()})}},{key:"initSource",value:function(u){this.layerSource=u,this.clusterZoom=0,this.addSourceEvent()}},{key:"getSource",value:function(){return this.layerSource}},{key:"addSourceEvent",value:function(){var u=this;this.layerSource.on("update",function(){if(u.coordCenter===void 0){var h,v=u.layerSource.center;u.coordCenter=v,(h=u.mapService)!==null&&h!==void 0&&h.setCoordCenter&&u.mapService.setCoordCenter(v)}u.sourceEvent()})}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(u){this.encodedData=u,this.encodeDataLength=u.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(u){return this.styleAttributeService.getLayerAttributeScale(u)}},{key:"getLegend",value:function(u){var h,v,m,w=this.styleAttributeService.getLayerStyleAttribute(u),A=(w==null||(h=w.scale)===null||h===void 0?void 0:h.scalers)||[];return{type:(v=A[0].option)===null||v===void 0?void 0:v.type,field:w==null||(m=w.scale)===null||m===void 0?void 0:m.field,items:this.getLegendItems(u)}}},{key:"getLegendItems",value:function(u){var h=this.styleAttributeService.getLayerAttributeScale(u);if(!h)return[];if(h.invertExtent){var v=h.range().map(function(A){return(0,W.Z)({value:h.invertExtent(A)},u,A)});return v}else if(h.ticks){var m=h.ticks().map(function(A){return(0,W.Z)({value:A},u,h(A))});return m}else if(h!=null&&h.domain){var w=h.domain().filter(function(A){return!(0,ne.isUndefined)(A)}).map(function(A){return(0,W.Z)({value:A},u,h(A))});return w}return[]}},{key:"pick",value:function(u){var h=u.x,v=u.y;this.interactionService.triggerHover({x:h,y:v})}},{key:"boxSelect",value:function(u,h){this.pickingService.boxPickLayer(this,u,h)}},{key:"buildLayerModel",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m=this,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze,Qe;return ot().wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:return w=v.moduleName,A=v.vertexShader,R=v.fragmentShader,B=v.triangulation,G=v.segmentNumber,j=v.workerEnabled,lt=j===void 0?!1:j,ct=v.workerOptions,_t=(0,ql.Z)(v,fm),this.shaderModuleService.registerModule(w,{vs:A,fs:R}),Zt=this.shaderModuleService.getModule(w),pe=Zt.vs,fe=Zt.fs,Ze=Zt.uniforms,Qe=this.rendererService.createModel,Lr.abrupt("return",new Promise(function(Vr,Wr){if(ct&&ct.modelType in Xh&&lt)m.styleAttributeService.createAttributesAndIndicesAscy(m.encodedData,G,ct).then(function(zo){var zs=zo.attributes,cu=zo.elements,Xu=Qe((0,K.Z)({attributes:zs,uniforms:Ze,fs:fe,vs:pe,elements:cu,blend:Pw[cp.normal]},_t));Vr(Xu)}).catch(function(zo){return Wr(zo)});else{var bn=m.styleAttributeService.createAttributesAndIndices(m.encodedData,B,G),hn=bn.attributes,Wn=bn.elements,vi=bn.count,$i=(0,K.Z)({attributes:hn,uniforms:Ze,fs:fe,vs:pe,elements:Wn,blend:Pw[cp.normal]},_t);vi&&($i.count=vi);var go=Qe($i);Vr(go)}}));case 5:case"end":return Lr.stop()}},h,this)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"createAttributes",value:function(u){var h=u.triangulation,v=this.styleAttributeService.createAttributes(this.encodedData,h),m=v.attributes;return m}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(u){var h=this.getLayerConfig(),v=h.enableHighlight,m=v===void 0?!0:v,w=h.enableSelect,A=w===void 0?!0:w,R=this.eventNames().indexOf(u)!==-1||this.eventNames().indexOf("un"+u)!==-1;return(u==="click"||u==="dblclick")&&A&&(R=!0),u==="mousemove"&&(m||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(R=!0),this.isVisible()&&R}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return m.stop()}},h)}));function u(){return s.apply(this,arguments)}return u}()},{key:"rebuildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"renderMulPass",value:function(){var s=(0,J.Z)(ot().mark(function h(v){return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,v.render();case 2:case"end":return w.stop()}},h)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"renderModels",value:function(u){var h=this;return this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(v){v.draw({uniforms:h.layerModel.getUninforms()},u)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(u,h,v,m){var w=this.configService.getAttributeConfig(this.id)||{};return(0,ne.isEqual)(w[u],{field:h,values:v})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(u)!==-1&&this.configService.setAttributeConfig(this.id,(0,W.Z)({},u,{field:h,values:v})),this.startInit?this.styleAttributeService.updateStyleAttribute(u,{scale:(0,K.Z)({field:h},this.splitValuesAndCallbackInAttribute(v,this.getLayerConfig()[h]))},m):this.pendingStyleAttributes.push({attributeName:u,attributeField:h,attributeValues:v,updateOptions:m}),!0)}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(u){console.warn("empty fn")}},{key:"processData",value:function(u){return u}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.models.forEach(function(w){return w.destroy()}),this.models=[],m.next=4,this.layerModel.initModels();case 4:this.models=m.sent;case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(u,h){return{values:(0,ne.isFunction)(u)?void 0:u||h,callback:(0,ne.isFunction)(u)?u:void 0}}}]),a}(Ee.EventEmitter),a1=Fi(pm.prototype,"configService",[hm],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pm),Zw,Sx,Vw;function B5(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=N5(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function N5(n,l){if(n){if(typeof n=="string")return Gw(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Gw(n,l)}}function Gw(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Vo=(Zw=Z_(Dt.IGlobalConfigService),Sx=function(){function n(l){(0,pt.Z)(this,n),Rn(this,"configService",Vw,this),this.layer=l,this.rendererService=l.getContainer().get(Dt.IRendererService),this.pickingService=l.getContainer().get(Dt.IPickingService),this.shaderModuleService=l.getContainer().get(Dt.IShaderModuleService),this.styleAttributeService=l.getContainer().get(Dt.IStyleAttributeService),this.mapService=l.getContainer().get(Dt.IMapService),this.iconService=l.getContainer().get(Dt.IIconService),this.fontService=l.getContainer().get(Dt.IFontService),this.cameraService=l.getContainer().get(Dt.ICameraService),this.layerService=l.getContainer().get(Dt.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var a=this.rendererService.createTexture2D;this.createTexture2D=a,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:se.NEAREST,min:se.NEAREST,width:1,height:1}))}return(0,et.Z)(n,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(a){var s=!1;return(0,ne.isEqual)(a.thetaOffset,this.cacheStyleProperties.thetaOffset)||(s=!0,this.cacheStyleProperties.thetaOffset=a.thetaOffset),(0,ne.isEqual)(a.opacity,this.cacheStyleProperties.opacity)||(s=!0,this.cacheStyleProperties.opacity=a.opacity),(0,ne.isEqual)(a.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(s=!0,this.cacheStyleProperties.strokeOpacity=a.strokeOpacity),(0,ne.isEqual)(a.strokeWidth,this.cacheStyleProperties.strokeWidth)||(s=!0,this.cacheStyleProperties.strokeWidth=a.strokeWidth),(0,ne.isEqual)(a.stroke,this.cacheStyleProperties.stroke)||(s=!0,this.cacheStyleProperties.stroke=a.stroke),(0,ne.isEqual)(a.offsets,this.cacheStyleProperties.offsets)||(s=!0,this.cacheStyleProperties.offsets=a.offsets),this.dataTexture===void 0&&(s=!0),s}},{key:"judgeStyleAttributes",value:function(a){this.clearLastCalRes(),a.opacity!==void 0&&!(0,ne.isNumber)(a.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),a.strokeOpacity!==void 0&&!(0,ne.isNumber)(a.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),a.strokeWidth!==void 0&&!(0,ne.isNumber)(a.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),a.stroke!==void 0&&!this.isStaticColor(a.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),a.offsets!==void 0&&!this.isOffsetStatic(a.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),a.thetaOffset!==void 0&&!(0,ne.isNumber)(a.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(a){return(0,ne.isString)(a)?!!oc(a):!1}},{key:"getStrokeColor",value:function(a){if(this.isStaticColor(a)){var s=$e(a);return s[0]=s[0]?s[0]:0,s[1]=s[1]?s[1]:0,s[2]=s[2]?s[2]:0,s[3]=s[3]?s[3]:0,s}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(a){return!!(Array.isArray(a)&&a.length===2&&(0,ne.isNumber)(a[0])&&(0,ne.isNumber)(a[1]))}},{key:"patchMod",value:function(a,s){for(var u=0;u<s;u++)a.push(-1)}},{key:"patchData",value:function(a,s,u){var h=B5(u),v;try{for(h.s();!(v=h.n()).done;){var m=v.value,w=m.attr,A=m.count,R=s[w];R!==void 0?w==="stroke"?a.push.apply(a,(0,ve.Z)($e(R))):w==="offsets"?this.isOffsetStatic(R)?a.push(-R[0],R[1]):a.push(0,0):a.push((0,ne.isNumber)(R)?R:1):this.patchMod(a,A)}}catch(B){h.e(B)}finally{h.f()}}},{key:"calDataFrame",value:function(a,s,u){for(var h=s.length,v=Math.ceil(h*a/this.DATA_TEXTURE_WIDTH),m=v*this.DATA_TEXTURE_WIDTH,w=[],A=0;A<h;A++){var R=s[A];this.patchData(w,R,u)}for(var B=w.length;B<m;B++)w.push(-1);return{data:w,width:this.DATA_TEXTURE_WIDTH,height:v}}},{key:"getBlend",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,u=s===void 0?"normal":s;return Pw[cp[u]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var l=(0,J.Z)(ot().mark(function s(){return ot().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",!1);case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var l=(0,J.Z)(ot().mark(function s(){return ot().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var l=(0,J.Z)(ot().mark(function s(){return ot().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.duration||4,a.interval||.2,a.trailLength||.1]}},{key:"startModelAnimate",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption;s.enable&&this.layer.setAnimateStartTime()}}]),n}(),Vw=Fi(Sx.prototype,"configService",[Zw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sx),jd=100,Ol=36,lu=40;function ds(n){return n/180*Math.acos(-1)}function Go(n){var l=ds(n[0])+Math.PI/2,a=ds(n[1]),s=jd+Math.random()*.4,u=s*Math.cos(a)*Math.cos(l),h=s*Math.cos(a)*Math.sin(l),v=s*Math.sin(a);return[h,v,u]}function I0(n,l){var a=mat4.create(),s=mat4.create(),u=vec3.fromValues(0,1,0),h=vec3.fromValues(0,0,0);l=l||{},n=typeof n!="undefined"?n:1;for(var v=typeof l.segments!="undefined"?l.segments:32,m=2+v,w=2*m,A=[],R=[],B=[],G=[],j=[],lt=[],ct=0;ct<=m;ct++){for(var _t=ct/m,Zt=_t*Math.PI,pe=0;pe<=w;pe++){var fe=pe/w,Ze=fe*Math.PI*2;mat4.identity(s),mat4.rotateZ(s,s,-Zt),mat4.identity(a),mat4.rotateY(a,a,Ze),vec3.transformMat4(h,u,s),vec3.transformMat4(h,h,a),vec3.scale(h,h,-n),B.push(h.slice()),G.push.apply(G,_toConsumableArray(h.slice())),vec3.normalize(h,h),j.push.apply(j,_toConsumableArray(h.slice())),lt.push([fe,1-_t]),G.push(fe,1-_t)}if(ct>0)for(var Qe=B.length,wr=Qe-2*(w+1);wr+w+2<Qe;wr++)A.push([wr,wr+1,wr+w+1]),R.push(wr,wr+1,wr+w+1),A.push([wr+w+1,wr+1,wr+w+2]),R.push(wr+w+1,wr+1,wr+w+2)}return{cells:A,positions:B,uvs:lt,positionsArr:G,indicesArr:R,normalArr:j}}var Fv=ei.Ue(),Hw=ei.Ue(),So=ei.Ue(),ms=ei.Ue(),Oh=ei.Ue();function s1(n,l,a,s,u){ei.IH(n,a,s),ei.Fv(n,n),l=ei.al(-n[1],n[0]);var h=ei.al(-a[1],a[0]);return[u/ei.AK(l,h),l]}function Wd(n,l){return ei.t8(n,-l[1],l[0])}function dm(n,l,a){return ei.lu(n,l,a),ei.Fv(n,n),n}function pg(n,l){return n[0]===l[0]&&n[1]===l[1]}function z5(n){for(var l=new Map,a=0;a<n.length;a++){var s=n[0].toString()+"-"+n[1].toString();l.get(s)?(n.splice(a,1),a++):l.set(s,s)}return n}var u1=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,pt.Z)(this,n),(0,W.Z)(this,"lastFlip",-1),(0,W.Z)(this,"miter",ei.al(0,0)),(0,W.Z)(this,"started",!1),(0,W.Z)(this,"dash",!1),(0,W.Z)(this,"totalDistance",0),(0,W.Z)(this,"currentIndex",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,et.Z)(n,[{key:"simpleExtrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var u=a.length,h=s.startIndex,v=1;v<u;v++){var m=a[v-1],w=a[v],A=v<a.length-1?a[v+1]:null,R=this.simpleSegment(s,h,m,w,A);h+=R}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleExtrude_gaode2",value:function(a,s){var u=this.complex;if(a.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=u.startIndex,m=1;m<h;m++){var w,A,R,B=a[m-1];B.push((w=s[m-1][2])!==null&&w!==void 0?w:0);var G=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var lt=s[m],ct=m<a.length-1?[].concat((0,ve.Z)(a[m+1]),[(R=s[m+1][2])!==null&&R!==void 0?R:0]):null,_t=m<s.length-1?s[m+1]:null,Zt=this.simpleSegment(u,v,B,j,ct,G,lt,_t);v+=Zt}if(this.dash)for(var pe=0;pe<u.positions.length/6;pe++)u.positions[pe*6+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"extrude_gaode2",value:function(a,s){var u=this.complex;if(a.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=u.startIndex,m=1;m<h;m++){var w,A,R,B=a[m-1];B.push((w=s[m-1][2])!==null&&w!==void 0?w:0);var G=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var lt=s[m],ct=m<a.length-1?[].concat((0,ve.Z)(a[m+1]),[(R=s[m+1][2])!==null&&R!==void 0?R:0]):null,_t=m<s.length-1?s[m+1]:null,Zt=this.segment_gaode2(u,v,B,j,ct,G,lt,_t);v+=Zt}if(this.dash)for(var pe=0;pe<u.positions.length/6;pe++)u.positions[pe*6+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"extrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var u=a.length,h=s.startIndex,v=1;v<u;v++){var m=a[v-1],w=a[v],A=v<a.length-1?a[v+1]:null,R=this.segment(s,h,m,w,A);h+=R}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleSegment",value:function(a,s,u,h,v){var m=0,w=a.indices,A=a.positions,R=a.normals,B=mo([h[0],h[1]]),G=mo([u[0],u[1]]);dm(So,B,G);var j=0;if(this.dash&&(j=this.lineSegmentDistance(B,G),this.totalDistance+=j),this.normal||(this.normal=ei.Ue(),Wd(this.normal,So)),this.started||(this.started=!0,this.extrusions(A,R,u,this.normal,this.thickness,this.totalDistance-j)),w.push(s+0,s+1,s+2),!v)Wd(this.normal,So),this.extrusions(A,R,h,this.normal,this.thickness,this.totalDistance),w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2;else{var lt=mo([v[0],v[1]]);pg(B,lt)&&ei.IH(lt,B,ei.Fv(lt,ei.$X(lt,B,G))),dm(ms,lt,B);var ct=s1(Oh,ei.Ue(),So,ms,this.thickness),_t=(0,yt.Z)(ct,2),Zt=_t[0],pe=_t[1],fe=ei.AK(Oh,this.normal)<0?-1:1;this.extrusions(A,R,h,pe,Zt,this.totalDistance),w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fe=-1,ei.JG(this.normal,pe),m+=2,this.lastFlip=fe}return m}},{key:"segment_gaode2",value:function(a,s,u,h,v,m,w,A){var R=0,B=a.indices,G=a.positions,j=a.normals,lt=this.cap==="square",ct=this.join==="bevel",_t=mo([w[0],w[1]]),Zt=mo([m[0],m[1]]);dm(So,h,u);var pe=0;if(this.dash&&(pe=this.lineSegmentDistance(_t,Zt),this.totalDistance+=pe),this.normal||(this.normal=ei.Ue(),Wd(this.normal,So)),!this.started)if(this.started=!0,lt){var fe=ei.Ue(),Ze=ei.Ue();ei.IH(fe,this.normal,So),ei.IH(Ze,this.normal,So),j.push(Ze[0],Ze[1],0),j.push(fe[0],fe[1],0),G.push(u[0],u[1],u[2]|0,this.totalDistance-pe,-this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),G.push(u[0],u[1],u[2]|0,this.totalDistance-pe,this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(G,j,u,this.normal,this.thickness,this.totalDistance-pe);if(B.push(s+0,s+1,s+2),v){pg(h,v)&&ei.IH(v,h,ei.Fv(v,ei.$X(v,h,u))),dm(ms,v,h);var Lr=s1(Oh,ei.Ue(),So,ms,this.thickness),Vr=(0,yt.Z)(Lr,2),Wr=Vr[0],bn=Vr[1],hn=ei.AK(Oh,this.normal)<0?-1:1,Wn=ct;if(!Wn&&this.join==="miter"){var vi=Wr;vi>this.miterLimit&&(Wn=!0)}Wn?(j.push(this.normal[0],this.normal[1],0),j.push(bn[0],bn[1],0),G.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*hn,h[2]|0),this.complex.indexes.push(this.currentIndex),G.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*hn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,B.push.apply(B,(0,ve.Z)(this.lastFlip!==-hn?[s,s+2,s+3]:[s+2,s+1,s+3])),B.push(s+2,s+3,s+4),Wd(Fv,ms),ei.JG(this.normal,Fv),j.push(this.normal[0],this.normal[1],0),G.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*hn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,R+=3):(this.extrusions(G,j,h,bn,Wr,this.totalDistance),B.push.apply(B,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),hn=-1,ei.JG(this.normal,bn),R+=2),this.lastFlip=hn}else{if(Wd(this.normal,So),lt){var Qe=ei.Ue(),wr=ei.Ue();ei.lu(wr,So,this.normal),ei.IH(Qe,So,this.normal),j.push(wr[0],wr[1],0),j.push(Qe[0],Qe[1],0),G.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),G.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(G,j,h,this.normal,this.thickness,this.totalDistance);B.push.apply(B,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),R+=2}return R}},{key:"segment",value:function(a,s,u,h,v){var m=0,w=a.indices,A=a.positions,R=a.normals,B=this.cap==="square",G=this.join==="bevel",j=mo([h[0],h[1]]),lt=mo([u[0],u[1]]);dm(So,j,lt);var ct=0;if(this.dash&&(ct=this.lineSegmentDistance(j,lt),this.totalDistance+=ct),this.normal||(this.normal=ei.Ue(),Wd(this.normal,So)),!this.started)if(this.started=!0,B){var _t=ei.Ue(),Zt=ei.Ue();ei.IH(_t,this.normal,So),ei.IH(Zt,this.normal,So),R.push(Zt[0],Zt[1],0),R.push(_t[0],_t[1],0),A.push(u[0],u[1],u[2]|0,this.totalDistance-ct,-this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),A.push(u[0],u[1],u[2]|0,this.totalDistance-ct,this.thickness,u[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,R,u,this.normal,this.thickness,this.totalDistance-ct);if(w.push(s+0,s+1,s+2),v){var Ze=mo([v[0],v[1]]);pg(j,Ze)&&ei.IH(Ze,j,ei.Fv(Ze,ei.$X(Ze,j,lt))),dm(ms,Ze,j);var Qe=s1(Oh,ei.Ue(),So,ms,this.thickness),wr=(0,yt.Z)(Qe,2),Lr=wr[0],Vr=wr[1],Wr=ei.AK(Oh,this.normal)<0?-1:1,bn=G;if(!bn&&this.join==="miter"){var hn=Lr;hn>this.miterLimit&&(bn=!0)}bn?(R.push(this.normal[0],this.normal[1],0),R.push(Vr[0],Vr[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Wr,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*Wr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,w.push.apply(w,(0,ve.Z)(this.lastFlip!==-Wr?[s,s+2,s+3]:[s+2,s+1,s+3])),w.push(s+2,s+3,s+4),Wd(Fv,ms),ei.JG(this.normal,Fv),R.push(this.normal[0],this.normal[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Wr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,m+=3):(this.extrusions(A,R,h,Vr,Lr,this.totalDistance),w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),Wr=-1,ei.JG(this.normal,Vr),m+=2),this.lastFlip=Wr}else{if(Wd(this.normal,So),B){var pe=ei.Ue(),fe=ei.Ue();ei.lu(fe,So,this.normal),ei.IH(pe,So,this.normal),R.push(fe[0],fe[1],0),R.push(pe[0],pe[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,R,h,this.normal,this.thickness,this.totalDistance);w.push.apply(w,(0,ve.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2}return m}},{key:"extrusions",value:function(a,s,u,h,v,m){s.push(h[0],h[1],0),s.push(h[0],h[1],0),a.push(u[0],u[1],u[2]|0,m,-v,u[2]|0),this.complex.indexes.push(this.currentIndex),a.push(u[0],u[1],u[2]|0,m,v,u[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(a,s){var u=s[0]-a[0],h=s[1]-a[1];return Math.sqrt(u*u+h*h)}}]),n}(),Co=nt(68072);function YO(n){var l=n[0][0],a=n[0][n[0].length-1];l[0]===a[0]&&l[1]===a[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var s=n[0].length,u=earcut.flatten(n),h=u.vertices,v=u.dimensions,m=[],w=[],A=0;A<h.length/v;A++)v===2?m.push(h[A*2],h[A*2+1],1):m.push(h[A*3],h[A*3+1],1);var R=earcut(u.vertices,u.holes,u.dimensions);w.push.apply(w,_toConsumableArray(R));for(var B=function(lt){var ct=u.vertices.slice(lt*v,(lt+1)*v),_t=u.vertices.slice((lt+1)*v,(lt+2)*v);_t.length===0&&(_t=u.vertices.slice(0,v));var Zt=m.length/3;m.push(ct[0],ct[1],1,_t[0],_t[1],1,ct[0],ct[1],0,_t[0],_t[1],0),w.push.apply(w,_toConsumableArray([0,2,1,2,3,1].map(function(pe){return pe+Zt})))},G=0;G<s;G++)B(G);return{positions:m,index:w}}function dp(n){var l=earcut.flatten(n),a=earcut(l.vertices,l.holes,l.dimensions);return{positions:l.vertices,index:a}}function vm(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=n[0][0],s=n[0][n[0].length-1];a[0]===s[0]&&a[1]===s[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var u=n[0].length,h=rh().flatten(n),v=h.vertices,m=h.dimensions,w=[],A=[],R=[],B=0;B<v.length/m;B++)m===2?w.push(v[B*2],v[B*2+1],1,-1,-1):w.push(v[B*3],v[B*3+1],1,-1,-1),R.push(0,0,1);var G=rh()(h.vertices,h.holes,h.dimensions);A.push.apply(A,(0,ve.Z)(G));for(var j=function(_t){var Zt=h.vertices.slice(_t*m,(_t+1)*m),pe=h.vertices.slice((_t+1)*m,(_t+2)*m);pe.length===0&&(pe=h.vertices.slice(0,m));var fe=w.length/5;w.push(Zt[0],Zt[1],1,0,0,pe[0],pe[1],1,.1,0,Zt[0],Zt[1],0,0,.8,pe[0],pe[1],0,.1,.8);var Ze=dg([pe[0],pe[1],1],[Zt[0],Zt[1],0],[Zt[0],Zt[1],1],l);R.push.apply(R,(0,ve.Z)(Ze).concat((0,ve.Z)(Ze),(0,ve.Z)(Ze),(0,ve.Z)(Ze))),A.push.apply(A,(0,ve.Z)([1,2,0,3,2,1].map(function(Qe){return Qe+fe})))},lt=0;lt<u;lt++)j(lt);return{positions:w,index:A,normals:R}}function dg(n,l,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=Co.create(),h=Co.create(),v=Co.create();s&&(n=bf(n),l=bf(l),a=bf(a));var m=Co.fromValues.apply(Co,(0,ve.Z)(n)),w=Co.fromValues.apply(Co,(0,ve.Z)(l)),A=Co.fromValues.apply(Co,(0,ve.Z)(a));Co.sub(u,A,w),Co.sub(h,m,w),Co.cross(v,u,h);var R=Co.create();return Co.normalize(R,v),R}var Ru,Xp;(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"})(Xp||(Xp={}));var Rv;(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"})(Rv||(Rv={}));function gm(n){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Math.PI*2/n,s=[],u=0;u<n;u++)s.push(a*u+l*Math.PI/12);var h=s.map(function(v){var m=Math.sin(v+Math.PI/4),w=Math.cos(v+Math.PI/4);return[m,w,0]});return h}function pc(){return gm(30)}function k0(){return gm(4)}function Bf(){return gm(3)}function mm(){return gm(6,1)}function l1(){return gm(5)}var Cx=(Ru={},(0,W.Z)(Ru,Rv.CIRCLE,pc),(0,W.Z)(Ru,Rv.HEXAGON,mm),(0,W.Z)(Ru,Rv.TRIANGLE,Bf),(0,W.Z)(Ru,Rv.SQUARE,k0),(0,W.Z)(Ru,Rv.PENTAGON,l1),(0,W.Z)(Ru,Xp.CYLINDER,pc),(0,W.Z)(Ru,Xp.HEXAGONCOLUMN,mm),(0,W.Z)(Ru,Xp.TRIANGLECOLUMN,Bf),(0,W.Z)(Ru,Xp.SQUARECOLUMN,k0),(0,W.Z)(Ru,Xp.PENTAGONCOLUMN,l1),Ru),c1={};function ym(n){var l=zl(n.coordinates);return{vertices:[].concat((0,ve.Z)(l),(0,ve.Z)(l),(0,ve.Z)(l),(0,ve.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function Ax(n){var l=zl(n.coordinates),a=Go(l);return{vertices:[].concat((0,ve.Z)(a),(0,ve.Z)(a),(0,ve.Z)(a),(0,ve.Z)(a)),indices:[0,1,2,2,3,0],size:a.length}}function Ka(n){var l=n.shape,a=V5(l,!1),s=a.positions,u=a.index,h=a.normals;return{vertices:s,indices:u,normals:h,size:5}}function jw(n){var l=zl(n.coordinates);return{vertices:(0,ve.Z)(l),indices:[0],size:l.length}}function _m(n){var l=n.coordinates,a=n.originCoordinates,s=n.version,u=new u1({dash:!0,join:"bevel"});if(s==="GAODE2.x"){var h=l;Array.isArray(h[0][0])||(h=[l]);var v=a;Array.isArray(v[0][0])||(v=[a]);for(var m=0;m<h.length;m++){var w=h[m],A=v[m];u.extrude_gaode2(w,A)}}else{var R=l;R[0]&&!Array.isArray(R[0][0])&&(R=[l]),R.forEach(function(G){u.extrude(G)})}var B=u.complex;return{vertices:B.positions,indices:B.indices,normals:B.normals,indexes:B.indexes,size:6}}function xm(n){var l=n.coordinates,a=[];if(!Array.isArray(l[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var s=Ww(l),u=s.results,h=s.totalDistance;return u.map(function(v){a.push(v[0],v[1],v[2],v[3],0,h)}),{vertices:a,indices:[],normals:[],size:6,count:u.length}}function $O(n){var l=n.coordinates,a=[];if(!Array.isArray(l[0]))return{vertices:[],indices:[],size:4,count:0};var s=Xw(l),u=s.results;return u.map(function(h){a.push(h[0],h[1],h[2],h[3])}),{vertices:a,indices:[],size:4,count:u.length}}function bm(n,l){var a=l[0]-n[0],s=l[1]-n[1];return Math.sqrt(a*a+s*s)}function vg(n,l){return n.length<3&&n.push(0),l!==void 0&&n.push(l),n}function Ww(n){var l=n;Array.isArray(l)&&Array.isArray(l[0])&&Array.isArray(l[0][0])&&(l=n.flat());var a=0;if(l.length<2)return{results:l,totalDistance:0};var s=[],u=vg(l[0],a);s.push(u);for(var h=1;h<l.length-1;h++){var v=bm(l[h-1],l[h]);a+=v;var m=vg(l[h],a);s.push(m),s.push(m)}var w=bm(l[l.length-2],l[l.length-1]);return a+=w,s.push(vg(l[l.length-1],a)),{results:s,totalDistance:a}}function Xw(n){if(n.length<2)return{results:n};var l=[],a=vg(n[0]);l.push(a);for(var s=1;s<n.length-1;s++){var u=vg(n[s]);l.push(u),l.push(u)}return l.push(vg(n[n.length-1])),{results:l}}function Tx(n){var l=n.coordinates,a=rh().flatten(l),s=a.vertices,u=a.dimensions,h=a.holes;return{indices:rh()(s,h,u),vertices:s,size:u}}function U5(n){var l=n.coordinates,a=rh().flatten(l),s=a.vertices,u=a.dimensions,h=a.holes;return{indices:rh()(s,h,u),vertices:Yw(s),size:u+4}}function Yw(n){for(var l=[],a=Do(n),s=a.center,u=a.radius,h=0;h<n.length;h+=2){var v=n[h],m=n[h+1];l.push.apply(l,[v,m,0].concat((0,ve.Z)(s),[u]))}return l}function Z5(n){var l=n.coordinates,a=vm(l,!0),s=a.positions,u=a.index,h=a.normals;return{vertices:s,indices:u,normals:h,size:5}}function qO(n){var l=n.shape,a=H5(l),s=a.positions,u=a.index;return{vertices:s,indices:u,size:3}}function f1(n){var l=n.coordinates,a=[].concat((0,ve.Z)(l[0]),[0,0,1,l[1][0],l[0][1],0,1,1],(0,ve.Z)(l[1]),[0,1,0],(0,ve.Z)(l[0]),[0,0,1],(0,ve.Z)(l[1]),[0,1,0,l[0][0],l[1][1],0,0,0]),s=[0,1,2,3,4,5];return{vertices:a,indices:s,size:5}}function Em(n,l){for(var a=l||30,s=n.coordinates,u=[],h=[],v=function(A){u.push(A,1,A,s[0][0],s[0][1],s[1][0],s[1][1],A,-1,A,s[0][0],s[0][1],s[1][0],s[1][1]),A!==a-1&&h.push.apply(h,(0,ve.Z)([0,1,2,1,3,2].map(function(R){return A*2+R})))},m=0;m<a;m++)v(m);return{vertices:u,indices:h,size:7}}function KO(n){var l=n.coordinates;l.length===2&&l.push(0);var a=Fh(-1,1),s=Fh(1,1),u=Fh(-1,-1),h=Fh(1,-1),v=[].concat(_toConsumableArray(l),_toConsumableArray(a),_toConsumableArray(l),_toConsumableArray(u),_toConsumableArray(l),_toConsumableArray(h),_toConsumableArray(l),_toConsumableArray(s)),m=[0,1,2,3,0,2];return{vertices:v,indices:m,size:5}}function V5(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(c1&&c1[n])return c1[n];var a=Cx[n]?Cx[n]():Cx.cylinder(),s=vm([a],l);return c1[n]=s,s}function QO(n,l){for(var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=new Float32Array(n.length/a*3),h,v,m,w=vec3.create(),A=vec3.create(),R=vec3.create(),B=0,G=l.length;B<G;B+=3){h=l[B+0]*3,v=l[B+1]*3,m=l[B+2]*3;var j=[n[h],n[h+1]],lt=[n[v],n[v+1]],ct=[n[m],n[m+1]];s&&(j=lngLatToMeters(j),lt=lngLatToMeters(lt),ct=lngLatToMeters(ct));var _t=j,Zt=_slicedToArray(_t,2),pe=Zt[0],fe=Zt[1],Ze=vec3.fromValues(pe,fe,n[h+2]),Qe=lt,wr=_slicedToArray(Qe,2),Lr=wr[0],Vr=wr[1],Wr=vec3.fromValues(Lr,Vr,n[v+2]),bn=ct,hn=_slicedToArray(bn,2),Wn=hn[0],vi=hn[1],$i=vec3.fromValues(Wn,vi,n[m+2]);vec3.sub(w,$i,Wr),vec3.sub(A,Ze,Wr),vec3.cross(R,w,A),u[h]+=w[0],u[h+1]+=w[1],u[h+2]+=w[2],u[v]+=w[0],u[v+1]+=w[1],u[v+2]+=w[2],u[m]+=w[0],u[m+1]+=w[1],u[m+2]+=w[2]}return G5(u),u}function G5(n){for(var l=0,a=n.length;l<a;l+=3){var s=vec3.fromValues(n[l],n[l+1],n[l+2]),u=vec3.create();vec3.normalize(u,s),n.set(u,l)}}function JO(n){var l=n[0][0],a=n[0][n[0].length-1];return l[0]===a[0]&&l[1]===a[1]}function H5(n){var l=["cylinder","triangleColumn","hexagonColumn","squareColumn"],a=geometryShape[n]?geometryShape[n]():geometryShape.circle(),s=l.indexOf(n)===-1?fillPolygon([a]):extrudePolygon([a]);return s}function Fh(n,l){var a=(n+1)/2,s=(l+1)/2;return[a,s]}function gg(){var n=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),l=n.positionsArr,a=n.indicesArr,s=n.normalArr;return{vertices:l,indices:a,size:5,normals:s}}function j5(){var n=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),l=n.positionsArr,a=n.indicesArr,s=n.normalArr;return{vertices:l,indices:a,size:5,normals:s}}function $w(n){var l=L0();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function L0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Mx=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,W5=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,qw=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,X5=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  float arcThetaOffset = styleMappingMat[0][1];
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,h1=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,Y5=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,$5={solid:0,dash:1},q5=function(n){(0,zt.Z)(a,n);var l=$w(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.textureBlend,R=A===void 0?"normal":A,B=u.lineType,G=B===void 0?"solid":B,j=u.dashArray,lt=j===void 0?[10,5]:j,ct=u.forward,_t=ct===void 0?!0:ct,Zt=u.lineTexture,pe=Zt===void 0?!1:Zt,fe=u.iconStep,Ze=fe===void 0?100:fe,Qe=u.segmentNumber,wr=Qe===void 0?30:Qe,Lr=u.thetaOffset,Vr=Lr===void 0?.314:Lr;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,thetaOffset:Vr})){this.judgeStyleAttributes({opacity:v,thetaOffset:Vr});var Wr=this.layer.getEncodedData(),bn=this.calDataFrame(this.cellLength,Wr,this.cellProperties),hn=bn.data,Wn=bn.width,vi=bn.height;this.rowCount=vi,this.dataTexture=this.cellLength>0&&hn.length>0?this.createTexture2D({flipY:!0,data:hn,format:se.LUMINANCE,type:se.FLOAT,width:Wn,height:vi}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}lt.length===2&&lt.push(0,0);var $i=0,go=[0,0,0,0],zo=[0,0,0,0];return m&&w&&(go=$e(m),zo=$e(w),$i=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:(0,ne.isNumber)(Vr)?Vr:0,u_opacity:(0,ne.isNumber)(v)?v:1,u_textureBlend:R==="normal"?0:1,segmentNumber:wr,u_line_type:$5[G||"solid"],u_dash_array:lt,u_blur:.9,u_lineDir:_t?1:-1,u_texture:this.texture,u_line_texture:pe?1:0,u_icon_step:Ze,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:$i,u_sourceColor:go,u_targetColor:zo}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var u=this.layer.getLayerConfig(),h=u.sourceColor,v=u.targetColor,m=u.lineType;return m==="dash"?{frag:Mx,vert:W5,type:"Dash"}:h&&v?{frag:h1,vert:Y5,type:"Linear"}:{frag:qw,vert:X5,type:""}}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt;return ot().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,w=m===void 0?30:m,A=v.mask,R=A===void 0?!1:A,B=v.maskInside,G=B===void 0?!0:B,j=this.getShaders(),lt=j.frag,ct=j.vert,_t=j.type,fe.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+_t,vertexShader:ct,fragmentShader:lt,triangulation:Em,depth:{enable:!1},blend:this.getBlend(),segmentNumber:w,stencil:Di(R,G)});case 4:return Zt=fe.sent,fe.abrupt("return",[Zt]);case 6:case"end":return fe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?1:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:ta.Attribute,descriptor:{name:"a_Instance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:4,update:function(v,m,w){return[w[3],w[4],w[5],w[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.texture,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo);function K5(n){var l=Q5();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Q5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var J5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Ix=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,tI=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,eI=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,rI={solid:0,dash:1},nI=function(n){(0,zt.Z)(a,n);var l=K5(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.textureBlend,R=A===void 0?"normal":A,B=u.lineType,G=B===void 0?"solid":B,j=u.dashArray,lt=j===void 0?[10,5]:j,ct=u.lineTexture,_t=ct===void 0?!1:ct,Zt=u.iconStep,pe=Zt===void 0?100:Zt,fe=u.segmentNumber,Ze=fe===void 0?30:fe,Qe=u.globalArcHeight,wr=Qe===void 0?10:Qe;lt.length===2&&lt.push(0,0);var Lr=0,Vr=[0,0,0,0],Wr=[0,0,0,0];if(m&&w&&(Vr=$e(m),Wr=$e(w),Lr=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var bn=this.layer.getEncodedData(),hn=this.calDataFrame(this.cellLength,bn,this.cellProperties),Wn=hn.data,vi=hn.width,$i=hn.height;this.rowCount=$i,this.dataTexture=this.cellLength>0&&Wn.length>0?this.createTexture2D({flipY:!0,data:Wn,format:se.LUMINANCE,type:se.FLOAT,width:vi,height:$i}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:jd,u_global_height:wr,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_textureBlend:R==="normal"?0:1,segmentNumber:Ze,u_line_type:rI[G]||0,u_dash_array:lt,u_texture:this.texture,u_line_texture:_t?1:0,u_icon_step:pe,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Lr,u_sourceColor:Vr,u_targetColor:Wr}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var u=this.layer.getLayerConfig(),h=u.sourceColor,v=u.targetColor;return h&&v?{frag:tI,vert:eI,type:"Linear"}:{frag:J5,vert:Ix,type:""}}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt;return ot().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,w=m===void 0?30:m,A=v.mask,R=A===void 0?!1:A,B=v.maskInside,G=B===void 0?!0:B,j=this.getShaders(),lt=j.frag,ct=j.vert,_t=j.type,fe.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+_t,vertexShader:ct,fragmentShader:lt,triangulation:Em,blend:this.getBlend(),segmentNumber:w,stencil:Di(R,G)});case 4:return Zt=fe.sent,fe.abrupt("return",[Zt]);case 6:case"end":return fe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?1:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:ta.Attribute,descriptor:{name:"a_Instance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:4,update:function(v,m,w){return[w[3],w[4],w[5],w[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.texture,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo);function p1(n){var l=iI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function iI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var aI=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,oI=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,sI=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,uI=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,Kw={solid:0,dash:1},lI=function(n){(0,zt.Z)(a,n);var l=p1(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.textureBlend,R=A===void 0?"normal":A,B=u.lineType,G=B===void 0?"solid":B,j=u.dashArray,lt=j===void 0?[10,5]:j,ct=u.lineTexture,_t=ct===void 0?!1:ct,Zt=u.iconStep,pe=Zt===void 0?100:Zt,fe=u.segmentNumber,Ze=fe===void 0?30:fe,Qe=u.globalArcHeight,wr=Qe===void 0?10:Qe;lt.length===2&&lt.push(0,0);var Lr=0,Vr=[0,0,0,0],Wr=[0,0,0,0];if(m&&w&&(Vr=$e(m),Wr=$e(w),Lr=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var bn=this.layer.getEncodedData(),hn=this.calDataFrame(this.cellLength,bn,this.cellProperties),Wn=hn.data,vi=hn.width,$i=hn.height;this.rowCount=$i,this.dataTexture=this.cellLength>0&&Wn.length>0?this.createTexture2D({flipY:!0,data:Wn,format:se.LUMINANCE,type:se.FLOAT,width:vi,height:$i}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:jd,u_global_height:wr,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_textureBlend:R==="normal"?0:1,segmentNumber:Ze,u_line_type:Kw[G]||0,u_dash_array:lt,u_texture:this.texture,u_line_texture:_t?1:0,u_icon_step:pe,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Lr,u_sourceColor:Vr,u_targetColor:Wr}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var u=this.layer.getLayerConfig(),h=u.sourceColor,v=u.targetColor;return h&&v?{frag:sI,vert:uI,type:"Linear"}:{frag:aI,vert:oI,type:""}}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt;return ot().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,w=m===void 0?30:m,A=v.mask,R=A===void 0?!1:A,B=v.maskInside,G=B===void 0?!0:B,j=this.getShaders(),lt=j.frag,ct=j.vert,_t=j.type,fe.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+_t,vertexShader:ct,fragmentShader:lt,triangulation:Em,depth:{enable:!0},blend:this.getBlend(),segmentNumber:w,stencil:Di(R,G)});case 4:return Zt=fe.sent,fe.abrupt("return",[Zt]);case 6:case"end":return fe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?1:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:ta.Attribute,descriptor:{name:"a_Instance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:4,update:function(v,m,w){return[w[3],w[4],w[5],w[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.texture,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo);function Qw(n){var l=cI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function cI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Jw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,kx=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,Dv={solid:0,dash:1},Bv=function(n){(0,zt.Z)(a,n);var l=Qw(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.textureBlend,R=A===void 0?"normal":A,B=u.lineType,G=B===void 0?"solid":B,j=u.dashArray,lt=j===void 0?[10,5]:j,ct=u.lineTexture,_t=ct===void 0?!1:ct,Zt=u.iconStep,pe=Zt===void 0?100:Zt,fe=u.segmentNumber,Ze=fe===void 0?30:fe;lt.length===2&&lt.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var Qe=0,wr=[0,0,0,0],Lr=[0,0,0,0];if(m&&w&&(wr=$e(m),Lr=$e(w),Qe=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Vr=this.layer.getEncodedData(),Wr=this.calDataFrame(this.cellLength,Vr,this.cellProperties),bn=Wr.data,hn=Wr.width,Wn=Wr.height;this.rowCount=Wn,this.dataTexture=this.cellLength>0&&bn.length>0?this.createTexture2D({flipY:!0,data:bn,format:se.LUMINANCE,type:se.FLOAT,width:hn,height:Wn}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_textureBlend:R==="normal"?0:1,segmentNumber:Ze,u_line_type:Dv[G]||0,u_dash_array:lt,u_texture:this.texture,u_line_texture:_t?1:0,u_icon_step:pe,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Qe,u_sourceColor:wr,u_targetColor:Lr}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:kx,fragmentShader:Jw,triangulation:Em,depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?1:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:ta.Attribute,descriptor:{name:"a_Instance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:4,update:function(v,m,w){return[w[3],w[4],w[5],w[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.texture,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo);function Xd(n){var l=Lx();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Lx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wm=`#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
uniform float u_CoordinateSystem;
varying vec4 v_color;
uniform float u_arrow: 0.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

varying mat4 styleMappingMat;
void main() {
  float distanceAndIndex = styleMappingMat[0][3];
  float miter = styleMappingMat[0][2];

  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B


  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { 
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap
        discard;
      }
    } else { // amap2 mapbox map
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { 
        discard;
      }
    }
  } else { // line body
    if(miter < 0.0) {
      discard;
    }
  }


  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Sm=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute vec4 a_dirPoints;
attribute vec3 a_DistanceAndIndex;

uniform vec4 u_lineDir;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex
    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );
  styleMappingMat[0][3] = a_DistanceAndIndex.y;
  styleMappingMat[0][2] = a_Miter;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97


  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  // styleMappingMat[1].rg = a_Position.xy + offset;

  vec2 copyOffset = vec2(offset.x, offset.y);

  float lineDistance = a_DistanceAndIndex.x;
  float total_Distance = a_DistanceAndIndex.z;
  float currentLinePointRatio = lineDistance / total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z); // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }
  
  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {
    vec2 startPoint = a_dirPoints.rg;
    vec2 endPoint = a_dirPoints.ba;
    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));
    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));
    // TODO\uFF1A \u540E\u7EED\u4F18\u5316\u53EF\u4EE5\u628A\u4F4D\u7F6E\u8BA1\u7B97\u653E\u5728 cpu \u4E2D\u5B8C\u6210
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    } else {
      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    }
  }

  setPickingColor(a_PickingColor);
}
`,fI=function(n){(0,zt.Z)(a,n);var l=Xd(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.arrow,R=A===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:A,B=0,G=[0,0,0,0],j=[0,0,0,0];if(m&&w&&(G=$e(m),j=$e(w),B=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var lt=this.layer.getEncodedData(),ct=this.calDataFrame(this.cellLength,lt,this.cellProperties),_t=ct.data,Zt=ct.width,pe=ct.height;this.rowCount=pe,this.dataTexture=this.cellLength>0&&_t.length>0?this.createTexture2D({flipY:!0,data:_t,format:se.LUMINANCE,type:se.FLOAT,width:Zt,height:pe}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_linearColor:B,u_sourceColor:G,u_targetColor:j,u_arrow:Number(R.enable),u_arrowHeight:R.arrowHeight||3,u_arrowWidth:R.arrowWidth||2,u_tailWidth:R.tailWidth===void 0?1:R.tailWidth}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t;return ot().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=v.depth,G=B===void 0?!1:B,j=this.getShaders(),lt=j.frag,ct=j.vert,this.layer.triangulation=_m,pe.next=5,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:ct,fragmentShader:lt,triangulation:_m,depth:{enable:G},blend:this.getBlend(),stencil:Di(w,R)});case 5:return _t=pe.sent,pe.abrupt("return",[_t]);case 7:case"end":return pe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getShaders",value:function(){return{frag:wm,vert:Sm,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:ta.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h,v,m,w,A,R){return R===void 0?[m[3],10,m[5]]:[m[3],R,m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:ta.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:4,update:function(h){var v=h.coordinates[0]||[0,0],m=h.coordinates[3]||[0,0];return[v[0],v[1],m[0],m[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h,v,m,w,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:ta.Attribute,descriptor:{name:"a_Miter",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h,v,m){return[m[4]]}}})}}]),a}(Vo),Px;(function(n){n[n.solid=0]="solid",n[n.dash=1]="dash"})(Px||(Px={}));var Nv;(function(n){n.VERTICAL="vertical",n.HORIZONTAL="horizontal"})(Nv||(Nv={}));var Cm;(function(n){n.NORMAL="normal",n.REPLACE="replace"})(Cm||(Cm={}));var Am;(function(n){n[n.pixel=0]="pixel",n[n.meter=1]="meter"})(Am||(Am={}));var tS;(function(n){n.ALWAYS="always",n.DRAGEND="dragend"})(tS||(tS={}));function hI(n){var l=eS();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function eS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rS=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,pI=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,dI=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = styleMappingMat[3][3];
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,Ox=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,vI=`varying vec4 v_color;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3][0]; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,gI={solid:0,dash:1},nS=function(n){(0,zt.Z)(a,n);var l=hI(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"texture",s.createTexture2D({data:[0,0,0,0],mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.textureBlend,R=A===void 0?"normal":A,B=u.lineType,G=B===void 0?"solid":B,j=u.dashArray,lt=j===void 0?[10,5,0,0]:j,ct=u.lineTexture,_t=ct===void 0?!1:ct,Zt=u.iconStep,pe=Zt===void 0?100:Zt,fe=u.vertexHeightScale,Ze=fe===void 0?20:fe,Qe=u.borderWidth,wr=Qe===void 0?0:Qe,Lr=u.borderColor,Vr=Lr===void 0?"#ccc":Lr,Wr=u.raisingHeight,bn=Wr===void 0?0:Wr,hn=u.heightfixed,Wn=hn===void 0?!1:hn,vi=u.linearDir,$i=vi===void 0?Nv.VERTICAL:vi,go=u.blur,zo=go===void 0?[1,1,1]:go,zs=u.arrow,cu=zs===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:zs;lt.length===2&&lt.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var Xu=0,zh=[0,0,0,0],m2=[0,0,0,0];if(m&&w&&(zh=$e(m),m2=$e(w),Xu=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var p_=this.layer.getEncodedData(),y2=this.calDataFrame(this.cellLength,p_,this.cellProperties),LT=y2.data,cO=y2.width,PT=y2.height;this.rowCount=PT,this.dataTexture=this.cellLength>0&&LT.length>0?this.createTexture2D({flipY:!0,data:LT,format:se.LUMINANCE,type:se.FLOAT,width:cO,height:PT}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_textureBlend:R===Cm.NORMAL?0:1,u_line_type:gI[G],u_dash_array:lt,u_blur:zo,u_texture:this.texture,u_line_texture:_t?1:0,u_icon_step:pe,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:wr,u_borderColor:$e(Vr),u_linearDir:$i===Nv.VERTICAL?1:0,u_linearColor:Xu,u_sourceColor:zh,u_targetColor:m2,u_heightfixed:Number(Wn),u_vertexScale:Ze,u_raisingHeight:Number(bn),u_arrow:Number(cu.enable),u_arrowHeight:cu.arrowHeight||3,u_arrowWidth:cu.arrowWidth||2,u_tailWidth:cu.tailWidth===void 0?1:cu.tailWidth}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze;return ot().wrap(function(wr){for(;;)switch(wr.prev=wr.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=v.depth,G=B===void 0?!1:B,j=v.workerEnabled,lt=j===void 0?!1:j,ct=v.enablePicking,_t=this.getShaders(),Zt=_t.frag,pe=_t.vert,fe=_t.type,this.layer.triangulation=Wh,wr.next=5,this.layer.buildLayerModel({moduleName:"line"+fe,vertexShader:pe,fragmentShader:Zt,triangulation:Wh,depth:{enable:G},blend:this.getBlend(),stencil:Di(w,R),workerEnabled:lt,workerOptions:{modelType:"line"+fe,enablePicking:ct,iconMap:this.iconService.getIconMap()}});case 5:return Ze=wr.sent,wr.abrupt("return",[Ze]);case 7:case"end":return wr.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getShaders",value:function(){var u=this.layer.getLayerConfig(),h=u.sourceColor,v=u.targetColor,m=u.lineType;return m==="dash"?{frag:rS,vert:pI,type:"Dash"}:h&&v?{frag:vI,vert:Ox,type:"Linear"}:{frag:dI,vert:Ox,type:""}}},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:ta.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v,m,w,A,R,B){return B===void 0?[w[3],10]:[w[3],B]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:ta.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v,m,w){return[w[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=v.size,w=m===void 0?1:m;return Array.isArray(w)?[w[0],w[1]]:[w,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(v,m,w,A,R){return R}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:ta.Attribute,descriptor:{name:"a_Miter",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v,m,w){return[w[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.texture,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo);function mI(n){var l=yI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function yI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var _I=`uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;

#pragma include "picking"

varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,xI=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "picking"

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,bI=function(n){(0,zt.Z)(a,n);var l=mI(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;s.colorTexture&&s.colorTexture.destroy();var w=s.layer.getLayerConfig(),A=w.rampColors,R=Er(A);s.colorTexture=m({data:new Uint8Array(R.data),width:R.width,height:R.height,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE,min:se.NEAREST,mag:se.NEAREST,flipY:!1})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.vertexHeightScale,w=m===void 0?20:m,A=u.raisingHeight,R=A===void 0?0:A,B=u.heightfixed,G=B===void 0?!1:B,j=u.linearDir,lt=j===void 0?Nv.VERTICAL:j;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var ct=this.layer.getEncodedData(),_t=this.calDataFrame(this.cellLength,ct,this.cellProperties),Zt=_t.data,pe=_t.width,fe=_t.height;this.rowCount=fe,this.dataTexture=this.cellLength>0&&Zt.length>0?this.createTexture2D({flipY:!0,data:Zt,format:se.LUMINANCE,type:se.FLOAT,width:pe,height:fe}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:lt===Nv.VERTICAL?1:0,u_opacity:(0,ne.isNumber)(v)?v:1,u_texture:this.colorTexture,u_heightfixed:Number(G),u_vertexScale:w,u_raisingHeight:Number(R)}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.colorTexture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j;return ot().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=v.depth,G=B===void 0?!1:B,this.layer.triangulation=_m,ct.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:xI,fragmentShader:_I,triangulation:_m,depth:{enable:G},blend:this.getBlend(),stencil:Di(w,R)});case 4:return j=ct.sent,ct.abrupt("return",[j]);case 6:case"end":return ct.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:ta.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m,w,A,R){return R===void 0?[m[3],10]:[m[3],R]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:ta.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h,v,m){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h,v,m,w,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:ta.Attribute,descriptor:{name:"a_Miter",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h,v,m){return[m[4]]}}})}}]),a}(Vo);function EI(n){var l=wI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function wI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var SI=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,iS=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];

  // styleMappingMat[3][0] \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,d1=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  v_color = a_Color; 
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,aS=function(n){(0,zt.Z)(a,n);var l=EI(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.vertexHeightScale,R=A===void 0?20:A,B=0,G=[0,0,0,0],j=[0,0,0,0];if(m&&w&&(G=$e(m),j=$e(w),B=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var lt=this.layer.getEncodedData(),ct=this.calDataFrame(this.cellLength,lt,this.cellProperties),_t=ct.data,Zt=ct.width,pe=ct.height;this.rowCount=pe,this.dataTexture=this.cellLength>0&&_t.length>0?this.createTexture2D({flipY:!0,data:_t,format:se.LUMINANCE,type:se.FLOAT,width:Zt,height:pe}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_linearColor:B,u_sourceColor:G,u_targetColor:j,u_vertexScale:R}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"getShaders",value:function(){var u=this.layer.getLayerConfig(),h=u.sourceColor,v=u.targetColor;return h&&v?{frag:iS,vert:d1,type:"lineSimpleLinear"}:{frag:SI,vert:d1,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct;return ot().wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=this.getShaders(),G=B.frag,j=B.vert,lt=B.type,Zt.next=4,this.layer.buildLayerModel({moduleName:lt,vertexShader:j,fragmentShader:G,triangulation:xm,primitive:se.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R),pick:!1});case 4:return ct=Zt.sent,Zt.abrupt("return",[ct]);case 6:case"end":return Zt.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:ta.Attribute,descriptor:{name:"a_Distance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h,v,m){return[m[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:ta.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h,v,m){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}})}}]),a}(Vo);function CI(n){var l=AI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function AI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var TI=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,MI=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,II=function(n){(0,zt.Z)(a,n);var l=CI(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.NEAREST,min:se.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.sourceColor,w=u.targetColor,A=u.textureBlend,R=A===void 0?"normal":A,B=u.heightfixed,G=B===void 0?!1:B,j=u.lineTexture,lt=j===void 0?!1:j,ct=u.iconStep,_t=ct===void 0?100:ct,Zt=u.iconStepCount,pe=Zt===void 0?1:Zt;this.rendererService.getDirty()&&this.texture.bind();var fe=0,Ze=[0,0,0,0],Qe=[0,0,0,0];return m&&w&&(Ze=$e(m),Qe=$e(w),fe=1),{u_heightfixed:Number(G),u_opacity:(0,ne.isNumber)(v)?v:1,u_textureBlend:R==="normal"?0:1,u_texture:this.texture,u_line_texture:lt?1:0,u_iconStepCount:pe,u_icon_step:_t,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:fe,u_sourceColor:Ze,u_targetColor:Qe}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.texture)===null||u===void 0||u.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:MI,fragmentShader:TI,triangulation:_m,depth:{enable:!1},blend:this.getBlend()});case 2:return v=w.sent,w.abrupt("return",[v]);case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:ta.Attribute,descriptor:{name:"a_Distance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v,m,w){return[w[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:ta.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v,m,w){return[w[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=v.size,w=m===void 0?1:m;return Array.isArray(w)?[w[0],w[1]]:[w,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(v,m,w,A,R){return R}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:ta.Attribute,descriptor:{name:"a_Miter",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v,m,w){return[w[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.texture,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo),kI={arc:q5,arc3d:nI,greatcircle:Bv,wall:II,line:nS,halfLine:fI,simple:aS,linearline:bI,earthArc3d:lI},oS=kI;function LI(n){var l=v1();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function v1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var P0=function(n){(0,zt.Z)(a,n);var l=LI(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"type","LineLayer"),(0,W.Z)((0,ut.Z)(s),"arrowInsertCount",0),(0,W.Z)((0,ut.Z)(s),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=this.getModelType(),this.layerModel=new oS[v](this),w.next=4,this.initLayerModels();case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getDefaultConfig",value:function(){var u=this.getModelType(),h={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},halfLine:{},earthArc3d:{}};return h[u]}},{key:"getModelType",value:function(){var u;if(this.layerType)return this.layerType;var h=this.styleAttributeService.getLayerStyleAttribute("shape"),v=h==null||(u=h.scale)===null||u===void 0?void 0:u.field;return v||"line"}},{key:"processData",value:function(u){if(this.getModelType()!=="simple")return u;var h=[];return u.map(function(v){if(Array.isArray(v.coordinates)&&Array.isArray(v.coordinates[0])&&Array.isArray(v.coordinates[0][0])){var m=(0,K.Z)({},v);v.coordinates.map(function(w){h.push((0,K.Z)((0,K.Z)({},m),{},{coordinates:w}))})}else h.push(v)}),h}}]),a}(hg);function sS(n){var l=Yd();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Yd(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PI=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,uS=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,lS=function(n){(0,zt.Z)(a,n);var l=sS(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"raiseCount",0),(0,W.Z)((0,ut.Z)(s),"raiseRepeat",0),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption,v=h===void 0?{enable:!1,speed:.01,repeat:!1}:h,m=u.opacity,w=m===void 0?1:m,A=u.sourceColor,R=u.targetColor,B=u.pickLight,G=B===void 0?!1:B,j=u.heightfixed,lt=j===void 0?!1:j,ct=u.opacityLinear,_t=ct===void 0?{enable:!1,dir:"up"}:ct,Zt=u.lightEnable,pe=Zt===void 0?!0:Zt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var fe=this.layer.getEncodedData(),Ze=this.calDataFrame(this.cellLength,fe,this.cellProperties),Qe=Ze.data,wr=Ze.width,Lr=Ze.height;this.rowCount=Lr,this.dataTexture=this.cellLength>0&&Qe.length>0?this.createTexture2D({flipY:!0,data:Qe,format:se.LUMINANCE,type:se.FLOAT,width:wr,height:Lr}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}var Vr=0,Wr=[0,0,0,0],bn=[0,0,0,0];if(A&&R&&(Wr=$e(A),bn=$e(R),Vr=1),this.raiseCount<1&&this.raiseRepeat>0&&v.enable){var hn=v.speed,Wn=hn===void 0?.01:hn;this.raiseCount+=Wn,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(G),u_heightfixed:Number(lt),u_r:v.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(w)?w:1,u_linearColor:Vr,u_sourceColor:Wr,u_targetColor:bn,u_opacitylinear:Number(_t.enable),u_opacitylinear_dir:_t.dir==="up"?1:0,u_lightEnable:Number(pe)}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.layer.getLayerConfig(),m=v.animateOption.repeat,w=m===void 0?1:m,this.raiseRepeat=w,B.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:uS,fragmentShader:PI,triangulation:Ka,depth:{enable:!0},cull:{enable:!0,face:bc(this.mapService.version)},blend:this.getBlend()});case 4:return A=B.sent,B.abrupt("return",[A]);case 6:case"end":return B.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h){var v=h.size;if(v){var m=[];return Array.isArray(v)&&(m=v.length===2?[v[0],v[0],v[1]]:v),Array.isArray(v)||(m=[v,v,v]),m}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h,v,m,w,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:ta.Attribute,descriptor:{name:"a_Pos",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h){var v=zl(h.coordinates);return Go([v[0],v[1]])}}})}}]),a}(Vo);function OI(n){var l=FI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function FI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var cS=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,fS=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);

  setPickingColor(a_PickingColor);
}
`,RI=function(n){(0,zt.Z)(a,n);var l=OI(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.strokeOpacity,w=m===void 0?1:m,A=u.strokeWidth,R=A===void 0?0:A,B=u.stroke,G=B===void 0?"rgba(0,0,0,0)":B,j=u.offsets,lt=j===void 0?[0,0]:j,ct=u.blend,_t=u.blur,Zt=_t===void 0?0:_t;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeOpacity:w,strokeWidth:R,stroke:G,offsets:lt})){this.judgeStyleAttributes({opacity:v,strokeOpacity:w,strokeWidth:R,stroke:G,offsets:lt});var pe=this.layer.getEncodedData(),fe=this.calDataFrame(this.cellLength,pe,this.cellProperties),Ze=fe.data,Qe=fe.width,wr=fe.height;this.rowCount=wr,this.dataTexture=this.cellLength>0&&Ze.length>0?this.createTexture2D({flipY:!0,data:Ze,format:se.LUMINANCE,type:se.FLOAT,width:Qe,height:wr}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_blur:Zt,u_additive:ct==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_stroke_opacity:(0,ne.isNumber)(w)?w:1,u_stroke_width:(0,ne.isNumber)(R)?R:1,u_stroke_color:this.getStrokeColor(G),u_offsets:this.isOffsetStatic(lt)?lt:[0,0]}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return this.layer.triangulation=Ax,w.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:fS,fragmentShader:cS,triangulation:Ax,depth:{enable:!0},blend:this.getBlend()});case 3:return v=w.sent,w.abrupt("return",[v]);case 5:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"animateOption2Array",value:function(u){return[u.enable?0:1,u.speed||1,u.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:ta.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(v,m,w,A){var R=(0,yt.Z)(w,3),B=R[0],G=R[1],j=R[2],lt=Co.fromValues(0,0,1),ct=Co.fromValues(B,0,j),_t=B>=0?Co.angle(lt,ct):Math.PI*2-Co.angle(lt,ct),Zt=Math.PI*2-Math.asin(G/100),pe=$r();Oi(pe,pe,_t),Ni(pe,pe,Zt);var fe=Co.fromValues(1,1,0);Co.transformMat4(fe,fe,pe),Co.normalize(fe,fe);var Ze=Co.fromValues(-1,1,0);Co.transformMat4(Ze,Ze,pe),Co.normalize(Ze,Ze);var Qe=Co.fromValues(-1,-1,0);Co.transformMat4(Qe,Qe,pe),Co.normalize(Qe,Qe);var wr=Co.fromValues(1,-1,0);Co.transformMat4(wr,wr,pe),Co.normalize(wr,wr);var Lr=[].concat((0,ve.Z)(fe),(0,ve.Z)(Ze),(0,ve.Z)(Qe),(0,ve.Z)(wr)),Vr=A%4*3;return[Lr[Vr],Lr[Vr+1],Lr[Vr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?5:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:ta.Attribute,descriptor:{name:"a_Shape",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.shape,w=m===void 0?2:m,A=u.layer.getLayerConfig().shape2d,R=A.indexOf(w);return[R]}}})}}]),a}(Vo);function DI(n){var l=hS();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function hS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var BI=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,NI=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,Fx=function(n){(0,zt.Z)(a,n);var l=DI(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"raiseCount",0),(0,W.Z)((0,ut.Z)(s),"raiseRepeat",0),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption,v=h===void 0?{enable:!1,speed:.01,repeat:!1}:h,m=u.opacity,w=m===void 0?1:m,A=u.sourceColor,R=u.targetColor,B=u.pickLight,G=B===void 0?!1:B,j=u.heightfixed,lt=j===void 0?!1:j,ct=u.opacityLinear,_t=ct===void 0?{enable:!1,dir:"up"}:ct,Zt=u.lightEnable,pe=Zt===void 0?!0:Zt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var fe=this.layer.getEncodedData(),Ze=this.calDataFrame(this.cellLength,fe,this.cellProperties),Qe=Ze.data,wr=Ze.width,Lr=Ze.height;this.rowCount=Lr,this.dataTexture=this.cellLength>0&&Qe.length>0?this.createTexture2D({flipY:!0,data:Qe,format:se.LUMINANCE,type:se.FLOAT,width:wr,height:Lr}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}var Vr=0,Wr=[0,0,0,0],bn=[0,0,0,0];if(A&&R&&(Wr=$e(A),bn=$e(R),Vr=1),this.raiseCount<1&&this.raiseRepeat>0&&v.enable){var hn=v.speed,Wn=hn===void 0?.01:hn;this.raiseCount+=Wn,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(G),u_heightfixed:Number(lt),u_r:v.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(w)?w:1,u_linearColor:Vr,u_sourceColor:Wr,u_targetColor:bn,u_opacitylinear:Number(_t.enable),u_opacitylinear_dir:_t.dir==="up"?1:0,u_lightEnable:Number(pe)}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.depth,w=m===void 0?!0:m,A=v.animateOption.repeat,R=A===void 0?1:A,this.raiseRepeat=R,j.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:NI,fragmentShader:BI,triangulation:Ka,blend:this.getBlend(),cull:{enable:!0,face:bc(this.mapService.version)},depth:{enable:w}});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h){var v=h.size;if(v){var m=[];return Array.isArray(v)&&(m=v.length===2?[v[0],v[0],v[1]]:v),Array.isArray(v)||(m=[v,v,v]),m}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h,v,m,w,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:ta.Attribute,descriptor:{name:"a_Pos",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h){var v=zl(h.coordinates);return[v[0],v[1],0]}}})}}]),a}(Vo);function zI(n){var l=pS();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function pS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dS=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,vS=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,mg=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform int u_Size_Unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;
if(u_Size_Unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);
  
  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_raisingHeight;

  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position =  u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,yg=function(n){(0,zt.Z)(a,n);var l=zI(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.strokeOpacity,w=m===void 0?1:m,A=u.strokeWidth,R=A===void 0?0:A,B=u.stroke,G=B===void 0?"rgba(0,0,0,0)":B,j=u.offsets,lt=j===void 0?[0,0]:j,ct=u.blend,_t=u.blur,Zt=_t===void 0?0:_t,pe=u.raisingHeight,fe=pe===void 0?0:pe,Ze=u.heightfixed,Qe=Ze===void 0?!1:Ze,wr=u.unit,Lr=wr===void 0?"pixel":wr;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeOpacity:w,strokeWidth:R,stroke:G,offsets:lt})){this.judgeStyleAttributes({opacity:v,strokeOpacity:w,strokeWidth:R,stroke:G,offsets:lt});var Vr=this.layer.getEncodedData(),Wr=this.calDataFrame(this.cellLength,Vr,this.cellProperties),bn=Wr.data,hn=Wr.width,Wn=Wr.height;this.rowCount=Wn,this.dataTexture=this.cellLength>0&&bn.length>0?this.createTexture2D({flipY:!0,data:bn,format:se.LUMINANCE,type:se.FLOAT,width:hn,height:Wn}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(fe),u_heightfixed:Number(Qe),u_blur:Zt,u_additive:ct==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_stroke_opacity:(0,ne.isNumber)(w)?w:1,u_stroke_width:(0,ne.isNumber)(R)?R:1,u_stroke_color:this.getStrokeColor(G),u_Size_Unit:Am[Lr],u_offsets:this.isOffsetStatic(lt)?lt:[0,0]}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),xc)}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze,Qe;return ot().wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=v.animateOption,G=B===void 0?{enable:!1}:B,j=v.workerEnabled,lt=j===void 0?!1:j,ct=v.enablePicking,_t=v.shape2d,Zt=this.getShaders(G),pe=Zt.frag,fe=Zt.vert,Ze=Zt.type,this.layer.triangulation=xc,Lr.next=5,this.layer.buildLayerModel({moduleName:Ze,vertexShader:fe,fragmentShader:pe,triangulation:xc,depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R),workerEnabled:lt,workerOptions:{modelType:Ze,enablePicking:ct,shape2d:_t}});case 5:return Qe=Lr.sent,Lr.abrupt("return",[Qe]);case 7:case"end":return Lr.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getShaders",value:function(u){if(u.enable)switch(u.type){case"wave":return{frag:dS,vert:mg,type:"pointWave"};default:return{frag:dS,vert:mg,type:"pointWave"}}else return{frag:vS,vert:mg,type:"pointFill"}}},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"animateOption2Array",value:function(u){return[u.enable?0:1,u.speed||1,u.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var u=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:ta.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(v,m,w,A){var R=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[R[B],R[B+1],R[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?5:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:ta.Attribute,descriptor:{name:"a_Shape",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.shape,w=m===void 0?2:m,A=u.indexOf(w);return[A]}}})}}]),a}(Vo);function UI(n){var l=ZI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function ZI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var VI=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,GI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform int u_Size_Unit;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float newSize = a_Size;
  if(u_Size_Unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (newSize) + textrueOffsets);
  vec3 aPosition = a_Position;

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp *vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,HI=function(n){(0,zt.Z)(a,n);var l=UI(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"meter2coord",1),(0,W.Z)((0,ut.Z)(s),"isMeter",!1),(0,W.Z)((0,ut.Z)(s),"radian",0),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),s.layerService.throttleRenderLayers();return}s.texture=m({data:s.iconService.getCanvas(),mag:se.LINEAR,min:se.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128,mipmap:!0})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.offsets,w=m===void 0?[0,0]:m,A=u.rotation,R=u.raisingHeight,B=R===void 0?0:R,G=u.heightfixed,j=G===void 0?!1:G,lt=u.unit,ct=lt===void 0?"pixel":lt;this.rendererService.getDirty()&&this.texture.bind();var _t=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(_t=-1),this.radian=A!==void 0?_t*Math.PI*A/180:_t*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:w})){this.judgeStyleAttributes({opacity:v,offsets:w});var Zt=this.layer.getEncodedData(),pe=this.calDataFrame(this.cellLength,Zt,this.cellProperties),fe=pe.data,Ze=pe.width,Qe=pe.height;this.rowCount=Qe,this.dataTexture=this.cellLength>0&&fe.length>0?this.createTexture2D({flipY:!0,data:fe,format:se.LUMINANCE,type:se.FLOAT,width:Ze,height:Qe}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(B),u_heightfixed:Number(j),u_Size_Unit:Am[ct],u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,ne.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(w)?w:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),ym)}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:GI,fragmentShader:VI,triangulation:ym,depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R),cull:{enable:!0,face:bc(this.mapService.version)}});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;this.iconService.off("imageUpdate",this.updateTexture),(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:ta.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.rotate,w=m===void 0?0:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_Uv",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.shape,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:ta.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(v,m,w,A){var R=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[R[B],R[B+1],R[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?5:m;return Array.isArray(w)?[w[0]]:[w]}}})}}]),a}(Vo);function gS(n){var l=jI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function jI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var WI=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,XI=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(textrueOffsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,mS=function(n){(0,zt.Z)(a,n);var l=gS(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){s.layerService.throttleRenderLayers()});return}s.texture=m({data:s.iconService.getCanvas(),mag:se.LINEAR,min:se.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128,mipmap:!0})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.offsets,w=m===void 0?[0,0]:m,A=u.raisingHeight,R=A===void 0?0:A,B=u.heightfixed,G=B===void 0?!1:B;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:w})){this.judgeStyleAttributes({opacity:v,offsets:w});var j=this.layer.getEncodedData(),lt=this.calDataFrame(this.cellLength,j,this.cellProperties),ct=lt.data,_t=lt.width,Zt=lt.height;this.rowCount=Zt,this.dataTexture=this.cellLength>0&&ct.length>0?this.createTexture2D({flipY:!0,data:ct,format:se.LUMINANCE,type:se.FLOAT,width:_t,height:Zt}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(R),u_heightfixed:Number(G),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,ne.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(w)?w:[0,0]}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:XI,fragmentShader:WI,triangulation:jw,depth:{enable:!1},primitive:se.POINTS,blend:this.getBlend(),stencil:Di(w,R)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){var u=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(v){var m=v.size,w=m===void 0?5:m;return Array.isArray(w)?[w[0]]:[w]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_Uv",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(v){var m=u.iconService.getIconMap(),w=v.shape,A=m[w]||{x:0,y:0},R=A.x,B=A.y;return[R,B]}}})}}]),a}(Vo);function yS(n){var l=YI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function YI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Rx=`uniform float u_opacity : 1;
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
}
`,$I=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function _S(n){var l=n.coordinates;return{vertices:(0,ve.Z)(l),indices:[0],size:l.length}}var xS=function(n){(0,zt.Z)(a,n);var l=yS(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h;return{u_opacity:(0,ne.isNumber)(v)?v:1}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,this.layer.triangulation=_S,j.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:$I,fragmentShader:Rx,triangulation:_S,depth:{enable:!1},primitive:se.POINTS,blend:this.getBlend(),stencil:Di(w,R),pick:!1});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(Vo);function bS(n){var l=qI();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function qI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var KI=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,g1=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform int u_Size_Unit;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;



  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_Size_Unit == 1) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  // radius(16-bit)
  v_radius = newSize;

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
  offset = project_pixel(offset);
  
  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp *vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,QI=function(n){(0,zt.Z)(a,n);var l=bS(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.blend,w=u.speed,A=w===void 0?1:w,R=u.unit,B=R===void 0?"pixel":R;return{u_Size_Unit:Am[B],u_speed:A,u_additive:m==="additive"?1:0,u_opacity:(0,ne.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){var u=this.layer.getLayerConfig(),h=u.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),ym)}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:g1,fragmentShader:KI,triangulation:ym,depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"animateOption2Array",value:function(u){return[u.enable?0:1,u.speed||1,u.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:ta.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(h,v,m,w){var A=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],R=w%4*3;return[A[R],A[R+1],A[R+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?5:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(Vo);function JI(n){var l=tk();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function tk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ek=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,ES=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  vec2 offset = project_pixel(textrueOffsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Dx(n){var l=n.coordinates;return{vertices:(0,ve.Z)(l),indices:[0],size:l.length}}var rk=function(n){(0,zt.Z)(a,n);var l=JI(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.offsets,w=m===void 0?[0,0]:m,A=u.blend,R=u.strokeOpacity,B=R===void 0?1:R,G=u.strokeWidth,j=G===void 0?0:G,lt=u.stroke,ct=lt===void 0?"#fff":lt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:w})){this.judgeStyleAttributes({opacity:v,offsets:w});var _t=this.layer.getEncodedData(),Zt=this.calDataFrame(this.cellLength,_t,this.cellProperties),pe=Zt.data,fe=Zt.width,Ze=Zt.height;this.rowCount=Ze,this.dataTexture=this.cellLength>0&&pe.length>0?this.createTexture2D({flipY:!0,data:pe,format:se.LUMINANCE,type:se.FLOAT,width:fe,height:Ze}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_additive:A==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ne.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(w)?w:[0,0],u_stroke_opacity:(0,ne.isNumber)(B)?B:1,u_stroke_width:(0,ne.isNumber)(j)?j:1,u_stroke_color:this.getStrokeColor(ct)}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,this.layer.triangulation=Dx,j.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:ES,fragmentShader:ek,triangulation:Dx,depth:{enable:!1},primitive:se.POINTS,blend:this.getBlend(),stencil:Di(w,R)});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(Vo);function nk(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=wS(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function wS(n,l){if(n){if(typeof n=="string")return Bx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Bx(n,l)}}function Bx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var SS=function(){function n(l,a,s){(0,pt.Z)(this,n),(0,W.Z)(this,"boxCells",[]);var u=this.boxCells;this.xCellCount=Math.ceil(l/s),this.yCellCount=Math.ceil(a/s);for(var h=0;h<this.xCellCount*this.yCellCount;h++)u.push([]);this.boxKeys=[],this.bboxes=[],this.width=l,this.height=a,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/a,this.boxUid=0}return(0,et.Z)(n,[{key:"insert",value:function(a,s,u,h,v){this.forEachCell(s,u,h,v,this.insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(v)}},{key:"query",value:function(a,s,u,h,v){return this.queryHitTest(a,s,u,h,!1,v)}},{key:"hitTest",value:function(a,s,u,h,v){return this.queryHitTest(a,s,u,h,!0,v)}},{key:"insertBoxCell",value:function(a,s,u,h,v,m){this.boxCells[v].push(m)}},{key:"queryHitTest",value:function(a,s,u,h,v,m){if(u<0||a>this.width||h<0||s>this.height)return v?!1:[];var w=[];if(a<=0&&s<=0&&this.width<=u&&this.height<=h){if(v)return!0;for(var A=0;A<this.boxKeys.length;A++)w.push({key:this.boxKeys[A],x1:this.bboxes[A*4],y1:this.bboxes[A*4+1],x2:this.bboxes[A*4+2],y2:this.bboxes[A*4+3]});return m?w.filter(m):w}var R={hitTest:v,seenUids:{box:{},circle:{}}};return this.forEachCell(a,s,u,h,this.queryCell,w,R,m),v?w.length>0:w}},{key:"queryCell",value:function(a,s,u,h,v,m,w,A){var R=w.seenUids,B=this.boxCells[v];if(B!==null){var G=this.bboxes,j=nk(B),lt;try{for(j.s();!(lt=j.n()).done;){var ct=lt.value;if(!R.box[ct]){R.box[ct]=!0;var _t=ct*4;if(a<=G[_t+2]&&s<=G[_t+3]&&u>=G[_t+0]&&h>=G[_t+1]&&(!A||A(this.boxKeys[ct]))){if(w.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[ct],x1:G[_t],y1:G[_t+1],x2:G[_t+2],y2:G[_t+3]})}}}}catch(Zt){j.e(Zt)}finally{j.f()}}return!1}},{key:"forEachCell",value:function(a,s,u,h,v,m,w,A){for(var R=this.convertToXCellCoord(a),B=this.convertToYCellCoord(s),G=this.convertToXCellCoord(u),j=this.convertToYCellCoord(h),lt=R;lt<=G;lt++)for(var ct=B;ct<=j;ct++){var _t=this.xCellCount*ct+lt;if(v.call(this,a,s,u,h,_t,m,w,A))return}}},{key:"convertToXCellCoord",value:function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}},{key:"convertToYCellCoord",value:function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}}]),n}(),ik=SS,Nx=function(){function n(l,a){(0,pt.Z)(this,n),(0,W.Z)(this,"viewportPadding",100),this.width=l,this.height=a,this.viewportPadding=Math.max(l,a),this.grid=new ik(l+this.viewportPadding,a+this.viewportPadding,25),this.screenRightBoundary=l+this.viewportPadding,this.screenBottomBoundary=a+this.viewportPadding,this.gridRightBoundary=l+2*this.viewportPadding,this.gridBottomBoundary=a+2*this.viewportPadding}return(0,et.Z)(n,[{key:"placeCollisionBox",value:function(a){var s=a.x1+a.anchorPointX+this.viewportPadding,u=a.y1+a.anchorPointY+this.viewportPadding,h=a.x2+a.anchorPointX+this.viewportPadding,v=a.y2+a.anchorPointY+this.viewportPadding;return!this.isInsideGrid(s,u,h,v)||this.grid.hitTest(s,u,h,v)?{box:[]}:{box:[s,u,h,v]}}},{key:"insertCollisionBox",value:function(a,s){var u={featureIndex:s};this.grid.insert(u,a[0],a[1],a[2],a[3])}},{key:"project",value:function(a,s,u){var h=ho(s,u,0,1),v=aa(),m=Rr.apply(kt,(0,ve.Z)(a));return tl(v,h,m),{x:(v[0]/v[3]+1)/2*this.width+this.viewportPadding,y:(-v[1]/v[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(a,s,u,h){return u>=0&&a<this.gridRightBoundary&&h>=0&&s<this.gridBottomBoundary}}]),n}();function zx(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=ak(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function ak(n,l){if(n){if(typeof n=="string")return Ux(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ux(n,l)}}function Ux(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function CS(n){var l=.5,a=.5;switch(n){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0;break;default:l=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0;break;default:a=.5}return{horizontalAlign:l,verticalAlign:a}}function AS(n,l,a,s,u){if(u){var h=n[s],v=h.glyph;if(v)for(var m=l[v].advance*h.scale,w=(n[s].x+m)*u,A=a;A<=s;A++)n[A].x-=w}}function Zx(n,l,a,s,u,h,v){var m=(l-a)*u,w=(-s*v+.5)*h,A=zx(n),R;try{for(A.s();!(R=A.n()).done;){var B=R.value;B.x+=m,B.y+=w}}catch(G){A.e(G)}finally{A.f()}}function TS(n,l,a,s,u,h,v){var m=-8,w=0,A=m,R=0,B=n.positionedGlyphs,G=h==="right"?1:h==="left"?0:.5,j=B.length;a.forEach(function(pe){if(pe.split("").forEach(function(Ze){var Qe=l[Ze],wr=0;Qe&&(B.push({glyph:Ze,x:w,y:A+wr,vertical:!1,scale:1,metrics:Qe}),w+=Qe.advance+v)}),B.length!==j){var fe=w-v;R=Math.max(fe,R),AS(B,l,j,B.length-1,G)}w=0,A-=s+5});var lt=CS(u),ct=lt.horizontalAlign,_t=lt.verticalAlign;Zx(B,G,ct,_t,R,s,a.length);var Zt=A-m;n.top+=-_t*Zt,n.bottom=n.top-Zt,n.left+=-ct*R,n.right=n.left+R}function ok(n,l,a,s,u,h,v){var m=-8,w=0,A=m,R=0,B=n.positionedGlyphs,G=h==="right"?1:h==="left"?0:.5,j=B.length;a.forEach(function(pe){var fe=l[pe],Ze=0;if(fe&&(B.push({glyph:pe,x:fe.advance/2,y:A+Ze,vertical:!1,scale:1,metrics:fe}),w+=fe.advance+v),B.length!==j){var Qe=w-v;R=Math.max(Qe,R),AS(B,l,j,B.length-1,G)}w=0,A-=s+5});var lt=CS(u),ct=lt.horizontalAlign,_t=lt.verticalAlign;Zx(B,G,ct,_t,R,s,a.length);var Zt=A-m;n.top+=-_t*Zt,n.bottom=n.top-Zt,n.left+=-ct*R,n.right=n.left+R}function sk(n,l,a,s,u,h){var v=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],m=arguments.length>7?arguments[7]:void 0,w=n.split(`
`),A=[],R={positionedGlyphs:A,top:v[1],bottom:v[1],left:v[0],right:v[0],lineCount:w.length,text:n};return m?ok(R,l,w,a,s,u,h):TS(R,l,w,a,s,u,h),A.length?R:!1}function O0(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],a=arguments.length>2?arguments[2]:void 0,s=n.positionedGlyphs,u=s===void 0?[]:s,h=[],v=zx(u),m;try{for(v.s();!(m=v.n()).done;){var w=m.value,A=w.metrics,R=4,B=A.advance*w.scale/2,G=a?[w.x+B,w.y]:[0,0],j=a?[0,0]:[w.x+B+l[0],w.y+l[1]],lt=(0-R)*w.scale-B+j[0],ct=(0-R)*w.scale+j[1],_t=lt+A.width*w.scale,Zt=ct+A.height*w.scale,pe={x:lt,y:ct},fe={x:_t,y:ct},Ze={x:lt,y:Zt},Qe={x:_t,y:Zt};h.push({tl:pe,tr:fe,bl:Ze,br:Qe,tex:A,glyphOffset:G})}}catch(wr){v.e(wr)}finally{v.f()}return h}function uk(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=lk(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function lk(n,l){if(n){if(typeof n=="string")return MS(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return MS(n,l)}}function MS(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function ck(n){var l=fk();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function fk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Vx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,IS=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp *(vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function Tm(n){var l=this,a=n.id,s=[],u=[];if(!l.glyphInfoMap||!l.glyphInfoMap[a])return{vertices:[],indices:[],size:7};var h=l.glyphInfoMap[a].centroid,v=h.length===2?[h[0],h[1],0]:h;return l.glyphInfoMap[a].glyphQuads.forEach(function(m,w){s.push.apply(s,(0,ve.Z)(v).concat([m.tex.x,m.tex.y+m.tex.height,m.tl.x,m.tl.y],(0,ve.Z)(v),[m.tex.x+m.tex.width,m.tex.y+m.tex.height,m.tr.x,m.tr.y],(0,ve.Z)(v),[m.tex.x+m.tex.width,m.tex.y,m.br.x,m.br.y],(0,ve.Z)(v),[m.tex.x,m.tex.y,m.bl.x,m.bl.y])),u.push(0+w*4,1+w*4,2+w*4,2+w*4,3+w*4,0+w*4)}),{vertices:s,indices:u,size:7}}var kS=function(n){(0,zt.Z)(a,n);var l=ck(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"glyphInfoMap",{}),(0,W.Z)((0,ut.Z)(s),"currentZoom",-1),(0,W.Z)((0,ut.Z)(s),"textureHeight",0),(0,W.Z)((0,ut.Z)(s),"textCount",0),(0,W.Z)((0,ut.Z)(s),"preTextStyle",{}),(0,W.Z)((0,ut.Z)(s),"mapping",(0,J.Z)(ot().mark(function m(){return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return s.initGlyph(),s.updateTexture(),A.next=4,s.reBuildModel();case 4:case"end":return A.stop()}},m)}))),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.stroke,w=m===void 0?"#fff":m,A=u.strokeWidth,R=A===void 0?0:A,B=u.textAnchor,G=B===void 0?"center":B,j=u.textOffset,lt=u.textAllowOverlap,ct=lt===void 0?!1:lt,_t=u.halo,Zt=_t===void 0?.5:_t,pe=u.gamma,fe=pe===void 0?2:pe,Ze=u.raisingHeight,Qe=Ze===void 0?0:Ze,wr=this.fontService,Lr=wr.canvas,Vr=wr.mapping;if(Vr&&Object.keys(Vr).length!==this.textCount&&Lr&&(this.updateTexture(),this.textCount=Object.keys(Vr).length),this.preTextStyle={textAnchor:G,textAllowOverlap:ct,textOffset:j},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeWidth:R,stroke:w})){this.judgeStyleAttributes({opacity:v,strokeWidth:R,stroke:w});var Wr=this.layer.getEncodedData(),bn=this.calDataFrame(this.cellLength,Wr,this.cellProperties),hn=bn.data,Wn=bn.width,vi=bn.height;this.rowCount=vi,this.dataTexture=this.cellLength>0&&hn.length>0?this.createTexture2D({flipY:!0,data:hn,format:se.LUMINANCE,type:se.FLOAT,width:Wn,height:vi}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(Qe),u_opacity:(0,ne.isNumber)(v)?v:1,u_stroke_width:(0,ne.isNumber)(R)?R:1,u_stroke_color:this.getStrokeColor(w),u_sdf_map:this.texture,u_halo_blur:Zt,u_gamma_scale:fe,u_sdf_map_size:[(Lr==null?void 0:Lr.width)||1,(Lr==null?void 0:Lr.height)||1]}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),v=this.layer.getLayerConfig(),m=v.textAnchor,w=m===void 0?"center":m,A=v.textAllowOverlap,R=A===void 0?!0:A,B=v.textOffset,this.preTextStyle={textAnchor:w,textAllowOverlap:R,textOffset:B},j.next=6,this.buildModels();case 6:return j.abrupt("return",j.sent);case 7:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j;return ot().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=v.textAllowOverlap,G=B===void 0?!1:B,this.initGlyph(),this.updateTexture(),G||this.filterGlyphs(),ct.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:IS,fragmentShader:Vx,triangulation:Tm.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R)});case 6:return j=ct.sent,ct.abrupt("return",[j]);case 8:case"end":return ct.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"needUpdate",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct;return ot().wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:if(v=this.layer.getLayerConfig(),m=v.textAllowOverlap,w=m===void 0?!1:m,A=v.textAnchor,R=A===void 0?"center":A,B=v.textOffset,G=this.layer.getEncodedData(),!(JSON.stringify(B)!==JSON.stringify(this.preTextStyle.textOffset)||R!==this.preTextStyle.textAnchor)){Zt.next=6;break}return Zt.next=5,this.mapping();case 5:return Zt.abrupt("return",!0);case 6:if(!(G.length<5||w)){Zt.next=8;break}return Zt.abrupt("return",!1);case 8:if(j=this.mapService.getZoom(),lt=this.mapService.getBounds(),ct=Sl(this.extent,lt),!(Math.abs(this.currentZoom-j)>1||!ct||w!==this.preTextStyle.textAllowOverlap)){Zt.next=15;break}return Zt.next=14,this.reBuildModel();case 14:return Zt.abrupt("return",!0);case 15:return Zt.abrupt("return",!1);case 16:case"end":return Zt.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:ta.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h){var v=h.rotate,m=v===void 0?0:v;return Array.isArray(m)?[m[0]]:[m]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:ta.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m){return[m[5],m[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?12:v;return Array.isArray(m)?[m[0]]:[m]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:ta.Attribute,descriptor:{name:"a_tex",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var u=this.mapService.getBounds();return fu(u,.5)}},{key:"initTextFont",value:function(){var u=this.layer.getLayerConfig(),h=u.fontWeight,v=h===void 0?"400":h,m=u.fontFamily,w=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),R=[];A.forEach(function(B){var G=B.shape,j=G===void 0?"":G;j=j.toString();var lt=uk(j),ct;try{for(lt.s();!(ct=lt.n()).done;){var _t=ct.value;R.indexOf(_t)===-1&&R.push(_t)}}catch(Zt){lt.e(Zt)}finally{lt.f()}}),this.fontService.setFontOptions({characterSet:R,fontWeight:v,fontFamily:w,iconfont:!1})}},{key:"initIconFontTex",value:function(){var u=this.layer.getLayerConfig(),h=u.fontWeight,v=h===void 0?"400":h,m=u.fontFamily,w=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),R=[];A.forEach(function(B){var G=B.shape,j=G===void 0?"":G;j="".concat(j),R.indexOf(j)===-1&&R.push(j)}),this.fontService.setFontOptions({characterSet:R,fontWeight:v,fontFamily:w,iconfont:!0})}},{key:"generateGlyphLayout",value:function(u){var h=this,v=this.fontService.mapping,m=this.layer.getLayerConfig(),w=m.spacing,A=w===void 0?2:w,R=m.textAnchor,B=R===void 0?"center":R,G=m.textOffset,j=this.layer.getEncodedData();this.glyphInfo=j.map(function(lt){var ct=lt.shape,_t=ct===void 0?"":ct,Zt=lt.id,pe=lt.size,fe=pe===void 0?1:pe,Ze=sk(_t.toString(),v,fe,B,"left",A,G||lt.textOffset||[0,0],u),Qe=O0(Ze,G,!1);return lt.shaping=Ze,lt.glyphQuads=Qe,lt.centroid=zl(lt.coordinates),lt.originCentroid=lt.version==="GAODE2.x"?zl(lt.originCoordinates):lt.originCentroid=lt.centroid,h.glyphInfoMap[Zt]={shaping:Ze,glyphQuads:Qe,centroid:zl(lt.coordinates)},lt})}},{key:"filterGlyphs",value:function(){var u=this,h=this.layer.getLayerConfig(),v=h.padding,m=v===void 0?[0,0]:v,w=h.textAllowOverlap,A=w===void 0?!1:w;if(!A){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var R=this.rendererService.getViewportSize(),B=R.width,G=R.height,j=new Nx(B,G),lt=this.glyphInfo.filter(function(ct){var _t=ct.shaping,Zt=ct.id,pe=Zt===void 0?0:Zt,fe=ct.version==="GAODE2.x"?ct.originCentroid:ct.centroid,Ze=ct.size,Qe=Ze/16,wr=u.mapService.lngLatToContainer(fe),Lr=j.placeCollisionBox({x1:_t.left*Qe-m[0],x2:_t.right*Qe+m[0],y1:_t.top*Qe-m[1],y2:_t.bottom*Qe+m[1],anchorPointX:wr.x,anchorPointY:wr.y}),Vr=Lr.box;return Vr&&Vr.length?(j.insertCollisionBox(Vr,pe),!0):!1});lt.forEach(function(ct){u.glyphInfoMap[ct.id]=ct})}}},{key:"initGlyph",value:function(){var u=this.layer.getLayerConfig(),h=u.iconfont,v=h===void 0?!1:h;v?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(v)}},{key:"updateTexture",value:function(){var u=this.rendererService.createTexture2D,h=this.fontService.canvas;this.textureHeight=h.height,this.texture&&this.texture.destroy(),this.texture=u({data:h,mag:se.LINEAR,min:se.LINEAR,width:h.width,height:h.height})}},{key:"reBuildModel",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,this.filterGlyphs(),j.next=4,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:IS,fragmentShader:Vx,triangulation:Tm.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R)});case 4:B=j.sent,this.layer.models=[B];case 6:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()}]),a}(Vo),hk={fillImage:HI,fill:yg,radar:QI,image:mS,normal:xS,simplePoint:rk,extrude:Fx,text:kS,earthFill:RI,earthExtrude:lS},pk=hk;function dk(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vk(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,u=function(){};return{s:u,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:u}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vk(n,l){if(n){if(typeof n=="string")return LS(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return LS(n,l)}}function LS(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function PS(n){var l=gk();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function gk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var m1=function(n){(0,zt.Z)(a,n);var l=PS(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"type","PointLayer"),(0,W.Z)((0,ut.Z)(s),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new pk[v](this),w.next=5,this.initLayerModels();case 5:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"rebuildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var u=this.shapeOption,h=u.field,v=u.values,m=this.getLayerConfig(),w=m.shape2d,A=this.iconService.getIconMap();if(h&&(w==null?void 0:w.indexOf(h))!==-1)return"fill";if(v==="text")return"text";if(v&&v instanceof Array){var R=dk(v),B;try{for(R.s();!(B=R.n()).done;){var G=B.value;if(typeof G=="string"&&A.hasOwnProperty(G))return"image"}}catch(j){R.e(j)}finally{R.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var u=this.getModelType(),h={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return h[u]}},{key:"getModelType",value:function(){var u=this.getEncodedData(),h=this.getLayerConfig(),v=h.shape2d,m=h.shape3d,w=this.iconService.getIconMap(),A=u.find(function(B){return B.hasOwnProperty("shape")});if(A){var R=A.shape;return R==="dot"?"normal":R==="simple"?"simplePoint":R==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(v==null?void 0:v.indexOf(R))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(m==null?void 0:m.indexOf(R))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":w.hasOwnProperty(R)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),a}(hg);function Mm(n){var l=y1();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function y1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var OS=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }

  } else {
     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,FS=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,mk=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,yk=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_Color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,RS=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,_k=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,xk=function(n){(0,zt.Z)(a,n);var l=Mm(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.heightfixed,w=m===void 0?!1:m,A=u.raisingHeight,R=A===void 0?0:A,B=u.topsurface,G=B===void 0?!0:B,j=u.sidesurface,lt=j===void 0?!0:j,ct=u.sourceColor,_t=u.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Zt=this.layer.getEncodedData(),pe=this.calDataFrame(this.cellLength,Zt,this.cellProperties),fe=pe.data,Ze=pe.width,Qe=pe.height;this.rowCount=Qe,this.dataTexture=this.cellLength>0&&fe.length>0?this.createTexture2D({flipY:!0,data:fe,format:se.LUMINANCE,type:se.FLOAT,width:Ze,height:Qe}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}var wr=0,Lr=[1,1,1,1],Vr=[1,1,1,1];return ct&&_t&&(Lr=$e(ct),Vr=$e(_t),wr=1),{u_topsurface:Number(G),u_sidesurface:Number(lt),u_heightfixed:Number(w),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(R),u_opacity:(0,ne.isNumber)(v)?v:1,u_linearColor:wr,u_sourceColor:Lr,u_targetColor:Vr,u_texture:this.texture}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct;return ot().wrap(function(Zt){for(;;)switch(Zt.prev=Zt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=this.getShaders(),G=B.frag,j=B.vert,lt=B.type,Zt.next=4,this.layer.buildLayerModel({moduleName:lt,vertexShader:j,fragmentShader:G,triangulation:Z5,stencil:Di(w,R)});case 4:return ct=Zt.sent,Zt.abrupt("return",[ct]);case 6:case"end":return Zt.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getShaders",value:function(){var u=this.layer.getLayerConfig(),h=u.pickLight,v=u.mapTexture;return v?{frag:mk,vert:yk,type:"polygonExtrudeTexture"}:h?{frag:RS,vert:_k,type:"polygonExtrudePickLight"}:{frag:OS,vert:FS,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var u,h;(u=this.dataTexture)===null||u===void 0||u.destroy(),(h=this.texture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var u=this.layer.getSource().extent,h=(0,yt.Z)(u,4),v=h[0],m=h[1],w=h[2],A=h[3],R=w-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:ta.Attribute,descriptor:{name:"a_uvs",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(j,lt,ct){var _t=ct[0],Zt=ct[1];return[(_t-v)/R,(Zt-m)/B,ct[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:ta.Attribute,descriptor:{name:"a_Normal",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(j,lt,ct,_t,Zt){return Zt}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:ta.Attribute,descriptor:{name:"a_Size",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(j){var lt=j.size,ct=lt===void 0?10:lt;return Array.isArray(ct)?[ct[0]]:[ct]}}})}},{key:"loadTexture",value:function(){var u=this,h=this.layer.getLayerConfig(),v=h.mapTexture,m=this.rendererService.createTexture2D;if(this.texture=m({height:0,width:0}),v){var w=new Image;w.crossOrigin="",w.src=v,w.onload=function(){u.texture=m({data:w,width:w.width,height:w.height,wrapS:se.CLAMP_TO_EDGE,wrapT:se.CLAMP_TO_EDGE,min:se.LINEAR,mag:se.LINEAR}),u.layerService.reRender()}}}}]),a}(Vo);function bk(n){var l=Ek();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Ek(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wk=`uniform float u_opacity: 1.0;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,DS=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Sk=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,F0=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,Im=function(n){(0,zt.Z)(a,n);var l=bk(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.raisingHeight,v=h===void 0?0:h,m=u.opacity,w=m===void 0?1:m,A=u.opacityLinear,R=A===void 0?{enable:!1,dir:"in"}:A;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var B=this.layer.getEncodedData(),G=this.calDataFrame(this.cellLength,B,this.cellProperties),j=G.data,lt=G.width,ct=G.height;this.rowCount=ct,this.dataTexture=this.cellLength>0&&j.length>0?this.createTexture2D({flipY:!0,data:j,format:se.LUMINANCE,type:se.FLOAT,width:lt,height:ct}):this.createTexture2D({flipY:!0,data:[1],format:se.LUMINANCE,type:se.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(v),u_opacity:(0,ne.isNumber)(w)?w:1,u_opacitylinear:Number(R.enable),u_dir:R.dir==="in"?1:0}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe;return ot().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:return v=this.getModelParams(),m=v.frag,w=v.vert,A=v.triangulation,R=v.type,B=this.layer.getLayerConfig(),G=B.mask,j=G===void 0?!1:G,lt=B.maskInside,ct=lt===void 0?!0:lt,_t=B.workerEnabled,Zt=_t===void 0?!1:_t,pe=B.enablePicking,this.layer.triangulation=A,Qe.next=5,this.layer.buildLayerModel({moduleName:R,vertexShader:w,fragmentShader:m,triangulation:A,primitive:se.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Di(j,ct),workerEnabled:Zt,workerOptions:{modelType:R,enablePicking:pe}});case 5:return fe=Qe.sent,Qe.abrupt("return",[fe]);case 7:case"end":return Qe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.dataTexture)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){var u=this.layer.getLayerConfig(),h=u.opacityLinear,v=h===void 0?{enable:!1,dir:"in"}:h;v.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:ta.Attribute,descriptor:{name:"a_linear",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:3,update:function(w,A,R){return[R[3],R[4],R[5]]}}})}},{key:"getModelParams",value:function(){var u=this.layer.getLayerConfig(),h=u.opacityLinear,v=h===void 0?{enable:!1}:h;return v.enable?{frag:DS,vert:Sk,type:"polygonLinear",triangulation:U5}:{frag:wk,vert:F0,type:"polygonFill",triangulation:gd}}}]),a}(Vo);function _g(n){var l=BS();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function BS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ck=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,Ak=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,xg=function(n){(0,zt.Z)(a,n);var l=_g(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.watercolor,w=m===void 0?"#6D99A8":m,A=u.watercolor2,R=A===void 0?"#0F121C":A;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:$e(w),u_watercolor2:$e(R),u_opacity:(0,ne.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:Ak,fragmentShader:Ck,triangulation:Tx,primitive:se.TRIANGLES,depth:{enable:!1},stencil:Di(w,R)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h,v;(u=this.texture1)===null||u===void 0||u.destroy(),(h=this.texture2)===null||h===void 0||h.destroy(),(v=this.texture3)===null||v===void 0||v.destroy()}},{key:"registerBuiltinAttributes",value:function(){var u=this.layer.getSource().extent,h=(0,yt.Z)(u,4),v=h[0],m=h[1],w=h[2],A=h[3],R=w-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:ta.Attribute,descriptor:{name:"a_uv",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(j,lt,ct,_t){var Zt=j.version===Tc["GAODE2.x"]?j.originCoordinates[0][_t]:ct,pe=(0,yt.Z)(Zt,2),fe=pe[0],Ze=pe[1];return[(fe-v)/R,(Ze-m)/B]}}})}},{key:"loadTexture",value:function(){var u=this,h=this.rendererService.createTexture2D,v={height:0,width:0};this.texture1=h(v),this.texture2=h(v),this.texture3=h(v),m(function(A){u.texture1=w(A[0]),u.texture2=w(A[1]),u.texture3=w(A[2]),u.layerService.reRender()});function m(A){var R=0,B=[],G=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];G.map(function(j){var lt=new Image;lt.crossOrigin="",lt.src=j,B.push(lt),lt.onload=function(){R++,R===3&&A(B)}})}function w(A){return h({data:A,width:A.width,height:A.height,wrapS:se.MIRRORED_REPEAT,wrapT:se.MIRRORED_REPEAT,min:se.LINEAR,mag:se.LINEAR})}}}]),a}(Vo);function NS(n){var l=Tk();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Tk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Mk=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,Ik=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,zS=function(n){(0,zt.Z)(a,n);var l=NS(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.speed,w=m===void 0?.5:m;return{u_texture:this.texture,u_speed:w,u_opacity:(0,ne.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:Ik,fragmentShader:Mk,triangulation:Tx,primitive:se.TRIANGLES,depth:{enable:!1},stencil:Di(w,R)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.texture)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){var u=this.layer.getSource().extent,h=(0,yt.Z)(u,4),v=h[0],m=h[1],w=h[2],A=h[3],R=w-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:ta.Attribute,descriptor:{name:"a_uv",buffer:{usage:se.STATIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(j,lt,ct,_t){var Zt=j.version===Tc["GAODE2.x"]?j.originCoordinates[0][_t]:ct,pe=(0,yt.Z)(Zt,2),fe=pe[0],Ze=pe[1];return[(fe-v)/R,(Ze-m)/B]}}})}},{key:"loadTexture",value:function(){var u=this,h=this.layer.getLayerConfig(),v=h.waterTexture,m=this.rendererService.createTexture2D;this.texture=m({height:0,width:0});var w=new Image;w.crossOrigin="",v?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),w.src=v):w.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",w.onload=function(){u.texture=m({data:w,width:w.width,height:w.height,wrapS:se.MIRRORED_REPEAT,wrapT:se.MIRRORED_REPEAT,min:se.LINEAR,mag:se.LINEAR}),u.layerService.reRender()}}}]),a}(Vo),kk={fill:Im,line:nS,extrude:xk,text:kS,point_fill:yg,point_image:mS,point_normal:xS,point_extrude:Fx,water:zS,ocean:xg},Lk=kk;function Pk(n){var l=Ok();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Ok(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var _1=function(n){(0,zt.Z)(a,n);var l=Pk(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"type","PolygonLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=this.getModelType(),this.layerModel=new Lk[v](this),w.next=4,this.initLayerModels();case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getModelType",value:function(){var u,h=this.styleAttributeService.getLayerStyleAttribute("shape"),v=h==null||(u=h.scale)===null||u===void 0?void 0:u.field;return v==="fill"?"fill":v==="extrude"?"extrude":v==="water"?"water":v==="ocean"?"ocean":v==="line"?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var u=this.getEncodedData(),h=this.getLayerConfig(),v=h.shape2d,m=h.shape3d,w=this.iconService.getIconMap(),A=u.find(function(B){return B.hasOwnProperty("shape")});if(A){var R=A.shape;return R==="dot"?"point_normal":(v==null?void 0:v.indexOf(R))!==-1?"point_fill":(m==null?void 0:m.indexOf(R))!==-1?"point_extrude":w.hasOwnProperty(R)?"point_image":"text"}else return"fill"}}]),a}(hg);function Fk(n){var l=Rk();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Rk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Dk=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,Bk=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,Gx=function(n){(0,zt.Z)(a,n);var l=Fk(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?0:h,m=u.color,w=m===void 0?"#000":m;return{u_opacity:(0,ne.isNumber)(v)?v:0,u_color:$e(w)}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:Bk,fragmentShader:Dk,triangulation:Tx,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:se.ALWAYS,ref:1,mask:255},opFront:{fail:se.REPLACE,zfail:se.REPLACE,zpass:se.REPLACE}},pick:!1});case 2:return v=w.sent,w.abrupt("return",[v]);case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;u&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),a}(Vo),Nk={fill:Gx},zk=Nk;function Uk(n){var l=Zk();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Zk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Hx=function(n){(0,zt.Z)(a,n);var l=Uk(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"type","MaskLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=this.getModelType(),this.layerModel=new zk[v](this),w.next=4,this.initLayerModels();case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getModelType",value:function(){return"fill"}}]),a}(hg),US,ZS,VS,R0,x1,Vk,vp,Yp=(US=(0,Tt.b2)(),ZS=(0,Tt.f3)(Dt.IMapService),VS=(0,Tt.f3)(Dt.IFontService),US(R0=(x1=function(){function n(){(0,pt.Z)(this,n),Rn(this,"mapService",Vk,this),Rn(this,"fontService",vp,this)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var u=this,h=s.styleAttributeService;a.hooks.init.tapPromise("DataMappingPlugin",(0,J.Z)(ot().mark(function v(){return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:u.generateMaping(a,{styleAttributeService:h});case 1:case"end":return w.stop()}},v)}))),a.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var v=(0,J.Z)(ot().mark(function m(w){return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(w){R.next=2;break}return R.abrupt("return",w);case 2:return a.dataState.dataMappingNeedUpdate=!1,R.abrupt("return",u.generateMaping(a,{styleAttributeService:h}));case 4:case"end":return R.stop()}},m)}));return function(m){return v.apply(this,arguments)}}()),a.hooks.beforeRender.tap("DataMappingPlugin",function(){var v=a.getSource();if(!(a.layerModelNeedUpdate||!v||!v.inited)){var m=h.getLayerStyleAttributes()||[],w=h.getLayerStyleAttribute("filter"),A=v.data.dataArray;if(!(Array.isArray(A)&&A.length===0)){var R=m.filter(function(j){return j.needRemapping}),B=A;if(w!=null&&w.needRemapping&&w!==null&&w!==void 0&&w.scale&&(B=A.filter(function(j){return u.applyAttributeMapping(w,j)[0]})),R.length){var G=u.mapping(a,R,B,a.getEncodedData());a.setEncodedData(G)}}}})}},{key:"generateMaping",value:function(a,s){var u=this,h=s.styleAttributeService,v=h.getLayerStyleAttributes()||[],m=h.getLayerStyleAttribute("filter"),w=a.getSource().data.dataArray,A=w;m!=null&&m.scale&&(A=w.filter(function(B){return u.applyAttributeMapping(m,B)[0]})),A=a.processData(A);var R=this.mapping(a,v,A,void 0);return a.setEncodedData(R),w.length===0&&a.encodeDataLength===0?!1:(a.emit("dataUpdate",null),!0)}},{key:"mapping",value:function(a,s,u,h){var v=this,m=a.getLayerConfig(),w=m.arrow,A=w===void 0?{enable:!1}:w,R=s.filter(function(G){return G.scale!==void 0}).filter(function(G){return G.name!=="filter"}),B=u.map(function(G,j){var lt=h?h[j]:{},ct=(0,K.Z)({id:G._id,coordinates:G.coordinates},lt);if(R.forEach(function(pe){var fe=v.applyAttributeMapping(pe,G);pe.name==="color"&&(fe=fe.map(function(Ze){return $e(Ze)})),ct[pe.name]=Array.isArray(fe)&&fe.length===1?fe[0]:fe,pe.name==="shape"&&(ct.shape=v.fontService.getIconFontKey(ct[pe.name]))}),A.enable&&(ct.shape==="line"||ct.shape==="halfLine")){var _t=ct.coordinates;if(a.arrowInsertCount<a.encodeDataLength){var Zt=v.getArrowPoints(_t[0],_t[1]);ct.coordinates.splice(1,0,Zt,Zt),a.arrowInsertCount++}}return ct});return s.forEach(function(G){G.needRemapping=!1}),this.adjustData2Amap2Coordinates(B,a),this.adjustData2SimpleCoordinates(B),B}},{key:"adjustData2Amap2Coordinates",value:function(a,s){var u=this;if(a.length>0&&this.mapService.version===Tc["GAODE2.x"]){var h=s.coordCenter||s.getSource().center;typeof a[0].coordinates[0]=="number"?a.filter(function(v){return!v.originCoordinates}).map(function(v){v.version=Tc["GAODE2.x"],v.originCoordinates=(0,ne.cloneDeep)(v.coordinates),v.coordinates=u.mapService.lngLatToCoordByLayer(v.coordinates,h)}):a.filter(function(v){return!v.originCoordinates}).map(function(v){v.version=Tc["GAODE2.x"],v.originCoordinates=(0,ne.cloneDeep)(v.coordinates),v.coordinates=u.mapService.lngLatToCoordsByLayer(v.coordinates,h)})}}},{key:"adjustData2SimpleCoordinates",value:function(a){var s=this;a.length>0&&this.mapService.version===Tc.SIMPLE&&a.map(function(u){u.simpleCoordinate||(u.coordinates=s.unProjectCoordinates(u.coordinates),u.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(a){var s=this;if(typeof a[0]=="number")return this.mapService.simpleMapCoord.unproject(a);if(a[0]&&a[0][0]instanceof Array){var u=[];return a.map(function(v){var m=[];v.map(function(w){m.push(s.mapService.simpleMapCoord.unproject(w))}),u.push(m)}),u}else{var h=[];return a.map(function(v){h.push(s.mapService.simpleMapCoord.unproject(v))}),h}}},{key:"applyAttributeMapping",value:function(a,s){var u;if(!a.scale)return[];var h=(a==null||(u=a.scale)===null||u===void 0?void 0:u.scalers)||[],v=[];h.forEach(function(w){var A,R=w.field;(s.hasOwnProperty(R)||((A=a.scale)===null||A===void 0?void 0:A.type)==="variable")&&v.push(s[R])});var m=a.mapping?a.mapping(v):[];return m}},{key:"getArrowPoints",value:function(a,s){var u=[s[0]-a[0],s[1]-a[1]],h=ki(u),v=[a[0]+h[0]*1e-4,a[1]+h[1]*1e-4];return v}}]),n}(),Vk=Fi(x1.prototype,"mapService",[ZS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vp=Fi(x1.prototype,"fontService",[VS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x1))||R0),zv,jx,$d=(zv=(0,Tt.b2)(),zv(jx=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){var s=this;this.mapService=a.getContainer().get(Dt.IMapService),a.hooks.init.tapPromise("DataSourcePlugin",(0,J.Z)(ot().mark(function u(){var h,v,m,w;return ot().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(h=a.getSource(),h||(v=a.sourceOption||a.defaultSourceConfig,m=v.data,w=v.options,h=new M0(m,w),a.setSource(h)),!h.inited){R.next=6;break}s.updateClusterData(a),R.next=8;break;case 6:return R.next=8,new Promise(function(B){h.on("update",function(G){G.type==="inited"&&s.updateClusterData(a),B(null)})});case 8:case"end":return R.stop()}},u)}))),a.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,J.Z)(ot().mark(function u(){var h,v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return h=s.updateClusterData(a),v=a.dataState.dataSourceNeedUpdate,a.dataState.dataSourceNeedUpdate=!1,w.abrupt("return",h||v);case 4:case"end":return w.stop()}},u)})))}},{key:"updateClusterData",value:function(a){if(a.isTileLayer||a.tileLayer||!a.getSource())return!1;var s=a.getSource(),u=s.cluster,h=s.clusterOptions.zoom,v=h===void 0?0:h,m=this.mapService.getZoom()-1,w=a.dataState.dataSourceNeedUpdate;return u&&w&&s.updateClusterData(Math.floor(m)),u&&Math.abs(a.clusterZoom-m)>=1?(v!==Math.floor(m)&&s.updateClusterData(Math.floor(m)),a.clusterZoom=m,!0):!1}}]),n}())||jx);function Wx(n,l){return n<l?-1:n>l?1:n>=l?0:NaN}function GS(n){return n.length===1&&(n=Gk(n)),{left:function(l,a,s,u){for(s==null&&(s=0),u==null&&(u=l.length);s<u;){var h=s+u>>>1;n(l[h],a)<0?s=h+1:u=h}return s},right:function(l,a,s,u){for(s==null&&(s=0),u==null&&(u=l.length);s<u;){var h=s+u>>>1;n(l[h],a)>0?u=h:s=h+1}return s}}}function Gk(n){return function(l,a){return Wx(n(l),a)}}var HS=GS(Wx),Hk=HS.right,tF=HS.left,b1=Hk;function jS(n,l){var a=n.length,s=-1,u,h,v;if(l==null){for(;++s<a;)if((u=n[s])!=null&&u>=u)for(h=v=u;++s<a;)(u=n[s])!=null&&(h>u&&(h=u),v<u&&(v=u))}else for(;++s<a;)if((u=l(n[s],s,n))!=null&&u>=u)for(h=v=u;++s<a;)(u=l(n[s],s,n))!=null&&(h>u&&(h=u),v<u&&(v=u));return[h,v]}var WS=Array.prototype,eF=WS.slice,DR=WS.map,km=Math.sqrt(50),Uv=Math.sqrt(10),Xx=Math.sqrt(2);function XS(n,l,a){var s,u=-1,h,v,m;if(l=+l,n=+n,a=+a,n===l&&a>0)return[n];if((s=l<n)&&(h=n,n=l,l=h),(m=Lm(n,l,a))===0||!isFinite(m))return[];if(m>0)for(n=Math.ceil(n/m),l=Math.floor(l/m),v=new Array(h=Math.ceil(l-n+1));++u<h;)v[u]=(n+u)*m;else for(n=Math.floor(n*m),l=Math.ceil(l*m),v=new Array(h=Math.ceil(n-l+1));++u<h;)v[u]=(n-u)/m;return s&&v.reverse(),v}function Lm(n,l,a){var s=(l-n)/Math.max(0,a),u=Math.floor(Math.log(s)/Math.LN10),h=s/Math.pow(10,u);return u>=0?(h>=km?10:h>=Uv?5:h>=Xx?2:1)*Math.pow(10,u):-Math.pow(10,-u)/(h>=km?10:h>=Uv?5:h>=Xx?2:1)}function Yx(n,l,a){var s=Math.abs(l-n)/Math.max(0,a),u=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),h=s/u;return h>=km?u*=10:h>=Uv?u*=5:h>=Xx&&(u*=2),l<n?-u:u}function jk(){var n=identity,l=extent,a=sturges;function s(u){var h,v=u.length,m,w=new Array(v);for(h=0;h<v;++h)w[h]=n(u[h],h,u);var A=l(w),R=A[0],B=A[1],G=a(w,R,B);Array.isArray(G)||(G=tickStep(R,B,G),G=range(Math.ceil(R/G)*G,B,G));for(var j=G.length;G[0]<=R;)G.shift(),--j;for(;G[j-1]>B;)G.pop(),--j;var lt=new Array(j+1),ct;for(h=0;h<=j;++h)ct=lt[h]=[],ct.x0=h>0?G[h-1]:R,ct.x1=h<j?G[h]:B;for(h=0;h<v;++h)m=w[h],R<=m&&m<=B&&lt[bisect(G,m,0,j)].push(u[h]);return lt}return s.value=function(u){return arguments.length?(n=typeof u=="function"?u:constant(u),s):n},s.domain=function(u){return arguments.length?(l=typeof u=="function"?u:constant([u[0],u[1]]),s):l},s.thresholds=function(u){return arguments.length?(a=typeof u=="function"?u:Array.isArray(u)?constant(slice.call(u)):constant(u),s):a},s}function rF(n,l,a){return n=map.call(n,number).sort(ascending),Math.ceil((a-l)/(2*(quantile(n,.75)-quantile(n,.25))*Math.pow(n.length,-1/3)))}function Wk(n){return n===null?NaN:+n}function Xk(n,l,a){if(a==null&&(a=Wk),!!(s=n.length)){if((l=+l)<=0||s<2)return+a(n[0],0,n);if(l>=1)return+a(n[s-1],s-1,n);var s,u=(s-1)*l,h=Math.floor(u),v=+a(n[h],h,n),m=+a(n[h+1],h+1,n);return v+(m-v)*(u-h)}}function YS(n,l,a,s,u){var h=n*n,v=h*n;return((1-3*n+3*h-v)*l+(4-6*h+3*v)*a+(1+3*n+3*h-3*v)*s+v*u)/6}function Yk(n){var l=n.length-1;return function(a){var s=a<=0?a=0:a>=1?(a=1,l-1):Math.floor(a*l),u=n[s],h=n[s+1],v=s>0?n[s-1]:2*u-h,m=s<l-1?n[s+2]:2*h-u;return YS((a-s/l)*l,v,u,h,m)}}function $k(n){var l=n.length;return function(a){var s=Math.floor(((a%=1)<0?++a:a)*l),u=n[(s+l-1)%l],h=n[s%l],v=n[(s+1)%l],m=n[(s+2)%l];return YS((a-s/l)*l,u,h,v,m)}}function $S(n){return function(){return n}}function $x(n,l){return function(a){return n+a*l}}function qS(n,l,a){return n=Math.pow(n,a),l=Math.pow(l,a)-n,a=1/a,function(s){return Math.pow(n+s*l,a)}}function nF(n,l){var a=l-n;return a?$x(n,a>180||a<-180?a-360*Math.round(a/360):a):constant(isNaN(n)?l:n)}function KS(n){return(n=+n)==1?QS:function(l,a){return a-l?qS(l,a,n):$S(isNaN(l)?a:l)}}function QS(n,l){var a=l-n;return a?$x(n,a):$S(isNaN(n)?l:n)}var JS=function n(l){var a=KS(l);function s(u,h){var v=a((u=M(u)).r,(h=M(h)).r),m=a(u.g,h.g),w=a(u.b,h.b),A=QS(u.opacity,h.opacity);return function(R){return u.r=v(R),u.g=m(R),u.b=w(R),u.opacity=A(R),u+""}}return s.gamma=n,s}(1);function tC(n){return function(l){var a=l.length,s=new Array(a),u=new Array(a),h=new Array(a),v,m;for(v=0;v<a;++v)m=M(l[v]),s[v]=m.r||0,u[v]=m.g||0,h[v]=m.b||0;return s=n(s),u=n(u),h=n(h),m.opacity=1,function(w){return m.r=s(w),m.g=u(w),m.b=h(w),m+""}}}var qk=tC(Yk),iF=tC($k),gp="$";function E1(){}E1.prototype=eC.prototype={constructor:E1,has:function(n){return gp+n in this},get:function(n){return this[gp+n]},set:function(n,l){return this[gp+n]=l,this},remove:function(n){var l=gp+n;return l in this&&delete this[l]},clear:function(){for(var n in this)n[0]===gp&&delete this[n]},keys:function(){var n=[];for(var l in this)l[0]===gp&&n.push(l.slice(1));return n},values:function(){var n=[];for(var l in this)l[0]===gp&&n.push(this[l]);return n},entries:function(){var n=[];for(var l in this)l[0]===gp&&n.push({key:l.slice(1),value:this[l]});return n},size:function(){var n=0;for(var l in this)l[0]===gp&&++n;return n},empty:function(){for(var n in this)if(n[0]===gp)return!1;return!0},each:function(n){for(var l in this)l[0]===gp&&n(this[l],l.slice(1),this)}};function eC(n,l){var a=new E1;if(n instanceof E1)n.each(function(m,w){a.set(w,m)});else if(Array.isArray(n)){var s=-1,u=n.length,h;if(l==null)for(;++s<u;)a.set(s,n[s]);else for(;++s<u;)a.set(l(h=n[s],s,n),h)}else if(n)for(var v in n)a.set(v,n[v]);return a}var qx=eC;function aF(){var n=[],l=[],a,s,u;function h(m,w,A,R){if(w>=n.length)return a!=null&&m.sort(a),s!=null?s(m):m;for(var B=-1,G=m.length,j=n[w++],lt,ct,_t=map(),Zt,pe=A();++B<G;)(Zt=_t.get(lt=j(ct=m[B])+""))?Zt.push(ct):_t.set(lt,[ct]);return _t.each(function(fe,Ze){R(pe,Ze,h(fe,w,A,R))}),pe}function v(m,w){if(++w>n.length)return m;var A,R=l[w-1];return s!=null&&w>=n.length?A=m.entries():(A=[],m.each(function(B,G){A.push({key:G,values:v(B,w)})})),R!=null?A.sort(function(B,G){return R(B.key,G.key)}):A}return u={object:function(m){return h(m,0,Kk,Qk)},map:function(m){return h(m,0,rC,Kx)},entries:function(m){return v(h(m,0,rC,Kx),0)},key:function(m){return n.push(m),u},sortKeys:function(m){return l[n.length-1]=m,u},sortValues:function(m){return a=m,u},rollup:function(m){return s=m,u}}}function Kk(){return{}}function Qk(n,l,a){n[l]=a}function rC(){return map()}function Kx(n,l,a){n.set(l,a)}function Pm(){}var Zv=qx.prototype;Pm.prototype=nC.prototype={constructor:Pm,has:Zv.has,add:function(n){return n+="",this[gp+n]=n,this},remove:Zv.remove,clear:Zv.clear,values:Zv.keys,size:Zv.size,empty:Zv.empty,each:Zv.each};function nC(n,l){var a=new Pm;if(n instanceof Pm)n.each(function(h){a.add(h)});else if(n){var s=-1,u=n.length;if(l==null)for(;++s<u;)a.add(n[s]);else for(;++s<u;)a.add(l(n[s],s,n))}return a}var oF=null,iC=Array.prototype,aC=iC.map,D0=iC.slice;function Vv(n,l){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(l).domain(n);break}return this}function oC(n,l){switch(arguments.length){case 0:break;case 1:this.interpolator(n);break;default:this.interpolator(l).domain(n);break}return this}var sC={name:"implicit"};function w1(){var n=qx(),l=[],a=[],s=sC;function u(h){var v=h+"",m=n.get(v);if(!m){if(s!==sC)return s;n.set(v,m=l.push(h))}return a[(m-1)%a.length]}return u.domain=function(h){if(!arguments.length)return l.slice();l=[],n=qx();for(var v=-1,m=h.length,w,A;++v<m;)n.has(A=(w=h[v])+"")||n.set(A,l.push(w));return u},u.range=function(h){return arguments.length?(a=D0.call(h),u):a.slice()},u.unknown=function(h){return arguments.length?(s=h,u):s},u.copy=function(){return w1(l,a).unknown(s)},Vv.apply(u,arguments),u}function uC(){var n=ordinal().unknown(void 0),l=n.domain,a=n.range,s=[0,1],u,h,v=!1,m=0,w=0,A=.5;delete n.unknown;function R(){var B=l().length,G=s[1]<s[0],j=s[G-0],lt=s[1-G];u=(lt-j)/Math.max(1,B-m+w*2),v&&(u=Math.floor(u)),j+=(lt-j-u*(B-m))*A,h=u*(1-m),v&&(j=Math.round(j),h=Math.round(h));var ct=sequence(B).map(function(_t){return j+u*_t});return a(G?ct.reverse():ct)}return n.domain=function(B){return arguments.length?(l(B),R()):l()},n.range=function(B){return arguments.length?(s=[+B[0],+B[1]],R()):s.slice()},n.rangeRound=function(B){return s=[+B[0],+B[1]],v=!0,R()},n.bandwidth=function(){return h},n.step=function(){return u},n.round=function(B){return arguments.length?(v=!!B,R()):v},n.padding=function(B){return arguments.length?(m=Math.min(1,w=+B),R()):m},n.paddingInner=function(B){return arguments.length?(m=Math.min(1,B),R()):m},n.paddingOuter=function(B){return arguments.length?(w=+B,R()):w},n.align=function(B){return arguments.length?(A=Math.max(0,Math.min(1,B)),R()):A},n.copy=function(){return uC(l(),s).round(v).paddingInner(m).paddingOuter(w).align(A)},initRange.apply(R(),arguments)}function lC(n){var l=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return lC(l())},n}function sF(){return lC(uC.apply(null,arguments).paddingInner(1))}function BR(n,l){return(isNumberArray(l)?numberArray:cC)(n,l)}function cC(n,l){var a=l?l.length:0,s=n?Math.min(a,n.length):0,u=new Array(s),h=new Array(a),v;for(v=0;v<s;++v)u[v]=A1(n[v],l[v]);for(;v<a;++v)h[v]=l[v];return function(m){for(v=0;v<s;++v)h[v]=u[v](m);return h}}function Jk(n,l){var a=new Date;return n=+n,l=+l,function(s){return a.setTime(n*(1-s)+l*s),a}}function Om(n,l){return n=+n,l=+l,function(a){return n*(1-a)+l*a}}function tL(n,l){var a={},s={},u;(n===null||typeof n!="object")&&(n={}),(l===null||typeof l!="object")&&(l={});for(u in l)u in n?a[u]=A1(n[u],l[u]):s[u]=l[u];return function(h){for(u in a)s[u]=a[u](h);return s}}var S1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,C1=new RegExp(S1.source,"g");function eL(n){return function(){return n}}function Fm(n){return function(l){return n(l)+""}}function rL(n,l){var a=S1.lastIndex=C1.lastIndex=0,s,u,h,v=-1,m=[],w=[];for(n=n+"",l=l+"";(s=S1.exec(n))&&(u=C1.exec(l));)(h=u.index)>a&&(h=l.slice(a,h),m[v]?m[v]+=h:m[++v]=h),(s=s[0])===(u=u[0])?m[v]?m[v]+=u:m[++v]=u:(m[++v]=null,w.push({i:v,x:Om(s,u)})),a=C1.lastIndex;return a<l.length&&(h=l.slice(a),m[v]?m[v]+=h:m[++v]=h),m.length<2?w[0]?Fm(w[0].x):eL(l):(l=w.length,function(A){for(var R=0,B;R<l;++R)m[(B=w[R]).i]=B.x(A);return m.join("")})}function nL(n,l){l||(l=[]);var a=n?Math.min(l.length,n.length):0,s=l.slice(),u;return function(h){for(u=0;u<a;++u)s[u]=n[u]*(1-h)+l[u]*h;return s}}function iL(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function A1(n,l){var a=typeof l,s;return l==null||a==="boolean"?$S(l):(a==="number"?Om:a==="string"?(s=oc(l))?(l=s,JS):rL:l instanceof oc?JS:l instanceof Date?Jk:iL(l)?nL:Array.isArray(l)?cC:typeof l.valueOf!="function"&&typeof l.toString!="function"||isNaN(l)?tL:Om)(n,l)}function aL(n,l){return n=+n,l=+l,function(a){return Math.round(n*(1-a)+l*a)}}function T1(n){return function(){return n}}function fC(n){return+n}var M1=[0,1];function Zc(n){return n}function Qx(n,l){return(l-=n=+n)?function(a){return(a-n)/l}:T1(isNaN(l)?NaN:.5)}function bg(n){var l=n[0],a=n[n.length-1],s;return l>a&&(s=l,l=a,a=s),function(u){return Math.max(l,Math.min(a,u))}}function hC(n,l,a){var s=n[0],u=n[1],h=l[0],v=l[1];return u<s?(s=Qx(u,s),h=a(v,h)):(s=Qx(s,u),h=a(h,v)),function(m){return h(s(m))}}function pC(n,l,a){var s=Math.min(n.length,l.length)-1,u=new Array(s),h=new Array(s),v=-1;for(n[s]<n[0]&&(n=n.slice().reverse(),l=l.slice().reverse());++v<s;)u[v]=Qx(n[v],n[v+1]),h[v]=a(l[v],l[v+1]);return function(m){var w=b1(n,m,1,s)-1;return h[w](u[w](m))}}function Rm(n,l){return l.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function I1(){var n=M1,l=M1,a=A1,s,u,h,v=Zc,m,w,A;function R(){return m=Math.min(n.length,l.length)>2?pC:hC,w=A=null,B}function B(G){return isNaN(G=+G)?h:(w||(w=m(n.map(s),l,a)))(s(v(G)))}return B.invert=function(G){return v(u((A||(A=m(l,n.map(s),Om)))(G)))},B.domain=function(G){return arguments.length?(n=aC.call(G,fC),v===Zc||(v=bg(n)),R()):n.slice()},B.range=function(G){return arguments.length?(l=D0.call(G),R()):l.slice()},B.rangeRound=function(G){return l=D0.call(G),a=aL,R()},B.clamp=function(G){return arguments.length?(v=G?bg(n):Zc,B):v!==Zc},B.interpolate=function(G){return arguments.length?(a=G,R()):a},B.unknown=function(G){return arguments.length?(h=G,B):h},function(G,j){return s=G,u=j,R()}}function Dm(n,l){return I1()(n,l)}var dC=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function k1(n){if(!(l=dC.exec(n)))throw new Error("invalid format: "+n);var l;return new Jx({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}k1.prototype=Jx.prototype;function Jx(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}Jx.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function L1(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function $p(n,l){if((a=(n=l?n.toExponential(l-1):n.toExponential()).indexOf("e"))<0)return null;var a,s=n.slice(0,a);return[s.length>1?s[0]+s.slice(2):s,+n.slice(a+1)]}function mp(n){return n=$p(Math.abs(n)),n?n[1]:NaN}function oL(n,l){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(mp(l)/3)))*3-mp(Math.abs(n)))}function vC(n,l){return function(a,s){for(var u=a.length,h=[],v=0,m=n[0],w=0;u>0&&m>0&&(w+m+1>s&&(m=Math.max(1,s-w)),h.push(a.substring(u-=m,u+m)),!((w+=m+1)>s));)m=n[v=(v+1)%n.length];return h.reverse().join(l)}}function gC(n){return function(l){return l.replace(/[0-9]/g,function(a){return n[+a]})}}function tb(n){t:for(var l=n.length,a=1,s=-1,u;a<l;++a)switch(n[a]){case".":s=u=a;break;case"0":s===0&&(s=a),u=a;break;default:if(!+n[a])break t;s>0&&(s=0);break}return s>0?n.slice(0,s)+n.slice(u+1):n}var eb;function sL(n,l){var a=$p(n,l);if(!a)return n+"";var s=a[0],u=a[1],h=u-(eb=Math.max(-8,Math.min(8,Math.floor(u/3)))*3)+1,v=s.length;return h===v?s:h>v?s+new Array(h-v+1).join("0"):h>0?s.slice(0,h)+"."+s.slice(h):"0."+new Array(1-h).join("0")+$p(n,Math.max(0,l+h-1))[0]}function mC(n,l){var a=$p(n,l);if(!a)return n+"";var s=a[0],u=a[1];return u<0?"0."+new Array(-u).join("0")+s:s.length>u+1?s.slice(0,u+1)+"."+s.slice(u+1):s+new Array(u-s.length+2).join("0")}var yC={"%":function(n,l){return(n*100).toFixed(l)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:L1,e:function(n,l){return n.toExponential(l)},f:function(n,l){return n.toFixed(l)},g:function(n,l){return n.toPrecision(l)},o:function(n){return Math.round(n).toString(8)},p:function(n,l){return mC(n*100,l)},r:mC,s:sL,X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function _C(n){return n}var xC=Array.prototype.map,rb=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function uL(n){var l=n.grouping===void 0||n.thousands===void 0?_C:vC(xC.call(n.grouping,Number),n.thousands+""),a=n.currency===void 0?"":n.currency[0]+"",s=n.currency===void 0?"":n.currency[1]+"",u=n.decimal===void 0?".":n.decimal+"",h=n.numerals===void 0?_C:gC(xC.call(n.numerals,String)),v=n.percent===void 0?"%":n.percent+"",m=n.minus===void 0?"-":n.minus+"",w=n.nan===void 0?"NaN":n.nan+"";function A(B){B=k1(B);var G=B.fill,j=B.align,lt=B.sign,ct=B.symbol,_t=B.zero,Zt=B.width,pe=B.comma,fe=B.precision,Ze=B.trim,Qe=B.type;Qe==="n"?(pe=!0,Qe="g"):yC[Qe]||(fe===void 0&&(fe=12),Ze=!0,Qe="g"),(_t||G==="0"&&j==="=")&&(_t=!0,G="0",j="=");var wr=ct==="$"?a:ct==="#"&&/[boxX]/.test(Qe)?"0"+Qe.toLowerCase():"",Lr=ct==="$"?s:/[%p]/.test(Qe)?v:"",Vr=yC[Qe],Wr=/[defgprs%]/.test(Qe);fe=fe===void 0?6:/[gprs]/.test(Qe)?Math.max(1,Math.min(21,fe)):Math.max(0,Math.min(20,fe));function bn(hn){var Wn=wr,vi=Lr,$i,go,zo;if(Qe==="c")vi=Vr(hn)+vi,hn="";else{hn=+hn;var zs=hn<0||1/hn<0;if(hn=isNaN(hn)?w:Vr(Math.abs(hn),fe),Ze&&(hn=tb(hn)),zs&&+hn==0&&lt!=="+"&&(zs=!1),Wn=(zs?lt==="("?lt:m:lt==="-"||lt==="("?"":lt)+Wn,vi=(Qe==="s"?rb[8+eb/3]:"")+vi+(zs&&lt==="("?")":""),Wr){for($i=-1,go=hn.length;++$i<go;)if(zo=hn.charCodeAt($i),48>zo||zo>57){vi=(zo===46?u+hn.slice($i+1):hn.slice($i))+vi,hn=hn.slice(0,$i);break}}}pe&&!_t&&(hn=l(hn,1/0));var cu=Wn.length+hn.length+vi.length,Xu=cu<Zt?new Array(Zt-cu+1).join(G):"";switch(pe&&_t&&(hn=l(Xu+hn,Xu.length?Zt-vi.length:1/0),Xu=""),j){case"<":hn=Wn+hn+vi+Xu;break;case"=":hn=Wn+Xu+hn+vi;break;case"^":hn=Xu.slice(0,cu=Xu.length>>1)+Wn+hn+vi+Xu.slice(cu);break;default:hn=Xu+Wn+hn+vi;break}return h(hn)}return bn.toString=function(){return B+""},bn}function R(B,G){var j=A((B=k1(B),B.type="f",B)),lt=Math.max(-8,Math.min(8,Math.floor(mp(G)/3)))*3,ct=Math.pow(10,-lt),_t=rb[8+lt/3];return function(Zt){return j(ct*Zt)+_t}}return{format:A,formatPrefix:R}}var P1,nb,bC;lL({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function lL(n){return P1=uL(n),nb=P1.format,bC=P1.formatPrefix,P1}function cL(n,l){return n=Math.abs(n),l=Math.abs(l)-n,Math.max(0,mp(l)-mp(n))+1}function fL(n){return Math.max(0,-mp(Math.abs(n)))}function hL(n,l,a,s){var u=Yx(n,l,a),h;switch(s=k1(s==null?",f":s),s.type){case"s":{var v=Math.max(Math.abs(n),Math.abs(l));return s.precision==null&&!isNaN(h=oL(u,v))&&(s.precision=h),bC(s,v)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(h=cL(u,Math.max(Math.abs(n),Math.abs(l))))&&(s.precision=h-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(h=fL(u))&&(s.precision=h-(s.type==="%")*2);break}}return nb(s)}function Bm(n){var l=n.domain;return n.ticks=function(a){var s=l();return XS(s[0],s[s.length-1],a==null?10:a)},n.tickFormat=function(a,s){var u=l();return hL(u[0],u[u.length-1],a==null?10:a,s)},n.nice=function(a){a==null&&(a=10);var s=l(),u=0,h=s.length-1,v=s[u],m=s[h],w;return m<v&&(w=v,v=m,m=w,w=u,u=h,h=w),w=Lm(v,m,a),w>0?(v=Math.floor(v/w)*w,m=Math.ceil(m/w)*w,w=Lm(v,m,a)):w<0&&(v=Math.ceil(v*w)/w,m=Math.floor(m*w)/w,w=Lm(v,m,a)),w>0?(s[u]=Math.floor(v/w)*w,s[h]=Math.ceil(m/w)*w,l(s)):w<0&&(s[u]=Math.ceil(v*w)/w,s[h]=Math.floor(m*w)/w,l(s)),n},n}function EC(){var n=Dm(Zc,Zc);return n.copy=function(){return Rm(n,EC())},Vv.apply(n,arguments),Bm(n)}function pL(n){var l;function a(s){return isNaN(s=+s)?l:s}return a.invert=a,a.domain=a.range=function(s){return arguments.length?(n=map.call(s,number),a):n.slice()},a.unknown=function(s){return arguments.length?(l=s,a):l},a.copy=function(){return pL(n).unknown(l)},n=arguments.length?map.call(n,number):[0,1],linearish(a)}function wC(n,l){n=n.slice();var a=0,s=n.length-1,u=n[a],h=n[s],v;return h<u&&(v=a,a=s,s=v,v=u,u=h,h=v),n[a]=l.floor(u),n[s]=l.ceil(h),n}function SC(n){return Math.log(n)}function ib(n){return Math.exp(n)}function dL(n){return-Math.log(-n)}function CC(n){return-Math.exp(-n)}function Eg(n){return isFinite(n)?+("1e"+n):n<0?0:n}function vL(n){return n===10?Eg:n===Math.E?Math.exp:function(l){return Math.pow(n,l)}}function gL(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),function(l){return Math.log(l)/n})}function AC(n){return function(l){return-n(-l)}}function mL(n){var l=n(SC,ib),a=l.domain,s=10,u,h;function v(){return u=gL(s),h=vL(s),a()[0]<0?(u=AC(u),h=AC(h),n(dL,CC)):n(SC,ib),l}return l.base=function(m){return arguments.length?(s=+m,v()):s},l.domain=function(m){return arguments.length?(a(m),v()):a()},l.ticks=function(m){var w=a(),A=w[0],R=w[w.length-1],B;(B=R<A)&&(G=A,A=R,R=G);var G=u(A),j=u(R),lt,ct,_t,Zt=m==null?10:+m,pe=[];if(!(s%1)&&j-G<Zt){if(G=Math.round(G)-1,j=Math.round(j)+1,A>0){for(;G<j;++G)for(ct=1,lt=h(G);ct<s;++ct)if(_t=lt*ct,!(_t<A)){if(_t>R)break;pe.push(_t)}}else for(;G<j;++G)for(ct=s-1,lt=h(G);ct>=1;--ct)if(_t=lt*ct,!(_t<A)){if(_t>R)break;pe.push(_t)}}else pe=XS(G,j,Math.min(j-G,Zt)).map(h);return B?pe.reverse():pe},l.tickFormat=function(m,w){if(w==null&&(w=s===10?".0e":","),typeof w!="function"&&(w=nb(w)),m===1/0)return w;m==null&&(m=10);var A=Math.max(1,s*m/l.ticks().length);return function(R){var B=R/h(Math.round(u(R)));return B*s<s-.5&&(B*=s),B<=A?w(R):""}},l.nice=function(){return a(wC(a(),{floor:function(m){return h(Math.floor(u(m)))},ceil:function(m){return h(Math.ceil(u(m)))}}))},l}function ab(){var n=mL(I1()).domain([1,10]);return n.copy=function(){return Rm(n,ab()).base(n.base())},Vv.apply(n,arguments),n}function B0(n){return function(l){return Math.sign(l)*Math.log1p(Math.abs(l/n))}}function ob(n){return function(l){return Math.sign(l)*Math.expm1(Math.abs(l))*n}}function TC(n){var l=1,a=n(B0(l),ob(l));return a.constant=function(s){return arguments.length?n(B0(l=+s),ob(l)):l},linearish(a)}function sb(){var n=TC(transformer());return n.copy=function(){return copy(n,sb()).constant(n.constant())},initRange.apply(n,arguments)}function O1(n){return function(l){return l<0?-Math.pow(-l,n):Math.pow(l,n)}}function ub(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function lb(n){return n<0?-n*n:n*n}function yL(n){var l=n(Zc,Zc),a=1;function s(){return a===1?n(Zc,Zc):a===.5?n(ub,lb):n(O1(a),O1(1/a))}return l.exponent=function(u){return arguments.length?(a=+u,s()):a},Bm(l)}function cb(){var n=yL(I1());return n.copy=function(){return Rm(n,cb()).exponent(n.exponent())},Vv.apply(n,arguments),n}function _L(){return cb.apply(null,arguments).exponent(.5)}function fb(){var n=[],l=[],a=[],s;function u(){var v=0,m=Math.max(1,l.length);for(a=new Array(m-1);++v<m;)a[v-1]=Xk(n,v/m);return h}function h(v){return isNaN(v=+v)?s:l[b1(a,v)]}return h.invertExtent=function(v){var m=l.indexOf(v);return m<0?[NaN,NaN]:[m>0?a[m-1]:n[0],m<a.length?a[m]:n[n.length-1]]},h.domain=function(v){if(!arguments.length)return n.slice();n=[];for(var m=0,w=v.length,A;m<w;++m)A=v[m],A!=null&&!isNaN(A=+A)&&n.push(A);return n.sort(Wx),u()},h.range=function(v){return arguments.length?(l=D0.call(v),u()):l.slice()},h.unknown=function(v){return arguments.length?(s=v,h):s},h.quantiles=function(){return a.slice()},h.copy=function(){return fb().domain(n).range(l).unknown(s)},Vv.apply(h,arguments)}function MC(){var n=0,l=1,a=1,s=[.5],u=[0,1],h;function v(w){return w<=w?u[b1(s,w,0,a)]:h}function m(){var w=-1;for(s=new Array(a);++w<a;)s[w]=((w+1)*l-(w-a)*n)/(a+1);return v}return v.domain=function(w){return arguments.length?(n=+w[0],l=+w[1],m()):[n,l]},v.range=function(w){return arguments.length?(a=(u=D0.call(w)).length-1,m()):u.slice()},v.invertExtent=function(w){var A=u.indexOf(w);return A<0?[NaN,NaN]:A<1?[n,s[0]]:A>=a?[s[a-1],l]:[s[A-1],s[A]]},v.unknown=function(w){return arguments.length&&(h=w),v},v.thresholds=function(){return s.slice()},v.copy=function(){return MC().domain([n,l]).range(u).unknown(h)},Vv.apply(Bm(v),arguments)}function IC(){var n=[.5],l=[0,1],a,s=1;function u(h){return h<=h?l[b1(n,h,0,s)]:a}return u.domain=function(h){return arguments.length?(n=D0.call(h),s=Math.min(n.length,l.length-1),u):n.slice()},u.range=function(h){return arguments.length?(l=D0.call(h),s=Math.min(n.length,l.length-1),u):l.slice()},u.invertExtent=function(h){var v=l.indexOf(h);return[n[v-1],n[v]]},u.unknown=function(h){return arguments.length?(a=h,u):a},u.copy=function(){return IC().domain(n).range(l).unknown(a)},Vv.apply(u,arguments)}var hb=new Date,pb=new Date;function hf(n,l,a,s){function u(h){return n(h=arguments.length===0?new Date:new Date(+h)),h}return u.floor=function(h){return n(h=new Date(+h)),h},u.ceil=function(h){return n(h=new Date(h-1)),l(h,1),n(h),h},u.round=function(h){var v=u(h),m=u.ceil(h);return h-v<m-h?v:m},u.offset=function(h,v){return l(h=new Date(+h),v==null?1:Math.floor(v)),h},u.range=function(h,v,m){var w=[],A;if(h=u.ceil(h),m=m==null?1:Math.floor(m),!(h<v)||!(m>0))return w;do w.push(A=new Date(+h)),l(h,m),n(h);while(A<h&&h<v);return w},u.filter=function(h){return hf(function(v){if(v>=v)for(;n(v),!h(v);)v.setTime(v-1)},function(v,m){if(v>=v)if(m<0)for(;++m<=0;)for(;l(v,-1),!h(v););else for(;--m>=0;)for(;l(v,1),!h(v););})},a&&(u.count=function(h,v){return hb.setTime(+h),pb.setTime(+v),n(hb),n(pb),Math.floor(a(hb,pb))},u.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?u.filter(s?function(v){return s(v)%h===0}:function(v){return u.count(0,v)%h===0}):u}),u}var db=hf(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,l){n.setFullYear(n.getFullYear()+l)},function(n,l){return l.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});db.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:hf(function(l){l.setFullYear(Math.floor(l.getFullYear()/n)*n),l.setMonth(0,1),l.setHours(0,0,0,0)},function(l,a){l.setFullYear(l.getFullYear()+a*n)})};var wg=db,uF=db.range,kC=hf(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,l){n.setMonth(n.getMonth()+l)},function(n,l){return l.getMonth()-n.getMonth()+(l.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()}),LC=kC,xL=kC.range,vb=1e3,Mc=6e4,Nf=36e5,gb=864e5,PC=6048e5;function N0(n){return hf(function(l){l.setDate(l.getDate()-(l.getDay()+7-n)%7),l.setHours(0,0,0,0)},function(l,a){l.setDate(l.getDate()+a*7)},function(l,a){return(a-l-(a.getTimezoneOffset()-l.getTimezoneOffset())*Mc)/PC})}var Gv=N0(0),qp=N0(1),mb=N0(2),yb=N0(3),z0=N0(4),OC=N0(5),FC=N0(6),lF=Gv.range,bL=qp.range,EL=mb.range,cF=yb.range,fF=z0.range,hF=OC.range,pF=FC.range,RC=hf(function(n){n.setHours(0,0,0,0)},function(n,l){n.setDate(n.getDate()+l)},function(n,l){return(l-n-(l.getTimezoneOffset()-n.getTimezoneOffset())*Mc)/gb},function(n){return n.getDate()-1}),_b=RC,dF=RC.range,DC=hf(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*vb-n.getMinutes()*Mc)},function(n,l){n.setTime(+n+l*Nf)},function(n,l){return(l-n)/Nf},function(n){return n.getHours()}),wL=DC,vF=DC.range,BC=hf(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*vb)},function(n,l){n.setTime(+n+l*Mc)},function(n,l){return(l-n)/Mc},function(n){return n.getMinutes()}),SL=BC,gF=BC.range,NC=hf(function(n){n.setTime(n-n.getMilliseconds())},function(n,l){n.setTime(+n+l*vb)},function(n,l){return(l-n)/vb},function(n){return n.getUTCSeconds()}),CL=NC,NR=NC.range,F1=hf(function(){},function(n,l){n.setTime(+n+l)},function(n,l){return l-n});F1.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?hf(function(l){l.setTime(Math.floor(l/n)*n)},function(l,a){l.setTime(+l+a*n)},function(l,a){return(a-l)/n}):F1};var AL=F1,mF=F1.range;function U0(n){return hf(function(l){l.setUTCDate(l.getUTCDate()-(l.getUTCDay()+7-n)%7),l.setUTCHours(0,0,0,0)},function(l,a){l.setUTCDate(l.getUTCDate()+a*7)},function(l,a){return(a-l)/PC})}var zC=U0(0),xb=U0(1),TL=U0(2),ML=U0(3),Sg=U0(4),IL=U0(5),kL=U0(6),yF=zC.range,_F=xb.range,xF=TL.range,zR=ML.range,bF=Sg.range,LL=IL.range,EF=kL.range,bb=hf(function(n){n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCDate(n.getUTCDate()+l)},function(n,l){return(l-n)/gb},function(n){return n.getUTCDate()-1}),UC=bb,wF=bb.range,R1=hf(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCFullYear(n.getUTCFullYear()+l)},function(n,l){return l.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});R1.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:hf(function(l){l.setUTCFullYear(Math.floor(l.getUTCFullYear()/n)*n),l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0)},function(l,a){l.setUTCFullYear(l.getUTCFullYear()+a*n)})};var Cg=R1,SF=R1.range;function Eb(n){if(0<=n.y&&n.y<100){var l=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return l.setFullYear(n.y),l}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function wb(n){if(0<=n.y&&n.y<100){var l=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return l.setUTCFullYear(n.y),l}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function Nm(n,l,a){return{y:n,m:l,d:a,H:0,M:0,S:0,L:0}}function PL(n){var l=n.dateTime,a=n.date,s=n.time,u=n.periods,h=n.days,v=n.shortDays,m=n.months,w=n.shortMonths,A=D1(u),R=zm(u),B=D1(h),G=zm(h),j=D1(v),lt=zm(v),ct=D1(m),_t=zm(m),Zt=D1(w),pe=zm(w),fe={a:zs,A:cu,b:Xu,B:zh,c:null,d:YC,e:YC,f:KL,g:r4,G:Sb,H:YL,I:$L,j:qL,L:$C,m:TF,M:qC,p:m2,q:p_,Q:rA,s:kb,S:KC,u:QC,U:B1,V:QL,w:JL,W:t4,x:null,X:null,y:e4,Y:n4,Z:i4,"%":eA},Ze={a:y2,A:LT,b:cO,B:PT,c:null,d:Zm,e:Zm,f:JC,g:h4,G:d4,H:Cb,I:Ab,j:a4,L:Tb,m:N1,M:Mb,p:s8,q:u8,Q:rA,s:kb,S:o4,u:s4,U:u4,V:tA,w:l4,W:c4,x:null,X:null,y:f4,Y:p4,Z:v4,"%":eA},Qe={a:bn,A:hn,b:Wn,B:vi,c:$i,d:jC,e:jC,f:jL,g:HC,G:GC,H:XC,I:XC,j:WC,L:HL,m:ZL,M:VL,p:Wr,q:UL,Q:WL,s:XL,S:GL,u:DL,U:BL,V:NL,w:RL,W:zL,x:go,X:zo,y:HC,Y:GC,Z:CF,"%":AF};fe.x=wr(a,fe),fe.X=wr(s,fe),fe.c=wr(l,fe),Ze.x=wr(a,Ze),Ze.X=wr(s,Ze),Ze.c=wr(l,Ze);function wr(Fa,ys){return function(Us){var Yi=[],Uh=-1,Yu=0,xp=Fa.length,bp,hy,RR;for(Us instanceof Date||(Us=new Date(+Us));++Uh<xp;)Fa.charCodeAt(Uh)===37&&(Yi.push(Fa.slice(Yu,Uh)),(hy=ZC[bp=Fa.charAt(++Uh)])!=null?bp=Fa.charAt(++Uh):hy=bp==="e"?" ":"0",(RR=ys[bp])&&(bp=RR(Us,hy)),Yi.push(bp),Yu=Uh+1);return Yi.push(Fa.slice(Yu,Uh)),Yi.join("")}}function Lr(Fa,ys){return function(Us){var Yi=Nm(1900,void 0,1),Uh=Vr(Yi,Fa,Us+="",0),Yu,xp;if(Uh!=Us.length)return null;if("Q"in Yi)return new Date(Yi.Q);if("s"in Yi)return new Date(Yi.s*1e3+("L"in Yi?Yi.L:0));if(ys&&!("Z"in Yi)&&(Yi.Z=0),"p"in Yi&&(Yi.H=Yi.H%12+Yi.p*12),Yi.m===void 0&&(Yi.m="q"in Yi?Yi.q:0),"V"in Yi){if(Yi.V<1||Yi.V>53)return null;"w"in Yi||(Yi.w=1),"Z"in Yi?(Yu=wb(Nm(Yi.y,0,1)),xp=Yu.getUTCDay(),Yu=xp>4||xp===0?xb.ceil(Yu):xb(Yu),Yu=UC.offset(Yu,(Yi.V-1)*7),Yi.y=Yu.getUTCFullYear(),Yi.m=Yu.getUTCMonth(),Yi.d=Yu.getUTCDate()+(Yi.w+6)%7):(Yu=Eb(Nm(Yi.y,0,1)),xp=Yu.getDay(),Yu=xp>4||xp===0?qp.ceil(Yu):qp(Yu),Yu=_b.offset(Yu,(Yi.V-1)*7),Yi.y=Yu.getFullYear(),Yi.m=Yu.getMonth(),Yi.d=Yu.getDate()+(Yi.w+6)%7)}else("W"in Yi||"U"in Yi)&&("w"in Yi||(Yi.w="u"in Yi?Yi.u%7:"W"in Yi?1:0),xp="Z"in Yi?wb(Nm(Yi.y,0,1)).getUTCDay():Eb(Nm(Yi.y,0,1)).getDay(),Yi.m=0,Yi.d="W"in Yi?(Yi.w+6)%7+Yi.W*7-(xp+5)%7:Yi.w+Yi.U*7-(xp+6)%7);return"Z"in Yi?(Yi.H+=Yi.Z/100|0,Yi.M+=Yi.Z%100,wb(Yi)):Eb(Yi)}}function Vr(Fa,ys,Us,Yi){for(var Uh=0,Yu=ys.length,xp=Us.length,bp,hy;Uh<Yu;){if(Yi>=xp)return-1;if(bp=ys.charCodeAt(Uh++),bp===37){if(bp=ys.charAt(Uh++),hy=Qe[bp in ZC?ys.charAt(Uh++):bp],!hy||(Yi=hy(Fa,Us,Yi))<0)return-1}else if(bp!=Us.charCodeAt(Yi++))return-1}return Yi}function Wr(Fa,ys,Us){var Yi=A.exec(ys.slice(Us));return Yi?(Fa.p=R[Yi[0].toLowerCase()],Us+Yi[0].length):-1}function bn(Fa,ys,Us){var Yi=j.exec(ys.slice(Us));return Yi?(Fa.w=lt[Yi[0].toLowerCase()],Us+Yi[0].length):-1}function hn(Fa,ys,Us){var Yi=B.exec(ys.slice(Us));return Yi?(Fa.w=G[Yi[0].toLowerCase()],Us+Yi[0].length):-1}function Wn(Fa,ys,Us){var Yi=Zt.exec(ys.slice(Us));return Yi?(Fa.m=pe[Yi[0].toLowerCase()],Us+Yi[0].length):-1}function vi(Fa,ys,Us){var Yi=ct.exec(ys.slice(Us));return Yi?(Fa.m=_t[Yi[0].toLowerCase()],Us+Yi[0].length):-1}function $i(Fa,ys,Us){return Vr(Fa,l,ys,Us)}function go(Fa,ys,Us){return Vr(Fa,a,ys,Us)}function zo(Fa,ys,Us){return Vr(Fa,s,ys,Us)}function zs(Fa){return v[Fa.getDay()]}function cu(Fa){return h[Fa.getDay()]}function Xu(Fa){return w[Fa.getMonth()]}function zh(Fa){return m[Fa.getMonth()]}function m2(Fa){return u[+(Fa.getHours()>=12)]}function p_(Fa){return 1+~~(Fa.getMonth()/3)}function y2(Fa){return v[Fa.getUTCDay()]}function LT(Fa){return h[Fa.getUTCDay()]}function cO(Fa){return w[Fa.getUTCMonth()]}function PT(Fa){return m[Fa.getUTCMonth()]}function s8(Fa){return u[+(Fa.getUTCHours()>=12)]}function u8(Fa){return 1+~~(Fa.getUTCMonth()/3)}return{format:function(Fa){var ys=wr(Fa+="",fe);return ys.toString=function(){return Fa},ys},parse:function(Fa){var ys=Lr(Fa+="",!1);return ys.toString=function(){return Fa},ys},utcFormat:function(Fa){var ys=wr(Fa+="",Ze);return ys.toString=function(){return Fa},ys},utcParse:function(Fa){var ys=Lr(Fa+="",!0);return ys.toString=function(){return Fa},ys}}}var ZC={"-":"",_:" ",0:"0"},dc=/^\s*\d+/,OL=/^%/,FL=/[\\^$*+?|[\]().{}]/g;function As(n,l,a){var s=n<0?"-":"",u=(s?-n:n)+"",h=u.length;return s+(h<a?new Array(a-h+1).join(l)+u:u)}function VC(n){return n.replace(FL,"\\$&")}function D1(n){return new RegExp("^(?:"+n.map(VC).join("|")+")","i")}function zm(n){for(var l={},a=-1,s=n.length;++a<s;)l[n[a].toLowerCase()]=a;return l}function RL(n,l,a){var s=dc.exec(l.slice(a,a+1));return s?(n.w=+s[0],a+s[0].length):-1}function DL(n,l,a){var s=dc.exec(l.slice(a,a+1));return s?(n.u=+s[0],a+s[0].length):-1}function BL(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.U=+s[0],a+s[0].length):-1}function NL(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.V=+s[0],a+s[0].length):-1}function zL(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.W=+s[0],a+s[0].length):-1}function GC(n,l,a){var s=dc.exec(l.slice(a,a+4));return s?(n.y=+s[0],a+s[0].length):-1}function HC(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.y=+s[0]+(+s[0]>68?1900:2e3),a+s[0].length):-1}function CF(n,l,a){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(l.slice(a,a+6));return s?(n.Z=s[1]?0:-(s[2]+(s[3]||"00")),a+s[0].length):-1}function UL(n,l,a){var s=dc.exec(l.slice(a,a+1));return s?(n.q=s[0]*3-3,a+s[0].length):-1}function ZL(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.m=s[0]-1,a+s[0].length):-1}function jC(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.d=+s[0],a+s[0].length):-1}function WC(n,l,a){var s=dc.exec(l.slice(a,a+3));return s?(n.m=0,n.d=+s[0],a+s[0].length):-1}function XC(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.H=+s[0],a+s[0].length):-1}function VL(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.M=+s[0],a+s[0].length):-1}function GL(n,l,a){var s=dc.exec(l.slice(a,a+2));return s?(n.S=+s[0],a+s[0].length):-1}function HL(n,l,a){var s=dc.exec(l.slice(a,a+3));return s?(n.L=+s[0],a+s[0].length):-1}function jL(n,l,a){var s=dc.exec(l.slice(a,a+6));return s?(n.L=Math.floor(s[0]/1e3),a+s[0].length):-1}function AF(n,l,a){var s=OL.exec(l.slice(a,a+1));return s?a+s[0].length:-1}function WL(n,l,a){var s=dc.exec(l.slice(a));return s?(n.Q=+s[0],a+s[0].length):-1}function XL(n,l,a){var s=dc.exec(l.slice(a));return s?(n.s=+s[0],a+s[0].length):-1}function YC(n,l){return As(n.getDate(),l,2)}function YL(n,l){return As(n.getHours(),l,2)}function $L(n,l){return As(n.getHours()%12||12,l,2)}function qL(n,l){return As(1+_b.count(wg(n),n),l,3)}function $C(n,l){return As(n.getMilliseconds(),l,3)}function KL(n,l){return $C(n,l)+"000"}function TF(n,l){return As(n.getMonth()+1,l,2)}function qC(n,l){return As(n.getMinutes(),l,2)}function KC(n,l){return As(n.getSeconds(),l,2)}function QC(n){var l=n.getDay();return l===0?7:l}function B1(n,l){return As(Gv.count(wg(n)-1,n),l,2)}function Um(n){var l=n.getDay();return l>=4||l===0?z0(n):z0.ceil(n)}function QL(n,l){return n=Um(n),As(z0.count(wg(n),n)+(wg(n).getDay()===4),l,2)}function JL(n){return n.getDay()}function t4(n,l){return As(qp.count(wg(n)-1,n),l,2)}function e4(n,l){return As(n.getFullYear()%100,l,2)}function r4(n,l){return n=Um(n),As(n.getFullYear()%100,l,2)}function n4(n,l){return As(n.getFullYear()%1e4,l,4)}function Sb(n,l){var a=n.getDay();return n=a>=4||a===0?z0(n):z0.ceil(n),As(n.getFullYear()%1e4,l,4)}function i4(n){var l=n.getTimezoneOffset();return(l>0?"-":(l*=-1,"+"))+As(l/60|0,"0",2)+As(l%60,"0",2)}function Zm(n,l){return As(n.getUTCDate(),l,2)}function Cb(n,l){return As(n.getUTCHours(),l,2)}function Ab(n,l){return As(n.getUTCHours()%12||12,l,2)}function a4(n,l){return As(1+UC.count(Cg(n),n),l,3)}function Tb(n,l){return As(n.getUTCMilliseconds(),l,3)}function JC(n,l){return Tb(n,l)+"000"}function N1(n,l){return As(n.getUTCMonth()+1,l,2)}function Mb(n,l){return As(n.getUTCMinutes(),l,2)}function o4(n,l){return As(n.getUTCSeconds(),l,2)}function s4(n){var l=n.getUTCDay();return l===0?7:l}function u4(n,l){return As(zC.count(Cg(n)-1,n),l,2)}function Ib(n){var l=n.getUTCDay();return l>=4||l===0?Sg(n):Sg.ceil(n)}function tA(n,l){return n=Ib(n),As(Sg.count(Cg(n),n)+(Cg(n).getUTCDay()===4),l,2)}function l4(n){return n.getUTCDay()}function c4(n,l){return As(xb.count(Cg(n)-1,n),l,2)}function f4(n,l){return As(n.getUTCFullYear()%100,l,2)}function h4(n,l){return n=Ib(n),As(n.getUTCFullYear()%100,l,2)}function p4(n,l){return As(n.getUTCFullYear()%1e4,l,4)}function d4(n,l){var a=n.getUTCDay();return n=a>=4||a===0?Sg(n):Sg.ceil(n),As(n.getUTCFullYear()%1e4,l,4)}function v4(){return"+0000"}function eA(){return"%"}function rA(n){return+n}function kb(n){return Math.floor(+n/1e3)}var Ag,nA,g4,m4,y4;_4({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _4(n){return Ag=PL(n),nA=Ag.format,g4=Ag.parse,m4=Ag.utcFormat,y4=Ag.utcParse,Ag}var Vm=1e3,z1=Vm*60,Z0=z1*60,Tg=Z0*24,Gm=Tg*7,iA=Tg*30,Lb=Tg*365;function aA(n){return new Date(n)}function Hm(n){return n instanceof Date?+n:+new Date(+n)}function Pb(n,l,a,s,u,h,v,m,w){var A=Dm(Zc,Zc),R=A.invert,B=A.domain,G=w(".%L"),j=w(":%S"),lt=w("%I:%M"),ct=w("%I %p"),_t=w("%a %d"),Zt=w("%b %d"),pe=w("%B"),fe=w("%Y"),Ze=[[v,1,Vm],[v,5,5*Vm],[v,15,15*Vm],[v,30,30*Vm],[h,1,z1],[h,5,5*z1],[h,15,15*z1],[h,30,30*z1],[u,1,Z0],[u,3,3*Z0],[u,6,6*Z0],[u,12,12*Z0],[s,1,Tg],[s,2,2*Tg],[a,1,Gm],[l,1,iA],[l,3,3*iA],[n,1,Lb]];function Qe(Lr){return(v(Lr)<Lr?G:h(Lr)<Lr?j:u(Lr)<Lr?lt:s(Lr)<Lr?ct:l(Lr)<Lr?a(Lr)<Lr?_t:Zt:n(Lr)<Lr?pe:fe)(Lr)}function wr(Lr,Vr,Wr,bn){if(Lr==null&&(Lr=10),typeof Lr=="number"){var hn=Math.abs(Wr-Vr)/Lr,Wn=GS(function(vi){return vi[2]}).right(Ze,hn);Wn===Ze.length?(bn=Yx(Vr/Lb,Wr/Lb,Lr),Lr=n):Wn?(Wn=Ze[hn/Ze[Wn-1][2]<Ze[Wn][2]/hn?Wn-1:Wn],bn=Wn[1],Lr=Wn[0]):(bn=Math.max(Yx(Vr,Wr,Lr),1),Lr=m)}return bn==null?Lr:Lr.every(bn)}return A.invert=function(Lr){return new Date(R(Lr))},A.domain=function(Lr){return arguments.length?B(aC.call(Lr,Hm)):B().map(aA)},A.ticks=function(Lr,Vr){var Wr=B(),bn=Wr[0],hn=Wr[Wr.length-1],Wn=hn<bn,vi;return Wn&&(vi=bn,bn=hn,hn=vi),vi=wr(Lr,bn,hn,Vr),vi=vi?vi.range(bn,hn+1):[],Wn?vi.reverse():vi},A.tickFormat=function(Lr,Vr){return Vr==null?Qe:w(Vr)},A.nice=function(Lr,Vr){var Wr=B();return(Lr=wr(Lr,Wr[0],Wr[Wr.length-1],Vr))?B(wC(Wr,Lr)):A},A.copy=function(){return Rm(A,Pb(n,l,a,s,u,h,v,m,w))},A}function x4(){return Vv.apply(Pb(wg,LC,Gv,_b,wL,SL,CL,AL,nA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function MF(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function U1(){var n=0,l=1,a,s,u,h,v=Zc,m=!1,w;function A(R){return isNaN(R=+R)?w:v(u===0?.5:(R=(h(R)-a)*u,m?Math.max(0,Math.min(1,R)):R))}return A.domain=function(R){return arguments.length?(a=h(n=+R[0]),s=h(l=+R[1]),u=a===s?0:1/(s-a),A):[n,l]},A.clamp=function(R){return arguments.length?(m=!!R,A):m},A.interpolator=function(R){return arguments.length?(v=R,A):v},A.unknown=function(R){return arguments.length?(w=R,A):w},function(R){return h=R,a=R(n),s=R(l),u=a===s?0:1/(s-a),A}}function jm(n,l){return l.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function oA(){var n=Bm(U1()(Zc));return n.copy=function(){return jm(n,oA())},oC.apply(n,arguments)}function b4(){var n=loggish(U1()).domain([1,10]);return n.copy=function(){return jm(n,b4()).base(n.base())},initInterpolator.apply(n,arguments)}function E4(){var n=symlogish(U1());return n.copy=function(){return jm(n,E4()).constant(n.constant())},initInterpolator.apply(n,arguments)}function sA(){var n=powish(U1());return n.copy=function(){return jm(n,sA()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function IF(){return sA.apply(null,arguments).exponent(.5)}function w4(){var n=[],l=identity;function a(s){if(!isNaN(s=+s))return l((bisect(n,s)-1)/(n.length-1))}return a.domain=function(s){if(!arguments.length)return n.slice();n=[];for(var u=0,h=s.length,v;u<h;++u)v=s[u],v!=null&&!isNaN(v=+v)&&n.push(v);return n.sort(ascending),a},a.interpolator=function(s){return arguments.length?(l=s,a):l},a.copy=function(){return w4(l).domain(n)},initInterpolator.apply(a,arguments)}function Z1(){var n=0,l=.5,a=1,s,u,h,v,m,w=Zc,A,R=!1,B;function G(j){return isNaN(j=+j)?B:(j=.5+((j=+A(j))-u)*(j<u?v:m),w(R?Math.max(0,Math.min(1,j)):j))}return G.domain=function(j){return arguments.length?(s=A(n=+j[0]),u=A(l=+j[1]),h=A(a=+j[2]),v=s===u?0:.5/(u-s),m=u===h?0:.5/(h-u),G):[n,l,a]},G.clamp=function(j){return arguments.length?(R=!!j,G):R},G.interpolator=function(j){return arguments.length?(w=j,G):w},G.unknown=function(j){return arguments.length?(B=j,G):B},function(j){return A=j,s=j(n),u=j(l),h=j(a),v=s===u?0:.5/(u-s),m=u===h?0:.5/(h-u),G}}function Ob(){var n=Bm(Z1()(Zc));return n.copy=function(){return jm(n,Ob())},oC.apply(n,arguments)}function S4(){var n=loggish(Z1()).domain([.1,1,10]);return n.copy=function(){return copy(n,S4()).base(n.base())},initInterpolator.apply(n,arguments)}function C4(){var n=symlogish(Z1());return n.copy=function(){return copy(n,C4()).constant(n.constant())},initInterpolator.apply(n,arguments)}function uA(){var n=powish(Z1());return n.copy=function(){return copy(n,uA()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function kF(){return uA.apply(null,arguments).exponent(.5)}function V1(n){var l,a=[];function s(u){return u==null?l:u}return s.invert=s,s.domain=s.range=function(u){return u?(a=u,u):a},s.unknown=function(u){return u?(l=u,u):l},s.copy=function(){return V1(n).unknown(l)},s}var pf,lA,cA,A4=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,G1=(pf={},(0,W.Z)(pf,Os.LINEAR,EC),(0,W.Z)(pf,Os.POWER,cb),(0,W.Z)(pf,Os.LOG,ab),(0,W.Z)(pf,Os.IDENTITY,V1),(0,W.Z)(pf,Os.SEQUENTIAL,oA),(0,W.Z)(pf,Os.TIME,x4),(0,W.Z)(pf,Os.QUANTILE,fb),(0,W.Z)(pf,Os.QUANTIZE,MC),(0,W.Z)(pf,Os.THRESHOLD,IC),(0,W.Z)(pf,Os.CAT,w1),(0,W.Z)(pf,Os.DIVERGING,Ob),pf),T4=(lA=(0,Tt.b2)(),lA(cA=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"scaleOptions",{})}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var u=this,h=s.styleAttributeService;a.hooks.init.tapPromise("FeatureScalePlugin",(0,J.Z)(ot().mark(function v(){var m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(u.scaleOptions=a.getScaleOptions(),w=h.getLayerStyleAttributes(),A=(m=a.getSource())===null||m===void 0?void 0:m.data.dataArray,!(Array.isArray(A)&&A.length===0)){B.next=7;break}return B.abrupt("return");case 7:u.caculateScalesForAttributes(w||[],A);case 8:case"end":return B.stop()}},v)}))),a.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var v=(0,J.Z)(ot().mark(function m(w){var A,R;return ot().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(w){G.next=2;break}return G.abrupt("return",w);case 2:if(u.scaleOptions=a.getScaleOptions(),A=h.getLayerStyleAttributes(),R=a.getSource().data.dataArray,!(Array.isArray(R)&&R.length===0)){G.next=7;break}return G.abrupt("return",!0);case 7:return u.caculateScalesForAttributes(A||[],R),a.layerModelNeedUpdate=!0,G.abrupt("return",!0);case 10:case"end":return G.stop()}},m)}));return function(m){return v.apply(this,arguments)}}()),a.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!a.layerModelNeedUpdate){u.scaleOptions=a.getScaleOptions();var v=h.getLayerStyleAttributes(),m=a.getSource().data.dataArray;if(!(Array.isArray(m)&&m.length===0)&&v){var w=v.filter(function(A){return A.needRescale});w.length&&u.caculateScalesForAttributes(w,m)}}})}},{key:"isNumber",value:function(a){return!isNaN(parseFloat(a))&&isFinite(a)}},{key:"caculateScalesForAttributes",value:function(a,s){var u=this;a.forEach(function(h){if(h.scale){var v=h.scale;v.names=u.parseFields(h.scale.field||[]);var m=[];v.names.forEach(function(w){var A;m.push(u.createScale(w,h.name,(A=h.scale)===null||A===void 0?void 0:A.values,s))}),m.some(function(w){return w.type===Gp.VARIABLE})?(v.type=Gp.VARIABLE,m.forEach(function(w){var A;if(!v.callback&&v.values!=="text")switch((A=w.option)===null||A===void 0?void 0:A.type){case Os.LOG:case Os.LINEAR:case Os.POWER:if(v.values&&v.values.length>2){var R=w.scale.ticks(v.values.length);w.scale.domain(R)}v.values?w.scale.range(v.values):w.scale.range(w.option.domain);break;case Os.QUANTILE:case Os.QUANTIZE:case Os.THRESHOLD:w.scale.range(v.values);break;case Os.IDENTITY:break;case Os.CAT:v.values?w.scale.range(v.values):w.scale.range(w.option.domain);break;case Os.DIVERGING:case Os.SEQUENTIAL:w.scale.interpolator(qk(v.values));break}if(v.values==="text"){var B;w.scale.range((B=w.option)===null||B===void 0?void 0:B.domain)}})):(v.type=Gp.CONSTANT,v.defaultValues=m.map(function(w,A){return w.scale(v.names[A])})),v.scalers=m.map(function(w){return{field:w.field,func:w.scale,option:w.option}}),h.needRescale=!1}})}},{key:"parseFields",value:function(a){return Array.isArray(a)?a:(0,ne.isString)(a)?a.split("*"):[a]}},{key:"createScale",value:function(a,s,u,h){var v,m,w=this.scaleOptions[s]&&((v=this.scaleOptions[s])===null||v===void 0?void 0:v.field)===a?this.scaleOptions[s]:this.scaleOptions[a],A={field:a,scale:void 0,type:Gp.VARIABLE,option:w};if(!h||!h.length)return w&&w.type?A.scale=this.createDefaultScale(w):(A.scale=w1([a]),A.type=Gp.CONSTANT),A;var R=(m=h.find(function(j){return!(0,ne.isNil)(j[a])}))===null||m===void 0?void 0:m[a];if(this.isNumber(a)||(0,ne.isNil)(R)&&!w)A.scale=w1([a]),A.type=Gp.CONSTANT;else{var B=w&&w.type||this.getDefaultType(R);u==="text"&&(B=Os.CAT);var G=this.createScaleConfig(B,a,w,h);A.scale=this.createDefaultScale(G),A.option=G}return A}},{key:"getDefaultType",value:function(a){var s=Os.LINEAR;return typeof a=="string"&&(s=A4.test(a)?Os.TIME:Os.CAT),s}},{key:"createScaleConfig",value:function(a,s,u,h){var v={type:a},m=(h==null?void 0:h.map(function(R){return R[s]}))||[];if(u!=null&&u.domain)v.domain=u==null?void 0:u.domain;else if(a===Os.CAT||a===Os.IDENTITY)v.domain=(0,ne.uniq)(m);else if(a===Os.QUANTILE)v.domain=m;else if(a===Os.DIVERGING){var w=jS(m),A=(u==null?void 0:u.neutral)!==void 0?u==null?void 0:u.neutral:(w[0]+w[1])/2;v.domain=[w[0],A,w[1]]}else v.domain=jS(m);return(0,K.Z)((0,K.Z)({},v),u)}},{key:"createDefaultScale",value:function(a){var s=a.type,u=a.domain,h=a.unknown,v=a.clamp,m=a.nice,w=G1[s]();return u&&w.domain&&w.domain(u),h&&w.unknown(h),v!==void 0&&w.clamp&&w.clamp(v),m!==void 0&&w.nice&&w.nice(m),w}}]),n}())||cA),fA,Wm,hA=(fA=(0,Tt.b2)(),fA(Wm=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var s=a.animateStatus;s&&a.models.forEach(function(u){u.addUniforms((0,K.Z)({},a.layerModel.getAnimateUniforms()))})})}}]),n}())||Wm),pA=function(){function n(l){var a=l.rendererService,s=l.layerService,u=l.parent;(0,pt.Z)(this,n),(0,W.Z)(this,"tileResource",new Map),(0,W.Z)(this,"_tiles",[]),this.rendererService=a,this.layerService=s,this.parent=u}return(0,et.Z)(n,[{key:"tiles",get:function(){return this._tiles}},{key:"hasTile",value:function(a){return this._tiles.some(function(s){return s.key===a})}},{key:"addTile",value:function(a){this._tiles.push(a)}},{key:"getTile",value:function(a){return this._tiles.find(function(s){return s.key===a})}},{key:"getVisibleTileBylngLat",value:function(a){return this._tiles.find(function(s){return s.isLoaded&&s.visible&&s.lnglatInBounds(a)})}},{key:"removeTile",value:function(a){var s=this._tiles.findIndex(function(h){return h.key===a}),u=this._tiles.splice(s,1);u[0]&&u[0].destroy()}},{key:"updateTileVisible",value:function(a){var s=this.getTile(a.key);s==null||s.updateVisible(a.isVisible)}},{key:"isParentLoaded",value:function(a){var s=a.parent;if(!s)return!0;var u=this.getTile(s==null?void 0:s.key);return!!(u!=null&&u.isLoaded)}},{key:"isChildrenLoaded",value:function(a){var s=this,u=a==null?void 0:a.children;return u.length===0?!0:u.some(function(h){var v=s.getTile(h==null?void 0:h.key);return(v==null?void 0:v.isLoaded)===!1})}},{key:"render",value:function(){var l=(0,J.Z)(ot().mark(function s(){var u=this,h;return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:h=this.getRenderLayers(),h.map(function(){var w=(0,J.Z)(ot().mark(function A(R){return ot().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return G.next=2,u.layerService.renderLayer(R);case 2:case"end":return G.stop()}},A)}));return function(A){return w.apply(this,arguments)}}());case 2:case"end":return m.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"getRenderLayers",value:function(){var a=this._tiles.filter(function(u){return u.visible&&u.isLoaded}),s=[];return a.map(function(u){return s.push.apply(s,(0,ve.Z)(u.getLayers()))}),s}},{key:"getLayers",value:function(){var a=this._tiles.filter(function(u){return u.isLoaded}),s=[];return a.map(function(u){return s.push.apply(s,(0,ve.Z)(u.getLayers()))}),s}},{key:"getTiles",value:function(){return this._tiles}},{key:"destroy",value:function(){this._tiles.forEach(function(a){return a.destroy()}),this.tileResource.clear()}}]),n}(),dA=nt(37824);function vA(n,l,a){a===void 0&&(a={});var s=ow(n),u=ow(l),h=dA.union(s.coordinates,u.coordinates);return h.length===0?null:h.length===1?rc(h[0],a.properties):mf(h,a.properties)}var M4=vA,I4=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"getCombineFeature",value:function(a){var s=null,u=a[0];return a.map(function(h){var v=rc(h.coordinates);s===null?s=v:s=M4(s,v)}),u&&(s.properties=(0,K.Z)({},u)),s}}]),n}(),Xm="select",Ym="active",k4=function(){function n(l){var a=l.layerService,s=l.tileLayerService,u=l.parent;(0,pt.Z)(this,n),(0,W.Z)(this,"tilePickID",new Map),this.layerService=a,this.tileLayerService=s,this.parent=u,this.tileSourceService=new I4}return(0,et.Z)(n,[{key:"pickRender",value:function(a){var s=this.tileLayerService.getVisibleTileBylngLat(a.lngLat);if(s){var u=s.getMainLayer();u==null||u.layerPickService.pickRender(a)}}},{key:"pick",value:function(a,s){var u=this.parent.getContainer(),h=u.get(Dt.IPickingService);if(a.type==="RasterLayer"){var v=this.tileLayerService.getVisibleTileBylngLat(s.lngLat);if(v&&v.getMainLayer()!==void 0){var m=v.getMainLayer();return m.layerPickService.pickRasterLayer(m,s,this.parent)}return!1}return this.pickRender(s),h.pickFromPickingFBO(a,s)}},{key:"selectFeature",value:function(a){var s=(0,yt.Z)(a,3),u=s[0],h=s[1],v=s[2],m=this.color2PickId(u,h,v);this.tilePickID.set(Xm,m),this.updateHighLight(u,h,v,Xm)}},{key:"highlightPickedFeature",value:function(a){var s=(0,yt.Z)(a,3),u=s[0],h=s[1],v=s[2],m=this.color2PickId(u,h,v);this.tilePickID.set(Ym,m),this.updateHighLight(u,h,v,Ym)}},{key:"updateHighLight",value:function(a,s,u,h){this.tileLayerService.tiles.map(function(v){var m=v.getMainLayer();switch(h){case Xm:m==null||m.hooks.beforeSelect.call([a,s,u]);break;case Ym:m==null||m.hooks.beforeHighlight.call([a,s,u]);break}})}},{key:"setPickState",value:function(){var a=this.tilePickID.get(Xm),s=this.tilePickID.get(Ym);if(a){var u=this.pickId2Color(a),h=(0,yt.Z)(u,3),v=h[0],m=h[1],w=h[2];this.updateHighLight(v,m,w,Xm);return}if(s){var A=this.pickId2Color(s),R=(0,yt.Z)(A,3),B=R[0],G=R[1],j=R[2];this.updateHighLight(B,G,j,Ym);return}}},{key:"color2PickId",value:function(a,s,u){return _r(new Uint8Array([a,s,u]))}},{key:"pickId2Color",value:function(a){return er(a)}},{key:"getFeatureById",value:function(a){var s=this.tileLayerService.getTiles().filter(function(h){return h.visible}),u=[];return s.forEach(function(h){u.push.apply(u,(0,ve.Z)(h.getFeatureById(a)))}),u}},{key:"pickRasterLayer",value:function(a,s,u){return!1}}]),n}();function gA(n){return n==="PolygonLayer"?_1:n==="LineLayer"?P0:m1}function mA(n){return["PolygonLayer","LineLayer"].indexOf(n)!==-1}var V0=function(){function n(l,a){(0,pt.Z)(this,n),(0,W.Z)(this,"visible",!0),(0,W.Z)(this,"layers",[]),(0,W.Z)(this,"isLoaded",!1),this.parent=a,this.sourceTile=l,this.x=l.x,this.y=l.y,this.z=l.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}return(0,et.Z)(n,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(a){var s=(0,yt.Z)(this.sourceTile.bounds,4),u=s[0],h=s[1],v=s[2],m=s[3],w=a.lng,A=a.lat;return w>=u&&w<=v&&A>=h&&A<=m}},{key:"getLayerOptions",value:function(){var a=this.parent.getLayerConfig();return(0,K.Z)((0,K.Z)({},a),{},{autoFit:!1,mask:mA(this.parent.type)||a.mask})}},{key:"addMask",value:function(){var l=(0,J.Z)(ot().mark(function s(u,h){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=tm(this.parent.sceneContainer),h.setContainer(v,this.parent.sceneContainer),w.next=4,h.init();case 4:u.addMaskLayer(h);case 5:case"end":return w.stop()}},s,this)}));function a(s,u){return l.apply(this,arguments)}return a}()},{key:"addLayer",value:function(){var l=(0,J.Z)(ot().mark(function s(u){var h;return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return u.isTileLayer=!0,h=tm(this.parent.sceneContainer),u.setContainer(h,this.parent.sceneContainer),this.layers.push(u),m.next=6,u.init();case 6:case"end":return m.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"updateVisible",value:function(a){this.visible=a,this.updateOptions("visible",a)}},{key:"updateOptions",value:function(a,s){this.layers.forEach(function(u){u.updateLayerConfig((0,W.Z)({},a,s))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(a){return[]}},{key:"getFeatureById",value:function(a){return[]}},{key:"destroy",value:function(){this.layers.forEach(function(a){return a.destroy()})}}]),n}();function L4(n){var l=P4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function P4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var H1=function(n){(0,zt.Z)(a,n);var l=L4(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R;return ot().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),w=gA(this.parent.type),A=this.getSourceOption(),A){G.next=7;break}return this.isLoaded=!0,G.abrupt("return");case 7:if(R=new w((0,K.Z)({},m)).source(A.data,A.options),Object.keys(v).forEach(function(j){var lt,ct,_t=j;R[_t]((lt=v[_t])===null||lt===void 0?void 0:lt.field,(ct=v[_t])===null||ct===void 0?void 0:ct.values)}),!m.mask){G.next=12;break}return G.next=12,this.addTileMask(R);case 12:return G.next=14,this.addLayer(R);case 14:this.setLayerMinMaxZoom(R),this.isLoaded=!0;case 16:case"end":return G.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"addTileMask",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m=new Hx({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}),A.next=3,this.addMask(v,m);case 3:case"end":return A.stop()}},h,this)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"getSourceOption",value:function(){var u=this.parent.getSource(),h=this.parent.getLayerConfig(),v=h.sourceLayer,m=v===void 0?"defaultLayer":v,w=h.featureId,A=w===void 0?"id":w,R=this.getFeatures(m);return{data:{type:"FeatureCollection",features:R},options:{parser:{type:"geojson",featureId:A},transforms:u.transforms}}}},{key:"setLayerMinMaxZoom",value:function(u){u.getModelType()==="text"&&u.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(u){var h=this.sourceTile.data;return h.getTileData(u)}},{key:"getFeatureById",value:function(u){var h=this.getMainLayer();if(!h)return[];var v=h.getSource().data.dataArray.filter(function(m){return m._id===u});return v}}]),a}(V0);function O4(n){var l=F4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function F4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var R4=function(n){(0,zt.Z)(a,n);var l=O4(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.getSourceOption(),m=v.data.features[0].properties,w=new P0().source(v.data,v.options).size(1).shape("line").color("red"),A=new m1({minZoom:this.z-1,maxZoom:this.z+1}).source([m],{parser:{type:"json",x:"textLng",y:"textLat"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),B.next=6,this.addLayer(w);case 6:return B.next=8,this.addLayer(A);case 8:this.isLoaded=!0;case 9:case"end":return B.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getSourceOption",value:function(){var u=this.parent.getSource(),h=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:h},options:{parser:{type:"geojson"},transforms:u.transforms}}}}]),a}(V0);function D4(n){var l=B4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function B4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var LF=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,yA=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,_A=function(n){(0,zt.Z)(a,n);var l=D4(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity;return{u_opacity:h||1,u_texture:this.texture}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v=this,m,w,A,R,B,G,j,lt,ct,_t,Zt;return ot().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(m=this.layer.getLayerConfig(),w=m.mask,A=w===void 0?!1:w,R=m.maskInside,B=R===void 0?!0:R,G=this.layer.getSource(),j=this.rendererService.createTexture2D,this.texture=j({height:0,width:0}),!Ms){fe.next=12;break}lt=this.layerService.sceneService.getSceneConfig().canvas,ct=lt.createImage(),ct.crossOrigin="anonymous",ct.src=G.data.originData,ct.onload=function(){v.texture=j({data:ct,width:ct.width,height:ct.height}),v.layerService.reRender()},fe.next=16;break;case 12:return fe.next=14,G.data.images;case 14:_t=fe.sent,this.texture=j({data:_t[0],width:_t[0].width,height:_t[0].height,mag:se.LINEAR,min:se.LINEAR});case 16:return fe.next=18,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:yA,fragmentShader:LF,triangulation:f1,primitive:se.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:Di(A,B)});case 18:return Zt=fe.sent,fe.abrupt("return",[Zt]);case 20:case"end":return fe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.texture)===null||u===void 0||u.destroy()}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_Uv",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Vo),Fb={image:_A},N4=Fb;function Rb(n){var l=z4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function z4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var U4=function(n){(0,zt.Z)(a,n);var l=Rb(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"type","ImageLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=this.getModelType(),this.layerModel=new N4[v](this),w.next=4,this.initLayerModels();case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getDefaultConfig",value:function(){var u=this.getModelType(),h={image:{}};return h[u]}},{key:"getModelType",value:function(){return"image"}}]),a}(hg);function Z4(n){var l=V4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function V4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var G4=function(n){(0,zt.Z)(a,n);var l=Z4(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),w=this.getSourceOption(),A=new U4((0,K.Z)({},m)).source(w.data,w.options),v&&Object.keys(v).forEach(function(G){var j,lt,ct=G;A[ct]((j=v[ct])===null||j===void 0?void 0:j.field,(lt=v[ct])===null||lt===void 0?void 0:lt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getSourceOption",value:function(){var u=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:u.transforms}}}}]),a}(V0);function H4(n){var l=j4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function j4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PF=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
   
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,qd=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,j1=function(n){(0,zt.Z)(a,n);var l=H4(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.clampLow,w=m===void 0?!0:m,A=u.clampHigh,R=A===void 0?!0:A,B=u.noDataValue,G=B===void 0?-9999999:B,j=u.domain,lt=u.rampColors,ct=j||Un(lt);return this.colorTexture=this.layer.textureService.getColorTexture(lt,ct),{u_opacity:v||1,u_texture:this.texture,u_domain:ct,u_clampLow:w,u_clampHigh:typeof R!="undefined"?R:w,u_noDataValue:G,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m,w,A,R;return ot().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(!Array.isArray(v.data)){G.next=4;break}return G.abrupt("return",{data:v.data,width:v.width,height:v.height});case 4:return G.next=6,v.data;case 6:return m=G.sent,w=m.rasterData,A=m.width,R=m.height,G.abrupt("return",{data:Array.from(w),width:A,height:R});case 11:case"end":return G.stop()}},h)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe;return ot().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=this.layer.getSource(),G=this.rendererService.createTexture2D,j=B.data.dataArray[0],Ze.next=6,this.getRasterData(j);case 6:return lt=Ze.sent,ct=lt.data,_t=lt.width,Zt=lt.height,this.texture=G({data:ct,width:_t,height:Zt,format:se.LUMINANCE,type:se.FLOAT}),Ze.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:qd,fragmentShader:PF,triangulation:f1,primitive:se.TRIANGLES,depth:{enable:!1},stencil:Di(w,R)});case 13:return pe=Ze.sent,Ze.abrupt("return",[pe]);case 15:case"end":return Ze.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u,h;(u=this.texture)===null||u===void 0||u.destroy(),(h=this.colorTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_Uv",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Vo),W4=["data"],W1=["rasterData"];function X4(n){var l=Y4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function Y4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $4=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
 
}`,q4=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,K4=function(n){(0,zt.Z)(a,n);var l=X4(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"dataOption",{}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=h===void 0?1:h,m=u.noDataValue,w=m===void 0?0:m,A=this.dataOption,R=A.rMinMax,B=A.gMinMax,G=A.bMinMax;return{u_opacity:v||1,u_texture:this.texture,u_noDataValue:w,u_rminmax:R,u_gminmax:B,u_bminmax:G}}},{key:"getRasterData",value:function(){var s=(0,J.Z)(ot().mark(function h(v){var m,w,A,R,B;return ot().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!Array.isArray(v.data)){j.next=4;break}return m=v.data,w=(0,ql.Z)(v,W4),this.dataOption=w,j.abrupt("return",(0,K.Z)({data:m},w));case 4:return j.next=6,v.data;case 6:if(A=j.sent,R=A.rasterData,B=(0,ql.Z)(A,W1),this.dataOption=B,!Array.isArray(R)){j.next=14;break}return j.abrupt("return",(0,K.Z)({data:R},B));case 14:return j.abrupt("return",(0,K.Z)({data:Array.from(R)},B));case 15:case"end":return j.stop()}},h,this)}));function u(h){return s.apply(this,arguments)}return u}()},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe;return ot().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=this.layer.getSource(),G=this.rendererService.createTexture2D,j=B.data.dataArray[0],Ze.next=6,this.getRasterData(j);case 6:return lt=Ze.sent,ct=lt.data,_t=lt.width,Zt=lt.height,this.texture=G({data:ct,width:_t,height:Zt,format:se.RGB,type:se.FLOAT}),Ze.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:q4,fragmentShader:$4,triangulation:f1,primitive:se.TRIANGLES,depth:{enable:!1},stencil:Di(w,R)});case 13:return pe=Ze.sent,Ze.abrupt("return",[pe]);case 15:case"end":return Ze.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.texture)===null||u===void 0||u.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_Uv",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Vo);function Q4(n){var l=J4();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function J4(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tP=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y)) * 256.0;
  float r = baseColor.r * 256.0 * 256.0;
  float g = baseColor.g * 256.0;
  float b = baseColor.b;
  float value =  (r + g + b) * 0.1 - 10000.0;
  
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,eP=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,rP=function(n){(0,zt.Z)(a,n);var l=Q4(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var u=this.layer.getLayerConfig(),h=u.opacity,v=u.clampLow,m=v===void 0?!0:v,w=u.clampHigh,A=w===void 0?!0:w,R=u.noDataValue,B=R===void 0?-9999999:R,G=u.domain,j=u.rampColors,lt=u.colorTexture,ct=G||Un(j),_t=lt;return lt?this.layer.textureService.setColorTexture(lt,j,ct):_t=this.layer.textureService.getColorTexture(j,ct),{u_opacity:h||1,u_texture:this.texture,u_domain:ct,u_clampLow:m,u_clampHigh:typeof A!="undefined"?A:m,u_noDataValue:B,u_colorTexture:_t}}},{key:"initModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt;return ot().wrap(function(_t){for(;;)switch(_t.prev=_t.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,w=m===void 0?!1:m,A=v.maskInside,R=A===void 0?!0:A,B=this.layer.getSource(),G=this.rendererService.createTexture2D,_t.next=5,B.data.images;case 5:return j=_t.sent,this.texture=G({data:j[0],width:j[0].width,height:j[0].height}),_t.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:eP,fragmentShader:tP,triangulation:f1,primitive:se.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Di(w,R)});case 9:return lt=_t.sent,_t.abrupt("return",[lt]);case 11:case"end":return _t.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"clearModels",value:function(){var u;(u=this.texture)===null||u===void 0||u.destroy()}},{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:ta.Attribute,descriptor:{name:"a_Uv",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Vo),$m={raster:j1,rasterRgb:K4,raster3d:j1,rasterTerrainRgb:rP},nP=$m;function iP(n){var l=aP();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function aP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Db=function(n){(0,zt.Z)(a,n);var l=iP(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"type","RasterLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return v=this.getModelType(),this.layerModel=new nP[v](this),w.next=4,this.initLayerModels();case 4:case"end":return w.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getDefaultConfig",value:function(){var u=this.getModelType(),h={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return h[u]}},{key:"getModelType",value:function(){var u=this.layerSource.getParserType();switch(u){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),a}(hg),xA=["rasterData"];function OF(n){var l=qm();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function qm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Bb={positions:[0,1],colors:["#000","#fff"]},oP=function(n){(0,zt.Z)(a,n);var l=OF(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G;return ot().wrap(function(lt){for(;;)switch(lt.prev=lt.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),w=this.getSourceOption(),A=this.getLayerOptions(),R=A.rampColors,B=A.domain,this.colorTexture=this.parent.textureService.getColorTexture(R,B),G=new Db((0,K.Z)((0,K.Z)({},m),{},{colorTexture:this.colorTexture})).source(w.data,w.options),v&&Object.keys(v).forEach(function(ct){var _t,Zt,pe=ct;G[pe]((_t=v[pe])===null||_t===void 0?void 0:_t.field,(Zt=v[pe])===null||Zt===void 0?void 0:Zt.values)}),lt.next=9,this.addLayer(G);case 9:this.isLoaded=!0;case 10:case"end":return lt.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getSourceOption",value:function(){var u=this.parent.getSource(),h=this.sourceTile.data.data,v=h.rasterData,m=(0,ql.Z)(h,xA);return{data:v,options:{parser:(0,K.Z)({type:"raster",extent:this.sourceTile.bounds},m),transforms:u.transforms}}}},{key:"styleUpdate",value:function(){for(var u=this,h=arguments.length,v=new Array(h),m=0;m<h;m++)v[m]=arguments[m];var w=v,A=w.rampColors,R=A===void 0?Bb:A,B=w.domain;this.colorTexture=this.parent.textureService.getColorTexture(R,B||Un(R)),this.layers.forEach(function(G){return G.style({colorTexture:u.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(u){return u.destroy()})}}]),a}(V0),bA=["rasterData"];function sP(n){var l=uP();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function uP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var FF=function(n){(0,zt.Z)(a,n);var l=sP(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),w=this.getSourceOption(),A=new Db((0,K.Z)({},m)).source(w.data,w.options),v&&Object.keys(v).forEach(function(G){var j,lt,ct=G;A[ct]((j=v[ct])===null||j===void 0?void 0:j.field,(lt=v[ct])===null||lt===void 0?void 0:lt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getSourceOption",value:function(){var u=this.parent.getSource(),h=this.sourceTile.data.data,v=h.rasterData,m=(0,ql.Z)(h,bA);return{data:v,options:{parser:(0,K.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},m),transforms:u.transforms}}}}]),a}(V0);function RF(n){var l=DF();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function DF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var lP=function(n){(0,zt.Z)(a,n);var l=RF(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),w=this.getSourceOption(),A=new Db((0,K.Z)({},m)).source(w.data,w.options),v&&Object.keys(v).forEach(function(G){var j,lt,ct=G;A[ct]((j=v[ct])===null||j===void 0?void 0:j.field,(lt=v[ct])===null||lt===void 0?void 0:lt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getSourceOption",value:function(){var u=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:u.transforms}}}}]),a}(V0);function EA(n){var l=wA();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function wA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var cP=function(n){(0,zt.Z)(a,n);var l=EA(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A;return ot().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),w=this.getSourceOption(),A=new Hx((0,K.Z)({},m)).source(w.data,w.options),v&&Object.keys(v).forEach(function(G){var j,lt,ct=G;A[ct]((j=v[ct])===null||j===void 0?void 0:j.field,(lt=v[ct])===null||lt===void 0?void 0:lt.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getFeatures",value:function(u){if(!u)return[];var h=this.sourceTile.data;return h.getTileData(u)}},{key:"getSourceOption",value:function(){var u=this.parent.getSource(),h=this.parent.getLayerConfig(),v=h.sourceLayer,m=h.featureId,w=this.getFeatures(v);return{data:{type:"FeatureCollection",features:w},options:{parser:{type:"geojson",featureId:m},transforms:u.transforms}}}}]),a}(V0);function fP(n){var l=n.type;switch(l){case"PolygonLayer":return H1;case"LineLayer":return H1;case"PointLayer":return H1;case"TileDebugLayer":return R4;case"MaskLayer":return cP;case"RasterLayer":var a=n.getSource().parser.dataType;switch(a){case"rgb":case"customRGB":return FF;case"arraybuffer":case"customArrayBuffer":return oP;case"terrainRGB":return lP;default:return G4}default:return H1}}var Hv=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive"],X1=function(){function n(l){(0,pt.Z)(this,n),(0,W.Z)(this,"initedTileset",!1),(0,W.Z)(this,"viewchange",(0,ne.debounce)(this.mapchange,24)),this.parent=l;var a=this.parent.getContainer();this.rendererService=a.get(Dt.IRendererService),this.layerService=a.get(Dt.ILayerService),this.mapService=a.get(Dt.IMapService),this.pickingService=a.get(Dt.IPickingService),this.tileLayerService=new pA({rendererService:this.rendererService,layerService:this.layerService,parent:l}),this.tilePickService=new k4({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:l}),this.parent.setLayerPickService(this.tilePickService),this.proxy(l),this.initTileSetManager()}return(0,et.Z)(n,[{key:"initTileSetManager",value:function(){var a,s=this.parent.getSource();this.tilesetManager=s.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var u=this.getCurrentView(),h=u.latLonBounds,v=u.zoom;(a=this.tilesetManager)===null||a===void 0||a.update(v,h)}},{key:"mapchange",value:function(){var a,s=this.getCurrentView(),u=s.latLonBounds,h=s.zoom;if(this.mapService.version==="GAODE1.x"){var v=this.parent.getLayerConfig(),m=v.visible;h<2&&m?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):h>=2&&!m&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===h&&this.lastViewStates.latLonBounds.toString()===u.toString()||(this.lastViewStates={zoom:h,latLonBounds:u},(a=this.tilesetManager)===null||a===void 0||a.throttleUpdate(h,u))}},{key:"getCurrentView",value:function(){var a=this.mapService.getBounds(),s=[a[0][0],a[0][1],a[1][0],a[1][1]],u=this.mapService.getZoom();return{latLonBounds:s,zoom:u}}},{key:"bindTilesetEvent",value:function(){var a=this;this.tilesetManager.on("tile-loaded",function(s){}),this.tilesetManager.on("tile-unload",function(s){a.tileUnLoad(s)}),this.tilesetManager.on("tile-error",function(s,u){a.tileError(s)}),this.tilesetManager.on("tile-update",function(){a.tileUpdate()}),this.mapService.on("zoomend",function(){return a.mapchange()}),this.mapService.on("moveend",function(){return a.viewchange()})}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"tileLoaded",value:function(a){}},{key:"tileError",value:function(a){console.warn("error:",a)}},{key:"destroy",value:function(){var a;(a=this.tilesetManager)===null||a===void 0||a.destroy(),this.tileLayerService.destroy()}},{key:"tileUnLoad",value:function(a){this.tileLayerService.removeTile(a.key)}},{key:"tileUpdate",value:function(){var l=(0,J.Z)(ot().mark(function s(){var u=this,h,v;return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(this.tilesetManager){w.next=2;break}return w.abrupt("return");case 2:return h=this.parent.getMinZoom(),v=this.parent.getMaxZoom(),w.next=6,Promise.all(this.tilesetManager.tiles.filter(function(A){return A.isLoaded}).filter(function(A){return A.isVisibleChange}).filter(function(A){return A.data}).filter(function(A){return A.z>=h&&A.z<v}).map(function(){var A=(0,J.Z)(ot().mark(function R(B){var G,j;return ot().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:if(u.tileLayerService.hasTile(B.key)){ct.next=9;break}return G=fP(u.parent),j=new G(B,u.parent),ct.next=5,j.initTileLayer();case 5:u.tilePickService.setPickState(),j.getLayers().length!==0&&(u.tileLayerService.addTile(j),u.tileLayerService.updateTileVisible(B),u.layerService.reRender()),ct.next=12;break;case 9:u.tileLayerService.updateTileVisible(B),u.tilePickService.setPickState(),u.layerService.reRender();case 12:case"end":return ct.stop()}},R)}));return function(R){return A.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return w.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"setPickState",value:function(a){}},{key:"pickRender",value:function(a){this.tilePickService.pickRender(a)}},{key:"selectFeature",value:function(a){this.tilePickService.selectFeature(a)}},{key:"highlightPickedFeature",value:function(a){this.tilePickService.highlightPickedFeature(a)}},{key:"proxy",value:function(a){var s=this;Hv.forEach(function(u){var h=a[u].bind(a);a[u]=function(){for(var v=arguments.length,m=new Array(v),w=0;w<v;w++)m[w]=arguments[w];return h.apply(void 0,m),s.getLayers().map(function(A){A[u].apply(A,m)}),u==="style"&&s.getTiles().forEach(function(A){return A.styleUpdate.apply(A,m)}),a}})}}]),n}(),SA,Nb,CA=(SA=(0,Tt.b2)(),SA(Nb=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"initLayerModel",value:function(){var l=(0,J.Z)(ot().mark(function s(u){return ot().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return u.prepareBuildModel(),v.next=3,u.buildModels();case 3:u.styleNeedUpdate=!1;case 4:case"end":return v.stop()}},s)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"prepareLayerModel",value:function(){var l=(0,J.Z)(ot().mark(function s(u){return ot().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return u.prepareBuildModel(),v.next=3,u.buildModels();case 3:case"end":return v.stop()}},s)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"apply",value:function(a){var s=this;a.hooks.init.tapPromise("LayerModelPlugin",(0,J.Z)(ot().mark(function u(){return ot().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!a.getSource().isTile){v.next=4;break}return a.prepareBuildModel(),a.tileLayer=new X1(a),v.abrupt("return");case 4:return v.next=6,s.initLayerModel(a);case 6:case"end":return v.stop()}},u)}))),a.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var u=(0,J.Z)(ot().mark(function h(v){return ot().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(v){w.next=2;break}return w.abrupt("return",!1);case 2:if(!a.getSource().isTile){w.next=5;break}return a.tileLayer=new X1(a),w.abrupt("return",!1);case 5:return w.next=7,s.prepareLayerModel(a);case 7:return w.abrupt("return",!0);case 8:case"end":return w.stop()}},h)}));return function(h){return u.apply(this,arguments)}}())}}]),n}())||Nb),AA,TA,BF=(AA=(0,Tt.b2)(),AA(TA=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.afterInit.tap("LayerStylePlugin",function(){var s=a.getLayerConfig(),u=s.autoFit,h=s.fitBoundsOptions;u&&a.fitBounds(h)})}}]),n}())||TA),MA,IA,kA=["type"],LA={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},hP={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},Y1={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},Kp={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function PA(n){var l={u_DirectionalLights:new Array(3).fill((0,K.Z)({},Y1)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,K.Z)({},Kp)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[hP]),n.forEach(function(a){var s=a.type,u=s===void 0?"directional":s,h=(0,ql.Z)(a,kA),v=LA[u].lights,m=LA[u].num,w=l[m];l[v][w]=(0,K.Z)((0,K.Z)({},l[v][w]),h),l[m]++}),l}var zb=(MA=(0,Tt.b2)(),MA(IA=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LightingPlugin",function(){var s=a.getLayerConfig(),u=s.enableLighting;u&&a.models.forEach(function(h){return h.addUniforms((0,K.Z)({},PA()))})})}}]),n}())||IA),OA,FA,Ub=(OA=(0,Tt.b2)(),OA(FA=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var u=this,h=s.rendererService,v=s.postProcessingPassFactory,m=s.normalPassFactory;a.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var w=a.getLayerConfig(),A=w.enableMultiPassRenderer,R=w.passes,B=R===void 0?[]:R;u.enabled=!!A&&a.getLayerConfig().enableMultiPassRenderer!==!1,u.enabled&&(a.multiPassRenderer=Ex(a,B,v,m),a.multiPassRenderer.setRenderFlag(!0))}),a.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(u.enabled){var w=h.getViewportSize(),A=w.width,R=w.height;a.multiPassRenderer.resize(A,R)}})}}]),n}())||FA),Rh,Zb,Km={NONE:0,ENCODE:1,HIGHLIGHT:2},RA=(Rh=(0,Tt.b2)(),Rh(Zb=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var u=s.styleAttributeService;a.hooks.init.tapPromise("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;u.registerStyleAttribute({name:"pickingColor",type:ta.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:se.FLOAT},size:3,update:function(w){var A=w.id;return v?er(A):[0,0,0]}}})}),a.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;v&&a.isVisible()&&a.models.forEach(function(m){return m.addUniforms({u_PickingStage:Km.ENCODE})})}),a.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;v&&a.isVisible()&&a.models.forEach(function(m){return m.addUniforms({u_PickingStage:Km.HIGHLIGHT})})}),a.hooks.beforeHighlight.tap("PixelPickingPlugin",function(h){var v=a.getLayerConfig(),m=v.highlightColor,w=v.activeMix,A=w===void 0?0:w,R=typeof m=="string"?$e(m):m||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:_r(new Uint8Array(h))}),a.models.forEach(function(B){return B.addUniforms({u_PickingStage:Km.HIGHLIGHT,u_PickingColor:h,u_HighlightColor:R.map(function(G){return G*255}),u_activeMix:A})})}),a.hooks.beforeSelect.tap("PixelPickingPlugin",function(h){var v=a.getLayerConfig(),m=v.selectColor,w=v.selectMix,A=w===void 0?0:w,R=typeof m=="string"?$e(m):m||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:_r(new Uint8Array(h))}),a.models.forEach(function(B){return B.addUniforms({u_PickingStage:Km.HIGHLIGHT,u_PickingColor:h,u_HighlightColor:R.map(function(G){return G*255}),u_activeMix:A,u_CurrentSelectedId:h,u_SelectColor:R.map(function(G){return G*255}),u_EnableSelect:1})})})}}]),n}())||Zb),Vb=["mvt","geojsonvt","testTile"];function DA(n){var l=n.getSource();return Vb.includes(l.parser.type)}function NF(n){return n.getContext?{width:n.width/DOM.DPR,height:n.height/DOM.DPR}:n.getBoundingClientRect()}var BA,NA,zF=(BA=(0,Tt.b2)(),BA(NA=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var u=this,h=s.styleAttributeService;a.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){DA(a)||u.registerBuiltinAttributes(h,a)})}},{key:"registerBuiltinAttributes",value:function(a,s){if(s.type==="MaskLayer"){this.registerPositionAttribute(a);return}this.registerPositionAttribute(a),this.registerColorAttribute(a),this.registerVertexIdAttribute(a)}},{key:"registerPositionAttribute",value:function(a){a.registerStyleAttribute({name:"position",type:ta.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:se.FLOAT},size:3,update:function(u,h,v){return v.length===2?[v[0],v[1],0]:[v[0],v[1],v[2]]}}})}},{key:"registerFilterAttribute",value:function(a){a.registerStyleAttribute({name:"filter",type:ta.Attribute,descriptor:{name:"filter",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(u){var h=u.filter;return h?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(a){a.registerStyleAttribute({name:"color",type:ta.Attribute,descriptor:{name:"a_Color",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:4,update:function(u){var h=u.color;return!h||!h.length?[1,1,1,1]:h}}})}},{key:"registerVertexIdAttribute",value:function(a){a.registerStyleAttribute({name:"vertexId",type:ta.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:se.DYNAMIC_DRAW,data:[],type:se.FLOAT},size:1,update:function(u,h){return[h]}}})}}]),n}())||NA),zA,UA,Gb,$1,ZA,VA,Mg,GA,HA,jA,q1,pP=(zA=(0,Tt.b2)(),UA=(0,Tt.f3)(Dt.ICameraService),Gb=(0,Tt.f3)(Dt.ICoordinateSystemService),$1=(0,Tt.f3)(Dt.IRendererService),ZA=(0,Tt.f3)(Dt.IMapService),zA(VA=(Mg=function(){function n(){(0,pt.Z)(this,n),Rn(this,"cameraService",GA,this),Rn(this,"coordinateSystemService",HA,this),Rn(this,"rendererService",jA,this),Rn(this,"mapService",q1,this)}return(0,et.Z)(n,[{key:"apply",value:function(a){var s=this,u=this.mapService.version,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],v=[0,0];a.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var m=a.getLayerConfig().tileOrigin;s.coordinateSystemService.refresh(m),u==="GAODE2.x"&&(s.setLayerCenter(a),h=s.mapService.map.customCoords.getMVPMatrix(),v=s.mapService.getCustomCoordCenter());var w=s.rendererService.getViewportSize(),A=w.width,R=w.height;a.models.forEach(function(B){var G;B.addUniforms((G={},(0,W.Z)(G,w0.ProjectionMatrix,s.cameraService.getProjectionMatrix()),(0,W.Z)(G,w0.ViewMatrix,s.cameraService.getViewMatrix()),(0,W.Z)(G,w0.ViewProjectionMatrix,s.cameraService.getViewProjectionMatrix()),(0,W.Z)(G,w0.Zoom,s.cameraService.getZoom()),(0,W.Z)(G,w0.ZoomScale,s.cameraService.getZoomScale()),(0,W.Z)(G,w0.FocalDistance,s.cameraService.getFocalDistance()),(0,W.Z)(G,w0.CameraPosition,s.cameraService.getCameraPosition()),(0,W.Z)(G,sf.CoordinateSystem,s.coordinateSystemService.getCoordinateSystem()),(0,W.Z)(G,sf.ViewportCenter,s.coordinateSystemService.getViewportCenter()),(0,W.Z)(G,sf.ViewportCenterProjection,s.coordinateSystemService.getViewportCenterProjection()),(0,W.Z)(G,sf.PixelsPerDegree,s.coordinateSystemService.getPixelsPerDegree()),(0,W.Z)(G,sf.PixelsPerDegree2,s.coordinateSystemService.getPixelsPerDegree2()),(0,W.Z)(G,sf.PixelsPerMeter,s.coordinateSystemService.getPixelsPerMeter()),(0,W.Z)(G,sf.Mvp,h),(0,W.Z)(G,"u_SceneCenterMKT",v),(0,W.Z)(G,"u_ViewportSize",[A,R]),(0,W.Z)(G,"u_ModelMatrix",s.cameraService.getModelMatrix()),(0,W.Z)(G,"u_DevicePixelRatio",Ga.devicePixelRatio),(0,W.Z)(G,"u_PickingBuffer",a.getLayerConfig().pickingBuffer||0),(0,W.Z)(G,"u_shaderPick",Number(a.getShaderPickStat())),G))})})}},{key:"setLayerCenter",value:function(a){a.coordCenter===void 0&&(a.coordCenter=a.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(a.coordCenter)}}]),n}(),GA=Fi(Mg.prototype,"cameraService",[UA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HA=Fi(Mg.prototype,"coordinateSystemService",[Gb],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jA=Fi(Mg.prototype,"rendererService",[$1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q1=Fi(Mg.prototype,"mapService",[ZA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mg))||VA),WA,K1,UF=(WA=(0,Tt.b2)(),WA(K1=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("UpdateModelPlugin",function(){a.layerModel&&a.layerModel.needUpdate().then(function(s){s&&a.renderLayers()})}),a.hooks.afterRender.tap("UpdateModelPlugin",function(){a.layerModelNeedUpdate=!1})}}]),n}())||K1),XA,YA,dP=(XA=(0,Tt.b2)(),XA(YA=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var u=this,h=s.styleAttributeService;a.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){u.initStyleAttribute(a,{styleAttributeService:h})}),a.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){a.layerModelNeedUpdate||a.inited&&u.updateStyleAttribute(a,{styleAttributeService:h})})}},{key:"updateStyleAttribute",value:function(a,s){var u=s.styleAttributeService,h=u.getLayerStyleAttributes()||[],v=u.getLayerStyleAttribute("filter");if(v&&v.needRegenerateVertices){a.layerModelNeedUpdate=!0,h.forEach(function(m){return m.needRegenerateVertices=!1});return}h.filter(function(m){return m.needRegenerateVertices}).forEach(function(m){u.updateAttributeByFeatureRange(m.name,a.getEncodedData(),m.featureRange.startIndex,m.featureRange.endIndex,a),m.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(a,s){var u=s.styleAttributeService,h=u.getLayerStyleAttributes()||[];h.filter(function(v){return v.needRegenerateVertices}).forEach(function(v){u.updateAttributeByFeatureRange(v.name,a.getEncodedData(),v.featureRange.startIndex,v.featureRange.endIndex),v.needRegenerateVertices=!1})}}]),n}())||YA);cf.bind(Dt.ILayerPlugin).to($d).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(zF).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(T4).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(Yp).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(BF).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(dP).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(UF).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(Ub).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(pP).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(hA).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(zb).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(RA).inRequestScope(),cf.bind(Dt.ILayerPlugin).to(CA).inRequestScope();var vP=nt(87781),gP=nt.n(vP),$A=function(){function n(l,a){(0,pt.Z)(this,n);var s=a.buffer,u=a.offset,h=a.stride,v=a.normalized,m=a.size,w=a.divisor;this.buffer=s,this.attribute={buffer:s.get(),offset:u||0,stride:h||0,normalized:v||!1,divisor:w||0},m&&(this.attribute.size=m)}return(0,et.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(a){this.buffer.subData(a)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),Kd,Qm,Qd,Dh,Jm,jv,ty,Q1,Qp,Ig,Ks,Vc,Jp,ey,qA=(Kd={},(0,W.Z)(Kd,se.POINTS,"points"),(0,W.Z)(Kd,se.LINES,"lines"),(0,W.Z)(Kd,se.LINE_LOOP,"line loop"),(0,W.Z)(Kd,se.LINE_STRIP,"line strip"),(0,W.Z)(Kd,se.TRIANGLES,"triangles"),(0,W.Z)(Kd,se.TRIANGLE_FAN,"triangle fan"),(0,W.Z)(Kd,se.TRIANGLE_STRIP,"triangle strip"),Kd),Hb=(Qm={},(0,W.Z)(Qm,se.STATIC_DRAW,"static"),(0,W.Z)(Qm,se.DYNAMIC_DRAW,"dynamic"),(0,W.Z)(Qm,se.STREAM_DRAW,"stream"),Qm),ry=(Qd={},(0,W.Z)(Qd,se.BYTE,"int8"),(0,W.Z)(Qd,se.UNSIGNED_INT,"int16"),(0,W.Z)(Qd,se.INT,"int32"),(0,W.Z)(Qd,se.UNSIGNED_BYTE,"uint8"),(0,W.Z)(Qd,se.UNSIGNED_SHORT,"uint16"),(0,W.Z)(Qd,se.UNSIGNED_INT,"uint32"),(0,W.Z)(Qd,se.FLOAT,"float"),Qd),mP=(Dh={},(0,W.Z)(Dh,se.ALPHA,"alpha"),(0,W.Z)(Dh,se.LUMINANCE,"luminance"),(0,W.Z)(Dh,se.LUMINANCE_ALPHA,"luminance alpha"),(0,W.Z)(Dh,se.RGB,"rgb"),(0,W.Z)(Dh,se.RGBA,"rgba"),(0,W.Z)(Dh,se.RGBA4,"rgba4"),(0,W.Z)(Dh,se.RGB5_A1,"rgb5 a1"),(0,W.Z)(Dh,se.RGB565,"rgb565"),(0,W.Z)(Dh,se.DEPTH_COMPONENT,"depth"),(0,W.Z)(Dh,se.DEPTH_STENCIL,"depth stencil"),Dh),yP=(Jm={},(0,W.Z)(Jm,se.DONT_CARE,"dont care"),(0,W.Z)(Jm,se.NICEST,"nice"),(0,W.Z)(Jm,se.FASTEST,"fast"),Jm),KA=(jv={},(0,W.Z)(jv,se.NEAREST,"nearest"),(0,W.Z)(jv,se.LINEAR,"linear"),(0,W.Z)(jv,se.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,W.Z)(jv,se.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,W.Z)(jv,se.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,W.Z)(jv,se.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),jv),QA=(ty={},(0,W.Z)(ty,se.REPEAT,"repeat"),(0,W.Z)(ty,se.CLAMP_TO_EDGE,"clamp"),(0,W.Z)(ty,se.MIRRORED_REPEAT,"mirror"),ty),_P=(Q1={},(0,W.Z)(Q1,se.NONE,"none"),(0,W.Z)(Q1,se.BROWSER_DEFAULT_WEBGL,"browser"),Q1),xP=(Qp={},(0,W.Z)(Qp,se.NEVER,"never"),(0,W.Z)(Qp,se.ALWAYS,"always"),(0,W.Z)(Qp,se.LESS,"less"),(0,W.Z)(Qp,se.LEQUAL,"lequal"),(0,W.Z)(Qp,se.GREATER,"greater"),(0,W.Z)(Qp,se.GEQUAL,"gequal"),(0,W.Z)(Qp,se.EQUAL,"equal"),(0,W.Z)(Qp,se.NOTEQUAL,"notequal"),Qp),jb=(Ig={},(0,W.Z)(Ig,se.FUNC_ADD,"add"),(0,W.Z)(Ig,se.MIN_EXT,"min"),(0,W.Z)(Ig,se.MAX_EXT,"max"),(0,W.Z)(Ig,se.FUNC_SUBTRACT,"subtract"),(0,W.Z)(Ig,se.FUNC_REVERSE_SUBTRACT,"reverse subtract"),Ig),Wv=(Ks={},(0,W.Z)(Ks,se.ZERO,"zero"),(0,W.Z)(Ks,se.ONE,"one"),(0,W.Z)(Ks,se.SRC_COLOR,"src color"),(0,W.Z)(Ks,se.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,W.Z)(Ks,se.SRC_ALPHA,"src alpha"),(0,W.Z)(Ks,se.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,W.Z)(Ks,se.DST_COLOR,"dst color"),(0,W.Z)(Ks,se.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,W.Z)(Ks,se.DST_ALPHA,"dst alpha"),(0,W.Z)(Ks,se.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,W.Z)(Ks,se.CONSTANT_COLOR,"constant color"),(0,W.Z)(Ks,se.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,W.Z)(Ks,se.CONSTANT_ALPHA,"constant alpha"),(0,W.Z)(Ks,se.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,W.Z)(Ks,se.SRC_ALPHA_SATURATE,"src alpha saturate"),Ks),J1=(Vc={},(0,W.Z)(Vc,se.NEVER,"never"),(0,W.Z)(Vc,se.ALWAYS,"always"),(0,W.Z)(Vc,se.LESS,"less"),(0,W.Z)(Vc,se.LEQUAL,"lequal"),(0,W.Z)(Vc,se.GREATER,"greater"),(0,W.Z)(Vc,se.GEQUAL,"gequal"),(0,W.Z)(Vc,se.EQUAL,"equal"),(0,W.Z)(Vc,se.NOTEQUAL,"notequal"),Vc),td=(Jp={},(0,W.Z)(Jp,se.ZERO,"zero"),(0,W.Z)(Jp,se.KEEP,"keep"),(0,W.Z)(Jp,se.REPLACE,"replace"),(0,W.Z)(Jp,se.INVERT,"invert"),(0,W.Z)(Jp,se.INCR,"increment"),(0,W.Z)(Jp,se.DECR,"decrement"),(0,W.Z)(Jp,se.INCR_WRAP,"increment wrap"),(0,W.Z)(Jp,se.DECR_WRAP,"decrement wrap"),Jp),JA=(ey={},(0,W.Z)(ey,se.FRONT,"front"),(0,W.Z)(ey,se.BACK,"back"),ey),bP=function(){function n(l,a){(0,pt.Z)(this,n);var s=a.data,u=a.usage,h=a.type;this.buffer=l.buffer({data:s,usage:Hb[u||se.STATIC_DRAW],type:ry[h||se.UNSIGNED_BYTE]})}return(0,et.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(a){var s=a.data,u=a.offset;this.buffer.subdata(s,u)}}]),n}(),EP=function(){function n(l,a){(0,pt.Z)(this,n);var s=a.data,u=a.usage,h=a.type,v=a.count;this.elements=l.elements({data:s,usage:Hb[u||se.STATIC_DRAW],type:ry[h||se.UNSIGNED_BYTE],count:v})}return(0,et.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(a){var s=a.data;this.elements.subdata(s)}},{key:"destroy",value:function(){}}]),n}(),tT=function(){function n(l,a){(0,pt.Z)(this,n);var s=a.width,u=a.height,h=a.color,v=a.colors,m={width:s,height:u};Array.isArray(v)&&(m.colors=v.map(function(w){return w.get()})),h&&typeof h!="boolean"&&(m.color=h.get()),this.framebuffer=l.framebuffer(m)}return(0,et.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(a){var s=a.width,u=a.height;this.framebuffer.resize(s,u)}}]),n}(),eT=function(){function n(l,a){(0,pt.Z)(this,n),(0,W.Z)(this,"destroyed",!1),(0,W.Z)(this,"uniforms",{}),this.reGl=l;var s=a.pick,u=s===void 0?!0:s,h=a.vs,v=a.fs,m=a.attributes,w=a.uniforms,A=a.primitive,R=a.count,B=a.elements,G=a.depth,j=a.blend,lt=a.stencil,ct=a.cull,_t=a.instances,Zt={};this.options=a,w&&(this.uniforms=this.extractUniforms(w),Object.keys(w).forEach(function(Qe){Zt[Qe]=l.prop(Qe)}));var pe={};Object.keys(m).forEach(function(Qe){pe[Qe]=m[Qe].get()});var fe={attributes:pe,frag:v,uniforms:Zt,vert:h,blend:{},primitive:qA[A===void 0?se.TRIANGLES:A]};if(_t&&(fe.instances=_t),R?fe.count=R:B&&(fe.elements=B.get()),this.initDepthDrawParams({depth:G},fe),this.initBlendDrawParams({blend:j},fe),this.initStencilDrawParams({stencil:lt},fe),this.initCullDrawParams({cull:ct},fe),this.drawCommand=l(fe),u){var Ze=(0,ne.cloneDeep)(fe);Ze.blend=(0,K.Z)((0,K.Z)({},Ze.blend),{},{enable:!1}),this.drawPickCommand=l(Ze)}this.drawParams=fe}return(0,et.Z)(n,[{key:"updateAttributesAndElements",value:function(a,s){var u={};if(Object.keys(a).forEach(function(v){u[v]=a[v].get()}),this.drawParams.attributes=u,this.drawParams.elements=s.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var h=(0,ne.cloneDeep)(this.drawParams);h.blend=(0,K.Z)((0,K.Z)({},h.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(h)}}},{key:"updateAttributes",value:function(a){var s={};if(Object.keys(a).forEach(function(h){s[h]=a[h].get()}),this.drawParams.attributes=s,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var u=(0,ne.cloneDeep)(this.drawParams);u.blend=(0,K.Z)((0,K.Z)({},u.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(u)}}},{key:"addUniforms",value:function(a){this.uniforms=(0,K.Z)((0,K.Z)({},this.uniforms),this.extractUniforms(a))}},{key:"draw",value:function(a,s){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var u=(0,K.Z)((0,K.Z)({},this.uniforms),this.extractUniforms(a.uniforms||{})),h={};Object.keys(u).forEach(function(v){var m=(0,Pn.Z)(u[v]);m==="boolean"||m==="number"||Array.isArray(u[v])||u[v].BYTES_PER_ELEMENT?h[v]=u[v]:h[v]=u[v].get()}),s?this.drawPickCommand&&this.drawPickCommand(h):this.drawCommand(h)}}},{key:"destroy",value:function(){var a,s;(a=this.drawParams)===null||a===void 0||(s=a.elements)===null||s===void 0||s.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(u){u==null||u.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(a,s){var u=a.depth;u&&(s.depth={enable:u.enable===void 0?!0:!!u.enable,mask:u.mask===void 0?!0:!!u.mask,func:xP[u.func||se.LESS],range:u.range||[0,1]})}},{key:"initBlendDrawParams",value:function(a,s){var u=a.blend;if(u){var h=u.enable,v=u.func,m=u.equation,w=u.color,A=w===void 0?[0,0,0,0]:w;s.blend={enable:!!h,func:{srcRGB:Wv[v&&v.srcRGB||se.SRC_ALPHA],srcAlpha:Wv[v&&v.srcAlpha||se.SRC_ALPHA],dstRGB:Wv[v&&v.dstRGB||se.ONE_MINUS_SRC_ALPHA],dstAlpha:Wv[v&&v.dstAlpha||se.ONE_MINUS_SRC_ALPHA]},equation:{rgb:jb[m&&m.rgb||se.FUNC_ADD],alpha:jb[m&&m.alpha||se.FUNC_ADD]},color:A}}}},{key:"initStencilDrawParams",value:function(a,s){var u=a.stencil;if(u){var h=u.enable,v=u.mask,m=v===void 0?-1:v,w=u.func,A=w===void 0?{cmp:se.ALWAYS,ref:0,mask:-1}:w,R=u.opFront,B=R===void 0?{fail:se.KEEP,zfail:se.KEEP,zpass:se.KEEP}:R,G=u.opBack,j=G===void 0?{fail:se.KEEP,zfail:se.KEEP,zpass:se.KEEP}:G;s.stencil={enable:!!h,mask:m,func:(0,K.Z)((0,K.Z)({},A),{},{cmp:J1[A.cmp]}),opFront:{fail:td[B.fail],zfail:td[B.zfail],zpass:td[B.zpass]},opBack:{fail:td[j.fail],zfail:td[j.zfail],zpass:td[j.zpass]}}}}},{key:"initCullDrawParams",value:function(a,s){var u=a.cull;if(u){var h=u.enable,v=u.face,m=v===void 0?se.BACK:v;s.cull={enable:!!h,face:JA[m]}}}},{key:"extractUniforms",value:function(a){var s=this,u={};return Object.keys(a).forEach(function(h){s.extractUniformsRecursively(h,a[h],u,"")}),u}},{key:"extractUniformsRecursively",value:function(a,s,u,h){var v=this;if(s===null||typeof s=="number"||typeof s=="boolean"||Array.isArray(s)&&typeof s[0]=="number"||(0,ne.isTypedArray)(s)||s===""||"resize"in s){u["".concat(h&&h+".").concat(a)]=s;return}(0,ne.isPlainObject)(s)&&Object.keys(s).forEach(function(m){v.extractUniformsRecursively(m,s[m],u,"".concat(h&&h+".").concat(a))}),Array.isArray(s)&&s.forEach(function(m,w){Object.keys(m).forEach(function(A){v.extractUniformsRecursively(A,m[A],u,"".concat(h&&h+".").concat(a,"[").concat(w,"]"))})})}}]),n}(),rT=function(){function n(l,a){(0,pt.Z)(this,n),(0,W.Z)(this,"isDestroy",!1);var s=a.data,u=a.type,h=u===void 0?se.UNSIGNED_BYTE:u,v=a.width,m=a.height,w=a.flipY,A=w===void 0?!1:w,R=a.format,B=R===void 0?se.RGBA:R,G=a.mipmap,j=G===void 0?!1:G,lt=a.wrapS,ct=lt===void 0?se.CLAMP_TO_EDGE:lt,_t=a.wrapT,Zt=_t===void 0?se.CLAMP_TO_EDGE:_t,pe=a.aniso,fe=pe===void 0?0:pe,Ze=a.alignment,Qe=Ze===void 0?1:Ze,wr=a.premultiplyAlpha,Lr=wr===void 0?!1:wr,Vr=a.mag,Wr=Vr===void 0?se.NEAREST:Vr,bn=a.min,hn=bn===void 0?se.NEAREST:bn,Wn=a.colorSpace,vi=Wn===void 0?se.BROWSER_DEFAULT_WEBGL:Wn,$i=a.x,go=$i===void 0?0:$i,zo=a.y,zs=zo===void 0?0:zo,cu=a.copy,Xu=cu===void 0?!1:cu;this.width=v,this.height=m;var zh={width:v,height:m,type:ry[h],format:mP[B],wrapS:QA[ct],wrapT:QA[Zt],mag:KA[Wr],min:KA[hn],alignment:Qe,flipY:A,colorSpace:_P[vi],premultiplyAlpha:Lr,aniso:fe,x:go,y:zs,copy:Xu};s&&(zh.data=s),typeof j=="number"?zh.mipmap=yP[j]:typeof j=="boolean"&&(zh.mipmap=j),this.texture=l.texture(zh)}return(0,et.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(a)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(a){var s=a.width,u=a.height;this.texture.resize(s,u),this.width=s,this.height=u}},{key:"getSize",value:function(){return[this.width,this.height]}},{key:"destroy",value:function(){if(!this.isDestroy){var a;(a=this.texture)===null||a===void 0||a.destroy()}this.isDestroy=!0}}]),n}(),Wb,ny,t_=(Wb=(0,Tt.b2)(),Wb(ny=function(){function n(){var l=this;(0,pt.Z)(this,n),(0,W.Z)(this,"createModel",function(a){return new eT(l.gl,a)}),(0,W.Z)(this,"createAttribute",function(a){return new $A(l.gl,a)}),(0,W.Z)(this,"createBuffer",function(a){return new bP(l.gl,a)}),(0,W.Z)(this,"createElements",function(a){return new EP(l.gl,a)}),(0,W.Z)(this,"createTexture2D",function(a){return new rT(l.gl,a)}),(0,W.Z)(this,"createFramebuffer",function(a){return new tT(l.gl,a)}),(0,W.Z)(this,"useFramebuffer",function(a,s){l.gl({framebuffer:a?a.get():null})(s)}),(0,W.Z)(this,"clear",function(a){var s,u=a.color,h=a.depth,v=a.stencil,m=a.framebuffer,w=m===void 0?null:m,A={color:u,depth:h,stencil:v};A.framebuffer=w===null?w:w.get(),(s=l.gl)===null||s===void 0||s.clear(A)}),(0,W.Z)(this,"viewport",function(a){var s=a.x,u=a.y,h=a.width,v=a.height;l.gl._gl.viewport(s,u,h,v),l.width=h,l.height=v,l.gl._refresh()}),(0,W.Z)(this,"readPixels",function(a){var s=a.framebuffer,u=a.x,h=a.y,v=a.width,m=a.height,w={x:u,y:h,width:v,height:m};return s&&(w.framebuffer=s.get()),l.gl.read(w)}),(0,W.Z)(this,"getViewportSize",function(){return{width:l.gl._gl.drawingBufferWidth,height:l.gl._gl.drawingBufferHeight}}),(0,W.Z)(this,"getContainer",function(){if(Ms)return l.canvas;var a;return(a=l.canvas)===null||a===void 0?void 0:a.parentElement}),(0,W.Z)(this,"getCanvas",function(){return l.canvas}),(0,W.Z)(this,"getGLContext",function(){return l.gl._gl}),(0,W.Z)(this,"destroy",function(){var a,s,u;l.canvas=null,(a=l.gl)===null||a===void 0||(s=a._gl)===null||s===void 0||(u=s.getExtension("WEBGL_lose_context"))===null||u===void 0||u.loseContext(),l.gl.destroy(),l.gl=null})}return(0,et.Z)(n,[{key:"init",value:function(){var l=(0,J.Z)(ot().mark(function s(u,h,v){var m=this;return ot().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(this.canvas=u,!v){A.next=5;break}this.gl=v,A.next=8;break;case 5:return A.next=7,new Promise(function(R,B){gP()({canvas:m.canvas,attributes:{alpha:!0,antialias:h.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:h.preserveDrawingBuffer,stencil:h.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(j,lt){(j||!lt)&&B(j),R(lt)}})});case 7:this.gl=A.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return A.stop()}},s,this)}));function a(s,u,h){return l.apply(this,arguments)}return a}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(a){return!!this.getGLContext().getExtension(a)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var a=this.getGLContext();a.disable(a.CULL_FACE)}},{key:"setDirty",value:function(a){this.isDirty=a}},{key:"getDirty",value:function(){return this.isDirty}}]),n}())||ny);function wP(n){var l=SP();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function SP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Xb=["selectstart","selecting","selectend"],CP=function(n){(0,zt.Z)(a,n);var l=wP(a);function a(s){var u,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,pt.Z)(this,a),u=l.call(this),(0,W.Z)((0,ut.Z)(u),"isEnable",!1),(0,W.Z)((0,ut.Z)(u),"onDragStart",function(v){u.box.style.display="block",u.startEvent=u.endEvent=v,u.syncBoxBound(),u.emit("selectstart",u.getLngLatBox(),u.startEvent,u.endEvent)}),(0,W.Z)((0,ut.Z)(u),"onDragging",function(v){u.endEvent=v,u.syncBoxBound(),u.emit("selecting",u.getLngLatBox(),u.startEvent,u.endEvent)}),(0,W.Z)((0,ut.Z)(u),"onDragEnd",function(v){u.endEvent=v,u.box.style.display="none",u.emit("selectend",u.getLngLatBox(),u.startEvent,u.endEvent)}),u.scene=s,u.options=h,u}return(0,et.Z)(a,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var u=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var h=Jt("div",void 0,this.container);h.classList.add("l7-select-box"),u&&h.classList.add(u),h.style.display="none",this.box=h}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var u=this.startEvent,h=u.x,v=u.y,m=this.endEvent,w=m.x,A=m.y,R=Math.min(h,w),B=Math.min(v,A),G=Math.abs(h-w),j=Math.abs(v-A);this.box.style.top="".concat(B,"px"),this.box.style.left="".concat(R,"px"),this.box.style.width="".concat(G,"px"),this.box.style.height="".concat(j,"px")}},{key:"getLngLatBox",value:function(){var u=this.startEvent.lngLat,h=u.lng,v=u.lat,m=this.endEvent.lngLat,w=m.lng,A=m.lat;return rs([[h,v],[w,A]])}}]),a}(Ee.EventEmitter),AP=function(){function n(l){(0,pt.Z)(this,n);var a=l.id,s=l.map,u=l.canvas,h=l.hasBaseMap,v=GM();this.container=v,s.setContainer(v,a,u,h),v.bind(Dt.IRendererService).to(t_).inSingletonScope(),this.sceneService=v.get(Dt.ISceneService),this.mapService=v.get(Dt.IMapService),this.iconService=v.get(Dt.IIconService),this.fontService=v.get(Dt.IFontService),this.controlService=v.get(Dt.IControlService),this.layerService=v.get(Dt.ILayerService),this.markerService=v.get(Dt.IMarkerService),this.interactionService=v.get(Dt.IInteractionService),this.popupService=v.get(Dt.IPopupService),this.boxSelect=new CP(this,{}),jc((l==null?void 0:l.isMini)||!1),Ms?this.sceneService.initMiniScene(l):(this.initComponent(a),this.sceneService.init(l),this.initControl())}return(0,et.Z)(n,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(){var l=(0,J.Z)(ot().mark(function s(u){return ot().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this.sceneService.exportPng(u);case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"exportMap",value:function(){var l=(0,J.Z)(ot().mark(function s(u){return ot().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this.sceneService.exportPng(u);case 2:return v.abrupt("return",v.sent);case 3:case"end":return v.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"registerRenderService",value:function(a){var s=this;if(this.sceneService.loaded){var u=new a(this);u.init()}else this.on("loaded",function(){var h=new a(s);h.init()})}},{key:"setBgColor",value:function(a){this.mapService.setBgColor(a)}},{key:"addLayer",value:function(a){var s=this,u=tm(this.container);if(a.setContainer(u,this.container),this.sceneService.addLayer(a),a.inited){var h=this.initMask(a);this.addMask(h,a.id)}else a.on("inited",function(){var v=s.initMask(a);s.addMask(v,a.id)})}},{key:"initMask",value:function(a){var s=a.getLayerConfig(),u=s.mask,h=s.maskfence,v=s.maskColor,m=v===void 0?"#000":v,w=s.maskOpacity,A=w===void 0?0:w;if(!(!u||!h)){var R=new Hx().source(h).shape("fill").style({color:m,opacity:A});return R}}},{key:"addMask",value:function(a,s){if(a){var u=this.getLayer(s);if(u){var h=tm(this.container);a.setContainer(h,this.container),u.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(a){return this.layerService.getLayer(a)}},{key:"getLayerByName",value:function(a){return this.layerService.getLayerByName(a)}},{key:"removeLayer",value:function(){var l=(0,J.Z)(ot().mark(function s(u,h){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.layerService.remove(u,h);case 2:case"end":return m.stop()}},s,this)}));function a(s,u){return l.apply(this,arguments)}return a}()},{key:"removeAllLayer",value:function(){var l=(0,J.Z)(ot().mark(function s(){return ot().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.layerService.removeAllLayers();case 2:case"end":return h.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(a){this.layerService.setEnableRender(a)}},{key:"addIconFont",value:function(a,s){this.fontService.addIconFont(a,s)}},{key:"addIconFonts",value:function(a){var s=this;a.forEach(function(u){var h=(0,yt.Z)(u,2),v=h[0],m=h[1];s.fontService.addIconFont(v,m)})}},{key:"addFontFace",value:function(a,s){var u=this;this.fontService.once("fontloaded",function(h){u.emit("fontloaded",h)}),this.fontService.addFontFace(a,s)}},{key:"addImage",value:function(){var l=(0,J.Z)(ot().mark(function s(u,h){return ot().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(Ms){m.next=5;break}return m.next=3,this.iconService.addImage(u,h);case 3:m.next=6;break;case 5:this.iconService.addImageMini(u,h,this.sceneService);case 6:case"end":return m.stop()}},s,this)}));function a(s,u){return l.apply(this,arguments)}return a}()},{key:"hasImage",value:function(a){return this.iconService.hasImage(a)}},{key:"removeImage",value:function(a){this.iconService.removeImage(a)}},{key:"addIconFontGlyphs",value:function(a,s){this.fontService.addIconGlyphs(s)}},{key:"addControl",value:function(a){this.controlService.addControl(a,this.container)}},{key:"removeControl",value:function(a){this.controlService.removeControl(a)}},{key:"getControlByName",value:function(a){return this.controlService.getControlByName(a)}},{key:"addMarker",value:function(a){this.markerService.addMarker(a)}},{key:"addMarkerLayer",value:function(a){this.markerService.addMarkerLayer(a)}},{key:"removeMarkerLayer",value:function(a){this.markerService.removeMarkerLayer(a)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(a){this.popupService.addPopup(a)}},{key:"removePopup",value:function(a){this.popupService.removePopup(a)}},{key:"on",value:function(a,s){if(Xb.includes(a)){var u;(u=this.boxSelect)===null||u===void 0||u.on(a,s)}else zy.includes(a)?this.sceneService.on(a,s):this.mapService.on(a,s)}},{key:"once",value:function(a,s){if(Xb.includes(a)){var u;(u=this.boxSelect)===null||u===void 0||u.once(a,s)}else zy.includes(a)?this.sceneService.once(a,s):this.mapService.once(a,s)}},{key:"emit",value:function(a,s){zy.indexOf(a)===-1?this.mapService.on(a,s):this.sceneService.emit(a,s)}},{key:"off",value:function(a,s){if(Xb.includes(a)){var u;(u=this.boxSelect)===null||u===void 0||u.off(a,s)}else zy.includes(a)?this.sceneService.off(a,s):this.mapService.off(a,s)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(a){return this.mapService.getCenter(a)}},{key:"setCenter",value:function(a,s){return this.mapService.setCenter(a,s)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(a){return this.mapService.setPitch(a)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(a){this.mapService.setRotation(a)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(a){this.mapService.panTo(a)}},{key:"panBy",value:function(a,s){this.mapService.panBy(a,s)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(a){this.mapService.setZoom(a)}},{key:"fitBounds",value:function(a,s){var u=this.sceneService.getSceneConfig(),h=u.fitBoundsOptions,v=u.animate;this.mapService.fitBounds(a,s||(0,K.Z)((0,K.Z)({},h),{},{animate:v}))}},{key:"setZoomAndCenter",value:function(a,s){this.mapService.setZoomAndCenter(a,s)}},{key:"setMapStyle",value:function(a){this.mapService.setMapStyle(a)}},{key:"setMapStatus",value:function(a){this.mapService.setMapStatus(a)}},{key:"pixelToLngLat",value:function(a){return this.mapService.pixelToLngLat(a)}},{key:"lngLatToPixel",value:function(a){return this.mapService.lngLatToPixel(a)}},{key:"containerToLngLat",value:function(a){return this.mapService.containerToLngLat(a)}},{key:"lngLatToContainer",value:function(a){return this.mapService.lngLatToContainer(a)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(a,s){this.container.bind(Dt.IPostProcessingPass).to(a).whenTargetNamed(s)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var a=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),s&&this.boxSelect.once("selectend",function(){a.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(a){this.controlService.init({container:D(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var a=this.sceneService.getSceneConfig(),s=a.logoVisible,u=a.logoPosition;s&&this.addControl(new h3({position:u}))}}]),n}(),nT,Yb,iT,aT=(nT=Z_(Dt.IGlobalConfigService),Yb=function(){function n(l){(0,pt.Z)(this,n),Rn(this,"configService",iT,this),this.config=l}return(0,et.Z)(n,[{key:"setContainer",value:function(a,s,u,h){a.bind(Dt.MapConfig).toConstantValue((0,K.Z)((0,K.Z)({},this.config),{},{id:s,canvas:u,hasBaseMap:h})),a.bind(Dt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),iT=Fi(Yb.prototype,"configService",[nT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yb),ZF=nt(95742),ch=nt.n(ZF),iy=function(){function n(l){(0,pt.Z)(this,n),(0,W.Z)(this,"size",1e4),this.size=l||1e4}return(0,et.Z)(n,[{key:"setSize",value:function(a){this.size=a}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(a){return(180+a)/360*this.size}},{key:"mercatorYfromLat",value:function(a){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(a){return a/this.size*360-180}},{key:"latFromMercatorY",value:function(a){var s=180-(1-a/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(s*Math.PI/180))-90}},{key:"project",value:function(a){var s=this.mercatorXfromLng(a[0]),u=this.mercatorYfromLat(a[1]);return[s,u]}},{key:"unproject",value:function(a){var s=this.lngFromMercatorX(a[0]),u=this.latFromMercatorY(a[1]);return[s,u]}}]),n}();function e_(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l={top:0,right:0,bottom:0,left:0};if(typeof n=="number")return{top:n,right:n,bottom:n,left:n};if(Array.isArray(n)){if(n.length===4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]}}return(0,K.Z)((0,K.Z)({},l),n)}function G0(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function r_(n,l){var a=tl([],l,n);return Hu(a,a,1/a[3]),a}function VF(n,l){var a=n%l;return a<0?l+a:a}function GF(n,l,a){return a*l+(1-a)*n}function H0(n,l){if(!n)throw new Error(l||"viewport-mercator-project: assertion failed.")}var Bh=Math.PI,oT=Bh/4,Jd=Bh/180,sT=180/Bh,$b=512,qb=4003e4,TP=1.5;function uT(n){return Math.pow(2,n)}function MP(n){return Math.log2(n)}function Kb(n,l){var a=(0,yt.Z)(n,2),s=a[0],u=a[1];H0(Number.isFinite(s)&&Number.isFinite(l)),H0(Number.isFinite(u)&&u>=-90&&u<=90,"invalid latitude"),l*=$b;var h=s*Jd,v=u*Jd,m=l*(h+Bh)/(2*Bh),w=l*(Bh-Math.log(Math.tan(oT+v*.5)))/(2*Bh);return[m,w]}function ay(n,l){var a=(0,yt.Z)(n,2),s=a[0],u=a[1];l*=$b;var h=s/l*(2*Bh)-Bh,v=2*(Math.atan(Math.exp(Bh-u/l*(2*Bh)))-oT);return[h*sT,v*sT]}function HF(n){var l=n.latitude;assert(Number.isFinite(l));var a=Math.cos(l*Jd);return MP(qb*a)-9}function lT(n){var l=n.latitude,a=n.longitude,s=n.zoom,u=n.scale,h=n.highPrecision,v=h===void 0?!1:h;u=u!==void 0?u:uT(s),H0(Number.isFinite(l)&&Number.isFinite(a)&&Number.isFinite(u));var m={},w=$b*u,A=Math.cos(l*Jd),R=w/360,B=R/A,G=w/qb/A;if(m.pixelsPerMeter=[G,-G,G],m.metersPerPixel=[1/G,-1/G,1/G],m.pixelsPerDegree=[R,-B,G],m.degreesPerPixel=[1/R,-1/B,1/G],v){var j=Jd*Math.tan(l*Jd)/A,lt=R*j/2,ct=w/qb*j,_t=ct/B*G;m.pixelsPerDegree2=[0,-lt,ct],m.pixelsPerMeter2=[_t,0,_t]}return m}function jF(n,l){var a=_slicedToArray(n,3),s=a[0],u=a[1],h=a[2],v=_slicedToArray(l,3),m=v[0],w=v[1],A=v[2],R=1,B=lT({longitude:s,latitude:u,scale:R,highPrecision:!0}),G=B.pixelsPerMeter,j=B.pixelsPerMeter2,lt=Kb(n,R);lt[0]+=m*(G[0]+j[0]*w),lt[1]+=w*(G[1]+j[1]*w);var ct=ay(lt,R),_t=(h||0)+(A||0);return Number.isFinite(h)||Number.isFinite(A)?[ct[0],ct[1],_t]:ct}function IP(n){var l=n.height,a=n.pitch,s=n.bearing,u=n.altitude,h=n.center,v=h===void 0?null:h,m=n.flipY,w=m===void 0?!1:m,A=G0();return li(A,A,[0,0,-u]),wi(A,A,[1,1,1/l]),Ni(A,A,-a*Jd),zi(A,A,s*Jd),w&&wi(A,A,[1,-1,1]),v&&li(A,A,Co.negate([],v)),A}function Qb(n){var l=n.width,a=n.height,s=n.altitude,u=s===void 0?TP:s,h=n.pitch,v=h===void 0?0:h,m=n.nearZMultiplier,w=m===void 0?1:m,A=n.farZMultiplier,R=A===void 0?1:A,B=v*Jd,G=Math.atan(.5/u),j=Math.sin(G)*u/Math.sin(Math.PI/2-B-G),lt=Math.cos(Math.PI/2-B)*j+u;return{fov:2*Math.atan(a/2/u),aspect:l/a,focalDistance:u,near:w,far:lt*R}}function oy(n){var l=n.width,a=n.height,s=n.pitch,u=n.altitude,h=n.nearZMultiplier,v=n.farZMultiplier,m=Qb({width:l,height:a,altitude:u,pitch:s,nearZMultiplier:h,farZMultiplier:v}),w=m.fov,A=m.aspect,R=m.near,B=m.far,G=su([],w,A,R,B);return G}function n_(n,l){var a=(0,yt.Z)(n,3),s=a[0],u=a[1],h=a[2],v=h===void 0?0:h;return H0(Number.isFinite(s)&&Number.isFinite(u)&&Number.isFinite(v)),r_(l,[s,u,v,1])}function cT(n,l){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=(0,yt.Z)(n,3),u=s[0],h=s[1],v=s[2];if(H0(Number.isFinite(u)&&Number.isFinite(h),"invalid pixel coordinate"),Number.isFinite(v)){var m=r_(l,[u,h,v,1]);return m}var w=r_(l,[u,h,0,1]),A=r_(l,[u,h,1,1]),R=w[2],B=A[2],G=R===B?0:((a||0)-R)/(B-R);return ei.t7([],w,A,G)}var fT=G0(),hT=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=l.width,s=l.height,u=l.viewMatrix,h=u===void 0?fT:u,v=l.projectionMatrix,m=v===void 0?fT:v;(0,pt.Z)(this,n),this.width=a||1,this.height=s||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=h,this.projectionMatrix=m;var w=G0();ti(w,w,this.projectionMatrix),ti(w,w,this.viewMatrix),this.viewProjectionMatrix=w;var A=G0();wi(A,A,[this.width/2,-this.height/2,1]),li(A,A,[1,-1,0]),ti(A,A,this.viewProjectionMatrix);var R=Mr(G0(),A);if(!R)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=A,this.pixelUnprojectionMatrix=R,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,et.Z)(n,[{key:"equals",value:function(a){return a instanceof n?a.width===this.width&&a.height===this.height&&d(a.projectionMatrix,this.projectionMatrix)&&d(a.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=s.topLeft,h=u===void 0?!0:u,v=this.projectPosition(a),m=n_(v,this.pixelProjectionMatrix),w=(0,yt.Z)(m,2),A=w[0],R=w[1],B=h?R:this.height-R;return a.length===2?[A,B]:[A,B,m[2]]}},{key:"unproject",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=s.topLeft,h=u===void 0?!0:u,v=s.targetZ,m=(0,yt.Z)(a,3),w=m[0],A=m[1],R=m[2],B=h?A:this.height-A,G=v&&v*this.pixelsPerMeter,j=cT([w,B,R],this.pixelUnprojectionMatrix,G),lt=this.unprojectPosition(j),ct=(0,yt.Z)(lt,3),_t=ct[0],Zt=ct[1],pe=ct[2];return Number.isFinite(R)?[_t,Zt,pe]:Number.isFinite(v)?[_t,Zt,v]:[_t,Zt]}},{key:"projectPosition",value:function(a){var s=this.projectFlat(a),u=(0,yt.Z)(s,2),h=u[0],v=u[1],m=(a[2]||0)*this.pixelsPerMeter;return[h,v,m]}},{key:"unprojectPosition",value:function(a){var s=this.unprojectFlat(a),u=(0,yt.Z)(s,2),h=u[0],v=u[1],m=(a[2]||0)/this.pixelsPerMeter;return[h,v,m]}},{key:"projectFlat",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}},{key:"unprojectFlat",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}}]),n}();function kP(n){var l=n.width,a=n.height,s=n.bounds,u=n.minExtent,h=u===void 0?0:u,v=n.maxZoom,m=v===void 0?24:v,w=n.padding,A=w===void 0?0:w,R=n.offset,B=R===void 0?[0,0]:R,G=(0,yt.Z)(s,2),j=(0,yt.Z)(G[0],2),lt=j[0],ct=j[1],_t=(0,yt.Z)(G[1],2),Zt=_t[0],pe=_t[1];if(Number.isFinite(A)){var fe=A;A={top:fe,bottom:fe,left:fe,right:fe}}else H0(Number.isFinite(A.top)&&Number.isFinite(A.bottom)&&Number.isFinite(A.left)&&Number.isFinite(A.right));var Ze=new Jb({width:l,height:a,longitude:0,latitude:0,zoom:0}),Qe=Ze.project([lt,pe]),wr=Ze.project([Zt,ct]),Lr=[Math.max(Math.abs(wr[0]-Qe[0]),h),Math.max(Math.abs(wr[1]-Qe[1]),h)],Vr=[l-A.left-A.right-Math.abs(B[0])*2,a-A.top-A.bottom-Math.abs(B[1])*2];H0(Vr[0]>0&&Vr[1]>0);var Wr=Vr[0]/Lr[0],bn=Vr[1]/Lr[1],hn=(A.right-A.left)/2/Wr,Wn=(A.bottom-A.top)/2/bn,vi=[(wr[0]+Qe[0])/2+hn,(wr[1]+Qe[1])/2+Wn],$i=Ze.unproject(vi),go=Ze.zoom+Math.log2(Math.abs(Math.min(Wr,bn)));return{longitude:$i[0],latitude:$i[1],zoom:Math.min(go,m)}}var Jb=function(n){(0,zt.Z)(l,n);function l(){var a,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u=s.width,h=s.height,v=s.latitude,m=v===void 0?0:v,w=s.longitude,A=w===void 0?0:w,R=s.zoom,B=R===void 0?0:R,G=s.pitch,j=G===void 0?0:G,lt=s.bearing,ct=lt===void 0?0:lt,_t=s.altitude,Zt=_t===void 0?1.5:_t,pe=s.nearZMultiplier,fe=s.farZMultiplier;(0,pt.Z)(this,l),u=u||1,h=h||1;var Ze=uT(B);Zt=Math.max(.75,Zt);var Qe=Kb([A,m],Ze);Qe[2]=0;var wr=oy({width:u,height:h,pitch:j,bearing:ct,altitude:Zt,nearZMultiplier:pe||1/h,farZMultiplier:fe||1.01}),Lr=IP({height:h,center:Qe,pitch:j,bearing:ct,altitude:Zt,flipY:!0});return a=(0,P.Z)(this,(0,b.Z)(l).call(this,{width:u,height:h,viewMatrix:Lr,projectionMatrix:wr})),a.latitude=m,a.longitude=A,a.zoom=B,a.pitch=j,a.bearing=ct,a.altitude=Zt,a.scale=Ze,a.center=Qe,a.pixelsPerMeter=lT((0,ut.Z)((0,ut.Z)(a))).pixelsPerMeter[2],Object.freeze((0,ut.Z)((0,ut.Z)(a))),a}return(0,et.Z)(l,[{key:"projectFlat",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return Kb(s,u)}},{key:"unprojectFlat",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return ay(s,u)}},{key:"getMapCenterByLngLatPosition",value:function(s){var u=s.lngLat,h=s.pos,v=cT(h,this.pixelUnprojectionMatrix),m=Kb(u,this.scale),w=ei.IH([],m,ei.tk([],v)),A=ei.IH([],this.center,w);return ay(A,this.scale)}},{key:"getLocationAtPoint",value:function(s){var u=s.lngLat,h=s.pos;return this.getMapCenterByLngLatPosition({lngLat:u,pos:h})}},{key:"fitBounds",value:function(s){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=this.width,v=this.height,m=kP(Object.assign({width:h,height:v,bounds:s},u)),w=m.longitude,A=m.latitude,R=m.zoom;return new l({width:h,height:v,longitude:w,latitude:A,zoom:R})}}]),l}(hT),LP=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.center,u=a.zoom,h=a.pitch,v=a.bearing,m=a.viewportHeight,w=a.viewportWidth,A=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new Jb((0,K.Z)((0,K.Z)({},A),{},{width:w,height:m,longitude:s&&s[0],latitude:s&&s[1],zoom:u,pitch:h,bearing:v}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}}]),n}(),PP={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},OP=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],pT,dT,t2,vT,e2,gT,df,mT,yT,r2,_T;function FP(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var u=l.head||l.getElementsByTagName("head")[0];if(!u){u=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(u,h):l.documentElement.appendChild(u)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),u.appendChild(v),v}}FP(`.amap-logo{
 display: none !important;
}
`);var xT={contextmenu:"rightclick"},RP=0;window.forceWebGL=!0;var bT="15cd8a57710d40c9b7c0e3cc120f1200",DP="1.4.15",BP="amap-script",n2=!1,i_=[],NP=12,zP=(pT=(0,Tt.b2)(),dT=(0,Tt.f3)(Dt.IGlobalConfigService),t2=(0,Tt.f3)(Dt.MapConfig),vT=(0,Tt.f3)(Dt.ICoordinateSystemService),e2=(0,Tt.f3)(Dt.IEventEmitter),pT(gT=(df=function(){function n(){var l=this;(0,pt.Z)(this,n),(0,W.Z)(this,"version",Tc["GAODE1.x"]),(0,W.Z)(this,"simpleMapCoord",new iy),(0,W.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),Rn(this,"configService",mT,this),Rn(this,"config",yT,this),Rn(this,"coordinateSystemService",r2,this),Rn(this,"eventEmitter",_T,this),(0,W.Z)(this,"handleCameraChanged",function(a){var s=a.camera,u=s.fov,h=s.near,v=s.far,m=s.height,w=s.pitch,A=s.rotation,R=s.aspect,B=s.position,G=l.getCenter(),j=G.lng,lt=G.lat;if(l.emit("mapchange"),l.cameraChangedCallback){l.viewport.syncWithMapCamera({aspect:R,bearing:360-A,far:v,fov:u,cameraHeight:m,near:h,pitch:w,zoom:l.map.getZoom()-1,center:[j,lt],offsetOrigin:[B.x,B.y]});var ct=l.config.offsetZoom,_t=ct===void 0?NP:ct;l.viewport.getZoom()>_t?l.coordinateSystemService.setCoordinateSystem(el.P20_OFFSET):l.coordinateSystemService.setCoordinateSystem(el.P20),l.cameraChangedCallback(l.viewport)}})}return(0,et.Z)(n,[{key:"setBgColor",value:function(a){this.bgColor=a}},{key:"addMarkerContainer",value:function(){var a=this.map.getContainer();if(a!==null){var s=a.getElementsByClassName("amap-maps")[0];this.markerContainer=Jt("div","l7-marker-container",s)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(a,s){G_.indexOf(a)!==-1?this.eventEmitter.on(a,s):this.map.on(xT[a]||a,s)}},{key:"off",value:function(a,s){G_.indexOf(a)!==-1?this.eventEmitter.off(a,s):this.map.off(xT[a]||a,s)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var a;return(a=this.map.getContainer())===null||a===void 0?void 0:a.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var a=this.map.getSize();return[a.getWidth(),a.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(a){return this.map.setZoom(a+1)}},{key:"getCenter",value:function(a){if(a!=null&&a.padding){var s=this.getCenter(),u=e_(a.padding),h=this.lngLatToPixel([s.lng,s.lat]),v=[(u.right-u.left)/2,(u.bottom-u.top)/2],m=this.pixelToLngLat([h.x-v[0],h.y-v[1]]);return m}var w=this.map.getCenter();return{lng:w.getLng(),lat:w.getLat()}}},{key:"setCenter",value:function(a,s){if(s!=null&&s.padding){var u=e_(s.padding),h=this.lngLatToPixel(a),v=[(u.right-u.left)/2,(u.bottom-u.top)/2],m=this.pixelToLngLat([h.x+v[0],h.y+v[1]]);this.map.setCenter([m.lng,m.lat])}else this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var a=this.map.getBounds().toBounds(),s=a.getNorthEast(),u=a.getSouthWest(),h=this.getCenter(),v=h.lng>s.getLng()||h.lng<u.getLng()?180-s.getLng():s.getLng(),m=h.lng<u.getLng()?u.getLng()-180:u.getLng();return[[m,u.getLat()],[v,s.getLat()]]}},{key:"getMinZoom",value:function(){var a=this.map.get("zooms");return a[0]-1}},{key:"getMaxZoom",value:function(){var a=this.map.get("zooms");return a[1]-1}},{key:"setRotation",value:function(a){return this.map.setRotation(a)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(a,s)}},{key:"fitBounds",value:function(a){this.map.setBounds(new AMap.Bounds([a[0][0],a[0][1],a[1][0],a[1][1]]))}},{key:"setZoomAndCenter",value:function(a,s){this.map.setZoomAndCenter(a+1,s)}},{key:"setMapStyle",value:function(a){this.map.setMapStyle(this.getMapStyleValue(a))}},{key:"setMapStatus",value:function(a){this.map.setStatus(a)}},{key:"getMapStyleConfig",value:function(){return PP}},{key:"getMapStyleValue",value:function(a){return this.getMapStyleConfig()[a]||a}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(a){var s=this.map.pixelToLngLat(new AMap.Pixel(a[0],a[1]));return{lng:s.getLng(),lat:s.getLat()}}},{key:"lngLatToPixel",value:function(a){var s=this.map.lnglatToPixel(new AMap.LngLat(a[0],a[1]));return{x:s.getX(),y:s.getY()}}},{key:"containerToLngLat",value:function(a){var s=new AMap.Pixel(a[0],a[1]),u=this.map.containerToLngLat(s);return{lng:u==null?void 0:u.getLng(),lat:u==null?void 0:u.getLat()}}},{key:"lngLatToContainer",value:function(a){var s=new AMap.LngLat(a[0],a[1]),u=this.map.lngLatToContainer(s);return{x:u.getX(),y:u.getY()}}},{key:"lngLatToCoord",value:function(a){var s=this.map.lngLatToGeodeticCoord(a),u=s.x,h=s.y;return[u,-h]}},{key:"lngLatToMercator",value:function(a,s){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(a,s,u){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],v=this.viewport.projectFlat(a),m=$r();return li(m,m,Co.fromValues(v[0],v[1],s)),wi(m,m,Co.fromValues(h[0],h[1],h[2])),Ni(m,m,u[0]),Oi(m,m,u[1]),zi(m,m,u[2]),m}},{key:"init",value:function(){var l=(0,J.Z)(ot().mark(function s(){var u=this,h,v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe;return ot().wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return h=this.config,v=h.id,m=h.style,w=m===void 0?"light":m,A=h.minZoom,R=A===void 0?0:A,B=h.maxZoom,G=B===void 0?18:B,j=h.token,lt=j===void 0?bT:j,ct=h.mapInstance,_t=h.plugin,Zt=_t===void 0?[]:_t,pe=(0,ql.Z)(h,OP),Ze.next=3,new Promise(function(Qe){var wr=function(){if(ct)u.map=ct,u.$mapContainer=u.map.getContainer(),setTimeout(function(){u.map.on("camerachange",u.handleCameraChanged),Qe()},30);else{u.$mapContainer=u.creatMapContainer(v);var Vr=(0,K.Z)({mapStyle:u.getMapStyleValue(w),zooms:[R,G],viewMode:"3D"},pe);Vr.zoom&&(Vr.zoom+=1);var Wr=new AMap.Map(u.$mapContainer,Vr);Wr.on("camerachange",u.handleCameraChanged),Wr.on("camerachange",function(){setTimeout(function(){return u.handleAfterMapChange()})}),u.map=Wr,setTimeout(function(){Qe()},10)}};!n2&&!ct?(lt===bT&&console.warn("%c".concat(u.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),n2=!0,Zt.push("Map3D"),ch().load({key:lt,version:DP,plugins:Zt}).then(function(){wr(),i_.length&&(i_.forEach(function(Lr){return Lr()}),i_=[])}).catch(function(Lr){throw new Error(Lr)})):n2&&window.AMap||ct?wr():i_.push(wr)});case 3:this.viewport=new LP;case 4:case"end":return Ze.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"meterToCoord",value:function(a,s){var u=AMap.GeometryUtil.distance($c(AMap.LngLat,(0,ve.Z)(a)),$c(AMap.LngLat,(0,ve.Z)(s))),h=this.lngLatToCoord(a),v=(0,yt.Z)(h,2),m=v[0],w=v[1],A=this.lngLatToCoord(s),R=(0,yt.Z)(A,2),B=R[0],G=R[1],j=Math.sqrt(Math.pow(m-B,2)+Math.pow(w-G,2));return j/u}},{key:"updateView",value:function(a){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(a){var s,u=(s=this.getContainer())===null||s===void 0?void 0:s.getElementsByClassName("amap-layer")[0],h=a==="jpg"?u==null?void 0:u.toDataURL("image/jpeg"):u==null?void 0:u.toDataURL("image/png");return h}},{key:"emit",value:function(a){for(var s,u=arguments.length,h=new Array(u>1?u-1:0),v=1;v<u;v++)h[v-1]=arguments[v];(s=this.eventEmitter).emit.apply(s,[a].concat(h))}},{key:"once",value:function(a){for(var s,u=arguments.length,h=new Array(u>1?u-1:0),v=1;v<u;v++)h[v-1]=arguments[v];(s=this.eventEmitter).once.apply(s,[a].concat(h))}},{key:"destroy",value:function(){var a,s;(a=this.$mapContainer)===null||a===void 0||(s=a.parentNode)===null||s===void 0||s.removeChild(this.$mapContainer),delete window.initAMap;var u=document.getElementById(BP);u&&document.head.removeChild(u),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(a){var s=a;typeof a=="string"&&(s=document.getElementById(a));var u=document.createElement("div");return u.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,u.id="l7_amap_div"+RP++,s.appendChild(u),u}}]),n}(),mT=Fi(df.prototype,"configService",[dT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yT=Fi(df.prototype,"config",[t2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),r2=Fi(df.prototype,"coordinateSystemService",[vT],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_T=Fi(df.prototype,"eventEmitter",[e2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),df))||gT),UP=function(){function n(){(0,pt.Z)(this,n),(0,W.Z)(this,"projectionMatrix",$r()),(0,W.Z)(this,"viewMatrix",$r()),(0,W.Z)(this,"viewProjectionMatrix",$r()),(0,W.Z)(this,"ViewProjectionMatrixUncentered",$r()),(0,W.Z)(this,"viewUncenteredMatrix",$r())}return(0,et.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.zoom,u=s===void 0?1:s,h=a.center,v=h===void 0?[0,0]:h,m=a.offsetOrigin,w=m===void 0?[0,0]:m,A=a.cameraPosition,R=A===void 0?[0,0,0]:A,B=a.up,G=B===void 0?[0,1,0]:B,j=a.lookAt,lt=j===void 0?[0,0,0]:j,ct=a.aspect,_t=ct===void 0?1:ct,Zt=a.near,pe=Zt===void 0?.1:Zt,fe=a.far,Ze=fe===void 0?1e3:fe,Qe=a.fov,wr=Qe===void 0?45:Qe;this.zoom=u,this.center=v,su(this.projectionMatrix,wr/180*Math.PI,_t,pe,Ze);var Lr=Co.fromValues.apply(Co,(0,ve.Z)(R)),Vr=Co.fromValues.apply(Co,(0,ve.Z)(lt)),Wr=Co.fromValues.apply(Co,(0,ve.Z)(G));bd(this.viewMatrix,Lr,Vr,Wr),this.viewUncenteredMatrix=Ar(this.viewMatrix),li(this.viewMatrix,this.viewMatrix,Co.fromValues(-w[0],w[1],0)),ti(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),ti(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var a=(0,yt.Z)(this.center,2),s=a[0],u=a[1];return[s,u]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1.2}},{key:"projectFlat",value:function(a){var s=85.0511287798,u=Math.max(Math.min(s,a[1]),-s),h=256<<20,v=Math.PI/180,m=a[0]*v,w=u*v;w=Math.log(Math.tan(Math.PI/4+w/2));var A=.5/Math.PI,R=.5,B=-.5/Math.PI;return v=.5,m=h*(A*m+R)-215440491,w=-(h*(B*w+v)-106744817),[m,w]}}]),n}(),ZP=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],ET,VP;function WF(n){var l=XF();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function XF(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function YF(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var u=l.head||l.getElementsByTagName("head")[0];if(!u){u=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(u,h):l.documentElement.appendChild(u)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),u.appendChild(v),v}}YF(`.amap-logo{
 display: none !important;
}
`);var r=[108.92361,34.54083];window.forceWebGL=!0;var e="ff533602d57df6f8ab3b0fea226ae52f",t="2.0",i=!1,o=null,c=(ET=(0,Tt.b2)(),ET(VP=function(n){(0,zt.Z)(a,n);var l=WF(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"version",Tc["GAODE2.x"]),(0,W.Z)((0,ut.Z)(s),"handleViewChanged",function(m){var w=s.map.customCoords.getCameraParams(),A=w.fov,R=w.near,B=w.far,G=w.aspect,j=w.position,lt=w.lookAt,ct=w.up;s.emit("mapchange");var _t=s.map.customCoords.getCenter();s.cameraChangedCallback&&(s.viewport.syncWithMapCamera({aspect:G,far:B,fov:A,cameraPosition:j,lookAt:lt,up:ct,near:R,zoom:s.map.getZoom()-1,center:_t,offsetOrigin:[j[0],j[1]]}),s.coordinateSystemService.setCoordinateSystem(el.P20_2),s.cameraChangedCallback(s.viewport))}),s}return(0,et.Z)(a,[{key:"setCustomCoordCenter",value:function(u){this.sceneCenter=u,this.sceneCenterMKT=Xs.apply(void 0,(0,ve.Z)(u))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(u,h){var v=h||this.sceneCenter,m=Xs.apply(void 0,(0,ve.Z)(v)),w=this._sub(Xs(u[0],u[1]),m);return u[2]&&w.push(u[2]),w}},{key:"lngLatToCoordsByLayer",value:function(u,h){var v=this;return u.map(function(m){return typeof m[0]=="number"?v.lngLatToCoordByLayer(m,h):m.map(function(w){return v.lngLatToCoordByLayer(w,h)})})}},{key:"setCoordCenter",value:function(u){this.map.customCoords.setCenter(u||r),this.setCustomCoordCenter(u||r)}},{key:"lngLatToCoord",value:function(u){return this.sceneCenter||(this.map.customCoords.setCenter(u),this.setCustomCoordCenter(u)),this._sub(Xs(u[0],u[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(u){var h=this;return u.map(function(v){return typeof v[0]=="number"?h.lngLatToCoord(v):v.map(function(m){return h.lngLatToCoord(m)})})}},{key:"addMarkerContainer",value:function(){if(this.map){var u=this.map.getContainer();if(u!==null){var h=u.getElementsByClassName("amap-maps")[0];h.style.zIndex="auto",this.markerContainer=Jt("div","l7-marker-container2",h)}}}},{key:"updateView",value:function(u){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var u=this.map.getBounds(),h=u.getNorthEast(),v=u.getSouthWest(),m=this.getCenter(),w=m.lng>h.getLng()||m.lng<v.getLng()?180-h.getLng():h.getLng(),A=m.lng<v.getLng()?v.getLng()-180:v.getLng();return[[A,v.getLat()],[w,h.getLat()]]}},{key:"getMinZoom",value:function(){var u=this.map.getZooms();return u[0]-1}},{key:"getMaxZoom",value:function(){var u=this.map.getZooms();return u[1]-1}},{key:"lngLatToContainer",value:function(u){var h=this.map.lngLatToContainer(u);return{x:h.getX(),y:h.getY()}}},{key:"getModelMatrix",value:function(u,h,v){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],w=this.map.customCoords.lngLatToCoord(u),A=$r();return li(A,A,Co.fromValues(w[0],w[1],h)),wi(A,A,Co.fromValues(m[0],m[1],m[2])),Ni(A,A,v[0]),Oi(A,A,v[1]),zi(A,A,v[2]),A}},{key:"init",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe,Ze,Qe,wr,Lr,Vr,Wr,bn,hn;return ot().wrap(function(vi){for(;;)switch(vi.prev=vi.next){case 0:if(v=this.config,m=v.id,w=v.style,A=w===void 0?"light":w,R=v.minZoom,B=R===void 0?0:R,G=v.maxZoom,j=G===void 0?18:G,lt=v.token,ct=lt===void 0?e:lt,_t=v.mapInstance,Zt=v.plugin,pe=Zt===void 0?[]:Zt,fe=v.version,Ze=fe===void 0?t:fe,Qe=(0,ql.Z)(v,ZP),this.viewport=new UP,window.AMap||_t){vi.next=6;break}return pe.push("Map3D"),vi.next=6,ch().load({key:ct,version:t,plugins:pe});case 6:_t?(this.map=_t,this.$mapContainer=this.map.getContainer(),Lr=this.map.getCenter(),(wr=this.map.customCoords)===null||wr===void 0||wr.setCenter([Lr.lng,Lr.lat]),this.setCustomCoordCenter([Lr.lng,Lr.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(m),Wr=(0,K.Z)({mapStyle:this.getMapStyleValue(A),zooms:[B,j],viewMode:"3D"},Qe),Wr.zoom&&(Wr.zoom+=1),ct===e&&console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),bn=new AMap.Map(this.$mapContainer,Wr),this.map=bn,hn=bn.getCenter(),(Vr=this.map.customCoords)===null||Vr===void 0||Vr.setCenter([hn.lng,hn.lat]),this.setCustomCoordCenter([hn.lng,hn.lat]),bn.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return vi.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(u){this.cameraChangedCallback=u}},{key:"initViewPort",value:function(){var u,h=(u=this.map.customCoords)===null||u===void 0?void 0:u.getCameraParams(),v=h.fov,m=h.near,w=h.far,A=h.aspect,R=h.position,B=h.lookAt,G=h.up;this.emit("mapchange");var j=this.map.customCoords.getCenter(),lt=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:A,far:w,fov:v,cameraPosition:R,lookAt:B,near:m,up:G,zoom:lt-1,center:j,offsetOrigin:[R[0],R[1]]}),this.coordinateSystemService.setCoordinateSystem(el.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(u,h){var v=[0,0];return v[0]=u[0]-h[0],v[1]=u[1]-h[1],v}}]),a}(zP))||VP);function p(n){var l=g();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function g(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var _=function(n){(0,zt.Z)(a,n);var l=p(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getServiceConstructor",value:function(){return c}}]),a}(aT),S=nt(80966),I=nt.n(S),L={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},F,z,V,Q,st,at,Ft,Kt,ee,Me,hr,Tr={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},Dr=12,cn=(F=(0,Tt.b2)(),z=(0,Tt.f3)(Dt.MapConfig),V=(0,Tt.f3)(Dt.IGlobalConfigService),Q=(0,Tt.f3)(Dt.ICoordinateSystemService),st=(0,Tt.f3)(Dt.IEventEmitter),F(at=(Ft=function(){function n(){var l=this;(0,pt.Z)(this,n),(0,W.Z)(this,"version",Tc.DEFUALT),(0,W.Z)(this,"simpleMapCoord",new iy),(0,W.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Rn(this,"config",Kt,this),Rn(this,"configService",ee,this),Rn(this,"coordinateSystemService",Me,this),Rn(this,"eventEmitter",hr,this),(0,W.Z)(this,"handleCameraChanged",function(a){var s=l.map.getCenter(),u=s.lat,h=s.lng;l.emit("mapchange"),l.viewport.syncWithMapCamera({bearing:l.map.getBearing(),center:[h,u],viewportHeight:l.map.transform.height,pitch:l.map.getPitch(),viewportWidth:l.map.transform.width,zoom:l.map.getZoom(),cameraHeight:0}),l.updateCoordinateSystemService(),l.cameraChangedCallback(l.viewport)})}return(0,et.Z)(n,[{key:"setBgColor",value:function(a){this.bgColor=a}},{key:"addMarkerContainer",value:function(){var a=this.map.getCanvasContainer();this.markerContainer=Jt("div","l7-marker-container",a),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"on",value:function(a,s){G_.indexOf(a)!==-1?this.eventEmitter.on(a,s):this.map.on(Tr[a]||a,s)}},{key:"off",value:function(a,s){this.map.off(Tr[a]||a,s),this.eventEmitter.off(a,s)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version===Tc.SIMPLE)return this.simpleMapCoord.getSize();var a=this.map.transform;return[a.width,a.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(a){return this.map.setZoom(a)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(a){this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(a){this.map.setBearing(a)}},{key:"zoomIn",value:function(a,s){this.map.zoomIn(a,s)}},{key:"zoomOut",value:function(a,s){this.map.zoomOut(a,s)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([a,s])}},{key:"fitBounds",value:function(a,s){this.map.fitBounds(a,s)}},{key:"setMaxZoom",value:function(a){this.map.setMaxZoom(a)}},{key:"setMinZoom",value:function(a){this.map.setMinZoom(a)}},{key:"setMapStatus",value:function(a){a.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),a.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),a.dragEnable===!1&&this.map.dragPan.disable(),a.dragEnable===!0&&this.map.dragPan.enable(),a.rotateEnable===!1&&this.map.dragRotate.disable(),a.dragEnable===!0&&this.map.dragRotate.enable(),a.keyboardEnable===!1&&this.map.keyboard.disable(),a.keyboardEnable===!0&&this.map.keyboard.enable(),a.zoomEnable===!1&&this.map.scrollZoom.disable(),a.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(a,s){this.map.flyTo({zoom:a,center:s})}},{key:"setMapStyle",value:function(a){this.map.setStyle(this.getMapStyleValue(a))}},{key:"meterToCoord",value:function(a,s){return 1}},{key:"pixelToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToPixel",value:function(a){return this.map.project(a)}},{key:"containerToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToContainer",value:function(a){return this.map.project(a)}},{key:"getMapStyle",value:function(){try{var a,s=(a=this.map.getStyle().sprite)!==null&&a!==void 0?a:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(s)?s==null?void 0:s.replace(/\/\w+$/,"").replace(/sprites/,"styles"):s}catch(u){return""}}},{key:"getMapStyleConfig",value:function(){return L}},{key:"getMapStyleValue",value:function(a){var s;return(s=this.getMapStyleConfig()[a])!==null&&s!==void 0?s:a}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(a){for(var s,u=arguments.length,h=new Array(u>1?u-1:0),v=1;v<u;v++)h[v-1]=arguments[v];(s=this.eventEmitter).emit.apply(s,[a].concat(h))}},{key:"once",value:function(a){for(var s,u=arguments.length,h=new Array(u>1?u-1:0),v=1;v<u;v++)h[v-1]=arguments[v];(s=this.eventEmitter).once.apply(s,[a].concat(h))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(a){var s=this.map.getCanvas(),u=a==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png");return u}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"creatMapContainer",value:function(a){var s=a;return typeof a=="string"&&(s=document.getElementById(a)),s}},{key:"updateView",value:function(a){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:a.bearing,center:a.center,viewportHeight:a.viewportHeight,pitch:a.pitch,viewportWidth:a.viewportWidth,zoom:a.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var a=this.config.offsetCoordinate,s=a===void 0?!0:a;this.viewport.getZoom()>Dr&&s?this.coordinateSystemService.setCoordinateSystem(el.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(el.LNGLAT)}}]),n}(),Kt=Fi(Ft.prototype,"config",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Fi(Ft.prototype,"configService",[V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Fi(Ft.prototype,"coordinateSystemService",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hr=Fi(Ft.prototype,"eventEmitter",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft))||at),Jr=function(){function n(){(0,pt.Z)(this,n)}return(0,et.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.center,u=a.zoom,h=a.pitch,v=a.bearing,m=a.viewportHeight,w=a.viewportWidth;this.viewport=new Jb({width:w,height:m,longitude:s&&s[0],latitude:s&&s[1],zoom:u,pitch:h,bearing:v})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}}]),n}(),Mn=["id","attributionControl","style","token","rotation","mapInstance"],mi,da;function Sa(n){var l=eo();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function eo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function Gn(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var u=l.head||l.getElementsByTagName("head")[0];if(!u){u=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(u,h):l.documentElement.appendChild(u)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),u.appendChild(v),v}}Gn(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=I();var Vi=0,ua="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg",Xi=(mi=(0,Tt.b2)(),mi(da=function(n){(0,zt.Z)(a,n);var l=Sa(a);function a(){var s;(0,pt.Z)(this,a);for(var u=arguments.length,h=new Array(u),v=0;v<u;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,W.Z)((0,ut.Z)(s),"version",Tc.MAPBOX),s}return(0,et.Z)(a,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},v=this.lngLatToMercator(u,0),m=v.x,w=v.y;return[m-h.x,w-h.y]}},{key:"lngLatToMercator",value:function(u,h){var v=window.mapboxgl.MercatorCoordinate.fromLngLat(u,h),m=v.x,w=m===void 0?0:m,A=v.y,R=A===void 0?0:A,B=v.z,G=B===void 0?0:B;return{x:w,y:R,z:G}}},{key:"getModelMatrix",value:function(u,h,v){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],w=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},A=window.mapboxgl.MercatorCoordinate.fromLngLat(u,h),R=A.meterInMercatorCoordinateUnits(),B=$r();return li(B,B,Co.fromValues(A.x-w.x,A.y-w.y,A.z||0-w.z)),wi(B,B,Co.fromValues(R*m[0],-R*m[1],R*m[2])),Ni(B,B,v[0]),Oi(B,B,v[1]),zi(B,B,v[2]),B}},{key:"init",value:function(){var s=(0,J.Z)(ot().mark(function h(){var v=this,m,w,A,R,B,G,j,lt,ct,_t,Zt,pe,fe;return ot().wrap(function(Qe){for(;;)switch(Qe.prev=Qe.next){case 0:m=this.config,w=m.id,A=w===void 0?"map":w,R=m.attributionControl,B=R===void 0?!1:R,G=m.style,j=G===void 0?"light":G,lt=m.token,ct=lt===void 0?ua:lt,_t=m.rotation,Zt=_t===void 0?0:_t,pe=m.mapInstance,fe=(0,ql.Z)(m,Mn),this.viewport=new Jr,!pe&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),ct===ua&&j!=="blank"&&!window.mapboxgl.accessToken&&!pe&&console.warn(this.configService.getSceneWarninfo("MapToken")),!pe&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=ct),pe?(this.map=pe,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(A),this.map=new window.mapboxgl.Map((0,K.Z)({container:this.$mapContainer,style:this.getMapStyleValue(j),attributionControl:B,bearing:Zt},fe))),this.map.on("load",function(){v.handleCameraChanged()}),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Qe.stop()}},h,this)}));function u(){return s.apply(this,arguments)}return u}()},{key:"destroy",value:function(){var u,h;(u=this.$mapContainer)===null||u===void 0||(h=u.parentNode)===null||h===void 0||h.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(u){for(var h,v=arguments.length,m=new Array(v>1?v-1:0),w=1;w<v;w++)m[w-1]=arguments[w];(h=this.eventEmitter).emit.apply(h,[u].concat(m))}},{key:"once",value:function(u){for(var h,v=arguments.length,m=new Array(v>1?v-1:0),w=1;w<v;w++)m[w-1]=arguments[w];(h=this.eventEmitter).once.apply(h,[u].concat(m))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(u,h){var v=new(I()).LngLat(u[0],u[1]),m=new(I()).LngLat(h[0],h[1]),w=v.distanceTo(m),A=I().MercatorCoordinate.fromLngLat({lng:u[0],lat:u[1]}),R=I().MercatorCoordinate.fromLngLat({lng:h[0],lat:h[1]}),B=A.x,G=A.y,j=R.x,lt=R.y,ct=Math.sqrt(Math.pow(B-j,2)+Math.pow(G-lt,2))*4194304*2;return ct/w}},{key:"exportMap",value:function(u){var h=this.map.getCanvas(),v=u==="jpg"?h==null?void 0:h.toDataURL("image/jpeg"):h==null?void 0:h.toDataURL("image/png");return v}},{key:"creatMapContainer",value:function(u){var h=u;typeof u=="string"&&(h=document.getElementById(u));var v=document.createElement("div");return v.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,v.id="l7_mapbox_div"+Vi++,h.appendChild(v),v}}]),a}(cn))||da);function ea(n){var l=ka();return function(){var s=(0,b.Z)(n),u;if(l){var h=(0,b.Z)(this).constructor;u=Reflect.construct(s,arguments,h)}else u=s.apply(this,arguments);return(0,P.Z)(this,u)}}function ka(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function xo(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var u=l.head||l.getElementsByTagName("head")[0];if(!u){u=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(u,h):l.documentElement.appendChild(u)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),u.appendChild(v),v}}xo(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var Mo=function(n){(0,zt.Z)(a,n);var l=ea(a);function a(){return(0,pt.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getServiceConstructor",value:function(){return Xi}}]),a}(aT),$a=nt(42090),Za=nt(85306),ss={fontFamily:`
  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`},ju="l7plot-tooltip",Wu="l7plot-tooltip__title",Nh="l7plot-tooltip__list",Xv="l7plot-tooltip__list-item",ed="l7plot-tooltip__name",j0="l7plot-tooltip__value",kg='<div class="'.concat(ju,`">
  <div class="`).concat(Wu,`"></div>
  <ul class="`).concat(Nh,`"></ul>
</div>`),i2='<li class="'.concat(Xv,`" data-index={index}>
  <span class="`).concat(ed,`">{name}</span>
  <span class="`).concat(j0,`">{value}</span>
</li>`),Yv,GP=(Yv={},Yv[ju]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:ss.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},Yv[Wu]={marginBottom:"4px"},Yv[Nh]={margin:"0px",listStyleType:"none",padding:"0px"},Yv[Xv]={listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},Yv[ed]={},Yv[j0]={marginLeft:"30px"},Yv),wT=nt(71452);function a2(n,l){return!!n.className.match(new RegExp("(\\s|^)".concat(l,"(\\s|$)")))}function a_(n){for(var l=n.childNodes,a=l.length,s=a-1;s>=0;s--)n.removeChild(l[s])}var o2=function(){function n(l){this.destroyed=!1,this.options=(0,Et.b$)({},this.getDefaultOptions(),l),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}return n.prototype.getDefaultOptions=function(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}},n.prototype.getContainer=function(){return this.container},n.prototype.getParentContainer=function(){var l=this.options.parent,a;if(!l)return a;if((0,Et.HD)(l)){var s=document.getElementById(l);if(s)a=s;else throw new Error("No parent id ".concat(l))}else a=l;return a},n.prototype.initContainer=function(){var l=this.createDom(this.options.containerTpl),a=this.getParentContainer();return a&&a.appendChild(l),l},n.prototype.initVisible=function(){this.options.visible?this.show():this.hide()},n.prototype.initCapture=function(){this.setCapture(this.options.capture)},n.prototype.update=function(l){this.options=(0,Et.b$)({},this.options,l),this.updateInner(l),this.afterUpdate(l)},n.prototype.updateInner=function(l){l.domStyles&&this.applyStyles()},n.prototype.afterUpdate=function(l){l.capture&&this.setCapture(l.capture)},n.prototype.setCapture=function(l){var a=this.container,s=l?"auto":"none";a.style.pointerEvents=s},n.prototype.applyStyles=function(){var l=this.options.domStyles;if(l){var a=this.container;this.applyChildrenStyles(a,l);var s=this.options.className;if(s&&a2(a,s)){var u=l[s];(0,Za.Z)(a,u)}}},n.prototype.applyChildrenStyles=function(l,a){(0,Et.S6)(a,function(s,u){var h=l.getElementsByClassName(u);(0,Et.S6)(h,function(v){(0,Za.Z)(v,s)})})},n.prototype.applyStyle=function(l,a){var s=this.options.domStyles;s&&(0,Za.Z)(a,s[l])},n.prototype.createDom=function(l){return l===void 0&&(l="<div></div>"),(0,wT.Z)(l)},n.prototype.removeDom=function(){var l=this.container;l&&l.parentNode&&l.parentNode.removeChild(l)},n.prototype.destroy=function(){this.removeEvent(),this.removeDom(),this.destroyed=!0},n}(),s2=function(n){(0,k.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,Et.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:kg,itemTpl:i2,domStyles:GP,className:ju})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),u=this.getParentContainer();return u&&u.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(Wu)[0],u=a.getElementsByClassName(Nh)[0];this.titleDom=s,this.listDom=u},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,Za.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,Za.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.items&&this.renderItems()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,u=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(u,h),this.container=u,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,u=a(this.options.title||"",this.options.items);return(0,Et.HD)(u)?s=this.createDom(u):s=u,s},l.prototype.resetTitle=function(){var a=this.options.title,s=this.options.showTitle;s&&a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,Za.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,Za.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderItems=function(){var a=this;this.clearItemDoms();var s=this.options.items,u=this.options.itemTpl||i2,h=this.listDom;h&&(s.forEach(function(v){var m=(0,k.pi)({},v),w=(0,Et.ng)(u,m),A=a.createDom(w);h.appendChild(A)}),this.applyChildrenStyles(h,this.options.domStyles))},l.prototype.clearItemDoms=function(){this.listDom&&a_(this.listDom)},l.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},l}(o2),u2=nt(39588),l2=typeof global=="object"&&global&&global.Object===Object&&global,c2=l2,$F=typeof self=="object"&&self&&self.Object===Object&&self,HP=c2||$F||Function("return this")(),yp=HP,jP=yp.Symbol,vf=jP,Lg=Object.prototype,UR=Lg.hasOwnProperty,ZR=Lg.toString,f2=vf?vf.toStringTag:void 0;function VR(n){var l=UR.call(n,f2),a=n[f2];try{n[f2]=void 0;var s=!0}catch(h){}var u=ZR.call(n);return s&&(l?n[f2]=a:delete n[f2]),u}var GR=VR,HR=Object.prototype,jR=HR.toString;function WR(n){return jR.call(n)}var XR=WR,YR="[object Null]",$R="[object Undefined]",qF=vf?vf.toStringTag:void 0;function qR(n){return n==null?n===void 0?$R:YR:qF&&qF in Object(n)?GR(n):XR(n)}var KF=qR;function KR(n){return n!=null&&typeof n=="object"}var QR=KR,JR="[object Symbol]";function t6(n){return typeof n=="symbol"||QR(n)&&KF(n)==JR}var ST=t6,e6=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r6=/^\w*$/;function n6(n,l){if((0,u2.Z)(n))return!1;var a=typeof n;return a=="number"||a=="symbol"||a=="boolean"||n==null||ST(n)?!0:r6.test(n)||!e6.test(n)||l!=null&&n in Object(l)}var i6=n6;function a6(n){var l=typeof n;return n!=null&&(l=="object"||l=="function")}var CT=a6,o6="[object AsyncFunction]",s6="[object Function]",u6="[object GeneratorFunction]",l6="[object Proxy]";function c6(n){if(!CT(n))return!1;var l=KF(n);return l==s6||l==u6||l==o6||l==l6}var f6=c6,h6=yp["__core-js_shared__"],WP=h6,QF=function(){var n=/[^.]+$/.exec(WP&&WP.keys&&WP.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function p6(n){return!!QF&&QF in n}var d6=p6,v6=Function.prototype,g6=v6.toString;function m6(n){if(n!=null){try{return g6.call(n)}catch(l){}try{return n+""}catch(l){}}return""}var y6=m6,_6=/[\\^$.*+?()[\]{}|]/g,x6=/^\[object .+?Constructor\]$/,b6=Function.prototype,E6=Object.prototype,w6=b6.toString,S6=E6.hasOwnProperty,C6=RegExp("^"+w6.call(S6).replace(_6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function A6(n){if(!CT(n)||d6(n))return!1;var l=f6(n)?C6:x6;return l.test(y6(n))}var T6=A6;function M6(n,l){return n==null?void 0:n[l]}var I6=M6;function k6(n,l){var a=I6(n,l);return T6(a)?a:void 0}var JF=k6,L6=JF(Object,"create"),h2=L6;function P6(){this.__data__=h2?h2(null):{},this.size=0}var O6=P6;function F6(n){var l=this.has(n)&&delete this.__data__[n];return this.size-=l?1:0,l}var R6=F6,D6="__lodash_hash_undefined__",B6=Object.prototype,N6=B6.hasOwnProperty;function z6(n){var l=this.__data__;if(h2){var a=l[n];return a===D6?void 0:a}return N6.call(l,n)?l[n]:void 0}var U6=z6,Z6=Object.prototype,V6=Z6.hasOwnProperty;function G6(n){var l=this.__data__;return h2?l[n]!==void 0:V6.call(l,n)}var H6=G6,j6="__lodash_hash_undefined__";function W6(n,l){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=h2&&l===void 0?j6:l,this}var X6=W6;function o_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}o_.prototype.clear=O6,o_.prototype.delete=R6,o_.prototype.get=U6,o_.prototype.has=H6,o_.prototype.set=X6;var tR=o_;function Y6(){this.__data__=[],this.size=0}var $6=Y6;function q6(n,l){return n===l||n!==n&&l!==l}var K6=q6;function Q6(n,l){for(var a=n.length;a--;)if(K6(n[a][0],l))return a;return-1}var AT=Q6,J6=Array.prototype,tD=J6.splice;function eD(n){var l=this.__data__,a=AT(l,n);if(a<0)return!1;var s=l.length-1;return a==s?l.pop():tD.call(l,a,1),--this.size,!0}var rD=eD;function nD(n){var l=this.__data__,a=AT(l,n);return a<0?void 0:l[a][1]}var iD=nD;function aD(n){return AT(this.__data__,n)>-1}var oD=aD;function sD(n,l){var a=this.__data__,s=AT(a,n);return s<0?(++this.size,a.push([n,l])):a[s][1]=l,this}var uD=sD;function s_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}s_.prototype.clear=$6,s_.prototype.delete=rD,s_.prototype.get=iD,s_.prototype.has=oD,s_.prototype.set=uD;var lD=s_,cD=JF(yp,"Map"),fD=cD;function hD(){this.size=0,this.__data__={hash:new tR,map:new(fD||lD),string:new tR}}var pD=hD;function dD(n){var l=typeof n;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?n!=="__proto__":n===null}var vD=dD;function gD(n,l){var a=n.__data__;return vD(l)?a[typeof l=="string"?"string":"hash"]:a.map}var TT=gD;function mD(n){var l=TT(this,n).delete(n);return this.size-=l?1:0,l}var yD=mD;function _D(n){return TT(this,n).get(n)}var xD=_D;function bD(n){return TT(this,n).has(n)}var ED=bD;function wD(n,l){var a=TT(this,n),s=a.size;return a.set(n,l),this.size+=a.size==s?0:1,this}var SD=wD;function u_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}u_.prototype.clear=pD,u_.prototype.delete=yD,u_.prototype.get=xD,u_.prototype.has=ED,u_.prototype.set=SD;var eR=u_,CD="Expected a function";function XP(n,l){if(typeof n!="function"||l!=null&&typeof l!="function")throw new TypeError(CD);var a=function(){var s=arguments,u=l?l.apply(this,s):s[0],h=a.cache;if(h.has(u))return h.get(u);var v=n.apply(this,s);return a.cache=h.set(u,v)||h,v};return a.cache=new(XP.Cache||eR),a}XP.Cache=eR;var AD=XP,TD=500;function MD(n){var l=AD(n,function(s){return a.size===TD&&a.clear(),s}),a=l.cache;return l}var ID=MD,kD=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,LD=/\\(\\)?/g,PD=ID(function(n){var l=[];return n.charCodeAt(0)===46&&l.push(""),n.replace(kD,function(a,s,u,h){l.push(u?h.replace(LD,"$1"):s||a)}),l}),OD=PD;function FD(n,l){for(var a=-1,s=n==null?0:n.length,u=Array(s);++a<s;)u[a]=l(n[a],a,n);return u}var RD=FD,DD=1/0,rR=vf?vf.prototype:void 0,nR=rR?rR.toString:void 0;function iR(n){if(typeof n=="string")return n;if((0,u2.Z)(n))return RD(n,iR)+"";if(ST(n))return nR?nR.call(n):"";var l=n+"";return l=="0"&&1/n==-DD?"-0":l}var BD=iR;function ND(n){return n==null?"":BD(n)}var YP=ND;function zD(n,l){return(0,u2.Z)(n)?n:i6(n,l)?[n]:OD(YP(n))}var UD=zD,ZD=1/0;function VD(n){if(typeof n=="string"||ST(n))return n;var l=n+"";return l=="0"&&1/n==-ZD?"-0":l}var GD=VD;function HD(n,l){l=UD(l,n);for(var a=0,s=l.length;n!=null&&a<s;)n=n[GD(l[a++])];return a&&a==s?n:void 0}var jD=HD;function WD(n,l,a){var s=n==null?void 0:jD(n,l);return s===void 0?a:s}var aR=WD,XD=5,YD=new Object().toString,oR=function(n,l){return YD.call(n)==="[object "+l+"]"},$D=function(n){return oR(n,"Array")},qD=function(n){return typeof n=="object"&&n!==null},sR=function(n){if(!qD(n)||!oR(n,"Object"))return!1;for(var l=n;Object.getPrototypeOf(l)!==null;)l=Object.getPrototypeOf(l);return Object.getPrototypeOf(n)===l},uR=function(n,l,a,s){a=a||0,s=s||XD;for(var u in l)if(Object.prototype.hasOwnProperty.call(l,u)){var h=l[u];h?sR(h)?(sR(n[u])||(n[u]={}),a<s?uR(n[u],h,a+1,s):n[u]=l[u]):$D(h)?(n[u]=[],n[u]=n[u].concat(h)):n[u]=h:n[u]=h}},_p=function(n){for(var l=[],a=1;a<arguments.length;a++)l[a-1]=arguments[a];for(var s=0;s<l.length;s+=1)uR(n,l[s]);return n},KD=["mousemove","click"],QD=function(n){(0,k.ZT)(l,n);function l(a,s,u){var h=n.call(this)||this;h.currentVisible=!1,h.interactionTriggerHander=function(lt){var ct=lt.feature,_t=lt.featureId,Zt=h.options,pe=Zt.title,fe=Zt.customTitle,Ze=Zt.items,Qe=Zt.customItems,wr=ct.type==="Feature"&&ct.geometry&&ct.properties,Lr=wr?ct.properties:ct,Vr=[];if(Qe){var Wr=Qe(ct);if(Array.isArray(Wr))Vr=Wr;else throw new Error("customItems return array")}else Ze&&Ze.forEach(function(hn){if((0,Et.HD)(hn)){var Wn=hn.split(".").pop()||hn,vi=aR(Lr,hn);vi!==void 0&&Vr.push({name:Wn,value:vi})}else{var $i=hn.field,go=hn.alias,zo=hn.customValue,zs=go||$i.split(".").pop()||$i,vi=aR(Lr,$i);vi!==void 0&&Vr.push({name:zs,value:zo?zo(vi,Lr,_t):vi})}});var bn={title:fe?fe(Lr):pe,items:Vr};h.updateTooltip(lt,bn)},h.interactionUntriggerHander=function(){h.hideTooltip()},h.scene=a,h.interactionLayers=s,h.options=_p({},h.getDefaultOptions(),u);var v=h.options,m=v.offsets,w=v.title,A=v.showTitle,R=v.customContent,B=v.domStyles,G=v.anchor,j=v.className;return h.marker=new Uy({offsets:m,anchor:G,draggable:!1}),h.tooltipComponent=new s2({title:w,showTitle:A,items:[],customContent:R,domStyles:B,className:j}),h.setComponent(),h.initInteractionEvent(),h}return l.prototype.getDefaultOptions=function(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:ui["TOP-LEFT"]}},l.prototype.update=function(a){this.marker.remove(),this.currentVisible=!1,this.options=_p({},this.options,a);var s=this.options,u=s.offsets,h=s.showTitle,v=s.customContent,m=s.domStyles,w=s.anchor,A=s.className;this.marker=new Uy({offsets:u,anchor:w,draggable:!1}),this.tooltipComponent.update({showTitle:h,customContent:v,domStyles:m,className:A}),this.setComponent()},l.prototype.initInteractionEvent=function(){var a=this,s=this.options.trigger||"mousemove";if(!KD.includes(s))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach(function(u){var h=u.layer;h.on(s,a.interactionTriggerHander),h.on("un".concat(s),a.interactionUntriggerHander)})},l.prototype.unBindInteractionEvent=function(){var a=this,s=this.options.trigger||"mousemove";this.interactionLayers.forEach(function(u){var h=u.layer;h.off(s,a.interactionTriggerHander),h.off("un".concat(s),a.interactionUntriggerHander)})},l.prototype.updateTooltip=function(a,s){var u=a.lngLat,h=a.x,v=a.y;if(this.options.showComponent&&(this.updateComponent(s),this.setPostion(u)),this.currentVisible){var m={type:"tooltip:change",data:s,lngLat:u,x:h,y:v};this.emit("tooltip:change",m)}else{this.showTooltip();var w={type:"tooltip:show",data:s,lngLat:u,x:h,y:v};this.emit("tooltip:show",w)}},l.prototype.showTooltip=function(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)},l.prototype.hideTooltip=function(){if(this.currentVisible){this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;var a={type:"tooltip:hide"};this.emit("tooltip:hide",a)}},l.prototype.updateComponent=function(a){(0,Et.Xy)(this.lastComponentOptions,a)||(this.tooltipComponent.update(a),this.lastComponentOptions=a)},l.prototype.setComponent=function(){var a=this.tooltipComponent.getContainer(),s=window.document.createElement("div");s.style.cursor="auto",s.style.userSelect="text",s.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(u){s.addEventListener(u,function(h){return h.stopPropagation()})}),s.appendChild(a),this.marker.setElement(s)},l.prototype.setPostion=function(a){this.marker.setLnglat(a)},l.prototype.destroy=function(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()},l}($a.Z),$P="l7plot-legend l7plot-legend__category",qP="l7plot-legend__title",KP="l7plot-legend__category-list",lR="l7plot-legend__list-item",cR="l7plot-legend__category-marker",fR="l7plot-legend__category-value",JD='<div class="'.concat($P,`">
  <div class="`).concat(qP,`"></div>
  <ul class="`).concat(KP,`"></ul>
</div>`),hR='<li class="'.concat(lR,`" data-index={index}>
  <span class="`).concat(cR,`" style="background:{color}"></span>
  <span class="`).concat(fR,`">{value}</span>
</li>`),Pg,t7=(Pg={},Pg[$P]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:ss.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},Pg[qP]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},Pg[KP]={margin:"0px",listStyleType:"none",padding:"0px"},Pg[lR]={listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},Pg[cR]={width:"10px",height:"10px"},Pg[fR]={paddingLeft:"8px"},Pg),e7=function(n){(0,k.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,Et.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:JD,itemTpl:hR,domStyles:t7,className:$P})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),u=this.getParentContainer();return u&&u.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(qP)[0],u=a.getElementsByClassName(KP)[0];this.titleDom=s,this.listDom=u},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,Za.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,Za.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.items&&this.renderItems()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,u=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(u,h),this.container=u,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,u=a(this.options.title||"",this.options.items);return(0,Et.HD)(u)?s=this.createDom(u):s=u,s},l.prototype.resetTitle=function(){var a=this.options.title;a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,Za.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,Za.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderItems=function(){var a=this;this.clearItemDoms();var s=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,u=this.options.itemTpl||hR,h=this.listDom;h&&(s.forEach(function(v){var m=v.value==="",w=m?"\u2014":Array.isArray(v.value)?v.value.join(" - "):v.value,A=(0,k.pi)((0,k.pi)({},v),{value:w}),R=(0,Et.ng)(u,A),B=a.createDom(R);h.appendChild(B)}),this.applyChildrenStyles(h,this.options.domStyles))},l.prototype.clearItemDoms=function(){this.listDom&&a_(this.listDom)},l.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},l}(o2),QP="l7plot-legend l7plot-legend__continue",JP="l7plot-legend__title",pR="l7plot-legend__ribbon-container",dR="l7plot-legend__ribbon",vR="l7plot-legend__gradient-bar",tO="l7plot-legend__value-range",r7='<div class="'.concat(QP,`">
  <div class="`).concat(JP,`"></div>
  <div class="`).concat(pR,`"></div>
</div>`),gR='<div class="'.concat(dR,`">
  <span class="`).concat(tO,`">{min}</span>
  <div class="`).concat(vR,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(tO,`">{max}</span>
</div>`),sy,n7=(sy={},sy[QP]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:ss.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},sy[JP]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},sy[dR]={display:"flex",alignItems:"center"},sy[vR]={width:"140px",height:"14px",margin:"0px 5px"},sy[tO]={padding:"0px"},sy),i7=function(n){(0,k.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,Et.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:r7,ribbonTpl:gR,domStyles:n7,className:QP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),u=this.getParentContainer();return u&&u.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(JP)[0],u=a.getElementsByClassName(pR)[0];this.titleDom=s,this.ribbonContainerDom=u},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,Za.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,Za.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.colors&&this.renderRibbon()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,u=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(u,h),this.container=u,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,u=a(this.options.title||"",this.options.min,this.options.max,this.options.colors);return(0,Et.HD)(u)?s=this.createDom(u):s=u,s},l.prototype.resetTitle=function(){var a=this.options.title;a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,Za.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,Za.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderRibbon=function(){this.clearRibbonContainerDoms();var a=this.options,s=a.min,u=a.max,h=a.colors,v=a.ribbonTpl,m=v===void 0?gR:v,w=this.ribbonContainerDom;if(w){var A="linear-gradient(to right, ".concat(h.join(", "),")"),R={min:s,max:u,backgroundImage:A},B=(0,Et.ng)(m,R),G=this.createDom(B);w.appendChild(G),this.applyChildrenStyles(w,this.options.domStyles)}},l.prototype.clearRibbonContainerDoms=function(){this.ribbonContainerDom&&a_(this.ribbonContainerDom)},l.prototype.clear=function(){this.setTitle(""),this.clearRibbonContainerDoms()},l}(o2),a7=function(n){(0,k.ZT)(l,n);function l(a){var s=n.call(this,a)||this;return s.legendComponents=[],s.options=a,s.legendComponents=s.initLegendComponents(a.items),s}return l.prototype.initLegendComponents=function(a){for(var s=[],u=0;u<a.length;u++){var h=a[u];if(h.type==="category"){var v=new e7({title:h.options.title,items:h.options.items,className:h.options.className,customContent:h.options.customContent,domStyles:h.options.domStyles});s.push(v)}else if(h.type==="continue"){var v=new i7({title:h.options.title,min:h.options.min,max:h.options.max,colors:h.options.colors,className:h.options.className,customContent:h.options.customContent,domStyles:h.options.domStyles});s.push(v)}}return s},l.prototype.getDefaultOptions=function(){return{position:"bottomleft"}},l.prototype.onAdd=function(){var a=window.document.createElement("div");return a.className="l7plot-legend-container",this.legendComponents.forEach(function(s){var u=s.getContainer();a.appendChild(u)}),a},l.prototype.onRemove=function(){this.legendComponents.forEach(function(a){a.destroy()})},l}(Ud),l_;(function(n){n.Amap="amap",n.Mapbox="mapbox"})(l_||(l_={}));var mR=function(n){(0,k.ZT)(l,n);function l(a,s){a===void 0&&(a=[]),s===void 0&&(s={});var u=n.call(this)||this;return u.name=s.name?s.name:(0,Et.EL)("layerGroup"),u.layers=a,u}return l.prototype.addTo=function(a){var s=this;this.scene=a;var u=0,h=this.layers.length;this.layers.forEach(function(v){v.once("inited",function(m){u++,s.emit("inited",m),u===h&&s.emit("inited-all")}),v.addTo(a)})},l.prototype.hasLayer=function(a){return this.layers.some(function(s){return s===a})},l.prototype.addLayer=function(a){var s=this;this.layers.push(a),this.scene&&(a.once("inited",function(u){return s.emit("inited",u)}),a.addTo(this.scene))},l.prototype.removeLayer=function(a){var s=this.layers.findIndex(function(u){return u===a});return s===-1?!1:(this.layers.splice(s,1),this.scene&&a.remove(this.scene),!0)},l.prototype.getLayers=function(){return this.layers},l.prototype.getInteractionLayers=function(){return this.layers.filter(function(a){var s=a.interaction;return s})},l.prototype.getLayer=function(a){return this.layers.find(function(s){var u=s.layer;return u.id===a})},l.prototype.getLayerByName=function(a){return this.layers.find(function(s){return s.name===a})},l.prototype.removeAllLayer=function(){var a=this;this.layers.forEach(function(s){a.scene&&s.remove(a.scene)}),this.layers=[]},l.prototype.isEmpty=function(){return this.layers.length===0},l}($a.Z),o7=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}],s7=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"],MT=["inited","add","remove","dataUpdate","click","unclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick"],uy=new Map;function l8(n,l){uy.set(n,l)}function c8(n){n.forEach(function(l){uy.set(l.id,l.image)})}function f8(n){return uy.get(n)}function h8(n){return uy.has(n)}function p8(n){return uy.delete(n)}var IT=new Map;function d8(n,l){IT.set(n,l)}function v8(n){return IT.delete(n)}var p2=new Map;function g8(n,l){p2.set(n,l)}function m8(n){n.forEach(function(l){p2.set(l.name,l.fontUnicode)})}function y8(n){return p2.delete(n)}var c_=nt(84593),f_=nt(52789),d2=nt(34996);function yR(n){var l,a,s,u={point:{default:{fill:n.pointFillColor,size:n.pointSize,stroke:n.pointBorderColor,lineWidth:n.pointBorder,fillOpacity:n.pointFillOpacity},active:{fill:n.pointActiveFillColor},selected:{fill:n.pointSelectedFillColor}}};return{mapStyle:n.mapStyle,defaultColor:n.brandColor,subColor:n.subColor,semanticRed:n.paletteSemanticRed,semanticGreen:n.paletteSemanticGreen,fontFamily:n.fontFamily,colors10:n.paletteQualitative10,colors20:n.paletteQualitative20,sequenceColors:n.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:u.point.default},active:{style:u.point.active},selected:{style:u.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:(l={},l[f_.rC]={visibility:"visible",zIndex:1,backgroundColor:n.legendContainerFillColor,boxShadow:n.legendContainerShadow,borderRadius:"".concat(n.legendContainerBorderRadius,"px"),color:n.legendTextFillColor,fontFamily:n.fontFamily,padding:"10px",lineHeight:"1",fontSize:"".concat(n.legendTextFontSize,"px")},l[f_.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},l[f_.fL]={margin:"0px",padding:"0px"},l[f_.jp]={marginBottom:"2px"},l[f_.Bc]={width:"10px",height:"10px"},l[f_.Tf]={paddingLeft:"8px"},l)},continue:{domStyles:(a={},a[d2.rC]={visibility:"visible",zIndex:1,backgroundColor:n.legendContainerFillColor,boxShadow:n.legendContainerShadow,borderRadius:"".concat(n.legendContainerBorderRadius,"px"),color:n.legendTextFillColor,fontFamily:n.fontFamily,padding:"10px",lineHeight:1,fontSize:"".concat(n.legendTextFontSize,"px")},a[d2.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},a[d2.el]={display:"flex",alignItems:"center"},a[d2.bl]={width:"140px",height:"14px",margin:"0px 5px"},a[d2.VI]={padding:"0px"},a)}},tooltip:{domStyles:(s={},s[c_.rC]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:n.tooltipContainerFillColor,boxShadow:n.tooltipContainerShadow,borderRadius:"".concat(n.tooltipContainerBorderRadius,"px"),color:n.tooltipTextFillColor,fontSize:"".concat(n.tooltipTextFontSize,"px"),fontFamily:n.fontFamily,lineHeight:n.tooltipTextLineHeight},s[c_.O6]={marginBottom:"4px"},s[c_.fL]={margin:"0px",padding:"0px"},s[c_.jp]={marginBottom:"4px"},s[c_.bX]={color:n.tooltipItemNameFillColor},s[c_.Tf]={color:n.tooltipItemValueFillColor,marginLeft:"30px"},s)},label:{style:{textAnchor:"center",textOffset:[0,0],fill:n.labelFillColor,fontSize:n.labelFontSize,fontFamily:n.fontFamily,fillColorDark:n.labelFillColorDark,fillColorLight:n.labelFillColorLight}}}}}var ly={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},u7={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},l7=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],c7=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],f7=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],_R=function(n){n===void 0&&(n={});var l=n.mapStyle,a=l===void 0?"light":l,s=n.subColor,u=s===void 0?"rgba(0,0,0,0.05)":s,h=n.paletteQualitative10,v=h===void 0?l7:h,m=n.paletteQualitative20,w=m===void 0?c7:m,A=n.paletteSemanticRed,R=A===void 0?"#F4664A":A,B=n.paletteSemanticGreen,G=B===void 0?"#30BF78":B,j=n.paletteSemanticYellow,lt=j===void 0?"#FAAD14":j,ct=n.paletteSequence,_t=ct===void 0?f7:ct,Zt=n.fontFamily,pe=Zt===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Zt,fe=n.brandColor,Ze=fe===void 0?v[0]:fe;return{mapStyle:a,brandColor:Ze,subColor:u,paletteQualitative10:v,paletteQualitative20:w,paletteSemanticRed:R,paletteSemanticGreen:G,paletteSemanticYellow:lt,paletteSequence:_t,fontFamily:pe,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:ly[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:ly[65],tooltipItemNameFillColor:ly[65],tooltipItemValueFillColor:ly[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:ly[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:Ze,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:u7[100],pointActiveBorderColor:ly[100],pointSelectedBorderColor:ly[100]}},_8=_R(),h7={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},cy={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},xR=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],p7=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],d7=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],bR=function(n){n===void 0&&(n={});var l=n.mapStyle,a=l===void 0?"dark":l,s=n.subColor,u=s===void 0?"rgba(255,255,255,0.05)":s,h=n.paletteQualitative10,v=h===void 0?xR:h,m=n.paletteQualitative20,w=m===void 0?p7:m,A=n.paletteSemanticRed,R=A===void 0?"#F4664A":A,B=n.paletteSemanticGreen,G=B===void 0?"#30BF78":B,j=n.paletteSemanticYellow,lt=j===void 0?"#FAAD14":j,ct=n.paletteSequence,_t=ct===void 0?d7:ct,Zt=n.fontFamily,pe=Zt===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Zt,fe=n.brandColor,Ze=fe===void 0?v[0]:fe;return{mapStyle:a,brandColor:Ze,subColor:u,paletteQualitative10:v,paletteQualitative20:w,paletteSemanticRed:R,paletteSemanticGreen:G,paletteSemanticYellow:lt,paletteSequence:_t,fontFamily:pe,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:cy[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:cy[65],tooltipItemNameFillColor:cy[65],tooltipItemValueFillColor:cy[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:cy[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:xR[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:h7[100],pointActiveBorderColor:cy[100],pointSelectedBorderColor:cy[100]}},x8=bR();function ER(n){var l=n.styleSheet,a=l===void 0?{}:l,s=(0,k._T)(n,["styleSheet"]),u=_R(a);return(0,Et.b$)({},yR(u),s)}function v7(n){var l=n.styleSheet,a=l===void 0?{}:l,s=(0,k._T)(n,["styleSheet"]),u=bR(a);return(0,Et.b$)({},yR(u),s)}var wR=ER({}),g7=v7({}),eO={default:wR,light:wR,dark:g7};function rO(n){return n===void 0&&(n="default"),(0,Et.U2)(eO,(0,Et.vl)(n),eO.default)}function b8(n,l,a){a===void 0&&(a="light"),eO[lowerCase(n)]=a==="light"?createTheme(l):createDarkTheme(l)}var SR={map:{type:l_.Amap},logo:!0},m7=function(n){(0,k.ZT)(l,n);function l(a){var s=n.call(this)||this;return s.inited=!1,s.sceneLoaded=!1,s.layersLoaded=!1,s.loaded=!1,s.layerGroup=new mR,s.options=_p({},s.getDefaultOptions(),a),s.lastOptions=s.options,s}return l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createContainer=function(a){var s=this.options,u=s.width,h=s.height,v=typeof a=="string"?document.getElementById(a):a;return v.style.position||(v.style.position="relative"),u&&(v.style.width||(v.style.width="".concat(u,"px"))),h&&(v.style.height||(v.style.height="".concat(h,"px"))),v},l.prototype.createTheme=function(){var a=(0,Et.Kn)(this.options.theme)?_p({},rO("default"),ER(this.options.theme)):rO(this.options.theme);return a},l.prototype.createMap=function(){var a=this.options.map?this.options.map:SR.map,s=a.type,u=(0,k._T)(a,["type"]),h=Object.assign({style:this.theme.mapStyle},u);return s===l_.Amap?new _(h):new Mo(h)},l.prototype.createScene=function(){var a=this.options,s=a.logo,u=a.antialias,h=a.preserveDrawingBuffer,v=(0,Et.jn)(s)?{logoVisible:s}:{logoVisible:s==null?void 0:s.visible,logoPosition:s==null?void 0:s.position},m=Object.assign({antialias:u,preserveDrawingBuffer:h},v),w=this.createMap(),A=new AP((0,k.pi)({id:this.container,map:w},m));return A},l.prototype.registerResources=function(){var a=this;uy.size&&uy.forEach(function(s,u){!a.scene.hasImage(u)&&a.scene.addImage(u,s)}),IT.size&&IT.forEach(function(s,u){a.scene.addFontFace(u,s)}),p2.size&&p2.forEach(function(s,u){a.scene.addIconFont(u,s)})},l.prototype.update=function(a){this.updateOption(a),a.map&&!(0,Et.Xy)(this.lastOptions.map,this.options.map)&&this.updateMap(a.map),this.render(),this.emit("update")},l.prototype.updateOption=function(a){this.lastOptions=this.options,this.options=_p({},this.options,a)},l.prototype.updateMap=function(a){var s;if(this.scene){var u=a.style,h=a.center,v=a.zoom,m=a.rotation,w=a.pitch;(0,Et.o8)(w)||this.scene.setPitch(w),(0,Et.o8)(m)||this.scene.setRotation(m),u&&u!==((s=this.lastOptions.map)===null||s===void 0?void 0:s.style)&&this.scene.setMapStyle(u),v&&h&&this.scene.setZoomAndCenter(v,h)}},l.prototype.changeSize=function(a,s){this.options.width===a&&this.options.height===s||(this.container.style.width="".concat(a,"px"),this.container.style.height="".concat(s,"px"),this.options=Object.assign(this.options,{width:a,height:s}))},l.prototype.on=function(a,s,u){return this.proxyEventHander("on",a,s,u),this},l.prototype.once=function(a,s){return this.proxyEventHander("once",a,s),this},l.prototype.off=function(a,s){return this.proxyEventHander("off",a,s),this},l.prototype.proxyEventHander=function(a,s,u,h){var v=o7.find(function(B){return B.adaptation===s});if(v)this.scene[a](v.original,u);else if(s7.indexOf(s)!==-1)this.scene[a](s,u);else if(s.includes("Layer:")){var m=(0,k.CR)(s.split(":"),2),w=m[0],A=m[1],R=this[w]&&this[w][a];if(R&&MT.indexOf(A)!==-1)this[w][a](A,u);else throw new Error('No event name "'.concat(s,'"'))}else n.prototype[a].call(this,s,u,h)},l.prototype.getScene=function(){return this.scene},l.prototype.getMap=function(){var a,s;return((a=this.options.map)===null||a===void 0?void 0:a.type)===l_.Amap?this.scene.map:((s=this.options.map)===null||s===void 0?void 0:s.type)===l_.Mapbox?this.scene.map:this.scene.map},l.prototype.addLayer=function(a){this.layerGroup.addLayer(a)},l.prototype.getLayes=function(){return console.warn("Replace to use getLayers()"),this.getLayers()},l.prototype.getLayers=function(){return this.layerGroup.getLayers()},l.prototype.getLayerByName=function(a){return this.layerGroup.getLayerByName(a)},l.prototype.removeLayer=function(a){return this.layerGroup.removeLayer(a)},l.prototype.removeAllLayer=function(){this.layerGroup.removeAllLayer()},l.prototype.zoomIn=function(){this.scene.zoomIn()},l.prototype.zoomOut=function(){this.scene.zoomOut()},l.prototype.setPitch=function(a){this.scene.setPitch(a)},l.prototype.fitBounds=function(a){this.scene.fitBounds(a)},l.prototype.setMapStatus=function(a){this.scene.setMapStatus(a)},l.prototype.setBgColor=function(a){this.scene.setBgColor(a)},l.prototype.initComponents=function(){this.initControls(),this.initTooltip()},l.prototype.updateComponents=function(){this.updateControls(),this.initTooltip()},l.prototype.initControls=function(){var a=this,s=this.options,u=s.zoom,h=s.scale,v=s.layerMenu,m=s.legend;h&&this.addScaleControl(h),u&&this.addZoomControl(u),v&&this.addLayerMenuControl(v),m&&setTimeout(function(){a.addLegendControl(m),a.emit("add-legend")},1e3)},l.prototype.updateControls=function(){var a=this.options,s=a.zoom,u=a.scale,h=a.layerMenu,v=a.legend;(0,Et.Xy)(this.lastOptions.zoom,s)||(s?this.updateZoomControl(s):this.removeZoomControl()),(0,Et.Xy)(this.lastOptions.scale,u)||(u?this.updateScaleControl(u):this.removeScaleControl()),(0,Et.Xy)(this.lastOptions.layerMenu,h)||(h?this.updateLayerMenuControl(h):this.removeLayerMenuControl()),(0,Et.Xy)(this.lastOptions.legend,v)||(v?this.updateLegendControl(v):this.removeLegendControl())},l.prototype.addZoomControl=function(a){this.zoomControl||(this.zoomControl=new A3(a),this.scene.addControl(this.zoomControl))},l.prototype.updateZoomControl=function(a){if(!this.zoomControl){this.addZoomControl(a);return}this.removeZoomControl(),this.addZoomControl(a)},l.prototype.removeZoomControl=function(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)},l.prototype.addScaleControl=function(a){this.scaleControl||(this.scaleControl=new M3(a),this.scene.addControl(this.scaleControl))},l.prototype.updateScaleControl=function(a){if(!this.scaleControl){this.addScaleControl(a);return}this.removeScaleControl(),this.addScaleControl(a)},l.prototype.removeScaleControl=function(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)},l.prototype.addLayerMenuControl=function(a){var s={},u={};this.layerGroup.getLayers().forEach(function(h){var v=h.name,m=h.layer;u[v]=m})},l.prototype.updateLayerMenuControl=function(a){this.removeLayerMenuControl(),this.addLayerMenuControl(a)},l.prototype.removeLayerMenuControl=function(){},l.prototype.getLegendOptions=function(){return{}},l.prototype.addLegendControl=function(a){if(!this.legendControl){var s=this.theme.components.legend,u=_p({},this.getLegendOptions(),a),h=u.type,v=u.position,m=(0,k._T)(u,["type","position"]),w=[];if(h==="category"){var A=_p({},{domStyles:s.category.domStyles},m);w.push({type:h,options:A})}else if(h==="continue"){var R=_p({},{domStyles:s.continue.domStyles},m);w.push({type:h,options:R})}w.length&&(this.legendControl=new a7({position:v,items:w}),this.scene.addControl(this.legendControl))}},l.prototype.updateLegendControl=function(a){if(!this.legendControl){this.addLegendControl(a);return}this.removeLegendControl(),this.addLegendControl(a)},l.prototype.removeLegendControl=function(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)},l.prototype.initTooltip=function(){var a=this;this.tooltip&&this.tooltip.destroy();var s=this.options.tooltip;if(s){var u=_p({},{domStyles:this.theme.components.tooltip.domStyles},s),h=this.layerGroup.getInteractionLayers();this.tooltip=new QD(this.scene,h,u),this.tooltip.on("*",function(v){return a.emit(v.type,v)})}},l.prototype.exportPng=function(a){return this.scene.exportPng(a)},l.prototype.destroy=function(){var a;n.prototype.off.call(this,"*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(a=this.tooltip)===null||a===void 0||a.destroy(),this.scene.destroy()},l.DefaultOptions=SR,l}($a.Z),CR;(function(n){n[n.solid=0]="solid",n[n.dash=1]="dash"})(CR||(CR={}));var nO;(function(n){n.TextLayer="textLayer",n.DotLayer="dotLayer",n.IconLayer="iconLayer",n.DotDensity="dotDensityLayer",n.ColumnLayer="columnLayer",n.HeatmapLayer="heatmapLayer",n.GridLayer="gridLayer",n.HexbinLayer="hexbinLayer",n.LinesLayer="linesLayer",n.PathLayer="pathLayer",n.ArcLayer="arcLayer",n.AreaLayer="areaLayer",n.PrismLayer="prismLayer"})(nO||(nO={}));var iO=function(){function n(){}return n.aggregation=function(l,a){var s=a.type,u=s===void 0?"grid":s,h=a.radius,v=a.method,m=a.field,w={type:u,size:h,method:v,field:m};l.transforms?(l.transforms=l.transforms.filter(function(A){return A.type!==w.type}),l.transforms.push(w)):l.transforms=[w]},n}(),AR=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"],h_=function(n){(0,k.ZT)(l,n);function l(a){var s=n.call(this)||this;return s.options=_p({},s.getDefaultOptions(),a),s.lastOptions=s.options,s}return l.prototype.getDefaultOptions=function(){return{}},l.prototype.pickLayerConfig=function(a){var s=(0,Et.ei)(a,AR);return s},l.prototype.addTo=function(a){a.addLayer(this.layer)},l.prototype.remove=function(a){a.removeLayer(this.layer)},l.prototype.update=function(a){this.updateOption(a),this.updateConfig(a)},l.prototype.updateOption=function(a){this.lastOptions=this.options,this.options=_p({},this.options,a)},l.prototype.updateConfig=function(a){!(0,Et.o8)(a.zIndex)&&!(0,Et.Xy)(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(a.zIndex),!(0,Et.o8)(a.blend)&&!(0,Et.Xy)(this.lastOptions.blend,this.options.blend)&&this.setBlend(a.blend),!(0,Et.o8)(a.minZoom)&&!(0,Et.Xy)(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(a.minZoom),!(0,Et.o8)(a.maxZoom)&&!(0,Et.Xy)(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMinZoom(a.maxZoom),!(0,Et.o8)(a.visible)&&!(0,Et.Xy)(this.lastOptions.visible,this.options.visible)&&(a.visible?this.show():this.hide())},l.prototype.render=function(){this.layer.renderLayers()},l.prototype.setSource=function(a){if(a instanceof M0)this.layer.setSource(a);else{var s=a.data,u=a.aggregation,h=(0,k._T)(a,["data","aggregation"]);u&&iO.aggregation(h,u);var v=this.layer.getSource();v?this.layer.setData(s,h):this.layer.source(s,h)}},l.prototype.changeData=function(a){this.setSource(a)},l.prototype.setIndex=function(a){this.layer.setIndex(a)},l.prototype.setBlend=function(a){this.layer.setBlend(a)},l.prototype.setMinZoom=function(a){this.layer.setMinZoom(a)},l.prototype.setMaxZoom=function(a){this.layer.setMaxZoom(a)},l.prototype.show=function(){this.layer.inited&&this.layer.show()},l.prototype.hide=function(){this.layer.inited&&this.layer.hide()},l.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},l.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():this.options.visible},l.prototype.fitBounds=function(a){this.layer.fitBounds(a)},l.prototype.on=function(a,s){return MT.indexOf(a)!==-1?this.layer.on(a,s):n.prototype.on.call(this,a,s),this},l.prototype.once=function(a,s){return MT.indexOf(a)!==-1?this.layer.once(a,s):n.prototype.once.call(this,a,s),this},l.prototype.off=function(a,s){return MT.indexOf(a)!==-1?this.layer.off(a,s):n.prototype.off.call(this,a,s),this},l.LayerType=nO,l.LayerConfigkeys=AR,l}($a.Z);function fy(n,l){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var u={};return n.forEach(function(h,v){u[h]=a[v]}),delete u.undefined,l(u)}}var rl=function(){function n(){}return n.shape=function(l,a){if((0,Et.HD)(a))l.shape(a);else if((0,Et.mf)(a)){var s=[];l.shape(s.join("*"),fy(s,a))}else if((0,Et.Kn)(a)){var u=a.field?a.field:"";if((0,Et.mf)(a.value)){var s=(0,Et.kJ)(u)?u:u.split("*");l.shape(u,fy(s,a.value))}else l.shape(u,a.value);(0,Et.HD)(u)&&a.scale&&n.scale(l,u,a.scale)}},n.size=function(l,a){if((0,Et.hj)(a))l.size(a);else if((0,Et.kJ)(a))l.size(a);else if((0,Et.mf)(a)){var s=[];l.size(s.join("*"),fy(s,a))}else if((0,Et.Kn)(a)){var u=a.field?a.field:"";if((0,Et.mf)(a.value)){var s=(0,Et.kJ)(u)?u:u.split("*");l.size(u,fy(s,a.value))}else l.size(u,a.value);(0,Et.HD)(u)&&a.scale&&n.scale(l,u,a.scale)}},n.color=function(l,a){if((0,Et.HD)(a))l.color(a);else if((0,Et.mf)(a)){var s=[];l.color(s.join("*"),fy(s,a))}else if((0,Et.Kn)(a)){var u=a.field?a.field:"";if((0,Et.mf)(a.value)){var s=(0,Et.kJ)(u)?u:u.split("*");l.color(u,fy(s,a.value))}else l.color(u,a.value);(0,Et.HD)(u)&&a.scale&&n.scale(l,u,a.scale)}},n.style=function(l,a){a&&l.style(a)},n.state=function(l,a){var s=a.active,u=a.select;s&&l.active(s),u&&l.select(u)},n.rotate=function(l,a){(0,Et.HD)(a)||(0,Et.mf)(a)||(0,Et.Kn)(a)},n.texture=function(l,a){(0,Et.HD)(a)&&l.texture(a)},n.animate=function(l,a){((0,Et.jn)(a)||(0,Et.Kn)(a))&&l.animate(a)},n.scale=function(l,a,s){l.scale(a,s)},n.filter=function(l,a){var s=a.field?a.field:"",u=(0,Et.kJ)(s)?s:s.split("*");l.filter(u.join("*"),fy(u,a.value))},n}();function y7(n,l){var a=l.field,s=l.content,u=l.style,h=u===void 0?{}:u,v=l.state,m=h.fontSize,w=h.fill,A=a||s||"",R={field:A,value:"text"};rl.shape(n,R),m&&rl.size(n,m),w&&rl.color(n,w),h&&rl.style(n,h),v&&rl.state(n,v)}var TR={style:{fontSize:12}},_7=[],x7=function(n){(0,k.ZT)(l,n);function l(a){var s=n.call(this,a)||this;s.type=h_.LayerType.TextLayer,s.interaction=!1;var u=s.options,h=u.name,v=u.source,m=s.pickLayerConfig(s.options);return s.name=h||(0,Et.EL)(s.type),s.layer=new m1((0,k.pi)((0,k.pi)({},m),{name:s.name})),s.mappingLayer(s.layer,s.options),s.setSource(v),s}return l.prototype.getDefaultOptions=function(){return TR},l.prototype.mappingLayer=function(a,s){y7(a,s)},l.prototype.update=function(a){n.prototype.update.call(this,a),this.mappingLayer(this.layer,this.options)},l.DefaultOptions=TR,l.LayerOptionsKeys=h_.LayerConfigkeys.concat(_7),l}(h_),aO;(function(n){n.Dot="dot",n.DotDensity="dotDensity",n.Heatmap="heatmap",n.Grid="grid",n.Hexbin="hexbin",n.Path="path",n.Flow="flow",n.Area="area",n.Choropleth="choropleth"})(aO||(aO={}));var b7={autoFit:!1},oO=function(n){(0,k.ZT)(l,n);function l(a,s){var u=this;if(typeof a=="string"||a instanceof Element){if(s===void 0)throw new Error("options is undefined");u=n.call(this,s)||this,u.container=u.createContainer(a),u.theme=u.createTheme(),u.scene=u.createScene(),u.registerResources(),u.initSource()}else u=n.call(this,a)||this;return u}return l.prototype.initSource=function(){this.source=this.createSource(),this.render(),this.inited=!0},l.prototype.initLayersEvent=function(){},l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createSource=function(){var a=this.options.source,s=a.data,u=a.aggregation,h=(0,k._T)(a,["data","aggregation"]);u&&iO.aggregation(h,u);var v=new M0(s,h);return v},l.prototype.createLabelLayer=function(a,s,u){var h=u||{},v=h.visible,m=h.minZoom,w=h.maxZoom,A=h.zIndex,R=A===void 0?0:A,B=new x7((0,k.pi)({name:"labelLayer",visible:v,minZoom:m,maxZoom:w,zIndex:R+.1,source:a},s));return B},l.prototype.updateLabelLayer=function(a,s,u,h){s?h?h.update((0,k.pi)({},s)):(h=this.createLabelLayer(a,s,u),this.layerGroup.addLayer(h)):s===!1&&h&&this.layerGroup.removeLayer(h)},l.prototype.render=function(){var a=this,s=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),s.addTo(this.scene),this.layerGroup=s):(this.layerGroup=s,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){a.onSceneLoaded()})),this.initLayersEvent()},l.prototype.onSceneLoaded=function(){var a=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){a.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},l.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")},l.prototype.attachToScene=function(a,s){this.scene=a,this.theme=s||rO("default"),this.registerResources(),this.initSource()},l.prototype.unattachFromScene=function(){var a;this.removeAllLayer(),(a=this.tooltip)===null||a===void 0||a.destroy()},l.prototype.addToScene=function(a){this.attachToScene(a)},l.prototype.removeFromScene=function(){var a;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(a=this.tooltip)===null||a===void 0||a.destroy()},l.prototype.update=function(a){if(this.updateOption(a),a.map&&!(0,Et.Xy)(this.lastOptions.map,this.options.map)&&this.updateMap(a.map),this.scene.setEnableRender(!1),a.source&&!(0,Et.Xy)(this.lastOptions.source,this.options.source)){var s=a.source,u=s.data,h=(0,k._T)(s,["data"]);this.changeData(u,h)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")},l.prototype.changeData=function(a,s){var u=this;this.options.source=_p({},this.options.source,(0,k.pi)({data:a},s));var h=this.options.source,v=h.aggregation,m=(0,k._T)(h,["aggregation"]);v&&iO.aggregation(m,v),this.source.setData(this.options.source.data,m);var w=this.options.legend;w&&setTimeout(function(){u.updateLegendControl(w)}),this.emit("change-data")},l.DefaultOptions=b7,l.PlotType=aO,l}(m7),E7=_p({},oO.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}}),MR="#2f54eb",Gc={active:{fill:!1,stroke:MR,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:MR,lineWidth:1.5,lineOpacity:.8}},v2=function(n){return(0,Et.o8)(n)||(n.active===!1?Gc.active=Object.assign(Gc.active,{fill:!1,stroke:!1}):typeof n.active=="object"&&(n.active.fill===!1?Gc.active.fill=!1:typeof n.active.fill=="string"&&(Gc.active.fill=n.active.fill),n.active.stroke===!1?Gc.active.stroke=!1:typeof n.active.stroke=="string"&&(Gc.active.stroke=n.active.stroke),typeof n.active.lineWidth=="number"&&(Gc.active.lineWidth=n.active.lineWidth),typeof n.active.lineOpacity=="number"&&(Gc.active.lineOpacity=n.active.lineOpacity)),n.select===!1?Gc.select=Object.assign(Gc.select,{fill:!1,stroke:!1}):typeof n.select=="object"&&(n.select.fill===!1?Gc.select.fill=!1:typeof n.select.fill=="string"&&(Gc.select.fill=n.select.fill),n.select.stroke===!1?Gc.select.stroke=!1:typeof n.select.stroke=="string"&&(Gc.select.stroke=n.select.stroke),typeof n.select.lineWidth=="number"&&(Gc.select.lineWidth=n.select.lineWidth),typeof n.select.lineOpacity=="number"&&(Gc.select.lineOpacity=n.select.lineOpacity))),Gc};function w7(n,l,a,s,u,h){var v=h.color,m=h.style,w=h.state,A=v2(w),R={active:A.active.fill===!1?!1:{color:A.active.fill},select:!1},B={opacity:m==null?void 0:m.opacity},G=m==null?void 0:m.fillBottomColor,j=m==null?void 0:m.lineWidth,lt=m==null?void 0:m.stroke,ct={opacity:m==null?void 0:m.lineOpacity,dashArray:m==null?void 0:m.lineDash,lineType:m==null?void 0:m.lineType};if(rl.shape(n,"fill"),v&&rl.color(n,v),B&&rl.style(n,B),R&&rl.state(n,R),G&&n.setBottomColor(G),rl.shape(l,"line"),j&&rl.size(l,j),lt&&rl.color(l,lt),ct&&rl.style(l,ct),A.active.stroke){var _t=A.active.stroke,Zt=A.active.lineWidth||j,pe={opacity:A.active.lineOpacity};rl.shape(a,"line"),Zt&&rl.size(a,Zt),_t&&rl.color(a,_t),pe&&rl.style(a,pe)}if(A.select.fill){var fe=A.select.fill;rl.shape(s,"fill"),fe&&rl.color(s,fe),B&&rl.style(s,B),rl.state(s,{select:!1,active:!1})}if(A.select.stroke){var Ze=A.select.stroke,Zt=A.select.lineWidth||j,Qe={opacity:A.select.lineOpacity};rl.shape(u,"line"),Zt&&rl.size(u,Zt),Ze&&rl.color(u,Ze),Qe&&rl.style(u,Qe)}}var S7=/\s/;function C7(n){for(var l=n.length;l--&&S7.test(n.charAt(l)););return l}var A7=C7,T7=/^\s+/;function M7(n){return n&&n.slice(0,A7(n)+1).replace(T7,"")}var I7=M7,IR=0/0,k7=/^[-+]0x[0-9a-f]+$/i,L7=/^0b[01]+$/i,P7=/^0o[0-7]+$/i,O7=parseInt;function F7(n){if(typeof n=="number")return n;if(ST(n))return IR;if(CT(n)){var l=typeof n.valueOf=="function"?n.valueOf():n;n=CT(l)?l+"":l}if(typeof n!="string")return n===0?n:+n;n=I7(n);var a=L7.test(n);return a||P7.test(n)?O7(n.slice(2),a?2:8):k7.test(n)?IR:+n}var kR=F7,LR=1/0,R7=17976931348623157e292;function D7(n){if(!n)return n===0?n:0;if(n=kR(n),n===LR||n===-LR){var l=n<0?-1:1;return l*R7}return n===n?n:0}var B7=D7;function N7(n){var l=B7(n),a=l%1;return l===l?a?l-a:l:0}var z7=N7,U7=yp.isFinite,Z7=Math.min;function V7(n){var l=Math[n];return function(a,s){if(a=kR(a),s=s==null?0:Z7(z7(s),292),s&&U7(a)){var u=(YP(a)+"e").split("e"),h=l(u[0]+"e"+(+u[1]+s));return u=(YP(h)+"e").split("e"),+(u[0]+"e"+(+u[1]-s))}return l(a)}}var G7=V7,H7=G7("round"),PR=H7,j7=function(n){return!Array.isArray(n[0].value)},W7=function(n){if(j7(n))return n;var l=n.map(function(a){return(0,k.pi)((0,k.pi)({},a),{value:[PR(a.value[0],2),PR(a.value[1],2)]})});return l},OR={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},X7=["color","style","state","enabledMultiSelect"],sO=function(n){(0,k.ZT)(l,n);function l(a){var s=n.call(this,a)||this;s.selectData=[],s.type=h_.LayerType.AreaLayer,s.interaction=!0,s.onHighlighHandle=function(lt){var ct=lt.feature,_t=lt.featureId;s.setHighlightLayerSource(ct,_t)},s.onUnhighlighHandle=function(){s.setHighlightLayerSource()},s.onSelectHandle=function(lt){var ct=s.options.enabledMultiSelect,_t=lt.feature,Zt=lt.featureId,pe=(0,Et.d9)(s.selectData),fe=pe.findIndex(function(Qe){return Qe.featureId===Zt});if(fe===-1)ct?pe.push({feature:_t,featureId:Zt}):pe=[{feature:_t,featureId:Zt}],s.emit("select",_t,(0,Et.d9)(pe));else{var Ze=pe[fe];ct?pe.splice(fe,1):pe=[],s.emit("unselect",Ze,(0,Et.d9)(pe))}s.setSelectLayerSource(pe)};var u=s.options,h=u.name,v=u.source,m=u.visible,w=u.minZoom,A=u.maxZoom,R=u.zIndex,B=R===void 0?0:R,G=s.pickLayerConfig(s.options),j=v2(s.options.state);return s.name=h||(0,Et.EL)(s.type),s.layer=new _1((0,k.pi)((0,k.pi)({},G),{name:s.name})),s.strokeLayer=new P0({name:"strokeLayer",visible:m,zIndex:B,minZoom:w,maxZoom:A}),s.highlightLayer=new P0({name:"highlightLayer",visible:m&&Boolean(j.active.stroke),zIndex:B+.1,minZoom:w,maxZoom:A}),s.selectFillLayer=new _1({name:"selectFillLayer",visible:m&&Boolean(j.select.fill),zIndex:B+.1,minZoom:w,maxZoom:A}),s.selectStrokeLayer=new P0({name:"selectStrokeLayer",visible:m&&Boolean(j.select.stroke),zIndex:B+.1,minZoom:w,maxZoom:A}),s.mappingLayer(s.options),s.setSource(v),s.initEvent(),s}return l.prototype.getDefaultOptions=function(){return OR},l.prototype.mappingLayer=function(a){w7(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,a)},l.prototype.setSource=function(a){n.prototype.setSource.call(this,a),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})},l.prototype.setStrokeLayerSource=function(){var a=this.layer.getSource();if(a)this.strokeLayer.setSource(a);else{var s=this.layer.sourceOption,u=s.data,h=s.options;this.strokeLayer.source(u,h)}},l.prototype.setHighlightLayerSource=function(a,s){if(s===void 0&&(s=-999),this.highlightLayerData!==s){var u=a?[a]:[];this.highlightLayer.setData({type:"FeatureCollection",features:u},{parser:{type:"geojson"}}),this.highlightLayerData=s}},l.prototype.setSelectLayerSource=function(a){if(a===void 0&&(a=[]),!(this.selectData.length===a.length&&(0,Et.Xy)(this.selectData.map(function(u){var h=u.featureId;return h}),a.map(function(u){var h=u.featureId;return h})))){var s=a.map(function(u){var h=u.feature;return h});this.selectFillLayer.setData({type:"FeatureCollection",features:s},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:s},{parser:{type:"geojson"}}),this.selectData=a}},l.prototype.initEvent=function(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))},l.prototype.addTo=function(a){a.addLayer(this.layer),a.addLayer(this.strokeLayer),a.addLayer(this.highlightLayer),a.addLayer(this.selectFillLayer),a.addLayer(this.selectStrokeLayer)},l.prototype.remove=function(a){a.removeLayer(this.layer),a.removeLayer(this.strokeLayer),a.removeLayer(this.highlightLayer),a.removeLayer(this.selectFillLayer),a.removeLayer(this.selectStrokeLayer)},l.prototype.update=function(a){if(n.prototype.update.call(this,a),this.mappingLayer(this.options),this.options.visible){!(0,Et.o8)(a.state)&&!(0,Et.Xy)(this.lastOptions.state,this.options.state)&&this.updateHighlightLayer();var s=v2(this.options.state);s.active.stroke&&this.setHighlightLayerSource(),(s.select.fill||s.select.stroke)&&this.setSelectLayerSource()}this.initEvent()},l.prototype.updateHighlightLayer=function(){var a=v2(this.options.state),s=v2(this.lastOptions.state);s.active.stroke!==a.active.stroke&&(a.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),s.select.fill!==a.select.fill&&(a.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),s.select.stroke!==a.select.stroke&&(a.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},l.prototype.setIndex=function(a){this.layer.setIndex(a),this.strokeLayer.setIndex(a),this.highlightLayer.setIndex(a+.1),this.selectFillLayer.setIndex(a+.1),this.selectStrokeLayer.setIndex(a+.1)},l.prototype.setMinZoom=function(a){this.layer.setMinZoom(a),this.strokeLayer.setMinZoom(a),this.highlightLayer.setMinZoom(a),this.selectFillLayer.setMinZoom(a),this.selectStrokeLayer.setMinZoom(a)},l.prototype.setMaxZoom=function(a){this.layer.setMaxZoom(a),this.strokeLayer.setMaxZoom(a),this.highlightLayer.setMaxZoom(a),this.selectFillLayer.setMaxZoom(a),this.selectStrokeLayer.setMaxZoom(a)},l.prototype.show=function(){this.layer.inited&&(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())},l.prototype.hide=function(){this.layer.inited&&(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())},l.prototype.getColorLegendItems=function(){var a=this.layer.getLegendItems("color");if(Array.isArray(a)&&a.length!==0){var s=W7(a);return s}return[]},l.prototype.setActive=function(a){},l.prototype.setSelect=function(a){},l.DefaultOptions=OR,l.LayerOptionsKeys=h_.LayerConfigkeys.concat(X7),l}(h_),Y7=function(n){(0,k.ZT)(l,n);function l(){var a=n!==null&&n.apply(this,arguments)||this;return a.type=oO.PlotType.Area,a}return l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createLayers=function(a){this.areaLayer=new sO((0,k.pi)({source:a},(0,Et.ei)(this.options,sO.LayerOptionsKeys)));var s=new mR([this.areaLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(a,this.options.label,this.options),s.addLayer(this.labelLayer)),s},l.prototype.updateLayers=function(a){var s=(0,Et.ei)(a,sO.LayerOptionsKeys);this.areaLayer.update(s),this.updateLabelLayer(this.source,a.label,this.options,this.labelLayer)},l.prototype.initLayersEvent=function(){},l.prototype.getLegendOptions=function(){var a=this.areaLayer.getColorLegendItems();return a.length!==0?{type:"category",items:a}:{}},l.DefaultOptions=E7,l}(oO),E8=function(n,l){var a={}.toString;return a.call(n)==="[object ".concat(l,"]")},w8=function(n){return Object.prototype.toString.call(n).slice(8,-1)},uO=function(n){if(!n||typeof n!="object")return n;var l;return Array.isArray(n)?l=n.map(function(a){return uO(a)}):(l={},Object.keys(n).forEach(function(a){return l[a]=uO(n[a])})),l},S8=function(n){if(!n)return n;var l={};for(var a in n)l[a]=n[a];return l},g2=function(){return g2=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(n[u]=l[u])}return n},g2.apply(this,arguments)},$7=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,s=Object.getOwnPropertySymbols(n);u<s.length;u++)l.indexOf(s[u])<0&&Object.prototype.propertyIsEnumerable.call(n,s[u])&&(a[s[u]]=n[s[u]]);return a},FR=function(n){var l=n.source,a=$7(n,["source"]),s=g2(g2({},uO(a)),{source:g2({},l)});return s},lO=function(){return lO=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var u in l)Object.prototype.hasOwnProperty.call(l,u)&&(n[u]=l[u])}return n},lO.apply(this,arguments)},kT=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,s=Object.getOwnPropertySymbols(n);u<s.length;u++)l.indexOf(s[u])<0&&Object.prototype.propertyIsEnumerable.call(n,s[u])&&(a[s[u]]=n[s[u]]);return a};function q7(n,l){var a=(0,mt.useRef)(),s=(0,mt.useRef)(),u=(0,mt.useRef)(null),h=l.onReady;return(0,mt.useEffect)(function(){if(!(!a.current||!s.current||(0,Et.Xy)(s.current,l))){var v=!1,m=!1,w=!1,A=s.current,R=A.onReady,B=A.map,G=A.source,j=G.data,lt=kT(G,["data"]),ct=kT(A,["onReady","map","source"]),_t=l.onReady,Zt=l.map,pe=l.source,fe=pe.data,Ze=kT(pe,["data"]),Qe=kT(l,["onReady","map","source"]);if(m=!(0,Et.Xy)(B,Zt),v=!(0,Et.Xy)(lt,Ze)||j!==fe,w=!(0,Et.Xy)(ct,Qe),s.current=FR(l),m){var wr=(0,Et.ei)(Zt,["center","pitch","rotation","zoom","style"]);a.current.updateMap(wr)}v&&(a.current.loaded?a.current.changeData(fe,Ze):a.current.once("loaded",function(){var Lr;(Lr=a.current)===null||Lr===void 0||Lr.changeData(fe,Ze)})),w&&(a.current.loaded?a.current.update(Qe):a.current.once("loaded",function(){var Lr;(Lr=a.current)===null||Lr===void 0||Lr.update(Qe)}))}},[l]),(0,mt.useEffect)(function(){return u.current?(s.current||(s.current=FR(l)),a.current=new n(u.current,lO({},l)),h&&a.current.once("loaded",function(){h(a.current)}),function(){a.current&&(a.current.destroy(),a.current=void 0)}):function(){return null}},[]),{plotRef:a,containerRef:u}}var K7=function(n,l){n&&((0,Et.mf)(n)?n(l):n.current=l)},Q7=function(){var n=function(l,a){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,u){s.__proto__=u}||function(s,u){for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(s[h]=u[h])},n(l,a)};return function(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");n(l,a);function s(){this.constructor=l}l.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}}(),J7=function(n){Q7(l,n);function l(){var a=n!==null&&n.apply(this,arguments)||this;return a.state={hasError:!1},a.renderError=function(s){var u=a.props.errorTemplate;switch(s){default:return typeof u=="function"?u(s):u||mt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",s.message)}},a}return l.getDerivedStateFromError=function(a){return{hasError:!0,error:a}},l.getDerivedStateFromProps=function(a,s){return s.children!==a.children?{children:a.children,hasError:!1,error:void 0}:null},l.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):mt.createElement(mt.Fragment,null,this.props.children)},l}(mt.Component),t8=J7,e8=nt(87488),r8=function(n){var l=n.loadingTemplate,a=function(){return l||mt.createElement(e8.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1},mt.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),mt.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),mt.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),mt.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),mt.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),mt.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),mt.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),mt.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),mt.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),mt.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return mt.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:"#fff"}},a())},n8=r8,i8=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,s=Object.getOwnPropertySymbols(n);u<s.length;u++)l.indexOf(s[u])<0&&Object.prototype.propertyIsEnumerable.call(n,s[u])&&(a[s[u]]=n[s[u]]);return a},a8=(0,mt.forwardRef)(function(n,l){var a=n.chartRef,s=n.containerStyle,u=s===void 0?{height:"inherit"}:s,h=n.className,v=n.loading,m=n.loadingTemplate,w=n.errorTemplate,A=i8(n,["chartRef","containerStyle","className","loading","loadingTemplate","errorTemplate"]),R=q7(Y7,A),B=R.plotRef,G=R.containerRef;return(0,mt.useEffect)(function(){K7(a,B.current)},[B.current]),(0,mt.useImperativeHandle)(l,function(){return{getChart:function(){return B.current}}}),mt.createElement(t8,{errorTemplate:w},v&&mt.createElement(n8,{loadingTemplate:m}),mt.createElement("div",{className:h,style:u,ref:G}))}),o8=a8},61841:function(dn,Pt,nt){"use strict";var kt=nt(79685),mt=nt(40923),k=nt(80157),Et=nt(68141),K=nt(29722),yt=nt(44903),J=function(et,be){var ot={};for(var ut in et)Object.prototype.hasOwnProperty.call(et,ut)&&be.indexOf(ut)<0&&(ot[ut]=et[ut]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var zt=0,ut=Object.getOwnPropertySymbols(et);zt<ut.length;zt++)be.indexOf(ut[zt])<0&&Object.prototype.propertyIsEnumerable.call(et,ut[zt])&&(ot[ut[zt]]=et[ut[zt]]);return ot},pt=(0,kt.forwardRef)(function(et,be){var ot=et.chartRef,ut=et.style,zt=ut===void 0?{height:"inherit"}:ut,P=et.className,b=et.loading,W=et.loadingTemplate,le=et.errorTemplate,Ee=J(et,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),ke=(0,k.Z)(mt.Bar,Ee),Tt=ke.chart,rt=ke.container;return(0,kt.useEffect)(function(){(0,Et.J)(ot,Tt.current)},[Tt.current]),(0,kt.useImperativeHandle)(be,function(){return{getChart:function(){return Tt.current}}}),kt.createElement(K.Z,{errorTemplate:le},b&&kt.createElement(yt.Z,{loadingTemplate:W,theme:et.theme}),kt.createElement("div",{className:P,style:zt,ref:rt}))});Pt.Z=pt},29554:function(dn,Pt,nt){"use strict";var kt=nt(79685),mt=nt(40923),k=nt(80157),Et=nt(68141),K=nt(29722),yt=nt(44903),J=function(et,be){var ot={};for(var ut in et)Object.prototype.hasOwnProperty.call(et,ut)&&be.indexOf(ut)<0&&(ot[ut]=et[ut]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var zt=0,ut=Object.getOwnPropertySymbols(et);zt<ut.length;zt++)be.indexOf(ut[zt])<0&&Object.prototype.propertyIsEnumerable.call(et,ut[zt])&&(ot[ut[zt]]=et[ut[zt]]);return ot},pt=(0,kt.forwardRef)(function(et,be){var ot=et.chartRef,ut=et.style,zt=ut===void 0?{height:"inherit"}:ut,P=et.className,b=et.loading,W=et.loadingTemplate,le=et.errorTemplate,Ee=J(et,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),ke=(0,k.Z)(mt.Column,Ee),Tt=ke.chart,rt=ke.container;return(0,kt.useEffect)(function(){(0,Et.J)(ot,Tt.current)},[Tt.current]),(0,kt.useImperativeHandle)(be,function(){return{getChart:function(){return Tt.current}}}),kt.createElement(K.Z,{errorTemplate:le},b&&kt.createElement(yt.Z,{loadingTemplate:W,theme:et.theme}),kt.createElement("div",{className:P,style:zt,ref:rt}))});Pt.Z=pt},74425:function(dn,Pt,nt){"use strict";var kt=nt(79685),mt=nt(40923),k=nt(80157),Et=nt(68141),K=nt(29722),yt=nt(44903),J=function(et,be){var ot={};for(var ut in et)Object.prototype.hasOwnProperty.call(et,ut)&&be.indexOf(ut)<0&&(ot[ut]=et[ut]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var zt=0,ut=Object.getOwnPropertySymbols(et);zt<ut.length;zt++)be.indexOf(ut[zt])<0&&Object.prototype.propertyIsEnumerable.call(et,ut[zt])&&(ot[ut[zt]]=et[ut[zt]]);return ot},pt=(0,kt.forwardRef)(function(et,be){var ot=et.chartRef,ut=et.style,zt=ut===void 0?{height:"inherit"}:ut,P=et.className,b=et.loading,W=et.loadingTemplate,le=et.errorTemplate,Ee=J(et,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),ke=(0,k.Z)(mt.Pie,Ee),Tt=ke.chart,rt=ke.container;return(0,kt.useEffect)(function(){(0,Et.J)(ot,Tt.current)},[Tt.current]),(0,kt.useImperativeHandle)(be,function(){return{getChart:function(){return Tt.current}}}),kt.createElement(K.Z,{errorTemplate:le},b&&kt.createElement(yt.Z,{loadingTemplate:W,theme:et.theme}),kt.createElement("div",{className:P,style:zt,ref:rt}))});Pt.Z=pt},29722:function(dn,Pt,nt){"use strict";var kt=nt(79685),mt=function(){var Et=function(K,yt){return Et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(J,pt){J.__proto__=pt}||function(J,pt){for(var et in pt)Object.prototype.hasOwnProperty.call(pt,et)&&(J[et]=pt[et])},Et(K,yt)};return function(K,yt){if(typeof yt!="function"&&yt!==null)throw new TypeError("Class extends value "+String(yt)+" is not a constructor or null");Et(K,yt);function J(){this.constructor=K}K.prototype=yt===null?Object.create(yt):(J.prototype=yt.prototype,new J)}}(),k=function(Et){mt(K,Et);function K(){var yt=Et!==null&&Et.apply(this,arguments)||this;return yt.state={hasError:!1},yt.renderError=function(J){var pt=yt.props.errorTemplate;switch(J){default:return typeof pt=="function"?pt(J):pt||kt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",J.message)}},yt}return K.getDerivedStateFromError=function(yt){return{hasError:!0,error:yt}},K.getDerivedStateFromProps=function(yt,J){return J.children!==yt.children?{children:yt.children,hasError:!1,error:void 0}:null},K.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):kt.createElement(kt.Fragment,null,this.props.children)},K}(kt.Component);Pt.Z=k},80157:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return Oe}});var kt=nt(79685),mt=nt(22374),k=nt(50374),Et=nt.t(k,2),K=function(){return K=Object.assign||function(Le){for(var Ve,Bt=1,re=arguments.length;Bt<re;Bt++){Ve=arguments[Bt];for(var ye in Ve)Object.prototype.hasOwnProperty.call(Ve,ye)&&(Le[ye]=Ve[ye])}return Le},K.apply(this,arguments)},yt=function(Le,Ve,Bt,re){function ye(Yt){return Yt instanceof Bt?Yt:new Bt(function(qe){qe(Yt)})}return new(Bt||(Bt=Promise))(function(Yt,qe){function vr(bt){try{qt(re.next(bt))}catch(Wt){qe(Wt)}}function oe(bt){try{qt(re.throw(bt))}catch(Wt){qe(Wt)}}function qt(bt){bt.done?Yt(bt.value):ye(bt.value).then(vr,oe)}qt((re=re.apply(Le,Ve||[])).next())})},J=function(Le,Ve){var Bt={label:0,sent:function(){if(Yt[0]&1)throw Yt[1];return Yt[1]},trys:[],ops:[]},re,ye,Yt,qe;return qe={next:vr(0),throw:vr(1),return:vr(2)},typeof Symbol=="function"&&(qe[Symbol.iterator]=function(){return this}),qe;function vr(qt){return function(bt){return oe([qt,bt])}}function oe(qt){if(re)throw new TypeError("Generator is already executing.");for(;qe&&(qe=0,qt[0]&&(Bt=0)),Bt;)try{if(re=1,ye&&(Yt=qt[0]&2?ye.return:qt[0]?ye.throw||((Yt=ye.return)&&Yt.call(ye),0):ye.next)&&!(Yt=Yt.call(ye,qt[1])).done)return Yt;switch(ye=0,Yt&&(qt=[qt[0]&2,Yt.value]),qt[0]){case 0:case 1:Yt=qt;break;case 4:return Bt.label++,{value:qt[1],done:!1};case 5:Bt.label++,ye=qt[1],qt=[0];continue;case 7:qt=Bt.ops.pop(),Bt.trys.pop();continue;default:if(Yt=Bt.trys,!(Yt=Yt.length>0&&Yt[Yt.length-1])&&(qt[0]===6||qt[0]===2)){Bt=0;continue}if(qt[0]===3&&(!Yt||qt[1]>Yt[0]&&qt[1]<Yt[3])){Bt.label=qt[1];break}if(qt[0]===6&&Bt.label<Yt[1]){Bt.label=Yt[1],Yt=qt;break}if(Yt&&Bt.label<Yt[2]){Bt.label=Yt[2],Bt.ops.push(qt);break}Yt[2]&&Bt.ops.pop(),Bt.trys.pop();continue}qt=Ve.call(Le,Bt)}catch(bt){qt=[6,bt],ye=0}finally{re=Yt=0}if(qt[0]&5)throw qt[1];return{value:qt[0]?qt[1]:void 0,done:!0}}},pt=K({},Et),et=pt.version,be=pt.render,ot=pt.unmountComponentAtNode,ut;try{var zt=Number((et||"").split(".")[0]);zt>=18&&(ut=pt.createRoot)}catch(Le){}function P(Le){var Ve=pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;Ve&&typeof Ve=="object"&&(Ve.usingClientEntryPoint=Le)}var b="__rc_react_root__";function W(Le,Ve){P(!0);var Bt=Ve[b]||ut(Ve);P(!1),Bt.render(Le),Ve[b]=Bt}function le(Le,Ve){be(Le,Ve)}function Ee(Le,Ve){}function ke(Le,Ve){if(ut){W(Le,Ve);return}le(Le,Ve)}function Tt(Le){return yt(this,void 0,void 0,function(){return J(this,function(Ve){return[2,Promise.resolve().then(function(){var Bt;(Bt=Le[b])===null||Bt===void 0||Bt.unmount(),delete Le[b]})]})})}function rt(Le){ot(Le)}function Dt(Le){}function Se(Le){return yt(this,void 0,void 0,function(){return J(this,function(Ve){return ut!==void 0?[2,Tt(Le)]:(rt(Le),[2])})})}var _e=new Map,ve=function(Le,Ve,Bt){var re=document.createElement("div");return Ve==="tooltip"&&(re.setAttribute("data-uuid",Bt),_e.has(Bt)?re=_e.get(Bt):_e.set(Bt,re),re.className="g2-tooltip"),ke(Le,re),re},ne=ve,xe=function(Le,Ve){var Bt={}.toString;return Bt.call(Le)==="[object ".concat(Ve,"]")},Je=function(Le){if(!Le)return Le;var Ve={};for(var Bt in Le)Ve[Bt]=Le[Bt];return Ve},Ot=function(Le){return Object.prototype.toString.call(Le).slice(8,-1)},te=function(Le){if(!Le||typeof Le!="object")return Le;var Ve;return Array.isArray(Le)?Ve=Le.map(function(Bt){return te(Bt)}):(Ve={},Object.keys(Le).forEach(function(Bt){return Ve[Bt]=te(Le[Bt])})),Ve},ft=function(Le,Ve){for(var Bt=Le,re=0;re<Ve.length;re+=1)if(Bt!=null&&Bt[Ve[re]])Bt=Bt[Ve[re]];else{Bt=void 0;break}return Bt},wt=function(Le,Ve,Bt){if(!Le)return Le;var re=Le;return Ve.forEach(function(ye,Yt){Yt<Ve.length-1?re=re[ye]:re[ye]=Bt}),Le},Y=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(Le){var Ve=Math.random()*16|0,Bt=Le=="x"?Ve:Ve&3|8;return Bt.toString(16)})},gt=function(){return gt=Object.assign||function(Le){for(var Ve,Bt=1,re=arguments.length;Bt<re;Bt++){Ve=arguments[Bt];for(var ye in Ve)Object.prototype.hasOwnProperty.call(Ve,ye)&&(Le[ye]=Ve[ye])}return Le},gt.apply(this,arguments)},he=function(Le,Ve){var Bt={};for(var re in Le)Object.prototype.hasOwnProperty.call(Le,re)&&Ve.indexOf(re)<0&&(Bt[re]=Le[re]);if(Le!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ye=0,re=Object.getOwnPropertySymbols(Le);ye<re.length;ye++)Ve.indexOf(re[ye])<0&&Object.prototype.propertyIsEnumerable.call(Le,re[ye])&&(Bt[re[ye]]=Le[re[ye]]);return Bt};function Oe(Le,Ve){var Bt=(0,kt.useRef)(),re=(0,kt.useRef)(),ye=(0,kt.useRef)(null),Yt=Ve.onReady,qe=Ve.onEvent,vr=function(Wt,$t){var xt;return Wt===void 0&&(Wt="image/png"),(xt=Bt.current)===null||xt===void 0?void 0:xt.chart.canvas.cfg.el.toDataURL(Wt,$t)},oe=function(Wt,$t,xt){var St;Wt===void 0&&(Wt="download"),$t===void 0&&($t="image/png");var ue=Wt;Wt.indexOf(".")===-1&&(ue="".concat(Wt,".").concat($t.split("/")[1]));var Pe=(St=Bt.current)===null||St===void 0?void 0:St.chart.canvas.cfg.el.toDataURL($t,xt),ze=document.createElement("a");return ze.href=Pe,ze.download=ue,document.body.appendChild(ze),ze.click(),document.body.removeChild(ze),ze=null,ue},qt=function(Wt,$t,xt,St){var ue=ft(Wt,$t);wt(Wt,$t,function(){for(var Pe=[],ze=0;ze<arguments.length;ze++)Pe[ze]=arguments[ze];var Vt=xe(ue,"Function")?ue.apply(void 0,Pe):ue;return xe(Vt,"String")||xe(Vt,"Number")||xe(Vt,"HTMLDivElement")?Vt:ne(Vt,xt,St)})},bt=function(){var Wt=Y();ft(Ve,["statistic","content","customHtml"])&&qt(Ve,["statistic","content","customHtml"]),ft(Ve,["statistic","title","customHtml"])&&qt(Ve,["statistic","title","customHtml"]),typeof Ve.tooltip=="object"&&(ft(Ve,["tooltip","container"])&&qt(Ve,["tooltip","container"],"tooltip",Wt),ft(Ve,["tooltip","customContent"])&&qt(Ve,["tooltip","customContent"],"tooltip",Wt))};return(0,kt.useEffect)(function(){if(Bt.current&&!(0,mt.Xy)(re.current,Ve)){var Wt=!1;if(re.current){var $t=re.current,xt=$t.data,St=$t.value,ue=$t.percent,Pe=he($t,["data","value","percent"]),ze=Ve.data,Vt=Ve.value,Ct=Ve.percent,At=he(Ve,["data","value","percent"]);Wt=(0,mt.Xy)(Pe,At)}if(re.current=te(Ve),Wt&&(0,mt.U2)(Ve,"chartType")!=="Mix"){var Nt="data",tt=["percent"],vt=Object.keys(Ve);tt.forEach(function(Ht){vt.includes(Ht)&&(Nt=Ht)}),Bt.current.changeData((Ve==null?void 0:Ve[Nt])||[]),Bt.current.render()}else bt(),Bt.current.update(Ve)}},[Ve]),(0,kt.useEffect)(function(){if(!ye.current)return function(){return null};re.current||(re.current=te(Ve)),bt();var Wt=new Le(ye.current,gt({},Ve));Wt.toDataURL=function(xt,St){return vr(xt,St)},Wt.downloadImage=function(xt,St,ue){return oe(xt,St,ue)},Wt.render(),Bt.current=Je(Wt),Yt&&Yt(Wt);var $t=function(xt){qe&&qe(Wt,xt)};return Wt.on("*",$t),function(){Bt.current&&(Bt.current.destroy(),Bt.current.off("*",$t),Bt.current=void 0)}},[]),{chart:Bt,container:ye}}},44903:function(dn,Pt,nt){"use strict";var kt=nt(79685),mt=nt(87488),k=function(Et){var K=Et.loadingTemplate,yt=Et.theme,J=yt===void 0?"light":yt,pt=function(){return K||kt.createElement(mt.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1,backgroundColor:J==="dark"?"#262626":"#D9D9D9"},kt.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),kt.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),kt.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),kt.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),kt.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),kt.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),kt.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),kt.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),kt.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),kt.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return kt.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:J==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},pt())};Pt.Z=k},68141:function(dn,Pt,nt){"use strict";nt.d(Pt,{J:function(){return mt}});var kt=nt(22374),mt=function(k,Et){k&&((0,kt.mf)(k)?k(Et):k.current=Et)}},25211:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return Pe}});var kt=nt(16431),mt=nt(5543),k=nt(66105),Et=nt(47918),K=nt(68591),yt=nt.n(K),J=nt(79685),pt=nt(79322),et=nt(5720),be=nt(71775),ot=function(Vt){return(0,kt.Z)({},Vt.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:Vt.marginLG,marginInline:0,color:Vt.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function ut(ze){return(0,be.Xj)("ProCardOperation",function(Vt){var Ct=(0,mt.Z)((0,mt.Z)({},Vt),{},{componentCls:".".concat(ze)});return[ot(Ct)]})}var zt=nt(63342),P=function(Vt){var Ct=Vt.className,At=Vt.style,Nt=At===void 0?{}:At,tt=Vt.children,vt=(0,J.useContext)(Et.ZP.ConfigContext),Ht=vt.getPrefixCls,de=Ht("pro-card-operation"),jt=ut(de),Ie=jt.wrapSSR,We=jt.hashId,Ke=yt()(de,Ct,We);return Ie((0,zt.jsx)("div",{className:Ke,style:Nt,children:tt}))},b=P,W=nt(44992),le=nt(30877),Ee=function(Vt,Ct){return J.createElement(le.Z,(0,mt.Z)((0,mt.Z)({},Vt),{},{ref:Ct,icon:W.Z}))};Ee.displayName="QuestionCircleOutlined";var ke=J.forwardRef(Ee),Tt=nt(18477),rt=nt(81381),Dt=nt(56865),Se=nt(79696),ve=ze=>{const{value:Vt,formatter:Ct,precision:At,decimalSeparator:Nt,groupSeparator:tt="",prefixCls:vt}=ze;let Ht;if(typeof Ct=="function")Ht=Ct(Vt);else{const de=String(Vt),jt=de.match(/^(-?)(\d*)(\.(\d+))?$/);if(!jt||de==="-")Ht=de;else{const Ie=jt[1];let We=jt[2]||"0",Ke=jt[4]||"";We=We.replace(/\B(?=(\d{3})+(?!\d))/g,tt),typeof At=="number"&&(Ke=Ke.padEnd(At,"0").slice(0,At>0?At:0)),Ke&&(Ke=`${Nt}${Ke}`),Ht=[J.createElement("span",{key:"int",className:`${vt}-content-value-int`},Ie,We),Ke&&J.createElement("span",{key:"decimal",className:`${vt}-content-value-decimal`},Ke)]}}return J.createElement("span",{className:`${vt}-content-value`},Ht)},ne=nt(83396),xe=nt(42006),Je=nt(42786);const Ot=ze=>{const{componentCls:Vt,marginXXS:Ct,padding:At,colorTextDescription:Nt,statisticTitleFontSize:tt,colorTextHeading:vt,statisticContentFontSize:Ht,statisticFontFamily:de}=ze;return{[`${Vt}`]:Object.assign(Object.assign({},(0,Je.Wf)(ze)),{[`${Vt}-title`]:{marginBottom:Ct,color:Nt,fontSize:tt},[`${Vt}-skeleton`]:{paddingTop:At},[`${Vt}-content`]:{color:vt,fontSize:Ht,fontFamily:de,[`${Vt}-content-value`]:{display:"inline-block",direction:"ltr"},[`${Vt}-content-prefix, ${Vt}-content-suffix`]:{display:"inline-block"},[`${Vt}-content-prefix`]:{marginInlineEnd:Ct},[`${Vt}-content-suffix`]:{marginInlineStart:Ct}}})}};var te=(0,ne.Z)("Statistic",ze=>{const{fontSizeHeading3:Vt,fontSize:Ct,fontFamily:At}=ze,Nt=(0,xe.TS)(ze,{statisticTitleFontSize:Ct,statisticContentFontSize:Vt,statisticFontFamily:At});return[Ot(Nt)]}),ft=nt(76171),wt=nt(78592);const Y=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function gt(ze,Vt){let Ct=ze;const At=/\[[^\]]*]/g,Nt=(Vt.match(At)||[]).map(de=>de.slice(1,-1)),tt=Vt.replace(At,"[]"),vt=Y.reduce((de,jt)=>{let[Ie,We]=jt;if(de.includes(Ie)){const Ke=Math.floor(Ct/We);return Ct-=Ke*We,de.replace(new RegExp(`${Ie}+`,"g"),pr=>{const lr=pr.length;return Ke.toString().padStart(lr,"0")})}return de},tt);let Ht=0;return vt.replace(At,()=>{const de=Nt[Ht];return Ht+=1,de})}function he(ze,Vt){const{format:Ct=""}=Vt,At=new Date(ze).getTime(),Nt=Date.now(),tt=Math.max(At-Nt,0);return gt(tt,Ct)}const Oe=1e3/30;function Le(ze){return new Date(ze).getTime()}const Ve=ze=>{const{value:Vt,format:Ct="HH:mm:ss",onChange:At,onFinish:Nt}=ze,tt=(0,ft.Z)(),vt=J.useRef(null),Ht=()=>{Nt==null||Nt(),vt.current&&(clearInterval(vt.current),vt.current=null)},de=()=>{const We=Le(Vt);We>=Date.now()&&(vt.current=setInterval(()=>{tt(),At==null||At(We-Date.now()),We<Date.now()&&Ht()},Oe))};J.useEffect(()=>(de(),()=>{vt.current&&(clearInterval(vt.current),vt.current=null)}),[Vt]);const jt=(We,Ke)=>he(We,Object.assign(Object.assign({},Ke),{format:Ct})),Ie=We=>(0,wt.Tm)(We,{title:void 0});return J.createElement(ye,Object.assign({},ze,{valueRender:Ie,formatter:jt}))};var Bt=J.memo(Ve);const re=ze=>{const{prefixCls:Vt,className:Ct,rootClassName:At,style:Nt,valueStyle:tt,value:vt=0,title:Ht,valueRender:de,prefix:jt,suffix:Ie,loading:We=!1,onMouseEnter:Ke,onMouseLeave:pr,decimalSeparator:lr=".",groupSeparator:Nr=","}=ze,{getPrefixCls:Pr,direction:Gr}=J.useContext(Dt.E_),Sn=Pr("statistic",Vt),[nn,Nn]=te(Sn),Zn=J.createElement(ve,Object.assign({decimalSeparator:lr,groupSeparator:Nr,prefixCls:Sn},ze,{value:vt})),Hn=yt()(Sn,{[`${Sn}-rtl`]:Gr==="rtl"},Ct,At,Nn);return nn(J.createElement("div",{className:Hn,style:Nt,onMouseEnter:Ke,onMouseLeave:pr},Ht&&J.createElement("div",{className:`${Sn}-title`},Ht),J.createElement(Se.Z,{paragraph:!1,loading:We,className:`${Sn}-skeleton`},J.createElement("div",{style:tt,className:`${Sn}-content`},jt&&J.createElement("span",{className:`${Sn}-content-prefix`},jt),de?de(Zn):Zn,Ie&&J.createElement("span",{className:`${Sn}-content-suffix`},Ie)))))};re.Countdown=Bt;var ye=re,Yt=ye,qe=function(Vt){var Ct,At,Nt;return(0,kt.Z)({},Vt.componentCls,(Nt={display:"flex",fontSize:Vt.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,kt.Z)({display:"flex",width:"100%"},"".concat(Vt.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":{width:"100%"},"&-description":{width:"100%"}},(0,kt.Z)(Nt,"".concat(Vt.antCls,"-statistic-title"),{color:Vt.colorText}),(0,kt.Z)(Nt,"&-trend-up",(0,kt.Z)({},"".concat(Vt.antCls,"-statistic-content"),(0,kt.Z)({color:"#f5222d"},"".concat(Vt.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),(0,kt.Z)(Nt,"&-trend-down",(0,kt.Z)({},"".concat(Vt.antCls,"-statistic-content"),(0,kt.Z)({color:"#389e0d"},"".concat(Vt.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),(0,kt.Z)(Nt,"& &-layout-horizontal",(Ct={display:"flex",justifyContent:"space-between"},(0,kt.Z)(Ct,"".concat(Vt.antCls,"-statistic-title"),{marginBlockEnd:0}),(0,kt.Z)(Ct,"".concat(Vt.antCls,"-statistic-content-value"),{fontWeight:500}),(0,kt.Z)(Ct,"".concat(Vt.antCls,"-statistic-title,").concat(Vt.antCls,"-statistic-content,").concat(Vt.antCls,"-statistic-content-suffix,").concat(Vt.antCls,"-statistic-content-prefix,").concat(Vt.antCls,"-statistic-content-value-decimal"),{fontSize:Vt.fontSize}),Ct)),(0,kt.Z)(Nt,"& &-layout-inline",(At={display:"inline-flex",color:Vt.colorTextSecondary},(0,kt.Z)(At,"".concat(Vt.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),(0,kt.Z)(At,"".concat(Vt.antCls,"-statistic-content"),{color:Vt.colorTextSecondary}),(0,kt.Z)(At,"".concat(Vt.antCls,"-statistic-title,").concat(Vt.antCls,"-statistic-content,").concat(Vt.antCls,"-statistic-content-suffix,").concat(Vt.antCls,"-statistic-content-prefix,").concat(Vt.antCls,"-statistic-content-value-decimal"),{fontSize:Vt.fontSizeSM}),At)),Nt))};function vr(ze){return(0,be.Xj)("Statistic",function(Vt){var Ct=(0,mt.Z)((0,mt.Z)({},Vt),{},{componentCls:".".concat(ze)});return[qe(Ct)]})}var oe=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],qt=function(Vt){var Ct,At=Vt.className,Nt=Vt.layout,tt=Nt===void 0?"inline":Nt,vt=Vt.style,Ht=vt===void 0?{}:vt,de=Vt.description,jt=Vt.children,Ie=Vt.title,We=Vt.tip,Ke=Vt.status,pr=Vt.trend,lr=Vt.prefix,Nr=Vt.icon,Pr=(0,k.Z)(Vt,oe),Gr=(0,J.useContext)(Et.ZP.ConfigContext),Sn=Gr.getPrefixCls,nn=Sn("pro-card-statistic"),Nn=vr(nn),Zn=Nn.wrapSSR,Hn=Nn.hashId,An=yt()(nn,At,Hn),$n=yt()("".concat(nn,"-status"),Hn),Rt=yt()("".concat(nn,"-icon"),Hn),Xt=yt()("".concat(nn,"-wrapper"),Hn),ae=yt()("".concat(nn,"-content"),Hn),we=yt()(Hn,(Ct={},(0,kt.Z)(Ct,"".concat(nn,"-layout-").concat(tt),tt),(0,kt.Z)(Ct,"".concat(nn,"-trend-").concat(pr),pr),Ct)),Ge=We&&(0,zt.jsx)(Tt.Z,{title:We,children:(0,zt.jsx)(ke,{className:"".concat(nn,"-tip ").concat(Hn)})}),cr=yt()("".concat(nn,"-trend-icon"),Hn,(0,kt.Z)({},"".concat(nn,"-trend-icon-").concat(pr),pr)),br=pr&&(0,zt.jsx)("div",{className:cr}),Ce=Ke&&(0,zt.jsx)("div",{className:$n,children:(0,zt.jsx)(rt.Z,{status:Ke,text:null})}),ar=Nr&&(0,zt.jsx)("div",{className:Rt,children:Nr});return Zn((0,zt.jsxs)("div",{className:An,style:Ht,children:[ar,(0,zt.jsxs)("div",{className:Xt,children:[Ce,(0,zt.jsxs)("div",{className:ae,children:[(0,zt.jsx)(Yt,(0,mt.Z)({title:(Ie||Ge)&&(0,zt.jsxs)(zt.Fragment,{children:[Ie,Ge]}),prefix:(br||lr)&&(0,zt.jsxs)(zt.Fragment,{children:[br,lr]}),className:we},Pr)),de&&(0,zt.jsx)("div",{className:"".concat(nn,"-description ").concat(Hn),children:de})]})]})]}))},bt=qt,Wt=function(Vt){return(0,kt.Z)({},Vt.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,kt.Z)({flexDirection:"row"},"".concat(Vt.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(Vt.colorBorder)}})};function $t(ze){return(0,be.Xj)("StatisticCard",function(Vt){var Ct=(0,mt.Z)((0,mt.Z)({},Vt),{},{componentCls:".".concat(ze)});return[Wt(Ct)]})}var xt=["children","statistic","className","chart","chartPlacement","footer"],St=function(Vt){var Ct,At=Vt.children,Nt=Vt.statistic,tt=Vt.className,vt=Vt.chart,Ht=Vt.chartPlacement,de=Vt.footer,jt=(0,k.Z)(Vt,xt),Ie=(0,J.useContext)(Et.ZP.ConfigContext),We=Ie.getPrefixCls,Ke=We("pro-statistic-card"),pr=$t(Ke),lr=pr.wrapSSR,Nr=pr.hashId,Pr=yt()(Ke,tt,Nr),Gr=Nt&&(0,zt.jsx)(bt,(0,mt.Z)({layout:"vertical"},Nt)),Sn=yt()("".concat(Ke,"-chart"),Nr,(Ct={},(0,kt.Z)(Ct,"".concat(Ke,"-chart-left"),Ht==="left"&&vt&&Nt),(0,kt.Z)(Ct,"".concat(Ke,"-chart-right"),Ht==="right"&&vt&&Nt),Ct)),nn=vt&&(0,zt.jsx)("div",{className:Sn,children:vt}),Nn=yt()("".concat(Ke,"-content "),Nr,(0,kt.Z)({},"".concat(Ke,"-content-horizontal"),Ht==="left"||Ht==="right")),Zn=(nn||Gr)&&(Ht==="left"?(0,zt.jsxs)("div",{className:Nn,children:[nn,Gr]}):(0,zt.jsxs)("div",{className:Nn,children:[Gr,nn]})),Hn=de&&(0,zt.jsx)("div",{className:"".concat(Ke,"-footer ").concat(Nr),children:de});return lr((0,zt.jsxs)(pt.Z,(0,mt.Z)((0,mt.Z)({className:Pr},jt),{},{children:[Zn,At,Hn]})))},ue=function(Vt){return(0,zt.jsx)(St,(0,mt.Z)({bodyStyle:{padding:0}},Vt))};St.Statistic=bt,St.Divider=et.Z,St.Operation=b,St.isProCard=!0,St.Group=ue;var Pe=St},71452:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return yt}});var kt,mt,k,Et;function K(){kt=document.createElement("table"),mt=document.createElement("tr"),k=/^\s*<(\w+|!)[^>]*>/,Et={tr:document.createElement("tbody"),tbody:kt,thead:kt,tfoot:kt,td:mt,th:mt,"*":document.createElement("div")}}function yt(J){kt||K();var pt=k.test(J)&&RegExp.$1;(!pt||!(pt in Et))&&(pt="*");var et=Et[pt];J=typeof J=="string"?J.replace(/(^\s*)|(\s*$)/g,""):J,et.innerHTML=""+J;var be=et.childNodes[0];return be&&et.contains(be)&&et.removeChild(be),be}},85306:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return kt}});function kt(mt,k){if(mt)for(var Et in k)k.hasOwnProperty(Et)&&(mt.style[Et]=k[Et]);return mt}},42090:function(dn,Pt){"use strict";var nt="*",kt=function(){function mt(){this._events={}}return mt.prototype.on=function(k,Et,K){return this._events[k]||(this._events[k]=[]),this._events[k].push({callback:Et,once:!!K}),this},mt.prototype.once=function(k,Et){return this.on(k,Et,!0)},mt.prototype.emit=function(k){for(var Et=this,K=[],yt=1;yt<arguments.length;yt++)K[yt-1]=arguments[yt];var J=this._events[k]||[],pt=this._events[nt]||[],et=function(be){for(var ot=be.length,ut=0;ut<ot;ut++)if(be[ut]){var zt=be[ut],P=zt.callback,b=zt.once;b&&(be.splice(ut,1),be.length===0&&delete Et._events[k],ot--,ut--),P.apply(Et,K)}};et(J),et(pt)},mt.prototype.off=function(k,Et){if(!k)this._events={};else if(!Et)delete this._events[k];else{for(var K=this._events[k]||[],yt=K.length,J=0;J<yt;J++)K[J].callback===Et&&(K.splice(J,1),yt--,J--);K.length===0&&delete this._events[k]}return this},mt.prototype.getEvents=function(){return this._events},mt}();Pt.Z=kt},53079:function(dn,Pt,nt){"use strict";var kt=nt(29268),mt=nt(42090),k=nt(91220),Et=function(K){(0,kt.ZT)(yt,K);function yt(J){var pt=K.call(this)||this;pt.destroyed=!1;var et=pt.getDefaultCfg();return pt.cfg=(0,k.CD)(et,J),pt}return yt.prototype.getDefaultCfg=function(){return{}},yt.prototype.get=function(J){return this.cfg[J]},yt.prototype.set=function(J,pt){this.cfg[J]=pt},yt.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},yt}(mt.Z);Pt.Z=Et},81577:function(dn,Pt,nt){"use strict";nt.d(Pt,{Z:function(){return _o}});var kt=nt(29268),mt=nt(74348),k=nt(51030),Et=nt(91220),K=nt(22374),yt=0,J=0,pt=0,et=1e3,be,ot,ut=0,zt=0,P=0,b=typeof performance=="object"&&performance.now?performance:Date,W=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(ir){setTimeout(ir,17)};function le(){return zt||(W(Ee),zt=b.now()+P)}function Ee(){zt=0}function ke(){this._call=this._time=this._next=null}ke.prototype=Tt.prototype={constructor:ke,restart:function(ir,ge,He){if(typeof ir!="function")throw new TypeError("callback is not a function");He=(He==null?le():+He)+(ge==null?0:+ge),!this._next&&ot!==this&&(ot?ot._next=this:be=this,ot=this),this._call=ir,this._time=He,ve()},stop:function(){this._call&&(this._call=null,this._time=1/0,ve())}};function Tt(ir,ge,He){var Ir=new ke;return Ir.restart(ir,ge,He),Ir}function rt(){le(),++yt;for(var ir=be,ge;ir;)(ge=zt-ir._time)>=0&&ir._call.call(null,ge),ir=ir._next;--yt}function Dt(){zt=(ut=b.now())+P,yt=J=0;try{rt()}finally{yt=0,_e(),zt=0}}function Se(){var ir=b.now(),ge=ir-ut;ge>et&&(P-=ge,ut=ir)}function _e(){for(var ir,ge=be,He,Ir=1/0;ge;)ge._call?(Ir>ge._time&&(Ir=ge._time),ir=ge,ge=ge._next):(He=ge._next,ge._next=null,ge=ir?ir._next=He:be=He);ot=ir,ve(Ir)}function ve(ir){if(!yt){J&&(J=clearTimeout(J));var ge=ir-zt;ge>24?(ir<1/0&&(J=setTimeout(Dt,ir-b.now()-P)),pt&&(pt=clearInterval(pt))):(pt||(ut=b.now(),pt=setInterval(Se,et)),yt=1,W(Dt))}}var ne=nt(4620);function xe(ir,ge,He){ir.prototype=ge.prototype=He,He.constructor=ir}function Je(ir,ge){var He=Object.create(ir.prototype);for(var Ir in ge)He[Ir]=ge[Ir];return He}function Ot(){}var te=.7,ft=1/te,wt="\\s*([+-]?\\d+)\\s*",Y="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",he=/^#([0-9a-f]{3,8})$/,Oe=new RegExp("^rgb\\(".concat(wt,",").concat(wt,",").concat(wt,"\\)$")),Le=new RegExp("^rgb\\(".concat(gt,",").concat(gt,",").concat(gt,"\\)$")),Ve=new RegExp("^rgba\\(".concat(wt,",").concat(wt,",").concat(wt,",").concat(Y,"\\)$")),Bt=new RegExp("^rgba\\(".concat(gt,",").concat(gt,",").concat(gt,",").concat(Y,"\\)$")),re=new RegExp("^hsl\\(".concat(Y,",").concat(gt,",").concat(gt,"\\)$")),ye=new RegExp("^hsla\\(".concat(Y,",").concat(gt,",").concat(gt,",").concat(Y,"\\)$")),Yt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};xe(Ot,bt,{copy:function(ge){return Object.assign(new this.constructor,this,ge)},displayable:function(){return this.rgb().displayable()},hex:qe,formatHex:qe,formatHex8:vr,formatHsl:oe,formatRgb:qt,toString:qt});function qe(){return this.rgb().formatHex()}function vr(){return this.rgb().formatHex8()}function oe(){return vt(this).formatHsl()}function qt(){return this.rgb().formatRgb()}function bt(ir){var ge,He;return ir=(ir+"").trim().toLowerCase(),(ge=he.exec(ir))?(He=ge[1].length,ge=parseInt(ge[1],16),He===6?Wt(ge):He===3?new ue(ge>>8&15|ge>>4&240,ge>>4&15|ge&240,(ge&15)<<4|ge&15,1):He===8?$t(ge>>24&255,ge>>16&255,ge>>8&255,(ge&255)/255):He===4?$t(ge>>12&15|ge>>8&240,ge>>8&15|ge>>4&240,ge>>4&15|ge&240,((ge&15)<<4|ge&15)/255):null):(ge=Oe.exec(ir))?new ue(ge[1],ge[2],ge[3],1):(ge=Le.exec(ir))?new ue(ge[1]*255/100,ge[2]*255/100,ge[3]*255/100,1):(ge=Ve.exec(ir))?$t(ge[1],ge[2],ge[3],ge[4]):(ge=Bt.exec(ir))?$t(ge[1]*255/100,ge[2]*255/100,ge[3]*255/100,ge[4]):(ge=re.exec(ir))?tt(ge[1],ge[2]/100,ge[3]/100,1):(ge=ye.exec(ir))?tt(ge[1],ge[2]/100,ge[3]/100,ge[4]):Yt.hasOwnProperty(ir)?Wt(Yt[ir]):ir==="transparent"?new ue(NaN,NaN,NaN,0):null}function Wt(ir){return new ue(ir>>16&255,ir>>8&255,ir&255,1)}function $t(ir,ge,He,Ir){return Ir<=0&&(ir=ge=He=NaN),new ue(ir,ge,He,Ir)}function xt(ir){return ir instanceof Ot||(ir=bt(ir)),ir?(ir=ir.rgb(),new ue(ir.r,ir.g,ir.b,ir.opacity)):new ue}function St(ir,ge,He,Ir){return arguments.length===1?xt(ir):new ue(ir,ge,He,Ir==null?1:Ir)}function ue(ir,ge,He,Ir){this.r=+ir,this.g=+ge,this.b=+He,this.opacity=+Ir}xe(ue,St,Je(Ot,{brighter:function(ge){return ge=ge==null?ft:Math.pow(ft,ge),new ue(this.r*ge,this.g*ge,this.b*ge,this.opacity)},darker:function(ge){return ge=ge==null?te:Math.pow(te,ge),new ue(this.r*ge,this.g*ge,this.b*ge,this.opacity)},rgb:function(){return this},clamp:function(){return new ue(At(this.r),At(this.g),At(this.b),Ct(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Pe,formatHex:Pe,formatHex8:ze,formatRgb:Vt,toString:Vt}));function Pe(){return"#".concat(Nt(this.r)).concat(Nt(this.g)).concat(Nt(this.b))}function ze(){return"#".concat(Nt(this.r)).concat(Nt(this.g)).concat(Nt(this.b)).concat(Nt((isNaN(this.opacity)?1:this.opacity)*255))}function Vt(){var ir=Ct(this.opacity);return"".concat(ir===1?"rgb(":"rgba(").concat(At(this.r),", ").concat(At(this.g),", ").concat(At(this.b)).concat(ir===1?")":", ".concat(ir,")"))}function Ct(ir){return isNaN(ir)?1:Math.max(0,Math.min(1,ir))}function At(ir){return Math.max(0,Math.min(255,Math.round(ir)||0))}function Nt(ir){return ir=At(ir),(ir<16?"0":"")+ir.toString(16)}function tt(ir,ge,He,Ir){return Ir<=0?ir=ge=He=NaN:He<=0||He>=1?ir=ge=NaN:ge<=0&&(ir=NaN),new de(ir,ge,He,Ir)}function vt(ir){if(ir instanceof de)return new de(ir.h,ir.s,ir.l,ir.opacity);if(ir instanceof Ot||(ir=bt(ir)),!ir)return new de;if(ir instanceof de)return ir;ir=ir.rgb();var ge=ir.r/255,He=ir.g/255,Ir=ir.b/255,en=Math.min(ge,He,Ir),On=Math.max(ge,He,Ir),zn=NaN,kn=On-en,qi=(On+en)/2;return kn?(ge===On?zn=(He-Ir)/kn+(He<Ir)*6:He===On?zn=(Ir-ge)/kn+2:zn=(ge-He)/kn+4,kn/=qi<.5?On+en:2-On-en,zn*=60):kn=qi>0&&qi<1?0:zn,new de(zn,kn,qi,ir.opacity)}function Ht(ir,ge,He,Ir){return arguments.length===1?vt(ir):new de(ir,ge,He,Ir==null?1:Ir)}function de(ir,ge,He,Ir){this.h=+ir,this.s=+ge,this.l=+He,this.opacity=+Ir}xe(de,Ht,Je(Ot,{brighter:function(ge){return ge=ge==null?ft:Math.pow(ft,ge),new de(this.h,this.s,this.l*ge,this.opacity)},darker:function(ge){return ge=ge==null?te:Math.pow(te,ge),new de(this.h,this.s,this.l*ge,this.opacity)},rgb:function(){var ge=this.h%360+(this.h<0)*360,He=isNaN(ge)||isNaN(this.s)?0:this.s,Ir=this.l,en=Ir+(Ir<.5?Ir:1-Ir)*He,On=2*Ir-en;return new ue(We(ge>=240?ge-240:ge+120,On,en),We(ge,On,en),We(ge<120?ge+240:ge-120,On,en),this.opacity)},clamp:function(){return new de(jt(this.h),Ie(this.s),Ie(this.l),Ct(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var ge=Ct(this.opacity);return"".concat(ge===1?"hsl(":"hsla(").concat(jt(this.h),", ").concat(Ie(this.s)*100,"%, ").concat(Ie(this.l)*100,"%").concat(ge===1?")":", ".concat(ge,")"))}}));function jt(ir){return ir=(ir||0)%360,ir<0?ir+360:ir}function Ie(ir){return Math.max(0,Math.min(1,ir||0))}function We(ir,ge,He){return(ir<60?ge+(He-ge)*ir/60:ir<180?He:ir<240?ge+(He-ge)*(240-ir)/60:ge)*255}function Ke(ir,ge,He,Ir,en){var On=ir*ir,zn=On*ir;return((1-3*ir+3*On-zn)*ge+(4-6*On+3*zn)*He+(1+3*ir+3*On-3*zn)*Ir+zn*en)/6}function pr(ir){var ge=ir.length-1;return function(He){var Ir=He<=0?He=0:He>=1?(He=1,ge-1):Math.floor(He*ge),en=ir[Ir],On=ir[Ir+1],zn=Ir>0?ir[Ir-1]:2*en-On,kn=Ir<ge-1?ir[Ir+2]:2*On-en;return Ke((He-Ir/ge)*ge,zn,en,On,kn)}}function lr(ir){var ge=ir.length;return function(He){var Ir=Math.floor(((He%=1)<0?++He:He)*ge),en=ir[(Ir+ge-1)%ge],On=ir[Ir%ge],zn=ir[(Ir+1)%ge],kn=ir[(Ir+2)%ge];return Ke((He-Ir/ge)*ge,en,On,zn,kn)}}var Nr=function(ir){return function(){return ir}};function Pr(ir,ge){return function(He){return ir+He*ge}}function Gr(ir,ge,He){return ir=Math.pow(ir,He),ge=Math.pow(ge,He)-ir,He=1/He,function(Ir){return Math.pow(ir+Ir*ge,He)}}function Sn(ir,ge){var He=ge-ir;return He?Pr(ir,He>180||He<-180?He-360*Math.round(He/360):He):constant(isNaN(ir)?ge:ir)}function nn(ir){return(ir=+ir)==1?Nn:function(ge,He){return He-ge?Gr(ge,He,ir):Nr(isNaN(ge)?He:ge)}}function Nn(ir,ge){var He=ge-ir;return He?Pr(ir,He):Nr(isNaN(ir)?ge:ir)}var Zn=function ir(ge){var He=nn(ge);function Ir(en,On){var zn=He((en=St(en)).r,(On=St(On)).r),kn=He(en.g,On.g),qi=He(en.b,On.b),Oa=Nn(en.opacity,On.opacity);return function(us){return en.r=zn(us),en.g=kn(us),en.b=qi(us),en.opacity=Oa(us),en+""}}return Ir.gamma=ir,Ir}(1);function Hn(ir){return function(ge){var He=ge.length,Ir=new Array(He),en=new Array(He),On=new Array(He),zn,kn;for(zn=0;zn<He;++zn)kn=St(ge[zn]),Ir[zn]=kn.r||0,en[zn]=kn.g||0,On[zn]=kn.b||0;return Ir=ir(Ir),en=ir(en),On=ir(On),kn.opacity=1,function(qi){return kn.r=Ir(qi),kn.g=en(qi),kn.b=On(qi),kn+""}}}var An=Hn(pr),$n=Hn(lr);function Rt(ir,ge){ge||(ge=[]);var He=ir?Math.min(ge.length,ir.length):0,Ir=ge.slice(),en;return function(On){for(en=0;en<He;++en)Ir[en]=ir[en]*(1-On)+ge[en]*On;return Ir}}function Xt(ir){return ArrayBuffer.isView(ir)&&!(ir instanceof DataView)}function ae(ir,ge){return(Xt(ge)?Rt:we)(ir,ge)}function we(ir,ge){var He=ge?ge.length:0,Ir=ir?Math.min(He,ir.length):0,en=new Array(Ir),On=new Array(He),zn;for(zn=0;zn<Ir;++zn)en[zn]=an(ir[zn],ge[zn]);for(;zn<He;++zn)On[zn]=ge[zn];return function(kn){for(zn=0;zn<Ir;++zn)On[zn]=en[zn](kn);return On}}function Ge(ir,ge){var He=new Date;return ir=+ir,ge=+ge,function(Ir){return He.setTime(ir*(1-Ir)+ge*Ir),He}}function cr(ir,ge){return ir=+ir,ge=+ge,function(He){return ir*(1-He)+ge*He}}function br(ir,ge){var He={},Ir={},en;(ir===null||ne(ir)!=="object")&&(ir={}),(ge===null||ne(ge)!=="object")&&(ge={});for(en in ge)en in ir?He[en]=an(ir[en],ge[en]):Ir[en]=ge[en];return function(On){for(en in He)Ir[en]=He[en](On);return Ir}}var Ce=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ar=new RegExp(Ce.source,"g");function Hr(ir){return function(){return ir}}function Tn(ir){return function(ge){return ir(ge)+""}}function Kr(ir,ge){var He=Ce.lastIndex=ar.lastIndex=0,Ir,en,On,zn=-1,kn=[],qi=[];for(ir=ir+"",ge=ge+"";(Ir=Ce.exec(ir))&&(en=ar.exec(ge));)(On=en.index)>He&&(On=ge.slice(He,On),kn[zn]?kn[zn]+=On:kn[++zn]=On),(Ir=Ir[0])===(en=en[0])?kn[zn]?kn[zn]+=en:kn[++zn]=en:(kn[++zn]=null,qi.push({i:zn,x:cr(Ir,en)})),He=ar.lastIndex;return He<ge.length&&(On=ge.slice(He),kn[zn]?kn[zn]+=On:kn[++zn]=On),kn.length<2?qi[0]?Tn(qi[0].x):Hr(ge):(ge=qi.length,function(Oa){for(var us=0,Ao;us<ge;++us)kn[(Ao=qi[us]).i]=Ao.x(Oa);return kn.join("")})}function an(ir,ge){var He=ne(ge),Ir;return ge==null||He==="boolean"?Nr(ge):(He==="number"?cr:He==="string"?(Ir=bt(ge))?(ge=Ir,Zn):Kr:ge instanceof bt?Zn:ge instanceof Date?Ge:Xt(ge)?Rt:Array.isArray(ge)?we:typeof ge.valueOf!="function"&&typeof ge.toString!="function"||isNaN(ge)?br:cr)(ir,ge)}var Pn=nt(97338),xi=nt(63007),Ci=function(ir){return["fill","stroke","fillStyle","strokeStyle"].includes(ir)},Qr=function(ir){return/^[r,R,L,l]{1}[\s]*\(/.test(ir)},Kn=[1,0,0,0,1,0,0,0,1];function ai(ir,ge,He){var Ir={},en=ge.fromAttrs,On=ge.toAttrs;if(!ir.destroyed){var zn;for(var kn in On)if(!(0,K.Xy)(en[kn],On[kn]))if(kn==="path"){var qi=On[kn],Oa=en[kn];qi.length>Oa.length?(qi=xi.parsePathString(On[kn]),Oa=xi.parsePathString(en[kn]),Oa=xi.fillPathByDiff(Oa,qi),Oa=xi.formatPath(Oa,qi),ge.fromAttrs.path=Oa,ge.toAttrs.path=qi):ge.pathFormatted||(qi=xi.parsePathString(On[kn]),Oa=xi.parsePathString(en[kn]),Oa=xi.formatPath(Oa,qi),ge.fromAttrs.path=Oa,ge.toAttrs.path=qi,ge.pathFormatted=!0),Ir[kn]=[];for(var us=0;us<qi.length;us++){for(var Ao=qi[us],Ho=Oa[us],uo=[],Zo=0;Zo<Ao.length;Zo++)(0,K.hj)(Ao[Zo])&&Ho&&(0,K.hj)(Ho[Zo])?(zn=an(Ho[Zo],Ao[Zo]),uo.push(zn(He))):uo.push(Ao[Zo]);Ir[kn].push(uo)}}else if(kn==="matrix"){var Qs=ae(en[kn]||Kn,On[kn]||Kn),jo=Qs(He);Ir[kn]=jo}else Ci(kn)&&Qr(On[kn])?Ir[kn]=On[kn]:(0,K.mf)(On[kn])||(zn=an(en[kn],On[kn]),Ir[kn]=zn(He));ir.attr(Ir)}}function fi(ir,ge,He){var Ir=ge.startTime,en=ge.delay;if(He<Ir+en||ge._paused)return!1;var On,zn=ge.duration,kn=ge.easing,qi=(0,Pn._)(kn);if(He=He-Ir-ge.delay,ge.repeat)On=He%zn/zn,On=qi(On);else if(On=He/zn,On<1)On=qi(On);else return ge.onFrame?ir.attr(ge.onFrame(1)):ir.attr(ge.toAttrs),!0;if(ge.onFrame){var Oa=ge.onFrame(On);ir.attr(Oa)}else ai(ir,ge,On);return!1}var oa=function(){function ir(ge){this.animators=[],this.current=0,this.timer=null,this.canvas=ge}return ir.prototype.initTimer=function(){var ge=this,He=!1,Ir,en,On;this.timer=Tt(function(zn){if(ge.current=zn,ge.animators.length>0){for(var kn=ge.animators.length-1;kn>=0;kn--){if(Ir=ge.animators[kn],Ir.destroyed){ge.removeAnimator(kn);continue}if(!Ir.isAnimatePaused()){en=Ir.get("animations");for(var qi=en.length-1;qi>=0;qi--)On=en[qi],He=fi(Ir,On,zn),He&&(en.splice(qi,1),He=!1,On.callback&&On.callback())}en.length===0&&ge.removeAnimator(kn)}var Oa=ge.canvas.get("autoDraw");Oa||ge.canvas.draw()}})},ir.prototype.addAnimator=function(ge){this.animators.push(ge)},ir.prototype.removeAnimator=function(ge){this.animators.splice(ge,1)},ir.prototype.isAnimating=function(){return!!this.animators.length},ir.prototype.stop=function(){this.timer&&this.timer.stop()},ir.prototype.stopAllAnimations=function(ge){ge===void 0&&(ge=!0),this.animators.forEach(function(He){He.stopAnimate(ge)}),this.animators=[],this.canvas.draw()},ir.prototype.getTime=function(){return this.current},ir}(),Ai=oa,Ca=nt(83302),po=40,La=0,Va=":",_a=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function ma(ir,ge){for(var He in ir)if(ir.hasOwnProperty(He)&&He.indexOf(Va+ge)>=0)return!0;return!1}function Qa(ir,ge,He){He.name=ge,He.target=ir,He.currentTarget=ir,He.delegateTarget=ir,ir.emit(ge,He)}function Uo(ir,ge,He){if(He.bubbles){var Ir=void 0,en=!1;if(ge==="mouseenter"?(Ir=He.fromShape,en=!0):ge==="mouseleave"&&(en=!0,Ir=He.toShape),ir.isCanvas()&&en)return;if(Ir&&(0,Et.UY)(ir,Ir)){He.bubbles=!1;return}He.name=ge,He.currentTarget=ir,He.delegateTarget=ir,ir.emit(ge,He)}}var vo=function(){function ir(ge){var He=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(Ir){var en=Ir.type;He._triggerEvent(en,Ir)},this._onDocumentMove=function(Ir){var en=He.canvas,On=en.get("el");if(On!==Ir.target&&(He.dragging||He.currentShape)){var zn=He._getPointInfo(Ir);He.dragging&&He._emitEvent("drag",Ir,zn,He.draggingShape)}},this._onDocumentMouseUp=function(Ir){var en=He.canvas,On=en.get("el");if(On!==Ir.target&&He.dragging){var zn=He._getPointInfo(Ir);He.draggingShape&&He._emitEvent("drop",Ir,zn,null),He._emitEvent("dragend",Ir,zn,He.draggingShape),He._afterDrag(He.draggingShape,zn,Ir)}},this.canvas=ge.canvas}return ir.prototype.init=function(){this._bindEvents()},ir.prototype._bindEvents=function(){var ge=this,He=this.canvas.get("el");(0,Et.S6)(_a,function(Ir){He.addEventListener(Ir,ge._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},ir.prototype._clearEvents=function(){var ge=this,He=this.canvas.get("el");(0,Et.S6)(_a,function(Ir){He.removeEventListener(Ir,ge._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},ir.prototype._getEventObj=function(ge,He,Ir,en,On,zn){var kn=new Ca.Z(ge,He);return kn.fromShape=On,kn.toShape=zn,kn.x=Ir.x,kn.y=Ir.y,kn.clientX=Ir.clientX,kn.clientY=Ir.clientY,kn.propagationPath.push(en),kn},ir.prototype._getShape=function(ge,He){return this.canvas.getShape(ge.x,ge.y,He)},ir.prototype._getPointInfo=function(ge){var He=this.canvas,Ir=He.getClientByEvent(ge),en=He.getPointByEvent(ge);return{x:en.x,y:en.y,clientX:Ir.x,clientY:Ir.y}},ir.prototype._triggerEvent=function(ge,He){var Ir=this._getPointInfo(He),en=this._getShape(Ir,He),On=this["_on"+ge],zn=!1;if(On)On.call(this,Ir,en,He);else{var kn=this.currentShape;ge==="mouseenter"||ge==="dragenter"||ge==="mouseover"?(this._emitEvent(ge,He,Ir,null,null,en),en&&this._emitEvent(ge,He,Ir,en,null,en),ge==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",He,Ir,null)):ge==="mouseleave"||ge==="dragleave"||ge==="mouseout"?(zn=!0,kn&&this._emitEvent(ge,He,Ir,kn,kn,null),this._emitEvent(ge,He,Ir,null,kn,null),ge==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",He,Ir,null)):this._emitEvent(ge,He,Ir,en,null,null)}if(zn||(this.currentShape=en),en&&!en.get("destroyed")){var qi=this.canvas,Oa=qi.get("el");Oa.style.cursor=en.attr("cursor")||qi.get("cursor")}},ir.prototype._onmousedown=function(ge,He,Ir){Ir.button===La&&(this.mousedownShape=He,this.mousedownPoint=ge,this.mousedownTimeStamp=Ir.timeStamp),this._emitEvent("mousedown",Ir,ge,He,null,null)},ir.prototype._emitMouseoverEvents=function(ge,He,Ir,en){var On=this.canvas.get("el");Ir!==en&&(Ir&&(this._emitEvent("mouseout",ge,He,Ir,Ir,en),this._emitEvent("mouseleave",ge,He,Ir,Ir,en),(!en||en.get("destroyed"))&&(On.style.cursor=this.canvas.get("cursor"))),en&&(this._emitEvent("mouseover",ge,He,en,Ir,en),this._emitEvent("mouseenter",ge,He,en,Ir,en)))},ir.prototype._emitDragoverEvents=function(ge,He,Ir,en,On){en?(en!==Ir&&(Ir&&this._emitEvent("dragleave",ge,He,Ir,Ir,en),this._emitEvent("dragenter",ge,He,en,Ir,en)),On||this._emitEvent("dragover",ge,He,en)):Ir&&this._emitEvent("dragleave",ge,He,Ir,Ir,en),On&&this._emitEvent("dragover",ge,He,en)},ir.prototype._afterDrag=function(ge,He,Ir){ge&&(ge.set("capture",!0),this.draggingShape=null),this.dragging=!1;var en=this._getShape(He,Ir);en!==ge&&this._emitMouseoverEvents(Ir,He,ge,en),this.currentShape=en},ir.prototype._onmouseup=function(ge,He,Ir){if(Ir.button===La){var en=this.draggingShape;this.dragging?(en&&this._emitEvent("drop",Ir,ge,He),this._emitEvent("dragend",Ir,ge,en),this._afterDrag(en,ge,Ir)):(this._emitEvent("mouseup",Ir,ge,He),He===this.mousedownShape&&this._emitEvent("click",Ir,ge,He),this.mousedownShape=null,this.mousedownPoint=null)}},ir.prototype._ondragover=function(ge,He,Ir){Ir.preventDefault();var en=this.currentShape;this._emitDragoverEvents(Ir,ge,en,He,!0)},ir.prototype._onmousemove=function(ge,He,Ir){var en=this.canvas,On=this.currentShape,zn=this.draggingShape;if(this.dragging)zn&&this._emitDragoverEvents(Ir,ge,On,He,!1),this._emitEvent("drag",Ir,ge,zn);else{var kn=this.mousedownPoint;if(kn){var qi=this.mousedownShape,Oa=Ir.timeStamp,us=Oa-this.mousedownTimeStamp,Ao=kn.clientX-ge.clientX,Ho=kn.clientY-ge.clientY,uo=Ao*Ao+Ho*Ho;us>120||uo>po?qi&&qi.get("draggable")?(zn=this.mousedownShape,zn.set("capture",!1),this.draggingShape=zn,this.dragging=!0,this._emitEvent("dragstart",Ir,ge,zn),this.mousedownShape=null,this.mousedownPoint=null):!qi&&en.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",Ir,ge,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(Ir,ge,On,He),this._emitEvent("mousemove",Ir,ge,He)):(this._emitMouseoverEvents(Ir,ge,On,He),this._emitEvent("mousemove",Ir,ge,He))}else this._emitMouseoverEvents(Ir,ge,On,He),this._emitEvent("mousemove",Ir,ge,He)}},ir.prototype._emitEvent=function(ge,He,Ir,en,On,zn){var kn=this._getEventObj(ge,He,Ir,en,On,zn);if(en){kn.shape=en,Qa(en,ge,kn);for(var qi=en.getParent();qi;)qi.emitDelegation(ge,kn),kn.propagationStopped||Uo(qi,ge,kn),kn.propagationPath.push(qi),qi=qi.getParent()}else{var Oa=this.canvas;Qa(Oa,ge,kn)}},ir.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},ir}(),Ua=vo,Xa="px",Oo=(0,mt.qY)(),Du=Oo&&Oo.name==="firefox",Yo=function(ir){(0,kt.ZT)(ge,ir);function ge(He){var Ir=ir.call(this,He)||this;return Ir.initContainer(),Ir.initDom(),Ir.initEvents(),Ir.initTimeline(),Ir}return ge.prototype.getDefaultCfg=function(){var He=ir.prototype.getDefaultCfg.call(this);return He.cursor="default",He.supportCSSTransform=!1,He},ge.prototype.initContainer=function(){var He=this.get("container");(0,Et.HD)(He)&&(He=document.getElementById(He),this.set("container",He))},ge.prototype.initDom=function(){var He=this.createDom();this.set("el",He);var Ir=this.get("container");Ir.appendChild(He),this.setDOMSize(this.get("width"),this.get("height"))},ge.prototype.initEvents=function(){var He=new Ua({canvas:this});He.init(),this.set("eventController",He)},ge.prototype.initTimeline=function(){var He=new Ai(this);this.set("timeline",He)},ge.prototype.setDOMSize=function(He,Ir){var en=this.get("el");Et.jU&&(en.style.width=He+Xa,en.style.height=Ir+Xa)},ge.prototype.changeSize=function(He,Ir){this.setDOMSize(He,Ir),this.set("width",He),this.set("height",Ir),this.onCanvasChange("changeSize")},ge.prototype.getRenderer=function(){return this.get("renderer")},ge.prototype.getCursor=function(){return this.get("cursor")},ge.prototype.setCursor=function(He){this.set("cursor",He);var Ir=this.get("el");Et.jU&&Ir&&(Ir.style.cursor=He)},ge.prototype.getPointByEvent=function(He){var Ir=this.get("supportCSSTransform");if(Ir){if(Du&&!(0,Et.kK)(He.layerX)&&He.layerX!==He.offsetX)return{x:He.layerX,y:He.layerY};if(!(0,Et.kK)(He.offsetX))return{x:He.offsetX,y:He.offsetY}}var en=this.getClientByEvent(He),On=en.x,zn=en.y;return this.getPointByClient(On,zn)},ge.prototype.getClientByEvent=function(He){var Ir=He;return He.touches&&(He.type==="touchend"?Ir=He.changedTouches[0]:Ir=He.touches[0]),{x:Ir.clientX,y:Ir.clientY}},ge.prototype.getPointByClient=function(He,Ir){var en=this.get("el"),On=en.getBoundingClientRect();return{x:He-On.left,y:Ir-On.top}},ge.prototype.getClientByPoint=function(He,Ir){var en=this.get("el"),On=en.getBoundingClientRect();return{x:He+On.left,y:Ir+On.top}},ge.prototype.draw=function(){},ge.prototype.removeDom=function(){var He=this.get("el");He.parentNode.removeChild(He)},ge.prototype.clearEvents=function(){var He=this.get("eventController");He.destroy()},ge.prototype.isCanvas=function(){return!0},ge.prototype.getParent=function(){return null},ge.prototype.destroy=function(){var He=this.get("timeline");this.get("destroyed")||(this.clear(),He&&He.stop(),this.clearEvents(),this.removeDom(),ir.prototype.destroy.call(this))},ge}(k.Z),_o=Yo},51030:function(dn,Pt,nt){"use strict";var kt=nt(29268),mt=nt(22374),k=nt(16087),Et=nt(91220),K={},yt="_INDEX";function J(zt,P){if(zt.set("canvas",P),zt.isGroup()){var b=zt.get("children");b.length&&b.forEach(function(W){J(W,P)})}}function pt(zt,P){if(zt.set("timeline",P),zt.isGroup()){var b=zt.get("children");b.length&&b.forEach(function(W){pt(W,P)})}}function et(zt,P){var b=zt.getChildren();return b.indexOf(P)>=0}function be(zt,P,b){b===void 0&&(b=!0),b?P.destroy():(P.set("parent",null),P.set("canvas",null)),(0,Et.As)(zt.getChildren(),P)}function ot(zt){return function(P,b){var W=zt(P,b);return W===0?P[yt]-b[yt]:W}}var ut=function(zt){(0,kt.ZT)(P,zt);function P(){return zt!==null&&zt.apply(this,arguments)||this}return P.prototype.isCanvas=function(){return!1},P.prototype.getBBox=function(){var b=1/0,W=-1/0,le=1/0,Ee=-1/0,ke=[],Tt=[],rt=this.getChildren().filter(function(Se){return Se.get("visible")&&(!Se.isGroup()||Se.isGroup()&&Se.getChildren().length>0)});rt.length>0?((0,Et.S6)(rt,function(Se){var _e=Se.getBBox();ke.push(_e.minX,_e.maxX),Tt.push(_e.minY,_e.maxY)}),b=(0,mt.VV)(ke),W=(0,mt.Fp)(ke),le=(0,mt.VV)(Tt),Ee=(0,mt.Fp)(Tt)):(b=0,W=0,le=0,Ee=0);var Dt={x:b,y:le,minX:b,minY:le,maxX:W,maxY:Ee,width:W-b,height:Ee-le};return Dt},P.prototype.getCanvasBBox=function(){var b=1/0,W=-1/0,le=1/0,Ee=-1/0,ke=[],Tt=[],rt=this.getChildren().filter(function(Se){return Se.get("visible")&&(!Se.isGroup()||Se.isGroup()&&Se.getChildren().length>0)});rt.length>0?((0,Et.S6)(rt,function(Se){var _e=Se.getCanvasBBox();ke.push(_e.minX,_e.maxX),Tt.push(_e.minY,_e.maxY)}),b=(0,mt.VV)(ke),W=(0,mt.Fp)(ke),le=(0,mt.VV)(Tt),Ee=(0,mt.Fp)(Tt)):(b=0,W=0,le=0,Ee=0);var Dt={x:b,y:le,minX:b,minY:le,maxX:W,maxY:Ee,width:W-b,height:Ee-le};return Dt},P.prototype.getDefaultCfg=function(){var b=zt.prototype.getDefaultCfg.call(this);return b.children=[],b},P.prototype.onAttrChange=function(b,W,le){if(zt.prototype.onAttrChange.call(this,b,W,le),b==="matrix"){var Ee=this.getTotalMatrix();this._applyChildrenMarix(Ee)}},P.prototype.applyMatrix=function(b){var W=this.getTotalMatrix();zt.prototype.applyMatrix.call(this,b);var le=this.getTotalMatrix();le!==W&&this._applyChildrenMarix(le)},P.prototype._applyChildrenMarix=function(b){var W=this.getChildren();(0,Et.S6)(W,function(le){le.applyMatrix(b)})},P.prototype.addShape=function(){for(var b=[],W=0;W<arguments.length;W++)b[W]=arguments[W];var le=b[0],Ee=b[1];(0,Et.Kn)(le)?Ee=le:Ee.type=le;var ke=K[Ee.type];ke||(ke=(0,Et.jC)(Ee.type),K[Ee.type]=ke);var Tt=this.getShapeBase(),rt=new Tt[ke](Ee);return this.add(rt),rt},P.prototype.addGroup=function(){for(var b=[],W=0;W<arguments.length;W++)b[W]=arguments[W];var le=b[0],Ee=b[1],ke;if((0,Et.mf)(le))Ee?ke=new le(Ee):ke=new le({parent:this});else{var Tt=le||{},rt=this.getGroupBase();ke=new rt(Tt)}return this.add(ke),ke},P.prototype.getCanvas=function(){var b;return this.isCanvas()?b=this:b=this.get("canvas"),b},P.prototype.getShape=function(b,W,le){if(!(0,Et.pP)(this))return null;var Ee=this.getChildren(),ke;if(this.isCanvas())ke=this._findShape(Ee,b,W,le);else{var Tt=[b,W,1];Tt=this.invertFromMatrix(Tt),this.isClipped(Tt[0],Tt[1])||(ke=this._findShape(Ee,Tt[0],Tt[1],le))}return ke},P.prototype._findShape=function(b,W,le,Ee){for(var ke=null,Tt=b.length-1;Tt>=0;Tt--){var rt=b[Tt];if((0,Et.pP)(rt)&&(rt.isGroup()?ke=rt.getShape(W,le,Ee):rt.isHit(W,le)&&(ke=rt)),ke)break}return ke},P.prototype.add=function(b){var W=this.getCanvas(),le=this.getChildren(),Ee=this.get("timeline"),ke=b.getParent();ke&&be(ke,b,!1),b.set("parent",this),W&&J(b,W),Ee&&pt(b,Ee),le.push(b),b.onCanvasChange("add"),this._applyElementMatrix(b)},P.prototype._applyElementMatrix=function(b){var W=this.getTotalMatrix();W&&b.applyMatrix(W)},P.prototype.getChildren=function(){return this.get("children")},P.prototype.sort=function(){var b=this.getChildren();(0,Et.S6)(b,function(W,le){return W[yt]=le,W}),b.sort(ot(function(W,le){return W.get("zIndex")-le.get("zIndex")})),this.onCanvasChange("sort")},P.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var b=this.getChildren(),W=b.length-1;W>=0;W--)b[W].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},P.prototype.destroy=function(){this.get("destroyed")||(this.clear(),zt.prototype.destroy.call(this))},P.prototype.getFirst=function(){return this.getChildByIndex(0)},P.prototype.getLast=function(){var b=this.getChildren();return this.getChildByIndex(b.length-1)},P.prototype.getChildByIndex=function(b){var W=this.getChildren();return W[b]},P.prototype.getCount=function(){var b=this.getChildren();return b.length},P.prototype.contain=function(b){var W=this.getChildren();return W.indexOf(b)>-1},P.prototype.removeChild=function(b,W){W===void 0&&(W=!0),this.contain(b)&&b.remove(W)},P.prototype.findAll=function(b){var W=[],le=this.getChildren();return(0,Et.S6)(le,function(Ee){b(Ee)&&W.push(Ee),Ee.isGroup()&&(W=W.concat(Ee.findAll(b)))}),W},P.prototype.find=function(b){var W=null,le=this.getChildren();return(0,Et.S6)(le,function(Ee){if(b(Ee)?W=Ee:Ee.isGroup()&&(W=Ee.find(b)),W)return!1}),W},P.prototype.findById=function(b){return this.find(function(W){return W.get("id")===b})},P.prototype.findByClassName=function(b){return this.find(function(W){return W.get("className")===b})},P.prototype.findAllByName=function(b){return this.findAll(function(W){return W.get("name")===b})},P}(k.Z);Pt.Z=ut},16087:function(dn,Pt,nt){"use strict";var kt=nt(29268),mt=nt(22374),k=nt(32071),Et=nt(91220),K=nt(55885),yt=nt(53079),J=k.vs,pt="matrix",et=["zIndex","capture","visible","type"],be=["repeat"],ot=":",ut="*";function zt(Ee){for(var ke=[],Tt=0;Tt<Ee.length;Tt++)(0,mt.kJ)(Ee[Tt])?ke.push([].concat(Ee[Tt])):ke.push(Ee[Tt]);return ke}function P(Ee,ke){var Tt={},rt=ke.attrs;for(var Dt in Ee)Tt[Dt]=rt[Dt];return Tt}function b(Ee,ke){var Tt={},rt=ke.attr();return(0,mt.S6)(Ee,function(Dt,Se){be.indexOf(Se)===-1&&!(0,mt.Xy)(rt[Se],Dt)&&(Tt[Se]=Dt)}),Tt}function W(Ee,ke){if(ke.onFrame)return Ee;var Tt=ke.startTime,rt=ke.delay,Dt=ke.duration,Se=Object.prototype.hasOwnProperty;return(0,mt.S6)(Ee,function(_e){Tt+rt<_e.startTime+_e.delay+_e.duration&&Dt>_e.delay&&(0,mt.S6)(ke.toAttrs,function(ve,ne){Se.call(_e.toAttrs,ne)&&(delete _e.toAttrs[ne],delete _e.fromAttrs[ne])})}),Ee}var le=function(Ee){(0,kt.ZT)(ke,Ee);function ke(Tt){var rt=Ee.call(this,Tt)||this;rt.attrs={};var Dt=rt.getDefaultAttrs();return(0,mt.CD)(Dt,Tt.attrs),rt.attrs=Dt,rt.initAttrs(Dt),rt.initAnimate(),rt}return ke.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},ke.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},ke.prototype.onCanvasChange=function(Tt){},ke.prototype.initAttrs=function(Tt){},ke.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},ke.prototype.isGroup=function(){return!1},ke.prototype.getParent=function(){return this.get("parent")},ke.prototype.getCanvas=function(){return this.get("canvas")},ke.prototype.attr=function(){for(var Tt,rt=[],Dt=0;Dt<arguments.length;Dt++)rt[Dt]=arguments[Dt];var Se=rt[0],_e=rt[1];if(!Se)return this.attrs;if((0,mt.Kn)(Se)){for(var ve in Se)this.setAttr(ve,Se[ve]);return this.afterAttrsChange(Se),this}return rt.length===2?(this.setAttr(Se,_e),this.afterAttrsChange((Tt={},Tt[Se]=_e,Tt)),this):this.attrs[Se]},ke.prototype.isClipped=function(Tt,rt){var Dt=this.getClip();return Dt&&!Dt.isHit(Tt,rt)},ke.prototype.setAttr=function(Tt,rt){var Dt=this.attrs[Tt];Dt!==rt&&(this.attrs[Tt]=rt,this.onAttrChange(Tt,rt,Dt))},ke.prototype.onAttrChange=function(Tt,rt,Dt){Tt==="matrix"&&this.set("totalMatrix",null)},ke.prototype.afterAttrsChange=function(Tt){if(this.cfg.isClipShape){var rt=this.cfg.applyTo;rt&&rt.onCanvasChange("clip")}else this.onCanvasChange("attr")},ke.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},ke.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},ke.prototype.setZIndex=function(Tt){this.set("zIndex",Tt);var rt=this.getParent();return rt&&rt.sort(),this},ke.prototype.toFront=function(){var Tt=this.getParent();if(Tt){var rt=Tt.getChildren(),Dt=this.get("el"),Se=rt.indexOf(this);rt.splice(Se,1),rt.push(this),this.onCanvasChange("zIndex")}},ke.prototype.toBack=function(){var Tt=this.getParent();if(Tt){var rt=Tt.getChildren(),Dt=this.get("el"),Se=rt.indexOf(this);rt.splice(Se,1),rt.unshift(this),this.onCanvasChange("zIndex")}},ke.prototype.remove=function(Tt){Tt===void 0&&(Tt=!0);var rt=this.getParent();rt?((0,Et.As)(rt.getChildren(),this),rt.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),Tt&&this.destroy()},ke.prototype.resetMatrix=function(){this.attr(pt,this.getDefaultMatrix()),this.onCanvasChange("matrix")},ke.prototype.getMatrix=function(){return this.attr(pt)},ke.prototype.setMatrix=function(Tt){this.attr(pt,Tt),this.onCanvasChange("matrix")},ke.prototype.getTotalMatrix=function(){var Tt=this.cfg.totalMatrix;if(!Tt){var rt=this.attr("matrix"),Dt=this.cfg.parentMatrix;Dt&&rt?Tt=(0,K.xq)(Dt,rt):Tt=rt||Dt,this.set("totalMatrix",Tt)}return Tt},ke.prototype.applyMatrix=function(Tt){var rt=this.attr("matrix"),Dt=null;Tt&&rt?Dt=(0,K.xq)(Tt,rt):Dt=rt||Tt,this.set("totalMatrix",Dt),this.set("parentMatrix",Tt)},ke.prototype.getDefaultMatrix=function(){return null},ke.prototype.applyToMatrix=function(Tt){var rt=this.attr("matrix");return rt?(0,K.rG)(rt,Tt):Tt},ke.prototype.invertFromMatrix=function(Tt){var rt=this.attr("matrix");if(rt){var Dt=(0,K.U_)(rt);if(Dt)return(0,K.rG)(Dt,Tt)}return Tt},ke.prototype.setClip=function(Tt){var rt=this.getCanvas(),Dt=null;if(Tt){var Se=this.getShapeBase(),_e=(0,mt.jC)(Tt.type),ve=Se[_e];ve&&(Dt=new ve({type:Tt.type,isClipShape:!0,applyTo:this,attrs:Tt.attrs,canvas:rt}))}return this.set("clipShape",Dt),this.onCanvasChange("clip"),Dt},ke.prototype.getClip=function(){var Tt=this.cfg.clipShape;return Tt||null},ke.prototype.clone=function(){var Tt=this,rt=this.attrs,Dt={};(0,mt.S6)(rt,function(ve,ne){(0,mt.kJ)(rt[ne])?Dt[ne]=zt(rt[ne]):Dt[ne]=rt[ne]});var Se=this.constructor,_e=new Se({attrs:Dt});return(0,mt.S6)(et,function(ve){_e.set(ve,Tt.get(ve))}),_e},ke.prototype.destroy=function(){var Tt=this.destroyed;Tt||(this.attrs={},Ee.prototype.destroy.call(this))},ke.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},ke.prototype.animate=function(){for(var Tt=[],rt=0;rt<arguments.length;rt++)Tt[rt]=arguments[rt];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var Dt=this.get("timeline");Dt||(Dt=this.get("canvas").get("timeline"),this.set("timeline",Dt));var Se=this.get("animations")||[];Dt.timer||Dt.initTimer();var _e=Tt[0],ve=Tt[1],ne=Tt[2],xe=ne===void 0?"easeLinear":ne,Je=Tt[3],Ot=Je===void 0?mt.ZT:Je,te=Tt[4],ft=te===void 0?0:te,wt,Y,gt,he,Oe;(0,mt.mf)(_e)?(wt=_e,_e={}):(0,mt.Kn)(_e)&&_e.onFrame&&(wt=_e.onFrame,Y=_e.repeat),(0,mt.Kn)(ve)?(Oe=ve,ve=Oe.duration,xe=Oe.easing||"easeLinear",ft=Oe.delay||0,Y=Oe.repeat||Y||!1,Ot=Oe.callback||mt.ZT,gt=Oe.pauseCallback||mt.ZT,he=Oe.resumeCallback||mt.ZT):((0,mt.hj)(Ot)&&(ft=Ot,Ot=null),(0,mt.mf)(xe)?(Ot=xe,xe="easeLinear"):xe=xe||"easeLinear");var Le=b(_e,this),Ve={fromAttrs:P(Le,this),toAttrs:Le,duration:ve,easing:xe,repeat:Y,callback:Ot,pauseCallback:gt,resumeCallback:he,delay:ft,startTime:Dt.getTime(),id:(0,mt.EL)(),onFrame:wt,pathFormatted:!1};Se.length>0?Se=W(Se,Ve):Dt.addAnimator(this),Se.push(Ve),this.set("animations",Se),this.set("_pause",{isPaused:!1})}},ke.prototype.stopAnimate=function(Tt){var rt=this;Tt===void 0&&(Tt=!0);var Dt=this.get("animations");(0,mt.S6)(Dt,function(Se){Tt&&(Se.onFrame?rt.attr(Se.onFrame(1)):rt.attr(Se.toAttrs)),Se.callback&&Se.callback()}),this.set("animating",!1),this.set("animations",[])},ke.prototype.pauseAnimate=function(){var Tt=this.get("timeline"),rt=this.get("animations"),Dt=Tt.getTime();return(0,mt.S6)(rt,function(Se){Se._paused=!0,Se._pauseTime=Dt,Se.pauseCallback&&Se.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:Dt}),this},ke.prototype.resumeAnimate=function(){var Tt=this.get("timeline"),rt=Tt.getTime(),Dt=this.get("animations"),Se=this.get("_pause").pauseTime;return(0,mt.S6)(Dt,function(_e){_e.startTime=_e.startTime+(rt-Se),_e._paused=!1,_e._pauseTime=null,_e.resumeCallback&&_e.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",Dt),this},ke.prototype.emitDelegation=function(Tt,rt){var Dt=this,Se=rt.propagationPath,_e=this.getEvents(),ve;Tt==="mouseenter"?ve=rt.fromShape:Tt==="mouseleave"&&(ve=rt.toShape);for(var ne=function(te){var ft=Se[te],wt=ft.get("name");if(wt){if((ft.isGroup()||ft.isCanvas&&ft.isCanvas())&&ve&&(0,Et.UY)(ft,ve))return"break";(0,mt.kJ)(wt)?(0,mt.S6)(wt,function(Y){Dt.emitDelegateEvent(ft,Y,rt)}):xe.emitDelegateEvent(ft,wt,rt)}},xe=this,Je=0;Je<Se.length;Je++){var Ot=ne(Je);if(Ot==="break")break}},ke.prototype.emitDelegateEvent=function(Tt,rt,Dt){var Se=this.getEvents(),_e=rt+ot+Dt.type;(Se[_e]||Se[ut])&&(Dt.name=_e,Dt.currentTarget=Tt,Dt.delegateTarget=this,Dt.delegateObject=Tt.get("delegateObject"),this.emit(_e,Dt))},ke.prototype.translate=function(Tt,rt){Tt===void 0&&(Tt=0),rt===void 0&&(rt=0);var Dt=this.getMatrix(),Se=J(Dt,[["t",Tt,rt]]);return this.setMatrix(Se),this},ke.prototype.move=function(Tt,rt){var Dt=this.attr("x")||0,Se=this.attr("y")||0;return this.translate(Tt-Dt,rt-Se),this},ke.prototype.moveTo=function(Tt,rt){return this.move(Tt,rt)},ke.prototype.scale=function(Tt,rt){var Dt=this.getMatrix(),Se=J(Dt,[["s",Tt,rt||Tt]]);return this.setMatrix(Se),this},ke.prototype.rotate=function(Tt){var rt=this.getMatrix(),Dt=J(rt,[["r",Tt]]);return this.setMatrix(Dt),this},ke.prototype.rotateAtStart=function(Tt){var rt=this.attr(),Dt=rt.x,Se=rt.y,_e=this.getMatrix(),ve=J(_e,[["t",-Dt,-Se],["r",Tt],["t",Dt,Se]]);return this.setMatrix(ve),this},ke.prototype.rotateAtPoint=function(Tt,rt,Dt){var Se=this.getMatrix(),_e=J(Se,[["t",-Tt,-rt],["r",Dt],["t",Tt,rt]]);return this.setMatrix(_e),this},ke}(yt.Z);Pt.Z=le},14629:function(dn,Pt,nt){"use strict";var kt=nt(29268),mt=nt(51030),k=function(Et){(0,kt.ZT)(K,Et);function K(){return Et!==null&&Et.apply(this,arguments)||this}return K.prototype.isGroup=function(){return!0},K.prototype.isEntityGroup=function(){return!1},K.prototype.clone=function(){for(var yt=Et.prototype.clone.call(this),J=this.getChildren(),pt=0;pt<J.length;pt++){var et=J[pt];yt.add(et.clone())}return yt},K}(mt.Z);Pt.Z=k},40073:function(dn,Pt,nt){"use strict";var kt=nt(29268),mt=nt(16087),k=nt(55885),Et=function(K){(0,kt.ZT)(yt,K);function yt(J){return K.call(this,J)||this}return yt.prototype._isInBBox=function(J,pt){var et=this.getBBox();return et.minX<=J&&et.maxX>=J&&et.minY<=pt&&et.maxY>=pt},yt.prototype.afterAttrsChange=function(J){K.prototype.afterAttrsChange.call(this,J),this.clearCacheBBox()},yt.prototype.getBBox=function(){var J=this.cfg.bbox;return J||(J=this.calculateBBox(),this.set("bbox",J)),J},yt.prototype.getCanvasBBox=function(){var J=this.cfg.canvasBBox;return J||(J=this.calculateCanvasBBox(),this.set("canvasBBox",J)),J},yt.prototype.applyMatrix=function(J){K.prototype.applyMatrix.call(this,J),this.set("canvasBBox",null)},yt.prototype.calculateCanvasBBox=function(){var J=this.getBBox(),pt=this.getTotalMatrix(),et=J.minX,be=J.minY,ot=J.maxX,ut=J.maxY;if(pt){var zt=(0,k.rG)(pt,[J.minX,J.minY]),P=(0,k.rG)(pt,[J.maxX,J.minY]),b=(0,k.rG)(pt,[J.minX,J.maxY]),W=(0,k.rG)(pt,[J.maxX,J.maxY]);et=Math.min(zt[0],P[0],b[0],W[0]),ot=Math.max(zt[0],P[0],b[0],W[0]),be=Math.min(zt[1],P[1],b[1],W[1]),ut=Math.max(zt[1],P[1],b[1],W[1])}var le=this.attrs;if(le.shadowColor){var Ee=le.shadowBlur,ke=Ee===void 0?0:Ee,Tt=le.shadowOffsetX,rt=Tt===void 0?0:Tt,Dt=le.shadowOffsetY,Se=Dt===void 0?0:Dt,_e=et-ke+rt,ve=ot+ke+rt,ne=be-ke+Se,xe=ut+ke+Se;et=Math.min(et,_e),ot=Math.max(ot,ve),be=Math.min(be,ne),ut=Math.max(ut,xe)}return{x:et,y:be,minX:et,minY:be,maxX:ot,maxY:ut,width:ot-et,height:ut-be}},yt.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},yt.prototype.isClipShape=function(){return this.get("isClipShape")},yt.prototype.isInShape=function(J,pt){return!1},yt.prototype.isOnlyHitBox=function(){return!1},yt.prototype.isHit=function(J,pt){var et=this.get("startArrowShape"),be=this.get("endArrowShape"),ot=[J,pt,1];ot=this.invertFromMatrix(ot);var ut=ot[0],zt=ot[1],P=this._isInBBox(ut,zt);return this.isOnlyHitBox()?P:!!(P&&!this.isClipped(ut,zt)&&(this.isInShape(ut,zt)||et&&et.isHit(ut,zt)||be&&be.isHit(ut,zt)))},yt}(mt.Z);Pt.Z=Et},97338:function(dn,Pt,nt){"use strict";nt.d(Pt,{_:function(){return $t},C:function(){return xt}});var kt={};nt.r(kt),nt.d(kt,{easeBack:function(){return ye},easeBackIn:function(){return Bt},easeBackInOut:function(){return ye},easeBackOut:function(){return re},easeBounce:function(){return Oe},easeBounceIn:function(){return he},easeBounceInOut:function(){return Le},easeBounceOut:function(){return Oe},easeCircle:function(){return _e},easeCircleIn:function(){return Dt},easeCircleInOut:function(){return _e},easeCircleOut:function(){return Se},easeCubic:function(){return pt},easeCubicIn:function(){return yt},easeCubicInOut:function(){return pt},easeCubicOut:function(){return J},easeElastic:function(){return qt},easeElasticIn:function(){return oe},easeElasticInOut:function(){return bt},easeElasticOut:function(){return qt},easeExp:function(){return rt},easeExpIn:function(){return ke},easeExpInOut:function(){return rt},easeExpOut:function(){return Tt},easeLinear:function(){return mt},easePoly:function(){return ut},easePolyIn:function(){return be},easePolyInOut:function(){return ut},easePolyOut:function(){return ot},easeQuad:function(){return K},easeQuadIn:function(){return k},easeQuadInOut:function(){return K},easeQuadOut:function(){return Et},easeSin:function(){return le},easeSinIn:function(){return b},easeSinInOut:function(){return le},easeSinOut:function(){return W}});function mt(St){return+St}function k(St){return St*St}function Et(St){return St*(2-St)}function K(St){return((St*=2)<=1?St*St:--St*(2-St)+1)/2}function yt(St){return St*St*St}function J(St){return--St*St*St+1}function pt(St){return((St*=2)<=1?St*St*St:(St-=2)*St*St+2)/2}var et=3,be=function St(ue){ue=+ue;function Pe(ze){return Math.pow(ze,ue)}return Pe.exponent=St,Pe}(et),ot=function St(ue){ue=+ue;function Pe(ze){return 1-Math.pow(1-ze,ue)}return Pe.exponent=St,Pe}(et),ut=function St(ue){ue=+ue;function Pe(ze){return((ze*=2)<=1?Math.pow(ze,ue):2-Math.pow(2-ze,ue))/2}return Pe.exponent=St,Pe}(et),zt=Math.PI,P=zt/2;function b(St){return+St==1?1:1-Math.cos(St*P)}function W(St){return Math.sin(St*P)}function le(St){return(1-Math.cos(zt*St))/2}function Ee(St){return(Math.pow(2,-10*St)-.0009765625)*1.0009775171065494}function ke(St){return Ee(1-+St)}function Tt(St){return 1-Ee(St)}function rt(St){return((St*=2)<=1?Ee(1-St):2-Ee(St-1))/2}function Dt(St){return 1-Math.sqrt(1-St*St)}function Se(St){return Math.sqrt(1- --St*St)}function _e(St){return((St*=2)<=1?1-Math.sqrt(1-St*St):Math.sqrt(1-(St-=2)*St)+1)/2}var ve=4/11,ne=6/11,xe=8/11,Je=3/4,Ot=9/11,te=10/11,ft=15/16,wt=21/22,Y=63/64,gt=1/ve/ve;function he(St){return 1-Oe(1-St)}function Oe(St){return(St=+St)<ve?gt*St*St:St<xe?gt*(St-=ne)*St+Je:St<te?gt*(St-=Ot)*St+ft:gt*(St-=wt)*St+Y}function Le(St){return((St*=2)<=1?1-Oe(1-St):Oe(St-1)+1)/2}var Ve=1.70158,Bt=function St(ue){ue=+ue;function Pe(ze){return(ze=+ze)*ze*(ue*(ze-1)+ze)}return Pe.overshoot=St,Pe}(Ve),re=function St(ue){ue=+ue;function Pe(ze){return--ze*ze*((ze+1)*ue+ze)+1}return Pe.overshoot=St,Pe}(Ve),ye=function St(ue){ue=+ue;function Pe(ze){return((ze*=2)<1?ze*ze*((ue+1)*ze-ue):(ze-=2)*ze*((ue+1)*ze+ue)+2)/2}return Pe.overshoot=St,Pe}(Ve),Yt=2*Math.PI,qe=1,vr=.3,oe=function St(ue,Pe){var ze=Math.asin(1/(ue=Math.max(1,ue)))*(Pe/=Yt);function Vt(Ct){return ue*Ee(- --Ct)*Math.sin((ze-Ct)/Pe)}return Vt.amplitude=function(Ct){return St(Ct,Pe*Yt)},Vt.period=function(Ct){return St(ue,Ct)},Vt}(qe,vr),qt=function St(ue,Pe){var ze=Math.asin(1/(ue=Math.max(1,ue)))*(Pe/=Yt);function Vt(Ct){return 1-ue*Ee(Ct=+Ct)*Math.sin((Ct+ze)/Pe)}return Vt.amplitude=function(Ct){return St(Ct,Pe*Yt)},Vt.period=function(Ct){return St(ue,Ct)},Vt}(qe,vr),bt=function St(ue,Pe){var ze=Math.asin(1/(ue=Math.max(1,ue)))*(Pe/=Yt);function Vt(Ct){return((Ct=Ct*2-1)<0?ue*Ee(-Ct)*Math.sin((ze-Ct)/Pe):2-ue*Ee(Ct)*Math.sin((ze+Ct)/Pe))/2}return Vt.amplitude=function(Ct){return St(Ct,Pe*Yt)},Vt.period=function(Ct){return St(ue,Ct)},Vt}(qe,vr),Wt={};function $t(St){return Wt[St.toLowerCase()]||kt[St]}function xt(St,ue){Wt[St.toLowerCase()]=ue}},71626:function(dn,Pt,nt){"use strict";nt.d(Pt,{b:function(){return k},W:function(){return mt}});var kt=new Map;function mt(Tt,rt){kt.set(Tt,rt)}function k(Tt){return kt.get(Tt)}function Et(Tt){var rt=Tt.attr(),Dt=rt.x,Se=rt.y,_e=rt.width,ve=rt.height;return{x:Dt,y:Se,width:_e,height:ve}}function K(Tt){var rt=Tt.attr(),Dt=rt.x,Se=rt.y,_e=rt.r;return{x:Dt-_e,y:Se-_e,width:_e*2,height:_e*2}}var yt=nt(62930);function J(Tt,rt){return!Tt||!rt?Tt||rt:{minX:Math.min(Tt.minX,rt.minX),minY:Math.min(Tt.minY,rt.minY),maxX:Math.max(Tt.maxX,rt.maxX),maxY:Math.max(Tt.maxY,rt.maxY)}}function pt(Tt,rt){var Dt=Tt.get("startArrowShape"),Se=Tt.get("endArrowShape"),_e=null,ve=null;return Dt&&(_e=Dt.getCanvasBBox(),rt=J(rt,_e)),Se&&(ve=Se.getCanvasBBox(),rt=J(rt,ve)),rt}function et(Tt){for(var rt=Tt.attr(),Dt=rt.points,Se=[],_e=[],ve=0;ve<Dt.length;ve++){var ne=Dt[ve];Se.push(ne[0]),_e.push(ne[1])}var xe=yt.Zr.getBBoxByArray(Se,_e),Je=xe.x,Ot=xe.y,te=xe.width,ft=xe.height,wt={minX:Je,minY:Ot,maxX:Je+te,maxY:Ot+ft};return wt=pt(Tt,wt),{x:wt.minX,y:wt.minY,width:wt.maxX-wt.minX,height:wt.maxY-wt.minY}}function be(Tt){for(var rt=Tt.attr(),Dt=rt.points,Se=[],_e=[],ve=0;ve<Dt.length;ve++){var ne=Dt[ve];Se.push(ne[0]),_e.push(ne[1])}return yt.Zr.getBBoxByArray(Se,_e)}var ot=nt(56430);function ut(Tt){var rt=Tt.attr(),Dt=rt.x,Se=rt.y,_e=rt.text,ve=rt.fontSize,ne=rt.lineHeight,xe=rt.font;xe||(xe=(0,ot.$O)(rt));var Je=(0,ot.mY)(_e,xe),Ot;if(!Je)Ot={x:Dt,y:Se,width:0,height:0};else{var te=rt.textAlign,ft=rt.textBaseline,wt=(0,ot.FE)(_e,ve,ne),Y={x:Dt,y:Se-wt};te&&(te==="end"||te==="right"?Y.x-=Je:te==="center"&&(Y.x-=Je/2)),ft&&(ft==="top"?Y.y+=wt:ft==="middle"&&(Y.y+=wt/2)),Ot={x:Y.x,y:Y.y,width:Je,height:wt}}return Ot}var zt=nt(34357),P=nt(22374);function b(Tt,rt){for(var Dt=[],Se=[],_e=[],ve=0;ve<Tt.length;ve++){var ne=Tt[ve],xe=ne.currentPoint,Je=ne.params,Ot=ne.prePoint,te=void 0;switch(ne.command){case"Q":te=yt.lD.box(Ot[0],Ot[1],Je[1],Je[2],Je[3],Je[4]);break;case"C":te=yt.Ll.box(Ot[0],Ot[1],Je[1],Je[2],Je[3],Je[4],Je[5],Je[6]);break;case"A":var ft=ne.arcParams;te=yt.wN.box(ft.cx,ft.cy,ft.rx,ft.ry,ft.xRotation,ft.startAngle,ft.endAngle);break;default:Dt.push(xe[0]),Se.push(xe[1]);break}te&&(ne.box=te,Dt.push(te.x,te.x+te.width),Se.push(te.y,te.y+te.height)),rt&&(ne.command==="L"||ne.command==="M")&&ne.prePoint&&ne.nextPoint&&_e.push(ne)}Dt=Dt.filter(function(Le){return!Number.isNaN(Le)&&Le!==1/0&&Le!==-1/0}),Se=Se.filter(function(Le){return!Number.isNaN(Le)&&Le!==1/0&&Le!==-1/0});var wt=(0,P.VV)(Dt),Y=(0,P.VV)(Se),gt=(0,P.Fp)(Dt),he=(0,P.Fp)(Se);if(_e.length===0)return{x:wt,y:Y,width:gt-wt,height:he-Y};for(var ve=0;ve<_e.length;ve++){var ne=_e[ve],xe=ne.currentPoint,Oe=void 0;xe[0]===wt?(Oe=W(ne,rt),wt=wt-Oe.xExtra):xe[0]===gt&&(Oe=W(ne,rt),gt=gt+Oe.xExtra),xe[1]===Y?(Oe=W(ne,rt),Y=Y-Oe.yExtra):xe[1]===he&&(Oe=W(ne,rt),he=he+Oe.yExtra)}return{x:wt,y:Y,width:gt-wt,height:he-Y}}function W(Tt,rt){var Dt=Tt.prePoint,Se=Tt.currentPoint,_e=Tt.nextPoint,ve=Math.pow(Se[0]-Dt[0],2)+Math.pow(Se[1]-Dt[1],2),ne=Math.pow(Se[0]-_e[0],2)+Math.pow(Se[1]-_e[1],2),xe=Math.pow(Dt[0]-_e[0],2)+Math.pow(Dt[1]-_e[1],2),Je=Math.acos((ve+ne-xe)/(2*Math.sqrt(ve)*Math.sqrt(ne)));if(!Je||Math.sin(Je)===0||(0,P.vQ)(Je,0))return{xExtra:0,yExtra:0};var Ot=Math.abs(Math.atan2(_e[1]-Se[1],_e[0]-Se[0])),te=Math.abs(Math.atan2(_e[0]-Se[0],_e[1]-Se[1]));Ot=Ot>Math.PI/2?Math.PI-Ot:Ot,te=te>Math.PI/2?Math.PI-te:te;var ft={xExtra:Math.cos(Je/2-Ot)*(rt/2*(1/Math.sin(Je/2)))-rt/2||0,yExtra:Math.cos(te-Je/2)*(rt/2*(1/Math.sin(Je/2)))-rt/2||0};return ft}function le(Tt){var rt=Tt.attr(),Dt=rt.path,Se=rt.stroke,_e=Se?rt.lineWidth:0,ve=Tt.get("segments")||(0,zt.zx)(Dt),ne=b(ve,_e),xe=ne.x,Je=ne.y,Ot=ne.width,te=ne.height,ft={minX:xe,minY:Je,maxX:xe+Ot,maxY:Je+te};return ft=pt(Tt,ft),{x:ft.minX,y:ft.minY,width:ft.maxX-ft.minX,height:ft.maxY-ft.minY}}function Ee(Tt){var rt=Tt.attr(),Dt=rt.x1,Se=rt.y1,_e=rt.x2,ve=rt.y2,ne=Math.min(Dt,_e),xe=Math.max(Dt,_e),Je=Math.min(Se,ve),Ot=Math.max(Se,ve),te={minX:ne,maxX:xe,minY:Je,maxY:Ot};return te=pt(Tt,te),{x:te.minX,y:te.minY,width:te.maxX-te.minX,height:te.maxY-te.minY}}function ke(Tt){var rt=Tt.attr(),Dt=rt.x,Se=rt.y,_e=rt.rx,ve=rt.ry;return{x:Dt-_e,y:Se-ve,width:_e*2,height:ve*2}}mt("rect",Et),mt("image",Et),mt("circle",K),mt("marker",K),mt("polyline",et),mt("polygon",be),mt("text",ut),mt("path",le),mt("line",Ee),mt("ellipse",ke)},83302:function(dn,Pt){"use strict";var nt=function(){function kt(mt,k){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=mt,this.name=mt,this.originalEvent=k,this.timeStamp=k.timeStamp}return kt.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},kt.prototype.stopPropagation=function(){this.propagationStopped=!0},kt.prototype.toString=function(){var mt=this.type;return"[Event (type="+mt+")]"},kt.prototype.save=function(){},kt.prototype.restore=function(){},kt}();Pt.Z=nt},22479:function(dn,Pt,nt){"use strict";nt.r(Pt),nt.d(Pt,{AbstractCanvas:function(){return be.Z},AbstractGroup:function(){return ot.Z},AbstractShape:function(){return ut.Z},Base:function(){return et.Z},Event:function(){return pt.Z},PathUtil:function(){return kt},assembleFont:function(){return P.$O},getBBoxMethod:function(){return zt.b},getOffScreenContext:function(){return le.L},getTextHeight:function(){return P.FE},invert:function(){return W.U_},isAllowCapture:function(){return b.pP},multiplyVec2:function(){return W.rG},registerBBox:function(){return zt.W},registerEasing:function(){return Ee.C},version:function(){return ke}});var kt=nt(63007),mt=nt(54153),k=nt.n(mt),J={};for(var Et in mt)["default","Event","Base","AbstractCanvas","AbstractGroup","AbstractShape","PathUtil","getBBoxMethod","registerBBox","getTextHeight","assembleFont","isAllowCapture","multiplyVec2","invert","getOffScreenContext","registerEasing","version"].indexOf(Et)<0&&(J[Et]=function(Tt){return mt[Tt]}.bind(0,Et));nt.d(Pt,J);var K=nt(97750),yt=nt.n(K),J={};for(var Et in K)["default","Event","Base","AbstractCanvas","AbstractGroup","AbstractShape","PathUtil","getBBoxMethod","registerBBox","getTextHeight","assembleFont","isAllowCapture","multiplyVec2","invert","getOffScreenContext","registerEasing","version"].indexOf(Et)<0&&(J[Et]=function(rt){return K[rt]}.bind(0,Et));nt.d(Pt,J);var pt=nt(83302),et=nt(53079),be=nt(81577),ot=nt(14629),ut=nt(40073),zt=nt(71626),P=nt(56430),b=nt(91220),W=nt(55885),le=nt(69307),Ee=nt(97338),ke="0.5.11"},97750:function(){},54153:function(){},55885:function(dn,Pt,nt){"use strict";nt.d(Pt,{U_:function(){return k},rG:function(){return mt},xq:function(){return kt}});function kt(Et,K){var yt=[],J=Et[0],pt=Et[1],et=Et[2],be=Et[3],ot=Et[4],ut=Et[5],zt=Et[6],P=Et[7],b=Et[8],W=K[0],le=K[1],Ee=K[2],ke=K[3],Tt=K[4],rt=K[5],Dt=K[6],Se=K[7],_e=K[8];return yt[0]=W*J+le*be+Ee*zt,yt[1]=W*pt+le*ot+Ee*P,yt[2]=W*et+le*ut+Ee*b,yt[3]=ke*J+Tt*be+rt*zt,yt[4]=ke*pt+Tt*ot+rt*P,yt[5]=ke*et+Tt*ut+rt*b,yt[6]=Dt*J+Se*be+_e*zt,yt[7]=Dt*pt+Se*ot+_e*P,yt[8]=Dt*et+Se*ut+_e*b,yt}function mt(Et,K){var yt=[],J=K[0],pt=K[1];return yt[0]=Et[0]*J+Et[3]*pt+Et[6],yt[1]=Et[1]*J+Et[4]*pt+Et[7],yt}function k(Et){var K=[],yt=Et[0],J=Et[1],pt=Et[2],et=Et[3],be=Et[4],ot=Et[5],ut=Et[6],zt=Et[7],P=Et[8],b=P*be-ot*zt,W=-P*et+ot*ut,le=zt*et-be*ut,Ee=yt*b+J*W+pt*le;return Ee?(Ee=1/Ee,K[0]=b*Ee,K[1]=(-P*J+pt*zt)*Ee,K[2]=(ot*J-pt*be)*Ee,K[3]=W*Ee,K[4]=(P*yt-pt*ut)*Ee,K[5]=(-ot*yt+pt*et)*Ee,K[6]=le*Ee,K[7]=(-zt*yt+J*ut)*Ee,K[8]=(be*yt-J*et)*Ee,K):null}},69307:function(dn,Pt,nt){"use strict";nt.d(Pt,{L:function(){return mt}});var kt=null;function mt(){if(!kt){var k=document.createElement("canvas");k.width=1,k.height=1,kt=k.getContext("2d")}return kt}},63007:function(dn,Pt,nt){"use strict";nt.r(Pt),nt.d(Pt,{catmullRomToBezier:function(){return yt},fillPath:function(){return ft},fillPathByDiff:function(){return he},formatPath:function(){return Ve},intersection:function(){return xe},parsePathArray:function(){return P},parsePathString:function(){return K},pathToAbsolute:function(){return pt},pathToCurve:function(){return ut},rectPath:function(){return Tt}});var kt=nt(22374),mt=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,k=new RegExp("([a-z])["+mt+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+mt+"]*,?["+mt+"]*)+)","ig"),Et=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+mt+"]*,?["+mt+"]*","ig"),K=function(Bt){if(!Bt)return null;if((0,kt.kJ)(Bt))return Bt;var re={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},ye=[];return String(Bt).replace(k,function(Yt,qe,vr){var oe=[],qt=qe.toLowerCase();if(vr.replace(Et,function(bt,Wt){Wt&&oe.push(+Wt)}),qt==="m"&&oe.length>2&&(ye.push([qe].concat(oe.splice(0,2))),qt="l",qe=qe==="m"?"l":"L"),qt==="o"&&oe.length===1&&ye.push([qe,oe[0]]),qt==="r")ye.push([qe].concat(oe));else for(;oe.length>=re[qt]&&(ye.push([qe].concat(oe.splice(0,re[qt]))),!!re[qt]););return Bt}),ye},yt=function(Bt,re){for(var ye=[],Yt=0,qe=Bt.length;qe-2*!re>Yt;Yt+=2){var vr=[{x:+Bt[Yt-2],y:+Bt[Yt-1]},{x:+Bt[Yt],y:+Bt[Yt+1]},{x:+Bt[Yt+2],y:+Bt[Yt+3]},{x:+Bt[Yt+4],y:+Bt[Yt+5]}];re?Yt?qe-4===Yt?vr[3]={x:+Bt[0],y:+Bt[1]}:qe-2===Yt&&(vr[2]={x:+Bt[0],y:+Bt[1]},vr[3]={x:+Bt[2],y:+Bt[3]}):vr[0]={x:+Bt[qe-2],y:+Bt[qe-1]}:qe-4===Yt?vr[3]=vr[2]:Yt||(vr[0]={x:+Bt[Yt],y:+Bt[Yt+1]}),ye.push(["C",(-vr[0].x+6*vr[1].x+vr[2].x)/6,(-vr[0].y+6*vr[1].y+vr[2].y)/6,(vr[1].x+6*vr[2].x-vr[3].x)/6,(vr[1].y+6*vr[2].y-vr[3].y)/6,vr[2].x,vr[2].y])}return ye},J=function(Bt,re,ye,Yt,qe){var vr=[];if(qe===null&&Yt===null&&(Yt=ye),Bt=+Bt,re=+re,ye=+ye,Yt=+Yt,qe!==null){var oe=Math.PI/180,qt=Bt+ye*Math.cos(-Yt*oe),bt=Bt+ye*Math.cos(-qe*oe),Wt=re+ye*Math.sin(-Yt*oe),$t=re+ye*Math.sin(-qe*oe);vr=[["M",qt,Wt],["A",ye,ye,0,+(qe-Yt>180),0,bt,$t]]}else vr=[["M",Bt,re],["m",0,-Yt],["a",ye,Yt,0,1,1,0,2*Yt],["a",ye,Yt,0,1,1,0,-2*Yt],["z"]];return vr},pt=function(Bt){if(Bt=K(Bt),!Bt||!Bt.length)return[["M",0,0]];var re=[],ye=0,Yt=0,qe=0,vr=0,oe=0,qt,bt;Bt[0][0]==="M"&&(ye=+Bt[0][1],Yt=+Bt[0][2],qe=ye,vr=Yt,oe++,re[0]=["M",ye,Yt]);for(var Wt=Bt.length===3&&Bt[0][0]==="M"&&Bt[1][0].toUpperCase()==="R"&&Bt[2][0].toUpperCase()==="Z",$t=void 0,xt=void 0,St=oe,ue=Bt.length;St<ue;St++){if(re.push($t=[]),xt=Bt[St],qt=xt[0],qt!==qt.toUpperCase())switch($t[0]=qt.toUpperCase(),$t[0]){case"A":$t[1]=xt[1],$t[2]=xt[2],$t[3]=xt[3],$t[4]=xt[4],$t[5]=xt[5],$t[6]=+xt[6]+ye,$t[7]=+xt[7]+Yt;break;case"V":$t[1]=+xt[1]+Yt;break;case"H":$t[1]=+xt[1]+ye;break;case"R":bt=[ye,Yt].concat(xt.slice(1));for(var Pe=2,ze=bt.length;Pe<ze;Pe++)bt[Pe]=+bt[Pe]+ye,bt[++Pe]=+bt[Pe]+Yt;re.pop(),re=re.concat(yt(bt,Wt));break;case"O":re.pop(),bt=J(ye,Yt,xt[1],xt[2]),bt.push(bt[0]),re=re.concat(bt);break;case"U":re.pop(),re=re.concat(J(ye,Yt,xt[1],xt[2],xt[3])),$t=["U"].concat(re[re.length-1].slice(-2));break;case"M":qe=+xt[1]+ye,vr=+xt[2]+Yt;break;default:for(var Pe=1,ze=xt.length;Pe<ze;Pe++)$t[Pe]=+xt[Pe]+(Pe%2?ye:Yt)}else if(qt==="R")bt=[ye,Yt].concat(xt.slice(1)),re.pop(),re=re.concat(yt(bt,Wt)),$t=["R"].concat(xt.slice(-2));else if(qt==="O")re.pop(),bt=J(ye,Yt,xt[1],xt[2]),bt.push(bt[0]),re=re.concat(bt);else if(qt==="U")re.pop(),re=re.concat(J(ye,Yt,xt[1],xt[2],xt[3])),$t=["U"].concat(re[re.length-1].slice(-2));else for(var Vt=0,Ct=xt.length;Vt<Ct;Vt++)$t[Vt]=xt[Vt];if(qt=qt.toUpperCase(),qt!=="O")switch($t[0]){case"Z":ye=+qe,Yt=+vr;break;case"H":ye=$t[1];break;case"V":Yt=$t[1];break;case"M":qe=$t[$t.length-2],vr=$t[$t.length-1];break;default:ye=$t[$t.length-2],Yt=$t[$t.length-1]}}return re},et=function(Bt,re,ye,Yt){return[Bt,re,ye,Yt,ye,Yt]},be=function(Bt,re,ye,Yt,qe,vr){var oe=.3333333333333333,qt=2/3;return[oe*Bt+qt*ye,oe*re+qt*Yt,oe*qe+qt*ye,oe*vr+qt*Yt,qe,vr]},ot=function(Bt,re,ye,Yt,qe,vr,oe,qt,bt,Wt){ye===Yt&&(ye+=1);var $t=Math.PI*120/180,xt=Math.PI/180*(+qe||0),St=[],ue,Pe,ze,Vt,Ct,At=function(we,Ge,cr){var br=we*Math.cos(cr)-Ge*Math.sin(cr),Ce=we*Math.sin(cr)+Ge*Math.cos(cr);return{x:br,y:Ce}};if(Wt)Pe=Wt[0],ze=Wt[1],Vt=Wt[2],Ct=Wt[3];else{ue=At(Bt,re,-xt),Bt=ue.x,re=ue.y,ue=At(qt,bt,-xt),qt=ue.x,bt=ue.y,Bt===qt&&re===bt&&(qt+=1,bt+=1);var Nt=(Bt-qt)/2,tt=(re-bt)/2,vt=Nt*Nt/(ye*ye)+tt*tt/(Yt*Yt);vt>1&&(vt=Math.sqrt(vt),ye=vt*ye,Yt=vt*Yt);var Ht=ye*ye,de=Yt*Yt,jt=(vr===oe?-1:1)*Math.sqrt(Math.abs((Ht*de-Ht*tt*tt-de*Nt*Nt)/(Ht*tt*tt+de*Nt*Nt)));Vt=jt*ye*tt/Yt+(Bt+qt)/2,Ct=jt*-Yt*Nt/ye+(re+bt)/2,Pe=Math.asin(((re-Ct)/Yt).toFixed(9)),ze=Math.asin(((bt-Ct)/Yt).toFixed(9)),Pe=Bt<Vt?Math.PI-Pe:Pe,ze=qt<Vt?Math.PI-ze:ze,Pe<0&&(Pe=Math.PI*2+Pe),ze<0&&(ze=Math.PI*2+ze),oe&&Pe>ze&&(Pe=Pe-Math.PI*2),!oe&&ze>Pe&&(ze=ze-Math.PI*2)}var Ie=ze-Pe;if(Math.abs(Ie)>$t){var We=ze,Ke=qt,pr=bt;ze=Pe+$t*(oe&&ze>Pe?1:-1),qt=Vt+ye*Math.cos(ze),bt=Ct+Yt*Math.sin(ze),St=ot(qt,bt,ye,Yt,qe,0,oe,Ke,pr,[ze,We,Vt,Ct])}Ie=ze-Pe;var lr=Math.cos(Pe),Nr=Math.sin(Pe),Pr=Math.cos(ze),Gr=Math.sin(ze),Sn=Math.tan(Ie/4),nn=4/3*ye*Sn,Nn=4/3*Yt*Sn,Zn=[Bt,re],Hn=[Bt+nn*Nr,re-Nn*lr],An=[qt+nn*Gr,bt-Nn*Pr],$n=[qt,bt];if(Hn[0]=2*Zn[0]-Hn[0],Hn[1]=2*Zn[1]-Hn[1],Wt)return[Hn,An,$n].concat(St);St=[Hn,An,$n].concat(St).join().split(",");for(var Rt=[],Xt=0,ae=St.length;Xt<ae;Xt++)Rt[Xt]=Xt%2?At(St[Xt-1],St[Xt],xt).y:At(St[Xt],St[Xt+1],xt).x;return Rt},ut=function(Bt,re){var ye=pt(Bt),Yt=re&&pt(re),qe={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},vr={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},oe=[],qt=[],bt="",Wt="",$t,xt=function(Nt,tt,vt){var Ht,de;if(!Nt)return["C",tt.x,tt.y,tt.x,tt.y,tt.x,tt.y];switch(!(Nt[0]in{T:1,Q:1})&&(tt.qx=tt.qy=null),Nt[0]){case"M":tt.X=Nt[1],tt.Y=Nt[2];break;case"A":Nt=["C"].concat(ot.apply(0,[tt.x,tt.y].concat(Nt.slice(1))));break;case"S":vt==="C"||vt==="S"?(Ht=tt.x*2-tt.bx,de=tt.y*2-tt.by):(Ht=tt.x,de=tt.y),Nt=["C",Ht,de].concat(Nt.slice(1));break;case"T":vt==="Q"||vt==="T"?(tt.qx=tt.x*2-tt.qx,tt.qy=tt.y*2-tt.qy):(tt.qx=tt.x,tt.qy=tt.y),Nt=["C"].concat(be(tt.x,tt.y,tt.qx,tt.qy,Nt[1],Nt[2]));break;case"Q":tt.qx=Nt[1],tt.qy=Nt[2],Nt=["C"].concat(be(tt.x,tt.y,Nt[1],Nt[2],Nt[3],Nt[4]));break;case"L":Nt=["C"].concat(et(tt.x,tt.y,Nt[1],Nt[2]));break;case"H":Nt=["C"].concat(et(tt.x,tt.y,Nt[1],tt.y));break;case"V":Nt=["C"].concat(et(tt.x,tt.y,tt.x,Nt[1]));break;case"Z":Nt=["C"].concat(et(tt.x,tt.y,tt.X,tt.Y));break;default:break}return Nt},St=function(Nt,tt){if(Nt[tt].length>7){Nt[tt].shift();for(var vt=Nt[tt];vt.length;)oe[tt]="A",Yt&&(qt[tt]="A"),Nt.splice(tt++,0,["C"].concat(vt.splice(0,6)));Nt.splice(tt,1),$t=Math.max(ye.length,Yt&&Yt.length||0)}},ue=function(Nt,tt,vt,Ht,de){Nt&&tt&&Nt[de][0]==="M"&&tt[de][0]!=="M"&&(tt.splice(de,0,["M",Ht.x,Ht.y]),vt.bx=0,vt.by=0,vt.x=Nt[de][1],vt.y=Nt[de][2],$t=Math.max(ye.length,Yt&&Yt.length||0))};$t=Math.max(ye.length,Yt&&Yt.length||0);for(var Pe=0;Pe<$t;Pe++){ye[Pe]&&(bt=ye[Pe][0]),bt!=="C"&&(oe[Pe]=bt,Pe&&(Wt=oe[Pe-1])),ye[Pe]=xt(ye[Pe],qe,Wt),oe[Pe]!=="A"&&bt==="C"&&(oe[Pe]="C"),St(ye,Pe),Yt&&(Yt[Pe]&&(bt=Yt[Pe][0]),bt!=="C"&&(qt[Pe]=bt,Pe&&(Wt=qt[Pe-1])),Yt[Pe]=xt(Yt[Pe],vr,Wt),qt[Pe]!=="A"&&bt==="C"&&(qt[Pe]="C"),St(Yt,Pe)),ue(ye,Yt,qe,vr,Pe),ue(Yt,ye,vr,qe,Pe);var ze=ye[Pe],Vt=Yt&&Yt[Pe],Ct=ze.length,At=Yt&&Vt.length;qe.x=ze[Ct-2],qe.y=ze[Ct-1],qe.bx=parseFloat(ze[Ct-4])||qe.x,qe.by=parseFloat(ze[Ct-3])||qe.y,vr.bx=Yt&&(parseFloat(Vt[At-4])||vr.x),vr.by=Yt&&(parseFloat(Vt[At-3])||vr.y),vr.x=Yt&&Vt[At-2],vr.y=Yt&&Vt[At-1]}return Yt?[ye,Yt]:ye},zt=/,?([a-z]),?/gi,P=function(Bt){return Bt.join(",").replace(zt,"$1")},b=function(Bt,re,ye,Yt,qe){var vr=-3*re+9*ye-9*Yt+3*qe,oe=Bt*vr+6*re-12*ye+6*Yt;return Bt*oe-3*re+3*ye},W=function(Bt,re,ye,Yt,qe,vr,oe,qt,bt){bt===null&&(bt=1),bt=bt>1?1:bt<0?0:bt;for(var Wt=bt/2,$t=12,xt=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],St=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],ue=0,Pe=0;Pe<$t;Pe++){var ze=Wt*xt[Pe]+Wt,Vt=b(ze,Bt,ye,qe,oe),Ct=b(ze,re,Yt,vr,qt),At=Vt*Vt+Ct*Ct;ue+=St[Pe]*Math.sqrt(At)}return Wt*ue},le=function(Bt,re,ye,Yt,qe,vr,oe,qt){for(var bt=[],Wt=[[],[]],$t,xt,St,ue,Pe=0;Pe<2;++Pe){if(Pe===0?(xt=6*Bt-12*ye+6*qe,$t=-3*Bt+9*ye-9*qe+3*oe,St=3*ye-3*Bt):(xt=6*re-12*Yt+6*vr,$t=-3*re+9*Yt-9*vr+3*qt,St=3*Yt-3*re),Math.abs($t)<1e-12){if(Math.abs(xt)<1e-12)continue;ue=-St/xt,ue>0&&ue<1&&bt.push(ue);continue}var ze=xt*xt-4*St*$t,Vt=Math.sqrt(ze);if(!(ze<0)){var Ct=(-xt+Vt)/(2*$t);Ct>0&&Ct<1&&bt.push(Ct);var At=(-xt-Vt)/(2*$t);At>0&&At<1&&bt.push(At)}}for(var Nt=bt.length,tt=Nt,vt;Nt--;)ue=bt[Nt],vt=1-ue,Wt[0][Nt]=vt*vt*vt*Bt+3*vt*vt*ue*ye+3*vt*ue*ue*qe+ue*ue*ue*oe,Wt[1][Nt]=vt*vt*vt*re+3*vt*vt*ue*Yt+3*vt*ue*ue*vr+ue*ue*ue*qt;return Wt[0][tt]=Bt,Wt[1][tt]=re,Wt[0][tt+1]=oe,Wt[1][tt+1]=qt,Wt[0].length=Wt[1].length=tt+2,{min:{x:Math.min.apply(0,Wt[0]),y:Math.min.apply(0,Wt[1])},max:{x:Math.max.apply(0,Wt[0]),y:Math.max.apply(0,Wt[1])}}},Ee=function(Bt,re,ye,Yt,qe,vr,oe,qt){if(!(Math.max(Bt,ye)<Math.min(qe,oe)||Math.min(Bt,ye)>Math.max(qe,oe)||Math.max(re,Yt)<Math.min(vr,qt)||Math.min(re,Yt)>Math.max(vr,qt))){var bt=(Bt*Yt-re*ye)*(qe-oe)-(Bt-ye)*(qe*qt-vr*oe),Wt=(Bt*Yt-re*ye)*(vr-qt)-(re-Yt)*(qe*qt-vr*oe),$t=(Bt-ye)*(vr-qt)-(re-Yt)*(qe-oe);if($t){var xt=bt/$t,St=Wt/$t,ue=+xt.toFixed(2),Pe=+St.toFixed(2);if(!(ue<+Math.min(Bt,ye).toFixed(2)||ue>+Math.max(Bt,ye).toFixed(2)||ue<+Math.min(qe,oe).toFixed(2)||ue>+Math.max(qe,oe).toFixed(2)||Pe<+Math.min(re,Yt).toFixed(2)||Pe>+Math.max(re,Yt).toFixed(2)||Pe<+Math.min(vr,qt).toFixed(2)||Pe>+Math.max(vr,qt).toFixed(2)))return{x:xt,y:St}}}},ke=function(Bt,re,ye){return re>=Bt.x&&re<=Bt.x+Bt.width&&ye>=Bt.y&&ye<=Bt.y+Bt.height},Tt=function(Bt,re,ye,Yt,qe){if(qe)return[["M",+Bt+ +qe,re],["l",ye-qe*2,0],["a",qe,qe,0,0,1,qe,qe],["l",0,Yt-qe*2],["a",qe,qe,0,0,1,-qe,qe],["l",qe*2-ye,0],["a",qe,qe,0,0,1,-qe,-qe],["l",0,qe*2-Yt],["a",qe,qe,0,0,1,qe,-qe],["z"]];var vr=[["M",Bt,re],["l",ye,0],["l",0,Yt],["l",-ye,0],["z"]];return vr.parsePathArray=P,vr},rt=function(Bt,re,ye,Yt){return Bt===null&&(Bt=re=ye=Yt=0),re===null&&(re=Bt.y,ye=Bt.width,Yt=Bt.height,Bt=Bt.x),{x:Bt,y:re,width:ye,w:ye,height:Yt,h:Yt,x2:Bt+ye,y2:re+Yt,cx:Bt+ye/2,cy:re+Yt/2,r1:Math.min(ye,Yt)/2,r2:Math.max(ye,Yt)/2,r0:Math.sqrt(ye*ye+Yt*Yt)/2,path:Tt(Bt,re,ye,Yt),vb:[Bt,re,ye,Yt].join(" ")}},Dt=function(Bt,re){return Bt=rt(Bt),re=rt(re),ke(re,Bt.x,Bt.y)||ke(re,Bt.x2,Bt.y)||ke(re,Bt.x,Bt.y2)||ke(re,Bt.x2,Bt.y2)||ke(Bt,re.x,re.y)||ke(Bt,re.x2,re.y)||ke(Bt,re.x,re.y2)||ke(Bt,re.x2,re.y2)||(Bt.x<re.x2&&Bt.x>re.x||re.x<Bt.x2&&re.x>Bt.x)&&(Bt.y<re.y2&&Bt.y>re.y||re.y<Bt.y2&&re.y>Bt.y)},Se=function(Bt,re,ye,Yt,qe,vr,oe,qt){(0,kt.kJ)(Bt)||(Bt=[Bt,re,ye,Yt,qe,vr,oe,qt]);var bt=le.apply(null,Bt);return rt(bt.min.x,bt.min.y,bt.max.x-bt.min.x,bt.max.y-bt.min.y)},_e=function(Bt,re,ye,Yt,qe,vr,oe,qt,bt){var Wt=1-bt,$t=Math.pow(Wt,3),xt=Math.pow(Wt,2),St=bt*bt,ue=St*bt,Pe=$t*Bt+xt*3*bt*ye+Wt*3*bt*bt*qe+ue*oe,ze=$t*re+xt*3*bt*Yt+Wt*3*bt*bt*vr+ue*qt,Vt=Bt+2*bt*(ye-Bt)+St*(qe-2*ye+Bt),Ct=re+2*bt*(Yt-re)+St*(vr-2*Yt+re),At=ye+2*bt*(qe-ye)+St*(oe-2*qe+ye),Nt=Yt+2*bt*(vr-Yt)+St*(qt-2*vr+Yt),tt=Wt*Bt+bt*ye,vt=Wt*re+bt*Yt,Ht=Wt*qe+bt*oe,de=Wt*vr+bt*qt,jt=90-Math.atan2(Vt-At,Ct-Nt)*180/Math.PI;return{x:Pe,y:ze,m:{x:Vt,y:Ct},n:{x:At,y:Nt},start:{x:tt,y:vt},end:{x:Ht,y:de},alpha:jt}},ve=function(Bt,re,ye){var Yt=Se(Bt),qe=Se(re);if(!Dt(Yt,qe))return ye?0:[];for(var vr=W.apply(0,Bt),oe=W.apply(0,re),qt=~~(vr/8),bt=~~(oe/8),Wt=[],$t=[],xt={},St=ye?0:[],ue=0;ue<qt+1;ue++){var Pe=_e.apply(0,Bt.concat(ue/qt));Wt.push({x:Pe.x,y:Pe.y,t:ue/qt})}for(var ue=0;ue<bt+1;ue++){var Pe=_e.apply(0,re.concat(ue/bt));$t.push({x:Pe.x,y:Pe.y,t:ue/bt})}for(var ue=0;ue<qt;ue++)for(var ze=0;ze<bt;ze++){var Vt=Wt[ue],Ct=Wt[ue+1],At=$t[ze],Nt=$t[ze+1],tt=Math.abs(Ct.x-Vt.x)<.001?"y":"x",vt=Math.abs(Nt.x-At.x)<.001?"y":"x",Ht=Ee(Vt.x,Vt.y,Ct.x,Ct.y,At.x,At.y,Nt.x,Nt.y);if(Ht){if(xt[Ht.x.toFixed(4)]===Ht.y.toFixed(4))continue;xt[Ht.x.toFixed(4)]=Ht.y.toFixed(4);var de=Vt.t+Math.abs((Ht[tt]-Vt[tt])/(Ct[tt]-Vt[tt]))*(Ct.t-Vt.t),jt=At.t+Math.abs((Ht[vt]-At[vt])/(Nt[vt]-At[vt]))*(Nt.t-At.t);de>=0&&de<=1&&jt>=0&&jt<=1&&(ye?St+=1:St.push({x:Ht.x,y:Ht.y,t1:de,t2:jt}))}}return St},ne=function(Bt,re,ye){Bt=ut(Bt),re=ut(re);for(var Yt,qe,vr,oe,qt,bt,Wt,$t,xt,St,ue=ye?0:[],Pe=0,ze=Bt.length;Pe<ze;Pe++){var Vt=Bt[Pe];if(Vt[0]==="M")Yt=qt=Vt[1],qe=bt=Vt[2];else{Vt[0]==="C"?(xt=[Yt,qe].concat(Vt.slice(1)),Yt=xt[6],qe=xt[7]):(xt=[Yt,qe,Yt,qe,qt,bt,qt,bt],Yt=qt,qe=bt);for(var Ct=0,At=re.length;Ct<At;Ct++){var Nt=re[Ct];if(Nt[0]==="M")vr=Wt=Nt[1],oe=$t=Nt[2];else{Nt[0]==="C"?(St=[vr,oe].concat(Nt.slice(1)),vr=St[6],oe=St[7]):(St=[vr,oe,vr,oe,Wt,$t,Wt,$t],vr=Wt,oe=$t);var tt=ve(xt,St,ye);if(ye)ue+=tt;else{for(var vt=0,Ht=tt.length;vt<Ht;vt++)tt[vt].segment1=Pe,tt[vt].segment2=Ct,tt[vt].bez1=xt,tt[vt].bez2=St;ue=ue.concat(tt)}}}}}return ue},xe=function(Bt,re){return ne(Bt,re)};function Je(Bt,re){var ye=[],Yt=[];function qe(vr,oe){if(vr.length===1)ye.push(vr[0]),Yt.push(vr[0]);else{for(var qt=[],bt=0;bt<vr.length-1;bt++)bt===0&&ye.push(vr[0]),bt===vr.length-2&&Yt.push(vr[bt+1]),qt[bt]=[(1-oe)*vr[bt][0]+oe*vr[bt+1][0],(1-oe)*vr[bt][1]+oe*vr[bt+1][1]];qe(qt,oe)}}return Bt.length&&qe(Bt,re),{left:ye,right:Yt.reverse()}}function Ot(Bt,re,ye){var Yt=[[Bt[1],Bt[2]]];ye=ye||2;var qe=[];re[0]==="A"?(Yt.push(re[6]),Yt.push(re[7])):re[0]==="C"?(Yt.push([re[1],re[2]]),Yt.push([re[3],re[4]]),Yt.push([re[5],re[6]])):re[0]==="S"||re[0]==="Q"?(Yt.push([re[1],re[2]]),Yt.push([re[3],re[4]])):Yt.push([re[1],re[2]]);for(var vr=Yt,oe=1/ye,qt=0;qt<ye-1;qt++){var bt=oe/(1-oe*qt),Wt=Je(vr,bt);qe.push(Wt.left),vr=Wt.right}qe.push(vr);var $t=qe.map(function(xt){var St=[];return xt.length===4&&(St.push("C"),St=St.concat(xt[2])),xt.length>=3&&(xt.length===3&&St.push("Q"),St=St.concat(xt[1])),xt.length===2&&St.push("L"),St=St.concat(xt[xt.length-1]),St});return $t}var te=function(Bt,re,ye){if(ye===1)return[[].concat(Bt)];var Yt=[];if(re[0]==="L"||re[0]==="C"||re[0]==="Q")Yt=Yt.concat(Ot(Bt,re,ye));else{var qe=[].concat(Bt);qe[0]==="M"&&(qe[0]="L");for(var vr=0;vr<=ye-1;vr++)Yt.push(qe)}return Yt},ft=function(Bt,re){if(Bt.length===1)return Bt;var ye=Bt.length-1,Yt=re.length-1,qe=ye/Yt,vr=[];if(Bt.length===1&&Bt[0][0]==="M"){for(var oe=0;oe<Yt-ye;oe++)Bt.push(Bt[0]);return Bt}for(var oe=0;oe<Yt;oe++){var qt=Math.floor(qe*oe);vr[qt]=(vr[qt]||0)+1}var bt=vr.reduce(function(Wt,$t,xt){return xt===ye?Wt.concat(Bt[ye]):Wt.concat(te(Bt[xt],Bt[xt+1],$t))},[]);return bt.unshift(Bt[0]),(re[Yt]==="Z"||re[Yt]==="z")&&bt.push("Z"),bt},wt=function(Bt,re){if(Bt.length!==re.length)return!1;var ye=!0;return(0,kt.S6)(Bt,function(Yt,qe){if(Yt!==re[qe])return ye=!1,!1}),ye};function Y(Bt,re,ye){var Yt=null,qe=ye;return re<qe&&(qe=re,Yt="add"),Bt<qe&&(qe=Bt,Yt="del"),{type:Yt,min:qe}}var gt=function(Bt,re){var ye=Bt.length,Yt=re.length,qe,vr,oe=0;if(ye===0||Yt===0)return null;for(var qt=[],bt=0;bt<=ye;bt++)qt[bt]=[],qt[bt][0]={min:bt};for(var Wt=0;Wt<=Yt;Wt++)qt[0][Wt]={min:Wt};for(var bt=1;bt<=ye;bt++){qe=Bt[bt-1];for(var Wt=1;Wt<=Yt;Wt++){vr=re[Wt-1],wt(qe,vr)?oe=0:oe=1;var $t=qt[bt-1][Wt].min+1,xt=qt[bt][Wt-1].min+1,St=qt[bt-1][Wt-1].min+oe;qt[bt][Wt]=Y($t,xt,St)}}return qt},he=function(Bt,re){var ye=gt(Bt,re),Yt=Bt.length,qe=re.length,vr=[],oe=1,qt=1;if(ye[Yt][qe].min!==Yt){for(var bt=1;bt<=Yt;bt++){var Wt=ye[bt][bt].min;qt=bt;for(var $t=oe;$t<=qe;$t++)ye[bt][$t].min<Wt&&(Wt=ye[bt][$t].min,qt=$t);oe=qt,ye[bt][oe].type&&vr.push({index:bt-1,type:ye[bt][oe].type})}for(var bt=vr.length-1;bt>=0;bt--)oe=vr[bt].index,vr[bt].type==="add"?Bt.splice(oe,0,[].concat(Bt[oe])):Bt.splice(oe,1)}Yt=Bt.length;var xt=qe-Yt;if(Yt<qe)for(var bt=0;bt<xt;bt++)Bt[Yt-1][0]==="z"||Bt[Yt-1][0]==="Z"?Bt.splice(Yt-2,0,Bt[Yt-2]):Bt.push(Bt[Yt-1]),Yt+=1;return Bt};function Oe(Bt,re,ye){for(var Yt=[].concat(Bt),qe,vr=1/(ye+1),oe=Le(re)[0],qt=1;qt<=ye;qt++)vr*=qt,qe=Math.floor(Bt.length*vr),qe===0?Yt.unshift([oe[0]*vr+Bt[qe][0]*(1-vr),oe[1]*vr+Bt[qe][1]*(1-vr)]):Yt.splice(qe,0,[oe[0]*vr+Bt[qe][0]*(1-vr),oe[1]*vr+Bt[qe][1]*(1-vr)]);return Yt}function Le(Bt){var re=[];switch(Bt[0]){case"M":re.push([Bt[1],Bt[2]]);break;case"L":re.push([Bt[1],Bt[2]]);break;case"A":re.push([Bt[6],Bt[7]]);break;case"Q":re.push([Bt[3],Bt[4]]),re.push([Bt[1],Bt[2]]);break;case"T":re.push([Bt[1],Bt[2]]);break;case"C":re.push([Bt[5],Bt[6]]),re.push([Bt[1],Bt[2]]),re.push([Bt[3],Bt[4]]);break;case"S":re.push([Bt[3],Bt[4]]),re.push([Bt[1],Bt[2]]);break;case"H":re.push([Bt[1],Bt[1]]);break;case"V":re.push([Bt[1],Bt[1]]);break;default:}return re}var Ve=function(Bt,re){if(Bt.length<=1)return Bt;for(var ye,Yt=0;Yt<re.length;Yt++)if(Bt[Yt][0]!==re[Yt][0])switch(ye=Le(Bt[Yt]),re[Yt][0]){case"M":Bt[Yt]=["M"].concat(ye[0]);break;case"L":Bt[Yt]=["L"].concat(ye[0]);break;case"A":Bt[Yt]=[].concat(re[Yt]),Bt[Yt][6]=ye[0][0],Bt[Yt][7]=ye[0][1];break;case"Q":if(ye.length<2)if(Yt>0)ye=Oe(ye,Bt[Yt-1],1);else{Bt[Yt]=re[Yt];break}Bt[Yt]=["Q"].concat(ye.reduce(function(qe,vr){return qe.concat(vr)},[]));break;case"T":Bt[Yt]=["T"].concat(ye[0]);break;case"C":if(ye.length<3)if(Yt>0)ye=Oe(ye,Bt[Yt-1],2);else{Bt[Yt]=re[Yt];break}Bt[Yt]=["C"].concat(ye.reduce(function(qe,vr){return qe.concat(vr)},[]));break;case"S":if(ye.length<2)if(Yt>0)ye=Oe(ye,Bt[Yt-1],1);else{Bt[Yt]=re[Yt];break}Bt[Yt]=["S"].concat(ye.reduce(function(qe,vr){return qe.concat(vr)},[]));break;default:Bt[Yt]=re[Yt]}return Bt}},56430:function(dn,Pt,nt){"use strict";nt.d(Pt,{$O:function(){return yt},FE:function(){return k},mY:function(){return K}});var kt=nt(91220),mt=nt(69307);function k(J,pt,et){var be=1;if((0,kt.HD)(J)&&(be=J.split(`
`).length),be>1){var ot=Et(pt,et);return pt*be+ot*(be-1)}return pt}function Et(J,pt){return pt?pt-J:J*.14}function K(J,pt){var et=(0,mt.L)(),be=0;if((0,kt.kK)(J)||J==="")return be;if(et.save(),et.font=pt,(0,kt.HD)(J)&&J.includes(`
`)){var ot=J.split(`
`);(0,kt.S6)(ot,function(ut){var zt=et.measureText(ut).width;be<zt&&(be=zt)})}else be=et.measureText(J).width;return et.restore(),be}function yt(J){var pt=J.fontSize,et=J.fontFamily,be=J.fontWeight,ot=J.fontStyle,ut=J.fontVariant;return[ot,ut,be,pt+"px",et].join(" ").trim()}},91220:function(dn,Pt,nt){"use strict";nt.d(Pt,{As:function(){return mt},CD:function(){return kt.CD},HD:function(){return kt.HD},Kn:function(){return kt.Kn},S6:function(){return kt.S6},UY:function(){return Et},jC:function(){return kt.jC},jU:function(){return k},kK:function(){return kt.UM},mf:function(){return kt.mf},pP:function(){return K}});var kt=nt(22374);function mt(yt,J){var pt=yt.indexOf(J);pt!==-1&&yt.splice(pt,1)}var k=typeof window!="undefined"&&typeof window.document!="undefined";function Et(yt,J){if(yt.isCanvas())return!0;for(var pt=J.getParent(),et=!1;pt;){if(pt===yt){et=!0;break}pt=pt.getParent()}return et}function K(yt){return yt.cfg.visible&&yt.cfg.capture}},62930:function(dn,Pt,nt){"use strict";nt.d(Pt,{wN:function(){return Oe},Ll:function(){return _e},x1:function(){return et},aH:function(){return Yt},lD:function(){return Ee},Zr:function(){return kt}});var kt={};nt.r(kt),nt.d(kt,{distance:function(){return k},getBBoxByArray:function(){return K},getBBoxRange:function(){return yt},isNumberEqual:function(){return Et},piMod:function(){return J}});var mt=nt(22374);function k(oe,qt,bt,Wt){var $t=oe-bt,xt=qt-Wt;return Math.sqrt($t*$t+xt*xt)}function Et(oe,qt){return Math.abs(oe-qt)<.001}function K(oe,qt){var bt=(0,mt.VV)(oe),Wt=(0,mt.VV)(qt),$t=(0,mt.Fp)(oe),xt=(0,mt.Fp)(qt);return{x:bt,y:Wt,width:$t-bt,height:xt-Wt}}function yt(oe,qt,bt,Wt){return{minX:(0,mt.VV)([oe,bt]),maxX:(0,mt.Fp)([oe,bt]),minY:(0,mt.VV)([qt,Wt]),maxY:(0,mt.Fp)([qt,Wt])}}function J(oe){return(oe+Math.PI*2)%(Math.PI*2)}var pt=nt(1153),et={box:function(oe,qt,bt,Wt){return K([oe,bt],[qt,Wt])},length:function(oe,qt,bt,Wt){return k(oe,qt,bt,Wt)},pointAt:function(oe,qt,bt,Wt,$t){return{x:(1-$t)*oe+$t*bt,y:(1-$t)*qt+$t*Wt}},pointDistance:function(oe,qt,bt,Wt,$t,xt){var St=(bt-oe)*($t-oe)+(Wt-qt)*(xt-qt);if(St<0)return k(oe,qt,$t,xt);var ue=(bt-oe)*(bt-oe)+(Wt-qt)*(Wt-qt);return St>ue?k(bt,Wt,$t,xt):this.pointToLine(oe,qt,bt,Wt,$t,xt)},pointToLine:function(oe,qt,bt,Wt,$t,xt){var St=[bt-oe,Wt-qt];if(pt.I6(St,[0,0]))return Math.sqrt(($t-oe)*($t-oe)+(xt-qt)*(xt-qt));var ue=[-St[1],St[0]];pt.Fv(ue,ue);var Pe=[$t-oe,xt-qt];return Math.abs(pt.AK(Pe,ue))},tangentAngle:function(oe,qt,bt,Wt){return Math.atan2(Wt-qt,bt-oe)}},be=1e-4;function ot(oe,qt,bt,Wt,$t,xt){var St,ue=1/0,Pe=[bt,Wt],ze=20;xt&&xt>200&&(ze=xt/10);for(var Vt=1/ze,Ct=Vt/10,At=0;At<=ze;At++){var Nt=At*Vt,tt=[$t.apply(null,oe.concat([Nt])),$t.apply(null,qt.concat([Nt]))],vt=k(Pe[0],Pe[1],tt[0],tt[1]);vt<ue&&(St=Nt,ue=vt)}if(St===0)return{x:oe[0],y:qt[0]};if(St===1){var Ht=oe.length;return{x:oe[Ht-1],y:qt[Ht-1]}}ue=1/0;for(var At=0;At<32&&!(Ct<be);At++){var de=St-Ct,jt=St+Ct,tt=[$t.apply(null,oe.concat([de])),$t.apply(null,qt.concat([de]))],vt=k(Pe[0],Pe[1],tt[0],tt[1]);if(de>=0&&vt<ue)St=de,ue=vt;else{var Ie=[$t.apply(null,oe.concat([jt])),$t.apply(null,qt.concat([jt]))],We=k(Pe[0],Pe[1],Ie[0],Ie[1]);jt<=1&&We<ue?(St=jt,ue=We):Ct*=.5}}return{x:$t.apply(null,oe.concat([St])),y:$t.apply(null,qt.concat([St]))}}function ut(oe,qt){for(var bt=0,Wt=oe.length,$t=0;$t<Wt;$t++){var xt=oe[$t],St=qt[$t],ue=oe[($t+1)%Wt],Pe=qt[($t+1)%Wt];bt+=k(xt,St,ue,Pe)}return bt/2}function zt(oe,qt,bt,Wt){var $t=1-Wt;return $t*$t*oe+2*Wt*$t*qt+Wt*Wt*bt}function P(oe,qt,bt){var Wt=oe+bt-2*qt;if(Et(Wt,0))return[.5];var $t=(oe-qt)/Wt;return $t<=1&&$t>=0?[$t]:[]}function b(oe,qt,bt,Wt){return 2*(1-Wt)*(qt-oe)+2*Wt*(bt-qt)}function W(oe,qt,bt,Wt,$t,xt,St){var ue=zt(oe,bt,$t,St),Pe=zt(qt,Wt,xt,St),ze=et.pointAt(oe,qt,bt,Wt,St),Vt=et.pointAt(bt,Wt,$t,xt,St);return[[oe,qt,ze.x,ze.y,ue,Pe],[ue,Pe,Vt.x,Vt.y,$t,xt]]}function le(oe,qt,bt,Wt,$t,xt,St){if(St===0)return(k(oe,qt,bt,Wt)+k(bt,Wt,$t,xt)+k(oe,qt,$t,xt))/2;var ue=W(oe,qt,bt,Wt,$t,xt,.5),Pe=ue[0],ze=ue[1];return Pe.push(St-1),ze.push(St-1),le.apply(null,Pe)+le.apply(null,ze)}var Ee={box:function(oe,qt,bt,Wt,$t,xt){var St=P(oe,bt,$t)[0],ue=P(qt,Wt,xt)[0],Pe=[oe,$t],ze=[qt,xt];return St!==void 0&&Pe.push(zt(oe,bt,$t,St)),ue!==void 0&&ze.push(zt(qt,Wt,xt,ue)),K(Pe,ze)},length:function(oe,qt,bt,Wt,$t,xt){return le(oe,qt,bt,Wt,$t,xt,3)},nearestPoint:function(oe,qt,bt,Wt,$t,xt,St,ue){return ot([oe,bt,$t],[qt,Wt,xt],St,ue,zt)},pointDistance:function(oe,qt,bt,Wt,$t,xt,St,ue){var Pe=this.nearestPoint(oe,qt,bt,Wt,$t,xt,St,ue);return k(Pe.x,Pe.y,St,ue)},interpolationAt:zt,pointAt:function(oe,qt,bt,Wt,$t,xt,St){return{x:zt(oe,bt,$t,St),y:zt(qt,Wt,xt,St)}},divide:function(oe,qt,bt,Wt,$t,xt,St){return W(oe,qt,bt,Wt,$t,xt,St)},tangentAngle:function(oe,qt,bt,Wt,$t,xt,St){var ue=b(oe,bt,$t,St),Pe=b(qt,Wt,xt,St),ze=Math.atan2(Pe,ue);return J(ze)}};function ke(oe,qt,bt,Wt,$t){var xt=1-$t;return xt*xt*xt*oe+3*qt*$t*xt*xt+3*bt*$t*$t*xt+Wt*$t*$t*$t}function Tt(oe,qt,bt,Wt,$t){var xt=1-$t;return 3*(xt*xt*(qt-oe)+2*xt*$t*(bt-qt)+$t*$t*(Wt-bt))}function rt(oe,qt,bt,Wt){var $t=-3*oe+9*qt-9*bt+3*Wt,xt=6*oe-12*qt+6*bt,St=3*qt-3*oe,ue=[],Pe,ze,Vt;if(Et($t,0))Et(xt,0)||(Pe=-St/xt,Pe>=0&&Pe<=1&&ue.push(Pe));else{var Ct=xt*xt-4*$t*St;Et(Ct,0)?ue.push(-xt/(2*$t)):Ct>0&&(Vt=Math.sqrt(Ct),Pe=(-xt+Vt)/(2*$t),ze=(-xt-Vt)/(2*$t),Pe>=0&&Pe<=1&&ue.push(Pe),ze>=0&&ze<=1&&ue.push(ze))}return ue}function Dt(oe,qt,bt,Wt,$t,xt,St,ue,Pe){var ze=ke(oe,bt,$t,St,Pe),Vt=ke(qt,Wt,xt,ue,Pe),Ct=et.pointAt(oe,qt,bt,Wt,Pe),At=et.pointAt(bt,Wt,$t,xt,Pe),Nt=et.pointAt($t,xt,St,ue,Pe),tt=et.pointAt(Ct.x,Ct.y,At.x,At.y,Pe),vt=et.pointAt(At.x,At.y,Nt.x,Nt.y,Pe);return[[oe,qt,Ct.x,Ct.y,tt.x,tt.y,ze,Vt],[ze,Vt,vt.x,vt.y,Nt.x,Nt.y,St,ue]]}function Se(oe,qt,bt,Wt,$t,xt,St,ue,Pe){if(Pe===0)return ut([oe,bt,$t,St],[qt,Wt,xt,ue]);var ze=Dt(oe,qt,bt,Wt,$t,xt,St,ue,.5),Vt=ze[0],Ct=ze[1];return Vt.push(Pe-1),Ct.push(Pe-1),Se.apply(null,Vt)+Se.apply(null,Ct)}var _e={extrema:rt,box:function(oe,qt,bt,Wt,$t,xt,St,ue){for(var Pe=[oe,St],ze=[qt,ue],Vt=rt(oe,bt,$t,St),Ct=rt(qt,Wt,xt,ue),At=0;At<Vt.length;At++)Pe.push(ke(oe,bt,$t,St,Vt[At]));for(var At=0;At<Ct.length;At++)ze.push(ke(qt,Wt,xt,ue,Ct[At]));return K(Pe,ze)},length:function(oe,qt,bt,Wt,$t,xt,St,ue){return Se(oe,qt,bt,Wt,$t,xt,St,ue,3)},nearestPoint:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe,ze,Vt){return ot([oe,bt,$t,St],[qt,Wt,xt,ue],Pe,ze,ke,Vt)},pointDistance:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe,ze,Vt){var Ct=this.nearestPoint(oe,qt,bt,Wt,$t,xt,St,ue,Pe,ze,Vt);return k(Ct.x,Ct.y,Pe,ze)},interpolationAt:ke,pointAt:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe){return{x:ke(oe,bt,$t,St,Pe),y:ke(qt,Wt,xt,ue,Pe)}},divide:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe){return Dt(oe,qt,bt,Wt,$t,xt,St,ue,Pe)},tangentAngle:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe){var ze=Tt(oe,bt,$t,St,Pe),Vt=Tt(qt,Wt,xt,ue,Pe);return J(Math.atan2(Vt,ze))}};function ve(oe,qt){var bt=Math.abs(oe);return qt>0?bt:bt*-1}var ne={box:function(oe,qt,bt,Wt){return{x:oe-bt,y:qt-Wt,width:bt*2,height:Wt*2}},length:function(oe,qt,bt,Wt){return Math.PI*(3*(bt+Wt)-Math.sqrt((3*bt+Wt)*(bt+3*Wt)))},nearestPoint:function(oe,qt,bt,Wt,$t,xt){var St=bt,ue=Wt;if(St===0||ue===0)return{x:oe,y:qt};for(var Pe=$t-oe,ze=xt-qt,Vt=Math.abs(Pe),Ct=Math.abs(ze),At=St*St,Nt=ue*ue,tt=Math.PI/4,vt,Ht,de=0;de<4;de++){vt=St*Math.cos(tt),Ht=ue*Math.sin(tt);var jt=(At-Nt)*Math.pow(Math.cos(tt),3)/St,Ie=(Nt-At)*Math.pow(Math.sin(tt),3)/ue,We=vt-jt,Ke=Ht-Ie,pr=Vt-jt,lr=Ct-Ie,Nr=Math.hypot(Ke,We),Pr=Math.hypot(lr,pr),Gr=Nr*Math.asin((We*lr-Ke*pr)/(Nr*Pr)),Sn=Gr/Math.sqrt(At+Nt-vt*vt-Ht*Ht);tt+=Sn,tt=Math.min(Math.PI/2,Math.max(0,tt))}return{x:oe+ve(vt,Pe),y:qt+ve(Ht,ze)}},pointDistance:function(oe,qt,bt,Wt,$t,xt){var St=this.nearestPoint(oe,qt,bt,Wt,$t,xt);return k(St.x,St.y,$t,xt)},pointAt:function(oe,qt,bt,Wt,$t){var xt=2*Math.PI*$t;return{x:oe+bt*Math.cos(xt),y:qt+Wt*Math.sin(xt)}},tangentAngle:function(oe,qt,bt,Wt,$t){var xt=2*Math.PI*$t,St=Math.atan2(Wt*Math.cos(xt),-bt*Math.sin(xt));return J(St)}};function xe(oe,qt,bt,Wt,$t,xt,St,ue){return-1*bt*Math.cos($t)*Math.sin(ue)-Wt*Math.sin($t)*Math.cos(ue)}function Je(oe,qt,bt,Wt,$t,xt,St,ue){return-1*bt*Math.sin($t)*Math.sin(ue)+Wt*Math.cos($t)*Math.cos(ue)}function Ot(oe,qt,bt){return Math.atan(-qt/oe*Math.tan(bt))}function te(oe,qt,bt){return Math.atan(qt/(oe*Math.tan(bt)))}function ft(oe,qt,bt,Wt,$t,xt){return bt*Math.cos($t)*Math.cos(xt)-Wt*Math.sin($t)*Math.sin(xt)+oe}function wt(oe,qt,bt,Wt,$t,xt){return bt*Math.sin($t)*Math.cos(xt)+Wt*Math.cos($t)*Math.sin(xt)+qt}function Y(oe,qt,bt,Wt){var $t=Math.atan2(Wt*oe,bt*qt);return($t+Math.PI*2)%(Math.PI*2)}function gt(oe,qt,bt){return{x:oe*Math.cos(bt),y:qt*Math.sin(bt)}}function he(oe,qt,bt){var Wt=Math.cos(bt),$t=Math.sin(bt);return[oe*Wt-qt*$t,oe*$t+qt*Wt]}var Oe={box:function(oe,qt,bt,Wt,$t,xt,St){for(var ue=Ot(bt,Wt,$t),Pe=1/0,ze=-1/0,Vt=[xt,St],Ct=-Math.PI*2;Ct<=Math.PI*2;Ct+=Math.PI){var At=ue+Ct;xt<St?xt<At&&At<St&&Vt.push(At):St<At&&At<xt&&Vt.push(At)}for(var Ct=0;Ct<Vt.length;Ct++){var Nt=ft(oe,qt,bt,Wt,$t,Vt[Ct]);Nt<Pe&&(Pe=Nt),Nt>ze&&(ze=Nt)}for(var tt=te(bt,Wt,$t),vt=1/0,Ht=-1/0,de=[xt,St],Ct=-Math.PI*2;Ct<=Math.PI*2;Ct+=Math.PI){var jt=tt+Ct;xt<St?xt<jt&&jt<St&&de.push(jt):St<jt&&jt<xt&&de.push(jt)}for(var Ct=0;Ct<de.length;Ct++){var Ie=wt(oe,qt,bt,Wt,$t,de[Ct]);Ie<vt&&(vt=Ie),Ie>Ht&&(Ht=Ie)}return{x:Pe,y:vt,width:ze-Pe,height:Ht-vt}},length:function(oe,qt,bt,Wt,$t,xt,St){},nearestPoint:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe){var ze=he(ue-oe,Pe-qt,-$t),Vt=ze[0],Ct=ze[1],At=ne.nearestPoint(0,0,bt,Wt,Vt,Ct),Nt=Y(bt,Wt,At.x,At.y);Nt<xt?At=gt(bt,Wt,xt):Nt>St&&(At=gt(bt,Wt,St));var tt=he(At.x,At.y,$t);return{x:tt[0]+oe,y:tt[1]+qt}},pointDistance:function(oe,qt,bt,Wt,$t,xt,St,ue,Pe){var ze=this.nearestPoint(oe,qt,bt,Wt,ue,Pe);return k(ze.x,ze.y,ue,Pe)},pointAt:function(oe,qt,bt,Wt,$t,xt,St,ue){var Pe=(St-xt)*ue+xt;return{x:ft(oe,qt,bt,Wt,$t,Pe),y:wt(oe,qt,bt,Wt,$t,Pe)}},tangentAngle:function(oe,qt,bt,Wt,$t,xt,St,ue){var Pe=(St-xt)*ue+xt,ze=xe(oe,qt,bt,Wt,$t,xt,St,Pe),Vt=Je(oe,qt,bt,Wt,$t,xt,St,Pe);return J(Math.atan2(Vt,ze))}};function Le(oe){for(var qt=0,bt=[],Wt=0;Wt<oe.length-1;Wt++){var $t=oe[Wt],xt=oe[Wt+1],St=k($t[0],$t[1],xt[0],xt[1]),ue={from:$t,to:xt,length:St};bt.push(ue),qt+=St}return{segments:bt,totalLength:qt}}function Ve(oe){if(oe.length<2)return 0;for(var qt=0,bt=0;bt<oe.length-1;bt++){var Wt=oe[bt],$t=oe[bt+1];qt+=k(Wt[0],Wt[1],$t[0],$t[1])}return qt}function Bt(oe,qt){if(qt>1||qt<0||oe.length<2)return null;var bt=Le(oe),Wt=bt.segments,$t=bt.totalLength;if($t===0)return{x:oe[0][0],y:oe[0][1]};for(var xt=0,St=null,ue=0;ue<Wt.length;ue++){var Pe=Wt[ue],ze=Pe.from,Vt=Pe.to,Ct=Pe.length/$t;if(qt>=xt&&qt<=xt+Ct){var At=(qt-xt)/Ct;St=et.pointAt(ze[0],ze[1],Vt[0],Vt[1],At);break}xt+=Ct}return St}function re(oe,qt){if(qt>1||qt<0||oe.length<2)return 0;for(var bt=Le(oe),Wt=bt.segments,$t=bt.totalLength,xt=0,St=0,ue=0;ue<Wt.length;ue++){var Pe=Wt[ue],ze=Pe.from,Vt=Pe.to,Ct=Pe.length/$t;if(qt>=xt&&qt<=xt+Ct){St=Math.atan2(Vt[1]-ze[1],Vt[0]-ze[0]);break}xt+=Ct}return St}function ye(oe,qt,bt){for(var Wt=1/0,$t=0;$t<oe.length-1;$t++){var xt=oe[$t],St=oe[$t+1],ue=et.pointDistance(xt[0],xt[1],St[0],St[1],qt,bt);ue<Wt&&(Wt=ue)}return Wt}var Yt={box:function(oe){for(var qt=[],bt=[],Wt=0;Wt<oe.length;Wt++){var $t=oe[Wt];qt.push($t[0]),bt.push($t[1])}return K(qt,bt)},length:function(oe){return Ve(oe)},pointAt:function(oe,qt){return Bt(oe,qt)},pointDistance:function(oe,qt,bt){return ye(oe,qt,bt)},tangentAngle:function(oe,qt){return re(oe,qt)}};function qe(oe){var qt=oe.slice(0);return oe.length&&qt.push(oe[0]),qt}var vr={box:function(oe){return Yt.box(oe)},length:function(oe){return Ve(qe(oe))},pointAt:function(oe,qt){return Bt(qe(oe),qt)},pointDistance:function(oe,qt,bt){return ye(qe(oe),qt,bt)},tangentAngle:function(oe,qt){return re(qe(oe),qt)}}},40923:function(dn,Pt,nt){"use strict";nt.d(Pt,{Bar:function(){return Qw},Column:function(){return Jw},Pie:function(){return Bx}});var kt={};nt.r(kt),nt.d(kt,{assign:function(){return jo},default:function(){return Nu},defaultI18n:function(){return Xe},format:function(){return Ku},parse:function(){return Bu},setGlobalDateI18n:function(){return sn},setGlobalDateMasks:function(){return _u}});var mt={};nt.r(mt),nt.d(mt,{Arc:function(){return Zl},DataMarker:function(){return Mp},DataRegion:function(){return Al},Html:function(){return Ut},Image:function(){return Sf},Line:function(){return vl},Region:function(){return qf},RegionFilter:function(){return Hh},Shape:function(){return oc},Text:function(){return ac}});var k={};nt.r(k),nt.d(k,{ellipsisHead:function(){return $e},ellipsisMiddle:function(){return er},ellipsisTail:function(){return _r},getDefault:function(){return fr}});var Et={};nt.r(Et),nt.d(Et,{equidistance:function(){return Ri},equidistanceWithReverseBoth:function(){return Di},getDefault:function(){return _n},reserveBoth:function(){return oi},reserveFirst:function(){return Un},reserveLast:function(){return ui}});var K={};nt.r(K),nt.d(K,{fixedAngle:function(){return Bi},getDefault:function(){return co},unfixedAngle:function(){return Pa}});var yt={};nt.r(yt),nt.d(yt,{autoEllipsis:function(){return k},autoHide:function(){return Et},autoRotate:function(){return K}});var J={};nt.r(J),nt.d(J,{Base:function(){return ca},Circle:function(){return hu},Html:function(){return Vl},Line:function(){return xs}});var pt={};nt.r(pt),nt.d(pt,{CONTAINER_CLASS:function(){return au},CROSSHAIR_X:function(){return Fc},CROSSHAIR_Y:function(){return _h},LIST_CLASS:function(){return ol},LIST_ITEM_CLASS:function(){return yc},MARKER_CLASS:function(){return Mf},NAME_CLASS:function(){return ou},TITLE_CLASS:function(){return kl},VALUE_CLASS:function(){return Ll}});var et={};nt.r(et),nt.d(et,{Base:function(){return Nc},Circle:function(){return xy},Ellipse:function(){return rg},Image:function(){return ng},Line:function(){return Sc},Marker:function(){return up},Path:function(){return Nd},Polygon:function(){return y_},Polyline:function(){return __},Rect:function(){return $g},Text:function(){return Vp}});var be={};nt.r(be),nt.d(be,{Canvas:function(){return x2},Group:function(){return m0},Shape:function(){return et},getArcParams:function(){return Pd},version:function(){return fO}});var ot={};nt.r(ot),nt.d(ot,{Base:function(){return uh},Circle:function(){return T2},Dom:function(){return I2},Ellipse:function(){return L2},Image:function(){return Cc},Line:function(){return F2},Marker:function(){return D2},Path:function(){return N2},Polygon:function(){return U2},Polyline:function(){return V2},Rect:function(){return RT},Text:function(){return BT}});var ut={};nt.r(ut),nt.d(ut,{Canvas:function(){return eE},Group:function(){return Iy},Shape:function(){return ot},version:function(){return rE}});var zt={};nt.r(zt),nt.d(zt,{cluster:function(){return w4},hierarchy:function(){return Eg},pack:function(){return vC},packEnclose:function(){return A1},packSiblings:function(){return k1},partition:function(){return Pb},stratify:function(){return uA},tree:function(){return fA},treemap:function(){return vA},treemapBinary:function(){return M4},treemapDice:function(){return Hm},treemapResquarify:function(){return Xm},treemapSlice:function(){return Wm},treemapSliceDice:function(){return I4},treemapSquarify:function(){return dA}});var P=nt(29268),b=nt(22374),W;(function(r){r.FORE="fore",r.MID="mid",r.BG="bg"})(W||(W={}));var le;(function(r){r.TOP="top",r.TOP_LEFT="top-left",r.TOP_RIGHT="top-right",r.RIGHT="right",r.RIGHT_TOP="right-top",r.RIGHT_BOTTOM="right-bottom",r.LEFT="left",r.LEFT_TOP="left-top",r.LEFT_BOTTOM="left-bottom",r.BOTTOM="bottom",r.BOTTOM_LEFT="bottom-left",r.BOTTOM_RIGHT="bottom-right",r.RADIUS="radius",r.CIRCLE="circle",r.NONE="none"})(le||(le={}));var Ee;(function(r){r.AXIS="axis",r.GRID="grid",r.LEGEND="legend",r.TOOLTIP="tooltip",r.ANNOTATION="annotation",r.SLIDER="slider",r.SCROLLBAR="scrollbar",r.OTHER="other"})(Ee||(Ee={}));var ke={FORE:3,MID:2,BG:1},Tt;(function(r){r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_PAINT="beforepaint",r.AFTER_PAINT="afterpaint",r.BEFORE_CHANGE_DATA="beforechangedata",r.AFTER_CHANGE_DATA="afterchangedata",r.BEFORE_CLEAR="beforeclear",r.AFTER_CLEAR="afterclear",r.BEFORE_DESTROY="beforedestroy",r.BEFORE_CHANGE_SIZE="beforechangesize",r.AFTER_CHANGE_SIZE="afterchangesize"})(Tt||(Tt={}));var rt;(function(r){r.BEFORE_DRAW_ANIMATE="beforeanimate",r.AFTER_DRAW_ANIMATE="afteranimate",r.BEFORE_RENDER_LABEL="beforerenderlabel",r.AFTER_RENDER_LABEL="afterrenderlabel"})(rt||(rt={}));var Dt;(function(r){r.MOUSE_ENTER="plot:mouseenter",r.MOUSE_DOWN="plot:mousedown",r.MOUSE_MOVE="plot:mousemove",r.MOUSE_UP="plot:mouseup",r.MOUSE_LEAVE="plot:mouseleave",r.TOUCH_START="plot:touchstart",r.TOUCH_MOVE="plot:touchmove",r.TOUCH_END="plot:touchend",r.TOUCH_CANCEL="plot:touchcancel",r.CLICK="plot:click",r.DBLCLICK="plot:dblclick",r.CONTEXTMENU="plot:contextmenu",r.LEAVE="plot:leave",r.ENTER="plot:enter"})(Dt||(Dt={}));var Se;(function(r){r.ACTIVE="active",r.INACTIVE="inactive",r.SELECTED="selected",r.DEFAULT="default"})(Se||(Se={}));var _e=["color","shape","size"],ve="_origin",ne=1,xe=1,Je=.25,Ot={};function te(r){var e=Ot[r];if(!e)throw new Error("G engine '".concat(r,"' is not exist, please register it at first."));return e}function ft(r,e){Ot[r]=e}var wt=nt(71452),Y=nt(85306);function gt(r){var e=getComputedStyle(r);return{width:(r.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10),height:(r.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)}}function he(r){return typeof r=="number"&&!isNaN(r)}function Oe(r,e,t,i){var o=t,c=i;if(e){var p=gt(r);o=p.width?p.width:o,c=p.height?p.height:c}return{width:Math.max(he(o)?o:ne,ne),height:Math.max(he(c)?c:xe,xe)}}function Le(r){var e=r.parentNode;e&&e.removeChild(r)}var Ve=nt(42090),Bt=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this)||this;i.destroyed=!1;var o=t.visible,c=o===void 0?!0:o;return i.visible=c,i}return e.prototype.show=function(){var t=this.visible;t||this.changeVisible(!0)},e.prototype.hide=function(){var t=this.visible;t&&this.changeVisible(!1)},e.prototype.destroy=function(){this.off(),this.destroyed=!0},e.prototype.changeVisible=function(t){this.visible!==t&&(this.visible=t)},e}(Ve.Z),re=Bt,ye=nt(22479),Yt=0,qe=1/2,vr=1/2,oe=.05,qt=function(){function r(e){var t=e.xField,i=e.yField,o=e.adjustNames,c=o===void 0?["x","y"]:o,p=e.dimValuesMap;this.adjustNames=c,this.xField=t,this.yField=i,this.dimValuesMap=p}return r.prototype.isAdjust=function(e){return this.adjustNames.indexOf(e)>=0},r.prototype.getAdjustRange=function(e,t,i){var o=this.yField,c=i.indexOf(t),p=i.length,g,_;return!o&&this.isAdjust("y")?(g=0,_=1):p>1?(g=i[c===0?0:c-1],_=i[c===p-1?p-1:c+1],c!==0?g+=(t-g)/2:g-=(_-t)/2,c!==p-1?_-=(_-t)/2:_+=(t-i[p-2])/2):(g=t===0?0:t-.5,_=t===0?1:t+.5),{pre:g,next:_}},r.prototype.adjustData=function(e,t){var i=this,o=this.getDimValues(t);b.S6(e,function(c,p){b.S6(o,function(g,_){i.adjustDim(_,g,c,p)})})},r.prototype.groupData=function(e,t){return b.S6(e,function(i){i[t]===void 0&&(i[t]=Yt)}),b.vM(e,t)},r.prototype.adjustDim=function(e,t,i,o){},r.prototype.getDimValues=function(e){var t=this,i=t.xField,o=t.yField,c=b.f0({},this.dimValuesMap),p=[];if(i&&this.isAdjust("x")&&p.push(i),o&&this.isAdjust("y")&&p.push(o),p.forEach(function(_){c&&c[_]||(c[_]=b.I(e,_).sort(function(S,I){return S-I}))}),!o&&this.isAdjust("y")){var g="y";c[g]=[Yt,1]}return c},r}(),bt=qt,Wt={},$t=function(r){return Wt[r.toLowerCase()]},xt=function(r,e){if($t(r))throw new Error("Adjust type '"+r+"' existed.");Wt[r.toLowerCase()]=e},St=nt(4620),ue=nt.n(St);var Pe=function(e,t){return Pe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var c in o)o.hasOwnProperty(c)&&(i[c]=o[c])},Pe(e,t)};function ze(r,e){Pe(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Vt=function(){return Vt=Object.assign||function(t){for(var i,o=1,c=arguments.length;o<c;o++){i=arguments[o];for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&(t[p]=i[p])}return t},Vt.apply(this,arguments)};function Ct(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(r);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(r,i[o])&&(t[i[o]]=r[i[o]]);return t}function At(r,e,t,i){var o=arguments.length,c=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,p;if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,i);else for(var g=r.length-1;g>=0;g--)(p=r[g])&&(c=(o<3?p(c):o>3?p(e,t,c):p(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function Nt(r,e){return function(t,i){e(t,i,r)}}function tt(r,e){if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function vt(r,e,t,i){function o(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function g(I){try{S(i.next(I))}catch(L){p(L)}}function _(I){try{S(i.throw(I))}catch(L){p(L)}}function S(I){I.done?c(I.value):o(I.value).then(g,_)}S((i=i.apply(r,e||[])).next())})}function Ht(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,o,c,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(S){return function(I){return _([S,I])}}function _(S){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,o&&(c=S[0]&2?o.return:S[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,S[1])).done)return c;switch(o=0,c&&(S=[S[0]&2,c.value]),S[0]){case 0:case 1:c=S;break;case 4:return t.label++,{value:S[1],done:!1};case 5:t.label++,o=S[1],S=[0];continue;case 7:S=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(S[0]===6||S[0]===2)){t=0;continue}if(S[0]===3&&(!c||S[1]>c[0]&&S[1]<c[3])){t.label=S[1];break}if(S[0]===6&&t.label<c[1]){t.label=c[1],c=S;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(S);break}c[2]&&t.ops.pop(),t.trys.pop();continue}S=e.call(r,t)}catch(I){S=[6,I],o=0}finally{i=c=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}}function de(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function jt(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Ie(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function We(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),o,c=[],p;try{for(;(e===void 0||e-- >0)&&!(o=i.next()).done;)c.push(o.value)}catch(g){p={error:g}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(p)throw p.error}}return c}function Ke(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(We(arguments[e]));return r}function pr(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),o=0,e=0;e<t;e++)for(var c=arguments[e],p=0,g=c.length;p<g;p++,o++)i[o]=c[p];return i}function lr(r){return this instanceof lr?(this.v=r,this):new lr(r)}function Nr(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),o,c=[];return o={},p("next"),p("throw"),p("return"),o[Symbol.asyncIterator]=function(){return this},o;function p(F){i[F]&&(o[F]=function(z){return new Promise(function(V,Q){c.push([F,z,V,Q])>1||g(F,z)})})}function g(F,z){try{_(i[F](z))}catch(V){L(c[0][3],V)}}function _(F){F.value instanceof lr?Promise.resolve(F.value.v).then(S,I):L(c[0][2],F)}function S(F){g("next",F)}function I(F){g("throw",F)}function L(F,z){F(z),c.shift(),c.length&&g(c[0][0],c[0][1])}}function Pr(r){var e,t;return e={},i("next"),i("throw",function(o){throw o}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(o,c){e[o]=r[o]?function(p){return(t=!t)?{value:lr(r[o](p)),done:o==="return"}:c?c(p):p}:c}}function Gr(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Ie=="function"?Ie(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=r[c]&&function(p){return new Promise(function(g,_){p=r[c](p),o(g,_,p.done,p.value)})}}function o(c,p,g,_){Promise.resolve(_).then(function(S){c({value:S,done:g})},p)}}function Sn(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function nn(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Nn(r){return r&&r.__esModule?r:{default:r}}function Zn(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function Hn(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var An=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this;i.cacheMap={},i.adjustDataArray=[],i.mergeData=[];var o=t.marginRatio,c=o===void 0?qe:o,p=t.dodgeRatio,g=p===void 0?vr:p,_=t.dodgeBy,S=t.intervalPadding,I=t.dodgePadding,L=t.xDimensionLength,F=t.groupNum,z=t.defaultSize,V=t.maxColumnWidth,Q=t.minColumnWidth,st=t.columnWidthRatio,at=t.customOffset;return i.marginRatio=c,i.dodgeRatio=g,i.dodgeBy=_,i.intervalPadding=S,i.dodgePadding=I,i.xDimensionLegenth=L,i.groupNum=F,i.defaultSize=z,i.maxColumnWidth=V,i.minColumnWidth=Q,i.columnWidthRatio=st,i.customOffset=at,i}return e.prototype.process=function(t){var i=b.d9(t),o=b.xH(i),c=this.dodgeBy,p=c?b.ru(o,c):i;return this.cacheMap={},this.adjustDataArray=p,this.mergeData=o,this.adjustData(p,o),this.adjustDataArray=[],this.mergeData=[],i},e.prototype.adjustDim=function(t,i,o,c){var p=this,g=this.customOffset,_=this.getDistribution(t),S=this.groupData(o,t);return b.S6(S,function(I,L){var F;i.length===1?F={pre:i[0]-1,next:i[0]+1}:F=p.getAdjustRange(t,parseFloat(L),i),b.S6(I,function(z){var V=z[t],Q=_[V],st=Q.indexOf(c);if(b.UM(g))z[t]=p.getDodgeOffset(F,st,Q.length);else{var at=F.pre,Ft=F.next;z[t]=b.mf(g)?g(z,F):(at+Ft)/2+g}})}),[]},e.prototype.getDodgeOffset=function(t,i,o){var c=this,p=c.dodgeRatio,g=c.marginRatio,_=c.intervalPadding,S=c.dodgePadding,I=t.pre,L=t.next,F=L-I,z;if(!b.UM(_)&&b.UM(S)&&_>=0){var V=this.getIntervalOnlyOffset(o,i);z=I+V}else if(!b.UM(S)&&b.UM(_)&&S>=0){var V=this.getDodgeOnlyOffset(o,i);z=I+V}else if(!b.UM(_)&&!b.UM(S)&&_>=0&&S>=0){var V=this.getIntervalAndDodgeOffset(o,i);z=I+V}else{var Q=F*p/o,st=g*Q,V=1/2*(F-o*Q-(o-1)*st)+((i+1)*Q+i*st)-1/2*Q-1/2*F;z=(I+L)/2+V}return z},e.prototype.getIntervalOnlyOffset=function(t,i){var o=this,c=o.defaultSize,p=o.intervalPadding,g=o.xDimensionLegenth,_=o.groupNum,S=o.dodgeRatio,I=o.maxColumnWidth,L=o.minColumnWidth,F=o.columnWidthRatio,z=p/g,V=(1-(_-1)*z)/_*S/(t-1),Q=((1-z*(_-1))/_-V*(t-1))/t;if(Q=b.UM(F)?Q:1/_/t*F,!b.UM(I)){var st=I/g;Q=Math.min(Q,st)}if(!b.UM(L)){var at=L/g;Q=Math.max(Q,at)}Q=c?c/g:Q,V=((1-(_-1)*z)/_-t*Q)/(t-1);var Ft=((1/2+i)*Q+i*V+1/2*z)*_-z/2;return Ft},e.prototype.getDodgeOnlyOffset=function(t,i){var o=this,c=o.defaultSize,p=o.dodgePadding,g=o.xDimensionLegenth,_=o.groupNum,S=o.marginRatio,I=o.maxColumnWidth,L=o.minColumnWidth,F=o.columnWidthRatio,z=p/g,V=1*S/(_-1),Q=((1-V*(_-1))/_-z*(t-1))/t;if(Q=F?1/_/t*F:Q,!b.UM(I)){var st=I/g;Q=Math.min(Q,st)}if(!b.UM(L)){var at=L/g;Q=Math.max(Q,at)}Q=c?c/g:Q,V=(1-(Q*t+z*(t-1))*_)/(_-1);var Ft=((1/2+i)*Q+i*z+1/2*V)*_-V/2;return Ft},e.prototype.getIntervalAndDodgeOffset=function(t,i){var o=this,c=o.intervalPadding,p=o.dodgePadding,g=o.xDimensionLegenth,_=o.groupNum,S=c/g,I=p/g,L=((1-S*(_-1))/_-I*(t-1))/t,F=((1/2+i)*L+i*I+1/2*S)*_-S/2;return F},e.prototype.getDistribution=function(t){var i=this.adjustDataArray,o=this.cacheMap,c=o[t];return c||(c={},b.S6(i,function(p,g){var _=b.I(p,t);_.length||_.push(0),b.S6(_,function(S){c[S]||(c[S]=[]),c[S].push(g)})}),o[t]=c),c},e}(bt),$n=An;function Rt(r,e){return(e-r)*Math.random()+r}var Xt=function(r){ze(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.process=function(t){var i=b.d9(t),o=b.xH(i);return this.adjustData(i,o),i},e.prototype.adjustDim=function(t,i,o){var c=this,p=this.groupData(o,t);return b.S6(p,function(g,_){return c.adjustGroup(g,t,parseFloat(_),i)})},e.prototype.getAdjustOffset=function(t){var i=t.pre,o=t.next,c=(o-i)*oe;return Rt(i+c,o-c)},e.prototype.adjustGroup=function(t,i,o,c){var p=this,g=this.getAdjustRange(i,o,c);return b.S6(t,function(_){_[i]=p.getAdjustOffset(g)}),t},e}(bt),ae=Xt,we=b.Ct,Ge=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this,o=t.adjustNames,c=o===void 0?["y"]:o,p=t.height,g=p===void 0?NaN:p,_=t.size,S=_===void 0?10:_,I=t.reverseOrder,L=I===void 0?!1:I;return i.adjustNames=c,i.height=g,i.size=S,i.reverseOrder=L,i}return e.prototype.process=function(t){var i=this,o=i.yField,c=i.reverseOrder,p=o?this.processStack(t):this.processOneDimStack(t);return c?this.reverse(p):p},e.prototype.reverse=function(t){return t.slice(0).reverse()},e.prototype.processStack=function(t){var i=this,o=i.xField,c=i.yField,p=i.reverseOrder,g=p?this.reverse(t):t,_=new we,S=new we;return g.map(function(I){return I.map(function(L){var F,z=b.U2(L,o,0),V=b.U2(L,[c]),Q=z.toString();if(V=b.kJ(V)?V[1]:V,!b.UM(V)){var st=V>=0?_:S;st.has(Q)||st.set(Q,0);var at=st.get(Q),Ft=V+at;return st.set(Q,Ft),Vt(Vt({},L),(F={},F[c]=[at,Ft],F))}return L})})},e.prototype.processOneDimStack=function(t){var i=this,o=this,c=o.xField,p=o.height,g=o.reverseOrder,_="y",S=g?this.reverse(t):t,I=new we;return S.map(function(L){return L.map(function(F){var z,V=i.size,Q=F[c],st=V*2/p;I.has(Q)||I.set(Q,st/2);var at=I.get(Q);return I.set(Q,at+st),Vt(Vt({},F),(z={},z[_]=at,z))})})},e}(bt),cr=Ge,br=function(r){ze(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.process=function(t){var i=b.xH(t),o=this,c=o.xField,p=o.yField,g=this.getXValuesMaxMap(i),_=Math.max.apply(Math,Object.keys(g).map(function(S){return g[S]}));return b.UI(t,function(S){return b.UI(S,function(I){var L,F,z=I[p],V=I[c];if(b.kJ(z)){var Q=(_-g[V])/2;return Vt(Vt({},I),(L={},L[p]=b.UI(z,function(at){return Q+at}),L))}var st=(_-z)/2;return Vt(Vt({},I),(F={},F[p]=[st,z+st],F))})})},e.prototype.getXValuesMaxMap=function(t){var i=this,o=this,c=o.xField,p=o.yField,g=b.vM(t,function(_){return _[c]});return b.Q8(g,function(_){return i.getDimMaxValue(_,p)})},e.prototype.getDimMaxValue=function(t,i){var o=b.UI(t,function(p){return b.U2(p,i,[])}),c=b.xH(o);return Math.max.apply(Math,c)},e}(bt),Ce=br;xt("Dodge",$n),xt("Jitter",ae),xt("Stack",cr),xt("Symmetric",Ce);var ar=function(r,e){return(0,b.HD)(e)?e:r.invert(r.scale(e))},Hr=function(){function r(e){this.names=[],this.scales=[],this.linear=!1,this.values=[],this.callback=function(){return[]},this._parseCfg(e)}return r.prototype.mapping=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=t.map(function(c,p){return e._toOriginParam(c,e.scales[p])});return this.callback.apply(this,o)},r.prototype.getLinearValue=function(e){var t=this.values.length-1,i=Math.floor(t*e),o=t*e-i,c=this.values[i],p=i===t?c:this.values[i+1];return c+(p-c)*o},r.prototype.getNames=function(){for(var e=this.scales,t=this.names,i=Math.min(e.length,t.length),o=[],c=0;c<i;c+=1)o.push(t[c]);return o},r.prototype.getFields=function(){return this.scales.map(function(e){return e.field})},r.prototype.getScale=function(e){return this.scales[this.names.indexOf(e)]},r.prototype.defaultCallback=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.length===0?this.values:t.map(function(o,c){var p=e.scales[c];return p.type==="identity"?p.values[0]:e._getAttributeValue(p,o)})},r.prototype._parseCfg=function(e){var t=this,i=e.type,o=i===void 0?"base":i,c=e.names,p=c===void 0?[]:c,g=e.scales,_=g===void 0?[]:g,S=e.values,I=S===void 0?[]:S,L=e.callback;this.type=o,this.scales=_,this.values=I,this.names=p,this.callback=function(){for(var F=[],z=0;z<arguments.length;z++)F[z]=arguments[z];if(L){var V=L.apply(void 0,F);if(!(0,b.UM)(V))return[V]}return t.defaultCallback.apply(t,F)}},r.prototype._getAttributeValue=function(e,t){if(e.isCategory&&!this.linear){var i=e.translate(t);return this.values[i%this.values.length]}var o=e.scale(t);return this.getLinearValue(o)},r.prototype._toOriginParam=function(e,t){return t.isLinear?e:(0,b.kJ)(e)?e.map(function(i){return ar(t,i)}):ar(t,e)},r}(),Tn=Hr,Kr=/rgba?\(([\s.,0-9]+)\)/,an=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Pn=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,xi=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,Ci=function(r){return/^[r,R,L,l]{1}[\s]*\(/.test(r)},Qr=function(){var r=document.createElement("i");return r.title="Web Colour Picker",r.style.display="none",document.body.appendChild(r),r},Kn=function(r,e,t,i){return r[i]+(e[i]-r[i])*t};function ai(r){return"#"+oa(r[0])+oa(r[1])+oa(r[2])}var fi=function(r){return[parseInt(r.substr(1,2),16),parseInt(r.substr(3,2),16),parseInt(r.substr(5,2),16)]},oa=function(r){var e=Math.round(r).toString(16);return e.length===1?"0"+e:e},Ai=function(r,e){var t=isNaN(Number(e))||e<0?0:e>1?1:Number(e),i=r.length-1,o=Math.floor(i*t),c=i*t-o,p=r[o],g=o===i?p:r[o+1];return ai([Kn(p,g,c,0),Kn(p,g,c,1),Kn(p,g,c,2)])},Ca,po=function(r){if(r[0]==="#"&&r.length===7)return r;Ca||(Ca=Qr()),Ca.style.color=r;var e=document.defaultView.getComputedStyle(Ca,"").getPropertyValue("color"),t=Kr.exec(e),i=t[1].split(/\s*,\s*/).map(function(o){return Number(o)});return e=ai(i),e},La=function(r){var e=(0,b.HD)(r)?r.split("-"):r,t=(0,b.UI)(e,function(i){return fi(i.indexOf("#")===-1?po(i):i)});return function(i){return Ai(t,i)}},Va=function(r){if(Ci(r)){var e,t=void 0;if(r[0]==="l"){var i=an.exec(r),o=+i[1]+90;t=i[2],e="linear-gradient("+o+"deg, "}else if(r[0]==="r"){e="radial-gradient(";var i=Pn.exec(r);t=i[4]}var c=t.match(xi);return(0,b.S6)(c,function(p,g){var _=p.split(":");e+=_[1]+" "+_[0]*100+"%",g!==c.length-1&&(e+=", ")}),e+=")",e}return r},_a={rgb2arr:fi,gradient:La,toRGB:(0,b.HP)(po),toCSSGradient:Va},ma=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this;return i.type="color",i.names=["color"],(0,b.HD)(i.values)&&(i.linear=!0),i.gradient=_a.gradient(i.values),i}return e.prototype.getLinearValue=function(t){return this.gradient(t)},e}(Tn),Qa=ma,Uo=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this;return i.type="opacity",i.names=["opacity"],i}return e}(Tn),vo=Uo,Ua=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this;return i.names=["x","y"],i.type="position",i}return e.prototype.mapping=function(t,i){var o=this.scales,c=o[0],p=o[1];return(0,b.UM)(t)||(0,b.UM)(i)?[]:[(0,b.kJ)(t)?t.map(function(g){return c.scale(g)}):c.scale(t),(0,b.kJ)(i)?i.map(function(g){return p.scale(g)}):p.scale(i)]},e}(Tn),Xa=Ua,Oo=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this;return i.type="shape",i.names=["shape"],i}return e.prototype.getLinearValue=function(t){var i=Math.round((this.values.length-1)*t);return this.values[i]},e}(Tn),Du=Oo,Yo=function(r){ze(e,r);function e(t){var i=r.call(this,t)||this;return i.type="size",i.names=["size"],i}return e}(Tn),_o=Yo,ir={};function ge(r){return ir[r]}function He(r,e){ir[r]=e}var Ir=function(){function r(e){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=e,this.initCfg(),this.init()}return r.prototype.translate=function(e){return e},r.prototype.change=function(e){(0,b.f0)(this.__cfg__,e),this.init()},r.prototype.clone=function(){return this.constructor(this.__cfg__)},r.prototype.getTicks=function(){var e=this;return(0,b.UI)(this.ticks,function(t,i){return(0,b.Kn)(t)?t:{text:e.getText(t,i),tickValue:t,value:e.scale(t)}})},r.prototype.getText=function(e,t){var i=this.formatter,o=i?i(e,t):e;return(0,b.UM)(o)||!(0,b.mf)(o.toString)?"":o.toString()},r.prototype.getConfig=function(e){return this.__cfg__[e]},r.prototype.init=function(){(0,b.f0)(this,this.__cfg__),this.setDomain(),(0,b.xb)(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},r.prototype.initCfg=function(){},r.prototype.setDomain=function(){},r.prototype.calculateTicks=function(){var e=this.tickMethod,t=[];if((0,b.HD)(e)){var i=ge(e);if(!i)throw new Error("There is no method to to calculate ticks!");t=i(this)}else(0,b.mf)(e)&&(t=e(this));return t},r.prototype.rangeMin=function(){return this.range[0]},r.prototype.rangeMax=function(){return this.range[1]},r.prototype.calcPercent=function(e,t,i){return(0,b.hj)(e)?(e-t)/(i-t):NaN},r.prototype.calcValue=function(e,t,i){return t+e*(i-t)},r}(),en=Ir,On=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return e.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},e.prototype.translate=function(t){this.buildIndexMap();var i=this.translateIndexMap.get(t);return i===void 0&&(i=(0,b.hj)(t)?t:NaN),i},e.prototype.scale=function(t){var i=this.translate(t),o=this.calcPercent(i,this.min,this.max);return this.calcValue(o,this.rangeMin(),this.rangeMax())},e.prototype.invert=function(t){var i=this.max-this.min,o=this.calcPercent(t,this.rangeMin(),this.rangeMax()),c=Math.round(i*o)+this.min;return c<this.min||c>this.max?NaN:this.values[c]},e.prototype.getText=function(t){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var c=t;return(0,b.hj)(t)&&!this.values.includes(t)&&(c=this.values[c]),r.prototype.getText.apply(this,(0,P.pr)([c],i))},e.prototype.initCfg=function(){this.tickMethod="cat"},e.prototype.setDomain=function(){if((0,b.UM)(this.getConfig("min"))&&(this.min=0),(0,b.UM)(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},e}(en),zn=On,kn=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,qi="\\d\\d?",Oa="\\d\\d",us="\\d{3}",Ao="\\d{4}",Ho="[^\\s]+",uo=/\[([^]*?)\]/gm;function Zo(r,e){for(var t=[],i=0,o=r.length;i<o;i++)t.push(r[i].substr(0,e));return t}var Qs=function(r){return function(e,t){var i=t[r].map(function(c){return c.toLowerCase()}),o=i.indexOf(e.toLowerCase());return o>-1?o:null}};function jo(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var i=0,o=e;i<o.length;i++){var c=o[i];for(var p in c)r[p]=c[p]}return r}var _l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Hc=["January","February","March","April","May","June","July","August","September","October","November","December"],$u=Zo(Hc,3),Ae=Zo(_l,3),Xe={dayNamesShort:Ae,dayNames:_l,monthNamesShort:$u,monthNames:Hc,amPm:["am","pm"],DoFn:function(r){return r+["th","st","nd","rd"][r%10>3?0:(r-r%10!==10?1:0)*r%10]}},Cr=jo({},Xe),sn=function(r){return Cr=jo(Cr,r)},si=function(r){return r.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},Pi=function(r,e){for(e===void 0&&(e=2),r=String(r);r.length<e;)r="0"+r;return r},ja={D:function(r){return String(r.getDate())},DD:function(r){return Pi(r.getDate())},Do:function(r,e){return e.DoFn(r.getDate())},d:function(r){return String(r.getDay())},dd:function(r){return Pi(r.getDay())},ddd:function(r,e){return e.dayNamesShort[r.getDay()]},dddd:function(r,e){return e.dayNames[r.getDay()]},M:function(r){return String(r.getMonth()+1)},MM:function(r){return Pi(r.getMonth()+1)},MMM:function(r,e){return e.monthNamesShort[r.getMonth()]},MMMM:function(r,e){return e.monthNames[r.getMonth()]},YY:function(r){return Pi(String(r.getFullYear()),4).substr(2)},YYYY:function(r){return Pi(r.getFullYear(),4)},h:function(r){return String(r.getHours()%12||12)},hh:function(r){return Pi(r.getHours()%12||12)},H:function(r){return String(r.getHours())},HH:function(r){return Pi(r.getHours())},m:function(r){return String(r.getMinutes())},mm:function(r){return Pi(r.getMinutes())},s:function(r){return String(r.getSeconds())},ss:function(r){return Pi(r.getSeconds())},S:function(r){return String(Math.round(r.getMilliseconds()/100))},SS:function(r){return Pi(Math.round(r.getMilliseconds()/10),2)},SSS:function(r){return Pi(r.getMilliseconds(),3)},a:function(r,e){return r.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(r,e){return r.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+Pi(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+Pi(Math.floor(Math.abs(e)/60),2)+":"+Pi(Math.abs(e)%60,2)}},vs=function(r){return+r-1},$o=[null,qi],qo=[null,Ho],Js=["isPm",Ho,function(r,e){var t=r.toLowerCase();return t===e.amPm[0]?0:t===e.amPm[1]?1:null}],qu=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(r){var e=(r+"").match(/([+-]|\d\d)/gi);if(e){var t=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?t:-t}return 0}],yu={D:["day",qi],DD:["day",Oa],Do:["day",qi+Ho,function(r){return parseInt(r,10)}],M:["month",qi,vs],MM:["month",Oa,vs],YY:["year",Oa,function(r){var e=new Date,t=+(""+e.getFullYear()).substr(0,2);return+(""+(+r>68?t-1:t)+r)}],h:["hour",qi,void 0,"isPm"],hh:["hour",Oa,void 0,"isPm"],H:["hour",qi],HH:["hour",Oa],m:["minute",qi],mm:["minute",Oa],s:["second",qi],ss:["second",Oa],YYYY:["year",Ao],S:["millisecond","\\d",function(r){return+r*100}],SS:["millisecond",Oa,function(r){return+r*10}],SSS:["millisecond",us],d:$o,dd:$o,ddd:qo,dddd:qo,MMM:["month",Ho,Qs("monthNamesShort")],MMMM:["month",Ho,Qs("monthNames")],a:Js,A:Js,ZZ:qu,Z:qu},Zs={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},_u=function(r){return jo(Zs,r)},Ku=function(r,e,t){if(e===void 0&&(e=Zs.default),t===void 0&&(t={}),typeof r=="number"&&(r=new Date(r)),Object.prototype.toString.call(r)!=="[object Date]"||isNaN(r.getTime()))throw new Error("Invalid Date pass to format");e=Zs[e]||e;var i=[];e=e.replace(uo,function(c,p){return i.push(p),"@@@"});var o=jo(jo({},Cr),t);return e=e.replace(kn,function(c){return ja[c](r,o)}),e.replace(/@@@/g,function(){return i.shift()})};function Bu(r,e,t){if(t===void 0&&(t={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=Zs[e]||e,r.length>1e3)return null;var i=new Date,o={year:i.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},c=[],p=[],g=e.replace(uo,function(ee,Me){return p.push(si(Me)),"@@@"}),_={},S={};g=si(g).replace(kn,function(ee){var Me=yu[ee],hr=Me[0],Tr=Me[1],Dr=Me[3];if(_[hr])throw new Error("Invalid format. "+hr+" specified twice in format");return _[hr]=!0,Dr&&(S[Dr]=!0),c.push(Me),"("+Tr+")"}),Object.keys(S).forEach(function(ee){if(!_[ee])throw new Error("Invalid format. "+ee+" is required in specified format")}),g=g.replace(/@@@/g,function(){return p.shift()});var I=r.match(new RegExp(g,"i"));if(!I)return null;for(var L=jo(jo({},Cr),t),F=1;F<I.length;F++){var z=c[F-1],V=z[0],Q=z[2],st=Q?Q(I[F],L):+I[F];if(st==null)return null;o[V]=st}o.isPm===1&&o.hour!=null&&+o.hour!=12?o.hour=+o.hour+12:o.isPm===0&&+o.hour==12&&(o.hour=0);var at;if(o.timezoneOffset==null){at=new Date(o.year,o.month,o.day,o.hour,o.minute,o.second,o.millisecond);for(var Ft=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],F=0,Kt=Ft.length;F<Kt;F++)if(_[Ft[F][0]]&&o[Ft[F][0]]!==at[Ft[F][1]]())return null}else if(at=new Date(Date.UTC(o.year,o.month,o.day,o.hour,o.minute-o.timezoneOffset,o.second,o.millisecond)),o.month>11||o.month<0||o.day>31||o.day<1||o.hour>23||o.hour<0||o.minute>59||o.minute<0||o.second>59||o.second<0)return null;return at}var xl={format:Ku,parse:Bu,defaultI18n:Xe,setGlobalDateI18n:sn,setGlobalDateMasks:_u},Nu=xl;function Fo(r){return function(e,t,i,o){for(var c=(0,b.UM)(i)?0:i,p=(0,b.UM)(o)?e.length:o;c<p;){var g=c+p>>>1;r(e[g])>t?p=g:c=g+1}return c}}var Ts="format";function jc(r,e){var t=kt[Ts]||Nu[Ts];return t(r,e)}function Wc(r){return(0,b.HD)(r)&&(r.indexOf("T")>0?r=new Date(r).getTime():r=new Date(r.replace(/-/gi,"/")).getTime()),(0,b.J_)(r)&&(r=r.getTime()),r}var xu=1e3,Ms=60*xu,pl=60*Ms,Ga=24*pl,zu=Ga*31,Xc=Ga*365,D=[["HH:mm:ss",xu],["HH:mm:ss",xu*10],["HH:mm:ss",xu*30],["HH:mm",Ms],["HH:mm",Ms*10],["HH:mm",Ms*30],["HH",pl],["HH",pl*6],["HH",pl*12],["YYYY-MM-DD",Ga],["YYYY-MM-DD",Ga*4],["YYYY-WW",Ga*7],["YYYY-MM",zu],["YYYY-MM",zu*4],["YYYY-MM",zu*6],["YYYY",Ga*380]];function X(r,e,t){var i=(e-r)/t,o=Fo(function(p){return p[1]})(D,i)-1,c=D[o];return o<0?c=D[0]:o>=D.length&&(c=(0,b.Z$)(D)),c}var Mt=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="timeCat",t}return e.prototype.translate=function(t){t=Wc(t);var i=this.values.indexOf(t);return i===-1&&((0,b.hj)(t)&&t<this.values.length?i=t:i=NaN),i},e.prototype.getText=function(t,i){var o=this.translate(t);if(o>-1){var c=this.values[o],p=this.formatter;return c=p?p(c,i):jc(c,this.mask),c}return t},e.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},e.prototype.setDomain=function(){var t=this.values;(0,b.S6)(t,function(i,o){t[o]=Wc(i)}),t.sort(function(i,o){return i-o}),r.prototype.setDomain.call(this)},e}(zn),it=Mt,Jt=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isContinuous=!0,t}return e.prototype.scale=function(t){if((0,b.UM)(t))return NaN;var i=this.rangeMin(),o=this.rangeMax(),c=this.max,p=this.min;if(c===p)return i;var g=this.getScalePercent(t);return i+g*(o-i)},e.prototype.init=function(){r.prototype.init.call(this);var t=this.ticks,i=(0,b.YM)(t),o=(0,b.Z$)(t);i<this.min&&(this.min=i),o>this.max&&(this.max=o),(0,b.UM)(this.minLimit)||(this.min=i),(0,b.UM)(this.maxLimit)||(this.max=o)},e.prototype.setDomain=function(){var t=(0,b.rx)(this.values),i=t.min,o=t.max;(0,b.UM)(this.min)&&(this.min=i),(0,b.UM)(this.max)&&(this.max=o),this.min>this.max&&(this.min=i,this.max=o)},e.prototype.calculateTicks=function(){var t=this,i=r.prototype.calculateTicks.call(this);return this.nice||(i=(0,b.hX)(i,function(o){return o>=t.min&&o<=t.max})),i},e.prototype.getScalePercent=function(t){var i=this.max,o=this.min;return(t-o)/(i-o)},e.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},e}(en),Ue=Jt,yr=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return e.prototype.invert=function(t){var i=this.getInvertPercent(t);return this.min+i*(this.max-this.min)},e.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},e}(Ue),Br=yr;function zr(r,e){var t=Math.E,i;return e>=0?i=Math.pow(t,Math.log(e)/r):i=Math.pow(t,Math.log(-e)/r)*-1,i}function Cn(r,e){return r===1?1:Math.log(e)/Math.log(r)}function Vn(r,e,t){(0,b.UM)(t)&&(t=Math.max.apply(null,r));var i=t;return(0,b.S6)(r,function(o){o>0&&o<i&&(i=o)}),i===t&&(i=t/e),i>1&&(i=1),i}function Ki(r){var e=r.toString().split(/[eE]/),t=(e[0].split(".")[1]||"").length-+(e[1]||0);return t>0?t:0}function Ma(r,e){var t=Ki(r),i=Ki(e),o=Math.pow(10,Math.max(t,i));return(r*o+e*o)/o}var xa=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="log",t}return e.prototype.invert=function(t){var i=this.base,o=Cn(i,this.max),c=this.rangeMin(),p=this.rangeMax()-c,g,_=this.positiveMin;if(_){if(t===0)return 0;g=Cn(i,_/i);var S=1/(o-g)*p;if(t<S)return t/S*_}else g=Cn(i,this.min);var I=(t-c)/p,L=I*(o-g)+g;return Math.pow(i,L)},e.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},e.prototype.setDomain=function(){r.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");t===0&&(this.positiveMin=Vn(this.values,this.base,this.max))},e.prototype.getScalePercent=function(t){var i=this.max,o=this.min;if(i===o||t<=0)return 0;var c=this.base,p=this.positiveMin;p&&(o=p*1/c);var g;return t<p?g=t/p/(Cn(c,i)-Cn(c,o)):g=(Cn(c,t)-Cn(c,o))/(Cn(c,i)-Cn(c,o)),g},e}(Ue),lo=xa,Ro=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pow",t}return e.prototype.invert=function(t){var i=this.getInvertPercent(t),o=this.exponent,c=zr(o,this.max),p=zr(o,this.min),g=i*(c-p)+p,_=g>=0?1:-1;return Math.pow(g,o)*_},e.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},e.prototype.getScalePercent=function(t){var i=this.max,o=this.min;if(i===o)return 0;var c=this.exponent,p=(zr(c,t)-zr(c,o))/(zr(c,i)-zr(c,o));return p},e}(Ue),Io=Ro,fa=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="time",t}return e.prototype.getText=function(t,i){var o=this.translate(t),c=this.formatter;return c?c(o,i):jc(o,this.mask)},e.prototype.scale=function(t){var i=t;return((0,b.HD)(i)||(0,b.J_)(i))&&(i=this.translate(i)),r.prototype.scale.call(this,i)},e.prototype.translate=function(t){return Wc(t)},e.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},e.prototype.setDomain=function(){var t=this.values,i=this.getConfig("min"),o=this.getConfig("max");if((!(0,b.UM)(i)||!(0,b.hj)(i))&&(this.min=this.translate(this.min)),(!(0,b.UM)(o)||!(0,b.hj)(o))&&(this.max=this.translate(this.max)),t&&t.length){var c=[],p=1/0,g=p,_=0;(0,b.S6)(t,function(S){var I=Wc(S);if(isNaN(I))throw new TypeError("Invalid Time: "+S+" in time scale!");p>I?(g=p,p=I):g>I&&(g=I),_<I&&(_=I),c.push(I)}),t.length>1&&(this.minTickInterval=g-p),(0,b.UM)(i)&&(this.min=p),(0,b.UM)(o)&&(this.max=_)}},e}(Br),bu=fa,bl=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantize",t}return e.prototype.invert=function(t){var i=this.ticks,o=i.length,c=this.getInvertPercent(t),p=Math.floor(c*(o-1));if(p>=o-1)return(0,b.Z$)(i);if(p<0)return(0,b.YM)(i);var g=i[p],_=i[p+1],S=p/(o-1),I=(p+1)/(o-1);return g+(c-S)/(I-S)*(_-g)},e.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},e.prototype.calculateTicks=function(){var t=r.prototype.calculateTicks.call(this);return this.nice||((0,b.Z$)(t)!==this.max&&t.push(this.max),(0,b.YM)(t)!==this.min&&t.unshift(this.min)),t},e.prototype.getScalePercent=function(t){var i=this.ticks;if(t<(0,b.YM)(i))return 0;if(t>(0,b.Z$)(i))return 1;var o=0;return(0,b.S6)(i,function(c,p){if(t>=c)o=p;else return!1}),o/(i.length-1)},e}(Ue),Ic=bl,Yc=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantile",t}return e.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},e}(Ic),Fl=Yc,kc={};function Uu(r){return kc[r]}function js(r,e){if(Uu(r))throw new Error("type '"+r+"' existed.");kc[r]=e}var ce=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return e.prototype.calculateTicks=function(){return this.values},e.prototype.scale=function(t){return this.values[0]!==t&&(0,b.hj)(t)?t:this.range[0]},e.prototype.invert=function(t){var i=this.range;return t<i[0]||t>i[1]?NaN:this.values[0]},e}(en),or=ce;function Fr(r){var e=r.values,t=r.tickInterval,i=r.tickCount,o=r.showLast;if((0,b.hj)(t)){var c=(0,b.hX)(e,function(V,Q){return Q%t===0}),p=(0,b.Z$)(e);return o&&(0,b.Z$)(c)!==p&&c.push(p),c}var g=e.length,_=r.min,S=r.max;if((0,b.UM)(_)&&(_=0),(0,b.UM)(S)&&(S=e.length-1),!(0,b.hj)(i)||i>=g)return e.slice(_,S+1);if(i<=0||S<=0)return[];for(var I=i===1?g:Math.floor(g/(i-1)),L=[],F=_,z=0;z<i&&!(F>=S);z++)F=Math.min(_+z*I,S),z===i-1&&o?L.push(e[S]):L.push(e[F]);return L}function Xr(r){var e=r.min,t=r.max,i=r.nice,o=r.tickCount,c=new Eu;return c.domain([e,t]),i&&c.nice(o),c.ticks(o)}var xn=5,Ii=Math.sqrt(50),ra=Math.sqrt(10),Wa=Math.sqrt(2),Eu=function(){function r(){this._domain=[0,1]}return r.prototype.domain=function(e){return e?(this._domain=Array.from(e,Number),this):this._domain.slice()},r.prototype.nice=function(e){var t,i;e===void 0&&(e=xn);var o=this._domain.slice(),c=0,p=this._domain.length-1,g=this._domain[c],_=this._domain[p],S;return _<g&&(t=[_,g],g=t[0],_=t[1],i=[p,c],c=i[0],p=i[1]),S=Ya(g,_,e),S>0?(g=Math.floor(g/S)*S,_=Math.ceil(_/S)*S,S=Ya(g,_,e)):S<0&&(g=Math.ceil(g*S)/S,_=Math.floor(_*S)/S,S=Ya(g,_,e)),S>0?(o[c]=Math.floor(g/S)*S,o[p]=Math.ceil(_/S)*S,this.domain(o)):S<0&&(o[c]=Math.ceil(g*S)/S,o[p]=Math.floor(_*S)/S,this.domain(o)),this},r.prototype.ticks=function(e){return e===void 0&&(e=xn),Ws(this._domain[0],this._domain[this._domain.length-1],e||xn)},r}();function Ws(r,e,t){var i,o=-1,c,p,g;if(e=+e,r=+r,t=+t,r===e&&t>0)return[r];if((i=e<r)&&(c=r,r=e,e=c),(g=Ya(r,e,t))===0||!isFinite(g))return[];if(g>0)for(r=Math.ceil(r/g),e=Math.floor(e/g),p=new Array(c=Math.ceil(e-r+1));++o<c;)p[o]=(r+o)*g;else for(r=Math.floor(r*g),e=Math.ceil(e*g),p=new Array(c=Math.ceil(r-e+1));++o<c;)p[o]=(r-o)/g;return i&&p.reverse(),p}function Ya(r,e,t){var i=(e-r)/Math.max(0,t),o=Math.floor(Math.log(i)/Math.LN10),c=i/Math.pow(10,o);return o>=0?(c>=Ii?10:c>=ra?5:c>=Wa?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(c>=Ii?10:c>=ra?5:c>=Wa?2:1)}function Jl(r,e,t){var i;return t==="ceil"?i=Math.ceil(r/e):t==="floor"?i=Math.floor(r/e):i=Math.round(r/e),i*e}function $c(r,e,t){var i=Jl(r,t,"floor"),o=Jl(e,t,"ceil");i=(0,b.ri)(i,t),o=(0,b.ri)(o,t);for(var c=[],p=Math.max((o-i)/(Math.pow(2,12)-1),t),g=i;g<=o;g=g+p){var _=(0,b.ri)(g,p);c.push(_)}return{min:i,max:o,ticks:c}}function tc(r,e,t){var i,o=r.minLimit,c=r.maxLimit,p=r.min,g=r.max,_=r.tickCount,S=_===void 0?5:_,I=(0,b.UM)(o)?(0,b.UM)(e)?p:e:o,L=(0,b.UM)(c)?(0,b.UM)(t)?g:t:c;if(I>L&&(i=[I,L],L=i[0],I=i[1]),S<=2)return[I,L];for(var F=(L-I)/(S-1),z=[],V=0;V<S;V++)z.push(I+F*V);return z}function rd(r){var e=r.min,t=r.max,i=r.tickInterval,o=r.minLimit,c=r.maxLimit,p=Xr(r);return!(0,b.UM)(o)||!(0,b.UM)(c)?tc(r,(0,b.YM)(p),(0,b.Z$)(p)):i?$c(e,t,i).ticks:p}function zf(r){return Math.abs(r)<1e-15?r:parseFloat(r.toFixed(15))}var tv=[1,5,2,2.5,4,3],Ep=null,Uf=Number.EPSILON*100;function qc(r,e){return(r%e+e)%e}function Zf(r){return Math.round(r*1e12)/1e12}function Kc(r,e,t,i,o,c){var p=(0,b.dp)(e),g=(0,b.cq)(e,r),_=0,S=qc(i,c);return(S<Uf||c-S<Uf)&&i<=0&&o>=0&&(_=1),1-g/(p-1)-t+_}function Vf(r,e,t){var i=(0,b.dp)(e),o=(0,b.cq)(e,r),c=1;return 1-o/(i-1)-t+c}function fh(r,e,t,i,o,c){var p=(r-1)/(c-o),g=(e-1)/(Math.max(c,i)-Math.min(t,o));return 2-Math.max(p/g,g/p)}function Qc(r,e){return r>=e?2-(r-1)/(e-1):1}function Rl(r,e,t,i){var o=e-r;return 1-.5*(Math.pow(e-i,2)+Math.pow(r-t,2))/Math.pow(.1*o,2)}function wp(r,e,t){var i=e-r;if(t>i){var o=(t-i)/2;return 1-Math.pow(o,2)/Math.pow(.1*i,2)}return 1}function hh(){return 1}function Qu(r,e,t,i,o,c){t===void 0&&(t=5),i===void 0&&(i=!0),o===void 0&&(o=tv),c===void 0&&(c=[.25,.2,.5,.05]);var p=t<0?0:Math.round(t);if(Number.isNaN(r)||Number.isNaN(e)||typeof r!="number"||typeof e!="number"||!p)return{min:0,max:0,ticks:[]};if(e-r<1e-15||p===1)return{min:r,max:e,ticks:[r]};if(e-r>1e148){var g=t||5,_=(e-r)/g;return{min:r,max:e,ticks:Array(g).fill(null).map(function(ka,xo){return zf(r+_*xo)})}}for(var S={score:-2,lmin:0,lmax:0,lstep:0},I=1;I<1/0;){for(var L=0;L<o.length;L+=1){var F=o[L],z=Vf(F,o,I);if(c[0]*z+c[1]+c[2]+c[3]<S.score){I=1/0;break}for(var V=2;V<1/0;){var Q=Qc(V,p);if(c[0]*z+c[1]+c[2]*Q+c[3]<S.score)break;for(var st=(e-r)/(V+1)/I/F,at=Math.ceil(Math.log10(st));at<1/0;){var Ft=I*F*Math.pow(10,at),Kt=wp(r,e,Ft*(V-1));if(c[0]*z+c[1]*Kt+c[2]*Q+c[3]<S.score)break;var ee=Math.floor(e/Ft)*I-(V-1)*I,Me=Math.ceil(r/Ft)*I;if(ee<=Me)for(var g=Me-ee,hr=0;hr<=g;hr+=1){var Tr=ee+hr,Dr=Tr*(Ft/I),cn=Dr+Ft*(V-1),Jr=Ft,Mn=Kc(F,o,I,Dr,cn,Jr),mi=Rl(r,e,Dr,cn),da=fh(V,p,r,e,Dr,cn),Sa=hh(),eo=c[0]*Mn+c[1]*mi+c[2]*da+c[3]*Sa;eo>S.score&&(!i||Dr<=r&&cn>=e)&&(S.lmin=Dr,S.lmax=cn,S.lstep=Jr,S.score=eo)}at+=1}V+=1}}I+=1}var Gn=zf(S.lmax),Vi=zf(S.lmin),ua=zf(S.lstep),Xi=Math.floor(Zf((Gn-Vi)/ua))+1,ea=new Array(Xi);ea[0]=zf(Vi);for(var L=1;L<Xi;L++)ea[L]=zf(ea[L-1]+ua);return{min:Math.min(r,(0,b.YM)(ea)),max:Math.max(e,(0,b.Z$)(ea)),ticks:ea}}function Jc(r){var e=r.min,t=r.max,i=r.tickCount,o=r.nice,c=r.tickInterval,p=r.minLimit,g=r.maxLimit,_=Qu(e,t,i,o).ticks;return!(0,b.UM)(p)||!(0,b.UM)(g)?tc(r,(0,b.YM)(_),(0,b.Z$)(_)):c?$c(e,t,c).ticks:_}function Zh(r){var e=r.base,t=r.tickCount,i=r.min,o=r.max,c=r.values,p,g=Cn(e,o);if(i>0)p=Math.floor(Cn(e,i));else{var _=Vn(c,e,o);p=Math.floor(Cn(e,_))}for(var S=g-p,I=Math.ceil(S/t),L=[],F=p;F<g+I;F=F+I)L.push(Math.pow(e,F));return i<=0&&L.unshift(0),L}function Gf(r,e,t){if(t===void 0&&(t=5),r===e)return{max:e,min:r,ticks:[r]};var i=t<0?0:Math.round(t);if(i===0)return{max:e,min:r,ticks:[]};var o=1.5,c=.5+1.5*o,p=e-r,g=p/i,_=Math.pow(10,Math.floor(Math.log10(g))),S=_;2*_-g<o*(g-S)&&(S=2*_,5*_-g<c*(g-S)&&(S=5*_,10*_-g<o*(g-S)&&(S=10*_)));for(var I=Math.ceil(e/S),L=Math.floor(r/S),F=Math.max(I*S,e),z=Math.min(L*S,r),V=Math.floor((F-z)/S)+1,Q=new Array(V),st=0;st<V;st++)Q[st]=zf(z+st*S);return{min:z,max:F,ticks:Q}}function ec(r){var e=r.exponent,t=r.tickCount,i=Math.ceil(zr(e,r.max)),o=Math.floor(zr(e,r.min)),c=Gf(o,i,t).ticks;return c.map(function(p){var g=p>=0?1:-1;return Math.pow(p,e)*g})}function Sp(r,e){var t=r.length*e;return e===1?r[r.length-1]:e===0?r[0]:t%1!==0?r[Math.ceil(t)-1]:r.length%2===0?(r[t-1]+r[t])/2:r[t]}function nd(r){var e=r.tickCount,t=r.values;if(!t||!t.length)return[];for(var i=t.slice().sort(function(g,_){return g-_}),o=[],c=0;c<e;c++){var p=c/(e-1);o.push(Sp(i,p))}return o}function Cp(r){var e=r.min,t=r.max,i=r.tickCount,o=r.tickInterval,c=r.minLimit,p=r.maxLimit,g=Gf(e,t,i).ticks;return!(0,b.UM)(c)||!(0,b.UM)(p)?tc(r,(0,b.YM)(g),(0,b.Z$)(g)):o?$c(e,t,o).ticks:g}function rc(r){var e=r.min,t=r.max,i=r.minTickInterval,o=r.tickInterval,c=r.tickCount;if(o)c=Math.ceil((t-e)/o);else{o=X(e,t,c)[1];var p=(t-e)/o,g=p/c;g>1&&(o=o*Math.ceil(g)),i&&o<i&&(o=i)}o=Math.max(Math.floor((t-e)/(Math.pow(2,12)-1)),o);for(var _=[],S=e;S<t+o;S+=o)_.push(S);return _}function id(r){var e=Fr((0,P.pi)({showLast:!0},r));return e}function tf(r){return new Date(r).getFullYear()}function Hf(r){return new Date(r,0,1).getTime()}function gf(r){return new Date(r).getMonth()}function ad(r,e){var t=tf(r),i=tf(e),o=gf(r),c=gf(e);return(i-t)*12+(c-o)%12}function od(r,e){return new Date(r,e,1).getTime()}function mf(r,e){return Math.ceil((e-r)/Ga)}function $v(r,e){return Math.ceil((e-r)/pl)}function ph(r,e){return Math.ceil((e-r)/(60*1e3))}function gs(r){var e=r.min,t=r.max,i=r.minTickInterval,o=r.tickCount,c=r.tickInterval,p=[];c||(c=(t-e)/o,i&&c<i&&(c=i)),c=Math.max(Math.floor((t-e)/(Math.pow(2,12)-1)),c);var g=tf(e);if(c>Xc)for(var _=tf(t),S=Math.ceil(c/Xc),I=g;I<=_+S;I=I+S)p.push(Hf(I));else if(c>zu)for(var L=Math.ceil(c/zu),F=gf(e),z=ad(e,t),I=0;I<=z+L;I=I+L)p.push(od(g,I+F));else if(c>Ga)for(var V=new Date(e),Q=V.getFullYear(),st=V.getMonth(),at=V.getDate(),Ft=Math.ceil(c/Ga),Kt=mf(e,t),I=0;I<Kt+Ft;I=I+Ft)p.push(new Date(Q,st,at+I).getTime());else if(c>pl)for(var V=new Date(e),Q=V.getFullYear(),st=V.getMonth(),Ft=V.getDate(),ee=V.getHours(),Me=Math.ceil(c/pl),hr=$v(e,t),I=0;I<=hr+Me;I=I+Me)p.push(new Date(Q,st,Ft,ee+I).getTime());else if(c>Ms)for(var Tr=ph(e,t),Dr=Math.ceil(c/Ms),I=0;I<=Tr+Dr;I=I+Dr)p.push(e+I*Ms);else{var cn=c;cn<xu&&(cn=xu);for(var Jr=Math.floor(e/xu)*xu,Mn=Math.ceil((t-e)/xu),mi=Math.ceil(cn/xu),I=0;I<Mn+mi;I=I+mi)p.push(Jr+I*xu)}return p.length>=512&&console.warn("Notice: current ticks length("+p.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+c+") is too small, increase the value to solve the problem!"),p}He("cat",Fr),He("time-cat",id),He("wilkinson-extended",Jc),He("r-pretty",Cp),He("time",rc),He("time-pretty",gs),He("log",Zh),He("pow",ec),He("quantile",nd),He("d3-linear",rd),js("cat",zn),js("category",zn),js("identity",or),js("linear",Br),js("log",lo),js("pow",Io),js("time",bu),js("timeCat",it),js("quantize",Ic),js("quantile",Fl);var yf={},jf=function(r){return yf[r.toLowerCase()]},Dl=function(r,e){if(jf(r))throw new Error("Attribute type '"+r+"' existed.");yf[r.toLowerCase()]=e};Dl("Color",Qa),Dl("Opacity",vo),Dl("Position",Xa),Dl("Shape",Du),Dl("Size",_o);var Ja=nt(68072),Wo=nt(99250),ro=nt(32071),Ap=function(){function r(e){this.type="coordinate",this.isRect=!1,this.isHelix=!1,this.isPolar=!1,this.isReflectX=!1,this.isReflectY=!1;var t=e.start,i=e.end,o=e.matrix,c=o===void 0?[1,0,0,0,1,0,0,0,1]:o,p=e.isTransposed,g=p===void 0?!1:p;this.start=t,this.end=i,this.matrix=c,this.originalMatrix=(0,P.ev)([],c),this.isTransposed=g}return r.prototype.initial=function(){this.center={x:(this.start.x+this.end.x)/2,y:(this.start.y+this.end.y)/2},this.width=Math.abs(this.end.x-this.start.x),this.height=Math.abs(this.end.y-this.start.y)},r.prototype.update=function(e){(0,b.f0)(this,e),this.initial()},r.prototype.convertDim=function(e,t){var i,o=this[t],c=o.start,p=o.end;return this.isReflect(t)&&(i=[p,c],c=i[0],p=i[1]),c+e*(p-c)},r.prototype.invertDim=function(e,t){var i,o=this[t],c=o.start,p=o.end;return this.isReflect(t)&&(i=[p,c],c=i[0],p=i[1]),(e-c)/(p-c)},r.prototype.applyMatrix=function(e,t,i){i===void 0&&(i=0);var o=this.matrix,c=[e,t,i];return Ja.transformMat3(c,c,o),c},r.prototype.invertMatrix=function(e,t,i){i===void 0&&(i=0);var o=this.matrix,c=Wo.U_([0,0,0,0,0,0,0,0,0],o),p=[e,t,i];return c&&Ja.transformMat3(p,p,c),p},r.prototype.convert=function(e){var t=this.convertPoint(e),i=t.x,o=t.y,c=this.applyMatrix(i,o,1);return{x:c[0],y:c[1]}},r.prototype.invert=function(e){var t=this.invertMatrix(e.x,e.y,1);return this.invertPoint({x:t[0],y:t[1]})},r.prototype.rotate=function(e){var t=this.matrix,i=this.center;return ro.m$(t,t,[-i.x,-i.y]),ro.zu(t,t,e),ro.m$(t,t,[i.x,i.y]),this},r.prototype.reflect=function(e){return e==="x"?this.isReflectX=!this.isReflectX:this.isReflectY=!this.isReflectY,this},r.prototype.scale=function(e,t){var i=this.matrix,o=this.center;return ro.m$(i,i,[-o.x,-o.y]),ro.lh(i,i,[e,t]),ro.m$(i,i,[o.x,o.y]),this},r.prototype.translate=function(e,t){var i=this.matrix;return ro.m$(i,i,[e,t]),this},r.prototype.transpose=function(){return this.isTransposed=!this.isTransposed,this},r.prototype.getCenter=function(){return this.center},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRadius=function(){return this.radius},r.prototype.isReflect=function(e){return e==="x"?this.isReflectX:this.isReflectY},r.prototype.resetMatrix=function(e){this.matrix=e||(0,P.ev)([],this.originalMatrix)},r}(),Bl=Ap,Tp=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.isRect=!0,i.type="cartesian",i.initial(),i}return e.prototype.initial=function(){r.prototype.initial.call(this);var t=this.start,i=this.end;this.x={start:t.x,end:i.x},this.y={start:t.y,end:i.y}},e.prototype.convertPoint=function(t){var i,o=t.x,c=t.y;return this.isTransposed&&(i=[c,o],o=i[0],c=i[1]),{x:this.convertDim(o,"x"),y:this.convertDim(c,"y")}},e.prototype.invertPoint=function(t){var i,o=this.invertDim(t.x,"x"),c=this.invertDim(t.y,"y");return this.isTransposed&&(i=[c,o],o=i[0],c=i[1]),{x:o,y:c}},e}(Bl),qv=Tp,Ia=nt(1153),Wf=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.isHelix=!0,i.type="helix";var o=t.startAngle,c=o===void 0?1.25*Math.PI:o,p=t.endAngle,g=p===void 0?7.25*Math.PI:p,_=t.innerRadius,S=_===void 0?0:_,I=t.radius;return i.startAngle=c,i.endAngle=g,i.innerRadius=S,i.radius=I,i.initial(),i}return e.prototype.initial=function(){r.prototype.initial.call(this);var t=(this.endAngle-this.startAngle)/(2*Math.PI)+1,i=Math.min(this.width,this.height)/2;this.radius&&this.radius>=0&&this.radius<=1&&(i=i*this.radius),this.d=Math.floor(i*(1-this.innerRadius)/t),this.a=this.d/(Math.PI*2),this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*i,end:this.innerRadius*i+this.d*.99}},e.prototype.convertPoint=function(t){var i,o=t.x,c=t.y;this.isTransposed&&(i=[c,o],o=i[0],c=i[1]);var p=this.convertDim(o,"x"),g=this.a*p,_=this.convertDim(c,"y");return{x:this.center.x+Math.cos(p)*(g+_),y:this.center.y+Math.sin(p)*(g+_)}},e.prototype.invertPoint=function(t){var i,o=this.d+this.y.start,c=Ia.$X([0,0],[t.x,t.y],[this.center.x,this.center.y]),p=ro.Dg(c,[1,0],!0),g=p*this.a;Ia.kE(c)<g&&(g=Ia.kE(c));var _=Math.floor((Ia.kE(c)-g)/o);p=2*_*Math.PI+p;var S=this.a*p,I=Ia.kE(c)-S;I=(0,b.vQ)(I,0)?0:I;var L=this.invertDim(p,"x"),F=this.invertDim(I,"y");return L=(0,b.vQ)(L,0)?0:L,F=(0,b.vQ)(F,0)?0:F,this.isTransposed&&(i=[F,L],L=i[0],F=i[1]),{x:L,y:F}},e}(Bl),ef=Wf,_f=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.isPolar=!0,i.type="polar";var o=t.startAngle,c=o===void 0?-Math.PI/2:o,p=t.endAngle,g=p===void 0?Math.PI*3/2:p,_=t.innerRadius,S=_===void 0?0:_,I=t.radius;return i.startAngle=c,i.endAngle=g,i.innerRadius=S,i.radius=I,i.initial(),i}return e.prototype.initial=function(){for(r.prototype.initial.call(this);this.endAngle<this.startAngle;)this.endAngle+=Math.PI*2;var t=this.getOneBox(),i=t.maxX-t.minX,o=t.maxY-t.minY,c=Math.abs(t.minX)/i,p=Math.abs(t.minY)/o,g;this.height/o>this.width/i?(g=this.width/i,this.circleCenter={x:this.center.x-(.5-c)*this.width,y:this.center.y-(.5-p)*g*o}):(g=this.height/o,this.circleCenter={x:this.center.x-(.5-c)*g*i,y:this.center.y-(.5-p)*this.height}),this.polarRadius=this.radius,this.radius?this.radius>0&&this.radius<=1?this.polarRadius=g*this.radius:(this.radius<=0||this.radius>g)&&(this.polarRadius=g):this.polarRadius=g,this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*this.polarRadius,end:this.polarRadius}},e.prototype.getRadius=function(){return this.polarRadius},e.prototype.convertPoint=function(t){var i,o=this.getCenter(),c=t.x,p=t.y;return this.isTransposed&&(i=[p,c],c=i[0],p=i[1]),c=this.convertDim(c,"x"),p=this.convertDim(p,"y"),{x:o.x+Math.cos(c)*p,y:o.y+Math.sin(c)*p}},e.prototype.invertPoint=function(t){var i,o=this.getCenter(),c=[t.x-o.x,t.y-o.y],p=this,g=p.startAngle,_=p.endAngle;this.isReflect("x")&&(i=[_,g],g=i[0],_=i[1]);var S=[1,0,0,0,1,0,0,0,1];ro.zu(S,S,g);var I=[1,0,0];Ja.transformMat3(I,I,S);var L=[I[0],I[1]],F=ro.Dg(L,c,_<g);(0,b.vQ)(F,Math.PI*2)&&(F=0);var z=Ia.kE(c),V=F/(_-g);V=_-g>0?V:-V;var Q=this.invertDim(z,"y"),st={x:0,y:0};return st.x=this.isTransposed?Q:V,st.y=this.isTransposed?V:Q,st},e.prototype.getCenter=function(){return this.circleCenter},e.prototype.getOneBox=function(){var t=this.startAngle,i=this.endAngle;if(Math.abs(i-t)>=Math.PI*2)return{minX:-1,maxX:1,minY:-1,maxY:1};for(var o=[0,Math.cos(t),Math.cos(i)],c=[0,Math.sin(t),Math.sin(i)],p=Math.min(t,i);p<Math.max(t,i);p+=Math.PI/18)o.push(Math.cos(p)),c.push(Math.sin(p));return{minX:Math.min.apply(Math,o),maxX:Math.max.apply(Math,o),minY:Math.min.apply(Math,c),maxY:Math.max.apply(Math,c)}},e}(Bl),tu=_f,dh={},vh=function(r){return dh[r.toLowerCase()]},Fs=function(r,e){dh[r.toLowerCase()]=e};Fs("rect",qv),Fs("cartesian",qv),Fs("polar",tu),Fs("helix",ef);function ji(r,e,t){var i=new ye.Event(e,t);i.target=r,i.propagationPath.push(r),r.emitDelegation(e,i);for(var o=r.getParent();o;)o.emitDelegation(e,i),i.propagationPath.push(o),o=o.getParent()}var _s=[1,0,0,0,1,0,0,0,1];function El(r,e,t){if(t===void 0&&(t=_s),!e)return null;var i=ro.vs(t,[["t",-r.x,-r.y],["r",e],["t",r.x,r.y]]);return i}function Nl(r,e){return!r.x&&!r.y?null:ro.vs(e||_s,[["t",r.x,r.y]])}function vc(r){var e=[1,0,0],t=[0,0,0];return Ja.transformMat3(t,e,r),Math.atan2(t[1],t[0])}function Zu(r,e){var t=[0,0];return Ia.kK(t,e,r),t}function sd(r,e){var t=Zu(r,[e.minX,e.minY]),i=Zu(r,[e.maxX,e.minY]),o=Zu(r,[e.minX,e.maxY]),c=Zu(r,[e.maxX,e.maxY]),p=Math.min(t[0],i[0],o[0],c[0]),g=Math.max(t[0],i[0],o[0],c[0]),_=Math.min(t[1],i[1],o[1],c[1]),S=Math.max(t[1],i[1],o[1],c[1]);return{x:p,y:_,minX:p,minY:_,maxX:g,maxY:S,width:g-p,height:S-_}}function Ti(r,e,t,i){if(e){var o=El({x:t,y:i},e,r.getMatrix());r.setMatrix(o)}}function Xf(r,e,t){var i=Nl({x:e,y:t});r.attr("matrix",i)}function gh(r){var e=0,t=0,i=0,o=0;return(0,b.hj)(r)?e=t=i=o=r:(0,b.kJ)(r)&&(e=r[0],i=(0,b.UM)(r[1])?r[0]:r[1],o=(0,b.UM)(r[2])?r[0]:r[2],t=(0,b.UM)(r[3])?i:r[3]),[e,i,o,t]}function rf(r){for(var e=r.childNodes,t=e.length,i=t-1;i>=0;i--)r.removeChild(e[i])}function es(r,e){return!!r.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function wu(r){var e=r.start,t=r.end,i=Math.min(e.x,t.x),o=Math.min(e.y,t.y),c=Math.max(e.x,t.x),p=Math.max(e.y,t.y);return{x:i,y:o,minX:i,minY:o,maxX:c,maxY:p,width:c-i,height:p-o}}function xf(r){var e=r.map(function(g){return g.x}),t=r.map(function(g){return g.y}),i=Math.min.apply(Math,e),o=Math.min.apply(Math,t),c=Math.max.apply(Math,e),p=Math.max.apply(Math,t);return{x:i,y:o,minX:i,minY:o,maxX:c,maxY:p,width:c-i,height:p-o}}function wl(r,e,t,i){var o=r+t,c=e+i;return{x:r,y:e,width:t,height:i,minX:r,minY:e,maxX:isNaN(o)?0:o,maxY:isNaN(c)?0:c}}function eu(r,e,t){return(1-t)*r+e*t}function nl(r,e,t){return{x:r.x+Math.cos(t)*e,y:r.y+Math.sin(t)*e}}function Kv(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}var Vh=function(r){return new Promise(function(e){setTimeout(e,r)})},bf=function(r,e,t){return t===void 0&&(t=Math.pow(Number.EPSILON,.5)),[r,e].includes(1/0)?Math.abs(r)===Math.abs(e):Math.abs(r-e)<t};function ev(r,e){var t=Math.max(r.minX,e.minX),i=Math.max(r.minY,e.minY),o=Math.min(r.maxX,e.maxX),c=Math.min(r.maxY,e.maxY);return wl(t,i,o-t,c-i)}function nc(r,e){var t=Math.min(r.minX,e.minX),i=Math.min(r.minY,e.minY),o=Math.max(r.maxX,e.maxX),c=Math.max(r.maxY,e.maxY);return wl(t,i,o-t,c-i)}function dl(r){var e=r.getClip(),t=e&&e.getBBox(),i;if(!r.isGroup())i=r.getBBox();else{var o=1/0,c=-1/0,p=1/0,g=-1/0,_=r.getChildren();_.length>0?(0,b.S6)(_,function(S){if(S.get("visible")){if(S.isGroup()&&S.get("children").length===0)return!0;var I=dl(S),L=S.applyToMatrix([I.minX,I.minY,1]),F=S.applyToMatrix([I.minX,I.maxY,1]),z=S.applyToMatrix([I.maxX,I.minY,1]),V=S.applyToMatrix([I.maxX,I.maxY,1]),Q=Math.min(L[0],F[0],z[0],V[0]),st=Math.max(L[0],F[0],z[0],V[0]),at=Math.min(L[1],F[1],z[1],V[1]),Ft=Math.max(L[1],F[1],z[1],V[1]);Q<o&&(o=Q),st>c&&(c=st),at<p&&(p=at),Ft>g&&(g=Ft)}}):(o=0,c=0,p=0,g=0),i=wl(o,p,c-o,g-p)}return t?ev(i,t):i}function to(r,e){if(!(!r.getClip()&&!e.getClip())){var t=e.getClip();if(!t){r.setClip(null);return}var i={type:t.get("type"),attrs:t.attr()};r.setClip(i)}}function mo(r){return r+"px"}function ic(r,e,t,i){var o=Kv(r,e),c=i/o,p=0;return t==="start"?p=0-c:t==="end"&&(p=1+c),{x:eu(r.x,e.x,p),y:eu(r.y,e.y,p)}}var Xs={none:[],point:["x","y"],region:["start","end"],points:["points"],circle:["center","radius","startAngle","endAngle"]},Yf=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.initCfg(),i}return e.prototype.getDefaultCfg=function(){return{id:"",name:"",type:"",locationType:"none",offsetX:0,offsetY:0,animate:!1,capture:!0,updateAutoRender:!1,animateOption:{appear:null,update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},events:null,defaultCfg:{},visible:!0}},e.prototype.clear=function(){},e.prototype.update=function(t){var i=this,o=this.get("defaultCfg")||{};(0,b.S6)(t,function(c,p){var g=i.get(p),_=c;g!==c&&((0,b.Kn)(c)&&o[p]&&(_=(0,b.b$)({},o[p],c)),i.set(p,_))}),this.updateInner(t),this.afterUpdate(t)},e.prototype.updateInner=function(t){},e.prototype.afterUpdate=function(t){(0,b.wH)(t,"visible")&&(t.visible?this.show():this.hide()),(0,b.wH)(t,"capture")&&this.setCapture(t.capture)},e.prototype.getLayoutBBox=function(){return this.getBBox()},e.prototype.getLocationType=function(){return this.get("locationType")},e.prototype.getOffset=function(){return{offsetX:this.get("offsetX"),offsetY:this.get("offsetY")}},e.prototype.setOffset=function(t,i){this.update({offsetX:t,offsetY:i})},e.prototype.setLocation=function(t){var i=(0,P.pi)({},t);this.update(i)},e.prototype.getLocation=function(){var t=this,i={},o=this.get("locationType"),c=Xs[o];return(0,b.S6)(c,function(p){i[p]=t.get(p)}),i},e.prototype.isList=function(){return!1},e.prototype.isSlider=function(){return!1},e.prototype.init=function(){},e.prototype.initCfg=function(){var t=this,i=this.get("defaultCfg");(0,b.S6)(i,function(o,c){var p=t.get(c);if((0,b.Kn)(p)){var g=(0,b.b$)({},o,p);t.set(c,g)}})},e}(ye.Base),nf=Yf,Su="update_status",fu=["visible","tip","delegateObject"],Sl=["container","group","shapesMap","isRegister","isUpdating","destroyed"],Qi=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{container:null,shapesMap:{},group:null,capture:!0,isRegister:!1,isUpdating:!1,isInit:!0})},e.prototype.remove=function(){this.clear();var t=this.get("group");t.remove()},e.prototype.clear=function(){var t=this.get("group");t.clear(),this.set("shapesMap",{}),this.clearOffScreenCache(),this.set("isInit",!0)},e.prototype.getChildComponentById=function(t){var i=this.getElementById(t),o=i&&i.get("component");return o},e.prototype.getElementById=function(t){return this.get("shapesMap")[t]},e.prototype.getElementByLocalId=function(t){var i=this.getElementId(t);return this.getElementById(i)},e.prototype.getElementsByName=function(t){var i=[];return(0,b.S6)(this.get("shapesMap"),function(o){o.get("name")===t&&i.push(o)}),i},e.prototype.getContainer=function(){return this.get("container")},e.prototype.updateInner=function(t){this.offScreenRender(),this.get("updateAutoRender")&&this.render()},e.prototype.render=function(){var t=this.get("offScreenGroup");t||(t=this.offScreenRender());var i=this.get("group");this.updateElements(t,i),this.deleteElements(),this.applyOffset(),this.get("eventInitted")||(this.initEvent(),this.set("eventInitted",!0)),this.set("isInit",!1)},e.prototype.show=function(){var t=this.get("group");t.show(),this.set("visible",!0)},e.prototype.hide=function(){var t=this.get("group");t.hide(),this.set("visible",!1)},e.prototype.setCapture=function(t){var i=this.get("group");i.set("capture",t),this.set("capture",t)},e.prototype.destroy=function(){this.removeEvent(),this.remove(),r.prototype.destroy.call(this)},e.prototype.getBBox=function(){return this.get("group").getCanvasBBox()},e.prototype.getLayoutBBox=function(){var t=this.get("group"),i=this.getInnerLayoutBBox(),o=t.getTotalMatrix();return o&&(i=sd(o,i)),i},e.prototype.on=function(t,i,o){var c=this.get("group");return c.on(t,i,o),this},e.prototype.off=function(t,i){var o=this.get("group");return o&&o.off(t,i),this},e.prototype.emit=function(t,i){var o=this.get("group");o.emit(t,i)},e.prototype.init=function(){r.prototype.init.call(this),this.get("group")||this.initGroup(),this.offScreenRender()},e.prototype.getInnerLayoutBBox=function(){return this.get("offScreenBBox")||this.get("group").getBBox()},e.prototype.delegateEmit=function(t,i){var o=this.get("group");i.target=o,o.emit(t,i),ji(o,t,i)},e.prototype.createOffScreenGroup=function(){var t=this.get("group"),i=t.getGroupBase(),o=new i({delegateObject:this.getDelegateObject()});return o},e.prototype.applyOffset=function(){var t=this.get("offsetX"),i=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t,y:i})},e.prototype.initGroup=function(){var t=this.get("container");this.set("group",t.addGroup({id:this.get("id"),name:this.get("name"),capture:this.get("capture"),visible:this.get("visible"),isComponent:!0,component:this,delegateObject:this.getDelegateObject()}))},e.prototype.offScreenRender=function(){this.clearOffScreenCache();var t=this.createOffScreenGroup();return this.renderInner(t),this.set("offScreenGroup",t),this.set("offScreenBBox",dl(t)),t},e.prototype.addGroup=function(t,i){this.appendDelegateObject(t,i);var o=t.addGroup(i);return this.get("isRegister")&&this.registerElement(o),o},e.prototype.addShape=function(t,i){this.appendDelegateObject(t,i);var o=t.addShape(i);return this.get("isRegister")&&this.registerElement(o),o},e.prototype.addComponent=function(t,i){var o=i.id,c=i.component,p=(0,P._T)(i,["id","component"]),g=new c((0,P.pi)((0,P.pi)({},p),{id:o,container:t,updateAutoRender:this.get("updateAutoRender")}));return g.init(),g.render(),this.get("isRegister")&&this.registerElement(g.get("group")),g},e.prototype.initEvent=function(){},e.prototype.removeEvent=function(){var t=this.get("group");t.off()},e.prototype.getElementId=function(t){var i=this.get("id"),o=this.get("name");return i+"-"+o+"-"+t},e.prototype.registerElement=function(t){var i=t.get("id");this.get("shapesMap")[i]=t},e.prototype.unregisterElement=function(t){var i=t.get("id");delete this.get("shapesMap")[i]},e.prototype.moveElementTo=function(t,i){var o=Nl(i);t.attr("matrix",o)},e.prototype.addAnimation=function(t,i,o){var c=i.attr("opacity");(0,b.UM)(c)&&(c=1),i.attr("opacity",0),i.animate({opacity:c},o)},e.prototype.removeAnimation=function(t,i,o){i.animate({opacity:0},o)},e.prototype.updateAnimation=function(t,i,o,c){i.animate(o,c)},e.prototype.updateElements=function(t,i){var o=this,c=this.get("animate"),p=this.get("animateOption"),g=t.getChildren().slice(0),_;(0,b.S6)(g,function(S){var I=S.get("id"),L=o.getElementById(I),F=S.get("name");if(L)if(S.get("isComponent")){var z=S.get("component"),V=L.get("component"),Q=(0,b.ei)(z.cfg,(0,b.e5)((0,b.XP)(z.cfg),Sl));V.update(Q),L.set(Su,"update")}else{var st=o.getReplaceAttrs(L,S);c&&p.update?o.updateAnimation(F,L,st,p.update):L.attr(st),S.isGroup()&&o.updateElements(S,L),(0,b.S6)(fu,function(ee){L.set(ee,S.get(ee))}),to(L,S),_=L,L.set(Su,"update")}else{i.add(S);var at=i.getChildren();if(at.splice(at.length-1,1),_){var Ft=at.indexOf(_);at.splice(Ft+1,0,S)}else at.unshift(S);if(o.registerElement(S),S.set(Su,"add"),S.get("isComponent")){var z=S.get("component");z.set("container",i)}else S.isGroup()&&o.registerNewGroup(S);if(_=S,c){var Kt=o.get("isInit")?p.appear:p.enter;Kt&&o.addAnimation(F,S,Kt)}}})},e.prototype.clearUpdateStatus=function(t){var i=t.getChildren();(0,b.S6)(i,function(o){o.set(Su,null)})},e.prototype.clearOffScreenCache=function(){var t=this.get("offScreenGroup");t&&t.destroy(),this.set("offScreenGroup",null),this.set("offScreenBBox",null)},e.prototype.getDelegateObject=function(){var t,i=this.get("name"),o=(t={},t[i]=this,t.component=this,t);return o},e.prototype.appendDelegateObject=function(t,i){var o=t.get("delegateObject");i.delegateObject||(i.delegateObject={}),(0,b.CD)(i.delegateObject,o)},e.prototype.getReplaceAttrs=function(t,i){var o=t.attr(),c=i.attr();return(0,b.S6)(o,function(p,g){c[g]===void 0&&(c[g]=void 0)}),c},e.prototype.registerNewGroup=function(t){var i=this,o=t.getChildren();(0,b.S6)(o,function(c){i.registerElement(c),c.set(Su,"add"),c.isGroup()&&i.registerNewGroup(c)})},e.prototype.deleteElements=function(){var t=this,i=this.get("shapesMap"),o=[];(0,b.S6)(i,function(g,_){!g.get(Su)||g.destroyed?o.push([_,g]):g.set(Su,null)});var c=this.get("animate"),p=this.get("animateOption");(0,b.S6)(o,function(g){var _=g[0],S=g[1];if(!S.destroyed){var I=S.get("name");if(c&&p.leave){var L=(0,b.CD)({callback:function(){t.removeElement(S)}},p.leave);t.removeAnimation(I,S,L)}else t.removeElement(S)}delete i[_]})},e.prototype.removeElement=function(t){if(t.get("isGroup")){var i=t.get("component");i&&i.destroy()}t.remove()},e}(nf),ki=Qi,Ef="\u2026";function Ju(r){for(var e=0,t=0;t<r.length;t++)e+=Cu(r,t);return e}function Cu(r,e){return r.charCodeAt(e)>0&&r.charCodeAt(e)<128?1:2}function Vu(r,e,t){t===void 0&&(t="tail");var i=r.length,o="";if(t==="tail"){for(var c=0,p=0;c<e;){var g=Cu(r,p);if(c+g<=e)o+=r[p],c+=Cu(r,p),p++;else break}o+=Ef}else if(t==="head"){for(var c=0,p=i-1;c<e;){var g=Cu(r,p);if(c+g<=e)o+=r[p],c+=Cu(r,p),p--;else break}o=Ef+o}else{for(var _="",S="",c=0,I=0,L=i-1;c<e;){var F=Cu(r,I),z=!1;F+c<=e&&(_+=r[I],I++,c+=F,z=!0);var V=Cu(r,L);if(V+c<=e&&(S=r[L]+S,c+=V,L--,z=!0),!z)break}o=_+Ef+S}return o}var gc="\u2026",ud=2,zl=400;function Do(r){for(var e=r.map(function(_){var S=_.attr("text");return(0,b.UM)(S)?"":""+S}),t=0,i=0,o=0;o<e.length;o+=1){for(var c=0,p=0;p<=e[o].length;p+=1){var g=e[o].charCodeAt(p);g>=19968&&g<=40869?c+=2:c+=1}c>t&&(t=c,i=o)}return r[i].getBBox().width}function rs(r){if(r.length>zl)return Do(r);var e=0;return(0,b.S6)(r,function(t){var i=t.getBBox(),o=i.width;e<o&&(e=o)}),e}function ld(r,e){var t=e.getCanvasBBox();return r?t.width:t.height}function $f(r,e){return r.getBBox().width<e}function Cl(r,e,t,i){var o;i===void 0&&(i="tail");var c=(o=e.attr("text"))!==null&&o!==void 0?o:"";if(i==="tail"){var p=(0,b.ei)(e.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),g=(0,b.Lo)(c,t,p,"\u2026");return c!==g?(e.attr("text",g),e.set("tip",c),!0):(e.set("tip",null),!1)}var _=ld(r,e),S=Ju(c),I=!1;if(t<_){var L=Math.floor(t/_*S)-ud,F=void 0;L>=0?F=Vu(c,L,i):F=gc,F&&(e.attr("text",F),I=!0)}return I?e.set("tip",c):e.set("tip",null),I}function il(r,e){var t=e.x,i=e.y,o=e.content,c=e.style,p=e.id,g=e.name,_=e.rotate,S=e.maxLength,I=e.autoEllipsis,L=e.isVertical,F=e.ellipsisPosition,z=e.background,V=r.addGroup({id:p+"-group",name:g+"-group",attrs:{x:t,y:i}}),Q=V.addShape({type:"text",id:p,name:g,attrs:(0,P.pi)({x:0,y:0,text:o},c)}),st=gh((0,b.U2)(z,"padding",0));if(S&&I){var at=S-(st[1]+st[3]);Cl(!L,Q,at,F)}if(z){var Ft=(0,b.U2)(z,"style",{}),Kt=Q.getCanvasBBox(),ee=Kt.minX,Me=Kt.minY,hr=Kt.width,Tr=Kt.height,Dr=V.addShape("rect",{id:p+"-bg",name:p+"-bg",attrs:(0,P.pi)({x:ee-st[3],y:Me-st[0],width:hr+st[1]+st[3],height:Tr+st[0]+st[2]},Ft)});Dr.toBack()}Xf(V,t,i),Ti(V,_,t,i)}var va={fontFamily:`
  BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`,textColor:"#2C3542",activeTextColor:"#333333",uncheckedColor:"#D8D8D8",lineColor:"#416180",regionColor:"#CCD7EB",verticalAxisRotate:-Math.PI/4,horizontalAxisRotate:Math.PI/4,descriptionIconStroke:"#fff",descriptionIconFill:"rgba(58, 73, 101, .25)"},Ul=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"line",locationType:"region",start:null,end:null,style:{},text:null,defaultCfg:{style:{fill:va.textColor,fontSize:12,textAlign:"center",textBaseline:"bottom",fontFamily:va.fontFamily},text:{position:"center",autoRotate:!0,content:null,offsetX:0,offsetY:0,style:{stroke:va.lineColor,lineWidth:1}}}})},e.prototype.renderInner=function(t){this.renderLine(t),this.get("text")&&this.renderLabel(t)},e.prototype.renderLine=function(t){var i=this.get("start"),o=this.get("end"),c=this.get("style");this.addShape(t,{type:"line",id:this.getElementId("line"),name:"annotation-line",attrs:(0,P.pi)({x1:i.x,y1:i.y,x2:o.x,y2:o.y},c)})},e.prototype.getLabelPoint=function(t,i,o){var c;return o==="start"?c=0:o==="center"?c=.5:(0,b.HD)(o)&&o.indexOf("%")!==-1?c=parseInt(o,10)/100:(0,b.hj)(o)?c=o:c=1,(c>1||c<0)&&(c=1),{x:eu(t.x,i.x,c),y:eu(t.y,i.y,c)}},e.prototype.renderLabel=function(t){var i=this.get("text"),o=this.get("start"),c=this.get("end"),p=i.position,g=i.content,_=i.style,S=i.offsetX,I=i.offsetY,L=i.autoRotate,F=i.maxLength,z=i.autoEllipsis,V=i.ellipsisPosition,Q=i.background,st=i.isVertical,at=st===void 0?!1:st,Ft=this.getLabelPoint(o,c,p),Kt=Ft.x+S,ee=Ft.y+I,Me={id:this.getElementId("line-text"),name:"annotation-line-text",x:Kt,y:ee,content:g,style:_,maxLength:F,autoEllipsis:z,ellipsisPosition:V,background:Q,isVertical:at};if(L){var hr=[c.x-o.x,c.y-o.y];Me.rotate=Math.atan2(hr[1],hr[0])}il(t,Me)},e}(ki),vl=Ul,wf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"text",locationType:"point",x:0,y:0,content:"",rotate:null,style:{},background:null,maxLength:null,autoEllipsis:!0,isVertical:!1,ellipsisPosition:"tail",defaultCfg:{style:{fill:va.textColor,fontSize:12,textAlign:"center",textBaseline:"middle",fontFamily:va.fontFamily}}})},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},e.prototype.renderInner=function(t){var i=this.getLocation(),o=i.x,c=i.y,p=this.get("content"),g=this.get("style"),_=this.getElementId("text"),S=this.get("name")+"-text",I=this.get("maxLength"),L=this.get("autoEllipsis"),F=this.get("isVertical"),z=this.get("ellipsisPosition"),V=this.get("background"),Q=this.get("rotate"),st={id:_,name:S,x:o,y:c,content:p,style:g,maxLength:I,autoEllipsis:L,isVertical:F,ellipsisPosition:z,background:V,rotate:Q};il(t,st)},e.prototype.resetLocation=function(){var t=this.getElementByLocalId("text-group");if(t){var i=this.getLocation(),o=i.x,c=i.y,p=this.get("rotate");Xf(t,o,c),Ti(t,p,o,c)}},e}(ki),ac=wf,Lc=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"arc",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2,style:{stroke:"#999",lineWidth:1}})},e.prototype.renderInner=function(t){this.renderArc(t)},e.prototype.getArcPath=function(){var t=this.getLocation(),i=t.center,o=t.radius,c=t.startAngle,p=t.endAngle,g=nl(i,o,c),_=nl(i,o,p),S=p-c>Math.PI?1:0,I=[["M",g.x,g.y]];if(p-c===Math.PI*2){var L=nl(i,o,c+Math.PI);I.push(["A",o,o,0,S,1,L.x,L.y]),I.push(["A",o,o,0,S,1,_.x,_.y])}else I.push(["A",o,o,0,S,1,_.x,_.y]);return I},e.prototype.renderArc=function(t){var i=this.getArcPath(),o=this.get("style");this.addShape(t,{type:"path",id:this.getElementId("arc"),name:"annotation-arc",attrs:(0,P.pi)({path:i},o)})},e}(ki),Zl=Lc,mh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"region",locationType:"region",start:null,end:null,style:{},defaultCfg:{style:{lineWidth:0,fill:va.regionColor,opacity:.4}}})},e.prototype.renderInner=function(t){this.renderRegion(t)},e.prototype.renderRegion=function(t){var i=this.get("start"),o=this.get("end"),c=this.get("style"),p=wu({start:i,end:o});this.addShape(t,{type:"rect",id:this.getElementId("region"),name:"annotation-region",attrs:(0,P.pi)({x:p.x,y:p.y,width:p.width,height:p.height},c)})},e}(ki),qf=mh,cd=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"image",locationType:"region",start:null,end:null,src:null,style:{}})},e.prototype.renderInner=function(t){this.renderImage(t)},e.prototype.getImageAttrs=function(){var t=this.get("start"),i=this.get("end"),o=this.get("style"),c=wu({start:t,end:i}),p=this.get("src");return(0,P.pi)({x:c.x,y:c.y,img:p,width:c.width,height:c.height},o)},e.prototype.renderImage=function(t){this.addShape(t,{type:"image",id:this.getElementId("image"),name:"annotation-image",attrs:this.getImageAttrs()})},e}(ki),Sf=cd,Cf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"dataMarker",locationType:"point",x:0,y:0,point:{},line:{},text:{},direction:"upward",autoAdjust:!0,coordinateBBox:null,defaultCfg:{point:{display:!0,style:{r:3,fill:"#FFFFFF",stroke:"#1890FF",lineWidth:2}},line:{display:!0,length:20,style:{stroke:va.lineColor,lineWidth:1}},text:{content:"",display:!0,style:{fill:va.textColor,opacity:.65,fontSize:12,textAlign:"start",fontFamily:va.fontFamily}}}})},e.prototype.renderInner=function(t){(0,b.U2)(this.get("line"),"display")&&this.renderLine(t),(0,b.U2)(this.get("text"),"display")&&this.renderText(t),(0,b.U2)(this.get("point"),"display")&&this.renderPoint(t),this.get("autoAdjust")&&this.autoAdjust(t)},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x")+this.get("offsetX"),y:this.get("y")+this.get("offsetY")})},e.prototype.renderPoint=function(t){var i=this.getShapeAttrs().point;this.addShape(t,{type:"circle",id:this.getElementId("point"),name:"annotation-point",attrs:i})},e.prototype.renderLine=function(t){var i=this.getShapeAttrs().line;this.addShape(t,{type:"path",id:this.getElementId("line"),name:"annotation-line",attrs:i})},e.prototype.renderText=function(t){var i=this.getShapeAttrs().text,o=i.x,c=i.y,p=i.text,g=(0,P._T)(i,["x","y","text"]),_=this.get("text"),S=_.background,I=_.maxLength,L=_.autoEllipsis,F=_.isVertival,z=_.ellipsisPosition,V={x:o,y:c,id:this.getElementId("text"),name:"annotation-text",content:p,style:g,background:S,maxLength:I,autoEllipsis:L,isVertival:F,ellipsisPosition:z};il(t,V)},e.prototype.autoAdjust=function(t){var i=this.get("direction"),o=this.get("x"),c=this.get("y"),p=(0,b.U2)(this.get("line"),"length",0),g=this.get("coordinateBBox"),_=t.getBBox(),S=_.minX,I=_.maxX,L=_.minY,F=_.maxY,z=t.findById(this.getElementId("text-group")),V=t.findById(this.getElementId("text")),Q=t.findById(this.getElementId("line"));if(g){if(z){if(o+S<=g.minX){var st=g.minX-(o+S);Xf(z,z.attr("x")+st,z.attr("y"))}if(o+I>=g.maxX){var st=o+I-g.maxX;Xf(z,z.attr("x")-st,z.attr("y"))}}if(i==="upward"&&c+L<=g.minY||i!=="upward"&&c+F>=g.maxY){var at=void 0,Ft=void 0;i==="upward"&&c+L<=g.minY?(at="top",Ft=1):(at="bottom",Ft=-1),V.attr("textBaseline",at),Q&&Q.attr("path",[["M",0,0],["L",0,p*Ft]]),Xf(z,z.attr("x"),(p+2)*Ft)}}},e.prototype.getShapeAttrs=function(){var t=(0,b.U2)(this.get("line"),"display"),i=(0,b.U2)(this.get("point"),"style",{}),o=(0,b.U2)(this.get("line"),"style",{}),c=(0,b.U2)(this.get("text"),"style",{}),p=this.get("direction"),g=t?(0,b.U2)(this.get("line"),"length",0):0,_=p==="upward"?-1:1;return{point:(0,P.pi)({x:0,y:0},i),line:(0,P.pi)({path:[["M",0,0],["L",0,g*_]]},o),text:(0,P.pi)({x:0,y:(g+2)*_,text:(0,b.U2)(this.get("text"),"content",""),textBaseline:p==="upward"?"bottom":"top"},c)}},e}(ki),Mp=Cf,Af=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"dataRegion",locationType:"points",points:[],lineLength:0,region:{},text:{},defaultCfg:{region:{style:{lineWidth:0,fill:va.regionColor,opacity:.4}},text:{content:"",style:{textAlign:"center",textBaseline:"bottom",fontSize:12,fill:va.textColor,fontFamily:va.fontFamily}}}})},e.prototype.renderInner=function(t){var i=(0,b.U2)(this.get("region"),"style",{}),o=(0,b.U2)(this.get("text"),"style",{}),c=this.get("lineLength")||0,p=this.get("points");if(p.length){var g=xf(p),_=[];_.push(["M",p[0].x,g.minY-c]),p.forEach(function(I){_.push(["L",I.x,I.y])}),_.push(["L",p[p.length-1].x,p[p.length-1].y-c]),this.addShape(t,{type:"path",id:this.getElementId("region"),name:"annotation-region",attrs:(0,P.pi)({path:_},i)});var S=(0,P.pi)({id:this.getElementId("text"),name:"annotation-text",x:(g.minX+g.maxX)/2,y:g.minY-c},this.get("text"));il(t,S)}},e}(ki),Al=Af,Gh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"regionFilter",locationType:"region",start:null,end:null,color:null,shape:[]})},e.prototype.renderInner=function(t){var i=this,o=this.get("start"),c=this.get("end"),p=this.addGroup(t,{id:this.getElementId("region-filter"),capture:!1});(0,b.S6)(this.get("shapes"),function(_,S){var I=_.get("type"),L=(0,b.d9)(_.attr());i.adjustShapeAttrs(L),i.addShape(p,{id:i.getElementId("shape-"+I+"-"+S),capture:!1,type:I,attrs:L})});var g=wu({start:o,end:c});p.setClip({type:"rect",attrs:{x:g.minX,y:g.minY,width:g.width,height:g.height}})},e.prototype.adjustShapeAttrs=function(t){var i=this.get("color");t.fill&&(t.fill=t.fillStyle=i),t.stroke=t.strokeStyle=i},e}(ki),Hh=Gh,Ip=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"shape",draw:b.ZT})},e.prototype.renderInner=function(t){var i=this.get("render");(0,b.mf)(i)&&i(t)},e}(ki),oc=Ip;function x(r,e,t){var i;try{i=window.getComputedStyle?window.getComputedStyle(r,null)[e]:r.style[e]}catch(o){}finally{i=i===void 0?t:i}return i}function C(r,e){var t=x(r,"width",e);return t==="auto"&&(t=r.offsetWidth),parseFloat(t)}function E(r,e){var t=C(r,e),i=parseFloat(x(r,"borderLeftWidth"))||0,o=parseFloat(x(r,"paddingLeft"))||0,c=parseFloat(x(r,"paddingRight"))||0,p=parseFloat(x(r,"borderRightWidth"))||0,g=parseFloat(x(r,"marginRight"))||0,_=parseFloat(x(r,"marginLeft"))||0;return t+i+p+o+c+_+g}function M(r,e){var t=x(r,"height",e);return t==="auto"&&(t=r.offsetHeight),parseFloat(t)}function U(r,e){var t=M(r,e),i=parseFloat(x(r,"borderTopWidth"))||0,o=parseFloat(x(r,"paddingTop"))||0,c=parseFloat(x(r,"paddingBottom"))||0,p=parseFloat(x(r,"borderBottomWidth"))||0,g=parseFloat(x(r,"marginTop"))||0,_=parseFloat(x(r,"marginBottom"))||0;return t+i+p+o+c+g+_}var H=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{container:null,containerTpl:"<div></div>",updateAutoRender:!0,containerClassName:"",parent:null})},e.prototype.getContainer=function(){return this.get("container")},e.prototype.show=function(){var t=this.get("container");t.style.display="",this.set("visible",!0)},e.prototype.hide=function(){var t=this.get("container");t.style.display="none",this.set("visible",!1)},e.prototype.setCapture=function(t){var i=this.getContainer(),o=t?"auto":"none";i.style.pointerEvents=o,this.set("capture",t)},e.prototype.getBBox=function(){var t=this.getContainer(),i=parseFloat(t.style.left)||0,o=parseFloat(t.style.top)||0;return wl(i,o,t.clientWidth,t.clientHeight)},e.prototype.clear=function(){var t=this.get("container");rf(t)},e.prototype.destroy=function(){this.removeEvent(),this.removeDom(),r.prototype.destroy.call(this)},e.prototype.init=function(){r.prototype.init.call(this),this.initContainer(),this.initDom(),this.resetStyles(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible()},e.prototype.initCapture=function(){this.setCapture(this.get("capture"))},e.prototype.initVisible=function(){this.get("visible")?this.show():this.hide()},e.prototype.initDom=function(){},e.prototype.initContainer=function(){var t=this.get("container");if((0,b.UM)(t)){t=this.createDom();var i=this.get("parent");(0,b.HD)(i)&&(i=document.getElementById(i),this.set("parent",i)),i.appendChild(t),this.get("containerId")&&t.setAttribute("id",this.get("containerId")),this.set("container",t)}else(0,b.HD)(t)&&(t=document.getElementById(t),this.set("container",t));this.get("parent")||this.set("parent",t.parentNode)},e.prototype.resetStyles=function(){var t=this.get("domStyles"),i=this.get("defaultStyles");t?t=(0,b.b$)({},i,t):t=i,this.set("domStyles",t)},e.prototype.applyStyles=function(){var t=this.get("domStyles");if(t){var i=this.getContainer();this.applyChildrenStyles(i,t);var o=this.get("containerClassName");if(o&&es(i,o)){var c=t[o];(0,Y.Z)(i,c)}}},e.prototype.applyChildrenStyles=function(t,i){(0,b.S6)(i,function(o,c){var p=t.getElementsByClassName(c);(0,b.S6)(p,function(g){(0,Y.Z)(g,o)})})},e.prototype.applyStyle=function(t,i){var o=this.get("domStyles");(0,Y.Z)(i,o[t])},e.prototype.createDom=function(){var t=this.get("containerTpl");return(0,wt.Z)(t)},e.prototype.initEvent=function(){},e.prototype.removeDom=function(){var t=this.get("container");t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.removeEvent=function(){},e.prototype.updateInner=function(t){(0,b.wH)(t,"domStyles")&&(this.resetStyles(),this.applyStyles()),this.resetPosition()},e.prototype.resetPosition=function(){},e}(nf),$=H,ht=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"html",locationType:"point",x:0,y:0,containerTpl:'<div class="g2-html-annotation" style="position:absolute"></div>',alignX:"left",alignY:"top",html:"",zIndex:7})},e.prototype.render=function(){var t=this.getContainer(),i=this.get("html");rf(t);var o=(0,b.mf)(i)?i(t):i;if((0,b.kK)(o))t.appendChild(o);else if((0,b.HD)(o)||(0,b.hj)(o)){var c=(0,wt.Z)(""+o);c&&t.appendChild(c)}this.resetPosition()},e.prototype.resetPosition=function(){var t=this.getContainer(),i=this.getLocation(),o=i.x,c=i.y,p=this.get("alignX"),g=this.get("alignY"),_=this.get("offsetX"),S=this.get("offsetY"),I=E(t),L=U(t),F={x:o,y:c};p==="middle"?F.x-=Math.round(I/2):p==="right"&&(F.x-=Math.round(I)),g==="middle"?F.y-=Math.round(L/2):g==="bottom"&&(F.y-=Math.round(L)),_&&(F.x+=_),S&&(F.y+=S),(0,Y.Z)(t,{position:"absolute",left:F.x+"px",top:F.y+"px",zIndex:this.get("zIndex")})},e}($),Ut=ht;function ie(r,e,t){var i=e+"Style",o=null;return(0,b.S6)(t,function(c,p){r[p]&&c[i]&&(o||(o={}),(0,b.CD)(o,c[i]))}),o}var Be=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"axis",ticks:[],line:{},tickLine:{},subTickLine:null,title:null,label:{},verticalFactor:1,verticalLimitLength:null,overlapOrder:["autoRotate","autoEllipsis","autoHide"],tickStates:{},optimize:{},defaultCfg:{line:{style:{lineWidth:1,stroke:va.lineColor}},tickLine:{style:{lineWidth:1,stroke:va.lineColor},alignTick:!0,length:5,displayWithLabel:!0},subTickLine:{style:{lineWidth:1,stroke:va.lineColor},count:4,length:2},label:{autoRotate:!0,autoHide:!1,autoEllipsis:!1,style:{fontSize:12,fill:va.textColor,fontFamily:va.fontFamily,fontWeight:"normal"},offset:10,offsetX:0,offsetY:0},title:{autoRotate:!0,spacing:5,position:"center",style:{fontSize:12,fill:va.textColor,textBaseline:"middle",fontFamily:va.fontFamily,textAlign:"center"},iconStyle:{fill:va.descriptionIconFill,stroke:va.descriptionIconStroke},description:""},tickStates:{active:{labelStyle:{fontWeight:500},tickLineStyle:{lineWidth:2}},inactive:{labelStyle:{fill:va.uncheckedColor}}},optimize:{enable:!0,threshold:400}},theme:{}})},e.prototype.renderInner=function(t){this.get("line")&&this.drawLine(t),this.drawTicks(t),this.get("title")&&this.drawTitle(t)},e.prototype.isList=function(){return!0},e.prototype.getItems=function(){return this.get("ticks")},e.prototype.setItems=function(t){this.update({ticks:t})},e.prototype.updateItem=function(t,i){(0,b.CD)(t,i),this.clear(),this.render()},e.prototype.clearItems=function(){var t=this.getElementByLocalId("label-group");t&&t.clear()},e.prototype.setItemState=function(t,i,o){t[i]=o,this.updateTickStates(t)},e.prototype.hasState=function(t,i){return!!t[i]},e.prototype.getItemStates=function(t){var i=this.get("tickStates"),o=[];return(0,b.S6)(i,function(c,p){t[p]&&o.push(p)}),o},e.prototype.clearItemsState=function(t){var i=this,o=this.getItemsByState(t);(0,b.S6)(o,function(c){i.setItemState(c,t,!1)})},e.prototype.getItemsByState=function(t){var i=this,o=this.getItems();return(0,b.hX)(o,function(c){return i.hasState(c,t)})},e.prototype.getSidePoint=function(t,i){var o=this,c=o.getSideVector(i,t);return{x:t.x+c[0],y:t.y+c[1]}},e.prototype.getTextAnchor=function(t){var i;return(0,b.vQ)(t[0],0)?i="center":t[0]>0?i="start":t[0]<0&&(i="end"),i},e.prototype.getTextBaseline=function(t){var i;return(0,b.vQ)(t[1],0)?i="middle":t[1]>0?i="top":t[1]<0&&(i="bottom"),i},e.prototype.processOverlap=function(t){},e.prototype.drawLine=function(t){var i=this.getLinePath(),o=this.get("line");this.addShape(t,{type:"path",id:this.getElementId("line"),name:"axis-line",attrs:(0,b.CD)({path:i},o.style)})},e.prototype.getTickLineItems=function(t){var i=this,o=[],c=this.get("tickLine"),p=c.alignTick,g=c.length,_=1,S=t.length;return S>=2&&(_=t[1].value-t[0].value),(0,b.S6)(t,function(I){var L=I.point;p||(L=i.getTickPoint(I.value-_/2));var F=i.getSidePoint(L,g);o.push({startPoint:L,tickValue:I.value,endPoint:F,tickId:I.id,id:"tickline-"+I.id})}),o},e.prototype.getSubTickLineItems=function(t){var i=[],o=this.get("subTickLine"),c=o.count,p=t.length;if(p>=2)for(var g=0;g<p-1;g++)for(var _=t[g],S=t[g+1],I=0;I<c;I++){var L=(I+1)/(c+1),F=(1-L)*_.tickValue+L*S.tickValue,z=this.getTickPoint(F),V=this.getSidePoint(z,o.length);i.push({startPoint:z,endPoint:V,tickValue:F,id:"sub-"+_.id+"-"+I})}return i},e.prototype.getTickLineAttrs=function(t,i,o,c){var p=this.get(i).style,g={points:[t.startPoint,t.endPoint]},_=(0,b.U2)(this.get("theme"),["tickLine","style"],{});p=(0,b.mf)(p)?(0,b.CD)({},_,p(g,o,c)):p;var S=t.startPoint,I=t.endPoint;return(0,P.pi)({x1:S.x,y1:S.y,x2:I.x,y2:I.y},p)},e.prototype.drawTick=function(t,i,o,c,p){this.addShape(i,{type:"line",id:this.getElementId(t.id),name:"axis-"+o,attrs:this.getTickLineAttrs(t,o,c,p)})},e.prototype.drawTickLines=function(t){var i=this,o=this.get("ticks"),c=this.get("subTickLine"),p=this.getTickLineItems(o),g=this.addGroup(t,{name:"axis-tickline-group",id:this.getElementId("tickline-group")}),_=this.get("tickLine");if((0,b.S6)(p,function(I,L){if(_.displayWithLabel){var F=i.getElementId("label-"+I.tickId);t.findById(F)&&i.drawTick(I,g,"tickLine",L,p)}else i.drawTick(I,g,"tickLine",L,p)}),c){var S=this.getSubTickLineItems(p);(0,b.S6)(S,function(I,L){i.drawTick(I,g,"subTickLine",L,S)})}},e.prototype.processTicks=function(){var t=this,i=this.get("ticks");(0,b.S6)(i,function(o){o.point=t.getTickPoint(o.value),(0,b.UM)(o.id)&&(o.id=o.name)})},e.prototype.drawTicks=function(t){var i=this;this.optimizeTicks(),this.processTicks(),this.get("label")&&this.drawLabels(t),this.get("tickLine")&&this.drawTickLines(t);var o=this.get("ticks");(0,b.S6)(o,function(c){i.applyTickStates(c,t)})},e.prototype.optimizeTicks=function(){var t=this.get("optimize"),i=this.get("ticks");if(t&&t.enable&&t.threshold>0){var o=(0,b.dp)(i);if(o>t.threshold){var c=Math.ceil(o/t.threshold),p=i.filter(function(g,_){return _%c===0});this.set("ticks",p),this.set("originalTicks",i)}}},e.prototype.getLabelAttrs=function(t,i,o){var c=this.get("label"),p=c.offset,g=c.offsetX,_=c.offsetY,S=c.rotate,I=c.formatter,L=this.getSidePoint(t.point,p),F=this.getSideVector(p,L),z=I?I(t.name,t,i):t.name,V=c.style;V=(0,b.mf)(V)?(0,b.U2)(this.get("theme"),["label","style"],{}):V;var Q=(0,b.CD)({x:L.x+g,y:L.y+_,text:z,textAlign:this.getTextAnchor(F),textBaseline:this.getTextBaseline(F)},V);return S&&(Q.matrix=El(L,S)),Q},e.prototype.drawLabels=function(t){var i=this,o=this.get("ticks"),c=this.addGroup(t,{name:"axis-label-group",id:this.getElementId("label-group")});(0,b.S6)(o,function(F,z){i.addShape(c,{type:"text",name:"axis-label",id:i.getElementId("label-"+F.id),attrs:i.getLabelAttrs(F,z,o),delegateObject:{tick:F,item:F,index:z}})}),this.processOverlap(c);var p=c.getChildren(),g=(0,b.U2)(this.get("theme"),["label","style"],{}),_=this.get("label"),S=_.style,I=_.formatter;if((0,b.mf)(S)){var L=p.map(function(F){return(0,b.U2)(F.get("delegateObject"),"tick")});(0,b.S6)(p,function(F,z){var V=F.get("delegateObject").tick,Q=I?I(V.name,V,z):V.name,st=(0,b.CD)({},g,S(Q,z,L));F.attr(st)})}},e.prototype.getTitleAttrs=function(){var t=this.get("title"),i=t.style,o=t.position,c=t.offset,p=t.spacing,g=p===void 0?0:p,_=t.autoRotate,S=i.fontSize,I=.5;o==="start"?I=0:o==="end"&&(I=1);var L=this.getTickPoint(I),F=this.getSidePoint(L,c||g+S/2),z=(0,b.CD)({x:F.x,y:F.y,text:t.text},i),V=t.rotate,Q=V;if((0,b.UM)(V)&&_){var st=this.getAxisVector(L),at=[1,0];Q=ro.Dg(st,at,!0)}if(Q){var Ft=El(F,Q);z.matrix=Ft}return z},e.prototype.drawTitle=function(t){var i,o=this.getTitleAttrs(),c=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"axis-title",attrs:o});!((i=this.get("title"))===null||i===void 0)&&i.description&&this.drawDescriptionIcon(t,c,o.matrix)},e.prototype.drawDescriptionIcon=function(t,i,o){var c=this.addGroup(t,{name:"axis-description",id:this.getElementById("description")}),p=i.getBBox(),g=p.maxX,_=p.maxY,S=p.height,I=this.get("title").iconStyle,L=4,F=S/2,z=F/6,V=g+L,Q=_-S/2,st=[V+F,Q-F],at=st[0],Ft=st[1],Kt=[at+F,Ft+F],ee=Kt[0],Me=Kt[1],hr=[at,Me+F],Tr=hr[0],Dr=hr[1],cn=[V,Ft+F],Jr=cn[0],Mn=cn[1],mi=[V+F,Q-S/4],da=mi[0],Sa=mi[1],eo=[da,Sa+z],Gn=eo[0],Vi=eo[1],ua=[Gn,Vi+z],Xi=ua[0],ea=ua[1],ka=[Xi,ea+F*3/4],xo=ka[0],Mo=ka[1];this.addShape(c,{type:"path",id:this.getElementId("title-description-icon"),name:"axis-title-description-icon",attrs:(0,P.pi)({path:[["M",at,Ft],["A",F,F,0,0,1,ee,Me],["A",F,F,0,0,1,Tr,Dr],["A",F,F,0,0,1,Jr,Mn],["A",F,F,0,0,1,at,Ft],["M",da,Sa],["L",Gn,Vi],["M",Xi,ea],["L",xo,Mo]],lineWidth:z,matrix:o},I)}),this.addShape(c,{type:"rect",id:this.getElementId("title-description-rect"),name:"axis-title-description-rect",attrs:{x:V,y:Q-S/2,width:S,height:S,stroke:"#000",fill:"#000",opacity:0,matrix:o,cursor:"pointer"}})},e.prototype.applyTickStates=function(t,i){var o=this.getItemStates(t);if(o.length){var c=this.get("tickStates"),p=this.getElementId("label-"+t.id),g=i.findById(p);if(g){var _=ie(t,"label",c);_&&g.attr(_)}var S=this.getElementId("tickline-"+t.id),I=i.findById(S);if(I){var L=ie(t,"tickLine",c);L&&I.attr(L)}}},e.prototype.updateTickStates=function(t){var i=this.getItemStates(t),o=this.get("tickStates"),c=this.get("label"),p=this.getElementByLocalId("label-"+t.id),g=this.get("tickLine"),_=this.getElementByLocalId("tickline-"+t.id);if(i.length){if(p){var S=ie(t,"label",o);S&&p.attr(S)}if(_){var I=ie(t,"tickLine",o);I&&_.attr(I)}}else p&&p.attr(c.style),_&&_.attr(g.style)},e}(ki),De=Be;function Ne(r,e,t,i){var o=e.getChildren(),c=!1;return(0,b.S6)(o,function(p){var g=Cl(r,p,t,i);c=c||g}),c}function fr(){return _r}function $e(r,e,t){return Ne(r,e,t,"head")}function _r(r,e,t){return Ne(r,e,t,"tail")}function er(r,e,t){return Ne(r,e,t,"middle")}function Er(r){var e=r.attr("matrix");return e&&e[0]!==1}function Or(r){var e=Er(r)?vc(r.attr("matrix")):0;return e%360}function Yr(r,e,t,i){var o=!1,c=Or(e),p=Math.abs(r?t.attr("y")-e.attr("y"):t.attr("x")-e.attr("x")),g=(r?t.attr("y")>e.attr("y"):t.attr("x")>e.attr("x"))?e.getBBox():t.getBBox();if(r){var _=Math.abs(Math.cos(c));bf(_,0,Math.PI/180)?o=g.width+i>p:o=g.height/_+i>p}else{var _=Math.abs(Math.sin(c));bf(_,0,Math.PI/180)?o=g.width+i>p:o=g.height/_+i>p}return o}function gn(r,e,t,i){var o=(i==null?void 0:i.minGap)||0,c=e.getChildren().slice().filter(function(V){return V.get("visible")});if(!c.length)return!1;var p=!1;t&&c.reverse();for(var g=c.length,_=c[0],S=_,I=1;I<g;I++){var L=c[I],F=L.getBBox(),z=Yr(r,S,L,o);z?(L.hide(),p=!0):S=L}return p}function vn(r,e,t){var i=(t==null?void 0:t.minGap)||0,o=e.getChildren().slice();if(o.length<2)return!1;var c=!1,p=o[0],g=p.getBBox(),_=o[1],S=o.length,I=Or(p),L=Math.abs(r?_.attr("y")-p.attr("y"):_.attr("x")-p.attr("x")),F=0;if(r){var z=Math.abs(Math.cos(I));if(bf(z,0,Math.PI/180)){var V=rs(o);F=(V+i)/L}else F=(g.height/z+i)/L}else{var z=Math.abs(Math.sin(I));if(bf(z,0,Math.PI/180)){var V=rs(o);F=(V+i)/L}else F=(g.height/z+i)/L}if(F>1){F=Math.ceil(F);for(var Q=0;Q<S;Q++)Q%F!==0&&(o[Q].hide(),c=!0)}return c}function _n(){return Ri}function Un(r,e,t,i){return gn(r,e,!1,i)}function ui(r,e,t,i){return gn(r,e,!0,i)}function oi(r,e,t,i){var o=(i==null?void 0:i.minGap)||0,c=e.getChildren().slice();if(c.length<=2)return!1;for(var p=!1,g=c.length,_=c[0],S=c[g-1],I=_,L=1;L<g-1;L++){var F=c[L],z=F.getBBox(),V=Yr(r,I,F,o);V?(F.hide(),p=!0):I=F}var Q=Yr(r,I,S,o);return Q&&(I.hide(),p=!0),p}function Ri(r,e,t,i){var o=vn(r,e,i);return gn(r,e,!1)&&(o=!0),o}function Di(r,e,t,i){var o=e.getChildren().slice(),c=vn(r,e,i);if(o.length>2){var p=o[0],g=o[o.length-1];p.get("visible")||(p.show(),gn(r,e,!1,i)&&(c=!0)),g.get("visible")||(g.show(),gn(r,e,!0,i)&&(c=!0))}return c}function ia(r,e){(0,b.S6)(r,function(t){var i=t.attr("x"),o=t.attr("y"),c=El({x:i,y:o},e);t.attr("matrix",c)})}function na(r,e,t,i){var o=e.getChildren();if(!o.length||!r&&o.length<2)return!1;var c=rs(o),p=!1;if(r)p=!!t&&c>t;else{var g=Math.abs(o[1].attr("x")-o[0].attr("x"));p=c>g}if(p){var _=i(t,c);ia(o,_)}return p}function co(){return Bi}function Bi(r,e,t,i){return na(r,e,t,function(){return(0,b.hj)(i)?i:r?va.verticalAxisRotate:va.horizontalAxisRotate})}function Pa(r,e,t){return na(r,e,t,function(i,o){if(!i)return r?va.verticalAxisRotate:va.horizontalAxisRotate;if(r)return-Math.acos(i/o);var c=0;return i>o?c=Math.PI/4:(c=Math.asin(i/o),c>Math.PI/4&&(c=Math.PI/4)),c})}var Ra=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line",locationType:"region",start:null,end:null})},e.prototype.getLinePath=function(){var t=this.get("start"),i=this.get("end"),o=[];return o.push(["M",t.x,t.y]),o.push(["L",i.x,i.y]),o},e.prototype.getInnerLayoutBBox=function(){var t=this.get("start"),i=this.get("end"),o=r.prototype.getInnerLayoutBBox.call(this),c=Math.min(t.x,i.x,o.x),p=Math.min(t.y,i.y,o.y),g=Math.max(t.x,i.x,o.maxX),_=Math.max(t.y,i.y,o.maxY);return{x:c,y:p,minX:c,minY:p,maxX:g,maxY:_,width:g-c,height:_-p}},e.prototype.isVertical=function(){var t=this.get("start"),i=this.get("end");return(0,b.vQ)(t.x,i.x)},e.prototype.isHorizontal=function(){var t=this.get("start"),i=this.get("end");return(0,b.vQ)(t.y,i.y)},e.prototype.getTickPoint=function(t){var i=this,o=i.get("start"),c=i.get("end"),p=c.x-o.x,g=c.y-o.y;return{x:o.x+p*t,y:o.y+g*t}},e.prototype.getSideVector=function(t){var i=this.getAxisVector(),o=Ia.Fv([0,0],i),c=this.get("verticalFactor"),p=[o[1],o[0]*-1];return Ia.bA([0,0],p,t*c)},e.prototype.getAxisVector=function(){var t=this.get("start"),i=this.get("end");return[i.x-t.x,i.y-t.y]},e.prototype.processOverlap=function(t){var i=this,o=this.isVertical(),c=this.isHorizontal();if(!(!o&&!c)){var p=this.get("label"),g=this.get("title"),_=this.get("verticalLimitLength"),S=p.offset,I=_,L=0,F=0;g&&(L=g.style.fontSize,F=g.spacing),I&&(I=I-S-F-L);var z=this.get("overlapOrder");if((0,b.S6)(z,function(st){p[st]&&i.canProcessOverlap(st)&&i.autoProcessOverlap(st,p[st],t,I)}),g&&(0,b.UM)(g.offset)){var V=t.getCanvasBBox(),Q=o?V.width:V.height;g.offset=S+Q+F+L/2}}},e.prototype.canProcessOverlap=function(t){var i=this.get("label");return t==="autoRotate"?(0,b.UM)(i.rotate):!0},e.prototype.autoProcessOverlap=function(t,i,o,c){var p=this,g=this.isVertical(),_=!1,S=yt[t];if(i===!0){var I=this.get("label");_=S.getDefault()(g,o,c)}else if((0,b.mf)(i))_=i(g,o,c);else if((0,b.Kn)(i)){var L=i;S[L.type]&&(_=S[L.type](g,o,c,L.cfg))}else S[i]&&(_=S[i](g,o,c));if(t==="autoRotate"){if(_){var F=o.getChildren(),z=this.get("verticalFactor");(0,b.S6)(F,function(Q){var st=Q.attr("textAlign");if(st==="center"){var at=z>0?"end":"start";Q.attr("textAlign",at)}})}}else if(t==="autoHide"){var V=o.getChildren().slice(0);(0,b.S6)(V,function(Q){Q.get("visible")||(p.get("isRegister")&&p.unregisterElement(Q),Q.remove())})}},e}(De),Aa=Ra,ya=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",locationType:"circle",center:null,radius:null,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},e.prototype.getLinePath=function(){var t=this.get("center"),i=t.x,o=t.y,c=this.get("radius"),p=c,g=this.get("startAngle"),_=this.get("endAngle"),S=[];if(Math.abs(_-g)===Math.PI*2)S=[["M",i,o-p],["A",c,p,0,1,1,i,o+p],["A",c,p,0,1,1,i,o-p],["Z"]];else{var I=this.getCirclePoint(g),L=this.getCirclePoint(_),F=Math.abs(_-g)>Math.PI?1:0,z=g>_?0:1;S=[["M",i,o],["L",I.x,I.y],["A",c,p,0,F,z,L.x,L.y],["L",i,o]]}return S},e.prototype.getTickPoint=function(t){var i=this.get("startAngle"),o=this.get("endAngle"),c=i+(o-i)*t;return this.getCirclePoint(c)},e.prototype.getSideVector=function(t,i){var o=this.get("center"),c=[i.x-o.x,i.y-o.y],p=this.get("verticalFactor"),g=Ia.kE(c);return Ia.bA(c,c,p*t/g),c},e.prototype.getAxisVector=function(t){var i=this.get("center"),o=[t.x-i.x,t.y-i.y];return[o[1],-1*o[0]]},e.prototype.getCirclePoint=function(t,i){var o=this.get("center");return i=i||this.get("radius"),{x:o.x+Math.cos(t)*i,y:o.y+Math.sin(t)*i}},e.prototype.canProcessOverlap=function(t){var i=this.get("label");return t==="autoRotate"?(0,b.UM)(i.rotate):!0},e.prototype.processOverlap=function(t){var i=this,o=this.get("label"),c=this.get("title"),p=this.get("verticalLimitLength"),g=o.offset,_=p,S=0,I=0;c&&(S=c.style.fontSize,I=c.spacing),_&&(_=_-g-I-S);var L=this.get("overlapOrder");if((0,b.S6)(L,function(z){o[z]&&i.canProcessOverlap(z)&&i.autoProcessOverlap(z,o[z],t,_)}),c&&(0,b.UM)(c.offset)){var F=t.getCanvasBBox().height;c.offset=g+F+I+S/2}},e.prototype.autoProcessOverlap=function(t,i,o,c){var p=this,g=!1,_=yt[t];if(c>0)if(i===!0)g=_.getDefault()(!1,o,c);else if((0,b.mf)(i))g=i(!1,o,c);else if((0,b.Kn)(i)){var S=i;_[S.type]&&(g=_[S.type](!1,o,c,S.cfg))}else _[i]&&(g=_[i](!1,o,c));if(t==="autoRotate"){if(g){var I=o.getChildren(),L=this.get("verticalFactor");(0,b.S6)(I,function(z){var V=z.attr("textAlign");if(V==="center"){var Q=L>0?"end":"start";z.attr("textAlign",Q)}})}}else if(t==="autoHide"){var F=o.getChildren().slice(0);(0,b.S6)(F,function(z){z.get("visible")||(p.get("isRegister")&&p.unregisterElement(z),z.remove())})}},e}(De),Ba=ya,Ea=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"crosshair",type:"base",line:{},text:null,textBackground:{},capture:!1,defaultCfg:{line:{style:{lineWidth:1,stroke:va.lineColor}},text:{position:"start",offset:10,autoRotate:!1,content:null,style:{fill:va.textColor,textAlign:"center",textBaseline:"middle",fontFamily:va.fontFamily}},textBackground:{padding:5,style:{stroke:va.lineColor}}}})},e.prototype.renderInner=function(t){this.get("line")&&this.renderLine(t),this.get("text")&&(this.renderText(t),this.renderBackground(t))},e.prototype.renderText=function(t){var i=this.get("text"),o=i.style,c=i.autoRotate,p=i.content;if(!(0,b.UM)(p)){var g=this.getTextPoint(),_=null;if(c){var S=this.getRotateAngle();_=El(g,S)}this.addShape(t,{type:"text",name:"crosshair-text",id:this.getElementId("text"),attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{text:p,matrix:_}),o)})}},e.prototype.renderLine=function(t){var i=this.getLinePath(),o=this.get("line"),c=o.style;this.addShape(t,{type:"path",name:"crosshair-line",id:this.getElementId("line"),attrs:(0,P.pi)({path:i},c)})},e.prototype.renderBackground=function(t){var i=this.getElementId("text"),o=t.findById(i),c=this.get("textBackground");if(c&&o){var p=o.getBBox(),g=gh(c.padding),_=c.style,S=this.addShape(t,{type:"rect",name:"crosshair-text-background",id:this.getElementId("text-background"),attrs:(0,P.pi)({x:p.x-g[3],y:p.y-g[0],width:p.width+g[1]+g[3],height:p.height+g[0]+g[2],matrix:o.attr("matrix")},_)});S.toBack()}},e}(ki),ca=Ea,Ys=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line",locationType:"region",start:null,end:null})},e.prototype.getRotateAngle=function(){var t=this.getLocation(),i=t.start,o=t.end,c=this.get("text").position,p=Math.atan2(o.y-i.y,o.x-i.x),g=c==="start"?p-Math.PI/2:p+Math.PI/2;return g},e.prototype.getTextPoint=function(){var t=this.getLocation(),i=t.start,o=t.end,c=this.get("text"),p=c.position,g=c.offset;return ic(i,o,p,g)},e.prototype.getLinePath=function(){var t=this.getLocation(),i=t.start,o=t.end;return[["M",i.x,i.y],["L",o.x,o.y]]},e}(ca),xs=Ys,ru=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},e.prototype.getRotateAngle=function(){var t=this.getLocation(),i=t.startAngle,o=t.endAngle,c=this.get("text").position,p=c==="start"?i+Math.PI/2:o-Math.PI/2;return p},e.prototype.getTextPoint=function(){var t=this.get("text"),i=t.position,o=t.offset,c=this.getLocation(),p=c.center,g=c.radius,_=c.startAngle,S=c.endAngle,I=i==="start"?_:S,L=this.getRotateAngle()-Math.PI,F=nl(p,g,I),z=Math.cos(L)*o,V=Math.sin(L)*o;return{x:F.x+z,y:F.y+V}},e.prototype.getLinePath=function(){var t=this.getLocation(),i=t.center,o=t.radius,c=t.startAngle,p=t.endAngle,g=null;if(p-c===Math.PI*2){var _=i.x,S=i.y;g=[["M",_,S-o],["A",o,o,0,1,1,_,S+o],["A",o,o,0,1,1,_,S-o],["Z"]]}else{var I=nl(i,o,c),L=nl(i,o,p),F=Math.abs(p-c)>Math.PI?1:0,z=c>p?0:1;g=[["M",I.x,I.y],["A",o,o,0,F,z,L.x,L.y]]}return g},e}(ca),hu=ru,Ko="g2-crosshair",bs=Ko+"-line",Au=Ko+"-text",nu,mc=(nu={},nu[""+Ko]={position:"relative"},nu[""+bs]={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.25)"},nu[""+Au]={position:"absolute",color:va.textColor,fontFamily:va.fontFamily},nu),pu=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"crosshair",type:"html",locationType:"region",start:{x:0,y:0},end:{x:0,y:0},capture:!1,text:null,containerTpl:'<div class="'+Ko+'"></div>',crosshairTpl:'<div class="'+bs+'"></div>',textTpl:'<span class="'+Au+'">{content}</span>',domStyles:null,containerClassName:Ko,defaultStyles:mc,defaultCfg:{text:{position:"start",content:null,align:"center",offset:10}}})},e.prototype.render=function(){this.resetText(),this.resetPosition()},e.prototype.initCrossHair=function(){var t=this.getContainer(),i=this.get("crosshairTpl"),o=(0,wt.Z)(i);t.appendChild(o),this.applyStyle(bs,o),this.set("crosshairEl",o)},e.prototype.getTextPoint=function(){var t=this.getLocation(),i=t.start,o=t.end,c=this.get("text"),p=c.position,g=c.offset;return ic(i,o,p,g)},e.prototype.resetText=function(){var t=this.get("text"),i=this.get("textEl");if(t){var o=t.content;if(!i){var c=this.getContainer(),p=(0,b.ng)(this.get("textTpl"),t);i=(0,wt.Z)(p),c.appendChild(i),this.applyStyle(Au,i),this.set("textEl",i)}i.innerHTML=o}else i&&i.remove()},e.prototype.isVertical=function(t,i){return t.x===i.x},e.prototype.resetPosition=function(){var t=this.get("crosshairEl");t||(this.initCrossHair(),t=this.get("crosshairEl"));var i=this.get("start"),o=this.get("end"),c=Math.min(i.x,o.x),p=Math.min(i.y,o.y);this.isVertical(i,o)?(0,Y.Z)(t,{width:"1px",height:mo(Math.abs(o.y-i.y))}):(0,Y.Z)(t,{height:"1px",width:mo(Math.abs(o.x-i.x))}),(0,Y.Z)(t,{top:mo(p),left:mo(c)}),this.alignText()},e.prototype.alignText=function(){var t=this.get("textEl");if(t){var i=this.get("text").align,o=t.clientWidth,c=this.getTextPoint();switch(i){case"center":c.x=c.x-o/2;break;case"right":c.x=c.x-o;case"left":break}(0,Y.Z)(t,{top:mo(c.y),left:mo(c.x)})}},e.prototype.updateInner=function(t){(0,b.wH)(t,"text")&&this.resetText(),r.prototype.updateInner.call(this,t)},e}($),Vl=pu,Tl=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"grid",line:{},alternateColor:null,capture:!1,items:[],closed:!1,defaultCfg:{line:{type:"line",style:{lineWidth:1,stroke:va.lineColor}}}})},e.prototype.getLineType=function(){var t=this.get("line")||this.get("defaultCfg").line;return t.type},e.prototype.renderInner=function(t){this.drawGrid(t)},e.prototype.getAlternatePath=function(t,i){var o=this.getGridPath(t),c=i.slice(0).reverse(),p=this.getGridPath(c,!0),g=this.get("closed");return g?o=o.concat(p):(p[0][0]="L",o=o.concat(p),o.push(["Z"])),o},e.prototype.getPathStyle=function(){return this.get("line").style},e.prototype.drawGrid=function(t){var i=this,o=this.get("line"),c=this.get("items"),p=this.get("alternateColor"),g=null;(0,b.S6)(c,function(_,S){var I=_.id||S;if(o){var L=i.getPathStyle();L=(0,b.mf)(L)?L(_,S,c):L;var F=i.getElementId("line-"+I),z=i.getGridPath(_.points);i.addShape(t,{type:"path",name:"grid-line",id:F,attrs:(0,b.CD)({path:z},L)})}if(p&&S>0){var V=i.getElementId("region-"+I),Q=S%2===0;if((0,b.HD)(p))Q&&i.drawAlternateRegion(V,t,g.points,_.points,p);else{var st=Q?p[1]:p[0];i.drawAlternateRegion(V,t,g.points,_.points,st)}}g=_})},e.prototype.drawAlternateRegion=function(t,i,o,c,p){var g=this.getAlternatePath(o,c);this.addShape(i,{type:"path",id:t,name:"grid-region",attrs:{path:g,fill:p}})},e}(ki),Kf=Tl;function Qf(r,e,t,i){var o=t-r,c=i-e;return Math.sqrt(o*o+c*c)}var Ml=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",center:null,closed:!0})},e.prototype.getGridPath=function(t,i){var o=this.getLineType(),c=this.get("closed"),p=[];if(t.length)if(o==="circle"){var g=this.get("center"),_=t[0],S=Qf(g.x,g.y,_.x,_.y),I=i?0:1;c?(p.push(["M",g.x,g.y-S]),p.push(["A",S,S,0,0,I,g.x,g.y+S]),p.push(["A",S,S,0,0,I,g.x,g.y-S]),p.push(["Z"])):(0,b.S6)(t,function(L,F){F===0?p.push(["M",L.x,L.y]):p.push(["A",S,S,0,0,I,L.x,L.y])})}else(0,b.S6)(t,function(L,F){F===0?p.push(["M",L.x,L.y]):p.push(["L",L.x,L.y])}),c&&p.push(["Z"]);return p},e}(Kf),Tf=Ml,yh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line"})},e.prototype.getGridPath=function(t){var i=[];return(0,b.S6)(t,function(o,c){c===0?i.push(["M",o.x,o.y]):i.push(["L",o.x,o.y])}),i},e}(Kf),sc=yh,Jf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"legend",layout:"horizontal",locationType:"point",x:0,y:0,offsetX:0,offsetY:0,title:null,background:null})},e.prototype.getLayoutBBox=function(){var t=r.prototype.getLayoutBBox.call(this),i=this.get("maxWidth"),o=this.get("maxHeight"),c=t.width,p=t.height;return i&&(c=Math.min(c,i)),o&&(p=Math.min(p,o)),wl(t.minX,t.minY,c,p)},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},e.prototype.resetLocation=function(){var t=this.get("x"),i=this.get("y"),o=this.get("offsetX"),c=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t+o,y:i+c})},e.prototype.applyOffset=function(){this.resetLocation()},e.prototype.getDrawPoint=function(){return this.get("currentPoint")},e.prototype.setDrawPoint=function(t){return this.set("currentPoint",t)},e.prototype.renderInner=function(t){this.resetDraw(),this.get("title")&&this.drawTitle(t),this.drawLegendContent(t),this.get("background")&&this.drawBackground(t)},e.prototype.drawBackground=function(t){var i=this.get("background"),o=t.getBBox(),c=gh(i.padding),p=(0,P.pi)({x:0,y:0,width:o.width+c[1]+c[3],height:o.height+c[0]+c[2]},i.style),g=this.addShape(t,{type:"rect",id:this.getElementId("background"),name:"legend-background",attrs:p});g.toBack()},e.prototype.drawTitle=function(t){var i=this.get("currentPoint"),o=this.get("title"),c=o.spacing,p=o.style,g=o.text,_=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"legend-title",attrs:(0,P.pi)({text:g,x:i.x,y:i.y},p)}),S=_.getBBox();this.set("currentPoint",{x:i.x,y:S.maxY+c})},e.prototype.resetDraw=function(){var t=this.get("background"),i={x:0,y:0};if(t){var o=gh(t.padding);i.x=o[3],i.y=o[0]}this.set("currentPoint",i)},e}(ki),Il=Jf,Rs={marker:{style:{inactiveFill:"#000",inactiveOpacity:.45,fill:"#000",opacity:1,size:12}},text:{style:{fill:"#ccc",fontSize:12}}},iu={fill:va.textColor,fontSize:12,textAlign:"start",textBaseline:"middle",fontFamily:va.fontFamily,fontWeight:"normal",lineHeight:12},uc="navigation-arrow-right",Pc="navigation-arrow-left",Eo={right:90*Math.PI/180,left:(360-90)*Math.PI/180,up:0,down:180*Math.PI/180},Gl=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.currentPageIndex=1,t.totalPagesCnt=1,t.pageWidth=0,t.pageHeight=0,t.startX=0,t.startY=0,t.onNavigationBack=function(){var i=t.getElementByLocalId("item-group");if(t.currentPageIndex>1){t.currentPageIndex-=1,t.updateNavigation();var o=t.getCurrentNavigationMatrix();t.get("animate")?i.animate({matrix:o},100):i.attr({matrix:o})}},t.onNavigationAfter=function(){var i=t.getElementByLocalId("item-group");if(t.currentPageIndex<t.totalPagesCnt){t.currentPageIndex+=1,t.updateNavigation();var o=t.getCurrentNavigationMatrix();t.get("animate")?i.animate({matrix:o},100):i.attr({matrix:o})}},t}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"legend",type:"category",itemSpacing:24,itemMarginBottom:8,maxItemWidth:null,itemWidth:null,itemHeight:null,itemName:{},itemValue:null,maxWidth:null,maxHeight:null,marker:{},radio:null,items:[],itemStates:{},itemBackground:{},pageNavigator:{},defaultCfg:{title:{spacing:5,style:{fill:va.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}},background:{padding:5,style:{stroke:va.lineColor}},itemBackground:{style:{opacity:0,fill:"#fff"}},pageNavigator:Rs,itemName:{spacing:16,style:iu},marker:{spacing:8,style:{r:6,symbol:"circle"}},itemValue:{alignRight:!1,formatter:null,style:iu,spacing:6},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:va.uncheckedColor},markerStyle:{fill:va.uncheckedColor,stroke:va.uncheckedColor}},inactive:{nameStyle:{fill:va.uncheckedColor},markerStyle:{opacity:.2}}}}})},e.prototype.isList=function(){return!0},e.prototype.getItems=function(){return this.get("items")},e.prototype.setItems=function(t){this.update({items:t})},e.prototype.updateItem=function(t,i){(0,b.CD)(t,i),this.clear(),this.render()},e.prototype.clearItems=function(){var t=this.getElementByLocalId("item-group");t&&t.clear()},e.prototype.setItemState=function(t,i,o){t[i]=o;var c=this.getElementByLocalId("item-"+t.id);if(c){var p=this.getItems(),g=p.indexOf(t),_=this.createOffScreenGroup(),S=this.drawItem(t,g,this.getItemHeight(),_);this.updateElements(S,c),this.clearUpdateStatus(c)}},e.prototype.hasState=function(t,i){return!!t[i]},e.prototype.getItemStates=function(t){var i=this.get("itemStates"),o=[];return(0,b.S6)(i,function(c,p){t[p]&&o.push(p)}),o},e.prototype.clearItemsState=function(t){var i=this,o=this.getItemsByState(t);(0,b.S6)(o,function(c){i.setItemState(c,t,!1)})},e.prototype.getItemsByState=function(t){var i=this,o=this.getItems();return(0,b.hX)(o,function(c){return i.hasState(c,t)})},e.prototype.drawLegendContent=function(t){this.processItems(),this.drawItems(t)},e.prototype.processItems=function(){var t=this.get("items");(0,b.S6)(t,function(i){i.id||(i.id=i.name)})},e.prototype.drawItems=function(t){var i=this,o=this.addGroup(t,{id:this.getElementId("item-container-group"),name:"legend-item-container-group"}),c=this.addGroup(o,{id:this.getElementId("item-group"),name:"legend-item-group"}),p=this.getItemHeight(),g=this.get("itemWidth"),_=this.get("itemSpacing"),S=this.get("itemMarginBottom"),I=this.get("currentPoint"),L=I.x,F=I.y,z=this.get("layout"),V=this.get("items"),Q=!1,st=0,at=this.get("maxWidth"),Ft=this.get("maxHeight");(0,b.S6)(V,function(Kt,ee){var Me=i.drawItem(Kt,ee,p,c),hr=Me.getBBox(),Tr=g||hr.width;Tr>st&&(st=Tr),z==="horizontal"?(at&&at<I.x+Tr-L&&(Q=!0,I.x=L,I.y+=p+S),i.moveElementTo(Me,I),I.x+=Tr+_):(Ft&&Ft<I.y+p+S-F&&(Q=!0,I.x+=st+_,I.y=F,st=0),i.moveElementTo(Me,I),I.y+=p+S)}),Q&&this.get("flipPage")&&(this.pageHeight=0,this.pageWidth=0,this.totalPagesCnt=1,this.startX=L,this.startY=F,this.adjustNavigation(t,c))},e.prototype.getItemHeight=function(){var t=this.get("itemHeight");if(!t){var i=(this.get("itemName")||{}).style;if((0,b.mf)(i)){var o=this.getItems();o.forEach(function(c,p){var g=(0,P.pi)((0,P.pi)({},iu),i(c,p,o)).fontSize;t<g&&(t=g)})}else i&&(t=i.fontSize)}return t},e.prototype.drawMarker=function(t,i,o,c){var p=(0,P.pi)((0,P.pi)((0,P.pi)({x:0,y:c/2},i.style),{symbol:(0,b.U2)(o.marker,"symbol","circle")}),(0,b.U2)(o.marker,"style",{})),g=this.addShape(t,{type:"marker",id:this.getElementId("item-"+o.id+"-marker"),name:"legend-item-marker",attrs:p}),_=g.getBBox();g.attr("x",_.width/2);var S=g.attr(),I=S.stroke,L=S.fill;return I&&g.set("isStroke",!0),L&&g.set("isFill",!0),g},e.prototype.drawItemText=function(t,i,o,c,p,g,_){var S=o.formatter,I=o.style,L=(0,P.pi)((0,P.pi)({x:g,y:p/2,text:S?S(c[i],c,_):c[i]},iu),(0,b.mf)(I)?I(c,_,this.getItems()):I);return this.addShape(t,{type:"text",id:this.getElementId("item-"+c.id+"-"+i),name:"legend-item-"+i,attrs:L})},e.prototype.drawRadio=function(t,i,o,c,p){var g,_,S=i.style||{},I=(g=S.r)!==null&&g!==void 0?g:c/2,L=I*3.6/8,F=[p+I,c/2-I],z=F[0],V=F[1],Q=[z+I,V+I],st=Q[0],at=Q[1],Ft=[z,at+I],Kt=Ft[0],ee=Ft[1],Me=[p,V+I],hr=Me[0],Tr=Me[1],Dr=o.showRadio,cn=(0,P.pi)((0,P.pi)({path:[["M",z,V],["A",I,I,0,0,1,st,at],["L",st-L,at],["L",st,at],["A",I,I,0,0,1,Kt,ee],["L",Kt,ee-L],["L",Kt,ee],["A",I,I,0,0,1,hr,Tr],["L",hr+L,Tr],["L",hr,Tr],["A",I,I,0,0,1,z,V],["L",z,V+L]],stroke:"#000000",fill:"#ffffff"},S),{opacity:Dr?(_=S==null?void 0:S.opacity)!==null&&_!==void 0?_:.45:0}),Jr=this.addShape(t,{type:"path",id:this.getElementId("item-"+o.id+"-radio"),name:"legend-item-radio",attrs:cn});return Jr.set("tip",i.tip),Jr},e.prototype.drawItem=function(t,i,o,c){var p="item-"+t.id,g=this.addGroup(c,{name:"legend-item-container",id:this.getElementId("item-container-"+p),delegateObject:{item:t,index:i}}),_=this.addGroup(g,{name:"legend-item",id:this.getElementId(p),delegateObject:{item:t,index:i}}),S=this.get("marker"),I=this.get("itemName"),L=this.get("itemValue"),F=this.get("itemBackground"),z=this.get("radio"),V=this.getLimitItemWidth(),Q=0;if(S){var st=this.drawMarker(_,S,t,o),at=S.spacing,Ft=(0,b.U2)(t,["marker","spacing"]);(0,b.hj)(Ft)&&(at=Ft),Q=st.getBBox().maxX+at}if(I){var Kt=this.drawItemText(_,"name",I,t,o,Q,i);V&&Cl(!0,Kt,(0,b.uZ)(V-Q,0,V)),Q=Kt.getBBox().maxX+I.spacing}if(L){var ee=this.drawItemText(_,"value",L,t,o,Q,i);V&&(L.alignRight?(ee.attr({textAlign:"right",x:V}),Cl(!0,ee,(0,b.uZ)(V-Q,0,V),"head")):Cl(!0,ee,(0,b.uZ)(V-Q,0,V))),Q=ee.getBBox().maxX+L.spacing}if(z&&this.drawRadio(_,z,t,o,Q),F){var Me=_.getBBox(),hr=this.addShape(_,{type:"rect",name:"legend-item-background",id:this.getElementId(p+"-background"),attrs:(0,P.pi)({x:0,y:0,width:Me.width,height:o},F.style)});hr.toBack()}return this.applyItemStates(t,_),_},e.prototype.adjustNavigation=function(t,i){var o=this,c=this.startX,p=this.startY,g=this.get("layout"),_=i.findAll(function(Jr){return Jr.get("name")==="legend-item"}),S=this.get("maxWidth"),I=this.get("maxHeight"),L=this.get("itemWidth"),F=this.get("itemSpacing"),z=this.getItemHeight(),V=(0,b.b$)({},Rs,this.get("pageNavigator")),Q=this.drawNavigation(t,g,"00/00",V),st=Q.getBBox(),at={x:c,y:p},Ft=1,Kt=0,ee=0,Me=0,hr=this.get("itemMarginBottom");if(g==="horizontal"){var Tr=this.get("maxRow")||1,Dr=z+(Tr===1?0:hr);this.pageHeight=Dr*Tr,(0,b.S6)(_,function(Jr){var Mn=Jr.getBBox(),mi=L||Mn.width;(Kt&&Kt<at.x+mi+F||S<at.x+mi+F+st.width)&&(Ft===1&&(Kt=at.x+F,o.pageWidth=Kt,o.moveElementTo(Q,{x:S-F-st.width-st.minX,y:at.y+z/2-st.height/2-st.minY})),Ft+=1,at.x=c,at.y+=Dr),o.moveElementTo(Jr,at),Jr.getParent().setClip({type:"rect",attrs:{x:at.x,y:at.y,width:mi+F,height:z}}),at.x+=mi+F})}else{(0,b.S6)(_,function(Jr){var Mn=Jr.getBBox();Mn.width>ee&&(ee=Mn.width)}),Me=ee,ee+=F,S&&(ee=Math.min(S,ee),Me=Math.min(S,Me)),this.pageWidth=ee,this.pageHeight=I-Math.max(st.height,z+hr);var cn=Math.floor(this.pageHeight/(z+hr));(0,b.S6)(_,function(Jr,Mn){Mn!==0&&Mn%cn===0&&(Ft+=1,at.x+=ee,at.y=p),o.moveElementTo(Jr,at),Jr.getParent().setClip({type:"rect",attrs:{x:at.x,y:at.y,width:ee,height:z}}),at.y+=z+hr}),this.totalPagesCnt=Ft,this.moveElementTo(Q,{x:c+Me/2-st.width/2-st.minX,y:I-st.height-st.minY})}this.pageHeight&&this.pageWidth&&i.getParent().setClip({type:"rect",attrs:{x:this.startX,y:this.startY,width:this.pageWidth,height:this.pageHeight}}),g==="horizontal"&&this.get("maxRow")?this.totalPagesCnt=Math.ceil(Ft/this.get("maxRow")):this.totalPagesCnt=Ft,this.currentPageIndex>this.totalPagesCnt&&(this.currentPageIndex=1),this.updateNavigation(Q),i.attr("matrix",this.getCurrentNavigationMatrix())},e.prototype.drawNavigation=function(t,i,o,c){var p={x:0,y:0},g=this.addGroup(t,{id:this.getElementId("navigation-group"),name:"legend-navigation"}),_=(0,b.U2)(c.marker,"style",{}),S=_.size,I=S===void 0?12:S,L=(0,P._T)(_,["size"]),F=this.drawArrow(g,p,Pc,i==="horizontal"?"up":"left",I,L);F.on("click",this.onNavigationBack);var z=F.getBBox();p.x+=z.width+2;var V=this.addShape(g,{type:"text",id:this.getElementId("navigation-text"),name:"navigation-text",attrs:(0,P.pi)({x:p.x,y:p.y+I/2,text:o,textBaseline:"middle"},(0,b.U2)(c.text,"style"))}),Q=V.getBBox();p.x+=Q.width+2;var st=this.drawArrow(g,p,uc,i==="horizontal"?"down":"right",I,L);return st.on("click",this.onNavigationAfter),g},e.prototype.updateNavigation=function(t){var i=(0,b.b$)({},Rs,this.get("pageNavigator")),o=i.marker.style,c=o.fill,p=o.opacity,g=o.inactiveFill,_=o.inactiveOpacity,S=this.currentPageIndex+"/"+this.totalPagesCnt,I=t?t.getChildren()[1]:this.getElementByLocalId("navigation-text"),L=t?t.findById(this.getElementId(Pc)):this.getElementByLocalId(Pc),F=t?t.findById(this.getElementId(uc)):this.getElementByLocalId(uc);I.attr("text",S),L.attr("opacity",this.currentPageIndex===1?_:p),L.attr("fill",this.currentPageIndex===1?g:c),L.attr("cursor",this.currentPageIndex===1?"not-allowed":"pointer"),F.attr("opacity",this.currentPageIndex===this.totalPagesCnt?_:p),F.attr("fill",this.currentPageIndex===this.totalPagesCnt?g:c),F.attr("cursor",this.currentPageIndex===this.totalPagesCnt?"not-allowed":"pointer");var z=L.getBBox().maxX+2;I.attr("x",z),z+=I.getBBox().width+2,this.updateArrowPath(F,{x:z,y:0})},e.prototype.drawArrow=function(t,i,o,c,p,g){var _=i.x,S=i.y,I=this.addShape(t,{type:"path",id:this.getElementId(o),name:o,attrs:(0,P.pi)({size:p,direction:c,path:[["M",_+p/2,S],["L",_,S+p],["L",_+p,S+p],["Z"]],cursor:"pointer"},g)});return I.attr("matrix",El({x:_+p/2,y:S+p/2},Eo[c])),I},e.prototype.updateArrowPath=function(t,i){var o=i.x,c=i.y,p=t.attr(),g=p.size,_=p.direction,S=El({x:o+g/2,y:c+g/2},Eo[_]);t.attr("path",[["M",o+g/2,c],["L",o,c+g],["L",o+g,c+g],["Z"]]),t.attr("matrix",S)},e.prototype.getCurrentNavigationMatrix=function(){var t=this,i=t.currentPageIndex,o=t.pageWidth,c=t.pageHeight,p=this.get("layout"),g=p==="horizontal"?{x:0,y:c*(1-i)}:{x:o*(1-i),y:0};return Nl(g)},e.prototype.applyItemStates=function(t,i){var o=this.getItemStates(t),c=o.length>0;if(c){var p=i.getChildren(),g=this.get("itemStates");(0,b.S6)(p,function(_){var S=_.get("name"),I=S.split("-")[2],L=ie(t,I,g);L&&(_.attr(L),I==="marker"&&!(_.get("isStroke")&&_.get("isFill"))&&(_.get("isStroke")&&_.attr("fill",null),_.get("isFill")&&_.attr("stroke",null)))})}},e.prototype.getLimitItemWidth=function(){var t=this.get("itemWidth"),i=this.get("maxItemWidth");return i?t&&(i=t<=i?t:i):t&&(i=t),i},e}(Il),al=Gl,Oc=1.4,th=.4,kp=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"continue",min:0,max:100,value:null,colors:[],track:{},rail:{},label:{},handler:{},slidable:!0,tip:null,step:null,maxWidth:null,maxHeight:null,defaultCfg:{label:{align:"rail",spacing:5,formatter:null,style:{fontSize:12,fill:va.textColor,textBaseline:"middle",fontFamily:va.fontFamily}},handler:{size:10,style:{fill:"#fff",stroke:"#333"}},track:{},rail:{type:"color",size:20,defaultLength:100,style:{fill:"#DCDEE2"}},title:{spacing:5,style:{fill:va.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}}}})},e.prototype.isSlider=function(){return!0},e.prototype.getValue=function(){return this.getCurrentValue()},e.prototype.getRange=function(){return{min:this.get("min"),max:this.get("max")}},e.prototype.setRange=function(t,i){this.update({min:t,max:i})},e.prototype.setValue=function(t){var i=this.getValue();this.set("value",t);var o=this.get("group");this.resetTrackClip(),this.get("slidable")&&this.resetHandlers(o),this.delegateEmit("valuechanged",{originValue:i,value:t})},e.prototype.initEvent=function(){var t=this.get("group");this.bindSliderEvent(t),this.bindRailEvent(t),this.bindTrackEvent(t)},e.prototype.drawLegendContent=function(t){this.drawRail(t),this.drawLabels(t),this.fixedElements(t),this.resetTrack(t),this.resetTrackClip(t),this.get("slidable")&&this.resetHandlers(t)},e.prototype.bindSliderEvent=function(t){this.bindHandlersEvent(t)},e.prototype.bindHandlersEvent=function(t){var i=this;t.on("legend-handler-min:drag",function(o){var c=i.getValueByCanvasPoint(o.x,o.y),p=i.getCurrentValue(),g=p[1];g<c&&(g=c),i.setValue([c,g])}),t.on("legend-handler-max:drag",function(o){var c=i.getValueByCanvasPoint(o.x,o.y),p=i.getCurrentValue(),g=p[0];g>c&&(g=c),i.setValue([g,c])})},e.prototype.bindRailEvent=function(t){},e.prototype.bindTrackEvent=function(t){var i=this,o=null;t.on("legend-track:dragstart",function(c){o={x:c.x,y:c.y}}),t.on("legend-track:drag",function(c){if(o){var p=i.getValueByCanvasPoint(o.x,o.y),g=i.getValueByCanvasPoint(c.x,c.y),_=i.getCurrentValue(),S=_[1]-_[0],I=i.getRange(),L=g-p;L<0?_[0]+L>I.min?i.setValue([_[0]+L,_[1]+L]):i.setValue([I.min,I.min+S]):L>0&&(L>0&&_[1]+L<I.max?i.setValue([_[0]+L,_[1]+L]):i.setValue([I.max-S,I.max])),o={x:c.x,y:c.y}}}),t.on("legend-track:dragend",function(c){o=null})},e.prototype.drawLabels=function(t){this.drawLabel("min",t),this.drawLabel("max",t)},e.prototype.drawLabel=function(t,i){var o=this.get("label"),c=o.style,p=o.align,g=o.formatter,_=this.get(t),S=this.getLabelAlignAttrs(t,p),I="label-"+t;this.addShape(i,{type:"text",id:this.getElementId(I),name:"legend-label-"+t,attrs:(0,P.pi)((0,P.pi)({x:0,y:0,text:(0,b.mf)(g)?g(_):_},c),S)})},e.prototype.getLabelAlignAttrs=function(t,i){var o=this.isVertical(),c="center",p="middle";return o?(c="start",i!=="rail"?t==="min"?p="top":p="bottom":p="top"):i!=="rail"?(p="top",t==="min"?c="start":c="end"):(c="start",p="middle"),{textAlign:c,textBaseline:p}},e.prototype.getRailPath=function(t,i,o,c){var p=this.get("rail"),g=p.size,_=p.defaultLength,S=p.type,I=this.isVertical(),L=_,F=o,z=c;F||(F=I?g:L),z||(z=I?L:g);var V=[];return S==="color"?(V.push(["M",t,i]),V.push(["L",t+F,i]),V.push(["L",t+F,i+z]),V.push(["L",t,i+z]),V.push(["Z"])):(V.push(["M",t+F,i]),V.push(["L",t+F,i+z]),V.push(["L",t,i+z]),V.push(["Z"])),V},e.prototype.drawRail=function(t){var i=this.get("rail"),o=i.style;this.addShape(t,{type:"path",id:this.getElementId("rail"),name:"legend-rail",attrs:(0,P.pi)({path:this.getRailPath(0,0)},o)})},e.prototype.getTrackColor=function(t){var i=t.length;if(!i)return null;if(i===1)return t[0];var o;this.isVertical()?o="l(90)":o="l(0)";for(var c=0;c<i;c++){var p=c/(i-1);o+=" "+p+":"+t[c]}return o},e.prototype.getTrackPath=function(t){var i=this.getRailShape(t),o=i.attr("path");return(0,b.d9)(o)},e.prototype.getClipTrackAttrs=function(t){var i=this.getCurrentValue(),o=i[0],c=i[1],p=this.getRailBBox(t),g=this.getPointByValue(o,t),_=this.getPointByValue(c,t),S=this.isVertical(),I,L,F,z;return S?(I=p.minX,L=g.y,F=p.width,z=_.y-g.y):(I=g.x,L=p.minY,F=_.x-g.x,z=p.height),{x:I,y:L,width:F,height:z}},e.prototype.getTrackAttrs=function(t){var i=this.get("track"),o=this.get("colors"),c=this.getTrackPath(t);return(0,b.CD)({path:c,fill:this.getTrackColor(o)},i.style)},e.prototype.resetTrackClip=function(t){var i=t||this.get("group"),o=this.getElementId("track"),c=i.findById(o),p=c.getClip(),g=this.getClipTrackAttrs(t);p?p.attr(g):c.setClip({type:"rect",attrs:g})},e.prototype.resetTrack=function(t){var i=this.getElementId("track"),o=t.findById(i),c=this.getTrackAttrs(t);o?o.attr(c):this.addShape(t,{type:"path",id:i,draggable:this.get("slidable"),name:"legend-track",attrs:c})},e.prototype.getPointByValue=function(t,i){var o=this.getRange(),c=o.min,p=o.max,g=(t-c)/(p-c),_=this.getRailBBox(i),S=this.isVertical(),I={x:0,y:0};return S?(I.x=_.minX+_.width/2,I.y=eu(_.minY,_.maxY,g)):(I.x=eu(_.minX,_.maxX,g),I.y=_.minY+_.height/2),I},e.prototype.getRailShape=function(t){var i=t||this.get("group");return i.findById(this.getElementId("rail"))},e.prototype.getRailBBox=function(t){var i=this.getRailShape(t),o=i.getBBox();return o},e.prototype.getRailCanvasBBox=function(){var t=this.get("group"),i=t.findById(this.getElementId("rail")),o=i.getCanvasBBox();return o},e.prototype.isVertical=function(){return this.get("layout")==="vertical"},e.prototype.getValueByCanvasPoint=function(t,i){var o=this.getRange(),c=o.min,p=o.max,g=this.getRailCanvasBBox(),_=this.isVertical(),S=this.get("step"),I;_?I=(i-g.minY)/g.height:I=(t-g.minX)/g.width;var L=eu(c,p,I);if(S){var F=Math.round((L-c)/S);L=c+F*S}return L>p&&(L=p),L<c&&(L=c),L},e.prototype.getCurrentValue=function(){var t=this.get("value");if(!t){var i=this.get("values");return i?[Math.max(Math.min.apply(Math,(0,P.pr)(i,[this.get("max")])),this.get("min")),Math.min(Math.max.apply(Math,(0,P.pr)(i,[this.get("min")])),this.get("max"))]:[this.get("min"),this.get("max")]}return t},e.prototype.resetHandlers=function(t){var i=this.getCurrentValue(),o=i[0],c=i[1];this.resetHandler(t,"min",o),this.resetHandler(t,"max",c)},e.prototype.getHandlerPath=function(t,i){var o=this.isVertical(),c=[],p=t.size,g=i.x,_=i.y,S=p*Oc,I=p/2,L=p/6;if(o){var F=g+S*th;c.push(["M",g,_]),c.push(["L",F,_+I]),c.push(["L",g+S,_+I]),c.push(["L",g+S,_-I]),c.push(["L",F,_-I]),c.push(["Z"]),c.push(["M",F,_+L]),c.push(["L",g+S-2,_+L]),c.push(["M",F,_-L]),c.push(["L",g+S-2,_-L])}else{var z=_+S*th;c.push(["M",g,_]),c.push(["L",g-I,z]),c.push(["L",g-I,_+S]),c.push(["L",g+I,_+S]),c.push(["L",g+I,z]),c.push(["Z"]),c.push(["M",g-L,z]),c.push(["L",g-L,_+S-2]),c.push(["M",g+L,z]),c.push(["L",g+L,_+S-2])}return c},e.prototype.resetHandler=function(t,i,o){var c=this.getPointByValue(o,t),p=this.get("handler"),g=this.getHandlerPath(p,c),_=this.getElementId("handler-"+i),S=t.findById(_),I=this.isVertical();S?S.attr("path",g):this.addShape(t,{type:"path",name:"legend-handler-"+i,draggable:!0,id:_,attrs:(0,P.pi)((0,P.pi)({path:g},p.style),{cursor:I?"ns-resize":"ew-resize"})})},e.prototype.fixedElements=function(t){var i=t.findById(this.getElementId("rail")),o=t.findById(this.getElementId("label-min")),c=t.findById(this.getElementId("label-max")),p=this.getDrawPoint();this.isVertical()?this.fixedVertail(o,c,i,p):this.fixedHorizontal(o,c,i,p)},e.prototype.fitRailLength=function(t,i,o,c){var p=this.isVertical(),g=p?"height":"width",_=this.get("label"),S=_.align,I=_.spacing,L=this.get("max"+(0,b.jC)(g));if(L){var F=S==="rail"?o[g]+t[g]+i[g]+I*2:o[g],z=F-L;z>0&&this.changeRailLength(c,g,o[g]-z)}},e.prototype.changeRailLength=function(t,i,o){var c=t.getBBox(),p;i==="height"?p=this.getRailPath(c.x,c.y,c.width,o):p=this.getRailPath(c.x,c.y,o,c.height),t.attr("path",p)},e.prototype.changeRailPosition=function(t,i,o){var c=t.getBBox(),p=this.getRailPath(i,o,c.width,c.height);t.attr("path",p)},e.prototype.fixedHorizontal=function(t,i,o,c){var p=this.get("label"),g=p.align,_=p.spacing,S=o.getBBox(),I=t.getBBox(),L=i.getBBox(),F=S.height;this.fitRailLength(I,L,S,o),S=o.getBBox(),g==="rail"?(t.attr({x:c.x,y:c.y+F/2}),this.changeRailPosition(o,c.x+I.width+_,c.y),i.attr({x:c.x+I.width+S.width+_*2,y:c.y+F/2})):g==="top"?(t.attr({x:c.x,y:c.y}),i.attr({x:c.x+S.width,y:c.y}),this.changeRailPosition(o,c.x,c.y+I.height+_)):(this.changeRailPosition(o,c.x,c.y),t.attr({x:c.x,y:c.y+S.height+_}),i.attr({x:c.x+S.width,y:c.y+S.height+_}))},e.prototype.fixedVertail=function(t,i,o,c){var p=this.get("label"),g=p.align,_=p.spacing,S=o.getBBox(),I=t.getBBox(),L=i.getBBox();if(this.fitRailLength(I,L,S,o),S=o.getBBox(),g==="rail")t.attr({x:c.x,y:c.y}),this.changeRailPosition(o,c.x,c.y+I.height+_),i.attr({x:c.x,y:c.y+I.height+S.height+_*2});else if(g==="right")t.attr({x:c.x+S.width+_,y:c.y}),this.changeRailPosition(o,c.x,c.y),i.attr({x:c.x+S.width+_,y:c.y+S.height});else{var F=Math.max(I.width,L.width);t.attr({x:c.x,y:c.y}),this.changeRailPosition(o,c.x+F+_,c.y),i.attr({x:c.x,y:c.y+S.height})}},e}(Il),fd=kp,au="g2-tooltip",kl="g2-tooltip-title",ol="g2-tooltip-list",yc="g2-tooltip-list-item",Mf="g2-tooltip-marker",Ll="g2-tooltip-value",ou="g2-tooltip-name",Fc="g2-tooltip-crosshair-x",_h="g2-tooltip-crosshair-y",_c,hd=(_c={},_c[""+au]={position:"absolute",visibility:"visible",zIndex:8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0px 0px 10px #aeaeae",borderRadius:"3px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:va.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},_c[""+kl]={marginBottom:"4px"},_c[""+ol]={margin:"0px",listStyleType:"none",padding:"0px"},_c[""+yc]={listStyleType:"none",marginBottom:"4px"},_c[""+Mf]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},_c[""+Ll]={display:"inline-block",float:"right",marginLeft:"30px"},_c[""+Fc]={position:"absolute",width:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},_c[""+_h]={position:"absolute",height:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},_c);function rv(r,e,t,i,o){var c={left:r<o.x,right:r+t>o.x+o.width,top:e<o.y,bottom:e+i>o.y+o.height};return c}function nv(r,e,t,i,o,c){var p=r,g=e;switch(c){case"left":p=r-i-t,g=e-o/2;break;case"right":p=r+t,g=e-o/2;break;case"top":p=r-i/2,g=e-o-t;break;case"bottom":p=r-i/2,g=e+t;break;default:p=r+t,g=e-o-t;break}return{x:p,y:g}}function If(r,e,t,i,o,c,p){var g=nv(r,e,t,i,o,c);if(p){var _=rv(g.x,g.y,i,o,p);c==="auto"?(_.right&&(g.x=Math.max(0,r-i-t)),_.top&&(g.y=Math.max(0,e-o-t))):c==="top"||c==="bottom"?(_.left&&(g.x=p.x),_.right&&(g.x=p.x+p.width-i),c==="top"&&_.top&&(g.y=e+t),c==="bottom"&&_.bottom&&(g.y=e-o-t)):(_.top&&(g.y=p.y),_.bottom&&(g.y=p.y+p.height-o),c==="left"&&_.left&&(g.x=r+t),c==="right"&&_.right&&(g.x=r-i-t))}return g}function pd(r,e){var t=!1;return(0,b.S6)(e,function(i){if((0,b.wH)(r,i))return t=!0,!1}),t}var iv=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"tooltip",type:"html",x:0,y:0,items:[],customContent:null,containerTpl:'<div class="'+au+'"><div class="'+kl+'"></div><ul class="'+ol+'"></ul></div>',itemTpl:'<li class="'+yc+`" data-index={index}>
          <span class="`+Mf+`" style="background:{color}"></span>
          <span class="`+ou+`">{name}</span>:
          <span class="`+Ll+`">{value}</span>
        </li>`,xCrosshairTpl:'<div class="'+Fc+'"></div>',yCrosshairTpl:'<div class="'+_h+'"></div>',title:null,showTitle:!0,region:null,crosshairsRegion:null,containerClassName:au,crosshairs:null,offset:10,position:"right",domStyles:null,defaultStyles:hd})},e.prototype.render=function(){this.get("customContent")?this.renderCustomContent():(this.resetTitle(),this.renderItems()),this.resetPosition()},e.prototype.clear=function(){this.clearCrosshairs(),this.setTitle(""),this.clearItemDoms()},e.prototype.show=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!0),(0,Y.Z)(t,{visibility:"visible"}),this.setCrossHairsVisible(!0))},e.prototype.hide=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!1),(0,Y.Z)(t,{visibility:"hidden"}),this.setCrossHairsVisible(!1))},e.prototype.getLocation=function(){return{x:this.get("x"),y:this.get("y")}},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetPosition()},e.prototype.setCrossHairsVisible=function(t){var i=t?"":"none",o=this.get("xCrosshairDom"),c=this.get("yCrosshairDom");o&&(0,Y.Z)(o,{display:i}),c&&(0,Y.Z)(c,{display:i})},e.prototype.initContainer=function(){if(r.prototype.initContainer.call(this),this.get("customContent")){this.get("container")&&this.get("container").remove();var t=this.getHtmlContentNode();this.get("parent").appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()}},e.prototype.updateInner=function(t){this.get("customContent")?this.renderCustomContent():(pd(t,["title","showTitle"])&&this.resetTitle(),(0,b.wH)(t,"items")&&this.renderItems()),r.prototype.updateInner.call(this,t)},e.prototype.initDom=function(){this.cacheDoms()},e.prototype.removeDom=function(){r.prototype.removeDom.call(this),this.clearCrosshairs()},e.prototype.resetPosition=function(){var t=this.get("x"),i=this.get("y"),o=this.get("offset"),c=this.getOffset(),p=c.offsetX,g=c.offsetY,_=this.get("position"),S=this.get("region"),I=this.getContainer(),L=this.getBBox(),F=L.width,z=L.height,V;S&&(V=wu(S));var Q=If(t,i,o,F,z,_,V);(0,Y.Z)(I,{left:mo(Q.x+p),top:mo(Q.y+g)}),this.resetCrosshairs()},e.prototype.renderCustomContent=function(){var t=this.getHtmlContentNode(),i=this.get("parent"),o=this.get("container");o&&o.parentNode===i?i.replaceChild(t,o):i.appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()},e.prototype.getHtmlContentNode=function(){var t,i=this.get("customContent");if(i){var o=i(this.get("title"),this.get("items"));(0,b.kK)(o)?t=o:t=(0,wt.Z)(o)}return t},e.prototype.cacheDoms=function(){var t=this.getContainer(),i=t.getElementsByClassName(kl)[0],o=t.getElementsByClassName(ol)[0];this.set("titleDom",i),this.set("listDom",o)},e.prototype.resetTitle=function(){var t=this.get("title"),i=this.get("showTitle");i&&t?this.setTitle(t):this.setTitle("")},e.prototype.setTitle=function(t){var i=this.get("titleDom");i&&(i.innerText=t)},e.prototype.resetCrosshairs=function(){var t=this.get("crosshairsRegion"),i=this.get("crosshairs");if(!t||!i)this.clearCrosshairs();else{var o=wu(t),c=this.get("xCrosshairDom"),p=this.get("yCrosshairDom");i==="x"?(this.resetCrosshair("x",o),p&&(p.remove(),this.set("yCrosshairDom",null))):i==="y"?(this.resetCrosshair("y",o),c&&(c.remove(),this.set("xCrosshairDom",null))):(this.resetCrosshair("x",o),this.resetCrosshair("y",o)),this.setCrossHairsVisible(this.get("visible"))}},e.prototype.resetCrosshair=function(t,i){var o=this.checkCrosshair(t),c=this.get(t);t==="x"?(0,Y.Z)(o,{left:mo(c),top:mo(i.y),height:mo(i.height)}):(0,Y.Z)(o,{top:mo(c),left:mo(i.x),width:mo(i.width)})},e.prototype.checkCrosshair=function(t){var i=t+"CrosshairDom",o=t+"CrosshairTpl",c="CROSSHAIR_"+t.toUpperCase(),p=pt[c],g=this.get(i),_=this.get("parent");return g||(g=(0,wt.Z)(this.get(o)),this.applyStyle(p,g),_.appendChild(g),this.set(i,g)),g},e.prototype.renderItems=function(){this.clearItemDoms();var t=this.get("items"),i=this.get("itemTpl"),o=this.get("listDom");o&&((0,b.S6)(t,function(c){var p=_a.toCSSGradient(c.color),g=(0,P.pi)((0,P.pi)({},c),{color:p}),_=(0,b.ng)(i,g),S=(0,wt.Z)(_);o.appendChild(S)}),this.applyChildrenStyles(o,this.get("domStyles")))},e.prototype.clearItemDoms=function(){this.get("listDom")&&rf(this.get("listDom"))},e.prototype.clearCrosshairs=function(){var t=this.get("xCrosshairDom"),i=this.get("yCrosshairDom");t&&t.remove(),i&&i.remove(),this.set("xCrosshairDom",null),this.set("yCrosshairDom",null)},e}($),W0=iv,eh={opacity:0},dd={stroke:"#C5C5C5",strokeOpacity:.85},Og={fill:"#CACED4",opacity:.85},xh=nt(34357);function bh(r){return(0,b.UI)(r,function(e,t){var i=t===0?"M":"L",o=e[0],c=e[1];return[i,o,c]})}function Lp(r){return bh(r)}function Qv(r){if(r.length<=2)return Lp(r);var e=[];(0,b.S6)(r,function(p){(0,b.Xy)(p,e.slice(e.length-2))||e.push(p[0],p[1])});var t=(0,xh.e9)(e,!1),i=(0,b.YM)(r),o=i[0],c=i[1];return t.unshift(["M",o,c]),t}function Fg(r,e,t,i){i===void 0&&(i=!0);var o=new Br({values:r}),c=new zn({values:(0,b.UI)(r,function(g,_){return _})}),p=(0,b.UI)(r,function(g,_){return[c.scale(_)*e,t-o.scale(g)*t]});return i?Qv(p):Lp(p)}function rh(r,e){var t=new Br({values:r}),i=t.max<0?t.max:Math.max(0,t.min);return e-t.scale(i)*e}function ei(r,e,t,i){var o=(0,P.pr)(r),c=rh(i,t);return o.push(["L",e,c]),o.push(["L",0,c]),o.push(["Z"]),o}var av=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"trend",x:0,y:0,width:200,height:16,smooth:!0,isArea:!1,data:[],backgroundStyle:eh,lineStyle:dd,areaStyle:Og})},e.prototype.renderInner=function(t){var i=this.cfg,o=i.width,c=i.height,p=i.data,g=i.smooth,_=i.isArea,S=i.backgroundStyle,I=i.lineStyle,L=i.areaStyle;this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:(0,P.pi)({x:0,y:0,width:o,height:c},S)});var F=Fg(p,o,c,g);if(this.addShape(t,{id:this.getElementId("line"),type:"path",attrs:(0,P.pi)({path:F},I)}),_){var z=ei(F,o,c,p);this.addShape(t,{id:this.getElementId("area"),type:"path",attrs:(0,P.pi)({path:z},L)})}},e.prototype.applyOffset=function(){var t=this.cfg,i=t.x,o=t.y;this.moveElementTo(this.get("group"),{x:i,y:o})},e}(ki),ov=null,Tu={fill:"#F7F7F7",stroke:"#BFBFBF",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#FFF"},ls=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"handler",x:0,y:0,width:10,height:24,style:Tu})},e.prototype.renderInner=function(t){var i=this.cfg,o=i.width,c=i.height,p=i.style,g=p.fill,_=p.stroke,S=p.radius,I=p.opacity,L=p.cursor;this.addShape(t,{type:"rect",id:this.getElementId("background"),attrs:{x:0,y:0,width:o,height:c,fill:g,stroke:_,radius:S,opacity:I,cursor:L}});var F=1/3*o,z=2/3*o,V=1/4*c,Q=3/4*c;this.addShape(t,{id:this.getElementId("line-left"),type:"line",attrs:{x1:F,y1:V,x2:F,y2:Q,stroke:_,cursor:L}}),this.addShape(t,{id:this.getElementId("line-right"),type:"line",attrs:{x1:z,y1:V,x2:z,y2:Q,stroke:_,cursor:L}})},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.bindEvents=function(){var t=this;this.get("group").on("mouseenter",function(){var i=t.get("style").highLightFill;t.getElementByLocalId("background").attr("fill",i),t.draw()}),this.get("group").on("mouseleave",function(){var i=t.get("style").fill;t.getElementByLocalId("background").attr("fill",i),t.draw()})},e.prototype.draw=function(){var t=this.get("container").get("canvas");t&&t.draw()},e}(ki),Eh=null,sv={fill:"#416180",opacity:.05},af={fill:"#5B8FF9",opacity:.15,cursor:"move"},Rc=10,jh={width:Rc,height:24},Jv={textBaseline:"middle",fill:"#000",opacity:.45},vd="sliderchange",of=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.onMouseDown=function(i){return function(o){t.currentTarget=i;var c=o.originalEvent;c.stopPropagation(),c.preventDefault(),t.prevX=(0,b.U2)(c,"touches.0.pageX",c.pageX),t.prevY=(0,b.U2)(c,"touches.0.pageY",c.pageY);var p=t.getContainerDOM();p.addEventListener("mousemove",t.onMouseMove),p.addEventListener("mouseup",t.onMouseUp),p.addEventListener("mouseleave",t.onMouseUp),p.addEventListener("touchmove",t.onMouseMove),p.addEventListener("touchend",t.onMouseUp),p.addEventListener("touchcancel",t.onMouseUp)}},t.onMouseMove=function(i){var o=t.cfg.width,c=[t.get("start"),t.get("end")];i.stopPropagation(),i.preventDefault();var p=(0,b.U2)(i,"touches.0.pageX",i.pageX),g=(0,b.U2)(i,"touches.0.pageY",i.pageY),_=p-t.prevX,S=t.adjustOffsetRange(_/o);t.updateStartEnd(S),t.updateUI(t.getElementByLocalId("foreground"),t.getElementByLocalId("minText"),t.getElementByLocalId("maxText")),t.prevX=p,t.prevY=g,t.draw(),t.emit(vd,[t.get("start"),t.get("end")].sort()),t.delegateEmit("valuechanged",{originValue:c,value:[t.get("start"),t.get("end")]})},t.onMouseUp=function(){t.currentTarget&&(t.currentTarget=void 0);var i=t.getContainerDOM();i&&(i.removeEventListener("mousemove",t.onMouseMove),i.removeEventListener("mouseup",t.onMouseUp),i.removeEventListener("mouseleave",t.onMouseUp),i.removeEventListener("touchmove",t.onMouseMove),i.removeEventListener("touchend",t.onMouseUp),i.removeEventListener("touchcancel",t.onMouseUp))},t}return e.prototype.setRange=function(t,i){this.set("minLimit",t),this.set("maxLimit",i);var o=this.get("start"),c=this.get("end"),p=(0,b.uZ)(o,t,i),g=(0,b.uZ)(c,t,i);!this.get("isInit")&&(o!==p||c!==g)&&this.setValue([p,g])},e.prototype.getRange=function(){return{min:this.get("minLimit")||0,max:this.get("maxLimit")||1}},e.prototype.setValue=function(t){var i=this.getRange();if((0,b.kJ)(t)&&t.length===2){var o=[this.get("start"),this.get("end")];this.update({start:(0,b.uZ)(t[0],i.min,i.max),end:(0,b.uZ)(t[1],i.min,i.max)}),this.get("updateAutoRender")||this.render(),this.delegateEmit("valuechanged",{originValue:o,value:t})}},e.prototype.getValue=function(){return[this.get("start"),this.get("end")]},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"slider",x:0,y:0,width:100,height:16,backgroundStyle:{},foregroundStyle:{},handlerStyle:{},textStyle:{},defaultCfg:{backgroundStyle:sv,foregroundStyle:af,handlerStyle:jh,textStyle:Jv}})},e.prototype.update=function(t){var i=t.start,o=t.end,c=(0,P.pi)({},t);(0,b.UM)(i)||(c.start=(0,b.uZ)(i,0,1)),(0,b.UM)(o)||(c.end=(0,b.uZ)(o,0,1)),r.prototype.update.call(this,c),this.minHandler=this.getChildComponentById(this.getElementId("minHandler")),this.maxHandler=this.getChildComponentById(this.getElementId("maxHandler")),this.trend=this.getChildComponentById(this.getElementId("trend"))},e.prototype.init=function(){this.set("start",(0,b.uZ)(this.get("start"),0,1)),this.set("end",(0,b.uZ)(this.get("end"),0,1)),r.prototype.init.call(this)},e.prototype.render=function(){r.prototype.render.call(this),this.updateUI(this.getElementByLocalId("foreground"),this.getElementByLocalId("minText"),this.getElementByLocalId("maxText"))},e.prototype.renderInner=function(t){var i=this.cfg,o=i.start,c=i.end,p=i.width,g=i.height,_=i.trendCfg,S=_===void 0?{}:_,I=i.minText,L=i.maxText,F=i.backgroundStyle,z=F===void 0?{}:F,V=i.foregroundStyle,Q=V===void 0?{}:V,st=i.textStyle,at=st===void 0?{}:st,Ft=(0,b.b$)({},Tu,this.cfg.handlerStyle),Kt=o*p,ee=c*p;(0,b.dp)((0,b.U2)(S,"data"))&&(this.trend=this.addComponent(t,(0,P.pi)({component:av,id:this.getElementId("trend"),x:0,y:0,width:p,height:g},S))),this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:(0,P.pi)({x:0,y:0,width:p,height:g},z)});var Me=this.addShape(t,{id:this.getElementId("minText"),type:"text",attrs:(0,P.pi)({y:g/2,textAlign:"right",text:I,silent:!1},at)}),hr=this.addShape(t,{id:this.getElementId("maxText"),type:"text",attrs:(0,P.pi)({y:g/2,textAlign:"left",text:L,silent:!1},at)}),Tr=this.addShape(t,{id:this.getElementId("foreground"),name:"foreground",type:"rect",attrs:(0,P.pi)({y:0,height:g},Q)}),Dr=(0,b.U2)(Ft,"width",Rc),cn=(0,b.U2)(Ft,"height",24);this.minHandler=this.addComponent(t,{component:ls,id:this.getElementId("minHandler"),name:"handler-min",x:0,y:(g-cn)/2,width:Dr,height:cn,cursor:"ew-resize",style:Ft}),this.maxHandler=this.addComponent(t,{component:ls,id:this.getElementId("maxHandler"),name:"handler-max",x:0,y:(g-cn)/2,width:Dr,height:cn,cursor:"ew-resize",style:Ft})},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.updateUI=function(t,i,o){var c=this.cfg,p=c.start,g=c.end,_=c.width,S=c.minText,I=c.maxText,L=c.handlerStyle,F=c.height,z=p*_,V=g*_;this.trend&&(this.trend.update({width:_,height:F}),this.get("updateAutoRender")||this.trend.render()),t.attr("x",z),t.attr("width",V-z);var Q=(0,b.U2)(L,"width",Rc);i.attr("text",S),o.attr("text",I);var st=this._dodgeText([z,V],i,o),at=st[0],Ft=st[1];this.minHandler&&(this.minHandler.update({x:z-Q/2}),this.get("updateAutoRender")||this.minHandler.render()),(0,b.S6)(at,function(Kt,ee){return i.attr(ee,Kt)}),this.maxHandler&&(this.maxHandler.update({x:V-Q/2}),this.get("updateAutoRender")||this.maxHandler.render()),(0,b.S6)(Ft,function(Kt,ee){return o.attr(ee,Kt)})},e.prototype.bindEvents=function(){var t=this.get("group");t.on("handler-min:mousedown",this.onMouseDown("minHandler")),t.on("handler-min:touchstart",this.onMouseDown("minHandler")),t.on("handler-max:mousedown",this.onMouseDown("maxHandler")),t.on("handler-max:touchstart",this.onMouseDown("maxHandler"));var i=t.findById(this.getElementId("foreground"));i.on("mousedown",this.onMouseDown("foreground")),i.on("touchstart",this.onMouseDown("foreground"))},e.prototype.adjustOffsetRange=function(t){var i=this.cfg,o=i.start,c=i.end;switch(this.currentTarget){case"minHandler":{var p=0-o,g=1-o;return Math.min(g,Math.max(p,t))}case"maxHandler":{var p=0-c,g=1-c;return Math.min(g,Math.max(p,t))}case"foreground":{var p=0-o,g=1-c;return Math.min(g,Math.max(p,t))}}},e.prototype.updateStartEnd=function(t){var i=this.cfg,o=i.start,c=i.end;switch(this.currentTarget){case"minHandler":o+=t;break;case"maxHandler":c+=t;break;case"foreground":o+=t,c+=t;break}this.set("start",o),this.set("end",c)},e.prototype._dodgeText=function(t,i,o){var c,p,g=this.cfg,_=g.handlerStyle,S=g.width,I=2,L=(0,b.U2)(_,"width",Rc),F=t[0],z=t[1],V=!1;F>z&&(c=[z,F],F=c[0],z=c[1],p=[o,i],i=p[0],o=p[1],V=!0);var Q=i.getBBox(),st=o.getBBox(),at=Q.width>F-I?{x:F+L/2+I,textAlign:"left"}:{x:F-L/2-I,textAlign:"right"},Ft=st.width>S-z-I?{x:z-L/2-I,textAlign:"right"}:{x:z+L/2+I,textAlign:"left"};return V?[Ft,at]:[at,Ft]},e.prototype.draw=function(){var t=this.get("container"),i=t&&t.get("canvas");i&&i.draw()},e.prototype.getContainerDOM=function(){var t=this.get("container"),i=t&&t.get("canvas");return i&&i.get("container")},e}(ki),Wh=null;function xc(r,e,t){if(r){if(typeof r.addEventListener=="function")return r.addEventListener(e,t,!1),{remove:function(){r.removeEventListener(e,t,!1)}};if(typeof r.attachEvent=="function")return r.attachEvent("on"+e,t),{remove:function(){r.detachEvent("on"+e,t)}}}}var gd={trackColor:"rgba(0,0,0,0)",thumbColor:"rgba(0,0,0,0.15)",size:8,lineCap:"round"},nh={default:gd,hover:{thumbColor:"rgba(0,0,0,0.2)"}},t0=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.clearEvents=b.ZT,t.onStartEvent=function(i){return function(o){t.isMobile=i,o.originalEvent.preventDefault();var c=i?(0,b.U2)(o.originalEvent,"touches.0.clientX"):o.clientX,p=i?(0,b.U2)(o.originalEvent,"touches.0.clientY"):o.clientY;t.startPos=t.cfg.isHorizontal?c:p,t.bindLaterEvent()}},t.bindLaterEvent=function(){var i=t.getContainerDOM(),o=[];t.isMobile?o=[xc(i,"touchmove",t.onMouseMove),xc(i,"touchend",t.onMouseUp),xc(i,"touchcancel",t.onMouseUp)]:o=[xc(i,"mousemove",t.onMouseMove),xc(i,"mouseup",t.onMouseUp),xc(i,"mouseleave",t.onMouseUp)],t.clearEvents=function(){o.forEach(function(c){c.remove()})}},t.onMouseMove=function(i){var o=t.cfg,c=o.isHorizontal,p=o.thumbOffset;i.preventDefault();var g=t.isMobile?(0,b.U2)(i,"touches.0.clientX"):i.clientX,_=t.isMobile?(0,b.U2)(i,"touches.0.clientY"):i.clientY,S=c?g:_,I=S-t.startPos;t.startPos=S,t.updateThumbOffset(p+I)},t.onMouseUp=function(i){i.preventDefault(),t.clearEvents()},t.onTrackClick=function(i){var o=t.cfg,c=o.isHorizontal,p=o.x,g=o.y,_=o.thumbLen,S=t.getContainerDOM(),I=S.getBoundingClientRect(),L=i.clientX,F=i.clientY,z=c?L-I.left-p-_/2:F-I.top-g-_/2,V=t.validateRange(z);t.updateThumbOffset(V)},t.onThumbMouseOver=function(){var i=t.cfg.theme.hover.thumbColor;t.getElementByLocalId("thumb").attr("stroke",i),t.draw()},t.onThumbMouseOut=function(){var i=t.cfg.theme.default.thumbColor;t.getElementByLocalId("thumb").attr("stroke",i),t.draw()},t}return e.prototype.setRange=function(t,i){this.set("minLimit",t),this.set("maxLimit",i);var o=this.getValue(),c=(0,b.uZ)(o,t,i);o!==c&&!this.get("isInit")&&this.setValue(c)},e.prototype.getRange=function(){var t=this.get("minLimit")||0,i=this.get("maxLimit")||1;return{min:t,max:i}},e.prototype.setValue=function(t){var i=this.getRange(),o=this.getValue();this.update({thumbOffset:(this.get("trackLen")-this.get("thumbLen"))*(0,b.uZ)(t,i.min,i.max)}),this.delegateEmit("valuechange",{originalValue:o,value:this.getValue()})},e.prototype.getValue=function(){return(0,b.uZ)(this.get("thumbOffset")/(this.get("trackLen")-this.get("thumbLen")),0,1)},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"scrollbar",isHorizontal:!0,minThumbLen:20,thumbOffset:0,theme:nh})},e.prototype.renderInner=function(t){this.renderTrackShape(t),this.renderThumbShape(t)},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.renderTrackShape=function(t){var i=this.cfg,o=i.trackLen,c=i.theme,p=c===void 0?{default:{}}:c,g=(0,b.b$)({},nh,p).default,_=g.lineCap,S=g.trackColor,I=g.size,L=(0,b.U2)(this.cfg,"size",I),F=this.get("isHorizontal")?{x1:0+L/2,y1:L/2,x2:o-L/2,y2:L/2,lineWidth:L,stroke:S,lineCap:_}:{x1:L/2,y1:0+L/2,x2:L/2,y2:o-L/2,lineWidth:L,stroke:S,lineCap:_};return this.addShape(t,{id:this.getElementId("track"),name:"track",type:"line",attrs:F})},e.prototype.renderThumbShape=function(t){var i=this.cfg,o=i.thumbOffset,c=i.thumbLen,p=i.theme,g=(0,b.b$)({},nh,p).default,_=g.size,S=g.lineCap,I=g.thumbColor,L=(0,b.U2)(this.cfg,"size",_),F=this.get("isHorizontal")?{x1:o+L/2,y1:L/2,x2:o+c-L/2,y2:L/2,lineWidth:L,stroke:I,lineCap:S,cursor:"default"}:{x1:L/2,y1:o+L/2,x2:L/2,y2:o+c-L/2,lineWidth:L,stroke:I,lineCap:S,cursor:"default"};return this.addShape(t,{id:this.getElementId("thumb"),name:"thumb",type:"line",attrs:F})},e.prototype.bindEvents=function(){var t=this.get("group");t.on("mousedown",this.onStartEvent(!1)),t.on("mouseup",this.onMouseUp),t.on("touchstart",this.onStartEvent(!0)),t.on("touchend",this.onMouseUp);var i=t.findById(this.getElementId("track"));i.on("click",this.onTrackClick);var o=t.findById(this.getElementId("thumb"));o.on("mouseover",this.onThumbMouseOver),o.on("mouseout",this.onThumbMouseOut)},e.prototype.getContainerDOM=function(){var t=this.get("container"),i=t&&t.get("canvas");return i&&i.get("container")},e.prototype.validateRange=function(t){var i=this.cfg,o=i.thumbLen,c=i.trackLen,p=t;return t+o>c?p=c-o:t+o<o&&(p=0),p},e.prototype.draw=function(){var t=this.get("container"),i=t&&t.get("canvas");i&&i.draw()},e.prototype.updateThumbOffset=function(t){var i=this.cfg,o=i.thumbOffset,c=i.isHorizontal,p=i.thumbLen,g=i.size,_=this.validateRange(t);if(_!==o){var S=this.getElementByLocalId("thumb");c?S.attr({x1:_+g/2,x2:_+p-g/2}):S.attr({y1:_+g/2,y2:_+p-g/2}),this.emitOffsetChange(_)}},e.prototype.emitOffsetChange=function(t){var i=this.cfg,o=i.thumbOffset,c=i.trackLen,p=i.thumbLen;this.cfg.thumbOffset=t,this.emit("scrollchange",{thumbOffset:t,ratio:(0,b.uZ)(t/(c-p),0,1)}),this.delegateEmit("valuechange",{originalValue:o,value:t})},e}(ki),md=Aa,uv=Ba,Pp=sc,Xh=Tf,gl=al,yd=fd,kf=W0;function Op(r){if((0,b.xb)(r))return null;var e=r[0].x,t=r[0].x,i=r[0].y,o=r[0].y;return(0,b.S6)(r,function(c){e=e>c.x?c.x:e,t=t<c.x?c.x:t,i=i>c.y?c.y:i,o=o<c.y?c.y:o}),{minX:e,maxX:t,minY:i,maxY:o,centerX:(e+t)/2,centerY:(i+o)/2}}function Fp(r){return Array.from(new Set(r)).length===1}function _d(r){return((0,b.VV)(r)+(0,b.Fp)(r))/2}function cs(r,e,t,i){return{x:r+t*Math.cos(i),y:e+t*Math.sin(i)}}function sl(r,e,t,i,o,c){c===void 0&&(c=0);var p=cs(r,e,t,i),g=cs(r,e,t,o),_=cs(r,e,c,i),S=cs(r,e,c,o);if(o-i===Math.PI*2){var I=cs(r,e,t,i+Math.PI),L=cs(r,e,c,i+Math.PI),F=[["M",p.x,p.y],["A",t,t,0,1,1,I.x,I.y],["A",t,t,0,1,1,g.x,g.y],["M",_.x,_.y]];return c&&(F.push(["A",c,c,0,1,0,L.x,L.y]),F.push(["A",c,c,0,1,0,S.x,S.y])),F.push(["M",p.x,p.y]),F.push(["Z"]),F}var z=o-i<=Math.PI?0:1,V=[["M",p.x,p.y],["A",t,t,0,z,1,g.x,g.y],["L",S.x,S.y]];return c&&V.push(["A",c,c,0,z,0,_.x,_.y]),V.push(["L",p.x,p.y]),V.push(["Z"]),V}function e0(r,e,t,i,o){var c=cs(r,e,t,i),p=cs(r,e,t,o);if((0,b.vQ)(o-i,Math.PI*2)){var g=cs(r,e,t,i+Math.PI);return[["M",c.x,c.y],["A",t,t,0,1,1,g.x,g.y],["A",t,t,0,1,1,c.x,c.y],["A",t,t,0,1,0,g.x,g.y],["A",t,t,0,1,0,c.x,c.y],["Z"]]}var _=o-i<=Math.PI?0:1;return[["M",c.x,c.y],["A",t,t,0,_,1,p.x,p.y]]}function wh(r,e){var t=r.points,i=Op(t),o,c,p=e.startAngle,g=e.endAngle,_=g-p;return e.isTransposed?(o=i.maxY*_,c=i.minY*_):(o=i.maxX*_,c=i.minX*_),o+=p,c+=p,{startAngle:c,endAngle:o}}function X0(r,e){if((0,b.hj)(r)&&(0,b.hj)(e))return[r,e];if(r=r,e=e,Fp(r)||Fp(e))return[_d(r),_d(e)];for(var t=-1,i=0,o=0,c,p=r.length-1,g,_=0;++t<r.length;)c=p,p=t,_+=g=r[c]*e[p]-r[p]*e[c],i+=(r[c]+r[p])*g,o+=(e[c]+e[p])*g;return _*=3,[i/_,o/_]}function Y0(r,e){var t=r.attr(),i=e.attr();return(0,b.S6)(t,function(o,c){i[c]===void 0&&(i[c]=void 0)}),i}function Rp(r,e,t){var i=Math.min(e,t),o=Math.max(e,t);return r>=i&&r<=o}function Hl(r,e,t){if((0,b.HD)(r))return r.padEnd(e,t);if((0,b.kJ)(r)){var i=r.length;if(i<e)for(var o=e-i,c=0;c<o;c++)r.push(t)}return r}function Mu(r,e){return typeof r=="object"&&e.forEach(function(t){delete r[t]}),r}function bc(r,e,t){var i,o;e===void 0&&(e=[]),t===void 0&&(t=new Map);try{for(var c=(0,P.XA)(r),p=c.next();!p.done;p=c.next()){var g=p.value;t.has(g)||(e.push(g),t.set(g,!0))}}catch(_){i={error:_}}finally{try{p&&!p.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}return e}var Iu=function(){function r(e,t,i,o){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),o===void 0&&(o=0),this.x=e,this.y=t,this.height=o,this.width=i}return r.fromRange=function(e,t,i,o){return new r(e,t,i-e,o-t)},r.fromObject=function(e){return new r(e.minX,e.minY,e.width,e.height)},Object.defineProperty(r.prototype,"minX",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minY",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tl",{get:function(){return{x:this.x,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tr",{get:function(){return{x:this.maxX,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bl",{get:function(){return{x:this.x,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"br",{get:function(){return{x:this.maxX,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return{x:this.x+this.width/2,y:this.minY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return{x:this.maxX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return{x:this.x+this.width/2,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return{x:this.minX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),r.prototype.isEqual=function(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},r.prototype.contains=function(e){return e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.clone();return(0,b.S6)(e,function(o){i.x=Math.min(o.x,i.x),i.y=Math.min(o.y,i.y),i.width=Math.max(o.maxX,i.maxX)-i.x,i.height=Math.max(o.maxY,i.maxY)-i.y}),i},r.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.clone();return(0,b.S6)(e,function(o){i.x=Math.max(o.x,i.x),i.y=Math.max(o.y,i.y),i.width=Math.min(o.maxX,i.maxX)-i.x,i.height=Math.min(o.maxY,i.maxY)-i.y}),i},r.prototype.cut=function(e,t){var i=e.width,o=e.height;switch(t){case le.TOP:case le.TOP_LEFT:case le.TOP_RIGHT:return r.fromRange(this.minX,this.minY+o,this.maxX,this.maxY);case le.RIGHT:case le.RIGHT_TOP:case le.RIGHT_BOTTOM:return r.fromRange(this.minX,this.minY,this.maxX-i,this.maxY);case le.BOTTOM:case le.BOTTOM_LEFT:case le.BOTTOM_RIGHT:return r.fromRange(this.minX,this.minY,this.maxX,this.maxY-o);case le.LEFT:case le.LEFT_TOP:case le.LEFT_BOTTOM:return r.fromRange(this.minX+i,this.minY,this.maxX,this.maxY);default:return this}},r.prototype.shrink=function(e){var t=(0,P.CR)(e,4),i=t[0],o=t[1],c=t[2],p=t[3];return new r(this.x+p,this.y+i,this.width-p-o,this.height-i-c)},r.prototype.expand=function(e){var t=(0,P.CR)(e,4),i=t[0],o=t[1],c=t[2],p=t[3];return new r(this.x-p,this.y-i,this.width+p+o,this.height+i+c)},r.prototype.exceed=function(e){return[Math.max(-this.minY+e.minY,0),Math.max(this.maxX-e.maxX,0),Math.max(this.maxY-e.maxY,0),Math.max(-this.minX+e.minX,0)]},r.prototype.collide=function(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY},r.prototype.size=function(){return this.width*this.height},r.prototype.isPointIn=function(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY},r}(),Lf=function(r,e){var t=e.start,i=e.end;return new Iu(r.x+r.width*t.x,r.y+r.height*t.y,r.width*Math.abs(i.x-t.x),r.height*Math.abs(i.y-t.y))};function Rg(r){return[[r.minX,r.minY],[r.maxX,r.minY],[r.maxX,r.maxY],[r.minX,r.maxY]]}function xd(r){if(r.isPolar&&!r.isTransposed)return(r.endAngle-r.startAngle)*r.getRadius();var e=r.convert({x:0,y:0}),t=r.convert({x:1,y:0});return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function jl(r){if(r.isPolar){var e=r.startAngle,t=r.endAngle;return t-e===Math.PI*2}return!1}function ku(r,e){var t=r.getCenter();return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Sh(r,e){var t=!1;if(r)if(r.type==="theta"){var i=r.start,o=r.end;t=Rp(e.x,i.x,o.x)&&Rp(e.y,i.y,o.y)}else{var c=r.invert(e);t=Rp(c.x,0,1)&&Rp(c.y,0,1)}return t}function lc(r,e){var t=r.getCenter();return Math.atan2(e.y-t.y,e.x-t.x)}function Yh(r,e){e===void 0&&(e=0);var t=r.start,i=r.end,o=r.getWidth(),c=r.getHeight();if(r.isPolar){var p=r.startAngle,g=r.endAngle,_=r.getCenter(),S=r.getRadius();return{type:"path",startState:{path:sl(_.x,_.y,S+e,p,p)},endState:function(L){var F=(g-p)*L+p,z=sl(_.x,_.y,S+e,p,F);return{path:z}},attrs:{path:sl(_.x,_.y,S+e,p,g)}}}var I;return r.isTransposed?I={height:c+e*2}:I={width:o+e*2},{type:"rect",startState:{x:t.x-e,y:i.y-e,width:r.isTransposed?o+e*2:0,height:r.isTransposed?0:c+e*2},endState:I,attrs:{x:t.x-e,y:i.y-e,width:o+e*2,height:c+e*2}}}function r0(r,e){e===void 0&&(e=0);var t=r.start,i=r.end,o=r.getWidth(),c=r.getHeight(),p=Math.min(t.x,i.x),g=Math.min(t.y,i.y);return Iu.fromRange(p-e,g-e,p+o+e,g+c+e)}var lv=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]+)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/;function n0(r){var e="linear";return lv.test(r)?e="timeCat":(0,b.HD)(r)&&(e="cat"),e}function ko(r,e,t,i){return e===void 0&&(e={}),e.type?e.type:r.type!=="identity"&&_e.includes(t)&&["interval"].includes(i)||r.isCategory?"cat":r.type}function Pf(r,e,t){var i=e||[];if((0,b.hj)(r)||(0,b.UM)((0,b.Wx)(i,r))&&(0,b.xb)(t)){var o=Uu("identity");return new o({field:r.toString(),values:[r]})}var c=(0,b.I)(i,r),p=(0,b.U2)(t,"type",n0(c[0])),g=Uu(p);return new g((0,P.pi)({field:r,values:c},t))}function Is(r,e){if(r.type!=="identity"&&e.type!=="identity"){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);r.change(t)}}function ul(r){return r.alias||r.field}function cv(r,e,t){var i=r.values,o=i.length,c;if(o===1)c=[.5,1];else{var p=1,g=0;jl(e)?e.isTransposed?(p=(0,b.U2)(t,"widthRatio.multiplePie",1/1.3),g=1/o*p,c=[g/2,1-g/2]):c=[0,1-1/o]:(g=1/o/2,c=[g,1-g])}return c}function $0(r){var e=r.values.filter(function(t){return!(0,b.UM)(t)&&!isNaN(t)});return Math.max.apply(Math,(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),[(0,b.UM)(r.max)?-1/0:r.max],!1))}function Dg(r){var e,t;switch(r){case le.TOP:e={x:0,y:1},t={x:1,y:1};break;case le.RIGHT:e={x:1,y:0},t={x:1,y:1};break;case le.BOTTOM:e={x:0,y:0},t={x:1,y:0};break;case le.LEFT:e={x:0,y:0},t={x:0,y:1};break;default:e=t={x:0,y:0}}return{start:e,end:t}}function Bg(r){var e,t;return r.isTransposed?(e={x:0,y:0},t={x:1,y:0}):(e={x:0,y:0},t={x:0,y:1}),{start:e,end:t}}function fv(r,e){var t={start:{x:0,y:0},end:{x:0,y:0}};r.isRect?t=Dg(e):r.isPolar&&(t=Bg(r));var i=t.start,o=t.end;return{start:r.convert(i),end:r.convert(o)}}function hv(r,e){if(r.isRect)return r.isTransposed?[DIRECTION.RIGHT,DIRECTION.BOTTOM].includes(e)?1:-1:[DIRECTION.BOTTOM,DIRECTION.RIGHT].includes(e)?-1:1;if(r.isPolar){var t=r.x.start;return t<0?-1:1}return 1}function i0(r){var e=r.start,t=r.end;return e.x===t.x}function a0(r,e){var t=r.start,i=r.end,o=i0(r);return o?(t.y-i.y)*(e.x-t.x)>0?1:-1:(i.x-t.x)*(t.y-e.y)>0?-1:1}function Ch(r,e){var t=(0,b.U2)(r,["components","axis"],{});return(0,b.b$)({},(0,b.U2)(t,["common"],{}),(0,b.b$)({},(0,b.U2)(t,[e],{})))}function o0(r,e,t){var i=(0,b.U2)(r,["components","axis"],{});return(0,b.b$)({},(0,b.U2)(i,["common","title"],{}),(0,b.b$)({},(0,b.U2)(i,[e,"title"],{})),t)}function pv(r){var e=r.x,t=r.y,i=r.circleCenter,o=t.start>t.end,c=r.isTransposed?r.convert({x:o?0:1,y:0}):r.convert({x:0,y:o?0:1}),p=[c.x-i.x,c.y-i.y],g=[1,0],_=c.y>i.y?Ia.EU(p,g):Ia.EU(p,g)*-1,S=_+(e.end-e.start),I=Math.sqrt(Math.pow(c.x-i.x,2)+Math.pow(c.y-i.y,2));return{center:i,radius:I,startAngle:_,endAngle:S}}function Ah(r,e){return(0,b.jn)(r)?r===!1?!1:{}:(0,b.U2)(r,[e])}function ns(r,e){return(0,b.U2)(r,"position",e)}function dv(r,e){return(0,b.U2)(e,["title","text"],ul(r))}var cc=function(){function r(e,t){this.destroyed=!1,this.facets=[],this.view=e,this.cfg=(0,b.b$)({},this.getDefaultCfg(),t)}return r.prototype.init=function(){this.container||(this.container=this.createContainer());var e=this.view.getData();this.facets=this.generateFacets(e)},r.prototype.render=function(){this.renderViews()},r.prototype.update=function(){},r.prototype.clear=function(){this.clearFacetViews()},r.prototype.destroy=function(){this.clear(),this.container&&(this.container.remove(!0),this.container=void 0),this.destroyed=!0,this.view=void 0,this.facets=[]},r.prototype.facetToView=function(e){var t=e.region,i=e.data,o=e.padding,c=o===void 0?this.cfg.padding:o,p=this.view.createView({region:t,padding:c});p.data(i||[]),e.view=p,this.beforeEachView(p,e);var g=this.cfg.eachView;return g&&g(p,e),this.afterEachView(p,e),p},r.prototype.createContainer=function(){var e=this.view.getLayer(W.FORE);return e.addGroup()},r.prototype.renderViews=function(){this.createFacetViews()},r.prototype.createFacetViews=function(){var e=this;return this.facets.map(function(t){return e.facetToView(t)})},r.prototype.clearFacetViews=function(){var e=this;(0,b.S6)(this.facets,function(t){t.view&&(e.view.removeView(t.view),t.view=void 0)})},r.prototype.parseSpacing=function(){var e=this.view.viewBBox,t=e.width,i=e.height,o=this.cfg.spacing;return o.map(function(c,p){return(0,b.hj)(c)?c/(p===0?t:i):parseFloat(c)/100})},r.prototype.getFieldValues=function(e,t){var i=[],o={};return(0,b.S6)(e,function(c){var p=c[t];!(0,b.UM)(p)&&!o[p]&&(i.push(p),o[p]=!0)}),i},r.prototype.getRegion=function(e,t,i,o){var c=(0,P.CR)(this.parseSpacing(),2),p=c[0],g=c[1],_=(1+p)/(t===0?1:t)-p,S=(1+g)/(e===0?1:e)-g,I={x:(_+p)*i,y:(S+g)*o},L={x:I.x+_,y:I.y+S};return{start:I,end:L}},r.prototype.getDefaultCfg=function(){return{eachView:void 0,showTitle:!0,spacing:[0,0],padding:10,fields:[]}},r.prototype.getDefaultTitleCfg=function(){var e=this.view.getTheme().fontFamily;return{style:{fontSize:14,fill:"#666",fontFamily:e}}},r.prototype.processAxis=function(e,t){var i=e.getOptions(),o=i.coordinate,c=e.geometries,p=(0,b.U2)(o,"type","rect");if(p==="rect"&&c.length){(0,b.UM)(i.axes)&&(i.axes={});var g=i.axes,_=(0,P.CR)(c[0].getXYFields(),2),S=_[0],I=_[1],L=Ah(g,S),F=Ah(g,I);L!==!1&&(i.axes[S]=this.getXAxisOption(S,g,L,t)),F!==!1&&(i.axes[I]=this.getYAxisOption(I,g,F,t))}},r.prototype.getFacetDataFilter=function(e){return function(t){return(0,b.yW)(e,function(i){var o=i.field,c=i.value;return!(0,b.UM)(c)&&o?t[o]===c:!0})}},r}(),fc={},s0=function(r){return fc[(0,b.vl)(r)]},$h=function(r,e){fc[(0,b.vl)(r)]=e},It=function(){function r(e,t){this.context=e,this.cfg=t,e.addAction(this)}return r.prototype.applyCfg=function(e){(0,b.f0)(this,e)},r.prototype.init=function(){this.applyCfg(this.cfg)},r.prototype.destroy=function(){this.context.removeAction(this),this.context=null},r}(),Re=It,dr=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.execute=function(){this.callback&&this.callback(this.context)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.callback=null},e}(Re),ln=dr,Ln={};function on(r,e){var t=Ln[r],i=null;if(t){var o=t.ActionClass,c=t.cfg;i=new o(e,c),i.name=r,i.init()}return i}function En(r){var e=Ln[r];return(0,b.U2)(e,"ActionClass")}function jr(r,e,t){Ln[r]={ActionClass:e,cfg:t}}function Xn(r){delete Ln[r]}function Yn(r,e){var t=new ln(e);return t.callback=r,t.name="callback",t}function ni(r,e){var t=[];if(r.length){t.push(["M",r[0].x,r[0].y]);for(var i=1,o=r.length;i<o;i+=1){var c=r[i];t.push(["L",c.x,c.y])}e&&t.push(["Z"])}return t}function Jn(r,e){for(var t=[r[0]],i=1,o=r.length;i<o;i=i+2){var c=e.convert({x:r[i],y:r[i+1]});t.push(c.x,c.y)}return t}function yi(r,e){var t=e.isTransposed,i=r[1],o=r[6],c=r[7],p=e.convert({x:o,y:c}),g=t?0:1;return["A",i,i,0,0,g,p.x,p.y]}function qn(r,e,t){var i=t.isTransposed,o=t.startAngle,c=t.endAngle,p=r[0].toLowerCase()==="a"?{x:r[6],y:r[7]}:{x:r[1],y:r[2]},g={x:e[1],y:e[2]},_=[],S=i?"y":"x",I=Math.abs(g[S]-p[S])*(c-o),L=g[S]>=p[S]?1:0,F=I>Math.PI?1:0,z=t.convert(g),V=ku(t,z);if(V>=.5)if(I===Math.PI*2){var Q={x:(g.x+p.x)/2,y:(g.y+p.y)/2},st=t.convert(Q);_.push(["A",V,V,0,F,L,st.x,st.y]),_.push(["A",V,V,0,F,L,z.x,z.y])}else _.push(["A",V,V,0,F,L,z.x,z.y]);return _}function ri(r){(0,b.S6)(r,function(e,t){var i=e;if(i[0].toLowerCase()==="a"){var o=r[t-1],c=r[t+1];c&&c[0].toLowerCase()==="a"?o&&o[0].toLowerCase()==="l"&&(o[0]="M"):o&&o[0].toLowerCase()==="a"&&c&&c[0].toLowerCase()==="l"&&(c[0]="M")}})}var Zr=function(r,e,t,i){var o,c=[],p=!!i,g,_,S,I,L,F,z;if(p){o=(0,P.CR)(i,2),S=o[0],I=o[1];for(var V=0,Q=r.length;V<Q;V++){var st=r[V];S=Ia.VV([0,0],S,st),I=Ia.Fp([0,0],I,st)}}for(var V=0,at=r.length;V<at;V++){var st=r[V];if(V===0&&!t)z=st;else if(V===at-1&&!t)F=st,c.push(z),c.push(F);else{g=r[t?V?V-1:at-1:V-1],_=r[t?(V+1)%at:V+1];var Ft=[0,0];Ft=Ia.lu(Ft,_,g),Ft=Ia.bA(Ft,Ft,e);var Kt=Ia.TE(st,g),ee=Ia.TE(st,_),Me=Kt+ee;Me!==0&&(Kt/=Me,ee/=Me);var hr=Ia.bA([0,0],Ft,-Kt),Tr=Ia.bA([0,0],Ft,ee);F=Ia.IH([0,0],st,hr),L=Ia.IH([0,0],st,Tr),L=Ia.VV([0,0],L,Ia.Fp([0,0],_,st)),L=Ia.Fp([0,0],L,Ia.VV([0,0],_,st)),hr=Ia.lu([0,0],L,st),hr=Ia.bA([0,0],hr,-Kt/ee),F=Ia.IH([0,0],st,hr),F=Ia.VV([0,0],F,Ia.Fp([0,0],g,st)),F=Ia.Fp([0,0],F,Ia.VV([0,0],g,st)),Tr=Ia.lu([0,0],st,F),Tr=Ia.bA([0,0],Tr,ee/Kt),L=Ia.IH([0,0],st,Tr),p&&(F=Ia.Fp([0,0],F,S),F=Ia.VV([0,0],F,I),L=Ia.Fp([0,0],L,S),L=Ia.VV([0,0],L,I)),c.push(z),c.push(F),z=L}}return t&&c.push(c.shift()),c};function mn(r,e,t){for(var i=!!e,o=[],c=0,p=r.length;c<p;c+=2)o.push([r[c],r[c+1]]);for(var g=Zr(o,.4,i,t),_=o.length,S=[],I,L,F,c=0;c<_-1;c++)I=g[c*2],L=g[c*2+1],F=o[c+1],S.push(["C",I[0],I[1],L[0],L[1],F[0],F[1]]);return i&&(I=g[_],L=g[_+1],F=o[0],S.push(["C",I[0],I[1],L[0],L[1],F[0],F[1]])),S}function jn(r,e){return ni(r,e)}function gi(r,e,t){var i=[],o=r[0],c=null;if(r.length<=2)return jn(r,e);for(var p=0,g=r.length;p<g;p++){var _=r[p];(!c||!(c.x===_.x&&c.y===_.y))&&(i.push(_.x),i.push(_.y),c=_)}var S=t||[[0,0],[1,1]],I=mn(i,e,S);return I.unshift(["M",o.x,o.y]),I}function Dn(r,e){var t=[];return(0,b.S6)(e,function(i){var o=i[0];switch(o.toLowerCase()){case"m":case"l":case"c":t.push(Jn(i,r));break;case"a":t.push(yi(i,r));break;case"z":default:t.push(i);break}}),t}function ci(r,e){var t=[],i,o,c,p;return(0,b.S6)(e,function(g,_){var S=g[0];switch(S.toLowerCase()){case"m":case"c":case"q":t.push(Jn(g,r));break;case"l":i=e[_-1],o=g,c=r.isTransposed,p=c?i[i.length-2]===o[1]:i[i.length-1]===o[2],p?t=t.concat(qn(i,o,r)):t.push(Jn(g,r));break;case"a":t.push(yi(g,r));break;case"z":default:t.push(g);break}}),ri(t),t}function Mi(r,e){var t=r.event,i=t.target;return wn(i,e)}function la(r,e){var t=r.getCanvasBBox(),i=t.width,o=t.height;return i>0&&o>0&&(i>=e||o>=e)}function wn(r,e){var t=r.getCanvasBBox();return la(r,e)?t:null}function In(r,e){var t=r.event.maskShapes;return t.map(function(i){return wn(i,e)}).filter(function(i){return!!i})}function Wi(r,e){var t=r.event,i=t.target;return bi(i,e)}function bi(r,e){return la(r,e)?r.attr("path"):null}function Qn(r,e){var t=r.event.maskShapes;return t.map(function(i){return bi(i,e)})}function pi(r){var e=r.event,t,i=e.target;return i&&(t=i.get("element")),t}function hi(r){var e=r.event,t=e.target,i;return t&&(i=t.get("delegateObject")),i}function Na(r){var e=r.event.gEvent;return!(e&&e.fromShape&&e.toShape&&e.fromShape.get("element")===e.toShape.get("element"))}function wa(r){return r&&r.component&&r.component.isList()}function Ei(r){return r&&r.component&&r.component.isSlider()}function Li(r){var e=r.event,t=e.target;return t&&(t==null?void 0:t.get("name"))==="mask"||ga(r)}function ga(r){var e;return((e=r.event.target)===null||e===void 0?void 0:e.get("name"))==="multi-mask"}function Ta(r,e){var t=r.event.target;if(ga(r))return no(r,e);if(t.get("type")==="path"){var i=Wi(r,e);return i?ks(r.view,i):void 0}var o=Mi(r,e);return o?Vs(r.view,o):null}function no(r,e){var t=r.event.target;if(t.get("type")==="path"){var i=Qn(r,e);return i.length>0?i.flatMap(function(c){return ks(r.view,c)}):null}var o=In(r,e);return o.length>0?o.flatMap(function(c){return Vs(r.view,c)}):null}function ws(r,e,t){if(ga(r))return io(r,e,t);var i=Mi(r,t);return i?Ss(i,r,e):null}function Ss(r,e,t){var i=e.view,o=wo(i,t,{x:r.x,y:r.y}),c=wo(i,t,{x:r.maxX,y:r.maxY}),p={minX:o.x,minY:o.y,maxX:c.x,maxY:c.y};return Vs(t,p)}function io(r,e,t){var i=In(r,t);return i.length>0?i.flatMap(function(o){return Ss(o,r,e)}):null}function Bo(r){var e=r.geometries,t=[];return(0,b.S6)(e,function(i){var o=i.elements;t=t.concat(o)}),r.views&&r.views.length&&(0,b.S6)(r.views,function(i){t=t.concat(Bo(i))}),t}function Es(r,e,t){var i=Bo(r);return i.filter(function(o){return Qo(o,e)===t})}function du(r,e){var t=r.geometries,i=[];return(0,b.S6)(t,function(o){var c=o.getElementsBy(function(p){return p.hasState(e)});i=i.concat(c)}),i}function Qo(r,e){var t=r.getModel(),i=t.data,o;return(0,b.kJ)(i)?o=i[0][e]:o=i[e],o}function Lu(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function Vs(r,e){var t=Bo(r),i=[];return(0,b.S6)(t,function(o){var c=o.shape,p=c.getCanvasBBox();Lu(e,p)&&i.push(o)}),i}function Gu(r){var e=[];return(0,b.S6)(r,function(t){var i=t[0];if(i!=="A")for(var o=1;o<t.length;o=o+2)e.push([t[o],t[o+1]]);else{var c=t.length;e.push([t[c-2],t[c-1]])}}),e}function ks(r,e){var t=Bo(r),i=Gu(e),o=t.filter(function(c){var p=c.shape,g;if(p.get("type")==="path")g=Gu(p.attr("path"));else{var _=p.getCanvasBBox();g=Rg(_)}return(0,xh.Wq)(i,g)});return o}function Da(r){return r.getComponents().map(function(e){return e.component})}function $s(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}function bo(r,e){if(r.length<=2)return jn(r,!1);var t=r[0],i=[];(0,b.S6)(r,function(c){i.push(c.x),i.push(c.y)});var o=mn(i,e,null);return o.unshift(["M",t.x,t.y]),o}function Pu(r,e){return r.x<=e.x&&r.maxX>=e.x&&r.y<=e.y&&r.maxY>e.y}function ha(r){var e=r.parent,t=null;return e&&(t=e.views.filter(function(i){return i!==r})),t}function ao(r,e){var t=r.getCoordinate();return t.invert(e)}function wo(r,e,t){var i=ao(r,t);return e.getCoordinate().convert(i)}function Ds(r,e,t,i){var o=!1;return(0,b.S6)(r,function(c){if(c[t]===e[t]&&c[i]===e[i])return o=!0,!1}),o}function Wl(r,e){var t=r.getScaleByField(e);return!t&&r.views&&(0,b.S6)(r.views,function(i){if(t=Wl(i,e),t)return!1}),t}var sr=function(){function r(e){this.actions=[],this.event=null,this.cacheMap={},this.view=e}return r.prototype.cache=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length===1)return this.cacheMap[e[0]];e.length===2&&(this.cacheMap[e[0]]=e[1])},r.prototype.getAction=function(e){return this.actions.find(function(t){return t.name===e})},r.prototype.addAction=function(e){this.actions.push(e)},r.prototype.removeAction=function(e){var t=this.actions,i=this.actions.indexOf(e);i>=0&&t.splice(i,1)},r.prototype.getCurrentPoint=function(){var e=this.event;if(e)if(e.target instanceof HTMLElement){var t=this.view.getCanvas(),i=t.getPointByClient(e.clientX,e.clientY);return i}else return{x:e.x,y:e.y};return null},r.prototype.getCurrentShape=function(){return(0,b.U2)(this.event,["gEvent","shape"])},r.prototype.isInPlot=function(){var e=this.getCurrentPoint();return e?this.view.isPointInPlot(e):!1},r.prototype.isInShape=function(e){var t=this.getCurrentShape();return t?t.get("name")===e:!1},r.prototype.isInComponent=function(e){var t=Da(this.view),i=this.getCurrentPoint();return i?!!t.find(function(o){var c=o.getBBox();return e?o.get("name")===e&&Pu(c,i):Pu(c,i)}):!1},r.prototype.destroy=function(){(0,b.S6)(this.actions.slice(),function(e){e.destroy()}),this.view=null,this.event=null,this.actions=null,this.cacheMap=null},r}(),fn=sr,rn=function(){function r(e,t){this.view=e,this.cfg=t}return r.prototype.init=function(){this.initEvents()},r.prototype.initEvents=function(){},r.prototype.clearEvents=function(){},r.prototype.destroy=function(){this.clearEvents()},r}(),Gi=rn;function oo(r,e,t){var i=r.split(":"),o=i[0],c=e.getAction(o)||on(o,e);if(!c)throw new Error("There is no action named ".concat(o));var p=i[1];return{action:c,methodName:p,arg:t}}function tr(r){var e=r.action,t=r.methodName,i=r.arg;if(e[t])e[t](i);else throw new Error("Action(".concat(e.name,") doesn't have a method called ").concat(t))}var Te={START:"start",SHOW_ENABLE:"showEnable",END:"end",ROLLBACK:"rollback",PROCESSING:"processing"},xr=function(r){(0,P.ZT)(e,r);function e(t,i){var o=r.call(this,t,i)||this;return o.callbackCaches={},o.emitCaches={},o.steps=i,o}return e.prototype.init=function(){this.initContext(),r.prototype.init.call(this)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.steps=null,this.context&&(this.context.destroy(),this.context=null),this.callbackCaches=null,this.view=null},e.prototype.initEvents=function(){var t=this;(0,b.S6)(this.steps,function(i,o){(0,b.S6)(i,function(c){var p=t.getActionCallback(o,c);p&&t.bindEvent(c.trigger,p)})})},e.prototype.clearEvents=function(){var t=this;(0,b.S6)(this.steps,function(i,o){(0,b.S6)(i,function(c){var p=t.getActionCallback(o,c);p&&t.offEvent(c.trigger,p)})})},e.prototype.initContext=function(){var t=this.view,i=new fn(t);this.context=i;var o=this.steps;(0,b.S6)(o,function(c){(0,b.S6)(c,function(p){if((0,b.mf)(p.action))p.actionObject={action:Yn(p.action,i),methodName:"execute"};else if((0,b.HD)(p.action))p.actionObject=oo(p.action,i,p.arg);else if((0,b.kJ)(p.action)){var g=p.action,_=(0,b.kJ)(p.arg)?p.arg:[p.arg];p.actionObject=[],(0,b.S6)(g,function(S,I){p.actionObject.push(oo(S,i,_[I]))})}})})},e.prototype.isAllowStep=function(t){var i=this.currentStepName,o=this.steps;if(i===t||t===Te.SHOW_ENABLE)return!0;if(t===Te.PROCESSING)return i===Te.START;if(t===Te.START)return i!==Te.PROCESSING;if(t===Te.END)return i===Te.PROCESSING||i===Te.START;if(t===Te.ROLLBACK){if(o[Te.END])return i===Te.END;if(i===Te.START)return!0}return!1},e.prototype.isAllowExecute=function(t,i){if(this.isAllowStep(t)){var o=this.getKey(t,i);return i.once&&this.emitCaches[o]?!1:i.isEnable?i.isEnable(this.context):!0}return!1},e.prototype.enterStep=function(t){this.currentStepName=t,this.emitCaches={}},e.prototype.afterExecute=function(t,i){t!==Te.SHOW_ENABLE&&this.currentStepName!==t&&this.enterStep(t);var o=this.getKey(t,i);this.emitCaches[o]=!0},e.prototype.getKey=function(t,i){return t+i.trigger+i.action},e.prototype.getActionCallback=function(t,i){var o=this,c=this.context,p=this.callbackCaches,g=i.actionObject;if(i.action&&g){var _=this.getKey(t,i);if(!p[_]){var S=function(I){c.event=I,o.isAllowExecute(t,i)?((0,b.kJ)(g)?(0,b.S6)(g,function(L){c.event=I,tr(L)}):(c.event=I,tr(g)),o.afterExecute(t,i),i.callback&&(c.event=I,i.callback(c))):c.event=null};i.debounce?p[_]=(0,b.Ds)(S,i.debounce.wait,i.debounce.immediate):i.throttle?p[_]=(0,b.P2)(S,i.throttle.wait,{leading:i.throttle.leading,trailing:i.throttle.trailing}):p[_]=S}return p[_]}return null},e.prototype.bindEvent=function(t,i){var o=t.split(":");o[0]==="window"?window.addEventListener(o[1],i):o[0]==="document"?document.addEventListener(o[1],i):this.view.on(t,i)},e.prototype.offEvent=function(t,i){var o=t.split(":");o[0]==="window"?window.removeEventListener(o[1],i):o[0]==="document"?document.removeEventListener(o[1],i):this.view.off(t,i)},e}(Gi),kr=xr,$r={};function Ar(r){return $r[(0,b.vl)(r)]}function Ye(r,e){$r[(0,b.vl)(r)]=e}function Rr(r,e,t){var i=Ar(r);if(!i)return null;if((0,b.PO)(i)){var o=(0,b.CD)((0,b.d9)(i),t);return new kr(e,o)}else{var c=i;return new c(e,t)}}function je(r){return{title:{autoRotate:!0,position:"center",spacing:r.axisTitleSpacing,style:{fill:r.axisTitleTextFillColor,fontSize:r.axisTitleTextFontSize,lineHeight:r.axisTitleTextLineHeight,textBaseline:"middle",fontFamily:r.fontFamily},iconStyle:{fill:r.axisDescriptionIconFillColor}},label:{autoRotate:!1,autoEllipsis:!1,autoHide:{type:"equidistance",cfg:{minGap:6}},offset:r.axisLabelOffset,style:{fill:r.axisLabelFillColor,fontSize:r.axisLabelFontSize,lineHeight:r.axisLabelLineHeight,fontFamily:r.fontFamily}},line:{style:{lineWidth:r.axisLineBorder,stroke:r.axisLineBorderColor}},grid:{line:{type:"line",style:{stroke:r.axisGridBorderColor,lineWidth:r.axisGridBorder,lineDash:r.axisGridLineDash}},alignTick:!0,animate:!0},tickLine:{style:{lineWidth:r.axisTickLineBorder,stroke:r.axisTickLineBorderColor},alignTick:!0,length:r.axisTickLineLength},subTickLine:null,animate:!0}}function mr(r){return{title:null,marker:{symbol:"circle",spacing:r.legendMarkerSpacing,style:{r:r.legendCircleMarkerSize,fill:r.legendMarkerColor}},itemName:{spacing:5,style:{fill:r.legendItemNameFillColor,fontFamily:r.fontFamily,fontSize:r.legendItemNameFontSize,lineHeight:r.legendItemNameLineHeight,fontWeight:r.legendItemNameFontWeight,textAlign:"start",textBaseline:"middle"}},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:"#D8D8D8"},markerStyle:{fill:"#D8D8D8",stroke:"#D8D8D8"}},inactive:{nameStyle:{fill:"#D8D8D8"},markerStyle:{opacity:.2}}},flipPage:!0,pageNavigator:{marker:{style:{size:r.legendPageNavigatorMarkerSize,inactiveFill:r.legendPageNavigatorMarkerInactiveFillColor,inactiveOpacity:r.legendPageNavigatorMarkerInactiveFillOpacity,fill:r.legendPageNavigatorMarkerFillColor,opacity:r.legendPageNavigatorMarkerFillOpacity}},text:{style:{fill:r.legendPageNavigatorTextFillColor,fontSize:r.legendPageNavigatorTextFontSize}}},animate:!1,maxItemWidth:200,itemSpacing:r.legendItemSpacing,itemMarginBottom:r.legendItemMarginBottom,padding:r.legendPadding}}function rr(r){var e,t={point:{default:{fill:r.pointFillColor,r:r.pointSize,stroke:r.pointBorderColor,lineWidth:r.pointBorder,fillOpacity:r.pointFillOpacity},active:{stroke:r.pointActiveBorderColor,lineWidth:r.pointActiveBorder},selected:{stroke:r.pointSelectedBorderColor,lineWidth:r.pointSelectedBorder},inactive:{fillOpacity:r.pointInactiveFillOpacity,strokeOpacity:r.pointInactiveBorderOpacity}},hollowPoint:{default:{fill:r.hollowPointFillColor,lineWidth:r.hollowPointBorder,stroke:r.hollowPointBorderColor,strokeOpacity:r.hollowPointBorderOpacity,r:r.hollowPointSize},active:{stroke:r.hollowPointActiveBorderColor,strokeOpacity:r.hollowPointActiveBorderOpacity},selected:{lineWidth:r.hollowPointSelectedBorder,stroke:r.hollowPointSelectedBorderColor,strokeOpacity:r.hollowPointSelectedBorderOpacity},inactive:{strokeOpacity:r.hollowPointInactiveBorderOpacity}},area:{default:{fill:r.areaFillColor,fillOpacity:r.areaFillOpacity,stroke:null},active:{fillOpacity:r.areaActiveFillOpacity},selected:{fillOpacity:r.areaSelectedFillOpacity},inactive:{fillOpacity:r.areaInactiveFillOpacity}},hollowArea:{default:{fill:null,stroke:r.hollowAreaBorderColor,lineWidth:r.hollowAreaBorder,strokeOpacity:r.hollowAreaBorderOpacity},active:{fill:null,lineWidth:r.hollowAreaActiveBorder},selected:{fill:null,lineWidth:r.hollowAreaSelectedBorder},inactive:{strokeOpacity:r.hollowAreaInactiveBorderOpacity}},interval:{default:{fill:r.intervalFillColor,fillOpacity:r.intervalFillOpacity},active:{stroke:r.intervalActiveBorderColor,lineWidth:r.intervalActiveBorder},selected:{stroke:r.intervalSelectedBorderColor,lineWidth:r.intervalSelectedBorder},inactive:{fillOpacity:r.intervalInactiveFillOpacity,strokeOpacity:r.intervalInactiveBorderOpacity}},hollowInterval:{default:{fill:r.hollowIntervalFillColor,stroke:r.hollowIntervalBorderColor,lineWidth:r.hollowIntervalBorder,strokeOpacity:r.hollowIntervalBorderOpacity},active:{stroke:r.hollowIntervalActiveBorderColor,lineWidth:r.hollowIntervalActiveBorder,strokeOpacity:r.hollowIntervalActiveBorderOpacity},selected:{stroke:r.hollowIntervalSelectedBorderColor,lineWidth:r.hollowIntervalSelectedBorder,strokeOpacity:r.hollowIntervalSelectedBorderOpacity},inactive:{stroke:r.hollowIntervalInactiveBorderColor,lineWidth:r.hollowIntervalInactiveBorder,strokeOpacity:r.hollowIntervalInactiveBorderOpacity}},line:{default:{stroke:r.lineBorderColor,lineWidth:r.lineBorder,strokeOpacity:r.lineBorderOpacity,fill:null,lineAppendWidth:10,lineCap:"round",lineJoin:"round"},active:{lineWidth:r.lineActiveBorder},selected:{lineWidth:r.lineSelectedBorder},inactive:{strokeOpacity:r.lineInactiveBorderOpacity}}},i=je(r),o=mr(r);return{background:r.backgroundColor,defaultColor:r.brandColor,subColor:r.subColor,semanticRed:r.paletteSemanticRed,semanticGreen:r.paletteSemanticGreen,padding:"auto",fontFamily:r.fontFamily,columnWidthRatio:1/2,maxColumnWidth:null,minColumnWidth:null,roseWidthRatio:.9999999,multiplePieWidthRatio:1/1.3,colors10:r.paletteQualitative10,colors20:r.paletteQualitative20,sequenceColors:r.paletteSequence,shapes:{point:["hollow-circle","hollow-square","hollow-bowtie","hollow-diamond","hollow-hexagon","hollow-triangle","hollow-triangle-down","circle","square","bowtie","diamond","hexagon","triangle","triangle-down","cross","tick","plus","hyphen","line"],line:["line","dash","dot","smooth"],area:["area","smooth","line","smooth-line"],interval:["rect","hollow-rect","line","tick"]},sizes:[1,10],geometries:{interval:{rect:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:function(c){var p=c.geometry.coordinate;if(p.isPolar&&p.isTransposed){var g=wh(c.getModel(),p),_=g.startAngle,S=g.endAngle,I=(_+S)/2,L=7.5,F=L*Math.cos(I),z=L*Math.sin(I);return{matrix:ro.vs(null,[["t",F,z]])}}return t.interval.selected}}},"hollow-rect":{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},line:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},tick:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},funnel:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}},pyramid:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},line:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},dot:{default:{style:(0,P.pi)((0,P.pi)({},t.line.default),{lineCap:null,lineDash:[1,1]})},active:{style:(0,P.pi)((0,P.pi)({},t.line.active),{lineCap:null,lineDash:[1,1]})},inactive:{style:(0,P.pi)((0,P.pi)({},t.line.inactive),{lineCap:null,lineDash:[1,1]})},selected:{style:(0,P.pi)((0,P.pi)({},t.line.selected),{lineCap:null,lineDash:[1,1]})}},dash:{default:{style:(0,P.pi)((0,P.pi)({},t.line.default),{lineCap:null,lineDash:[5.5,1]})},active:{style:(0,P.pi)((0,P.pi)({},t.line.active),{lineCap:null,lineDash:[5.5,1]})},inactive:{style:(0,P.pi)((0,P.pi)({},t.line.inactive),{lineCap:null,lineDash:[5.5,1]})},selected:{style:(0,P.pi)((0,P.pi)({},t.line.selected),{lineCap:null,lineDash:[5.5,1]})}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hvh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},polygon:{polygon:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},point:{circle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},square:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},bowtie:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},diamond:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},hexagon:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},triangle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"triangle-down":{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"hollow-circle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-square":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-bowtie":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-diamond":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-hexagon":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle-down":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},cross:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},tick:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},plus:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},hyphen:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},line:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}}},area:{area:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},smooth:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},line:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"smooth-line":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}},schema:{candle:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},box:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}}},edge:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},arc:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},violin:{violin:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hollow:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"hollow-smooth":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}}},components:{axis:{common:i,top:{position:"top",grid:null,title:null,verticalLimitLength:1/2},bottom:{position:"bottom",grid:null,title:null,verticalLimitLength:1/2},left:{position:"left",title:null,line:null,tickLine:null,verticalLimitLength:1/3},right:{position:"right",title:null,line:null,tickLine:null,verticalLimitLength:1/3},circle:{title:null,grid:(0,b.b$)({},i.grid,{line:{type:"line"}})},radius:{title:null,grid:(0,b.b$)({},i.grid,{line:{type:"circle"}})}},legend:{common:o,right:{layout:"vertical",padding:r.legendVerticalPadding},left:{layout:"vertical",padding:r.legendVerticalPadding},top:{layout:"horizontal",padding:r.legendHorizontalPadding},bottom:{layout:"horizontal",padding:r.legendHorizontalPadding},continuous:{title:null,background:null,track:{},rail:{type:"color",size:r.sliderRailHeight,defaultLength:r.sliderRailWidth,style:{fill:r.sliderRailFillColor,stroke:r.sliderRailBorderColor,lineWidth:r.sliderRailBorder}},label:{align:"rail",spacing:4,formatter:null,style:{fill:r.sliderLabelTextFillColor,fontSize:r.sliderLabelTextFontSize,lineHeight:r.sliderLabelTextLineHeight,textBaseline:"middle",fontFamily:r.fontFamily}},handler:{size:r.sliderHandlerWidth,style:{fill:r.sliderHandlerFillColor,stroke:r.sliderHandlerBorderColor}},slidable:!0,padding:o.padding}},tooltip:{showContent:!0,follow:!0,showCrosshairs:!1,showMarkers:!0,shared:!1,enterable:!1,position:"auto",marker:{symbol:"circle",stroke:"#fff",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0,0,0,0.09)",lineWidth:2,r:4},crosshairs:{line:{style:{stroke:r.tooltipCrosshairsBorderColor,lineWidth:r.tooltipCrosshairsBorder}},text:null,textBackground:{padding:2,style:{fill:"rgba(0, 0, 0, 0.25)",lineWidth:0,stroke:null}},follow:!1},domStyles:(e={},e["".concat(au)]={position:"absolute",visibility:"hidden",zIndex:8,transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:r.tooltipContainerFillColor,opacity:r.tooltipContainerFillOpacity,boxShadow:r.tooltipContainerShadow,borderRadius:"".concat(r.tooltipContainerBorderRadius,"px"),color:r.tooltipTextFillColor,fontSize:"".concat(r.tooltipTextFontSize,"px"),fontFamily:r.fontFamily,lineHeight:"".concat(r.tooltipTextLineHeight,"px"),padding:"0 12px 0 12px"},e["".concat(kl)]={marginBottom:"12px",marginTop:"12px"},e["".concat(ol)]={margin:0,listStyleType:"none",padding:0},e["".concat(yc)]={listStyleType:"none",padding:0,marginBottom:"12px",marginTop:"12px",marginLeft:0,marginRight:0},e["".concat(Mf)]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},e["".concat(Ll)]={display:"inline-block",float:"right",marginLeft:"30px"},e)},annotation:{arc:{style:{stroke:r.annotationArcBorderColor,lineWidth:r.annotationArcBorder},animate:!0},line:{style:{stroke:r.annotationLineBorderColor,lineDash:r.annotationLineDash,lineWidth:r.annotationLineBorder},text:{position:"start",autoRotate:!0,style:{fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,textAlign:"start",fontFamily:r.fontFamily,textBaseline:"bottom"}},animate:!0},text:{style:{fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,textBaseline:"middle",textAlign:"start",fontFamily:r.fontFamily},animate:!0},region:{top:!1,style:{lineWidth:r.annotationRegionBorder,stroke:r.annotationRegionBorderColor,fill:r.annotationRegionFillColor,fillOpacity:r.annotationRegionFillOpacity},animate:!0},image:{top:!1,animate:!0},dataMarker:{top:!0,point:{style:{r:3,stroke:r.brandColor,lineWidth:2}},line:{style:{stroke:r.annotationLineBorderColor,lineWidth:r.annotationLineBorder},length:r.annotationDataMarkerLineLength},text:{style:{textAlign:"start",fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,fontFamily:r.fontFamily}},direction:"upward",autoAdjust:!0,animate:!0},dataRegion:{style:{region:{fill:r.annotationRegionFillColor,fillOpacity:r.annotationRegionFillOpacity},text:{textAlign:"center",textBaseline:"bottom",fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,fontFamily:r.fontFamily}},animate:!0}},slider:{common:{padding:[8,8,8,8],backgroundStyle:{fill:r.cSliderBackgroundFillColor,opacity:r.cSliderBackgroundFillOpacity},foregroundStyle:{fill:r.cSliderForegroundFillColor,opacity:r.cSliderForegroundFillOpacity},handlerStyle:{width:r.cSliderHandlerWidth,height:r.cSliderHandlerHeight,fill:r.cSliderHandlerFillColor,opacity:r.cSliderHandlerFillOpacity,stroke:r.cSliderHandlerBorderColor,lineWidth:r.cSliderHandlerBorder,radius:r.cSliderHandlerBorderRadius,highLightFill:r.cSliderHandlerHighlightFillColor},textStyle:{fill:r.cSliderTextFillColor,opacity:r.cSliderTextFillOpacity,fontSize:r.cSliderTextFontSize,lineHeight:r.cSliderTextLineHeight,fontWeight:r.cSliderTextFontWeight,stroke:r.cSliderTextBorderColor,lineWidth:r.cSliderTextBorder}}},scrollbar:{common:{padding:[8,8,8,8]},default:{style:{trackColor:r.scrollbarTrackFillColor,thumbColor:r.scrollbarThumbFillColor}},hover:{style:{thumbColor:r.scrollbarThumbHighlightFillColor}}}},labels:{offset:12,style:{fill:r.labelFillColor,fontSize:r.labelFontSize,fontFamily:r.fontFamily,stroke:r.labelBorderColor,lineWidth:r.labelBorder},fillColorDark:r.labelFillColorDark,fillColorLight:r.labelFillColorLight,autoRotate:!0},innerLabels:{style:{fill:r.innerLabelFillColor,fontSize:r.innerLabelFontSize,fontFamily:r.fontFamily,stroke:r.innerLabelBorderColor,lineWidth:r.innerLabelBorder},autoRotate:!0},overflowLabels:{style:{fill:r.overflowLabelFillColor,fontSize:r.overflowLabelFontSize,fontFamily:r.fontFamily,stroke:r.overflowLabelBorderColor,lineWidth:r.overflowLabelBorder}},pieLabels:{labelHeight:14,offset:10,labelLine:{style:{lineWidth:r.labelLineBorder}},autoRotate:!0}}}var Mr={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},qr={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Bn=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],ti=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],li=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],wi=function(r){r===void 0&&(r={});var e=r.paletteQualitative10,t=e===void 0?Bn:e,i=r.paletteQualitative20,o=i===void 0?ti:i,c=r.brandColor,p=c===void 0?t[0]:c,g={backgroundColor:"transparent",brandColor:p,subColor:"rgba(0,0,0,0.05)",paletteQualitative10:t,paletteQualitative20:o,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:li,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:Mr[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:Mr[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:qr[85],axisTickLineBorderColor:Mr[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:Mr[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:Mr[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:Mr[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:Mr[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:p,legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:Mr[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:Mr[100],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:Mr[100],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:Mr[45],legendPageNavigatorTextFontSize:12,sliderRailFillColor:Mr[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:Mr[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:Mr[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:Mr[25],annotationArcBorderColor:Mr[15],annotationArcBorder:1,annotationLineBorderColor:Mr[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:Mr[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:Mr[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:Mr[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"rgb(255, 255, 255)",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 0px 10px #aeaeae",tooltipContainerBorderRadius:3,tooltipTextFillColor:Mr[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:Mr[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:qr[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:Mr[65],overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:qr[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:Mr[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#000",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(0,0,0,0)",scrollbarThumbFillColor:"rgba(0,0,0,0.15)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.2)",pointFillColor:p,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:qr[100],pointBorderOpacity:1,pointActiveBorderColor:Mr[100],pointSelectedBorder:2,pointSelectedBorderColor:Mr[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:p,hollowPointBorderOpacity:.95,hollowPointFillColor:qr[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:Mr[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:Mr[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:p,lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:p,areaFillOpacity:.25,areaActiveFillColor:p,areaActiveFillOpacity:.5,areaSelectedFillColor:p,areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:p,hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:Mr[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:Mr[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:p,intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:Mr[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:Mr[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:p,hollowIntervalBorderOpacity:1,hollowIntervalFillColor:qr[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:Mr[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:Mr[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return(0,P.pi)((0,P.pi)({},g),r)},di=wi();function Ni(r){var e=r.styleSheet,t=e===void 0?{}:e,i=(0,P._T)(r,["styleSheet"]),o=wi(t);return(0,b.b$)({},rr(o),i)}var Oi=Ni({}),zi={default:Oi};function Ui(r){return(0,b.U2)(zi,(0,b.vl)(r),zi.default)}function Hi(r,e){zi[(0,b.vl)(r)]=Ni(e)}function ba(r,e,t){var i=t.translate(r),o=t.translate(e);return(0,b.vQ)(i,o)}function Xo(r,e){var t=e.coordinate,i=e.getXScale(),o=i.range,c=o[o.length-1],p=o[0],g=t.invert(r),_=g.x;return t.isPolar&&_>(1+c)/2&&(_=p),i.translate(i.invert(_))}function Ou(r,e,t){var i=t.coordinate,o=t.getYScale(),c=o.field,p=i.invert(e),g=o.invert(p.y),_=(0,b.sE)(r,function(S){var I=S[ve];return I[c][0]<=g&&I[c][1]>=g});return _||r[r.length-1]}var fs=(0,b.HP)(function(r){if(r.isCategory)return 1;for(var e=r.values,t=e.length,i=r.translate(e[0]),o=i,c=0;c<t;c++){var p=e[c],g=r.translate(p);g<i&&(i=g),g>o&&(o=g)}return(o-i)/(t-1)});function Lo(r,e,t){var i=e.getAttribute("position"),o=i.getFields(),c=e.scales,p=(0,b.mf)(t)||!t?o[0]:t,g=c[p],_=g?g.getText(r[p]):r[p]||p;return(0,b.mf)(t)?t(_,r):_}function Of(r){var e=(0,b.VO)(r.attributes);return(0,b.hX)(e,function(t){return(0,b.FX)(_e,t.type)})}function ll(r){var e,t,i=Of(r),o;try{for(var c=(0,P.XA)(i),p=c.next();!p.done;p=c.next()){var g=p.value,_=g.getScale(g.type);if(_&&_.isLinear){var S=(0,b.U2)(r.scaleDefs,_.field),I=ko(_,S,g.type,r.type);if(I!=="cat"){o=_;break}}}}catch(z){e={error:z}}finally{try{p&&!p.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}var L=r.getXScale(),F=r.getYScale();return o||F||L}function Dc(r,e){var t=e.field,i=r[t];if((0,b.kJ)(i)){var o=i.map(function(c){return e.getText(c)});return o.join("-")}return e.getText(i)}function Ec(r,e){var t,i=e.getGroupScales();if(i.length&&(t=i[0]),t){var o=t.field;return t.getText(r[o])}var c=ll(e);return ul(c)}function vv(r,e,t){if(e.length===0)return null;var i=t.type,o=t.getXScale(),c=t.getYScale(),p=o.field,g=c.field,_=null;if(i==="heatmap"||i==="point"){for(var S=t.coordinate,I=S.invert(r),L=o.invert(I.x),F=c.invert(I.y),z=1/0,V=0;V<e.length;V++){var Q=e[V],st=Q[ve],at=Math.pow(st[p]-L,2)+Math.pow(st[g]-F,2);at<z&&(z=at,_=Q)}return _}var Ft=e[0],Kt=e[e.length-1],ee=Xo(r,t),Me=Ft[ve][p],hr=Ft[ve][g],Tr=Kt[ve][p],Dr=c.isLinear&&(0,b.kJ)(hr);if((0,b.kJ)(Me)){for(var V=0;V<e.length;V++){var cn=e[V],st=cn[ve];if(o.translate(st[p][0])<=ee&&o.translate(st[p][1])>=ee)if(Dr)(0,b.kJ)(_)||(_=[]),_.push(cn);else{_=cn;break}}(0,b.kJ)(_)&&(_=Ou(_,r,t))}else{var Jr=void 0;if(!o.isLinear&&o.type!=="timeCat"){for(var V=0;V<e.length;V++){var cn=e[V],st=cn[ve];if(ba(st[p],ee,o))if(Dr)(0,b.kJ)(_)||(_=[]),_.push(cn);else{_=cn;break}else o.translate(st[p])<=ee&&(Kt=cn,Jr=e[V+1])}(0,b.kJ)(_)&&(_=Ou(_,r,t))}else{if((ee>o.translate(Tr)||ee<o.translate(Me))&&(ee>o.max||ee<o.min))return null;for(var Mn=0,mi=e.length-1,da=void 0;Mn<=mi;){da=Math.floor((Mn+mi)/2);var Sa=e[da][ve][p];if(ba(Sa,ee,o))return e[da];o.translate(Sa)<=o.translate(ee)?(Mn=da+1,Kt=e[da],Jr=e[da+1]):(mi===0&&(Kt=e[0]),mi=da-1)}}Kt&&Jr&&Math.abs(o.translate(Kt[ve][p])-ee)>Math.abs(o.translate(Jr[ve][p])-ee)&&(Kt=Jr)}var eo=fs(t.getXScale());return!_&&Math.abs(o.translate(Kt[ve][p])-ee)<=eo/2&&(_=Kt),_}function Xl(r,e,t,i){var o,c;t===void 0&&(t=""),i===void 0&&(i=!1);var p=r[ve],g=Lo(p,e,t),_=e.tooltipOption,S=e.theme.defaultColor,I=[],L,F;function z(cn,Jr){if(i||!(0,b.UM)(Jr)&&Jr!==""){var Mn={title:g,data:p,mappingData:r,name:cn,value:Jr,color:r.color||S,marker:!0};I.push(Mn)}}if((0,b.Kn)(_)){var V=_.fields,Q=_.callback;if(Q){var st=V.map(function(cn){return r[ve][cn]}),at=Q.apply(void 0,(0,P.ev)([],(0,P.CR)(st),!1)),Ft=(0,P.pi)({data:r[ve],mappingData:r,title:g,color:r.color||S,marker:!0},at);I.push(Ft)}else{var Kt=e.scales;try{for(var ee=(0,P.XA)(V),Me=ee.next();!Me.done;Me=ee.next()){var hr=Me.value;if(!(0,b.UM)(p[hr])){var Tr=Kt[hr];L=ul(Tr),F=Tr.getText(p[hr]),z(L,F)}}}catch(cn){o={error:cn}}finally{try{Me&&!Me.done&&(c=ee.return)&&c.call(ee)}finally{if(o)throw o.error}}}}else{var Dr=ll(e);F=Dc(p,Dr),L=Ec(p,e),z(L,F)}return I}function ih(r,e,t,i){var o,c,p=i.showNil,g=[],_=r.dataArray;if(!(0,b.xb)(_)){r.sort(_);try{for(var S=(0,P.XA)(_),I=S.next();!I.done;I=S.next()){var L=I.value,F=vv(e,L,r);if(F){var z=r.getElementId(F),V=r.elementsMap[z];if(r.type==="heatmap"||V.visible){var Q=Xl(F,r,t,p);Q.length&&g.push(Q)}}}}catch(st){o={error:st}}finally{try{I&&!I.done&&(c=S.return)&&c.call(S)}finally{if(o)throw o.error}}}return g}function Dp(r,e,t,i){var o=i.showNil,c=[],p=r.container,g=p.getShape(e.x,e.y);if(g&&g.get("visible")&&g.get("origin")){var _=g.get("origin").mappingData,S=Xl(_,r,t,o);S.length&&c.push(S)}return c}function u0(r,e,t){var i,o,c=[],p=r.geometries,g=t.shared,_=t.title,S=t.reversed;try{for(var I=(0,P.XA)(p),L=I.next();!L.done;L=I.next()){var F=L.value;if(F.visible&&F.tooltipOption!==!1){var z=F.type,V=void 0;["point","edge","polygon"].includes(z)?V=Dp(F,e,_,t):["area","line","path","heatmap"].includes(z)||g!==!1?V=ih(F,e,_,t):V=Dp(F,e,_,t),V.length&&(S&&V.reverse(),c.push(V))}}}catch(Q){i={error:Q}}finally{try{L&&!L.done&&(o=I.return)&&o.call(I)}finally{if(i)throw i.error}}return c}function su(r,e,t){var i,o,c=u0(r,e,t);try{for(var p=(0,P.XA)(r.views),g=p.next();!g.done;g=p.next()){var _=g.value;c=c.concat(u0(_,e,t))}}catch(S){i={error:S}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}return c}function l0(r){return!(0,b.hj)(r)&&!(0,b.kJ)(r)}function ah(r){r===void 0&&(r=0);var e=(0,b.kJ)(r)?r:[r];switch(e.length){case 0:e=[0,0,0,0];break;case 1:e=new Array(4).fill(e[0]);break;case 2:e=(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),(0,P.CR)(e),!1);break;case 3:e=(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),[e[1]],!1);break;default:e=e.slice(0,4);break}return e}var Bp={};function Th(r,e){Bp[r]=e}function py(r){delete Bp[r]}function bd(){return Object.keys(Bp)}function qh(r){return Bp[r]}var dy=function(){function r(e){this.option=this.wrapperOption(e)}return r.prototype.update=function(e){return this.option=this.wrapperOption(e),this},r.prototype.hasAction=function(e){var t=this.option.actions;return(0,b.G)(t,function(i){return i[0]===e})},r.prototype.create=function(e,t){var i=this.option,o=i.type,c=i.cfg,p=o==="theta",g=(0,P.pi)({start:e,end:t},c),_=vh(p?"polar":o);return this.coordinate=new _(g),this.coordinate.type=o,p&&(this.hasAction("transpose")||this.transpose()),this.execActions(),this.coordinate},r.prototype.adjust=function(e,t){return this.coordinate.update({start:e,end:t}),this.coordinate.resetMatrix(),this.execActions(["scale","rotate","translate"]),this.coordinate},r.prototype.rotate=function(e){return this.option.actions.push(["rotate",e]),this},r.prototype.reflect=function(e){return this.option.actions.push(["reflect",e]),this},r.prototype.scale=function(e,t){return this.option.actions.push(["scale",e,t]),this},r.prototype.transpose=function(){return this.option.actions.push(["transpose"]),this},r.prototype.getOption=function(){return this.option},r.prototype.getCoordinate=function(){return this.coordinate},r.prototype.wrapperOption=function(e){return(0,P.pi)({type:"rect",actions:[],cfg:{}},e)},r.prototype.execActions=function(e){var t=this,i=this.option.actions;(0,b.S6)(i,function(o){var c,p=(0,P.CR)(o),g=p[0],_=p.slice(1),S=(0,b.UM)(e)?!0:e.includes(g);S&&(c=t.coordinate)[g].apply(c,(0,P.ev)([],(0,P.CR)(_),!1))})},r}(),vy=dy,d_=function(){function r(e,t,i){this.view=e,this.gEvent=t,this.data=i,this.type=t.type}return r.fromData=function(e,t,i){return new r(e,new ye.Event(t,{}),i)},Object.defineProperty(r.prototype,"target",{get:function(){return this.gEvent.target},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"event",{get:function(){return this.gEvent.originalEvent},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"x",{get:function(){return this.gEvent.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this.gEvent.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientX",{get:function(){return this.gEvent.clientX},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientY",{get:function(){return this.gEvent.clientY},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[Event (type=".concat(this.type,")]")},r.prototype.clone=function(){return new r(this.view,this.gEvent,this.data)},r}(),fo=d_;function Np(r){var e=r.getController("axis"),t=r.getController("legend"),i=r.getController("annotation"),o=r.getController("slider"),c=r.getController("scrollbar");[e,o,c,t,i].forEach(function(p){p&&p.layout()})}var gy=function(){function r(){this.scales=new Map,this.syncScales=new Map}return r.prototype.createScale=function(e,t,i,o){var c=i,p=this.getScaleMeta(o);if(t.length===0&&p){var g=p.scale,_={type:g.type};g.isCategory&&(_.values=g.values),c=(0,b.b$)(_,p.scaleDef,i)}var S=Pf(e,t,c);return this.cacheScale(S,i,o),S},r.prototype.sync=function(e,t){var i=this;this.syncScales.forEach(function(o,c){var p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,_=[];(0,b.S6)(o,function(S){var I=i.getScale(S);g=(0,b.hj)(I.max)?Math.max(g,I.max):g,p=(0,b.hj)(I.min)?Math.min(p,I.min):p,(0,b.S6)(I.values,function(L){_.includes(L)||_.push(L)})}),(0,b.S6)(o,function(S){var I=i.getScale(S);if(I.isContinuous)I.change({min:p,max:g,values:_});else if(I.isCategory){var L=I.range,F=i.getScaleMeta(S);_&&!(0,b.U2)(F,["scaleDef","range"])&&(L=cv((0,b.b$)({},I,{values:_}),e,t)),I.change({values:_,range:L})}})})},r.prototype.cacheScale=function(e,t,i){var o=this.getScaleMeta(i);o&&o.scale.type===e.type?(Is(o.scale,e),o.scaleDef=t):(o={key:i,scale:e,scaleDef:t},this.scales.set(i,o));var c=this.getSyncKey(o);if(o.syncKey=c,this.removeFromSyncScales(i),c){var p=this.syncScales.get(c);p||(p=[],this.syncScales.set(c,p)),p.push(i)}},r.prototype.getScale=function(e){var t=this.getScaleMeta(e);if(!t){var i=(0,b.Z$)(e.split("-")),o=this.syncScales.get(i);o&&o.length&&(t=this.getScaleMeta(o[0]))}return t&&t.scale},r.prototype.deleteScale=function(e){var t=this.getScaleMeta(e);if(t){var i=t.syncKey,o=this.syncScales.get(i);if(o&&o.length){var c=o.indexOf(e);c!==-1&&o.splice(c,1)}}this.scales.delete(e)},r.prototype.clear=function(){this.scales.clear(),this.syncScales.clear()},r.prototype.removeFromSyncScales=function(e){var t=this;this.syncScales.forEach(function(i,o){var c=i.indexOf(e);if(c!==-1)return i.splice(c,1),i.length===0&&t.syncScales.delete(o),!1})},r.prototype.getSyncKey=function(e){var t=e.scale,i=e.scaleDef,o=t.field,c=(0,b.U2)(i,["sync"]);return c===!0?o:c===!1?void 0:c},r.prototype.getScaleMeta=function(e){return this.scales.get(e)},r}(),f=function(){function r(e,t,i,o){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),o===void 0&&(o=0),this.top=e,this.right=t,this.bottom=i,this.left=o}return r.instance=function(e,t,i,o){return e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),o===void 0&&(o=0),new r(e,t,i,o)},r.prototype.max=function(e){var t=(0,P.CR)(e,4),i=t[0],o=t[1],c=t[2],p=t[3];return this.top=Math.max(this.top,i),this.right=Math.max(this.right,o),this.bottom=Math.max(this.bottom,c),this.left=Math.max(this.left,p),this},r.prototype.shrink=function(e){var t=(0,P.CR)(e,4),i=t[0],o=t[1],c=t[2],p=t[3];return this.top+=i,this.right+=o,this.bottom+=c,this.left+=p,this},r.prototype.inc=function(e,t){var i=e.width,o=e.height;switch(t){case le.TOP:case le.TOP_LEFT:case le.TOP_RIGHT:this.top+=o;break;case le.RIGHT:case le.RIGHT_TOP:case le.RIGHT_BOTTOM:this.right+=i;break;case le.BOTTOM:case le.BOTTOM_LEFT:case le.BOTTOM_RIGHT:this.bottom+=o;break;case le.LEFT:case le.LEFT_TOP:case le.LEFT_BOTTOM:this.left+=i;break;default:break}return this},r.prototype.getPadding=function(){return[this.top,this.right,this.bottom,this.left]},r.prototype.clone=function(){return new(r.bind.apply(r,(0,P.ev)([void 0],(0,P.CR)(this.getPadding()),!1)))},r}();function d(r){var e=r.padding;if(!l0(e))return new(f.bind.apply(f,(0,P.ev)([void 0],(0,P.CR)(ah(e)),!1)));var t=r.viewBBox,i=new f,o=[],c=[],p=[];return(0,b.S6)(r.getComponents(),function(g){var _=g.type;_===Ee.AXIS?o.push(g):[Ee.LEGEND,Ee.SLIDER,Ee.SCROLLBAR].includes(_)?c.push(g):_!==Ee.GRID&&_!==Ee.TOOLTIP&&p.push(g)}),(0,b.S6)(o,function(g){var _=g.component,S=_.getLayoutBBox(),I=new Iu(S.x,S.y,S.width,S.height),L=I.exceed(t);i.max(L)}),(0,b.S6)(c,function(g){var _=g.component,S=g.direction,I=_.getLayoutBBox(),L=_.get("padding"),F=new Iu(I.x,I.y,I.width,I.height).expand(L);i.inc(F,S)}),(0,b.S6)(p,function(g){var _=g.component,S=g.direction,I=_.getLayoutBBox(),L=new Iu(I.x,I.y,I.width,I.height);i.inc(L,S)}),i}function y(r,e,t){var i=t.instance();e.forEach(function(o){o.autoPadding=i.max(o.autoPadding.getPadding())})}var T=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,{visible:t.visible})||this;i.views=[],i.geometries=[],i.controllers=[],i.interactions={},i.limitInPlot=!1,i.options={data:[],animate:!0},i.usedControllers=bd(),i.scalePool=new gy,i.layoutFunc=Np,i.isPreMouseInPlot=!1,i.isDataChanged=!1,i.isCoordinateChanged=!1,i.createdScaleKeys=new Map,i.onCanvasEvent=function(Kt){var ee=Kt.name;if(!ee.includes(":")){var Me=i.createViewEvent(Kt);i.doPlotEvent(Me),i.emit(ee,Me)}},i.onDelegateEvents=function(Kt){var ee=Kt.name;if(ee.includes(":")){var Me=i.createViewEvent(Kt);i.emit(ee,Me)}};var o=t.id,c=o===void 0?(0,b.EL)("view"):o,p=t.parent,g=t.canvas,_=t.backgroundGroup,S=t.middleGroup,I=t.foregroundGroup,L=t.region,F=L===void 0?{start:{x:0,y:0},end:{x:1,y:1}}:L,z=t.padding,V=t.appendPadding,Q=t.theme,st=t.options,at=t.limitInPlot,Ft=t.syncViewPadding;return i.parent=p,i.canvas=g,i.backgroundGroup=_,i.middleGroup=S,i.foregroundGroup=I,i.region=F,i.padding=z,i.appendPadding=V,i.options=(0,P.pi)((0,P.pi)({},i.options),st),i.limitInPlot=at,i.id=c,i.syncViewPadding=Ft,i.themeObject=(0,b.Kn)(Q)?(0,b.b$)({},Ui("default"),Ni(Q)):Ui(Q),i.init(),i}return e.prototype.setLayout=function(t){this.layoutFunc=t},e.prototype.init=function(){this.calculateViewBBox(),this.initEvents(),this.initComponentController(),this.initOptions()},e.prototype.render=function(t,i){t===void 0&&(t=!1),this.emit(Tt.BEFORE_RENDER,fo.fromData(this,Tt.BEFORE_RENDER,i)),this.paint(t),this.emit(Tt.AFTER_RENDER,fo.fromData(this,Tt.AFTER_RENDER,i)),this.visible===!1&&this.changeVisible(!1)},e.prototype.clear=function(){var t=this;this.emit(Tt.BEFORE_CLEAR),this.filteredData=[],this.coordinateInstance=void 0,this.isDataChanged=!1,this.isCoordinateChanged=!1;for(var i=this.geometries,o=0;o<i.length;o++)i[o].clear(),i[o].container.remove(!0),i[o].labelsContainer.remove(!0);this.geometries=[];for(var c=this.controllers,o=0;o<c.length;o++)c[o].name==="annotation"?c[o].clear(!0):c[o].clear();this.createdScaleKeys.forEach(function(g,_){t.getRootView().scalePool.deleteScale(_)}),this.createdScaleKeys.clear();for(var p=this.views,o=0;o<p.length;o++)p[o].clear();this.emit(Tt.AFTER_CLEAR)},e.prototype.destroy=function(){this.emit(Tt.BEFORE_DESTROY);var t=this.interactions;(0,b.S6)(t,function(g){g&&g.destroy()}),this.clear();for(var i=this.controllers,o=0,c=i.length;o<c;o++){var p=i[o];p.destroy()}this.backgroundGroup.remove(!0),this.middleGroup.remove(!0),this.foregroundGroup.remove(!0),r.prototype.destroy.call(this)},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t);for(var i=this.geometries,o=0,c=i.length;o<c;o++){var p=i[o];p.changeVisible(t)}for(var g=this.controllers,o=0,c=g.length;o<c;o++){var _=g[o];_.changeVisible(t)}return this.foregroundGroup.set("visible",t),this.middleGroup.set("visible",t),this.backgroundGroup.set("visible",t),this.getCanvas().draw(),this},e.prototype.data=function(t){return(0,b.t8)(this.options,"data",t),this.isDataChanged=!0,this},e.prototype.source=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.data() instead."),this.data(t)},e.prototype.filter=function(t,i){return(0,b.mf)(i)?((0,b.t8)(this.options,["filters",t],i),this):(!i&&(0,b.U2)(this.options,["filters",t])&&delete this.options.filters[t],this)},e.prototype.axis=function(t,i){return(0,b.jn)(t)?(0,b.t8)(this.options,["axes"],t):(0,b.t8)(this.options,["axes",t],i),this},e.prototype.legend=function(t,i){return(0,b.jn)(t)?(0,b.t8)(this.options,["legends"],t):(0,b.HD)(t)?((0,b.t8)(this.options,["legends",t],i),(0,b.PO)(i)&&(i!=null&&i.selected)&&(0,b.t8)(this.options,["filters",t],function(o){var c;return(c=i==null?void 0:i.selected[o])!==null&&c!==void 0?c:!0})):(0,b.t8)(this.options,["legends"],t),this},e.prototype.scale=function(t,i){var o=this;return(0,b.HD)(t)?(0,b.t8)(this.options,["scales",t],i):(0,b.Kn)(t)&&(0,b.S6)(t,function(c,p){(0,b.t8)(o.options,["scales",p],c)}),this},e.prototype.tooltip=function(t){return(0,b.t8)(this.options,"tooltip",t),this},e.prototype.annotation=function(){return this.getController("annotation")},e.prototype.guide=function(){return console.warn("This method will be removed at G2 V4.1. Please use chart.annotation() instead."),this.annotation()},e.prototype.coordinate=function(t,i){return(0,b.HD)(t)?(0,b.t8)(this.options,"coordinate",{type:t,cfg:i}):(0,b.t8)(this.options,"coordinate",t),this.coordinateController.update(this.options.coordinate),this.coordinateController},e.prototype.coord=function(t,i){return console.warn("This method will be removed at G2 V4.1. Please use chart.coordinate() instead."),this.coordinate(t,i)},e.prototype.facet=function(t,i){this.facetInstance&&this.facetInstance.destroy();var o=s0(t);if(!o)throw new Error("facet '".concat(t,"' is not exist!"));return this.facetInstance=new o(this,(0,P.pi)((0,P.pi)({},i),{type:t})),this},e.prototype.animate=function(t){return(0,b.t8)(this.options,"animate",t),this},e.prototype.updateOptions=function(t){return this.clear(),(0,b.CD)(this.options,t),this.views.forEach(function(i){return i.destroy()}),this.views=[],this.initOptions(),this.coordinateBBox=this.viewBBox,this},e.prototype.option=function(t,i){if(e.prototype[t])throw new Error(`Can't use built in variable name "`.concat(t,'", please change another one.'));return(0,b.t8)(this.options,t,i),this},e.prototype.theme=function(t){return this.themeObject=(0,b.Kn)(t)?(0,b.b$)({},this.themeObject,Ni(t)):Ui(t),this},e.prototype.interaction=function(t,i){var o=this.interactions[t];o&&o.destroy();var c=Rr(t,this,i);return c&&(c.init(),this.interactions[t]=c),this},e.prototype.removeInteraction=function(t){var i=this.interactions[t];i&&(i.destroy(),this.interactions[t]=void 0)},e.prototype.changeData=function(t){this.isDataChanged=!0,this.emit(Tt.BEFORE_CHANGE_DATA,fo.fromData(this,Tt.BEFORE_CHANGE_DATA,null)),this.data(t),this.paint(!0);for(var i=this.views,o=0,c=i.length;o<c;o++){var p=i[o];p.changeData(t)}this.emit(Tt.AFTER_CHANGE_DATA,fo.fromData(this,Tt.AFTER_CHANGE_DATA,null))},e.prototype.createView=function(t){this.parent&&this.parent.parent&&console.warn("The view nesting recursive feature will be removed at G2 V4.1. Please avoid to use it.");var i={data:this.options.data,scales:(0,b.d9)(this.options.scales),axes:(0,b.d9)(this.options.axes),coordinate:(0,b.d9)(this.coordinateController.getOption()),tooltip:(0,b.d9)(this.options.tooltip),legends:(0,b.d9)(this.options.legends),animate:this.options.animate,visible:this.visible},o=new e((0,P.pi)((0,P.pi)({parent:this,canvas:this.canvas,backgroundGroup:this.backgroundGroup.addGroup({zIndex:ke.BG}),middleGroup:this.middleGroup.addGroup({zIndex:ke.MID}),foregroundGroup:this.foregroundGroup.addGroup({zIndex:ke.FORE}),theme:this.themeObject,padding:this.padding},t),{options:(0,P.pi)((0,P.pi)({},i),(0,b.U2)(t,"options",{}))}));return this.views.push(o),o},e.prototype.view=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.createView() instead."),this.createView(t)},e.prototype.removeView=function(t){var i=(0,b.Od)(this.views,function(o){return o===t})[0];return i&&i.destroy(),i},e.prototype.getCoordinate=function(){return this.coordinateInstance},e.prototype.getTheme=function(){return this.themeObject},e.prototype.getXScale=function(){var t=this.geometries[0];return t?t.getXScale():null},e.prototype.getYScales=function(){var t={},i=[];return this.geometries.forEach(function(o){var c=o.getYScale(),p=c.field;t[p]||(t[p]=!0,i.push(c))}),i},e.prototype.getScalesByDim=function(t){for(var i=this.geometries,o={},c=0,p=i.length;c<p;c++){var g=i[c],_=t==="x"?g.getXScale():g.getYScale();_&&!o[_.field]&&(o[_.field]=_)}return o},e.prototype.getScale=function(t,i){var o=i||this.getScaleKey(t);return this.getRootView().scalePool.getScale(o)},e.prototype.getScaleByField=function(t,i){return this.getScale(t,i)},e.prototype.getOptions=function(){return this.options},e.prototype.getData=function(){return this.filteredData},e.prototype.getOriginalData=function(){return this.options.data},e.prototype.getPadding=function(){return this.autoPadding.getPadding()},e.prototype.getGeometries=function(){return this.geometries},e.prototype.getElements=function(){return(0,b.u4)(this.geometries,function(t,i){return t.concat(i.getElements())},[])},e.prototype.getElementsBy=function(t){return this.getElements().filter(function(i){return t(i)})},e.prototype.getLayer=function(t){return t===W.BG?this.backgroundGroup:t===W.MID?this.middleGroup:t===W.FORE?this.foregroundGroup:this.foregroundGroup},e.prototype.isPointInPlot=function(t){return Sh(this.getCoordinate(),t)},e.prototype.getLegendAttributes=function(){return(0,b.xH)(this.geometries.map(function(t){return t.getGroupAttributes()}))},e.prototype.getGroupScales=function(){var t=this.geometries.map(function(i){return i.getGroupScales()});return bc((0,b.xH)(t))},e.prototype.getCanvas=function(){return this.getRootView().canvas},e.prototype.getRootView=function(){for(var t=this;;){if(t.parent){t=t.parent;continue}break}return t},e.prototype.getXY=function(t){var i=this.getCoordinate(),o=this.getScalesByDim("x"),c=this.getScalesByDim("y"),p,g;if((0,b.S6)(t,function(_,S){o[S]&&(p=o[S].scale(_)),c[S]&&(g=c[S].scale(_))}),!(0,b.UM)(p)&&!(0,b.UM)(g))return i.convert({x:p,y:g})},e.prototype.getController=function(t){return(0,b.sE)(this.controllers,function(i){return i.name===t})},e.prototype.showTooltip=function(t){var i=this.getController("tooltip");return i&&i.showTooltip(t),this},e.prototype.hideTooltip=function(){var t=this.getController("tooltip");return t&&t.hideTooltip(),this},e.prototype.lockTooltip=function(){var t=this.getController("tooltip");return t&&t.lockTooltip(),this},e.prototype.unlockTooltip=function(){var t=this.getController("tooltip");return t&&t.unlockTooltip(),this},e.prototype.isTooltipLocked=function(){var t=this.getController("tooltip");return t&&t.isTooltipLocked()},e.prototype.getTooltipItems=function(t){var i=this.getController("tooltip");return i?i.getTooltipItems(t):[]},e.prototype.getSnapRecords=function(t){for(var i=this.geometries,o=[],c=0,p=i.length;c<p;c++){var g=i[c],_=g.dataArray;g.sort(_);for(var S=void 0,I=0,L=_.length;I<L;I++){var F=_[I];S=vv(t,F,g),S&&o.push(S)}}for(var z=this.views,c=0,p=z.length;c<p;c++){var V=z[c],Q=V.getSnapRecords(t);o=o.concat(Q)}return o},e.prototype.getComponents=function(){for(var t=[],i=this.controllers,o=0,c=i.length;o<c;o++){var p=i[o];t=t.concat(p.getComponents())}return t},e.prototype.filterData=function(t){var i=this.options.filters;return(0,b.dp)(i)===0?t:(0,b.hX)(t,function(o,c){var p=Object.keys(i);return p.every(function(g){var _=i[g];return _(o[g],o,c)})})},e.prototype.filterFieldData=function(t,i){var o=this.options.filters,c=(0,b.U2)(o,t);return(0,b.o8)(c)?i:i.filter(function(p,g){return c(p[t],p,g)})},e.prototype.adjustCoordinate=function(){var t=this.getCoordinate(),i=t.start,o=t.end,c=this.coordinateBBox.bl,p=this.coordinateBBox.tr;if((0,b.Xy)(i,c)&&(0,b.Xy)(o,p)){this.isCoordinateChanged=!1;return}this.isCoordinateChanged=!0,this.coordinateInstance=this.coordinateController.adjust(c,p)},e.prototype.paint=function(t){this.renderDataRecursive(t),this.syncScale(),this.emit(Tt.BEFORE_PAINT),this.renderPaddingRecursive(t),this.renderLayoutRecursive(t),this.renderBackgroundStyleShape(),this.renderPaintRecursive(t),this.emit(Tt.AFTER_PAINT),this.isDataChanged=!1},e.prototype.renderBackgroundStyleShape=function(){if(!this.parent){var t=(0,b.U2)(this.themeObject,"background");if(t){this.backgroundStyleRectShape||(this.backgroundStyleRectShape=this.backgroundGroup.addShape("rect",{attrs:{},zIndex:-1,capture:!1}),this.backgroundStyleRectShape.toBack());var i=this.viewBBox,o=i.x,c=i.y,p=i.width,g=i.height;this.backgroundStyleRectShape.attr({fill:t,x:o,y:c,width:p,height:g})}else this.backgroundStyleRectShape&&(this.backgroundStyleRectShape.remove(!0),this.backgroundStyleRectShape=void 0)}},e.prototype.renderPaddingRecursive=function(t){this.calculateViewBBox(),this.adjustCoordinate(),this.initComponents(t),this.autoPadding=d(this).shrink(ah(this.appendPadding)),this.coordinateBBox=this.viewBBox.shrink(this.autoPadding.getPadding()),this.adjustCoordinate();var i=this.controllers.find(function(_){return _.name==="tooltip"});i.update();for(var o=this.views,c=0,p=o.length;c<p;c++){var g=o[c];g.renderPaddingRecursive(t)}},e.prototype.renderLayoutRecursive=function(t){var i=this.syncViewPadding===!0?y:(0,b.mf)(this.syncViewPadding)?this.syncViewPadding:void 0;i&&(i(this,this.views,f),this.views.forEach(function(_){_.coordinateBBox=_.viewBBox.shrink(_.autoPadding.getPadding()),_.adjustCoordinate()})),this.doLayout();for(var o=this.views,c=0,p=o.length;c<p;c++){var g=o[c];g.renderLayoutRecursive(t)}},e.prototype.renderPaintRecursive=function(t){var i=this.middleGroup;if(this.limitInPlot){var o=Yh(this.coordinateInstance),c=o.type,p=o.attrs;i.setClip({type:c,attrs:p})}else i.setClip(void 0);this.paintGeometries(t),this.renderComponents(t);for(var g=this.views,_=0,S=g.length;_<S;_++){var I=g[_];I.renderPaintRecursive(t)}},e.prototype.createScale=function(t,i,o,c){var p=(0,b.U2)(this.options.scales,[t]),g=(0,P.pi)((0,P.pi)({},p),o);return this.parent?this.parent.createScale(t,i,g,c):this.scalePool.createScale(t,i,g,c)},e.prototype.renderDataRecursive=function(t){this.doFilterData(),this.createCoordinate(),this.initGeometries(t),this.renderFacet(t);for(var i=this.views,o=0,c=i.length;o<c;o++){var p=i[o];p.renderDataRecursive(t)}},e.prototype.calculateViewBBox=function(){var t,i,o,c;if(this.parent){var p=this.parent.coordinateBBox;t=p.x,i=p.y,o=p.width,c=p.height}else t=0,i=0,o=this.canvas.get("width"),c=this.canvas.get("height");var g=this.region,_=g.start,S=g.end,I=new Iu(t+o*_.x,i+c*_.y,o*(S.x-_.x),c*(S.y-_.y));(!this.viewBBox||!this.viewBBox.isEqual(I))&&(this.viewBBox=new Iu(t+o*_.x,i+c*_.y,o*(S.x-_.x),c*(S.y-_.y))),this.coordinateBBox=this.viewBBox},e.prototype.initEvents=function(){this.foregroundGroup.on("*",this.onDelegateEvents),this.middleGroup.on("*",this.onDelegateEvents),this.backgroundGroup.on("*",this.onDelegateEvents),this.canvas.on("*",this.onCanvasEvent)},e.prototype.initComponentController=function(){for(var t=this.usedControllers,i=0,o=t.length;i<o;i++){var c=t[i],p=qh(c);p&&this.controllers.push(new p(this))}},e.prototype.createViewEvent=function(t){var i=t.shape,o=t.name,c=i?i.get("origin"):null,p=new fo(this,t,c);return p.type=o,p},e.prototype.doPlotEvent=function(t){var i=t.type,o=t.x,c=t.y,p={x:o,y:c},g=["mousedown","mouseup","mousemove","mouseleave","mousewheel","touchstart","touchmove","touchend","touchcancel","click","dblclick","contextmenu"];if(g.includes(i)){var _=this.isPointInPlot(p),S=t.clone();if(_){var I="plot:".concat(i);S.type=I,this.emit(I,S),(i==="mouseleave"||i==="touchend")&&(this.isPreMouseInPlot=!1)}i==="mousemove"||i==="touchmove"?(this.isPreMouseInPlot&&!_?(i==="mousemove"&&(S.type=Dt.MOUSE_LEAVE,this.emit(Dt.MOUSE_LEAVE,S)),S.type=Dt.LEAVE,this.emit(Dt.LEAVE,S)):!this.isPreMouseInPlot&&_&&(i==="mousemove"&&(S.type=Dt.MOUSE_ENTER,this.emit(Dt.MOUSE_ENTER,S)),S.type=Dt.ENTER,this.emit(Dt.ENTER,S)),this.isPreMouseInPlot=_):(i==="mouseleave"||i==="touchend")&&this.isPreMouseInPlot&&(i==="mouseleave"&&(S.type=Dt.MOUSE_LEAVE,this.emit(Dt.MOUSE_LEAVE,S)),S.type=Dt.LEAVE,this.emit(Dt.LEAVE,S),this.isPreMouseInPlot=!1)}},e.prototype.doFilterData=function(){var t=this.options.data;this.filteredData=this.filterData(t)},e.prototype.initGeometries=function(t){this.createOrUpdateScales();for(var i=this.getCoordinate(),o=(0,b.U2)(this.options,"scales",{}),c=this.geometries,p=0,g=c.length;p<g;p++){var _=c[p];_.scales=this.getGeometryScales();var S={coordinate:i,scaleDefs:o,data:this.filteredData,theme:this.themeObject,isDataChanged:this.isDataChanged,isCoordinateChanged:this.isCoordinateChanged};t?_.update(S):_.init(S)}this.adjustScales()},e.prototype.createOrUpdateScales=function(){for(var t=this.getScaleFields(),i=this.getGroupedFields(),o=this.getOptions(),c=o.data,p=o.scales,g=p===void 0?{}:p,_=this.filteredData,S=0,I=t.length;S<I;S++){var L=t[S],F=g[L],z=this.getScaleKey(L);this.createScale(L,i.includes(L)?c:_,F,z),this.createdScaleKeys.set(z,!0)}},e.prototype.syncScale=function(){this.getRootView().scalePool.sync(this.getCoordinate(),this.theme)},e.prototype.getGeometryScales=function(){for(var t=this.getScaleFields(),i={},o=0;o<t.length;o++){var c=t[o];i[c]=this.getScaleByField(c)}return i},e.prototype.getScaleFields=function(){for(var t=[],i=new Map,o=this.geometries,c=0;c<o.length;c++){var p=o[c],g=p.getScaleFields();bc(g,t,i)}return t},e.prototype.getGroupedFields=function(){for(var t=[],i=new Map,o=this.geometries,c=0;c<o.length;c++){var p=o[c],g=p.getGroupFields();bc(g,t,i)}return t},e.prototype.adjustScales=function(){this.adjustCategoryScaleRange()},e.prototype.adjustCategoryScaleRange=function(){var t=this,i=(0,P.ev)([this.getXScale()],(0,P.CR)(this.getYScales()),!1).filter(function(p){return!!p}),o=this.getCoordinate(),c=this.options.scales;(0,b.S6)(i,function(p){var g=p.field,_=p.values,S=p.isCategory,I=p.isIdentity;(S||I)&&_&&!(0,b.U2)(c,[g,"range"])&&(p.range=cv(p,o,t.theme))})},e.prototype.initComponents=function(t){for(var i=this.controllers,o=0;o<i.length;o++){var c=i[o];t?c.update():(c.clear(),c.render())}},e.prototype.doLayout=function(){this.layoutFunc(this)},e.prototype.createCoordinate=function(){var t=this.coordinateBBox.bl,i=this.coordinateBBox.tr;this.coordinateInstance=this.coordinateController.create(t,i)},e.prototype.paintGeometries=function(t){for(var i=this.options.animate,o=this.getCoordinate(),c={x:this.viewBBox.x,y:this.viewBBox.y,minX:this.viewBBox.minX,minY:this.viewBBox.minY,maxX:this.viewBBox.maxX,maxY:this.viewBBox.maxY,width:this.viewBBox.width,height:this.viewBBox.height},p=this.geometries,g=0;g<p.length;g++){var _=p[g];_.coordinate=o,_.canvasRegion=c,i||_.animate(!1),_.paint(t)}},e.prototype.renderComponents=function(t){for(var i=this.getComponents(),o=0;o<i.length;o++){var c=i[o];c.component.render()}},e.prototype.renderFacet=function(t){this.facetInstance&&(t?this.facetInstance.update():(this.facetInstance.clear(),this.facetInstance.init(),this.facetInstance.render()))},e.prototype.initOptions=function(){var t=this,i=this.options,o=i.geometries,c=o===void 0?[]:o,p=i.interactions,g=p===void 0?[]:p,_=i.views,S=_===void 0?[]:_,I=i.annotations,L=I===void 0?[]:I,F=i.coordinate,z=i.events,V=i.facets;this.coordinateController?F&&this.coordinateController.update(F):this.coordinateController=new vy(F);for(var Q=0;Q<c.length;Q++){var st=c[Q];this.createGeometry(st)}for(var at=0;at<g.length;at++){var Ft=g[at],Kt=Ft.type,ee=Ft.cfg;this.interaction(Kt,ee)}for(var Me=0;Me<S.length;Me++){var hr=S[Me];this.createView(hr)}for(var Tr=this.getController("annotation"),Dr=0;Dr<L.length;Dr++){var cn=L[Dr];Tr.annotation(cn)}z&&(0,b.S6)(z,function(Jr,Mn){t.on(Mn,Jr)}),V&&(0,b.S6)(V,function(Jr){var Mn=Jr.type,mi=(0,P._T)(Jr,["type"]);t.facet(Mn,mi)})},e.prototype.createGeometry=function(t){var i=t.type,o=t.cfg,c=o===void 0?{}:o;if(this[i]){var p=this[i](c);(0,b.S6)(t,function(g,_){(0,b.mf)(p[_])&&p[_](g)})}},e.prototype.getScaleKey=function(t){return"".concat(this.id,"-").concat(t)},e}(re);function O(r,e){T.prototype[r.toLowerCase()]=function(t){t===void 0&&(t={});var i=(0,P.pi)({container:this.middleGroup.addGroup(),labelsContainer:this.foregroundGroup.addGroup()},t),o=new e(i);return this.geometries.push(o),o}}var N=T,Z=function(r){(0,P.ZT)(e,r);function e(t){var i=this,o=t.container,c=t.width,p=t.height,g=t.autoFit,_=g===void 0?!1:g,S=t.padding,I=t.appendPadding,L=t.renderer,F=L===void 0?"canvas":L,z=t.pixelRatio,V=t.localRefresh,Q=V===void 0?!0:V,st=t.visible,at=st===void 0?!0:st,Ft=t.supportCSSTransform,Kt=Ft===void 0?!1:Ft,ee=t.defaultInteractions,Me=ee===void 0?["tooltip","legend-filter","legend-active","continuous-filter","ellipsis-text","axis-description"]:ee,hr=t.options,Tr=t.limitInPlot,Dr=t.theme,cn=t.syncViewPadding,Jr=(0,b.HD)(o)?document.getElementById(o):o,Mn=(0,wt.Z)('<div style="position:relative;"></div>');Jr.appendChild(Mn);var mi=Oe(Jr,_,c,p),da=te(F),Sa=new da.Canvas((0,P.pi)({container:Mn,pixelRatio:z,localRefresh:Q,supportCSSTransform:Kt},mi));return i=r.call(this,{parent:null,canvas:Sa,backgroundGroup:Sa.addGroup({zIndex:ke.BG}),middleGroup:Sa.addGroup({zIndex:ke.MID}),foregroundGroup:Sa.addGroup({zIndex:ke.FORE}),padding:S,appendPadding:I,visible:at,options:hr,limitInPlot:Tr,theme:Dr,syncViewPadding:cn})||this,i.onResize=(0,b.Ds)(function(){i.forceFit()},300),i.ele=Jr,i.canvas=Sa,i.width=mi.width,i.height=mi.height,i.autoFit=_,i.localRefresh=Q,i.renderer=F,i.wrapperElement=Mn,i.updateCanvasStyle(),i.bindAutoFit(),i.initDefaultInteractions(Me),i}return e.prototype.initDefaultInteractions=function(t){var i=this;(0,b.S6)(t,function(o){i.interaction(o)})},e.prototype.aria=function(t){var i="aria-label";t===!1?this.ele.removeAttribute(i):this.ele.setAttribute(i,t.label)},e.prototype.changeSize=function(t,i){return this.width===t&&this.height===i?this:(this.emit(Tt.BEFORE_CHANGE_SIZE),this.width=t,this.height=i,this.canvas.changeSize(t,i),this.render(!0),this.emit(Tt.AFTER_CHANGE_SIZE),this)},e.prototype.clear=function(){r.prototype.clear.call(this),this.aria(!1)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.unbindAutoFit(),this.canvas.destroy(),Le(this.wrapperElement),this.wrapperElement=null},e.prototype.changeVisible=function(t){return r.prototype.changeVisible.call(this,t),this.wrapperElement.style.display=t?"":"none",this},e.prototype.forceFit=function(){if(!this.destroyed){var t=Oe(this.ele,!0,this.width,this.height),i=t.width,o=t.height;this.changeSize(i,o)}},e.prototype.updateCanvasStyle=function(){(0,Y.Z)(this.canvas.get("el"),{display:"inline-block",verticalAlign:"middle"})},e.prototype.bindAutoFit=function(){this.autoFit&&window.addEventListener("resize",this.onResize)},e.prototype.unbindAutoFit=function(){this.autoFit&&window.removeEventListener("resize",this.onResize)},e}(N),q=Z,dt=function(){function r(e){this.visible=!0,this.components=[],this.view=e}return r.prototype.clear=function(e){(0,b.S6)(this.components,function(t){t.component.destroy()}),this.components=[]},r.prototype.destroy=function(){this.clear()},r.prototype.getComponents=function(){return this.components},r.prototype.changeVisible=function(e){this.visible!==e&&(this.components.forEach(function(t){e?t.component.show():t.component.hide()}),this.visible=e)},r}();function Lt(r){for(var e=[],t=function(o){var c=r[o],p=(0,b.sE)(e,function(g){return g.color===c.color&&g.name===c.name&&g.value===c.value&&g.title===c.title});p||e.push(c)},i=0;i<r.length;i++)t(i);return e}var Gt=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isLocked=!1,t}return Object.defineProperty(e.prototype,"name",{get:function(){return"tooltip"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.isVisible=function(){var t=this.view.getOptions().tooltip;return t!==!1},e.prototype.render=function(){},e.prototype.showTooltip=function(t){if(this.point=t,!!this.isVisible()){var i=this.view,o=this.getTooltipItems(t);if(!o.length){this.hideTooltip();return}var c=this.getTitle(o),p={x:o[0].x,y:o[0].y};i.emit("tooltip:show",fo.fromData(i,"tooltip:show",(0,P.pi)({items:o,title:c},t)));var g=this.getTooltipCfg(),_=g.follow,S=g.showMarkers,I=g.showCrosshairs,L=g.showContent,F=g.marker,z=this.items,V=this.title;if(!(0,b.Xy)(V,c)||!(0,b.Xy)(z,o)?(i.emit("tooltip:change",fo.fromData(i,"tooltip:change",(0,P.pi)({items:o,title:c},t))),((0,b.mf)(L)?L(o):L)&&(this.tooltip||this.renderTooltip(),this.tooltip.update((0,b.CD)({},g,{items:this.getItemsAfterProcess(o),title:c},_?t:{})),this.tooltip.show()),S&&this.renderTooltipMarkers(o,F)):(this.tooltip&&_&&(this.tooltip.update(t),this.tooltip.show()),this.tooltipMarkersGroup&&this.tooltipMarkersGroup.show()),this.items=o,this.title=c,I){var Q=(0,b.U2)(g,["crosshairs","follow"],!1);this.renderCrosshairs(Q?t:p,g)}}},e.prototype.hideTooltip=function(){var t=this.getTooltipCfg().follow;if(!t){this.point=null;return}var i=this.tooltipMarkersGroup;i&&i.hide();var o=this.xCrosshair,c=this.yCrosshair;o&&o.hide(),c&&c.hide();var p=this.tooltip;p&&p.hide(),this.view.emit("tooltip:hide",fo.fromData(this.view,"tooltip:hide",{})),this.point=null},e.prototype.lockTooltip=function(){this.isLocked=!0,this.tooltip&&this.tooltip.setCapture(!0)},e.prototype.unlockTooltip=function(){this.isLocked=!1;var t=this.getTooltipCfg();this.tooltip&&this.tooltip.setCapture(t.capture)},e.prototype.isTooltipLocked=function(){return this.isLocked},e.prototype.clear=function(){var t=this,i=t.tooltip,o=t.xCrosshair,c=t.yCrosshair,p=t.tooltipMarkersGroup;i&&(i.hide(),i.clear()),o&&o.clear(),c&&c.clear(),p&&p.clear(),i!=null&&i.get("customContent")&&(this.tooltip.destroy(),this.tooltip=null),this.title=null,this.items=null},e.prototype.destroy=function(){this.tooltip&&this.tooltip.destroy(),this.xCrosshair&&this.xCrosshair.destroy(),this.yCrosshair&&this.yCrosshair.destroy(),this.guideGroup&&this.guideGroup.remove(!0),this.reset()},e.prototype.reset=function(){this.items=null,this.title=null,this.tooltipMarkersGroup=null,this.tooltipCrosshairsGroup=null,this.xCrosshair=null,this.yCrosshair=null,this.tooltip=null,this.guideGroup=null,this.isLocked=!1,this.point=null},e.prototype.changeVisible=function(t){if(this.visible!==t){var i=this,o=i.tooltip,c=i.tooltipMarkersGroup,p=i.xCrosshair,g=i.yCrosshair;t?(o&&o.show(),c&&c.show(),p&&p.show(),g&&g.show()):(o&&o.hide(),c&&c.hide(),p&&p.hide(),g&&g.hide()),this.visible=t}},e.prototype.getTooltipItems=function(t){var i,o,c,p,g,_,S=this.findItemsFromView(this.view,t);if(S.length){S=(0,b.xH)(S);try{for(var I=(0,P.XA)(S),L=I.next();!L.done;L=I.next()){var F=L.value;try{for(var z=(c=void 0,(0,P.XA)(F)),V=z.next();!V.done;V=z.next()){var Q=V.value,st=Q.mappingData,at=st.x,Ft=st.y;Q.x=(0,b.kJ)(at)?at[at.length-1]:at,Q.y=(0,b.kJ)(Ft)?Ft[Ft.length-1]:Ft}}catch(Jr){c={error:Jr}}finally{try{V&&!V.done&&(p=z.return)&&p.call(z)}finally{if(c)throw c.error}}}}catch(Jr){i={error:Jr}}finally{try{L&&!L.done&&(o=I.return)&&o.call(I)}finally{if(i)throw i.error}}var Kt=this.getTooltipCfg().shared;if(Kt===!1&&S.length>1){var ee=S[0],Me=Math.abs(t.y-ee[0].y);try{for(var hr=(0,P.XA)(S),Tr=hr.next();!Tr.done;Tr=hr.next()){var Dr=Tr.value,cn=Math.abs(t.y-Dr[0].y);cn<=Me&&(ee=Dr,Me=cn)}}catch(Jr){g={error:Jr}}finally{try{Tr&&!Tr.done&&(_=hr.return)&&_.call(hr)}finally{if(g)throw g.error}}S=[ee]}return Lt((0,b.xH)(S))}return[]},e.prototype.layout=function(){},e.prototype.update=function(){if(this.point&&this.showTooltip(this.point),this.tooltip){var t=this.view.getCanvas();this.tooltip.set("region",{start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}})}},e.prototype.isCursorEntered=function(t){if(this.tooltip){var i=this.tooltip.getContainer(),o=this.tooltip.get("capture");if(i&&o){var c=i.getBoundingClientRect(),p=c.x,g=c.y,_=c.width,S=c.height;return new Iu(p,g,_,S).isPointIn(t)}}return!1},e.prototype.getTooltipCfg=function(){var t=this.view,i=t.getOptions().tooltip,o=this.processCustomContent(i),c=t.getTheme(),p=(0,b.U2)(c,["components","tooltip"],{}),g=(0,b.U2)(o,"enterable",p.enterable);return(0,b.b$)({},p,o,{capture:!!(g||this.isLocked)})},e.prototype.processCustomContent=function(t){if((0,b.jn)(t)||!(0,b.U2)(t,"customContent"))return t;var i=t.customContent,o=function(c,p){var g=i(c,p)||"";return(0,b.HD)(g)?'<div class="g2-tooltip">'+g+"</div>":g};return(0,P.pi)((0,P.pi)({},t),{customContent:o})},e.prototype.getTitle=function(t){var i=t[0].title||t[0].name;return this.title=i,i},e.prototype.renderTooltip=function(){var t=this.view.getCanvas(),i={start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}},o=this.getTooltipCfg(),c=new kf((0,P.pi)((0,P.pi)({parent:t.get("el").parentNode,region:i},o),{visible:!1,crosshairs:null}));c.init(),this.tooltip=c},e.prototype.renderTooltipMarkers=function(t,i){var o,c,p=this.getTooltipMarkersGroup(),g=this.view.getRootView(),_=g.limitInPlot;try{for(var S=(0,P.XA)(t),I=S.next();!I.done;I=S.next()){var L=I.value,F=L.x,z=L.y;if(_||p!=null&&p.getClip()){var V=Yh(g.getCoordinate()),Q=V.type,st=V.attrs;p==null||p.setClip({type:Q,attrs:st})}else p==null||p.setClip(void 0);var at=this.view.getTheme(),Ft=(0,b.U2)(at,["components","tooltip","marker"],{}),Kt=(0,P.pi)((0,P.pi)({fill:L.color,symbol:"circle",shadowColor:L.color},(0,b.mf)(i)?(0,P.pi)((0,P.pi)({},Ft),i(L)):i),{x:F,y:z});p.addShape("marker",{attrs:Kt})}}catch(ee){o={error:ee}}finally{try{I&&!I.done&&(c=S.return)&&c.call(S)}finally{if(o)throw o.error}}},e.prototype.renderCrosshairs=function(t,i){var o=(0,b.U2)(i,["crosshairs","type"],"x");o==="x"?(this.yCrosshair&&this.yCrosshair.hide(),this.renderXCrosshairs(t,i)):o==="y"?(this.xCrosshair&&this.xCrosshair.hide(),this.renderYCrosshairs(t,i)):o==="xy"&&(this.renderXCrosshairs(t,i),this.renderYCrosshairs(t,i))},e.prototype.renderXCrosshairs=function(t,i){var o=this.getViewWithGeometry(this.view).getCoordinate(),c,p;if(o.isRect)o.isTransposed?(c={x:o.start.x,y:t.y},p={x:o.end.x,y:t.y}):(c={x:t.x,y:o.end.y},p={x:t.x,y:o.start.y});else{var g=lc(o,t),_=o.getCenter(),S=o.getRadius();p=cs(_.x,_.y,S,g),c=_}var I=(0,b.b$)({start:c,end:p,container:this.getTooltipCrosshairsGroup()},(0,b.U2)(i,"crosshairs",{}),this.getCrosshairsText("x",t,i));delete I.type;var L=this.xCrosshair;L?L.update(I):(L=new xs(I),L.init()),L.render(),L.show(),this.xCrosshair=L},e.prototype.renderYCrosshairs=function(t,i){var o=this.getViewWithGeometry(this.view).getCoordinate(),c,p;if(o.isRect){var g=void 0,_=void 0;o.isTransposed?(g={x:t.x,y:o.end.y},_={x:t.x,y:o.start.y}):(g={x:o.start.x,y:t.y},_={x:o.end.x,y:t.y}),c={start:g,end:_},p="Line"}else c={center:o.getCenter(),radius:ku(o,t),startAngle:o.startAngle,endAngle:o.endAngle},p="Circle";c=(0,b.b$)({container:this.getTooltipCrosshairsGroup()},c,(0,b.U2)(i,"crosshairs",{}),this.getCrosshairsText("y",t,i)),delete c.type;var S=this.yCrosshair;S?o.isRect&&S.get("type")==="circle"||!o.isRect&&S.get("type")==="line"?(S=new J[p](c),S.init()):S.update(c):(S=new J[p](c),S.init()),S.render(),S.show(),this.yCrosshair=S},e.prototype.getCrosshairsText=function(t,i,o){var c=(0,b.U2)(o,["crosshairs","text"]),p=(0,b.U2)(o,["crosshairs","follow"]),g=this.items;if(c){var _=this.getViewWithGeometry(this.view),S=g[0],I=_.getXScale(),L=_.getYScales()[0],F=void 0,z=void 0;if(p){var V=this.view.getCoordinate().invert(i);F=I.invert(V.x),z=L.invert(V.y)}else F=S.data[I.field],z=S.data[L.field];var Q=t==="x"?F:z;return(0,b.mf)(c)?c=c(t,Q,g,i):c.content=Q,{text:c}}},e.prototype.getGuideGroup=function(){if(!this.guideGroup){var t=this.view.foregroundGroup;this.guideGroup=t.addGroup({name:"tooltipGuide",capture:!1})}return this.guideGroup},e.prototype.getTooltipMarkersGroup=function(){var t=this.tooltipMarkersGroup;return t&&!t.destroyed?(t.clear(),t.show()):(t=this.getGuideGroup().addGroup({name:"tooltipMarkersGroup"}),t.toFront(),this.tooltipMarkersGroup=t),t},e.prototype.getTooltipCrosshairsGroup=function(){var t=this.tooltipCrosshairsGroup;return t||(t=this.getGuideGroup().addGroup({name:"tooltipCrosshairsGroup",capture:!1}),t.toBack(),this.tooltipCrosshairsGroup=t),t},e.prototype.findItemsFromView=function(t,i){var o,c;if(t.getOptions().tooltip===!1)return[];var p=this.getTooltipCfg(),g=u0(t,i,p);try{for(var _=(0,P.XA)(t.views),S=_.next();!S.done;S=_.next()){var I=S.value;g=g.concat(this.findItemsFromView(I,i))}}catch(L){o={error:L}}finally{try{S&&!S.done&&(c=_.return)&&c.call(_)}finally{if(o)throw o.error}}return g},e.prototype.getViewWithGeometry=function(t){var i=this;return t.geometries.length?t:(0,b.sE)(t.views,function(o){return i.getViewWithGeometry(o)})},e.prototype.getItemsAfterProcess=function(t){var i=this.getTooltipCfg().customItems,o=i||function(c){return c};return o(t)},e}(dt),Qt=Gt,me={};function Fe(r){return me[r.toLowerCase()]}function nr(r,e){me[r.toLowerCase()]=e}var ur={appear:{duration:450,easing:"easeQuadOut"},update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},Sr={interval:function(r){return{enter:{animation:r.isRect?r.isTransposed?"scale-in-x":"scale-in-y":"fade-in"},update:{animation:r.isPolar&&r.isTransposed?"sector-path-update":null},leave:{animation:"fade-out"}}},line:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},path:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},point:{appear:{animation:"zoom-in"},enter:{animation:"zoom-in"},leave:{animation:"zoom-out"}},area:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},polygon:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},schema:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},edge:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},label:{appear:{animation:"fade-in",delay:450},enter:{animation:"fade-in"},update:{animation:"position-update"},leave:{animation:"fade-out"}}},gr={line:function(){return{animation:"wave-in"}},area:function(){return{animation:"wave-in"}},path:function(){return{animation:"fade-in"}},interval:function(r){var e;return r.isRect?e=r.isTransposed?"grow-in-x":"grow-in-y":(e="grow-in-xy",r.isPolar&&r.isTransposed&&(e="wave-in")),{animation:e}},schema:function(r){var e;return r.isRect?e=r.isTransposed?"grow-in-x":"grow-in-y":e="grow-in-xy",{animation:e}},polygon:function(){return{animation:"fade-in",duration:500}},edge:function(){return{animation:"fade-in"}}};function Ur(r,e){return{delay:(0,b.mf)(r.delay)?r.delay(e):r.delay,easing:(0,b.mf)(r.easing)?r.easing(e):r.easing,duration:(0,b.mf)(r.duration)?r.duration(e):r.duration,callback:r.callback,repeat:r.repeat}}function tn(r,e,t){var i=Sr[r];return i&&((0,b.mf)(i)&&(i=i(e)),i=(0,b.b$)({},ur,i),t)?i[t]:i}function un(r,e,t){var i=(0,b.U2)(r.get("origin"),"data",ve),o=e.animation,c=Ur(e,i);if(o){var p=Fe(o);p&&p(r,c,t)}else r.animate(t.toAttrs,c)}function yn(r,e,t,i,o){if(gr[t]){var c=gr[t](i),p=Fe((0,b.U2)(c,"animation",""));if(p){var g=(0,P.pi)((0,P.pi)((0,P.pi)({},ur.appear),c),e);r.stopAnimate(),p(r,g,{coordinate:i,minYPoint:o,toAttrs:null})}}}var Fn="element-background",ii=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.labelShape=[],i.states=[];var o=t.shapeFactory,c=t.container,p=t.offscreenGroup,g=t.elementIndex,_=t.visible,S=_===void 0?!0:_;return i.shapeFactory=o,i.container=c,i.offscreenGroup=p,i.visible=S,i.elementIndex=g,i}return e.prototype.draw=function(t,i){i===void 0&&(i=!1),this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.drawShape(t,i),this.visible===!1&&this.changeVisible(!1)},e.prototype.update=function(t){var i=this,o=i.shapeFactory,c=i.shape;if(c){this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.setShapeInfo(c,t);var p=this.getOffscreenGroup(),g=o.drawShape(this.shapeType,t,p);g.cfg.data=this.data,g.cfg.origin=t,g.cfg.element=this,this.syncShapeStyle(c,g,this.getStates(),this.getAnimateCfg("update"))}},e.prototype.destroy=function(){var t=this,i=t.shapeFactory,o=t.shape;if(o){var c=this.getAnimateCfg("leave");c?un(o,c,{coordinate:i.coordinate,toAttrs:(0,P.pi)({},o.attr())}):o.remove(!0)}this.states=[],this.shapeFactory=void 0,this.container=void 0,this.shape=void 0,this.animate=void 0,this.geometry=void 0,this.labelShape=[],this.model=void 0,this.data=void 0,this.offscreenGroup=void 0,this.statesStyle=void 0,r.prototype.destroy.call(this)},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t),t?(this.shape&&this.shape.show(),this.labelShape&&this.labelShape.forEach(function(i){i.show()})):(this.shape&&this.shape.hide(),this.labelShape&&this.labelShape.forEach(function(i){i.hide()}))},e.prototype.setState=function(t,i){var o=this,c=o.states,p=o.shapeFactory,g=o.model,_=o.shape,S=o.shapeType,I=c.indexOf(t);if(i){if(I>-1)return;c.push(t),(t==="active"||t==="selected")&&(_==null||_.toFront())}else{if(I===-1)return;if(c.splice(I,1),t==="active"||t==="selected"){var L=this.geometry,F=L.sortZIndex,z=L.zIndexReversed,V=z?this.geometry.elements.length-this.elementIndex:this.elementIndex;F?_.setZIndex(V):_.set("zIndex",V)}}var Q=p.drawShape(S,g,this.getOffscreenGroup());c.length?this.syncShapeStyle(_,Q,c,null):this.syncShapeStyle(_,Q,["reset"],null),Q.remove(!0);var st={state:t,stateStatus:i,element:this,target:this.container};this.container.emit("statechange",st),ji(this.shape,"statechange",st)},e.prototype.clearStates=function(){var t=this,i=this.states;(0,b.S6)(i,function(o){t.setState(o,!1)}),this.states=[]},e.prototype.hasState=function(t){return this.states.includes(t)},e.prototype.getStates=function(){return this.states},e.prototype.getData=function(){return this.data},e.prototype.getModel=function(){return this.model},e.prototype.getBBox=function(){var t=this,i=t.shape,o=t.labelShape,c={x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};return i&&(c=i.getCanvasBBox()),o&&o.forEach(function(p){var g=p.getCanvasBBox();c.x=Math.min(g.x,c.x),c.y=Math.min(g.y,c.y),c.minX=Math.min(g.minX,c.minX),c.minY=Math.min(g.minY,c.minY),c.maxX=Math.max(g.maxX,c.maxX),c.maxY=Math.max(g.maxY,c.maxY)}),c.width=c.maxX-c.minX,c.height=c.maxY-c.minY,c},e.prototype.getStatesStyle=function(){if(!this.statesStyle){var t=this,i=t.shapeType,o=t.geometry,c=t.shapeFactory,p=o.stateOption,g=c.defaultShapeType,_=c.theme[i]||c.theme[g];this.statesStyle=(0,b.b$)({},_,p)}return this.statesStyle},e.prototype.getStateStyle=function(t,i){var o=this.getStatesStyle(),c=(0,b.U2)(o,[t,"style"],{}),p=c[i]||c;return(0,b.mf)(p)?p(this):p},e.prototype.getAnimateCfg=function(t){var i=this,o=this.animate;if(o){var c=o[t];return c&&(0,P.pi)((0,P.pi)({},c),{callback:function(){var p;(0,b.mf)(c.callback)&&c.callback(),(p=i.geometry)===null||p===void 0||p.emit(rt.AFTER_DRAW_ANIMATE)}})}return null},e.prototype.drawShape=function(t,i){var o;i===void 0&&(i=!1);var c=this,p=c.shapeFactory,g=c.container,_=c.shapeType;if(this.shape=p.drawShape(_,t,g),this.shape){this.setShapeInfo(this.shape,t);var S=this.shape.cfg.name;S?(0,b.HD)(S)&&(this.shape.cfg.name=["element",S]):this.shape.cfg.name=["element",this.shapeFactory.geometryType];var I=i?"enter":"appear",L=this.getAnimateCfg(I);L&&((o=this.geometry)===null||o===void 0||o.emit(rt.BEFORE_DRAW_ANIMATE),un(this.shape,L,{coordinate:p.coordinate,toAttrs:(0,P.pi)({},this.shape.attr())}))}},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.setShapeInfo=function(t,i){var o=this;if(t.cfg.origin=i,t.cfg.element=this,t.isGroup()){var c=t.get("children");c.forEach(function(p){o.setShapeInfo(p,i)})}},e.prototype.syncShapeStyle=function(t,i,o,c,p){var g=this,_;if(o===void 0&&(o=[]),p===void 0&&(p=0),!(!t||!i)){var S=t.get("clipShape"),I=i.get("clipShape");if(this.syncShapeStyle(S,I,o,c),t.isGroup())for(var L=t.get("children"),F=i.get("children"),z=0;z<L.length;z++)this.syncShapeStyle(L[z],F[z],o,c,p+z);else{if(!(0,b.xb)(o)&&!(0,b.Xy)(o,["reset"])){var V=t.get("name");(0,b.kJ)(V)&&(V=V[1]),(0,b.S6)(o,function(st){if(i.get("name")!==Fn){var at=g.getStateStyle(st,V||p);i.attr(at)}})}var Q=Y0(t,i);this.animate?c?((_=this.geometry)===null||_===void 0||_.emit(rt.BEFORE_DRAW_ANIMATE),un(t,c,{coordinate:this.shapeFactory.coordinate,toAttrs:Q,shapeModel:this.model})):(0,b.xb)(o)?t.attr(Q):(t.stopAnimate(),t.animate(Q,{duration:300})):t.attr(Q)}}},e.prototype.getShapeType=function(t){var i=(0,b.U2)(t,"shape");return(0,b.kJ)(i)?i[0]:i},e}(re),Si=ii,sa={},Zi={};function pa(r){return sa[r.toLowerCase()]}function Rn(r,e){sa[r.toLowerCase()]=e}function Fi(r){return Zi[r.toLowerCase()]}function aa(r,e){Zi[r.toLowerCase()]=e}var Ji={coordinate:null,defaultShapeType:null,theme:null,getShapePoints:function(r,e){var t=this.getShape(r);return t.getPoints?t.getPoints(e):this.getDefaultPoints(e)},getShape:function(r){var e=this[r]||this[this.defaultShapeType];return e.coordinate=this.coordinate,e},getDefaultPoints:function(){return[]},getDefaultStyle:function(r){return(0,b.U2)(r,[this.defaultShapeType,"default","style"],{})},getMarker:function(r,e){var t=this.getShape(r);if(!t.getMarker){var i=this.defaultShapeType;t=this.getShape(i)}var o=this.theme,c=(0,b.U2)(o,[r,"default"],{}),p=t.getMarker(e);return(0,b.b$)({},c,p)},drawShape:function(r,e,t){var i=this.getShape(r);return i.draw(e,t)}},ho={coordinate:null,parsePath:function(r){var e=this.coordinate,t=(0,xh.tr)(r);return e.isPolar?t=ci(e,t):t=Dn(e,t),t},parsePoint:function(r){var e=this.coordinate;return e.convert(r)},parsePoints:function(r){var e=this.coordinate;return r.map(function(t){return e.convert(t)})},draw:function(r,e){}},Ha={};function so(r,e){var t=(0,b.jC)(r),i=(0,P.pi)((0,P.pi)((0,P.pi)({},Ji),e),{geometryType:r});return Ha[t]=i,i}function _i(r,e,t){var i=(0,b.jC)(r),o=Ha[i],c=(0,P.pi)((0,P.pi)({},ho),t);return o[e]=c,c}function No(r){var e=(0,b.jC)(r);return Ha[e]}function Bs(r,e,t){var i,o;if(t===void 0&&(t={}),!e)return[r];var c=(0,b.Ms)(r,e),p=[];if(e.length===1&&t[e[0]]){var g=t[e[0]];try{for(var _=(0,P.XA)(g),S=_.next();!S.done;S=_.next()){var I=S.value,L=c["_".concat(I)];L&&p.push(L)}}catch(V){i={error:V}}finally{try{S&&!S.done&&(o=_.return)&&o.call(_)}finally{if(i)throw i.error}}}else for(var F in c)if(c.hasOwnProperty(F)){var z=c[F];p.push(z)}return p}function qs(r,e){return(0,b.G)(["color","shape","size","x","y","isInCircle","data","style","defaultStyle","points","mappingData"],function(t){return!(0,b.Xy)(r[t],e[t])})}function Cs(r){return(0,b.kJ)(r)?r:r.split("*")}function Ls(r,e){for(var t=[],i=[],o=[],c=new Map,p=0;p<e.length;p++){var g=e[p];r[g]?i.push(g):t.push(g),c.set(g,!0)}return Object.keys(r).forEach(function(_){c.has(_)||o.push(_)}),{added:t,updated:i,removed:o}}var uu=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="base",i.attributes={},i.elements=[],i.elementsMap={},i.animateOption=!0,i.attributeOption={},i.lastElementsMap={},i.generatePoints=!1,i.beforeMappingData=null,i.adjusts={},i.idFields=[],i.hasSorted=!1,i.isCoordinateChanged=!1;var o=t.container,c=t.labelsContainer,p=t.coordinate,g=t.data,_=t.sortable,S=_===void 0?!1:_,I=t.visible,L=I===void 0?!0:I,F=t.theme,z=t.scales,V=z===void 0?{}:z,Q=t.scaleDefs,st=Q===void 0?{}:Q,at=t.intervalPadding,Ft=t.dodgePadding,Kt=t.maxColumnWidth,ee=t.minColumnWidth,Me=t.columnWidthRatio,hr=t.roseWidthRatio,Tr=t.multiplePieWidthRatio,Dr=t.zIndexReversed,cn=t.sortZIndex,Jr=t.useDeferredLabel;return i.container=o,i.labelsContainer=c,i.coordinate=p,i.data=g,i.sortable=S,i.visible=L,i.userTheme=F,i.scales=V,i.scaleDefs=st,i.intervalPadding=at,i.dodgePadding=Ft,i.maxColumnWidth=Kt,i.minColumnWidth=ee,i.columnWidthRatio=Me,i.roseWidthRatio=hr,i.multiplePieWidthRatio=Tr,i.zIndexReversed=Dr,i.sortZIndex=cn,i.useDeferredLabel=Jr?typeof Jr=="number"?Jr:1/0:null,i}return e.prototype.position=function(t){var i=t;(0,b.PO)(t)||(i={fields:Cs(t)});var o=(0,b.U2)(i,"fields");return o.length===1&&(o.unshift("1"),(0,b.t8)(i,"fields",o)),(0,b.t8)(this.attributeOption,"position",i),this},e.prototype.color=function(t,i){return this.createAttrOption("color",t,i),this},e.prototype.shape=function(t,i){return this.createAttrOption("shape",t,i),this},e.prototype.size=function(t,i){return this.createAttrOption("size",t,i),this},e.prototype.adjust=function(t){var i=t;return((0,b.HD)(t)||(0,b.PO)(t))&&(i=[t]),(0,b.S6)(i,function(o,c){(0,b.Kn)(o)||(i[c]={type:o})}),this.adjustOption=i,this},e.prototype.style=function(t,i){if((0,b.HD)(t)){var o=Cs(t);this.styleOption={fields:o,callback:i}}else{var c=t,o=c.fields,p=c.callback,g=c.cfg;o||p||g?this.styleOption=t:this.styleOption={cfg:t}}return this},e.prototype.tooltip=function(t,i){if((0,b.HD)(t)){var o=Cs(t);this.tooltipOption={fields:o,callback:i}}else this.tooltipOption=t;return this},e.prototype.animate=function(t){return this.animateOption=t,this},e.prototype.label=function(t,i,o){if((0,b.HD)(t)){var c={},p=Cs(t);c.fields=p,(0,b.mf)(i)?c.callback=i:(0,b.PO)(i)&&(c.cfg=i),o&&(c.cfg=o),this.labelOption=c}else this.labelOption=t;return this},e.prototype.state=function(t){return this.stateOption=t,this},e.prototype.customInfo=function(t){return this.customOption=t,this},e.prototype.init=function(t){t===void 0&&(t={}),this.setCfg(t),this.initAttributes(),this.processData(this.data),this.adjustScale()},e.prototype.update=function(t){t===void 0&&(t={});var i=t.data,o=t.isDataChanged,c=t.isCoordinateChanged,p=this,g=p.attributeOption,_=p.lastAttributeOption;(0,b.Xy)(g,_)?i&&(o||!(0,b.Xy)(i,this.data))?(this.setCfg(t),this.initAttributes(),this.processData(i)):this.setCfg(t):this.init(t),this.adjustScale(),this.isCoordinateChanged=c},e.prototype.paint=function(t){var i=this;t===void 0&&(t=!1),this.animateOption&&(this.animateOption=(0,b.b$)({},tn(this.type,this.coordinate),this.animateOption)),this.defaultSize=void 0,this.elementsMap={},this.elements=[];var o=this.getOffscreenGroup();o.clear();var c=this.beforeMappingData,p=this.beforeMapping(c);this.dataArray=new Array(p.length);for(var g=0;g<p.length;g++){var _=p[g];this.dataArray[g]=this.mapping(_)}if(this.updateElements(this.dataArray,t),this.lastElementsMap=this.elementsMap,this.canDoGroupAnimation(t)){var S=this.container,I=this.type,L=this.coordinate,F=(0,b.U2)(this.animateOption,"appear"),z=this.getYScale(),V=L.convert({x:0,y:z.scale(this.getYMinValue())});yn(S,F,I,L,V)}if(this.labelOption){var Q=this.useDeferredLabel,st=function(){return i.renderLabels((0,b.xH)(i.dataArray),t)}.bind(this);if(typeof Q=="number"){var at=typeof Q=="number"&&Q!==1/0?Q:0;if(!window.requestIdleCallback)setTimeout(st,at);else{var Ft=at&&at!==1/0?{timeout:at}:void 0;window.requestIdleCallback(st,Ft)}}else st()}this.lastAttributeOption=(0,P.pi)({},this.attributeOption),this.visible===!1&&this.changeVisible(!1)},e.prototype.clear=function(){var t=this,i=t.container,o=t.geometryLabel,c=t.offscreenGroup;i&&i.clear(),o&&o.clear(),c&&c.clear(),this.scaleDefs=void 0,this.attributes={},this.scales={},this.elementsMap={},this.lastElementsMap={},this.elements=[],this.adjusts={},this.dataArray=null,this.beforeMappingData=null,this.lastAttributeOption=void 0,this.defaultSize=void 0,this.idFields=[],this.groupScales=void 0,this.hasSorted=!1,this.isCoordinateChanged=!1},e.prototype.destroy=function(){this.clear();var t=this.container;t.remove(!0),this.offscreenGroup&&(this.offscreenGroup.remove(!0),this.offscreenGroup=null),this.geometryLabel&&(this.geometryLabel.destroy(),this.geometryLabel=null),this.theme=void 0,this.shapeFactory=void 0,r.prototype.destroy.call(this)},e.prototype.getGroupScales=function(){return this.groupScales},e.prototype.getAttribute=function(t){return this.attributes[t]},e.prototype.getXScale=function(){return this.getAttribute("position").scales[0]},e.prototype.getYScale=function(){return this.getAttribute("position").scales[1]},e.prototype.getGroupAttributes=function(){var t=[];return(0,b.S6)(this.attributes,function(i){_e.includes(i.type)&&t.push(i)}),t},e.prototype.getDefaultValue=function(t){var i,o=this.getAttribute(t);return o&&(0,b.xb)(o.scales)&&(i=o.values[0]),i},e.prototype.getAttributeValues=function(t,i){for(var o=[],c=t.scales,p=0,g=c.length;p<g;p++){var _=c[p],S=_.field;_.isIdentity?o.push(_.values):o.push(i[S])}return t.mapping.apply(t,(0,P.ev)([],(0,P.CR)(o),!1))},e.prototype.getAdjust=function(t){return this.adjusts[t]},e.prototype.getCoordinate=function(){return this.coordinate},e.prototype.getData=function(){return this.data},e.prototype.getShapeMarker=function(t,i){var o=this.getShapeFactory();return o.getMarker(t,i)},e.prototype.getElementsBy=function(t){return this.elements.filter(function(i){return t(i)})},e.prototype.getElements=function(){return this.elements},e.prototype.getElementId=function(t){t=(0,b.kJ)(t)?t[0]:t;var i=t[ve];if(this.idFields.length){for(var o=i[this.idFields[0]],c=1;c<this.idFields.length;c++)o+="-"+i[this.idFields[c]];return o}var p=this.type,g=this.getXScale(),_=this.getYScale(),S=g.field||"x",I=_.field||"y",L=i[I],F;g.type==="identity"?F=g.values[0]:F=i[S];var z;p==="interval"||p==="schema"?z="".concat(F):p==="line"||p==="area"||p==="path"?z=p:z="".concat(F,"-").concat(L);for(var V=this.groupScales,c=0,Q=V.length;c<Q;c++){var st=V[c],at=st.field;z="".concat(z,"-").concat(i[at])}var Ft=this.getAdjust("dodge");if(Ft){var Kt=Ft.dodgeBy;Kt&&(z="".concat(z,"-").concat(i[Kt]))}return this.getAdjust("jitter")&&(z="".concat(z,"-").concat(t.x,"-").concat(t.y)),z},e.prototype.getScaleFields=function(){var t=[],i=new Map,o=this,c=o.attributeOption,p=o.labelOption,g=o.tooltipOption;for(var _ in c)if(c.hasOwnProperty(_)){var S=c[_];S.fields?bc(S.fields,t,i):S.values&&bc(S.values,t,i)}return p&&p.fields&&bc(p.fields,t,i),(0,b.Kn)(g)&&g.fields&&bc(g.fields,t,i),t},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t);for(var i=this.elements,o=0,c=i.length;o<c;o++){var p=i[o];p.changeVisible(t)}t?(this.container&&this.container.show(),this.labelsContainer&&this.labelsContainer.show()):(this.container&&this.container.hide(),this.labelsContainer&&this.labelsContainer.hide())},e.prototype.getFields=function(){var t=new Map,i=[];return Object.values(this.attributeOption).forEach(function(o){var c=(o==null?void 0:o.fields)||[];c.forEach(function(p){t.has(p)||i.push(p),t.set(p,!0)})},[]),i},e.prototype.getGroupFields=function(){for(var t=[],i=new Map,o=0,c=_e.length;o<c;o++){var p=_e[o],g=this.attributeOption[p];g&&g.fields&&bc(g.fields,t,i)}return t},e.prototype.getXYFields=function(){var t=(0,P.CR)(this.attributeOption.position.fields,2),i=t[0],o=t[1];return[i,o]},e.prototype.getXField=function(){return(0,b.U2)(this.getXYFields(),[0])},e.prototype.getYField=function(){return(0,b.U2)(this.getXYFields(),[1])},e.prototype.getShapes=function(){return this.elements.map(function(t){return t.shape})},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.sort=function(t){if(!this.hasSorted)for(var i=this.getXScale(),o=i.field,c=0;c<t.length;c++){var p=t[c];p.sort(function(g,_){return i.translate(g[ve][o])-i.translate(_[ve][o])})}this.hasSorted=!0},e.prototype.adjustScale=function(){var t=this.getYScale();t&&this.getAdjust("stack")&&this.updateStackRange(t,this.beforeMappingData)},e.prototype.getShapeFactory=function(){var t=this.shapeType;if(No(t))return this.shapeFactory||(this.shapeFactory=(0,b.d9)(No(t))),this.shapeFactory.coordinate=this.coordinate,this.shapeFactory.theme=this.theme.geometries[t]||{},this.shapeFactory},e.prototype.createShapePointsCfg=function(t){var i=this.getXScale(),o=this.getYScale(),c=this.normalizeValues(t[i.field],i),p;return o?p=this.normalizeValues(t[o.field],o):p=t.y?t.y:.1,{x:c,y:p,y0:o?o.scale(this.getYMinValue()):void 0}},e.prototype.createElement=function(t,i,o){o===void 0&&(o=!1);var c=this.container,p=this.getDrawCfg(t),g=this.getShapeFactory(),_=new Si({shapeFactory:g,container:c,offscreenGroup:this.getOffscreenGroup(),elementIndex:i});return _.animate=this.animateOption,_.geometry=this,_.draw(p,o),_},e.prototype.getDrawCfg=function(t){var i=t[ve],o={mappingData:t,data:i,x:t.x,y:t.y,color:t.color,size:t.size,isInCircle:this.coordinate.isPolar,customInfo:this.customOption},c=t.shape;!c&&this.getShapeFactory()&&(c=this.getShapeFactory().defaultShapeType),o.shape=c;var p=this.theme.geometries[this.shapeType];o.defaultStyle=(0,b.U2)(p,[c,"default"],{}).style,!o.defaultStyle&&this.getShapeFactory()&&(o.defaultStyle=this.getShapeFactory().getDefaultStyle(p));var g=this.styleOption;return g&&(o.style=this.getStyleCfg(g,i)),this.generatePoints&&(o.points=t.points,o.nextPoints=t.nextPoints),o},e.prototype.updateElements=function(t,i){var o,c,p,g,_,S;i===void 0&&(i=!1);for(var I=new Map,L=[],F=new Map,z=0,V=0;V<t.length;V++)for(var Q=t[V],st=0;st<Q.length;st++){var at=Q[st],Ft=this.getElementId(at),Kt=I.has(Ft)?"".concat(Ft,"-").concat(V,"-").concat(st):Ft;L.push(Kt),I.set(Kt,at),F.set(Kt,z),z++}this.elements=new Array(z);var ee=Ls(this.lastElementsMap,L),Me=ee.added,hr=ee.updated,Tr=ee.removed;try{for(var Dr=(0,P.XA)(Me),cn=Dr.next();!cn.done;cn=Dr.next()){var Ft=cn.value,at=I.get(Ft),V=F.get(Ft),Jr=this.createElement(at,V,i);this.elements[V]=Jr,this.elementsMap[Ft]=Jr,Jr.shape&&Jr.shape.set("zIndex",this.zIndexReversed?this.elements.length-V:V)}}catch(Vi){o={error:Vi}}finally{try{cn&&!cn.done&&(c=Dr.return)&&c.call(Dr)}finally{if(o)throw o.error}}try{for(var Mn=(0,P.XA)(hr),mi=Mn.next();!mi.done;mi=Mn.next()){var Ft=mi.value,Jr=this.lastElementsMap[Ft],at=I.get(Ft),da=this.getDrawCfg(at),Sa=Jr.getModel(),V=F.get(Ft);(this.isCoordinateChanged||qs(da,Sa))&&(Jr.animate=this.animateOption,Jr.update(da)),this.elements[V]=Jr,this.elementsMap[Ft]=Jr,Jr.shape&&Jr.shape.set("zIndex",this.zIndexReversed?this.elements.length-V:V)}}catch(Vi){p={error:Vi}}finally{try{mi&&!mi.done&&(g=Mn.return)&&g.call(Mn)}finally{if(p)throw p.error}}this.container&&this.container.sort();try{for(var eo=(0,P.XA)(Tr),Gn=eo.next();!Gn.done;Gn=eo.next()){var Ft=Gn.value,Jr=this.lastElementsMap[Ft];Jr.animate=this.animateOption,Jr.destroy()}}catch(Vi){_={error:Vi}}finally{try{Gn&&!Gn.done&&(S=eo.return)&&S.call(eo)}finally{if(_)throw _.error}}},e.prototype.getLabelType=function(){var t=this,i=t.labelOption,o=t.coordinate,c=t.type,p=o.type,g=o.isTransposed,_=(0,b.U2)(i,["cfg","type"]);return _||(p==="polar"?_=g?"pie":"polar":p==="theta"?_="pie":c==="interval"||c==="polygon"?_="interval":_="base"),_},e.prototype.getYMinValue=function(){var t=this.getYScale(),i=t.min,o=t.max,c;return i>=0?c=i:o<=0?c=o:c=0,c},e.prototype.createAttrOption=function(t,i,o){if((0,b.UM)(i)||(0,b.Kn)(i))(0,b.Kn)(i)&&(0,b.Xy)(Object.keys(i),["values"])?(0,b.t8)(this.attributeOption,t,{fields:i.values}):(0,b.t8)(this.attributeOption,t,i);else{var c={};(0,b.hj)(i)?c.values=[i]:c.fields=Cs(i),o&&((0,b.mf)(o)?c.callback=o:c.values=o),(0,b.t8)(this.attributeOption,t,c)}},e.prototype.initAttributes=function(){var t=this,i=this,o=i.attributes,c=i.attributeOption,p=i.theme,g=i.shapeType;this.groupScales=[];var _={},S=function(F){if(c.hasOwnProperty(F)){var z=c[F];if(!z)return{value:void 0};var V=(0,P.pi)({},z),Q=V.callback,st=V.values,at=V.fields,Ft=at===void 0?[]:at,Kt=Ft.map(function(Me){var hr=t.scales[Me];if(!_[Me]&&_e.includes(F)){var Tr=ko(hr,(0,b.U2)(t.scaleDefs,Me),F,t.type);Tr==="cat"&&(t.groupScales.push(hr),_[Me]=!0)}return hr});V.scales=Kt,F!=="position"&&Kt.length===1&&Kt[0].type==="identity"?V.values=Kt[0].values:!Q&&!st&&(F==="size"?V.values=p.sizes:F==="shape"?V.values=p.shapes[g]||[]:F==="color"&&(Kt.length?V.values=Kt[0].values.length<=10?p.colors10:p.colors20:V.values=p.colors10));var ee=jf(F);o[F]=new ee(V)}};for(var I in c){var L=S(I);if(typeof L=="object")return L.value}},e.prototype.processData=function(t){var i,o;this.hasSorted=!1;for(var c=this.getAttribute("position").scales,p=c.filter(function(Tr){return Tr.isCategory}),g=this.groupData(t),_=[],S=0,I=g.length;S<I;S++){for(var L=g[S],F=[],z=0,V=L.length;z<V;z++){var Q=L[z],st={};for(var at in Q)st[at]=Q[at];st[ve]=Q;try{for(var Ft=(i=void 0,(0,P.XA)(p)),Kt=Ft.next();!Kt.done;Kt=Ft.next()){var ee=Kt.value,Me=ee.field;st[Me]=ee.translate(st[Me])}}catch(Tr){i={error:Tr}}finally{try{Kt&&!Kt.done&&(o=Ft.return)&&o.call(Ft)}finally{if(i)throw i.error}}F.push(st)}_.push(F)}var hr=this.adjustData(_);return this.beforeMappingData=hr,hr},e.prototype.adjustData=function(t){var i=this.adjustOption,o=this,c=o.intervalPadding,p=o.dodgePadding,g=o.theme,_=this.maxColumnWidth||g.maxColumnWidth,S=this.minColumnWidth||g.minColumnWidth,I=this.columnWidthRatio||g.columnWidthRatio,L=t;if(i){var F=this.getXScale(),z=this.getYScale(),V=F.field,Q=z?z.field:null,st=xd(this.coordinate),at=F.values.length,Ft=this.getAttribute("size"),Kt=void 0;Ft&&(Kt=Ft.values[0]);for(var ee=0,Me=i.length;ee<Me;ee++){var hr=i[ee],Tr=(0,P.pi)({xField:V,yField:Q,intervalPadding:c,dodgePadding:p,xDimensionLength:st,groupNum:at,defaultSize:Kt,maxColumnWidth:_,minColumnWidth:S,columnWidthRatio:I},hr),Dr=hr.type;if(Dr==="dodge"){var cn=[];if(F.isCategory||F.type==="identity")cn.push("x");else if(!z)cn.push("y");else throw new Error("dodge is not support linear attribute, please use category attribute!");Tr.adjustNames=cn,Tr.dodgeRatio=I}else if(Dr==="stack"){var Jr=this.coordinate;if(!z){Tr.height=Jr.getHeight();var Mn=this.getDefaultValue("size")||3;Tr.size=Mn}!Jr.isTransposed&&(0,b.UM)(Tr.reverseOrder)&&(Tr.reverseOrder=!0)}var mi=$t(Dr);Tr.dimValuesMap={},F&&F.values&&(Tr.dimValuesMap[F.field]=F.values.map(function(Sa){return F.translate(Sa)}));var da=new mi(Tr);L=da.process(L),this.adjusts[Dr]=da}}return L},e.prototype.groupData=function(t){for(var i=this.getGroupScales(),o=this.scaleDefs,c={},p=[],g=0;g<i.length;g++){var _=i[g],S=_.field;p.push(S),(0,b.U2)(o,[S,"values"])&&(c[S]=o[S].values)}return Bs(t,p,c)},e.prototype.updateStackRange=function(t,i){for(var o=(0,b.xH)(i),c=t.field,p=t.min,g=t.max,_=0;_<o.length;_++){var S=o[_],I=Math.min.apply(null,S[c]),L=Math.max.apply(null,S[c]);I<p&&(p=I),L>g&&(g=L)}var F=this.scaleDefs,z={};p<t.min&&!(0,b.U2)(F,[c,"min"])&&(z.min=p),g>t.max&&!(0,b.U2)(F,[c,"max"])&&(z.max=g),t.change(z)},e.prototype.beforeMapping=function(t){var i=t;if(this.sortable&&this.sort(i),this.generatePoints)for(var o=0,c=i.length;o<c;o++){var p=i[o];this.generateShapePoints(p);var g=i[o+1];g&&(this.generateShapePoints(g),p[0].nextPoints=g[0].points)}return i},e.prototype.generateShapePoints=function(t){for(var i=this.getShapeFactory(),o=this.getAttribute("shape"),c=0;c<t.length;c++){var p=t[c],g=this.createShapePointsCfg(p),_=o?this.getAttributeValues(o,p):null,S=i.getShapePoints(_,g);p.points=S}},e.prototype.normalizeValues=function(t,i){var o=[];if((0,b.kJ)(t))for(var c=0;c<t.length;c++){var p=t[c];o.push(i.scale(p))}else o=i.scale(t);return o},e.prototype.mapping=function(t){for(var i=this.attributes,o=[],c=0;c<t.length;c++){var p=t[c],g={_origin:p[ve],points:p.points,nextPoints:p.nextPoints};for(var _ in i)if(i.hasOwnProperty(_)){var S=i[_],I=S.names,L=this.getAttributeValues(S,p);if(I.length>1)for(var F=0;F<L.length;F+=1){var z=L[F],V=I[F];g[V]=(0,b.kJ)(z)&&z.length===1?z[0]:z}else g[I[0]]=L.length===1?L[0]:L}this.convertPoint(g),o.push(g)}return o},e.prototype.convertPoint=function(t){var i=t.x,o=t.y,c,p,g,_=this.coordinate;if((0,b.kJ)(i)&&(0,b.kJ)(o)){c=[],p=[];for(var S=0,I=0,L=i.length,F=o.length;S<L&&I<F;S+=1,I+=1)g=_.convert({x:i[S],y:o[I]}),c.push(g.x),p.push(g.y)}else if((0,b.kJ)(o)){p=[];for(var z=0;z<o.length;z++){var V=o[z];g=_.convert({x:i,y:V}),c&&c!==g.x?((0,b.kJ)(c)||(c=[c]),c.push(g.x)):c=g.x,p.push(g.y)}}else if((0,b.kJ)(i)){c=[];for(var z=0;z<i.length;z++){var Q=i[z];g=_.convert({x:Q,y:o}),p&&p!==g.y?((0,b.kJ)(p)||(p=[p]),p.push(g.y)):p=g.y,c.push(g.x)}}else{var st=_.convert({x:i,y:o});c=st.x,p=st.y}t.x=c,t.y=p},e.prototype.getStyleCfg=function(t,i){var o=t.fields,c=o===void 0?[]:o,p=t.callback,g=t.cfg;if(g)return g;var _=c.map(function(S){return i[S]});return p.apply(void 0,(0,P.ev)([],(0,P.CR)(_),!1))},e.prototype.setCfg=function(t){var i=this,o=t.coordinate,c=t.data,p=t.theme,g=t.scaleDefs;o&&(this.coordinate=o),c&&(this.data=c),g&&(this.scaleDefs=g,this.idFields=[],(0,b.S6)(g,function(_,S){_&&_.key&&i.idFields.push(S)})),p&&(this.theme=this.userTheme?(0,b.b$)({},p,this.userTheme):p)},e.prototype.renderLabels=function(t,i){return i===void 0&&(i=!1),(0,P.mG)(this,void 0,void 0,function(){var o,c,p,g,_,S,I,L,F,z,V,Q,st=this;return(0,P.Jh)(this,function(at){switch(at.label){case 0:return o=this.geometryLabel,this.emit(rt.BEFORE_RENDER_LABEL),o||(c=this.getLabelType(),p=pa(c),o=new p(this),this.geometryLabel=o),[4,o.render(t,i)];case 1:at.sent(),g=o.labelsRenderer.shapesMap,_=new Map,(0,b.S6)(g,function(Ft,Kt){for(var ee=Ft.getChildren()||[],Me=0;Me<ee.length;Me++){var hr=ee[Me],Tr=st.elementsMap[hr.get("elementId")||Kt.split(" ")[0]];if(Tr){hr.cfg.name=["element","label"],hr.cfg.element=Tr;var Dr=_.get(Tr)||new Set;Dr.add(Ft),_.set(Tr,Dr)}}});try{for(S=(0,P.XA)(_.entries()),I=S.next();!I.done;I=S.next())L=(0,P.CR)(I.value,2),F=L[0],z=L[1],F.labelShape=(0,P.ev)([],(0,P.CR)(z),!1)}catch(Ft){V={error:Ft}}finally{try{I&&!I.done&&(Q=S.return)&&Q.call(S)}finally{if(V)throw V.error}}return this.emit(rt.AFTER_RENDER_LABEL),[2]}})})},e.prototype.canDoGroupAnimation=function(t){return!t&&this.animateOption&&((0,b.U2)(this.animateOption,"appear")===void 0||(0,b.U2)(this.animateOption,"appear")&&(0,b.U2)(this.animateOption,["appear","animation"])===void 0)},e}(re),Ns=uu,vu=ro.vs;function Hu(r,e,t){var i=vu(r.getMatrix(),[["t",e,t]]);r.setMatrix(i)}function cl(r,e){var t=r.attr(),i=t.x,o=t.y,c=vu(r.getMatrix(),[["t",-i,-o],["r",e],["t",i,o]]);return c}function ml(r,e){var t=cl(r,e);r.setMatrix(t)}function Fu(){return[1,0,0,0,1,0,0,0,1]}function fl(r,e){var t=r.getBBox(),i=(t.minX+t.maxX)/2,o=(t.minY+t.maxY)/2;r.applyToMatrix([i,o,1]);var c=vu(r.getMatrix(),[["t",-i,-o],["s",e,e],["t",i,o]]);r.setMatrix(c)}function qa(r){return r.find(function(e){return e.get("type")==="text"})}function hs(r,e,t){t===void 0&&(t=[0,0,0,0]);var i=r&&r.getChildren()[0];if(i){var o=i.clone();e!=null&&e.rotate&&ml(o,-e.rotate);var c=o.getCanvasBBox(),p=c.x,g=c.y,_=c.width,S=c.height;o.destroy();var I=t;return(0,b.UM)(I)?I=[2,2,2,2]:(0,b.hj)(I)&&(I=new Array(4).fill(I)),{x:p-I[3],y:g-I[0],width:_+I[1]+I[3],height:S+I[0]+I[2],rotation:(e==null?void 0:e.rotate)||0}}return{x:0,y:0,width:0,height:0,rotation:0}}function as(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),o=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*o}function Po(r,e){var t=r.getBBox();return(0,b.G)(e,function(i){var o=i.getBBox();return as(t,o,2)>0})}function Yl(r,e,t){var i=t.data,o=t.origin,c=t.animateCfg,p=t.coordinate,g=(0,b.U2)(c,"update");r.set("data",i),r.set("origin",o),r.set("animateCfg",c),r.set("coordinate",p),r.set("visible",e.get("visible")),(r.getChildren()||[]).forEach(function(_,S){var I=e.getChildByIndex(S);if(!I)r.removeChild(_),_.remove(!0);else{_.set("data",i),_.set("origin",o),_.set("animateCfg",c),_.set("coordinate",p);var L=Y0(_,I);g?un(_,g,{toAttrs:L,coordinate:p}):_.attr(L),I.isGroup()&&Yl(_,I,t)}}),(0,b.S6)(e.getChildren(),function(_,S){S>=r.getCount()&&(_.destroyed||r.add(_))})}var Pl=function(){function r(e){this.shapesMap={};var t=e.layout,i=e.container;this.layout=t,this.container=i}return r.prototype.render=function(e,t,i){return i===void 0&&(i=!1),(0,P.mG)(this,void 0,void 0,function(){var o,c,p,g,_,S,I,L,F=this;return(0,P.Jh)(this,function(z){switch(z.label){case 0:if(o={},c=this.createOffscreenGroup(),!e.length)return[3,2];try{for(p=(0,P.XA)(e),g=p.next();!g.done;g=p.next())_=g.value,_&&(o[_.id]=this.renderLabel(_,c))}catch(V){I={error:V}}finally{try{g&&!g.done&&(L=p.return)&&L.call(p)}finally{if(I)throw I.error}}return[4,this.doLayout(e,t,o)];case 1:z.sent(),this.renderLabelLine(e,o),this.renderLabelBackground(e,o),this.adjustLabel(e,o),z.label=2;case 2:return S=this.shapesMap,(0,b.S6)(o,function(V,Q){if(V.destroyed)delete o[Q];else{if(S[Q]){var st=V.get("data"),at=V.get("origin"),Ft=V.get("coordinate"),Kt=V.get("animateCfg"),ee=S[Q];Yl(ee,o[Q],{data:st,origin:at,animateCfg:Kt,coordinate:Ft}),o[Q]=ee}else{if(F.container.destroyed)return;F.container.add(V);var Me=(0,b.U2)(V.get("animateCfg"),i?"enter":"appear");Me&&un(V,Me,{toAttrs:(0,P.pi)({},V.attr()),coordinate:V.get("coordinate")})}delete S[Q]}}),(0,b.S6)(S,function(V){var Q=(0,b.U2)(V.get("animateCfg"),"leave");Q?un(V,Q,{toAttrs:null,coordinate:V.get("coordinate")}):V.remove(!0)}),this.shapesMap=o,c.destroy(),[2]}})})},r.prototype.clear=function(){this.container.clear(),this.shapesMap={}},r.prototype.destroy=function(){this.container.destroy(),this.shapesMap=null},r.prototype.renderLabel=function(e,t){var i=e.id,o=e.elementId,c=e.data,p=e.mappingData,g=e.coordinate,_=e.animate,S=e.content,I=e.capture,L={id:i,elementId:o,capture:I,data:c,origin:(0,P.pi)((0,P.pi)({},p),{data:p[ve]}),coordinate:g},F=t.addGroup((0,P.pi)({name:"label",animateCfg:this.animate===!1||_===null||_===!1?!1:(0,b.b$)({},this.animate,_)},L)),z;if(S.isGroup&&S.isGroup()||S.isShape&&S.isShape()){var V=S.getCanvasBBox(),Q=V.width,st=V.height,at=(0,b.U2)(e,"textAlign","left"),Ft=e.x,Kt=e.y-st/2;at==="center"?Ft=Ft-Q/2:(at==="right"||at==="end")&&(Ft=Ft-Q),Hu(S,Ft,Kt),z=S,F.add(S)}else{var ee=(0,b.U2)(e,["style","fill"]);z=F.addShape("text",(0,P.pi)({attrs:(0,P.pi)((0,P.pi)({x:e.x,y:e.y,textAlign:e.textAlign,textBaseline:(0,b.U2)(e,"textBaseline","middle"),text:e.content},e.style),{fill:(0,b.Ft)(ee)?e.color:ee})},L))}return e.rotate&&ml(z,e.rotate),F},r.prototype.doLayout=function(e,t,i){return(0,P.mG)(this,void 0,void 0,function(){var o,c=this;return(0,P.Jh)(this,function(p){switch(p.label){case 0:return this.layout?(o=(0,b.kJ)(this.layout)?this.layout:[this.layout],[4,Promise.all(o.map(function(g){var _=Fi((0,b.U2)(g,"type",""));if(_){var S=[],I=[];return(0,b.S6)(i,function(L,F){S.push(L),I.push(t[L.get("elementId")])}),_(e,S,I,c.region,g.cfg)}}))]):[3,2];case 1:p.sent(),p.label=2;case 2:return[2]}})})},r.prototype.renderLabelLine=function(e,t){(0,b.S6)(e,function(i){var o=(0,b.U2)(i,"coordinate");if(!(!i||!o)){var c=o.getCenter(),p=o.getRadius();if(i.labelLine){var g=(0,b.U2)(i,"labelLine",{}),_=i.id,S=g.path;if(!S){var I=cs(c.x,c.y,p,i.angle);S=[["M",I.x,I.y],["L",i.x,i.y]]}var L=t[_];L.destroyed||L.addShape("path",{capture:!1,attrs:(0,P.pi)({path:S,stroke:i.color?i.color:(0,b.U2)(i,["style","fill"],"#000"),fill:null},g.style),id:_,origin:i.mappingData,data:i.data,coordinate:i.coordinate})}}})},r.prototype.renderLabelBackground=function(e,t){(0,b.S6)(e,function(i){var o=(0,b.U2)(i,"coordinate"),c=(0,b.U2)(i,"background");if(!(!c||!o)){var p=i.id,g=t[p];if(!g.destroyed){var _=g.getChildren()[0];if(_){var S=hs(g,i,c.padding),I=S.rotation,L=(0,P._T)(S,["rotation"]),F=g.addShape("rect",{attrs:(0,P.pi)((0,P.pi)({},L),c.style||{}),id:p,origin:i.mappingData,data:i.data,coordinate:i.coordinate});if(F.setZIndex(-1),I){var z=_.getMatrix();F.setMatrix(z)}}}}})},r.prototype.createOffscreenGroup=function(){var e=this.container,t=e.getGroupBase(),i=new t({});return i},r.prototype.adjustLabel=function(e,t){(0,b.S6)(e,function(i){if(i){var o=i.id,c=t[o];if(!c.destroyed){var p=c.findAll(function(g){return g.get("type")!=="path"});(0,b.S6)(p,function(g){g&&(i.offsetX&&g.attr("x",g.attr("x")+i.offsetX),i.offsetY&&g.attr("y",g.attr("y")+i.offsetY))})}}})},r}(),Ps=Pl;function gu(r){var e=0;return(0,b.S6)(r,function(t){e+=t}),e/r.length}var tl=function(){function r(e){this.geometry=e}return r.prototype.getLabelItems=function(e){var t=this,i=[],o=this.getLabelCfgs(e);return(0,b.S6)(e,function(c,p){var g=o[p];if(!g||(0,b.UM)(c.x)||(0,b.UM)(c.y)){i.push(null);return}var _=(0,b.kJ)(g.content)?g.content:[g.content];g.content=_;var S=_.length;(0,b.S6)(_,function(I,L){if((0,b.UM)(I)||I===""){i.push(null);return}var F=(0,P.pi)((0,P.pi)({},g),t.getLabelPoint(g,c,L));F.textAlign||(F.textAlign=t.getLabelAlign(F,L,S)),F.offset<=0&&(F.labelLine=null),i.push(F)})}),i},r.prototype.render=function(e,t){return t===void 0&&(t=!1),(0,P.mG)(this,void 0,void 0,function(){var i,o,c;return(0,P.Jh)(this,function(p){switch(p.label){case 0:return i=this.getLabelItems(e),o=this.getLabelsRenderer(),c=this.getGeometryShapes(),[4,o.render(i,c,t)];case 1:return p.sent(),[2]}})})},r.prototype.clear=function(){var e=this.labelsRenderer;e&&e.clear()},r.prototype.destroy=function(){var e=this.labelsRenderer;e&&e.destroy(),this.labelsRenderer=null},r.prototype.getCoordinate=function(){return this.geometry.coordinate},r.prototype.getDefaultLabelCfg=function(e,t){var i=this.geometry,o=i.type,c=i.theme;return o==="polygon"||o==="interval"&&t==="middle"||e<0&&!["line","point","path"].includes(o)?(0,b.U2)(c,"innerLabels",{}):(0,b.U2)(c,"labels",{})},r.prototype.getThemedLabelCfg=function(e){var t=this.geometry,i=this.getDefaultLabelCfg(),o=t.type,c=t.theme,p;return o==="polygon"||e.offset<0&&!["line","point","path"].includes(o)?p=(0,b.b$)({},i,c.innerLabels,e):p=(0,b.b$)({},i,c.labels,e),p},r.prototype.setLabelPosition=function(e,t,i,o){},r.prototype.getLabelOffset=function(e){var t=this.getCoordinate(),i=this.getOffsetVector(e);return t.isTransposed?i[0]:i[1]},r.prototype.getLabelOffsetPoint=function(e,t,i){var o=e.offset,c=this.getCoordinate(),p=c.isTransposed,g=p?"x":"y",_=p?1:-1,S={x:0,y:0};return t>0||i===1?S[g]=o*_:S[g]=o*_*-1,S},r.prototype.getLabelPoint=function(e,t,i){var o=this.getCoordinate(),c=e.content.length;function p(st,at,Ft){Ft===void 0&&(Ft=!1);var Kt=st;return(0,b.kJ)(Kt)&&(e.content.length===1?Ft?Kt=gu(Kt):Kt.length<=2?Kt=Kt[st.length-1]:Kt=gu(Kt):Kt=Kt[at]),Kt}var g={content:e.content[i],x:0,y:0,start:{x:0,y:0},color:"#fff"},_=(0,b.kJ)(t.shape)?t.shape[0]:t.shape,S=_==="funnel"||_==="pyramid";if(this.geometry.type==="polygon"){var I=X0(t.x,t.y);g.x=I[0],g.y=I[1]}else this.geometry.type==="interval"&&!S?(g.x=p(t.x,i,!0),g.y=p(t.y,i)):(g.x=p(t.x,i),g.y=p(t.y,i));if(S){var L=(0,b.U2)(t,"nextPoints"),F=(0,b.U2)(t,"points");if(L){var z=o.convert(F[1]),V=o.convert(L[1]);g.x=(z.x+V.x)/2,g.y=(z.y+V.y)/2}else if(_==="pyramid"){var z=o.convert(F[1]),V=o.convert(F[2]);g.x=(z.x+V.x)/2,g.y=(z.y+V.y)/2}}e.position&&this.setLabelPosition(g,t,i,e.position);var Q=this.getLabelOffsetPoint(e,i,c);return g.start={x:g.x,y:g.y},g.x+=Q.x,g.y+=Q.y,g.color=t.color,g},r.prototype.getLabelAlign=function(e,t,i){var o="center",c=this.getCoordinate();if(c.isTransposed){var p=e.offset;p<0?o="right":p===0?o="center":o="left",i>1&&t===0&&(o==="right"?o="left":o==="left"&&(o="right"))}return o},r.prototype.getLabelId=function(e){var t=this.geometry,i=t.type,o=t.getXScale(),c=t.getYScale(),p=e[ve],g=t.getElementId(e);return i==="line"||i==="area"?g+=" ".concat(p[o.field]):i==="path"&&(g+=" ".concat(p[o.field],"-").concat(p[c.field])),g},r.prototype.getLabelsRenderer=function(){var e=this.geometry,t=e.labelsContainer,i=e.labelOption,o=e.canvasRegion,c=e.animateOption,p=this.geometry.coordinate,g=this.labelsRenderer;return g||(g=new Ps({container:t,layout:(0,b.U2)(i,["cfg","layout"],{type:this.defaultLayout})}),this.labelsRenderer=g),g.region=o,g.animate=c?tn("label",p):!1,g},r.prototype.getLabelCfgs=function(e){var t=this,i=this.geometry,o=i.labelOption,c=i.scales,p=i.coordinate,g=o,_=g.fields,S=g.callback,I=g.cfg,L=_.map(function(z){return c[z]}),F=[];return(0,b.S6)(e,function(z,V){var Q=z[ve],st=t.getLabelText(Q,L),at;if(S){var Ft=_.map(function(Tr){return Q[Tr]});if(at=S.apply(void 0,(0,P.ev)([],(0,P.CR)(Ft),!1)),(0,b.UM)(at)){F.push(null);return}}var Kt=(0,P.pi)((0,P.pi)({id:t.getLabelId(z),elementId:t.geometry.getElementId(z),data:Q,mappingData:z,coordinate:p},I),at);(0,b.mf)(Kt.position)&&(Kt.position=Kt.position(Q,z,V));var ee=t.getLabelOffset(Kt.offset||0),Me=t.getDefaultLabelCfg(ee,Kt.position);Kt=(0,b.b$)({},Me,Kt),Kt.offset=t.getLabelOffset(Kt.offset||0);var hr=Kt.content;(0,b.mf)(hr)?Kt.content=hr(Q,z,V):(0,b.o8)(hr)&&(Kt.content=st[0]),F.push(Kt)}),F},r.prototype.getLabelText=function(e,t){var i=[];return(0,b.S6)(t,function(o){var c=e[o.field];(0,b.kJ)(c)?c=c.map(function(p){return o.getText(p)}):c=o.getText(c),(0,b.UM)(c)||c===""?i.push(null):i.push(c)}),i},r.prototype.getOffsetVector=function(e){e===void 0&&(e=0);var t=this.getCoordinate(),i=0;return(0,b.hj)(e)&&(i=e),t.isTransposed?t.applyMatrix(i,0):t.applyMatrix(0,i)},r.prototype.getGeometryShapes=function(){var e=this.geometry,t={};return(0,b.S6)(e.elementsMap,function(i,o){t[o]=i.shape}),(0,b.S6)(e.getOffscreenGroup().getChildren(),function(i){var o=e.getElementId(i.get("origin").mappingData);t[o]=i}),t},r}(),To=tl;function oh(r,e,t){if(!r)return t;var i;if(r.callback&&r.callback.length>1){var o=Array(r.callback.length-1).fill("");i=r.mapping.apply(r,(0,P.ev)([e],(0,P.CR)(o),!1)).join("")}else i=r.mapping(e).join("");return i||t}var yl={hexagon:function(r,e,t){var i=t/2*Math.sqrt(3);return[["M",r,e-t],["L",r+i,e-t/2],["L",r+i,e+t/2],["L",r,e+t],["L",r-i,e+t/2],["L",r-i,e-t/2],["Z"]]},bowtie:function(r,e,t){var i=t-1.5;return[["M",r-t,e-i],["L",r+t,e+i],["L",r+t,e-i],["L",r-t,e+i],["Z"]]},cross:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e+t],["M",r+t,e-t],["L",r-t,e+t]]},tick:function(r,e,t){return[["M",r-t/2,e-t],["L",r+t/2,e-t],["M",r,e-t],["L",r,e+t],["M",r-t/2,e+t],["L",r+t/2,e+t]]},plus:function(r,e,t){return[["M",r-t,e],["L",r+t,e],["M",r,e-t],["L",r,e+t]]},hyphen:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},line:function(r,e,t){return[["M",r,e-t],["L",r,e+t]]}},Kh=["line","cross","tick","plus","hyphen"];function mu(r,e){return(0,b.mf)(e)?e(r):(0,b.b$)({},r,e)}function Qh(r,e){var t=r.symbol;if((0,b.HD)(t)&&Kh.indexOf(t)!==-1){var i=(0,b.U2)(r,"style",{}),o=(0,b.U2)(i,"lineWidth",1),c=i.stroke||i.fill||e;r.style=(0,b.b$)({},r.style,{lineWidth:o,stroke:c,fill:null})}}function Ff(r){var e=r.symbol;(0,b.HD)(e)&&yl[e]&&(r.symbol=yl[e])}function Ed(r){return r.startsWith(le.LEFT)||r.startsWith(le.RIGHT)?"vertical":"horizontal"}function wd(r,e,t,i,o){var c=t.getScale(t.type);if(c.isCategory){var p=c.field,g=e.getAttribute("color"),_=e.getAttribute("shape"),S=r.getTheme().defaultColor,I=e.coordinate.isPolar;return c.getTicks().map(function(L,F){var z,V=L.text,Q=L.value,st=V,at=c.invert(Q),Ft=r.filterFieldData(p,[(z={},z[p]=at,z)]).length===0;(0,b.S6)(r.views,function(Tr){var Dr;Tr.filterFieldData(p,[(Dr={},Dr[p]=at,Dr)]).length||(Ft=!0)});var Kt=oh(g,at,S),ee=oh(_,at,"point"),Me=e.getShapeMarker(ee,{color:Kt,isInPolar:I}),hr=o;return(0,b.mf)(hr)&&(hr=hr(st,F,(0,P.pi)({name:st,value:at},(0,b.b$)({},i,Me)))),Me=(0,b.b$)({},i,Me,Mu((0,P.pi)({},hr),["style"])),Qh(Me,Kt),hr&&hr.style&&(Me.style=mu(Me.style,hr.style)),Ff(Me),{id:at,name:st,value:at,marker:Me,unchecked:Ft}})}return[]}function c0(r,e,t){return t.map(function(i,o){var c=e;(0,b.mf)(c)&&(c=c(i.name,o,(0,b.b$)({},r,i)));var p=(0,b.mf)(i.marker)?i.marker(i.name,o,(0,b.b$)({},r,i)):i.marker,g=(0,b.b$)({},r,c,p);return Ff(g),i.marker=g,i})}function Jh(r,e){var t=(0,b.U2)(r,["components","legend"],{});return(0,b.b$)({},(0,b.U2)(t,["common"],{}),(0,b.b$)({},(0,b.U2)(t,[e],{})))}function Sd(r){return r?!1:r==null||isNaN(r)}function q0(r){if((0,b.kJ)(r))return Sd(r[1].y);var e=r.y;return(0,b.kJ)(e)?Sd(e[0]):Sd(e)}function sh(r,e,t){if(e===void 0&&(e=!1),t===void 0&&(t=!0),!r.length||r.length===1&&!t)return[];if(e){for(var i=[],o=0,c=r.length;o<c;o++){var p=r[o];q0(p)||i.push(p)}return[i]}for(var g=[],_=[],o=0,c=r.length;o<c;o++){var p=r[o];q0(p)?_.length&&(_.length===1&&!t||g.push(_),_=[]):_.push(p)}return _.length&&g.push(_),g}function gv(r){for(var e=[],t=0;t<r.length;t++){var i=r[t];if(i){var o=t===0?"M":"L";e.push([o,i.x,i.y])}}var c=r[0];return c&&(e.push(["L",c.x,c.y]),e.push(["z"])),e}function mv(r){for(var e=r.length/2,t=[],i=[],o=0;o<r.length;o++)o<e?t.push(r[o]):i.push(r[o]);var c=gi(t,!1),p=gi(i,!1);i.length&&c.push(["L",i[0].x,i[0].y]),p.shift();var g=c.concat(p);return t.length&&g.push(["L",t[0].x,t[0].y]),g.push(["z"]),g}function Gs(r,e,t,i){i===void 0&&(i="");var o=r.style,c=o===void 0?{}:o,p=r.defaultStyle,g=r.color,_=r.size,S=(0,P.pi)((0,P.pi)({},p),c);return g&&(e&&(c.stroke||(S.stroke=g)),t&&(c.fill||(S.fill=g))),i&&(0,b.UM)(c[i])&&!(0,b.UM)(_)&&(S[i]=_),S}function el(r){return(0,b.b$)({},{fill:"#CCD6EC",fillOpacity:.3},(0,b.U2)(r,["background","style"]))}function sf(r){var e=r.x,t=(0,b.kJ)(r.y)?r.y:[r.y];return t.map(function(i,o){return{x:(0,b.kJ)(e)?e[o]:e,y:i}})}var Cd={line:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},dot:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},dash:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},smooth:function(r,e,t){return[["M",r-t,e],["A",t/2,t/2,0,1,1,r,e],["A",t/2,t/2,0,1,0,r+t,e]]},hv:function(r,e,t){return[["M",r-t-1,e-2.5],["L",r,e-2.5],["L",r,e+2.5],["L",r+t+1,e+2.5]]},vh:function(r,e,t){return[["M",r-t-1,e+2.5],["L",r,e+2.5],["L",r,e-2.5],["L",r+t+1,e-2.5]]},hvh:function(r,e,t){return[["M",r-(t+1),e+2.5],["L",r-t/2,e+2.5],["L",r-t/2,e-2.5],["L",r+t/2,e-2.5],["L",r+t/2,e+2.5],["L",r+t+1,e+2.5]]},vhv:function(r,e){return[["M",r-5,e+2.5],["L",r-5,e],["L",r,e],["L",r,e-3],["L",r,e+3],["L",r+6.5,e+3]]}};function Mh(r,e){var t=r.color;return{symbol:Cd[e],style:{lineWidth:2,r:6,stroke:t}}}function Ad(r,e,t){for(var i=r.isStack,o=r.connectNulls,c=r.isInCircle,p=r.showSinglePoint,g=Gs(r,!0,!1,"lineWidth"),_=sh(r.points,o,p),S=[],I=0,L=_.length;I<L;I++){var F=_[I];S=S.concat(yv(F,c,i,e,t,g))}return g.path=S,g}function zp(r,e,t,i,o){if(r.length===1)return[["M",r[0].x,r[0].y-o.lineWidth/2],["L",r[0].x,r[0].y],["L",r[0].x,r[0].y+o.lineWidth/2]];var c;return t?(e&&r.length&&r.push({x:r[0].x,y:r[0].y}),c=gi(r,!1,i)):(c=jn(r,!1),e&&c.push(["Z"])),c}function f0(r,e,t,i,o,c){var p=[],g=[];(0,b.S6)(r,function(I){var L=sf(I);p.push(L[1]),g.push(L[0])});var _=zp(p,e,i,o,c),S=zp(g,e,i,o,c);return t?_:_.concat(S)}function yv(r,e,t,i,o,c){if(r.length){var p=r[0];return(0,b.kJ)(p.y)?f0(r,e,t,i,o,c):zp(r,e,i,o,c)}return[]}var K0=so("line",{defaultShapeType:"line"});(0,b.S6)(["line","dot","dash","smooth"],function(r){_i("line",r,{draw:function(e,t){var i=r==="smooth",o;if(i){var c=this.coordinate,p=c.start,g=c.end;o=[[p.x,g.y],[g.x,p.y]]}var _=Ad(e,i,o),S=t.addShape({type:"path",attrs:_,name:"line",capture:!i});return S},getMarker:function(e){return Mh(e,r)}})});var Ng=null,Up="4.2.9",os={getLegendItems:wd,translate:Hu,rotate:ml,zoom:fl,transform:vu,getAngle:wh,getSectorPath:sl,polarToCartesian:cs,getDelegationObject:hi,getTooltipItems:Xl,getMappingValue:oh,getPath:yv,getPathPoints:sh},uf={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Jo={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},$l=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],_v=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],Td=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],h0=function(r){r===void 0&&(r={});var e=r.paletteQualitative10,t=e===void 0?$l:e,i=r.paletteQualitative20,o=i===void 0?_v:i,c=r.brandColor,p=c===void 0?t[0]:c,g={backgroundColor:"#141414",brandColor:p,subColor:"rgba(255,255,255,0.05)",paletteQualitative10:t,paletteQualitative20:o,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:Td,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:Jo[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:Jo[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:uf[85],axisTickLineBorderColor:Jo[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:Jo[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:Jo[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:Jo[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:Jo[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:$l[0],legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:Jo[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendSpacing:16,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:Jo[45],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:Jo[45],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:Jo[65],legendPageNavigatorTextFontSize:12,sliderRailFillColor:Jo[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:Jo[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:uf[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:uf[25],annotationArcBorderColor:Jo[15],annotationArcBorder:1,annotationLineBorderColor:Jo[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:Jo[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:Jo[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:Jo[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"#1f1f1f",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 2px 4px rgba(0,0,0,.5)",tooltipContainerBorderRadius:3,tooltipTextFillColor:Jo[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:Jo[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:uf[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:Jo[65],overflowLabelFillColorDark:"#2c3542",overflowLabelFillColorLight:"#ffffff",overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:uf[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:Jo[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#fff",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(255,255,255,0.65)",scrollbarThumbFillColor:"rgba(0,0,0,0.35)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.45)",pointFillColor:$l[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:uf[100],pointBorderOpacity:1,pointActiveBorderColor:Jo[100],pointSelectedBorder:2,pointSelectedBorderColor:Jo[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:$l[0],hollowPointBorderOpacity:.95,hollowPointFillColor:uf[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:Jo[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:Jo[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:$l[0],lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:$l[0],areaFillOpacity:.25,areaActiveFillColor:$l[0],areaActiveFillOpacity:.5,areaSelectedFillColor:$l[0],areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:$l[0],hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:Jo[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:Jo[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:$l[0],intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:Jo[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:Jo[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:$l[0],hollowIntervalBorderOpacity:1,hollowIntervalFillColor:uf[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:Jo[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:Jo[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return(0,P.pi)((0,P.pi)({},g),r)},Md=h0();function p0(){return window?window.devicePixelRatio:1}function Id(r,e,t,i){var o=r-t,c=e-i;return Math.sqrt(o*o+c*c)}function tp(r,e,t,i,o,c){return o>=r&&o<=r+t&&c>=e&&c<=e+i}function xv(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function zg(r,e){return!r||!e?r||e:{minX:Math.min(r.minX,e.minX),minY:Math.min(r.minY,e.minY),maxX:Math.max(r.maxX,e.maxX),maxY:Math.max(r.maxY,e.maxY)}}function se(r,e){return r[0]===e[0]&&r[1]===e[1]}var Q0=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,yy=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,bv=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Hs=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function lf(r,e){var t=r.match(Hs);(0,b.S6)(t,function(i){var o=i.split(":");e.addColorStop(o[0],o[1])})}function _y(r,e,t){var i=Q0.exec(t),o=parseFloat(i[1])%360*(Math.PI/180),c=i[2],p=e.getBBox(),g,_;o>=0&&o<1/2*Math.PI?(g={x:p.minX,y:p.minY},_={x:p.maxX,y:p.maxY}):1/2*Math.PI<=o&&o<Math.PI?(g={x:p.maxX,y:p.minY},_={x:p.minX,y:p.maxY}):Math.PI<=o&&o<3/2*Math.PI?(g={x:p.maxX,y:p.maxY},_={x:p.minX,y:p.minY}):(g={x:p.minX,y:p.maxY},_={x:p.maxX,y:p.minY});var S=Math.tan(o),I=S*S,L=(_.x-g.x+S*(_.y-g.y))/(I+1)+g.x,F=S*(_.x-g.x+S*(_.y-g.y))/(I+1)+g.y,z=r.createLinearGradient(g.x,g.y,L,F);return lf(c,z),z}function ep(r,e,t){var i=yy.exec(t),o=parseFloat(i[1]),c=parseFloat(i[2]),p=parseFloat(i[3]),g=i[4];if(p===0){var _=g.match(Hs);return _[_.length-1].split(":")[1]}var S=e.getBBox(),I=S.maxX-S.minX,L=S.maxY-S.minY,F=Math.sqrt(I*I+L*L)/2,z=r.createRadialGradient(S.minX+I*o,S.minY+L*c,0,S.minX+I/2,S.minY+L/2,p*F);return lf(g,z),z}function rp(r,e,t){if(e.get("patternSource")&&e.get("patternSource")===t)return e.get("pattern");var i,o,c=bv.exec(t),p=c[1],g=c[2];function _(){i=r.createPattern(o,p),e.set("pattern",i),e.set("patternSource",t)}switch(p){case"a":p="repeat";break;case"x":p="repeat-x";break;case"y":p="repeat-y";break;case"n":p="no-repeat";break;default:p="no-repeat"}return o=new Image,g.match(/^data:/i)||(o.crossOrigin="Anonymous"),o.src=g,o.complete?_():(o.onload=_,o.src=o.src),i}function Ug(r,e,t){var i=e.getBBox();if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height))return t;if((0,b.HD)(t)){if(t[1]==="("||t[2]==="("){if(t[0]==="l")return _y(r,e,t);if(t[0]==="r")return ep(r,e,t);if(t[0]==="p")return rp(r,e,t)}return t}if(t instanceof CanvasPattern)return t}function d0(r){var e=0,t=0,i=0,o=0;return(0,b.kJ)(r)?r.length===1?e=t=i=o=r[0]:r.length===2?(e=i=r[0],t=o=r[1]):r.length===3?(e=r[0],t=o=r[1],i=r[2]):(e=r[0],t=r[1],i=r[2],o=r[3]):e=t=i=o=r,[e,t,i,o]}function Bc(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function kd(r,e){return Bc(r)*Bc(e)?(r[0]*e[0]+r[1]*e[1])/(Bc(r)*Bc(e)):1}function Ld(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(kd(r,e))}function Pd(r,e){var t=e[1],i=e[2],o=(0,b.wQ)((0,b.c$)(e[3]),Math.PI*2),c=e[4],p=e[5],g=r[0],_=r[1],S=e[6],I=e[7],L=Math.cos(o)*(g-S)/2+Math.sin(o)*(_-I)/2,F=-1*Math.sin(o)*(g-S)/2+Math.cos(o)*(_-I)/2,z=L*L/(t*t)+F*F/(i*i);z>1&&(t*=Math.sqrt(z),i*=Math.sqrt(z));var V=t*t*(F*F)+i*i*(L*L),Q=V?Math.sqrt((t*t*(i*i)-V)/V):1;c===p&&(Q*=-1),isNaN(Q)&&(Q=0);var st=i?Q*t*F/i:0,at=t?Q*-i*L/t:0,Ft=(g+S)/2+Math.cos(o)*st-Math.sin(o)*at,Kt=(_+I)/2+Math.sin(o)*st+Math.cos(o)*at,ee=[(L-st)/t,(F-at)/i],Me=[(-1*L-st)/t,(-1*F-at)/i],hr=Ld([1,0],ee),Tr=Ld(ee,Me);return kd(ee,Me)<=-1&&(Tr=Math.PI),kd(ee,Me)>=1&&(Tr=0),p===0&&Tr>0&&(Tr=Tr-2*Math.PI),p===1&&Tr<0&&(Tr=Tr+2*Math.PI),{cx:Ft,cy:Kt,rx:se(r,[S,I])?0:t,ry:se(r,[S,I])?0:i,startAngle:hr,endAngle:hr+Tr,xRotation:o,arcFlag:c,sweepFlag:p}}var Od=Math.sin,Fd=Math.cos,v0=Math.atan2,np=Math.PI;function J0(r,e,t,i,o,c,p){var g=e.stroke,_=e.lineWidth,S=t-o,I=i-c,L=v0(I,S),F=new Nd({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*Fd(np/6)+","+10*Od(np/6)+" L0,0 L"+10*Fd(np/6)+",-"+10*Od(np/6),stroke:g,lineWidth:_}});F.translate(o,c),F.rotateAtPoint(o,c,L),r.set(p?"startArrowShape":"endArrowShape",F)}function Ev(r,e,t,i,o,c,p){var g=e.startArrow,_=e.endArrow,S=e.stroke,I=e.lineWidth,L=p?g:_,F=L.d,z=L.fill,V=L.stroke,Q=L.lineWidth,st=(0,P._T)(L,["d","fill","stroke","lineWidth"]),at=t-o,Ft=i-c,Kt=v0(Ft,at);F&&(o=o-Fd(Kt)*F,c=c-Od(Kt)*F);var ee=new Nd({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:(0,P.pi)((0,P.pi)({},st),{stroke:V||S,lineWidth:Q||I,fill:z})});ee.translate(o,c),ee.rotateAtPoint(o,c,Kt),r.set(p?"startArrowShape":"endArrowShape",ee)}function ip(r,e,t,i,o){var c=v0(i-e,t-r);return{dx:Fd(c)*o,dy:Od(c)*o}}function g0(r,e,t,i,o,c){typeof e.startArrow=="object"?Ev(r,e,t,i,o,c,!0):e.startArrow?J0(r,e,t,i,o,c,!0):r.set("startArrowShape",null)}function tg(r,e,t,i,o,c){typeof e.endArrow=="object"?Ev(r,e,t,i,o,c,!1):e.endArrow?J0(r,e,t,i,o,c,!1):r.set("startArrowShape",null)}var wc={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function Ih(r,e){var t=e.attr();for(var i in t){var o=t[i],c=wc[i]?wc[i]:i;c==="matrix"&&o?r.transform(o[0],o[1],o[3],o[4],o[6],o[7]):c==="lineDash"&&r.setLineDash?(0,b.kJ)(o)&&r.setLineDash(o):(c==="strokeStyle"||c==="fillStyle"?o=Ug(r,e,o):c==="globalAlpha"&&(o=o*r.globalAlpha),r[c]=o)}}function eg(r,e,t){for(var i=0;i<e.length;i++){var o=e[i];o.cfg.visible?o.draw(r,t):o.skipDraw()}}function kh(r,e,t){var i=r.get("refreshElements");(0,b.S6)(i,function(o){if(o!==r)for(var c=o.cfg.parent;c&&c!==r&&!c.cfg.refresh;)c.cfg.refresh=!0,c=c.cfg.parent}),i[0]===r?ap(e,t):Zg(e,t)}function Zg(r,e){for(var t=0;t<r.length;t++){var i=r[t];if(i.cfg.visible)if(i.cfg.hasChanged)i.cfg.refresh=!0,i.isGroup()&&ap(i.cfg.children,e);else if(i.cfg.refresh)i.isGroup()&&Zg(i.cfg.children,e);else{var o=wv(i,e);i.cfg.refresh=o,o&&i.isGroup()&&Zg(i.cfg.children,e)}}}function ql(r){for(var e=0;e<r.length;e++){var t=r[e];t.cfg.hasChanged=!1,t.isGroup()&&!t.destroyed&&ql(t.cfg.children)}}function ap(r,e){for(var t=0;t<r.length;t++){var i=r[t];i.cfg.refresh=!0,i.isGroup()&&ap(i.get("children"),e)}}function wv(r,e){var t=r.cfg.cacheCanvasBBox,i=r.cfg.isInView&&t&&xv(t,e);return i}function Rd(r,e,t,i){var o=t.path,c=t.startArrow,p=t.endArrow;if(o){var g=[0,0],_=[0,0],S={dx:0,dy:0};e.beginPath();for(var I=0;I<o.length;I++){var L=o[I],F=L[0];if(I===0&&c&&c.d){var z=r.getStartTangent();S=ip(z[0][0],z[0][1],z[1][0],z[1][1],c.d)}else if(I===o.length-2&&o[I+1][0]==="Z"&&p&&p.d){var V=o[I+1];if(V[0]==="Z"){var z=r.getEndTangent();S=ip(z[0][0],z[0][1],z[1][0],z[1][1],p.d)}}else if(I===o.length-1&&p&&p.d&&o[0]!=="Z"){var z=r.getEndTangent();S=ip(z[0][0],z[0][1],z[1][0],z[1][1],p.d)}var Q=S.dx,st=S.dy;switch(F){case"M":e.moveTo(L[1]-Q,L[2]-st),_=[L[1],L[2]];break;case"L":e.lineTo(L[1]-Q,L[2]-st);break;case"Q":e.quadraticCurveTo(L[1],L[2],L[3]-Q,L[4]-st);break;case"C":e.bezierCurveTo(L[1],L[2],L[3],L[4],L[5]-Q,L[6]-st);break;case"A":{var at=void 0;i?(at=i[I],at||(at=Pd(g,L),i[I]=at)):at=Pd(g,L);var Ft=at.cx,Kt=at.cy,ee=at.rx,Me=at.ry,hr=at.startAngle,Tr=at.endAngle,Dr=at.xRotation,cn=at.sweepFlag;if(e.ellipse)e.ellipse(Ft,Kt,ee,Me,Dr,hr,Tr,1-cn);else{var Jr=ee>Me?ee:Me,Mn=ee>Me?1:ee/Me,mi=ee>Me?Me/ee:1;e.translate(Ft,Kt),e.rotate(Dr),e.scale(Mn,mi),e.arc(0,0,Jr,hr,Tr,1-cn),e.scale(1/Mn,1/mi),e.rotate(-Dr),e.translate(-Ft,-Kt)}break}case"Z":e.closePath();break;default:break}if(F==="Z")g=_;else{var da=L.length;g=[L[da-2],L[da-1]]}}}}function Dd(r,e){var t=r.get("canvas");t&&(e==="remove"&&(r._cacheCanvasBBox=r.get("cacheCanvasBBox")),r.get("hasChanged")||(r.set("hasChanged",!0),r.cfg.parent&&r.cfg.parent.get("hasChanged")||(t.refreshElement(r,e,t),t.get("autoDraw")&&t.draw())))}function Sv(r){var e;if(r.destroyed)e=r._cacheCanvasBBox;else{var t=r.get("cacheCanvasBBox"),i=t&&!!(t.width&&t.height),o=r.getCanvasBBox(),c=o&&!!(o.width&&o.height);i&&c?e=zg(t,o):i?e=t:c&&(e=o)}return e}function Cv(r){if(!r.length)return null;var e=[],t=[],i=[],o=[];return(0,b.S6)(r,function(c){var p=Sv(c);p&&(e.push(p.minX),t.push(p.minY),i.push(p.maxX),o.push(p.maxY))}),{minX:(0,b.VV)(e),minY:(0,b.VV)(t),maxX:(0,b.Fp)(i),maxY:(0,b.Fp)(o)}}function Vg(r,e){return!r||!e||!xv(r,e)?null:{minX:Math.max(r.minX,e.minX),minY:Math.max(r.minY,e.minY),maxX:Math.min(r.maxX,e.maxX),maxY:Math.min(r.maxY,e.maxY)}}var Gg=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.onCanvasChange=function(t){Dd(this,t)},e.prototype.getShapeBase=function(){return et},e.prototype.getGroupBase=function(){return e},e.prototype._applyClip=function(t,i){i&&(t.save(),Ih(t,i),i.createPath(t),t.restore(),t.clip(),i._afterDraw())},e.prototype.cacheCanvasBBox=function(){var t=this.cfg.children,i=[],o=[];(0,b.S6)(t,function(F){var z=F.cfg.cacheCanvasBBox;z&&F.cfg.isInView&&(i.push(z.minX,z.maxX),o.push(z.minY,z.maxY))});var c=null;if(i.length){var p=(0,b.VV)(i),g=(0,b.Fp)(i),_=(0,b.VV)(o),S=(0,b.Fp)(o);c={minX:p,minY:_,x:p,y:_,maxX:g,maxY:S,width:g-p,height:S-_};var I=this.cfg.canvas;if(I){var L=I.getViewRange();this.set("isInView",xv(c,L))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",c)},e.prototype.draw=function(t,i){var o=this.cfg.children,c=i?this.cfg.refresh:!0;o.length&&c&&(t.save(),Ih(t,this),this._applyClip(t,this.getClip()),eg(t,o,i),t.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},e}(ye.AbstractGroup),m0=Gg,y0=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.getShapeBase=function(){return et},e.prototype.getGroupBase=function(){return m0},e.prototype.onCanvasChange=function(t){Dd(this,t)},e.prototype.calculateBBox=function(){var t=this.get("type"),i=this.getHitLineWidth(),o=(0,ye.getBBoxMethod)(t),c=o(this),p=i/2,g=c.x-p,_=c.y-p,S=c.x+c.width+p,I=c.y+c.height+p;return{x:g,minX:g,y:_,minY:_,width:c.width+i,height:c.height+i,maxX:S,maxY:I}},e.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},e.prototype.isStroke=function(){return!!this.attrs.stroke},e.prototype._applyClip=function(t,i){i&&(t.save(),Ih(t,i),i.createPath(t),t.restore(),t.clip(),i._afterDraw())},e.prototype.draw=function(t,i){var o=this.cfg.clipShape;if(i){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var c=this.getCanvasBBox();if(!xv(i,c)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}t.save(),Ih(t,this),this._applyClip(t,o),this.drawPath(t),t.restore(),this._afterDraw()},e.prototype.getCanvasViewBox=function(){var t=this.cfg.canvas;return t?t.getViewRange():null},e.prototype.cacheCanvasBBox=function(){var t=this.getCanvasViewBox();if(t){var i=this.getCanvasBBox(),o=xv(i,t);this.set("isInView",o),o?this.set("cacheCanvasBBox",i):this.set("cacheCanvasBBox",null)}},e.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},e.prototype.drawPath=function(t){this.createPath(t),this.strokeAndFill(t),this.afterDrawPath(t)},e.prototype.fill=function(t){t.fill()},e.prototype.stroke=function(t){t.stroke()},e.prototype.strokeAndFill=function(t){var i=this.attrs,o=i.lineWidth,c=i.opacity,p=i.strokeOpacity,g=i.fillOpacity;this.isFill()&&(!(0,b.UM)(g)&&g!==1?(t.globalAlpha=g,this.fill(t),t.globalAlpha=c):this.fill(t)),this.isStroke()&&o>0&&(!(0,b.UM)(p)&&p!==1&&(t.globalAlpha=p),this.stroke(t)),this.afterDrawPath(t)},e.prototype.createPath=function(t){},e.prototype.afterDrawPath=function(t){},e.prototype.isInShape=function(t,i){var o=this.isStroke(),c=this.isFill(),p=this.getHitLineWidth();return this.isInStrokeOrPath(t,i,o,c,p)},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){return!1},e.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var t=this.attrs;return t.lineWidth+t.lineAppendWidth},e}(ye.AbstractShape),Nc=y0,op=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,r:0})},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){var g=this.attr(),_=g.x,S=g.y,I=g.r,L=p/2,F=Id(_,S,t,i);return c&&o?F<=I+L:c?F<=I:o?F>=I-L&&F<=I+L:!1},e.prototype.createPath=function(t){var i=this.attr(),o=i.x,c=i.y,p=i.r;t.beginPath(),t.arc(o,c,p,0,Math.PI*2,!1),t.closePath()},e}(Nc),xy=op;function Zp(r,e,t,i){return r/(t*t)+e/(i*i)}var _0=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){var g=this.attr(),_=p/2,S=g.x,I=g.y,L=g.rx,F=g.ry,z=(t-S)*(t-S),V=(i-I)*(i-I);return c&&o?Zp(z,V,L+_,F+_)<=1:c?Zp(z,V,L,F)<=1:o?Zp(z,V,L-_,F-_)>=1&&Zp(z,V,L+_,F+_)<=1:!1},e.prototype.createPath=function(t){var i=this.attr(),o=i.x,c=i.y,p=i.rx,g=i.ry;if(t.beginPath(),t.ellipse)t.ellipse(o,c,p,g,0,0,Math.PI*2,!1);else{var _=p>g?p:g,S=p>g?1:p/g,I=p>g?g/p:1;t.save(),t.translate(o,c),t.scale(S,I),t.arc(0,0,_,0,Math.PI*2),t.restore(),t.closePath()}},e}(Nc),rg=_0;function Bd(r){return r instanceof HTMLElement&&(0,b.HD)(r.nodeName)&&r.nodeName.toUpperCase()==="CANVAS"}var x0=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0})},e.prototype.initAttrs=function(t){this._setImage(t.img)},e.prototype.isStroke=function(){return!1},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var t=this.get("canvas");t?t.draw():this.createPath(this.get("context"))}},e.prototype._setImage=function(t){var i=this,o=this.attrs;if((0,b.HD)(t)){var c=new Image;c.onload=function(){if(i.destroyed)return!1;i.attr("img",c),i.set("loading",!1),i._afterLoading();var p=i.get("callback");p&&p.call(i)},c.crossOrigin="Anonymous",c.src=t,this.set("loading",!0)}else t instanceof Image?(o.width||(o.width=t.width),o.height||(o.height=t.height)):Bd(t)&&(o.width||(o.width=Number(t.getAttribute("width"))),o.height||(o.height,Number(t.getAttribute("height"))))},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),t==="img"&&this._setImage(i)},e.prototype.createPath=function(t){if(this.get("loading")){this.set("toDraw",!0),this.set("context",t);return}var i=this.attr(),o=i.x,c=i.y,p=i.width,g=i.height,_=i.sx,S=i.sy,I=i.swidth,L=i.sheight,F=i.img;(F instanceof Image||Bd(F))&&(!(0,b.UM)(_)&&!(0,b.UM)(S)&&!(0,b.UM)(I)&&!(0,b.UM)(L)?t.drawImage(F,_,S,I,L,o,c,p,g):t.drawImage(F,o,c,p,g))},e}(Nc),ng=x0,hl=nt(62930);function Rf(r,e,t,i,o,c,p){var g=Math.min(r,t),_=Math.max(r,t),S=Math.min(e,i),I=Math.max(e,i),L=o/2;return c>=g-L&&c<=_+L&&p>=S-L&&p<=I+L?hl.x1.pointToLine(r,e,t,i,c,p)<=o/2:!1}var sp=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),this.setArrow()},e.prototype.setArrow=function(){var t=this.attr(),i=t.x1,o=t.y1,c=t.x2,p=t.y2,g=t.startArrow,_=t.endArrow;g&&g0(this,t,c,p,i,o),_&&tg(this,t,i,o,c,p)},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){if(!o||!p)return!1;var g=this.attr(),_=g.x1,S=g.y1,I=g.x2,L=g.y2;return Rf(_,S,I,L,p,t,i)},e.prototype.createPath=function(t){var i=this.attr(),o=i.x1,c=i.y1,p=i.x2,g=i.y2,_=i.startArrow,S=i.endArrow,I={dx:0,dy:0},L={dx:0,dy:0};_&&_.d&&(I=ip(o,c,p,g,i.startArrow.d)),S&&S.d&&(L=ip(o,c,p,g,i.endArrow.d)),t.beginPath(),t.moveTo(o+I.dx,c+I.dy),t.lineTo(p-L.dx,g-L.dy)},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),o=this.get("endArrowShape");i&&i.draw(t),o&&o.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr(),i=t.x1,o=t.y1,c=t.x2,p=t.y2;return hl.x1.length(i,o,c,p)},e.prototype.getPoint=function(t){var i=this.attr(),o=i.x1,c=i.y1,p=i.x2,g=i.y2;return hl.x1.pointAt(o,c,p,g,t)},e}(Nc),Sc=sp,Av={circle:function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+i],["L",r,e-i],["L",r+t,e+i],["Z"]]},"triangle-down":function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-i],["L",r+t,e-i],["L",r,e+i],["Z"]]}},Hg=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initAttrs=function(t){this._resetParamsCache()},e.prototype._resetParamsCache=function(){this.set("paramsCache",{})},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),["symbol","x","y","r","radius"].indexOf(t)!==-1&&this._resetParamsCache()},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._getR=function(t){return(0,b.UM)(t.r)?t.radius:t.r},e.prototype._getPath=function(){var t=this.attr(),i=t.x,o=t.y,c=t.symbol||"circle",p=this._getR(t),g,_;if((0,b.mf)(c))g=c,_=g(i,o,p),_=(0,xh.wb)(_);else{if(g=e.Symbols[c],!g)return console.warn(c+" marker is not supported."),null;_=g(i,o,p)}return _},e.prototype.createPath=function(t){var i=this._getPath(),o=this.get("paramsCache");Rd(this,t,{path:i},o)},e.Symbols=Av,e}(Nc),up=Hg;function by(r,e,t){var i=(0,ye.getOffScreenContext)();return r.createPath(i),i.isPointInPath(e,t)}var v_=1e-6;function jg(r){return Math.abs(r)<v_?0:r<0?-1:1}function Ey(r,e,t){return(t[0]-r[0])*(e[1]-r[1])===(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function Wg(r,e,t){var i=!1,o=r.length;if(o<=2)return!1;for(var c=0;c<o;c++){var p=r[c],g=r[(c+1)%o];if(Ey(p,g,[e,t]))return!0;jg(p[1]-t)>0!=jg(g[1]-t)>0&&jg(e-(t-p[1])*(p[0]-g[0])/(p[1]-g[1])-p[0])<0&&(i=!i)}return i}function lp(r,e,t,i,o,c,p,g){var _=(Math.atan2(g-e,p-r)+Math.PI*2)%(Math.PI*2);if(_<i||_>o)return!1;var S={x:r+t*Math.cos(_),y:e+t*Math.sin(_)};return Id(S.x,S.y,p,g)<=c/2}var g_=ro.vs;function m_(r){for(var e=!1,t=r.length,i=0;i<t;i++){var o=r[i],c=o[0];if(c==="C"||c==="A"||c==="Q"){e=!0;break}}return e}function Lh(r,e,t,i,o){for(var c=!1,p=e/2,g=0;g<r.length;g++){var _=r[g],S=_.currentPoint,I=_.params,L=_.prePoint,F=_.box;if(!(F&&!tp(F.x-p,F.y-p,F.width+e,F.height+e,t,i))){switch(_.command){case"L":case"Z":c=Rf(L[0],L[1],S[0],S[1],e,t,i);break;case"Q":var z=hl.lD.pointDistance(L[0],L[1],I[1],I[2],I[3],I[4],t,i);c=z<=e/2;break;case"C":var V=hl.Ll.pointDistance(L[0],L[1],I[1],I[2],I[3],I[4],I[5],I[6],t,i,o);c=V<=e/2;break;case"A":var Q=_.arcParams,st=Q.cx,at=Q.cy,Ft=Q.rx,Kt=Q.ry,ee=Q.startAngle,Me=Q.endAngle,hr=Q.xRotation,Tr=[t,i,1],Dr=Ft>Kt?Ft:Kt,cn=Ft>Kt?1:Ft/Kt,Jr=Ft>Kt?Kt/Ft:1,Mn=g_(null,[["t",-st,-at],["r",-hr],["s",1/cn,1/Jr]]);Ja.transformMat3(Tr,Tr,Mn),c=lp(0,0,Dr,ee,Me,e,Tr[0],Tr[1]);break;default:break}if(c)break}}return c}function b0(r){for(var e=r.length,t=[],i=[],o=[],c=0;c<e;c++){var p=r[c],g=p[0];g==="M"?(o.length&&(i.push(o),o=[]),o.push([p[1],p[2]])):g==="Z"?o.length&&(t.push(o),o=[]):o.push([p[1],p[2]])}return o.length>0&&i.push(o),{polygons:t,polylines:i}}var E0=(0,P.pi)({hasArc:m_,extractPolygons:b0,isPointInStroke:Lh},ye.PathUtil);function Tv(r,e,t){for(var i=!1,o=0;o<r.length;o++){var c=r[o];if(i=Wg(c,e,t),i)break}return i}var wy=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this._setPathArr(t.path),this.setArrow()},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),t==="path"&&this._setPathArr(i),this.setArrow()},e.prototype._setPathArr=function(t){this.attrs.path=(0,xh.wb)(t);var i=E0.hasArc(t);this.set("hasArc",i),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},e.prototype.getSegments=function(){var t=this.get("segements");return t||(t=(0,xh.zx)(this.attr("path")),this.set("segments",t)),t},e.prototype.setArrow=function(){var t=this.attr(),i=t.startArrow,o=t.endArrow;if(i){var c=this.getStartTangent();g0(this,t,c[0][0],c[0][1],c[1][0],c[1][1])}if(o){var c=this.getEndTangent();tg(this,t,c[0][0],c[0][1],c[1][0],c[1][1])}},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){var g=this.getSegments(),_=this.get("hasArc"),S=!1;if(o){var I=this.getTotalLength();S=E0.isPointInStroke(g,p,t,i,I)}if(!S&&c)if(_)S=by(this,t,i);else{var L=this.attr("path"),F=E0.extractPolygons(L);S=Tv(F.polygons,t,i)||Tv(F.polylines,t,i)}return S},e.prototype.createPath=function(t){var i=this.attr(),o=this.get("paramsCache");Rd(this,t,i,o)},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),o=this.get("endArrowShape");i&&i.draw(t),o&&o.draw(t)},e.prototype.getTotalLength=function(){var t=this.get("totalLength");return(0,b.UM)(t)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):t},e.prototype.getPoint=function(t){var i=this.get("tCache");i||(this._calculateCurve(),this._setTcache(),i=this.get("tCache"));var o,c,p=this.get("curve");if(!i||i.length===0)return p?{x:p[0][1],y:p[0][2]}:null;(0,b.S6)(i,function(I,L){t>=I[0]&&t<=I[1]&&(o=(t-I[0])/(I[1]-I[0]),c=L)});var g=p[c];if((0,b.UM)(g)||(0,b.UM)(c))return null;var _=g.length,S=p[c+1];return hl.Ll.pointAt(g[_-2],g[_-1],S[1],S[2],S[3],S[4],S[5],S[6],o)},e.prototype._calculateCurve=function(){var t=this.attr().path;this.set("curve",E0.pathToCurve(t))},e.prototype._setTcache=function(){var t=0,i=0,o=[],c,p,g,_,S=this.get("curve");if(S){if((0,b.S6)(S,function(I,L){g=S[L+1],_=I.length,g&&(t+=hl.Ll.length(I[_-2],I[_-1],g[1],g[2],g[3],g[4],g[5],g[6])||0)}),this.set("totalLength",t),t===0){this.set("tCache",[]);return}(0,b.S6)(S,function(I,L){g=S[L+1],_=I.length,g&&(c=[],c[0]=i/t,p=hl.Ll.length(I[_-2],I[_-1],g[1],g[2],g[3],g[4],g[5],g[6]),i+=p||0,c[1]=i/t,o.push(c))}),this.set("tCache",o)}},e.prototype.getStartTangent=function(){var t=this.getSegments(),i;if(t.length>1){var o=t[0].currentPoint,c=t[1].currentPoint,p=t[1].startTangent;i=[],p?(i.push([o[0]-p[0],o[1]-p[1]]),i.push([o[0],o[1]])):(i.push([c[0],c[1]]),i.push([o[0],o[1]]))}return i},e.prototype.getEndTangent=function(){var t=this.getSegments(),i=t.length,o;if(i>1){var c=t[i-2].currentPoint,p=t[i-1].currentPoint,g=t[i-1].endTangent;o=[],g?(o.push([p[0]-g[0],p[1]-g[1]]),o.push([p[0],p[1]])):(o.push([c[0],c[1]]),o.push([p[0],p[1]]))}return o},e}(Nc),Nd=wy;function Sy(r,e,t,i,o){var c=r.length;if(c<2)return!1;for(var p=0;p<c-1;p++){var g=r[p][0],_=r[p][1],S=r[p+1][0],I=r[p+1][1];if(Rf(g,_,S,I,e,t,i))return!0}if(o){var L=r[0],F=r[c-1];if(Rf(L[0],L[1],F[0],F[1],e,t,i))return!0}return!1}var Cy=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isInStrokeOrPath=function(t,i,o,c,p){var g=this.attr().points,_=!1;return o&&(_=Sy(g,p,t,i,!0)),!_&&c&&(_=Wg(g,t,i)),_},e.prototype.createPath=function(t){var i=this.attr(),o=i.points;if(!(o.length<2)){t.beginPath();for(var c=0;c<o.length;c++){var p=o[c];c===0?t.moveTo(p[0],p[1]):t.lineTo(p[0],p[1])}t.closePath()}},e}(Nc),y_=Cy,Xg=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),this.setArrow(),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.setArrow=function(){var t=this.attr(),i=this.attrs,o=i.points,c=i.startArrow,p=i.endArrow,g=o.length,_=o[0][0],S=o[0][1],I=o[g-1][0],L=o[g-1][1];c&&g0(this,t,o[1][0],o[1][1],_,S),p&&tg(this,t,o[g-2][0],o[g-2][1],I,L)},e.prototype.isFill=function(){return!1},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){if(!o||!p)return!1;var g=this.attr().points;return Sy(g,p,t,i,!1)},e.prototype.isStroke=function(){return!0},e.prototype.createPath=function(t){var i=this.attr(),o=i.points,c=i.startArrow,p=i.endArrow,g=o.length;if(!(o.length<2)){var _=o[0][0],S=o[0][1],I=o[g-1][0],L=o[g-1][1];if(c&&c.d){var F=ip(_,S,o[1][0],o[1][1],c.d);_+=F.dx,S+=F.dy}if(p&&p.d){var F=ip(o[g-2][0],o[g-2][1],I,L,p.d);I-=F.dx,L-=F.dy}t.beginPath(),t.moveTo(_,S);for(var z=0;z<g-1;z++){var V=o[z];t.lineTo(V[0],V[1])}t.lineTo(I,L)}},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),o=this.get("endArrowShape");i&&i.draw(t),o&&o.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr().points,i=this.get("totalLength");return(0,b.UM)(i)?(this.set("totalLength",hl.aH.length(t)),this.get("totalLength")):i},e.prototype.getPoint=function(t){var i=this.attr().points,o=this.get("tCache");o||(this._setTcache(),o=this.get("tCache"));var c,p;return(0,b.S6)(o,function(g,_){t>=g[0]&&t<=g[1]&&(c=(t-g[0])/(g[1]-g[0]),p=_)}),hl.x1.pointAt(i[p][0],i[p][1],i[p+1][0],i[p+1][1],c)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var i=this.getTotalLength();if(!(i<=0)){var o=0,c=[],p,g;(0,b.S6)(t,function(_,S){t[S+1]&&(p=[],p[0]=o/i,g=hl.x1.length(_[0],_[1],t[S+1][0],t[S+1][1]),o+=g,p[1]=o/i,c.push(p))}),this.set("tCache",c)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,i=[];return i.push([t[1][0],t[1][1]]),i.push([t[0][0],t[0][1]]),i},e.prototype.getEndTangent=function(){var t=this.attr().points,i=t.length-1,o=[];return o.push([t[i-1][0],t[i-1][1]]),o.push([t[i][0],t[i][1]]),o},e}(Nc),__=Xg;function x_(r,e,t,i,o,c,p){var g=o/2;return tp(r-g,e-g,t,o,c,p)||tp(r+t-g,e-g,o,i,c,p)||tp(r+g,e+i-g,t,o,c,p)||tp(r-g,e+g,o,i,c,p)}function Yg(r,e,t,i,o,c,p,g){var _=c/2;return Rf(r+o,e,r+t-o,e,c,p,g)||Rf(r+t,e+o,r+t,e+i-o,c,p,g)||Rf(r+t-o,e+i,r+o,e+i,c,p,g)||Rf(r,e+i-o,r,e+o,c,p,g)||lp(r+t-o,e+o,o,1.5*Math.PI,2*Math.PI,c,p,g)||lp(r+t-o,e+i-o,o,0,.5*Math.PI,c,p,g)||lp(r+o,e+i-o,o,.5*Math.PI,Math.PI,c,p,g)||lp(r+o,e+o,o,Math.PI,1.5*Math.PI,c,p,g)}var b_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.isInStrokeOrPath=function(t,i,o,c,p){var g=this.attr(),_=g.x,S=g.y,I=g.width,L=g.height,F=g.radius;if(F){var V=!1;return o&&(V=Yg(_,S,I,L,F,p,t,i)),!V&&c&&(V=by(this,t,i)),V}else{var z=p/2;if(c&&o)return tp(_-z,S-z,I+z,L+z,t,i);if(c)return tp(_,S,I,L,t,i);if(o)return x_(_,S,I,L,p,t,i)}},e.prototype.createPath=function(t){var i=this.attr(),o=i.x,c=i.y,p=i.width,g=i.height,_=i.radius;if(t.beginPath(),_===0)t.rect(o,c,p,g);else{var S=d0(_),I=S[0],L=S[1],F=S[2],z=S[3];t.moveTo(o+I,c),t.lineTo(o+p-L,c),L!==0&&t.arc(o+p-L,c+L,L,-Math.PI/2,0),t.lineTo(o+p,c+g-F),F!==0&&t.arc(o+p-F,c+g-F,F,0,Math.PI/2),t.lineTo(o+z,c+g),z!==0&&t.arc(o+z,c+g-z,z,Math.PI/2,Math.PI),t.lineTo(o,c+I),I!==0&&t.arc(o+I,c+I,I,Math.PI,Math.PI*1.5),t.closePath()}},e}(Nc),$g=b_,Ay=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.isOnlyHitBox=function(){return!0},e.prototype.initAttrs=function(t){this._assembleFont(),t.text&&this._setText(t.text)},e.prototype._assembleFont=function(){var t=this.attrs;t.font=(0,ye.assembleFont)(t)},e.prototype._setText=function(t){var i=null;(0,b.HD)(t)&&t.indexOf(`
`)!==-1&&(i=t.split(`
`)),this.set("textArr",i)},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),t.startsWith("font")&&this._assembleFont(),t==="text"&&this._setText(i)},e.prototype._getSpaceingY=function(){var t=this.attrs,i=t.lineHeight,o=t.fontSize*1;return i?i-o:o*.14},e.prototype._drawTextArr=function(t,i,o){var c=this.attrs,p=c.textBaseline,g=c.x,_=c.y,S=c.fontSize*1,I=this._getSpaceingY(),L=(0,ye.getTextHeight)(c.text,c.fontSize,c.lineHeight),F;(0,b.S6)(i,function(z,V){F=_+V*(I+S)-L+S,p==="middle"&&(F+=L-S-(L-S)/2),p==="top"&&(F+=L-S),(0,b.UM)(z)||(o?t.fillText(z,g,F):t.strokeText(z,g,F))})},e.prototype._drawText=function(t,i){var o=this.attr(),c=o.x,p=o.y,g=this.get("textArr");if(g)this._drawTextArr(t,g,i);else{var _=o.text;(0,b.UM)(_)||(i?t.fillText(_,c,p):t.strokeText(_,c,p))}},e.prototype.strokeAndFill=function(t){var i=this.attrs,o=i.lineWidth,c=i.opacity,p=i.strokeOpacity,g=i.fillOpacity;this.isStroke()&&o>0&&(!(0,b.UM)(p)&&p!==1&&(t.globalAlpha=c),this.stroke(t)),this.isFill()&&(!(0,b.UM)(g)&&g!==1?(t.globalAlpha=g,this.fill(t),t.globalAlpha=c):this.fill(t)),this.afterDrawPath(t)},e.prototype.fill=function(t){this._drawText(t,!0)},e.prototype.stroke=function(t){this._drawText(t,!1)},e}(Nc),Vp=Ay;function E_(r,e){if(e){var t=(0,ye.invert)(e);return(0,ye.multiplyVec2)(t,r)}return r}function Ty(r,e,t){var i=r.getTotalMatrix();if(i){var o=E_([e,t,1],i),c=o[0],p=o[1];return[c,p]}return[e,t]}function _2(r,e,t){if(r.isCanvas&&r.isCanvas())return!0;if(!(0,ye.isAllowCapture)(r)||r.cfg.isInView===!1)return!1;if(r.cfg.clipShape){var i=Ty(r,e,t),o=i[0],c=i[1];if(r.isClipped(o,c))return!1}var p=r.cfg.cacheCanvasBBox||r.getCanvasBBox();return e>=p.minX&&e<=p.maxX&&t>=p.minY&&t<=p.maxY}function OT(r,e,t){if(!_2(r,e,t))return null;for(var i=null,o=r.getChildren(),c=o.length,p=c-1;p>=0;p--){var g=o[p];if(g.isGroup())i=OT(g,e,t);else if(_2(g,e,t)){var _=g,S=Ty(g,e,t),I=S[0],L=S[1];_.isInShape(I,L)&&(i=g)}if(i)break}return i}var w_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},e.prototype.onCanvasChange=function(t){(t==="attr"||t==="sort"||t==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},e.prototype.getShapeBase=function(){return et},e.prototype.getGroupBase=function(){return m0},e.prototype.getPixelRatio=function(){var t=this.get("pixelRatio")||p0();return t>=1?Math.ceil(t):1},e.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},e.prototype.createDom=function(){var t=document.createElement("canvas"),i=t.getContext("2d");return this.set("context",i),t},e.prototype.setDOMSize=function(t,i){r.prototype.setDOMSize.call(this,t,i);var o=this.get("context"),c=this.get("el"),p=this.getPixelRatio();c.width=p*t,c.height=p*i,p>1&&o.scale(p,p)},e.prototype.clear=function(){r.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),i=this.get("el");t.clearRect(0,0,i.width,i.height)},e.prototype.getShape=function(t,i){var o;return this.get("quickHit")?o=OT(this,t,i):o=r.prototype.getShape.call(this,t,i,null),o},e.prototype._getRefreshRegion=function(){var t=this.get("refreshElements"),i=this.getViewRange(),o;if(t.length&&t[0]===this)o=i;else if(o=Cv(t),o){o.minX=Math.floor(o.minX),o.minY=Math.floor(o.minY),o.maxX=Math.ceil(o.maxX),o.maxY=Math.ceil(o.maxY),o.maxY+=1;var c=this.get("clipView");c&&(o=Vg(o,i))}return o},e.prototype.refreshElement=function(t){var i=this.get("refreshElements");i.push(t)},e.prototype._clearFrame=function(){var t=this.get("drawFrame");t&&((0,b.VS)(t),this.set("drawFrame",null),this.set("refreshElements",[]))},e.prototype.draw=function(){var t=this.get("drawFrame");this.get("autoDraw")&&t||this._startDraw()},e.prototype._drawAll=function(){var t=this.get("context"),i=this.get("el"),o=this.getChildren();t.clearRect(0,0,i.width,i.height),Ih(t,this),eg(t,o),this.set("refreshElements",[])},e.prototype._drawRegion=function(){var t=this.get("context"),i=this.get("refreshElements"),o=this.getChildren(),c=this._getRefreshRegion();c?(t.clearRect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),t.save(),t.beginPath(),t.rect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),t.clip(),Ih(t,this),kh(this,o,c),eg(t,o,c),t.restore()):i.length&&ql(i),(0,b.S6)(i,function(p){p.get("hasChanged")&&p.set("hasChanged",!1)}),this.set("refreshElements",[])},e.prototype._startDraw=function(){var t=this,i=this.get("drawFrame");i||(i=(0,b.U7)(function(){t.get("localRefresh")?t._drawRegion():t._drawAll(),t.set("drawFrame",null)}),this.set("drawFrame",i))},e.prototype.skipDraw=function(){},e.prototype.removeDom=function(){var t=this.get("el");t.width=0,t.height=0,t.parentNode.removeChild(t)},e}(ye.AbstractCanvas),x2=w_,fO="0.5.12",My={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},is={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"},hO=null;function Ph(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function S_(r){var e=My[r.type],t=r.getParent();if(!e)throw new Error("the type "+r.type+" is not supported by svg");var i=Ph(e);if(r.get("id")&&(i.id=r.get("id")),r.set("el",i),r.set("attrs",{}),t){var o=t.get("el");o||(o=t.createDom(),t.set("el",o)),o.appendChild(i)}return i}function b2(r,e){var t=r.get("el"),i=(0,b.qo)(t.children).sort(e),o=document.createDocumentFragment();i.forEach(function(c){o.appendChild(c)}),t.appendChild(o)}function E2(r,e){var t=r.parentNode,i=Array.from(t.childNodes).filter(function(g){return g.nodeType===1&&g.nodeName.toLowerCase()!=="defs"}),o=i[e],c=i.indexOf(r);if(o){if(c>e)t.insertBefore(r,o);else if(c<e){var p=i[e+1];p?t.insertBefore(r,p):t.appendChild(r)}}else t.appendChild(r)}function w2(r,e){var t=r.cfg.el,i=r.attr(),o={dx:i.shadowOffsetX,dy:i.shadowOffsetY,blur:i.shadowBlur,color:i.shadowColor};if(!o.dx&&!o.dy&&!o.blur&&!o.color)t.removeAttribute("filter");else{var c=e.find("filter",o);c||(c=e.addShadow(o)),t.setAttribute("filter","url(#"+c+")")}}function ig(r){var e=r.attr().matrix;if(e){for(var t=r.cfg.el,i=[],o=0;o<9;o+=3)i.push(e[o]+","+e[o+1]);i=i.join(","),i.indexOf("NaN")===-1?t.setAttribute("transform","matrix("+i+")"):console.warn("invalid matrix:",e)}}function ag(r,e){var t=r.getClip(),i=r.get("el");if(!t)i.removeAttribute("clip-path");else if(t&&!i.hasAttribute("clip-path")){S_(t),t.createPath(e);var o=e.addClip(t);i.setAttribute("clip-path","url(#"+o+")")}}function C_(r,e){e.forEach(function(t){t.draw(r)})}function A_(r,e){var t=r.get("canvas");if(t&&t.get("autoDraw")){var i=t.get("context"),o=r.getParent(),c=o?o.getChildren():[t],p=r.get("el");if(e==="remove"){var g=r.get("isClipShape");if(g){var _=p&&p.parentNode,S=_&&_.parentNode;_&&S&&S.removeChild(_)}else p&&p.parentNode&&p.parentNode.removeChild(p)}else if(e==="show")p.setAttribute("visibility","visible");else if(e==="hide")p.setAttribute("visibility","hidden");else if(e==="zIndex")E2(p,c.indexOf(r));else if(e==="sort"){var I=r.get("children");I&&I.length&&b2(r,function(L,F){return I.indexOf(L)-I.indexOf(F)?1:0})}else e==="clear"?p&&(p.innerHTML=""):e==="matrix"?ig(r):e==="clip"?ag(r,i):e==="attr"||e==="add"&&r.draw(i)}}var S2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isEntityGroup=function(){return!0},e.prototype.createDom=function(){var t=Ph("g");this.set("el",t);var i=this.getParent();if(i){var o=i.get("el");o||(o=i.createDom(),i.set("el",o)),o.appendChild(t)}return t},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var i=this.get("canvas");if(i&&i.get("autoDraw")){var o=i.get("context");this.createPath(o,t)}},e.prototype.onCanvasChange=function(t){A_(this,t)},e.prototype.getShapeBase=function(){return ot},e.prototype.getGroupBase=function(){return e},e.prototype.draw=function(t){var i=this.getChildren(),o=this.get("el");this.get("destroyed")?o&&o.parentNode.removeChild(o):(o||this.createDom(),ag(this,t),this.createPath(t),i.length&&C_(t,i))},e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");(0,b.S6)(i||o,function(p,g){is[g]&&c.setAttribute(is[g],p)}),ig(this)},e}(ye.AbstractGroup),Iy=S2,C2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var i=this.get("canvas");if(i&&i.get("autoDraw")){var o=i.get("context");this.draw(o,t)}},e.prototype.getShapeBase=function(){return ot},e.prototype.getGroupBase=function(){return Iy},e.prototype.onCanvasChange=function(t){A_(this,t)},e.prototype.calculateBBox=function(){var t=this.get("el"),i=null;if(t)i=t.getBBox();else{var o=(0,ye.getBBoxMethod)(this.get("type"));o&&(i=o(this))}if(i){var c=i.x,p=i.y,g=i.width,_=i.height,S=this.getHitLineWidth(),I=S/2,L=c-I,F=p-I,z=c+g+I,V=p+_+I;return{x:L,y:F,minX:L,minY:F,maxX:z,maxY:V,width:g+S,height:_+S}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},e.prototype.isFill=function(){var t=this.attr(),i=t.fill,o=t.fillStyle;return(i||o||this.isClipShape())&&this.canFill},e.prototype.isStroke=function(){var t=this.attr(),i=t.stroke,o=t.strokeStyle;return(i||o)&&this.canStroke},e.prototype.draw=function(t,i){var o=this.get("el");this.get("destroyed")?o&&o.parentNode.removeChild(o):(o||S_(this),ag(this,t),this.createPath(t,i),this.shadow(t,i),this.strokeAndFill(t,i),this.transform(i))},e.prototype.createPath=function(t,i){},e.prototype.strokeAndFill=function(t,i){var o=i||this.attr(),c=o.fill,p=o.fillStyle,g=o.stroke,_=o.strokeStyle,S=o.fillOpacity,I=o.strokeOpacity,L=o.lineWidth,F=this.get("el");this.canFill&&(i?"fill"in o?this._setColor(t,"fill",c):"fillStyle"in o&&this._setColor(t,"fill",p):this._setColor(t,"fill",c||p),S&&F.setAttribute(is.fillOpacity,S)),this.canStroke&&L>0&&(i?"stroke"in o?this._setColor(t,"stroke",g):"strokeStyle"in o&&this._setColor(t,"stroke",_):this._setColor(t,"stroke",g||_),I&&F.setAttribute(is.strokeOpacity,I),L&&F.setAttribute(is.lineWidth,L))},e.prototype._setColor=function(t,i,o){var c=this.get("el");if(!o){c.setAttribute(is[i],"none");return}if(o=o.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(o)){var p=t.find("gradient",o);p||(p=t.addGradient(o)),c.setAttribute(is[i],"url(#"+p+")")}else if(/^[p,P]{1}[\s]*\(/.test(o)){var p=t.find("pattern",o);p||(p=t.addPattern(o)),c.setAttribute(is[i],"url(#"+p+")")}else c.setAttribute(is[i],o)},e.prototype.shadow=function(t,i){var o=this.attr(),c=i||o,p=c.shadowOffsetX,g=c.shadowOffsetY,_=c.shadowBlur,S=c.shadowColor;(p||g||_||S)&&w2(this,t)},e.prototype.transform=function(t){var i=this.attr(),o=(t||i).matrix;o&&ig(this)},e.prototype.isInShape=function(t,i){return this.isPointInPath(t,i)},e.prototype.isPointInPath=function(t,i){var o=this.get("el"),c=this.get("canvas"),p=c.get("el").getBoundingClientRect(),g=t+p.left,_=i+p.top,S=document.elementFromPoint(g,_);return!!(S&&S.isEqualNode(o))},e.prototype.getHitLineWidth=function(){var t=this.attrs,i=t.lineWidth,o=t.lineAppendWidth;return this.isStroke()?i+o:0},e}(ye.AbstractShape),uh=C2,A2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,r:0})},e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");(0,b.S6)(i||o,function(p,g){g==="x"||g==="y"?c.setAttribute("c"+g,p):is[g]&&c.setAttribute(is[g],p)})},e}(uh),T2=A2,M2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");if((0,b.S6)(i||o,function(S,I){is[I]&&c.setAttribute(is[I],S)}),typeof o.html=="function"){var p=o.html.call(this,o);if(p instanceof Element||p instanceof HTMLDocument){for(var g=c.childNodes,_=g.length-1;_>=0;_--)c.removeChild(g[_]);c.appendChild(p)}else c.innerHTML=p}else c.innerHTML=o.html},e}(uh),I2=M2,k2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");(0,b.S6)(i||o,function(p,g){g==="x"||g==="y"?c.setAttribute("c"+g,p):is[g]&&c.setAttribute(is[g],p)})},e}(uh),L2=k2,P2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0})},e.prototype.createPath=function(t,i){var o=this,c=this.attr(),p=this.get("el");(0,b.S6)(i||c,function(g,_){_==="img"?o._setImage(c.img):is[_]&&p.setAttribute(is[_],g)})},e.prototype.setAttr=function(t,i){this.attrs[t]=i,t==="img"&&this._setImage(i)},e.prototype._setImage=function(t){var i=this.attr(),o=this.get("el");if((0,b.HD)(t))o.setAttribute("href",t);else if(t instanceof window.Image)i.width||(o.setAttribute("width",t.width),this.attr("width",t.width)),i.height||(o.setAttribute("height",t.height),this.attr("height",t.height)),o.setAttribute("href",t.src);else if(t instanceof HTMLElement&&(0,b.HD)(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS")o.setAttribute("href",t.toDataURL());else if(t instanceof ImageData){var c=document.createElement("canvas");c.setAttribute("width",""+t.width),c.setAttribute("height",""+t.height),c.getContext("2d").putImageData(t,0,0),i.width||(o.setAttribute("width",""+t.width),this.attr("width",t.width)),i.height||(o.setAttribute("height",""+t.height),this.attr("height",t.height)),o.setAttribute("href",c.toDataURL())}},e}(uh),Cc=P2,O2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");(0,b.S6)(i||o,function(p,g){if(g==="startArrow"||g==="endArrow")if(p){var _=(0,b.Kn)(p)?t.addArrow(o,is[g]):t.getDefaultArrow(o,is[g]);c.setAttribute(is[g],"url(#"+_+")")}else c.removeAttribute(is[g]);else is[g]&&c.setAttribute(is[g],p)})},e.prototype.getTotalLength=function(){var t=this.attr(),i=t.x1,o=t.y1,c=t.x2,p=t.y2;return hl.x1.length(i,o,c,p)},e.prototype.getPoint=function(t){var i=this.attr(),o=i.x1,c=i.y1,p=i.x2,g=i.y2;return hl.x1.pointAt(o,c,p,g,t)},e}(uh),F2=O2,qg={circle:function(r,e,t){return[["M",r,e],["m",-t,0],["a",t,t,0,1,0,t*2,0],["a",t,t,0,1,0,-t*2,0]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+i],["L",r,e-i],["L",r+t,e+i],["z"]]},triangleDown:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-i],["L",r+t,e-i],["L",r,e+i],["Z"]]}},T_={get:function(r){return qg[r]},register:function(r,e){qg[r]=e},remove:function(r){delete qg[r]},getAll:function(){return qg}},R2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t){var i=this.get("el");i.setAttribute("d",this._assembleMarker())},e.prototype._assembleMarker=function(){var t=this._getPath();return(0,b.kJ)(t)?t.map(function(i){return i.join(" ")}).join(""):t},e.prototype._getPath=function(){var t=this.attr(),i=t.x,o=t.y,c=t.r||t.radius,p=t.symbol||"circle",g;return(0,b.mf)(p)?g=p:g=T_.get(p),g?g(i,o,c):(console.warn(g+" symbol is not exist."),null)},e.symbolsFactory=T_,e}(uh),D2=R2,B2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,i){var o=this,c=this.attr(),p=this.get("el");(0,b.S6)(i||c,function(g,_){if(_==="path"&&(0,b.kJ)(g))p.setAttribute("d",o._formatPath(g));else if(_==="startArrow"||_==="endArrow")if(g){var S=(0,b.Kn)(g)?t.addArrow(c,is[_]):t.getDefaultArrow(c,is[_]);p.setAttribute(is[_],"url(#"+S+")")}else p.removeAttribute(is[_]);else is[_]&&p.setAttribute(is[_],g)})},e.prototype._formatPath=function(t){var i=t.map(function(o){return o.join(" ")}).join("");return~i.indexOf("NaN")?"":i},e.prototype.getTotalLength=function(){var t=this.get("el");return t?t.getTotalLength():null},e.prototype.getPoint=function(t){var i=this.get("el"),o=this.getTotalLength();if(o===0)return null;var c=i?i.getPointAtLength(t*o):null;return c?{x:c.x,y:c.y}:null},e}(uh),N2=B2,z2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");(0,b.S6)(i||o,function(p,g){g==="points"&&(0,b.kJ)(p)&&p.length>=2?c.setAttribute("points",p.map(function(_){return _[0]+","+_[1]}).join(" ")):is[g]&&c.setAttribute(is[g],p)})},e}(uh),U2=z2,Z2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.onAttrChange=function(t,i,o){r.prototype.onAttrChange.call(this,t,i,o),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.createPath=function(t,i){var o=this.attr(),c=this.get("el");(0,b.S6)(i||o,function(p,g){g==="points"&&(0,b.kJ)(p)&&p.length>=2?c.setAttribute("points",p.map(function(_){return _[0]+","+_[1]}).join(" ")):is[g]&&c.setAttribute(is[g],p)})},e.prototype.getTotalLength=function(){var t=this.attr().points,i=this.get("totalLength");return(0,b.UM)(i)?(this.set("totalLength",hl.aH.length(t)),this.get("totalLength")):i},e.prototype.getPoint=function(t){var i=this.attr().points,o=this.get("tCache");o||(this._setTcache(),o=this.get("tCache"));var c,p;return(0,b.S6)(o,function(g,_){t>=g[0]&&t<=g[1]&&(c=(t-g[0])/(g[1]-g[0]),p=_)}),hl.x1.pointAt(i[p][0],i[p][1],i[p+1][0],i[p+1][1],c)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var i=this.getTotalLength();if(!(i<=0)){var o=0,c=[],p,g;(0,b.S6)(t,function(_,S){t[S+1]&&(p=[],p[0]=o/i,g=hl.x1.length(_[0],_[1],t[S+1][0],t[S+1][1]),o+=g,p[1]=o/i,c.push(p))}),this.set("tCache",c)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,i=[];return i.push([t[1][0],t[1][1]]),i.push([t[0][0],t[0][1]]),i},e.prototype.getEndTangent=function(){var t=this.attr().points,i=t.length-1,o=[];return o.push([t[i-1][0],t[i-1][1]]),o.push([t[i][0],t[i][1]]),o},e}(uh),V2=Z2,G2=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,H2=/[^\s,]+/gi;function j2(r){var e=0,t=0,i=0,o=0;return(0,b.kJ)(r)?r.length===1?e=t=i=o=r[0]:r.length===2?(e=i=r[0],t=o=r[1]):r.length===3?(e=r[0],t=o=r[1],i=r[2]):(e=r[0],t=r[1],i=r[2],o=r[3]):e=t=i=o=r,{r1:e,r2:t,r3:i,r4:o}}function pO(r){if(r=r||[],isArray(r))return r;if(isString(r))return r=r.match(G2),each(r,function(e,t){if(e=e.match(H2),e[0].length>1){var i=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=i}each(e,function(o,c){isNaN(o)||(e[c]=+o)}),r[t]=e}),r}var FT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.createPath=function(t,i){var o=this,c=this.attr(),p=this.get("el"),g=!1,_=["x","y","width","height","radius"];(0,b.S6)(i||c,function(S,I){_.indexOf(I)!==-1&&!g?(p.setAttribute("d",o._assembleRect(c)),g=!0):_.indexOf(I)===-1&&is[I]&&p.setAttribute(is[I],S)})},e.prototype._assembleRect=function(t){var i=t.x,o=t.y,c=t.width,p=t.height,g=t.radius;if(!g)return"M "+i+","+o+" l "+c+",0 l 0,"+p+" l"+-c+" 0 z";var _=j2(g);(0,b.kJ)(g)?g.length===1?_.r1=_.r2=_.r3=_.r4=g[0]:g.length===2?(_.r1=_.r3=g[0],_.r2=_.r4=g[1]):g.length===3?(_.r1=g[0],_.r2=_.r4=g[1],_.r3=g[2]):(_.r1=g[0],_.r2=g[1],_.r3=g[2],_.r4=g[3]):_.r1=_.r2=_.r3=_.r4=g;var S=[["M "+(i+_.r1)+","+o],["l "+(c-_.r1-_.r2)+",0"],["a "+_.r2+","+_.r2+",0,0,1,"+_.r2+","+_.r2],["l 0,"+(p-_.r2-_.r3)],["a "+_.r3+","+_.r3+",0,0,1,"+-_.r3+","+_.r3],["l "+(_.r3+_.r4-c)+",0"],["a "+_.r4+","+_.r4+",0,0,1,"+-_.r4+","+-_.r4],["l 0,"+(_.r4+_.r1-p)],["a "+_.r1+","+_.r1+",0,0,1,"+_.r1+","+-_.r1],["z"]];return S.join(" ")},e}(uh),RT=FT,DT=nt(74348),W2=.3,X2={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},Y2={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},$2={left:"left",start:"left",center:"middle",right:"end",end:"end"},q2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.createPath=function(t,i){var o=this,c=this.attr(),p=this.get("el");this._setFont(),(0,b.S6)(i||c,function(g,_){_==="text"?o._setText(""+g):_==="matrix"&&g?ig(o):is[_]&&p.setAttribute(is[_],g)}),p.setAttribute("paint-order","stroke"),p.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},e.prototype._setFont=function(){var t=this.get("el"),i=this.attr(),o=i.textBaseline,c=i.textAlign,p=(0,DT.qY)();p&&p.name==="firefox"?t.setAttribute("dominant-baseline",Y2[o]||"alphabetic"):t.setAttribute("alignment-baseline",X2[o]||"baseline"),t.setAttribute("text-anchor",$2[c]||"left")},e.prototype._setText=function(t){var i=this.get("el"),o=this.attr(),c=o.x,p=o.textBaseline,g=p===void 0?"bottom":p;if(!t)i.innerHTML="";else if(~t.indexOf(`
`)){var _=t.split(`
`),S=_.length-1,I="";(0,b.S6)(_,function(L,F){F===0?g==="alphabetic"?I+='<tspan x="'+c+'" dy="'+-S+'em">'+L+"</tspan>":g==="top"?I+='<tspan x="'+c+'" dy="0.9em">'+L+"</tspan>":g==="middle"?I+='<tspan x="'+c+'" dy="'+-(S-1)/2+'em">'+L+"</tspan>":g==="bottom"?I+='<tspan x="'+c+'" dy="-'+(S+W2)+'em">'+L+"</tspan>":g==="hanging"&&(I+='<tspan x="'+c+'" dy="'+(-(S-1)-W2)+'em">'+L+"</tspan>"):I+='<tspan x="'+c+'" dy="1em">'+L+"</tspan>"}),i.innerHTML=I}else i.innerHTML=t},e}(uh),BT=q2,NT=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,zT=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,UT=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function K2(r){var e=r.match(UT);if(!e)return"";var t="";return e.sort(function(i,o){return i=i.split(":"),o=o.split(":"),Number(i[0])-Number(o[0])}),(0,b.S6)(e,function(i){i=i.split(":"),t+='<stop offset="'+i[0]+'" stop-color="'+i[1]+'"></stop>'}),t}function ZT(r,e){var t=NT.exec(r),i=(0,b.wQ)((0,b.c$)(parseFloat(t[1])),Math.PI*2),o=t[2],c,p;i>=0&&i<.5*Math.PI?(c={x:0,y:0},p={x:1,y:1}):.5*Math.PI<=i&&i<Math.PI?(c={x:1,y:0},p={x:0,y:1}):Math.PI<=i&&i<1.5*Math.PI?(c={x:1,y:1},p={x:0,y:0}):(c={x:0,y:1},p={x:1,y:0});var g=Math.tan(i),_=g*g,S=(p.x-c.x+g*(p.y-c.y))/(_+1)+c.x,I=g*(p.x-c.x+g*(p.y-c.y))/(_+1)+c.y;e.setAttribute("x1",c.x),e.setAttribute("y1",c.y),e.setAttribute("x2",S),e.setAttribute("y2",I),e.innerHTML=K2(o)}function VT(r,e){var t=zT.exec(r),i=parseFloat(t[1]),o=parseFloat(t[2]),c=parseFloat(t[3]),p=t[4];e.setAttribute("cx",i),e.setAttribute("cy",o),e.setAttribute("r",c),e.innerHTML=K2(p)}var GT=function(){function r(e){this.cfg={};var t=null,i=(0,b.EL)("gradient_");return e.toLowerCase()[0]==="l"?(t=Ph("linearGradient"),ZT(e,t)):(t=Ph("radialGradient"),VT(e,t)),t.setAttribute("id",i),this.el=t,this.id=i,this.cfg=e,this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),HT=GT,jT={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},WT={x:"-40%",y:"-40%",width:"200%",height:"200%"},XT=function(){function r(e){this.type="filter",this.cfg={},this.type="filter";var t=Ph("filter");return(0,b.S6)(WT,function(i,o){t.setAttribute(o,i)}),this.el=t,this.id=(0,b.EL)("filter_"),this.el.id=this.id,this.cfg=e,this._parseShadow(e,t),this}return r.prototype.match=function(e,t){if(this.type!==e)return!1;var i=!0,o=this.cfg;return(0,b.S6)(Object.keys(o),function(c){if(o[c]!==t[c])return i=!1,!1}),i},r.prototype.update=function(e,t){var i=this.cfg;return i[jT[e]]=t,this._parseShadow(i,this.el),this},r.prototype._parseShadow=function(e,t){var i=`<feDropShadow
      dx="`+(e.dx||0)+`"
      dy="`+(e.dy||0)+`"
      stdDeviation="`+(e.blur?e.blur/10:0)+`"
      flood-color="`+(e.color?e.color:"#000")+`"
      flood-opacity="`+(e.opacity?e.opacity:1)+`"
      />`;t.innerHTML=i},r}(),YT=XT,$T=function(){function r(e,t){this.cfg={};var i=Ph("marker"),o=(0,b.EL)("marker_");i.setAttribute("id",o);var c=Ph("path");c.setAttribute("stroke",e.stroke||"none"),c.setAttribute("fill",e.fill||"none"),i.appendChild(c),i.setAttribute("overflow","visible"),i.setAttribute("orient","auto-start-reverse"),this.el=i,this.child=c,this.id=o;var p=e[t==="marker-start"?"startArrow":"endArrow"];return this.stroke=e.stroke||"#000",p===!0?this._setDefaultPath(t,c):(this.cfg=p,this._setMarker(e.lineWidth,c)),this}return r.prototype.match=function(){return!1},r.prototype._setDefaultPath=function(e,t){var i=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),i.setAttribute("refX",""+10*Math.cos(Math.PI/6)),i.setAttribute("refY",""+5)},r.prototype._setMarker=function(e,t){var i=this.el,o=this.cfg.path,c=this.cfg.d;(0,b.kJ)(o)&&(o=o.map(function(p){return p.join(" ")}).join("")),t.setAttribute("d",o),i.appendChild(t),c&&i.setAttribute("refX",""+c/e)},r.prototype.update=function(e){var t=this.child;t.attr?t.attr("fill",e):t.setAttribute("fill",e)},r}(),Q2=$T,qT=function(){function r(e){this.type="clip",this.cfg={};var t=Ph("clipPath");this.el=t,this.id=(0,b.EL)("clip_"),t.id=this.id;var i=e.cfg.el;return t.appendChild(i),this.cfg=e,this}return r.prototype.match=function(){return!1},r.prototype.remove=function(){var e=this.el;e.parentNode.removeChild(e)},r}(),KT=qT,QT=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,ts=function(){function r(e){this.cfg={};var t=Ph("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var i=Ph("image");t.appendChild(i);var o=(0,b.EL)("pattern_");t.id=o,this.el=t,this.id=o,this.cfg=e;var c=QT.exec(e),p=c[2];i.setAttribute("href",p);var g=new Image;p.match(/^data:/i)||(g.crossOrigin="Anonymous"),g.src=p;function _(){t.setAttribute("width",""+g.width),t.setAttribute("height",""+g.height)}return g.complete?_():(g.onload=_,g.src=g.src),this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),Mv=ts,J2=function(){function r(e){var t=Ph("defs"),i=(0,b.EL)("defs_");t.id=i,e.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=e}return r.prototype.find=function(e,t){for(var i=this.children,o=null,c=0;c<i.length;c++)if(i[c].match(e,t)){o=i[c].id;break}return o},r.prototype.findById=function(e){for(var t=this.children,i=null,o=0;o<t.length;o++)if(t[o].id===e){i=t[o];break}return i},r.prototype.add=function(e){this.children.push(e),e.canvas=this.canvas,e.parent=this},r.prototype.getDefaultArrow=function(e,t){var i=e.stroke||e.strokeStyle;if(this.defaultArrow[i])return this.defaultArrow[i].id;var o=new Q2(e,t);return this.defaultArrow[i]=o,this.el.appendChild(o.el),this.add(o),o.id},r.prototype.addGradient=function(e){var t=new HT(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addArrow=function(e,t){var i=new Q2(e,t);return this.el.appendChild(i.el),this.add(i),i.id},r.prototype.addShadow=function(e){var t=new YT(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addPattern=function(e){var t=new Mv(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addClip=function(e){var t=new KT(e);return this.el.appendChild(t.el),this.add(t),t.id},r}(),tE=J2,ky=function(r){(0,P.ZT)(e,r);function e(t){return r.call(this,(0,P.pi)((0,P.pi)({},t),{autoDraw:!0,renderer:"svg"}))||this}return e.prototype.getShapeBase=function(){return ot},e.prototype.getGroupBase=function(){return Iy},e.prototype.getShape=function(t,i,o){var c=o.target||o.srcElement;if(!My[c.tagName]){for(var p=c.parentNode;p&&!My[p.tagName];)p=p.parentNode;c=p}return this.find(function(g){return g.get("el")===c})},e.prototype.createDom=function(){var t=Ph("svg"),i=new tE(t);return t.setAttribute("width",""+this.get("width")),t.setAttribute("height",""+this.get("height")),this.set("context",i),t},e.prototype.onCanvasChange=function(t){var i=this.get("context"),o=this.get("el");if(t==="sort"){var c=this.get("children");c&&c.length&&b2(this,function(g,_){return c.indexOf(g)-c.indexOf(_)?1:0})}else if(t==="clear"){if(o){o.innerHTML="";var p=i.el;p.innerHTML="",o.appendChild(p)}}else t==="matrix"?ig(this):t==="clip"?ag(this,i):t==="changeSize"&&(o.setAttribute("width",""+this.get("width")),o.setAttribute("height",""+this.get("height")))},e.prototype.draw=function(){var t=this.get("context"),i=this.getChildren();ag(this,t),i.length&&C_(t,i)},e}(ye.AbstractCanvas),eE=ky,rE="0.5.6",JT=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="path",i.shapeType="line";var o=t.connectNulls,c=o===void 0?!1:o,p=t.showSinglePoint,g=p===void 0?!0:p;return i.connectNulls=c,i.showSinglePoint=g,i}return e.prototype.updateElements=function(t,i){var o,c,p,g,_,S;i===void 0&&(i=!1);for(var I=new Map,L=new Map,F=[],z=0,V=0;V<t.length;V++){var Q=t[V],st=this.getElementId(Q);F.push(st),I.set(st,Q),L.set(st,z),z++}this.elements=new Array(z);var at=Ls(this.lastElementsMap,F),Ft=at.added,Kt=at.updated,ee=at.removed;try{for(var Me=(0,P.XA)(Ft),hr=Me.next();!hr.done;hr=Me.next()){var st=hr.value,Q=I.get(st),Tr=this.getShapeFactory(),Dr=this.getShapeInfo(Q),V=L.get(st),cn=new Si({shapeFactory:Tr,container:this.container,offscreenGroup:this.getOffscreenGroup(),elementIndex:V});cn.geometry=this,cn.animate=this.animateOption,cn.draw(Dr,i),this.elementsMap[st]=cn,this.elements[V]=cn}}catch(eo){o={error:eo}}finally{try{hr&&!hr.done&&(c=Me.return)&&c.call(Me)}finally{if(o)throw o.error}}try{for(var Jr=(0,P.XA)(Kt),Mn=Jr.next();!Mn.done;Mn=Jr.next()){var st=Mn.value,Q=I.get(st),cn=this.lastElementsMap[st],V=L.get(st),Dr=this.getShapeInfo(Q),mi=cn.getModel();(this.isCoordinateChanged||qs(mi,Dr))&&(cn.animate=this.animateOption,cn.update(Dr)),this.elementsMap[st]=cn,this.elements[V]=cn}}catch(eo){p={error:eo}}finally{try{Mn&&!Mn.done&&(g=Jr.return)&&g.call(Jr)}finally{if(p)throw p.error}}try{for(var da=(0,P.XA)(ee),Sa=da.next();!Sa.done;Sa=da.next()){var st=Sa.value,cn=this.lastElementsMap[st];cn.animate=this.animateOption,cn.destroy()}}catch(eo){_={error:eo}}finally{try{Sa&&!Sa.done&&(S=da.return)&&S.call(da)}finally{if(_)throw _.error}}},e.prototype.getPointsAndData=function(t){for(var i=[],o=[],c=0,p=t.length;c<p;c++){var g=t[c];i.push({x:g.x,y:g.y}),o.push(g[ve])}return{points:i,data:o}},e.prototype.getShapeInfo=function(t){var i=this.getDrawCfg(t[0]),o=this.getPointsAndData(t),c=o.points,p=o.data;return i.mappingData=t,i.data=p,i.isStack=!!this.getAdjust("stack"),i.points=c,i.connectNulls=this.connectNulls,i.showSinglePoint=this.showSinglePoint,i},e}(Ns),M_=JT;function tM(r,e,t,i,o){var c=[];if(r.length){for(var p=[],g=[],_=0,S=r.length;_<S;_++){var I=r[_];p.push(I[1]),g.push(I[0])}g=g.reverse(),(0,b.S6)([p,g],function(L,F){var z=[],V=i.parsePoints(L),Q=V[0];p.length===1&&g.length===1?z=F===0?[["M",Q.x-.5,Q.y],["L",Q.x+.5,Q.y]]:[["L",Q.x+.5,Q.y],["L",Q.x-.5,Q.y]]:(e&&V.push({x:Q.x,y:Q.y}),t?z=gi(V,!1,o):z=jn(V,!1),F>0&&(z[0][0]="L")),c=c.concat(z)}),c.push(["Z"])}return c}function Kg(r,e,t,i,o){for(var c=Gs(r,e,!e,"lineWidth"),p=r.connectNulls,g=r.isInCircle,_=r.points,S=r.showSinglePoint,I=sh(_,p,S),L=[],F=0,z=I.length;F<z;F++){var V=I[F];L=L.concat(tM(V,g,t,i,o))}return c.path=L,c}function I_(r){var e=r.start,t=r.end;return[[e.x,t.y],[t.x,e.y]]}var eM=so("area",{defaultShapeType:"area",getDefaultPoints:function(r){var e=r.x,t=r.y0,i=(0,b.kJ)(r.y)?r.y:[t,r.y];return i.map(function(o){return{x:e,y:o}})}});_i("area","area",{draw:function(r,e){var t=Kg(r,!1,!1,this),i=e.addShape({type:"path",attrs:t,name:"area"});return i},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){return o===void 0&&(o=5.5),[["M",t-o,i-4],["L",t+o,i-4],["L",t+o,i+4],["L",t-o,i+4],["Z"]]},style:{r:5,fill:e,fillOpacity:1}}}});var nE=null,iE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="area",i.shapeType="area",i.generatePoints=!0,i.startOnZero=!0;var o=t.startOnZero,c=o===void 0?!0:o,p=t.sortable,g=p===void 0?!1:p,_=t.showSinglePoint,S=_===void 0?!1:_;return i.startOnZero=c,i.sortable=g,i.showSinglePoint=S,i}return e.prototype.getPointsAndData=function(t){for(var i=[],o=[],c=0,p=t.length;c<p;c++){var g=t[c];i.push(g.points),o.push(g[ve])}return{points:i,data:o}},e.prototype.getYMinValue=function(){if(this.startOnZero)return r.prototype.getYMinValue.call(this);var t=this.getYScale();return t.min},e}(M_),rM=iE,dO=so("edge",{defaultShapeType:"line",getDefaultPoints:function(r){return sf(r)}});_i("edge","line",{draw:function(r,e){var t=Gs(r,!0,!1,"lineWidth"),i=jn(this.parsePoints(r.points),this.coordinate.isPolar);return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});var nM=null,iM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="edge",t.shapeType="edge",t.generatePoints=!0,t}return e}(Ns),aE=iM,oE=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="heatmap",t.paletteCache={},t}return e.prototype.updateElements=function(t,i){i===void 0&&(i=!1);for(var o=0;o<t.length;o++){var c=t[o],p=this.prepareRange(c),g=this.prepareSize(),_=(0,b.U2)(this.styleOption,["cfg","shadowBlur"]);(0,b.hj)(_)||(_=g/2),this.prepareGreyScaleBlurredCircle(g,_),this.drawWithRange(c,p,g,_)}},e.prototype.color=function(t,i){return this.createAttrOption("color",t,typeof i!="function"?i:""),this},e.prototype.clear=function(){r.prototype.clear.call(this),this.clearShadowCanvasCtx(),this.paletteCache={}},e.prototype.prepareRange=function(t){var i=this.getAttribute("color"),o=i.getFields()[0],c=1/0,p=-1/0;return t.forEach(function(g){var _=g[ve][o];_>p&&(p=_),_<c&&(c=_)}),c===p&&(c=p-1),[c,p]},e.prototype.prepareSize=function(){var t=this.getDefaultValue("size");return(0,b.hj)(t)||(t=this.getDefaultSize()),t},e.prototype.prepareGreyScaleBlurredCircle=function(t,i){var o=this.getGrayScaleBlurredCanvas(),c=t+i,p=o.getContext("2d");o.width=o.height=c*2,p.clearRect(0,0,o.width,o.height),p.shadowOffsetX=p.shadowOffsetY=c*2,p.shadowBlur=i,p.shadowColor="black",p.beginPath(),p.arc(-c,-c,t,0,Math.PI*2,!0),p.closePath(),p.fill()},e.prototype.drawWithRange=function(t,i,o,c){var p,g,_=this.coordinate,S=_.start,I=_.end,L=this.coordinate.getWidth(),F=this.coordinate.getHeight(),z=this.getAttribute("color"),V=z.getFields()[0];this.clearShadowCanvasCtx();var Q=this.getShadowCanvasCtx();i&&(t=t.filter(function(Jr){return Jr[ve][V]<=i[1]&&Jr[ve][V]>=i[0]}));var st=this.scales[V];try{for(var at=(0,P.XA)(t),Ft=at.next();!Ft.done;Ft=at.next()){var Kt=Ft.value,ee=this.getDrawCfg(Kt),Me=ee.x,hr=ee.y,Tr=st.scale(Kt[ve][V]);this.drawGrayScaleBlurredCircle(Me-S.x,hr-I.y,o+c,Tr,Q)}}catch(Jr){p={error:Jr}}finally{try{Ft&&!Ft.done&&(g=at.return)&&g.call(at)}finally{if(p)throw p.error}}var Dr=Q.getImageData(0,0,L,F);this.clearShadowCanvasCtx(),this.colorize(Dr),Q.putImageData(Dr,0,0);var cn=this.getImageShape();cn.attr("x",S.x),cn.attr("y",I.y),cn.attr("width",L),cn.attr("height",F),cn.attr("img",Q.canvas),cn.set("origin",this.getShapeInfo(t))},e.prototype.getDefaultSize=function(){var t=this.getAttribute("position"),i=this.coordinate;return Math.min(i.getWidth()/(t.scales[0].ticks.length*4),i.getHeight()/(t.scales[1].ticks.length*4))},e.prototype.clearShadowCanvasCtx=function(){var t=this.getShadowCanvasCtx();t.clearRect(0,0,t.canvas.width,t.canvas.height)},e.prototype.getShadowCanvasCtx=function(){var t=this.shadowCanvas;return t||(t=document.createElement("canvas"),this.shadowCanvas=t),t.width=this.coordinate.getWidth(),t.height=this.coordinate.getHeight(),t.getContext("2d")},e.prototype.getGrayScaleBlurredCanvas=function(){return this.grayScaleBlurredCanvas||(this.grayScaleBlurredCanvas=document.createElement("canvas")),this.grayScaleBlurredCanvas},e.prototype.drawGrayScaleBlurredCircle=function(t,i,o,c,p){var g=this.getGrayScaleBlurredCanvas();p.globalAlpha=c,p.drawImage(g,t-o,i-o)},e.prototype.colorize=function(t){for(var i=this.getAttribute("color"),o=t.data,c=this.paletteCache,p=3;p<o.length;p+=4){var g=o[p];if((0,b.hj)(g)){var _=c[g]?c[g]:_a.rgb2arr(i.gradient(g/256));o[p-3]=_[0],o[p-2]=_[1],o[p-1]=_[2],o[p]=g}}},e.prototype.getImageShape=function(){var t=this.imageShape;if(t)return t;var i=this.container;return t=i.addShape({type:"image",attrs:{}}),this.imageShape=t,t},e.prototype.getShapeInfo=function(t){var i=this.getDrawCfg(t[0]),o=t.map(function(c){return c[ve]});return(0,P.pi)((0,P.pi)({},i),{mappingData:t,data:o})},e}(Ns),aM=oE;function k_(r){var e,t,i=r.x,o=r.y,c=r.y0,p=r.size,g,_;(0,b.kJ)(o)?(e=(0,P.CR)(o,2),g=e[0],_=e[1]):(g=c,_=o);var S,I;(0,b.kJ)(i)?(t=(0,P.CR)(i,2),S=t[0],I=t[1]):(S=i-p/2,I=i+p/2);var L=[{x:S,y:g},{x:S,y:_}];return L.push({x:I,y:_},{x:I,y:g}),L}function L_(r,e){e===void 0&&(e=!0);var t=[],i=r[0];t.push(["M",i.x,i.y]);for(var o=1,c=r.length;o<c;o++)t.push(["L",r[o].x,r[o].y]);return e&&(t.push(["L",i.x,i.y]),t.push(["z"])),t}function P_(r,e){var t=0,i=0,o=0,c=0;return(0,b.kJ)(r)?r.length===1?t=i=o=c=r[0]:r.length===2?(t=o=r[0],i=c=r[1]):r.length===3?(t=r[0],i=c=r[1],o=r[2]):(t=r[0],i=r[1],o=r[2],c=r[3]):t=i=o=c=r,t+i>e&&(t=t?e/(1+i/t):0,i=e-t),o+c>e&&(o=o?e/(1+c/o):0,c=e-o),[t||0,i||0,o||0,c||0]}function O_(r,e,t){var i=[];if(t.isRect){var o=t.isTransposed?{x:t.start.x,y:e[0].y}:{x:e[0].x,y:t.start.y},c=t.isTransposed?{x:t.end.x,y:e[2].y}:{x:e[3].x,y:t.end.y},p=(0,b.U2)(r,["background","style","radius"]);if(p){var g=t.isTransposed?Math.abs(e[0].y-e[2].y):e[2].x-e[1].x,_=t.isTransposed?t.getWidth():t.getHeight(),S=(0,P.CR)(P_(p,Math.min(g,_)),4),I=S[0],L=S[1],F=S[2],z=S[3],V=t.isTransposed&&t.isReflect("y"),Q=V?0:1,st=function(hr){return V?-hr:hr};i.push(["M",o.x,c.y+st(I)]),I!==0&&i.push(["A",I,I,0,0,Q,o.x+I,c.y]),i.push(["L",c.x-L,c.y]),L!==0&&i.push(["A",L,L,0,0,Q,c.x,c.y+st(L)]),i.push(["L",c.x,o.y-st(F)]),F!==0&&i.push(["A",F,F,0,0,Q,c.x-F,o.y]),i.push(["L",o.x+z,o.y]),z!==0&&i.push(["A",z,z,0,0,Q,o.x,o.y-st(z)])}else i.push(["M",o.x,o.y]),i.push(["L",c.x,o.y]),i.push(["L",c.x,c.y]),i.push(["L",o.x,c.y]),i.push(["L",o.x,o.y]);i.push(["z"])}if(t.isPolar){var at=t.getCenter(),Ft=wh(r,t),Kt=Ft.startAngle,ee=Ft.endAngle;if(t.type!=="theta"&&!t.isTransposed)i=sl(at.x,at.y,t.getRadius(),Kt,ee);else{var Me=function(Dr){return Math.pow(Dr,2)},I=Math.sqrt(Me(at.x-e[0].x)+Me(at.y-e[0].y)),L=Math.sqrt(Me(at.x-e[2].x)+Me(at.y-e[2].y));i=sl(at.x,at.y,I,t.startAngle,t.endAngle,L)}}return i}function sE(r,e,t){var i=t.getWidth(),o=t.getHeight(),c=t.type==="rect",p=[],g=(r[2].x-r[1].x)/2,_=t.isTransposed?g*o/i:g*i/o;return e==="round"?(c?(p.push(["M",r[0].x,r[0].y+_]),p.push(["L",r[1].x,r[1].y-_]),p.push(["A",g,g,0,0,1,r[2].x,r[2].y-_]),p.push(["L",r[3].x,r[3].y+_]),p.push(["A",g,g,0,0,1,r[0].x,r[0].y+_])):(p.push(["M",r[0].x,r[0].y]),p.push(["L",r[1].x,r[1].y]),p.push(["A",g,g,0,0,1,r[2].x,r[2].y]),p.push(["L",r[3].x,r[3].y]),p.push(["A",g,g,0,0,1,r[0].x,r[0].y])),p.push(["z"])):p=L_(r),p}function Ly(r,e,t){var i=[];return(0,b.UM)(e)?t?i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",(r[2].x+r[3].x)/2,(r[2].y+r[3].y)/2],["Z"]):i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",r[2].x,r[2].y],["L",r[3].x,r[3].y],["Z"]):i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",e[1].x,e[1].y],["L",e[0].x,e[0].y],["Z"]),i}function og(r,e){return[e,r]}function oM(r,e,t){var i,o,c,p,g,_,S,I=(0,P.CR)((0,P.ev)([],(0,P.CR)(r),!1),4),L=I[0],F=I[1],z=I[2],V=I[3],Q=(0,P.CR)(typeof t=="number"?Array(4).fill(t):t,4),st=Q[0],at=Q[1],Ft=Q[2],Kt=Q[3];e.isTransposed&&(i=(0,P.CR)(og(F,V),2),F=i[0],V=i[1]),e.isReflect("y")&&(o=(0,P.CR)(og(L,F),2),L=o[0],F=o[1],c=(0,P.CR)(og(z,V),2),z=c[0],V=c[1]),e.isReflect("x")&&(p=(0,P.CR)(og(L,V),2),L=p[0],V=p[1],g=(0,P.CR)(og(F,z),2),F=g[0],z=g[1]);var ee=[],Me=function(hr){return Math.abs(hr)};return _=(0,P.CR)(P_([st,at,Ft,Kt],Math.min(Me(V.x-L.x),Me(F.y-L.y))).map(function(hr){return Me(hr)}),4),st=_[0],at=_[1],Ft=_[2],Kt=_[3],e.isTransposed&&(S=(0,P.CR)([Kt,st,at,Ft],4),st=S[0],at=S[1],Ft=S[2],Kt=S[3]),L.y<F.y?(ee.push(["M",V.x,V.y+Ft]),Ft!==0&&ee.push(["A",Ft,Ft,0,0,0,V.x-Ft,V.y]),ee.push(["L",L.x+Kt,L.y]),Kt!==0&&ee.push(["A",Kt,Kt,0,0,0,L.x,L.y+Kt]),ee.push(["L",F.x,F.y-st]),st!==0&&ee.push(["A",st,st,0,0,0,F.x+st,F.y]),ee.push(["L",z.x-at,z.y]),at!==0&&ee.push(["A",at,at,0,0,0,z.x,z.y-at]),ee.push(["L",V.x,V.y+Ft]),ee.push(["z"])):V.x<L.x?(ee.push(["M",z.x+at,z.y]),at!==0&&ee.push(["A",at,at,0,0,0,z.x,z.y+at]),ee.push(["L",V.x,V.y-Ft]),Ft!==0&&ee.push(["A",Ft,Ft,0,0,0,V.x+Ft,V.y]),ee.push(["L",L.x-Kt,L.y]),Kt!==0&&ee.push(["A",Kt,Kt,0,0,0,L.x,L.y-Kt]),ee.push(["L",F.x,F.y+st]),st!==0&&ee.push(["A",st,st,0,0,0,F.x-st,F.y]),ee.push(["L",z.x+at,z.y]),ee.push(["z"])):(ee.push(["M",F.x,F.y+st]),st!==0&&ee.push(["A",st,st,0,0,1,F.x+st,F.y]),ee.push(["L",z.x-at,z.y]),at!==0&&ee.push(["A",at,at,0,0,1,z.x,z.y+at]),ee.push(["L",V.x,V.y-Ft]),Ft!==0&&ee.push(["A",Ft,Ft,0,0,1,V.x-Ft,V.y]),ee.push(["L",L.x+Kt,L.y]),Kt!==0&&ee.push(["A",Kt,Kt,0,0,1,L.x,L.y-Kt]),ee.push(["L",F.x,F.y+st]),ee.push(["z"])),ee}var Iv=so("interval",{defaultShapeType:"rect",getDefaultPoints:function(r){return k_(r)}});_i("interval","rect",{draw:function(r,e){var t=Gs(r,!1,!0),i=e,o=r==null?void 0:r.background;if(o){i=e.addGroup({name:"interval-group"});var c=el(r),p=O_(r,this.parsePoints(r.points),this.coordinate);i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},c),{path:p}),zIndex:-1,name:Fn})}var g;t.radius&&this.coordinate.isRect?g=oM(this.parsePoints(r.points),this.coordinate,t.radius):g=this.parsePath(sE(r.points,t.lineCap,this.coordinate));var _=i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:g}),name:"interval"});return o?i:_},getMarker:function(r){var e=r.color,t=r.isInPolar;return t?{symbol:"circle",style:{r:4.5,fill:e}}:{symbol:"square",style:{r:4,fill:e}}}});var sM=null;function uE(r,e){var t=r.length,i=r;(0,b.HD)(i[0])&&(i=r.map(function(g){return e.translate(g)}));for(var o=i[1]-i[0],c=2;c<t;c++){var p=i[c]-i[c-1];o>p&&(o=p)}return o}function uM(r,e){if(e){var t=(0,b.xH)(r),i=(0,b.I)(t,e);return i.length}return r.length}function F_(r){var e=r.theme,t=r.coordinate,i=r.getXScale(),o=i.values,c=r.beforeMappingData,p=o.length,g=xd(r.coordinate),_=r.intervalPadding,S=r.dodgePadding,I=r.maxColumnWidth||e.maxColumnWidth,L=r.minColumnWidth||e.minColumnWidth,F=r.columnWidthRatio||e.columnWidthRatio,z=r.multiplePieWidthRatio||e.multiplePieWidthRatio,V=r.roseWidthRatio||e.roseWidthRatio;if(i.isLinear&&o.length>1){o.sort();var Q=uE(o,i);p=(i.max-i.min)/Q,o.length>p&&(p=o.length)}var st=i.range,at=1/p,Ft=1;if(t.isPolar?t.isTransposed&&p>1?Ft=z:Ft=V:(i.isLinear&&(at*=st[1]-st[0]),Ft=F),!(0,b.UM)(_)&&_>=0){var Kt=_/g;at=(1-(p-1)*Kt)/p}else at*=Ft;if(r.getAdjust("dodge")){var ee=r.getAdjust("dodge"),Me=ee.dodgeBy,hr=uM(c,Me);if(!(0,b.UM)(S)&&S>=0){var Tr=S/g;at=(at-Tr*(hr-1))/hr}else!(0,b.UM)(_)&&_>=0&&(at*=Ft),at=at/hr;at=at>=0?at:0}if(!(0,b.UM)(I)&&I>=0){var Dr=I/g;at>Dr&&(at=Dr)}if(!(0,b.UM)(L)&&L>=0){var cn=L/g;at<cn&&(at=cn)}return at}var lM=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="interval",i.shapeType="interval",i.generatePoints=!0;var o=t.background;return i.background=o,i}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),o,c=this.getAttribute("size");if(c){o=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=xd(p);o=o/g}else this.defaultSize||(this.defaultSize=F_(this)),o=this.defaultSize;return i.size=o,i},e.prototype.adjustScale=function(){r.prototype.adjustScale.call(this);var t=this.getYScale();if(this.coordinate.type==="theta")t.change({nice:!1,min:0,max:$0(t)});else{var i=this.scaleDefs,o=t.field,c=t.min,p=t.max,g=t.type;g!=="time"&&(c>0&&!(0,b.U2)(i,[o,"min"])&&t.change({min:0}),p<=0&&!(0,b.U2)(i,[o,"max"])&&t.change({max:0}))}},e.prototype.getDrawCfg=function(t){var i=r.prototype.getDrawCfg.call(this,t);return i.background=this.background,i},e}(Ns),cM=lM,fM=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="line";var o=t.sortable,c=o===void 0?!1:o;return i.sortable=c,i}return e}(M_),lE=fM,R_=["circle","square","bowtie","diamond","hexagon","triangle","triangle-down"],hM=["cross","tick","plus","hyphen","line"];function D_(r,e,t,i,o){var c,p,g=Gs(e,o,!o,"r"),_=r.parsePoints(e.points),S=_[0];if(e.isStack)S=_[1];else if(_.length>1){var I=t.addGroup();try{for(var L=(0,P.XA)(_),F=L.next();!F.done;F=L.next()){var z=F.value;I.addShape({type:"marker",attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{symbol:yl[i]||i}),z)})}}catch(V){c={error:V}}finally{try{F&&!F.done&&(p=L.return)&&p.call(L)}finally{if(c)throw c.error}}return I}return t.addShape({type:"marker",attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{symbol:yl[i]||i}),S)})}var vO=so("point",{defaultShapeType:"hollow-circle",getDefaultPoints:function(r){return sf(r)}});(0,b.S6)(R_,function(r){_i("point","hollow-".concat(r),{draw:function(e,t){return D_(this,e,t,r,!0)},getMarker:function(e){var t=e.color;return{symbol:yl[r]||r,style:{r:4.5,stroke:t,fill:null}}}})});var gO=null,pM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="point",t.shapeType="point",t.generatePoints=!0,t}return e.prototype.getDrawCfg=function(t){var i=r.prototype.getDrawCfg.call(this,t);return(0,P.pi)((0,P.pi)({},i),{isStack:!!this.getAdjust("stack")})},e}(Ns),cE=pM;function fE(r){for(var e=r[0],t=1,i=[["M",e.x,e.y]];t<r.length;){var o=r[t];(o.x!==r[t-1].x||o.y!==r[t-1].y)&&(i.push(["L",o.x,o.y]),o.x===e.x&&o.y===e.y&&t<r.length-1&&(e=r[t+1],i.push(["Z"]),i.push(["M",e.x,e.y]),t++)),t++}return(0,b.Xy)((0,b.Z$)(i),e)||i.push(["L",e.x,e.y]),i.push(["Z"]),i}var mO=so("polygon",{defaultShapeType:"polygon",getDefaultPoints:function(r){var e=[];return(0,b.S6)(r.x,function(t,i){var o=r.y[i];e.push({x:t,y:o})}),e}});_i("polygon","polygon",{draw:function(r,e){if(!(0,b.xb)(r.points)){var t=Gs(r,!0,!0),i=this.parsePath(fE(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"polygon"})}},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}});var yO=null,dM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.shapeType="polygon",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),o=i.x,c=i.y,p;if(!((0,b.kJ)(o)&&(0,b.kJ)(c))){var g=this.getXScale(),_=this.getYScale(),S=g.values.length,I=_.values.length,L=.5*1/S,F=.5*1/I;g.isCategory&&_.isCategory?(o=[o-L,o-L,o+L,o+L],c=[c-F,c+F,c+F,c-F]):(0,b.kJ)(o)?(p=o,o=[p[0],p[0],p[1],p[1]],c=[c-F/2,c+F/2,c+F/2,c-F/2]):(0,b.kJ)(c)&&(p=c,c=[p[0],p[1],p[1],p[0]],o=[o-L/2,o-L/2,o+L/2,o+L/2]),i.x=o,i.y=c}return i},e}(Ns),vM=dM,_O=so("schema",{defaultShapeType:""}),gM=null,hE=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="schema",t.shapeType="schema",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),o,c=this.getAttribute("size");if(c){o=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=xd(p);o=o/g}else this.defaultSize||(this.defaultSize=F_(this)),o=this.defaultSize;return i.size=o,i},e}(Ns),mM=hE;function yM(r){if(!(0,b.kJ)(r))return[];var e=(0,b.Fp)(r);return(0,b.UI)(r,function(t){return t/e})}var xO=so("violin",{defaultShapeType:"violin",getDefaultPoints:function(r){var e=r.size/2,t=[],i=yM(r._size);return(0,b.S6)(r.y,function(o,c){var p=i[c]*e,g=c===0,_=c===r.y.length-1;t.push({isMin:g,isMax:_,x:r.x-p,y:o}),t.unshift({isMin:g,isMax:_,x:r.x+p,y:o})}),t}});_i("violin","violin",{draw:function(r,e){var t=Gs(r,!0,!0),i=this.parsePath(gv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"violin"})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:e}}}});var bO=null,_M=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="violin",t.shapeType="violin",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),o,c=this.getAttribute("size");if(c){o=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=xd(p);o=o/g}else this.defaultSize||(this.defaultSize=F_(this)),o=this.defaultSize;return i.size=o,i._size=(0,b.U2)(t[ve],[this._sizeField]),i},e.prototype.initAttributes=function(){var t=this.attributeOption,i=t.size?t.size.fields[0]:this._sizeField?this._sizeField:"size";this._sizeField=i,delete t.size,r.prototype.initAttributes.call(this)},e}(Ns),pE=_M;_i("area","line",{draw:function(r,e){var t=Kg(r,!0,!1,this),i=e.addShape({type:"path",attrs:t,name:"area"});return i},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){return o===void 0&&(o=5.5),[["M",t-o,i-4],["L",t+o,i-4],["L",t+o,i+4],["L",t-o,i+4],["Z"]]},style:{r:5,stroke:e,fill:null}}}}),_i("area","smooth",{draw:function(r,e){var t=this.coordinate,i=Kg(r,!1,!0,this,I_(t)),o=e.addShape({type:"path",attrs:i,name:"area"});return o},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){return o===void 0&&(o=5.5),[["M",t-o,i-4],["L",t+o,i-4],["L",t+o,i+4],["L",t-o,i+4],["Z"]]},style:{r:5,fill:e,fillOpacity:1}}}}),_i("area","smooth-line",{draw:function(r,e){var t=this.coordinate,i=Kg(r,!0,!0,this,I_(t)),o=e.addShape({type:"path",attrs:i,name:"area"});return o},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){return o===void 0&&(o=5.5),[["M",t-o,i-4],["L",t+o,i-4],["L",t+o,i+4],["L",t-o,i+4],["Z"]]},style:{r:5,stroke:e,fill:null}}}});function Py(r,e){return["C",r.x*1/2+e.x*1/2,r.y,r.x*1/2+e.x*1/2,e.y,e.x,e.y]}function B_(r,e){var t=[];t.push({x:e.x,y:e.y}),t.push(r);var i=["Q"];return(0,b.S6)(t,function(o){i.push(o.x,o.y)}),i}function xM(r,e,t){var i=B_(e,t),o=[["M",r.x,r.y]];return o.push(i),o}function bM(r,e){var t=B_(r[1],e),i=B_(r[3],e),o=[["M",r[0].x,r[0].y]];return o.push(i),o.push(["L",r[3].x,r[3].y]),o.push(["L",r[2].x,r[2].y]),o.push(t),o.push(["L",r[1].x,r[1].y]),o.push(["L",r[0].x,r[0].y]),o.push(["Z"]),o}_i("edge","arc",{draw:function(r,e){var t=Gs(r,!0,!1,"lineWidth"),i=r.points,o=i.length>2?"weight":"normal",c;if(r.isInCircle){var p={x:0,y:1};return o==="normal"?c=xM(i[0],i[1],p):(t.fill=t.stroke,c=bM(i,p)),c=this.parsePath(c),e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})})}else{if(o==="normal")return i=this.parsePoints(i),c=e0((i[1].x+i[0].x)/2,i[0].y,Math.abs(i[1].x-i[0].x)/2,Math.PI,Math.PI*2),e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})});var g=Py(i[1],i[3]),_=Py(i[2],i[0]);return c=[["M",i[0].x,i[0].y],["L",i[1].x,i[1].y],g,["L",i[3].x,i[3].y],["L",i[2].x,i[2].y],_,["Z"]],c=this.parsePath(c),t.fill=t.stroke,e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})})}},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});function EM(r,e){var t=Py(r,e),i=[["M",r.x,r.y]];return i.push(t),i}_i("edge","smooth",{draw:function(r,e){var t=Gs(r,!0,!1,"lineWidth"),i=r.points,o=this.parsePath(EM(i[0],i[1]));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:o})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});var Oy=1/3;function dE(r,e){var t=[];t.push({x:r.x,y:r.y*(1-Oy)+e.y*Oy}),t.push({x:e.x,y:r.y*(1-Oy)+e.y*Oy}),t.push(e);var i=[["M",r.x,r.y]];return(0,b.S6)(t,function(o){i.push(["L",o.x,o.y])}),i}_i("edge","vhv",{draw:function(r,e){var t=Gs(r,!0,!1,"lineWidth"),i=r.points,o=this.parsePath(dE(i[0],i[1]));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:o})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}}),_i("interval","funnel",{getPoints:function(r){return r.size=r.size*2,k_(r)},draw:function(r,e){var t=Gs(r,!1,!0),i=this.parsePath(Ly(r.points,r.nextPoints,!1)),o=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return o},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}}),_i("interval","hollow-rect",{draw:function(r,e){var t=Gs(r,!0,!1),i=e,o=r==null?void 0:r.background;if(o){i=e.addGroup();var c=el(r),p=O_(r,this.parsePoints(r.points),this.coordinate);i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},c),{path:p}),zIndex:-1,name:Fn})}var g=this.parsePath(L_(r.points)),_=i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:g}),name:"interval"});return o?i:_},getMarker:function(r){var e=r.color,t=r.isInPolar;return t?{symbol:"circle",style:{r:4.5,stroke:e,fill:null}}:{symbol:"square",style:{r:4,stroke:e,fill:null}}}});function vE(r){var e=r.x,t=r.y,i=r.y0;return(0,b.kJ)(t)?t.map(function(o,c){return{x:(0,b.kJ)(e)?e[c]:e,y:o}}):[{x:e,y:i},{x:e,y:t}]}_i("interval","line",{getPoints:function(r){return vE(r)},draw:function(r,e){var t=Gs(r,!0,!1,"lineWidth"),i=Mu((0,P.pi)({},t),["fill"]),o=this.parsePath(L_(r.points,!1)),c=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},i),{path:o}),name:"interval"});return c},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){return[["M",t,i-o],["L",t,i+o]]},style:{r:5,stroke:e}}}}),_i("interval","pyramid",{getPoints:function(r){return r.size=r.size*2,k_(r)},draw:function(r,e){var t=Gs(r,!1,!0),i=this.parsePath(Ly(r.points,r.nextPoints,!0)),o=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return o},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}});function wM(r){var e,t=r.x,i=r.y,o=r.y0,c=r.size,p,g;(0,b.kJ)(i)?(e=(0,P.CR)(i,2),p=e[0],g=e[1]):(p=o,g=i);var _=t+c/2,S=t-c/2;return[{x:t,y:p},{x:t,y:g},{x:S,y:p},{x:_,y:p},{x:S,y:g},{x:_,y:g}]}function SM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["M",r[4].x,r[4].y],["L",r[5].x,r[5].y]]}_i("interval","tick",{getPoints:function(r){return wM(r)},draw:function(r,e){var t=Gs(r,!0,!1),i=this.parsePath(SM(r.points)),o=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return o},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){return[["M",t-o/2,i-o],["L",t+o/2,i-o],["M",t,i-o],["L",t,i+o],["M",t-o/2,i+o],["L",t+o/2,i+o]]},style:{r:5,stroke:e}}}});var CM=function(r,e,t){var i=r.x,o=r.y,c=e.x,p=e.y,g;switch(t){case"hv":g=[{x:c,y:o}];break;case"vh":g=[{x:i,y:p}];break;case"hvh":var _=(c+i)/2;g=[{x:_,y:o},{x:_,y:p}];break;case"vhv":var S=(o+p)/2;g=[{x:i,y:S},{x:c,y:S}];break;default:break}return g};function AM(r,e){var t=[];return(0,b.S6)(r,function(i,o){var c=r[o+1];if(t.push(i),c){var p=CM(i,c,e);t=t.concat(p)}}),t}function TM(r){return r.map(function(e,t){return t===0?["M",e.x,e.y]:["L",e.x,e.y]})}function gE(r,e){var t=sh(r.points,r.connectNulls,r.showSinglePoint),i=[];return(0,b.S6)(t,function(o){var c=AM(o,e);i=i.concat(TM(c))}),(0,P.pi)((0,P.pi)({},Gs(r,!0,!1,"lineWidth")),{path:i})}(0,b.S6)(["hv","vh","hvh","vhv"],function(r){_i("line",r,{draw:function(e,t){var i=gE(e,r),o=t.addShape({type:"path",attrs:i,name:"line"});return o},getMarker:function(e){return Mh(e,r)}})}),(0,b.S6)(hM,function(r){_i("point",r,{draw:function(e,t){return D_(this,e,t,r,!0)},getMarker:function(e){var t=e.color;return{symbol:yl[r],style:{r:4.5,stroke:t,fill:null}}}})}),_i("point","image",{draw:function(r,e){var t,i,o=Gs(r,!1,!1,"r").r,c=this.parsePoints(r.points),p=c[0];if(r.isStack)p=c[1];else if(c.length>1){var g=e.addGroup();try{for(var _=(0,P.XA)(c),S=_.next();!S.done;S=_.next()){var I=S.value;g.addShape("image",{attrs:{x:I.x-o/2,y:I.y-o,width:o,height:o,img:r.shape[1]}})}}catch(L){t={error:L}}finally{try{S&&!S.done&&(i=_.return)&&i.call(_)}finally{if(t)throw t.error}}return g}return e.addShape("image",{attrs:{x:p.x-o/2,y:p.y-o,width:o,height:o,img:r.shape[1]}})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4.5,fill:e}}}}),(0,b.S6)(R_,function(r){_i("point",r,{draw:function(e,t){return D_(this,e,t,r,!1)},getMarker:function(e){var t=e.color;return{symbol:yl[r]||r,style:{r:4.5,fill:t}}}})});function N_(r){var e=(0,b.kJ)(r)?r:[r],t=e[0],i=e[e.length-1],o=e.length>1?e[1]:t,c=e.length>3?e[3]:i,p=e.length>2?e[2]:o;return{min:t,max:i,min1:o,max1:c,median:p}}function mE(r,e,t){var i=t/2,o;if((0,b.kJ)(e)){var c=N_(e),p=c.min,g=c.max,_=c.median,S=c.min1,I=c.max1,L=r-i,F=r+i;o=[[L,g],[F,g],[r,g],[r,I],[L,S],[L,I],[F,I],[F,S],[r,S],[r,p],[L,p],[F,p],[L,_],[F,_]]}else{e=(0,b.UM)(e)?.5:e;var z=N_(r),p=z.min,g=z.max,_=z.median,S=z.min1,I=z.max1,V=e-i,Q=e+i;o=[[p,V],[p,Q],[p,e],[S,e],[S,V],[S,Q],[I,Q],[I,V],[I,e],[g,e],[g,V],[g,Q],[_,V],[_,Q]]}return o.map(function(st){return{x:st[0],y:st[1]}})}function MM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["M",r[4].x,r[4].y],["L",r[5].x,r[5].y],["L",r[6].x,r[6].y],["L",r[7].x,r[7].y],["L",r[4].x,r[4].y],["Z"],["M",r[8].x,r[8].y],["L",r[9].x,r[9].y],["M",r[10].x,r[10].y],["L",r[11].x,r[11].y],["M",r[12].x,r[12].y],["L",r[13].x,r[13].y]]}_i("schema","box",{getPoints:function(r){var e=r.x,t=r.y,i=r.size;return mE(e,t,i)},draw:function(r,e){var t=Gs(r,!0,!1),i=this.parsePath(MM(r.points)),o=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i,name:"schema"})});return o},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){var c=[i-6,i-3,i,i+3,i+6],p=mE(t,c,o);return[["M",p[0].x+1,p[0].y],["L",p[1].x-1,p[1].y],["M",p[2].x,p[2].y],["L",p[3].x,p[3].y],["M",p[4].x,p[4].y],["L",p[5].x,p[5].y],["L",p[6].x,p[6].y],["L",p[7].x,p[7].y],["L",p[4].x,p[4].y],["Z"],["M",p[8].x,p[8].y],["L",p[9].x,p[9].y],["M",p[10].x+1,p[10].y],["L",p[11].x-1,p[11].y],["M",p[12].x,p[12].y],["L",p[13].x,p[13].y]]},style:{r:6,lineWidth:1,stroke:e}}}});function IM(r){var e=(0,b.kJ)(r)?r:[r],t=e.sort(function(i,o){return o-i});return Hl(t,4,t[t.length-1])}function yE(r,e,t){var i=IM(e);return[{x:r,y:i[0]},{x:r,y:i[1]},{x:r-t/2,y:i[2]},{x:r-t/2,y:i[1]},{x:r+t/2,y:i[1]},{x:r+t/2,y:i[2]},{x:r,y:i[2]},{x:r,y:i[3]}]}function kM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["L",r[4].x,r[4].y],["L",r[5].x,r[5].y],["Z"],["M",r[6].x,r[6].y],["L",r[7].x,r[7].y]]}_i("schema","candle",{getPoints:function(r){var e=r.x,t=r.y,i=r.size;return yE(e,t,i)},draw:function(r,e){var t=Gs(r,!0,!0),i=this.parsePath(kM(r.points)),o=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i,name:"schema"})});return o},getMarker:function(r){var e=r.color;return{symbol:function(t,i,o){var c=[i+7.5,i+3,i-3,i-7.5],p=yE(t,c,o);return[["M",p[0].x,p[0].y],["L",p[1].x,p[1].y],["M",p[2].x,p[2].y],["L",p[3].x,p[3].y],["L",p[4].x,p[4].y],["L",p[5].x,p[5].y],["Z"],["M",p[6].x,p[6].y],["L",p[7].x,p[7].y]]},style:{lineWidth:1,stroke:e,fill:e,r:6}}}});function _E(r,e){var t=Math.abs(r[0].x-r[2].x),i=Math.abs(r[0].y-r[2].y),o=Math.min(t,i);e&&(o=(0,b.uZ)(e,0,Math.min(t,i))),o=o/2;var c=(r[0].x+r[2].x)/2,p=(r[0].y+r[2].y)/2;return{x:c-o,y:p-o,width:o*2,height:o*2}}_i("polygon","square",{draw:function(r,e){if(!(0,b.xb)(r.points)){var t=Gs(r,!0,!0),i=this.parsePoints(r.points);return e.addShape("rect",{attrs:(0,P.pi)((0,P.pi)({},t),_E(i,r.size)),name:"polygon"})}},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}}),_i("violin","smooth",{draw:function(r,e){var t=Gs(r,!0,!0),i=this.parsePath(mv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{stroke:null,r:4,fill:e}}}}),_i("violin","hollow",{draw:function(r,e){var t=Gs(r,!0,!1),i=this.parsePath(gv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:null,stroke:e}}}}),_i("violin","hollow-smooth",{draw:function(r,e){var t=Gs(r,!0,!1),i=this.parsePath(mv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:null,stroke:e}}}});var xE=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelValueDir=function(t){var i="y",o=t.points;return o[0][i]<=o[2][i]?1:-1},e.prototype.getLabelOffsetPoint=function(t,i,o,c){var p,g=r.prototype.getLabelOffsetPoint.call(this,t,i,o),_=this.getCoordinate(),S=_.isTransposed,I=S?"x":"y",L=this.getLabelValueDir(t.mappingData);return g=(0,P.pi)((0,P.pi)({},g),(p={},p[I]=g[I]*L,p)),_.isReflect("x")&&(g=(0,P.pi)((0,P.pi)({},g),{x:g.x*-1})),_.isReflect("y")&&(g=(0,P.pi)((0,P.pi)({},g),{y:g.y*-1})),g},e.prototype.getThemedLabelCfg=function(t){var i=this.geometry,o=this.getDefaultLabelCfg(),c=i.theme;return(0,b.b$)({},o,c.labels,t.position==="middle"?{offset:0}:{},t)},e.prototype.setLabelPosition=function(t,i,o,c){var p=this.getCoordinate(),g=p.isTransposed,_=i.points,S=p.convert(_[0]),I=p.convert(_[2]),L=this.getLabelValueDir(i),F,z,V,Q,st=(0,b.kJ)(i.shape)?i.shape[0]:i.shape;if(st==="funnel"||st==="pyramid"){var at=(0,b.U2)(i,"nextPoints"),Ft=(0,b.U2)(i,"points");if(at){var Kt=p.convert(Ft[0]),ee=p.convert(Ft[1]),Me=p.convert(at[0]),hr=p.convert(at[1]);g?(F=Math.min(Me.y,Kt.y),V=Math.max(Me.y,Kt.y),z=(ee.x+hr.x)/2,Q=(Kt.x+Me.x)/2):(F=Math.min((ee.y+hr.y)/2,(Kt.y+Me.y)/2),V=Math.max((ee.y+hr.y)/2,(Kt.y+Me.y)/2),z=hr.x,Q=Kt.x)}else F=Math.min(I.y,S.y),V=Math.max(I.y,S.y),z=I.x,Q=S.x}else F=Math.min(I.y,S.y),V=Math.max(I.y,S.y),z=I.x,Q=S.x;switch(c){case"right":t.x=z,t.y=(F+V)/2,t.textAlign=(0,b.U2)(t,"textAlign",L>0?"left":"right");break;case"left":t.x=Q,t.y=(F+V)/2,t.textAlign=(0,b.U2)(t,"textAlign",L>0?"left":"right");break;case"bottom":g&&(t.x=(z+Q)/2),t.y=V,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline",L>0?"bottom":"top");break;case"middle":g&&(t.x=(z+Q)/2),t.y=(F+V)/2,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline","middle");break;case"top":g&&(t.x=(z+Q)/2),t.y=F,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline",L>0?"bottom":"top");break;default:break}},e}(To),LM=xE,Fy=Math.PI/2,PM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelOffset=function(t){var i=this.getCoordinate(),o=0;if((0,b.hj)(t))o=t;else if((0,b.HD)(t)&&t.indexOf("%")!==-1){var c=i.getRadius();i.innerRadius>0&&(c=c*(1-i.innerRadius)),o=parseFloat(t)*.01*c}return o},e.prototype.getLabelItems=function(t){var i=r.prototype.getLabelItems.call(this,t),o=this.geometry.getYScale();return(0,b.UI)(i,function(c){if(c&&o){var p=o.scale((0,b.U2)(c.data,o.field));return(0,P.pi)((0,P.pi)({},c),{percent:p})}return c})},e.prototype.getLabelAlign=function(t){var i=this.getCoordinate(),o;if(t.labelEmit)o=t.angle<=Math.PI/2&&t.angle>=-Math.PI/2?"left":"right";else if(!i.isTransposed)o="center";else{var c=i.getCenter(),p=t.offset;Math.abs(t.x-c.x)<1?o="center":t.angle>Math.PI||t.angle<=0?o=p>0?"left":"right":o=p>0?"right":"left"}return o},e.prototype.getLabelPoint=function(t,i,o){var c=1,p,g=t.content[o];this.isToMiddle(i)?p=this.getMiddlePoint(i.points):(t.content.length===1&&o===0?o=1:o===0&&(c=-1),p=this.getArcPoint(i,o));var _=t.offset*c,S=this.getPointAngle(p),I=t.labelEmit,L=this.getCirclePoint(S,_,p,I);return L.r===0?L.content="":(L.content=g,L.angle=S,L.color=i.color),L.rotate=t.autoRotate?this.getLabelRotate(S,_,I):t.rotate,L.start={x:p.x,y:p.y},L},e.prototype.getArcPoint=function(t,i){return i===void 0&&(i=0),!(0,b.kJ)(t.x)&&!(0,b.kJ)(t.y)?{x:t.x,y:t.y}:{x:(0,b.kJ)(t.x)?t.x[i]:t.x,y:(0,b.kJ)(t.y)?t.y[i]:t.y}},e.prototype.getPointAngle=function(t){return lc(this.getCoordinate(),t)},e.prototype.getCirclePoint=function(t,i,o,c){var p=this.getCoordinate(),g=p.getCenter(),_=ku(p,o);if(_===0)return(0,P.pi)((0,P.pi)({},g),{r:_});var S=t;if(p.isTransposed&&_>i&&!c){var I=Math.asin(i/(2*_));S=t+I*2}else _=_+i;return{x:g.x+_*Math.cos(S),y:g.y+_*Math.sin(S),r:_}},e.prototype.getLabelRotate=function(t,i,o){var c=t+Fy;return o&&(c-=Fy),c&&(c>Fy?c=c-Math.PI:c<-Fy&&(c=c+Math.PI)),c},e.prototype.getMiddlePoint=function(t){var i=this.getCoordinate(),o=t.length,c={x:0,y:0};return(0,b.S6)(t,function(p){c.x+=p.x,c.y+=p.y}),c.x/=o,c.y/=o,c=i.convert(c),c},e.prototype.isToMiddle=function(t){return t.x.length>2},e}(To),bE=PM,OM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.defaultLayout="distribute",t}return e.prototype.getDefaultLabelCfg=function(t,i){var o=r.prototype.getDefaultLabelCfg.call(this,t,i);return(0,b.b$)({},o,(0,b.U2)(this.geometry.theme,"pieLabels",{}))},e.prototype.getLabelOffset=function(t){return r.prototype.getLabelOffset.call(this,t)||0},e.prototype.getLabelRotate=function(t,i,o){var c;return i<0&&(c=t,c>Math.PI/2&&(c=c-Math.PI),c<-Math.PI/2&&(c=c+Math.PI)),c},e.prototype.getLabelAlign=function(t){var i=this.getCoordinate(),o=i.getCenter(),c;return t.angle<=Math.PI/2&&t.x>=o.x?c="left":c="right",t.offset<=0&&(c==="right"?c="left":c="right"),c},e.prototype.getArcPoint=function(t){return t},e.prototype.getPointAngle=function(t){var i=this.getCoordinate(),o={x:(0,b.kJ)(t.x)?t.x[0]:t.x,y:t.y[0]},c={x:(0,b.kJ)(t.x)?t.x[1]:t.x,y:t.y[1]},p,g=lc(i,o);if(t.points&&t.points[0].y===t.points[1].y)p=g;else{var _=lc(i,c);g>=_&&(_=_+Math.PI*2),p=g+(_-g)/2}return p},e.prototype.getCirclePoint=function(t,i){var o=this.getCoordinate(),c=o.getCenter(),p=o.getRadius()+i;return(0,P.pi)((0,P.pi)({},cs(c.x,c.y,p,t)),{angle:t,r:p})},e}(bE),EE=OM,z_=4;function FM(r,e,t,i,o,c){var p,g,_=!0,S=i.start,I=i.end,L=Math.min(S.y,I.y),F=Math.abs(S.y-I.y),z,V=0,Q=Number.MIN_VALUE,st=e.map(function(Tr){return Tr.y>V&&(V=Tr.y),Tr.y<Q&&(Q=Tr.y),{size:t,targets:[Tr.y-L]}});for(Q-=L,V-L>F&&(F=V-L);_;)for(st.forEach(function(Tr){var Dr=(Math.min.apply(Q,Tr.targets)+Math.max.apply(Q,Tr.targets))/2;Tr.pos=Math.min(Math.max(Q,Dr-Tr.size/2),F-Tr.size)}),_=!1,z=st.length;z--;)if(z>0){var at=st[z-1],Ft=st[z];at.pos+at.size>Ft.pos&&(at.size+=Ft.size,at.targets=at.targets.concat(Ft.targets),at.pos+at.size>F&&(at.pos=F-at.size),st.splice(z,1),_=!0)}z=0,st.forEach(function(Tr){var Dr=L+t/2;Tr.targets.forEach(function(){e[z].y=Tr.pos+Dr,Dr+=t,z++})});var Kt={};try{for(var ee=(0,P.XA)(r),Me=ee.next();!Me.done;Me=ee.next()){var hr=Me.value;Kt[hr.get("id")]=hr}}catch(Tr){p={error:Tr}}finally{try{Me&&!Me.done&&(g=ee.return)&&g.call(ee)}finally{if(p)throw p.error}}e.forEach(function(Tr){var Dr=Tr.r*Tr.r,cn=Math.pow(Math.abs(Tr.y-o.y),2);if(Dr<cn)Tr.x=o.x;else{var Jr=Math.sqrt(Dr-cn);c?Tr.x=o.x+Jr:Tr.x=o.x-Jr}var Mn=Kt[Tr.id];Mn.attr("x",Tr.x),Mn.attr("y",Tr.y);var mi=(0,b.sE)(Mn.getChildren(),function(da){return da.get("type")==="text"});mi&&(mi.attr("y",Tr.y),mi.attr("x",Tr.x))})}function RM(r,e,t,i){if(!(!r.length||!e.length)){var o=r[0]?r[0].offset:0,c=e[0].get("coordinate"),p=c.getRadius(),g=c.getCenter();if(o>0){var _=14,S=p+o,I=S*2+_*2,L={start:c.start,end:c.end},F=[[],[]];r.forEach(function(z){z&&(z.textAlign==="right"?F[0].push(z):F[1].push(z))}),F.forEach(function(z,V){var Q=I/_;z.length>Q&&(z.sort(function(st,at){return at["..percent"]-st["..percent"]}),z.splice(Q,z.length-Q)),z.sort(function(st,at){return st.y-at.y}),FM(e,z,_,L,g,V)})}(0,b.S6)(r,function(z){if(z&&z.labelLine){var V=z.offset,Q=z.angle,st=cs(g.x,g.y,p,Q),at=cs(g.x,g.y,p+V/2,Q),Ft=z.x+(0,b.U2)(z,"offsetX",0),Kt=z.y+(0,b.U2)(z,"offsetY",0),ee={x:Ft-Math.cos(Q)*z_,y:Kt-Math.sin(Q)*z_};(0,b.Kn)(z.labelLine)||(z.labelLine={}),z.labelLine.path=["M ".concat(st.x),"".concat(st.y," Q").concat(at.x),"".concat(at.y," ").concat(ee.x),ee.y].join(",")}})}}function wE(r,e,t){var i=r.filter(function(V){return!V.invisible});i.sort(function(V,Q){return V.y-Q.y});var o=!0,c=t.minY,p=t.maxY,g=Math.abs(c-p),_,S=0,I=Number.MIN_VALUE,L=i.map(function(V){return V.y>S&&(S=V.y),V.y<I&&(I=V.y),{content:V.content,size:e,targets:[V.y-c],pos:null}});for(I-=c,S-c>g&&(g=S-c);o;)for(L.forEach(function(V){var Q=(Math.min.apply(I,V.targets)+Math.max.apply(I,V.targets))/2;V.pos=Math.min(Math.max(I,Q-V.size/2),g-V.size),V.pos=Math.max(0,V.pos)}),o=!1,_=L.length;_--;)if(_>0){var F=L[_-1],z=L[_];F.pos+F.size>z.pos&&(F.size+=z.size,F.targets=F.targets.concat(z.targets),F.pos+F.size>g&&(F.pos=g-F.size),L.splice(_,1),o=!0)}_=0,L.forEach(function(V){var Q=c+e/2;V.targets.forEach(function(){i[_].y=V.pos+Q,Q+=e,_++})})}var SE=4;function DM(r,e){var t=e.getCenter(),i=e.getRadius();if(r&&r.labelLine){var o=r.angle,c=r.offset,p=cs(t.x,t.y,i,o),g=r.x+(0,b.U2)(r,"offsetX",0)*(Math.cos(o)>0?1:-1),_=r.y+(0,b.U2)(r,"offsetY",0)*(Math.sin(o)>0?1:-1),S={x:g-Math.cos(o)*SE,y:_-Math.sin(o)*SE},I=r.labelLine.smooth,L=[],F=S.x-t.x,z=S.y-t.y,V=Math.atan(z/F);if(F<0&&(V+=Math.PI),I===!1){(0,b.Kn)(r.labelLine)||(r.labelLine={});var Q=0;(o<0&&o>-Math.PI/2||o>Math.PI*1.5)&&S.y>p.y&&(Q=1),o>=0&&o<Math.PI/2&&S.y>p.y&&(Q=1),o>=Math.PI/2&&o<Math.PI&&p.y>S.y&&(Q=1),(o<-Math.PI/2||o>=Math.PI&&o<Math.PI*1.5)&&p.y>S.y&&(Q=1);var st=c/2>4?4:Math.max(c/2-1,0),at=cs(t.x,t.y,i+st,o),Ft=cs(t.x,t.y,i+c/2,V),Kt=0;L.push("M ".concat(p.x," ").concat(p.y)),L.push("L ".concat(at.x," ").concat(at.y)),L.push("A ".concat(t.x," ").concat(t.y," 0 ").concat(Kt," ").concat(Q," ").concat(Ft.x," ").concat(Ft.y)),L.push("L ".concat(S.x," ").concat(S.y))}else{var at=cs(t.x,t.y,i+(c/2>4?4:Math.max(c/2-1,0)),o),ee=p.x<t.x?1:-1;L.push("M ".concat(S.x," ").concat(S.y));var Me=(p.y-t.y)/(p.x-t.x),hr=(S.y-t.y)/(S.x-t.x);Math.abs(Me-hr)>Math.pow(Math.E,-16)&&L.push.apply(L,["C",S.x+ee*4,S.y,2*at.x-p.x,2*at.y-p.y,p.x,p.y]),L.push("L ".concat(p.x," ").concat(p.y))}r.labelLine.path=L.join(" ")}}function CE(r,e,t,i){var o,c,p=(0,b.hX)(r,function(Dr){return!(0,b.UM)(Dr)}),g=e[0]&&e[0].get("coordinate");if(g){var _=g.getCenter(),S=g.getRadius(),I={};try{for(var L=(0,P.XA)(e),F=L.next();!F.done;F=L.next()){var z=F.value;I[z.get("id")]=z}}catch(Dr){o={error:Dr}}finally{try{F&&!F.done&&(c=L.return)&&c.call(L)}finally{if(o)throw o.error}}var V=(0,b.U2)(p[0],"labelHeight",14),Q=(0,b.U2)(p[0],"offset",0);if(!(Q<=0)){var st="left",at="right",Ft=(0,b.vM)(p,function(Dr){return Dr.x<_.x?st:at}),Kt=g.start,ee=g.end,Me=Math.min((S+Q+V)*2,g.getHeight()),hr=Me/2,Tr={minX:Kt.x,maxX:ee.x,minY:_.y-hr,maxY:_.y+hr};(0,b.S6)(Ft,function(Dr,cn){var Jr=Math.floor(Me/V);Dr.length>Jr&&(Dr.sort(function(Mn,mi){return mi.percent-Mn.percent}),(0,b.S6)(Dr,function(Mn,mi){mi+1>Jr&&(I[Mn.id].set("visible",!1),Mn.invisible=!0)})),wE(Dr,V,Tr)}),(0,b.S6)(Ft,function(Dr,cn){(0,b.S6)(Dr,function(Jr){var Mn=cn===at,mi=I[Jr.id],da=mi.getChildByIndex(0);if(da){var Sa=S+Q,eo=Jr.y-_.y,Gn=Math.pow(Sa,2),Vi=Math.pow(eo,2),ua=Gn-Vi>0?Gn-Vi:0,Xi=Math.sqrt(ua),ea=Math.abs(Math.cos(Jr.angle)*Sa);Mn?Jr.x=_.x+Math.max(Xi,ea):Jr.x=_.x-Math.max(Xi,ea)}da&&(da.attr("y",Jr.y),da.attr("x",Jr.x)),DM(Jr,g)})})}}}var Ry=4,AE=4,U_=4;function sg(r,e,t){var i=e.getCenter(),o=e.getRadius(),c={x:r.x-(t?U_:-U_),y:r.y},p=cs(i.x,i.y,o+Ry,r.angle),g={x:c.x,y:c.y},_={x:p.x,y:p.y},S=cs(i.x,i.y,o,r.angle),I="";if(c.y!==p.y){var L=t?4:-4;g.y=c.y,r.angle<0&&r.angle>=-Math.PI/2&&(g.x=Math.max(p.x,c.x-L),c.y<p.y?_.y=g.y:(_.y=p.y,_.x=Math.max(_.x,g.x-L))),r.angle>0&&r.angle<Math.PI/2&&(g.x=Math.max(p.x,c.x-L),c.y>p.y?_.y=g.y:(_.y=p.y,_.x=Math.max(_.x,g.x-L))),r.angle>Math.PI/2&&(g.x=Math.min(p.x,c.x-L),c.y>p.y?_.y=g.y:(_.y=p.y,_.x=Math.min(_.x,g.x-L))),r.angle<-Math.PI/2&&(g.x=Math.min(p.x,c.x-L),c.y<p.y?_.y=g.y:(_.y=p.y,_.x=Math.min(_.x,g.x-L)))}I=["M ".concat(c.x,",").concat(c.y),"L ".concat(g.x,",").concat(g.y),"L ".concat(_.x,",").concat(_.y),"L ".concat(p.x,",").concat(p.y),"L ".concat(S.x,",").concat(S.y)].join(" "),r.labelLine=(0,b.b$)({},r.labelLine,{path:I})}function TE(r,e,t,i){var o,c,p=e[0]&&e[0].get("coordinate");if(p){var g=p.getCenter(),_=p.getRadius(),S={};try{for(var I=(0,P.XA)(e),L=I.next();!L.done;L=I.next()){var F=L.value;S[F.get("id")]=F}}catch(Dr){o={error:Dr}}finally{try{L&&!L.done&&(c=I.return)&&c.call(I)}finally{if(o)throw o.error}}var z=(0,b.U2)(r[0],"labelHeight",14),V=Math.max((0,b.U2)(r[0],"offset",0),Ry);(0,b.S6)(r,function(Dr){if(Dr){var cn=(0,b.U2)(S,[Dr.id]);if(cn){var Jr=Dr.x>g.x||Dr.x===g.x&&Dr.y>g.y,Mn=(0,b.UM)(Dr.offsetX)?AE:Dr.offsetX,mi=cs(g.x,g.y,_+Ry,Dr.angle),da=V+Mn;Dr.x=g.x+(Jr?1:-1)*(_+da),Dr.y=mi.y}}});var Q=p.start,st=p.end,at="left",Ft="right",Kt=(0,b.vM)(r,function(Dr){return Dr.x<g.x?at:Ft}),ee=(_+V)*2+z;(0,b.S6)(Kt,function(Dr){var cn=Dr.length*z;cn>ee&&(ee=Math.min(cn,Math.abs(Q.y-st.y)))});var Me={minX:Q.x,maxX:st.x,minY:g.y-ee/2,maxY:g.y+ee/2};(0,b.S6)(Kt,function(Dr,cn){var Jr=ee/z;Dr.length>Jr&&(Dr.sort(function(Mn,mi){return mi.percent-Mn.percent}),(0,b.S6)(Dr,function(Mn,mi){mi>Jr&&(S[Mn.id].set("visible",!1),Mn.invisible=!0)})),wE(Dr,z,Me)});var hr=Me.minY,Tr=Me.maxY;(0,b.S6)(Kt,function(Dr,cn){var Jr=cn===Ft;(0,b.S6)(Dr,function(Mn){var mi=(0,b.U2)(S,Mn&&[Mn.id]);if(mi){if(Mn.y<hr||Mn.y>Tr){mi.set("visible",!1);return}var da=mi.getChildByIndex(0),Sa=da.getCanvasBBox(),eo={x:Jr?Sa.x:Sa.maxX,y:Sa.y+Sa.height/2};Hu(da,Mn.x-eo.x,Mn.y-eo.y),Mn.labelLine&&sg(Mn,p,Jr)}})})}}function BM(r,e,t,i){(0,b.S6)(e,function(o){var c=i.minX,p=i.minY,g=i.maxX,_=i.maxY,S=o.getCanvasBBox(),I=S.minX,L=S.minY,F=S.maxX,z=S.maxY,V=S.x,Q=S.y,st=S.width,at=S.height,Ft=V,Kt=Q;(I<c||F<c)&&(Ft=c),(L<p||z<p)&&(Kt=p),I>g?Ft=g-st:F>g&&(Ft=Ft-(F-g)),L>_?Kt=_-at:z>_&&(Kt=Kt-(z-_)),(Ft!==V||Kt!==Q)&&Hu(o,Ft-V,Kt-Q)})}function ME(r,e,t,i){(0,b.S6)(e,function(o,c){var p=o.getCanvasBBox(),g=t[c].getBBox();(p.minX<g.minX||p.minY<g.minY||p.maxX>g.maxX||p.maxY>g.maxY)&&o.remove(!0)})}var IE=100,kE=function(){function r(e){e===void 0&&(e={}),this.bitmap={};var t=e.xGap,i=t===void 0?1:t,o=e.yGap,c=o===void 0?8:o;this.xGap=i,this.yGap=c}return r.prototype.hasGap=function(e){for(var t=!0,i=this.bitmap,o=Math.round(e.minX),c=Math.round(e.maxX),p=Math.round(e.minY),g=Math.round(e.maxY),_=o;_<=c;_+=1){if(!i[_]){i[_]={};continue}if(_===o||_===c){for(var S=p;S<=g;S++)if(i[_][S]){t=!1;break}}else if(i[_][p]||i[_][g]){t=!1;break}}return t},r.prototype.fillGap=function(e){for(var t=this.bitmap,i=Math.round(e.minX),o=Math.round(e.maxX),c=Math.round(e.minY),p=Math.round(e.maxY),g=i;g<=o;g+=1)t[g]||(t[g]={});for(var g=i;g<=o;g+=this.xGap){for(var _=c;_<=p;_+=this.yGap)t[g][_]=!0;t[g][p]=!0}if(this.yGap!==1)for(var g=c;g<=p;g+=1)t[i][g]=!0,t[o][g]=!0;if(this.xGap!==1)for(var g=i;g<=o;g+=1)t[g][c]=!0,t[g][p]=!0},r.prototype.destroy=function(){this.bitmap={}},r}();function NM(r,e,t){t===void 0&&(t=IE);var i=-1,o=r.attr(),c=o.x,p=o.y,g=r.getCanvasBBox(),_=Math.sqrt(g.width*g.width+g.height*g.height),S,I=-i,L=0,F=0,z=function(at){var Ft=at*.1;return[Ft*Math.cos(Ft),Ft*Math.sin(Ft)]};if(e.hasGap(g))return e.fillGap(g),!0;for(var V=!1,Q=0,st={};Math.min(Math.abs(L),Math.abs(F))<_&&Q<t;)if(S=z(I+=i),L=~~S[0],F=~~S[1],!(!L&&!F||st["".concat(L,"-").concat(F)])&&(r.attr({x:c+L,y:p+F}),L+F<0&&r.attr("textAlign","right"),Q++,e.hasGap(r.getCanvasBBox()))){e.fillGap(r.getCanvasBBox()),V=!0,st["".concat(L,"-").concat(F)]=!0;break}return V}function zM(r,e,t,i){var o=r.getCanvasBBox(),c=o.width,p=o.height,g={x:e,y:t,textAlign:"center"};switch(i){case 0:g.y-=p+1,g.x+=1,g.textAlign="left";break;case 1:g.y-=p+1,g.x-=1,g.textAlign="right";break;case 2:g.y+=p+1,g.x-=1,g.textAlign="right";break;case 3:g.y+=p+1,g.x+=1,g.textAlign="left";break;case 5:g.y-=p*2+2;break;case 6:g.y+=p*2+2;break;case 7:g.x+=c+1,g.textAlign="left";break;case 8:g.x-=c+1,g.textAlign="right";break;default:break}return r.attr(g),r.getCanvasBBox()}function LE(r,e,t,i){var o=new kE;(0,b.S6)(e,function(c){var p=c.find(function(g){return g.get("type")==="text"});NM(p,o)||c.remove(!0)}),o.destroy()}function PE(r,e,t,i){var o=new kE;(0,b.S6)(e,function(c){for(var p=c.find(function(z){return z.get("type")==="text"}),g=p.attr(),_=g.x,S=g.y,I=!1,L=0;L<=8;L++){var F=zM(p,_,S,L);if(o.hasGap(F)){o.fillGap(F),I=!0;break}}I||c.remove(!0)}),o.destroy()}function OE(r,e){return(r[0]||0)*(e[0]||0)+(r[1]||0)*(e[1]||0)+(r[2]||0)*(e[2]||0)}function Dy(r){if(r.length>4)return[];var e=function(o,c){return[c.x-o.x,c.y-o.y]},t=e(r[0],r[1]),i=e(r[1],r[2]);return[t,i]}function Qg(r,e,t){e===void 0&&(e=0),t===void 0&&(t={x:0,y:0});var i=r.x,o=r.y;return{x:(i-t.x)*Math.cos(-e)+(o-t.y)*Math.sin(-e)+t.x,y:(t.x-i)*Math.sin(-e)+(o-t.y)*Math.cos(-e)+t.y}}function FE(r){var e=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],t=r.rotation;return t?[Qg(e[0],t,e[0]),Qg(e[1],t,e[0]),Qg(e[2],t,e[0]),Qg(e[3],t,e[0])]:e}function RE(r,e){if(r.length>4)return{min:0,max:0};var t=[];return r.forEach(function(i){t.push(OE([i.x,i.y],e))}),{min:Math.min.apply(Math,(0,P.ev)([],(0,P.CR)(t),!1)),max:Math.max.apply(Math,(0,P.ev)([],(0,P.CR)(t),!1))}}function UM(r,e){return r.max>e.min&&r.min<e.max}function DE(r){return typeof r=="number"&&!Number.isNaN(r)&&r!==1/0&&r!==-1/0}function BE(r){return["x","y","width","height"].every(function(e){return DE(r[e])})}function NE(r,e,t){return t===void 0&&(t=0),!(e.x>r.x+r.width+t||e.x+e.width<r.x-t||e.y>r.y+r.height+t||e.y+e.height<r.y-t)}function ZM(r,e,t){if(t===void 0&&(t=0),!BE(r)||!BE(e))return!1;if(!r.rotation&&!e.rotation)return NE(r,e,t);for(var i=FE(r),o=FE(e),c=Dy(i).concat(Dy(o)),p=0;p<c.length;p++){var g=c[p],_=RE(i,g),S=RE(o,g);if(!UM(_,S))return!1}return!0}var VM=function(){function r(e){var t=this;this.queue=[],this.worker=new Worker(e),this.worker.onmessage=function(i){var o;(o=t.queue.shift())===null||o===void 0||o.resolve(i)},this.worker.onmessageerror=function(i){var o;console.warn("[AntV G2] Web worker is not available"),(o=t.queue.shift())===null||o===void 0||o.reject(i)}}return r.prototype.post=function(e,t){var i=this;return new Promise(function(o,c){i.queue.push({resolve:o,reject:c});try{i.worker.postMessage(e)}catch(p){console.warn("[AntV G2] Web worker is not available"),(0,b.mf)(t)&&t()}})},r.prototype.destroy=function(){this.worker.terminate()},r}();function Jg(r){if(typeof window!="undefined"){var e;try{e=new Blob([r.toString()],{type:"application/javascript"})}catch(t){e=new window.BlobBuilder,e.append(r.toString()),e=e.getBlob()}return new VM(URL.createObjectURL(e))}}var zE=function(r){function e(){function S(Kt,ee){return(Kt[0]||0)*(ee[0]||0)+(Kt[1]||0)*(ee[1]||0)+(Kt[2]||0)*(ee[2]||0)}function I(Kt){if(Kt.length>4)return[];var ee=function(Tr,Dr){return[Dr.x-Tr.x,Dr.y-Tr.y]},Me=ee(Kt[0],Kt[1]),hr=ee(Kt[1],Kt[2]);return[Me,hr]}function L(Kt,ee,Me){ee===void 0&&(ee=0),Me===void 0&&(Me={x:0,y:0});var hr=Kt.x,Tr=Kt.y;return{x:(hr-Me.x)*Math.cos(-ee)+(Tr-Me.y)*Math.sin(-ee)+Me.x,y:(Me.x-hr)*Math.sin(-ee)+(Tr-Me.y)*Math.cos(-ee)+Me.y}}function F(Kt){var ee=[{x:Kt.x,y:Kt.y},{x:Kt.x+Kt.width,y:Kt.y},{x:Kt.x+Kt.width,y:Kt.y+Kt.height},{x:Kt.x,y:Kt.y+Kt.height}],Me=Kt.rotation;return Me?[L(ee[0],Me,ee[0]),L(ee[1],Me,ee[0]),L(ee[2],Me,ee[0]),L(ee[3],Me,ee[0])]:ee}function z(Kt,ee){if(Kt.length>4)return{min:0,max:0};var Me=[];return Kt.forEach(function(hr){Me.push(S([hr.x,hr.y],ee))}),{min:Math.min.apply(null,Me),max:Math.max.apply(null,Me)}}function V(Kt,ee){return Kt.max>ee.min&&Kt.min<ee.max}function Q(Kt){return typeof Kt=="number"&&!Number.isNaN(Kt)&&Kt!==1/0&&Kt!==-1/0}function st(Kt){return["x","y","width","height"].every(function(ee){return Q(Kt[ee])})}function at(Kt,ee,Me){return Me===void 0&&(Me=0),!(ee.x>Kt.x+Kt.width+Me||ee.x+ee.width<Kt.x-Me||ee.y>Kt.y+Kt.height+Me||ee.y+ee.height<Kt.y-Me)}function Ft(Kt,ee,Me){if(Me===void 0&&(Me=0),!st(Kt)||!st(ee))return!1;if(!Kt.rotation&&!ee.rotation)return at(Kt,ee,Me);for(var hr=F(Kt),Tr=F(ee),Dr=I(hr).concat(I(Tr)),cn=0;cn<Dr.length;cn++){var Jr=Dr[cn],Mn=z(hr,Jr),mi=z(Tr,Jr);if(!V(Mn,mi))return!1}return!0}return{intersect:Ft}}var t=e().intersect;function i(S){for(var I=S.slice(),L=0;L<I.length;L++){var F=I[L];if(F.visible)for(var z=L+1;z<I.length;z++){var V=I[z];F!==V&&V.visible&&t(F,V)&&(V.visible=!1)}}return I}var o={"hide-overlap":i};try{var c=JSON.parse(r.data);if(!c||!c.type||!o[c.type])return;var p=c.type,g=c.items,_=o[p](g);self.postMessage(_)}catch(S){throw S}},Z_=`
   self.onmessage = `.concat(zE.toString(),`
`),UE=function(r){for(var e=r.slice(),t=0;t<e.length;t++){var i=e[t];if(i.visible)for(var o=t+1;o<e.length;o++){var c=e[o];i!==c&&c.visible&&ZM(i,c)&&(c.visible=!1)}}return e},cf=new Map,ZE=Jg(Z_);function GM(r,e,t,i){return(0,P.mG)(this,void 0,void 0,function(){var o,c,p,g,_,S;return(0,P.Jh)(this,function(I){switch(I.label){case 0:return o=e.map(function(L,F){return(0,P.pi)((0,P.pi)({},hs(L,r[F],(0,b.U2)(r[F],"background.padding"))),{visible:!0})}),c=JSON.stringify(o),p=function(L){return cf.set(c,L),(0,b.S6)(L,function(F,z){var V=F.visible,Q=e[z];V?Q==null||Q.show():Q==null||Q.hide()}),L},cf.get(c)?(p(cf.get(c)),[3,7]):[3,1];case 1:if(!ZE)return[3,6];I.label=2;case 2:return I.trys.push([2,4,,5]),g=JSON.stringify({type:"hide-overlap",items:o}),[4,ZE.post(g,function(){return p(UE(o))})];case 3:return _=I.sent(),p(Array.isArray(_.data)?_.data:[]),[3,5];case 4:return S=I.sent(),console.error(S),p(UE(o)),[3,5];case 5:return[3,7];case 6:p(UE(o)),I.label=7;case 7:return[2]}})})}var tm={"#5B8FF9":!0},HM=function(r){var e=_a.toRGB(r).toUpperCase();if(tm[e])return tm[e];var t=(0,P.CR)(_a.rgb2arr(e),3),i=t[0],o=t[1],c=t[2],p=(i*299+o*587+c*114)/1e3<128;return p};function EO(r,e,t){if(t.length!==0){var i=t[0].get("element"),o=i.geometry.theme,c=o.labels||{},p=c.fillColorLight,g=c.fillColorDark;t.forEach(function(_,S){var I=e[S],L=I.find(function(at){return at.get("type")==="text"}),F=Iu.fromObject(_.getBBox()),z=Iu.fromObject(L.getCanvasBBox()),V=!F.contains(z),Q=_.attr("fill"),st=HM(Q);V?L.attr(o.overflowLabels.style):st?p&&L.attr("fill",p):g&&L.attr("fill",g)})}}function jM(r,e,t){var i=r.coordinate,o=qa(e),c=Iu.fromObject(o.getCanvasBBox()),p=Iu.fromObject(t.getBBox());return i.isTransposed?p.height>=c.height:p.width>=c.width}function wO(r,e,t){var i=!!r.getAdjust("stack");return i||e.every(function(o,c){var p=t[c];return jM(r,o,p)})}function WM(r,e,t){var i=r.coordinate,o=Iu.fromObject(t.getBBox()),c=qa(e);i.isTransposed?c.attr({x:o.minX+o.width/2,textAlign:"center"}):c.attr({y:o.minY+o.height/2,textBaseline:"middle"})}function SO(r,e,t){var i;if(t.length!==0){var o=(i=t[0])===null||i===void 0?void 0:i.get("element"),c=o==null?void 0:o.geometry;if(!(!c||c.type!=="interval")){var p=wO(c,e,t);p&&t.forEach(function(g,_){var S=e[_];WM(c,S,g)})}}}function XM(r){var e=500,t=[],i=Math.max(Math.floor(r.length/e),1);return(0,b.S6)(r,function(o,c){c%i===0?t.push(o):o.set("visible",!1)}),t}function YM(r,e,t){var i;if(t.length!==0){var o=(i=t[0])===null||i===void 0?void 0:i.get("element"),c=o==null?void 0:o.geometry;if(!(!c||c.type!=="interval")){var p=XM(e),g=(0,P.CR)(c.getXYFields(),1),_=g[0],S=[],I=[],L=(0,b.vM)(p,function(st){return st.get("data")[_]}),F=(0,b.jj)((0,b.UI)(p,function(st){return st.get("data")[_]})),z;p.forEach(function(st){st.set("visible",!0)});var V=function(st){st&&(st.length&&I.push(st.pop()),I.push.apply(I,(0,P.ev)([],(0,P.CR)(st),!1)))};for((0,b.dp)(F)>0&&(z=F.shift(),V(L[z])),(0,b.dp)(F)>0&&(z=F.pop(),V(L[z])),(0,b.S6)(F.reverse(),function(st){V(L[st])});I.length>0;){var Q=I.shift();Q.get("visible")&&(Po(Q,S)?Q.set("visible",!1):S.push(Q))}}}}function CO(r,e){var t=r.getXYFields()[1],i=[],o=e.sort(function(c,p){return c.get("data")[t]-c.get("data")[t]});return o.length>0&&i.push(o.shift()),o.length>0&&i.push(o.pop()),i.push.apply(i,(0,P.ev)([],(0,P.CR)(o),!1)),i}function $M(r,e,t){return r.some(function(i){return t(i,e)})}function AO(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),o=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*o}function VE(r,e){return $M(r,e,function(t,i){var o=qa(t),c=qa(i);return AO(o.getCanvasBBox(),c.getCanvasBBox(),2)>0})}function GE(r,e,t,i,o){var c,p;if(t.length!==0){var g=(c=t[0])===null||c===void 0?void 0:c.get("element"),_=g==null?void 0:g.geometry;if(!(!_||_.type!=="point")){var S=(0,P.CR)(_.getXYFields(),2),I=S[0],L=S[1],F=(0,b.vM)(e,function(Q){return Q.get("data")[I]}),z=[],V=o&&o.offset||((p=r[0])===null||p===void 0?void 0:p.offset)||12;(0,b.UI)((0,b.XP)(F).reverse(),function(Q){for(var st=CO(_,F[Q]);st.length;){var at=st.shift(),Ft=qa(at);if($M(z,at,function(Me,hr){return Me.get("data")[I]===hr.get("data")[I]&&Me.get("data")[L]===hr.get("data")[L]})){Ft.set("visible",!1);continue}var Kt=VE(z,at),ee=!1;if(Kt&&(Ft.attr("y",Ft.attr("y")+2*V),ee=VE(z,at)),ee){Ft.set("visible",!1);continue}z.push(at)}})}}}function TO(r,e){var t=r.getXYFields()[1],i=[],o=e.sort(function(c,p){return c.get("data")[t]-c.get("data")[t]});return o.length>0&&i.push(o.shift()),o.length>0&&i.push(o.pop()),i.push.apply(i,(0,P.ev)([],(0,P.CR)(o),!1)),i}function HE(r,e,t){return r.some(function(i){return t(i,e)})}function MO(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),o=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*o}function jE(r,e){return HE(r,e,function(t,i){var o=qa(t),c=qa(i);return MO(o.getCanvasBBox(),c.getCanvasBBox(),2)>0})}function IO(r,e,t,i,o){var c,p;if(t.length!==0){var g=(c=t[0])===null||c===void 0?void 0:c.get("element"),_=g==null?void 0:g.geometry;if(!(!_||["path","line","area"].indexOf(_.type)<0)){var S=(0,P.CR)(_.getXYFields(),2),I=S[0],L=S[1],F=(0,b.vM)(e,function(Q){return Q.get("data")[I]}),z=[],V=o&&o.offset||((p=r[0])===null||p===void 0?void 0:p.offset)||12;(0,b.UI)((0,b.XP)(F).reverse(),function(Q){for(var st=TO(_,F[Q]);st.length;){var at=st.shift(),Ft=qa(at);if(HE(z,at,function(Me,hr){return Me.get("data")[I]===hr.get("data")[I]&&Me.get("data")[L]===hr.get("data")[L]})){Ft.set("visible",!1);continue}var Kt=jE(z,at),ee=!1;if(Kt&&(Ft.attr("y",Ft.attr("y")+2*V),ee=jE(z,at)),ee){Ft.set("visible",!1);continue}z.push(at)}})}}}var V_;function qM(){return V_||(V_=document.createElement("canvas").getContext("2d")),V_}var By=(0,b.HP)(function(r,e){e===void 0&&(e={});var t=e.fontSize,i=e.fontFamily,o=e.fontWeight,c=e.fontStyle,p=e.fontVariant,g=qM();return g.font=[c,p,o,"".concat(t,"px"),i].join(" "),g.measureText((0,b.HD)(r)?r:"").width},function(r,e){return e===void 0&&(e={}),(0,P.ev)([r],(0,P.CR)((0,b.VO)(e)),!1).join("")}),Ny=function(r,e,t){var i=16,o=By("...",t),c;(0,b.HD)(r)?c=r:c=(0,b.BB)(r);var p=e,g=[],_,S;if(By(r,t)<=e)return r;for(;_=c.substr(0,i),S=By(_,t),!(S+o>p&&S>p);)if(g.push(_),p-=S,c=c.substr(i),!c)return g.join("");for(;_=c.substr(0,1),S=By(_,t),!(S+o>p);)if(g.push(_),p-=S,c=c.substr(1),!c)return g.join("");return"".concat(g.join(""),"...")};function kO(r,e,t,i,o){if(!(e.length<=0)){var c=(o==null?void 0:o.direction)||["top","right","bottom","left"],p=(o==null?void 0:o.action)||"translate",g=(o==null?void 0:o.margin)||0,_=e[0].get("coordinate");if(_){var S=r0(_,g),I=S.minX,L=S.minY,F=S.maxX,z=S.maxY;(0,b.S6)(e,function(V){var Q=V.getCanvasBBox(),st=Q.minX,at=Q.minY,Ft=Q.maxX,Kt=Q.maxY,ee=Q.x,Me=Q.y,hr=Q.width,Tr=Q.height,Dr=ee,cn=Me;if(c.indexOf("left")>=0&&(st<I||Ft<I)&&(Dr=I),c.indexOf("top")>=0&&(at<L||Kt<L)&&(cn=L),c.indexOf("right")>=0&&(st>F?Dr=F-hr:Ft>F&&(Dr=Dr-(Ft-F))),c.indexOf("bottom")>=0&&(at>z?cn=z-Tr:Kt>z&&(cn=cn-(Kt-z))),Dr!==ee||cn!==Me){var Jr=Dr-ee;if(p==="translate")Hu(V,Jr,cn-Me);else if(p==="ellipsis"){var Mn=V.findAll(function(mi){return mi.get("type")==="text"});Mn.forEach(function(mi){var da=(0,b.ei)(mi.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),Sa=mi.getCanvasBBox(),eo=Ny(mi.attr("text"),Sa.width-Math.abs(Jr),da);mi.attr("text",eo)})}else V.hide()}})}}}function LO(r,e,t){var i={fillOpacity:(0,b.UM)(r.attr("fillOpacity"))?1:r.attr("fillOpacity"),strokeOpacity:(0,b.UM)(r.attr("strokeOpacity"))?1:r.attr("strokeOpacity"),opacity:(0,b.UM)(r.attr("opacity"))?1:r.attr("opacity")};r.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),r.animate(i,e)}function cp(r,e,t){var i={fillOpacity:0,strokeOpacity:0,opacity:0},o=e.easing,c=e.duration,p=e.delay;r.animate(i,c,o,function(){r.remove(!0)},p)}function Os(r,e,t){var i,o=(0,P.CR)(e,2),c=o[0],p=o[1];return r.applyToMatrix([c,p,1]),t==="x"?(r.setMatrix(ro.vs(r.getMatrix(),[["t",-c,-p],["s",.01,1],["t",c,p]])),i=ro.vs(r.getMatrix(),[["t",-c,-p],["s",100,1],["t",c,p]])):t==="y"?(r.setMatrix(ro.vs(r.getMatrix(),[["t",-c,-p],["s",1,.01],["t",c,p]])),i=ro.vs(r.getMatrix(),[["t",-c,-p],["s",1,100],["t",c,p]])):t==="xy"&&(r.setMatrix(ro.vs(r.getMatrix(),[["t",-c,-p],["s",.01,.01],["t",c,p]])),i=ro.vs(r.getMatrix(),[["t",-c,-p],["s",100,100],["t",c,p]])),i}function Gp(r,e,t,i,o){var c=t.start,p=t.end,g=t.getWidth(),_=t.getHeight(),S,I;o==="y"?(S=c.x+g/2,I=i.y<c.y?i.y:c.y):o==="x"?(S=i.x>c.x?i.x:c.x,I=c.y+_/2):o==="xy"&&(t.isPolar?(S=t.getCenter().x,I=t.getCenter().y):(S=(c.x+p.x)/2,I=(c.y+p.y)/2));var L=Os(r,[S,I],o);r.animate({matrix:L},e)}function ta(r,e,t){var i=t.coordinate,o=t.minYPoint;Gp(r,e,i,o,"x")}function fp(r,e,t){var i=t.coordinate,o=t.minYPoint;Gp(r,e,i,o,"y")}function G_(r,e,t){var i=t.coordinate,o=t.minYPoint;Gp(r,e,i,o,"xy")}function w0(r,e,t){var i=r.getTotalLength();r.attr("lineDash",[i]),r.animate(function(o){return{lineDashOffset:(1-o)*i}},e)}function zy(r,e,t){var i=t.toAttrs,o=i.x,c=i.y;delete i.x,delete i.y,r.attr(i),r.animate({x:o,y:c},e)}function KM(r,e,t){var i=r.getBBox(),o=r.get("origin").mappingData,c=o.points,p=c[0].y-c[1].y>0?i.maxX:i.minX,g=(i.minY+i.maxY)/2;r.applyToMatrix([p,g,1]);var _=ro.vs(r.getMatrix(),[["t",-p,-g],["s",.01,1],["t",p,g]]);r.setMatrix(_),r.animate({matrix:ro.vs(r.getMatrix(),[["t",-p,-g],["s",100,1],["t",p,g]])},e)}function QM(r,e,t){var i=r.getBBox(),o=r.get("origin").mappingData,c=(i.minX+i.maxX)/2,p=o.points,g=p[0].y-p[1].y<=0?i.maxY:i.minY;r.applyToMatrix([c,g,1]);var _=ro.vs(r.getMatrix(),[["t",-c,-g],["s",1,.01],["t",c,g]]);r.setMatrix(_),r.animate({matrix:ro.vs(r.getMatrix(),[["t",-c,-g],["s",1,100],["t",c,g]])},e)}function Uy(r,e){var t,i=Pd(r,e),o=i.startAngle,c=i.endAngle;return!(0,b.vQ)(o,-Math.PI*.5)&&o<-Math.PI*.5&&(o+=Math.PI*2),!(0,b.vQ)(c,-Math.PI*.5)&&c<-Math.PI*.5&&(c+=Math.PI*2),e[5]===0&&(t=(0,P.CR)([c,o],2),o=t[0],c=t[1]),(0,b.vQ)(o,Math.PI*1.5)&&(o=Math.PI*-.5),(0,b.vQ)(c,Math.PI*-.5)&&!(0,b.vQ)(o,c)&&(c=Math.PI*1.5),{startAngle:o,endAngle:c}}function WE(r){var e;return r[0]==="M"||r[0]==="L"?e=[r[1],r[2]]:(r[0]==="a"||r[0]==="A"||r[0]==="C")&&(e=[r[r.length-2],r[r.length-1]]),e}function H_(r){var e,t,i,o=r.filter(function(Kt){return Kt[0]==="A"||Kt[0]==="a"});if(o.length===0)return{startAngle:0,endAngle:0,radius:0,innerRadius:0};var c=o[0],p=o.length>1?o[1]:o[0],g=r.indexOf(c),_=r.indexOf(p),S=WE(r[g-1]),I=WE(r[_-1]),L=Uy(S,c),F=L.startAngle,z=L.endAngle,V=Uy(I,p),Q=V.startAngle,st=V.endAngle;(0,b.vQ)(F,Q)&&(0,b.vQ)(z,st)?(t=F,i=z):(t=Math.min(F,Q),i=Math.max(z,st));var at=c[1],Ft=o[o.length-1][1];return at<Ft?(e=(0,P.CR)([Ft,at],2),at=e[0],Ft=e[1]):at===Ft&&(Ft=0),{startAngle:t,endAngle:i,radius:at,innerRadius:Ft}}function JM(r,e,t){var i=t.toAttrs,o=t.coordinate,c=i.path||[],p=c.map(function(Ft){return Ft[0]});if(!(c.length<1)){var g=H_(c),_=g.startAngle,S=g.endAngle,I=g.radius,L=g.innerRadius,F=H_(r.attr("path")),z=F.startAngle,V=F.endAngle,Q=o.getCenter(),st=_-z,at=S-V;if(st===0&&at===0){r.attr("path",c);return}r.animate(function(Ft){var Kt=z+Ft*st,ee=V+Ft*at;return(0,P.pi)((0,P.pi)({},i),{path:(0,b.Xy)(p,["M","A","A","Z"])?e0(Q.x,Q.y,I,Kt,ee):sl(Q.x,Q.y,I,Kt,ee,L)})},(0,P.pi)((0,P.pi)({},e),{callback:function(){r.attr("path",c)}}))}}function t3(r,e,t){var i=Yh(t.coordinate,20),o=i.type,c=i.startState,p=i.endState,g=r.setClip({type:o,attrs:c});t.toAttrs&&r.attr(t.toAttrs),g.animate(p,(0,P.pi)((0,P.pi)({},e),{callback:function(){r&&!r.get("destroyed")&&r.set("clipShape",null),g.remove(!0)}}))}function XE(r,e,t){if(r.isGroup())(0,b.S6)(r.getChildren(),function(g){XE(g,e,t)});else{var i=r.getBBox(),o=(i.minX+i.maxX)/2,c=(i.minY+i.maxY)/2;if(r.applyToMatrix([o,c,1]),t==="zoomIn"){var p=ro.vs(r.getMatrix(),[["t",-o,-c],["s",.01,.01],["t",o,c]]);r.setMatrix(p),r.animate({matrix:ro.vs(r.getMatrix(),[["t",-o,-c],["s",100,100],["t",o,c]])},e)}else r.animate({matrix:ro.vs(r.getMatrix(),[["t",-o,-c],["s",.01,.01],["t",o,c]])},(0,P.pi)((0,P.pi)({},e),{callback:function(){r.remove(!0)}}))}}function PO(r,e,t){XE(r,e,"zoomIn")}function e3(r,e,t){XE(r,e,"zoomOut")}function zd(r){return[le.TOP,le.BOTTOM].includes(r)?{offsetX:0,offsetY:r===le.TOP?-8:8,style:{textAlign:"center",textBaseline:r===le.TOP?"bottom":"top"}}:[le.LEFT,le.RIGHT].includes(r)?{offsetX:r===le.LEFT?-8:8,offsetY:0,style:{textAlign:r===le.LEFT?"right":"left",textBaseline:"middle",rotate:Math.PI/2}}:{}}function Ud(r,e,t){return{x:r.x+e*Math.cos(t),y:r.y+e*Math.sin(t)}}var r3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"circle",showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.getRegion=function(t,i){var o=.5,c={x:.5,y:.5},p=Math.PI*2/t,g=-1*Math.PI/2+p*i,_=o/(1+1/Math.sin(p/2)),S=Ud(c,o-_,g),I=Math.PI*5/4,L=Math.PI*1/4;return{start:Ud(S,_,I),end:Ud(S,_,L)}},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){var i=this,o=this.cfg,c=o.fields,p=o.type,g=(0,P.CR)(c,1),_=g[0];if(!_)throw new Error("No `fields` specified!");var S=this.getFieldValues(t,_),I=S.length,L=[];return S.forEach(function(F,z){var V=[{field:_,value:F,values:S}],Q=(0,b.hX)(t,i.getFacetDataFilter(V)),st={type:p,data:Q,region:i.getRegion(I,z),columnValue:F,columnField:_,columnIndex:z,columnValuesLength:I,rowValue:null,rowField:null,rowIndex:0,rowValuesLength:1};L.push(st)}),L},e.prototype.getXAxisOption=function(t,i,o,c){return o},e.prototype.getYAxisOption=function(t,i,o,c){return o},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var o=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(o):o},zd(le.TOP),t.cfg.title);c.annotation().text(g)})},e}(cc),n3=r3,Zy=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"list",cols:null,showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){var i=this,o=this.cfg.fields,c=this.cfg.cols,p=(0,P.CR)(o,1),g=p[0];if(!g)throw new Error("No `fields` specified!");var _=this.getFieldValues(t,g),S=_.length;c=c||S;var I=this.getPageCount(S,c),L=[];return _.forEach(function(F,z){var V=i.getRowCol(z,c),Q=V.row,st=V.col,at=[{field:g,value:F,values:_}],Ft=(0,b.hX)(t,i.getFacetDataFilter(at)),Kt={type:i.cfg.type,data:Ft,region:i.getRegion(I,c,st,Q),columnValue:F,rowValue:F,columnField:g,rowField:null,columnIndex:st,rowIndex:Q,columnValuesLength:c,rowValuesLength:I,total:S};L.push(Kt)}),L},e.prototype.getXAxisOption=function(t,i,o,c){return c.rowIndex!==c.rowValuesLength-1&&c.columnValuesLength*c.rowIndex+c.columnIndex+1+c.columnValuesLength<=c.total?(0,P.pi)((0,P.pi)({},o),{label:null,title:null}):o},e.prototype.getYAxisOption=function(t,i,o,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},o),{title:null,label:null}):o},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var o=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(o):o},zd(le.TOP),t.cfg.title);c.annotation().text(g)})},e.prototype.getPageCount=function(t,i){return Math.floor((t+i-1)/i)},e.prototype.getRowCol=function(t,i){var o=Math.floor(t/i),c=t%i;return{row:o,col:c}},e}(cc),i3=Zy,a3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"matrix",showTitle:!1,columnTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this)),rowTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this))})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){for(var i=this.cfg,o=i.fields,c=i.type,p=o.length,g=p,_=[],S=0;S<g;S++)for(var I=o[S],L=0;L<p;L++){var F=o[L],z={type:c,data:t,region:this.getRegion(p,g,S,L),columnValue:I,rowValue:F,columnField:I,rowField:F,columnIndex:S,rowIndex:L,columnValuesLength:g,rowValuesLength:p};_.push(z)}return _},e.prototype.getXAxisOption=function(t,i,o,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},o),{label:null,title:null}):o},e.prototype.getYAxisOption=function(t,i,o,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},o),{title:null,label:null}):o},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,o){var c=i.columnIndex,p=i.rowIndex,g=i.columnValuesLength,_=i.rowValuesLength,S=i.columnValue,I=i.rowValue,L=i.view;if(p===0){var F=(0,b.U2)(t.cfg.columnTitle,"formatter"),z=(0,b.b$)({position:["50%","0%"],content:F?F(S):S},zd(le.TOP),t.cfg.columnTitle);L.annotation().text(z)}if(c===g-1){var F=(0,b.U2)(t.cfg.rowTitle,"formatter"),z=(0,b.b$)({position:["100%","50%"],content:F?F(I):I},zd(le.RIGHT),t.cfg.rowTitle);L.annotation().text(z)}})},e}(cc),YE=a3,o3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"mirror",showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this),transpose:!1})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.beforeEachView=function(t,i){this.cfg.transpose?i.columnIndex%2===0?t.coordinate().transpose().reflect("x"):t.coordinate().transpose():i.rowIndex%2!==0&&t.coordinate().reflect("y")},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.generateFacets=function(t){var i=this,o=(0,P.CR)(this.cfg.fields,1),c=o[0],p=[],g=1,_=1,S=[""],I=[""],L,F;return this.cfg.transpose?(L=c,S=this.getFieldValues(t,L).slice(0,2),g=S.length):(F=c,I=this.getFieldValues(t,F).slice(0,2),_=I.length),S.forEach(function(z,V){I.forEach(function(Q,st){var at=[{field:L,value:z,values:S},{field:F,value:Q,values:I}],Ft=(0,b.hX)(t,i.getFacetDataFilter(at)),Kt={type:i.cfg.type,data:Ft,region:i.getRegion(_,g,V,st),columnValue:z,rowValue:Q,columnField:L,rowField:F,columnIndex:V,rowIndex:st,columnValuesLength:g,rowValuesLength:_};p.push(Kt)})}),p},e.prototype.getXAxisOption=function(t,i,o,c){return c.columnIndex===1||c.rowIndex===1?(0,P.pi)((0,P.pi)({},o),{label:null,title:null}):o},e.prototype.getYAxisOption=function(t,i,o,c){return o},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,o){var c=i.columnValue,p=i.rowValue,g=i.view,_=(0,b.U2)(t.cfg.title,"formatter");if(t.cfg.transpose){var S=(0,b.b$)({position:["50%","0%"],content:_?_(c):c},zd(le.TOP),t.cfg.title);g.annotation().text(S)}else{var S=(0,b.b$)({position:["100%","50%"],content:_?_(p):p},zd(le.RIGHT),t.cfg.title);g.annotation().text(S)}})},e}(cc),s3=o3,u3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"rect",columnTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this)),rowTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this))})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.generateFacets=function(t){var i=this,o=(0,P.CR)(this.cfg.fields,2),c=o[0],p=o[1],g=[],_=1,S=1,I=[""],L=[""];return c&&(I=this.getFieldValues(t,c),_=I.length),p&&(L=this.getFieldValues(t,p),S=L.length),I.forEach(function(F,z){L.forEach(function(V,Q){var st=[{field:c,value:F,values:I},{field:p,value:V,values:L}],at=(0,b.hX)(t,i.getFacetDataFilter(st)),Ft={type:i.cfg.type,data:at,region:i.getRegion(S,_,z,Q),columnValue:F,rowValue:V,columnField:c,rowField:p,columnIndex:z,rowIndex:Q,columnValuesLength:_,rowValuesLength:S};g.push(Ft)})}),g},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,o){var c=i.columnIndex,p=i.rowIndex,g=i.columnValuesLength,_=i.columnValue,S=i.rowValue,I=i.view;if(p===0){var L=(0,b.U2)(t.cfg.columnTitle,"formatter"),F=(0,b.b$)({position:["50%","0%"],content:L?L(_):_},zd(le.TOP),t.cfg.columnTitle);I.annotation().text(F)}if(c===g-1){var L=(0,b.U2)(t.cfg.rowTitle,"formatter"),F=(0,b.b$)({position:["100%","50%"],content:L?L(S):S},zd(le.RIGHT),t.cfg.rowTitle);I.annotation().text(F)}})},e.prototype.getXAxisOption=function(t,i,o,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},o),{title:null,label:null}):c.columnIndex!==Math.floor((c.columnValuesLength-1)/2)?(0,P.pi)((0,P.pi)({},o),{title:null}):o},e.prototype.getYAxisOption=function(t,i,o,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},o),{title:null,label:null}):c.rowIndex!==Math.floor((c.rowValuesLength-1)/2)?(0,P.pi)((0,P.pi)({},o),{title:null}):o},e}(cc),l3=u3,c3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.afterChartRender=function(){t.facets&&t.cfg.line&&(t.container.clear(),t.drawLines(t.facets))},t}return e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.init=function(){r.prototype.init.call(this),this.view.on(Tt.AFTER_RENDER,this.afterChartRender)},e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"tree",line:{style:{lineWidth:1,stroke:"#ddd"},smooth:!1},showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.generateFacets=function(t){var i=this.cfg.fields;if(!i.length)throw new Error("Please specify for the fields for rootFacet!");var o=[],c={type:this.cfg.type,data:t,region:null,rowValuesLength:this.getRows(),columnValuesLength:1,rowIndex:0,columnIndex:0,rowField:"",columnField:"",rowValue:"",columnValue:""};return o.push(c),c.children=this.getChildFacets(t,1,o),this.setRegion(o),o},e.prototype.setRegion=function(t){var i=this;this.forceColIndex(t),t.forEach(function(o){o.region=i.getRegion(o.rowValuesLength,o.columnValuesLength,o.columnIndex,o.rowIndex)})},e.prototype.getRegion=function(t,i,o,c){var p=1/i,g=1/t,_={x:p*o,y:g*c},S={x:_.x+p,y:_.y+g*2/3};return{start:_,end:S}},e.prototype.forceColIndex=function(t){var i,o,c=this,p=[],g=0;t.forEach(function(V){c.isLeaf(V)&&(p.push(V),V.columnIndex=g,g++)}),p.forEach(function(V){V.columnValuesLength=p.length});for(var _=this.cfg.fields.length,S=_-1;S>=0;S--){var I=this.getFacetsByLevel(t,S);try{for(var L=(i=void 0,(0,P.XA)(I)),F=L.next();!F.done;F=L.next()){var z=F.value;this.isLeaf(z)||(z.originColIndex=z.columnIndex,z.columnIndex=this.getRegionIndex(z.children),z.columnValuesLength=p.length)}}catch(V){i={error:V}}finally{try{F&&!F.done&&(o=L.return)&&o.call(L)}finally{if(i)throw i.error}}}},e.prototype.getFacetsByLevel=function(t,i){var o=[];return t.forEach(function(c){c.rowIndex===i&&o.push(c)}),o},e.prototype.getRegionIndex=function(t){var i=t[0],o=t[t.length-1];return(o.columnIndex-i.columnIndex)/2+i.columnIndex},e.prototype.isLeaf=function(t){return!t.children||!t.children.length},e.prototype.getRows=function(){return this.cfg.fields.length+1},e.prototype.getChildFacets=function(t,i,o){var c=this,p=this.cfg.fields,g=p.length;if(!(g<i)){var _=[],S=p[i-1],I=this.getFieldValues(t,S);return I.forEach(function(L,F){var z=[{field:S,value:L,values:I}],V=t.filter(c.getFacetDataFilter(z));if(V.length){var Q={type:c.cfg.type,data:V,region:null,columnValue:L,rowValue:"",columnField:S,rowField:"",columnIndex:F,rowValuesLength:c.getRows(),columnValuesLength:1,rowIndex:i,children:c.getChildFacets(V,i+1,o)};_.push(Q),o.push(Q)}}),_}},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var o=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(o):o},zd(le.TOP),t.cfg.title);c.annotation().text(g)})},e.prototype.drawLines=function(t){var i=this;t.forEach(function(o){if(!i.isLeaf(o)){var c=o.children;i.addFacetLines(o,c)}})},e.prototype.addFacetLines=function(t,i){var o=this,c=t.view,p=c.coordinateBBox,g={x:p.x+p.width/2,y:p.y+p.height};i.forEach(function(_){var S=_.view.coordinateBBox,I={x:S.bl.x+(S.tr.x-S.bl.x)/2,y:S.tr.y},L={x:g.x,y:g.y+(I.y-g.y)/2},F={x:I.x,y:L.y};o.drawLine([g,L,F,I])})},e.prototype.getPath=function(t){var i=[],o=this.cfg.line.smooth;return o?(i.push(["M",t[0].x,t[0].y]),i.push(["C",t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y])):t.forEach(function(c,p){p===0?i.push(["M",c.x,c.y]):i.push(["L",c.x,c.y])}),i},e.prototype.drawLine=function(t){var i=this.getPath(t),o=this.cfg.line.style;this.container.addShape("path",{attrs:(0,b.f0)({path:i},o)})},e.prototype.getXAxisOption=function(t,i,o,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},o),{title:null,label:null}):o},e.prototype.getYAxisOption=function(t,i,o,c){return c.originColIndex!==0&&c.columnIndex!==0?(0,P.pi)((0,P.pi)({},o),{title:null,label:null}):o},e}(cc),f3=c3;function Hp(r){var e=(0,P.ev)([],(0,P.CR)(r),!1);e.sort(function(i,o){return i-o});var t=e.length;return t===0?0:t%2===1?e[(t-1)/2]:(e[t/2]+e[t/2-1])/2}function $E(r){var e=(0,b.u4)(r,function(t,i){return t+=isNaN(i)||!(0,b.hj)(i)?0:i},0);return r.length===0?0:e/r.length}function Vy(r,e){if(!e)return null;var t;switch(r){case"start":return 0;case"center":return .5;case"end":return 1;case"median":{t=e.isCategory?Hp(e.values.map(function(i,o){return o})):Hp(e.values);break}case"mean":{t=e.isCategory?(e.values.length-1)/2:$E(e.values);break}case"min":t=e.isCategory?0:e[r];break;case"max":t=e.isCategory?e.values.length-1:e[r];break;default:t=r;break}return e.scale(t)}var Gy=["regionFilter","shape"],h3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.cache=new Map,i.foregroundContainer=i.view.getLayer(W.FORE).addGroup(),i.backgroundContainer=i.view.getLayer(W.BG).addGroup(),i.option=[],i}return Object.defineProperty(e.prototype,"name",{get:function(){return"annotation"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.layout=function(){this.update()},e.prototype.render=function(){},e.prototype.update=function(){var t=this;this.onAfterRender(function(){var o=new Map;(0,b.S6)(t.option,function(c){if((0,b.q9)(Gy,c.type)){var p=t.updateOrCreate(c);p&&o.set(t.getCacheKey(c),p)}}),t.cache=t.syncCache(o)});var i=new Map;(0,b.S6)(this.option,function(o){if(!(0,b.q9)(Gy,o.type)){var c=t.updateOrCreate(o);c&&i.set(t.getCacheKey(o),c)}}),this.cache=this.syncCache(i)},e.prototype.clear=function(t){t===void 0&&(t=!1),r.prototype.clear.call(this),this.clearComponents(),this.foregroundContainer.clear(),this.backgroundContainer.clear(),t&&(this.option=[])},e.prototype.destroy=function(){this.clear(!0),this.foregroundContainer.remove(!0),this.backgroundContainer.remove(!0)},e.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(i){t.push(i)}),t},e.prototype.clearComponents=function(){this.getComponents().forEach(function(t){t.component.destroy()}),this.cache.clear()},e.prototype.onAfterRender=function(t){var i=!1;this.view.getOptions().animate&&this.view.geometries.forEach(function(o){o.animateOption&&(o.once(rt.AFTER_DRAW_ANIMATE,function(){t()}),i=!0)}),i||this.view.getRootView().once(Tt.AFTER_RENDER,function(){t()})},e.prototype.createAnnotation=function(t){var i=t.type,o=mt[(0,b.jC)(i)];if(o){var c=this.getAnnotationTheme(i),p=this.getAnnotationCfg(i,t,c);if(!p)return null;var g=new o(p);return{component:g,layer:this.isTop(p)?W.FORE:W.BG,direction:le.NONE,type:Ee.ANNOTATION,extra:t}}},e.prototype.annotation=function(t){this.option.push(t)},e.prototype.arc=function(t){return this.annotation((0,P.pi)({type:"arc"},t)),this},e.prototype.image=function(t){return this.annotation((0,P.pi)({type:"image"},t)),this},e.prototype.line=function(t){return this.annotation((0,P.pi)({type:"line"},t)),this},e.prototype.region=function(t){return this.annotation((0,P.pi)({type:"region"},t)),this},e.prototype.text=function(t){return this.annotation((0,P.pi)({type:"text"},t)),this},e.prototype.dataMarker=function(t){return this.annotation((0,P.pi)({type:"dataMarker"},t)),this},e.prototype.dataRegion=function(t){this.annotation((0,P.pi)({type:"dataRegion"},t))},e.prototype.regionFilter=function(t){this.annotation((0,P.pi)({type:"regionFilter"},t))},e.prototype.shape=function(t){this.annotation((0,P.pi)({type:"shape"},t))},e.prototype.html=function(t){this.annotation((0,P.pi)({type:"html"},t))},e.prototype.parsePosition=function(t){var i,o,c=this.view.getXScale(),p=this.view.getScalesByDim("y"),g=(0,b.mf)(t)?t.call(null,c,p):t,_=0,S=0;if((0,b.kJ)(g)){var I=(0,P.CR)(g,2),L=I[0],F=I[1];if((0,b.HD)(L)&&L.indexOf("%")!==-1&&!isNaN(L.slice(0,-1)))return this.parsePercentPosition(g);_=Vy(L,c),S=Vy(F,Object.values(p)[0])}else if(!(0,b.UM)(g))try{for(var z=(0,P.XA)((0,b.XP)(g)),V=z.next();!V.done;V=z.next()){var Q=V.value,st=g[Q];Q===c.field&&(_=Vy(st,c)),p[Q]&&(S=Vy(st,p[Q]))}}catch(at){i={error:at}}finally{try{V&&!V.done&&(o=z.return)&&o.call(z)}finally{if(i)throw i.error}}return isNaN(_)||isNaN(S)?null:this.view.getCoordinate().convert({x:_,y:S})},e.prototype.getRegionPoints=function(t,i){var o=this,c=this.view.getXScale(),p=this.view.getScalesByDim("y"),g=Object.values(p)[0],_=c.field,S=this.view.getData(),I=(0,b.kJ)(t)?t[0]:t[_],L=(0,b.kJ)(i)?i[0]:i[_],F=[],z;return(0,b.S6)(S,function(V,Q){if(V[_]===I&&(z=Q),Q>=z){var st=o.parsePosition([V[_],V[g.field]]);st&&F.push(st)}if(V[_]===L)return!1}),F},e.prototype.parsePercentPosition=function(t){var i=parseFloat(t[0])/100,o=parseFloat(t[1])/100,c=this.view.getCoordinate(),p=c.start,g=c.end,_={x:Math.min(p.x,g.x),y:Math.min(p.y,g.y)},S=c.getWidth()*i+_.x,I=c.getHeight()*o+_.y;return{x:S,y:I}},e.prototype.getCoordinateBBox=function(){var t=this.view.getCoordinate(),i=t.start,o=t.end,c=t.getWidth(),p=t.getHeight(),g={x:Math.min(i.x,o.x),y:Math.min(i.y,o.y)};return{x:g.x,y:g.y,minX:g.x,minY:g.y,maxX:g.x+c,maxY:g.y+p,width:c,height:p}},e.prototype.getAnnotationCfg=function(t,i,o){var c=this,p=this.view.getCoordinate(),g=this.view.getCanvas(),_={};if((0,b.UM)(i))return null;var S=i.start,I=i.end,L=i.position,F=this.parsePosition(S),z=this.parsePosition(I),V=this.parsePosition(L);if(["arc","image","line","region","regionFilter"].includes(t)&&(!F||!z))return null;if(["text","dataMarker","html"].includes(t)&&!V)return null;if(t==="arc"){var Q=i,st=Q.start,at=Q.end,Ft=(0,P._T)(Q,["start","end"]),Kt=lc(p,F),ee=lc(p,z);Kt>ee&&(ee=Math.PI*2+ee),_=(0,P.pi)((0,P.pi)({},Ft),{center:p.getCenter(),radius:ku(p,F),startAngle:Kt,endAngle:ee})}else if(t==="image"){var Me=i,hr=Me.start,Tr=Me.end,Ft=(0,P._T)(Me,["start","end"]);_=(0,P.pi)((0,P.pi)({},Ft),{start:F,end:z,src:i.src})}else if(t==="line"){var Dr=i,cn=Dr.start,Jr=Dr.end,Ft=(0,P._T)(Dr,["start","end"]);_=(0,P.pi)((0,P.pi)({},Ft),{start:F,end:z,text:(0,b.U2)(i,"text",null)})}else if(t==="region"){var Mn=i,mi=Mn.start,da=Mn.end,Ft=(0,P._T)(Mn,["start","end"]);_=(0,P.pi)((0,P.pi)({},Ft),{start:F,end:z})}else if(t==="text"){var Sa=this.view.getData(),eo=i,Gn=eo.position,Vi=eo.content,Ft=(0,P._T)(eo,["position","content"]),ua=Vi;(0,b.mf)(Vi)&&(ua=Vi(Sa)),_=(0,P.pi)((0,P.pi)((0,P.pi)({},V),Ft),{content:ua})}else if(t==="dataMarker"){var Xi=i,ea=Xi.position,ka=Xi.point,xo=Xi.line,Mo=Xi.text,$a=Xi.autoAdjust,Za=Xi.direction,Ft=(0,P._T)(Xi,["position","point","line","text","autoAdjust","direction"]);_=(0,P.pi)((0,P.pi)((0,P.pi)({},Ft),V),{coordinateBBox:this.getCoordinateBBox(),point:ka,line:xo,text:Mo,autoAdjust:$a,direction:Za})}else if(t==="dataRegion"){var ss=i,ju=ss.start,Wu=ss.end,Nh=ss.region,Mo=ss.text,Xv=ss.lineLength,Ft=(0,P._T)(ss,["start","end","region","text","lineLength"]);_=(0,P.pi)((0,P.pi)({},Ft),{points:this.getRegionPoints(ju,Wu),region:Nh,text:Mo,lineLength:Xv})}else if(t==="regionFilter"){var ed=i,j0=ed.start,kg=ed.end,i2=ed.apply,Yv=ed.color,Ft=(0,P._T)(ed,["start","end","apply","color"]),GP=this.view.geometries,wT=[],a2=function(vf){vf&&(vf.isGroup()?vf.getChildren().forEach(function(Lg){return a2(Lg)}):wT.push(vf))};(0,b.S6)(GP,function(vf){i2?(0,b.FX)(i2,vf.type)&&(0,b.S6)(vf.elements,function(Lg){a2(Lg.shape)}):(0,b.S6)(vf.elements,function(Lg){a2(Lg.shape)})}),_=(0,P.pi)((0,P.pi)({},Ft),{color:Yv,shapes:wT,start:F,end:z})}else if(t==="shape"){var a_=i,o2=a_.render,s2=(0,P._T)(a_,["render"]),u2=function(jP){if((0,b.mf)(i.render))return o2(jP,c.view,{parsePosition:c.parsePosition.bind(c)})};_=(0,P.pi)((0,P.pi)({},s2),{render:u2})}else if(t==="html"){var l2=i,c2=l2.html,$F=l2.position,s2=(0,P._T)(l2,["html","position"]),HP=function(vf){return(0,b.mf)(c2)?c2(vf,c.view):c2};_=(0,P.pi)((0,P.pi)((0,P.pi)({},s2),V),{parent:g.get("el").parentNode,html:HP})}var yp=(0,b.b$)({},o,(0,P.pi)((0,P.pi)({},_),{top:i.top,style:i.style,offsetX:i.offsetX,offsetY:i.offsetY}));return t!=="html"&&(yp.container=this.getComponentContainer(yp)),yp.animate=this.view.getOptions().animate&&yp.animate&&(0,b.U2)(i,"animate",yp.animate),yp.animateOption=(0,b.b$)({},ur,yp.animateOption,i.animateOption),yp},e.prototype.isTop=function(t){return(0,b.U2)(t,"top",!0)},e.prototype.getComponentContainer=function(t){return this.isTop(t)?this.foregroundContainer:this.backgroundContainer},e.prototype.getAnnotationTheme=function(t){return(0,b.U2)(this.view.getTheme(),["components","annotation",t],{})},e.prototype.updateOrCreate=function(t){var i=this.cache.get(this.getCacheKey(t));if(i){var o=t.type,c=this.getAnnotationTheme(o),p=this.getAnnotationCfg(o,t,c);p&&Mu(p,["container"]),i.component.update((0,P.pi)((0,P.pi)({},p||{}),{visible:!!p})),(0,b.q9)(Gy,t.type)&&i.component.render()}else i=this.createAnnotation(t),i&&(i.component.init(),(0,b.q9)(Gy,t.type)&&i.component.render());return i},e.prototype.syncCache=function(t){var i=this,o=new Map(this.cache);return t.forEach(function(c,p){o.set(p,c)}),o.forEach(function(c,p){(0,b.sE)(i.option,function(g){return p===i.getCacheKey(g)})||(c.component.destroy(),o.delete(p))}),o},e.prototype.getCacheKey=function(t){return t},e}(dt),Zd=h3;function j_(r,e){var t=(0,b.b$)({},(0,b.U2)(r,["components","axis","common"]),(0,b.U2)(r,["components","axis",e]));return(0,b.U2)(t,["grid"],{})}function Hy(r,e,t,i){var o=[],c=e.getTicks();return r.isPolar&&c.push({value:1,text:"",tickValue:""}),c.reduce(function(p,g,_){var S=g.value;if(i)o.push({points:[r.convert(t==="y"?{x:0,y:S}:{x:S,y:0}),r.convert(t==="y"?{x:1,y:S}:{x:S,y:1})]});else if(_){var I=p.value,L=(I+S)/2;o.push({points:[r.convert(t==="y"?{x:0,y:L}:{x:L,y:0}),r.convert(t==="y"?{x:1,y:L}:{x:L,y:1})]})}return g},c[0]),o}function jy(r,e,t,i,o){var c=e.values.length,p=[],g=t.getTicks();return g.reduce(function(_,S){var I=_?_.value:S.value,L=S.value,F=(I+L)/2;return o==="x"?p.push({points:[r.convert({x:i?L:F,y:0}),r.convert({x:i?L:F,y:1})]}):p.push({points:(0,b.UI)(Array(c+1),function(z,V){return r.convert({x:V/c,y:i?L:F})})}),S},g[0]),p}function W_(r,e){var t=(0,b.U2)(e,"grid");if(t===null)return!1;var i=(0,b.U2)(r,"grid");return!(t===void 0&&i===null)}var zc=["container"],X_=(0,P.pi)((0,P.pi)({},ur),{appear:null}),lh=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.cache=new Map,i.gridContainer=i.view.getLayer(W.BG).addGroup(),i.gridForeContainer=i.view.getLayer(W.FORE).addGroup(),i.axisContainer=i.view.getLayer(W.BG).addGroup(),i.axisForeContainer=i.view.getLayer(W.FORE).addGroup(),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"axis"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.render=function(){this.update()},e.prototype.layout=function(){var t=this,i=this.view.getCoordinate();(0,b.S6)(this.getComponents(),function(o){var c=o.component,p=o.direction,g=o.type,_=o.extra,S=_.dim,I=_.scale,L=_.alignTick,F;if(g===Ee.AXIS)i.isPolar?S==="x"?F=i.isTransposed?fv(i,p):pv(i):S==="y"&&(F=i.isTransposed?pv(i):fv(i,p)):F=fv(i,p);else if(g===Ee.GRID)if(i.isPolar){var z=void 0;i.isTransposed?z=S==="x"?jy(i,t.view.getYScales()[0],I,L,S):Hy(i,I,S,L):z=S==="x"?Hy(i,I,S,L):jy(i,t.view.getXScale(),I,L,S),F={items:z,center:t.view.getCoordinate().getCenter()}}else F={items:Hy(i,I,S,L)};c.update(F)})},e.prototype.update=function(){this.option=this.view.getOptions().axes;var t=new Map;this.updateXAxes(t),this.updateYAxes(t);var i=new Map;this.cache.forEach(function(o,c){t.has(c)?i.set(c,o):o.component.destroy()}),this.cache=i},e.prototype.clear=function(){r.prototype.clear.call(this),this.cache.clear(),this.gridContainer.clear(),this.gridForeContainer.clear(),this.axisContainer.clear(),this.axisForeContainer.clear()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.gridContainer.remove(!0),this.gridForeContainer.remove(!0),this.axisContainer.remove(!0),this.axisForeContainer.remove(!0)},e.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(i){t.push(i)}),t},e.prototype.updateXAxes=function(t){var i=this.view.getXScale();if(!(!i||i.isIdentity)){var o=Ah(this.option,i.field);if(o!==!1){var c=ns(o,le.BOTTOM),p=W.BG,g="x",_=this.view.getCoordinate(),S=this.getId("axis",i.field),I=this.getId("grid",i.field);if(_.isRect){var L=this.cache.get(S);if(L){var F=this.getLineAxisCfg(i,o,c);Mu(F,zc),L.component.update(F),t.set(S,L)}else L=this.createLineAxis(i,o,p,c,g),this.cache.set(S,L),t.set(S,L);var z=this.cache.get(I);if(z){var F=this.getLineGridCfg(i,o,c,g);Mu(F,zc),z.component.update(F),t.set(I,z)}else z=this.createLineGrid(i,o,p,c,g),z&&(this.cache.set(I,z),t.set(I,z))}else if(_.isPolar){var L=this.cache.get(S);if(L){var F=_.isTransposed?this.getLineAxisCfg(i,o,le.RADIUS):this.getCircleAxisCfg(i,o,c);Mu(F,zc),L.component.update(F),t.set(S,L)}else{if(_.isTransposed){if((0,b.o8)(o))return;L=this.createLineAxis(i,o,p,le.RADIUS,g)}else L=this.createCircleAxis(i,o,p,c,g);this.cache.set(S,L),t.set(S,L)}var z=this.cache.get(I);if(z){var F=_.isTransposed?this.getCircleGridCfg(i,o,le.RADIUS,g):this.getLineGridCfg(i,o,le.CIRCLE,g);Mu(F,zc),z.component.update(F),t.set(I,z)}else{if(_.isTransposed){if((0,b.o8)(o))return;z=this.createCircleGrid(i,o,p,le.RADIUS,g)}else z=this.createLineGrid(i,o,p,le.CIRCLE,g);z&&(this.cache.set(I,z),t.set(I,z))}}}}},e.prototype.updateYAxes=function(t){var i=this,o=this.view.getYScales();(0,b.S6)(o,function(c,p){if(!(!c||c.isIdentity)){var g=c.field,_=Ah(i.option,g);if(_!==!1){var S=W.BG,I="y",L=i.getId("axis",g),F=i.getId("grid",g),z=i.view.getCoordinate();if(z.isRect){var V=ns(_,p===0?le.LEFT:le.RIGHT),Q=i.cache.get(L);if(Q){var st=i.getLineAxisCfg(c,_,V);Mu(st,zc),Q.component.update(st),t.set(L,Q)}else Q=i.createLineAxis(c,_,S,V,I),i.cache.set(L,Q),t.set(L,Q);var at=i.cache.get(F);if(at){var st=i.getLineGridCfg(c,_,V,I);Mu(st,zc),at.component.update(st),t.set(F,at)}else at=i.createLineGrid(c,_,S,V,I),at&&(i.cache.set(F,at),t.set(F,at))}else if(z.isPolar){var Q=i.cache.get(L);if(Q){var st=z.isTransposed?i.getCircleAxisCfg(c,_,le.CIRCLE):i.getLineAxisCfg(c,_,le.RADIUS);Mu(st,zc),Q.component.update(st),t.set(L,Q)}else{if(z.isTransposed){if((0,b.o8)(_))return;Q=i.createCircleAxis(c,_,S,le.CIRCLE,I)}else Q=i.createLineAxis(c,_,S,le.RADIUS,I);i.cache.set(L,Q),t.set(L,Q)}var at=i.cache.get(F);if(at){var st=z.isTransposed?i.getLineGridCfg(c,_,le.CIRCLE,I):i.getCircleGridCfg(c,_,le.RADIUS,I);Mu(st,zc),at.component.update(st),t.set(F,at)}else{if(z.isTransposed){if((0,b.o8)(_))return;at=i.createLineGrid(c,_,S,le.CIRCLE,I)}else at=i.createCircleGrid(c,_,S,le.RADIUS,I);at&&(i.cache.set(F,at),t.set(F,at))}}}}})},e.prototype.createLineAxis=function(t,i,o,c,p){var g={component:new md(this.getLineAxisCfg(t,i,c)),layer:o,direction:c===le.RADIUS?le.NONE:c,type:Ee.AXIS,extra:{dim:p,scale:t}};return g.component.set("field",t.field),g.component.init(),g},e.prototype.createLineGrid=function(t,i,o,c,p){var g=this.getLineGridCfg(t,i,c,p);if(g){var _={component:new Pp(g),layer:o,direction:le.NONE,type:Ee.GRID,extra:{dim:p,scale:t,alignTick:(0,b.U2)(g,"alignTick",!0)}};return _.component.init(),_}},e.prototype.createCircleAxis=function(t,i,o,c,p){var g={component:new uv(this.getCircleAxisCfg(t,i,c)),layer:o,direction:c,type:Ee.AXIS,extra:{dim:p,scale:t}};return g.component.set("field",t.field),g.component.init(),g},e.prototype.createCircleGrid=function(t,i,o,c,p){var g=this.getCircleGridCfg(t,i,c,p);if(g){var _={component:new Xh(g),layer:o,direction:le.NONE,type:Ee.GRID,extra:{dim:p,scale:t,alignTick:(0,b.U2)(g,"alignTick",!0)}};return _.component.init(),_}},e.prototype.getLineAxisCfg=function(t,i,o){var c=(0,b.U2)(i,["top"])?this.axisForeContainer:this.axisContainer,p=this.view.getCoordinate(),g=fv(p,o),_=dv(t,i),S=Ch(this.view.getTheme(),o),I=(0,b.U2)(i,["title"])?(0,b.b$)({title:{style:{text:_}}},{title:o0(this.view.getTheme(),o,i.title)},i):i,L=(0,b.b$)((0,P.pi)((0,P.pi)({container:c},g),{ticks:t.getTicks().map(function(Kt){return{id:"".concat(Kt.tickValue),name:Kt.text,value:Kt.value}}),verticalFactor:p.isPolar?a0(g,p.getCenter())*-1:a0(g,p.getCenter()),theme:S}),S,I),F=this.getAnimateCfg(L),z=F.animate,V=F.animateOption;L.animateOption=V,L.animate=z;var Q=i0(g),st=(0,b.U2)(L,"verticalLimitLength",Q?1/3:1/2);if(st<=1){var at=this.view.getCanvas().get("width"),Ft=this.view.getCanvas().get("height");L.verticalLimitLength=st*(Q?at:Ft)}return L},e.prototype.getLineGridCfg=function(t,i,o,c){if(W_(Ch(this.view.getTheme(),o),i)){var p=j_(this.view.getTheme(),o),g=(0,b.b$)({container:(0,b.U2)(i,["top"])?this.gridForeContainer:this.gridContainer},p,(0,b.U2)(i,"grid"),this.getAnimateCfg(i));return g.items=Hy(this.view.getCoordinate(),t,c,(0,b.U2)(g,"alignTick",!0)),g}},e.prototype.getCircleAxisCfg=function(t,i,o){var c=(0,b.U2)(i,["top"])?this.axisForeContainer:this.axisContainer,p=this.view.getCoordinate(),g=t.getTicks().map(function(Q){return{id:"".concat(Q.tickValue),name:Q.text,value:Q.value}});!t.isCategory&&Math.abs(p.endAngle-p.startAngle)===Math.PI*2&&g.length&&(g[g.length-1].name="");var _=dv(t,i),S=Ch(this.view.getTheme(),le.CIRCLE),I=(0,b.U2)(i,["title"])?(0,b.b$)({title:{style:{text:_}}},{title:o0(this.view.getTheme(),o,i.title)},i):i,L=(0,b.b$)((0,P.pi)((0,P.pi)({container:c},pv(this.view.getCoordinate())),{ticks:g,verticalFactor:1,theme:S}),S,I),F=this.getAnimateCfg(L),z=F.animate,V=F.animateOption;return L.animate=z,L.animateOption=V,L},e.prototype.getCircleGridCfg=function(t,i,o,c){if(W_(Ch(this.view.getTheme(),o),i)){var p=j_(this.view.getTheme(),le.RADIUS),g=(0,b.b$)({container:(0,b.U2)(i,["top"])?this.gridForeContainer:this.gridContainer,center:this.view.getCoordinate().getCenter()},p,(0,b.U2)(i,"grid"),this.getAnimateCfg(i)),_=(0,b.U2)(g,"alignTick",!0),S=c==="x"?this.view.getYScales()[0]:this.view.getXScale();return g.items=jy(this.view.getCoordinate(),S,t,_,c),g}},e.prototype.getId=function(t,i){var o=this.view.getCoordinate();return"".concat(t,"-").concat(i,"-").concat(o.type)},e.prototype.getAnimateCfg=function(t){return{animate:this.view.getOptions().animate&&(0,b.U2)(t,"animate"),animateOption:t&&t.animateOption?(0,b.b$)({},X_,t.animateOption):X_}},e}(dt),Y_=lh;function kv(r,e,t){return t===le.TOP?[r.minX+r.width/2-e.width/2,r.minY]:t===le.BOTTOM?[r.minX+r.width/2-e.width/2,r.maxY-e.height]:t===le.LEFT?[r.minX,r.minY+r.height/2-e.height/2]:t===le.RIGHT?[r.maxX-e.width,r.minY+r.height/2-e.height/2]:t===le.TOP_LEFT||t===le.LEFT_TOP?[r.tl.x,r.tl.y]:t===le.TOP_RIGHT||t===le.RIGHT_TOP?[r.tr.x-e.width,r.tr.y]:t===le.BOTTOM_LEFT||t===le.LEFT_BOTTOM?[r.bl.x,r.bl.y-e.height]:t===le.BOTTOM_RIGHT||t===le.RIGHT_BOTTOM?[r.br.x-e.width,r.br.y-e.height]:[0,0]}function p3(r,e){if(e.isTransposed)switch(r){case DIRECTION.BOTTOM:return DIRECTION.LEFT;case DIRECTION.LEFT:return DIRECTION.BOTTOM;case DIRECTION.RIGHT:return DIRECTION.TOP;case DIRECTION.TOP:return DIRECTION.RIGHT}return r}function v3(r){return r===DIRECTION.LEFT?DIRECTION.RIGHT:r===DIRECTION.RIGHT?DIRECTION.LEFT:r}function qE(r){return r===DIRECTION.TOP?DIRECTION.BOTTOM:r===DIRECTION.BOTTOM?DIRECTION.TOP:r}function g3(r,e){var t=e.matrix[0],i=e.matrix[4],o=r;return t<0&&(o=v3(o)),i<0&&(o=qE(o)),o}function OO(r,e){var t=r;return e.isReflect("x")&&(t=v3(t)),e.isReflect("y")&&(t=qE(t)),t}function FO(r,e){var t=r;return t=p3(t,e),t=g3(t,e),t=OO(t,e),t}function KE(r,e){return(0,b.jn)(r)?r===!1?!1:{}:(0,b.U2)(r,[e],r)}function $_(r){return(0,b.U2)(r,"position",le.BOTTOM)}var m3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.container=i.view.getLayer(W.FORE).addGroup(),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"legend"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.render=function(){this.update()},e.prototype.layout=function(){var t=this;this.layoutBBox=this.view.viewBBox,(0,b.S6)(this.components,function(i){var o=i.component,c=i.direction,p=Ed(c),g=o.get("maxWidthRatio"),_=o.get("maxHeightRatio"),S=t.getCategoryLegendSizeCfg(p,g,_),I=o.get("maxWidth"),L=o.get("maxHeight");o.update({maxWidth:Math.min(S.maxWidth,I||0),maxHeight:Math.min(S.maxHeight,L||0)});var F=o.get("padding"),z=o.getLayoutBBox(),V=new Iu(z.x,z.y,z.width,z.height).expand(F),Q=(0,P.CR)(kv(t.view.viewBBox,V,c),2),st=Q[0],at=Q[1],Ft=(0,P.CR)(kv(t.layoutBBox,V,c),2),Kt=Ft[0],ee=Ft[1],Me=0,hr=0;c.startsWith("top")||c.startsWith("bottom")?(Me=st,hr=ee):(Me=Kt,hr=at),o.setLocation({x:Me+F[3],y:hr+F[0]}),t.layoutBBox=t.layoutBBox.cut(V,c)})},e.prototype.update=function(){var t=this;this.option=this.view.getOptions().legends;var i={},o=function(F,z,V){var Q=t.getId(V.field),st=t.getComponentById(Q);if(st){var at=void 0,Ft=KE(t.option,V.field);Ft!==!1&&((0,b.U2)(Ft,"custom")?at=t.getCategoryCfg(F,z,V,Ft,!0):V.isLinear?at=t.getContinuousCfg(F,z,V,Ft):V.isCategory&&(at=t.getCategoryCfg(F,z,V,Ft))),at&&(Mu(at,["container"]),st.direction=$_(Ft),st.component.update(at),i[Q]=!0)}else{var Kt=t.createFieldLegend(F,z,V);Kt&&(Kt.component.init(),t.components.push(Kt),i[Q]=!0)}};if((0,b.U2)(this.option,"custom")){var c="global-custom",p=this.getComponentById(c);if(p){var g=this.getCategoryCfg(void 0,void 0,void 0,this.option,!0);Mu(g,["container"]),p.component.update(g),i[c]=!0}else{var _=this.createCustomLegend(void 0,void 0,void 0,this.option);if(_){_.init();var S=W.FORE,I=$_(this.option);this.components.push({id:c,component:_,layer:S,direction:I,type:Ee.LEGEND,extra:void 0}),i[c]=!0}}}else this.loopLegends(o);var L=[];(0,b.S6)(this.getComponents(),function(F){i[F.id]?L.push(F):F.component.destroy()}),this.components=L},e.prototype.clear=function(){r.prototype.clear.call(this),this.container.clear()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.container.remove(!0)},e.prototype.getGeometries=function(t){var i=this,o=t.geometries;return(0,b.S6)(t.views,function(c){o=o.concat(i.getGeometries(c))}),o},e.prototype.loopLegends=function(t){var i=this.view.getRootView()===this.view;if(i){var o=this.getGeometries(this.view),c={};(0,b.S6)(o,function(p){var g=p.getGroupAttributes();(0,b.S6)(g,function(_){var S=_.getScale(_.type);!S||S.type==="identity"||c[S.field]||(t(p,_,S),c[S.field]=!0)})})}},e.prototype.createFieldLegend=function(t,i,o){var c,p=KE(this.option,o.field),g=W.FORE,_=$_(p);if(p!==!1&&((0,b.U2)(p,"custom")?c=this.createCustomLegend(t,i,o,p):o.isLinear?c=this.createContinuousLegend(t,i,o,p):o.isCategory&&(c=this.createCategoryLegend(t,i,o,p))),c)return c.set("field",o.field),{id:this.getId(o.field),component:c,layer:g,direction:_,type:Ee.LEGEND,extra:{scale:o}}},e.prototype.createCustomLegend=function(t,i,o,c){var p=this.getCategoryCfg(t,i,o,c,!0);return new gl(p)},e.prototype.createContinuousLegend=function(t,i,o,c){var p=this.getContinuousCfg(t,i,o,Mu(c,["value"]));return new yd(p)},e.prototype.createCategoryLegend=function(t,i,o,c){var p=this.getCategoryCfg(t,i,o,c);return new gl(p)},e.prototype.getContinuousCfg=function(t,i,o,c){var p=o.getTicks(),g=(0,b.sE)(p,function(Q){return Q.value===0}),_=(0,b.sE)(p,function(Q){return Q.value===1}),S=p.map(function(Q){var st=Q.value,at=Q.tickValue,Ft=i.mapping(o.invert(st)).join("");return{value:at,attrValue:Ft,color:Ft,scaleValue:st}});g||S.push({value:o.min,attrValue:i.mapping(o.invert(0)).join(""),color:i.mapping(o.invert(0)).join(""),scaleValue:0}),_||S.push({value:o.max,attrValue:i.mapping(o.invert(1)).join(""),color:i.mapping(o.invert(1)).join(""),scaleValue:1}),S.sort(function(Q,st){return Q.value-st.value});var I={min:(0,b.YM)(S).value,max:(0,b.Z$)(S).value,colors:[],rail:{type:i.type},track:{}};i.type==="size"&&(I.track={style:{fill:i.type==="size"?this.view.getTheme().defaultColor:void 0}}),i.type==="color"&&(I.colors=S.map(function(Q){return Q.attrValue}));var L=this.container,F=$_(c),z=Ed(F),V=(0,b.U2)(c,"title");return V&&(V=(0,b.b$)({text:ul(o)},V)),I.container=L,I.layout=z,I.title=V,I.animateOption=ur,this.mergeLegendCfg(I,c,"continuous")},e.prototype.getCategoryCfg=function(t,i,o,c,p){var g=this.container,_=(0,b.U2)(c,"position",le.BOTTOM),S=Jh(this.view.getTheme(),_),I=(0,b.U2)(S,["marker"]),L=(0,b.U2)(c,"marker"),F=Ed(_),z=(0,b.U2)(S,["pageNavigator"]),V=(0,b.U2)(c,"pageNavigator"),Q=p?c0(I,L,c.items):wd(this.view,t,i,I,L),st=(0,b.U2)(c,"title");st&&(st=(0,b.b$)({text:o?ul(o):""},st));var at=(0,b.U2)(c,"maxWidthRatio"),Ft=(0,b.U2)(c,"maxHeightRatio"),Kt=this.getCategoryLegendSizeCfg(F,at,Ft);Kt.container=g,Kt.layout=F,Kt.items=Q,Kt.title=st,Kt.animateOption=ur,Kt.pageNavigator=(0,b.b$)({},z,V);var ee=this.mergeLegendCfg(Kt,c,_);ee.reversed&&ee.items.reverse();var Me=(0,b.U2)(ee,"maxItemWidth");return Me&&Me<=1&&(ee.maxItemWidth=this.view.viewBBox.width*Me),ee},e.prototype.mergeLegendCfg=function(t,i,o){var c=o.split("-")[0],p=Jh(this.view.getTheme(),c);return(0,b.b$)({},p,t,i)},e.prototype.getId=function(t){return"".concat(this.name,"-").concat(t)},e.prototype.getComponentById=function(t){return(0,b.sE)(this.components,function(i){return i.id===t})},e.prototype.getCategoryLegendSizeCfg=function(t,i,o){i===void 0&&(i=Je),o===void 0&&(o=Je);var c=this.view.viewBBox,p=c.width,g=c.height;return t==="vertical"?{maxWidth:p*i,maxHeight:g}:{maxWidth:p,maxHeight:g*o}},e}(dt),y3=m3,_3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.onChangeFn=b.ZT,i.resetMeasure=function(){i.clear()},i.onValueChange=function(o){var c=(0,P.CR)(o,2),p=c[0],g=c[1];i.start=p,i.end=g,i.changeViewData(p,g)},i.container=i.view.getLayer(W.FORE).addGroup(),i.onChangeFn=(0,b.P2)(i.onValueChange,20,{leading:!0}),i.width=0,i.view.on(Tt.BEFORE_CHANGE_DATA,i.resetMeasure),i.view.on(Tt.BEFORE_CHANGE_SIZE,i.resetMeasure),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"slider"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.view.off(Tt.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(Tt.BEFORE_CHANGE_SIZE,this.resetMeasure)},e.prototype.init=function(){},e.prototype.render=function(){this.option=this.view.getOptions().slider;var t=this.getSliderCfg(),i=t.start,o=t.end;(0,b.UM)(this.start)&&(this.start=i,this.end=o);var c=this.view.getOptions().data;this.option&&!(0,b.xb)(c)?this.slider?this.slider=this.updateSlider():(this.slider=this.createSlider(),this.slider.component.on("sliderchange",this.onChangeFn)):this.slider&&(this.slider.component.destroy(),this.slider=void 0)},e.prototype.layout=function(){var t=this;if(this.option&&!this.width&&(this.measureSlider(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.start,t.end)},0)),this.slider){var i=this.view.coordinateBBox.width,o=this.slider.component.get("padding"),c=(0,P.CR)(o,4),p=c[0],g=c[1],_=c[2],S=c[3],I=this.slider.component.getLayoutBBox(),L=new Iu(I.x,I.y,Math.min(I.width,i),I.height).expand(o),F=this.getMinMaxText(this.start,this.end),z=F.minText,V=F.maxText,Q=(0,P.CR)(kv(this.view.viewBBox,L,le.BOTTOM),2),st=Q[0],at=Q[1],Ft=(0,P.CR)(kv(this.view.coordinateBBox,L,le.BOTTOM),2),Kt=Ft[0],ee=Ft[1];this.slider.component.update((0,P.pi)((0,P.pi)({},this.getSliderCfg()),{x:Kt+S,y:at+p,width:this.width,start:this.start,end:this.end,minText:z,maxText:V})),this.view.viewBBox=this.view.viewBBox.cut(L,le.BOTTOM)}},e.prototype.update=function(){this.render()},e.prototype.createSlider=function(){var t=this.getSliderCfg(),i=new of((0,P.pi)({container:this.container},t));return i.init(),{component:i,layer:W.FORE,direction:le.BOTTOM,type:Ee.SLIDER}},e.prototype.updateSlider=function(){var t=this.getSliderCfg();if(this.width){var i=this.getMinMaxText(this.start,this.end),o=i.minText,c=i.maxText;t=(0,P.pi)((0,P.pi)({},t),{width:this.width,start:this.start,end:this.end,minText:o,maxText:c})}return this.slider.component.update(t),this.slider},e.prototype.measureSlider=function(){var t=this.getSliderCfg().width;this.width=t},e.prototype.getSliderCfg=function(){var t={height:16,start:0,end:1,minText:"",maxText:"",x:0,y:0,width:this.view.coordinateBBox.width};if((0,b.Kn)(this.option)){var i=(0,P.pi)({data:this.getData()},(0,b.U2)(this.option,"trendCfg",{}));t=(0,b.b$)({},t,this.getThemeOptions(),this.option),t=(0,P.pi)((0,P.pi)({},t),{trendCfg:i})}return t.start=(0,b.uZ)(Math.min((0,b.UM)(t.start)?0:t.start,(0,b.UM)(t.end)?1:t.end),0,1),t.end=(0,b.uZ)(Math.max((0,b.UM)(t.start)?0:t.start,(0,b.UM)(t.end)?1:t.end),0,1),t},e.prototype.getData=function(){var t=this.view.getOptions().data,i=(0,P.CR)(this.view.getYScales(),1),o=i[0],c=this.view.getGroupScales();if(c.length){var p=c[0],g=p.field,_=p.ticks;return t.reduce(function(S,I){return I[g]===_[0]&&S.push(I[o.field]),S},[])}return t.map(function(S){return S[o.field]||0})},e.prototype.getThemeOptions=function(){var t=this.view.getTheme();return(0,b.U2)(t,["components","slider","common"],{})},e.prototype.getMinMaxText=function(t,i){var o=this.view.getOptions().data,c=this.view.getXScale(),p=!0,g=(0,b.I)(o,c.field);c.isLinear&&(g=g.sort());var _=p?g:g.reverse(),S=(0,b.dp)(o);if(!c||!S)return{};var I=(0,b.dp)(_),L=Math.round(t*(I-1)),F=Math.round(i*(I-1)),z=(0,b.U2)(_,[L]),V=(0,b.U2)(_,[F]),Q=this.getSliderCfg().formatter;return Q&&(z=Q(z,o[L],L),V=Q(V,o[F],F)),{minText:z,maxText:V}},e.prototype.changeViewData=function(t,i){var o=this.view.getOptions().data,c=this.view.getXScale(),p=(0,b.dp)(o);if(!(!c||!p)){var g=!0,_=(0,b.I)(o,c.field),S=this.view.getXScale().isLinear?_.sort(function(V,Q){return Number(V)-Number(Q)}):_,I=g?S:S.reverse(),L=(0,b.dp)(I),F=Math.round(t*(L-1)),z=Math.round(i*(L-1));this.view.filter(c.field,function(V,Q){var st=I.indexOf(V);return st>-1?Rp(st,F,z):!0}),this.view.render(!0)}},e.prototype.getComponents=function(){return this.slider?[this.slider]:[]},e.prototype.clear=function(){this.slider&&(this.slider.component.destroy(),this.slider=void 0),this.width=0,this.start=void 0,this.end=void 0},e}(dt),x3=_3,q_=0,QE=8,b3=32,RO=20,E3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.onChangeFn=b.ZT,i.resetMeasure=function(){i.clear()},i.onValueChange=function(o){var c=o.ratio,p=i.getValidScrollbarCfg().animate;i.ratio=(0,b.uZ)(c,0,1);var g=i.view.getOptions().animate;p||i.view.animate(!1),i.changeViewData(i.getScrollRange(),!0),i.view.animate(g)},i.container=i.view.getLayer(W.FORE).addGroup(),i.onChangeFn=(0,b.P2)(i.onValueChange,20,{leading:!0}),i.trackLen=0,i.thumbLen=0,i.ratio=0,i.view.on(Tt.BEFORE_CHANGE_DATA,i.resetMeasure),i.view.on(Tt.BEFORE_CHANGE_SIZE,i.resetMeasure),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"scrollbar"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.view.off(Tt.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(Tt.BEFORE_CHANGE_SIZE,this.resetMeasure)},e.prototype.init=function(){},e.prototype.render=function(){this.option=this.view.getOptions().scrollbar,this.option?this.scrollbar?this.scrollbar=this.updateScrollbar():(this.scrollbar=this.createScrollbar(),this.scrollbar.component.on("scrollchange",this.onChangeFn)):this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0)},e.prototype.layout=function(){var t=this;if(this.option&&!this.trackLen&&(this.measureScrollbar(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.getScrollRange(),!0)})),this.scrollbar){var i=this.view.coordinateBBox.width,o=this.scrollbar.component.get("padding"),c=this.scrollbar.component.getLayoutBBox(),p=new Iu(c.x,c.y,Math.min(c.width,i),c.height).expand(o),g=this.getScrollbarComponentCfg(),_=void 0,S=void 0;if(g.isHorizontal){var I=(0,P.CR)(kv(this.view.viewBBox,p,le.BOTTOM),2),L=I[0],F=I[1],z=(0,P.CR)(kv(this.view.coordinateBBox,p,le.BOTTOM),2),V=z[0],Q=z[1];_=V,S=F}else{var st=(0,P.CR)(kv(this.view.viewBBox,p,le.RIGHT),2),L=st[0],F=st[1],at=(0,P.CR)(kv(this.view.viewBBox,p,le.RIGHT),2),V=at[0],Q=at[1];_=V,S=F}_+=o[3],S+=o[0],this.trackLen?this.scrollbar.component.update((0,P.pi)((0,P.pi)({},g),{x:_,y:S,trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio})):this.scrollbar.component.update((0,P.pi)((0,P.pi)({},g),{x:_,y:S})),this.view.viewBBox=this.view.viewBBox.cut(p,g.isHorizontal?le.BOTTOM:le.RIGHT)}},e.prototype.update=function(){this.render()},e.prototype.getComponents=function(){return this.scrollbar?[this.scrollbar]:[]},e.prototype.clear=function(){this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0),this.trackLen=0,this.thumbLen=0,this.ratio=0,this.cnt=0,this.step=0,this.data=void 0,this.xScaleCfg=void 0,this.yScalesCfg=[]},e.prototype.setValue=function(t){this.onValueChange({ratio:t})},e.prototype.getValue=function(){return this.ratio},e.prototype.getThemeOptions=function(){var t=this.view.getTheme();return(0,b.U2)(t,["components","scrollbar","common"],{})},e.prototype.getScrollbarTheme=function(t){var i=(0,b.U2)(this.view.getTheme(),["components","scrollbar"]),o=t||{},c=o.thumbHighlightColor,p=(0,P._T)(o,["thumbHighlightColor"]);return{default:(0,b.b$)({},(0,b.U2)(i,["default","style"],{}),p),hover:(0,b.b$)({},(0,b.U2)(i,["hover","style"],{}),{thumbColor:c})}},e.prototype.measureScrollbar=function(){var t=this.view.getXScale(),i=this.view.getYScales().slice();this.data=this.getScrollbarData(),this.step=this.getStep(),this.cnt=this.getCnt();var o=this.getScrollbarComponentCfg(),c=o.trackLen,p=o.thumbLen;this.trackLen=c,this.thumbLen=p,this.xScaleCfg={field:t.field,values:t.values||[]},this.yScalesCfg=i},e.prototype.getScrollRange=function(){var t=Math.floor((this.cnt-this.step)*(0,b.uZ)(this.ratio,0,1)),i=Math.min(t+this.step-1,this.cnt-1);return[t,i]},e.prototype.changeViewData=function(t,i){var o=this,c=(0,P.CR)(t,2),p=c[0],g=c[1],_=this.getValidScrollbarCfg().type,S=_!=="vertical",I=(0,b.I)(this.data,this.xScaleCfg.field),L=this.view.getXScale().isLinear?I.sort(function(z,V){return Number(z)-Number(V)}):I,F=S?L:L.reverse();this.yScalesCfg.forEach(function(z){o.view.scale(z.field,{formatter:z.formatter,type:z.type,min:z.min,max:z.max,tickMethod:z.tickMethod})}),this.view.filter(this.xScaleCfg.field,function(z){var V=F.indexOf(z);return V>-1?Rp(V,p,g):!0}),this.view.render(!0)},e.prototype.createScrollbar=function(){var t=this.getValidScrollbarCfg().type,i=t!=="vertical",o=new t0((0,P.pi)((0,P.pi)({container:this.container},this.getScrollbarComponentCfg()),{x:0,y:0}));return o.init(),{component:o,layer:W.FORE,direction:i?le.BOTTOM:le.RIGHT,type:Ee.SCROLLBAR}},e.prototype.updateScrollbar=function(){var t=this.getScrollbarComponentCfg(),i=this.trackLen?(0,P.pi)((0,P.pi)({},t),{trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio}):(0,P.pi)({},t);return this.scrollbar.component.update(i),this.scrollbar},e.prototype.getStep=function(){if(this.step)return this.step;var t=this.view.coordinateBBox,i=this.getValidScrollbarCfg(),o=i.type,c=i.categorySize,p=o!=="vertical";return Math.floor((p?t.width:t.height)/c)},e.prototype.getCnt=function(){if(this.cnt)return this.cnt;var t=this.view.getXScale(),i=this.getScrollbarData(),o=(0,b.I)(i,t.field);return(0,b.dp)(o)},e.prototype.getScrollbarComponentCfg=function(){var t=this.view,i=t.coordinateBBox,o=t.viewBBox,c=this.getValidScrollbarCfg(),p=c.type,g=c.padding,_=c.width,S=c.height,I=c.style,L=p!=="vertical",F=(0,P.CR)(g,4),z=F[0],V=F[1],Q=F[2],st=F[3],at=L?{x:i.minX+st,y:o.maxY-S-Q}:{x:o.maxX-_-V,y:i.minY+z},Ft=this.getStep(),Kt=this.getCnt(),ee=L?i.width-st-V:i.height-z-Q,Me=Math.max(ee*(0,b.uZ)(Ft/Kt,0,1),RO);return(0,P.pi)((0,P.pi)({},this.getThemeOptions()),{x:at.x,y:at.y,size:L?S:_,isHorizontal:L,trackLen:ee,thumbLen:Me,thumbOffset:0,theme:this.getScrollbarTheme(I)})},e.prototype.getValidScrollbarCfg=function(){var t={type:"horizontal",categorySize:b3,width:QE,height:QE,padding:[0,0,0,0],animate:!0,style:{}};return(0,b.Kn)(this.option)&&(t=(0,P.pi)((0,P.pi)({},t),this.option)),(!(0,b.Kn)(this.option)||!this.option.padding)&&(t.padding=t.type==="horizontal"?[q_,0,q_,0]:[0,q_,0,q_]),t},e.prototype.getScrollbarData=function(){var t=this.view.getCoordinate(),i=this.getValidScrollbarCfg(),o=this.view.getOptions().data||[];return t.isReflect("y")&&i.type==="vertical"&&(o=(0,P.ev)([],(0,P.CR)(o),!1).reverse()),o},e}(dt),w3=E3,DO={fill:"#CCD6EC",opacity:.3};function S3(r,e,t){var i,o,c,p,g,_,S=su(r,e,t);if(S.length){S=(0,b.xH)(S);try{for(var I=(0,P.XA)(S),L=I.next();!L.done;L=I.next()){var F=L.value;try{for(var z=(c=void 0,(0,P.XA)(F)),V=z.next();!V.done;V=z.next()){var Q=V.value,st=Q.mappingData,at=st.x,Ft=st.y;Q.x=(0,b.kJ)(at)?at[at.length-1]:at,Q.y=(0,b.kJ)(Ft)?Ft[Ft.length-1]:Ft}}catch(Jr){c={error:Jr}}finally{try{V&&!V.done&&(p=z.return)&&p.call(z)}finally{if(c)throw c.error}}}}catch(Jr){i={error:Jr}}finally{try{L&&!L.done&&(o=I.return)&&o.call(I)}finally{if(i)throw i.error}}var Kt=t.shared;if(Kt===!1&&S.length>1){var ee=S[0],Me=Math.abs(e.y-ee[0].y);try{for(var hr=(0,P.XA)(S),Tr=hr.next();!Tr.done;Tr=hr.next()){var Dr=Tr.value,cn=Math.abs(e.y-Dr[0].y);cn<=Me&&(ee=Dr,Me=cn)}}catch(Jr){g={error:Jr}}finally{try{Tr&&!Tr.done&&(_=hr.return)&&_.call(hr)}finally{if(g)throw g.error}}S=[ee]}return(0,b.jj)((0,b.xH)(S))}return[]}var C3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.show=function(t){var i=this.context.view,o=this.context.event,c=i.getController("tooltip").getTooltipCfg(),p=S3(i,{x:o.x,y:o.y},c);if(!(0,b.Xy)(p,this.items)&&(this.items=p,p.length)){var g=i.getXScale().field,_=p[0].data[g],S=[],I=i.geometries;if((0,b.S6)(I,function(ua){if(ua.type==="interval"||ua.type==="schema"){var Xi=ua.getElementsBy(function(ea){var ka=ea.getData();return ka[g]===_});S=S.concat(Xi)}}),S.length){var L=i.getCoordinate(),F=S[0].shape.getCanvasBBox(),z=S[0].shape.getCanvasBBox(),V=F;(0,b.S6)(S,function(ua){var Xi=ua.shape.getCanvasBBox();L.isTransposed?(Xi.minY<F.minY&&(F=Xi),Xi.maxY>z.maxY&&(z=Xi)):(Xi.minX<F.minX&&(F=Xi),Xi.maxX>z.maxX&&(z=Xi)),V.x=Math.min(Xi.minX,V.minX),V.y=Math.min(Xi.minY,V.minY),V.width=Math.max(Xi.maxX,V.maxX)-V.x,V.height=Math.max(Xi.maxY,V.maxY)-V.y});var Q=i.backgroundGroup,st=i.coordinateBBox,at=void 0;if(L.isRect){var Ft=i.getXScale(),Kt=t||{},ee=Kt.appendRatio,Me=Kt.appendWidth;(0,b.UM)(Me)&&(ee=(0,b.UM)(ee)?Ft.isLinear?0:.25:ee,Me=L.isTransposed?ee*z.height:ee*F.width);var hr=void 0,Tr=void 0,Dr=void 0,cn=void 0;L.isTransposed?(hr=st.minX,Tr=Math.min(z.minY,F.minY)-Me,Dr=st.width,cn=V.height+Me*2):(hr=Math.min(F.minX,z.minX)-Me,Tr=st.minY,Dr=V.width+Me*2,cn=st.height),at=[["M",hr,Tr],["L",hr+Dr,Tr],["L",hr+Dr,Tr+cn],["L",hr,Tr+cn],["Z"]]}else{var Jr=(0,b.YM)(S),Mn=(0,b.Z$)(S),mi=wh(Jr.getModel(),L).startAngle,da=wh(Mn.getModel(),L).endAngle,Sa=L.getCenter(),eo=L.getRadius(),Gn=L.innerRadius*eo;at=sl(Sa.x,Sa.y,eo,mi,da,Gn)}if(this.regionPath)this.regionPath.attr("path",at),this.regionPath.show();else{var Vi=(0,b.U2)(t,"style",DO);this.regionPath=Q.addShape({type:"path",name:"active-region",capture:!1,attrs:(0,P.pi)((0,P.pi)({},Vi),{path:at})})}}}},e.prototype.hide=function(){this.regionPath&&this.regionPath.hide(),this.items=null},e.prototype.destroy=function(){this.hide(),this.regionPath&&this.regionPath.remove(!0),r.prototype.destroy.call(this)},e}(Re),A3=C3,T3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.show=function(){var t=this.context,i=t.event,o=t.view,c=o.isTooltipLocked();if(!c){var p=this.timeStamp,g=+new Date,_=(0,b.U2)(t.view.getOptions(),"tooltip.showDelay",16);if(g-p>_){var S=this.location,I={x:i.x,y:i.y};(!S||!(0,b.Xy)(S,I))&&this.showTooltip(o,I),this.timeStamp=g,this.location=I}}},e.prototype.hide=function(){var t=this.context.view,i=t.getController("tooltip"),o=this.context.event,c=o.clientX,p=o.clientY;i.isCursorEntered({x:c,y:p})||t.isTooltipLocked()||(this.hideTooltip(t),this.location=null)},e.prototype.showTooltip=function(t,i){t.showTooltip(i)},e.prototype.hideTooltip=function(t){t.hideTooltip()},e}(Re),JE=T3,M3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.showTooltip=function(t,i){var o=ha(t);(0,b.S6)(o,function(c){var p=wo(t,c,i);c.showTooltip(p)})},e.prototype.hideTooltip=function(t){var i=ha(t);(0,b.S6)(i,function(o){o.hideTooltip()})},e}(JE),I3=M3,k3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.show=function(){var t=this.context,i=t.event,o=this.timeStamp,c=+new Date;if(c-o>16){var p=this.location,g={x:i.x,y:i.y};(!p||!(0,b.Xy)(p,g))&&this.showTooltip(g),this.timeStamp=c,this.location=g}},e.prototype.hide=function(){this.hideTooltip(),this.location=null},e.prototype.showTooltip=function(t){var i=this.context,o=i.event,c=o.target;if(c&&c.get("tip")){this.tooltip||this.renderTooltip();var p=c.get("tip");this.tooltip.update((0,P.pi)({title:p},t)),this.tooltip.show()}},e.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=this.context.view,o=i.canvas,c={start:{x:0,y:0},end:{x:o.get("width"),y:o.get("height")}},p=i.getTheme(),g=(0,b.U2)(p,["components","tooltip","domStyles"],{}),_=new kf({parent:o.get("el").parentNode,region:c,visible:!1,crosshairs:null,domStyles:(0,P.pi)({},(0,b.b$)({},g,(t={},t[au]={"max-width":"50%"},t[kl]={"word-break":"break-all"},t)))});_.init(),_.setCapture(!1),this.tooltip=_},e}(Re),L3=k3,P3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="",t}return e.prototype.hasState=function(t){return t.hasState(this.stateName)},e.prototype.setElementState=function(t,i){t.setState(this.stateName,i)},e.prototype.setState=function(){this.setStateEnable(!0)},e.prototype.clear=function(){var t=this.context.view;this.clearViewState(t)},e.prototype.clearViewState=function(t){var i=this,o=du(t,this.stateName);(0,b.S6)(o,function(c){i.setElementState(c,!1)})},e}(Re),K_=P3;function O3(r){return(0,b.U2)(r.get("delegateObject"),"item")}var F3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ignoreListItemStates=["unchecked"],t}return e.prototype.isItemIgnore=function(t,i){var o=this.ignoreListItemStates,c=o.filter(function(p){return i.hasState(t,p)});return!!c.length},e.prototype.setStateByComponent=function(t,i,o){var c=this.context.view,p=t.get("field"),g=Bo(c);this.setElementsStateByItem(g,p,i,o)},e.prototype.setStateByElement=function(t,i){this.setElementState(t,i)},e.prototype.isMathItem=function(t,i,o){var c=this.context.view,p=Wl(c,i),g=Qo(t,i);return!(0,b.UM)(g)&&o.name===p.getText(g)},e.prototype.setElementsStateByItem=function(t,i,o,c){var p=this;(0,b.S6)(t,function(g){p.isMathItem(g,i,o)&&g.setState(p.stateName,c)})},e.prototype.setStateEnable=function(t){var i=pi(this.context);if(i)Na(this.context)&&this.setStateByElement(i,t);else{var o=hi(this.context);if(wa(o)){var c=o.item,p=o.component;if(c&&p&&!this.isItemIgnore(c,p)){var g=this.context.event.gEvent;if(g&&g.fromShape&&g.toShape&&O3(g.fromShape)===O3(g.toShape))return;this.setStateByComponent(p,c,t)}}}},e.prototype.toggle=function(){var t=pi(this.context);if(t){var i=t.hasState(this.stateName);this.setElementState(t,!i)}},e.prototype.reset=function(){this.setStateEnable(!1)},e}(K_),Wy=F3,tw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(Wy),ew=tw,jp=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.cache={},t}return e.prototype.getColorScale=function(t,i){var o=i.geometry.getAttribute("color");if(!o)return null;var c=t.getScaleByField(o.getFields()[0]);return c},e.prototype.getLinkPath=function(t,i){var o=this.context.view,c=o.getCoordinate().isTransposed,p=t.shape.getCanvasBBox(),g=i.shape.getCanvasBBox(),_=c?[["M",p.minX,p.minY],["L",g.minX,g.maxY],["L",g.maxX,g.maxY],["L",p.maxX,p.minY],["Z"]]:[["M",p.maxX,p.minY],["L",g.minX,g.minY],["L",g.minX,g.maxY],["L",p.maxX,p.maxY],["Z"]];return _},e.prototype.addLinkShape=function(t,i,o,c){var p={opacity:.4,fill:i.shape.attr("fill")};t.addShape({type:"path",attrs:(0,P.pi)((0,P.pi)({},(0,b.b$)({},p,(0,b.mf)(c)?c(p,i):c)),{path:this.getLinkPath(i,o)})})},e.prototype.linkByElement=function(t,i){var o=this,c=this.context.view,p=this.getColorScale(c,t);if(p){var g=Qo(t,p.field);if(!this.cache[g]){var _=Es(c,p.field,g),S=this.linkGroup,I=S.addGroup();this.cache[g]=I;var L=_.length;(0,b.S6)(_,function(F,z){if(z<L-1){var V=_[z+1];o.addLinkShape(I,F,V,i)}})}}},e.prototype.removeLink=function(t){var i=this.getColorScale(this.context.view,t);if(i){var o=Qo(t,i.field);this.cache[o]&&(this.cache[o].remove(),this.cache[o]=null)}},e.prototype.link=function(t){var i=this.context;this.linkGroup||(this.linkGroup=i.view.foregroundGroup.addGroup({id:"link-by-color-group",capture:!1}));var o=pi(i);o&&this.linkByElement(o,t==null?void 0:t.style)},e.prototype.unlink=function(){var t=pi(this.context);t&&this.removeLink(t)},e.prototype.clear=function(){this.linkGroup&&this.linkGroup.clear(),this.cache={}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.linkGroup&&this.linkGroup.remove()},e}(Re),R3=jp,ug=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.startPoint=null,t.endPoint=null,t.isStarted=!1,t.effectSiblings=!1,t.effectByRecord=!1,t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.start=function(){this.clear(),this.startPoint=this.getCurrentPoint(),this.isStarted=!0},e.prototype.getIntersectElements=function(){var t=null;if(Li(this.context))t=Ta(this.context,10);else{var i=this.startPoint,o=this.isStarted?this.getCurrentPoint():this.endPoint;if(!i||!o)return;var c={minX:Math.min(i.x,o.x),minY:Math.min(i.y,o.y),maxX:Math.max(i.x,o.x),maxY:Math.max(i.y,o.y)},p=this.context.view;t=Vs(p,c)}return t},e.prototype.setStateEnable=function(t){if(this.effectSiblings&&!this.effectByRecord)this.setSiblingsState(t);else{var i=Bo(this.context.view),o=this.getIntersectElements();o&&o.length?this.effectByRecord?this.setSiblingsStateByRecord(o,t):this.setElementsState(o,t,i):this.clear()}},e.prototype.setSiblingsStateByRecord=function(t,i){var o=this,c=this.context.view,p=ha(c),g=t.map(function(I){return I.getModel().data}),_=c.getXScale().field,S=c.getYScales()[0].field;(0,b.S6)(p,function(I){var L=Bo(I),F=L.filter(function(z){var V=z.getModel().data;return Ds(g,V,_,S)});o.setElementsState(F,i,L)})},e.prototype.setSiblingsState=function(t){var i=this,o=this.context.view,c=ha(o);Li(this.context)&&(0,b.S6)(c,function(p){var g=Bo(p),_=ws(i.context,p,10);_&&_.length?i.setElementsState(_,t,g):i.clearViewState(p)})},e.prototype.setElementsState=function(t,i,o){var c=this;(0,b.S6)(o,function(p){t.includes(p)?c.setElementState(p,i):c.setElementState(p,!1)})},e.prototype.end=function(){this.isStarted=!1,this.endPoint=this.getCurrentPoint()},e.prototype.clear=function(){var t=this,i=this.context.view;if(this.effectSiblings){var o=ha(i);(0,b.S6)(o,function(c){t.clearViewState(c)})}else this.clearViewState(i)},e}(K_),Xy=ug,Q_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(Xy),J_=Q_,em=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setStateEnable=function(t){var i=pi(this.context);if(i){if(!Na(this.context))return;t?(this.clear(),this.setElementState(i,!0)):this.hasState(i)&&this.setElementState(i,!1)}},e.prototype.toggle=function(){var t=pi(this.context);if(t){var i=this.hasState(t);i||this.clear(),this.setElementState(t,!i)}},e.prototype.reset=function(){this.setStateEnable(!1)},e}(K_),rm=em,rw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(rm),D3=rw,lg="inactive",hc="active";function tx(r){var e=Bo(r);(0,b.S6)(e,function(t){t.hasState(hc)&&t.setState(hc,!1),t.hasState(lg)&&t.setState(lg,!1)})}function nw(r,e,t){(0,b.S6)(r,function(i){e(i)?(i.hasState(lg)&&i.setState(lg,!1),i.setState(hc,t)):(i.hasState(hc)&&i.setState(hc,!1),i.setState(lg,t))})}var S0=Se.INACTIVE,ff=Se.ACTIVE,B3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=ff,t}return e.prototype.setElementsStateByItem=function(t,i,o,c){var p=this,g=function(_){return p.isMathItem(_,i,o)};this.setHighlightBy(t,g,c)},e.prototype.setElementHighlight=function(t,i){i(t)?(t.hasState(S0)&&t.setState(S0,!1),t.setState(ff,!0)):t.hasState(ff)||t.setState(S0,!0)},e.prototype.setHighlightBy=function(t,i,o){var c=this;if(o)(0,b.S6)(t,function(_){c.setElementHighlight(_,i)});else{var p=du(this.context.view,ff),g=!0;(0,b.S6)(p,function(_){if(!i(_))return g=!1,!1}),g?this.clear():(0,b.S6)(t,function(_){i(_)&&(_.hasState(ff)&&_.setState(ff,!1),_.setState(S0,!0))})}},e.prototype.setElementState=function(t,i){var o=this.context.view,c=Bo(o);this.setHighlightBy(c,function(p){return t===p},i)},e.prototype.highlight=function(){this.setState()},e.prototype.clear=function(){var t=this.context.view;tx(t)},e}(Wy),iw=B3,BO=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setStateByElement=function(t,i){var o=this.context.view,c=t.geometry.getAttribute("color");if(c){var p=o.getScaleByField(c.getFields()[0]),g=Qo(t,p.field),_=Bo(o),S=_.filter(function(I){return Qo(I,p.field)===g});this.setHighlightBy(_,function(I){return S.includes(I)},i)}},e}(iw),NO=BO,zO=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setElementHighlight=function(t,i){i(t)?(t.hasState(S0)&&t.setState(S0,!1),t.setState(ff,!0)):(t.setState(S0,!0),t.hasState(ff)&&t.setState(ff,!1))},e.prototype.setStateByElement=function(t,i){var o=this.context.view,c=o.getXScale(),p=Qo(t,c.field),g=Bo(o),_=g.filter(function(S){return Qo(S,c.field)===p});this.setHighlightBy(g,function(S){return _.includes(S)},i)},e.prototype.toggle=function(){var t=pi(this.context);if(t){var i=t.hasState(this.stateName);this.setStateByElement(t,!i)}},e}(iw),UO=zO,Vd;(function(r){r.BEFORE_HIGHLIGHT="element-range-highlight:beforehighlight",r.AFTER_HIGHLIGHT="element-range-highlight:afterhighlight",r.BEFORE_CLEAR="element-range-highlight:beforeclear",r.AFTER_CLEAR="element-range-highlight:afterclear"})(Vd||(Vd={}));var N3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.clearViewState=function(t){tx(t)},e.prototype.highlight=function(){var t=this.context,i=t.view,o=t.event,c=this.getIntersectElements(),p={view:i,event:o,highlightElements:c};i.emit(Vd.BEFORE_HIGHLIGHT,fo.fromData(i,Vd.BEFORE_HIGHLIGHT,p)),this.setState(),i.emit(Vd.AFTER_HIGHLIGHT,fo.fromData(i,Vd.AFTER_HIGHLIGHT,p))},e.prototype.clear=function(){var t=this.context.view;t.emit(Vd.BEFORE_CLEAR,fo.fromData(t,Vd.BEFORE_CLEAR,{})),r.prototype.clear.call(this),t.emit(Vd.AFTER_CLEAR,fo.fromData(t,Vd.AFTER_CLEAR,{}))},e.prototype.setElementsState=function(t,i,o){nw(o,function(c){return t.indexOf(c)>=0},i)},e}(Xy),Yy=N3,ZO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.highlight=function(){this.setState()},e.prototype.setElementState=function(t,i){var o=this.context.view,c=Bo(o);nw(c,function(p){return t===p},i)},e.prototype.clear=function(){var t=this.context.view;tx(t)},e}(rm),aw=ZO,z3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(Xy),VO=z3,GO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(Wy),HO=GO,ow=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(rm),jO=ow,sw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="",t.ignoreItemStates=[],t}return e.prototype.getTriggerListInfo=function(){var t=hi(this.context),i=null;return wa(t)&&(i={item:t.item,list:t.component}),i},e.prototype.getAllowComponents=function(){var t=this,i=this.context.view,o=Da(i),c=[];return(0,b.S6)(o,function(p){p.isList()&&t.allowSetStateByElement(p)&&c.push(p)}),c},e.prototype.hasState=function(t,i){return t.hasState(i,this.stateName)},e.prototype.clearAllComponentsState=function(){var t=this,i=this.getAllowComponents();(0,b.S6)(i,function(o){o.clearItemsState(t.stateName)})},e.prototype.allowSetStateByElement=function(t){var i=t.get("field");if(!i)return!1;if(this.cfg&&this.cfg.componentNames){var o=t.get("name");if(this.cfg.componentNames.indexOf(o)===-1)return!1}var c=this.context.view,p=Wl(c,i);return p&&p.isCategory},e.prototype.allowSetStateByItem=function(t,i){var o=this.ignoreItemStates;if(o.length){var c=o.filter(function(p){return i.hasState(t,p)});return c.length===0}return!0},e.prototype.setStateByElement=function(t,i,o){var c=t.get("field"),p=this.context.view,g=Wl(p,c),_=Qo(i,c),S=g.getText(_);this.setItemsState(t,S,o)},e.prototype.setStateEnable=function(t){var i=this,o=pi(this.context);if(o){var c=this.getAllowComponents();(0,b.S6)(c,function(S){i.setStateByElement(S,o,t)})}else{var p=hi(this.context);if(wa(p)){var g=p.item,_=p.component;this.allowSetStateByElement(_)&&this.allowSetStateByItem(g,_)&&this.setItemState(_,g,t)}}},e.prototype.setItemsState=function(t,i,o){var c=this,p=t.getItems();(0,b.S6)(p,function(g){g.name===i&&c.setItemState(t,g,o)})},e.prototype.setItemState=function(t,i,o){t.setItemState(i,this.stateName,o)},e.prototype.setState=function(){this.setStateEnable(!0)},e.prototype.reset=function(){this.setStateEnable(!1)},e.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var i=t.list,o=t.item,c=this.hasState(i,o);this.setItemState(i,o,!c)}},e.prototype.clear=function(){var t=this.getTriggerListInfo();t?t.list.clearItemsState(this.stateName):this.clearAllComponentsState()},e}(Re),C0=sw,U3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(C0),Z3=U3,uw="inactive",ex="active";function V3(r){var e=r.getItems();(0,b.S6)(e,function(t){r.hasState(t,ex)&&r.setItemState(t,ex,!1),r.hasState(t,uw)&&r.setItemState(t,uw,!1)})}var nm="inactive",A0="active",G3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=A0,t.ignoreItemStates=["unchecked"],t}return e.prototype.setItemsState=function(t,i,o){this.setHighlightBy(t,function(c){return c.name===i},o)},e.prototype.setItemState=function(t,i,o){var c=t.getItems();this.setHighlightBy(t,function(p){return p===i},o)},e.prototype.setHighlightBy=function(t,i,o){var c=t.getItems();if(o)(0,b.S6)(c,function(_){i(_)?(t.hasState(_,nm)&&t.setItemState(_,nm,!1),t.setItemState(_,A0,!0)):t.hasState(_,A0)||t.setItemState(_,nm,!0)});else{var p=t.getItemsByState(A0),g=!0;(0,b.S6)(p,function(_){if(!i(_))return g=!1,!1}),g?this.clear():(0,b.S6)(c,function(_){i(_)&&(t.hasState(_,A0)&&t.setItemState(_,A0,!1),t.setItemState(_,nm,!0))})}},e.prototype.highlight=function(){this.setState()},e.prototype.clear=function(){var t=this.getTriggerListInfo();if(t)V3(t.list);else{var i=this.getAllowComponents();(0,b.S6)(i,function(o){o.clearItemsState(A0),o.clearItemsState(nm)})}},e}(C0),$y=G3,H3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(C0),j3=H3,W3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="unchecked",t}return e.prototype.unchecked=function(){this.setState()},e}(C0),rx=W3,cg="unchecked",Lv="checked",X3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=Lv,t}return e.prototype.setItemState=function(t,i,o){this.setCheckedBy(t,function(c){return c===i},o)},e.prototype.setCheckedBy=function(t,i,o){var c=t.getItems();o&&(0,b.S6)(c,function(p){i(p)?(t.hasState(p,cg)&&t.setItemState(p,cg,!1),t.setItemState(p,Lv,!0)):t.hasState(p,Lv)||t.setItemState(p,cg,!0)})},e.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var i=t.list,o=t.item,c=!(0,b.G)(i.getItems(),function(p){return i.hasState(p,cg)});c||i.hasState(o,cg)?this.setItemState(i,o,!0):this.reset()}},e.prototype.checked=function(){this.setState()},e.prototype.reset=function(){var t=this.getAllowComponents();(0,b.S6)(t,function(i){i.clearItemsState(Lv),i.clearItemsState(cg)})},e}(C0),nx=X3,fg="unchecked",qy=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.toggle=function(){var t,i,o,c,p,g,_,S,I=this.getTriggerListInfo();if(I!=null&&I.item){var L=I.list,F=I.item,z=L.getItems(),V=z.filter(function(Jr){return!L.hasState(Jr,fg)}),Q=z.filter(function(Jr){return L.hasState(Jr,fg)}),st=V[0];if(z.length===V.length)try{for(var at=(0,P.XA)(z),Ft=at.next();!Ft.done;Ft=at.next()){var Kt=Ft.value;L.setItemState(Kt,fg,Kt.id!==F.id)}}catch(Jr){t={error:Jr}}finally{try{Ft&&!Ft.done&&(i=at.return)&&i.call(at)}finally{if(t)throw t.error}}else if(z.length-Q.length===1)if(st.id===F.id)try{for(var ee=(0,P.XA)(z),Me=ee.next();!Me.done;Me=ee.next()){var Kt=Me.value;L.setItemState(Kt,fg,!1)}}catch(Jr){o={error:Jr}}finally{try{Me&&!Me.done&&(c=ee.return)&&c.call(ee)}finally{if(o)throw o.error}}else try{for(var hr=(0,P.XA)(z),Tr=hr.next();!Tr.done;Tr=hr.next()){var Kt=Tr.value;L.setItemState(Kt,fg,Kt.id!==F.id)}}catch(Jr){p={error:Jr}}finally{try{Tr&&!Tr.done&&(g=hr.return)&&g.call(hr)}finally{if(p)throw p.error}}else try{for(var Dr=(0,P.XA)(z),cn=Dr.next();!cn.done;cn=Dr.next()){var Kt=cn.value;L.setItemState(Kt,fg,Kt.id!==F.id)}}catch(Jr){_={error:Jr}}finally{try{cn&&!cn.done&&(S=Dr.return)&&S.call(Dr)}finally{if(_)throw _.error}}}},e}(C0),lw=qy,Ky="showRadio",im="legend-radio-tip",cw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.show=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var i=t.list,o=t.item;i.setItemState(o,Ky,!0)}},e.prototype.hide=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var i=t.list,o=t.item;i.setItemState(o,Ky,!1)}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.showTip=function(){var t=this.context,i=t.event,o=this.timeStamp,c=+new Date,p=this.context.event.target;if(c-o>16&&p.get("name")==="legend-item-radio"){var g=this.location,_={x:i.x,y:i.y};this.timeStamp=c,this.location=_,(!g||!(0,b.Xy)(g,_))&&this.showTooltip(_)}},e.prototype.hideTip=function(){this.hideTooltip(),this.location=null},e.prototype.showTooltip=function(t){var i=this.context,o=i.event,c=o.target;if(c&&c.get("tip")){this.tooltip||this.renderTooltip();var p=i.view.getCanvas().get("el").getBoundingClientRect(),g=p.x,_=p.y;this.tooltip.update((0,P.pi)((0,P.pi)({title:c.get("tip")},t),{x:t.x+g,y:t.y+_})),this.tooltip.show()}},e.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=(t={},t[au]={padding:"6px 8px",transform:"translate(-50%, -80%)",background:"rgba(0,0,0,0.75)",color:"#fff","border-radius":"2px","z-index":100},t[kl]={"font-size":"12px","line-height":"14px","margin-bottom":0,"word-break":"break-all"},t);document.getElementById(im)&&document.body.removeChild(document.getElementById(im));var o=new kf({parent:document.body,region:null,visible:!1,crosshairs:null,domStyles:i,containerId:im});o.init(),o.setCapture(!1),this.tooltip=o},e}(C0),fw=cw,Gd=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.maskShape=null,t.points=[],t.starting=!1,t.moving=!1,t.preMovePoint=null,t.shapeType="path",t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.emitEvent=function(t){var i="mask:".concat(t),o=this.context.view,c=this.context.event;o.emit(i,{target:this.maskShape,shape:this.maskShape,points:this.points,x:c.x,y:c.y})},e.prototype.createMask=function(){var t=this.context.view,i=this.getMaskAttrs(),o=t.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:(0,P.pi)({fill:"#C5D4EB",opacity:.3},i)});return o},e.prototype.getMaskPath=function(){return[]},e.prototype.show=function(){this.maskShape&&(this.maskShape.show(),this.emitEvent("show"))},e.prototype.start=function(t){this.starting=!0,this.moving=!1,this.points=[this.getCurrentPoint()],this.maskShape||(this.maskShape=this.createMask(),this.maskShape.set("capture",!1)),this.updateMask(t==null?void 0:t.maskStyle),this.emitEvent("start")},e.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint()},e.prototype.move=function(){if(!(!this.moving||!this.maskShape)){var t=this.getCurrentPoint(),i=this.preMovePoint,o=t.x-i.x,c=t.y-i.y,p=this.points;(0,b.S6)(p,function(g){g.x+=o,g.y+=c}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=t}},e.prototype.updateMask=function(t){var i=(0,b.b$)({},this.getMaskAttrs(),t);this.maskShape.attr(i)},e.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null},e.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.maskShape&&this.maskShape.set("capture",!0)},e.prototype.hide=function(){this.maskShape&&(this.maskShape.hide(),this.emitEvent("hide"))},e.prototype.resize=function(){this.starting&&this.maskShape&&(this.points.push(this.getCurrentPoint()),this.updateMask(),this.emitEvent("change"))},e.prototype.destroy=function(){this.points=[],this.maskShape&&this.maskShape.remove(),this.maskShape=null,this.preMovePoint=null,r.prototype.destroy.call(this)},e}(Re),ix=Gd;function ax(r){var e=(0,b.Z$)(r),t=0,i=0,o=0;if(r.length){var c=r[0];t=$s(c,e)/2,i=(e.x+c.x)/2,o=(e.y+c.y)/2}return{x:i,y:o,r:t}}var hw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="circle",t}return e.prototype.getMaskAttrs=function(){return ax(this.points)},e}(ix),ox=hw;function Qy(r){return{start:(0,b.YM)(r),end:(0,b.Z$)(r)}}function pw(r,e){var t=Math.min(r.x,e.x),i=Math.min(r.y,e.y),o=Math.abs(e.x-r.x),c=Math.abs(e.y-r.y);return{x:t,y:i,width:o,height:c}}var Y3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="rect",t}return e.prototype.getRegion=function(){return Qy(this.points)},e.prototype.getMaskAttrs=function(){var t=this.getRegion(),i=t.start,o=t.end;return pw(i,o)},e}(ix),dw=Y3;function sx(r){r.x=(0,b.uZ)(r.x,0,1),r.y=(0,b.uZ)(r.y,0,1)}function Jy(r,e,t,i){var o=null,c=null,p=i.invert((0,b.YM)(r)),g=i.invert((0,b.Z$)(r));return t&&(sx(p),sx(g)),e==="x"?(o=i.convert({x:p.x,y:0}),c=i.convert({x:g.x,y:1})):(o=i.convert({x:0,y:p.y}),c=i.convert({x:1,y:g.y})),{start:o,end:c}}var vw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dim="x",t.inPlot=!0,t}return e.prototype.getRegion=function(){var t=this.context.view.getCoordinate();return Jy(this.points,this.dim,this.inPlot,t)},e}(dw),ux=vw;function lx(r){var e=[];return r.length&&((0,b.S6)(r,function(t,i){i===0?e.push(["M",t.x,t.y]):e.push(["L",t.x,t.y])}),e.push(["L",r[0].x,r[0].y])),e}function gw(r){return{path:lx(r)}}var cx=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getMaskPath=function(){return lx(this.points)},e.prototype.getMaskAttrs=function(){return gw(this.points)},e.prototype.addPoint=function(){this.resize()},e}(ix),mw=cx;function fx(r){return bo(r,!0)}function am(r){return{path:fx(r)}}var hx=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getMaskPath=function(){return fx(this.points)},e.prototype.getMaskAttrs=function(){return am(this.points)},e}(mw),$3=hx,q3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.maskShapes=[],t.starting=!1,t.moving=!1,t.recordPoints=null,t.preMovePoint=null,t.shapeType="path",t.maskType="multi-mask",t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.emitEvent=function(t){var i="".concat(this.maskType,":").concat(t),o=this.context.view,c=this.context.event,p={type:this.shapeType,name:this.maskType,get:function(g){return p.hasOwnProperty(g)?p[g]:void 0}};o.emit(i,{target:p,maskShapes:this.maskShapes,multiPoints:this.recordPoints,x:c.x,y:c.y})},e.prototype.createMask=function(t){var i=this.context.view,o=this.recordPoints[t],c=this.getMaskAttrs(o),p=i.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:(0,P.pi)({fill:"#C5D4EB",opacity:.3},c)});this.maskShapes.push(p)},e.prototype.getMaskPath=function(t){return[]},e.prototype.show=function(){this.maskShapes.length>0&&(this.maskShapes.forEach(function(t){return t.show()}),this.emitEvent("show"))},e.prototype.start=function(t){this.recordPointStart(),this.starting=!0,this.moving=!1;var i=this.recordPoints.length-1;this.createMask(i),this.updateShapesCapture(!1),this.updateMask(t==null?void 0:t.maskStyle),this.emitEvent("start")},e.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint(),this.updateShapesCapture(!1)},e.prototype.move=function(){if(!(!this.moving||this.maskShapes.length===0)){var t=this.getCurrentPoint(),i=this.preMovePoint,o=t.x-i.x,c=t.y-i.y,p=this.getCurMaskShapeIndex();p>-1&&(this.recordPoints[p].forEach(function(g){g.x+=o,g.y+=c}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=t)}},e.prototype.updateMask=function(t){var i=this;this.recordPoints.forEach(function(o,c){var p=(0,b.b$)({},i.getMaskAttrs(o),t);i.maskShapes[c].attr(p)})},e.prototype.resize=function(){this.starting&&this.maskShapes.length>0&&(this.recordPointContinue(),this.updateMask(),this.emitEvent("change"))},e.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null,this.updateShapesCapture(!0)},e.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.updateShapesCapture(!0)},e.prototype.hide=function(){this.maskShapes.length>0&&(this.maskShapes.forEach(function(t){return t.hide()}),this.emitEvent("hide"))},e.prototype.remove=function(){var t=this.getCurMaskShapeIndex();t>-1&&(this.recordPoints.splice(t,1),this.maskShapes[t].remove(),this.maskShapes.splice(t,1),this.preMovePoint=null,this.updateShapesCapture(!0),this.emitEvent("change"))},e.prototype.clearAll=function(){this.recordPointClear(),this.maskShapes.forEach(function(t){return t.remove()}),this.maskShapes=[],this.preMovePoint=null},e.prototype.clear=function(){var t=this.getCurMaskShapeIndex();t===-1?(this.recordPointClear(),this.maskShapes.forEach(function(i){return i.remove()}),this.maskShapes=[],this.emitEvent("clearAll")):(this.recordPoints.splice(t,1),this.maskShapes[t].remove(),this.maskShapes.splice(t,1),this.preMovePoint=null,this.emitEvent("clearSingle")),this.preMovePoint=null},e.prototype.destroy=function(){this.clear(),r.prototype.destroy.call(this)},e.prototype.getRecordPoints=function(){var t;return(0,P.ev)([],(0,P.CR)((t=this.recordPoints)!==null&&t!==void 0?t:[]),!1)},e.prototype.recordPointStart=function(){var t=this.getRecordPoints(),i=this.getCurrentPoint();this.recordPoints=(0,P.ev)((0,P.ev)([],(0,P.CR)(t),!1),[[i]],!1)},e.prototype.recordPointContinue=function(){var t=this.getRecordPoints(),i=this.getCurrentPoint(),o=t.splice(-1,1)[0]||[];o.push(i),this.recordPoints=(0,P.ev)((0,P.ev)([],(0,P.CR)(t),!1),[o],!1)},e.prototype.recordPointClear=function(){this.recordPoints=[]},e.prototype.updateShapesCapture=function(t){this.maskShapes.forEach(function(i){return i.set("capture",t)})},e.prototype.getCurMaskShapeIndex=function(){var t=this.getCurrentPoint();return this.maskShapes.findIndex(function(i){var o=i.attrs,c=o.width,p=o.height,g=o.r,_=c===0||p===0||g===0;return!_&&i.isHit(t.x,t.y)})},e}(Re),px=q3,K3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="rect",t}return e.prototype.getRegion=function(t){return Qy(t)},e.prototype.getMaskAttrs=function(t){var i=this.getRegion(t),o=i.start,c=i.end;return pw(o,c)},e}(px),yw=K3,Q3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dim="x",t.inPlot=!0,t}return e.prototype.getRegion=function(t){var i=this.context.view.getCoordinate();return Jy(t,this.dim,this.inPlot,i)},e}(yw),_w=Q3,J3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="circle",t.getMaskAttrs=ax,t}return e}(px),t5=J3,e5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.getMaskPath=lx,t.getMaskAttrs=gw,t}return e.prototype.addPoint=function(){this.resize()},e}(px),xw=e5,om=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.getMaskPath=fx,t.getMaskAttrs=am,t}return e}(xw),bw=om,r5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setCursor=function(t){var i=this.context.view;i.getCanvas().setCursor(t)},e.prototype.default=function(){this.setCursor("default")},e.prototype.pointer=function(){this.setCursor("pointer")},e.prototype.move=function(){this.setCursor("move")},e.prototype.crosshair=function(){this.setCursor("crosshair")},e.prototype.wait=function(){this.setCursor("wait")},e.prototype.help=function(){this.setCursor("help")},e.prototype.text=function(){this.setCursor("text")},e.prototype.eResize=function(){this.setCursor("e-resize")},e.prototype.wResize=function(){this.setCursor("w-resize")},e.prototype.nResize=function(){this.setCursor("n-resize")},e.prototype.sResize=function(){this.setCursor("s-resize")},e.prototype.neResize=function(){this.setCursor("ne-resize")},e.prototype.nwResize=function(){this.setCursor("nw-resize")},e.prototype.seResize=function(){this.setCursor("se-resize")},e.prototype.swResize=function(){this.setCursor("sw-resize")},e.prototype.nsResize=function(){this.setCursor("ns-resize")},e.prototype.ewResize=function(){this.setCursor("ew-resize")},e.prototype.zoomIn=function(){this.setCursor("zoom-in")},e.prototype.zoomOut=function(){this.setCursor("zoom-out")},e}(Re),dx=r5,n5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filterView=function(t,i,o){var c=this;t.getScaleByField(i)&&t.filter(i,o),t.views&&t.views.length&&(0,b.S6)(t.views,function(p){c.filterView(p,i,o)})},e.prototype.filter=function(){var t=hi(this.context);if(t){var i=this.context.view,o=t.component,c=o.get("field");if(wa(t)){if(c){var p=o.getItemsByState("unchecked"),g=Wl(i,c),_=p.map(function(z){return z.name});_.length?this.filterView(i,c,function(z){var V=g.getText(z);return!_.includes(V)}):this.filterView(i,c,null),i.render(!0)}}else if(Ei(t)){var S=o.getValue(),I=(0,P.CR)(S,2),L=I[0],F=I[1];this.filterView(i,c,function(z){return z>=L&&z<=F}),i.render(!0)}}},e}(Re),i5=n5;function t1(r,e,t,i){var o=Math.min(t[e],i[e]),c=Math.max(t[e],i[e]),p=(0,P.CR)(r.range,2),g=p[0],_=p[1];if(o<g&&(o=g),c>_&&(c=_),o===_&&c===_)return null;var S=r.invert(o),I=r.invert(c);if(r.isCategory){var L=r.values.indexOf(S),F=r.values.indexOf(I),z=r.values.slice(L,F+1);return function(V){return z.includes(V)}}else return function(V){return V>=S&&V<=I}}var Uc;(function(r){r.FILTER="brush-filter-processing",r.RESET="brush-filter-reset",r.BEFORE_FILTER="brush-filter:beforefilter",r.AFTER_FILTER="brush-filter:afterfilter",r.BEFORE_RESET="brush-filter:beforereset",r.AFTER_RESET="brush-filter:afterreset"})(Uc||(Uc={}));var vx=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dims=["x","y"],t.startPoint=null,t.isStarted=!1,t}return e.prototype.hasDim=function(t){return this.dims.includes(t)},e.prototype.start=function(){var t=this.context;this.isStarted=!0,this.startPoint=t.getCurrentPoint()},e.prototype.filter=function(){var t,i;if(Li(this.context)){var o=this.context.event.target,c=o.getCanvasBBox();t={x:c.x,y:c.y},i={x:c.maxX,y:c.maxY}}else{if(!this.isStarted)return;t=this.startPoint,i=this.context.getCurrentPoint()}if(!(Math.abs(t.x-i.x)<5||Math.abs(t.x-i.y)<5)){var p=this.context,g=p.view,_=p.event,S={view:g,event:_,dims:this.dims};g.emit(Uc.BEFORE_FILTER,fo.fromData(g,Uc.BEFORE_FILTER,S));var I=g.getCoordinate(),L=I.invert(i),F=I.invert(t);if(this.hasDim("x")){var z=g.getXScale(),V=t1(z,"x",L,F);this.filterView(g,z.field,V)}if(this.hasDim("y")){var Q=g.getYScales()[0],V=t1(Q,"y",L,F);this.filterView(g,Q.field,V)}this.reRender(g,{source:Uc.FILTER}),g.emit(Uc.AFTER_FILTER,fo.fromData(g,Uc.AFTER_FILTER,S))}},e.prototype.end=function(){this.isStarted=!1},e.prototype.reset=function(){var t=this.context.view;if(t.emit(Uc.BEFORE_RESET,fo.fromData(t,Uc.BEFORE_RESET,{})),this.isStarted=!1,this.hasDim("x")){var i=t.getXScale();this.filterView(t,i.field,null)}if(this.hasDim("y")){var o=t.getYScales()[0];this.filterView(t,o.field,null)}this.reRender(t,{source:Uc.RESET}),t.emit(Uc.AFTER_RESET,fo.fromData(t,Uc.AFTER_RESET,{}))},e.prototype.filterView=function(t,i,o){t.filter(i,o)},e.prototype.reRender=function(t,i){t.render(!0,i)},e}(Re),e1=vx,a5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filterView=function(t,i,o){var c=ha(t);(0,b.S6)(c,function(p){p.filter(i,o)})},e.prototype.reRender=function(t){var i=ha(t);(0,b.S6)(i,function(o){o.render(!0)})},e}(e1),sm=a5,gx=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filter=function(){var t=hi(this.context),i=this.context.view,o=Bo(i);if(Li(this.context)){var c=Ta(this.context,10);c&&(0,b.S6)(o,function(Q){c.includes(Q)?Q.show():Q.hide()})}else if(t){var p=t.component,g=p.get("field");if(wa(t)){if(g){var _=p.getItemsByState("unchecked"),S=Wl(i,g),I=_.map(function(Q){return Q.name});(0,b.S6)(o,function(Q){var st=Qo(Q,g),at=S.getText(st);I.indexOf(at)>=0?Q.hide():Q.show()})}}else if(Ei(t)){var L=p.getValue(),F=(0,P.CR)(L,2),z=F[0],V=F[1];(0,b.S6)(o,function(Q){var st=Qo(Q,g);st>=z&&st<=V?Q.show():Q.hide()})}}},e.prototype.clear=function(){var t=Bo(this.context.view);(0,b.S6)(t,function(i){i.show()})},e.prototype.reset=function(){this.clear()},e}(Re),o5=gx,s5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.byRecord=!1,t}return e.prototype.filter=function(){Li(this.context)&&(this.byRecord?this.filterByRecord():this.filterByBBox())},e.prototype.filterByRecord=function(){var t=this.context.view,i=Ta(this.context,10);if(i){var o=t.getXScale().field,c=t.getYScales()[0].field,p=i.map(function(_){return _.getModel().data}),g=ha(t);(0,b.S6)(g,function(_){var S=Bo(_);(0,b.S6)(S,function(I){var L=I.getModel().data;Ds(p,L,o,c)?I.show():I.hide()})})}},e.prototype.filterByBBox=function(){var t=this,i=this.context.view,o=ha(i);(0,b.S6)(o,function(c){var p=ws(t.context,c,10),g=Bo(c);p&&(0,b.S6)(g,function(_){p.includes(_)?_.show():_.hide()})})},e.prototype.reset=function(){var t=ha(this.context.view);(0,b.S6)(t,function(i){var o=Bo(i);(0,b.S6)(o,function(c){c.show()})})},e}(Re),u5=s5,Ew=10,l5=5,c5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg={name:"button",text:"button",textStyle:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"},padding:[8,10],style:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},activeStyle:{fill:"#e6e6e6"}},t}return e.prototype.getButtonCfg=function(){return(0,b.b$)(this.buttonCfg,this.cfg)},e.prototype.drawButton=function(){var t=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:t.name}),o=i.addShape({type:"text",name:"button-text",attrs:(0,P.pi)({text:t.text},t.textStyle)}),c=o.getBBox(),p=ah(t.padding),g=i.addShape({type:"rect",name:"button-rect",attrs:(0,P.pi)({x:c.x-p[3],y:c.y-p[0],width:c.width+p[1]+p[3],height:c.height+p[0]+p[2]},t.style)});g.toBack(),i.on("mouseenter",function(){g.attr(t.activeStyle)}),i.on("mouseleave",function(){g.attr(t.style)}),this.buttonGroup=i},e.prototype.resetPosition=function(){var t=this.context.view,i=t.getCoordinate(),o=i.convert({x:1,y:1}),c=this.buttonGroup,p=c.getBBox(),g=ro.vs(null,[["t",o.x-p.width-Ew,o.y+p.height+l5]]);c.setMatrix(g)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),r.prototype.destroy.call(this)},e}(Re),f5=c5,h5=4,p5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.starting=!1,t.dragStart=!1,t}return e.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint()},e.prototype.drag=function(){if(this.startPoint){var t=this.context.getCurrentPoint(),i=this.context.view,o=this.context.event;this.dragStart?i.emit("drag",{target:o.target,x:o.x,y:o.y}):$s(t,this.startPoint)>h5&&(i.emit("dragstart",{target:o.target,x:o.x,y:o.y}),this.dragStart=!0)}},e.prototype.end=function(){if(this.dragStart){var t=this.context.view,i=this.context.event;t.emit("dragend",{target:i.target,x:i.x,y:i.y})}this.starting=!1,this.dragStart=!1},e}(Re),d5=p5,ww=5,v5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.starting=!1,t.isMoving=!1,t.startPoint=null,t.startMatrix=null,t}return e.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint(),this.startMatrix=this.context.view.middleGroup.getMatrix()},e.prototype.move=function(){if(this.starting){var t=this.startPoint,i=this.context.getCurrentPoint(),o=$s(t,i);if(o>ww&&!this.isMoving&&(this.isMoving=!0),this.isMoving){var c=this.context.view,p=ro.vs(this.startMatrix,[["t",i.x-t.x,i.y-t.y]]);c.backgroundGroup.setMatrix(p),c.foregroundGroup.setMatrix(p),c.middleGroup.setMatrix(p)}}},e.prototype.end=function(){this.isMoving&&(this.isMoving=!1),this.startMatrix=null,this.starting=!1,this.startPoint=null},e.prototype.reset=function(){this.starting=!1,this.startPoint=null,this.isMoving=!1;var t=this.context.view;t.backgroundGroup.resetMatrix(),t.foregroundGroup.resetMatrix(),t.middleGroup.resetMatrix(),this.isMoving=!1},e}(Re),g5=v5,r1="x",Sw="y",Cw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dims=[r1,Sw],t.cfgFields=["dims"],t.cacheScaleDefs={},t}return e.prototype.hasDim=function(t){return this.dims.includes(t)},e.prototype.getScale=function(t){var i=this.context.view;return t==="x"?i.getXScale():i.getYScales()[0]},e.prototype.resetDim=function(t){var i=this.context.view;if(this.hasDim(t)&&this.cacheScaleDefs[t]){var o=this.getScale(t);i.scale(o.field,this.cacheScaleDefs[t]),this.cacheScaleDefs[t]=null}},e.prototype.reset=function(){this.resetDim(r1),this.resetDim(Sw);var t=this.context.view;t.render(!0)},e}(Re),mx=Cw,m5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.startPoint=null,t.starting=!1,t.startCache={},t}return e.prototype.start=function(){var t=this;this.startPoint=this.context.getCurrentPoint(),this.starting=!0;var i=this.dims;(0,b.S6)(i,function(o){var c=t.getScale(o),p=c.min,g=c.max,_=c.values;t.startCache[o]={min:p,max:g,values:_}})},e.prototype.end=function(){this.startPoint=null,this.starting=!1,this.startCache={}},e.prototype.translate=function(){var t=this;if(this.starting){var i=this.startPoint,o=this.context.view.getCoordinate(),c=this.context.getCurrentPoint(),p=o.invert(i),g=o.invert(c),_=g.x-p.x,S=g.y-p.y,I=this.context.view,L=this.dims;(0,b.S6)(L,function(F){t.translateDim(F,{x:_*-1,y:S*-1})}),I.render(!0)}},e.prototype.translateDim=function(t,i){if(this.hasDim(t)){var o=this.getScale(t);o.isLinear&&this.translateLinear(t,o,i)}},e.prototype.translateLinear=function(t,i,o){var c=this.context.view,p=this.startCache[t],g=p.min,_=p.max,S=_-g,I=o[t]*S;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:i.nice,min:g,max:_}),c.scale(i.field,{nice:!1,min:g+I,max:_+I})},e.prototype.reset=function(){r.prototype.reset.call(this),this.startPoint=null,this.starting=!1},e}(mx),WO=m5,y5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.zoomRatio=.05,t}return e.prototype.zoomIn=function(){this.zoom(this.zoomRatio)},e.prototype.zoom=function(t){var i=this,o=this.dims;(0,b.S6)(o,function(c){i.zoomDim(c,t)}),this.context.view.render(!0)},e.prototype.zoomOut=function(){this.zoom(-1*this.zoomRatio)},e.prototype.zoomDim=function(t,i){if(this.hasDim(t)){var o=this.getScale(t);o.isLinear&&this.zoomLinear(t,o,i)}},e.prototype.zoomLinear=function(t,i,o){var c=this.context.view;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:i.nice,min:i.min,max:i.max});var p=this.cacheScaleDefs[t],g=p.max-p.min,_=i.min,S=i.max,I=o*g,L=_-I,F=S+I,z=F-L,V=z/g;F>L&&V<100&&V>.01&&c.scale(i.field,{nice:!1,min:_-I,max:S+I})},e}(mx),_5=y5;function x5(r){var e=r.gEvent.originalEvent;return e.deltaY>0}var b5=1,E5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.scroll=function(t){var i=this.context,o=i.view,c=i.event;if(o.getOptions().scrollbar){var p=(t==null?void 0:t.wheelDelta)||b5,g=o.getController("scrollbar"),_=o.getXScale(),S=o.getOptions().data,I=(0,b.dp)((0,b.I)(S,_.field)),L=(0,b.dp)(_.values),F=g.getValue(),z=Math.floor((I-L)*F),V=z+(x5(c)?p:-p),Q=p/(I-L)/1e4,st=(0,b.uZ)(V/(I-L)+Q,0,1);g.setValue(st)}},e}(Re),Aw=E5,w5="aixs-description-tooltip",S5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.show=function(){var t=this.context,i=hi(t).axis,o=i.cfg.title,c=o.description,p=o.text,g=o.descriptionTooltipStyle,_=t.event,S=_.x,I=_.y;this.tooltip||this.renderTooltip(),this.tooltip.update({title:p||"",customContent:function(){return`
          <div class="`.concat(au,'" style={').concat(g,`}>
            <div class="`).concat(kl,`">
              \u5B57\u6BB5\u8BF4\u660E\uFF1A`).concat(c,`
            </div>
          </div>
        `)},x:S,y:I}),this.tooltip.show()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.hide=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=this.context.view,o=i.canvas,c={start:{x:0,y:0},end:{x:o.get("width"),y:o.get("height")}},p=new kf({parent:o.get("el").parentNode,region:c,visible:!1,containerId:w5,domStyles:(0,P.pi)({},(0,b.b$)({},(t={},t[au]={"max-width":"50%",padding:"10px","line-height":"15px","font-size":"12px",color:"rgba(0, 0, 0, .65)"},t[kl]={"word-break":"break-all","margin-bottom":"3px"},t)))});p.init(),p.setCapture(!1),this.tooltip=p},e}(Re),C5=S5;Hi("dark",rr(Md)),ft("canvas",be),ft("svg",ut),O("Polygon",vM),O("Interval",cM),O("Schema",mM),O("Path",M_),O("Point",cE),O("Line",lE),O("Area",rM),O("Edge",aE),O("Heatmap",aM),O("Violin",pE),Rn("base",To),Rn("interval",LM),Rn("pie",EE),Rn("polar",bE),aa("overlap",PE),aa("distribute",RM),aa("fixed-overlap",LE),aa("hide-overlap",GM),aa("limit-in-shape",ME),aa("limit-in-canvas",BM),aa("limit-in-plot",kO),aa("pie-outer",CE),aa("adjust-color",EO),aa("interval-adjust-position",SO),aa("interval-hide-overlap",YM),aa("point-adjust-position",GE),aa("pie-spider",TE),aa("path-adjust-position",IO),nr("fade-in",LO),nr("fade-out",cp),nr("grow-in-x",ta),nr("grow-in-xy",G_),nr("grow-in-y",fp),nr("scale-in-x",KM),nr("scale-in-y",QM),nr("wave-in",t3),nr("zoom-in",PO),nr("zoom-out",e3),nr("position-update",zy),nr("sector-path-update",JM),nr("path-in",w0),$h("rect",l3),$h("mirror",s3),$h("list",i3),$h("matrix",YE),$h("circle",n3),$h("tree",f3),Th("axis",Y_),Th("legend",y3),Th("tooltip",Qt),Th("annotation",Zd),Th("slider",x3),Th("scrollbar",w3),jr("tooltip",JE),jr("sibling-tooltip",I3),jr("ellipsis-text",L3),jr("element-active",ew),jr("element-single-active",D3),jr("element-range-active",J_),jr("element-highlight",iw),jr("element-highlight-by-x",UO),jr("element-highlight-by-color",NO),jr("element-single-highlight",aw),jr("element-range-highlight",Yy),jr("element-sibling-highlight",Yy,{effectSiblings:!0,effectByRecord:!0}),jr("element-selected",HO),jr("element-single-selected",jO),jr("element-range-selected",VO),jr("element-link-by-color",R3),jr("active-region",A3),jr("list-active",Z3),jr("list-selected",j3),jr("list-highlight",$y),jr("list-unchecked",rx),jr("list-checked",nx),jr("list-focus",lw),jr("list-radio",fw),jr("legend-item-highlight",$y,{componentNames:["legend"]}),jr("axis-label-highlight",$y,{componentNames:["axis"]}),jr("axis-description",C5),jr("rect-mask",dw),jr("x-rect-mask",ux,{dim:"x"}),jr("y-rect-mask",ux,{dim:"y"}),jr("circle-mask",ox),jr("path-mask",mw),jr("smooth-path-mask",$3),jr("rect-multi-mask",yw),jr("x-rect-multi-mask",_w,{dim:"x"}),jr("y-rect-multi-mask",_w,{dim:"y"}),jr("circle-multi-mask",t5),jr("path-multi-mask",xw),jr("smooth-path-multi-mask",bw),jr("cursor",dx),jr("data-filter",i5),jr("brush",e1),jr("brush-x",e1,{dims:["x"]}),jr("brush-y",e1,{dims:["y"]}),jr("sibling-filter",sm),jr("sibling-x-filter",sm),jr("sibling-y-filter",sm),jr("element-filter",o5),jr("element-sibling-filter",u5),jr("element-sibling-filter-record",u5,{byRecord:!0}),jr("view-drag",d5),jr("view-move",g5),jr("scale-translate",WO),jr("scale-zoom",_5),jr("reset-button",f5,{name:"reset-button",text:"reset"}),jr("mousewheel-scroll",Aw);function Wp(r){return r.isInPlot()}Ye("tooltip",{start:[{trigger:"plot:mousemove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"plot:touchmove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseleave",action:"tooltip:hide"},{trigger:"plot:leave",action:"tooltip:hide"},{trigger:"plot:touchend",action:"tooltip:hide"}]}),Ye("ellipsis-text",{start:[{trigger:"legend-item-name:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"legend-item-name:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"legend-item-name:mouseleave",action:"ellipsis-text:hide"},{trigger:"legend-item-name:touchend",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseleave",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseout",action:"ellipsis-text:hide"},{trigger:"axis-label:touchend",action:"ellipsis-text:hide"}]}),Ye("element-active",{start:[{trigger:"element:mouseenter",action:"element-active:active"}],end:[{trigger:"element:mouseleave",action:"element-active:reset"}]}),Ye("element-selected",{start:[{trigger:"element:click",action:"element-selected:toggle"}]}),Ye("element-highlight",{start:[{trigger:"element:mouseenter",action:"element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight:reset"}]}),Ye("element-highlight-by-x",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-x:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-x:reset"}]}),Ye("element-highlight-by-color",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-color:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-color:reset"}]}),Ye("legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","element-active:reset"]}]}),Ye("legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","element-highlight:reset"]}]}),Ye("axis-label-highlight",{start:[{trigger:"axis-label:mouseenter",action:["axis-label-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"axis-label:mouseleave",action:["axis-label-highlight:reset","element-highlight:reset"]}]}),Ye("element-list-highlight",{start:[{trigger:"element:mouseenter",action:["list-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"element:mouseleave",action:["list-highlight:reset","element-highlight:reset"]}]}),Ye("element-range-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(r){return!r.isInShape("mask")},action:["rect-mask:start","rect-mask:show"]},{trigger:"mask:dragstart",action:["rect-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:drag",action:["rect-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end"]},{trigger:"mask:dragend",action:["rect-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(r){return!r.isInPlot()},action:["element-range-highlight:clear","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","rect-mask:hide"]}]}),Ye("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Wp,action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:Wp,action:["rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Wp,action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide","reset-button:show"]}],rollback:[{trigger:"reset-button:click",action:["brush:reset","reset-button:hide","cursor:crosshair"]}]}),Ye("brush-visible",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end","rect-mask:hide","element-filter:filter","element-range-highlight:clear"]}],rollback:[{trigger:"dblclick",action:["element-filter:clear"]}]}),Ye("brush-x",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Wp,action:["brush-x:start","x-rect-mask:start","x-rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:Wp,action:["x-rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Wp,action:["brush-x:filter","brush-x:end","x-rect-mask:end","x-rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]}),Ye("element-path-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Wp,action:"path-mask:start"},{trigger:"mousedown",isEnable:Wp,action:"path-mask:show"}],processing:[{trigger:"mousemove",action:"path-mask:addPoint"}],end:[{trigger:"mouseup",action:"path-mask:end"}],rollback:[{trigger:"dblclick",action:"path-mask:hide"}]}),Ye("brush-x-multi",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"mousedown",isEnable:Wp,action:["x-rect-multi-mask:start","x-rect-multi-mask:show"]},{trigger:"mask:dragstart",action:["x-rect-multi-mask:moveStart"]}],processing:[{trigger:"mousemove",isEnable:function(r){return!ga(r)},action:["x-rect-multi-mask:resize"]},{trigger:"multi-mask:change",action:"element-range-highlight:highlight"},{trigger:"mask:drag",action:["x-rect-multi-mask:move"]}],end:[{trigger:"mouseup",action:["x-rect-multi-mask:end"]},{trigger:"mask:dragend",action:["x-rect-multi-mask:moveEnd"]}],rollback:[{trigger:"dblclick",action:["x-rect-multi-mask:clear","cursor:crosshair"]},{trigger:"multi-mask:clearAll",action:["element-range-highlight:clear"]},{trigger:"multi-mask:clearSingle",action:["element-range-highlight:highlight"]}]}),Ye("element-single-selected",{start:[{trigger:"element:click",action:"element-single-selected:toggle"}]}),Ye("legend-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:["cursor:pointer","list-radio:show"]},{trigger:"legend-item:mouseleave",action:["cursor:default","list-radio:hide"]}],start:[{trigger:"legend-item:click",isEnable:function(r){return!r.isInShape("legend-item-radio")},action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","data-filter:filter","list-radio:show"]},{trigger:"legend-item-radio:mouseenter",action:["list-radio:showTip"]},{trigger:"legend-item-radio:mouseleave",action:["list-radio:hideTip"]},{trigger:"legend-item-radio:click",action:["list-focus:toggle","data-filter:filter","list-radio:show"]}]}),Ye("continuous-filter",{start:[{trigger:"legend:valuechanged",action:"data-filter:filter"}]}),Ye("continuous-visible-filter",{start:[{trigger:"legend:valuechanged",action:"element-filter:filter"}]}),Ye("legend-visible-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:"cursor:pointer"},{trigger:"legend-item:mouseleave",action:"cursor:default"}],start:[{trigger:"legend-item:click",action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","element-filter:filter"]}]}),Ye("active-region",{start:[{trigger:"plot:mousemove",action:"active-region:show"}],end:[{trigger:"plot:mouseleave",action:"active-region:hide"}]}),Ye("axis-description",{start:[{trigger:"axis-description:mousemove",action:"axis-description:show"}],end:[{trigger:"axis-description:mouseleave",action:"axis-description:hide"}]});function Tw(r){return r.gEvent.preventDefault(),r.gEvent.originalEvent.deltaY>0}Ye("view-zoom",{start:[{trigger:"plot:mousewheel",isEnable:function(r){return Tw(r.event)},action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:function(r){return!Tw(r.event)},action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]}),Ye("sibling-tooltip",{start:[{trigger:"plot:mousemove",action:"sibling-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"sibling-tooltip:hide"}]}),Ye("plot-mousewheel-scroll",{start:[{trigger:"plot:mousewheel",action:"mousewheel-scroll:scroll"}]});var Df=["type","alias","tickCount","tickInterval","min","max","nice","minLimit","maxLimit","range","tickMethod","base","exponent","mask","sync"],hp;(function(r){r.ERROR="error",r.WARN="warn",r.INFO="log"})(hp||(hp={}));var Mw="AntV/G2Plot";function Iw(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var i=0;return Mw+": "+r.replace(/%s/g,function(){return""+e[i++]})}function XO(r,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];if(!r){var o=new Error(Iw.apply(void 0,__spreadArrays([e],t)));throw o.name=Mw,o}}function Hd(r,e,t){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];e||console[r](Iw.apply(void 0,(0,P.pr)([t],i)))}function ps(r,e){var t={};return r!==null&&typeof r=="object"&&e.forEach(function(i){var o=r[i];o!==void 0&&(t[i]=o)}),t}function yx(r,e){if(!r)return{};var t=r.filter(function(c){var p=(0,b.U2)(c,[e]);return(0,b.hj)(p)&&!isNaN(p)}),i=t.every(function(c){return(0,b.U2)(c,[e])>=0}),o=t.every(function(c){return(0,b.U2)(c,[e])<=0});return i?{min:0}:o?{max:0}:{}}function _x(r,e,t,i,o){if(o===void 0&&(o=[]),!Array.isArray(r))return{nodes:[],links:[]};var c=[],p={},g=-1;return r.forEach(function(_){var S=_[e],I=_[t],L=_[i],F=ps(_,o);p[S]||(p[S]=(0,P.pi)({id:++g,name:S},F)),p[I]||(p[I]=(0,P.pi)({id:++g,name:I},F)),c.push((0,P.pi)({source:p[S].id,target:p[I].id,value:L},F))}),{nodes:Object.values(p).sort(function(_,S){return _.id-S.id}),links:c}}function Pv(r,e){var t=(0,b.hX)(r,function(i){var o=i[e];return o===null||typeof o=="number"&&!isNaN(o)});return Hd(hp.WARN,t.length===r.length,"illegal data existed in chart data."),t}var A5=5,T5={}.toString,kw=function(r,e){return T5.call(r)==="[object "+e+"]"},M5=function(r){return kw(r,"Array")},I5=function(r){return typeof r=="object"&&r!==null},Lw=function(r){if(!I5(r)||!kw(r,"Object"))return!1;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e},T0=function(r,e,t,i){t=t||0,i=i||A5;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var c=e[o];c?Lw(c)?(Lw(r[o])||(r[o]={}),t<i?T0(r[o],c,t+1,i):r[o]=e[o]):M5(c)?(r[o]=[],r[o]=r[o].concat(c)):r[o]=c:r[o]=c}},pn=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var i=0;i<e.length;i+=1)T0(r,e[i]);return r};function xx(r){if(!r)return{width:0,height:0};var e=getComputedStyle(r);return{width:(r.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10),height:(r.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)}}function za(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return function(t){return r.reduce(function(i,o){return o(i)},t)}}function Ac(r,e){return r.geometries.find(function(t){return t.type===e})}function n1(r){return(0,b.u4)(r.geometries,function(e,t){return e.concat(t.elements)},[])}function um(r){return(0,b.U2)(r,["views","length"],0)<=0?n1(r):(0,b.u4)(r.views,function(e,t){return e.concat(um(t))},n1(r))}function k5(r){return(0,b.U2)(r,["views","length"],0)<=0?r.geometries:(0,b.u4)(r.views,function(e,t){return e.concat(t.geometries)},r.geometries)}function Kl(r){if(!(0,b.P9)(r,"Object"))return r;var e=(0,P.pi)({},r);return e.formatter&&!e.content&&(e.content=e.formatter),e}var M0;function Ov(){return M0||(M0=document.createElement("canvas").getContext("2d")),M0}var Pw=(0,b.HP)(function(r,e){e===void 0&&(e={});var t=e.fontSize,i=e.fontFamily,o=i===void 0?"sans-serif":i,c=e.fontWeight,p=e.fontStyle,g=e.fontVariant,_=Ov();_.font=[p,c,g,t+"px",o].join(" ");var S=_.measureText((0,b.HD)(r)?r:"");return S.width},function(r,e){return e===void 0&&(e={}),(0,P.pr)([r],(0,b.VO)(e)).join("")});function Ql(r){return typeof r=="number"&&!isNaN(r)}function L5(r,e,t){var i=Math.min(e,t),o=Math.max(e,t);return r>=i&&r<=o}function pp(r){if((0,b.hj)(r))return[r,r,r,r];if((0,b.kJ)(r)){var e=r.length;if(e===1)return[r[0],r[0],r[0],r[0]];if(e===2)return[r[0],r[1],r[0],r[1]];if(e===3)return[r[0],r[1],r[2],r[1]];if(e===4)return r}return[0,0,0,0]}function lm(r,e,t){e===void 0&&(e="bottom"),t===void 0&&(t=25);var i=pp(r),o=[e.startsWith("top")?t:0,e.startsWith("right")?t:0,e.startsWith("bottom")?t:0,e.startsWith("left")?t:0];return[i[0]+o[0],i[1]+o[1],i[2]+o[2],i[3]+o[3]]}function bx(r){var e=r.map(function(i){return pp(i)}),t=[0,0,0,0];return e.length>0&&(t=t.map(function(i,o){return e.forEach(function(c,p){i+=e[p][o]}),i})),t}function Tc(r,e){var t=[];if(r.length){t.push(["M",r[0].x,r[0].y]);for(var i=1,o=r.length;i<o;i+=1){var c=r[i];t.push(["L",c.x,c.y])}e&&t.push(["Z"])}return t}var P5=function(r,e,t,i){var o=[],c,p,g=!!i,_,S;if(g){_=[1/0,1/0],S=[-1/0,-1/0];for(var I=0,L=r.length;I<L;I++){var F=r[I];_=Ia.VV([0,0],_,F),S=Ia.Fp([0,0],S,F)}_=Ia.VV([0,0],_,i[0]),S=Ia.Fp([0,0],S,i[1])}for(var I=0,z=r.length;I<z;I++){var F=r[I];if(t)c=r[I?I-1:z-1],p=r[(I+1)%z];else if(I===0||I===z-1){o.push(F);continue}else c=r[I-1],p=r[I+1];var V=[0,0];V=Ia.lu(V,p,c),V=Ia.bA(V,V,e);var Q=Ia.TE(F,c),st=Ia.TE(F,p),at=Q+st;at!==0&&(Q/=at,st/=at);var Ft=Ia.bA([0,0],V,-Q),Kt=Ia.bA([0,0],V,st),ee=Ia.IH([0,0],F,Ft),Me=Ia.IH([0,0],F,Kt);g&&(ee=Ia.Fp([0,0],ee,_),ee=Ia.VV([0,0],ee,S),Me=Ia.Fp([0,0],Me,_),Me=Ia.VV([0,0],Me,S)),o.push(ee),o.push(Me)}return t&&o.push(o.shift()),o};function O5(r,e,t){for(var i=!!e,o=[],c=0,p=r.length;c<p;c+=2)o.push([r[c],r[c+1]]);for(var g=P5(o,.4,i,t),_=o.length,S=[],I,L,F,c=0;c<_-1;c++)I=g[c*2],L=g[c*2+1],F=o[c+1],S.push(["C",I[0],I[1],L[0],L[1],F[0],F[1]]);return i&&(I=g[_],L=g[_+1],F=o[0],S.push(["C",I[0],I[1],L[0],L[1],F[0],F[1]])),S}function F5(r,e,t){var i=[],o=r[0],c=null;if(r.length<=2)return Tc(r,e);for(var p=0,g=r.length;p<g;p++){var _=r[p];(!c||!(c.x===_.x&&c.y===_.y))&&(i.push(_.x),i.push(_.y),c=_)}var S=t||[[0,0],[1,1]],I=O5(i,e,S);return I.unshift(["M",o.x,o.y]),I}function Ow(r){if(!r)return r;var e=r.match(/(([A-Z]{0,1}[a-z]*[^A-Z])|([A-Z]{1}))/g);return e.map(function(t){return t.toLowerCase()}).join("-")}function Fw(r){var e={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",display:"flex",justifyContent:"center",alignItems:"center"},t=["stroke","lineWidth","shadowColor","strokeOpacity","shadowBlur","shadowOffsetX","shadowOffsetY","fill"];(0,b.U2)(r,"fill")&&(e.color=r.fill);var i=ps(r,t),o=i.shadowColor,c=i.shadowBlur,p=c===void 0?0:c,g=i.shadowOffsetX,_=g===void 0?0:g,S=i.shadowOffsetY,I=S===void 0?0:S;e["text-shadow"]=""+[o,_+"px",I+"px",p+"px"].join(" ");var L=ps(r,t),F=L.stroke,z=L.lineWidth,V=z===void 0?0:z;return e["-webkit-text-stroke"]=""+[V+"px",F].join(" "),(0,b.S6)(r,function(Q,st){["fontSize"].includes(st)&&(0,b.hj)(Q)?e[Ow(st)]=Q+"px":st&&!t.includes(st)&&(e[Ow(st)]=""+Q)}),e}function Rw(r,e){r.style["pointer-events"]="none",(0,b.S6)(e,function(t,i){i&&t&&(r.style[i]=t)})}var i1=function(r,e,t){var i=e.statistic,o=e.plotType,c=i.title,p=i.content;[c,p].forEach(function(g,_){if(g){var S="";_===0?S=p?"translate(-50%, -100%)":"translate(-50%, -50%)":S=c?"translate(-50%, 0)":"translate(-50%, -50%)";var I=(0,b.mf)(g.style)?g.style(t):g.style;r.annotation().html((0,P.pi)({position:["50%","50%"],html:function(L,F){var z=F.getCoordinate(),V=0;if(o==="pie"||o==="ring-progress")V=z.getRadius()*z.innerRadius*2;else if(o==="liquid"){var Q=(0,b.U2)(F.geometries,[0,"elements",0,"shape"]);if(Q){var st=Q.find(function(ee){return ee.get("name")==="wrap"}),at=st.getCanvasBBox().width;V=at}}else V||(V=z.getWidth());Rw(L,(0,P.pi)({width:V+"px",transform:S},Fw(I)));var Ft=F.getData();if(g.customHtml)return g.customHtml(L,F,t,Ft);var Kt=g.content;return g.formatter&&(Kt=g.formatter(t,Ft)),Kt?(0,b.HD)(Kt)?Kt:""+Kt:"<div></div>"},key:(_===0?"top":"bottom")+"-statistic"},ps(g,["offsetX","offsetY","rotate","style","formatter"])))}})},Dw=function(r,e,t){var i=e.statistic,o=i.title,c=i.content;[o,c].forEach(function(p){if(p){var g=(0,b.mf)(p.style)?p.style(t):p.style;r.annotation().html((0,P.pi)({position:["50%","100%"],html:function(_,S){var I=S.getCoordinate(),L=S.views[0].getCoordinate(),F=L.getCenter(),z=L.getRadius(),V=Math.max(Math.sin(L.startAngle),Math.sin(L.endAngle))*z,Q=F.y+V-I.y.start-parseFloat((0,b.U2)(g,"fontSize",0)),st=I.getRadius()*I.innerRadius*2;Rw(_,(0,P.pi)({width:st+"px",transform:"translate(-50%, "+Q+"px)"},Fw(g)));var at=S.getData();if(p.customHtml)return p.customHtml(_,S,t,at);var Ft=p.content;return p.formatter&&(Ft=p.formatter(t,at)),Ft?(0,b.HD)(Ft)?Ft:""+Ft:"<div></div>"}},ps(p,["offsetX","offsetY","rotate","style","formatter"])))}})};function Ex(r,e){return e?(0,b.u4)(e,function(t,i,o){return t.replace(new RegExp("{\\s*"+o+"\\s*}","g"),i)},r):r}function yo(r,e){return r.views.find(function(t){return t.id===e})}function cm(r){var e=r.parent;return e?e.views:[]}function Bw(r){return cm(r).filter(function(e){return e!==r})}function fm(r,e,t){t===void 0&&(t=r.geometries),typeof e=="boolean"?r.animate(e):r.animate(!0),(0,b.S6)(t,function(i){var o;(0,b.mf)(e)?o=e(i.type||i.shapeType,i)||!0:o=e,i.animate(o)})}function hm(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function pm(r,e){e===void 0&&(e=r);var t=document.createElement("canvas"),i=hm();t.width=r*i,t.height=e*i,t.style.width=r+"px",t.style.height=e+"px";var o=t.getContext("2d");return o.scale(i,i),t}function a1(r,e,t,i){i===void 0&&(i=t);var o=e.backgroundColor,c=e.opacity;r.globalAlpha=c,r.fillStyle=o,r.beginPath(),r.fillRect(0,0,t,i),r.closePath()}function Nw(r,e,t){var i=r+e;return t?i*2:i}function zw(r,e){var t=e?[[r*.25,r*.25],[r*.75,r*.75]]:[[r*.5,r*.5]];return t}function o1(r,e){var t=e*Math.PI/180,i={a:Math.cos(t)*(1/r),b:Math.sin(t)*(1/r),c:-Math.sin(t)*(1/r),d:Math.cos(t)*(1/r),e:0,f:0};return i}var R5={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function D5(r,e,t,i){var o=e.size,c=e.fill,p=e.lineWidth,g=e.stroke,_=e.fillOpacity;r.beginPath(),r.globalAlpha=_,r.fillStyle=c,r.strokeStyle=g,r.lineWidth=p,r.arc(t,i,o/2,0,2*Math.PI,!1),r.fill(),p&&r.stroke(),r.closePath()}function Uw(r){var e=pn({},R5,r),t=e.size,i=e.padding,o=e.isStagger,c=e.rotation,p=Nw(t,i,o),g=zw(p,o),_=pm(p,p),S=_.getContext("2d");a1(S,e,p);for(var I=0,L=g;I<L.length;I++){var F=L[I],z=F[0],V=F[1];D5(S,e,z,V)}var Q=S.createPattern(_,"repeat");if(Q){var st=hm(),at=o1(st,c);Q.setTransform(at)}return Q}var hg={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function Zw(r,e,t){var i=e.stroke,o=e.lineWidth,c=e.strokeOpacity,p=new Path2D(t);r.globalAlpha=c,r.lineCap="square",r.strokeStyle=o?i:"transparent",r.lineWidth=o,r.stroke(p)}function Sx(r){var e=pn({},hg,r),t=e.spacing,i=e.rotation,o=e.lineWidth,c=t+o||1,p=t+o||1,g=`
            M 0 0 L `+c+` 0
            M 0 `+p+" L "+c+" "+p+`
            `,_=pm(c,p),S=_.getContext("2d");a1(S,e,c,p),Zw(S,e,g);var I=S.createPattern(_,"repeat");if(I){var L=hm(),F=o1(L,i);I.setTransform(F)}return I}var Vw={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function B5(r,e,t,i){var o=e.stroke,c=e.size,p=e.fill,g=e.lineWidth,_=e.fillOpacity;r.globalAlpha=_,r.strokeStyle=o,r.lineWidth=g,r.fillStyle=p,r.strokeRect(t-c/2,i-c/2,c,c),r.fillRect(t-c/2,i-c/2,c,c)}function N5(r){var e=pn({},Vw,r),t=e.size,i=e.padding,o=e.isStagger,c=e.rotation,p=Nw(t,i,o),g=zw(p,o),_=pm(p,p),S=_.getContext("2d");a1(S,e,p);for(var I=0,L=g;I<L.length;I++){var F=L[I],z=F[0],V=F[1];B5(S,e,z,V)}var Q=S.createPattern(_,"repeat");if(Q){var st=hm(),at=o1(st,c);Q.setTransform(at)}return Q}function Gw(r){var e=r.type,t=r.cfg,i;switch(e){case"dot":i=Uw(t);break;case"line":i=Sx(t);break;case"square":i=N5(t);break;default:break}return i}function Vo(r){var e=this;return function(t){var i,o=t.options,c=t.chart,p=o.pattern;if(!p)return t;var g=function(_){for(var S,I,L,F=[],z=1;z<arguments.length;z++)F[z-1]=arguments[z];var V=c.getTheme().defaultColor,Q=V,st=(I=(S=c.geometries)===null||S===void 0?void 0:S[0])===null||I===void 0?void 0:I.getAttribute("color");if(st){var at=st.getFields()[0],Ft=(0,b.U2)(_,at);Q=os.getMappingValue(st,Ft,((L=st.values)===null||L===void 0?void 0:L[0])||V)}var Kt=p;typeof p=="function"&&(Kt=p.call(e,_,Q)),Kt instanceof CanvasPattern||(Kt=Gw(pn({},{cfg:{backgroundColor:Q}},Kt)));var ee=o[r];return(0,P.pi)((0,P.pi)({},typeof ee=="function"?ee.call.apply(ee,(0,P.pr)([e,_],F)):ee||{}),{fill:Kt||Q})};return pn({},t,{options:(i={},i[r]=g,i)})}}function jd(r){var e=r.chart,t=r.options,i=t.legend,o=t.colorField,c=t.seriesField;return i===!1?e.legend(!1):(o||c)&&e.legend(o||c,i),r}function Ol(r){var e=r.chart,t=r.options,i=t.tooltip;return i!==void 0&&e.tooltip(i),r}function lu(r){var e=r.chart,t=r.options,i=t.interactions;return(0,b.S6)(i,function(o){o.enable===!1?e.removeInteraction(o.type):e.interaction(o.type,o.cfg||{})}),r}function ds(r){var e=r.chart,t=r.options,i=t.animation;return fm(e,i),r}function Go(r){var e=r.chart,t=r.options,i=t.theme;return i&&e.theme(i),r}function I0(r){var e=r.chart,t=r.options,i=t.state;return i&&(0,b.S6)(e.geometries,function(o){o.state(i)}),r}function Fv(r){var e=r.chart,t=r.options,i=t.slider;return e.option("slider",i),r}function Hw(r){var e=r.chart,t=r.options,i=t.scrollbar;return e.option("scrollbar",i),r}function So(r,e){return function(t){var i=t.chart,o=t.options,c={};return(0,b.S6)(r,function(p,g){c[g]=ps(p,Df)}),c=pn({},e,o.meta,c),i.scale(c),t}}function ms(r){return function(e){var t=e.chart,i=e.options,o=t.getController("annotation");return(0,b.S6)((0,P.pr)(i.annotations||[],r||[]),function(c){o.annotation(c)}),e}}function Oh(r){var e=r.chart,t=r.options,i=t.yAxis,o=t.limitInPlot,c=o;return(0,b.Kn)(i)&&(0,b.UM)(o)&&(Object.values(ps(i,["min","max","minLimit","maxLimit"])).some(function(p){return!(0,b.UM)(p)})?c=!0:c=!1),e.limitInPlot=c,r}function s1(r){return r===void 0&&(r="rect"),function(e){var t=e.chart,i=e.options,o=i.coordinate,c=Array.from(o||[]).map(function(p){return p.type==="reflectX"?["reflect","x"]:p.type==="reflectY"?["reflect","y"]:p.type==="transpose"?["transpose"]:null}).filter(function(p){return!!p});return c.length!==0&&t.coordinate({type:r,actions:c}),e}}var Wd={locale:"en-US"};function dm(r){each(r,function(e,t){return Wd[t]=e})}var pg={};function z5(r,e){pg[r]=e}function u1(r){return{get:function(e,t){return Ex((0,b.U2)(pg[r],e)||(0,b.U2)(pg[Wd.locale],e)||(0,b.U2)(pg["en-US"],e)||e,t)}}}var Co={locale:"en-US",general:{increase:"Increase",decrease:"Decrease",root:"Root"},statistic:{total:"Total"},conversionTag:{label:"Rate"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"Total"}},YO={locale:"zh-CN",general:{increase:"\u589E\u52A0",decrease:"\u51CF\u5C11",root:"\u521D\u59CB"},statistic:{total:"\u603B\u8BA1"},conversionTag:{label:"\u8F6C\u5316\u7387"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"\u603B\u8BA1"}};function dp(r,e){if(r===!1)return{fields:!1};var t=(0,b.U2)(r,"fields"),i=(0,b.U2)(r,"formatter");return i&&!t&&(t=e),{fields:t,formatter:i}}function vm(r,e){var t=r.type,i=r.xField,o=r.yField,c=r.colorField,p=r.shapeField,g=r.sizeField,_=r.styleField,S=r.rawFields,I=[];if(S=((0,b.mf)(S)?S(t,e):S)||[],e==="color")I=(0,P.pr)([c||i],S);else if(e==="shape")I=(0,P.pr)([p||i],S);else if(e==="size")I=(0,P.pr)([g||i],S);else{I=(0,P.pr)([i,o,c,p,g,_],S);var L=["x","y","color","shape","size","style"].indexOf(e),F=I[L];I.splice(L,1),I.unshift(F)}var z=(0,b.jj)(I.filter(function(Q){return!!Q})),V=t==="line"&&[i,o].includes(z.join("*"))?"":z.join("*");return{mappingFields:z,tileMappingField:V}}function dg(r,e){if(e)return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o={};return r.forEach(function(c,p){o[c]=t[p]}),delete o.undefined,e(o)}}function Ru(r){var e=r.chart,t=r.options,i=t.type,o=t.args,c=t.mapping,p=t.xField,g=t.yField,_=t.colorField,S=t.shapeField,I=t.sizeField,L=t.tooltipFields,F=t.label,z=t.state,V=t.customInfo;if(!c)return r;var Q=c.color,st=c.shape,at=c.size,Ft=c.style,Kt=c.tooltip,ee=e[i](o).position(p+"*"+g);if((0,b.HD)(Q))_?ee.color(_,Q):ee.color(Q);else if((0,b.mf)(Q)){var Me=vm(t,"color"),hr=Me.mappingFields,Tr=Me.tileMappingField;ee.color(Tr,dg(hr,Q))}else _&&ee.color(_,Q);if((0,b.HD)(st))S?ee.shape(S,[st]):ee.shape(st);else if((0,b.mf)(st)){var Dr=vm(t,"shape"),hr=Dr.mappingFields,Tr=Dr.tileMappingField;ee.shape(Tr,dg(hr,st))}else S&&ee.shape(S,st);if((0,b.hj)(at))I?ee.size(I,at):ee.size(at);else if((0,b.mf)(at)){var cn=vm(t,"size"),hr=cn.mappingFields,Tr=cn.tileMappingField;ee.size(Tr,dg(hr,at))}else I&&ee.size(I,at);if((0,b.mf)(Ft)){var Jr=vm(t,"style"),hr=Jr.mappingFields,Tr=Jr.tileMappingField;ee.style(Tr,dg(hr,Ft))}else(0,b.Kn)(Ft)&&ee.style(Ft);if(L===!1?ee.tooltip(!1):(0,b.xb)(L)||ee.tooltip(L.join("*"),dg(L,Kt)),F===!1)ee.label(!1);else if(F){var Mn=F.callback,mi=F.fields,da=(0,P._T)(F,["callback","fields"]);ee.label({fields:mi||[g],callback:Mn,cfg:Kl(da)})}return z&&ee.state(z),V&&ee.customInfo(V),[p,g].filter(function(Sa){return Sa!==_}).forEach(function(Sa){e.legend(Sa,!1)}),(0,P.pi)((0,P.pi)({},r),{ext:{geometry:ee}})}function Xp(r){var e=r.options,t=e.area,i=e.xField,o=e.yField,c=e.seriesField,p=e.smooth,g=e.tooltip,_=e.useDeferredLabel,S=dp(g,[i,o,c]),I=S.fields,L=S.formatter;return t?Ru(pn({},r,{options:{type:"area",colorField:c,tooltipFields:I,mapping:(0,P.pi)({shape:p?"smooth":"area",tooltip:L},t),args:{useDeferredLabel:_}}})):r}function Rv(r){var e=r.options,t=e.edge,i=e.xField,o=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=dp(p,[i,o,c]),S=_.fields,I=_.formatter;return t?Ru(pn({},r,{options:{type:"edge",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:I},t),args:{useDeferredLabel:g}}})):r}function gm(r){var e=r.chart,t=r.options,i=r.ext,o=t.seriesField,c=t.isGroup,p=t.isStack,g=t.marginRatio,_=t.widthRatio,S=t.groupField,I=t.theme,L=[];if(o&&(c&&L.push({type:"dodge",dodgeBy:S||o,marginRatio:g}),p&&L.push({type:"stack",marginRatio:g})),L.length&&(i!=null&&i.geometry)){var F=i==null?void 0:i.geometry;F.adjust(L)}return(0,b.UM)(_)||e.theme(pn({},(0,b.Kn)(I)?I:Ui(I),{columnWidthRatio:_})),r}function pc(r){var e=r.options,t=e.xField,i=e.yField,o=e.interval,c=e.seriesField,p=e.tooltip,g=e.minColumnWidth,_=e.maxColumnWidth,S=e.columnBackground,I=e.dodgePadding,L=e.intervalPadding,F=e.useDeferredLabel,z=dp(p,[t,i,c]),V=z.fields,Q=z.formatter,st=(o?Ru(pn({},r,{options:{type:"interval",colorField:c,tooltipFields:V,mapping:(0,P.pi)({tooltip:Q},o),args:{dodgePadding:I,intervalPadding:L,minColumnWidth:g,maxColumnWidth:_,background:S,useDeferredLabel:F}}})):r).ext;return gm((0,P.pi)((0,P.pi)({},r),{ext:st}))}function k0(r){var e=r.options,t=e.line,i=e.stepType,o=e.xField,c=e.yField,p=e.seriesField,g=e.smooth,_=e.connectNulls,S=e.tooltip,I=e.useDeferredLabel,L=dp(S,[o,c,p]),F=L.fields,z=L.formatter;return t?Ru(pn({},r,{options:{type:"line",colorField:p,tooltipFields:F,mapping:(0,b.b$)({shape:i||(g?"smooth":"line"),tooltip:z},t),args:{connectNulls:_,useDeferredLabel:I}}})):r}function Bf(r){var e=r.options,t=e.point,i=e.xField,o=e.yField,c=e.seriesField,p=e.sizeField,g=e.shapeField,_=e.tooltip,S=e.useDeferredLabel,I=dp(_,[i,o,c,p,g]),L=I.fields,F=I.formatter;return t?Ru(pn({},r,{options:{type:"point",colorField:c,shapeField:g,tooltipFields:L,mapping:(0,P.pi)({tooltip:F},t),args:{useDeferredLabel:S}}})):r}function mm(r){var e=r.options,t=e.polygon,i=e.xField,o=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=dp(p,[i,o,c]),S=_.fields,I=_.formatter;return t?Ru(pn({},r,{options:{type:"polygon",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:I},t),args:{useDeferredLabel:g}}})):r}function l1(r){var e=r.options,t=e.schema,i=e.xField,o=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=dp(p,[i,o,c]),S=_.fields,I=_.formatter;return t?Ru(pn({},r,{options:{type:"schema",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:I},t),args:{useDeferredLabel:g}}})):r}function Cx(r){var e=r.options,t=e.violin,i=e.xField,o=e.yField,c=e.seriesField,p=e.sizeField,g=e.tooltip,_=dp(g,[i,o,c,p]),S=_.fields,I=_.formatter;return t?Ru(pn({},r,{options:{type:"violin",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:I},t)}})):r}var c1=nt(1375),ym="data-chart-source-type",Ax=["padding","appendPadding","renderer","pixelRatio","syncViewPadding","supportCSSTransform","limitInPlot"],Ka=function(r){(0,P.ZT)(e,r);function e(t,i){var o=r.call(this)||this;return o.container=typeof t=="string"?document.getElementById(t):t,o.options=pn({},o.getDefaultOptions(),i),o.createG2(),o.bindEvents(),o}return e.getDefaultOptions=function(){return{renderer:"canvas",xAxis:{nice:!0,label:{autoRotate:!1,autoHide:{type:"equidistance",cfg:{minGap:6}}}},yAxis:{nice:!0,label:{autoHide:!0,autoRotate:!1}},animation:!0}},e.prototype.createG2=function(){var t=this.options,i=t.width,o=t.height,c=t.defaultInteractions;this.chart=new q((0,P.pi)((0,P.pi)((0,P.pi)((0,P.pi)({container:this.container,autoFit:!1},this.getChartSize(i,o)),{localRefresh:!1}),ps(this.options,Ax)),{defaultInteractions:c})),this.container.setAttribute(ym,"G2Plot")},e.prototype.getChartSize=function(t,i){var o=xx(this.container);return{width:t||o.width||400,height:i||o.height||400}},e.prototype.bindEvents=function(){var t=this;this.chart&&this.chart.on("*",function(i){i!=null&&i.type&&t.emit(i.type,i)})},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.render=function(){this.chart.clear(),this.chart.options={data:[],animate:!0},this.chart.views=[],this.execAdaptor(),this.chart.render(),this.bindSizeSensor()},e.prototype.update=function(t){this.updateOption(t),this.render()},e.prototype.updateOption=function(t){this.options=pn({},this.options,t)},e.prototype.setState=function(t,i,o){o===void 0&&(o=!0);var c=um(this.chart);(0,b.S6)(c,function(p){i(p.getData())&&p.setState(t,o)})},e.prototype.getStates=function(){var t=um(this.chart),i=[];return(0,b.S6)(t,function(o){var c=o.getData(),p=o.getStates();(0,b.S6)(p,function(g){i.push({data:c,state:g,geometry:o.geometry,element:o})})}),i},e.prototype.changeData=function(t){this.update({data:t})},e.prototype.changeSize=function(t,i){this.chart.changeSize(t,i)},e.prototype.addAnnotations=function(t,i){i=i||this.chart;var o=(0,P.pr)(t),c=i.getController("annotation"),p=c.getComponents().map(function(S){return S.extra});c.clear(!0);for(var g=function(S){var I=p[S],L=o.findIndex(function(F){return F.id&&F.id===I.id});L!==-1&&(I=pn({},I,o[L]),o.splice(L,1)),c.annotation(I)},_=0;_<p.length;_++)g(_);o.forEach(function(S){return c.annotation(S)}),i.render(!0)},e.prototype.removeAnnotations=function(t){var i=this.chart.getController("annotation"),o=i.getComponents().map(function(g){return g.extra});i.clear(!0);for(var c=function(g){var _=o[g];t.find(function(S){return S.id&&S.id===_.id})||i.annotation(_)},p=0;p<o.length;p++)c(p);this.chart.render(!0)},e.prototype.destroy=function(){this.unbindSizeSensor(),this.chart.destroy(),this.off(),this.container.removeAttribute(ym)},e.prototype.execAdaptor=function(){var t=this.getSchemaAdaptor(),i=this.options,o=i.padding,c=i.appendPadding;this.chart.padding=o,this.chart.appendPadding=c,t({chart:this.chart,options:this.options})},e.prototype.triggerResize=function(){this.chart.forceFit()},e.prototype.bindSizeSensor=function(){var t=this;if(!this.unbind){var i=this.options.autoFit,o=i===void 0?!0:i;o&&(this.unbind=(0,c1.ak)(this.container,function(){var c=xx(t.container),p=c.width,g=c.height;(p!==t.chart.width||g!==t.chart.height)&&t.triggerResize()}))}},e.prototype.unbindSizeSensor=function(){this.unbind&&(this.unbind(),this.unbind=void 0)},e}(Ve.Z);function jw(r,e,t,i){var o=(0,b.u4)(r,function(c,p){var g=p[t],_=c.has(g)?c.get(g):0,S=p[e];return _=Ql(S)?_+S:_,c.set(g,_),c},new Map);return(0,b.UI)(r,function(c){var p,g=c[e],_=c[t],S=Ql(g)&&o.get(_)!==0?g/o.get(_):0;return(0,P.pi)((0,P.pi)({},c),(p={},p[i]=S,p))})}function _m(r,e,t,i){var o=(0,b.u4)(r,function(c,p){var g=(0,b.u4)(t,function(I,L){return""+I+p[L]},""),_=c.has(g)?c.get(g):0,S=p[e];return _=Ql(S)?_+S:_,c.set(g,_),c},new Map);return(0,b.UI)(r,function(c){var p,g=c[e],_=(0,b.u4)(t,function(I,L){return""+I+c[L]},""),S=Ql(g)&&o.get(_)!==0?g/o.get(_):0;return(0,P.pi)((0,P.pi)({},c),(p={},p[i]=S,p))})}function xm(r,e,t,i,o){return o?jw(r,e,t,i):r}function $O(r){var e=r.chart,t=r.options,i=t.data,o=t.color,c=t.lineStyle,p=t.lineShape,g=t.point,_=t.area,S=t.seriesField,I=g==null?void 0:g.state,L=_==null?void 0:_.state;e.data(i);var F=pn({},r,{options:{shapeField:S,line:{color:o,style:c,shape:p},point:g&&(0,P.pi)({color:o,shape:"circle"},g),area:_&&(0,P.pi)({color:o},_),label:void 0}}),z=pn({},F,{options:{tooltip:!1,state:I}}),V=pn({},F,{options:{tooltip:!1,state:L}});return k0(F),Bf(z),Xp(V),r}function bm(r){var e,t,i=r.options,o=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.data;return za(So((e={},e[p]=o,e[g]=c,e),(t={},t[p]={type:"cat"},t[g]=yx(_,g),t)))(r)}function vg(r){var e=r.chart,t=r.options,i=t.reflect;if(i){var o=i;(0,b.kJ)(o)||(o=[o]);var c=o.map(function(p){return["reflect",p]});e.coordinate({type:"rect",actions:c})}return r}function Ww(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),o===!1?e.axis(p,!1):e.axis(p,o),r}function Xw(r){var e=r.chart,t=r.options,i=t.legend,o=t.seriesField;return i&&o?e.legend(o,i):i===!1&&e.legend(!1),r}function Tx(r){var e=r.chart,t=r.options,i=t.label,o=t.yField,c=Ac(e,"line");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[o],callback:p,cfg:(0,P.pi)({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Kl(g))})}return r}function U5(r){var e=r.chart,t=r.options,i=t.isStack;return i&&(0,b.S6)(e.geometries,function(o){o.adjust("stack")}),r}function Yw(r){return za($O,bm,U5,Go,vg,Ww,Xw,Ol,Tx,Fv,Hw,lu,ds,ms(),Oh)(r)}function Z5(r){var e=r.chart,t=r.options,i=t.data,o=t.areaStyle,c=t.color,p=t.point,g=t.line,_=t.isPercent,S=t.xField,I=t.yField,L=t.tooltip,F=t.seriesField,z=t.startOnZero,V=p==null?void 0:p.state,Q=xm(i,I,S,I,_);e.data(Q);var st=_?(0,P.pi)({formatter:function(ee){return{name:ee[F]||ee[S],value:(Number(ee[I])*100).toFixed(2)+"%"}}},L):L,at=pn({},r,{options:{area:{color:c,style:o},point:p&&(0,P.pi)({color:c},p),tooltip:st,label:void 0,args:{startOnZero:z}}}),Ft={chart:e,options:pn({line:{size:2}},(0,b.CE)(t,["state"]),{line:g&&(0,P.pi)({color:c},g),sizeField:F,state:g==null?void 0:g.state,tooltip:!1,label:void 0,args:{startOnZero:z}})},Kt=pn({},at,{options:{tooltip:!1,state:V}});return Xp(at),k0(Ft),Bf(Kt),r}function qO(r){var e=r.chart,t=r.options,i=t.label,o=t.yField,c=Ac(e,"area");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[o],callback:p,cfg:(0,P.pi)({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Kl(g))})}return r}function f1(r){var e=r.chart,t=r.options,i=t.isStack,o=t.isPercent,c=t.seriesField;return(o||i)&&c&&(0,b.S6)(e.geometries,function(p){p.adjust("stack")}),r}function Em(r){return za(Go,Vo("areaStyle"),s1("rect"),Z5,bm,f1,Ww,Xw,Ol,qO,Fv,ms(),lu,ds,Oh)(r)}var KO=pn({},Ka.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},isStack:!0,line:{},legend:{position:"top-left",radio:{}}}),V5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="area",t}return e.getDefaultOptions=function(){return KO},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,o=i.isPercent,c=i.xField,p=i.yField,g=this,_=g.chart,S=g.options;bm({chart:_,options:S}),this.chart.changeData(xm(t,p,c,p,o))},e.prototype.getSchemaAdaptor=function(){return Em},e}(Ka),QO=10,G5=5,JO={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},H5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg=(0,P.pi)({name:"button"},JO),t}return e.prototype.getButtonCfg=function(){var t=this.context.view,i=(0,b.U2)(t,["interactions","filter-action","cfg","buttonConfig"]);return pn(this.buttonCfg,i,this.cfg)},e.prototype.drawButton=function(){var t=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:t.name}),o=this.drawText(i);this.drawBackground(i,o.getBBox()),this.buttonGroup=i},e.prototype.drawText=function(t){var i,o=this.getButtonCfg();return t.addShape({type:"text",name:"button-text",attrs:(0,P.pi)({text:o.text},(i=o.textStyle)===null||i===void 0?void 0:i.default)})},e.prototype.drawBackground=function(t,i){var o,c=this.getButtonCfg(),p=pp(c.padding),g=t.addShape({type:"rect",name:"button-rect",attrs:(0,P.pi)({x:i.x-p[3],y:i.y-p[0],width:i.width+p[1]+p[3],height:i.height+p[0]+p[2]},(o=c.buttonStyle)===null||o===void 0?void 0:o.default)});return g.toBack(),t.on("mouseenter",function(){var _;g.attr((_=c.buttonStyle)===null||_===void 0?void 0:_.active)}),t.on("mouseleave",function(){var _;g.attr((_=c.buttonStyle)===null||_===void 0?void 0:_.default)}),g},e.prototype.resetPosition=function(){var t=this.context.view,i=t.getCoordinate(),o=i.convert({x:1,y:1}),c=this.buttonGroup,p=c.getBBox(),g=os.transform(null,[["t",o.x-p.width-QO,o.y+p.height+G5]]);c.setMatrix(g)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),r.prototype.destroy.call(this)},e}(Re);jr("brush-reset-button",H5,{name:"brush-reset-button"}),Ye("filter-action",{});function Fh(r){return r.isInPlot()}function gg(r,e,t){var i=t||{},o=i.mask,c=i.isStartEnable,p=e||"rect";switch(r){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Fh,action:["brush:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:o==null?void 0:o.style}]}],processing:[{trigger:"mousemove",isEnable:Fh,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Fh,action:["brush:filter","brush:end",p+"-mask:end",p+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:default",isEnable:function(g){return c?!c(g):!1}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:o==null?void 0:o.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Fh,action:["brush-x:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:o==null?void 0:o.style}]}],processing:[{trigger:"mousemove",isEnable:Fh,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Fh,action:["brush-x:filter","brush-x:end",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:o==null?void 0:o.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Fh,action:["brush-y:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:o==null?void 0:o.style}]}],processing:[{trigger:"mousemove",isEnable:Fh,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Fh,action:["brush-y:filter","brush-y:end",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:o==null?void 0:o.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};default:return{}}}Ye("brush",gg("brush")),Ye("brush-highlight",gg("brush-highlight")),Ye("brush-x",gg("brush-x","x-rect")),Ye("brush-y",gg("brush-y","y-rect")),Ye("brush-x-highlight",gg("brush-x-highlight","x-rect")),Ye("brush-y-highlight",gg("brush-y-highlight","y-rect"));var j5=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function $w(r){var e=r.options,t=e.brush,i=(0,b.hX)(e.interactions||[],function(o){return j5.indexOf(o.type)===-1});return t!=null&&t.enabled&&(j5.forEach(function(o){var c=!1;switch(t.type){case"x-rect":c=o===(t.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":c=o===(t.action==="highlight"?"brush-y-highlight":"brush-y");break;default:c=o===(t.action==="highlight"?"brush-highlight":"brush");break}var p={type:o,enable:c};t&&(p.cfg=gg(o,t.type,t)),i.push(p)}),(t==null?void 0:t.action)!=="highlight"&&i.push({type:"filter-action",cfg:{buttonConfig:t.button}})),pn({},r,{options:{interactions:i}})}var L0={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},Mx=function(r,e){return r==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:e}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:e}]}]};Ye(L0.hover,{start:Mx(L0.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]}),Ye(L0.click,{start:Mx(L0.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function W5(r){return r===void 0&&(r=!1),function(e){var t=e.chart,i=e.options,o=i.connectedArea,c=function(){t.removeInteraction(L0.hover),t.removeInteraction(L0.click)};if(!r&&o){var p=o.trigger||"hover";c(),t.interaction(L0[p],{start:Mx(p,o.style)})}else c();return e}}function qw(r,e){return!(0,b.hj)(r)||!(0,b.hj)(e)||r===0&&e===0?"-":r===e?"100%":r===0?"\u221E":(100*e/r).toFixed(2)+"%"}function X5(r,e){return pn({size:e?32:80,spacing:e?8:12,offset:e?32:0,arrow:r.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:r.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:qw}},r)}function h1(r,e){return(0,b.UI)(e.getModel().points,function(t){return r.convertPoint(t)})}function Y5(r,e,t){var i=r.view,o=r.geometry,c=r.group,p=r.options,g=r.horizontal,_=p.offset,S=p.size,I=p.arrow,L=i.getCoordinate(),F=h1(L,e)[3],z=h1(L,t)[0],V=z.y-F.y,Q=z.x-F.x;if(typeof I!="boolean"){var st=I.headSize,at=p.spacing,Ft;g?(Q-st)/2<at?(at=Math.max(1,(Q-st)/2),Ft=[[F.x+at,F.y-_],[F.x+at,F.y-_-S],[z.x-at,z.y-_-S/2]]):Ft=[[F.x+at,F.y-_],[F.x+at,F.y-_-S],[z.x-at-st,z.y-_-S],[z.x-at,z.y-_-S/2],[z.x-at-st,z.y-_]]:(V-st)/2<at?(at=Math.max(1,(V-st)/2),Ft=[[F.x+_,F.y+at],[F.x+_+S,F.y+at],[z.x+_+S/2,z.y-at]]):Ft=[[F.x+_,F.y+at],[F.x+_+S,F.y+at],[z.x+_+S,z.y-at-st],[z.x+_+S/2,z.y-at],[z.x+_,z.y-at-st]],c.addShape("polygon",{id:i.id+"-conversion-tag-arrow-"+o.getElementId(e.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:e,nextElement:t},attrs:(0,P.pi)((0,P.pi)({},I.style||{}),{points:Ft})})}}function $5(r,e,t){var i,o,c,p=r.view,g=r.geometry,_=r.group,S=r.options,I=r.field,L=r.horizontal,F=S.offset,z=S.size;if(typeof S.text!="boolean"){var V=p.getCoordinate(),Q=((i=S.text)===null||i===void 0?void 0:i.formatter)&&((o=S.text)===null||o===void 0?void 0:o.formatter(e.getData()[I],t.getData()[I])),st=h1(V,e)[L?3:0],at=h1(V,t)[L?0:3],Ft=_.addShape("text",{id:p.id+"-conversion-tag-text-"+g.getElementId(e.getModel().mappingData),name:"conversion-tag-text",origin:{element:e,nextElement:t},attrs:(0,P.pi)((0,P.pi)({},((c=S.text)===null||c===void 0?void 0:c.style)||{}),{text:Q,x:L?(st.x+at.x)/2:st.x+F+z/2,y:L?st.y-F-z/2:(st.y+at.y)/2})});if(L){var Kt=at.x-st.x,ee=Ft.getBBox().width;if(ee>Kt){var Me=ee/Q.length,hr=Math.max(1,Math.ceil(Kt/Me)-1),Tr=Q.slice(0,hr)+"...";Ft.attr("text",Tr)}}}}function q5(r,e,t){Y5(r,e,t),$5(r,e,t)}function K5(r,e,t){return e===void 0&&(e=!0),t===void 0&&(t=!1),function(i){var o=i.options,c=i.chart,p=o.conversionTag,g=o.theme;return p&&!t&&(c.theme(pn({},(0,b.Kn)(g)?g:Ui(g),{columnWidthRatio:1/3})),c.annotation().shape({render:function(_,S){var I=_.addGroup({id:c.id+"-conversion-tag-group",name:"conversion-tag-group"}),L=(0,b.sE)(c.geometries,function(V){return V.type==="interval"}),F={view:S,geometry:L,group:I,field:r,horizontal:e,options:X5(p,e)},z=L.elements;(0,b.S6)(z,function(V,Q){Q>0&&q5(F,z[Q-1],V)})}})),i}}function Q5(r){var e=r.options,t=e.legend,i=e.seriesField,o=e.isStack;return i?t!==!1&&(t=(0,P.pi)({position:o?"right-top":"top-left"},t)):t=!1,r.options.legend=t,r}function J5(r){var e=r.chart,t=r.options,i=t.data,o=t.columnStyle,c=t.color,p=t.columnWidthRatio,g=t.isPercent,_=t.isGroup,S=t.isStack,I=t.xField,L=t.yField,F=t.seriesField,z=t.groupField,V=t.tooltip,Q=t.shape,st=g&&_&&S?_m(i,L,[I,z],L):xm(i,L,I,L,g),at=[];S&&F&&!_?st.forEach(function(ee){var Me=at.find(function(hr){return hr[I]===ee[I]&&hr[F]===ee[F]});Me?Me[L]+=ee[L]||0:at.push((0,P.pi)({},ee))}):at=st,e.data(at);var Ft=g?(0,P.pi)({formatter:function(ee){return{name:_&&S?ee[F]+" - "+ee[z]:ee[F]||ee[I],value:(Number(ee[L])*100).toFixed(2)+"%"}}},V):V,Kt=pn({},r,{options:{data:at,widthRatio:p,tooltip:Ft,interval:{shape:Q,style:o,color:c}}});return pc(Kt),Kt}function Ix(r){var e,t,i=r.options,o=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.data,S=i.isPercent,I=S?{max:1,min:0,minLimit:0,maxLimit:1}:{};return za(So((e={},e[p]=o,e[g]=c,e),(t={},t[p]={type:"cat"},t[g]=(0,P.pi)((0,P.pi)({},yx(_,g)),I),t)))(r)}function tI(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),o===!1?e.axis(p,!1):e.axis(p,o),r}function eI(r){var e=r.chart,t=r.options,i=t.legend,o=t.seriesField;return i&&o?e.legend(o,i):i===!1&&e.legend(!1),r}function rI(r){var e=r.chart,t=r.options,i=t.label,o=t.yField,c=t.isRange,p=Ac(e,"interval");if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:[o],callback:g,cfg:(0,P.pi)({layout:_!=null&&_.position?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Kl(c?(0,P.pi)({content:function(S){var I;return(I=S[o])===null||I===void 0?void 0:I.join("-")}},_):_))})}return r}function nI(r){var e=r.chart,t=r.options,i=t.tooltip,o=t.isGroup,c=t.isStack,p=t.groupField,g=t.data,_=t.xField,S=t.yField,I=t.seriesField;if(i===!1)e.tooltip(!1);else{var L=i;if(o&&c){var F=L.customItems,z=(L==null?void 0:L.formatter)||function(V){return{name:V[I]+" - "+V[p],value:V[S]}};L=(0,P.pi)((0,P.pi)({},L),{customItems:function(V){var Q=[];return(0,b.S6)(V,function(st){var at=(0,b.hX)(g,function(Ft){return(0,b.BD)(Ft,ps(st.data,[_,I]))});at.forEach(function(Ft){Q.push((0,P.pi)((0,P.pi)((0,P.pi)({},st),{value:Ft[S],data:Ft,mappingData:{_origin:Ft}}),z(Ft)))})}),F?F(Q):Q}})}e.tooltip(L)}return r}function p1(r,e){e===void 0&&(e=!1);var t=r.options,i=t.seriesField;return za(Q5,Go,Vo("columnStyle"),I0,s1("rect"),J5,Ix,tI,eI,nI,Fv,Hw,rI,$w,lu,ds,ms(),K5(t.yField,!e,!!i),W5(!t.isStack),Oh)(r)}function iI(r){var e=r.options,t=e.xField,i=e.yField,o=e.xAxis,c=e.yAxis,p={left:"bottom",right:"top",top:"left",bottom:"right"},g=c!==!1?(0,P.pi)({position:p[(c==null?void 0:c.position)||"left"]},c):!1,_=o!==!1?(0,P.pi)({position:p[(o==null?void 0:o.position)||"bottom"]},o):!1;return(0,P.pi)((0,P.pi)({},r),{options:(0,P.pi)((0,P.pi)({},e),{xField:i,yField:t,xAxis:g,yAxis:_})})}function aI(r){var e=r.options,t=e.label;return t&&!t.position&&(t.position="left",t.layout||(t.layout=[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}])),pn({},r,{options:{label:t}})}function oI(r){var e=r.options,t=e.seriesField,i=e.isStack,o=e.legend;return t?o!==!1&&(o=(0,P.pi)({position:i?"top-left":"right-top"},o||{})):o=!1,pn({},r,{options:{legend:o}})}function sI(r){var e=r.options,t=[{type:"transpose"},{type:"reflectY"}].concat(e.coordinate||[]);return pn({},r,{options:{coordinate:t}})}function uI(r){var e=r.chart,t=r.options,i=t.barStyle,o=t.barWidthRatio,c=t.minBarWidth,p=t.maxBarWidth,g=t.barBackground;return p1({chart:e,options:(0,P.pi)((0,P.pi)({},t),{columnStyle:i,columnWidthRatio:o,minColumnWidth:c,maxColumnWidth:p,columnBackground:g})},!0)}function Kw(r){return za(iI,aI,oI,Ol,sI,uI)(r)}var lI=pn({},Ka.getDefaultOptions(),{barWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),Qw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bar",t}return e.getDefaultOptions=function(){return lI},e.prototype.changeData=function(t){var i,o;this.updateOption({data:t});var c=this,p=c.chart,g=c.options,_=g.isPercent,S=g.xField,I=g.yField,L=g.xAxis,F=g.yAxis;i=[I,S],S=i[0],I=i[1],o=[F,L],L=o[0],F=o[1];var z=(0,P.pi)((0,P.pi)({},g),{xField:S,yField:I,yAxis:F,xAxis:L});Ix({chart:p,options:z}),p.changeData(xm(t,S,I,S,_))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Kw},e}(Ka),cI=pn({},Ka.getDefaultOptions(),{columnWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),Jw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="column",t}return e.getDefaultOptions=function(){return cI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,o=i.yField,c=i.xField,p=i.isPercent,g=this,_=g.chart,S=g.options;Ix({chart:_,options:S}),this.chart.changeData(xm(t,o,c,o,p))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return p1},e}(Ka),kx,Dv="$$percentage$$",Bv="$$mappingValue$$",Xd="$$conversion$$",Lx="$$totalPercentage$$",wm="$$x$$",Sm="$$y$$",fI={appendPadding:[0,80],minSize:0,maxSize:1,meta:(kx={},kx[Bv]={min:0,max:1,nice:!1},kx),label:{style:{fill:"#fff",fontSize:12}},tooltip:{showTitle:!1,showMarkers:!1,shared:!1},conversionTag:{offsetX:10,offsetY:0,style:{fontSize:12,fill:"rgba(0,0,0,0.45)"}}},Px="CONVERSION_TAG_NAME";function Nv(r,e,t){var i=[],o=t.yField,c=t.maxSize,p=t.minSize,g=(0,b.U2)((0,b.UT)(e,o),[o]),_=(0,b.hj)(c)?c:1,S=(0,b.hj)(p)?p:0;return i=(0,b.UI)(r,function(I,L){var F=(I[o]||0)/g;return I[Dv]=F,I[Bv]=(_-S)*F+S,I[Xd]=[(0,b.U2)(r,[L-1,o]),I[o]],I}),i}function Cm(r){return function(e){var t=e.chart,i=e.options,o=i.conversionTag,c=i.filteredData,p=c||t.getOptions().data;if(o){var g=o.formatter;p.forEach(function(_,S){if(!(S<=0||Number.isNaN(_[Bv]))){var I=r(_,S,p,{top:!0,name:Px,text:{content:(0,b.mf)(g)?g(_,p):g,offsetX:o.offsetX,offsetY:o.offsetY,position:"end",autoRotate:!1,style:(0,P.pi)({textAlign:"start",textBaseline:"middle"},o.style)}});t.annotation().line(I)}})}return e}}function Am(r){var e=r.chart,t=r.options,i=t.data,o=i===void 0?[]:i,c=t.yField,p=t.maxSize,g=t.minSize,_=Nv(o,o,{yField:c,maxSize:p,minSize:g});return e.data(_),r}function tS(r){var e=r.chart,t=r.options,i=t.xField,o=t.yField,c=t.color,p=t.tooltip,g=t.label,_=t.shape,S=_===void 0?"funnel":_,I=t.funnelStyle,L=t.state,F=dp(p,[i,o]),z=F.fields,V=F.formatter;Ru({chart:e,options:{type:"interval",xField:i,yField:Bv,colorField:i,tooltipFields:(0,b.kJ)(z)&&z.concat([Dv,Xd]),mapping:{shape:S,tooltip:V,color:c,style:I},label:g,state:L}});var Q=Ac(r.chart,"interval");return Q.adjust("symmetric"),r}function hI(r){var e=r.chart,t=r.options,i=t.isTransposed;return e.coordinate({type:"rect",actions:i?[]:[["transpose"],["scale",1,-1]]}),r}function eS(r){var e=r.options,t=r.chart,i=e.maxSize,o=(0,b.U2)(t,["geometries","0","dataArray"],[]),c=(0,b.U2)(t,["options","data","length"]),p=(0,b.UI)(o,function(_){return(0,b.U2)(_,["0","nextPoints","0","x"])*c-.5}),g=function(_,S,I,L){var F=i-(i-_[Bv])/2;return(0,P.pi)((0,P.pi)({},L),{start:[p[S-1]||S-.5,F],end:[p[S-1]||S-.5,F+.05]})};return Cm(g)(r),r}function rS(r){return za(Am,tS,hI,eS)(r)}function pI(r){var e,t=r.chart,i=r.options,o=i.data,c=o===void 0?[]:o,p=i.yField;return t.data(c),t.scale((e={},e[p]={sync:!0},e)),r}function dI(r){var e=r.chart,t=r.options,i=t.data,o=t.xField,c=t.yField,p=t.color,g=t.compareField,_=t.isTransposed,S=t.tooltip,I=t.maxSize,L=t.minSize,F=t.label,z=t.funnelStyle,V=t.state,Q=t.showFacetTitle;return e.facet("mirror",{fields:[g],transpose:!_,padding:_?0:[32,0,0,0],showTitle:Q,eachView:function(st,at){var Ft=_?at.rowIndex:at.columnIndex;_||st.coordinate({type:"rect",actions:[["transpose"],["scale",Ft===0?-1:1,-1]]});var Kt=Nv(at.data,i,{yField:c,maxSize:I,minSize:L});st.data(Kt);var ee=dp(S,[o,c,g]),Me=ee.fields,hr=ee.formatter,Tr=_?{offset:Ft===0?10:-23,position:Ft===0?"bottom":"top"}:{offset:10,position:"left",style:{textAlign:Ft===0?"end":"start"}};Ru({chart:st,options:{type:"interval",xField:o,yField:Bv,colorField:o,tooltipFields:(0,b.kJ)(Me)&&Me.concat([Dv,Xd]),mapping:{shape:"funnel",tooltip:hr,color:p,style:z},label:F===!1?!1:pn({},Tr,F),state:V}})}}),r}function Ox(r){var e=r.chart,t=r.index,i=r.options,o=i.conversionTag,c=i.isTransposed;((0,b.hj)(t)?[e]:e.views).forEach(function(p,g){var _=(0,b.U2)(p,["geometries","0","dataArray"],[]),S=(0,b.U2)(p,["options","data","length"]),I=(0,b.UI)(_,function(F){return(0,b.U2)(F,["0","nextPoints","0","x"])*S-.5}),L=function(F,z,V,Q){var st=(t||g)===0?-1:1;return pn({},Q,{start:[I[z-1]||z-.5,F[Bv]],end:[I[z-1]||z-.5,F[Bv]+.05],text:c?{style:{textAlign:"start"}}:{offsetX:o!==!1?st*o.offsetX:0,style:{textAlign:(t||g)===0?"end":"start"}}})};Cm(L)(pn({},{chart:p,options:i}))})}function vI(r){var e=r.chart;return e.once("beforepaint",function(){return Ox(r)}),r}function gI(r){return za(pI,dI,vI)(r)}function nS(r){var e=r.chart,t=r.options,i=t.data,o=i===void 0?[]:i,c=t.yField,p=(0,b.u4)(o,function(S,I){return S+(I[c]||0)},0),g=(0,b.UT)(o,c)[c],_=(0,b.UI)(o,function(S,I){var L=[],F=[];if(S[Lx]=(S[c]||0)/p,I){var z=o[I-1][wm],V=o[I-1][Sm];L[0]=z[3],F[0]=V[3],L[1]=z[2],F[1]=V[2]}else L[0]=-.5,F[0]=1,L[1]=.5,F[1]=1;return F[2]=F[1]-S[Lx],L[2]=(F[2]+1)/4,F[3]=F[2],L[3]=-L[2],S[wm]=L,S[Sm]=F,S[Dv]=(S[c]||0)/g,S[Xd]=[(0,b.U2)(o,[I-1,c]),S[c]],S});return e.data(_),r}function mI(r){var e=r.chart,t=r.options,i=t.xField,o=t.yField,c=t.color,p=t.tooltip,g=t.label,_=t.funnelStyle,S=t.state,I=dp(p,[i,o]),L=I.fields,F=I.formatter;return Ru({chart:e,options:{type:"polygon",xField:wm,yField:Sm,colorField:i,tooltipFields:(0,b.kJ)(L)&&L.concat([Dv,Xd]),label:g,state:S,mapping:{tooltip:F,color:c,style:_}}}),r}function yI(r){var e=r.chart,t=r.options,i=t.isTransposed;return e.coordinate({type:"rect",actions:i?[["transpose"],["reflect","x"]]:[]}),r}function _I(r){var e=function(t,i,o,c){return(0,P.pi)((0,P.pi)({},c),{start:[t[wm][1],t[Sm][1]],end:[t[wm][1]+.05,t[Sm][1]]})};return Cm(e)(r),r}function xI(r){return za(nS,mI,yI,_I)(r)}function bI(r){var e,t=r.chart,i=r.options,o=i.data,c=o===void 0?[]:o,p=i.yField;return t.data(c),t.scale((e={},e[p]={sync:!0},e)),r}function EI(r){var e=r.chart,t=r.options,i=t.seriesField,o=t.isTransposed,c=t.showFacetTitle;return e.facet("rect",{fields:[i],padding:[o?0:32,10,0,10],showTitle:c,eachView:function(p,g){rS(pn({},r,{chart:p,options:{data:g.data}}))}}),r}function wI(r){return za(bI,EI)(r)}var SI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.rendering=!1,t}return e.prototype.change=function(t){var i=this;if(!this.rendering){var o=t.seriesField,c=t.compareField,p=c?Ox:eS,g=this.context.view,_=o||c?g.views:[g];(0,b.UI)(_,function(S,I){var L=S.getController("annotation"),F=(0,b.hX)((0,b.U2)(L,["option"],[]),function(V){var Q=V.name;return Q!==Px});L.clear(!0),(0,b.S6)(F,function(V){typeof V=="object"&&S.annotation()[V.type](V)});var z=(0,b.U2)(S,["filteredData"],S.getOptions().data);p({chart:S,index:I,options:(0,P.pi)((0,P.pi)({},t),{filteredData:Nv(z,z,t)})}),S.filterData(z),i.rendering=!0,S.render(!0)})}this.rendering=!1},e}(Re),iS="funnel-conversion-tag",d1="funnel-afterrender",aS={trigger:"afterrender",action:iS+":change"};jr(iS,SI),Ye(d1,{start:[aS]});function CI(r){var e=r.options,t=e.compareField,i=e.xField,o=e.yField,c=e.locale,p=e.funnelStyle,g=e.data,_=u1(c),S={label:t?{fields:[i,o,t,Dv,Xd],formatter:function(L){return""+L[o]}}:{fields:[i,o,Dv,Xd],offset:0,position:"middle",formatter:function(L){return L[i]+" "+L[o]}},tooltip:{title:i,formatter:function(L){return{name:L[i],value:L[o]}}},conversionTag:{formatter:function(L){return _.get(["conversionTag","label"])+": "+qw.apply(void 0,L[Xd])}}},I;return(t||p)&&(I=function(L){return pn({},t&&{lineWidth:1,stroke:"#fff"},(0,b.mf)(p)?p(L):p)}),pn({options:S},r,{options:{funnelStyle:I,data:(0,b.d9)(g)}})}function AI(r){var e=r.options,t=e.compareField,i=e.dynamicHeight,o=e.seriesField;return o?wI(r):t?gI(r):i?xI(r):rS(r)}function TI(r){var e,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return za(So((e={},e[c]=i,e[p]=o,e)))(r)}function MI(r){var e=r.chart;return e.axis(!1),r}function II(r){var e=r.chart,t=r.options,i=t.legend;return i===!1?e.legend(!1):e.legend(i),r}function kI(r){var e=r.chart,t=r.options,i=t.interactions,o=t.dynamicHeight;return(0,b.S6)(i,function(c){c.enable===!1?e.removeInteraction(c.type):e.interaction(c.type,c.cfg||{})}),o?e.removeInteraction(d1):e.interaction(d1,{start:[(0,P.pi)((0,P.pi)({},aS),{arg:t})]}),r}function oS(r){return za(CI,AI,TI,MI,Ol,kI,II,ds,Go,ms())(r)}var LI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="funnel",t}return e.getDefaultOptions=function(){return fI},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return oS},e.prototype.setState=function(t,i,o){o===void 0&&(o=!0);var c=um(this.chart);(0,b.S6)(c,function(p){i(p.getData())&&p.setState(t,o)})},e.prototype.getStates=function(){var t=um(this.chart),i=[];return(0,b.S6)(t,function(o){var c=o.getData(),p=o.getStates();(0,b.S6)(p,function(g){i.push({data:c,state:g,geometry:o.geometry,element:o})})}),i},e.CONVERSATION_FIELD=Xd,e.PERCENT_FIELD=Dv,e.TOTAL_PERCENT_FIELD=Lx,e}(Ka),v1,P0="range",sS="type",Yd="percent",PI="#f0f0f0",uS="indicator-view",lS="range-view",OI={percent:0,range:{ticks:[]},innerRadius:.9,radius:.95,startAngle:-7/6*Math.PI,endAngle:1/6*Math.PI,syncViewPadding:!0,axis:{line:null,label:{offset:-24,style:{textAlign:"center",textBaseline:"middle"}},subTickLine:{length:-8},tickLine:{length:-12},grid:null},indicator:{pointer:{style:{lineWidth:5,lineCap:"round"}},pin:{style:{r:9.75,lineWidth:4.5,fill:"#fff"}}},statistic:{title:!1},meta:(v1={},v1[P0]={sync:"v"},v1[Yd]={sync:"v",tickCount:5,tickInterval:.2},v1),animation:!1};function FI(r,e){return r.map(function(t,i){var o;return o={},o[P0]=t-(r[i-1]||0),o[sS]=""+i,o[Yd]=e,o})}function cS(r){var e;return[(e={},e[Yd]=(0,b.uZ)(r,0,1),e)]}function fS(r,e){var t=(0,b.U2)(e,["ticks"],[]),i=(0,b.dp)(t)?(0,b.jj)(t):[0,(0,b.uZ)(r,0,1),1];return i[0]||i.shift(),FI(i,r)}function RI(r){var e=r.chart,t=r.options,i=t.percent,o=t.range,c=t.radius,p=t.innerRadius,g=t.startAngle,_=t.endAngle,S=t.axis,I=t.indicator,L=t.gaugeStyle,F=t.type,z=t.meter,V=o.color,Q=o.width;if(I){var st=cS(i),at=e.createView({id:uS});at.data(st),at.point().position(Yd+"*1").shape(I.shape||"gauge-indicator").customInfo({defaultColor:e.getTheme().defaultColor,indicator:I}),at.coordinate("polar",{startAngle:g,endAngle:_,radius:p*c}),at.axis(Yd,S),at.scale(Yd,ps(S,Df))}var Ft=fS(i,t.range),Kt=e.createView({id:lS});Kt.data(Ft);var ee=(0,b.HD)(V)?[V,PI]:V,Me=pc({chart:Kt,options:{xField:"1",yField:P0,seriesField:sS,rawFields:[Yd],isStack:!0,interval:{color:ee,style:L,shape:F==="meter"?"meter-gauge":null},args:{zIndexReversed:!0,sortZIndex:!0},minColumnWidth:Q,maxColumnWidth:Q}}).ext,hr=Me.geometry;return hr.customInfo({meter:z}),Kt.coordinate("polar",{innerRadius:p,radius:c,startAngle:g,endAngle:_}).transpose(),r}function DI(r){var e;return za(So((e={range:{min:0,max:1,maxLimit:1,minLimit:0}},e[Yd]={},e)))(r)}function hS(r,e){var t=r.chart,i=r.options,o=i.statistic,c=i.percent;if(t.getController("annotation").clear(!0),o){var p=o.content,g=void 0;p&&(g=pn({},{content:(c*100).toFixed(2)+"%",style:{opacity:.75,fontSize:"30px",lineHeight:1,textAlign:"center",color:"rgba(44,53,66,0.85)"}},p)),Dw(t,{statistic:(0,P.pi)((0,P.pi)({},o),{content:g})},{percent:c})}return e&&t.render(!0),r}function BI(r){var e=r.chart,t=r.options,i=t.tooltip;return i?e.tooltip(pn({showTitle:!1,showMarkers:!1,containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',domStyles:{"g2-tooltip":{padding:"4px 8px",fontSize:"10px"}},customContent:function(o,c){var p=(0,b.U2)(c,[0,"data",Yd],0);return(p*100).toFixed(2)+"%"}},i)):e.tooltip(!1),r}function NI(r){var e=r.chart;return e.legend(!1),r}function Fx(r){return za(Go,ds,RI,DI,BI,hS,lu,ms(),NI)(r)}_i("point","gauge-indicator",{draw:function(r,e){var t=r.customInfo,i=t.indicator,o=t.defaultColor,c=i,p=c.pointer,g=c.pin,_=e.addGroup(),S=this.parsePoint({x:0,y:0});return p&&_.addShape("line",{name:"pointer",attrs:(0,P.pi)({x1:S.x,y1:S.y,x2:r.x,y2:r.y,stroke:o},p.style)}),g&&_.addShape("circle",{name:"pin",attrs:(0,P.pi)({x:S.x,y:S.y,stroke:o},g.style)}),_}}),_i("interval","meter-gauge",{draw:function(r,e){var t=r.customInfo.meter,i=t===void 0?{}:t,o=i.steps,c=o===void 0?50:o,p=i.stepRatio,g=p===void 0?.5:p;c=c<1?1:c,g=(0,b.uZ)(g,0,1);var _=this.coordinate,S=_.startAngle,I=_.endAngle,L=0;if(g>0&&g<1){var F=I-S;L=F/c/(g/(1-g)+1-1/c)}for(var z=L/(1-g)*g,V=e.addGroup(),Q=this.coordinate.getCenter(),st=this.coordinate.getRadius(),at=os.getAngle(r,this.coordinate),Ft=at.startAngle,Kt=at.endAngle,ee=Ft;ee<Kt;){var Me=void 0,hr=(ee-S)%(z+L);hr<z?Me=ee+(z-hr):(ee+=z+L-hr,Me=ee+z);var Tr=os.getSectorPath(Q.x,Q.y,st,ee,Math.min(Me,Kt),st*this.coordinate.innerRadius);V.addShape("path",{name:"meter-gauge",attrs:{path:Tr,fill:r.color,stroke:r.color,lineWidth:.5}}),ee=Me+L}return V}});var zI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="gauge",t}return e.getDefaultOptions=function(){return OI},e.prototype.changeData=function(t){this.chart.emit(Tt.BEFORE_CHANGE_DATA,fo.fromData(this.chart,Tt.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t});var i=this.chart.views.find(function(c){return c.id===uS});i&&i.data(cS(t));var o=this.chart.views.find(function(c){return c.id===lS});o&&o.data(fS(t,this.options.range)),hS({chart:this.chart,options:this.options},!0),this.chart.emit(Tt.AFTER_CHANGE_DATA,fo.fromData(this.chart,Tt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Fx},e}(Ka);function pS(r,e,t){if(t===1)return[0,e];var i=Math.floor(r/e);return[e*i,e*(i+1)]}function dS(r){return Math.ceil(Math.log(r.length)/Math.LN2)+1}function vS(r,e,t,i,o){var c=(0,b.d9)(r);(0,b.MR)(c,e);var p=(0,b.I)(c,e),g=(0,b.rx)(p),_=g.max-g.min,S=t;if(!t&&i&&(S=i>1?_/(i-1):g.max),!t&&!i){var I=dS(p);S=_/I}var L={},F=(0,b.vM)(c,o);(0,b.xb)(F)?(0,b.S6)(c,function(V){var Q=V[e],st=pS(Q,S,i),at=st[0]+"-"+st[1];(0,b.wH)(L,at)||(L[at]={range:st,count:0}),L[at].count+=1}):Object.keys(F).forEach(function(V){(0,b.S6)(F[V],function(Q){var st=Q[e],at=pS(st,S,i),Ft=at[0]+"-"+at[1],Kt=Ft+"-"+V;(0,b.wH)(L,Kt)||(L[Kt]={range:at,count:0},L[Kt][o]=V),L[Kt].count+=1})});var z=[];return(0,b.S6)(L,function(V){z.push(V)}),z}var mg="range",yg="count",UI=pn({},Ka.getDefaultOptions(),{columnStyle:{stroke:"#FFFFFF"},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]});function ZI(r){var e=r.chart,t=r.options,i=t.data,o=t.binField,c=t.binNumber,p=t.binWidth,g=t.color,_=t.stackField,S=t.legend,I=t.columnStyle,L=vS(i,o,p,c,_);e.data(L);var F=pn({},r,{options:{xField:mg,yField:yg,seriesField:_,isStack:!0,interval:{color:g,style:I}}});return pc(F),S&&_?e.legend(_,S):e.legend(!1),r}function VI(r){var e,t=r.options,i=t.xAxis,o=t.yAxis;return za(So((e={},e[mg]=i,e[yg]=o,e)))(r)}function GI(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis;return i===!1?e.axis(mg,!1):e.axis(mg,i),o===!1?e.axis(yg,!1):e.axis(yg,o),r}function HI(r){var e=r.chart,t=r.options,i=t.label,o=Ac(e,"interval");if(!i)o.label(!1);else{var c=i.callback,p=(0,P._T)(i,["callback"]);o.label({fields:[yg],callback:c,cfg:Kl(p)})}return r}function gS(r){return za(Go,Vo("columnStyle"),ZI,VI,GI,I0,HI,Ol,lu,ds)(r)}var jI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="histogram",t}return e.getDefaultOptions=function(){return UI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,o=i.binField,c=i.binNumber,p=i.binWidth,g=i.stackField;this.chart.changeData(vS(t,o,p,c,g))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return gS},e}(Ka),WI=pn({},Ka.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},legend:{position:"top-left",radio:{}},isStack:!1}),XI=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.active=function(){var t=this.getView(),i=this.context.event;if(i.data){var o=i.data.items,c=t.geometries.filter(function(p){return p.type==="point"});(0,b.S6)(c,function(p){(0,b.S6)(p.elements,function(g){var _=(0,b.cx)(o,function(S){return S.data===g.data})!==-1;g.setState("active",_)})})}},e.prototype.reset=function(){var t=this.getView(),i=t.geometries.filter(function(o){return o.type==="point"});(0,b.S6)(i,function(o){(0,b.S6)(o.elements,function(c){c.setState("active",!1)})})},e.prototype.getView=function(){return this.context.view},e}(Re);jr("marker-active",XI),Ye("marker-active",{start:[{trigger:"tooltip:show",action:"marker-active:active"}],end:[{trigger:"tooltip:hide",action:"marker-active:reset"}]});var mS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t}return e.getDefaultOptions=function(){return WI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,o=i.chart,c=i.options;bm({chart:o,options:c}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Yw},e}(Ka),yS=pn({},Ka.getDefaultOptions(),{legend:{position:"right",radio:{}},tooltip:{shared:!1,showTitle:!1,showMarkers:!1},label:{layout:{type:"limit-in-plot",cfg:{action:"ellipsis"}}},pieStyle:{stroke:"white",lineWidth:1},statistic:{title:{style:{fontWeight:300,color:"#4B535E",textAlign:"center",fontSize:"20px",lineHeight:1}},content:{style:{fontWeight:"bold",color:"rgba(44,53,66,0.85)",textAlign:"center",fontSize:"32px",lineHeight:1}}},theme:{components:{annotation:{text:{animate:!1}}}}}),YI=[1,0,0,0,1,0,0,0,1];function Rx(r,e){var t=e?(0,P.pr)(e):(0,P.pr)(YI);return os.transform(t,r)}var $I=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getActiveElements=function(){var t=os.getDelegationObject(this.context);if(t){var i=this.context.view,o=t.component,c=t.item,p=o.get("field");if(p){var g=i.geometries[0].elements;return g.filter(function(_){return _.getModel().data[p]===c.value})}}return[]},e.prototype.getActiveElementLabels=function(){var t=this.context.view,i=this.getActiveElements(),o=t.geometries[0].labelsContainer.getChildren();return o.filter(function(c){return i.find(function(p){return(0,b.Xy)(p.getData(),c.get("data"))})})},e.prototype.transfrom=function(t){t===void 0&&(t=7.5);var i=this.getActiveElements(),o=this.getActiveElementLabels();i.forEach(function(c,p){var g=o[p],_=c.geometry.coordinate;if(_.isPolar&&_.isTransposed){var S=os.getAngle(c.getModel(),_),I=S.startAngle,L=S.endAngle,F=(I+L)/2,z=t,V=z*Math.cos(F),Q=z*Math.sin(F);c.shape.setMatrix(Rx([["t",V,Q]])),g.setMatrix(Rx([["t",V,Q]]))}})},e.prototype.active=function(){this.transfrom()},e.prototype.reset=function(){this.transfrom(0)},e}(Re);function _S(r){var e=r.event,t,i=e.target;return i&&(t=i.get("element")),t}var xS=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getAnnotations=function(t){var i=t||this.context.view;return i.getController("annotation").option},e.prototype.getInitialAnnotation=function(){return this.initialAnnotation},e.prototype.init=function(){var t=this,i=this.context.view;i.removeInteraction("tooltip"),i.on("afterchangesize",function(){var o=t.getAnnotations(i);t.initialAnnotation=o})},e.prototype.change=function(t){var i=this.context,o=i.view,c=i.event;this.initialAnnotation||(this.initialAnnotation=this.getAnnotations());var p=(0,b.U2)(c,["data","data"]);if(c.type.match("legend-item")){var g=os.getDelegationObject(this.context),_=o.getGroupedFields()[0];if(g&&_){var S=g.item;p=o.getData().find(function(z){return z[_]===S.value})}}if(p){var I=(0,b.U2)(t,"annotations",[]),L=(0,b.U2)(t,"statistic",{});o.getController("annotation").clear(!0),(0,b.S6)(I,function(z){typeof z=="object"&&o.annotation()[z.type](z)}),i1(o,{statistic:L,plotType:"pie"},p),o.render(!0)}var F=_S(this.context);F&&F.shape.toFront()},e.prototype.reset=function(){var t=this.context.view,i=t.getController("annotation");i.clear(!0);var o=this.getInitialAnnotation();(0,b.S6)(o,function(c){t.annotation()[c.type](c)}),t.render(!0)},e}(Re),bS="pie-statistic";jr(bS,xS),Ye("pie-statistic-active",{start:[{trigger:"element:mouseenter",action:"pie-statistic:change"}],end:[{trigger:"element:mouseleave",action:"pie-statistic:reset"}]}),jr("pie-legend",$I),Ye("pie-legend-active",{start:[{trigger:"legend-item:mouseenter",action:"pie-legend:active"}],end:[{trigger:"legend-item:mouseleave",action:"pie-legend:reset"}]});function qI(r,e){var t=null;return(0,b.S6)(r,function(i){typeof i[e]=="number"&&(t+=i[e])}),t}function KI(r,e){var t;switch(r){case"inner":return t="-30%",(0,b.HD)(e)&&e.endsWith("%")?parseFloat(e)*.01>0?t:e:e<0?e:t;case"outer":return t=12,(0,b.HD)(e)&&e.endsWith("%")?parseFloat(e)*.01<0?t:e:e>0?e:t;default:return e}}function g1(r,e){return(0,b.yW)(Pv(r,e),function(t){return t[e]===0})}function QI(r){var e=r.chart,t=r.options,i=t.data,o=t.angleField,c=t.colorField,p=t.color,g=t.pieStyle,_=t.shape,S=Pv(i,o);if(g1(S,o)){var I="$$percentage$$";S=S.map(function(F){var z;return(0,P.pi)((0,P.pi)({},F),(z={},z[I]=1/S.length,z))}),e.data(S);var L=pn({},r,{options:{xField:"1",yField:I,seriesField:c,isStack:!0,interval:{color:p,shape:_,style:g},args:{zIndexReversed:!0,sortZIndex:!0}}});pc(L)}else{e.data(S);var L=pn({},r,{options:{xField:"1",yField:o,seriesField:c,isStack:!0,interval:{color:p,shape:_,style:g},args:{zIndexReversed:!0,sortZIndex:!0}}});pc(L)}return r}function JI(r){var e,t=r.chart,i=r.options,o=i.meta,c=i.colorField,p=pn({},o);return t.scale(p,(e={},e[c]={type:"cat"},e)),r}function tk(r){var e=r.chart,t=r.options,i=t.radius,o=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"theta",cfg:{radius:i,innerRadius:o,startAngle:c,endAngle:p}}),r}function ek(r){var e=r.chart,t=r.options,i=t.label,o=t.colorField,c=t.angleField,p=e.geometries[0];if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]),S=Kl(_);if(S.content){var I=S.content;S.content=function(V,Q,st){var at=V[o],Ft=V[c],Kt=e.getScaleByField(c),ee=Kt==null?void 0:Kt.scale(Ft);return(0,b.mf)(I)?I((0,P.pi)((0,P.pi)({},V),{percent:ee}),Q,st):(0,b.HD)(I)?Ex(I,{value:Ft,name:at,percentage:(0,b.hj)(ee)&&!(0,b.UM)(Ft)?(ee*100).toFixed(2)+"%":null}):I}}var L={inner:"",outer:"pie-outer",spider:"pie-spider"},F=S.type?L[S.type]:"pie-outer",z=S.layout?(0,b.kJ)(S.layout)?S.layout:[S.layout]:[];S.layout=(F?[{type:F}]:[]).concat(z),p.label({fields:o?[c,o]:[c],callback:g,cfg:(0,P.pi)((0,P.pi)({},S),{offset:KI(S.type,S.offset),type:"pie"})})}return r}function ES(r){var e=r.innerRadius,t=r.statistic,i=r.angleField,o=r.colorField,c=r.meta,p=r.locale,g=u1(p);if(e&&t){var _=pn({},yS.statistic,t),S=_.title,I=_.content;return S!==!1&&(S=pn({},{formatter:function(L){var F=L?L[o]:(0,b.UM)(S.content)?g.get(["statistic","total"]):S.content,z=(0,b.U2)(c,[o,"formatter"])||function(V){return V};return z(F)}},S)),I!==!1&&(I=pn({},{formatter:function(L,F){var z=L?L[i]:qI(F,i),V=(0,b.U2)(c,[i,"formatter"])||function(Q){return Q};return L||(0,b.UM)(I.content)?V(z):I.content}},I)),pn({},{statistic:{title:S,content:I}},r)}return r}function Dx(r){var e=r.chart,t=r.options,i=ES(t),o=i.innerRadius,c=i.statistic;return e.getController("annotation").clear(!0),za(ms())(r),o&&c&&i1(e,{statistic:c,plotType:"pie"}),r}function rk(r){var e=r.chart,t=r.options,i=t.tooltip,o=t.colorField,c=t.angleField,p=t.data;if(i===!1)e.tooltip(i);else if(e.tooltip(pn({},i,{shared:!1})),g1(p,c)){var g=(0,b.U2)(i,"fields"),_=(0,b.U2)(i,"formatter");(0,b.xb)((0,b.U2)(i,"fields"))&&(g=[o,c],_=_||function(S){return{name:S[o],value:(0,b.BB)(S[c])}}),e.geometries[0].tooltip(g.join("*"),dg(g,_))}return r}function nk(r){var e=r.chart,t=r.options,i=ES(t),o=i.interactions,c=i.statistic,p=i.annotations;return(0,b.S6)(o,function(g){var _,S;if(g.enable===!1)e.removeInteraction(g.type);else if(g.type==="pie-statistic-active"){var I=[];!((_=g.cfg)===null||_===void 0)&&_.start||(I=[{trigger:"element:mouseenter",action:bS+":change",arg:{statistic:c,annotations:p}}]),(0,b.S6)((S=g.cfg)===null||S===void 0?void 0:S.start,function(L){I.push((0,P.pi)((0,P.pi)({},L),{arg:{statistic:c,annotations:p}}))}),e.interaction(g.type,pn({},g.cfg,{start:I}))}else e.interaction(g.type,g.cfg||{})}),r}function wS(r){return za(Vo("pieStyle"),QI,JI,Go,tk,jd,rk,ek,I0,Dx,nk,ds)(r)}var Bx=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pie",t}return e.getDefaultOptions=function(){return yS},e.prototype.changeData=function(t){this.chart.emit(Tt.BEFORE_CHANGE_DATA,fo.fromData(this.chart,Tt.BEFORE_CHANGE_DATA,null));var i=this.options,o=this.options.angleField,c=Pv(i.data,o),p=Pv(t,o);g1(c,o)||g1(p,o)?this.update({data:t}):(this.updateOption({data:t}),this.chart.data(p),Dx({chart:this.chart,options:this.options}),this.chart.render(!0)),this.chart.emit(Tt.AFTER_CHANGE_DATA,fo.fromData(this.chart,Tt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return wS},e}(Ka),SS=["#FAAD14","#E8EDF3"],ik={percent:.2,color:SS,animation:{}};function Nx(r){var e=(0,b.uZ)(Ql(r)?r:0,0,1);return[{current:""+e,type:"current",percent:e},{current:""+e,type:"target",percent:1}]}function zx(r){var e=r.chart,t=r.options,i=t.percent,o=t.progressStyle,c=t.color,p=t.barWidthRatio;e.data(Nx(i));var g=pn({},r,{options:{xField:"current",yField:"percent",seriesField:"type",widthRatio:p,interval:{style:o,color:(0,b.HD)(c)?[c,SS[1]]:c},args:{zIndexReversed:!0,sortZIndex:!0}}});return pc(g),e.tooltip(!1),e.axis(!1),e.legend(!1),r}function ak(r){var e=r.chart;return e.coordinate("rect").transpose(),r}function Ux(r){return za(zx,So({}),ak,ds,Go,ms())(r)}var CS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="process",t}return e.getDefaultOptions=function(){return ik},e.prototype.changeData=function(t){this.updateOption({percent:t}),this.chart.changeData(Nx(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ux},e}(Ka);function AS(r){var e=r.chart,t=r.options,i=t.innerRadius,o=t.radius;return e.coordinate("theta",{innerRadius:i,radius:o}),r}function Zx(r,e){var t=r.chart,i=r.options,o=i.innerRadius,c=i.statistic,p=i.percent,g=i.meta;if(t.getController("annotation").clear(!0),o&&c){var _=(0,b.U2)(g,["percent","formatter"])||function(I){return(I*100).toFixed(2)+"%"},S=c.content;S&&(S=pn({},S,{content:(0,b.UM)(S.content)?_(p):S.content})),i1(t,{statistic:(0,P.pi)((0,P.pi)({},c),{content:S}),plotType:"ring-progress"},{percent:p})}return e&&t.render(!0),r}function TS(r){return za(zx,So({}),AS,Zx,ds,Go,ms())(r)}var ok={percent:.2,innerRadius:.8,radius:.98,color:["#FAAD14","#E8EDF3"],statistic:{title:!1,content:{style:{fontSize:"14px",fontWeight:300,fill:"#4D4D4D",textAlign:"center",textBaseline:"middle"}}},animation:{}},sk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ring-process",t}return e.getDefaultOptions=function(){return ok},e.prototype.changeData=function(t){this.chart.emit(Tt.BEFORE_CHANGE_DATA,fo.fromData(this.chart,Tt.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(Nx(t)),Zx({chart:this.chart,options:this.options},!0),this.chart.emit(Tt.AFTER_CHANGE_DATA,fo.fromData(this.chart,Tt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return TS},e}(Ka),O0=nt(44334),uk={exp:O0.regressionExp,linear:O0.regressionLinear,loess:O0.regressionLoess,log:O0.regressionLog,poly:O0.regressionPoly,pow:O0.regressionPow,quad:O0.regressionQuad};function lk(r,e){var t=10,i={regionStyle:[{position:{start:[r,"max"],end:["max",e]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:["min","max"],end:[r,e]},style:{fill:"#a3dda1",opacity:.4}},{position:{start:["min",e],end:[r,"min"]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:[r,e],end:["max","min"]},style:{fill:"#a3dda1",opacity:.4}}],lineStyle:{stroke:"#9ba29a",lineWidth:1},labelStyle:[{position:["max",e],offsetX:-t,offsetY:-t,style:{textAlign:"right",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",e],offsetX:t,offsetY:-t,style:{textAlign:"left",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",e],offsetX:t,offsetY:t,style:{textAlign:"left",textBaseline:"top",fontSize:14,fill:"#ccc"}},{position:["max",e],offsetX:-t,offsetY:t,style:{textAlign:"right",textBaseline:"top",fontSize:14,fill:"#ccc"}}]};return i}var MS=function(r,e){var t=e.view,i=e.options,o=i.xField,c=i.yField,p=t.getScaleByField(o),g=t.getScaleByField(c),_=r.map(function(S){return t.getCoordinate().convert({x:p.scale(S[0]),y:g.scale(S[1])})});return F5(_,!1)},ck=function(r){var e=r.options,t=e.xField,i=e.yField,o=e.data,c=e.regressionLine,p=c.type,g=p===void 0?"linear":p,_=c.algorithm,S;if(_)S=(0,b.kJ)(_)?_:_(o);else{var I=uk[g]().x(function(L){return L[t]}).y(function(L){return L[i]});S=I(o)}return MS(S,r)},fk=function(r){var e,t=r.meta,i=t===void 0?{}:t,o=r.xField,c=r.yField,p=r.data,g=p[0][o],_=p[0][c],S=g>0,I=_>0;function L(F,z){var V=(0,b.U2)(i,[F]);function Q(at){return(0,b.U2)(V,at)}var st={};return z==="x"?((0,b.hj)(g)&&((0,b.hj)(Q("min"))||(st.min=S?0:g*2),(0,b.hj)(Q("max"))||(st.max=S?g*2:0)),st):((0,b.hj)(_)&&((0,b.hj)(Q("min"))||(st.min=I?0:_*2),(0,b.hj)(Q("max"))||(st.max=I?_*2:0)),st)}return(0,P.pi)((0,P.pi)({},i),(e={},e[o]=(0,P.pi)((0,P.pi)({},i[o]),L(o,"x")),e[c]=(0,P.pi)((0,P.pi)({},i[c]),L(c,"y")),e))};function Vx(r){var e=r.data,t=e===void 0?[]:e,i=r.xField,o=r.yField;if(t.length){for(var c=!0,p=!0,g=t[0],_=void 0,S=1;S<t.length&&(_=t[S],g[i]!==_[i]&&(c=!1),g[o]!==_[o]&&(p=!1),!(!c&&!p));S++)g=_;var I=[];c&&I.push(i),p&&I.push(o);var L=ps(fk(r),I);return pn({},r,{meta:L})}return r}function IS(r){var e=r.chart,t=r.options,i=t.data,o=t.type,c=t.color,p=t.shape,g=t.pointStyle,_=t.shapeField,S=t.colorField,I=t.xField,L=t.yField,F=t.sizeField,z=t.size,V=t.tooltip;F&&(z||(z=[2,8]),(0,b.hj)(z)&&(z=[z,z])),V&&!V.fields&&(V=(0,P.pi)((0,P.pi)({},V),{fields:[I,L,S,F,_]})),e.data(i),Bf(pn({},r,{options:{seriesField:S,point:{color:c,shape:p,size:z,style:g},tooltip:V}}));var Q=Ac(e,"point");return o&&Q.adjust(o),r}function Tm(r){var e,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField,g=Vx(t);return za(So((e={},e[c]=i,e[p]=o,e)))(pn({},r,{options:g}))}function kS(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return e.axis(c,i),e.axis(p,o),r}function hk(r){var e=r.chart,t=r.options,i=t.legend,o=t.colorField,c=t.shapeField,p=t.sizeField,g=t.shapeLegend,_=t.sizeLegend,S=i!==!1;return o&&e.legend(o,S?i:!1),c&&(g?e.legend(c,g):e.legend(c,g===!1?!1:i)),p&&e.legend(p,_||!1),!S&&!g&&!_&&e.legend(!1),r}function pk(r){var e=r.chart,t=r.options,i=t.label,o=t.yField,c=Ac(e,"point");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[o],callback:p,cfg:Kl(g)})}return r}function dk(r){var e=r.options,t=e.quadrant,i=[];if(t){var o=t.xBaseline,c=o===void 0?0:o,p=t.yBaseline,g=p===void 0?0:p,_=t.labels,S=t.regionStyle,I=t.lineStyle,L=lk(c,g),F=new Array(4).join(",").split(",");F.forEach(function(z,V){i.push((0,P.pi)((0,P.pi)({type:"region",top:!1},L.regionStyle[V].position),{style:pn({},L.regionStyle[V].style,S==null?void 0:S[V])}),(0,P.pi)({type:"text",top:!0},pn({},L.labelStyle[V],_==null?void 0:_[V])))}),i.push({type:"line",top:!1,start:["min",g],end:["max",g],style:pn({},L.lineStyle,I)},{type:"line",top:!1,start:[c,"min"],end:[c,"max"],style:pn({},L.lineStyle,I)})}return za(ms(i))(r)}function vk(r){var e=r.options,t=r.chart,i=e.regressionLine;if(i){var o=i.style,c=i.top,p=c===void 0?!1:c,g={stroke:"#9ba29a",lineWidth:2,opacity:.5};t.annotation().shape({top:p,render:function(_,S){var I=_.addGroup({id:t.id+"-regression-line",name:"regression-line-group"}),L=ck({view:S,options:e});I.addShape("path",{name:"regression-line",attrs:(0,P.pi)((0,P.pi)({path:L},g),o)})}})}return r}function LS(r){var e=r.chart,t=r.options,i=t.tooltip;return i?e.tooltip(i):i===!1&&e.tooltip(!1),r}function PS(r){return za(IS,Tm,kS,hk,LS,pk,$w,Fv,Hw,lu,dk,ds,Go,vk)(r)}var gk=pn({},Ka.getDefaultOptions(),{size:4,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!0,crosshairs:{type:"xy"}}});Ye("drag-move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});var m1=function(r){(0,P.ZT)(e,r);function e(t,i){var o=r.call(this,t,i)||this;return o.type="scatter",o.on(Tt.BEFORE_RENDER,function(c){var p,g,_=o,S=_.options,I=_.chart;if(((p=c.data)===null||p===void 0?void 0:p.source)===Uc.FILTER){var L=o.chart.filterData(o.chart.getData());Tm({chart:I,options:(0,P.pi)((0,P.pi)({},S),{data:L})})}((g=c.data)===null||g===void 0?void 0:g.source)===Uc.RESET&&Tm({chart:I,options:S})}),o}return e.getDefaultOptions=function(){return gk},e.prototype.changeData=function(t){this.updateOption(Vx(pn({},this.options,{data:t})));var i=this,o=i.options,c=i.chart;Tm({chart:c,options:o}),this.chart.changeData(t)},e.prototype.getSchemaAdaptor=function(){return PS},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ka),Mm="$$stock-range$$",y1="trend",OS="up",FS="down",mk={showMarkers:!1,showCrosshairs:!0,shared:!0,crosshairs:{type:"xy",follow:!0,text:function(r,e,t){var i;if(r==="x"){var o=t[0];i=o?o.title:e}else i=e;return{position:r==="y"?"start":"end",content:i,style:{fill:"#dfdfdf"}}},textBackground:{padding:[2,4],style:{fill:"#666"}}}},yk=pn({},Ka.getDefaultOptions(),{tooltip:mk,interactions:[{type:"tooltip"}],legend:{position:"top-left"},risingFill:"#ef5350",fallingFill:"#26a69a"});function RS(r,e){return(0,b.UI)(r,function(t){var i=t&&(0,P.pi)({},t);if((0,b.kJ)(e)&&i){var o=e[0],c=e[1],p=e[2],g=e[3];i[y1]=i[o]<=i[c]?OS:FS,i[Mm]=[i[o],i[c],i[p],i[g]]}return i})}function _k(r){var e=r.chart,t=r.options,i=t.yField,o=t.data,c=t.risingFill,p=t.fallingFill,g=t.tooltip,_=t.stockStyle;e.data(RS(o,i));var S=g;return S!==!1&&(S=pn({},{fields:i},S)),l1(pn({},r,{options:{schema:{shape:"candle",color:[c,p],style:_},yField:Mm,seriesField:y1,rawFields:i,tooltip:S}})),r}function xk(r){var e,t,i=r.chart,o=r.options,c=o.meta,p=o.xAxis,g=o.yAxis,_=o.xField,S=(e={},e[_]={type:"timeCat",tickCount:6},e[y1]={values:[OS,FS]},e),I=pn(S,c,(t={},t[_]=ps(p,Df),t[Mm]=ps(g,Df),t));return i.scale(I),r}function bk(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField;return i===!1?e.axis(c,!1):e.axis(c,i),o===!1?e.axis(Mm,!1):e.axis(Mm,o),r}function Ek(r){var e=r.chart,t=r.options,i=t.tooltip;return i!==!1?e.tooltip(i):e.tooltip(!1),r}function wk(r){var e=r.chart,t=r.options,i=t.legend;return i?e.legend(y1,i):i===!1&&e.legend(!1),r}function DS(r){za(Go,_k,xk,bk,Ek,wk,lu,ds,ms(),Fv)(r)}var Sk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="stock",t}return e.getDefaultOptions=function(){return yk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return DS},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options.yField;this.chart.changeData(RS(t,i))},e}(Ka);function F0(r){return(0,b.UI)(r||[],function(e,t){return{x:""+t,y:e}})}var Im="x",_g="y",BS={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(r,e){return""+(0,b.U2)(e,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}},showCrosshairs:!0,crosshairs:{type:"x"}},Ck={appendPadding:2,tooltip:(0,P.pi)({},BS),animation:{}};function Ak(r){var e=r.chart,t=r.options,i=t.data,o=t.color,c=t.areaStyle,p=t.point,g=t.line,_=p==null?void 0:p.state,S=F0(i);e.data(S);var I=pn({},r,{options:{xField:Im,yField:_g,area:{color:o,style:c},line:g,point:p}}),L=pn({},I,{options:{tooltip:!1}}),F=pn({},I,{options:{tooltip:!1,state:_}});return Xp(I),k0(L),Bf(F),e.axis(!1),e.legend(!1),r}function xg(r){var e,t,i=r.options,o=i.xAxis,c=i.yAxis,p=i.data,g=F0(p);return za(So((e={},e[Im]=o,e[_g]=c,e),(t={},t[Im]={type:"cat"},t[_g]=yx(g,_g),t)))(r)}function NS(r){return za(Vo("areaStyle"),Ak,xg,Ol,Go,ds,ms())(r)}var Tk={appendPadding:2,tooltip:(0,P.pi)({},BS),color:"l(90) 0:#E5EDFE 1:#ffffff",areaStyle:{fillOpacity:.6},line:{size:1,color:"#5B8FF9"},animation:{}},Mk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-area",t}return e.getDefaultOptions=function(){return Tk},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,o=i.chart,c=i.options;xg({chart:o,options:c}),o.changeData(F0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return NS},e}(Ka);function Ik(r){var e=r.chart,t=r.options,i=t.data,o=t.color,c=t.columnStyle,p=t.columnWidthRatio,g=F0(i);e.data(g);var _=pn({},r,{options:{xField:Im,yField:_g,widthRatio:p,interval:{style:c,color:o}}});return pc(_),e.axis(!1),e.legend(!1),e.interaction("element-active"),r}function zS(r){return za(Go,Vo("columnStyle"),Ik,xg,Ol,ds,ms())(r)}var kk={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(r,e){return""+(0,b.U2)(e,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}}},Lk={appendPadding:2,tooltip:(0,P.pi)({},kk),animation:{}},Pk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-column",t}return e.getDefaultOptions=function(){return Lk},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,o=i.chart,c=i.options;xg({chart:o,options:c}),o.changeData(F0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return zS},e}(Ka);function Ok(r){var e=r.chart,t=r.options,i=t.data,o=t.color,c=t.lineStyle,p=t.point,g=p==null?void 0:p.state,_=F0(i);e.data(_);var S=pn({},r,{options:{xField:Im,yField:_g,line:{color:o,style:c},point:p}}),I=pn({},S,{options:{tooltip:!1,state:g}});return k0(S),Bf(I),e.axis(!1),e.legend(!1),r}function _1(r){return za(Ok,xg,Go,Ol,ds,ms())(r)}var Fk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-line",t}return e.getDefaultOptions=function(){return Ck},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,o=i.chart,c=i.options;xg({chart:o,options:c}),o.changeData(F0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _1},e}(Ka),Rk={line:Yw,pie:wS,column:p1,bar:Kw,area:Em,gauge:Fx,"tiny-line":_1,"tiny-column":zS,"tiny-area":NS,"ring-progress":TS,progress:Ux,scatter:PS,histogram:gS,funnel:oS,stock:DS},Dk={line:mS,pie:Bx,column:Jw,bar:Qw,area:V5,gauge:zI,"tiny-line":Fk,"tiny-column":Pk,"tiny-area":Mk,"ring-progress":sk,progress:CS,scatter:m1,histogram:jI,funnel:LI,stock:Sk},Bk={pie:{label:!1},column:{tooltip:{showMarkers:!1}},bar:{tooltip:{showMarkers:!1}}};function Gx(r,e,t){var i=Dk[r];if(!i){console.error("could not find "+r+" plot");return}var o=Rk[r];o({chart:e,options:pn({},i.getDefaultOptions(),(0,b.U2)(Bk,r,{}),t)})}function Nk(r){var e=r.chart,t=r.options,i=t.views,o=t.legend;return(0,b.S6)(i,function(c){var p=c.region,g=c.data,_=c.meta,S=c.axes,I=c.coordinate,L=c.interactions,F=c.annotations,z=c.tooltip,V=c.geometries,Q=e.createView({region:p});Q.data(g);var st={};S&&(0,b.S6)(S,function(at,Ft){st[Ft]=ps(at,Df)}),st=pn({},_,st),Q.scale(st),S?(0,b.S6)(S,function(at,Ft){Q.axis(Ft,at)}):Q.axis(!1),Q.coordinate(I),(0,b.S6)(V,function(at){var Ft=Ru({chart:Q,options:at}).ext,Kt=at.adjust;Kt&&Ft.geometry.adjust(Kt)}),(0,b.S6)(L,function(at){at.enable===!1?Q.removeInteraction(at.type):Q.interaction(at.type,at.cfg)}),(0,b.S6)(F,function(at){Q.annotation()[at.type]((0,P.pi)({},at))}),typeof c.animation=="boolean"?Q.animate(!1):(Q.animate(!0),(0,b.S6)(Q.geometries,function(at){at.animate(c.animation)})),z&&(Q.interaction("tooltip"),Q.tooltip(z))}),o?(0,b.S6)(o,function(c,p){e.legend(p,c)}):e.legend(!1),e.tooltip(t.tooltip),r}function zk(r){var e=r.chart,t=r.options,i=t.plots,o=t.data,c=o===void 0?[]:o;return(0,b.S6)(i,function(p){var g=p.type,_=p.region,S=p.options,I=S===void 0?{}:S,L=p.top,F=I.tooltip;if(L){Gx(g,e,(0,P.pi)((0,P.pi)({},I),{data:c}));return}var z=e.createView((0,P.pi)({region:_},ps(I,Ax)));F&&z.interaction("tooltip"),Gx(g,z,(0,P.pi)({data:c},I))}),r}function Uk(r){var e=r.chart,t=r.options;return e.option("slider",t.slider),r}function Zk(r){return za(ds,Nk,zk,lu,ds,Go,Ol,Uk,ms())(r)}function Hx(r,e){var t=r.getModel(),i=t.data,o;return(0,b.kJ)(i)?o=i[0][e]:o=i[e],o}function US(r){var e=n1(r);(0,b.S6)(e,function(t){t.hasState("active")&&t.setState("active",!1),t.hasState("selected")&&t.setState("selected",!1),t.hasState("inactive")&&t.setState("inactive",!1)})}var ZS=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getAssociationItems=function(t,i){var o,c=this.context.event,p=i||{},g=p.linkField,_=p.dim,S=[];if(!((o=c.data)===null||o===void 0)&&o.data){var I=c.data.data;(0,b.S6)(t,function(L){var F,z,V=g;if(_==="x"?V=L.getXScale().field:_==="y"?V=(F=L.getYScales().find(function(st){return st.field===V}))===null||F===void 0?void 0:F.field:V||(V=(z=L.getGroupScales()[0])===null||z===void 0?void 0:z.field),!!V){var Q=(0,b.UI)(n1(L),function(st){var at=!1,Ft=!1,Kt=(0,b.kJ)(I)?(0,b.U2)(I[0],V):(0,b.U2)(I,V);return Hx(st,V)===Kt?at=!0:Ft=!0,{element:st,view:L,active:at,inactive:Ft}});S.push.apply(S,Q)}})}return S},e.prototype.showTooltip=function(t){var i=Bw(this.context.view),o=this.getAssociationItems(i,t);(0,b.S6)(o,function(c){if(c.active){var p=c.element.shape.getCanvasBBox();c.view.showTooltip({x:p.minX+p.width/2,y:p.minY+p.height/2})}})},e.prototype.hideTooltip=function(){var t=Bw(this.context.view);(0,b.S6)(t,function(i){i.hideTooltip()})},e.prototype.active=function(t){var i=cm(this.context.view),o=this.getAssociationItems(i,t);(0,b.S6)(o,function(c){var p=c.active,g=c.element;p&&g.setState("active",!0)})},e.prototype.selected=function(t){var i=cm(this.context.view),o=this.getAssociationItems(i,t);(0,b.S6)(o,function(c){var p=c.active,g=c.element;p&&g.setState("selected",!0)})},e.prototype.highlight=function(t){var i=cm(this.context.view),o=this.getAssociationItems(i,t);(0,b.S6)(o,function(c){var p=c.inactive,g=c.element;p&&g.setState("inactive",!0)})},e.prototype.reset=function(){var t=cm(this.context.view);(0,b.S6)(t,function(i){US(i)})},e}(Re);jr("association",ZS),Ye("association-active",{start:[{trigger:"element:mouseenter",action:"association:active"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),Ye("association-selected",{start:[{trigger:"element:mouseenter",action:"association:selected"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),Ye("association-highlight",{start:[{trigger:"element:mouseenter",action:"association:highlight"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),Ye("association-tooltip",{start:[{trigger:"element:mousemove",action:"association:showTooltip"}],end:[{trigger:"element:mouseleave",action:"association:hideTooltip"}]});var VS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="mix",t}return e.prototype.getSchemaAdaptor=function(){return Zk},e}(Ka),R0;(function(r){r.DEV="DEV",r.BETA="BETA",r.STABLE="STABLE"})(R0||(R0={}));function x1(r,e){console.warn(r===R0.DEV?"Plot '"+e+"' is in DEV stage, just give us issues.":r===R0.BETA?"Plot '"+e+"' is in BETA stage, DO NOT use it in production env.":r===R0.STABLE?"Plot '"+e+`' is in STABLE stage, import it by "import { `+e+` } from '@antv/g2plot'".`:"invalid Stage type.")}var Vk=function(){function r(){}return Object.defineProperty(r,"MultiView",{get:function(){return x1(R0.STABLE,"MultiView"),VS},enumerable:!1,configurable:!0}),r}(),vp="first-axes-view",Yp="second-axes-view",zv="series-field-key";function jx(r,e,t,i,o){var c=[];e.forEach(function(L){i.forEach(function(F){var z,V=(z={},z[r]=F[r],z[t]=L,z[L]=F[L],z);c.push(V)})});var p=Object.values((0,b.vM)(c,t)),g=p[0],_=g===void 0?[]:g,S=p[1],I=S===void 0?[]:S;return o?[_.reverse(),I.reverse()]:[_,I]}function $d(r){return r!=="vertical"}function Wx(r,e,t){var i=e[0],o=e[1],c=i.autoPadding,p=o.autoPadding,g=r.__axisPosition,_=g.layout,S=g.position;if($d(_)&&S==="top"&&(i.autoPadding=t.instance(c.top,0,c.bottom,c.left),o.autoPadding=t.instance(p.top,c.left,p.bottom,0)),$d(_)&&S==="bottom"&&(i.autoPadding=t.instance(c.top,c.right/2+5,c.bottom,c.left),o.autoPadding=t.instance(p.top,p.right,p.bottom,c.right/2+5)),!$d(_)&&S==="bottom"){var I=c.left>=p.left?c.left:p.left;i.autoPadding=t.instance(c.top,c.right,c.bottom/2+5,I),o.autoPadding=t.instance(c.bottom/2+5,p.right,p.bottom,I)}if(!$d(_)&&S==="top"){var I=c.left>=p.left?c.left:p.left;i.autoPadding=t.instance(c.top,c.right,0,I),o.autoPadding=t.instance(0,p.right,c.top,I)}}function GS(r){var e=r.chart,t=r.options,i=t.data,o=t.xField,c=t.yField,p=t.color,g=t.barStyle,_=t.widthRatio,S=t.legend,I=t.layout,L=jx(o,c,zv,i,$d(I));S?e.legend(zv,S):S===!1&&e.legend(!1);var F,z,V=L[0],Q=L[1];$d(I)?(F=e.createView({region:{start:{x:0,y:0},end:{x:.5,y:1}},id:vp}),F.coordinate().transpose().reflect("x"),z=e.createView({region:{start:{x:.5,y:0},end:{x:1,y:1}},id:Yp}),z.coordinate().transpose(),F.data(V),z.data(Q)):(F=e.createView({region:{start:{x:0,y:0},end:{x:1,y:.5}},id:vp}),z=e.createView({region:{start:{x:0,y:.5},end:{x:1,y:1}},id:Yp}),z.coordinate().reflect("y"),F.data(V),z.data(Q));var st=pn({},r,{chart:F,options:{widthRatio:_,xField:o,yField:c[0],seriesField:zv,interval:{color:p,style:g}}});pc(st);var at=pn({},r,{chart:z,options:{xField:o,yField:c[1],seriesField:zv,widthRatio:_,interval:{color:p,style:g}}});return pc(at),r}function Gk(r){var e,t,i,o=r.options,c=r.chart,p=o.xAxis,g=o.yAxis,_=o.xField,S=o.yField,I=yo(c,vp),L=yo(c,Yp),F={};return(0,b.XP)((o==null?void 0:o.meta)||{}).map(function(z){(0,b.U2)(o==null?void 0:o.meta,[z,"alias"])&&(F[z]=o.meta[z].alias)}),c.scale((e={},e[zv]={sync:!0,formatter:function(z){return(0,b.U2)(F,z,z)}},e)),So((t={},t[_]=p,t[S[0]]=g[S[0]],t))(pn({},r,{chart:I})),So((i={},i[_]=p,i[S[1]]=g[S[1]],i))(pn({},r,{chart:L})),r}function HS(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField,g=t.layout,_=yo(e,vp),S=yo(e,Yp);return(i==null?void 0:i.position)==="bottom"?S.axis(c,(0,P.pi)((0,P.pi)({},i),{label:{formatter:function(){return""}}})):S.axis(c,!1),i===!1?_.axis(c,!1):_.axis(c,(0,P.pi)({position:$d(g)?"top":"bottom"},i)),o===!1?(_.axis(p[0],!1),S.axis(p[1],!1)):(_.axis(p[0],o[p[0]]),S.axis(p[1],o[p[1]])),e.__axisPosition={position:_.getOptions().axes[c].position,layout:g},r}function Hk(r){var e=r.chart;return lu(pn({},r,{chart:yo(e,vp)})),lu(pn({},r,{chart:yo(e,Yp)})),r}function tF(r){var e=r.chart,t=r.options,i=t.yField,o=t.yAxis;return Oh(pn({},r,{chart:yo(e,vp),options:{yAxis:o[i[0]]}})),Oh(pn({},r,{chart:yo(e,Yp),options:{yAxis:o[i[1]]}})),r}function b1(r){var e=r.chart;return Go(pn({},r,{chart:yo(e,vp)})),Go(pn({},r,{chart:yo(e,Yp)})),Go(r),r}function jS(r){var e=r.chart;return ds(pn({},r,{chart:yo(e,vp)})),ds(pn({},r,{chart:yo(e,Yp)})),r}function WS(r){var e=this,t,i,o=r.chart,c=r.options,p=c.label,g=c.yField,_=c.layout,S=yo(o,vp),I=yo(o,Yp),L=Ac(S,"interval"),F=Ac(I,"interval");if(!p)L.label(!1),F.label(!1);else{var z=p.callback,V=(0,P._T)(p,["callback"]);V.position||(V.position="middle"),V.offset===void 0&&(V.offset=2);var Q=(0,P.pi)({},V);if($d(_)){var st=((t=Q.style)===null||t===void 0?void 0:t.textAlign)||(V.position==="middle"?"center":"left");V.style=pn({},V.style,{textAlign:st});var at={left:"right",right:"left",center:"center"};Q.style=pn({},Q.style,{textAlign:at[st]})}else{var Ft={top:"bottom",bottom:"top",middle:"middle"};typeof V.position=="string"?V.position=Ft[V.position]:typeof V.position=="function"&&(V.position=function(){for(var Me=[],hr=0;hr<arguments.length;hr++)Me[hr]=arguments[hr];return Ft[V.position.apply(e,Me)]});var Kt=((i=Q.style)===null||i===void 0?void 0:i.textBaseline)||"bottom";Q.style=pn({},Q.style,{textBaseline:Kt});var ee={top:"bottom",bottom:"top",middle:"middle"};V.style=pn({},V.style,{textBaseline:ee[Kt]})}L.label({fields:[g[0]],callback:z,cfg:Kl(Q)}),F.label({fields:[g[1]],callback:z,cfg:Kl(V)})}return r}function eF(r){return za(GS,Gk,HS,tF,b1,WS,Ol,Hk,jS)(r)}var DR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bidirectional-bar",t}return e.getDefaultOptions=function(){return pn({},r.getDefaultOptions.call(this),{syncViewPadding:Wx})},e.prototype.changeData=function(t){t===void 0&&(t=[]),this.chart.emit(Tt.BEFORE_CHANGE_DATA,fo.fromData(this.chart,Tt.BEFORE_CHANGE_DATA,null)),this.updateOption({data:t});var i=this.options,o=i.xField,c=i.yField,p=i.layout,g=jx(o,c,zv,t,$d(p)),_=g[0],S=g[1],I=yo(this.chart,vp),L=yo(this.chart,Yp);I.data(_),L.data(S),this.chart.render(!0),this.chart.emit(Tt.AFTER_CHANGE_DATA,fo.fromData(this.chart,Tt.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return eF},e.SERIES_FIELD_KEY=zv,e}(Ka),km,Uv="$$range$$",Xx="low-q1-median-q3-high",XS="$$y_outliers$$",Lm="outliers_view",Yx=pn({},Ka.getDefaultOptions(),{meta:(km={},km[Uv]={min:0,alias:Xx},km),interactions:[{type:"active-region"}],tooltip:{showMarkers:!1,shared:!0},boxStyle:{lineWidth:1}}),jk=function(r,e){var t=r;if(Array.isArray(e)){var i=e[0],o=e[1],c=e[2],p=e[3],g=e[4];t=(0,b.UI)(r,function(_){return _[Uv]=[_[i],_[o],_[c],_[p],_[g]],_})}return t};function rF(r){var e=r.chart,t=r.options,i=t.xField,o=t.yField,c=t.groupField,p=t.color,g=t.tooltip,_=t.boxStyle;e.data(jk(t.data,o));var S=(0,b.kJ)(o)?Uv:o,I=o?(0,b.kJ)(o)?o:[o]:[],L=g;L!==!1&&(L=pn({},{fields:(0,b.kJ)(o)?o:[]},L));var F=l1(pn({},r,{options:{xField:i,yField:S,seriesField:c,tooltip:L,rawFields:I,label:!1,schema:{shape:"box",color:p,style:_}}})).ext;return c&&F.geometry.adjust("dodge"),r}function Wk(r){var e=r.chart,t=r.options,i=t.xField,o=t.data,c=t.outliersField,p=t.outliersStyle,g=t.padding,_=t.label;if(!c)return r;var S=e.createView({padding:g,id:Lm}),I=o.reduce(function(L,F){var z=F[c];return z.forEach(function(V){var Q;return L.push((0,P.pi)((0,P.pi)({},F),(Q={},Q[c]=V,Q)))}),L},[]);return S.data(I),Bf({chart:S,options:{xField:i,yField:c,point:{shape:"circle",style:p},label:_}}),S.axis(!1),r}function Xk(r){var e,t,i=r.chart,o=r.options,c=o.meta,p=o.xAxis,g=o.yAxis,_=o.xField,S=o.yField,I=o.outliersField,L=Array.isArray(S)?Uv:S,F={};if(I){var z=XS;F=(e={},e[I]={sync:z,nice:!0},e[L]={sync:z,nice:!0},e)}var V=pn(F,c,(t={},t[_]=ps(p,Df),t[L]=ps(g,Df),t));return i.scale(V),r}function YS(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField,g=Array.isArray(p)?Uv:p;return i===!1?e.axis(c,!1):e.axis(c,i),o===!1?e.axis(Uv,!1):e.axis(g,o),r}function Yk(r){var e=r.chart,t=r.options,i=t.legend,o=t.groupField;return o?i?e.legend(o,i):e.legend(o,{position:"bottom"}):e.legend(!1),r}function $k(r){return za(rF,Wk,Xk,YS,Yk,Ol,ms(),lu,ds,Go)(r)}var $S=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="box",t}return e.getDefaultOptions=function(){return Yx},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options.yField,o=this.chart.views.find(function(c){return c.id===Lm});o&&o.data(t),this.chart.changeData(jk(t,i))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return $k},e}(Ka);function $x(r,e,t){return r.length>1?e+"_"+t:""+e}function qS(r){var e=r.data,t=r.xField,i=r.measureField,o=r.rangeField,c=r.targetField,p=r.layout,g=[],_=[];e.forEach(function(L,F){var z=[L[o]].flat();z.sort(function(st,at){return st-at}),z.forEach(function(st,at){var Ft,Kt=at===0?st:z[at]-z[at-1];g.push((Ft={rKey:o+"_"+at},Ft[t]=t?L[t]:String(F),Ft[o]=Kt,Ft))});var V=[L[i]].flat();V.forEach(function(st,at){var Ft;g.push((Ft={mKey:$x(V,i,at)},Ft[t]=t?L[t]:String(F),Ft[i]=st,Ft))});var Q=[L[c]].flat();Q.forEach(function(st,at){var Ft;g.push((Ft={tKey:$x(Q,c,at)},Ft[t]=t?L[t]:String(F),Ft[c]=st,Ft))}),_.push(L[o],L[i],L[c])});var S=Math.min.apply(Math,_.flat(1/0)),I=Math.max.apply(Math,_.flat(1/0));return S=S>0?0:S,p==="vertical"&&g.reverse(),{min:S,max:I,ds:g}}function nF(r){var e=r.chart,t=r.options,i=t.bulletStyle,o=t.targetField,c=t.rangeField,p=t.measureField,g=t.xField,_=t.color,S=t.layout,I=t.size,L=t.label,F=qS(t),z=F.min,V=F.max,Q=F.ds;e.data(Q);var st=pn({},r,{options:{xField:g,yField:c,seriesField:"rKey",isStack:!0,label:(0,b.U2)(L,"range"),interval:{color:(0,b.U2)(_,"range"),style:(0,b.U2)(i,"range"),size:(0,b.U2)(I,"range")}}});pc(st),e.geometries[0].tooltip(!1);var at=pn({},r,{options:{xField:g,yField:p,seriesField:"mKey",isStack:!0,label:(0,b.U2)(L,"measure"),interval:{color:(0,b.U2)(_,"measure"),style:(0,b.U2)(i,"measure"),size:(0,b.U2)(I,"measure")}}});pc(at);var Ft=pn({},r,{options:{xField:g,yField:o,seriesField:"tKey",label:(0,b.U2)(L,"target"),point:{color:(0,b.U2)(_,"target"),style:(0,b.U2)(i,"target"),size:(0,b.mf)((0,b.U2)(I,"target"))?function(Kt){return(0,b.U2)(I,"target")(Kt)/2}:(0,b.U2)(I,"target")/2,shape:S==="horizontal"?"line":"hyphen"}}});return Bf(Ft),S==="horizontal"&&e.coordinate().transpose(),(0,P.pi)((0,P.pi)({},r),{ext:{data:{min:z,max:V}}})}function KS(r){var e,t,i=r.options,o=r.ext,c=i.xAxis,p=i.yAxis,g=i.targetField,_=i.rangeField,S=i.measureField,I=i.xField,L=o.data;return za(So((e={},e[I]=c,e[S]=p,e),(t={},t[S]={min:L==null?void 0:L.min,max:L==null?void 0:L.max,sync:!0},t[g]={sync:""+S},t[_]={sync:""+S},t)))(r)}function QS(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.measureField,g=t.rangeField,_=t.targetField;return e.axis(""+g,!1),e.axis(""+_,!1),i===!1?e.axis(""+c,!1):e.axis(""+c,i),o===!1?e.axis(""+p,!1):e.axis(""+p,o),r}function JS(r){var e=r.chart,t=r.options,i=t.legend;return e.removeInteraction("legend-filter"),e.legend(i),e.legend("rKey",!1),e.legend("mKey",!1),e.legend("tKey",!1),r}function tC(r){var e=r.chart,t=r.options,i=t.label,o=t.measureField,c=t.targetField,p=t.rangeField,g=e.geometries,_=g[0],S=g[1],I=g[2];return(0,b.U2)(i,"range")?_.label(""+p,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Kl(i.range))):_.label(!1),(0,b.U2)(i,"measure")?S.label(""+o,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Kl(i.measure))):S.label(!1),(0,b.U2)(i,"target")?I.label(""+c,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Kl(i.target))):I.label(!1),r}function qk(r){za(nF,KS,QS,JS,Go,tC,Ol,lu,ds)(r)}var iF=pn({},Ka.getDefaultOptions(),{layout:"horizontal",size:{range:30,measure:20,target:20},xAxis:{tickLine:!1,line:null},bulletStyle:{range:{fillOpacity:.5}},label:{measure:{position:"right"}},tooltip:{showMarkers:!1}}),gp=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bullet",t}return e.getDefaultOptions=function(){return iF},e.prototype.changeData=function(t){this.updateOption({data:t});var i=qS(this.options),o=i.min,c=i.max,p=i.ds;KS({options:this.options,ext:{data:{min:o,max:c}},chart:this.chart}),this.chart.changeData(p)},e.prototype.getSchemaAdaptor=function(){return qk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ka),E1={y:0,nodeWidthRatio:.05,weight:!1,nodePaddingRatio:.1,id:function(r){return r.id},source:function(r){return r.source},target:function(r){return r.target},sourceWeight:function(r){return r.value||1},targetWeight:function(r){return r.value||1},sortBy:null};function eC(r,e,t){(0,b.U5)(r,function(i,o){i.inEdges=e.filter(function(c){return""+t.target(c)==""+o}),i.outEdges=e.filter(function(c){return""+t.source(c)==""+o}),i.edges=i.outEdges.concat(i.inEdges),i.frequency=i.edges.length,i.value=0,i.inEdges.forEach(function(c){i.value+=t.targetWeight(c)}),i.outEdges.forEach(function(c){i.value+=t.sourceWeight(c)})})}function qx(r,e){var t={weight:function(o,c){return c.value-o.value},frequency:function(o,c){return c.frequency-o.frequency},id:function(o,c){return(""+e.id(o)).localeCompare(""+e.id(c))}},i=t[e.sortBy];!i&&(0,b.mf)(e.sortBy)&&(i=e.sortBy),i&&r.sort(i)}function aF(r,e){var t=r.length;if(!t)throw new TypeError("Invalid nodes: it's empty!");if(e.weight){var i=e.nodePaddingRatio;if(i<0||i>=1)throw new TypeError("Invalid nodePaddingRatio: it must be in range [0, 1)!");var o=i/(2*t),c=e.nodeWidthRatio;if(c<=0||c>=1)throw new TypeError("Invalid nodeWidthRatio: it must be in range (0, 1)!");var p=0;r.forEach(function(_){p+=_.value}),r.forEach(function(_){_.weight=_.value/p,_.width=_.weight*(1-i),_.height=c}),r.forEach(function(_,S){for(var I=0,L=S-1;L>=0;L--)I+=r[L].width+2*o;var F=_.minX=o+I,z=_.maxX=_.minX+_.width,V=_.minY=e.y-c/2,Q=_.maxY=V+c;_.x=[F,z,z,F],_.y=[V,V,Q,Q]})}else{var g=1/t;r.forEach(function(_,S){_.x=(S+.5)*g,_.y=e.y})}return r}function Kk(r,e,t){if(t.weight){var i={};(0,b.U5)(r,function(o,c){i[c]=o.value}),e.forEach(function(o){var c=t.source(o),p=t.target(o),g=r[c],_=r[p];if(g&&_){var S=i[c],I=t.sourceWeight(o),L=g.minX+(g.value-S)/g.value*g.width,F=L+I/g.value*g.width;i[c]-=I;var z=i[p],V=t.targetWeight(o),Q=_.minX+(_.value-z)/_.value*_.width,st=Q+V/_.value*_.width;i[p]-=V;var at=t.y;o.x=[L,F,Q,st],o.y=[at,at,at,at],o.source=g,o.target=_}})}else e.forEach(function(o){var c=r[t.source(o)],p=r[t.target(o)];c&&p&&(o.x=[c.x,p.x],o.y=[c.y,p.y],o.source=c,o.target=p)});return e}function Qk(r){return(0,b.f0)({},E1,r)}function rC(r,e){var t=Qk(r),i={},o=e.nodes,c=e.links;o.forEach(function(_){var S=t.id(_);i[S]=_}),eC(i,c,t),qx(o,t);var p=aF(o,t),g=Kk(i,c,t);return{nodes:p,links:g}}var Kx="x",Pm="y",Zv="name",nC="source",oF={nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.5,lineWidth:2},label:{fields:["x","name"],callback:function(r,e){var t=(r[0]+r[1])/2,i=t>.5?-4:4;return{offsetX:i,content:e}},labelEmit:!0,style:{fill:"#8c8c8c"}},tooltip:{showTitle:!1,showMarkers:!1,fields:["source","target","value","isNode"],showContent:function(r){return!(0,b.U2)(r,[0,"data","isNode"])},formatter:function(r){var e=r.source,t=r.target,i=r.value;return{name:e+" -> "+t,value:i}}},interactions:[{type:"element-active"}],weight:!0,nodePaddingRatio:.1,nodeWidthRatio:.05};function iC(r){var e=r.options,t=e.data,i=e.sourceField,o=e.targetField,c=e.weightField,p=e.nodePaddingRatio,g=e.nodeWidthRatio,_=e.rawFields,S=_===void 0?[]:_,I=_x(t,i,o,c),L=rC({weight:!0,nodePaddingRatio:p,nodeWidthRatio:g},I),F=L.nodes,z=L.links,V=F.map(function(st){return(0,P.pi)((0,P.pi)({},ps(st,(0,P.pr)(["id","x","y","name"],S))),{isNode:!0})}),Q=z.map(function(st){return(0,P.pi)((0,P.pi)({source:st.source.name,target:st.target.name,name:st.source.name||st.target.name},ps(st,(0,P.pr)(["x","y","value"],S))),{isNode:!1})});return(0,P.pi)((0,P.pi)({},r),{ext:(0,P.pi)((0,P.pi)({},r.ext),{chordData:{nodesData:V,edgesData:Q}})})}function aC(r){var e,t=r.chart;return t.scale((e={x:{sync:!0,nice:!0},y:{sync:!0,nice:!0,max:1}},e[Zv]={sync:"color"},e[nC]={sync:"color"},e)),r}function D0(r){var e=r.chart;return e.axis(!1),r}function Vv(r){var e=r.chart;return e.legend(!1),r}function oC(r){var e=r.chart,t=r.options,i=t.tooltip;return e.tooltip(i),r}function sC(r){var e=r.chart;return e.coordinate("polar").reflect("y"),r}function w1(r){var e=r.chart,t=r.options,i=r.ext.chordData.nodesData,o=t.nodeStyle,c=t.label,p=t.tooltip,g=e.createView();return g.data(i),mm({chart:g,options:{xField:Kx,yField:Pm,seriesField:Zv,polygon:{style:o},label:c,tooltip:p}}),r}function uC(r){var e=r.chart,t=r.options,i=r.ext.chordData.edgesData,o=t.edgeStyle,c=t.tooltip,p=e.createView();p.data(i);var g={xField:Kx,yField:Pm,seriesField:nC,edge:{style:o,shape:"arc"},tooltip:c};return Rv({chart:p,options:g}),r}function lC(r){var e=r.chart,t=r.options,i=t.animation;return fm(e,i,k5(e)),r}function sF(r){return za(Go,iC,sC,aC,D0,Vv,oC,uC,w1,lu,I0,lC)(r)}var BR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="chord",t}return e.getDefaultOptions=function(){return oF},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return sF},e}(Ka),cC=["x","y","r","name","value","path","depth"],Jk={colorField:"name",autoFit:!0,pointStyle:{lineWidth:0,stroke:"#fff"},legend:!1,hierarchyConfig:{size:[1,1],padding:0},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1}},Om=4,tL=0,S1=5,C1="drilldown-bread-crumb",eL={position:"top-left",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}},Fm="hierarchy-data-transform-params",rL=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.name="drill-down",t.historyCache=[],t.breadCrumbGroup=null,t.breadCrumbCfg=eL,t}return e.prototype.click=function(){var t=(0,b.U2)(this.context,["event","data","data"]);if(!t)return!1;this.drill(t),this.drawBreadCrumb()},e.prototype.resetPosition=function(){if(this.breadCrumbGroup){var t=this.context.view.getCoordinate(),i=this.breadCrumbGroup,o=i.getBBox(),c=this.getButtonCfg().position,p={x:t.start.x,y:t.end.y-(o.height+S1*2)};t.isPolar&&(p={x:0,y:0}),c==="bottom-left"&&(p={x:t.start.x,y:t.start.y});var g=os.transform(null,[["t",p.x+tL,p.y+o.height+S1]]);i.setMatrix(g)}},e.prototype.back=function(){(0,b.dp)(this.historyCache)&&this.backTo(this.historyCache.slice(0,-1))},e.prototype.reset=function(){this.historyCache[0]&&this.backTo(this.historyCache.slice(0,1)),this.historyCache=[],this.hideCrumbGroup()},e.prototype.drill=function(t){var i=this.context.view,o=(0,b.U2)(i,["interactions","drill-down","cfg","transformData"],function(S){return S}),c=o((0,P.pi)({data:t.data},t[Fm]));i.changeData(c);for(var p=[],g=t;g;){var _=g.data;p.unshift({id:_.name+"_"+g.height+"_"+g.depth,name:_.name,children:o((0,P.pi)({data:_},t[Fm]))}),g=g.parent}this.historyCache=(this.historyCache||[]).slice(0,-1).concat(p)},e.prototype.backTo=function(t){if(!(!t||t.length<=0)){var i=this.context.view,o=(0,b.Z$)(t).children;i.changeData(o),t.length>1?(this.historyCache=t,this.drawBreadCrumb()):(this.historyCache=[],this.hideCrumbGroup())}},e.prototype.getButtonCfg=function(){var t=this.context.view,i=(0,b.U2)(t,["interactions","drill-down","cfg","drillDownConfig"]);return pn(this.breadCrumbCfg,i==null?void 0:i.breadCrumb,this.cfg)},e.prototype.drawBreadCrumb=function(){this.drawBreadCrumbGroup(),this.resetPosition(),this.breadCrumbGroup.show()},e.prototype.drawBreadCrumbGroup=function(){var t=this,i=this.getButtonCfg(),o=this.historyCache;this.breadCrumbGroup?this.breadCrumbGroup.clear():this.breadCrumbGroup=this.context.view.foregroundGroup.addGroup({name:C1});var c=0;o.forEach(function(p,g){var _=t.breadCrumbGroup.addShape({type:"text",id:p.id,name:C1+"_"+p.name+"_text",attrs:(0,P.pi)((0,P.pi)({text:g===0&&!(0,b.UM)(i.rootText)?i.rootText:p.name},i.textStyle),{x:c,y:0})}),S=_.getBBox();if(c+=S.width+Om,_.on("click",function(F){var z,V=F.target.get("id");if(V!==((z=(0,b.Z$)(o))===null||z===void 0?void 0:z.id)){var Q=o.slice(0,o.findIndex(function(st){return st.id===V})+1);t.backTo(Q)}}),_.on("mouseenter",function(F){var z,V=F.target.get("id");V!==((z=(0,b.Z$)(o))===null||z===void 0?void 0:z.id)?_.attr(i.activeTextStyle):_.attr({cursor:"default"})}),_.on("mouseleave",function(){_.attr(i.textStyle)}),g<o.length-1){var I=t.breadCrumbGroup.addShape({type:"text",name:i.name+"_"+p.name+"_divider",attrs:(0,P.pi)((0,P.pi)({text:i.dividerText},i.textStyle),{x:c,y:0})}),L=I.getBBox();c+=L.width+Om}})},e.prototype.hideCrumbGroup=function(){this.breadCrumbGroup&&this.breadCrumbGroup.hide()},e.prototype.destroy=function(){this.breadCrumbGroup&&this.breadCrumbGroup.remove(),r.prototype.destroy.call(this)},e}(Re);function nL(r){return ue()(r)==="object"&&"length"in r?r:Array.from(r)}function iL(r){for(var e=r.length,t,i;e;)i=Math.random()*e--|0,t=r[e],r[e]=r[i],r[i]=t;return r}function A1(r){for(var e=0,t=(r=iL(Array.from(r))).length,i=[],o,c;e<t;)o=r[e],c&&fC(c,o)?++e:(c=Zc(i=aL(i,o)),e=0);return c}function aL(r,e){var t,i;if(M1(e,r))return[e];for(t=0;t<r.length;++t)if(T1(e,r[t])&&M1(bg(r[t],e),r))return[r[t],e];for(t=0;t<r.length-1;++t)for(i=t+1;i<r.length;++i)if(T1(bg(r[t],r[i]),e)&&T1(bg(r[t],e),r[i])&&T1(bg(r[i],e),r[t])&&M1(hC(r[t],r[i],e),r))return[r[t],r[i],e];throw new Error}function T1(r,e){var t=r.r-e.r,i=e.x-r.x,o=e.y-r.y;return t<0||t*t<i*i+o*o}function fC(r,e){var t=r.r-e.r+Math.max(r.r,e.r,1)*1e-9,i=e.x-r.x,o=e.y-r.y;return t>0&&t*t>i*i+o*o}function M1(r,e){for(var t=0;t<e.length;++t)if(!fC(r,e[t]))return!1;return!0}function Zc(r){switch(r.length){case 1:return Qx(r[0]);case 2:return bg(r[0],r[1]);case 3:return hC(r[0],r[1],r[2])}}function Qx(r){return{x:r.x,y:r.y,r:r.r}}function bg(r,e){var t=r.x,i=r.y,o=r.r,c=e.x,p=e.y,g=e.r,_=c-t,S=p-i,I=g-o,L=Math.sqrt(_*_+S*S);return{x:(t+c+_/L*I)/2,y:(i+p+S/L*I)/2,r:(L+o+g)/2}}function hC(r,e,t){var i=r.x,o=r.y,c=r.r,p=e.x,g=e.y,_=e.r,S=t.x,I=t.y,L=t.r,F=i-p,z=i-S,V=o-g,Q=o-I,st=_-c,at=L-c,Ft=i*i+o*o-c*c,Kt=Ft-p*p-g*g+_*_,ee=Ft-S*S-I*I+L*L,Me=z*V-F*Q,hr=(V*ee-Q*Kt)/(Me*2)-i,Tr=(Q*st-V*at)/Me,Dr=(z*Kt-F*ee)/(Me*2)-o,cn=(F*at-z*st)/Me,Jr=Tr*Tr+cn*cn-1,Mn=2*(c+hr*Tr+Dr*cn),mi=hr*hr+Dr*Dr-c*c,da=-(Jr?(Mn+Math.sqrt(Mn*Mn-4*Jr*mi))/(2*Jr):mi/Mn);return{x:i+hr+Tr*da,y:o+Dr+cn*da,r:da}}function pC(r,e,t){var i=r.x-e.x,o,c,p=r.y-e.y,g,_,S=i*i+p*p;S?(c=e.r+t.r,c*=c,_=r.r+t.r,_*=_,c>_?(o=(S+_-c)/(2*S),g=Math.sqrt(Math.max(0,_/S-o*o)),t.x=r.x-o*i-g*p,t.y=r.y-o*p+g*i):(o=(S+c-_)/(2*S),g=Math.sqrt(Math.max(0,c/S-o*o)),t.x=e.x+o*i-g*p,t.y=e.y+o*p+g*i)):(t.x=e.x+t.r,t.y=e.y)}function Rm(r,e){var t=r.r+e.r-1e-6,i=e.x-r.x,o=e.y-r.y;return t>0&&t*t>i*i+o*o}function I1(r){var e=r._,t=r.next._,i=e.r+t.r,o=(e.x*t.r+t.x*e.r)/i,c=(e.y*t.r+t.y*e.r)/i;return o*o+c*c}function Dm(r){this._=r,this.next=null,this.previous=null}function dC(r){if(!(o=(r=nL(r)).length))return 0;var e,t,i,o,c,p,g,_,S,I,L;if(e=r[0],e.x=0,e.y=0,!(o>1))return e.r;if(t=r[1],e.x=-t.r,t.x=e.r,t.y=0,!(o>2))return e.r+t.r;pC(t,e,i=r[2]),e=new Dm(e),t=new Dm(t),i=new Dm(i),e.next=i.previous=t,t.next=e.previous=i,i.next=t.previous=e;t:for(g=3;g<o;++g){pC(e._,t._,i=r[g]),i=new Dm(i),_=t.next,S=e.previous,I=t._.r,L=e._.r;do if(I<=L){if(Rm(_._,i._)){t=_,e.next=t,t.previous=e,--g;continue t}I+=_._.r,_=_.next}else{if(Rm(S._,i._)){e=S,e.next=t,t.previous=e,--g;continue t}L+=S._.r,S=S.previous}while(_!==S.next);for(i.previous=e,i.next=t,e.next=t.previous=t=i,c=I1(e);(i=i.next)!==t;)(p=I1(i))<c&&(e=i,c=p);t=e.next}for(e=[t._],i=t;(i=i.next)!==t;)e.push(i._);for(i=A1(e),g=0;g<o;++g)e=r[g],e.x-=i.x,e.y-=i.y;return i.r}function k1(r){return dC(r),r}function Jx(r){return r==null?null:L1(r)}function L1(r){if(typeof r!="function")throw new Error;return r}function $p(){return 0}function mp(r){return function(){return r}}function oL(r){return Math.sqrt(r.value)}function vC(){var r=null,e=1,t=1,i=$p;function o(c){return c.x=e/2,c.y=t/2,r?c.eachBefore(gC(r)).eachAfter(tb(i,.5)).eachBefore(eb(1)):c.eachBefore(gC(oL)).eachAfter(tb($p,1)).eachAfter(tb(i,c.r/Math.min(e,t))).eachBefore(eb(Math.min(e,t)/(2*c.r))),c}return o.radius=function(c){return arguments.length?(r=Jx(c),o):r},o.size=function(c){return arguments.length?(e=+c[0],t=+c[1],o):[e,t]},o.padding=function(c){return arguments.length?(i=typeof c=="function"?c:mp(+c),o):i},o}function gC(r){return function(e){e.children||(e.r=Math.max(0,+r(e)||0))}}function tb(r,e){return function(t){if(i=t.children){var i,o,c=i.length,p=r(t)*e||0,g;if(p)for(o=0;o<c;++o)i[o].r+=p;if(g=dC(i),p)for(o=0;o<c;++o)i[o].r-=p;t.r=g+p}}}function eb(r){return function(e){var t=e.parent;e.r*=r,t&&(e.x=t.x+r*e.x,e.y=t.y+r*e.y)}}var sL=nt(39620),mC=nt.n(sL);function yC(r){var e=0,t=r.children,i=t&&t.length;if(!i)e=1;else for(;--i>=0;)e+=t[i].value;r.value=e}function _C(){return this.eachAfter(yC)}var xC=nt(14912),rb=nt.n(xC);function uL(r,e){var t=-1,i=rb()(this),o;try{for(i.s();!(o=i.n()).done;){var c=o.value;r.call(e,c,++t,this)}}catch(p){i.e(p)}finally{i.f()}return this}function P1(r,e){for(var t=this,i=[t],o,c,p=-1;t=i.pop();)if(r.call(e,t,++p,this),o=t.children)for(c=o.length-1;c>=0;--c)i.push(o[c]);return this}function nb(r,e){for(var t=this,i=[t],o=[],c,p,g,_=-1;t=i.pop();)if(o.push(t),c=t.children)for(p=0,g=c.length;p<g;++p)i.push(c[p]);for(;t=o.pop();)r.call(e,t,++_,this);return this}function bC(r,e){var t=-1,i=rb()(this),o;try{for(i.s();!(o=i.n()).done;){var c=o.value;if(r.call(e,c,++t,this))return c}}catch(p){i.e(p)}finally{i.f()}}function lL(r){return this.eachAfter(function(e){for(var t=+r(e.data)||0,i=e.children,o=i&&i.length;--o>=0;)t+=i[o].value;e.value=t})}function cL(r){return this.eachBefore(function(e){e.children&&e.children.sort(r)})}function fL(r){for(var e=this,t=hL(e,r),i=[e];e!==t;)e=e.parent,i.push(e);for(var o=i.length;r!==t;)i.splice(o,0,r),r=r.parent;return i}function hL(r,e){if(r===e)return r;var t=r.ancestors(),i=e.ancestors(),o=null;for(r=t.pop(),e=i.pop();r===e;)o=r,r=t.pop(),e=i.pop();return o}function Bm(){for(var r=this,e=[r];r=r.parent;)e.push(r);return e}function EC(){return Array.from(this)}function pL(){var r=[];return this.eachBefore(function(e){e.children||r.push(e)}),r}function wC(){var r=this,e=[];return r.each(function(t){t!==r&&e.push({source:t.parent,target:t})}),e}var SC=nt(84019),ib=nt.n(SC),dL=ib()().mark(CC);function CC(){var r,e,t,i,o,c;return ib()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:r=this,t=[r];case 1:e=t.reverse(),t=[];case 2:if(!(r=e.pop())){g.next=8;break}return g.next=5,r;case 5:if(i=r.children)for(o=0,c=i.length;o<c;++o)t.push(i[o]);g.next=2;break;case 8:if(t.length){g.next=1;break}case 9:case"end":return g.stop()}},dL,this)}function Eg(r,e){r instanceof Map?(r=[void 0,r],e===void 0&&(e=AC)):e===void 0&&(e=gL);for(var t=new B0(r),i,o=[t],c,p,g,_;i=o.pop();)if((p=e(i.data))&&(_=(p=Array.from(p)).length))for(i.children=p,g=_-1;g>=0;--g)o.push(c=p[g]=new B0(p[g])),c.parent=i,c.depth=i.depth+1;return t.eachBefore(ab)}function vL(){return Eg(this).eachBefore(mL)}function gL(r){return r.children}function AC(r){return Array.isArray(r)?r[1]:null}function mL(r){r.data.value!==void 0&&(r.value=r.data.value),r.data=r.data.data}function ab(r){var e=0;do r.height=e;while((r=r.parent)&&r.height<++e)}function B0(r){this.data=r,this.depth=this.height=0,this.parent=null}B0.prototype=Eg.prototype=mC()({constructor:B0,count:_C,each:uL,eachAfter:nb,eachBefore:P1,find:bC,sum:lL,sort:cL,path:fL,ancestors:Bm,descendants:EC,leaves:pL,links:wC,copy:vL},Symbol.iterator,CC);var ob="nodeIndex",TC="childNodeCount",sb="nodeAncestor",O1="Invalid field: it must be a string!";function ub(r,e){var t=r.field,i=r.fields;if((0,b.HD)(t))return t;if((0,b.kJ)(t))return console.warn(O1),t[0];if(console.warn(O1+" will try to get fields instead."),(0,b.HD)(i))return i;if((0,b.kJ)(i)&&i.length)return i[0];if(e)return e;throw new TypeError(O1)}function lb(r){var e=[];if(r&&r.each){var t,i;r.each(function(o){var c,p;o.parent!==t?(t=o.parent,i=0):i+=1;var g=(0,b.hX)((((c=o.ancestors)===null||c===void 0?void 0:c.call(o))||[]).map(function(_){return e.find(function(S){return S.name===_.name})||_}),function(_){var S=_.depth;return S>0&&S<o.depth});o[sb]=g,o[TC]=((p=o.children)===null||p===void 0?void 0:p.length)||0,o[ob]=i,e.push(o)})}else r&&r.eachNode&&r.eachNode(function(o){e.push(o)});return e}var yL={field:"value",as:["x","y","r"],sort:function(r,e){return e.value-r.value}};function cb(r,e){e=(0,b.f0)({},yL,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==3)throw new TypeError('Invalid as: it must be an array with 3 strings (e.g. [ "x", "y", "r" ])!');var i;try{i=ub(e)}catch(S){console.warn(S)}var o=function(S){return vC().size(e.size).padding(e.padding)(Eg(S).sum(function(I){return I[i]}).sort(e.sort))},c=o(r),p=t[0],g=t[1],_=t[2];return c.each(function(S){S[p]=S.x,S[g]=S.y,S[_]=S.r}),lb(c)}function _L(r){var e=r.data,t=r.hierarchyConfig,i=r.rawFields,o=i===void 0?[]:i,c=r.enableDrillDown,p=cb(e,(0,P.pi)((0,P.pi)({},t),{field:"value",as:["x","y","r"]})),g=[];return p.forEach(function(_){for(var S,I=_.data.name,L=(0,P.pi)({},_);L.depth>1;)I=((S=L.parent.data)===null||S===void 0?void 0:S.name)+" / "+I,L=L.parent;if(c&&_.depth>2)return null;var F=pn({},_.data,(0,P.pi)((0,P.pi)((0,P.pi)({},ps(_.data,o)),{path:I}),_));F.ext=t,F[Fm]={hierarchyConfig:t,rawFields:o,enableDrillDown:c},g.push(F)}),g}function fb(r,e,t){var i=bx([r,e]),o=i[0],c=i[1],p=i[2],g=i[3],_=t.width,S=t.height,I=_-(g+c),L=S-(o+p),F=Math.min(I,L),z=(I-F)/2,V=(L-F)/2,Q=o+V,st=c+z,at=p+V,Ft=g+z,Kt=[Q,st,at,Ft],ee=F<0?0:F;return{finalPadding:Kt,finalSize:ee}}function MC(r){var e=r.chart,t=Math.min(e.viewBBox.width,e.viewBBox.height);return pn({options:{size:function(i){var o=i.r;return o*t}}},r)}function IC(r){var e=r.options,t=r.chart,i=t.viewBBox,o=e.padding,c=e.appendPadding,p=e.drilldown,g=c;if(p!=null&&p.enabled){var _=lm(t.appendPadding,(0,b.U2)(p,["breadCrumb","position"]));g=bx([_,c])}var S=fb(o,g,i).finalPadding;return t.padding=S,t.appendPadding=0,r}function hb(r){var e=r.chart,t=r.options,i=e.padding,o=e.appendPadding,c=t.color,p=t.colorField,g=t.pointStyle,_=t.hierarchyConfig,S=t.sizeField,I=t.rawFields,L=I===void 0?[]:I,F=t.drilldown,z=_L({data:t.data,hierarchyConfig:_,enableDrillDown:F==null?void 0:F.enabled,rawFields:L});e.data(z);var V=e.viewBBox,Q=fb(i,o,V).finalSize,st=function(at){var Ft=at.r;return Ft*Q};return S&&(st=function(at){return at[S]*Q}),Bf(pn({},r,{options:{xField:"x",yField:"y",seriesField:p,sizeField:S,rawFields:(0,P.pr)(cC,L),point:{color:c,style:g,shape:"circle",size:st}}})),r}function pb(r){return za(So({},{x:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0},y:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0}}))(r)}function hf(r){var e=r.chart,t=r.options,i=t.tooltip;if(i===!1)e.tooltip(!1);else{var o=i;(0,b.U2)(i,"fields")||(o=pn({},{customItems:function(c){return c.map(function(p){var g=(0,b.U2)(e.getOptions(),"scales"),_=(0,b.U2)(g,["name","formatter"],function(I){return I}),S=(0,b.U2)(g,["value","formatter"],function(I){return I});return(0,P.pi)((0,P.pi)({},p),{name:_(p.data.name),value:S(p.data.value)})})}},o)),e.tooltip(o)}return r}function db(r){var e=r.chart;return e.axis(!1),r}function wg(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t;return e!=null&&e.enabled?pn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:_L,enableDrillDown:!0}}])}):r}function uF(r){var e=r.chart,t=r.options;return lu({chart:e,options:wg(t)}),r}function kC(r){return za(Vo("pointStyle"),MC,IC,Go,pb,hb,db,jd,hf,uF,ds,ms())(r)}function LC(r){var e=(0,b.U2)(r,["event","data","data"],{});return(0,b.kJ)(e.children)&&e.children.length>0}function xL(r){var e=r.view.getCoordinate(),t=e.innerRadius;if(t){var i=r.event,o=i.x,c=i.y,p=e.center,g=p.x,_=p.y,S=e.getRadius()*t,I=Math.sqrt(Math.pow(g-o,2)+Math.pow(_-c,2));return I<S}return!1}jr("drill-down-action",rL),Ye("drill-down",{showEnable:[{trigger:"element:mouseenter",action:"cursor:pointer",isEnable:LC},{trigger:"element:mouseleave",action:"cursor:default"},{trigger:"element:mouseleave",action:"cursor:pointer",isEnable:xL}],start:[{trigger:"element:click",isEnable:LC,action:["drill-down-action:click"]},{trigger:"afterchangesize",action:["drill-down-action:resetPosition"]},{trigger:"click",isEnable:xL,action:["drill-down-action:back"]}]});var vb=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle-packing",t}return e.getDefaultOptions=function(){return Jk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return kC},e.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},e}(Ka),Mc="left-axes-view",Nf="right-axes-view",gb={nice:!0,label:{autoHide:!0,autoRotate:!1}},PC=(0,P.pi)((0,P.pi)({},gb),{position:"left"}),N0=(0,P.pi)((0,P.pi)({},gb),{position:"right",grid:null}),Gv;(function(r){r.Left="Left",r.Right="Right"})(Gv||(Gv={}));var qp;(function(r){r.Line="line",r.Column="column"})(qp||(qp={}));function mb(r){return(0,b.U2)(r,"geometry")===qp.Line}function yb(r){return(0,b.U2)(r,"geometry")===qp.Column}function z0(r,e,t){return yb(t)?pn({},{geometry:qp.Column,label:t.label&&t.isRange?{content:function(i){var o;return(o=i[e])===null||o===void 0?void 0:o.join("-")}}:void 0},t):(0,P.pi)({geometry:qp.Line},t)}function OC(r,e){var t=r[0],i=r[1];if((0,b.kJ)(e)){var o=e[0],c=e[1];return[o,c]}var p=(0,b.U2)(e,t),g=(0,b.U2)(e,i);return[p,g]}function FC(r,e){return e===Gv.Left?r===!1?!1:pn({},PC,r):e===Gv.Right?r===!1?!1:pn({},N0,r):r}function lF(r){var e=r.options,t=r.chart,i=e.geometryOption,o=i.isStack,c=i.color,p=i.seriesField,g=i.groupField,_=i.isGroup,S=["xField","yField"];if(mb(i)){k0(pn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},ps(e,S)),i),{line:{color:i.color,style:i.lineStyle}})})),Bf(pn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},ps(e,S)),i),{point:i.point&&(0,P.pi)({color:c,shape:"circle"},i.point)})}));var I=[];_&&I.push({type:"dodge",dodgeBy:g||p,customOffset:0}),o&&I.push({type:"stack"}),I.length&&(0,b.S6)(t.geometries,function(L){L.adjust(I)})}return yb(i)&&p1(pn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},ps(e,S)),i),{widthRatio:i.columnWidthRatio,interval:(0,P.pi)((0,P.pi)({},ps(i,["color"])),{style:i.columnStyle})})})),r}function bL(r){var e=r.view,t=r.geometryOption,i=r.yField,o=r.legend,c=(0,b.U2)(o,"marker"),p=Ac(e,mb(t)?"line":"interval");if(!t.seriesField){var g=(0,b.U2)(e,"options.scales."+i+".alias")||i,_=p.getAttribute("color"),S=e.getTheme().defaultColor;_&&(S=os.getMappingValue(_,g,(0,b.U2)(_,["values",0],S)));var I=((0,b.mf)(c)?c:!(0,b.xb)(c)&&pn({},{style:{stroke:S,fill:S}},c))||(mb(t)?{symbol:function(F,z,V){return[["M",F-V,z],["L",F+V,z]]},style:{lineWidth:2,r:6,stroke:S}}:{symbol:"square",style:{fill:S}});return[{value:i,name:g,marker:I,isGeometry:!0,viewId:e.id}]}var L=p.getGroupAttributes();return(0,b.u4)(L,function(F,z){var V=os.getLegendItems(e,p,z,e.getTheme(),c);return F.concat(V)},[])}var EL=function(r,e){var t=e[0],i=e[1],o=r.getOptions().data,c=r.getXScale(),p=(0,b.dp)(o);if(!(!c||!p)){var g=!0,_=(0,b.I)(o,c.field),S=g?_:_.reverse(),I=(0,b.dp)(S),L=Math.floor(t*(I-1)),F=Math.floor(i*(I-1));r.filter(c.field,function(z){var V=S.indexOf(z);return V>-1?L5(V,L,F):!0}),r.getRootView().render(!0)}};function cF(r){var e,t=r.options,i=t.geometryOptions,o=i===void 0?[]:i,c=t.xField,p=t.yField,g=(0,b.yW)(o,function(_){var S=_.geometry;return S===qp.Line||S===void 0});return pn({},{options:{geometryOptions:[],meta:(e={},e[c]={type:"cat",sync:!0,range:g?[0,1]:void 0},e),tooltip:{showMarkers:g,showCrosshairs:g,shared:!0,crosshairs:{type:"x"}},interactions:g?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},r,{options:{yAxis:OC(p,t.yAxis),geometryOptions:[z0(c,p[0],o[0]),z0(c,p[1],o[1])],annotations:OC(p,t.annotations)}})}function fF(r){var e,t,i=r.chart,o=r.options,c=o.geometryOptions,p={line:0,column:1},g=[{type:(e=c[0])===null||e===void 0?void 0:e.geometry,id:Mc},{type:(t=c[1])===null||t===void 0?void 0:t.geometry,id:Nf}];return g.sort(function(_,S){return-p[_.type]+p[S.type]}).forEach(function(_){return i.createView({id:_.id})}),r}function hF(r){var e=r.chart,t=r.options,i=t.xField,o=t.yField,c=t.geometryOptions,p=t.data,g=t.tooltip,_=[(0,P.pi)((0,P.pi)({},c[0]),{id:Mc,data:p[0],yField:o[0]}),(0,P.pi)((0,P.pi)({},c[1]),{id:Nf,data:p[1],yField:o[1]})];return _.forEach(function(S){var I=S.id,L=S.data,F=S.yField,z=yb(S)&&S.isPercent,V=z?jw(L,F,i,F):L,Q=yo(e,I).data(V),st=z?(0,P.pi)({formatter:function(at){return{name:at[S.seriesField]||F,value:(Number(at[F])*100).toFixed(2)+"%"}}},g):g;lF({chart:Q,options:{xField:i,yField:F,tooltip:st,geometryOption:S}})}),r}function pF(r){var e,t=r.chart,i=r.options,o=i.geometryOptions,c=((e=t.getTheme())===null||e===void 0?void 0:e.colors10)||[],p=0;return t.once("beforepaint",function(){(0,b.S6)(o,function(g,_){var S=yo(t,_===0?Mc:Nf);if(!g.color){var I=S.getGroupScales(),L=(0,b.U2)(I,[0,"values","length"],1),F=c.slice(p,p+L).concat(_===0?[]:c);S.geometries.forEach(function(z){g.seriesField?z.color(g.seriesField,F):z.color(F[0])}),p+=L}}),t.render(!0)}),r}function RC(r){var e,t,i=r.chart,o=r.options,c=o.xAxis,p=o.yAxis,g=o.xField,_=o.yField;return So((e={},e[g]=c,e[_[0]]=p[0],e))(pn({},r,{chart:yo(i,Mc)})),So((t={},t[g]=c,t[_[1]]=p[1],t))(pn({},r,{chart:yo(i,Nf)})),r}function _b(r){var e=r.chart,t=r.options,i=yo(e,Mc),o=yo(e,Nf),c=t.xField,p=t.yField,g=t.xAxis,_=t.yAxis;return e.axis(c,!1),e.axis(p[0],!1),e.axis(p[1],!1),i.axis(c,g),i.axis(p[0],FC(_[0],Gv.Left)),o.axis(c,!1),o.axis(p[1],FC(_[1],Gv.Right)),r}function dF(r){var e=r.chart,t=r.options,i=t.tooltip,o=yo(e,Mc),c=yo(e,Nf);return e.tooltip(i),o.tooltip({shared:!0}),c.tooltip({shared:!0}),r}function DC(r){var e=r.chart;return lu(pn({},r,{chart:yo(e,Mc)})),lu(pn({},r,{chart:yo(e,Nf)})),r}function wL(r){var e=r.chart,t=r.options,i=t.annotations,o=(0,b.U2)(i,[0]),c=(0,b.U2)(i,[1]);return ms(o)(pn({},r,{chart:yo(e,Mc),options:{annotations:o}})),ms(c)(pn({},r,{chart:yo(e,Nf),options:{annotations:c}})),r}function vF(r){var e=r.chart;return Go(pn({},r,{chart:yo(e,Mc)})),Go(pn({},r,{chart:yo(e,Nf)})),Go(r),r}function BC(r){var e=r.chart;return ds(pn({},r,{chart:yo(e,Mc)})),ds(pn({},r,{chart:yo(e,Nf)})),r}function SL(r){var e=r.chart,t=r.options,i=t.yAxis;return Oh(pn({},r,{chart:yo(e,Mc),options:{yAxis:i[0]}})),Oh(pn({},r,{chart:yo(e,Nf),options:{yAxis:i[1]}})),r}function gF(r){var e=r.chart,t=r.options,i=t.legend,o=t.geometryOptions,c=t.yField,p=t.data,g=yo(e,Mc),_=yo(e,Nf);if(i===!1)e.legend(!1);else if((0,b.Kn)(i)&&i.custom===!0)e.legend(i);else{var S=(0,b.U2)(o,[0,"legend"],i),I=(0,b.U2)(o,[1,"legend"],i);e.once("beforepaint",function(){var L=p[0].length?bL({view:g,geometryOption:o[0],yField:c[0],legend:S}):[],F=p[1].length?bL({view:_,geometryOption:o[1],yField:c[1],legend:I}):[];e.legend(pn({},i,{custom:!0,items:L.concat(F)}))}),o[0].seriesField&&g.legend(o[0].seriesField,S),o[1].seriesField&&_.legend(o[1].seriesField,I),e.on("legend-item:click",function(L){var F=(0,b.U2)(L,"gEvent.delegateObject",{});if(F&&F.item){var z=F.item,V=z.value,Q=z.isGeometry,st=z.viewId;if(Q){var at=(0,b.cx)(c,function(ee){return ee===V});if(at>-1){var Ft=(0,b.U2)(yo(e,st),"geometries");(0,b.S6)(Ft,function(ee){ee.changeVisible(!F.item.unchecked)})}}else{var Kt=(0,b.U2)(e.getController("legend"),"option.items",[]);(0,b.S6)(e.views,function(ee){var Me=ee.getGroupScales();(0,b.S6)(Me,function(hr){hr.values&&hr.values.indexOf(V)>-1&&ee.filter(hr.field,function(Tr){var Dr=(0,b.sE)(Kt,function(cn){return cn.value===Tr});return!Dr.unchecked})}),e.render(!0)})}}})}return r}function NC(r){var e=r.chart,t=r.options,i=t.slider,o=yo(e,Mc),c=yo(e,Nf);return i&&(o.option("slider",i),o.on("slider:valuechanged",function(p){var g=p.event,_=g.value,S=g.originValue;(0,b.Xy)(_,S)||EL(c,_)}),e.once("afterpaint",function(){if(!(0,b.jn)(i)){var p=i.start,g=i.end;(p||g)&&EL(c,[p,g])}})),r}function CL(r){return za(cF,fF,vF,hF,RC,_b,SL,dF,DC,wL,BC,pF,gF,NC)(r)}var NR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dual-axes",t}return e.prototype.getDefaultOptions=function(){return pn({},r.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},e.prototype.getSchemaAdaptor=function(){return CL},e}(Ka);function F1(r,e){var t=e.data,i=e.coordinate,o=e.interactions,c=e.annotations,p=e.animation,g=e.tooltip,_=e.axes,S=e.meta,I=e.geometries;t&&r.data(t);var L={};_&&(0,b.S6)(_,function(F,z){L[z]=ps(F,Df)}),L=pn({},S,L),r.scale(L),i&&r.coordinate(i),_===!1?r.axis(!1):(0,b.S6)(_,function(F,z){r.axis(z,F)}),(0,b.S6)(I,function(F){var z=Ru({chart:r,options:F}).ext,V=F.adjust;V&&z.geometry.adjust(V)}),(0,b.S6)(o,function(F){F.enable===!1?r.removeInteraction(F.type):r.interaction(F.type,F.cfg)}),(0,b.S6)(c,function(F){r.annotation()[F.type]((0,P.pi)({},F))}),fm(r,p),g?(r.interaction("tooltip"),r.tooltip(g)):g===!1&&r.removeInteraction("tooltip")}function AL(r){var e=r.chart,t=r.options,i=t.type,o=t.data,c=t.fields,p=t.eachView,g=(0,b.CE)(t,["type","data","fields","eachView","axes","meta","tooltip","coordinate","theme","legend","interactions","annotations"]);return e.data(o),e.facet(i,(0,P.pi)((0,P.pi)({},g),{fields:c,eachView:function(_,S){var I=p(_,S);if(I.geometries)F1(_,I);else{var L=I,F=L.options;F.tooltip&&_.interaction("tooltip"),Gx(L.type,_,F)}}})),r}function mF(r){var e=r.chart,t=r.options,i=t.axes,o=t.meta,c=t.tooltip,p=t.coordinate,g=t.theme,_=t.legend,S=t.interactions,I=t.annotations,L={};return i&&(0,b.S6)(i,function(F,z){L[z]=ps(F,Df)}),L=pn({},o,L),e.scale(L),e.coordinate(p),i?(0,b.S6)(i,function(F,z){e.axis(z,F)}):e.axis(!1),c?(e.interaction("tooltip"),e.tooltip(c)):c===!1&&e.removeInteraction("tooltip"),e.legend(_),g&&e.theme(g),(0,b.S6)(S,function(F){F.enable===!1?e.removeInteraction(F.type):e.interaction(F.type,F.cfg)}),(0,b.S6)(I,function(F){e.annotation()[F.type]((0,P.pi)({},F))}),r}function U0(r){return za(Go,AL,mF)(r)}var zC={title:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},rowTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},columnTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}}},xb=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="area",t}return e.getDefaultOptions=function(){return zC},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return U0},e}(Ka);function TL(r){var e=r.chart,t=r.options,i=t.data,o=t.type,c=t.xField,p=t.yField,g=t.colorField,_=t.sizeField,S=t.sizeRatio,I=t.shape,L=t.color,F=t.tooltip,z=t.heatmapStyle,V=t.meta;e.data(i);var Q="polygon";o==="density"&&(Q="heatmap");var st=dp(F,[c,p,g]),at=st.fields,Ft=st.formatter,Kt=1;return(S||S===0)&&(!I&&!_?console.warn("sizeRatio is not in effect: Must define shape or sizeField first"):S<0||S>1?console.warn("sizeRatio is not in effect: It must be a number in [0,1]"):Kt=S),Ru(pn({},r,{options:{type:Q,colorField:g,tooltipFields:at,shapeField:_||"",label:void 0,mapping:{tooltip:Ft,shape:I&&(_?function(ee){var Me=i.map(function(cn){return cn[_]}),hr=(V==null?void 0:V[_])||{},Tr=hr.min,Dr=hr.max;return Tr=(0,b.hj)(Tr)?Tr:Math.min.apply(Math,Me),Dr=(0,b.hj)(Dr)?Dr:Math.max.apply(Math,Me),[I,((0,b.U2)(ee,_)-Tr)/(Dr-Tr),Kt]}:function(){return[I,1,Kt]}),color:L||g&&e.getTheme().sequenceColors.join("-"),style:z}}})),r}function ML(r){var e,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return za(So((e={},e[c]=i,e[p]=o,e)))(r)}function Sg(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),o===!1?e.axis(p,!1):e.axis(p,o),r}function IL(r){var e=r.chart,t=r.options,i=t.legend,o=t.colorField,c=t.sizeField,p=t.sizeLegend,g=i!==!1;return o&&e.legend(o,g?i:!1),c&&e.legend(c,p===void 0?i:p),!g&&!p&&e.legend(!1),r}function kL(r){var e=r.chart,t=r.options,i=t.label,o=t.colorField,c=t.type,p=Ac(e,c==="density"?"heatmap":"polygon");if(!i)p.label(!1);else if(o){var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:[o],callback:g,cfg:Kl(_)})}return r}function yF(r){var e,t,i=r.chart,o=r.options,c=o.coordinate,p=o.reflect,g=pn({actions:[]},c!=null?c:{type:"rect"});return p&&((t=(e=g.actions)===null||e===void 0?void 0:e.push)===null||t===void 0||t.call(e,["reflect",p])),i.coordinate(g),r}function _F(r){return za(Go,Vo("heatmapStyle"),ML,yF,TL,Sg,IL,Ol,kL,ms(),lu,ds,I0)(r)}var xF=pn({},Ka.getDefaultOptions(),{type:"polygon",legend:!1,coordinate:{type:"rect"},xAxis:{tickLine:null,line:null,grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}},yAxis:{grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}}});_i("polygon","circle",{draw:function(r,e){var t,i,o=r.x,c=r.y,p=this.parsePoints(r.points),g=Math.abs(p[2].x-p[1].x),_=Math.abs(p[1].y-p[0].y),S=Math.min(g,_)/2,I=Number(r.shape[1]),L=Number(r.shape[2]),F=Math.sqrt(L),z=S*F*Math.sqrt(I),V=((t=r.style)===null||t===void 0?void 0:t.fill)||r.color||((i=r.defaultStyle)===null||i===void 0?void 0:i.fill),Q=e.addShape("circle",{attrs:(0,P.pi)((0,P.pi)((0,P.pi)({x:o,y:c,r:z},r.defaultStyle),r.style),{fill:V})});return Q}}),_i("polygon","square",{draw:function(r,e){var t,i,o=r.x,c=r.y,p=this.parsePoints(r.points),g=Math.abs(p[2].x-p[1].x),_=Math.abs(p[1].y-p[0].y),S=Math.min(g,_),I=Number(r.shape[1]),L=Number(r.shape[2]),F=Math.sqrt(L),z=S*F*Math.sqrt(I),V=((t=r.style)===null||t===void 0?void 0:t.fill)||r.color||((i=r.defaultStyle)===null||i===void 0?void 0:i.fill),Q=e.addShape("rect",{attrs:(0,P.pi)((0,P.pi)((0,P.pi)({x:o-z/2,y:c-z/2,width:z,height:z},r.defaultStyle),r.style),{fill:V})});return Q}});var zR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="heatmap",t}return e.getDefaultOptions=function(){return xF},e.prototype.getSchemaAdaptor=function(){return _F},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ka),bF="liquid";function LL(r){return[{percent:r,type:bF}]}function EF(r){var e=r.chart,t=r.options,i=t.percent,o=t.liquidStyle,c=t.radius,p=t.outline,g=t.wave,_=t.shape,S=t.shapeStyle,I=t.animation;e.scale({percent:{min:0,max:1}}),e.data(LL(i));var L=t.color||e.getTheme().defaultColor,F=pn({},r,{options:{xField:"type",yField:"percent",widthRatio:c,interval:{color:L,style:o,shape:"liquid-fill-gauge"}}}),z=pc(F).ext,V=z.geometry,Q=e.getTheme().background,st={percent:i,radius:c,outline:p,wave:g,shape:_,shapeStyle:S,background:Q,animation:I};return V.customInfo(st),e.legend(!1),e.axis(!1),e.tooltip(!1),r}function bb(r,e){var t=r.chart,i=r.options,o=i.statistic,c=i.percent,p=i.meta;t.getController("annotation").clear(!0);var g=(0,b.U2)(p,["percent","formatter"])||function(S){return(S*100).toFixed(2)+"%"},_=o.content;return _&&(_=pn({},_,{content:(0,b.UM)(_.content)?g(c):_.content})),i1(t,{statistic:(0,P.pi)((0,P.pi)({},o),{content:_}),plotType:"liquid"},{percent:c}),e&&t.render(!0),r}function UC(r){return za(Go,Vo("liquidStyle"),EF,bb,So({}),ds,lu)(r)}var wF={radius:.9,statistic:{title:!1,content:{style:{opacity:.75,fontSize:"30px",lineHeight:"30px",textAlign:"center"}}},outline:{border:2,distance:0},wave:{count:3,length:192},shape:"circle"},R1=5e3;function Cg(r,e,t){return r+(e-r)*t}function SF(r){var e=(0,P.pi)({opacity:1},r.style);return r.color&&!e.fill&&(e.fill=r.color),e}function Eb(r){var e={fill:"#fff",fillOpacity:0,lineWidth:4},t=(0,b.CD)({},e,r.style);return r.color&&!t.stroke&&(t.stroke=r.color),(0,b.hj)(r.opacity)&&(t.opacity=t.strokeOpacity=r.opacity),t}function wb(r,e,t,i){return e===0?[[r+1/2*t/Math.PI/2,i/2],[r+1/2*t/Math.PI,i],[r+t/4,i]]:e===1?[[r+1/2*t/Math.PI/2*(Math.PI-2),i],[r+1/2*t/Math.PI/2*(Math.PI-1),i/2],[r+t/4,0]]:e===2?[[r+1/2*t/Math.PI/2,-i/2],[r+1/2*t/Math.PI,-i],[r+t/4,-i]]:[[r+1/2*t/Math.PI/2*(Math.PI-2),-i],[r+1/2*t/Math.PI/2*(Math.PI-1),-i/2],[r+t/4,0]]}function Nm(r,e,t,i,o,c,p){for(var g=Math.ceil(2*r/t*4)*4,_=[],S=i;S<-Math.PI*2;)S+=Math.PI*2;for(;S>0;)S-=Math.PI*2;S=S/Math.PI/2*t;var I=c-r+S-r*2;_.push(["M",I,e]);for(var L=0,F=0;F<g;++F){var z=F%4,V=wb(F*t/4,z,t,o);_.push(["C",V[0][0]+I,-V[0][1]+e,V[1][0]+I,-V[1][1]+e,V[2][0]+I,-V[2][1]+e]),F===g-1&&(L=V[2][0])}return _.push(["L",L+I,p+r]),_.push(["L",I,p+r]),_.push(["Z"]),_}function PL(r,e,t,i,o,c,p,g,_,S){for(var I=o.fill,L=o.opacity,F=p.getBBox(),z=F.maxX-F.minX,V=F.maxY-F.minY,Q=0;Q<i;Q++){var st=i<=1?1:Q/(i-1),at=c.addShape("path",{name:"waterwave-path",attrs:{path:Nm(g,F.minY+V*t,_,0,z/32,r,e),fill:I,opacity:Cg(.2,.9,st)*L}});try{if(S===!1)return;var Ft=Rx([["t",_,0]]);at.stopAnimate(),at.animate({matrix:Ft},{duration:Cg(.5*R1,R1,st),repeat:!0})}catch(Kt){console.warn("off-screen group animate error!")}}}function ZC(r,e,t,i){var o=t*2/3,c=Math.max(o,i),p=o/2,g=r,_=p+e-c/2,S=Math.asin(p/((c-p)*.85)),I=Math.sin(S)*p,L=Math.cos(S)*p,F=g-L,z=_+I,V=r,Q=_+p/Math.sin(S);return`
      M `+F+" "+z+`
      A `+p+" "+p+" 0 1 1 "+(F+L*2)+" "+z+`
      Q `+V+" "+Q+" "+r+" "+(e+c/2)+`
      Q `+V+" "+Q+" "+F+" "+z+`
      Z 
    `}function dc(r,e,t,i){var o=t/2,c=i/2;return`
      M `+r+" "+(e-c)+` 
      a `+o+" "+c+" 0 1 0 0 "+c*2+`
      a `+o+" "+c+" 0 1 0 0 "+-c*2+`
      Z
    `}function OL(r,e,t,i){var o=i/2,c=t/2;return`
      M `+r+" "+(e-o)+`
      L `+(r+c)+" "+e+`
      L `+r+" "+(e+o)+`
      L `+(r-c)+" "+e+`
      Z
    `}function FL(r,e,t,i){var o=i/2,c=t/2;return`
      M `+r+" "+(e-o)+`
      L `+(r+c)+" "+(e+o)+`
      L `+(r-c)+" "+(e+o)+`
      Z
    `}function As(r,e,t,i){var o=.618,c=i/2,p=t/2*o;return`
      M `+(r-p)+" "+(e-c)+`
      L `+(r+p)+" "+(e-c)+`
      L `+(r+p)+" "+(e+c)+`
      L `+(r-p)+" "+(e+c)+`
      Z
    `}var VC={pin:ZC,circle:dc,diamond:OL,triangle:FL,rect:As};_i("interval","liquid-fill-gauge",{draw:function(r,e){var t=.5,i=.5,o=r.customInfo,c=o,p=c.percent,g=c.radius,_=c.shape,S=c.shapeStyle,I=c.background,L=c.animation,F=o.outline,z=o.wave,V=F.border,Q=F.distance,st=z.count,at=z.length,Ft=(0,b.u4)(r.points,function(Sa,eo){return Math.min(Sa,eo.x)},1/0),Kt=this.parsePoint({x:t,y:i}),ee=this.parsePoint({x:Ft,y:i}),Me=Kt.x-ee.x,hr=Math.min(Me,ee.y*g),Tr=SF(r),Dr=Eb((0,b.CD)({},r,F)),cn=hr-V/2,Jr=typeof _=="function"?_:VC[_]||VC.circle,Mn=Jr(Kt.x,Kt.y,cn*2,cn*2);if(S&&e.addShape("path",{name:"shape",attrs:(0,P.pi)({path:Mn},S)}),p>0){var mi=e.addGroup({name:"waves"}),da=mi.setClip({type:"path",attrs:{path:Mn}});PL(Kt.x,Kt.y,1-r.points[1].y,st,Tr,mi,da,hr*2,at,L)}return e.addShape("path",{name:"distance",attrs:{path:Mn,fill:"transparent",lineWidth:V+Q*2,stroke:I==="transparent"?"#fff":I}}),e.addShape("path",{name:"wrap",attrs:(0,b.CD)(Dr,{path:Mn,fill:"transparent",lineWidth:V})}),e}});var D1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="liquid",t}return e.getDefaultOptions=function(){return wF},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.changeData=function(t){this.chart.emit(Tt.BEFORE_CHANGE_DATA,fo.fromData(this.chart,Tt.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(LL(t)),bb({chart:this.chart,options:this.options},!0),this.chart.emit(Tt.AFTER_CHANGE_DATA,fo.fromData(this.chart,Tt.AFTER_CHANGE_DATA,null))},e.prototype.getSchemaAdaptor=function(){return UC},e}(Ka);function zm(r){var e=r.chart,t=r.options,i=t.data,o=t.lineStyle,c=t.color,p=t.point,g=t.area;e.data(i);var _=pn({},r,{options:{line:{style:o,color:c},point:p&&(0,P.pi)({color:c},p),area:g&&(0,P.pi)({color:c},g),label:void 0}}),S=pn({},_,{options:{tooltip:!1}}),I=(p==null?void 0:p.state)||t.state,L=pn({},_,{options:{tooltip:!1,state:I}});return k0(_),Bf(L),Xp(S),r}function RL(r){var e,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return za(So((e={},e[c]=i,e[p]=o,e)))(r)}function DL(r){var e=r.chart,t=r.options,i=t.radius,o=t.startAngle,c=t.endAngle;return e.coordinate("polar",{radius:i,startAngle:o,endAngle:c}),r}function BL(r){var e=r.chart,t=r.options,i=t.xField,o=t.xAxis,c=t.yField,p=t.yAxis;return e.axis(i,o),e.axis(c,p),r}function NL(r){var e=r.chart,t=r.options,i=t.label,o=t.yField,c=Ac(e,"line");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[o],callback:p,cfg:Kl(g)})}return r}function zL(r){return za(zm,RL,Go,DL,BL,jd,Ol,NL,lu,ds,ms())(r)}var GC=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"name",{get:function(){return"radar-tooltip"},enumerable:!1,configurable:!0}),e.prototype.getTooltipItems=function(t){var i=this.getTooltipCfg(),o=i.shared,c=i.title,p=r.prototype.getTooltipItems.call(this,t);if(p.length>0){var g=this.view.geometries[0],_=g.dataArray,S=p[0].name,I=[];return _.forEach(function(L){L.forEach(function(F){var z=os.getTooltipItems(F,g),V=z[0];if(!o&&V&&V.name===S){var Q=(0,b.UM)(c)?S:c;I.push((0,P.pi)((0,P.pi)({},V),{name:V.title,title:Q}))}else if(o&&V){var Q=(0,b.UM)(c)?V.name||S:c;I.push((0,P.pi)((0,P.pi)({},V),{name:V.title,title:Q}))}})}),I}return[]},e}(Qt);Th("radar-tooltip",GC);var HC=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.init=function(){var t=this.context.view;t.removeInteraction("tooltip")},e.prototype.show=function(){var t=this.context.event,i=this.getTooltipController();i.showTooltip({x:t.x,y:t.y})},e.prototype.hide=function(){var t=this.getTooltipController();t.hideTooltip()},e.prototype.getTooltipController=function(){var t=this.context.view;return t.getController("radar-tooltip")},e}(Re);jr("radar-tooltip",HC),Ye("radar-tooltip",{start:[{trigger:"plot:mousemove",action:"radar-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"radar-tooltip:hide"}]});var CF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="radar",t}return e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return pn({},r.prototype.getDefaultOptions.call(this),{xAxis:{label:{offset:15},grid:{line:{type:"line"}}},yAxis:{grid:{line:{type:"circle"}}},legend:{position:"top"},tooltip:{shared:!0,showCrosshairs:!0,showMarkers:!0,crosshairs:{type:"xy",line:{style:{stroke:"#565656",lineDash:[4]}},follow:!0}}})},e.prototype.getSchemaAdaptor=function(){return zL},e}(Ka);function UL(r,e,t){var i=t.map(function(p){return p[e]}).filter(function(p){return p!==void 0}),o=i.length>0?Math.max.apply(Math,i):0,c=Math.abs(r)%360;return c?o*360/c:o}function ZL(r,e,t){var i=[];return r.forEach(function(o){var c=i.find(function(p){return p[e]===o[e]});c?c[t]+=o[t]||null:i.push((0,P.pi)({},o))}),i}function jC(r){var e=r.chart,t=r.options,i=t.barStyle,o=t.color,c=t.tooltip,p=t.colorField,g=t.type,_=t.xField,S=t.yField,I=t.data,L=Pv(I,S);e.data(L);var F=pn({},r,{options:{tooltip:c,seriesField:p,interval:{style:i,color:o,shape:g==="line"?"line":"intervel"},minColumnWidth:t.minBarWidth,maxColumnWidth:t.maxBarWidth,columnBackground:t.barBackground}});return pc(F),g==="line"&&Bf({chart:e,options:{xField:_,yField:S,seriesField:p,point:{shape:"circle",color:o}}}),r}function WC(r){var e,t=r.options,i=t.yField,o=t.xField,c=t.data,p=t.isStack,g=t.isGroup,_=t.colorField,S=t.maxAngle,I=p&&!g&&_?ZL(c,o,i):c,L=Pv(I,i);return za(So((e={},e[i]={min:0,max:UL(S,i,L)},e)))(r)}function XC(r){var e=r.chart,t=r.options,i=t.radius,o=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"polar",cfg:{radius:i,innerRadius:o,startAngle:c,endAngle:p}}).transpose(),r}function VL(r){var e=r.chart,t=r.options,i=t.xField,o=t.xAxis;return e.axis(i,o),r}function GL(r){var e=r.chart,t=r.options,i=t.label,o=t.yField,c=Ac(e,"interval");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[o],callback:p,cfg:(0,P.pi)((0,P.pi)({},Kl(g)),{type:"polar"})})}return r}function HL(r){return za(Vo("barStyle"),jC,WC,VL,XC,lu,ds,Go,Ol,jd,ms(),GL)(r)}var jL=pn({},Ka.getDefaultOptions(),{interactions:[{type:"element-active"}],legend:!1,tooltip:{showMarkers:!1},xAxis:{grid:null,tickLine:null,line:null},maxAngle:240}),AF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="radial-bar",t}return e.getDefaultOptions=function(){return jL},e.prototype.changeData=function(t){this.updateOption({data:t}),WC({chart:this.chart,options:this.options}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return HL},e}(Ka);function WL(r){var e=r.chart,t=r.options,i=t.data,o=t.sectorStyle,c=t.color;return e.data(i),za(pc)(pn({},r,{options:{marginRatio:1,interval:{style:o,color:c}}})),r}function XL(r){var e=r.chart,t=r.options,i=t.label,o=t.xField,c=Ac(e,"interval");if(i===!1)c.label(!1);else if((0,b.Kn)(i)){var p=i.callback,g=i.fields,_=(0,P._T)(i,["callback","fields"]),S=_.offset,I=_.layout;(S===void 0||S>=0)&&(I=I?(0,b.kJ)(I)?I:[I]:[],_.layout=(0,b.hX)(I,function(L){return L.type!=="limit-in-shape"}),_.layout.length||delete _.layout),c.label({fields:g||[o],callback:p,cfg:Kl(_)})}else Hd(hp.WARN,i===null,"the label option must be an Object."),c.label({fields:[o]});return r}function YC(r){var e=r.chart,t=r.options,i=t.legend,o=t.seriesField;return i===!1?e.legend(!1):o&&e.legend(o,i),r}function YL(r){var e=r.chart,t=r.options,i=t.radius,o=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"polar",cfg:{radius:i,innerRadius:o,startAngle:c,endAngle:p}}),r}function $L(r){var e,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return za(So((e={},e[c]=i,e[p]=o,e)))(r)}function qL(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return i?e.axis(c,i):e.axis(c,!1),o?e.axis(p,o):e.axis(p,!1),r}function $C(r){za(Vo("sectorStyle"),WL,$L,XL,YL,qL,YC,Ol,lu,ds,Go,ms(),I0)(r)}var KL=pn({},Ka.getDefaultOptions(),{xAxis:!1,yAxis:!1,legend:{position:"right",radio:{}},sectorStyle:{stroke:"#fff",lineWidth:1},label:{layout:{type:"limit-in-shape"}},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]}),TF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rose",t}return e.getDefaultOptions=function(){return KL},e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return $C},e}(Ka),qC="x",KC="y",QC="name",B1="nodes",Um="edges";function QL(r,e,t){var i=[];return r.forEach(function(o){var c=o[e],p=o[t];i.includes(c)||i.push(c),i.includes(p)||i.push(p)}),i}function JL(r,e,t,i){var o={};return e.forEach(function(c){o[c]={},e.forEach(function(p){o[c][p]=0})}),r.forEach(function(c){o[c[t]][c[i]]=1}),o}function t4(r,e,t){if(!(0,b.kJ)(r))return[];var i=[],o=QL(r,e,t),c=JL(r,o,e,t),p={};o.forEach(function(_){p[_]=0});function g(_){p[_]=1,o.forEach(function(S){if(c[_][S]!=0)if(p[S]==1)i.push(_+"_"+S);else{if(p[S]==-1)return;g(S)}}),p[_]=-1}return o.forEach(function(_){p[_]!=-1&&g(_)}),i.length!==0&&console.warn("sankey data contains circle, "+i.length+" records removed.",i),r.filter(function(_){return i.findIndex(function(S){return S===_[e]+"_"+_[t]})<0})}function e4(r){return r.target.depth}function r4(r){return r.depth}function n4(r,e){return e-1-r.height}function Sb(r,e){return r.sourceLinks.length?r.depth:e-1}function i4(r){return r.targetLinks.length?r.depth:r.sourceLinks.length?(0,b.F)(r.sourceLinks,e4)-1:0}function Zm(r){return function(){return r}}function Cb(r,e){for(var t=0,i=0;i<r.length;i++)t+=e(r[i]);return t}function Ab(r,e){for(var t=-1/0,i=0;i<r.length;i++)t=Math.max(e(r[i]),t);return t}function a4(r,e){for(var t=1/0,i=0;i<r.length;i++)t=Math.min(e(r[i]),t);return t}function Tb(r,e){return N1(r.source,e.source)||r.index-e.index}function JC(r,e){return N1(r.target,e.target)||r.index-e.index}function N1(r,e){return r.y0-e.y0}function Mb(r){return r.value}function o4(r){return r.index}function s4(r){return r.nodes}function u4(r){return r.links}function Ib(r,e){var t=r.get(e);if(!t)throw new Error("missing: "+e);return t}function tA(r){for(var e=r.nodes,t=0,i=e;t<i.length;t++){for(var o=i[t],c=o.y0,p=c,g=0,_=o.sourceLinks;g<_.length;g++){var S=_[g];S.y0=c+S.width/2,c+=S.width}for(var I=0,L=o.targetLinks;I<L.length;I++){var S=L[I];S.y1=p+S.width/2,p+=S.width}}}function l4(){var r=0,e=0,t=1,i=1,o=24,c=8,p,g=o4,_=Sb,S,I,L,F=s4,z=u4,V=6;function Q(Gn){var Vi={nodes:F(Gn),links:z(Gn)};return st(Vi),at(Vi),Ft(Vi),Kt(Vi),hr(Vi),tA(Vi),Vi}Q.update=function(Gn){return tA(Gn),Gn},Q.nodeId=function(Gn){return arguments.length?(g=typeof Gn=="function"?Gn:Zm(Gn),Q):g},Q.nodeAlign=function(Gn){return arguments.length?(_=typeof Gn=="function"?Gn:Zm(Gn),Q):_},Q.nodeDepth=function(Gn){return arguments.length?(S=Gn,Q):S},Q.nodeSort=function(Gn){return arguments.length?(I=Gn,Q):I},Q.nodeWidth=function(Gn){return arguments.length?(o=+Gn,Q):o},Q.nodePadding=function(Gn){return arguments.length?(c=p=+Gn,Q):c},Q.nodes=function(Gn){return arguments.length?(F=typeof Gn=="function"?Gn:Zm(Gn),Q):F},Q.links=function(Gn){return arguments.length?(z=typeof Gn=="function"?Gn:Zm(Gn),Q):z},Q.linkSort=function(Gn){return arguments.length?(L=Gn,Q):L},Q.size=function(Gn){return arguments.length?(r=e=0,t=+Gn[0],i=+Gn[1],Q):[t-r,i-e]},Q.extent=function(Gn){return arguments.length?(r=+Gn[0][0],t=+Gn[1][0],e=+Gn[0][1],i=+Gn[1][1],Q):[[r,e],[t,i]]},Q.iterations=function(Gn){return arguments.length?(V=+Gn,Q):V};function st(Gn){var Vi=Gn.nodes,ua=Gn.links;Vi.forEach(function(Za,ss){Za.index=ss,Za.sourceLinks=[],Za.targetLinks=[]});var Xi=new Map(Vi.map(function(Za){return[g(Za),Za]}));if(ua.forEach(function(Za,ss){Za.index=ss;var ju=Za.source,Wu=Za.target;typeof ju!="object"&&(ju=Za.source=Ib(Xi,ju)),typeof Wu!="object"&&(Wu=Za.target=Ib(Xi,Wu)),ju.sourceLinks.push(Za),Wu.targetLinks.push(Za)}),L!=null)for(var ea=0,ka=Vi;ea<ka.length;ea++){var xo=ka[ea],Mo=xo.sourceLinks,$a=xo.targetLinks;Mo.sort(L),$a.sort(L)}}function at(Gn){for(var Vi=Gn.nodes,ua=0,Xi=Vi;ua<Xi.length;ua++){var ea=Xi[ua];ea.value=ea.fixedValue===void 0?Math.max(Cb(ea.sourceLinks,Mb),Cb(ea.targetLinks,Mb)):ea.fixedValue}}function Ft(Gn){for(var Vi=Gn.nodes,ua=Vi.length,Xi=new Set(Vi),ea=new Set,ka=0;Xi.size;){if(Xi.forEach(function(Za){Za.depth=ka;for(var ss=0,ju=Za.sourceLinks;ss<ju.length;ss++){var Wu=ju[ss].target;ea.add(Wu)}}),++ka>ua)throw new Error("circular link");Xi=ea,ea=new Set}if(S)for(var xo=Math.max(Ab(Vi,function(Za){return Za.depth})+1,0),Mo=void 0,$a=0;$a<Vi.length;$a++)Mo=Vi[$a],Mo.depth=S.call(null,Mo,xo)}function Kt(Gn){for(var Vi=Gn.nodes,ua=Vi.length,Xi=new Set(Vi),ea=new Set,ka=0;Xi.size;){if(Xi.forEach(function(xo){xo.height=ka;for(var Mo=0,$a=xo.targetLinks;Mo<$a.length;Mo++){var Za=$a[Mo].source;ea.add(Za)}}),++ka>ua)throw new Error("circular link");Xi=ea,ea=new Set}}function ee(Gn){for(var Vi=Gn.nodes,ua=Math.max(Ab(Vi,function(Wu){return Wu.depth})+1,0),Xi=(t-r-o)/(ua-1),ea=new Array(ua).fill(0).map(function(){return[]}),ka=0,xo=Vi;ka<xo.length;ka++){var Mo=xo[ka],$a=Math.max(0,Math.min(ua-1,Math.floor(_.call(null,Mo,ua))));Mo.layer=$a,Mo.x0=r+$a*Xi,Mo.x1=Mo.x0+o,ea[$a]?ea[$a].push(Mo):ea[$a]=[Mo]}if(I)for(var Za=0,ss=ea;Za<ss.length;Za++){var ju=ss[Za];ju.sort(I)}return ea}function Me(Gn){for(var Vi=a4(Gn,function(Nh){return(i-e-(Nh.length-1)*p)/Cb(Nh,Mb)}),ua=0,Xi=Gn;ua<Xi.length;ua++){for(var ea=Xi[ua],ka=e,xo=0,Mo=ea;xo<Mo.length;xo++){var $a=Mo[xo];$a.y0=ka,$a.y1=ka+$a.value*Vi,ka=$a.y1+p;for(var Za=0,ss=$a.sourceLinks;Za<ss.length;Za++){var ju=ss[Za];ju.width=ju.value*Vi}}ka=(i-ka+p)/(ea.length+1);for(var Wu=0;Wu<ea.length;++Wu){var $a=ea[Wu];$a.y0+=ka*(Wu+1),$a.y1+=ka*(Wu+1)}da(ea)}}function hr(Gn){var Vi=ee(Gn);p=Math.min(c,(i-e)/(Ab(Vi,function(ka){return ka.length})-1)),Me(Vi);for(var ua=0;ua<V;++ua){var Xi=Math.pow(.99,ua),ea=Math.max(1-Xi,(ua+1)/V);Dr(Vi,Xi,ea),Tr(Vi,Xi,ea)}}function Tr(Gn,Vi,ua){for(var Xi=1,ea=Gn.length;Xi<ea;++Xi){for(var ka=Gn[Xi],xo=0,Mo=ka;xo<Mo.length;xo++){for(var $a=Mo[xo],Za=0,ss=0,ju=0,Wu=$a.targetLinks;ju<Wu.length;ju++){var Nh=Wu[ju],Xv=Nh.source,ed=Nh.value,j0=ed*($a.layer-Xv.layer);Za+=Sa(Xv,$a)*j0,ss+=j0}if(ss>0){var kg=(Za/ss-$a.y0)*Vi;$a.y0+=kg,$a.y1+=kg,mi($a)}}I===void 0&&ka.sort(N1),ka.length&&cn(ka,ua)}}function Dr(Gn,Vi,ua){for(var Xi=Gn.length,ea=Xi-2;ea>=0;--ea){for(var ka=Gn[ea],xo=0,Mo=ka;xo<Mo.length;xo++){for(var $a=Mo[xo],Za=0,ss=0,ju=0,Wu=$a.sourceLinks;ju<Wu.length;ju++){var Nh=Wu[ju],Xv=Nh.target,ed=Nh.value,j0=ed*(Xv.layer-$a.layer);Za+=eo($a,Xv)*j0,ss+=j0}if(ss>0){var kg=(Za/ss-$a.y0)*Vi;$a.y0+=kg,$a.y1+=kg,mi($a)}}I===void 0&&ka.sort(N1),ka.length&&cn(ka,ua)}}function cn(Gn,Vi){var ua=Gn.length>>1,Xi=Gn[ua];Mn(Gn,Xi.y0-p,ua-1,Vi),Jr(Gn,Xi.y1+p,ua+1,Vi),Mn(Gn,i,Gn.length-1,Vi),Jr(Gn,e,0,Vi)}function Jr(Gn,Vi,ua,Xi){for(;ua<Gn.length;++ua){var ea=Gn[ua],ka=(Vi-ea.y0)*Xi;ka>1e-6&&(ea.y0+=ka,ea.y1+=ka),Vi=ea.y1+p}}function Mn(Gn,Vi,ua,Xi){for(;ua>=0;--ua){var ea=Gn[ua],ka=(ea.y1-Vi)*Xi;ka>1e-6&&(ea.y0-=ka,ea.y1-=ka),Vi=ea.y0-p}}function mi(Gn){var Vi=Gn.sourceLinks,ua=Gn.targetLinks;if(L===void 0){for(var Xi=0,ea=ua;Xi<ea.length;Xi++){var ka=ea[Xi].source.sourceLinks;ka.sort(JC)}for(var xo=0,Mo=Vi;xo<Mo.length;xo++){var $a=Mo[xo].target.targetLinks;$a.sort(Tb)}}}function da(Gn){if(L===void 0)for(var Vi=0,ua=Gn;Vi<ua.length;Vi++){var Xi=ua[Vi],ea=Xi.sourceLinks,ka=Xi.targetLinks;ea.sort(JC),ka.sort(Tb)}}function Sa(Gn,Vi){for(var ua=Gn.y0-(Gn.sourceLinks.length-1)*p/2,Xi=0,ea=Gn.sourceLinks;Xi<ea.length;Xi++){var ka=ea[Xi],xo=ka.target,Mo=ka.width;if(xo===Vi)break;ua+=Mo+p}for(var $a=0,Za=Vi.targetLinks;$a<Za.length;$a++){var ss=Za[$a],xo=ss.source,Mo=ss.width;if(xo===Gn)break;ua-=Mo}return ua}function eo(Gn,Vi){for(var ua=Vi.y0-(Vi.targetLinks.length-1)*p/2,Xi=0,ea=Vi.targetLinks;Xi<ea.length;Xi++){var ka=ea[Xi],xo=ka.source,Mo=ka.width;if(xo===Gn)break;ua+=Mo+p}for(var $a=0,Za=Gn.sourceLinks;$a<Za.length;$a++){var ss=Za[$a],xo=ss.target,Mo=ss.width;if(xo===Vi)break;ua-=Mo}return ua}return Q}var c4={left:r4,right:n4,center:i4,justify:Sb},f4={nodeId:function(r){return r.index},nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodeSort:void 0};function h4(r){var e=(0,b.HD)(r)?c4[r]:(0,b.mf)(r)?r:null;return e||Sb}function p4(r){return(0,b.f0)({},f4,r)}function d4(r,e){var t=p4(r),i=t.nodeId,o=t.nodeSort,c=t.nodeAlign,p=t.nodeWidth,g=t.nodePadding,_=t.nodeDepth,S=l4().nodeSort(o).nodeWidth(p).nodePadding(g).nodeDepth(_).nodeAlign(h4(c)).extent([[0,0],[1,1]]).nodeId(i),I=S(e),L=I.nodes.map(function(z){var V=z.x0,Q=z.x1,st=z.y0,at=z.y1;return z.x=[V,Q,Q,V],z.y=[st,st,at,at],z}).filter(function(z){return z.name!==null}),F=I.links.map(function(z){var V=z.source,Q=z.target,st=V.x1,at=Q.x0;z.x=[st,st,at,at];var Ft=z.width/2;return z.y=[z.y0+Ft,z.y0-Ft,z.y1+Ft,z.y1-Ft],z}).filter(function(z){var V=z.source,Q=z.target;return V.name!==null&&Q.name!==null});return{nodes:L,links:F}}function v4(r){return r==="node-link"}function eA(r,e,t){return Ql(r)?r/t:e}function rA(r,e,t){return Ql(r)?r/t:e}function kb(r,e,t){var i=r.dataType,o=r.data,c=r.sourceField,p=r.targetField,g=r.weightField,_=r.nodeAlign,S=r.nodeSort,I=r.nodePadding,L=r.nodePaddingRatio,F=r.nodeWidth,z=r.nodeWidthRatio,V=r.nodeDepth,Q=r.rawFields,st=Q===void 0?[]:Q,at;v4(i)?at=o:at=_x(t4(o,c,p),c,p,g,st);var Ft=d4({nodeAlign:_,nodePadding:rA(I,L,t),nodeWidth:eA(F,z,e),nodeSort:S,nodeDepth:V},at),Kt=Ft.nodes,ee=Ft.links;return{nodes:Kt.map(function(Me){return(0,P.pi)((0,P.pi)({},ps(Me,(0,P.pr)(["x","y","name"],st))),{isNode:!0})}),edges:ee.map(function(Me){return(0,P.pi)((0,P.pi)({source:Me.source.name,target:Me.target.name,name:Me.source.name||Me.target.name},ps(Me,(0,P.pr)(["x","y","value"],st))),{isNode:!1})})}}function Ag(r){var e=r.options,t=e.rawFields,i=t===void 0?[]:t;return pn({},{options:{tooltip:{fields:(0,b.jj)((0,P.pr)(["name","source","target","value","isNode"],i))},label:{fields:(0,b.jj)((0,P.pr)(["x","name"],i))}}},r)}function nA(r){var e=r.chart,t=r.options,i=t.color,o=t.nodeStyle,c=t.edgeStyle,p=t.label,g=t.tooltip,_=t.nodeState,S=t.edgeState;e.legend(!1),e.tooltip(g),e.axis(!1),e.coordinate().reflect("y");var I=kb(t,e.width,e.height),L=I.nodes,F=I.edges,z=e.createView({id:Um});z.data(F),Rv({chart:z,options:{xField:qC,yField:KC,seriesField:QC,edge:{color:i,style:c,shape:"arc"},tooltip:g,state:S}});var V=e.createView({id:B1});return V.data(L),mm({chart:V,options:{xField:qC,yField:KC,seriesField:QC,polygon:{color:i,style:o},label:p,tooltip:g,state:_}}),e.interaction("element-active"),e.scale({x:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},y:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},name:{sync:"color",type:"cat"}}),r}function g4(r){var e=r.chart,t=r.options,i=t.animation,o=(0,P.pr)(e.views[0].geometries,e.views[1].geometries);return fm(e,i,o),r}function m4(r){var e=r.chart,t=r.options,i=t.nodeDraggable,o="sankey-node-draggable";return i?e.interaction(o):e.removeInteraction(o),r}function y4(r){var e=r.chart,t=r.options,i=t.interactions,o=i===void 0?[]:i,c=[].concat(o,t.nodeInteractions||[]),p=[].concat(o,t.edgeInteractions||[]),g=yo(e,B1),_=yo(e,Um);return c.forEach(function(S){(S==null?void 0:S.enable)===!1?g.removeInteraction(S.type):g.interaction(S.type,S.cfg||{})}),p.forEach(function(S){(S==null?void 0:S.enable)===!1?_.removeInteraction(S.type):_.interaction(S.type,S.cfg||{})}),r}function _4(r){return za(Ag,nA,y4,m4,g4,Go)(r)}var Vm=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isDragging=!1,t}return e.prototype.isNodeElement=function(){var t=(0,b.U2)(this.context,"event.target");if(t){var i=t.get("element");return i&&i.getModel().data.isNode}return!1},e.prototype.getNodeView=function(){return yo(this.context.view,B1)},e.prototype.getEdgeView=function(){return yo(this.context.view,Um)},e.prototype.getCurrentDatumIdx=function(t){return this.getNodeView().geometries[0].elements.indexOf(t)},e.prototype.start=function(){if(this.isNodeElement()){this.prevPoint={x:(0,b.U2)(this.context,"event.x"),y:(0,b.U2)(this.context,"event.y")};var t=this.context.event.target.get("element"),i=this.getCurrentDatumIdx(t);if(i===-1)return;this.currentElementIdx=i,this.context.isDragging=!0,this.isDragging=!0,this.prevNodeAnimateCfg=this.getNodeView().getOptions().animate,this.prevEdgeAnimateCfg=this.getEdgeView().getOptions().animate,this.getNodeView().animate(!1),this.getEdgeView().animate(!1)}},e.prototype.translate=function(){if(this.isDragging){var t=this.context.view,i={x:(0,b.U2)(this.context,"event.x"),y:(0,b.U2)(this.context,"event.y")},o=i.x-this.prevPoint.x,c=i.y-this.prevPoint.y,p=this.getNodeView(),g=p.geometries[0].elements[this.currentElementIdx];if(g&&g.getModel()){var _=g.getModel().data,S=p.getOptions().data,I=p.getCoordinate(),L={x:o/I.getWidth(),y:c/I.getHeight()},F=(0,P.pi)((0,P.pi)({},_),{x:_.x.map(function(at){return at+=L.x}),y:_.y.map(function(at){return at+=L.y})}),z=(0,P.pr)(S);z[this.currentElementIdx]=F,p.data(z);var V=_.name,Q=this.getEdgeView(),st=Q.getOptions().data;st.forEach(function(at){at.source===V&&(at.x[0]+=L.x,at.x[1]+=L.x,at.y[0]+=L.y,at.y[1]+=L.y),at.target===V&&(at.x[2]+=L.x,at.x[3]+=L.x,at.y[2]+=L.y,at.y[3]+=L.y)}),Q.data(st),this.prevPoint=i,t.render(!0)}}},e.prototype.end=function(){this.isDragging=!1,this.context.isDragging=!1,this.prevPoint=null,this.currentElementIdx=null,this.getNodeView().animate(this.prevNodeAnimateCfg),this.getEdgeView().animate(this.prevEdgeAnimateCfg)},e}(Re);jr("sankey-node-drag",Vm),Ye("sankey-node-draggable",{showEnable:[{trigger:"polygon:mouseenter",action:"cursor:pointer"},{trigger:"polygon:mouseleave",action:"cursor:default"}],start:[{trigger:"polygon:mousedown",action:"sankey-node-drag:start"}],processing:[{trigger:"plot:mousemove",action:"sankey-node-drag:translate"},{isEnable:function(r){return r.isDragging},trigger:"plot:mousemove",action:"cursor:move"}],end:[{trigger:"plot:mouseup",action:"sankey-node-drag:end"}]});var z1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="sankey",t}return e.getDefaultOptions=function(){return{appendPadding:8,syncViewPadding:!0,nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.3,lineWidth:0},edgeState:{active:{style:{opacity:.8,lineWidth:0}}},label:{formatter:function(t){var i=t.name;return i},callback:function(t){var i=t[1]===1;return{style:{fill:"#545454",textAlign:i?"end":"start"},offsetX:i?-8:8}},layout:[{type:"hide-overlap"}]},tooltip:{showTitle:!1,showMarkers:!1,shared:!1,showContent:function(t){return!(0,b.U2)(t,[0,"data","isNode"])},formatter:function(t){var i=t.source,o=t.target,c=t.value;return{name:i+" -> "+o,value:c}}},nodeWidthRatio:.008,nodePaddingRatio:.01,animation:{appear:{animation:"wave-in"},enter:{animation:"wave-in"}}}},e.prototype.changeData=function(t){this.updateOption({data:t});var i=kb(this.options,this.chart.width,this.chart.height),o=i.nodes,c=i.edges,p=yo(this.chart,B1),g=yo(this.chart,Um);p.changeData(o),g.changeData(c)},e.prototype.getSchemaAdaptor=function(){return _4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ka),Z0="ancestor-node",Tg="value",Gm="path",iA=[Gm,ob,sb,TC,"name","depth","height"],Lb=pn({},Ka.getDefaultOptions(),{innerRadius:0,radius:.85,hierarchyConfig:{field:"value"},tooltip:{shared:!0,showMarkers:!1,offset:20,showTitle:!1},legend:!1,sunburstStyle:{lineWidth:.5,stroke:"#FFF"},drilldown:{enabled:!0}});function aA(r){r.x0=Math.round(r.x0),r.y0=Math.round(r.y0),r.x1=Math.round(r.x1),r.y1=Math.round(r.y1)}function Hm(r,e,t,i,o){for(var c=r.children,p,g=-1,_=c.length,S=r.value&&(i-e)/r.value;++g<_;)p=c[g],p.y0=t,p.y1=o,p.x0=e,p.x1=e+=p.value*S}function Pb(){var r=1,e=1,t=0,i=!1;function o(p){var g=p.height+1;return p.x0=p.y0=t,p.x1=r,p.y1=e/g,p.eachBefore(c(e,g)),i&&p.eachBefore(aA),p}function c(p,g){return function(_){_.children&&Hm(_,_.x0,p*(_.depth+1)/g,_.x1,p*(_.depth+2)/g);var S=_.x0,I=_.y0,L=_.x1-t,F=_.y1-t;L<S&&(S=L=(S+L)/2),F<I&&(I=F=(I+F)/2),_.x0=S,_.y0=I,_.x1=L,_.y1=F}}return o.round=function(p){return arguments.length?(i=!!p,o):i},o.size=function(p){return arguments.length?(r=+p[0],e=+p[1],o):[r,e]},o.padding=function(p){return arguments.length?(t=+p,o):t},o}var x4={field:"value",size:[1,1],round:!1,padding:0,sort:function(r,e){return e.value-r.value},as:["x","y"],ignoreParentValue:!0};function MF(r,e){e=(0,b.f0)({},x4,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var i;try{i=ub(e)}catch(_){console.warn(_)}var o=function(_){return Pb().size(e.size).round(e.round).padding(e.padding)(Eg(_).sum(function(S){return(0,b.dp)(S.children)?e.ignoreParentValue?0:S[i]-(0,b.u4)(S.children,function(I,L){return I+L[i]},0):S[i]}).sort(e.sort))},c=o(r),p=t[0],g=t[1];return c.each(function(_){var S,I;_[p]=[_.x0,_.x1,_.x1,_.x0],_[g]=[_.y1,_.y1,_.y0,_.y0],_.name=_.name||((S=_.data)===null||S===void 0?void 0:S.name)||((I=_.data)===null||I===void 0?void 0:I.label),_.data.name=_.name,["x0","x1","y0","y1"].forEach(function(L){t.indexOf(L)===-1&&delete _[L]})}),lb(c)}function U1(r,e){return r.parent===e.parent?1:2}function jm(r){return r.reduce(oA,0)/r.length}function oA(r,e){return r+e.x}function b4(r){return 1+r.reduce(E4,0)}function E4(r,e){return Math.max(r,e.y)}function sA(r){for(var e;e=r.children;)r=e[0];return r}function IF(r){for(var e;e=r.children;)r=e[e.length-1];return r}function w4(){var r=U1,e=1,t=1,i=!1;function o(c){var p,g=0;c.eachAfter(function(F){var z=F.children;z?(F.x=jm(z),F.y=b4(z)):(F.x=p?g+=r(F,p):0,F.y=0,p=F)});var _=sA(c),S=IF(c),I=_.x-r(_,S)/2,L=S.x+r(S,_)/2;return c.eachAfter(i?function(F){F.x=(F.x-c.x)*e,F.y=(c.y-F.y)*t}:function(F){F.x=(F.x-I)/(L-I)*e,F.y=(1-(c.y?F.y/c.y:1))*t})}return o.separation=function(c){return arguments.length?(r=c,o):r},o.size=function(c){return arguments.length?(i=!1,e=+c[0],t=+c[1],o):i?null:[e,t]},o.nodeSize=function(c){return arguments.length?(i=!0,e=+c[0],t=+c[1],o):i?[e,t]:null},o}var Z1={depth:-1},Ob={};function S4(r){return r.id}function C4(r){return r.parentId}function uA(){var r=S4,e=C4;function t(i){var o=Array.from(i),c=o.length,p,g,_,S,I,L,F,z=new Map;for(g=0;g<c;++g)p=o[g],I=o[g]=new B0(p),(L=r(p,g,i))!=null&&(L+="")&&(F=I.id=L,z.set(F,z.has(F)?Ob:I)),(L=e(p,g,i))!=null&&(L+="")&&(I.parent=L);for(g=0;g<c;++g)if(I=o[g],L=I.parent){if(S=z.get(L),!S)throw new Error("missing: "+L);if(S===Ob)throw new Error("ambiguous: "+L);S.children?S.children.push(I):S.children=[I],I.parent=S}else{if(_)throw new Error("multiple roots");_=I}if(!_)throw new Error("no root");if(_.parent=Z1,_.eachBefore(function(V){V.depth=V.parent.depth+1,--c}).eachBefore(ab),_.parent=null,c>0)throw new Error("cycle");return _}return t.id=function(i){return arguments.length?(r=L1(i),t):r},t.parentId=function(i){return arguments.length?(e=L1(i),t):e},t}function kF(r,e){return r.parent===e.parent?1:2}function V1(r){var e=r.children;return e?e[0]:r.t}function pf(r){var e=r.children;return e?e[e.length-1]:r.t}function lA(r,e,t){var i=t/(e.i-r.i);e.c-=i,e.s+=t,r.c+=i,e.z+=t,e.m+=t}function cA(r){for(var e=0,t=0,i=r.children,o=i.length,c;--o>=0;)c=i[o],c.z+=e,c.m+=e,e+=c.s+(t+=c.c)}function A4(r,e,t){return r.a.parent===e.parent?r.a:t}function G1(r,e){this._=r,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}G1.prototype=Object.create(B0.prototype);function T4(r){for(var e=new G1(r,0),t,i=[e],o,c,p,g;t=i.pop();)if(c=t._.children)for(t.children=new Array(g=c.length),p=g-1;p>=0;--p)i.push(o=t.children[p]=new G1(c[p],p)),o.parent=t;return(e.parent=new G1(null,0)).children=[e],e}function fA(){var r=kF,e=1,t=1,i=null;function o(S){var I=T4(S);if(I.eachAfter(c),I.parent.m=-I.z,I.eachBefore(p),i)S.eachBefore(_);else{var L=S,F=S,z=S;S.eachBefore(function(Ft){Ft.x<L.x&&(L=Ft),Ft.x>F.x&&(F=Ft),Ft.depth>z.depth&&(z=Ft)});var V=L===F?1:r(L,F)/2,Q=V-L.x,st=e/(F.x+V+Q),at=t/(z.depth||1);S.eachBefore(function(Ft){Ft.x=(Ft.x+Q)*st,Ft.y=Ft.depth*at})}return S}function c(S){var I=S.children,L=S.parent.children,F=S.i?L[S.i-1]:null;if(I){cA(S);var z=(I[0].z+I[I.length-1].z)/2;F?(S.z=F.z+r(S._,F._),S.m=S.z-z):S.z=z}else F&&(S.z=F.z+r(S._,F._));S.parent.A=g(S,F,S.parent.A||L[0])}function p(S){S._.x=S.z+S.parent.m,S.m+=S.parent.m}function g(S,I,L){if(I){for(var F=S,z=S,V=I,Q=F.parent.children[0],st=F.m,at=z.m,Ft=V.m,Kt=Q.m,ee;V=pf(V),F=V1(F),V&&F;)Q=V1(Q),z=pf(z),z.a=S,ee=V.z+Ft-F.z-st+r(V._,F._),ee>0&&(lA(A4(V,S,L),S,ee),st+=ee,at+=ee),Ft+=V.m,st+=F.m,Kt+=Q.m,at+=z.m;V&&!pf(z)&&(z.t=V,z.m+=Ft-at),F&&!V1(Q)&&(Q.t=F,Q.m+=st-Kt,L=S)}return L}function _(S){S.x*=e,S.y=S.depth*t}return o.separation=function(S){return arguments.length?(r=S,o):r},o.size=function(S){return arguments.length?(i=!1,e=+S[0],t=+S[1],o):i?null:[e,t]},o.nodeSize=function(S){return arguments.length?(i=!0,e=+S[0],t=+S[1],o):i?[e,t]:null},o}function Wm(r,e,t,i,o){for(var c=r.children,p,g=-1,_=c.length,S=r.value&&(o-t)/r.value;++g<_;)p=c[g],p.x0=e,p.x1=i,p.y0=t,p.y1=t+=p.value*S}var hA=(1+Math.sqrt(5))/2;function pA(r,e,t,i,o,c){for(var p=[],g=e.children,_,S,I=0,L=0,F=g.length,z,V,Q=e.value,st,at,Ft,Kt,ee,Me,hr;I<F;){z=o-t,V=c-i;do st=g[L++].value;while(!st&&L<F);for(at=Ft=st,Me=Math.max(V/z,z/V)/(Q*r),hr=st*st*Me,ee=Math.max(Ft/hr,hr/at);L<F;++L){if(st+=S=g[L].value,S<at&&(at=S),S>Ft&&(Ft=S),hr=st*st*Me,Kt=Math.max(Ft/hr,hr/at),Kt>ee){st-=S;break}ee=Kt}p.push(_={value:st,dice:z<V,children:g.slice(I,L)}),_.dice?Hm(_,t,i,o,Q?i+=V*st/Q:c):Wm(_,t,i,Q?t+=z*st/Q:o,c),Q-=st,I=L}return p}var dA=function r(e){function t(i,o,c,p,g){pA(e,i,o,c,p,g)}return t.ratio=function(i){return r((i=+i)>1?i:1)},t}(hA);function vA(){var r=dA,e=!1,t=1,i=1,o=[0],c=$p,p=$p,g=$p,_=$p,S=$p;function I(F){return F.x0=F.y0=0,F.x1=t,F.y1=i,F.eachBefore(L),o=[0],e&&F.eachBefore(aA),F}function L(F){var z=o[F.depth],V=F.x0+z,Q=F.y0+z,st=F.x1-z,at=F.y1-z;st<V&&(V=st=(V+st)/2),at<Q&&(Q=at=(Q+at)/2),F.x0=V,F.y0=Q,F.x1=st,F.y1=at,F.children&&(z=o[F.depth+1]=c(F)/2,V+=S(F)-z,Q+=p(F)-z,st-=g(F)-z,at-=_(F)-z,st<V&&(V=st=(V+st)/2),at<Q&&(Q=at=(Q+at)/2),r(F,V,Q,st,at))}return I.round=function(F){return arguments.length?(e=!!F,I):e},I.size=function(F){return arguments.length?(t=+F[0],i=+F[1],I):[t,i]},I.tile=function(F){return arguments.length?(r=L1(F),I):r},I.padding=function(F){return arguments.length?I.paddingInner(F).paddingOuter(F):I.paddingInner()},I.paddingInner=function(F){return arguments.length?(c=typeof F=="function"?F:mp(+F),I):c},I.paddingOuter=function(F){return arguments.length?I.paddingTop(F).paddingRight(F).paddingBottom(F).paddingLeft(F):I.paddingTop()},I.paddingTop=function(F){return arguments.length?(p=typeof F=="function"?F:mp(+F),I):p},I.paddingRight=function(F){return arguments.length?(g=typeof F=="function"?F:mp(+F),I):g},I.paddingBottom=function(F){return arguments.length?(_=typeof F=="function"?F:mp(+F),I):_},I.paddingLeft=function(F){return arguments.length?(S=typeof F=="function"?F:mp(+F),I):S},I}function M4(r,e,t,i,o){var c=r.children,p,g=c.length,_,S=new Array(g+1);for(S[0]=_=p=0;p<g;++p)S[p+1]=_+=c[p].value;I(0,g,r.value,e,t,i,o);function I(L,F,z,V,Q,st,at){if(L>=F-1){var Ft=c[L];Ft.x0=V,Ft.y0=Q,Ft.x1=st,Ft.y1=at;return}for(var Kt=S[L],ee=z/2+Kt,Me=L+1,hr=F-1;Me<hr;){var Tr=Me+hr>>>1;S[Tr]<ee?Me=Tr+1:hr=Tr}ee-S[Me-1]<S[Me]-ee&&L+1<Me&&--Me;var Dr=S[Me]-Kt,cn=z-Dr;if(st-V>at-Q){var Jr=z?(V*cn+st*Dr)/z:st;I(L,Me,Dr,V,Q,Jr,at),I(Me,F,cn,Jr,Q,st,at)}else{var Mn=z?(Q*cn+at*Dr)/z:at;I(L,Me,Dr,V,Q,st,Mn),I(Me,F,cn,V,Mn,st,at)}}}function I4(r,e,t,i,o){(r.depth&1?Wm:Hm)(r,e,t,i,o)}var Xm=function r(e){function t(i,o,c,p,g){if((_=i._squarify)&&_.ratio===e)for(var _,S,I,L,F=-1,z,V=_.length,Q=i.value;++F<V;){for(S=_[F],I=S.children,L=S.value=0,z=I.length;L<z;++L)S.value+=I[L].value;S.dice?Hm(S,o,c,p,Q?c+=(g-c)*S.value/Q:g):Wm(S,o,c,Q?o+=(p-o)*S.value/Q:p,g),Q-=S.value}else i._squarify=_=pA(e,i,o,c,p,g),_.ratio=e}return t.ratio=function(i){return r((i=+i)>1?i:1)},t}(hA),Ym={field:"value",tile:"treemapSquarify",size:[1,1],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,as:["x","y"],sort:function(r,e){return e.value-r.value},ratio:.5*(1+Math.sqrt(5))};function k4(r,e){return r==="treemapSquarify"?zt[r].ratio(e):zt[r]}function gA(r,e){e=(0,b.f0)({},Ym,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var i;try{i=ub(e)}catch(S){console.warn(S)}var o=k4(e.tile,e.ratio),c=function(S){return vA().tile(o).size(e.size).round(e.round).padding(e.padding).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(Eg(S).sum(function(I){return e.ignoreParentValue&&I.children?0:I[i]}).sort(e.sort))},p=c(r),g=t[0],_=t[1];return p.each(function(S){S[g]=[S.x0,S.x1,S.x1,S.x0],S[_]=[S.y1,S.y1,S.y0,S.y0],["x0","x1","y0","y1"].forEach(function(I){t.indexOf(I)===-1&&delete S[I]})}),lb(p)}function mA(r){var e=r.data,t=r.colorField,i=r.rawFields,o=r.hierarchyConfig,c=o===void 0?{}:o,p=c.activeDepth,g={partition:MF,treemap:gA},_=r.seriesField,S=r.type||"partition",I=g[S](e,(0,P.pi)((0,P.pi)({field:_||"value"},(0,b.CE)(c,["activeDepth"])),{type:"hierarchy."+S,as:["x","y"]})),L=[];return I.forEach(function(F){var z,V,Q,st,at,Ft;if(F.depth===0||p>0&&F.depth>p)return null;for(var Kt=F.data.name,ee=(0,P.pi)({},F);ee.depth>1;)Kt=((V=ee.parent.data)===null||V===void 0?void 0:V.name)+" / "+Kt,ee=ee.parent;var Me=(0,P.pi)((0,P.pi)((0,P.pi)({},ps(F.data,(0,P.pr)(i||[],[c.field]))),(z={},z[Gm]=Kt,z[Z0]=ee.data.name,z)),F);_&&(Me[_]=F.data[_]||((st=(Q=F.parent)===null||Q===void 0?void 0:Q.data)===null||st===void 0?void 0:st[_])),t&&(Me[t]=F.data[t]||((Ft=(at=F.parent)===null||at===void 0?void 0:at.data)===null||Ft===void 0?void 0:Ft[t])),Me.ext=c,Me[Fm]={hierarchyConfig:c,colorField:t,rawFields:i},L.push(Me)}),L}function V0(r){var e=r.chart,t=r.options,i=t.color,o=t.colorField,c=o===void 0?Z0:o,p=t.sunburstStyle,g=t.rawFields,_=g===void 0?[]:g,S=mA(t);e.data(S);var I;return p&&(I=function(L){return pn({},{fillOpacity:Math.pow(.85,L.depth)},(0,b.mf)(p)?p(L):p)}),mm(pn({},r,{options:{xField:"x",yField:"y",seriesField:c,rawFields:(0,b.jj)((0,P.pr)(iA,_)),polygon:{color:i,style:I}}})),r}function L4(r){var e=r.chart;return e.axis(!1),r}function P4(r){var e=r.chart,t=r.options,i=t.label,o=Ac(e,"polygon");if(!i)o.label(!1);else{var c=i.fields,p=c===void 0?["name"]:c,g=i.callback,_=(0,P._T)(i,["fields","callback"]);o.label({fields:p,callback:g,cfg:Kl(_)})}return r}function H1(r){var e=r.chart,t=r.options,i=t.innerRadius,o=t.radius,c=t.reflect,p=e.coordinate({type:"polar",cfg:{innerRadius:i,radius:o}});return c&&p.reflect(c),r}function O4(r){var e,t=r.options,i=t.hierarchyConfig,o=t.meta;return za(So({},(e={},e[Tg]=(0,b.U2)(o,(0,b.U2)(i,["field"],"value")),e)))(r)}function F4(r){var e=r.chart,t=r.options,i=t.tooltip;if(i===!1)e.tooltip(!1);else{var o=i;(0,b.U2)(i,"fields")||(o=pn({},{customItems:function(c){return c.map(function(p){var g=(0,b.U2)(e.getOptions(),"scales"),_=(0,b.U2)(g,[Gm,"formatter"],function(I){return I}),S=(0,b.U2)(g,[Tg,"formatter"],function(I){return I});return(0,P.pi)((0,P.pi)({},p),{name:_(p.data[Gm]),value:S(p.data.value)})})}},o)),e.tooltip(o)}return r}function R4(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t;return e!=null&&e.enabled?pn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:mA}}])}):r}function D4(r){var e=r.chart,t=r.options,i=t.drilldown;return lu({chart:e,options:R4(t)}),i!=null&&i.enabled&&(e.appendPadding=lm(e.appendPadding,(0,b.U2)(i,["breadCrumb","position"]))),r}function B4(r){return za(Go,Vo("sunburstStyle"),V0,L4,O4,jd,H1,F4,P4,D4,ds,ms())(r)}var LF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="sunburst",t}return e.getDefaultOptions=function(){return Lb},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return B4},e.SUNBURST_ANCESTOR_FIELD=Z0,e.SUNBURST_PATH_FIELD=Gm,e.NODE_ANCESTORS_FIELD=sb,e}(Ka);function yA(r,e){if((0,b.kJ)(r))return r.find(function(t){return t.type===e})}function _A(r,e){var t=yA(r,e);return t&&t.enable!==!1}function Fb(r){var e=r.interactions,t=r.drilldown;return(0,b.U2)(t,"enabled")||_A(e,"treemap-drill-down")}function N4(r){var e=r.interactions["drill-down"];if(e){var t=e.context.actions.find(function(i){return i.name==="drill-down-action"});t.reset()}}function Rb(r){var e=r.data,t=r.colorField,i=r.enableDrillDown,o=r.hierarchyConfig,c=gA(e,(0,P.pi)((0,P.pi)({},o),{type:"hierarchy.treemap",field:"value",as:["x","y"]})),p=[];return c.forEach(function(g){if(g.depth===0||i&&g.depth!==1||!i&&g.children)return null;var _=g.ancestors().map(function(F){return{data:F.data,height:F.height,value:F.value}}),S=i&&(0,b.kJ)(e.path)?_.concat(e.path.slice(1)):_,I=Object.assign({},g.data,(0,P.pi)({x:g.x,y:g.y,depth:g.depth,value:g.value,path:S},g));if(!g.data[t]&&g.parent){var L=g.ancestors().find(function(F){return F.data[t]});I[t]=L==null?void 0:L.data[t]}else I[t]=g.data[t];I[Fm]={hierarchyConfig:o,colorField:t,enableDrillDown:i},p.push(I)}),p}function z4(r){var e=r.options,t=e.colorField;return pn({options:{rawFields:["value"],tooltip:{fields:["name","value",t,"path"],formatter:function(i){return{name:i.name,value:i.value}}}}},r)}function U4(r){var e=r.chart,t=r.options,i=t.color,o=t.colorField,c=t.rectStyle,p=t.hierarchyConfig,g=t.rawFields,_=Rb({data:t.data,colorField:t.colorField,enableDrillDown:Fb(t),hierarchyConfig:p});return e.data(_),mm(pn({},r,{options:{xField:"x",yField:"y",seriesField:o,rawFields:g,polygon:{color:i,style:c}}})),e.coordinate().reflect("y"),r}function Z4(r){var e=r.chart;return e.axis(!1),r}function V4(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t,o=Fb(r);return o?pn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:Rb}}])}):r}function G4(r){var e=r.chart,t=r.options,i=t.interactions,o=t.drilldown;lu({chart:e,options:V4(t)});var c=yA(i,"view-zoom");c&&(c.enable!==!1?e.getCanvas().on("mousewheel",function(g){g.preventDefault()}):e.getCanvas().off("mousewheel"));var p=Fb(t);return p&&(e.appendPadding=lm(e.appendPadding,(0,b.U2)(o,["breadCrumb","position"]))),r}function H4(r){return za(z4,Go,Vo("rectStyle"),U4,Z4,jd,Ol,G4,ds,ms())(r)}var j4={colorField:"name",rectStyle:{lineWidth:1,stroke:"#fff"},hierarchyConfig:{tile:"treemapSquarify"},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1,breadCrumb:{position:"bottom-left",rootText:"\u521D\u59CB",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}}}},PF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="treemap",t}return e.getDefaultOptions=function(){return j4},e.prototype.changeData=function(t){var i=this.options,o=i.colorField,c=i.interactions,p=i.hierarchyConfig;this.updateOption({data:t});var g=Rb({data:t,colorField:o,enableDrillDown:_A(c,"treemap-drill-down"),hierarchyConfig:p});this.chart.changeData(g),N4(this.chart)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return H4},e}(Ka),qd="id",j1="path",W4={appendPadding:[10,0,20,0],blendMode:"multiply",tooltip:{showTitle:!1,showMarkers:!1,fields:["id","size"],formatter:function(r){return{name:r.id,value:r.size}}},legend:{position:"top-left"},label:{style:{textAlign:"center",fill:"#fff"}},interactions:[{type:"legend-filter",enable:!1}],state:{active:{style:{stroke:"#000"}},selected:{style:{stroke:"#000",lineWidth:2}},inactive:{style:{fillOpacity:.3,strokeOpacity:.3}}},defaultInteractions:["tooltip","venn-legend-active"]};function W1(r){if(r){var e=r.geometries[0].elements;e.forEach(function(t){t.shape.toFront()})}}var X4=En("element-active"),Y4=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){W1(this.context.view)},e.prototype.active=function(){r.prototype.active.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(X4),$4=En("element-highlight"),q4=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){W1(this.context.view)},e.prototype.highlight=function(){r.prototype.highlight.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.clear=function(){r.prototype.clear.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}($4),K4=En("element-selected"),Q4=En("element-single-selected"),J4=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){W1(this.context.view)},e.prototype.selected=function(){r.prototype.selected.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(K4),tP=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){W1(this.context.view)},e.prototype.selected=function(){r.prototype.selected.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(Q4);jr("venn-element-active",Y4),jr("venn-element-highlight",q4),jr("venn-element-selected",J4),jr("venn-element-single-selected",tP),Ye("venn-element-active",{start:[{trigger:"element:mouseenter",action:"venn-element-active:active"}],end:[{trigger:"element:mouseleave",action:"venn-element-active:reset"}]}),Ye("venn-element-highlight",{start:[{trigger:"element:mouseenter",action:"venn-element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"venn-element-highlight:reset"}]}),Ye("venn-element-selected",{start:[{trigger:"element:click",action:"venn-element-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-selected:reset"]}]}),Ye("venn-element-single-selected",{start:[{trigger:"element:click",action:"venn-element-single-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-single-selected:reset"]}]}),Ye("venn-legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","venn-element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","venn-element-active:reset"]}]}),Ye("venn-legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","venn-element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","venn-element-highlight:reset"]}]});var eP=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelPoint=function(t,i,o){var c=t.data,p=c.x,g=c.y,_=t.customLabelInfo,S=_.offsetX,I=_.offsetY;return{content:t.content[o],x:p+S,y:g+I}},e}(To);Rn("venn",eP);var rP=nt(39588),$m=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,nP=new RegExp("([a-z])["+$m+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+$m+"]*,?["+$m+"]*)+)","ig"),iP=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+$m+"]*,?["+$m+"]*","ig");function aP(r){if(!r)return null;if((0,rP.Z)(r))return r;var e={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},t=[];return String(r).replace(nP,function(i,o,c){var p=[],g=o.toLowerCase();if(c.replace(iP,function(_,S){S&&p.push(+S)}),g==="m"&&p.length>2&&(t.push([o].concat(p.splice(0,2))),g="l",o=o==="m"?"l":"L"),g==="o"&&p.length===1&&t.push([o,p[0]]),g==="r")t.push([o].concat(p));else for(;p.length>=e[g]&&(t.push([o].concat(p.splice(0,e[g]))),!!e[g]););return""}),t}var Db=/[a-z]/;function xA(r,e){return[e[0]+(e[0]-r[0]),e[1]+(e[1]-r[1])]}function OF(r){var e=parsePathString(r);if(!e||!e.length)return[["M",0,0]];for(var t=!1,i=0;i<e.length;i++){var o=e[i][0];if(Db.test(o)||["V","H","T","S"].indexOf(o)>=0){t=!0;break}}if(!t)return e;var c=[],p=0,g=0,_=0,S=0,I=0,L,F,z=e[0];(z[0]==="M"||z[0]==="m")&&(p=+z[1],g=+z[2],_=p,S=g,I++,c[0]=["M",p,g]);for(var i=I,V=e.length;i<V;i++){var Q=e[i],st=c[i-1],at=[],o=Q[0],Ft=o.toUpperCase();if(o!==Ft)switch(at[0]=Ft,Ft){case"A":at[1]=Q[1],at[2]=Q[2],at[3]=Q[3],at[4]=Q[4],at[5]=Q[5],at[6]=+Q[6]+p,at[7]=+Q[7]+g;break;case"V":at[1]=+Q[1]+g;break;case"H":at[1]=+Q[1]+p;break;case"M":_=+Q[1]+p,S=+Q[2]+g,at[1]=_,at[2]=S;break;default:for(var Kt=1,ee=Q.length;Kt<ee;Kt++)at[Kt]=+Q[Kt]+(Kt%2?p:g)}else at=e[i];switch(Ft){case"Z":p=+_,g=+S;break;case"H":p=at[1],at=["L",p,g];break;case"V":g=at[1],at=["L",p,g];break;case"T":p=at[1],g=at[2];var Me=xA([st[1],st[2]],[st[3],st[4]]);at=["Q",Me[0],Me[1],p,g];break;case"S":p=at[at.length-2],g=at[at.length-1];var hr=st.length,Tr=xA([st[hr-4],st[hr-3]],[st[hr-2],st[hr-1]]);at=["C",Tr[0],Tr[1],at[1],at[2],p,g];break;case"M":_=at[at.length-2],S=at[at.length-1];break;default:p=at[at.length-2],g=at[at.length-1]}c.push(at)}return c}var qm=Math.PI*2,Bb=function(r,e,t,i,o,c,p){var g=r.x,_=r.y;g*=e,_*=t;var S=i*g-o*_,I=o*g+i*_;return{x:S+c,y:I+p}},oP=function(r,e){var t=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=Math.cos(r),o=Math.sin(r),c=Math.cos(r+e),p=Math.sin(r+e);return[{x:i-o*t,y:o+i*t},{x:c+p*t,y:p-c*t},{x:c,y:p}]},bA=function(r,e,t,i){var o=r*i-e*t<0?-1:1,c=r*t+e*i;return c>1&&(c=1),c<-1&&(c=-1),o*Math.acos(c)},sP=function(r,e,t,i,o,c,p,g,_,S,I,L){var F=Math.pow(o,2),z=Math.pow(c,2),V=Math.pow(I,2),Q=Math.pow(L,2),st=F*z-F*Q-z*V;st<0&&(st=0),st/=F*Q+z*V,st=Math.sqrt(st)*(p===g?-1:1);var at=st*o/c*L,Ft=st*-c/o*I,Kt=S*at-_*Ft+(r+t)/2,ee=_*at+S*Ft+(e+i)/2,Me=(I-at)/o,hr=(L-Ft)/c,Tr=(-I-at)/o,Dr=(-L-Ft)/c,cn=bA(1,0,Me,hr),Jr=bA(Me,hr,Tr,Dr);return g===0&&Jr>0&&(Jr-=qm),g===1&&Jr<0&&(Jr+=qm),[Kt,ee,cn,Jr]},uP=function(r){var e=r.px,t=r.py,i=r.cx,o=r.cy,c=r.rx,p=r.ry,g=r.xAxisRotation,_=g===void 0?0:g,S=r.largeArcFlag,I=S===void 0?0:S,L=r.sweepFlag,F=L===void 0?0:L,z=[];if(c===0||p===0)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:o}];var V=Math.sin(_*qm/360),Q=Math.cos(_*qm/360),st=Q*(e-i)/2+V*(t-o)/2,at=-V*(e-i)/2+Q*(t-o)/2;if(st===0&&at===0)return[{x1:0,y1:0,x2:0,y2:0,x:i,y:o}];c=Math.abs(c),p=Math.abs(p);var Ft=Math.pow(st,2)/Math.pow(c,2)+Math.pow(at,2)/Math.pow(p,2);Ft>1&&(c*=Math.sqrt(Ft),p*=Math.sqrt(Ft));var Kt=sP(e,t,i,o,c,p,I,F,V,Q,st,at),ee=Kt[0],Me=Kt[1],hr=Kt[2],Tr=Kt[3],Dr=Math.abs(Tr)/(qm/4);Math.abs(1-Dr)<1e-7&&(Dr=1);var cn=Math.max(Math.ceil(Dr),1);Tr/=cn;for(var Jr=0;Jr<cn;Jr++)z.push(oP(hr,Tr)),hr+=Tr;return z.map(function(Mn){var mi=Bb(Mn[0],c,p,Q,V,ee,Me),da=mi.x,Sa=mi.y,eo=Bb(Mn[1],c,p,Q,V,ee,Me),Gn=eo.x,Vi=eo.y,ua=Bb(Mn[2],c,p,Q,V,ee,Me),Xi=ua.x,ea=ua.y;return{x1:da,y1:Sa,x2:Gn,y2:Vi,x:Xi,y:ea}})};function FF(r,e,t,i,o,c,p,g,_){var S=uP({px:r,py:e,cx:g,cy:_,rx:t,ry:i,xAxisRotation:o,largeArcFlag:c,sweepFlag:p});return S.reduce(function(I,L){var F=L.x1,z=L.y1,V=L.x2,Q=L.y2,st=L.x,at=L.y;return I.push(F,z,V,Q,st,at),I},[])}function RF(r,e){"TQ".indexOf(r[0])<0&&(e.qx=null,e.qy=null);var t=r.slice(1),i=t[0],o=t[1];switch(r[0]){case"M":return e.x=i,e.y=o,r;case"A":return["C"].concat(arcToCubic.apply(0,[e.x1,e.y1].concat(r.slice(1))));case"Q":return e.qx=i,e.qy=o,["C"].concat(quadToCubic.apply(0,[e.x1,e.y1].concat(r.slice(1))));case"L":return["C"].concat(lineToCubic(e.x1,e.y1,r[1],r[2]));case"H":return["C"].concat(lineToCubic(e.x1,e.y1,r[1],e.y1));case"V":return["C"].concat(lineToCubic(e.x1,e.y1,e.x1,r[1]));case"Z":return["C"].concat(lineToCubic(e.x1,e.y1,e.x,e.y));default:}return r}function DF(r,e){e===void 0&&(e=!1);for(var t=path2Absolute(r),i={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},o=[],c="",p=t.length,g,_,S=[],I=0;I<p;I+=1)t[I]&&(c=t[I][0]),o[I]=c,t[I]=segmentToCubic(t[I],i),lP(t,o,I),p=t.length,c==="Z"&&S.push(I),g=t[I],_=g.length,i.x1=+g[_-2],i.y1=+g[_-1],i.x2=+g[_-4]||i.x1,i.y2=+g[_-3]||i.y1;return e?[t,S]:t}function lP(r,e,t){if(r[t].length>7){r[t].shift();for(var i=r[t],o=t;i.length;)e[t]="A",r.splice(o+=1,0,["C"].concat(i.splice(0,6)));r.splice(t,1)}}var EA=function(r,e,t,i,o){var c=-3*e+9*t-9*i+3*o,p=r*c+6*e-12*t+6*i;return r*p-3*e+3*t},wA=function(r,e,t,i,o,c,p,g,_){_===null&&(_=1),_=_>1?1:_<0?0:_;for(var S=_/2,I=12,L=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],F=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],z=0,V=0;V<I;V++){var Q=S*L[V]+S,st=EA(Q,r,t,o,p),at=EA(Q,e,i,c,g),Ft=st*st+at*at;z+=F[V]*Math.sqrt(Ft)}return S*z},cP=function(r,e,t,i,o,c,p,g){for(var _=[],S=[[],[]],I,L,F,z,V=0;V<2;++V){if(V===0?(L=6*r-12*t+6*o,I=-3*r+9*t-9*o+3*p,F=3*t-3*r):(L=6*e-12*i+6*c,I=-3*e+9*i-9*c+3*g,F=3*i-3*e),Math.abs(I)<1e-12){if(Math.abs(L)<1e-12)continue;z=-F/L,z>0&&z<1&&_.push(z);continue}var Q=L*L-4*F*I,st=Math.sqrt(Q);if(!(Q<0)){var at=(-L+st)/(2*I);at>0&&at<1&&_.push(at);var Ft=(-L-st)/(2*I);Ft>0&&Ft<1&&_.push(Ft)}}for(var Kt=_.length,ee=Kt,Me;Kt--;)z=_[Kt],Me=1-z,S[0][Kt]=Me*Me*Me*r+3*Me*Me*z*t+3*Me*z*z*o+z*z*z*p,S[1][Kt]=Me*Me*Me*e+3*Me*Me*z*i+3*Me*z*z*c+z*z*z*g;return S[0][ee]=r,S[1][ee]=e,S[0][ee+1]=p,S[1][ee+1]=g,S[0].length=S[1].length=ee+2,{min:{x:Math.min.apply(0,S[0]),y:Math.min.apply(0,S[1])},max:{x:Math.max.apply(0,S[0]),y:Math.max.apply(0,S[1])}}},fP=function(r,e,t,i,o,c,p,g){if(!(Math.max(r,t)<Math.min(o,p)||Math.min(r,t)>Math.max(o,p)||Math.max(e,i)<Math.min(c,g)||Math.min(e,i)>Math.max(c,g))){var _=(r*i-e*t)*(o-p)-(r-t)*(o*g-c*p),S=(r*i-e*t)*(c-g)-(e-i)*(o*g-c*p),I=(r-t)*(c-g)-(e-i)*(o-p);if(I){var L=_/I,F=S/I,z=+L.toFixed(2),V=+F.toFixed(2);if(!(z<+Math.min(r,t).toFixed(2)||z>+Math.max(r,t).toFixed(2)||z<+Math.min(o,p).toFixed(2)||z>+Math.max(o,p).toFixed(2)||V<+Math.min(e,i).toFixed(2)||V>+Math.max(e,i).toFixed(2)||V<+Math.min(c,g).toFixed(2)||V>+Math.max(c,g).toFixed(2)))return{x:L,y:F}}}},Hv=function(r,e,t){return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height},X1=function(r,e,t,i){return r===null&&(r=e=t=i=0),e===null&&(e=r.y,t=r.width,i=r.height,r=r.x),{x:r,y:e,width:t,w:t,height:i,h:i,x2:r+t,y2:e+i,cx:r+t/2,cy:e+i/2,r1:Math.min(t,i)/2,r2:Math.max(t,i)/2,r0:Math.sqrt(t*t+i*i)/2,path:rectPath(r,e,t,i),vb:[r,e,t,i].join(" ")}},SA=function(r,e){return r=X1(r),e=X1(e),Hv(e,r.x,r.y)||Hv(e,r.x2,r.y)||Hv(e,r.x,r.y2)||Hv(e,r.x2,r.y2)||Hv(r,e.x,e.y)||Hv(r,e.x2,e.y)||Hv(r,e.x,e.y2)||Hv(r,e.x2,e.y2)||(r.x<e.x2&&r.x>e.x||e.x<r.x2&&e.x>r.x)&&(r.y<e.y2&&r.y>e.y||e.y<r.y2&&e.y>r.y)},Nb=function(r,e,t,i,o,c,p,g){isArray(r)||(r=[r,e,t,i,o,c,p,g]);var _=cP.apply(null,r);return X1(_.min.x,_.min.y,_.max.x-_.min.x,_.max.y-_.min.y)},CA=function(r,e,t,i,o,c,p,g,_){var S=1-_,I=Math.pow(S,3),L=Math.pow(S,2),F=_*_,z=F*_,V=I*r+L*3*_*t+S*3*_*_*o+z*p,Q=I*e+L*3*_*i+S*3*_*_*c+z*g,st=r+2*_*(t-r)+F*(o-2*t+r),at=e+2*_*(i-e)+F*(c-2*i+e),Ft=t+2*_*(o-t)+F*(p-2*o+t),Kt=i+2*_*(c-i)+F*(g-2*c+i),ee=S*r+_*t,Me=S*e+_*i,hr=S*o+_*p,Tr=S*c+_*g,Dr=90-Math.atan2(st-Ft,at-Kt)*180/Math.PI;return{x:V,y:Q,m:{x:st,y:at},n:{x:Ft,y:Kt},start:{x:ee,y:Me},end:{x:hr,y:Tr},alpha:Dr}},AA=function(r,e,t){var i=Nb(r),o=Nb(e);if(!SA(i,o))return t?0:[];for(var c=wA.apply(0,r),p=wA.apply(0,e),g=~~(c/8),_=~~(p/8),S=[],I=[],L={},F=t?0:[],z=0;z<g+1;z++){var V=CA.apply(0,r.concat(z/g));S.push({x:V.x,y:V.y,t:z/g})}for(var z=0;z<_+1;z++){var V=CA.apply(0,e.concat(z/_));I.push({x:V.x,y:V.y,t:z/_})}for(var z=0;z<g;z++)for(var Q=0;Q<_;Q++){var st=S[z],at=S[z+1],Ft=I[Q],Kt=I[Q+1],ee=Math.abs(at.x-st.x)<.001?"y":"x",Me=Math.abs(Kt.x-Ft.x)<.001?"y":"x",hr=fP(st.x,st.y,at.x,at.y,Ft.x,Ft.y,Kt.x,Kt.y);if(hr){if(L[hr.x.toFixed(4)]===hr.y.toFixed(4))continue;L[hr.x.toFixed(4)]=hr.y.toFixed(4);var Tr=st.t+Math.abs((hr[ee]-st[ee])/(at[ee]-st[ee]))*(at.t-st.t),Dr=Ft.t+Math.abs((hr[Me]-Ft[Me])/(Kt[Me]-Ft[Me]))*(Kt.t-Ft.t);Tr>=0&&Tr<=1&&Dr>=0&&Dr<=1&&(t?F++:F.push({x:hr.x,y:hr.y,t1:Tr,t2:Dr}))}}return F},TA=function(r,e,t){r=path2Curve(r),e=path2Curve(e);for(var i,o,c,p,g,_,S,I,L,F,z=t?0:[],V=0,Q=r.length;V<Q;V++){var st=r[V];if(st[0]==="M")i=g=st[1],o=_=st[2];else{st[0]==="C"?(L=[i,o].concat(st.slice(1)),i=L[6],o=L[7]):(L=[i,o,i,o,g,_,g,_],i=g,o=_);for(var at=0,Ft=e.length;at<Ft;at++){var Kt=e[at];if(Kt[0]==="M")c=S=Kt[1],p=I=Kt[2];else{Kt[0]==="C"?(F=[c,p].concat(Kt.slice(1)),c=F[6],p=F[7]):(F=[c,p,c,p,S,I,S,I],c=S,p=I);var ee=AA(L,F,t);if(t)z+=ee;else{for(var Me=0,hr=ee.length;Me<hr;Me++)ee[Me].segment1=V,ee[Me].segment2=at,ee[Me].bez1=L,ee[Me].bez2=F;z=z.concat(ee)}}}}}return z};function BF(r,e){return TA(r,e)}function MA(r){return pn({},r.defaultStyle,{fill:r.color},r.style)}_i("schema","venn",{draw:function(r,e){var t=r.data,i=aP(t[j1]),o=MA(r),c=e.addGroup({name:"venn-shape"});c.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},o),{path:i}),name:"venn-path"});var p=r.customInfo,g=p.offsetX,_=p.offsetY,S=os.transform(null,[["t",g,_]]);return c.setMatrix(S),c},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{lineWidth:0,stroke:e,fill:e,r:4}}}});var IA=function(r){return function(e,t){var i=[];return i[0]=r(e[0],t[0]),i[1]=r(e[1],t[1]),i[2]=r(e[2],t[2]),i}},kA={normal:function(r){return r},multiply:function(r,e){return r*e/255},screen:function(r,e){return 255*(1-(1-r/255)*(1-e/255))},overlay:function(r,e){return e<128?2*r*e/255:255*(1-2*(1-r/255)*(1-e/255))},darken:function(r,e){return r>e?e:r},lighten:function(r,e){return r>e?r:e},dodge:function(r,e){return r===255?255:(r=255*(e/255)/(1-r/255),r>255?255:r)},burn:function(r,e){return e===255?255:r===0?0:255*(1-Math.min(1,(1-e/255)/(r/255)))}},LA=function(r){if(!kA[r])throw new Error("unknown blend mode "+r);return kA[r]};function hP(r,e,t){t===void 0&&(t="normal");var i=IA(LA(t))(Y1(r),Y1(e)),o=Y1(r),c=o[0],p=o[1],g=o[2],_=o[3],S=Y1(e),I=S[0],L=S[1],F=S[2],z=S[3],V=Number((_+z*(1-_)).toFixed(2)),Q=Math.round((_*(1-z)*(c/255)+_*z*(i[0]/255)+(1-_)*z*(I/255))/V*255),st=Math.round((_*(1-z)*(p/255)+_*z*(i[1]/255)+(1-_)*z*(L/255))/V*255),at=Math.round((_*(1-z)*(g/255)+_*z*(i[2]/255)+(1-_)*z*(F/255))/V*255);return"rgba("+Q+", "+st+", "+at+", "+V+")"}function Y1(r){var e=r.replace("/s+/g",""),t;return typeof e=="string"&&!e.startsWith("rgba")&&!e.startsWith("#")?t=_a.rgb2arr(_a.toRGB(e)).concat([1]):(e.startsWith("rgba")&&(t=e.replace("rgba(","").replace(")","").split(",")),e.startsWith("#")&&(t=_a.rgb2arr(e).concat([1])),t.map(function(i,o){return o===3?Number(i):i|0}))}var Kp=nt(12886),PA=1e-10;function zb(r,e){var t=FA(r),i=t.filter(function(Tr){return OA(Tr,r)}),o=0,c=0,p,g=[];if(i.length>1){var _=RA(i);for(p=0;p<i.length;++p){var S=i[p];S.angle=Math.atan2(S.x-_.x,S.y-_.y)}i.sort(function(Tr,Dr){return Dr.angle-Tr.angle});var I=i[i.length-1];for(p=0;p<i.length;++p){var L=i[p];c+=(I.x+L.x)*(L.y-I.y);for(var F={x:(L.x+I.x)/2,y:(L.y+I.y)/2},z=null,V=0;V<L.parentIndex.length;++V)if(I.parentIndex.indexOf(L.parentIndex[V])>-1){var Q=r[L.parentIndex[V]],st=Math.atan2(L.x-Q.x,L.y-Q.y),at=Math.atan2(I.x-Q.x,I.y-Q.y),Ft=at-st;Ft<0&&(Ft+=2*Math.PI);var Kt=at-Ft/2,ee=Rh(F,{x:Q.x+Q.radius*Math.sin(Kt),y:Q.y+Q.radius*Math.cos(Kt)});ee>Q.radius*2&&(ee=Q.radius*2),(z===null||z.width>ee)&&(z={circle:Q,width:ee,p1:L,p2:I})}z!==null&&(g.push(z),o+=Ub(z.circle.radius,z.width),I=L)}}else{var Me=r[0];for(p=1;p<r.length;++p)r[p].radius<Me.radius&&(Me=r[p]);var hr=!1;for(p=0;p<r.length;++p)if(Rh(r[p],Me)>Math.abs(Me.radius-r[p].radius)){hr=!0;break}hr?o=c=0:(o=Me.radius*Me.radius*Math.PI,g.push({circle:Me,p1:{x:Me.x,y:Me.y+Me.radius},p2:{x:Me.x-PA,y:Me.y+Me.radius},width:Me.radius*2}))}return c/=2,e&&(e.area=o+c,e.arcArea=o,e.polygonArea=c,e.arcs=g,e.innerPoints=i,e.intersectionPoints=t),o+c}function OA(r,e){for(var t=0;t<e.length;++t)if(Rh(r,e[t])>e[t].radius+PA)return!1;return!0}function FA(r){for(var e=[],t=0;t<r.length;++t)for(var i=t+1;i<r.length;++i)for(var o=Km(r[t],r[i]),c=0;c<o.length;++c){var p=o[c];p.parentIndex=[t,i],e.push(p)}return e}function Ub(r,e){return r*r*Math.acos(1-e/r)-(r-e)*Math.sqrt(e*(2*r-e))}function Rh(r,e){return Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y))}function Zb(r,e,t){if(t>=r+e)return 0;if(t<=Math.abs(r-e))return Math.PI*Math.min(r,e)*Math.min(r,e);var i=r-(t*t-e*e+r*r)/(2*t),o=e-(t*t-r*r+e*e)/(2*t);return Ub(r,i)+Ub(e,o)}function Km(r,e){var t=Rh(r,e),i=r.radius,o=e.radius;if(t>=i+o||t<=Math.abs(i-o))return[];var c=(i*i-o*o+t*t)/(2*t),p=Math.sqrt(i*i-c*c),g=r.x+c*(e.x-r.x)/t,_=r.y+c*(e.y-r.y)/t,S=-(e.y-r.y)*(p/t),I=-(e.x-r.x)*(p/t);return[{x:g+S,y:_-I},{x:g-S,y:_+I}]}function RA(r){for(var e={x:0,y:0},t=0;t<r.length;++t)e.x+=r[t].x,e.y+=r[t].y;return e.x/=r.length,e.y/=r.length,e}function Vb(r,e,t){var i=e[0].radius-Rh(e[0],r),o,c;for(o=1;o<e.length;++o)c=e[o].radius-Rh(e[o],r),c<=i&&(i=c);for(o=0;o<t.length;++o)c=Rh(t[o],r)-t[o].radius,c<=i&&(i=c);return i}function DA(r,e){var t=[],i;for(i=0;i<r.length;++i){var o=r[i];t.push({x:o.x,y:o.y}),t.push({x:o.x+o.radius/2,y:o.y}),t.push({x:o.x-o.radius/2,y:o.y}),t.push({x:o.x,y:o.y+o.radius/2}),t.push({x:o.x,y:o.y-o.radius/2})}var c=t[0],p=Vb(t[0],r,e);for(i=1;i<t.length;++i){var g=Vb(t[i],r,e);g>=p&&(c=t[i],p=g)}var _=(0,Kp.nelderMead)(function(F){return-1*Vb({x:F[0],y:F[1]},r,e)},[c.x,c.y],{maxIterations:500,minErrorDelta:1e-10}).x,S={x:_[0],y:_[1]},I=!0;for(i=0;i<r.length;++i)if(Rh(S,r[i])>r[i].radius){I=!1;break}for(i=0;i<e.length;++i)if(Rh(S,e[i])<e[i].radius){I=!1;break}if(!I)if(r.length==1)S={x:r[0].x,y:r[0].y};else{var L={};zb(r,L),L.arcs.length===0?S={x:0,y:-1e3,disjoint:!0}:L.arcs.length==1?S={x:L.arcs[0].circle.x,y:L.arcs[0].circle.y}:e.length?S=DA(r,[]):S=RA(L.arcs.map(function(F){return F.p1}))}return S}function NF(r){var e={},t=[];for(var i in r)t.push(i),e[i]=[];for(var o=0;o<t.length;o++)for(var c=r[t[o]],p=o+1;p<t.length;++p){var g=r[t[p]],_=Rh(c,g);_+g.radius<=c.radius+1e-10?e[t[p]].push(t[o]):_+c.radius<=g.radius+1e-10&&e[t[o]].push(t[p])}return e}function BA(r,e){for(var t={},i=NF(r),o=0;o<e.length;++o){for(var c=e[o].sets,p={},g={},_=0;_<c.length;++_){p[c[_]]=!0;for(var S=i[c[_]],I=0;I<S.length;++I)g[S[I]]=!0}var L=[],F=[];for(var z in r)z in p?L.push(r[z]):z in g||F.push(r[z]);var V=DA(L,F);t[c]=V,V.disjoint&&e[o].size>0&&console.log("WARNING: area "+c+" not represented on screen")}return t}function NA(r,e,t){var i=[],o=r-t,c=e;return i.push("M",o,c),i.push("A",t,t,0,1,0,o+2*t,c),i.push("A",t,t,0,1,0,o,c),i.join(" ")}function zF(r){var e=r.split(" ");return{x:parseFloat(e[1]),y:parseFloat(e[2]),radius:-parseFloat(e[4])}}function zA(r){var e={};zb(r,e);var t=e.arcs;if(t.length===0)return"M 0 0";if(t.length==1){var i=t[0].circle;return NA(i.x,i.y,i.radius)}else{for(var o=[`
M`,t[0].p2.x,t[0].p2.y],c=0;c<t.length;++c){var p=t[c],g=p.circle.radius,_=p.width>g;o.push(`
A`,g,g,0,_?1:0,1,p.p1.x,p.p1.y)}return o.join(" ")}}function UA(r,e){e=e||{},e.maxIterations=e.maxIterations||500;var t=e.initialLayout||GA,i=e.lossFunction||q1;r=ZA(r);var o=t(r,e),c=[],p=[],g;for(g in o)o.hasOwnProperty(g)&&(c.push(o[g].x),c.push(o[g].y),p.push(g));for(var _=(0,Kp.nelderMead)(function(L){for(var F={},z=0;z<p.length;++z){var V=p[z];F[V]={x:L[2*z],y:L[2*z+1],radius:o[V].radius}}return i(F,r)},c,e),S=_.x,I=0;I<p.length;++I)g=p[I],o[g].x=S[2*I],o[g].y=S[2*I+1];return o}var Gb=1e-10;function $1(r,e,t){return Math.min(r,e)*Math.min(r,e)*Math.PI<=t+Gb?Math.abs(r-e):(0,Kp.bisect)(function(i){return Zb(r,e,i)-t},0,r+e)}function ZA(r){r=r.slice();var e=[],t={},i,o,c,p;for(i=0;i<r.length;++i){var g=r[i];g.sets.length==1?e.push(g.sets[0]):g.sets.length==2&&(c=g.sets[0],p=g.sets[1],t[[c,p]]=!0,t[[p,c]]=!0)}for(e.sort(function(_,S){return _>S?1:-1}),i=0;i<e.length;++i)for(c=e[i],o=i+1;o<e.length;++o)p=e[o],[c,p]in t||r.push({sets:[c,p],size:0});return r}function VA(r,e,t){var i=(0,Kp.zerosM)(e.length,e.length),o=(0,Kp.zerosM)(e.length,e.length);return r.filter(function(c){return c.sets.length==2}).map(function(c){var p=t[c.sets[0]],g=t[c.sets[1]],_=Math.sqrt(e[p].size/Math.PI),S=Math.sqrt(e[g].size/Math.PI),I=$1(_,S,c.size);i[p][g]=i[g][p]=I;var L=0;c.size+1e-10>=Math.min(e[p].size,e[g].size)?L=1:c.size<=1e-10&&(L=-1),o[p][g]=o[g][p]=L}),{distances:i,constraints:o}}function Mg(r,e,t,i){var o=0,c;for(c=0;c<e.length;++c)e[c]=0;for(c=0;c<t.length;++c)for(var p=r[2*c],g=r[2*c+1],_=c+1;_<t.length;++_){var S=r[2*_],I=r[2*_+1],L=t[c][_],F=i[c][_],z=(S-p)*(S-p)+(I-g)*(I-g),V=Math.sqrt(z),Q=z-L*L;F>0&&V<=L||F<0&&V>=L||(o+=2*Q*Q,e[2*c]+=4*Q*(p-S),e[2*c+1]+=4*Q*(g-I),e[2*_]+=4*Q*(S-p),e[2*_+1]+=4*Q*(I-g))}return o}function GA(r,e){var t=jA(r,e),i=e.lossFunction||q1;if(r.length>=8){var o=HA(r,e),c=i(o,r),p=i(t,r);c+1e-8<p&&(t=o)}return t}function HA(r,e){e=e||{};var t=e.restarts||10,i=[],o={},c;for(c=0;c<r.length;++c){var p=r[c];p.sets.length==1&&(o[p.sets[0]]=i.length,i.push(p))}var g=VA(r,i,o),_=g.distances,S=g.constraints,I=(0,Kp.norm2)(_.map(Kp.norm2))/_.length;_=_.map(function(Ft){return Ft.map(function(Kt){return Kt/I})});var L=function(Ft,Kt){return Mg(Ft,Kt,_,S)},F,z;for(c=0;c<t;++c){var V=(0,Kp.zeros)(_.length*2).map(Math.random);z=(0,Kp.conjugateGradient)(L,V,e),(!F||z.fx<F.fx)&&(F=z)}var Q=F.x,st={};for(c=0;c<i.length;++c){var at=i[c];st[at.sets[0]]={x:Q[2*c]*I,y:Q[2*c+1]*I,radius:Math.sqrt(at.size/Math.PI)}}if(e.history)for(c=0;c<e.history.length;++c)(0,Kp.scale)(e.history[c].x,I);return st}function jA(r,e){for(var t=e&&e.lossFunction?e.lossFunction:q1,i={},o={},c,p=0;p<r.length;++p){var g=r[p];g.sets.length==1&&(c=g.sets[0],i[c]={x:1e10,y:1e10,rowid:Object.keys(i).length,size:g.size,radius:Math.sqrt(g.size/Math.PI)},o[c]=[])}r=r.filter(function(Gn){return Gn.sets.length==2});for(var p=0;p<r.length;++p){var _=r[p],S=_.hasOwnProperty("weight")?_.weight:1,I=_.sets[0],L=_.sets[1];_.size+Gb>=Math.min(i[I].size,i[L].size)&&(S=0),o[I].push({set:L,size:_.size,weight:S}),o[L].push({set:I,size:_.size,weight:S})}var F=[];for(c in o)if(o.hasOwnProperty(c)){for(var z=0,p=0;p<o[c].length;++p)z+=o[c][p].size*o[c][p].weight;F.push({set:c,size:z})}function V(Gn,Vi){return Vi.size-Gn.size}F.sort(V);var Q={};function st(Gn){return Gn.set in Q}function at(Gn,Vi){i[Vi].x=Gn.x,i[Vi].y=Gn.y,Q[Vi]=!0}at({x:0,y:0},F[0].set);for(var p=1;p<F.length;++p){var Ft=F[p].set,Kt=o[Ft].filter(st);if(c=i[Ft],Kt.sort(V),Kt.length===0)throw"ERROR: missing pairwise overlap information";for(var ee=[],Me=0;Me<Kt.length;++Me){var hr=i[Kt[Me].set],Tr=$1(c.radius,hr.radius,Kt[Me].size);ee.push({x:hr.x+Tr,y:hr.y}),ee.push({x:hr.x-Tr,y:hr.y}),ee.push({y:hr.y+Tr,x:hr.x}),ee.push({y:hr.y-Tr,x:hr.x});for(var Dr=Me+1;Dr<Kt.length;++Dr)for(var cn=i[Kt[Dr].set],Jr=$1(c.radius,cn.radius,Kt[Dr].size),Mn=Km({x:hr.x,y:hr.y,radius:Tr},{x:cn.x,y:cn.y,radius:Jr}),mi=0;mi<Mn.length;++mi)ee.push(Mn[mi])}for(var da=1e50,Sa=ee[0],Me=0;Me<ee.length;++Me){i[Ft].x=ee[Me].x,i[Ft].y=ee[Me].y;var eo=t(i,r);eo<da&&(da=eo,Sa=ee[Me])}at(Sa,Ft)}return i}function q1(r,e){var t=0;function i(I){return I.map(function(L){return r[L]})}for(var o=0;o<e.length;++o){var c=e[o],p=void 0;if(c.sets.length!=1){if(c.sets.length==2){var g=r[c.sets[0]],_=r[c.sets[1]];p=Zb(g.radius,_.radius,Rh(g,_))}else p=zb(i(c.sets));var S=c.hasOwnProperty("weight")?c.weight:1;t+=S*(p-c.size)*(p-c.size)}}return t}function pP(r,e,t){t===null?r.sort(function(Q,st){return st.radius-Q.radius}):r.sort(t);var i;if(r.length>0){var o=r[0].x,c=r[0].y;for(i=0;i<r.length;++i)r[i].x-=o,r[i].y-=c}if(r.length==2){var p=distance(r[0],r[1]);p<Math.abs(r[1].radius-r[0].radius)&&(r[1].x=r[0].x+r[0].radius-r[1].radius-1e-10,r[1].y=r[0].y)}if(r.length>1){var g=Math.atan2(r[1].x,r[1].y)-e,_=void 0,S=void 0,I=Math.cos(g),L=Math.sin(g);for(i=0;i<r.length;++i)_=r[i].x,S=r[i].y,r[i].x=I*_-L*S,r[i].y=L*_+I*S}if(r.length>2){for(var F=Math.atan2(r[2].x,r[2].y)-e;F<0;)F+=2*Math.PI;for(;F>2*Math.PI;)F-=2*Math.PI;if(F>Math.PI){var z=r[1].y/(1e-10+r[1].x);for(i=0;i<r.length;++i){var V=(r[i].x+z*r[i].y)/(1+z*z);r[i].x=2*V-r[i].x,r[i].y=2*V*z-r[i].y}}}}function WA(r){r.map(function(S){S.parent=S});function e(S){return S.parent!==S&&(S.parent=e(S.parent)),S.parent}function t(S,I){var L=e(S),F=e(I);L.parent=F}for(var i=0;i<r.length;++i)for(var o=i+1;o<r.length;++o){var c=r[i].radius+r[o].radius;distance(r[i],r[o])+1e-10<c&&t(r[o],r[i])}for(var p={},g,i=0;i<r.length;++i)g=e(r[i]).parent.setid,g in p||(p[g]=[]),p[g].push(r[i]);r.map(function(S){delete S.parent});var _=[];for(g in p)p.hasOwnProperty(g)&&_.push(p[g]);return _}function K1(r){var e=function(t){var i=Math.max.apply(null,r.map(function(c){return c[t]+c.radius})),o=Math.min.apply(null,r.map(function(c){return c[t]-c.radius}));return{max:i,min:o}};return{xRange:e("x"),yRange:e("y")}}function UF(r,e,t){e===null&&(e=Math.PI/2);var i=[],o,c;for(c in r)if(r.hasOwnProperty(c)){var p=r[c];i.push({x:p.x,y:p.y,radius:p.radius,setid:c})}var g=WA(i);for(o=0;o<g.length;++o){pP(g[o],e,t);var _=K1(g[o]);g[o].size=(_.xRange.max-_.xRange.min)*(_.yRange.max-_.yRange.min),g[o].bounds=_}g.sort(function(V,Q){return Q.size-V.size}),i=g[0];var S=i.bounds,I=(S.xRange.max-S.xRange.min)/50;function L(V,Q,st){if(V){var at=V.bounds,Ft,Kt,ee;Q?Ft=S.xRange.max-at.xRange.min+I:(Ft=S.xRange.max-at.xRange.max,ee=(at.xRange.max-at.xRange.min)/2-(S.xRange.max-S.xRange.min)/2,ee<0&&(Ft+=ee)),st?Kt=S.yRange.max-at.yRange.min+I:(Kt=S.yRange.max-at.yRange.max,ee=(at.yRange.max-at.yRange.min)/2-(S.yRange.max-S.yRange.min)/2,ee<0&&(Kt+=ee));for(var Me=0;Me<V.length;++Me)V[Me].x+=Ft,V[Me].y+=Kt,i.push(V[Me])}}for(var F=1;F<g.length;)L(g[F],!0,!1),L(g[F+1],!1,!0),L(g[F+2],!0,!0),F+=3,S=K1(i);var z={};for(o=0;o<i.length;++o)z[i[o].setid]=i[o];return z}function XA(r,e,t,i){var o=[],c=[];for(var p in r)r.hasOwnProperty(p)&&(c.push(p),o.push(r[p]));e-=2*i,t-=2*i;var g=K1(o),_=g.xRange,S=g.yRange;if(_.max==_.min||S.max==S.min)return console.log("not scaling solution: zero size detected"),r;for(var I=e/(_.max-_.min),L=t/(S.max-S.min),F=Math.min(L,I),z=(e-(_.max-_.min)*F)/2,V=(t-(S.max-S.min)*F)/2,Q={},st=0;st<o.length;++st){var at=o[st];Q[c[st]]={radius:F*at.radius,x:i+z+(at.x-_.min)*F,y:i+V+(at.y-S.min)*F}}return Q}var YA=(0,b.HP)(function(r,e,t,i){var o=new Map,c=r.length;return e.forEach(function(p,g){if(p[i].length===1)o.set(p[qd],r[(g+c)%c]);else{var _=p[i].map(function(S){return o.get(S)});o.set(p[qd],_.slice(1).reduce(function(S,I){return hP(S,I,t)},_[0]))}}),o},function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return JSON.stringify(r)});function dP(r,e,t,i){i===void 0&&(i=0);var o=r.data,c=r.setsField,p=r.sizeField;if(o.length===0)return Hd(hp.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),[];var g=o.map(function(L){var F;return(0,P.pi)((0,P.pi)({},L),(F={sets:L[c]||[],size:L[p]},F[j1]="",F[qd]="",F))});g.sort(function(L,F){return L.sets.length-F.sets.length});var _=UA(g),S=XA(_,e,t,i),I=BA(S,g);return g.forEach(function(L){var F=L.sets,z=F.join(",");L[qd]=z;var V=F.map(function(at){return S[at]}),Q=zA(V);/[zZ]$/.test(Q)||(Q+=" Z"),L[j1]=Q;var st=I[z]||{x:0,y:0};(0,b.f0)(L,st)}),g}function vP(r,e){for(var t=0;t<e.length;t++)if(!r.includes(e[t]))return!1;return!0}var gP=40;function $A(r,e,t){var i=r.chart,o=r.options,c=o.blendMode,p=o.setsField,g=i.getTheme(),_=g.colors10,S=g.colors20,I=t;(0,b.kJ)(I)||(I=e.filter(function(F){return F[p].length===1}).length<=10?_:S);var L=YA(I,e,c,p);return function(F){return L.get(F)||I[0]}}function Kd(r,e){var t=r.options,i=t.color;if(typeof i!="function"){var o=typeof i=="string"?[i]:i,c=$A(r,e,o);return function(p){return c(p[qd])}}return i}function Qm(r){var e=r.chart,t=r.options,i=t.legend,o=t.appendPadding,c=t.padding,p=pp(o);return i!==!1&&(p=lm(o,(0,b.U2)(i,"position"),gP)),e.appendPadding=bx([p,c]),r}function Qd(r){var e=r.options,t=e.data;t||(Hd(hp.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),t=[]);var i=t.filter(function(c){return c.sets.length===1}).map(function(c){return c.sets[0]}),o=t.filter(function(c){var p=c.sets;return vP(i,p)});return(0,b.Xy)(o,t)||Hd(hp.WARN,!1,"warn: %s","\u4EA4\u96C6\u4E2D\u4E0D\u80FD\u51FA\u73B0\u4E0D\u5B58\u5728\u7684\u96C6\u5408, \u8BF7\u8F93\u5165\u5408\u6CD5\u6570\u636E"),(0,b.b$)({},r,{options:{data:o}})}function Dh(r){var e=r.chart,t=r.options,i=t.pointStyle,o=t.setsField,c=t.sizeField,p=pp(e.appendPadding),g=p[0],_=p[1],S=p[2],I=p[3],L={offsetX:I,offsetY:g},F=e.viewBBox,z=F.width,V=F.height,Q=dP(t,Math.max(z-(_+I),0),Math.max(V-(g+S),0),0);e.data(Q);var st=l1(pn({},r,{options:{xField:"x",yField:"y",sizeField:c,seriesField:qd,rawFields:[o,c],schema:{shape:"venn",style:i}}})).ext,at=st.geometry;at.customInfo(L);var Ft=Kd(r,Q);return typeof Ft=="function"&&at.color(qd,function(Kt){var ee=Q.find(function(hr){return hr[qd]===Kt}),Me=$A(r,Q)(Kt);return Ft(ee,Me)}),r}function Jm(r){var e=r.chart,t=r.options,i=t.label,o=pp(e.appendPadding),c=o[0],p=o[3],g={offsetX:p,offsetY:c},_=Ac(e,"schema");if(!i)_.label(!1);else{var S=i.callback,I=(0,P._T)(i,["callback"]);_.label({fields:["id"],callback:S,cfg:(0,b.b$)({},Kl(I),{type:"venn",customLabelInfo:g})})}return r}function jv(r){var e=r.chart,t=r.options,i=t.legend,o=t.sizeField;return e.legend(qd,i),e.legend(o,!1),r}function ty(r){var e=r.chart;return e.axis(!1),r}function Q1(r){var e=r.options,t=r.chart,i=e.interactions;if(i){var o={"legend-active":"venn-legend-active","legend-highlight":"venn-legend-highlight"};lu(pn({},r,{options:{interactions:i.map(function(c){return(0,P.pi)((0,P.pi)({},c),{type:o[c.type]||c.type})})}}))}return t.removeInteraction("legend-active"),t.removeInteraction("legend-highlight"),r}function Qp(r){return za(Qm,Go,Qd,Dh,Jm,So({}),jv,ty,Ol,Q1,ds)(r)}var Ig=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="venn",t}return e.getDefaultOptions=function(){return W4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Qp},e.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},e}(Ka),Ks="x",Vc="violinY",Jp="violinSize",ey="minMax",qA="quantile",Hb="median",ry="violin_view",mP="min_max_view",yP="quantile_view",KA="median_view",QA=pn({},Ka.getDefaultOptions(),{syncViewPadding:!0,kde:{type:"triangular",sampleSize:32,width:3},violinStyle:{lineWidth:1,fillOpacity:.3,strokeOpacity:.75},xAxis:{grid:{line:null},tickLine:{alignTick:!1}},yAxis:{grid:{line:{style:{lineWidth:.5,lineDash:[4,4]}}}},legend:{position:"top-left"},tooltip:{showMarkers:!1}}),_P=nt(50517),xP=nt.n(_P);function jb(r,e){var t=r.length*e;if(r.length===0)throw new Error("quantile requires at least one data point.");if(e<0||e>1)throw new Error("quantiles must be between 0 and 1");return e===1?r[r.length-1]:e===0?r[0]:t%1!==0?r[Math.ceil(t)-1]:r.length%2===0?(r[t-1]+r[t])/2:r[t]}function Wv(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}function J1(r,e,t,i){for(t=t||0,i=i||r.length-1;i>t;){if(i-t>600){var o=i-t+1,c=e-t+1,p=Math.log(o),g=.5*Math.exp(2*p/3),_=.5*Math.sqrt(p*g*(o-g)/o);c-o/2<0&&(_*=-1);var S=Math.max(t,Math.floor(e-c*g/o+_)),I=Math.min(i,Math.floor(e+(o-c)*g/o+_));J1(r,e,S,I)}var L=r[e],F=t,z=i;for(Wv(r,t,e),r[i]>L&&Wv(r,t,i);F<z;){for(Wv(r,F,z),F++,z--;r[F]<L;)F++;for(;r[z]>L;)z--}r[t]===L?Wv(r,t,z):(z++,Wv(r,z,i)),z<=e&&(t=z+1),e<=z&&(i=z-1)}}function td(r,e){var t=r.slice();if(Array.isArray(e)){bP(t,e);for(var i=[],o=0;o<e.length;o++)i[o]=jb(t,e[o]);return i}else{var c=tT(t.length,e);return JA(t,c,0,t.length-1),jb(t,e)}}function JA(r,e,t,i){e%1===0?J1(r,e,t,i):(e=Math.floor(e),J1(r,e,t,i),J1(r,e+1,e+1,i))}function bP(r,e){for(var t=[0],i=0;i<e.length;i++)t.push(tT(r.length,e[i]));t.push(r.length-1),t.sort(EP);for(var o=[0,t.length-1];o.length;){var c=Math.ceil(o.pop()),p=Math.floor(o.pop());if(!(c-p<=1)){var g=Math.floor((p+c)/2);JA(r,t[g],Math.floor(t[p]),Math.ceil(t[c])),o.push(p,g,g,c)}}}function EP(r,e){return r-e}function tT(r,e){var t=r*e;return e===1?r-1:e===0?0:t%1!==0?Math.ceil(t)-1:r%2===0?t-.5:t}var eT=function(r){return{low:(0,b.VV)(r),high:(0,b.Fp)(r),q1:td(r,.25),q3:td(r,.75),median:td(r,[.5]),minMax:[(0,b.VV)(r),(0,b.Fp)(r)],quantile:[td(r,.25),td(r,.75)]}},rT=function(r,e){var t=xP().create(r,e);return{violinSize:t.map(function(i){return i.y}),violinY:t.map(function(i){return i.x})}},Wb=function(r){var e=r.xField,t=r.yField,i=r.seriesField,o=r.data,c=r.kde,p={min:c.min,max:c.max,size:c.sampleSize,width:c.width};if(!i){var g=(0,b.vM)(o,e);return Object.keys(g).map(function(I){var L=g[I],F=L.map(function(z){return z[t]});return(0,P.pi)((0,P.pi)({x:I},rT(F,p)),eT(F))})}var _=[],S=(0,b.vM)(o,i);return Object.keys(S).forEach(function(I){var L=(0,b.vM)(S[I],e);return Object.keys(L).forEach(function(F){var z,V=L[F],Q=V.map(function(st){return st[t]});_.push((0,P.pi)((0,P.pi)((z={x:F},z[i]=I,z),rT(Q,p)),eT(Q)))})}),_},ny=["low","high","q1","q3","median"],t_=[{type:"dodge",marginRatio:1/32}];function wP(r){var e=r.chart,t=r.options;return e.data(Wb(t)),r}function SP(r){var e=r.chart,t=r.options,i=t.seriesField,o=t.color,c=t.shape,p=c===void 0?"violin":c,g=t.violinStyle,_=t.tooltip,S=t.state,I=e.createView({id:ry});return Cx({chart:I,options:{xField:Ks,yField:Vc,seriesField:i||Ks,sizeField:Jp,tooltip:(0,P.pi)({fields:ny},_),violin:{style:g,color:o,shape:p},state:S}}),I.geometries[0].adjust(t_),r}function Xb(r){var e=r.chart,t=r.options,i=t.seriesField,o=t.color,c=t.tooltip,p=t.box;if(p===!1)return r;var g=e.createView({id:mP});pc({chart:g,options:{xField:Ks,yField:ey,seriesField:i||Ks,tooltip:(0,P.pi)({fields:ny},c),state:typeof p=="object"?p.state:{},interval:{color:o,size:1,style:{lineWidth:0}}}}),g.geometries[0].adjust(t_);var _=e.createView({id:yP});pc({chart:_,options:{xField:Ks,yField:qA,seriesField:i||Ks,tooltip:(0,P.pi)({fields:ny},c),state:typeof p=="object"?p.state:{},interval:{color:o,size:8,style:{fillOpacity:1}}}}),_.geometries[0].adjust(t_);var S=e.createView({id:KA});return Bf({chart:S,options:{xField:Ks,yField:Hb,seriesField:i||Ks,tooltip:(0,P.pi)({fields:ny},c),state:typeof p=="object"?p.state:{},point:{color:o,size:1,style:{fill:"white",lineWidth:0}}}}),S.geometries[0].adjust(t_),_.axis(!1),g.axis(!1),S.axis(!1),S.legend(!1),g.legend(!1),_.legend(!1),r}function CP(r){var e,t=r.chart,i=r.options,o=i.meta,c=i.xAxis,p=i.yAxis,g={},_=pn(g,o,(e={},e[Ks]=(0,P.pi)((0,P.pi)({sync:!0},ps(c,Df)),{type:"cat"}),e[Vc]=(0,P.pi)({sync:!0},ps(p,Df)),e[ey]=(0,P.pi)({sync:Vc},ps(p,Df)),e[qA]=(0,P.pi)({sync:Vc},ps(p,Df)),e[Hb]=(0,P.pi)({sync:Vc},ps(p,Df)),e));return t.scale(_),r}function AP(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=yo(e,ry);return i===!1?c.axis(Ks,!1):c.axis(Ks,i),o===!1?c.axis(Vc,!1):c.axis(Vc,o),e.axis(!1),r}function nT(r){var e=r.chart,t=r.options,i=t.legend,o=t.seriesField,c=t.shape;if(i===!1)e.legend(!1);else{var p=o||Ks,g=(0,b.CE)(i,["selected"]);(!c||!c.startsWith("hollow"))&&((0,b.U2)(g,["marker","style","lineWidth"])||(0,b.t8)(g,["marker","style","lineWidth"],0)),e.legend(p,g),(0,b.U2)(i,"selected")&&(0,b.S6)(e.views,function(_){return _.legend(p,i)})}return r}function Yb(r){var e=r.chart,t=yo(e,ry);return ms()((0,P.pi)((0,P.pi)({},r),{chart:t})),r}function iT(r){var e=r.chart,t=r.options,i=t.animation;return(0,b.S6)(e.views,function(o){fm(o,i)}),r}function aT(r){return za(Go,wP,SP,Xb,CP,Ol,AP,nT,lu,Yb,iT)(r)}var ZF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="violin",t}return e.getDefaultOptions=function(){return QA},e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(Wb(this.options))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return aT},e}(Ka),ch="$$yField$$",iy="$$diffField$$",e_="$$absoluteField$$",G0="$$isTotal$$",r_={label:{},leaderLine:{style:{lineWidth:1,stroke:"#8c8c8c",lineDash:[4,2]}},total:{style:{fill:"rgba(0, 0, 0, 0.25)"}},interactions:[{type:"element-active"}],risingFill:"#f4664a",fallingFill:"#30bf78",waterfallStyle:{fill:"rgba(0, 0, 0, 0.25)"},yAxis:{grid:{line:{style:{lineDash:[4,2]}}}}};function VF(r){for(var e=[],t=0;t<r.length;t++){var i=r[t];if(i){var o=t===0?"M":"L";e.push([o,i.x,i.y])}}var c=r[0];return e.push(["L",c.x,c.y]),e.push(["z"]),e}function GF(r){return pn({},r.defaultStyle,r.style,{fill:r.color})}_i("interval","waterfall",{draw:function(r,e){var t=r.customInfo,i=r.points,o=r.nextPoints,c=e.addGroup(),p=this.parsePath(VF(i)),g=GF(r);c.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},g),{path:p})});var _=(0,b.U2)(t,"leaderLine");if(_&&o){var S=[["M",i[2].x,i[2].y],["L",o[0].x,o[0].y]];i[2].y===o[1].y&&(S[1]=["L",o[1].x,o[1].y]),S=this.parsePath(S),c.addShape("path",{attrs:(0,P.pi)({path:S},_.style||{})})}return c}});function H0(r,e,t,i,o){var c,p=[];if((0,b.u4)(r,function(_,S){var I;Hd(hp.WARN,(0,b.hj)(S[t]),S[t]+" is not a valid number");var L=(0,b.o8)(S[t])?null:S[t];return p.push((0,P.pi)((0,P.pi)({},S),(I={},I[i]=[_,_+L],I))),_+L},0),p.length&&o){var g=(0,b.U2)(p,[[r.length-1],i,[1]]);p.push((c={},c[e]=o.label,c[t]=g,c[i]=[0,g],c))}return p}function Bh(r,e,t,i){var o=H0(r,e,t,ch,i);return o.map(function(c,p){var g;return(0,b.Kn)(c)?(0,P.pi)((0,P.pi)({},c),(g={},g[e_]=c[ch][1],g[iy]=c[ch][1]-c[ch][0],g[G0]=p===r.length,g)):c})}function oT(r){var e=r.options,t=e.locale,i=e.total,o=u1(t).get(["waterfall","total"]);return i&&typeof i.label!="string"&&o&&(r.options.total.label=o),r}function Jd(r){var e=r.chart,t=r.options,i=t.data,o=t.xField,c=t.yField,p=t.total,g=t.leaderLine,_=t.columnWidthRatio,S=t.waterfallStyle,I=t.risingFill,L=t.fallingFill,F=t.color;e.data(Bh(i,o,c,p));var z=F||function(at){return(0,b.U2)(at,[G0])?(0,b.U2)(p,["style","fill"],""):(0,b.U2)(at,[ch,1])-(0,b.U2)(at,[ch,0])>0?I:L},V=pn({},r,{options:{xField:o,yField:ch,seriesField:o,rawFields:[c,iy,G0,ch],widthRatio:_,interval:{style:S,shape:"waterfall",color:z}}}),Q=pc(V).ext,st=Q.geometry;return st.customInfo({leaderLine:g}),r}function sT(r){var e,t,i=r.options,o=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.meta,S=pn({},{alias:g},(0,b.U2)(_,g));return za(So((e={},e[p]=o,e[g]=c,e[ch]=c,e),pn({},_,(t={},t[ch]=S,t[iy]=S,t[e_]=S,t))))(r)}function $b(r){var e=r.chart,t=r.options,i=t.xAxis,o=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),o===!1?(e.axis(p,!1),e.axis(ch,!1)):(e.axis(p,o),e.axis(ch,o)),r}function qb(r){var e=r.chart,t=r.options,i=t.legend,o=t.total,c=t.risingFill,p=t.fallingFill,g=t.locale,_=u1(g);if(i===!1)e.legend(!1);else{var S=[{name:_.get(["general","increase"]),value:"increase",marker:{symbol:"square",style:{r:5,fill:c}}},{name:_.get(["general","decrease"]),value:"decrease",marker:{symbol:"square",style:{r:5,fill:p}}}];o&&S.push({name:o.label||"",value:"total",marker:{symbol:"square",style:pn({},{r:5},(0,b.U2)(o,"style"))}}),e.legend(pn({},{custom:!0,position:"top",items:S},i)),e.removeInteraction("legend-filter")}return r}function TP(r){var e=r.chart,t=r.options,i=t.label,o=t.labelMode,c=t.xField,p=Ac(e,"interval");if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:o==="absolute"?[e_,c]:[iy,c],callback:g,cfg:Kl(_)})}return r}function uT(r){var e=r.chart,t=r.options,i=t.tooltip,o=t.xField,c=t.yField;if(i!==!1){e.tooltip((0,P.pi)({showCrosshairs:!1,showMarkers:!1,shared:!0,fields:[c]},i));var p=e.geometries[0];i!=null&&i.formatter?p.tooltip(o+"*"+c,i.formatter):p.tooltip(c)}else e.tooltip(!1);return r}function MP(r){return za(oT,Go,Jd,sT,$b,qb,uT,TP,I0,lu,ds,ms())(r)}var Kb=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="waterfall",t}return e.getDefaultOptions=function(){return r_},e.prototype.changeData=function(t){var i=this.options,o=i.xField,c=i.yField,p=i.total;this.updateOption({data:t}),this.chart.changeData(Bh(t,o,c,p))},e.prototype.getSchemaAdaptor=function(){return MP},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ka),ay="color",HF=pn({},Ka.getDefaultOptions(),{timeInterval:2e3,legend:!1,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!1,fields:["text","value",ay],formatter:function(r){return{name:r.text,value:r.value}}},wordStyle:{fontFamily:"Verdana",fontWeight:"normal",padding:1,fontSize:[12,60],rotation:[0,90],rotationSteps:2,rotateRatio:.5}}),lT={font:function(){return"serif"},padding:1,size:[500,500],spiral:"archimedean",timeInterval:3e3};function jF(r,e){return e=(0,b.f0)({},lT,e),IP(r,e)}function IP(r,e){var t=yT();["font","fontSize","fontWeight","padding","rotate","size","spiral","timeInterval","random"].forEach(function(_){(0,b.UM)(e[_])||t[_](e[_])}),t.words(r),e.imageMask&&t.createMask(e.imageMask);var i=t.start(),o=i._tags;o.forEach(function(_){_.x+=e.size[0]/2,_.y+=e.size[1]/2});var c=e.size,p=c[0],g=c[1];return o.push({text:"",value:0,x:0,y:0,opacity:0}),o.push({text:"",value:0,x:p,y:g,opacity:0}),o}var Qb=Math.PI/180,oy=1<<11>>5,n_=1<<11;function cT(r){return r.text}function fT(){return"serif"}function hT(){return"normal"}function kP(r){return r.value}function Jb(){return~~(Math.random()*2)*90}function LP(){return 1}function PP(r,e,t,i){if(!e.sprite){var o=r.context,c=r.ratio;o.clearRect(0,0,(oy<<5)/c,n_/c);var p=0,g=0,_=0,S=t.length;for(--i;++i<S;){e=t[i],o.save(),o.font=e.style+" "+e.weight+" "+~~((e.size+1)/c)+"px "+e.font;var I=o.measureText(e.text+"m").width*c,L=e.size<<1;if(e.rotate){var F=Math.sin(e.rotate*Qb),z=Math.cos(e.rotate*Qb),V=I*z,Q=I*F,st=L*z,at=L*F;I=Math.max(Math.abs(V+at),Math.abs(V-at))+31>>5<<5,L=~~Math.max(Math.abs(Q+st),Math.abs(Q-st))}else I=I+31>>5<<5;if(L>_&&(_=L),p+I>=oy<<5&&(p=0,g+=_,_=0),g+L>=n_)break;o.translate((p+(I>>1))/c,(g+(L>>1))/c),e.rotate&&o.rotate(e.rotate*Qb),o.fillText(e.text,0,0),e.padding&&(o.lineWidth=2*e.padding,o.strokeText(e.text,0,0)),o.restore(),e.width=I,e.height=L,e.xoff=p,e.yoff=g,e.x1=I>>1,e.y1=L>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=I}for(var Ft=o.getImageData(0,0,(oy<<5)/c,n_/c).data,Kt=[];--i>=0;)if(e=t[i],!!e.hasText){for(var I=e.width,ee=I>>5,L=e.y1-e.y0,Me=0;Me<L*ee;Me++)Kt[Me]=0;if(p=e.xoff,p==null)return;g=e.yoff;for(var hr=0,Tr=-1,Dr=0;Dr<L;Dr++){for(var Me=0;Me<I;Me++){var cn=ee*Dr+(Me>>5),Jr=Ft[(g+Dr)*(oy<<5)+(p+Me)<<2]?1<<31-Me%32:0;Kt[cn]|=Jr,hr|=Jr}hr?Tr=Dr:(e.y0++,L--,Dr--,g++)}e.y1=e.y0+Tr,e.sprite=Kt.slice(0,(e.y1-e.y0)*ee)}}}function OP(r,e,t){t>>=5;for(var i=r.sprite,o=r.width>>5,c=r.x-(o<<4),p=c&127,g=32-p,_=r.y1-r.y0,S=(r.y+r.y0)*t+(c>>5),I,L=0;L<_;L++){I=0;for(var F=0;F<=o;F++)if((I<<g|(F<o?(I=i[L*o+F])>>>p:0))&e[S+F])return!0;S+=t}return!1}function pT(r,e){var t=r[0],i=r[1];e.x+e.x0<t.x&&(t.x=e.x+e.x0),e.y+e.y0<t.y&&(t.y=e.y+e.y0),e.x+e.x1>i.x&&(i.x=e.x+e.x1),e.y+e.y1>i.y&&(i.y=e.y+e.y1)}function dT(r,e){return r.x+r.x1>e[0].x&&r.x+r.x0<e[1].x&&r.y+r.y1>e[0].y&&r.y+r.y0<e[1].y}function t2(r){var e=r[0]/r[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function vT(r){var e=4,t=e*r[0]/r[1],i=0,o=0;return function(c){var p=c<0?-1:1;switch(Math.sqrt(1+4*p*c)-p&3){case 0:i+=t;break;case 1:o+=e;break;case 2:i-=t;break;default:o-=e;break}return[i,o]}}function e2(r){for(var e=[],t=-1;++t<r;)e[t]=0;return e}function gT(){return document.createElement("canvas")}function df(r){return(0,b.mf)(r)?r:function(){return r}}var mT={archimedean:t2,rectangular:vT};function yT(){var r=[256,256],e=fT,t=kP,i=hT,o=Jb,c=LP,p=t2,g=Math.random,_=[],S=1/0,I=cT,L=hT,F=gT,z={};z.start=function(){var st=r[0],at=r[1],Ft=V(F()),Kt=z.board?z.board:e2((r[0]>>5)*r[1]),ee=_.length,Me=[],hr=_.map(function(Jr,Mn,mi){return Jr.text=I.call(this,Jr,Mn,mi),Jr.font=e.call(this,Jr,Mn,mi),Jr.style=L.call(this,Jr,Mn,mi),Jr.weight=i.call(this,Jr,Mn,mi),Jr.rotate=o.call(this,Jr,Mn,mi),Jr.size=~~t.call(this,Jr,Mn,mi),Jr.padding=c.call(this,Jr,Mn,mi),Jr}).sort(function(Jr,Mn){return Mn.size-Jr.size}),Tr=-1,Dr=z.board?[{x:0,y:0},{x:st,y:at}]:null;cn();function cn(){for(var Jr=Date.now();Date.now()-Jr<S&&++Tr<ee;){var Mn=hr[Tr];Mn.x=st*(g()+.5)>>1,Mn.y=at*(g()+.5)>>1,PP(Ft,Mn,hr,Tr),Mn.hasText&&Q(Kt,Mn,Dr)&&(Me.push(Mn),Dr?z.hasImage||pT(Dr,Mn):Dr=[{x:Mn.x+Mn.x0,y:Mn.y+Mn.y0},{x:Mn.x+Mn.x1,y:Mn.y+Mn.y1}],Mn.x-=r[0]>>1,Mn.y-=r[1]>>1)}z._tags=Me,z._bounds=Dr}return z};function V(st){st.width=st.height=1;var at=Math.sqrt(st.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1).data.length>>2);st.width=(oy<<5)/at,st.height=n_/at;var Ft=st.getContext("2d",{willReadFrequently:!0});return Ft.fillStyle=Ft.strokeStyle="red",Ft.textAlign="center",{context:Ft,ratio:at}}function Q(st,at,Ft){for(var Kt=at.x,ee=at.y,Me=Math.sqrt(r[0]*r[0]+r[1]*r[1]),hr=p(r),Tr=g()<.5?1:-1,Dr,cn=-Tr,Jr,Mn;(Dr=hr(cn+=Tr))&&(Jr=~~Dr[0],Mn=~~Dr[1],!(Math.min(Math.abs(Jr),Math.abs(Mn))>=Me));)if(at.x=Kt+Jr,at.y=ee+Mn,!(at.x+at.x0<0||at.y+at.y0<0||at.x+at.x1>r[0]||at.y+at.y1>r[1])&&(!Ft||!OP(at,st,r[0]))&&(!Ft||dT(at,Ft))){for(var mi=at.sprite,da=at.width>>5,Sa=r[0]>>5,eo=at.x-(da<<4),Gn=eo&127,Vi=32-Gn,ua=at.y1-at.y0,Xi=void 0,ea=(at.y+at.y0)*Sa+(eo>>5),ka=0;ka<ua;ka++){Xi=0;for(var xo=0;xo<=da;xo++)st[ea+xo]|=Xi<<Vi|(xo<da?(Xi=mi[ka*da+xo])>>>Gn:0);ea+=Sa}return delete at.sprite,!0}return!1}return z.createMask=function(st){var at=document.createElement("canvas"),Ft=r[0],Kt=r[1];if(!(!Ft||!Kt)){var ee=Ft>>5,Me=e2((Ft>>5)*Kt);at.width=Ft,at.height=Kt;var hr=at.getContext("2d");hr.drawImage(st,0,0,st.width,st.height,0,0,Ft,Kt);for(var Tr=hr.getImageData(0,0,Ft,Kt).data,Dr=0;Dr<Kt;Dr++)for(var cn=0;cn<Ft;cn++){var Jr=ee*Dr+(cn>>5),Mn=Dr*Ft+cn<<2,mi=Tr[Mn]>=250&&Tr[Mn+1]>=250&&Tr[Mn+2]>=250,da=mi?1<<31-cn%32:0;Me[Jr]|=da}z.board=Me,z.hasImage=!0}},z.timeInterval=function(st){S=st==null?1/0:st},z.words=function(st){_=st},z.size=function(st){r=[+st[0],+st[1]]},z.font=function(st){e=df(st)},z.fontWeight=function(st){i=df(st)},z.rotate=function(st){o=df(st)},z.spiral=function(st){p=mT[st]||st},z.fontSize=function(st){t=df(st)},z.padding=function(st){c=df(st)},z.random=function(st){g=df(st)},z}function r2(r){var e=r.options,t=r.chart,i=t,o=i.width,c=i.height,p=i.padding,g=i.appendPadding,_=i.ele,S=e.data,I=e.imageMask,L=e.wordField,F=e.weightField,z=e.colorField,V=e.wordStyle,Q=e.timeInterval,st=e.random,at=e.spiral,Ft=e.autoFit,Kt=Ft===void 0?!0:Ft,ee=e.placementStrategy;if(!S||!S.length)return[];var Me=V.fontFamily,hr=V.fontWeight,Tr=V.padding,Dr=V.fontSize,cn=bT(S,F),Jr=[n2(cn),i_(cn)],Mn=S.map(function(Sa){return{text:Sa[L],value:Sa[F],color:Sa[z],datum:Sa}}),mi={imageMask:I,font:Me,fontSize:RP(Dr,Jr),fontWeight:hr,size:_T({width:o,height:c,padding:p,appendPadding:g,autoFit:Kt,container:_}),padding:Tr,timeInterval:Q,random:st,spiral:at,rotate:DP(e)};if((0,b.mf)(ee)){var da=Mn.map(function(Sa,eo,Gn){return(0,P.pi)((0,P.pi)((0,P.pi)({},Sa),{hasText:!!Sa.text,font:df(mi.font)(Sa,eo,Gn),weight:df(mi.fontWeight)(Sa,eo,Gn),rotate:df(mi.rotate)(Sa,eo,Gn),size:df(mi.fontSize)(Sa,eo,Gn),style:"normal"}),ee.call(t,Sa,eo,Gn))});return da.push({text:"",value:0,x:0,y:0,opacity:0}),da.push({text:"",value:0,x:mi.size[0],y:mi.size[1],opacity:0}),da}return jF(Mn,mi)}function _T(r){var e=r.width,t=r.height,i=r.container,o=r.autoFit,c=r.padding,p=r.appendPadding;if(o){var g=xx(i);e=g.width,t=g.height}e=e||400,t=t||400;var _=FP({padding:c,appendPadding:p}),S=_[0],I=_[1],L=_[2],F=_[3],z=[e-(F+I),t-(S+L)];return z}function FP(r){var e=pp(r.padding),t=pp(r.appendPadding),i=e[0]+t[0],o=e[1]+t[1],c=e[2]+t[2],p=e[3]+t[3];return[i,o,c,p]}function xT(r){return new Promise(function(e,t){if(r instanceof HTMLImageElement){e(r);return}if((0,b.HD)(r)){var i=new Image;i.crossOrigin="anonymous",i.src=r,i.onload=function(){e(i)},i.onerror=function(){Hd(hp.ERROR,!1,"image %s load failed !!!",r),t()};return}Hd(hp.WARN,r===void 0,"The type of imageMask option must be String or HTMLImageElement."),t()})}function RP(r,e){if((0,b.mf)(r))return r;if((0,b.kJ)(r)){var t=r[0],i=r[1];if(!e)return function(){return(i+t)/2};var o=e[0],c=e[1];return c===o?function(){return(i+t)/2}:function(g){var _=g.value;return(i-t)/(c-o)*(_-o)+t}}return function(){return r}}function bT(r,e){return r.map(function(t){return t[e]}).filter(function(t){return typeof t=="number"&&!isNaN(t)})}function DP(r){var e=BP(r),t=e.rotation,i=e.rotationSteps;if(!(0,b.kJ)(t))return t;var o=t[0],c=t[1],p=i===1?0:(c-o)/(i-1);return function(){return c===o?c:Math.floor(Math.random()*i)*p}}function BP(r){var e=r.wordStyle.rotationSteps;return e<1&&(Hd(hp.WARN,!1,"The rotationSteps option must be greater than or equal to 1."),e=1),{rotation:r.wordStyle.rotation,rotationSteps:e}}function n2(r){return Math.min.apply(Math,r)}function i_(r){return Math.max.apply(Math,r)}function NP(r){var e=r.chart,t=r.options,i=t.colorField,o=t.color,c=r2(r);e.data(c);var p=pn({},r,{options:{xField:"x",yField:"y",seriesField:i&&ay,rawFields:(0,b.mf)(o)&&(0,P.pr)((0,b.U2)(t,"rawFields",[]),["datum"]),point:{color:o,shape:"word-cloud"}}}),g=Bf(p).ext;return g.geometry.label(!1),e.coordinate().reflect("y"),e.axis(!1),r}function zP(r){return za(So({x:{nice:!1},y:{nice:!1}}))(r)}function UP(r){var e=r.chart,t=r.options,i=t.legend,o=t.colorField;return i===!1?e.legend(!1):o&&e.legend(ay,i),r}function ZP(r){za(NP,zP,Ol,UP,lu,ds,Go,I0)(r)}_i("point","word-cloud",{draw:function(r,e){var t=r.x,i=r.y,o=e.addShape("text",{attrs:(0,P.pi)((0,P.pi)({},ET(r)),{x:t,y:i})}),c=r.data.rotate;return typeof c=="number"&&os.rotate(o,c*Math.PI/180),o}});function ET(r){return{fontSize:r.data.size,text:r.data.text,textAlign:"center",fontFamily:r.data.font,fontWeight:r.data.weight,fill:r.color||r.defaultStyle.stroke,textBaseline:"alphabetic"}}var VP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="word-cloud",t}return e.getDefaultOptions=function(){return HF},e.prototype.changeData=function(t){this.updateOption({data:t}),this.options.imageMask?this.render():this.chart.changeData(r2({chart:this.chart,options:this.options}))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.render=function(){var t=this;return new Promise(function(i){var o=t.options.imageMask;if(!o){r.prototype.render.call(t),i();return}var c=function(p){t.options=(0,P.pi)((0,P.pi)({},t.options),{imageMask:p||null}),r.prototype.render.call(t),i()};xT(o).then(c).catch(c)})},e.prototype.getSchemaAdaptor=function(){return ZP},e.prototype.triggerResize=function(){var t=this;this.chart.destroyed||(this.execAdaptor(),window.setTimeout(function(){r.prototype.triggerResize.call(t)}))},e}(Ka),WF=function(r){(0,P.ZT)(e,r);function e(t,i,o,c){var p=r.call(this,t,pn({},c,i))||this;return p.type="g2-plot",p.defaultOptions=c,p.adaptor=o,p}return e.prototype.getDefaultOptions=function(){return this.defaultOptions},e.prototype.getSchemaAdaptor=function(){return this.adaptor},e}(Ka),XF="2.4.25";z5("en-US",Co),z5("zh-CN",YO);var YF={scale:So,legend:jd,tooltip:Ol,annotation:ms,interaction:lu,theme:Go,animation:ds}},21934:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(dn){try{let et=function(){K||(K=!0,k())},be=function(){try{Et.documentElement.doScroll("left")}catch(ot){return void setTimeout(be,50)}et()};var J=et,pt=be,nt=(nt=document.getElementsByTagName("script"))[nt.length-1],Pt=nt.getAttribute("data-injectcss"),nt=nt.getAttribute("data-disable-injectsvg");if(!nt){var kt,mt,k,Et,K,yt=function(ut,zt){zt.parentNode.insertBefore(ut,zt)};if(Pt&&!dn.__iconfont__svg__cssinject__){dn.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(ot){console&&console.log(ot)}}kt=function(){var ut,zt=document.createElement("div");zt.innerHTML=dn._iconfont_svg_string_3580659,(zt=zt.getElementsByTagName("svg")[0])&&(zt.setAttribute("aria-hidden","true"),zt.style.position="absolute",zt.style.width=0,zt.style.height=0,zt.style.overflow="hidden",zt=zt,(ut=document.body).firstChild?yt(zt,ut.firstChild):ut.appendChild(zt))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(kt,0):(mt=function(){document.removeEventListener("DOMContentLoaded",mt,!1),kt()},document.addEventListener("DOMContentLoaded",mt,!1)):document.attachEvent&&(k=kt,Et=dn.document,K=!1,be(),Et.onreadystatechange=function(){Et.readyState=="complete"&&(Et.onreadystatechange=null,et())})}}catch(et){}}(window)},52789:function(dn,Pt){"use strict";var nt;nt={value:!0},nt=nt=Pt.Tf=Pt.Bc=Pt.jp=Pt.fL=Pt.O6=Pt.rC=void 0,Pt.rC="l7plot-legend l7plot-legend__category",Pt.O6="l7plot-legend__title",Pt.fL="l7plot-legend__category-list",Pt.jp="l7plot-legend__list-item",Pt.Bc="l7plot-legend__category-marker",Pt.Tf="l7plot-legend__category-value",nt='<div class="'.concat(Pt.rC,`">
  <div class="`).concat(Pt.O6,`"></div>
  <ul class="`).concat(Pt.fL,`"></ul>
</div>`),nt='<li class="'.concat(Pt.jp,`" data-index={index}>
  <span class="`).concat(Pt.Bc,`" style="background:{color}"></span>
  <span class="`).concat(Pt.Tf,`">{value}</span>
</li>`)},34996:function(dn,Pt){"use strict";var nt;nt={value:!0},nt=nt=Pt.VI=Pt.bl=Pt.el=Pt.I8=Pt.O6=Pt.rC=void 0,Pt.rC="l7plot-legend l7plot-legend__continue",Pt.O6="l7plot-legend__title",Pt.I8="l7plot-legend__ribbon-container",Pt.el="l7plot-legend__ribbon",Pt.bl="l7plot-legend__gradient-bar",Pt.VI="l7plot-legend__value-range",nt='<div class="'.concat(Pt.rC,`">
  <div class="`).concat(Pt.O6,`"></div>
  <div class="`).concat(Pt.I8,`"></div>
</div>`),nt='<div class="'.concat(Pt.el,`">
  <span class="`).concat(Pt.VI,`">{min}</span>
  <div class="`).concat(Pt.bl,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(Pt.VI,`">{max}</span>
</div>`)},84593:function(dn,Pt){"use strict";var nt;nt={value:!0},nt=nt=Pt.Tf=Pt.bX=Pt.jp=Pt.fL=Pt.O6=Pt.rC=void 0,Pt.rC="l7plot-tooltip",Pt.O6="l7plot-tooltip__title",Pt.fL="l7plot-tooltip__list",Pt.jp="l7plot-tooltip__list-item",Pt.bX="l7plot-tooltip__name",Pt.Tf="l7plot-tooltip__value",nt='<div class="'.concat(Pt.rC,`">
  <div class="`).concat(Pt.O6,`"></div>
  <ul class="`).concat(Pt.fL,`"></ul>
</div>`),nt='<li class="'.concat(Pt.jp,`" data-index={index}>
  <span class="`).concat(Pt.bX,`">{name}</span>
  <span class="`).concat(Pt.Tf,`">{value}</span>
</li>`)},32071:function(dn,Pt,nt){"use strict";nt.d(Pt,{Dg:function(){return et},lh:function(){return K},m$:function(){return k},vs:function(){return J},zu:function(){return Et}});var kt=nt(99250),mt=nt(1153);function k(ot,ut,zt){var P=[0,0,0,0,0,0,0,0,0];return kt.vc(P,zt),kt.Jp(ot,P,ut)}function Et(ot,ut,zt){var P=[0,0,0,0,0,0,0,0,0];return kt.Us(P,zt),kt.Jp(ot,P,ut)}function K(ot,ut,zt){var P=[0,0,0,0,0,0,0,0,0];return kt.xJ(P,zt),kt.Jp(ot,P,ut)}function yt(ot,ut,zt){return kt.Jp(ot,zt,ut)}function J(ot,ut){for(var zt=ot?[].concat(ot):[1,0,0,0,1,0,0,0,1],P=0,b=ut.length;P<b;P++){var W=ut[P];switch(W[0]){case"t":k(zt,zt,[W[1],W[2]]);break;case"s":K(zt,zt,[W[1],W[2]]);break;case"r":Et(zt,zt,W[1]);break;case"m":yt(zt,zt,W[1]);break;default:break}}return zt}function pt(ot,ut){return ot[0]*ut[1]-ut[0]*ot[1]}function et(ot,ut,zt){var P=mt.EU(ot,ut),b=pt(ot,ut)>=0;return zt?b?Math.PI*2-P:P:b?P:Math.PI*2-P}function be(ot,ut,zt){return zt?(ot[0]=ut[1],ot[1]=-1*ut[0]):(ot[0]=-1*ut[1],ot[1]=ut[0]),ot}},34357:function(dn,Pt,nt){"use strict";nt.d(Pt,{e9:function(){return et},Wq:function(){return tt},tr:function(){return W},wb:function(){return ke},zx:function(){return Wt}});var kt=nt(22374),mt=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,k=/[^\s\,]+/ig;function Et(vt){var Ht=vt||[];if((0,kt.kJ)(Ht))return Ht;if((0,kt.HD)(Ht))return Ht=Ht.match(mt),(0,kt.S6)(Ht,function(de,jt){if(de=de.match(k),de[0].length>1){var Ie=de[0].charAt(0);de.splice(1,0,de[0].substr(1)),de[0]=Ie}(0,kt.S6)(de,function(We,Ke){isNaN(We)||(de[Ke]=+We)}),Ht[jt]=de}),Ht}var K=Et,yt=nt(1153);function J(vt,Ht,de,jt){var Ie=[],We=!!jt,Ke,pr,lr,Nr,Pr,Gr,Sn;if(We){lr=jt[0],Nr=jt[1];for(var nn=0,Nn=vt.length;nn<Nn;nn+=1){var Zn=vt[nn];lr=yt.VV([0,0],lr,Zn),Nr=yt.Fp([0,0],Nr,Zn)}}for(var nn=0,Hn=vt.length;nn<Hn;nn+=1){var Zn=vt[nn];if(nn===0&&!de)Sn=Zn;else if(nn===Hn-1&&!de)Gr=Zn,Ie.push(Sn),Ie.push(Gr);else{var An=[nn?nn-1:Hn-1,nn-1][de?0:1];Ke=vt[An],pr=vt[de?(nn+1)%Hn:nn+1];var $n=[0,0];$n=yt.lu($n,pr,Ke),$n=yt.bA($n,$n,Ht);var Rt=yt.TE(Zn,Ke),Xt=yt.TE(Zn,pr),ae=Rt+Xt;ae!==0&&(Rt/=ae,Xt/=ae);var we=yt.bA([0,0],$n,-Rt),Ge=yt.bA([0,0],$n,Xt);Gr=yt.IH([0,0],Zn,we),Pr=yt.IH([0,0],Zn,Ge),Pr=yt.VV([0,0],Pr,yt.Fp([0,0],pr,Zn)),Pr=yt.Fp([0,0],Pr,yt.VV([0,0],pr,Zn)),we=yt.lu([0,0],Pr,Zn),we=yt.bA([0,0],we,-Rt/Xt),Gr=yt.IH([0,0],Zn,we),Gr=yt.VV([0,0],Gr,yt.Fp([0,0],Ke,Zn)),Gr=yt.Fp([0,0],Gr,yt.VV([0,0],Ke,Zn)),Ge=yt.lu([0,0],Zn,Gr),Ge=yt.bA([0,0],Ge,Xt/Rt),Pr=yt.IH([0,0],Zn,Ge),We&&(Gr=yt.Fp([0,0],Gr,lr),Gr=yt.VV([0,0],Gr,Nr),Pr=yt.Fp([0,0],Pr,lr),Pr=yt.VV([0,0],Pr,Nr)),Ie.push(Sn),Ie.push(Gr),Sn=Pr}}return de&&Ie.push(Ie.shift()),Ie}function pt(vt,Ht,de){Ht===void 0&&(Ht=!1),de===void 0&&(de=[[0,0],[1,1]]);for(var jt=!!Ht,Ie=[],We=0,Ke=vt.length;We<Ke;We+=2)Ie.push([vt[We],vt[We+1]]);for(var pr=J(Ie,.4,jt,de),lr=Ie.length,Nr=[],Pr,Gr,Sn,We=0;We<lr-1;We+=1)Pr=pr[We*2],Gr=pr[We*2+1],Sn=Ie[We+1],Nr.push(["C",Pr[0],Pr[1],Gr[0],Gr[1],Sn[0],Sn[1]]);return jt&&(Pr=pr[lr],Gr=pr[lr+1],Sn=Ie[0],Nr.push(["C",Pr[0],Pr[1],Gr[0],Gr[1],Sn[0],Sn[1]])),Nr}var et=pt;function be(vt,Ht,de){var jt=null,Ie=de;return Ht<Ie&&(Ie=Ht,jt="add"),vt<Ie&&(Ie=vt,jt="del"),{type:jt,min:Ie}}var ot=function(vt,Ht){var de=vt.length,jt=Ht.length,Ie,We,Ke=0;if(de===0||jt===0)return null;for(var pr=[],lr=0;lr<=de;lr++)pr[lr]=[],pr[lr][0]={min:lr};for(var Nr=0;Nr<=jt;Nr++)pr[0][Nr]={min:Nr};for(var lr=1;lr<=de;lr++){Ie=vt[lr-1];for(var Nr=1;Nr<=jt;Nr++){We=Ht[Nr-1],isEqual(Ie,We)?Ke=0:Ke=1;var Pr=pr[lr-1][Nr].min+1,Gr=pr[lr][Nr-1].min+1,Sn=pr[lr-1][Nr-1].min+Ke;pr[lr][Nr]=be(Pr,Gr,Sn)}}return pr};function ut(vt,Ht){var de=ot(vt,Ht),jt=vt.length,Ie=Ht.length,We=[],Ke=1,pr=1;if(de[jt][Ie]!==jt){for(var lr=1;lr<=jt;lr++){var Nr=de[lr][lr].min;pr=lr;for(var Pr=Ke;Pr<=Ie;Pr++)de[lr][Pr].min<Nr&&(Nr=de[lr][Pr].min,pr=Pr);Ke=pr,de[lr][Ke].type&&We.push({index:lr-1,type:de[lr][Ke].type})}for(var lr=We.length-1;lr>=0;lr--)Ke=We[lr].index,We[lr].type==="add"?vt.splice(Ke,0,[].concat(vt[Ke])):vt.splice(Ke,1)}if(jt=vt.length,jt<Ie)for(var lr=0;lr<Ie-jt;lr++)vt[jt-1][0]==="z"||vt[jt-1][0]==="Z"?vt.splice(jt-2,0,vt[jt-2]):vt.push(vt[jt-1]);return vt}var zt=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,P=new RegExp("([a-z])["+zt+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+zt+"]*,?["+zt+"]*)+)","ig"),b=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+zt+"]*,?["+zt+"]*","ig");function W(vt){if(!vt)return null;if((0,kt.kJ)(vt))return vt;var Ht={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},de=[];return String(vt).replace(P,function(jt,Ie,We){var Ke=[],pr=Ie.toLowerCase();if(We.replace(b,function(lr,Nr){Nr&&Ke.push(+Nr)}),pr==="m"&&Ke.length>2&&(de.push([Ie].concat(Ke.splice(0,2))),pr="l",Ie=Ie==="m"?"l":"L"),pr==="o"&&Ke.length===1&&de.push([Ie,Ke[0]]),pr==="r")de.push([Ie].concat(Ke));else for(;Ke.length>=Ht[pr]&&(de.push([Ie].concat(Ke.splice(0,Ht[pr]))),!!Ht[pr]););return""}),de}var le=/[a-z]/;function Ee(vt,Ht){return[Ht[0]+(Ht[0]-vt[0]),Ht[1]+(Ht[1]-vt[1])]}function ke(vt){var Ht=W(vt);if(!Ht||!Ht.length)return[["M",0,0]];for(var de=!1,jt=0;jt<Ht.length;jt++){var Ie=Ht[jt][0];if(le.test(Ie)||["V","H","T","S"].indexOf(Ie)>=0){de=!0;break}}if(!de)return Ht;var We=[],Ke=0,pr=0,lr=0,Nr=0,Pr=0,Gr,Sn,nn=Ht[0];(nn[0]==="M"||nn[0]==="m")&&(Ke=+nn[1],pr=+nn[2],lr=Ke,Nr=pr,Pr++,We[0]=["M",Ke,pr]);for(var jt=Pr,Nn=Ht.length;jt<Nn;jt++){var Zn=Ht[jt],Hn=We[jt-1],An=[],Ie=Zn[0],$n=Ie.toUpperCase();if(Ie!==$n)switch(An[0]=$n,$n){case"A":An[1]=Zn[1],An[2]=Zn[2],An[3]=Zn[3],An[4]=Zn[4],An[5]=Zn[5],An[6]=+Zn[6]+Ke,An[7]=+Zn[7]+pr;break;case"V":An[1]=+Zn[1]+pr;break;case"H":An[1]=+Zn[1]+Ke;break;case"M":lr=+Zn[1]+Ke,Nr=+Zn[2]+pr,An[1]=lr,An[2]=Nr;break;default:for(var Rt=1,Xt=Zn.length;Rt<Xt;Rt++)An[Rt]=+Zn[Rt]+(Rt%2?Ke:pr)}else An=Ht[jt];switch($n){case"Z":Ke=+lr,pr=+Nr;break;case"H":Ke=An[1],An=["L",Ke,pr];break;case"V":pr=An[1],An=["L",Ke,pr];break;case"T":Ke=An[1],pr=An[2];var ae=Ee([Hn[1],Hn[2]],[Hn[3],Hn[4]]);An=["Q",ae[0],ae[1],Ke,pr];break;case"S":Ke=An[An.length-2],pr=An[An.length-1];var we=Hn.length,Ge=Ee([Hn[we-4],Hn[we-3]],[Hn[we-2],Hn[we-1]]);An=["C",Ge[0],Ge[1],An[1],An[2],Ke,pr];break;case"M":lr=An[An.length-2],Nr=An[An.length-1];break;default:Ke=An[An.length-2],pr=An[An.length-1]}We.push(An)}return We}var Tt=Math.PI*2,rt=function(vt,Ht,de,jt,Ie,We,Ke){var pr=vt.x,lr=vt.y;pr*=Ht,lr*=de;var Nr=jt*pr-Ie*lr,Pr=Ie*pr+jt*lr;return{x:Nr+We,y:Pr+Ke}},Dt=function(vt,Ht){var de=Ht===1.5707963267948966?.551915024494:Ht===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(Ht/4),jt=Math.cos(vt),Ie=Math.sin(vt),We=Math.cos(vt+Ht),Ke=Math.sin(vt+Ht);return[{x:jt-Ie*de,y:Ie+jt*de},{x:We+Ke*de,y:Ke-We*de},{x:We,y:Ke}]},Se=function(vt,Ht,de,jt){var Ie=vt*jt-Ht*de<0?-1:1,We=vt*de+Ht*jt;return We>1&&(We=1),We<-1&&(We=-1),Ie*Math.acos(We)},_e=function(vt,Ht,de,jt,Ie,We,Ke,pr,lr,Nr,Pr,Gr){var Sn=Math.pow(Ie,2),nn=Math.pow(We,2),Nn=Math.pow(Pr,2),Zn=Math.pow(Gr,2),Hn=Sn*nn-Sn*Zn-nn*Nn;Hn<0&&(Hn=0),Hn/=Sn*Zn+nn*Nn,Hn=Math.sqrt(Hn)*(Ke===pr?-1:1);var An=Hn*Ie/We*Gr,$n=Hn*-We/Ie*Pr,Rt=Nr*An-lr*$n+(vt+de)/2,Xt=lr*An+Nr*$n+(Ht+jt)/2,ae=(Pr-An)/Ie,we=(Gr-$n)/We,Ge=(-Pr-An)/Ie,cr=(-Gr-$n)/We,br=Se(1,0,ae,we),Ce=Se(ae,we,Ge,cr);return pr===0&&Ce>0&&(Ce-=Tt),pr===1&&Ce<0&&(Ce+=Tt),[Rt,Xt,br,Ce]},ve=function(vt){var Ht=vt.px,de=vt.py,jt=vt.cx,Ie=vt.cy,We=vt.rx,Ke=vt.ry,pr=vt.xAxisRotation,lr=pr===void 0?0:pr,Nr=vt.largeArcFlag,Pr=Nr===void 0?0:Nr,Gr=vt.sweepFlag,Sn=Gr===void 0?0:Gr,nn=[];if(We===0||Ke===0)return[{x1:0,y1:0,x2:0,y2:0,x:jt,y:Ie}];var Nn=Math.sin(lr*Tt/360),Zn=Math.cos(lr*Tt/360),Hn=Zn*(Ht-jt)/2+Nn*(de-Ie)/2,An=-Nn*(Ht-jt)/2+Zn*(de-Ie)/2;if(Hn===0&&An===0)return[{x1:0,y1:0,x2:0,y2:0,x:jt,y:Ie}];We=Math.abs(We),Ke=Math.abs(Ke);var $n=Math.pow(Hn,2)/Math.pow(We,2)+Math.pow(An,2)/Math.pow(Ke,2);$n>1&&(We*=Math.sqrt($n),Ke*=Math.sqrt($n));var Rt=_e(Ht,de,jt,Ie,We,Ke,Pr,Sn,Nn,Zn,Hn,An),Xt=Rt[0],ae=Rt[1],we=Rt[2],Ge=Rt[3],cr=Math.abs(Ge)/(Tt/4);Math.abs(1-cr)<1e-7&&(cr=1);var br=Math.max(Math.ceil(cr),1);Ge/=br;for(var Ce=0;Ce<br;Ce++)nn.push(Dt(we,Ge)),we+=Ge;return nn.map(function(ar){var Hr=rt(ar[0],We,Ke,Zn,Nn,Xt,ae),Tn=Hr.x,Kr=Hr.y,an=rt(ar[1],We,Ke,Zn,Nn,Xt,ae),Pn=an.x,xi=an.y,Ci=rt(ar[2],We,Ke,Zn,Nn,Xt,ae),Qr=Ci.x,Kn=Ci.y;return{x1:Tn,y1:Kr,x2:Pn,y2:xi,x:Qr,y:Kn}})};function ne(vt,Ht,de,jt,Ie,We,Ke,pr,lr){var Nr=ve({px:vt,py:Ht,cx:pr,cy:lr,rx:de,ry:jt,xAxisRotation:Ie,largeArcFlag:We,sweepFlag:Ke});return Nr.reduce(function(Pr,Gr){var Sn=Gr.x1,nn=Gr.y1,Nn=Gr.x2,Zn=Gr.y2,Hn=Gr.x,An=Gr.y;return Pr.push(Sn,nn,Nn,Zn,Hn,An),Pr},[])}function xe(vt,Ht){"TQ".indexOf(vt[0])<0&&(Ht.qx=null,Ht.qy=null);var de=vt.slice(1),jt=de[0],Ie=de[1];switch(vt[0]){case"M":return Ht.x=jt,Ht.y=Ie,vt;case"A":return["C"].concat(arcToCubic.apply(0,[Ht.x1,Ht.y1].concat(vt.slice(1))));case"Q":return Ht.qx=jt,Ht.qy=Ie,["C"].concat(quadToCubic.apply(0,[Ht.x1,Ht.y1].concat(vt.slice(1))));case"L":return["C"].concat(lineToCubic(Ht.x1,Ht.y1,vt[1],vt[2]));case"H":return["C"].concat(lineToCubic(Ht.x1,Ht.y1,vt[1],Ht.y1));case"V":return["C"].concat(lineToCubic(Ht.x1,Ht.y1,Ht.x1,vt[1]));case"Z":return["C"].concat(lineToCubic(Ht.x1,Ht.y1,Ht.x,Ht.y));default:}return vt}function Je(vt,Ht){Ht===void 0&&(Ht=!1);for(var de=path2Absolute(vt),jt={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},Ie=[],We="",Ke=de.length,pr,lr,Nr=[],Pr=0;Pr<Ke;Pr+=1)de[Pr]&&(We=de[Pr][0]),Ie[Pr]=We,de[Pr]=segmentToCubic(de[Pr],jt),Ot(de,Ie,Pr),Ke=de.length,We==="Z"&&Nr.push(Pr),pr=de[Pr],lr=pr.length,jt.x1=+pr[lr-2],jt.y1=+pr[lr-1],jt.x2=+pr[lr-4]||jt.x1,jt.y2=+pr[lr-3]||jt.y1;return Ht?[de,Nr]:de}function Ot(vt,Ht,de){if(vt[de].length>7){vt[de].shift();for(var jt=vt[de],Ie=de;jt.length;)Ht[de]="A",vt.splice(Ie+=1,0,["C"].concat(jt.splice(0,6)));vt.splice(de,1)}}var te=function(vt,Ht,de,jt,Ie){var We=-3*Ht+9*de-9*jt+3*Ie,Ke=vt*We+6*Ht-12*de+6*jt;return vt*Ke-3*Ht+3*de},ft=function(vt,Ht,de,jt,Ie,We,Ke,pr,lr){lr===null&&(lr=1),lr=lr>1?1:lr<0?0:lr;for(var Nr=lr/2,Pr=12,Gr=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],Sn=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],nn=0,Nn=0;Nn<Pr;Nn++){var Zn=Nr*Gr[Nn]+Nr,Hn=te(Zn,vt,de,Ie,Ke),An=te(Zn,Ht,jt,We,pr),$n=Hn*Hn+An*An;nn+=Sn[Nn]*Math.sqrt($n)}return Nr*nn},wt=function(vt,Ht,de,jt,Ie,We,Ke,pr){for(var lr=[],Nr=[[],[]],Pr,Gr,Sn,nn,Nn=0;Nn<2;++Nn){if(Nn===0?(Gr=6*vt-12*de+6*Ie,Pr=-3*vt+9*de-9*Ie+3*Ke,Sn=3*de-3*vt):(Gr=6*Ht-12*jt+6*We,Pr=-3*Ht+9*jt-9*We+3*pr,Sn=3*jt-3*Ht),Math.abs(Pr)<1e-12){if(Math.abs(Gr)<1e-12)continue;nn=-Sn/Gr,nn>0&&nn<1&&lr.push(nn);continue}var Zn=Gr*Gr-4*Sn*Pr,Hn=Math.sqrt(Zn);if(!(Zn<0)){var An=(-Gr+Hn)/(2*Pr);An>0&&An<1&&lr.push(An);var $n=(-Gr-Hn)/(2*Pr);$n>0&&$n<1&&lr.push($n)}}for(var Rt=lr.length,Xt=Rt,ae;Rt--;)nn=lr[Rt],ae=1-nn,Nr[0][Rt]=ae*ae*ae*vt+3*ae*ae*nn*de+3*ae*nn*nn*Ie+nn*nn*nn*Ke,Nr[1][Rt]=ae*ae*ae*Ht+3*ae*ae*nn*jt+3*ae*nn*nn*We+nn*nn*nn*pr;return Nr[0][Xt]=vt,Nr[1][Xt]=Ht,Nr[0][Xt+1]=Ke,Nr[1][Xt+1]=pr,Nr[0].length=Nr[1].length=Xt+2,{min:{x:Math.min.apply(0,Nr[0]),y:Math.min.apply(0,Nr[1])},max:{x:Math.max.apply(0,Nr[0]),y:Math.max.apply(0,Nr[1])}}},Y=function(vt,Ht,de,jt,Ie,We,Ke,pr){if(!(Math.max(vt,de)<Math.min(Ie,Ke)||Math.min(vt,de)>Math.max(Ie,Ke)||Math.max(Ht,jt)<Math.min(We,pr)||Math.min(Ht,jt)>Math.max(We,pr))){var lr=(vt*jt-Ht*de)*(Ie-Ke)-(vt-de)*(Ie*pr-We*Ke),Nr=(vt*jt-Ht*de)*(We-pr)-(Ht-jt)*(Ie*pr-We*Ke),Pr=(vt-de)*(We-pr)-(Ht-jt)*(Ie-Ke);if(Pr){var Gr=lr/Pr,Sn=Nr/Pr,nn=+Gr.toFixed(2),Nn=+Sn.toFixed(2);if(!(nn<+Math.min(vt,de).toFixed(2)||nn>+Math.max(vt,de).toFixed(2)||nn<+Math.min(Ie,Ke).toFixed(2)||nn>+Math.max(Ie,Ke).toFixed(2)||Nn<+Math.min(Ht,jt).toFixed(2)||Nn>+Math.max(Ht,jt).toFixed(2)||Nn<+Math.min(We,pr).toFixed(2)||Nn>+Math.max(We,pr).toFixed(2)))return{x:Gr,y:Sn}}}},gt=function(vt,Ht,de){return Ht>=vt.x&&Ht<=vt.x+vt.width&&de>=vt.y&&de<=vt.y+vt.height},he=function(vt,Ht,de,jt){return vt===null&&(vt=Ht=de=jt=0),Ht===null&&(Ht=vt.y,de=vt.width,jt=vt.height,vt=vt.x),{x:vt,y:Ht,width:de,w:de,height:jt,h:jt,x2:vt+de,y2:Ht+jt,cx:vt+de/2,cy:Ht+jt/2,r1:Math.min(de,jt)/2,r2:Math.max(de,jt)/2,r0:Math.sqrt(de*de+jt*jt)/2,path:rectPath(vt,Ht,de,jt),vb:[vt,Ht,de,jt].join(" ")}},Oe=function(vt,Ht){return vt=he(vt),Ht=he(Ht),gt(Ht,vt.x,vt.y)||gt(Ht,vt.x2,vt.y)||gt(Ht,vt.x,vt.y2)||gt(Ht,vt.x2,vt.y2)||gt(vt,Ht.x,Ht.y)||gt(vt,Ht.x2,Ht.y)||gt(vt,Ht.x,Ht.y2)||gt(vt,Ht.x2,Ht.y2)||(vt.x<Ht.x2&&vt.x>Ht.x||Ht.x<vt.x2&&Ht.x>vt.x)&&(vt.y<Ht.y2&&vt.y>Ht.y||Ht.y<vt.y2&&Ht.y>vt.y)},Le=function(vt,Ht,de,jt,Ie,We,Ke,pr){isArray(vt)||(vt=[vt,Ht,de,jt,Ie,We,Ke,pr]);var lr=wt.apply(null,vt);return he(lr.min.x,lr.min.y,lr.max.x-lr.min.x,lr.max.y-lr.min.y)},Ve=function(vt,Ht,de,jt,Ie,We,Ke,pr,lr){var Nr=1-lr,Pr=Math.pow(Nr,3),Gr=Math.pow(Nr,2),Sn=lr*lr,nn=Sn*lr,Nn=Pr*vt+Gr*3*lr*de+Nr*3*lr*lr*Ie+nn*Ke,Zn=Pr*Ht+Gr*3*lr*jt+Nr*3*lr*lr*We+nn*pr,Hn=vt+2*lr*(de-vt)+Sn*(Ie-2*de+vt),An=Ht+2*lr*(jt-Ht)+Sn*(We-2*jt+Ht),$n=de+2*lr*(Ie-de)+Sn*(Ke-2*Ie+de),Rt=jt+2*lr*(We-jt)+Sn*(pr-2*We+jt),Xt=Nr*vt+lr*de,ae=Nr*Ht+lr*jt,we=Nr*Ie+lr*Ke,Ge=Nr*We+lr*pr,cr=90-Math.atan2(Hn-$n,An-Rt)*180/Math.PI;return{x:Nn,y:Zn,m:{x:Hn,y:An},n:{x:$n,y:Rt},start:{x:Xt,y:ae},end:{x:we,y:Ge},alpha:cr}},Bt=function(vt,Ht,de){var jt=Le(vt),Ie=Le(Ht);if(!Oe(jt,Ie))return de?0:[];for(var We=ft.apply(0,vt),Ke=ft.apply(0,Ht),pr=~~(We/8),lr=~~(Ke/8),Nr=[],Pr=[],Gr={},Sn=de?0:[],nn=0;nn<pr+1;nn++){var Nn=Ve.apply(0,vt.concat(nn/pr));Nr.push({x:Nn.x,y:Nn.y,t:nn/pr})}for(var nn=0;nn<lr+1;nn++){var Nn=Ve.apply(0,Ht.concat(nn/lr));Pr.push({x:Nn.x,y:Nn.y,t:nn/lr})}for(var nn=0;nn<pr;nn++)for(var Zn=0;Zn<lr;Zn++){var Hn=Nr[nn],An=Nr[nn+1],$n=Pr[Zn],Rt=Pr[Zn+1],Xt=Math.abs(An.x-Hn.x)<.001?"y":"x",ae=Math.abs(Rt.x-$n.x)<.001?"y":"x",we=Y(Hn.x,Hn.y,An.x,An.y,$n.x,$n.y,Rt.x,Rt.y);if(we){if(Gr[we.x.toFixed(4)]===we.y.toFixed(4))continue;Gr[we.x.toFixed(4)]=we.y.toFixed(4);var Ge=Hn.t+Math.abs((we[Xt]-Hn[Xt])/(An[Xt]-Hn[Xt]))*(An.t-Hn.t),cr=$n.t+Math.abs((we[ae]-$n[ae])/(Rt[ae]-$n[ae]))*(Rt.t-$n.t);Ge>=0&&Ge<=1&&cr>=0&&cr<=1&&(de?Sn++:Sn.push({x:we.x,y:we.y,t1:Ge,t2:cr}))}}return Sn},re=function(vt,Ht,de){vt=path2Curve(vt),Ht=path2Curve(Ht);for(var jt,Ie,We,Ke,pr,lr,Nr,Pr,Gr,Sn,nn=de?0:[],Nn=0,Zn=vt.length;Nn<Zn;Nn++){var Hn=vt[Nn];if(Hn[0]==="M")jt=pr=Hn[1],Ie=lr=Hn[2];else{Hn[0]==="C"?(Gr=[jt,Ie].concat(Hn.slice(1)),jt=Gr[6],Ie=Gr[7]):(Gr=[jt,Ie,jt,Ie,pr,lr,pr,lr],jt=pr,Ie=lr);for(var An=0,$n=Ht.length;An<$n;An++){var Rt=Ht[An];if(Rt[0]==="M")We=Nr=Rt[1],Ke=Pr=Rt[2];else{Rt[0]==="C"?(Sn=[We,Ke].concat(Rt.slice(1)),We=Sn[6],Ke=Sn[7]):(Sn=[We,Ke,We,Ke,Nr,Pr,Nr,Pr],We=Nr,Ke=Pr);var Xt=Bt(Gr,Sn,de);if(de)nn+=Xt;else{for(var ae=0,we=Xt.length;ae<we;ae++)Xt[ae].segment1=Nn,Xt[ae].segment2=An,Xt[ae].bez1=Gr,Xt[ae].bez2=Sn;nn=nn.concat(Xt)}}}}}return nn};function ye(vt,Ht){return re(vt,Ht)}function Yt(vt){return Math.sqrt(vt[0]*vt[0]+vt[1]*vt[1])}function qe(vt,Ht){return Yt(vt)*Yt(Ht)?(vt[0]*Ht[0]+vt[1]*Ht[1])/(Yt(vt)*Yt(Ht)):1}function vr(vt,Ht){return(vt[0]*Ht[1]<vt[1]*Ht[0]?-1:1)*Math.acos(qe(vt,Ht))}function oe(vt,Ht){return vt[0]===Ht[0]&&vt[1]===Ht[1]}function qt(vt,Ht){var de=Ht[1],jt=Ht[2],Ie=(0,kt.wQ)((0,kt.c$)(Ht[3]),Math.PI*2),We=Ht[4],Ke=Ht[5],pr=vt[0],lr=vt[1],Nr=Ht[6],Pr=Ht[7],Gr=Math.cos(Ie)*(pr-Nr)/2+Math.sin(Ie)*(lr-Pr)/2,Sn=-1*Math.sin(Ie)*(pr-Nr)/2+Math.cos(Ie)*(lr-Pr)/2,nn=Gr*Gr/(de*de)+Sn*Sn/(jt*jt);nn>1&&(de*=Math.sqrt(nn),jt*=Math.sqrt(nn));var Nn=de*de*(Sn*Sn)+jt*jt*(Gr*Gr),Zn=Nn?Math.sqrt((de*de*(jt*jt)-Nn)/Nn):1;We===Ke&&(Zn*=-1),isNaN(Zn)&&(Zn=0);var Hn=jt?Zn*de*Sn/jt:0,An=de?Zn*-jt*Gr/de:0,$n=(pr+Nr)/2+Math.cos(Ie)*Hn-Math.sin(Ie)*An,Rt=(lr+Pr)/2+Math.sin(Ie)*Hn+Math.cos(Ie)*An,Xt=[(Gr-Hn)/de,(Sn-An)/jt],ae=[(-1*Gr-Hn)/de,(-1*Sn-An)/jt],we=vr([1,0],Xt),Ge=vr(Xt,ae);return qe(Xt,ae)<=-1&&(Ge=Math.PI),qe(Xt,ae)>=1&&(Ge=0),Ke===0&&Ge>0&&(Ge=Ge-2*Math.PI),Ke===1&&Ge<0&&(Ge=Ge+2*Math.PI),{cx:$n,cy:Rt,rx:oe(vt,[Nr,Pr])?0:de,ry:oe(vt,[Nr,Pr])?0:jt,startAngle:we,endAngle:we+Ge,xRotation:Ie,arcFlag:We,sweepFlag:Ke}}function bt(vt,Ht){return[Ht[0]+(Ht[0]-vt[0]),Ht[1]+(Ht[1]-vt[1])]}function Wt(vt){vt=K(vt);for(var Ht=[],de=null,jt=null,Ie=null,We=0,Ke=vt.length,pr=0;pr<Ke;pr++){var lr=vt[pr];jt=vt[pr+1];var Nr=lr[0],Pr={command:Nr,prePoint:de,params:lr,startTangent:null,endTangent:null};switch(Nr){case"M":Ie=[lr[1],lr[2]],We=pr;break;case"A":var Gr=qt(de,lr);Pr.arcParams=Gr;break;default:break}if(Nr==="Z")de=Ie,jt=vt[We+1];else{var Sn=lr.length;de=[lr[Sn-2],lr[Sn-1]]}jt&&jt[0]==="Z"&&(jt=vt[We],Ht[We]&&(Ht[We].prePoint=de)),Pr.currentPoint=de,Ht[We]&&oe(de,Ht[We].currentPoint)&&(Ht[We].prePoint=Pr.prePoint);var nn=jt?[jt[jt.length-2],jt[jt.length-1]]:null;Pr.nextPoint=nn;var Nn=Pr.prePoint;if(["L","H","V"].includes(Nr))Pr.startTangent=[Nn[0]-de[0],Nn[1]-de[1]],Pr.endTangent=[de[0]-Nn[0],de[1]-Nn[1]];else if(Nr==="Q"){var Zn=[lr[1],lr[2]];Pr.startTangent=[Nn[0]-Zn[0],Nn[1]-Zn[1]],Pr.endTangent=[de[0]-Zn[0],de[1]-Zn[1]]}else if(Nr==="T"){var Hn=Ht[pr-1],Zn=bt(Hn.currentPoint,Nn);Hn.command==="Q"?(Pr.command="Q",Pr.startTangent=[Nn[0]-Zn[0],Nn[1]-Zn[1]],Pr.endTangent=[de[0]-Zn[0],de[1]-Zn[1]]):(Pr.command="TL",Pr.startTangent=[Nn[0]-de[0],Nn[1]-de[1]],Pr.endTangent=[de[0]-Nn[0],de[1]-Nn[1]])}else if(Nr==="C"){var An=[lr[1],lr[2]],$n=[lr[3],lr[4]];Pr.startTangent=[Nn[0]-An[0],Nn[1]-An[1]],Pr.endTangent=[de[0]-$n[0],de[1]-$n[1]],Pr.startTangent[0]===0&&Pr.startTangent[1]===0&&(Pr.startTangent=[An[0]-$n[0],An[1]-$n[1]]),Pr.endTangent[0]===0&&Pr.endTangent[1]===0&&(Pr.endTangent=[$n[0]-An[0],$n[1]-An[1]])}else if(Nr==="S"){var Hn=Ht[pr-1],An=bt(Hn.currentPoint,Nn),$n=[lr[1],lr[2]];Hn.command==="C"?(Pr.command="C",Pr.startTangent=[Nn[0]-An[0],Nn[1]-An[1]],Pr.endTangent=[de[0]-$n[0],de[1]-$n[1]]):(Pr.command="SQ",Pr.startTangent=[Nn[0]-$n[0],Nn[1]-$n[1]],Pr.endTangent=[de[0]-$n[0],de[1]-$n[1]])}else if(Nr==="A"){var Rt=.001,Xt=Pr.arcParams||{},ae=Xt.cx,we=ae===void 0?0:ae,Ge=Xt.cy,cr=Ge===void 0?0:Ge,br=Xt.rx,Ce=br===void 0?0:br,ar=Xt.ry,Hr=ar===void 0?0:ar,Tn=Xt.sweepFlag,Kr=Tn===void 0?0:Tn,an=Xt.startAngle,Pn=an===void 0?0:an,xi=Xt.endAngle,Ci=xi===void 0?0:xi;Kr===0&&(Rt*=-1);var Qr=Ce*Math.cos(Pn-Rt)+we,Kn=Hr*Math.sin(Pn-Rt)+cr;Pr.startTangent=[Qr-Ie[0],Kn-Ie[1]];var ai=Ce*Math.cos(Pn+Ci+Rt)+we,fi=Hr*Math.sin(Pn+Ci-Rt)+cr;Pr.endTangent=[Nn[0]-ai,Nn[1]-fi]}Ht.push(Pr)}return Ht}var $t=1e-6;function xt(vt){return Math.abs(vt)<$t?0:vt<0?-1:1}function St(vt,Ht,de){return(de[0]-vt[0])*(Ht[1]-vt[1])===(Ht[0]-vt[0])*(de[1]-vt[1])&&Math.min(vt[0],Ht[0])<=de[0]&&de[0]<=Math.max(vt[0],Ht[0])&&Math.min(vt[1],Ht[1])<=de[1]&&de[1]<=Math.max(vt[1],Ht[1])}function ue(vt,Ht,de){var jt=!1,Ie=vt.length;if(Ie<=2)return!1;for(var We=0;We<Ie;We++){var Ke=vt[We],pr=vt[(We+1)%Ie];if(St(Ke,pr,[Ht,de]))return!0;xt(Ke[1]-de)>0!=xt(pr[1]-de)>0&&xt(Ht-(de-Ke[1])*(Ke[0]-pr[0])/(Ke[1]-pr[1])-Ke[0])<0&&(jt=!jt)}return jt}var Pe=function(vt,Ht,de){return vt>=Ht&&vt<=de};function ze(vt,Ht,de,jt){var Ie=.001,We={x:de.x-vt.x,y:de.y-vt.y},Ke={x:Ht.x-vt.x,y:Ht.y-vt.y},pr={x:jt.x-de.x,y:jt.y-de.y},lr=Ke.x*pr.y-Ke.y*pr.x,Nr=lr*lr,Pr=Ke.x*Ke.x+Ke.y*Ke.y,Gr=pr.x*pr.x+pr.y*pr.y,Sn=null;if(Nr>Ie*Pr*Gr){var nn=(We.x*pr.y-We.y*pr.x)/lr,Nn=(We.x*Ke.y-We.y*Ke.x)/lr;Pe(nn,0,1)&&Pe(Nn,0,1)&&(Sn={x:vt.x+nn*Ke.x,y:vt.y+nn*Ke.y})}return Sn}function Vt(vt){for(var Ht=[],de=vt.length,jt=0;jt<de-1;jt++){var Ie=vt[jt],We=vt[jt+1];Ht.push({from:{x:Ie[0],y:Ie[1]},to:{x:We[0],y:We[1]}})}if(Ht.length>1){var Ke=vt[0],pr=vt[de-1];Ht.push({from:{x:pr[0],y:pr[1]},to:{x:Ke[0],y:Ke[1]}})}return Ht}function Ct(vt,Ht){var de=!1;return(0,kt.S6)(vt,function(jt){if(ze(jt.from,jt.to,Ht.from,Ht.to))return de=!0,!1}),de}function At(vt){var Ht=vt.map(function(jt){return jt[0]}),de=vt.map(function(jt){return jt[1]});return{minX:Math.min.apply(null,Ht),maxX:Math.max.apply(null,Ht),minY:Math.min.apply(null,de),maxY:Math.max.apply(null,de)}}function Nt(vt,Ht){return!(Ht.minX>vt.maxX||Ht.maxX<vt.minX||Ht.minY>vt.maxY||Ht.maxY<vt.minY)}function tt(vt,Ht){if(vt.length<2||Ht.length<2)return!1;var de=At(vt),jt=At(Ht);if(!Nt(de,jt))return!1;var Ie=!1;if((0,kt.S6)(Ht,function(lr){if(ue(vt,lr[0],lr[1]))return Ie=!0,!1}),Ie||((0,kt.S6)(vt,function(lr){if(ue(Ht,lr[0],lr[1]))return Ie=!0,!1}),Ie))return!0;var We=Vt(vt),Ke=Vt(Ht),pr=!1;return(0,kt.S6)(Ke,function(lr){if(Ct(We,lr))return pr=!0,!1}),pr}},22374:function(dn,Pt,nt){"use strict";nt.d(Pt,{Ct:function(){return js},f0:function(){return zr},uZ:function(){return Rt},VS:function(){return Js},d9:function(){return _u},FX:function(){return Et},Ds:function(){return Bu},b$:function(){return jc},e5:function(){return pt},S6:function(){return Ee},yW:function(){return We},hX:function(){return yt},sE:function(){return Je},cx:function(){return te},Wx:function(){return wt},ri:function(){return ae},xH:function(){return gt},U5:function(){return vo},U2:function(){return Cn},Lo:function(){return kc},rx:function(){return re},ru:function(){return Sn},vM:function(){return Pr},Ms:function(){return Gr},wH:function(){return Xa},YM:function(){return Nt},q9:function(){return Et},cq:function(){return pl},kJ:function(){return b},jn:function(){return Ho},J_:function(){return Zo},kK:function(){return $o},xb:function(){return Xc},Xy:function(){return X},mf:function(){return ut},BD:function(){return Dt},UM:function(){return P},Ft:function(){return $u},hj:function(){return Ge},vQ:function(){return xi},Kn:function(){return W},PO:function(){return ne},HD:function(){return Pe},P9:function(){return ot},o8:function(){return ja},XP:function(){return Tt},Z$:function(){return tt},vl:function(){return ge},UI:function(){return Jt},Q8:function(){return yr},Fp:function(){return Le},UT:function(){return fi},HP:function(){return xl},VV:function(){return Ve},F:function(){return oa},CD:function(){return zr},wQ:function(){return Ca},ZT:function(){return bu},CE:function(){return xa},ei:function(){return Ma},u4:function(){return xt},Od:function(){return ue},U7:function(){return qo},t8:function(){return Vn},dp:function(){return bl},G:function(){return pr},MR:function(){return Vt},ng:function(){return Ir},P2:function(){return lo},qo:function(){return Ro},c$:function(){return Uo},BB:function(){return _o},jj:function(){return Ct},EL:function(){return fa},jC:function(){return On},VO:function(){return Du},I:function(){return At}});var kt=function(ce){return ce!==null&&typeof ce!="function"&&isFinite(ce.length)},mt=kt,k=function(ce,or){return mt(ce)?ce.indexOf(or)>-1:!1},Et=k,K=function(ce,or){if(!mt(ce))return ce;for(var Fr=[],Xr=0;Xr<ce.length;Xr++){var xn=ce[Xr];or(xn,Xr)&&Fr.push(xn)}return Fr},yt=K,J=function(ce,or){return or===void 0&&(or=[]),yt(ce,function(Fr){return!Et(or,Fr)})},pt=J,et={}.toString,be=function(ce,or){return et.call(ce)==="[object "+or+"]"},ot=be,ut=function(ce){return ot(ce,"Function")},zt=function(ce){return ce==null},P=zt,b=function(ce){return Array.isArray?Array.isArray(ce):ot(ce,"Array")},W=function(ce){var or=typeof ce;return ce!==null&&or==="object"||or==="function"};function le(ce,or){if(ce){var Fr;if(b(ce))for(var Xr=0,xn=ce.length;Xr<xn&&(Fr=or(ce[Xr],Xr),Fr!==!1);Xr++);else if(W(ce)){for(var Ii in ce)if(ce.hasOwnProperty(Ii)&&(Fr=or(ce[Ii],Ii),Fr===!1))break}}}var Ee=le,ke=Object.keys?function(ce){return Object.keys(ce)}:function(ce){var or=[];return Ee(ce,function(Fr,Xr){ut(ce)&&Xr==="prototype"||or.push(Xr)}),or},Tt=ke;function rt(ce,or){var Fr=Tt(or),Xr=Fr.length;if(P(ce))return!Xr;for(var xn=0;xn<Xr;xn+=1){var Ii=Fr[xn];if(or[Ii]!==ce[Ii]||!(Ii in ce))return!1}return!0}var Dt=rt,Se=function(ce){return typeof ce=="object"&&ce!==null},_e=Se,ve=function(ce){if(!_e(ce)||!ot(ce,"Object"))return!1;if(Object.getPrototypeOf(ce)===null)return!0;for(var or=ce;Object.getPrototypeOf(or)!==null;)or=Object.getPrototypeOf(or);return Object.getPrototypeOf(ce)===or},ne=ve;function xe(ce,or){if(!b(ce))return null;var Fr;if(ut(or)&&(Fr=or),ne(or)&&(Fr=function(xn){return Dt(xn,or)}),Fr){for(var Xr=0;Xr<ce.length;Xr+=1)if(Fr(ce[Xr]))return ce[Xr]}return null}var Je=xe;function Ot(ce,or,Fr){Fr===void 0&&(Fr=0);for(var Xr=Fr;Xr<ce.length;Xr++)if(or(ce[Xr],Xr))return Xr;return-1}var te=Ot,ft=function(ce,or){for(var Fr=null,Xr=0;Xr<ce.length;Xr++){var xn=ce[Xr],Ii=xn[or];if(!P(Ii)){b(Ii)?Fr=Ii[0]:Fr=Ii;break}}return Fr},wt=ft,Y=function(ce){if(!b(ce))return[];for(var or=[],Fr=0;Fr<ce.length;Fr++)or=or.concat(ce[Fr]);return or},gt=Y,he=function(ce,or){if(or===void 0&&(or=[]),!isArray(ce))or.push(ce);else for(var Fr=0;Fr<ce.length;Fr+=1)he(ce[Fr],or);return or},Oe=null,Le=function(ce){if(b(ce))return ce.reduce(function(or,Fr){return Math.max(or,Fr)},ce[0])},Ve=function(ce){if(b(ce))return ce.reduce(function(or,Fr){return Math.min(or,Fr)},ce[0])},Bt=function(ce){var or=ce.filter(function(ra){return!isNaN(ra)});if(!or.length)return{min:0,max:0};if(b(ce[0])){for(var Fr=[],Xr=0;Xr<ce.length;Xr++)Fr=Fr.concat(ce[Xr]);or=Fr}var xn=Le(or),Ii=Ve(or);return{min:Ii,max:xn}},re=Bt,ye=Array.prototype,Yt=ye.splice,qe=ye.indexOf,vr=function(ce){for(var or=[],Fr=1;Fr<arguments.length;Fr++)or[Fr-1]=arguments[Fr];for(var Xr=0;Xr<or.length;Xr++)for(var xn=or[Xr],Ii=-1;(Ii=qe.call(ce,xn))>-1;)Yt.call(ce,Ii,1);return ce},oe=null,qt=Array.prototype.splice,bt=function(or,Fr){if(!mt(or))return[];for(var Xr=or?Fr.length:0,xn=Xr-1;Xr--;){var Ii=void 0,ra=Fr[Xr];(Xr===xn||ra!==Ii)&&(Ii=ra,qt.call(or,ra,1))}return or},Wt=bt,$t=function(ce,or,Fr){if(!b(ce)&&!ne(ce))return ce;var Xr=Fr;return Ee(ce,function(xn,Ii){Xr=or(Xr,xn,Ii)}),Xr},xt=$t,St=function(ce,or){var Fr=[];if(!mt(ce))return Fr;for(var Xr=-1,xn=[],Ii=ce.length;++Xr<Ii;){var ra=ce[Xr];or(ra,Xr,ce)&&(Fr.push(ra),xn.push(Xr))}return Wt(ce,xn),Fr},ue=St,Pe=function(ce){return ot(ce,"String")};function ze(ce,or){var Fr;if(ut(or))Fr=function(xn,Ii){return or(xn)-or(Ii)};else{var Xr=[];Pe(or)?Xr.push(or):b(or)&&(Xr=or),Fr=function(xn,Ii){for(var ra=0;ra<Xr.length;ra+=1){var Wa=Xr[ra];if(xn[Wa]>Ii[Wa])return 1;if(xn[Wa]<Ii[Wa])return-1}return 0}}return ce.sort(Fr),ce}var Vt=ze;function Ct(ce,or){or===void 0&&(or=new Map);var Fr=[];if(Array.isArray(ce))for(var Xr=0,xn=ce.length;Xr<xn;Xr++){var Ii=ce[Xr];or.has(Ii)||(Fr.push(Ii),or.set(Ii,!0))}return Fr}var At=function(ce,or){for(var Fr=[],Xr={},xn=0;xn<ce.length;xn++){var Ii=ce[xn],ra=Ii[or];if(!P(ra)){b(ra)||(ra=[ra]);for(var Wa=0;Wa<ra.length;Wa++){var Eu=ra[Wa];Xr[Eu]||(Fr.push(Eu),Xr[Eu]=!0)}}}return Fr};function Nt(ce){if(mt(ce))return ce[0]}function tt(ce){if(mt(ce)){var or=ce;return or[or.length-1]}}function vt(ce,or){return isArray(ce)||isString(ce)?ce[0]===or:!1}var Ht=null;function de(ce,or){return isArray(ce)||isString(ce)?ce[ce.length-1]===or:!1}var jt=null,Ie=function(ce,or){for(var Fr=0;Fr<ce.length;Fr++)if(!or(ce[Fr],Fr))return!1;return!0},We=Ie,Ke=function(ce,or){for(var Fr=0;Fr<ce.length;Fr++)if(or(ce[Fr],Fr))return!0;return!1},pr=Ke,lr=Object.prototype.hasOwnProperty;function Nr(ce,or){if(!or||!b(ce))return{};for(var Fr={},Xr=ut(or)?or:function(Wa){return Wa[or]},xn,Ii=0;Ii<ce.length;Ii++){var ra=ce[Ii];xn=Xr(ra),lr.call(Fr,xn)?Fr[xn].push(ra):Fr[xn]=[ra]}return Fr}var Pr=Nr;function Gr(ce,or){if(!or)return{0:ce};if(!ut(or)){var Fr=b(or)?or:or.replace(/\s+/g,"").split("*");or=function(Xr){for(var xn="_",Ii=0,ra=Fr.length;Ii<ra;Ii++)xn+=Xr[Fr[Ii]]&&Xr[Fr[Ii]].toString();return xn}}return Pr(ce,or)}var Sn=function(ce,or){if(!or)return[ce];var Fr=Gr(ce,or),Xr=[];for(var xn in Fr)Xr.push(Fr[xn]);return Xr},nn={};function Nn(ce){var or=nn[ce];if(!or){for(var Fr=ce.toString(16),Xr=Fr.length;Xr<6;Xr++)Fr="0"+Fr;or="#"+Fr,nn[ce]=or}return or}var Zn=null;function Hn(ce){var or=0,Fr=0,Xr=0,xn=0;return isArray(ce)?ce.length===1?or=Fr=Xr=xn=ce[0]:ce.length===2?(or=Xr=ce[0],Fr=xn=ce[1]):ce.length===3?(or=ce[0],Fr=xn=ce[1],Xr=ce[2]):(or=ce[0],Fr=ce[1],Xr=ce[2],xn=ce[3]):or=Fr=Xr=xn=ce,{r1:or,r2:Fr,r3:Xr,r4:xn}}var An=null,$n=function(ce,or,Fr){return ce<or?or:ce>Fr?Fr:ce},Rt=$n,Xt=function(ce,or){var Fr=or.toString(),Xr=Fr.indexOf(".");if(Xr===-1)return Math.round(ce);var xn=Fr.substr(Xr+1).length;return xn>20&&(xn=20),parseFloat(ce.toFixed(xn))},ae=Xt,we=function(ce){return ot(ce,"Number")},Ge=we,cr=function(ce){return isNumber(ce)&&ce%1!==0},br=null,Ce=function(ce){return isNumber(ce)&&ce%2===0},ar=null,Hr=Number.isInteger?Number.isInteger:function(ce){return Ge(ce)&&ce%1===0},Tn=null,Kr=function(ce){return isNumber(ce)&&ce<0},an=null,Pn=1e-5;function xi(ce,or,Fr){return Fr===void 0&&(Fr=Pn),Math.abs(ce-or)<Fr}var Ci=function(ce){return isNumber(ce)&&ce%2!==0},Qr=null,Kn=function(ce){return isNumber(ce)&&ce>0},ai=null,fi=function(ce,or){if(b(ce)){for(var Fr,Xr=-1/0,xn=0;xn<ce.length;xn++){var Ii=ce[xn],ra=ut(or)?or(Ii):Ii[or];ra>Xr&&(Fr=Ii,Xr=ra)}return Fr}},oa=function(ce,or){if(b(ce)){for(var Fr,Xr=1/0,xn=0;xn<ce.length;xn++){var Ii=ce[xn],ra=ut(or)?or(Ii):Ii[or];ra<Xr&&(Fr=Ii,Xr=ra)}return Fr}},Ai=function(ce,or){return(ce%or+or)%or},Ca=Ai,po=180/Math.PI,La=function(ce){return po*ce},Va=null,_a=parseInt,ma=Math.PI/180,Qa=function(ce){return ma*ce},Uo=Qa,vo=Ee,Ua=function(ce,or){return ce.hasOwnProperty(or)},Xa=Ua,Oo=Object.values?function(ce){return Object.values(ce)}:function(ce){var or=[];return Ee(ce,function(Fr,Xr){ut(ce)&&Xr==="prototype"||or.push(Fr)}),or},Du=Oo,Yo=function(ce,or){return contains(values(ce),or)},_o=function(ce){return P(ce)?"":ce.toString()},ir=function(ce){return _o(ce).toLowerCase()},ge=ir;function He(ce,or){return!ce||!or?ce:ce.replace(/\\?\{([^{}]+)\}/g,function(Fr,Xr){return Fr.charAt(0)==="\\"?Fr.slice(1):or[Xr]===void 0?"":or[Xr]})}var Ir=He,en=function(ce){var or=_o(ce);return or.charAt(0).toUpperCase()+or.substring(1)},On=en,zn={}.toString,kn=function(ce){return zn.call(ce).replace(/^\[object /,"").replace(/]$/,"")},qi=kn,Oa=function(ce){return isType(ce,"Arguments")},us=null,Ao=function(ce){return ot(ce,"Boolean")},Ho=Ao,uo=function(ce){return ot(ce,"Date")},Zo=uo,Qs=function(ce){return isType(ce,"Error")},jo=null;function _l(ce){return isNumber(ce)&&isFinite(ce)}var Hc=function(ce){return ce===null},$u=Hc,Ae=Object.prototype,Xe=function(ce){var or=ce&&ce.constructor,Fr=typeof or=="function"&&or.prototype||Ae;return ce===Fr},Cr=Xe,sn=function(ce){return isType(ce,"RegExp")},si=null,Pi=function(ce){return ce===void 0},ja=Pi,vs=function(ce){return ce instanceof Element||ce instanceof HTMLDocument},$o=vs;function qo(ce){var or=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Fr){return setTimeout(Fr,16)};return or(ce)}function Js(ce){var or=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;or(ce)}var qu=function(){for(var ce=[],or=0;or<arguments.length;or++)ce[or]=arguments[or];for(var Fr=ce[0],Xr=1;Xr<ce.length;Xr++){var xn=ce[Xr];isFunction(xn)&&(xn=xn.prototype),mix(Fr.prototype,xn)}},yu=null,Zs=function(ce){if(typeof ce!="object"||ce===null)return ce;var or;if(b(ce)){or=[];for(var Fr=0,Xr=ce.length;Fr<Xr;Fr++)typeof ce[Fr]=="object"&&ce[Fr]!=null?or[Fr]=Zs(ce[Fr]):or[Fr]=ce[Fr]}else{or={};for(var xn in ce)typeof ce[xn]=="object"&&ce[xn]!=null?or[xn]=Zs(ce[xn]):or[xn]=ce[xn]}return or},_u=Zs;function Ku(ce,or,Fr){var Xr;return function(){var xn=this,Ii=arguments,ra=function(){Xr=null,Fr||ce.apply(xn,Ii)},Wa=Fr&&!Xr;clearTimeout(Xr),Xr=setTimeout(ra,or),Wa&&ce.apply(xn,Ii)}}var Bu=Ku,xl=function(ce,or){if(!ut(ce))throw new TypeError("Expected a function");var Fr=function(){for(var Xr=[],xn=0;xn<arguments.length;xn++)Xr[xn]=arguments[xn];var Ii=or?or.apply(this,Xr):Xr[0],ra=Fr.cache;if(ra.has(Ii))return ra.get(Ii);var Wa=ce.apply(this,Xr);return ra.set(Ii,Wa),Wa};return Fr.cache=new Map,Fr},Nu=5;function Fo(ce,or,Fr,Xr){Fr=Fr||0,Xr=Xr||Nu;for(var xn in or)if(or.hasOwnProperty(xn)){var Ii=or[xn];Ii!==null&&ne(Ii)?(ne(ce[xn])||(ce[xn]={}),Fr<Xr?Fo(ce[xn],Ii,Fr+1,Xr):ce[xn]=or[xn]):b(Ii)?(ce[xn]=[],ce[xn]=ce[xn].concat(Ii)):Ii!==void 0&&(ce[xn]=Ii)}}var Ts=function(ce){for(var or=[],Fr=1;Fr<arguments.length;Fr++)or[Fr-1]=arguments[Fr];for(var Xr=0;Xr<or.length;Xr+=1)Fo(ce,or[Xr]);return ce},jc=Ts,Wc=function(ce,or,Fr,Xr){isFunction(or)||(Fr=or,or=ce,ce=function(){});var xn=Object.create?function(ra,Wa){return Object.create(ra,{constructor:{value:Wa}})}:function(ra,Wa){function Eu(){}Eu.prototype=ra;var Ws=new Eu;return Ws.constructor=Wa,Ws},Ii=xn(or.prototype,ce);return ce.prototype=mix(Ii,ce.prototype),ce.superclass=xn(or.prototype,or),mix(Ii,Fr),mix(ce,Xr),ce},xu=null,Ms=function(ce,or){if(!mt(ce))return-1;var Fr=Array.prototype.indexOf;if(Fr)return Fr.call(ce,or);for(var Xr=-1,xn=0;xn<ce.length;xn++)if(ce[xn]===or){Xr=xn;break}return Xr},pl=Ms,Ga=Object.prototype.hasOwnProperty;function zu(ce){if(P(ce))return!0;if(mt(ce))return!ce.length;var or=qi(ce);if(or==="Map"||or==="Set")return!ce.size;if(Cr(ce))return!Object.keys(ce).length;for(var Fr in ce)if(Ga.call(ce,Fr))return!1;return!0}var Xc=zu,D=function(ce,or){if(ce===or)return!0;if(!ce||!or||Pe(ce)||Pe(or))return!1;if(mt(ce)||mt(or)){if(ce.length!==or.length)return!1;for(var Fr=!0,Xr=0;Xr<ce.length&&(Fr=D(ce[Xr],or[Xr]),!!Fr);Xr++);return Fr}if(_e(ce)||_e(or)){var xn=Object.keys(ce),Ii=Object.keys(or);if(xn.length!==Ii.length)return!1;for(var Fr=!0,Xr=0;Xr<xn.length&&(Fr=D(ce[xn[Xr]],or[xn[Xr]]),!!Fr);Xr++);return Fr}return!1},X=D,Mt=function(ce,or,Fr){return isFunction(Fr)?!!Fr(ce,or):isEqual(ce,or)},it=function(ce,or){if(!mt(ce))return ce;for(var Fr=[],Xr=0;Xr<ce.length;Xr++){var xn=ce[Xr];Fr.push(or(xn,Xr))}return Fr},Jt=it,Ue=function(ce){return ce},yr=function(ce,or){or===void 0&&(or=Ue);var Fr={};return W(ce)&&!P(ce)&&Object.keys(ce).forEach(function(Xr){Fr[Xr]=or(ce[Xr],Xr)}),Fr};function Br(ce,or){for(var Fr in or)or.hasOwnProperty(Fr)&&Fr!=="constructor"&&or[Fr]!==void 0&&(ce[Fr]=or[Fr])}function zr(ce,or,Fr,Xr){return or&&Br(ce,or),Fr&&Br(ce,Fr),Xr&&Br(ce,Xr),ce}var Cn=function(ce,or,Fr){for(var Xr=0,xn=Pe(or)?or.split("."):or;ce&&Xr<xn.length;)ce=ce[xn[Xr++]];return ce===void 0||Xr<xn.length?Fr:ce},Vn=function(ce,or,Fr){var Xr=ce,xn=Pe(or)?or.split("."):or;return xn.forEach(function(Ii,ra){ra<xn.length-1?(W(Xr[Ii])||(Xr[Ii]=Ge(xn[ra+1])?[]:{}),Xr=Xr[Ii]):Xr[Ii]=Fr}),ce},Ki=Object.prototype.hasOwnProperty,Ma=function(ce,or){if(ce===null||!ne(ce))return{};var Fr={};return Ee(or,function(Xr){Ki.call(ce,Xr)&&(Fr[Xr]=ce[Xr])}),Fr},xa=function(ce,or){return xt(ce,function(Fr,Xr,xn){return or.includes(xn)||(Fr[xn]=Xr),Fr},{})},lo=function(ce,or,Fr){var Xr,xn,Ii,ra,Wa=0;Fr||(Fr={});var Eu=function(){Wa=Fr.leading===!1?0:Date.now(),Xr=null,ra=ce.apply(xn,Ii),Xr||(xn=Ii=null)},Ws=function(){var Ya=Date.now();!Wa&&Fr.leading===!1&&(Wa=Ya);var Jl=or-(Ya-Wa);return xn=this,Ii=arguments,Jl<=0||Jl>or?(Xr&&(clearTimeout(Xr),Xr=null),Wa=Ya,ra=ce.apply(xn,Ii),Xr||(xn=Ii=null)):!Xr&&Fr.trailing!==!1&&(Xr=setTimeout(Eu,Jl)),ra};return Ws.cancel=function(){clearTimeout(Xr),Wa=0,Xr=xn=Ii=null},Ws},Ro=function(ce){return mt(ce)?Array.prototype.slice.call(ce):[]},Io={},fa=function(ce){return ce=ce||"g",Io[ce]?Io[ce]+=1:Io[ce]=1,ce+Io[ce]},bu=function(){};function bl(ce){return P(ce)?0:mt(ce)?ce.length:Object.keys(ce).length}var Ic=nt(29268),Yc,Fl=xl(function(ce,or){or===void 0&&(or={});var Fr=or.fontSize,Xr=or.fontFamily,xn=or.fontWeight,Ii=or.fontStyle,ra=or.fontVariant;return Yc||(Yc=document.createElement("canvas").getContext("2d")),Yc.font=[Ii,ra,xn,Fr+"px",Xr].join(" "),Yc.measureText(Pe(ce)?ce:"").width},function(ce,or){return or===void 0&&(or={}),(0,Ic.pr)([ce],Du(or)).join("")}),kc=function(ce,or,Fr,Xr){Xr===void 0&&(Xr="...");var xn=16,Ii=Fl(Xr,Fr),ra=Pe(ce)?ce:_o(ce),Wa=or,Eu=[],Ws,Ya;if(Fl(ce,Fr)<=or)return ce;for(;Ws=ra.substr(0,xn),Ya=Fl(Ws,Fr),!(Ya+Ii>Wa&&Ya>Wa);)if(Eu.push(Ws),Wa-=Ya,ra=ra.substr(xn),!ra)return Eu.join("");for(;Ws=ra.substr(0,1),Ya=Fl(Ws,Fr),!(Ya+Ii>Wa);)if(Eu.push(Ws),Wa-=Ya,ra=ra.substr(1),!ra)return Eu.join("");return""+Eu.join("")+Xr},Uu=function(){function ce(){this.map={}}return ce.prototype.has=function(or){return this.map[or]!==void 0},ce.prototype.get=function(or,Fr){var Xr=this.map[or];return Xr===void 0?Fr:Xr},ce.prototype.set=function(or,Fr){this.map[or]=Fr},ce.prototype.clear=function(){this.map={}},ce.prototype.delete=function(or){delete this.map[or]},ce.prototype.size=function(){return Object.keys(this.map).length},ce}(),js=Uu},70309:function(dn){dn.exports=Pt;function Pt(mt,k){var Et=mt&&mt.type,K;if(Et==="FeatureCollection")for(K=0;K<mt.features.length;K++)Pt(mt.features[K],k);else if(Et==="GeometryCollection")for(K=0;K<mt.geometries.length;K++)Pt(mt.geometries[K],k);else if(Et==="Feature")Pt(mt.geometry,k);else if(Et==="Polygon")nt(mt.coordinates,k);else if(Et==="MultiPolygon")for(K=0;K<mt.coordinates.length;K++)nt(mt.coordinates[K],k);return mt}function nt(mt,k){if(mt.length!==0){kt(mt[0],k);for(var Et=1;Et<mt.length;Et++)kt(mt[Et],!k)}}function kt(mt,k){for(var Et=0,K=0,yt=0,J=mt.length,pt=J-1;yt<J;pt=yt++){var et=(mt[yt][0]-mt[pt][0])*(mt[pt][1]+mt[yt][1]),be=Et+et;K+=Math.abs(Et)>=Math.abs(et)?Et-be+et:et-be+Et,Et=be}Et+K>=0!=!!k&&mt.reverse()}},56834:function(dn){"use strict";dn.exports=Pt;function Pt(nt,kt){this.x=nt,this.y=kt}Pt.prototype={clone:function(){return new Pt(this.x,this.y)},add:function(nt){return this.clone()._add(nt)},sub:function(nt){return this.clone()._sub(nt)},multByPoint:function(nt){return this.clone()._multByPoint(nt)},divByPoint:function(nt){return this.clone()._divByPoint(nt)},mult:function(nt){return this.clone()._mult(nt)},div:function(nt){return this.clone()._div(nt)},rotate:function(nt){return this.clone()._rotate(nt)},rotateAround:function(nt,kt){return this.clone()._rotateAround(nt,kt)},matMult:function(nt){return this.clone()._matMult(nt)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(nt){return this.x===nt.x&&this.y===nt.y},dist:function(nt){return Math.sqrt(this.distSqr(nt))},distSqr:function(nt){var kt=nt.x-this.x,mt=nt.y-this.y;return kt*kt+mt*mt},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(nt){return Math.atan2(this.y-nt.y,this.x-nt.x)},angleWith:function(nt){return this.angleWithSep(nt.x,nt.y)},angleWithSep:function(nt,kt){return Math.atan2(this.x*kt-this.y*nt,this.x*nt+this.y*kt)},_matMult:function(nt){var kt=nt[0]*this.x+nt[1]*this.y,mt=nt[2]*this.x+nt[3]*this.y;return this.x=kt,this.y=mt,this},_add:function(nt){return this.x+=nt.x,this.y+=nt.y,this},_sub:function(nt){return this.x-=nt.x,this.y-=nt.y,this},_mult:function(nt){return this.x*=nt,this.y*=nt,this},_div:function(nt){return this.x/=nt,this.y/=nt,this},_multByPoint:function(nt){return this.x*=nt.x,this.y*=nt.y,this},_divByPoint:function(nt){return this.x/=nt.x,this.y/=nt.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var nt=this.y;return this.y=this.x,this.x=-nt,this},_rotate:function(nt){var kt=Math.cos(nt),mt=Math.sin(nt),k=kt*this.x-mt*this.y,Et=mt*this.x+kt*this.y;return this.x=k,this.y=Et,this},_rotateAround:function(nt,kt){var mt=Math.cos(nt),k=Math.sin(nt),Et=kt.x+mt*(this.x-kt.x)-k*(this.y-kt.y),K=kt.y+k*(this.x-kt.x)+mt*(this.y-kt.y);return this.x=Et,this.y=K,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Pt.convert=function(nt){return nt instanceof Pt?nt:Array.isArray(nt)?new Pt(nt[0],nt[1]):nt}},85143:function(dn,Pt,nt){dn.exports.VectorTile=nt(7317),nt(26305),nt(65336)},7317:function(dn,Pt,nt){"use strict";var kt=nt(65336);dn.exports=mt;function mt(Et,K){this.layers=Et.readFields(k,{},K)}function k(Et,K,yt){if(Et===3){var J=new kt(yt,yt.readVarint()+yt.pos);J.length&&(K[J.name]=J)}}},26305:function(dn,Pt,nt){"use strict";var kt=nt(56834);dn.exports=mt;function mt(J,pt,et,be,ot){this.properties={},this.extent=et,this.type=0,this._pbf=J,this._geometry=-1,this._keys=be,this._values=ot,J.readFields(k,this,pt)}function k(J,pt,et){J==1?pt.id=et.readVarint():J==2?Et(et,pt):J==3?pt.type=et.readVarint():J==4&&(pt._geometry=et.pos)}function Et(J,pt){for(var et=J.readVarint()+J.pos;J.pos<et;){var be=pt._keys[J.readVarint()],ot=pt._values[J.readVarint()];pt.properties[be]=ot}}mt.types=["Unknown","Point","LineString","Polygon"],mt.prototype.loadGeometry=function(){var J=this._pbf;J.pos=this._geometry;for(var pt=J.readVarint()+J.pos,et=1,be=0,ot=0,ut=0,zt=[],P;J.pos<pt;){if(be<=0){var b=J.readVarint();et=b&7,be=b>>3}if(be--,et===1||et===2)ot+=J.readSVarint(),ut+=J.readSVarint(),et===1&&(P&&zt.push(P),P=[]),P.push(new kt(ot,ut));else if(et===7)P&&P.push(P[0].clone());else throw new Error("unknown command "+et)}return P&&zt.push(P),zt},mt.prototype.bbox=function(){var J=this._pbf;J.pos=this._geometry;for(var pt=J.readVarint()+J.pos,et=1,be=0,ot=0,ut=0,zt=1/0,P=-1/0,b=1/0,W=-1/0;J.pos<pt;){if(be<=0){var le=J.readVarint();et=le&7,be=le>>3}if(be--,et===1||et===2)ot+=J.readSVarint(),ut+=J.readSVarint(),ot<zt&&(zt=ot),ot>P&&(P=ot),ut<b&&(b=ut),ut>W&&(W=ut);else if(et!==7)throw new Error("unknown command "+et)}return[zt,b,P,W]},mt.prototype.toGeoJSON=function(J,pt,et){var be=this.extent*Math.pow(2,et),ot=this.extent*J,ut=this.extent*pt,zt=this.loadGeometry(),P=mt.types[this.type],b,W;function le(Tt){for(var rt=0;rt<Tt.length;rt++){var Dt=Tt[rt],Se=180-(Dt.y+ut)*360/be;Tt[rt]=[(Dt.x+ot)*360/be-180,360/Math.PI*Math.atan(Math.exp(Se*Math.PI/180))-90]}}switch(this.type){case 1:var Ee=[];for(b=0;b<zt.length;b++)Ee[b]=zt[b][0];zt=Ee,le(zt);break;case 2:for(b=0;b<zt.length;b++)le(zt[b]);break;case 3:for(zt=K(zt),b=0;b<zt.length;b++)for(W=0;W<zt[b].length;W++)le(zt[b][W]);break}zt.length===1?zt=zt[0]:P="Multi"+P;var ke={type:"Feature",geometry:{type:P,coordinates:zt},properties:this.properties};return"id"in this&&(ke.id=this.id),ke};function K(J){var pt=J.length;if(pt<=1)return[J];for(var et=[],be,ot,ut=0;ut<pt;ut++){var zt=yt(J[ut]);zt!==0&&(ot===void 0&&(ot=zt<0),ot===zt<0?(be&&et.push(be),be=[J[ut]]):be.push(J[ut]))}return be&&et.push(be),et}function yt(J){for(var pt=0,et=0,be=J.length,ot=be-1,ut,zt;et<be;ot=et++)ut=J[et],zt=J[ot],pt+=(zt.x-ut.x)*(ut.y+zt.y);return pt}},65336:function(dn,Pt,nt){"use strict";var kt=nt(26305);dn.exports=mt;function mt(K,yt){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=K,this._keys=[],this._values=[],this._features=[],K.readFields(k,this,yt),this.length=this._features.length}function k(K,yt,J){K===15?yt.version=J.readVarint():K===1?yt.name=J.readString():K===5?yt.extent=J.readVarint():K===2?yt._features.push(J.pos):K===3?yt._keys.push(J.readString()):K===4&&yt._values.push(Et(J))}function Et(K){for(var yt=null,J=K.readVarint()+K.pos;K.pos<J;){var pt=K.readVarint()>>3;yt=pt===1?K.readString():pt===2?K.readFloat():pt===3?K.readDouble():pt===4?K.readVarint64():pt===5?K.readVarint():pt===6?K.readSVarint():pt===7?K.readBoolean():null}return yt}mt.prototype.feature=function(K){if(K<0||K>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[K];var yt=this._pbf.readVarint()+this._pbf.pos;return new kt(this._pbf,yt,this.extent,this._keys,this._values)}},44334:function(dn,Pt){(function(nt,kt){kt(Pt)})(this,function(nt){"use strict";function kt(xe,Je){return mt(xe)||k(xe,Je)||Et()}function mt(xe){if(Array.isArray(xe))return xe}function k(xe,Je){var Ot=[],te=!0,ft=!1,wt=void 0;try{for(var Y=xe[Symbol.iterator](),gt;!(te=(gt=Y.next()).done)&&(Ot.push(gt.value),!(Je&&Ot.length===Je));te=!0);}catch(he){ft=!0,wt=he}finally{try{!te&&Y.return!=null&&Y.return()}finally{if(ft)throw wt}}return Ot}function Et(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function K(xe,Je,Ot,te){xe=xe.filter(function(ye,Yt){var qe=Je(ye,Yt),vr=Ot(ye,Yt);return qe!=null&&isFinite(qe)&&vr!=null&&isFinite(vr)}),te&&xe.sort(function(ye,Yt){return Je(ye)-Je(Yt)});for(var ft=xe.length,wt=new Float64Array(ft),Y=new Float64Array(ft),gt=0,he=0,Oe,Le,Ve,Bt=0;Bt<ft;)Ve=xe[Bt],wt[Bt]=Oe=+Je(Ve,Bt,xe),Y[Bt]=Le=+Ot(Ve,Bt,xe),++Bt,gt+=(Oe-gt)/Bt,he+=(Le-he)/Bt;for(var re=0;re<ft;++re)wt[re]-=gt,Y[re]-=he;return[wt,Y,gt,he]}function yt(xe,Je,Ot,te){for(var ft=0,wt=0,Y=xe.length;wt<Y;wt++){var gt=xe[wt],he=+Je(gt,wt,xe),Oe=+Ot(gt,wt,xe);he!=null&&isFinite(he)&&Oe!=null&&isFinite(Oe)&&te(he,Oe,ft++)}}function J(xe,Je,Ot,te,ft){var wt=0,Y=0;return yt(xe,Je,Ot,function(gt,he){var Oe=he-ft(gt),Le=he-te;wt+=Oe*Oe,Y+=Le*Le}),1-wt/Y}function pt(xe){return Math.atan2(xe[1][1]-xe[0][1],xe[1][0]-xe[0][0])*180/Math.PI}function et(xe){return[(xe[0][0]+xe[1][0])/2,(xe[0][1]+xe[1][1])/2]}function be(xe,Je,Ot){for(var te=Math.log(Je-xe)*Math.LOG10E+1|0,ft=1*Math.pow(10,-te/2-1),wt=1e4,Y=[he(xe),he(Je)],gt=0;Oe(Y)&&gt<wt;);return Y;function he(Le){return[Le,Ot(Le)]}function Oe(Le){gt++;for(var Ve=Le.length,Bt=!1,re=0;re<Ve-1;re++){var ye=Le[re],Yt=Le[re+1],qe=et([ye,Yt]),vr=he(qe[0]),oe=pt([ye,qe]),qt=pt([ye,vr]),bt=Math.abs(oe-qt);bt>ft&&(Le.splice(re+1,0,vr),Bt=!0)}return Bt}}function ot(xe,Je,Ot,te){var ft=te-xe*xe,wt=Math.abs(ft)<1e-24?0:(Ot-xe*Je)/ft,Y=Je-wt*xe;return[Y,wt]}function ut(){var xe=function(wt){return wt[0]},Je=function(wt){return wt[1]},Ot;function te(ft){var wt=0,Y=0,gt=0,he=0,Oe=0,Le=0,Ve=Ot?+Ot[0]:1/0,Bt=Ot?+Ot[1]:-1/0;yt(ft,xe,Je,function(qt,bt){var Wt=Math.log(bt),$t=qt*bt;++wt,Y+=(bt-Y)/wt,he+=($t-he)/wt,Le+=(qt*$t-Le)/wt,gt+=(bt*Wt-gt)/wt,Oe+=($t*Wt-Oe)/wt,Ot||(qt<Ve&&(Ve=qt),qt>Bt&&(Bt=qt))});var re=ot(he/Y,gt/Y,Oe/Y,Le/Y),ye=kt(re,2),Yt=ye[0],qe=ye[1];Yt=Math.exp(Yt);var vr=function(bt){return Yt*Math.exp(qe*bt)},oe=be(Ve,Bt,vr);return oe.a=Yt,oe.b=qe,oe.predict=vr,oe.rSquared=J(ft,xe,Je,Y,vr),oe}return te.domain=function(ft){return arguments.length?(Ot=ft,te):Ot},te.x=function(ft){return arguments.length?(xe=ft,te):xe},te.y=function(ft){return arguments.length?(Je=ft,te):Je},te}function zt(){var xe=function(wt){return wt[0]},Je=function(wt){return wt[1]},Ot;function te(ft){var wt=0,Y=0,gt=0,he=0,Oe=0,Le=Ot?+Ot[0]:1/0,Ve=Ot?+Ot[1]:-1/0;yt(ft,xe,Je,function(oe,qt){++wt,Y+=(oe-Y)/wt,gt+=(qt-gt)/wt,he+=(oe*qt-he)/wt,Oe+=(oe*oe-Oe)/wt,Ot||(oe<Le&&(Le=oe),oe>Ve&&(Ve=oe))});var Bt=ot(Y,gt,he,Oe),re=kt(Bt,2),ye=re[0],Yt=re[1],qe=function(qt){return Yt*qt+ye},vr=[[Le,qe(Le)],[Ve,qe(Ve)]];return vr.a=Yt,vr.b=ye,vr.predict=qe,vr.rSquared=J(ft,xe,Je,gt,qe),vr}return te.domain=function(ft){return arguments.length?(Ot=ft,te):Ot},te.x=function(ft){return arguments.length?(xe=ft,te):xe},te.y=function(ft){return arguments.length?(Je=ft,te):Je},te}function P(xe){xe.sort(function(Ot,te){return Ot-te});var Je=xe.length/2;return Je%1===0?(xe[Je-1]+xe[Je])/2:xe[Math.floor(Je)]}var b=2,W=1e-12;function le(){var xe=function(wt){return wt[0]},Je=function(wt){return wt[1]},Ot=.3;function te(ft){for(var wt=K(ft,xe,Je,!0),Y=kt(wt,4),gt=Y[0],he=Y[1],Oe=Y[2],Le=Y[3],Ve=gt.length,Bt=Math.max(2,~~(Ot*Ve)),re=new Float64Array(Ve),ye=new Float64Array(Ve),Yt=new Float64Array(Ve).fill(1),qe=-1;++qe<=b;){for(var vr=[0,Bt-1],oe=0;oe<Ve;++oe){for(var qt=gt[oe],bt=vr[0],Wt=vr[1],$t=qt-gt[bt]>gt[Wt]-qt?bt:Wt,xt=0,St=0,ue=0,Pe=0,ze=0,Vt=1/Math.abs(gt[$t]-qt||1),Ct=bt;Ct<=Wt;++Ct){var At=gt[Ct],Nt=he[Ct],tt=Ee(Math.abs(qt-At)*Vt)*Yt[Ct],vt=At*tt;xt+=tt,St+=vt,ue+=Nt*tt,Pe+=Nt*vt,ze+=At*vt}var Ht=ot(St/xt,ue/xt,Pe/xt,ze/xt),de=kt(Ht,2),jt=de[0],Ie=de[1];re[oe]=jt+Ie*qt,ye[oe]=Math.abs(he[oe]-re[oe]),ke(gt,oe+1,vr)}if(qe===b)break;var We=P(ye);if(Math.abs(We)<W)break;for(var Ke=0,pr,lr;Ke<Ve;++Ke)pr=ye[Ke]/(6*We),Yt[Ke]=pr>=1?W:(lr=1-pr*pr)*lr}return Tt(gt,re,Oe,Le)}return te.bandwidth=function(ft){return arguments.length?(Ot=ft,te):Ot},te.x=function(ft){return arguments.length?(xe=ft,te):xe},te.y=function(ft){return arguments.length?(Je=ft,te):Je},te}function Ee(xe){return(xe=1-xe*xe*xe)*xe*xe}function ke(xe,Je,Ot){var te=xe[Je],ft=Ot[0],wt=Ot[1]+1;if(!(wt>=xe.length))for(;Je>ft&&xe[wt]-te<=te-xe[ft];)Ot[0]=++ft,Ot[1]=wt,++wt}function Tt(xe,Je,Ot,te){for(var ft=xe.length,wt=[],Y=0,gt=0,he=[],Oe;Y<ft;++Y)Oe=xe[Y]+Ot,he[0]===Oe?he[1]+=(Je[Y]-he[1])/++gt:(gt=0,he[1]+=te,he=[Oe,Je[Y]],wt.push(he));return he[1]+=te,wt}function rt(){var xe=function(Y){return Y[0]},Je=function(Y){return Y[1]},Ot=Math.E,te;function ft(wt){var Y=0,gt=0,he=0,Oe=0,Le=0,Ve=te?+te[0]:1/0,Bt=te?+te[1]:-1/0,re=Math.log(Ot);yt(wt,xe,Je,function(bt,Wt){var $t=Math.log(bt)/re;++Y,gt+=($t-gt)/Y,he+=(Wt-he)/Y,Oe+=($t*Wt-Oe)/Y,Le+=($t*$t-Le)/Y,te||(bt<Ve&&(Ve=bt),bt>Bt&&(Bt=bt))});var ye=ot(gt,he,Oe,Le),Yt=kt(ye,2),qe=Yt[0],vr=Yt[1],oe=function(Wt){return vr*Math.log(Wt)/re+qe},qt=be(Ve,Bt,oe);return qt.a=vr,qt.b=qe,qt.predict=oe,qt.rSquared=J(wt,xe,Je,he,oe),qt}return ft.domain=function(wt){return arguments.length?(te=wt,ft):te},ft.x=function(wt){return arguments.length?(xe=wt,ft):xe},ft.y=function(wt){return arguments.length?(Je=wt,ft):Je},ft.base=function(wt){return arguments.length?(Ot=wt,ft):Ot},ft}function Dt(){var xe=function(wt){return wt[0]},Je=function(wt){return wt[1]},Ot;function te(ft){var wt=K(ft,xe,Je),Y=kt(wt,4),gt=Y[0],he=Y[1],Oe=Y[2],Le=Y[3],Ve=gt.length,Bt=0,re=0,ye=0,Yt=0,qe=0,vr,oe,qt,bt;for(vr=0;vr<Ve;)oe=gt[vr],qt=he[vr++],bt=oe*oe,Bt+=(bt-Bt)/vr,re+=(bt*oe-re)/vr,ye+=(bt*bt-ye)/vr,Yt+=(oe*qt-Yt)/vr,qe+=(bt*qt-qe)/vr;var Wt=0,$t=0,xt=Ot?+Ot[0]:1/0,St=Ot?+Ot[1]:-1/0;yt(ft,xe,Je,function(tt,vt){$t++,Wt+=(vt-Wt)/$t,Ot||(tt<xt&&(xt=tt),tt>St&&(St=tt))});var ue=ye-Bt*Bt,Pe=Bt*ue-re*re,ze=(qe*Bt-Yt*re)/Pe,Vt=(Yt*ue-qe*re)/Pe,Ct=-ze*Bt,At=function(vt){return vt=vt-Oe,ze*vt*vt+Vt*vt+Ct+Le},Nt=be(xt,St,At);return Nt.a=ze,Nt.b=Vt-2*ze*Oe,Nt.c=Ct-Vt*Oe+ze*Oe*Oe+Le,Nt.predict=At,Nt.rSquared=J(ft,xe,Je,Wt,At),Nt}return te.domain=function(ft){return arguments.length?(Ot=ft,te):Ot},te.x=function(ft){return arguments.length?(xe=ft,te):xe},te.y=function(ft){return arguments.length?(Je=ft,te):Je},te}function Se(){var xe=function(Y){return Y[0]},Je=function(Y){return Y[1]},Ot=3,te;function ft(wt){if(Ot===1){var Y=zt().x(xe).y(Je).domain(te)(wt);return Y.coefficients=[Y.b,Y.a],delete Y.a,delete Y.b,Y}if(Ot===2){var gt=Dt().x(xe).y(Je).domain(te)(wt);return gt.coefficients=[gt.c,gt.b,gt.a],delete gt.a,delete gt.b,delete gt.c,gt}var he=K(wt,xe,Je),Oe=kt(he,4),Le=Oe[0],Ve=Oe[1],Bt=Oe[2],re=Oe[3],ye=Le.length,Yt=[],qe=[],vr=Ot+1,oe=0,qt=0,bt=te?+te[0]:1/0,Wt=te?+te[1]:-1/0;yt(wt,xe,Je,function(At,Nt){++qt,oe+=(Nt-oe)/qt,te||(At<bt&&(bt=At),At>Wt&&(Wt=At))});var $t,xt,St,ue,Pe;for($t=0;$t<vr;++$t){for(St=0,ue=0;St<ye;++St)ue+=Math.pow(Le[St],$t)*Ve[St];for(Yt.push(ue),Pe=new Float64Array(vr),xt=0;xt<vr;++xt){for(St=0,ue=0;St<ye;++St)ue+=Math.pow(Le[St],$t+xt);Pe[xt]=ue}qe.push(Pe)}qe.push(Yt);var ze=ve(qe),Vt=function(Nt){Nt-=Bt;var tt=re+ze[0]+ze[1]*Nt+ze[2]*Nt*Nt;for($t=3;$t<vr;++$t)tt+=ze[$t]*Math.pow(Nt,$t);return tt},Ct=be(bt,Wt,Vt);return Ct.coefficients=_e(vr,ze,-Bt,re),Ct.predict=Vt,Ct.rSquared=J(wt,xe,Je,oe,Vt),Ct}return ft.domain=function(wt){return arguments.length?(te=wt,ft):te},ft.x=function(wt){return arguments.length?(xe=wt,ft):xe},ft.y=function(wt){return arguments.length?(Je=wt,ft):Je},ft.order=function(wt){return arguments.length?(Ot=wt,ft):Ot},ft}function _e(xe,Je,Ot,te){var ft=Array(xe),wt,Y,gt,he;for(wt=0;wt<xe;++wt)ft[wt]=0;for(wt=xe-1;wt>=0;--wt)for(gt=Je[wt],he=1,ft[wt]+=gt,Y=1;Y<=wt;++Y)he*=(wt+1-Y)/Y,ft[wt-Y]+=gt*Math.pow(Ot,Y)*he;return ft[0]+=te,ft}function ve(xe){var Je=xe.length-1,Ot=[],te,ft,wt,Y,gt;for(te=0;te<Je;++te){for(Y=te,ft=te+1;ft<Je;++ft)Math.abs(xe[te][ft])>Math.abs(xe[te][Y])&&(Y=ft);for(wt=te;wt<Je+1;++wt)gt=xe[wt][te],xe[wt][te]=xe[wt][Y],xe[wt][Y]=gt;for(ft=te+1;ft<Je;++ft)for(wt=Je;wt>=te;wt--)xe[wt][ft]-=xe[wt][te]*xe[te][ft]/xe[te][te]}for(ft=Je-1;ft>=0;--ft){for(gt=0,wt=ft+1;wt<Je;++wt)gt+=xe[wt][ft]*Ot[wt];Ot[ft]=(xe[Je][ft]-gt)/xe[ft][ft]}return Ot}function ne(){var xe=function(wt){return wt[0]},Je=function(wt){return wt[1]},Ot;function te(ft){var wt=0,Y=0,gt=0,he=0,Oe=0,Le=0,Ve=Ot?+Ot[0]:1/0,Bt=Ot?+Ot[1]:-1/0;yt(ft,xe,Je,function(qt,bt){var Wt=Math.log(qt),$t=Math.log(bt);++wt,Y+=(Wt-Y)/wt,gt+=($t-gt)/wt,he+=(Wt*$t-he)/wt,Oe+=(Wt*Wt-Oe)/wt,Le+=(bt-Le)/wt,Ot||(qt<Ve&&(Ve=qt),qt>Bt&&(Bt=qt))});var re=ot(Y,gt,he,Oe),ye=kt(re,2),Yt=ye[0],qe=ye[1];Yt=Math.exp(Yt);var vr=function(bt){return Yt*Math.pow(bt,qe)},oe=be(Ve,Bt,vr);return oe.a=Yt,oe.b=qe,oe.predict=vr,oe.rSquared=J(ft,xe,Je,Le,vr),oe}return te.domain=function(ft){return arguments.length?(Ot=ft,te):Ot},te.x=function(ft){return arguments.length?(xe=ft,te):xe},te.y=function(ft){return arguments.length?(Je=ft,te):Je},te}nt.regressionExp=ut,nt.regressionLinear=zt,nt.regressionLoess=le,nt.regressionLog=rt,nt.regressionPoly=Se,nt.regressionPow=ne,nt.regressionQuad=Dt,Object.defineProperty(nt,"__esModule",{value:!0})})},74348:function(dn,Pt,nt){"use strict";nt.d(Pt,{qY:function(){return zt}});var kt=nt(93738),mt=function(Tt,rt,Dt){if(Dt||arguments.length===2)for(var Se=0,_e=rt.length,ve;Se<_e;Se++)(ve||!(Se in rt))&&(ve||(ve=Array.prototype.slice.call(rt,0,Se)),ve[Se]=rt[Se]);return Tt.concat(ve||Array.prototype.slice.call(rt))},k=function(){function Tt(rt,Dt,Se){this.name=rt,this.version=Dt,this.os=Se,this.type="browser"}return Tt}(),Et=function(){function Tt(rt){this.version=rt,this.type="node",this.name="node",this.os=kt.platform}return Tt}(),K=function(){function Tt(rt,Dt,Se,_e){this.name=rt,this.version=Dt,this.os=Se,this.bot=_e,this.type="bot-device"}return Tt}(),yt=function(){function Tt(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return Tt}(),J=function(){function Tt(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return Tt}(),pt=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,et=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,be=3,ot=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",pt]],ut=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function zt(Tt){return Tt?W(Tt):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new J:typeof navigator!="undefined"?W(navigator.userAgent):Ee()}function P(Tt){return Tt!==""&&ot.reduce(function(rt,Dt){var Se=Dt[0],_e=Dt[1];if(rt)return rt;var ve=_e.exec(Tt);return!!ve&&[Se,ve]},!1)}function b(Tt){var rt=P(Tt);return rt?rt[0]:null}function W(Tt){var rt=P(Tt);if(!rt)return null;var Dt=rt[0],Se=rt[1];if(Dt==="searchbot")return new yt;var _e=Se[1]&&Se[1].split(".").join("_").split("_").slice(0,3);_e?_e.length<be&&(_e=mt(mt([],_e,!0),ke(be-_e.length),!0)):_e=[];var ve=_e.join("."),ne=le(Tt),xe=et.exec(Tt);return xe&&xe[1]?new K(Dt,ve,ne,xe[1]):new k(Dt,ve,ne)}function le(Tt){for(var rt=0,Dt=ut.length;rt<Dt;rt++){var Se=ut[rt],_e=Se[0],ve=Se[1],ne=ve.exec(Tt);if(ne)return _e}return null}function Ee(){var Tt=typeof kt!="undefined"&&kt.version;return Tt?new Et(kt.version.slice(1)):null}function ke(Tt){for(var rt=[],Dt=0;Dt<Tt;Dt++)rt.push("0");return rt}},89675:function(dn){"use strict";dn.exports=Pt,dn.exports.default=Pt;function Pt(ft,wt,Y){Y=Y||2;var gt=wt&&wt.length,he=gt?wt[0]*Y:ft.length,Oe=nt(ft,0,he,Y,!0),Le=[];if(!Oe||Oe.next===Oe.prev)return Le;var Ve,Bt,re,ye,Yt,qe,vr;if(gt&&(Oe=J(ft,wt,Oe,Y)),ft.length>80*Y){Ve=re=ft[0],Bt=ye=ft[1];for(var oe=Y;oe<he;oe+=Y)Yt=ft[oe],qe=ft[oe+1],Yt<Ve&&(Ve=Yt),qe<Bt&&(Bt=qe),Yt>re&&(re=Yt),qe>ye&&(ye=qe);vr=Math.max(re-Ve,ye-Bt),vr=vr!==0?32767/vr:0}return mt(Oe,Le,Y,Ve,Bt,vr,0),Le}function nt(ft,wt,Y,gt,he){var Oe,Le;if(he===te(ft,wt,Y,gt)>0)for(Oe=wt;Oe<Y;Oe+=gt)Le=xe(Oe,ft[Oe],ft[Oe+1],Le);else for(Oe=Y-gt;Oe>=wt;Oe-=gt)Le=xe(Oe,ft[Oe],ft[Oe+1],Le);return Le&&ke(Le,Le.next)&&(Je(Le),Le=Le.next),Le}function kt(ft,wt){if(!ft)return ft;wt||(wt=ft);var Y=ft,gt;do if(gt=!1,!Y.steiner&&(ke(Y,Y.next)||Ee(Y.prev,Y,Y.next)===0)){if(Je(Y),Y=wt=Y.prev,Y===Y.next)break;gt=!0}else Y=Y.next;while(gt||Y!==wt);return wt}function mt(ft,wt,Y,gt,he,Oe,Le){if(ft){!Le&&Oe&&ut(ft,gt,he,Oe);for(var Ve=ft,Bt,re;ft.prev!==ft.next;){if(Bt=ft.prev,re=ft.next,Oe?Et(ft,gt,he,Oe):k(ft)){wt.push(Bt.i/Y|0),wt.push(ft.i/Y|0),wt.push(re.i/Y|0),Je(ft),ft=re.next,Ve=re.next;continue}if(ft=re,ft===Ve){Le?Le===1?(ft=K(kt(ft),wt,Y),mt(ft,wt,Y,gt,he,Oe,2)):Le===2&&yt(ft,wt,Y,gt,he,Oe):mt(kt(ft),wt,Y,gt,he,Oe,1);break}}}}function k(ft){var wt=ft.prev,Y=ft,gt=ft.next;if(Ee(wt,Y,gt)>=0)return!1;for(var he=wt.x,Oe=Y.x,Le=gt.x,Ve=wt.y,Bt=Y.y,re=gt.y,ye=he<Oe?he<Le?he:Le:Oe<Le?Oe:Le,Yt=Ve<Bt?Ve<re?Ve:re:Bt<re?Bt:re,qe=he>Oe?he>Le?he:Le:Oe>Le?Oe:Le,vr=Ve>Bt?Ve>re?Ve:re:Bt>re?Bt:re,oe=gt.next;oe!==wt;){if(oe.x>=ye&&oe.x<=qe&&oe.y>=Yt&&oe.y<=vr&&W(he,Ve,Oe,Bt,Le,re,oe.x,oe.y)&&Ee(oe.prev,oe,oe.next)>=0)return!1;oe=oe.next}return!0}function Et(ft,wt,Y,gt){var he=ft.prev,Oe=ft,Le=ft.next;if(Ee(he,Oe,Le)>=0)return!1;for(var Ve=he.x,Bt=Oe.x,re=Le.x,ye=he.y,Yt=Oe.y,qe=Le.y,vr=Ve<Bt?Ve<re?Ve:re:Bt<re?Bt:re,oe=ye<Yt?ye<qe?ye:qe:Yt<qe?Yt:qe,qt=Ve>Bt?Ve>re?Ve:re:Bt>re?Bt:re,bt=ye>Yt?ye>qe?ye:qe:Yt>qe?Yt:qe,Wt=P(vr,oe,wt,Y,gt),$t=P(qt,bt,wt,Y,gt),xt=ft.prevZ,St=ft.nextZ;xt&&xt.z>=Wt&&St&&St.z<=$t;){if(xt.x>=vr&&xt.x<=qt&&xt.y>=oe&&xt.y<=bt&&xt!==he&&xt!==Le&&W(Ve,ye,Bt,Yt,re,qe,xt.x,xt.y)&&Ee(xt.prev,xt,xt.next)>=0||(xt=xt.prevZ,St.x>=vr&&St.x<=qt&&St.y>=oe&&St.y<=bt&&St!==he&&St!==Le&&W(Ve,ye,Bt,Yt,re,qe,St.x,St.y)&&Ee(St.prev,St,St.next)>=0))return!1;St=St.nextZ}for(;xt&&xt.z>=Wt;){if(xt.x>=vr&&xt.x<=qt&&xt.y>=oe&&xt.y<=bt&&xt!==he&&xt!==Le&&W(Ve,ye,Bt,Yt,re,qe,xt.x,xt.y)&&Ee(xt.prev,xt,xt.next)>=0)return!1;xt=xt.prevZ}for(;St&&St.z<=$t;){if(St.x>=vr&&St.x<=qt&&St.y>=oe&&St.y<=bt&&St!==he&&St!==Le&&W(Ve,ye,Bt,Yt,re,qe,St.x,St.y)&&Ee(St.prev,St,St.next)>=0)return!1;St=St.nextZ}return!0}function K(ft,wt,Y){var gt=ft;do{var he=gt.prev,Oe=gt.next.next;!ke(he,Oe)&&Tt(he,gt,gt.next,Oe)&&_e(he,Oe)&&_e(Oe,he)&&(wt.push(he.i/Y|0),wt.push(gt.i/Y|0),wt.push(Oe.i/Y|0),Je(gt),Je(gt.next),gt=ft=Oe),gt=gt.next}while(gt!==ft);return kt(gt)}function yt(ft,wt,Y,gt,he,Oe){var Le=ft;do{for(var Ve=Le.next.next;Ve!==Le.prev;){if(Le.i!==Ve.i&&le(Le,Ve)){var Bt=ne(Le,Ve);Le=kt(Le,Le.next),Bt=kt(Bt,Bt.next),mt(Le,wt,Y,gt,he,Oe,0),mt(Bt,wt,Y,gt,he,Oe,0);return}Ve=Ve.next}Le=Le.next}while(Le!==ft)}function J(ft,wt,Y,gt){var he=[],Oe,Le,Ve,Bt,re;for(Oe=0,Le=wt.length;Oe<Le;Oe++)Ve=wt[Oe]*gt,Bt=Oe<Le-1?wt[Oe+1]*gt:ft.length,re=nt(ft,Ve,Bt,gt,!1),re===re.next&&(re.steiner=!0),he.push(b(re));for(he.sort(pt),Oe=0;Oe<he.length;Oe++)Y=et(he[Oe],Y);return Y}function pt(ft,wt){return ft.x-wt.x}function et(ft,wt){var Y=be(ft,wt);if(!Y)return wt;var gt=ne(Y,ft);return kt(gt,gt.next),kt(Y,Y.next)}function be(ft,wt){var Y=wt,gt=ft.x,he=ft.y,Oe=-1/0,Le;do{if(he<=Y.y&&he>=Y.next.y&&Y.next.y!==Y.y){var Ve=Y.x+(he-Y.y)*(Y.next.x-Y.x)/(Y.next.y-Y.y);if(Ve<=gt&&Ve>Oe&&(Oe=Ve,Le=Y.x<Y.next.x?Y:Y.next,Ve===gt))return Le}Y=Y.next}while(Y!==wt);if(!Le)return null;var Bt=Le,re=Le.x,ye=Le.y,Yt=1/0,qe;Y=Le;do gt>=Y.x&&Y.x>=re&&gt!==Y.x&&W(he<ye?gt:Oe,he,re,ye,he<ye?Oe:gt,he,Y.x,Y.y)&&(qe=Math.abs(he-Y.y)/(gt-Y.x),_e(Y,ft)&&(qe<Yt||qe===Yt&&(Y.x>Le.x||Y.x===Le.x&&ot(Le,Y)))&&(Le=Y,Yt=qe)),Y=Y.next;while(Y!==Bt);return Le}function ot(ft,wt){return Ee(ft.prev,ft,wt.prev)<0&&Ee(wt.next,ft,ft.next)<0}function ut(ft,wt,Y,gt){var he=ft;do he.z===0&&(he.z=P(he.x,he.y,wt,Y,gt)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==ft);he.prevZ.nextZ=null,he.prevZ=null,zt(he)}function zt(ft){var wt,Y,gt,he,Oe,Le,Ve,Bt,re=1;do{for(Y=ft,ft=null,Oe=null,Le=0;Y;){for(Le++,gt=Y,Ve=0,wt=0;wt<re&&(Ve++,gt=gt.nextZ,!!gt);wt++);for(Bt=re;Ve>0||Bt>0&&gt;)Ve!==0&&(Bt===0||!gt||Y.z<=gt.z)?(he=Y,Y=Y.nextZ,Ve--):(he=gt,gt=gt.nextZ,Bt--),Oe?Oe.nextZ=he:ft=he,he.prevZ=Oe,Oe=he;Y=gt}Oe.nextZ=null,re*=2}while(Le>1);return ft}function P(ft,wt,Y,gt,he){return ft=(ft-Y)*he|0,wt=(wt-gt)*he|0,ft=(ft|ft<<8)&16711935,ft=(ft|ft<<4)&252645135,ft=(ft|ft<<2)&858993459,ft=(ft|ft<<1)&1431655765,wt=(wt|wt<<8)&16711935,wt=(wt|wt<<4)&252645135,wt=(wt|wt<<2)&858993459,wt=(wt|wt<<1)&1431655765,ft|wt<<1}function b(ft){var wt=ft,Y=ft;do(wt.x<Y.x||wt.x===Y.x&&wt.y<Y.y)&&(Y=wt),wt=wt.next;while(wt!==ft);return Y}function W(ft,wt,Y,gt,he,Oe,Le,Ve){return(he-Le)*(wt-Ve)>=(ft-Le)*(Oe-Ve)&&(ft-Le)*(gt-Ve)>=(Y-Le)*(wt-Ve)&&(Y-Le)*(Oe-Ve)>=(he-Le)*(gt-Ve)}function le(ft,wt){return ft.next.i!==wt.i&&ft.prev.i!==wt.i&&!Se(ft,wt)&&(_e(ft,wt)&&_e(wt,ft)&&ve(ft,wt)&&(Ee(ft.prev,ft,wt.prev)||Ee(ft,wt.prev,wt))||ke(ft,wt)&&Ee(ft.prev,ft,ft.next)>0&&Ee(wt.prev,wt,wt.next)>0)}function Ee(ft,wt,Y){return(wt.y-ft.y)*(Y.x-wt.x)-(wt.x-ft.x)*(Y.y-wt.y)}function ke(ft,wt){return ft.x===wt.x&&ft.y===wt.y}function Tt(ft,wt,Y,gt){var he=Dt(Ee(ft,wt,Y)),Oe=Dt(Ee(ft,wt,gt)),Le=Dt(Ee(Y,gt,ft)),Ve=Dt(Ee(Y,gt,wt));return!!(he!==Oe&&Le!==Ve||he===0&&rt(ft,Y,wt)||Oe===0&&rt(ft,gt,wt)||Le===0&&rt(Y,ft,gt)||Ve===0&&rt(Y,wt,gt))}function rt(ft,wt,Y){return wt.x<=Math.max(ft.x,Y.x)&&wt.x>=Math.min(ft.x,Y.x)&&wt.y<=Math.max(ft.y,Y.y)&&wt.y>=Math.min(ft.y,Y.y)}function Dt(ft){return ft>0?1:ft<0?-1:0}function Se(ft,wt){var Y=ft;do{if(Y.i!==ft.i&&Y.next.i!==ft.i&&Y.i!==wt.i&&Y.next.i!==wt.i&&Tt(Y,Y.next,ft,wt))return!0;Y=Y.next}while(Y!==ft);return!1}function _e(ft,wt){return Ee(ft.prev,ft,ft.next)<0?Ee(ft,wt,ft.next)>=0&&Ee(ft,ft.prev,wt)>=0:Ee(ft,wt,ft.prev)<0||Ee(ft,ft.next,wt)<0}function ve(ft,wt){var Y=ft,gt=!1,he=(ft.x+wt.x)/2,Oe=(ft.y+wt.y)/2;do Y.y>Oe!=Y.next.y>Oe&&Y.next.y!==Y.y&&he<(Y.next.x-Y.x)*(Oe-Y.y)/(Y.next.y-Y.y)+Y.x&&(gt=!gt),Y=Y.next;while(Y!==ft);return gt}function ne(ft,wt){var Y=new Ot(ft.i,ft.x,ft.y),gt=new Ot(wt.i,wt.x,wt.y),he=ft.next,Oe=wt.prev;return ft.next=wt,wt.prev=ft,Y.next=he,he.prev=Y,gt.next=Y,Y.prev=gt,Oe.next=gt,gt.prev=Oe,gt}function xe(ft,wt,Y,gt){var he=new Ot(ft,wt,Y);return gt?(he.next=gt.next,he.prev=gt,gt.next.prev=he,gt.next=he):(he.prev=he,he.next=he),he}function Je(ft){ft.next.prev=ft.prev,ft.prev.next=ft.next,ft.prevZ&&(ft.prevZ.nextZ=ft.nextZ),ft.nextZ&&(ft.nextZ.prevZ=ft.prevZ)}function Ot(ft,wt,Y){this.i=ft,this.x=wt,this.y=Y,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Pt.deviation=function(ft,wt,Y,gt){var he=wt&&wt.length,Oe=he?wt[0]*Y:ft.length,Le=Math.abs(te(ft,0,Oe,Y));if(he)for(var Ve=0,Bt=wt.length;Ve<Bt;Ve++){var re=wt[Ve]*Y,ye=Ve<Bt-1?wt[Ve+1]*Y:ft.length;Le-=Math.abs(te(ft,re,ye,Y))}var Yt=0;for(Ve=0;Ve<gt.length;Ve+=3){var qe=gt[Ve]*Y,vr=gt[Ve+1]*Y,oe=gt[Ve+2]*Y;Yt+=Math.abs((ft[qe]-ft[oe])*(ft[vr+1]-ft[qe+1])-(ft[qe]-ft[vr])*(ft[oe+1]-ft[qe+1]))}return Le===0&&Yt===0?0:Math.abs((Yt-Le)/Le)};function te(ft,wt,Y,gt){for(var he=0,Oe=wt,Le=Y-gt;Oe<Y;Oe+=gt)he+=(ft[Le]-ft[Oe])*(ft[Oe+1]+ft[Le+1]),Le=Oe;return he}Pt.flatten=function(ft){for(var wt=ft[0][0].length,Y={vertices:[],holes:[],dimensions:wt},gt=0,he=0;he<ft.length;he++){for(var Oe=0;Oe<ft[he].length;Oe++)for(var Le=0;Le<wt;Le++)Y.vertices.push(ft[he][Oe][Le]);he>0&&(gt+=ft[he-1].length,Y.holes.push(gt))}return Y}},73827:function(dn){function Pt(kt){var mt=kt.target||kt.srcElement;mt.__resizeRAF__&&cancelAnimationFrame(mt.__resizeRAF__),mt.__resizeRAF__=requestAnimationFrame(function(){var k=mt.__resizeTrigger__,Et=k&&k.__resizeListeners__;Et&&Et.forEach(function(K){K.call(k,kt)})})}var nt=function(mt,k){var Et=this,K=Et.document,yt,J=K.attachEvent;typeof navigator!="undefined"&&(yt=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function pt(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",Pt)}if(!mt.__resizeListeners__)if(mt.__resizeListeners__=[],J)mt.__resizeTrigger__=mt,mt.attachEvent("onresize",Pt);else{getComputedStyle(mt).position==="static"&&(mt.style.position="relative");var et=mt.__resizeTrigger__=K.createElement("object");et.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),et.setAttribute("class","resize-sensor"),et.setAttribute("tabindex","-1"),et.setAttribute("title",""),et.__resizeElement__=mt,et.onload=pt,et.type="text/html",yt&&mt.appendChild(et),et.data="about:blank",yt||mt.appendChild(et)}mt.__resizeListeners__.push(k)};dn.exports=typeof window=="undefined"?nt:nt.bind(window),dn.exports.unbind=function(kt,mt){var k=document.attachEvent,Et=kt.__resizeListeners__||[];if(mt){var K=Et.indexOf(mt);K!==-1&&Et.splice(K,1)}else Et=kt.__resizeListeners__=[];if(!Et.length){if(k)kt.detachEvent("onresize",Pt);else if(kt.__resizeTrigger__){var yt=kt.__resizeTrigger__.contentDocument,J=yt&&yt.defaultView;J&&(J.removeEventListener("resize",Pt),delete J.__resizeTrigger__),kt.__resizeTrigger__=!kt.removeChild(kt.__resizeTrigger__)}delete kt.__resizeListeners__}}},11488:function(dn){"use strict";var Pt=Object.prototype.hasOwnProperty,nt="~";function kt(){}Object.create&&(kt.prototype=Object.create(null),new kt().__proto__||(nt=!1));function mt(yt,J,pt){this.fn=yt,this.context=J,this.once=pt||!1}function k(yt,J,pt,et,be){if(typeof pt!="function")throw new TypeError("The listener must be a function");var ot=new mt(pt,et||yt,be),ut=nt?nt+J:J;return yt._events[ut]?yt._events[ut].fn?yt._events[ut]=[yt._events[ut],ot]:yt._events[ut].push(ot):(yt._events[ut]=ot,yt._eventsCount++),yt}function Et(yt,J){--yt._eventsCount===0?yt._events=new kt:delete yt._events[J]}function K(){this._events=new kt,this._eventsCount=0}K.prototype.eventNames=function(){var J=[],pt,et;if(this._eventsCount===0)return J;for(et in pt=this._events)Pt.call(pt,et)&&J.push(nt?et.slice(1):et);return Object.getOwnPropertySymbols?J.concat(Object.getOwnPropertySymbols(pt)):J},K.prototype.listeners=function(J){var pt=nt?nt+J:J,et=this._events[pt];if(!et)return[];if(et.fn)return[et.fn];for(var be=0,ot=et.length,ut=new Array(ot);be<ot;be++)ut[be]=et[be].fn;return ut},K.prototype.listenerCount=function(J){var pt=nt?nt+J:J,et=this._events[pt];return et?et.fn?1:et.length:0},K.prototype.emit=function(J,pt,et,be,ot,ut){var zt=nt?nt+J:J;if(!this._events[zt])return!1;var P=this._events[zt],b=arguments.length,W,le;if(P.fn){switch(P.once&&this.removeListener(J,P.fn,void 0,!0),b){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,pt),!0;case 3:return P.fn.call(P.context,pt,et),!0;case 4:return P.fn.call(P.context,pt,et,be),!0;case 5:return P.fn.call(P.context,pt,et,be,ot),!0;case 6:return P.fn.call(P.context,pt,et,be,ot,ut),!0}for(le=1,W=new Array(b-1);le<b;le++)W[le-1]=arguments[le];P.fn.apply(P.context,W)}else{var Ee=P.length,ke;for(le=0;le<Ee;le++)switch(P[le].once&&this.removeListener(J,P[le].fn,void 0,!0),b){case 1:P[le].fn.call(P[le].context);break;case 2:P[le].fn.call(P[le].context,pt);break;case 3:P[le].fn.call(P[le].context,pt,et);break;case 4:P[le].fn.call(P[le].context,pt,et,be);break;default:if(!W)for(ke=1,W=new Array(b-1);ke<b;ke++)W[ke-1]=arguments[ke];P[le].fn.apply(P[le].context,W)}}return!0},K.prototype.on=function(J,pt,et){return k(this,J,pt,et,!1)},K.prototype.once=function(J,pt,et){return k(this,J,pt,et,!0)},K.prototype.removeListener=function(J,pt,et,be){var ot=nt?nt+J:J;if(!this._events[ot])return this;if(!pt)return Et(this,ot),this;var ut=this._events[ot];if(ut.fn)ut.fn===pt&&(!be||ut.once)&&(!et||ut.context===et)&&Et(this,ot);else{for(var zt=0,P=[],b=ut.length;zt<b;zt++)(ut[zt].fn!==pt||be&&!ut[zt].once||et&&ut[zt].context!==et)&&P.push(ut[zt]);P.length?this._events[ot]=P.length===1?P[0]:P:Et(this,ot)}return this},K.prototype.removeAllListeners=function(J){var pt;return J?(pt=nt?nt+J:J,this._events[pt]&&Et(this,pt)):(this._events=new kt,this._eventsCount=0),this},K.prototype.off=K.prototype.removeListener,K.prototype.addListener=K.prototype.on,K.prefixed=nt,K.EventEmitter=K,dn.exports=K},12886:function(dn,Pt){(function(nt,kt){kt(Pt)})(this,function(nt){"use strict";function kt(zt,P,b,W){W=W||{};var le=W.maxIterations||100,Ee=W.tolerance||1e-10,ke=zt(P),Tt=zt(b),rt=b-P;if(ke*Tt>0)throw"Initial bisect points must have opposite signs";if(ke===0)return P;if(Tt===0)return b;for(var Dt=0;Dt<le;++Dt){rt/=2;var Se=P+rt,_e=zt(Se);if(_e*ke>=0&&(P=Se),Math.abs(rt)<Ee||_e===0)return Se}return P+rt}function mt(zt){for(var P=new Array(zt),b=0;b<zt;++b)P[b]=0;return P}function k(zt,P){return mt(zt).map(function(){return mt(P)})}function Et(zt,P){for(var b=0,W=0;W<zt.length;++W)b+=zt[W]*P[W];return b}function K(zt){return Math.sqrt(Et(zt,zt))}function yt(zt,P,b){for(var W=0;W<P.length;++W)zt[W]=P[W]*b}function J(zt,P,b,W,le){for(var Ee=0;Ee<zt.length;++Ee)zt[Ee]=P*b[Ee]+W*le[Ee]}function pt(zt,P,b){b=b||{};var W=b.maxIterations||P.length*200,le=b.nonZeroDelta||1.05,Ee=b.zeroDelta||.001,ke=b.minErrorDelta||1e-6,Tt=b.minErrorDelta||1e-5,rt=b.rho!==void 0?b.rho:1,Dt=b.chi!==void 0?b.chi:2,Se=b.psi!==void 0?b.psi:-.5,_e=b.sigma!==void 0?b.sigma:.5,ve,ne=P.length,xe=new Array(ne+1);xe[0]=P,xe[0].fx=zt(P),xe[0].id=0;for(var Je=0;Je<ne;++Je){var Ot=P.slice();Ot[Je]=Ot[Je]?Ot[Je]*le:Ee,xe[Je+1]=Ot,xe[Je+1].fx=zt(Ot),xe[Je+1].id=Je+1}function te(ye){for(var Yt=0;Yt<ye.length;Yt++)xe[ne][Yt]=ye[Yt];xe[ne].fx=ye.fx}for(var ft=function(ye,Yt){return ye.fx-Yt.fx},wt=P.slice(),Y=P.slice(),gt=P.slice(),he=P.slice(),Oe=0;Oe<W;++Oe){if(xe.sort(ft),b.history){var Le=xe.map(function(ye){var Yt=ye.slice();return Yt.fx=ye.fx,Yt.id=ye.id,Yt});Le.sort(function(ye,Yt){return ye.id-Yt.id}),b.history.push({x:xe[0].slice(),fx:xe[0].fx,simplex:Le})}for(ve=0,Je=0;Je<ne;++Je)ve=Math.max(ve,Math.abs(xe[0][Je]-xe[1][Je]));if(Math.abs(xe[0].fx-xe[ne].fx)<ke&&ve<Tt)break;for(Je=0;Je<ne;++Je){wt[Je]=0;for(var Ve=0;Ve<ne;++Ve)wt[Je]+=xe[Ve][Je];wt[Je]/=ne}var Bt=xe[ne];if(J(Y,1+rt,wt,-rt,Bt),Y.fx=zt(Y),Y.fx<xe[0].fx)J(he,1+Dt,wt,-Dt,Bt),he.fx=zt(he),he.fx<Y.fx?te(he):te(Y);else if(Y.fx>=xe[ne-1].fx){var re=!1;if(Y.fx>Bt.fx?(J(gt,1+Se,wt,-Se,Bt),gt.fx=zt(gt),gt.fx<Bt.fx?te(gt):re=!0):(J(gt,1-Se*rt,wt,Se*rt,Bt),gt.fx=zt(gt),gt.fx<Y.fx?te(gt):re=!0),re){if(_e>=1)break;for(Je=1;Je<xe.length;++Je)J(xe[Je],1-_e,xe[0],_e,xe[Je]),xe[Je].fx=zt(xe[Je])}}else te(Y)}return xe.sort(ft),{fx:xe[0].fx,x:xe[0]}}function et(zt,P,b,W,le,Ee,ke){var Tt=b.fx,rt=Et(b.fxprime,P),Dt=Tt,Se=Tt,_e=rt,ve=0;le=le||1,Ee=Ee||1e-6,ke=ke||.1;function ne(Je,Ot,te){for(var ft=0;ft<16;++ft)if(le=(Je+Ot)/2,J(W.x,1,b.x,le,P),Dt=W.fx=zt(W.x,W.fxprime),_e=Et(W.fxprime,P),Dt>Tt+Ee*le*rt||Dt>=te)Ot=le;else{if(Math.abs(_e)<=-ke*rt)return le;_e*(Ot-Je)>=0&&(Ot=Je),Je=le,te=Dt}return 0}for(var xe=0;xe<10;++xe){if(J(W.x,1,b.x,le,P),Dt=W.fx=zt(W.x,W.fxprime),_e=Et(W.fxprime,P),Dt>Tt+Ee*le*rt||xe&&Dt>=Se)return ne(ve,le,Se);if(Math.abs(_e)<=-ke*rt)return le;if(_e>=0)return ne(le,ve,Dt);Se=Dt,ve=le,le*=2}return le}function be(zt,P,b){var W={x:P.slice(),fx:0,fxprime:P.slice()},le={x:P.slice(),fx:0,fxprime:P.slice()},Ee=P.slice(),ke,Tt,rt=1,Dt;b=b||{},Dt=b.maxIterations||P.length*20,W.fx=zt(W.x,W.fxprime),ke=W.fxprime.slice(),yt(ke,W.fxprime,-1);for(var Se=0;Se<Dt;++Se){if(rt=et(zt,ke,W,le,rt),b.history&&b.history.push({x:W.x.slice(),fx:W.fx,fxprime:W.fxprime.slice(),alpha:rt}),!rt)yt(ke,W.fxprime,-1);else{J(Ee,1,le.fxprime,-1,W.fxprime);var _e=Et(W.fxprime,W.fxprime),ve=Math.max(0,Et(Ee,le.fxprime)/_e);J(ke,ve,ke,-1,le.fxprime),Tt=W,W=le,le=Tt}if(K(W.fxprime)<=1e-5)break}return b.history&&b.history.push({x:W.x.slice(),fx:W.fx,fxprime:W.fxprime.slice(),alpha:rt}),W}function ot(zt,P,b){b=b||{};for(var W=b.maxIterations||P.length*100,le=b.learnRate||.001,Ee={x:P.slice(),fx:0,fxprime:P.slice()},ke=0;ke<W&&(Ee.fx=zt(Ee.x,Ee.fxprime),b.history&&b.history.push({x:Ee.x.slice(),fx:Ee.fx,fxprime:Ee.fxprime.slice()}),J(Ee.x,1,Ee.x,-le,Ee.fxprime),!(K(Ee.fxprime)<=1e-5));++ke);return Ee}function ut(zt,P,b){b=b||{};var W={x:P.slice(),fx:0,fxprime:P.slice()},le={x:P.slice(),fx:0,fxprime:P.slice()},Ee=b.maxIterations||P.length*100,ke=b.learnRate||1,Tt=P.slice(),rt=b.c1||.001,Dt=b.c2||.1,Se,_e=[];if(b.history){var ve=zt;zt=function(xe,Je){return _e.push(xe.slice()),ve(xe,Je)}}W.fx=zt(W.x,W.fxprime);for(var ne=0;ne<Ee&&(yt(Tt,W.fxprime,-1),ke=et(zt,Tt,W,le,ke,rt,Dt),b.history&&(b.history.push({x:W.x.slice(),fx:W.fx,fxprime:W.fxprime.slice(),functionCalls:_e,learnRate:ke,alpha:ke}),_e=[]),Se=W,W=le,le=Se,!(ke===0||K(W.fxprime)<1e-5));++ne);return W}nt.bisect=kt,nt.nelderMead=pt,nt.conjugateGradient=be,nt.gradientDescent=ot,nt.gradientDescentLineSearch=ut,nt.zeros=mt,nt.zerosM=k,nt.norm2=K,nt.weightedSum=J,nt.scale=yt})},96140:function(dn,Pt,nt){"use strict";nt.d(Pt,{FD:function(){return k},Ib:function(){return kt},WT:function(){return mt}});var kt=1e-6,mt=typeof Float32Array!="undefined"?Float32Array:Array,k=Math.random;function Et(pt){mt=pt}var K=Math.PI/180;function yt(pt){return pt*K}function J(pt,et){return Math.abs(pt-et)<=kt*Math.max(1,Math.abs(pt),Math.abs(et))}Math.hypot||(Math.hypot=function(){for(var pt=0,et=arguments.length;et--;)pt+=arguments[et]*arguments[et];return Math.sqrt(pt)})},99250:function(dn,Pt,nt){"use strict";nt.d(Pt,{Jp:function(){return ut},U_:function(){return et},Us:function(){return le},vc:function(){return W},xJ:function(){return Ee}});function kt(){var Y=new glMatrix.ARRAY_TYPE(9);return glMatrix.ARRAY_TYPE!=Float32Array&&(Y[1]=0,Y[2]=0,Y[3]=0,Y[5]=0,Y[6]=0,Y[7]=0),Y[0]=1,Y[4]=1,Y[8]=1,Y}function mt(Y,gt){return Y[0]=gt[0],Y[1]=gt[1],Y[2]=gt[2],Y[3]=gt[4],Y[4]=gt[5],Y[5]=gt[6],Y[6]=gt[8],Y[7]=gt[9],Y[8]=gt[10],Y}function k(Y){var gt=new glMatrix.ARRAY_TYPE(9);return gt[0]=Y[0],gt[1]=Y[1],gt[2]=Y[2],gt[3]=Y[3],gt[4]=Y[4],gt[5]=Y[5],gt[6]=Y[6],gt[7]=Y[7],gt[8]=Y[8],gt}function Et(Y,gt){return Y[0]=gt[0],Y[1]=gt[1],Y[2]=gt[2],Y[3]=gt[3],Y[4]=gt[4],Y[5]=gt[5],Y[6]=gt[6],Y[7]=gt[7],Y[8]=gt[8],Y}function K(Y,gt,he,Oe,Le,Ve,Bt,re,ye){var Yt=new glMatrix.ARRAY_TYPE(9);return Yt[0]=Y,Yt[1]=gt,Yt[2]=he,Yt[3]=Oe,Yt[4]=Le,Yt[5]=Ve,Yt[6]=Bt,Yt[7]=re,Yt[8]=ye,Yt}function yt(Y,gt,he,Oe,Le,Ve,Bt,re,ye,Yt){return Y[0]=gt,Y[1]=he,Y[2]=Oe,Y[3]=Le,Y[4]=Ve,Y[5]=Bt,Y[6]=re,Y[7]=ye,Y[8]=Yt,Y}function J(Y){return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=1,Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1,Y}function pt(Y,gt){if(Y===gt){var he=gt[1],Oe=gt[2],Le=gt[5];Y[1]=gt[3],Y[2]=gt[6],Y[3]=he,Y[5]=gt[7],Y[6]=Oe,Y[7]=Le}else Y[0]=gt[0],Y[1]=gt[3],Y[2]=gt[6],Y[3]=gt[1],Y[4]=gt[4],Y[5]=gt[7],Y[6]=gt[2],Y[7]=gt[5],Y[8]=gt[8];return Y}function et(Y,gt){var he=gt[0],Oe=gt[1],Le=gt[2],Ve=gt[3],Bt=gt[4],re=gt[5],ye=gt[6],Yt=gt[7],qe=gt[8],vr=qe*Bt-re*Yt,oe=-qe*Ve+re*ye,qt=Yt*Ve-Bt*ye,bt=he*vr+Oe*oe+Le*qt;return bt?(bt=1/bt,Y[0]=vr*bt,Y[1]=(-qe*Oe+Le*Yt)*bt,Y[2]=(re*Oe-Le*Bt)*bt,Y[3]=oe*bt,Y[4]=(qe*he-Le*ye)*bt,Y[5]=(-re*he+Le*Ve)*bt,Y[6]=qt*bt,Y[7]=(-Yt*he+Oe*ye)*bt,Y[8]=(Bt*he-Oe*Ve)*bt,Y):null}function be(Y,gt){var he=gt[0],Oe=gt[1],Le=gt[2],Ve=gt[3],Bt=gt[4],re=gt[5],ye=gt[6],Yt=gt[7],qe=gt[8];return Y[0]=Bt*qe-re*Yt,Y[1]=Le*Yt-Oe*qe,Y[2]=Oe*re-Le*Bt,Y[3]=re*ye-Ve*qe,Y[4]=he*qe-Le*ye,Y[5]=Le*Ve-he*re,Y[6]=Ve*Yt-Bt*ye,Y[7]=Oe*ye-he*Yt,Y[8]=he*Bt-Oe*Ve,Y}function ot(Y){var gt=Y[0],he=Y[1],Oe=Y[2],Le=Y[3],Ve=Y[4],Bt=Y[5],re=Y[6],ye=Y[7],Yt=Y[8];return gt*(Yt*Ve-Bt*ye)+he*(-Yt*Le+Bt*re)+Oe*(ye*Le-Ve*re)}function ut(Y,gt,he){var Oe=gt[0],Le=gt[1],Ve=gt[2],Bt=gt[3],re=gt[4],ye=gt[5],Yt=gt[6],qe=gt[7],vr=gt[8],oe=he[0],qt=he[1],bt=he[2],Wt=he[3],$t=he[4],xt=he[5],St=he[6],ue=he[7],Pe=he[8];return Y[0]=oe*Oe+qt*Bt+bt*Yt,Y[1]=oe*Le+qt*re+bt*qe,Y[2]=oe*Ve+qt*ye+bt*vr,Y[3]=Wt*Oe+$t*Bt+xt*Yt,Y[4]=Wt*Le+$t*re+xt*qe,Y[5]=Wt*Ve+$t*ye+xt*vr,Y[6]=St*Oe+ue*Bt+Pe*Yt,Y[7]=St*Le+ue*re+Pe*qe,Y[8]=St*Ve+ue*ye+Pe*vr,Y}function zt(Y,gt,he){var Oe=gt[0],Le=gt[1],Ve=gt[2],Bt=gt[3],re=gt[4],ye=gt[5],Yt=gt[6],qe=gt[7],vr=gt[8],oe=he[0],qt=he[1];return Y[0]=Oe,Y[1]=Le,Y[2]=Ve,Y[3]=Bt,Y[4]=re,Y[5]=ye,Y[6]=oe*Oe+qt*Bt+Yt,Y[7]=oe*Le+qt*re+qe,Y[8]=oe*Ve+qt*ye+vr,Y}function P(Y,gt,he){var Oe=gt[0],Le=gt[1],Ve=gt[2],Bt=gt[3],re=gt[4],ye=gt[5],Yt=gt[6],qe=gt[7],vr=gt[8],oe=Math.sin(he),qt=Math.cos(he);return Y[0]=qt*Oe+oe*Bt,Y[1]=qt*Le+oe*re,Y[2]=qt*Ve+oe*ye,Y[3]=qt*Bt-oe*Oe,Y[4]=qt*re-oe*Le,Y[5]=qt*ye-oe*Ve,Y[6]=Yt,Y[7]=qe,Y[8]=vr,Y}function b(Y,gt,he){var Oe=he[0],Le=he[1];return Y[0]=Oe*gt[0],Y[1]=Oe*gt[1],Y[2]=Oe*gt[2],Y[3]=Le*gt[3],Y[4]=Le*gt[4],Y[5]=Le*gt[5],Y[6]=gt[6],Y[7]=gt[7],Y[8]=gt[8],Y}function W(Y,gt){return Y[0]=1,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=1,Y[5]=0,Y[6]=gt[0],Y[7]=gt[1],Y[8]=1,Y}function le(Y,gt){var he=Math.sin(gt),Oe=Math.cos(gt);return Y[0]=Oe,Y[1]=he,Y[2]=0,Y[3]=-he,Y[4]=Oe,Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1,Y}function Ee(Y,gt){return Y[0]=gt[0],Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=gt[1],Y[5]=0,Y[6]=0,Y[7]=0,Y[8]=1,Y}function ke(Y,gt){return Y[0]=gt[0],Y[1]=gt[1],Y[2]=0,Y[3]=gt[2],Y[4]=gt[3],Y[5]=0,Y[6]=gt[4],Y[7]=gt[5],Y[8]=1,Y}function Tt(Y,gt){var he=gt[0],Oe=gt[1],Le=gt[2],Ve=gt[3],Bt=he+he,re=Oe+Oe,ye=Le+Le,Yt=he*Bt,qe=Oe*Bt,vr=Oe*re,oe=Le*Bt,qt=Le*re,bt=Le*ye,Wt=Ve*Bt,$t=Ve*re,xt=Ve*ye;return Y[0]=1-vr-bt,Y[3]=qe-xt,Y[6]=oe+$t,Y[1]=qe+xt,Y[4]=1-Yt-bt,Y[7]=qt-Wt,Y[2]=oe-$t,Y[5]=qt+Wt,Y[8]=1-Yt-vr,Y}function rt(Y,gt){var he=gt[0],Oe=gt[1],Le=gt[2],Ve=gt[3],Bt=gt[4],re=gt[5],ye=gt[6],Yt=gt[7],qe=gt[8],vr=gt[9],oe=gt[10],qt=gt[11],bt=gt[12],Wt=gt[13],$t=gt[14],xt=gt[15],St=he*re-Oe*Bt,ue=he*ye-Le*Bt,Pe=he*Yt-Ve*Bt,ze=Oe*ye-Le*re,Vt=Oe*Yt-Ve*re,Ct=Le*Yt-Ve*ye,At=qe*Wt-vr*bt,Nt=qe*$t-oe*bt,tt=qe*xt-qt*bt,vt=vr*$t-oe*Wt,Ht=vr*xt-qt*Wt,de=oe*xt-qt*$t,jt=St*de-ue*Ht+Pe*vt+ze*tt-Vt*Nt+Ct*At;return jt?(jt=1/jt,Y[0]=(re*de-ye*Ht+Yt*vt)*jt,Y[1]=(ye*tt-Bt*de-Yt*Nt)*jt,Y[2]=(Bt*Ht-re*tt+Yt*At)*jt,Y[3]=(Le*Ht-Oe*de-Ve*vt)*jt,Y[4]=(he*de-Le*tt+Ve*Nt)*jt,Y[5]=(Oe*tt-he*Ht-Ve*At)*jt,Y[6]=(Wt*Ct-$t*Vt+xt*ze)*jt,Y[7]=($t*Pe-bt*Ct-xt*ue)*jt,Y[8]=(bt*Vt-Wt*Pe+xt*St)*jt,Y):null}function Dt(Y,gt,he){return Y[0]=2/gt,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=-2/he,Y[5]=0,Y[6]=-1,Y[7]=1,Y[8]=1,Y}function Se(Y){return"mat3("+Y[0]+", "+Y[1]+", "+Y[2]+", "+Y[3]+", "+Y[4]+", "+Y[5]+", "+Y[6]+", "+Y[7]+", "+Y[8]+")"}function _e(Y){return Math.hypot(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5],Y[6],Y[7],Y[8])}function ve(Y,gt,he){return Y[0]=gt[0]+he[0],Y[1]=gt[1]+he[1],Y[2]=gt[2]+he[2],Y[3]=gt[3]+he[3],Y[4]=gt[4]+he[4],Y[5]=gt[5]+he[5],Y[6]=gt[6]+he[6],Y[7]=gt[7]+he[7],Y[8]=gt[8]+he[8],Y}function ne(Y,gt,he){return Y[0]=gt[0]-he[0],Y[1]=gt[1]-he[1],Y[2]=gt[2]-he[2],Y[3]=gt[3]-he[3],Y[4]=gt[4]-he[4],Y[5]=gt[5]-he[5],Y[6]=gt[6]-he[6],Y[7]=gt[7]-he[7],Y[8]=gt[8]-he[8],Y}function xe(Y,gt,he){return Y[0]=gt[0]*he,Y[1]=gt[1]*he,Y[2]=gt[2]*he,Y[3]=gt[3]*he,Y[4]=gt[4]*he,Y[5]=gt[5]*he,Y[6]=gt[6]*he,Y[7]=gt[7]*he,Y[8]=gt[8]*he,Y}function Je(Y,gt,he,Oe){return Y[0]=gt[0]+he[0]*Oe,Y[1]=gt[1]+he[1]*Oe,Y[2]=gt[2]+he[2]*Oe,Y[3]=gt[3]+he[3]*Oe,Y[4]=gt[4]+he[4]*Oe,Y[5]=gt[5]+he[5]*Oe,Y[6]=gt[6]+he[6]*Oe,Y[7]=gt[7]+he[7]*Oe,Y[8]=gt[8]+he[8]*Oe,Y}function Ot(Y,gt){return Y[0]===gt[0]&&Y[1]===gt[1]&&Y[2]===gt[2]&&Y[3]===gt[3]&&Y[4]===gt[4]&&Y[5]===gt[5]&&Y[6]===gt[6]&&Y[7]===gt[7]&&Y[8]===gt[8]}function te(Y,gt){var he=Y[0],Oe=Y[1],Le=Y[2],Ve=Y[3],Bt=Y[4],re=Y[5],ye=Y[6],Yt=Y[7],qe=Y[8],vr=gt[0],oe=gt[1],qt=gt[2],bt=gt[3],Wt=gt[4],$t=gt[5],xt=gt[6],St=gt[7],ue=gt[8];return Math.abs(he-vr)<=glMatrix.EPSILON*Math.max(1,Math.abs(he),Math.abs(vr))&&Math.abs(Oe-oe)<=glMatrix.EPSILON*Math.max(1,Math.abs(Oe),Math.abs(oe))&&Math.abs(Le-qt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Le),Math.abs(qt))&&Math.abs(Ve-bt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ve),Math.abs(bt))&&Math.abs(Bt-Wt)<=glMatrix.EPSILON*Math.max(1,Math.abs(Bt),Math.abs(Wt))&&Math.abs(re-$t)<=glMatrix.EPSILON*Math.max(1,Math.abs(re),Math.abs($t))&&Math.abs(ye-xt)<=glMatrix.EPSILON*Math.max(1,Math.abs(ye),Math.abs(xt))&&Math.abs(Yt-St)<=glMatrix.EPSILON*Math.max(1,Math.abs(Yt),Math.abs(St))&&Math.abs(qe-ue)<=glMatrix.EPSILON*Math.max(1,Math.abs(qe),Math.abs(ue))}var ft=null,wt=null},1153:function(dn,Pt,nt){"use strict";nt.d(Pt,{$X:function(){return pt},AK:function(){return ve},EU:function(){return gt},Fp:function(){return P},Fv:function(){return _e},I6:function(){return Le},IH:function(){return J},JG:function(){return K},TE:function(){return Ee},Ue:function(){return mt},VV:function(){return zt},al:function(){return Et},bA:function(){return W},kE:function(){return Tt},kK:function(){return ft},lu:function(){return re},t7:function(){return xe},t8:function(){return yt},tk:function(){return Dt}});var kt=nt(96140);function mt(){var bt=new kt.WT(2);return kt.WT!=Float32Array&&(bt[0]=0,bt[1]=0),bt}function k(bt){var Wt=new glMatrix.ARRAY_TYPE(2);return Wt[0]=bt[0],Wt[1]=bt[1],Wt}function Et(bt,Wt){var $t=new kt.WT(2);return $t[0]=bt,$t[1]=Wt,$t}function K(bt,Wt){return bt[0]=Wt[0],bt[1]=Wt[1],bt}function yt(bt,Wt,$t){return bt[0]=Wt,bt[1]=$t,bt}function J(bt,Wt,$t){return bt[0]=Wt[0]+$t[0],bt[1]=Wt[1]+$t[1],bt}function pt(bt,Wt,$t){return bt[0]=Wt[0]-$t[0],bt[1]=Wt[1]-$t[1],bt}function et(bt,Wt,$t){return bt[0]=Wt[0]*$t[0],bt[1]=Wt[1]*$t[1],bt}function be(bt,Wt,$t){return bt[0]=Wt[0]/$t[0],bt[1]=Wt[1]/$t[1],bt}function ot(bt,Wt){return bt[0]=Math.ceil(Wt[0]),bt[1]=Math.ceil(Wt[1]),bt}function ut(bt,Wt){return bt[0]=Math.floor(Wt[0]),bt[1]=Math.floor(Wt[1]),bt}function zt(bt,Wt,$t){return bt[0]=Math.min(Wt[0],$t[0]),bt[1]=Math.min(Wt[1],$t[1]),bt}function P(bt,Wt,$t){return bt[0]=Math.max(Wt[0],$t[0]),bt[1]=Math.max(Wt[1],$t[1]),bt}function b(bt,Wt){return bt[0]=Math.round(Wt[0]),bt[1]=Math.round(Wt[1]),bt}function W(bt,Wt,$t){return bt[0]=Wt[0]*$t,bt[1]=Wt[1]*$t,bt}function le(bt,Wt,$t,xt){return bt[0]=Wt[0]+$t[0]*xt,bt[1]=Wt[1]+$t[1]*xt,bt}function Ee(bt,Wt){var $t=Wt[0]-bt[0],xt=Wt[1]-bt[1];return Math.hypot($t,xt)}function ke(bt,Wt){var $t=Wt[0]-bt[0],xt=Wt[1]-bt[1];return $t*$t+xt*xt}function Tt(bt){var Wt=bt[0],$t=bt[1];return Math.hypot(Wt,$t)}function rt(bt){var Wt=bt[0],$t=bt[1];return Wt*Wt+$t*$t}function Dt(bt,Wt){return bt[0]=-Wt[0],bt[1]=-Wt[1],bt}function Se(bt,Wt){return bt[0]=1/Wt[0],bt[1]=1/Wt[1],bt}function _e(bt,Wt){var $t=Wt[0],xt=Wt[1],St=$t*$t+xt*xt;return St>0&&(St=1/Math.sqrt(St)),bt[0]=Wt[0]*St,bt[1]=Wt[1]*St,bt}function ve(bt,Wt){return bt[0]*Wt[0]+bt[1]*Wt[1]}function ne(bt,Wt,$t){var xt=Wt[0]*$t[1]-Wt[1]*$t[0];return bt[0]=bt[1]=0,bt[2]=xt,bt}function xe(bt,Wt,$t,xt){var St=Wt[0],ue=Wt[1];return bt[0]=St+xt*($t[0]-St),bt[1]=ue+xt*($t[1]-ue),bt}function Je(bt,Wt){Wt=Wt||1;var $t=glMatrix.RANDOM()*2*Math.PI;return bt[0]=Math.cos($t)*Wt,bt[1]=Math.sin($t)*Wt,bt}function Ot(bt,Wt,$t){var xt=Wt[0],St=Wt[1];return bt[0]=$t[0]*xt+$t[2]*St,bt[1]=$t[1]*xt+$t[3]*St,bt}function te(bt,Wt,$t){var xt=Wt[0],St=Wt[1];return bt[0]=$t[0]*xt+$t[2]*St+$t[4],bt[1]=$t[1]*xt+$t[3]*St+$t[5],bt}function ft(bt,Wt,$t){var xt=Wt[0],St=Wt[1];return bt[0]=$t[0]*xt+$t[3]*St+$t[6],bt[1]=$t[1]*xt+$t[4]*St+$t[7],bt}function wt(bt,Wt,$t){var xt=Wt[0],St=Wt[1];return bt[0]=$t[0]*xt+$t[4]*St+$t[12],bt[1]=$t[1]*xt+$t[5]*St+$t[13],bt}function Y(bt,Wt,$t,xt){var St=Wt[0]-$t[0],ue=Wt[1]-$t[1],Pe=Math.sin(xt),ze=Math.cos(xt);return bt[0]=St*ze-ue*Pe+$t[0],bt[1]=St*Pe+ue*ze+$t[1],bt}function gt(bt,Wt){var $t=bt[0],xt=bt[1],St=Wt[0],ue=Wt[1],Pe=Math.sqrt($t*$t+xt*xt)*Math.sqrt(St*St+ue*ue),ze=Pe&&($t*St+xt*ue)/Pe;return Math.acos(Math.min(Math.max(ze,-1),1))}function he(bt){return bt[0]=0,bt[1]=0,bt}function Oe(bt){return"vec2("+bt[0]+", "+bt[1]+")"}function Le(bt,Wt){return bt[0]===Wt[0]&&bt[1]===Wt[1]}function Ve(bt,Wt){var $t=bt[0],xt=bt[1],St=Wt[0],ue=Wt[1];return Math.abs($t-St)<=glMatrix.EPSILON*Math.max(1,Math.abs($t),Math.abs(St))&&Math.abs(xt-ue)<=glMatrix.EPSILON*Math.max(1,Math.abs(xt),Math.abs(ue))}var Bt=null,re=pt,ye=null,Yt=null,qe=null,vr=null,oe=null,qt=function(){var bt=mt();return function(Wt,$t,xt,St,ue,Pe){var ze,Vt;for($t||($t=2),xt||(xt=0),St?Vt=Math.min(St*$t+xt,Wt.length):Vt=Wt.length,ze=xt;ze<Vt;ze+=$t)bt[0]=Wt[ze],bt[1]=Wt[ze+1],ue(bt,bt,Pe),Wt[ze]=bt[0],Wt[ze+1]=bt[1];return Wt}}()},68072:function(dn,Pt,nt){"use strict";nt.r(Pt),nt.d(Pt,{add:function(){return pt},angle:function(){return Le},bezier:function(){return Ot},ceil:function(){return ut},clone:function(){return k},copy:function(){return yt},create:function(){return mt},cross:function(){return ne},dist:function(){return oe},distance:function(){return ke},div:function(){return vr},divide:function(){return ot},dot:function(){return ve},equals:function(){return ye},exactEquals:function(){return re},floor:function(){return zt},forEach:function(){return $t},fromValues:function(){return K},hermite:function(){return Je},inverse:function(){return Se},len:function(){return bt},length:function(){return Et},lerp:function(){return xe},max:function(){return b},min:function(){return P},mul:function(){return qe},multiply:function(){return be},negate:function(){return Dt},normalize:function(){return _e},random:function(){return te},rotateX:function(){return gt},rotateY:function(){return he},rotateZ:function(){return Oe},round:function(){return W},scale:function(){return le},scaleAndAdd:function(){return Ee},set:function(){return J},sqrDist:function(){return qt},sqrLen:function(){return Wt},squaredDistance:function(){return Tt},squaredLength:function(){return rt},str:function(){return Bt},sub:function(){return Yt},subtract:function(){return et},transformMat3:function(){return wt},transformMat4:function(){return ft},transformQuat:function(){return Y},zero:function(){return Ve}});var kt=nt(96140);function mt(){var xt=new kt.WT(3);return kt.WT!=Float32Array&&(xt[0]=0,xt[1]=0,xt[2]=0),xt}function k(xt){var St=new kt.WT(3);return St[0]=xt[0],St[1]=xt[1],St[2]=xt[2],St}function Et(xt){var St=xt[0],ue=xt[1],Pe=xt[2];return Math.hypot(St,ue,Pe)}function K(xt,St,ue){var Pe=new kt.WT(3);return Pe[0]=xt,Pe[1]=St,Pe[2]=ue,Pe}function yt(xt,St){return xt[0]=St[0],xt[1]=St[1],xt[2]=St[2],xt}function J(xt,St,ue,Pe){return xt[0]=St,xt[1]=ue,xt[2]=Pe,xt}function pt(xt,St,ue){return xt[0]=St[0]+ue[0],xt[1]=St[1]+ue[1],xt[2]=St[2]+ue[2],xt}function et(xt,St,ue){return xt[0]=St[0]-ue[0],xt[1]=St[1]-ue[1],xt[2]=St[2]-ue[2],xt}function be(xt,St,ue){return xt[0]=St[0]*ue[0],xt[1]=St[1]*ue[1],xt[2]=St[2]*ue[2],xt}function ot(xt,St,ue){return xt[0]=St[0]/ue[0],xt[1]=St[1]/ue[1],xt[2]=St[2]/ue[2],xt}function ut(xt,St){return xt[0]=Math.ceil(St[0]),xt[1]=Math.ceil(St[1]),xt[2]=Math.ceil(St[2]),xt}function zt(xt,St){return xt[0]=Math.floor(St[0]),xt[1]=Math.floor(St[1]),xt[2]=Math.floor(St[2]),xt}function P(xt,St,ue){return xt[0]=Math.min(St[0],ue[0]),xt[1]=Math.min(St[1],ue[1]),xt[2]=Math.min(St[2],ue[2]),xt}function b(xt,St,ue){return xt[0]=Math.max(St[0],ue[0]),xt[1]=Math.max(St[1],ue[1]),xt[2]=Math.max(St[2],ue[2]),xt}function W(xt,St){return xt[0]=Math.round(St[0]),xt[1]=Math.round(St[1]),xt[2]=Math.round(St[2]),xt}function le(xt,St,ue){return xt[0]=St[0]*ue,xt[1]=St[1]*ue,xt[2]=St[2]*ue,xt}function Ee(xt,St,ue,Pe){return xt[0]=St[0]+ue[0]*Pe,xt[1]=St[1]+ue[1]*Pe,xt[2]=St[2]+ue[2]*Pe,xt}function ke(xt,St){var ue=St[0]-xt[0],Pe=St[1]-xt[1],ze=St[2]-xt[2];return Math.hypot(ue,Pe,ze)}function Tt(xt,St){var ue=St[0]-xt[0],Pe=St[1]-xt[1],ze=St[2]-xt[2];return ue*ue+Pe*Pe+ze*ze}function rt(xt){var St=xt[0],ue=xt[1],Pe=xt[2];return St*St+ue*ue+Pe*Pe}function Dt(xt,St){return xt[0]=-St[0],xt[1]=-St[1],xt[2]=-St[2],xt}function Se(xt,St){return xt[0]=1/St[0],xt[1]=1/St[1],xt[2]=1/St[2],xt}function _e(xt,St){var ue=St[0],Pe=St[1],ze=St[2],Vt=ue*ue+Pe*Pe+ze*ze;return Vt>0&&(Vt=1/Math.sqrt(Vt)),xt[0]=St[0]*Vt,xt[1]=St[1]*Vt,xt[2]=St[2]*Vt,xt}function ve(xt,St){return xt[0]*St[0]+xt[1]*St[1]+xt[2]*St[2]}function ne(xt,St,ue){var Pe=St[0],ze=St[1],Vt=St[2],Ct=ue[0],At=ue[1],Nt=ue[2];return xt[0]=ze*Nt-Vt*At,xt[1]=Vt*Ct-Pe*Nt,xt[2]=Pe*At-ze*Ct,xt}function xe(xt,St,ue,Pe){var ze=St[0],Vt=St[1],Ct=St[2];return xt[0]=ze+Pe*(ue[0]-ze),xt[1]=Vt+Pe*(ue[1]-Vt),xt[2]=Ct+Pe*(ue[2]-Ct),xt}function Je(xt,St,ue,Pe,ze,Vt){var Ct=Vt*Vt,At=Ct*(2*Vt-3)+1,Nt=Ct*(Vt-2)+Vt,tt=Ct*(Vt-1),vt=Ct*(3-2*Vt);return xt[0]=St[0]*At+ue[0]*Nt+Pe[0]*tt+ze[0]*vt,xt[1]=St[1]*At+ue[1]*Nt+Pe[1]*tt+ze[1]*vt,xt[2]=St[2]*At+ue[2]*Nt+Pe[2]*tt+ze[2]*vt,xt}function Ot(xt,St,ue,Pe,ze,Vt){var Ct=1-Vt,At=Ct*Ct,Nt=Vt*Vt,tt=At*Ct,vt=3*Vt*At,Ht=3*Nt*Ct,de=Nt*Vt;return xt[0]=St[0]*tt+ue[0]*vt+Pe[0]*Ht+ze[0]*de,xt[1]=St[1]*tt+ue[1]*vt+Pe[1]*Ht+ze[1]*de,xt[2]=St[2]*tt+ue[2]*vt+Pe[2]*Ht+ze[2]*de,xt}function te(xt,St){St=St||1;var ue=kt.FD()*2*Math.PI,Pe=kt.FD()*2-1,ze=Math.sqrt(1-Pe*Pe)*St;return xt[0]=Math.cos(ue)*ze,xt[1]=Math.sin(ue)*ze,xt[2]=Pe*St,xt}function ft(xt,St,ue){var Pe=St[0],ze=St[1],Vt=St[2],Ct=ue[3]*Pe+ue[7]*ze+ue[11]*Vt+ue[15];return Ct=Ct||1,xt[0]=(ue[0]*Pe+ue[4]*ze+ue[8]*Vt+ue[12])/Ct,xt[1]=(ue[1]*Pe+ue[5]*ze+ue[9]*Vt+ue[13])/Ct,xt[2]=(ue[2]*Pe+ue[6]*ze+ue[10]*Vt+ue[14])/Ct,xt}function wt(xt,St,ue){var Pe=St[0],ze=St[1],Vt=St[2];return xt[0]=Pe*ue[0]+ze*ue[3]+Vt*ue[6],xt[1]=Pe*ue[1]+ze*ue[4]+Vt*ue[7],xt[2]=Pe*ue[2]+ze*ue[5]+Vt*ue[8],xt}function Y(xt,St,ue){var Pe=ue[0],ze=ue[1],Vt=ue[2],Ct=ue[3],At=St[0],Nt=St[1],tt=St[2],vt=ze*tt-Vt*Nt,Ht=Vt*At-Pe*tt,de=Pe*Nt-ze*At,jt=ze*de-Vt*Ht,Ie=Vt*vt-Pe*de,We=Pe*Ht-ze*vt,Ke=Ct*2;return vt*=Ke,Ht*=Ke,de*=Ke,jt*=2,Ie*=2,We*=2,xt[0]=At+vt+jt,xt[1]=Nt+Ht+Ie,xt[2]=tt+de+We,xt}function gt(xt,St,ue,Pe){var ze=[],Vt=[];return ze[0]=St[0]-ue[0],ze[1]=St[1]-ue[1],ze[2]=St[2]-ue[2],Vt[0]=ze[0],Vt[1]=ze[1]*Math.cos(Pe)-ze[2]*Math.sin(Pe),Vt[2]=ze[1]*Math.sin(Pe)+ze[2]*Math.cos(Pe),xt[0]=Vt[0]+ue[0],xt[1]=Vt[1]+ue[1],xt[2]=Vt[2]+ue[2],xt}function he(xt,St,ue,Pe){var ze=[],Vt=[];return ze[0]=St[0]-ue[0],ze[1]=St[1]-ue[1],ze[2]=St[2]-ue[2],Vt[0]=ze[2]*Math.sin(Pe)+ze[0]*Math.cos(Pe),Vt[1]=ze[1],Vt[2]=ze[2]*Math.cos(Pe)-ze[0]*Math.sin(Pe),xt[0]=Vt[0]+ue[0],xt[1]=Vt[1]+ue[1],xt[2]=Vt[2]+ue[2],xt}function Oe(xt,St,ue,Pe){var ze=[],Vt=[];return ze[0]=St[0]-ue[0],ze[1]=St[1]-ue[1],ze[2]=St[2]-ue[2],Vt[0]=ze[0]*Math.cos(Pe)-ze[1]*Math.sin(Pe),Vt[1]=ze[0]*Math.sin(Pe)+ze[1]*Math.cos(Pe),Vt[2]=ze[2],xt[0]=Vt[0]+ue[0],xt[1]=Vt[1]+ue[1],xt[2]=Vt[2]+ue[2],xt}function Le(xt,St){var ue=xt[0],Pe=xt[1],ze=xt[2],Vt=St[0],Ct=St[1],At=St[2],Nt=Math.sqrt(ue*ue+Pe*Pe+ze*ze),tt=Math.sqrt(Vt*Vt+Ct*Ct+At*At),vt=Nt*tt,Ht=vt&&ve(xt,St)/vt;return Math.acos(Math.min(Math.max(Ht,-1),1))}function Ve(xt){return xt[0]=0,xt[1]=0,xt[2]=0,xt}function Bt(xt){return"vec3("+xt[0]+", "+xt[1]+", "+xt[2]+")"}function re(xt,St){return xt[0]===St[0]&&xt[1]===St[1]&&xt[2]===St[2]}function ye(xt,St){var ue=xt[0],Pe=xt[1],ze=xt[2],Vt=St[0],Ct=St[1],At=St[2];return Math.abs(ue-Vt)<=kt.Ib*Math.max(1,Math.abs(ue),Math.abs(Vt))&&Math.abs(Pe-Ct)<=kt.Ib*Math.max(1,Math.abs(Pe),Math.abs(Ct))&&Math.abs(ze-At)<=kt.Ib*Math.max(1,Math.abs(ze),Math.abs(At))}var Yt=et,qe=be,vr=ot,oe=ke,qt=Tt,bt=Et,Wt=rt,$t=function(){var xt=mt();return function(St,ue,Pe,ze,Vt,Ct){var At,Nt;for(ue||(ue=3),Pe||(Pe=0),ze?Nt=Math.min(ze*ue+Pe,St.length):Nt=St.length,At=Pe;At<Nt;At+=ue)xt[0]=St[At],xt[1]=St[At+1],xt[2]=St[At+2],Vt(xt,xt,Ct),St[At]=xt[0],St[At+1]=xt[1],St[At+2]=xt[2];return St}}()},34686:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});var nt=Symbol.for("INJECTION");function kt(yt,J,pt,et){function be(){return et&&!Reflect.hasMetadata(nt,this,J)&&Reflect.defineMetadata(nt,pt(),this,J),Reflect.hasMetadata(nt,this,J)?Reflect.getMetadata(nt,this,J):pt()}function ot(ut){Reflect.defineMetadata(nt,ut,this,J)}Object.defineProperty(yt,J,{configurable:!0,enumerable:!0,get:be,set:ot})}function mt(yt,J){return function(pt){return function(et,be){var ot=function(){return yt.get(pt)};kt(et,be,ot,J)}}}Pt.makePropertyInjectDecorator=mt;function k(yt,J){return function(pt,et){return function(be,ot){var ut=function(){return yt.getNamed(pt,et)};kt(be,ot,ut,J)}}}Pt.makePropertyInjectNamedDecorator=k;function Et(yt,J){return function(pt,et,be){return function(ot,ut){var zt=function(){return yt.getTagged(pt,et,be)};kt(ot,ut,zt,J)}}}Pt.makePropertyInjectTaggedDecorator=Et;function K(yt,J){return function(pt){return function(et,be){var ot=function(){return yt.getAll(pt)};kt(et,be,ot,J)}}}Pt.makePropertyMultiInjectDecorator=K},82615:function(dn,Pt,nt){"use strict";var kt;kt={value:!0};var mt=nt(34686);function k(Et,K){K===void 0&&(K=!0);var yt=mt.makePropertyInjectDecorator(Et,K),J=mt.makePropertyInjectNamedDecorator(Et,K),pt=mt.makePropertyInjectTaggedDecorator(Et,K),et=mt.makePropertyMultiInjectDecorator(Et,K);return{lazyInject:yt,lazyInjectNamed:J,lazyInjectTagged:pt,lazyMultiInject:et}}Pt.Z=k},90333:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.tagProperty=Pt.tagParameter=Pt.decorate=void 0;var kt=nt(52050),mt=nt(91193);function k(et,be,ot,ut){var zt=mt.TAGGED;K(zt,et,be,ut,ot)}Pt.tagParameter=k;function Et(et,be,ot){var ut=mt.TAGGED_PROP;K(ut,et.constructor,be,ot)}Pt.tagProperty=Et;function K(et,be,ot,ut,zt){var P={},b=typeof zt=="number",W=zt!==void 0&&b?zt.toString():ot;if(b&&ot!==void 0)throw new Error(kt.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(et,be)&&(P=Reflect.getMetadata(et,be));var le=P[W];if(!Array.isArray(le))le=[];else for(var Ee=0,ke=le;Ee<ke.length;Ee++){var Tt=ke[Ee];if(Tt.key===ut.key)throw new Error(kt.DUPLICATED_METADATA+" "+Tt.key.toString())}le.push(ut),P[W]=le,Reflect.defineMetadata(et,P,be)}function yt(et,be){Reflect.decorate(et,be)}function J(et,be){return function(ot,ut){be(ot,ut,et)}}function pt(et,be,ot){typeof ot=="number"?yt([J(ot,et)],be):typeof ot=="string"?Reflect.decorate([et],be,ot):yt([et],be)}Pt.decorate=pt},70105:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.inject=Pt.LazyServiceIdentifer=void 0;var kt=nt(52050),mt=nt(91193),k=nt(55650),Et=nt(90333),K=function(){function J(pt){this._cb=pt}return J.prototype.unwrap=function(){return this._cb()},J}();Pt.LazyServiceIdentifer=K;function yt(J){return function(pt,et,be){if(J===void 0)throw new Error(kt.UNDEFINED_INJECT_ANNOTATION(pt.name));var ot=new k.Metadata(mt.INJECT_TAG,J);typeof be=="number"?Et.tagParameter(pt,et,be,ot):Et.tagProperty(pt,et,ot)}}Pt.inject=yt},9719:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.injectable=void 0;var kt=nt(52050),mt=nt(91193);function k(){return function(Et){if(Reflect.hasOwnMetadata(mt.PARAM_TYPES,Et))throw new Error(kt.DUPLICATED_INJECTABLE_DECORATOR);var K=Reflect.getMetadata(mt.DESIGN_PARAM_TYPES,Et)||[];return Reflect.defineMetadata(mt.PARAM_TYPES,K,Et),Et}}Pt.injectable=k},81623:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.multiInject=void 0;var kt=nt(91193),mt=nt(55650),k=nt(90333);function Et(K){return function(yt,J,pt){var et=new mt.Metadata(kt.MULTI_INJECT_TAG,K);typeof pt=="number"?k.tagParameter(yt,J,pt,et):k.tagProperty(yt,J,et)}}Pt.multiInject=Et},69481:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.named=void 0;var kt=nt(91193),mt=nt(55650),k=nt(90333);function Et(K){return function(yt,J,pt){var et=new mt.Metadata(kt.NAMED_TAG,K);typeof pt=="number"?k.tagParameter(yt,J,pt,et):k.tagProperty(yt,J,et)}}Pt.named=Et},35231:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.optional=void 0;var kt=nt(91193),mt=nt(55650),k=nt(90333);function Et(){return function(K,yt,J){var pt=new mt.Metadata(kt.OPTIONAL_TAG,!0);typeof J=="number"?k.tagParameter(K,yt,J,pt):k.tagProperty(K,yt,pt)}}Pt.optional=Et},17419:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.postConstruct=void 0;var kt=nt(52050),mt=nt(91193),k=nt(55650);function Et(){return function(K,yt,J){var pt=new k.Metadata(mt.POST_CONSTRUCT,yt);if(Reflect.hasOwnMetadata(mt.POST_CONSTRUCT,K.constructor))throw new Error(kt.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(mt.POST_CONSTRUCT,pt,K.constructor)}}Pt.postConstruct=Et},97404:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.tagged=void 0;var kt=nt(55650),mt=nt(90333);function k(Et,K){return function(yt,J,pt){var et=new kt.Metadata(Et,K);typeof pt=="number"?mt.tagParameter(yt,J,pt,et):mt.tagProperty(yt,J,et)}}Pt.tagged=k},11580:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.targetName=void 0;var kt=nt(91193),mt=nt(55650),k=nt(90333);function Et(K){return function(yt,J,pt){var et=new mt.Metadata(kt.NAME_TAG,K);k.tagParameter(yt,J,pt,et)}}Pt.targetName=Et},8814:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.unmanaged=void 0;var kt=nt(91193),mt=nt(55650),k=nt(90333);function Et(){return function(K,yt,J){var pt=new mt.Metadata(kt.UNMANAGED_TAG,!0);k.tagParameter(K,yt,J,pt)}}Pt.unmanaged=Et},45210:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Binding=void 0;var kt=nt(88795),mt=nt(18576),k=function(){function Et(K,yt){this.id=mt.id(),this.activated=!1,this.serviceIdentifier=K,this.scope=yt,this.type=kt.BindingTypeEnum.Invalid,this.constraint=function(J){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return Et.prototype.clone=function(){var K=new Et(this.serviceIdentifier,this.scope);return K.activated=K.scope===kt.BindingScopeEnum.Singleton?this.activated:!1,K.implementationType=this.implementationType,K.dynamicValue=this.dynamicValue,K.scope=this.scope,K.type=this.type,K.factory=this.factory,K.provider=this.provider,K.constraint=this.constraint,K.onActivation=this.onActivation,K.cache=this.cache,K},Et}();Pt.Binding=k},44276:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingCount=void 0;var nt={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};Pt.BindingCount=nt},52050:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.STACK_OVERFLOW=Pt.CIRCULAR_DEPENDENCY_IN_FACTORY=Pt.POST_CONSTRUCT_ERROR=Pt.MULTIPLE_POST_CONSTRUCT_METHODS=Pt.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Pt.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Pt.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Pt.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Pt.ARGUMENTS_LENGTH_MISMATCH=Pt.INVALID_DECORATOR_OPERATION=Pt.INVALID_TO_SELF_VALUE=Pt.INVALID_FUNCTION_BINDING=Pt.INVALID_MIDDLEWARE_RETURN=Pt.NO_MORE_SNAPSHOTS_AVAILABLE=Pt.INVALID_BINDING_TYPE=Pt.NOT_IMPLEMENTED=Pt.CIRCULAR_DEPENDENCY=Pt.UNDEFINED_INJECT_ANNOTATION=Pt.MISSING_INJECT_ANNOTATION=Pt.MISSING_INJECTABLE_ANNOTATION=Pt.NOT_REGISTERED=Pt.CANNOT_UNBIND=Pt.AMBIGUOUS_MATCH=Pt.KEY_NOT_FOUND=Pt.NULL_ARGUMENT=Pt.DUPLICATED_METADATA=Pt.DUPLICATED_INJECTABLE_DECORATOR=void 0,Pt.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",Pt.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",Pt.NULL_ARGUMENT="NULL argument",Pt.KEY_NOT_FOUND="Key Not Found",Pt.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",Pt.CANNOT_UNBIND="Could not unbind serviceIdentifier:",Pt.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",Pt.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",Pt.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var nt=function(Et){return"@inject called with undefined this could mean that the class "+Et+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Pt.UNDEFINED_INJECT_ANNOTATION=nt,Pt.CIRCULAR_DEPENDENCY="Circular dependency found:",Pt.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",Pt.INVALID_BINDING_TYPE="Invalid binding type:",Pt.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",Pt.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",Pt.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",Pt.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",Pt.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var kt=function(){for(var Et=[],K=0;K<arguments.length;K++)Et[K]=arguments[K];return"The number of constructor arguments in the derived class "+(Et[0]+" must be >= than the number of constructor arguments of its base class.")};Pt.ARGUMENTS_LENGTH_MISMATCH=kt,Pt.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",Pt.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",Pt.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",Pt.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",Pt.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var mt=function(){for(var Et=[],K=0;K<arguments.length;K++)Et[K]=arguments[K];return"@postConstruct error in class "+Et[0]+": "+Et[1]};Pt.POST_CONSTRUCT_ERROR=mt;var k=function(){for(var Et=[],K=0;K<arguments.length;K++)Et[K]=arguments[K];return"It looks like there is a circular dependency "+("in one of the '"+Et[0]+"' bindings. Please investigate bindings with")+("service identifier '"+Et[1]+"'.")};Pt.CIRCULAR_DEPENDENCY_IN_FACTORY=k,Pt.STACK_OVERFLOW="Maximum call stack size exceeded"},88795:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.TargetTypeEnum=Pt.BindingTypeEnum=Pt.BindingScopeEnum=void 0;var nt={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Pt.BindingScopeEnum=nt;var kt={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Pt.BindingTypeEnum=kt;var mt={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Pt.TargetTypeEnum=mt},91193:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.NON_CUSTOM_TAG_KEYS=Pt.POST_CONSTRUCT=Pt.DESIGN_PARAM_TYPES=Pt.PARAM_TYPES=Pt.TAGGED_PROP=Pt.TAGGED=Pt.MULTI_INJECT_TAG=Pt.INJECT_TAG=Pt.OPTIONAL_TAG=Pt.UNMANAGED_TAG=Pt.NAME_TAG=Pt.NAMED_TAG=void 0,Pt.NAMED_TAG="named",Pt.NAME_TAG="name",Pt.UNMANAGED_TAG="unmanaged",Pt.OPTIONAL_TAG="optional",Pt.INJECT_TAG="inject",Pt.MULTI_INJECT_TAG="multi_inject",Pt.TAGGED="inversify:tagged",Pt.TAGGED_PROP="inversify:tagged_props",Pt.PARAM_TYPES="inversify:paramtypes",Pt.DESIGN_PARAM_TYPES="design:paramtypes",Pt.POST_CONSTRUCT="post_construct";function nt(){return[Pt.INJECT_TAG,Pt.MULTI_INJECT_TAG,Pt.NAME_TAG,Pt.UNMANAGED_TAG,Pt.NAMED_TAG,Pt.OPTIONAL_TAG]}Pt.NON_CUSTOM_TAG_KEYS=nt()},46769:function(dn,Pt,nt){"use strict";var kt=this&&this.__awaiter||function(le,Ee,ke,Tt){function rt(Dt){return Dt instanceof ke?Dt:new ke(function(Se){Se(Dt)})}return new(ke||(ke=Promise))(function(Dt,Se){function _e(xe){try{ne(Tt.next(xe))}catch(Je){Se(Je)}}function ve(xe){try{ne(Tt.throw(xe))}catch(Je){Se(Je)}}function ne(xe){xe.done?Dt(xe.value):rt(xe.value).then(_e,ve)}ne((Tt=Tt.apply(le,Ee||[])).next())})},mt=this&&this.__generator||function(le,Ee){var ke={label:0,sent:function(){if(Dt[0]&1)throw Dt[1];return Dt[1]},trys:[],ops:[]},Tt,rt,Dt,Se;return Se={next:_e(0),throw:_e(1),return:_e(2)},typeof Symbol=="function"&&(Se[Symbol.iterator]=function(){return this}),Se;function _e(ne){return function(xe){return ve([ne,xe])}}function ve(ne){if(Tt)throw new TypeError("Generator is already executing.");for(;ke;)try{if(Tt=1,rt&&(Dt=ne[0]&2?rt.return:ne[0]?rt.throw||((Dt=rt.return)&&Dt.call(rt),0):rt.next)&&!(Dt=Dt.call(rt,ne[1])).done)return Dt;switch(rt=0,Dt&&(ne=[ne[0]&2,Dt.value]),ne[0]){case 0:case 1:Dt=ne;break;case 4:return ke.label++,{value:ne[1],done:!1};case 5:ke.label++,rt=ne[1],ne=[0];continue;case 7:ne=ke.ops.pop(),ke.trys.pop();continue;default:if(Dt=ke.trys,!(Dt=Dt.length>0&&Dt[Dt.length-1])&&(ne[0]===6||ne[0]===2)){ke=0;continue}if(ne[0]===3&&(!Dt||ne[1]>Dt[0]&&ne[1]<Dt[3])){ke.label=ne[1];break}if(ne[0]===6&&ke.label<Dt[1]){ke.label=Dt[1],Dt=ne;break}if(Dt&&ke.label<Dt[2]){ke.label=Dt[2],ke.ops.push(ne);break}Dt[2]&&ke.ops.pop(),ke.trys.pop();continue}ne=Ee.call(le,ke)}catch(xe){ne=[6,xe],rt=0}finally{Tt=Dt=0}if(ne[0]&5)throw ne[1];return{value:ne[0]?ne[1]:void 0,done:!0}}},k=this&&this.__spreadArray||function(le,Ee){for(var ke=0,Tt=Ee.length,rt=le.length;ke<Tt;ke++,rt++)le[rt]=Ee[ke];return le};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Container=void 0;var Et=nt(45210),K=nt(52050),yt=nt(88795),J=nt(91193),pt=nt(54594),et=nt(47572),be=nt(87536),ot=nt(43085),ut=nt(18576),zt=nt(80030),P=nt(80522),b=nt(96382),W=function(){function le(Ee){this._appliedMiddleware=[];var ke=Ee||{};if(typeof ke!="object")throw new Error(""+K.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(ke.defaultScope===void 0)ke.defaultScope=yt.BindingScopeEnum.Transient;else if(ke.defaultScope!==yt.BindingScopeEnum.Singleton&&ke.defaultScope!==yt.BindingScopeEnum.Transient&&ke.defaultScope!==yt.BindingScopeEnum.Request)throw new Error(""+K.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(ke.autoBindInjectable===void 0)ke.autoBindInjectable=!1;else if(typeof ke.autoBindInjectable!="boolean")throw new Error(""+K.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(ke.skipBaseClassChecks===void 0)ke.skipBaseClassChecks=!1;else if(typeof ke.skipBaseClassChecks!="boolean")throw new Error(""+K.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:ke.autoBindInjectable,defaultScope:ke.defaultScope,skipBaseClassChecks:ke.skipBaseClassChecks},this.id=ut.id(),this._bindingDictionary=new b.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new pt.MetadataReader}return le.merge=function(Ee,ke){for(var Tt=[],rt=2;rt<arguments.length;rt++)Tt[rt-2]=arguments[rt];var Dt=new le,Se=k([Ee,ke],Tt).map(function(ne){return et.getBindingDictionary(ne)}),_e=et.getBindingDictionary(Dt);function ve(ne,xe){ne.traverse(function(Je,Ot){Ot.forEach(function(te){xe.add(te.serviceIdentifier,te.clone())})})}return Se.forEach(function(ne){ve(ne,_e)}),Dt},le.prototype.load=function(){for(var Ee=[],ke=0;ke<arguments.length;ke++)Ee[ke]=arguments[ke];for(var Tt=this._getContainerModuleHelpersFactory(),rt=0,Dt=Ee;rt<Dt.length;rt++){var Se=Dt[rt],_e=Tt(Se.id);Se.registry(_e.bindFunction,_e.unbindFunction,_e.isboundFunction,_e.rebindFunction)}},le.prototype.loadAsync=function(){for(var Ee=[],ke=0;ke<arguments.length;ke++)Ee[ke]=arguments[ke];return kt(this,void 0,void 0,function(){var Tt,rt,Dt,Se,_e;return mt(this,function(ve){switch(ve.label){case 0:Tt=this._getContainerModuleHelpersFactory(),rt=0,Dt=Ee,ve.label=1;case 1:return rt<Dt.length?(Se=Dt[rt],_e=Tt(Se.id),[4,Se.registry(_e.bindFunction,_e.unbindFunction,_e.isboundFunction,_e.rebindFunction)]):[3,4];case 2:ve.sent(),ve.label=3;case 3:return rt++,[3,1];case 4:return[2]}})})},le.prototype.unload=function(){for(var Ee=this,ke=[],Tt=0;Tt<arguments.length;Tt++)ke[Tt]=arguments[Tt];var rt=function(Dt){return function(Se){return Se.moduleId===Dt}};ke.forEach(function(Dt){var Se=rt(Dt.id);Ee._bindingDictionary.removeByCondition(Se)})},le.prototype.bind=function(Ee){var ke=this.options.defaultScope||yt.BindingScopeEnum.Transient,Tt=new Et.Binding(Ee,ke);return this._bindingDictionary.add(Ee,Tt),new ot.BindingToSyntax(Tt)},le.prototype.rebind=function(Ee){return this.unbind(Ee),this.bind(Ee)},le.prototype.unbind=function(Ee){try{this._bindingDictionary.remove(Ee)}catch(ke){throw new Error(K.CANNOT_UNBIND+" "+zt.getServiceIdentifierAsString(Ee))}},le.prototype.unbindAll=function(){this._bindingDictionary=new b.Lookup},le.prototype.isBound=function(Ee){var ke=this._bindingDictionary.hasKey(Ee);return!ke&&this.parent&&(ke=this.parent.isBound(Ee)),ke},le.prototype.isBoundNamed=function(Ee,ke){return this.isBoundTagged(Ee,J.NAMED_TAG,ke)},le.prototype.isBoundTagged=function(Ee,ke,Tt){var rt=!1;if(this._bindingDictionary.hasKey(Ee)){var Dt=this._bindingDictionary.get(Ee),Se=et.createMockRequest(this,Ee,ke,Tt);rt=Dt.some(function(_e){return _e.constraint(Se)})}return!rt&&this.parent&&(rt=this.parent.isBoundTagged(Ee,ke,Tt)),rt},le.prototype.snapshot=function(){this._snapshots.push(P.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},le.prototype.restore=function(){var Ee=this._snapshots.pop();if(Ee===void 0)throw new Error(K.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Ee.bindings,this._middleware=Ee.middleware},le.prototype.createChild=function(Ee){var ke=new le(Ee||this.options);return ke.parent=this,ke},le.prototype.applyMiddleware=function(){for(var Ee=[],ke=0;ke<arguments.length;ke++)Ee[ke]=arguments[ke];this._appliedMiddleware=this._appliedMiddleware.concat(Ee);var Tt=this._middleware?this._middleware:this._planAndResolve();this._middleware=Ee.reduce(function(rt,Dt){return Dt(rt)},Tt)},le.prototype.applyCustomMetadataReader=function(Ee){this._metadataReader=Ee},le.prototype.get=function(Ee){return this._get(!1,!1,yt.TargetTypeEnum.Variable,Ee)},le.prototype.getTagged=function(Ee,ke,Tt){return this._get(!1,!1,yt.TargetTypeEnum.Variable,Ee,ke,Tt)},le.prototype.getNamed=function(Ee,ke){return this.getTagged(Ee,J.NAMED_TAG,ke)},le.prototype.getAll=function(Ee){return this._get(!0,!0,yt.TargetTypeEnum.Variable,Ee)},le.prototype.getAllTagged=function(Ee,ke,Tt){return this._get(!1,!0,yt.TargetTypeEnum.Variable,Ee,ke,Tt)},le.prototype.getAllNamed=function(Ee,ke){return this.getAllTagged(Ee,J.NAMED_TAG,ke)},le.prototype.resolve=function(Ee){var ke=this.createChild();return ke.bind(Ee).toSelf(),this._appliedMiddleware.forEach(function(Tt){ke.applyMiddleware(Tt)}),ke.get(Ee)},le.prototype._getContainerModuleHelpersFactory=function(){var Ee=this,ke=function(_e,ve){_e._binding.moduleId=ve},Tt=function(_e){return function(ve){var ne=Ee.bind.bind(Ee),xe=ne(ve);return ke(xe,_e),xe}},rt=function(_e){return function(ve){var ne=Ee.unbind.bind(Ee);ne(ve)}},Dt=function(_e){return function(ve){var ne=Ee.isBound.bind(Ee);return ne(ve)}},Se=function(_e){return function(ve){var ne=Ee.rebind.bind(Ee),xe=ne(ve);return ke(xe,_e),xe}};return function(_e){return{bindFunction:Tt(_e),isboundFunction:Dt(_e),rebindFunction:Se(_e),unbindFunction:rt(_e)}}},le.prototype._get=function(Ee,ke,Tt,rt,Dt,Se){var _e=null,ve={avoidConstraints:Ee,contextInterceptor:function(ne){return ne},isMultiInject:ke,key:Dt,serviceIdentifier:rt,targetType:Tt,value:Se};if(this._middleware){if(_e=this._middleware(ve),_e==null)throw new Error(K.INVALID_MIDDLEWARE_RETURN)}else _e=this._planAndResolve()(ve);return _e},le.prototype._planAndResolve=function(){var Ee=this;return function(ke){var Tt=et.plan(Ee._metadataReader,Ee,ke.isMultiInject,ke.targetType,ke.serviceIdentifier,ke.key,ke.value,ke.avoidConstraints);Tt=ke.contextInterceptor(Tt);var rt=be.resolve(Tt);return rt}},le}();Pt.Container=W},69377:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.AsyncContainerModule=Pt.ContainerModule=void 0;var kt=nt(18576),mt=function(){function Et(K){this.id=kt.id(),this.registry=K}return Et}();Pt.ContainerModule=mt;var k=function(){function Et(K){this.id=kt.id(),this.registry=K}return Et}();Pt.AsyncContainerModule=k},80522:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.ContainerSnapshot=void 0;var nt=function(){function kt(){}return kt.of=function(mt,k){var Et=new kt;return Et.bindings=mt,Et.middleware=k,Et},kt}();Pt.ContainerSnapshot=nt},96382:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Lookup=void 0;var kt=nt(52050),mt=function(){function k(){this._map=new Map}return k.prototype.getMap=function(){return this._map},k.prototype.add=function(Et,K){if(Et==null)throw new Error(kt.NULL_ARGUMENT);if(K==null)throw new Error(kt.NULL_ARGUMENT);var yt=this._map.get(Et);yt!==void 0?(yt.push(K),this._map.set(Et,yt)):this._map.set(Et,[K])},k.prototype.get=function(Et){if(Et==null)throw new Error(kt.NULL_ARGUMENT);var K=this._map.get(Et);if(K!==void 0)return K;throw new Error(kt.KEY_NOT_FOUND)},k.prototype.remove=function(Et){if(Et==null)throw new Error(kt.NULL_ARGUMENT);if(!this._map.delete(Et))throw new Error(kt.KEY_NOT_FOUND)},k.prototype.removeByCondition=function(Et){var K=this;this._map.forEach(function(yt,J){var pt=yt.filter(function(et){return!Et(et)});pt.length>0?K._map.set(J,pt):K._map.delete(J)})},k.prototype.hasKey=function(Et){if(Et==null)throw new Error(kt.NULL_ARGUMENT);return this._map.has(Et)},k.prototype.clone=function(){var Et=new k;return this._map.forEach(function(K,yt){K.forEach(function(J){return Et.add(yt,J.clone())})}),Et},k.prototype.traverse=function(Et){this._map.forEach(function(K,yt){Et(yt,K)})},k}();Pt.Lookup=mt},31331:function(dn,Pt,nt){"use strict";var kt;kt={value:!0},kt=kt=kt=kt=kt=kt=Pt.GW=kt=kt=Pt.zY=kt=kt=kt=kt=kt=Pt.f3=kt=kt=Pt.b2=kt=kt=kt=kt=kt=Pt.W2=kt=void 0;var mt=nt(91193);kt=mt;var k=nt(46769);Object.defineProperty(Pt,"W2",{enumerable:!0,get:function(){return k.Container}});var Et=nt(88795);kt={enumerable:!0,get:function(){return Et.BindingScopeEnum}},kt={enumerable:!0,get:function(){return Et.BindingTypeEnum}},kt={enumerable:!0,get:function(){return Et.TargetTypeEnum}};var K=nt(69377);kt={enumerable:!0,get:function(){return K.AsyncContainerModule}},kt={enumerable:!0,get:function(){return K.ContainerModule}};var yt=nt(9719);Object.defineProperty(Pt,"b2",{enumerable:!0,get:function(){return yt.injectable}});var J=nt(97404);kt={enumerable:!0,get:function(){return J.tagged}};var pt=nt(69481);kt={enumerable:!0,get:function(){return pt.named}};var et=nt(70105);Object.defineProperty(Pt,"f3",{enumerable:!0,get:function(){return et.inject}}),kt={enumerable:!0,get:function(){return et.LazyServiceIdentifer}};var be=nt(35231);kt={enumerable:!0,get:function(){return be.optional}};var ot=nt(8814);kt={enumerable:!0,get:function(){return ot.unmanaged}};var ut=nt(81623);kt={enumerable:!0,get:function(){return ut.multiInject}};var zt=nt(11580);kt={enumerable:!0,get:function(){return zt.targetName}};var P=nt(17419);Object.defineProperty(Pt,"zY",{enumerable:!0,get:function(){return P.postConstruct}});var b=nt(54594);kt={enumerable:!0,get:function(){return b.MetadataReader}};var W=nt(18576);kt={enumerable:!0,get:function(){return W.id}};var le=nt(90333);Object.defineProperty(Pt,"GW",{enumerable:!0,get:function(){return le.decorate}});var Ee=nt(18307);kt={enumerable:!0,get:function(){return Ee.traverseAncerstors}},kt={enumerable:!0,get:function(){return Ee.taggedConstraint}},kt={enumerable:!0,get:function(){return Ee.namedConstraint}},kt={enumerable:!0,get:function(){return Ee.typeConstraint}};var ke=nt(80030);kt={enumerable:!0,get:function(){return ke.getServiceIdentifierAsString}};var Tt=nt(55605);kt={enumerable:!0,get:function(){return Tt.multiBindToService}}},52887:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Context=void 0;var kt=nt(18576),mt=function(){function k(Et){this.id=kt.id(),this.container=Et}return k.prototype.addPlan=function(Et){this.plan=Et},k.prototype.setCurrentRequest=function(Et){this.currentRequest=Et},k}();Pt.Context=mt},55650:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Metadata=void 0;var kt=nt(91193),mt=function(){function k(Et,K){this.key=Et,this.value=K}return k.prototype.toString=function(){return this.key===kt.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},k}();Pt.Metadata=mt},54594:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.MetadataReader=void 0;var kt=nt(91193),mt=function(){function k(){}return k.prototype.getConstructorMetadata=function(Et){var K=Reflect.getMetadata(kt.PARAM_TYPES,Et),yt=Reflect.getMetadata(kt.TAGGED,Et);return{compilerGeneratedMetadata:K,userGeneratedMetadata:yt||{}}},k.prototype.getPropertiesMetadata=function(Et){var K=Reflect.getMetadata(kt.TAGGED_PROP,Et)||[];return K},k}();Pt.MetadataReader=mt},21800:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Plan=void 0;var nt=function(){function kt(mt,k){this.parentContext=mt,this.rootRequest=k}return kt}();Pt.Plan=nt},47572:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.getBindingDictionary=Pt.createMockRequest=Pt.plan=void 0;var kt=nt(44276),mt=nt(52050),k=nt(88795),Et=nt(91193),K=nt(83817),yt=nt(80030),J=nt(52887),pt=nt(55650),et=nt(21800),be=nt(73630),ot=nt(13571),ut=nt(79060);function zt(rt){return rt._bindingDictionary}Pt.getBindingDictionary=zt;function P(rt,Dt,Se,_e,ve,ne){var xe=rt?Et.MULTI_INJECT_TAG:Et.INJECT_TAG,Je=new pt.Metadata(xe,Se),Ot=new ut.Target(Dt,_e,Se,Je);if(ve!==void 0){var te=new pt.Metadata(ve,ne);Ot.metadata.push(te)}return Ot}function b(rt,Dt,Se,_e,ve){var ne=Ee(Se.container,ve.serviceIdentifier),xe=[];return ne.length===kt.BindingCount.NoBindingsAvailable&&Se.container.options.autoBindInjectable&&typeof ve.serviceIdentifier=="function"&&rt.getConstructorMetadata(ve.serviceIdentifier).compilerGeneratedMetadata&&(Se.container.bind(ve.serviceIdentifier).toSelf(),ne=Ee(Se.container,ve.serviceIdentifier)),Dt?xe=ne:xe=ne.filter(function(Je){var Ot=new ot.Request(Je.serviceIdentifier,Se,_e,Je,ve);return Je.constraint(Ot)}),W(ve.serviceIdentifier,xe,ve,Se.container),xe}function W(rt,Dt,Se,_e){switch(Dt.length){case kt.BindingCount.NoBindingsAvailable:if(Se.isOptional())return Dt;var ve=yt.getServiceIdentifierAsString(rt),ne=mt.NOT_REGISTERED;throw ne+=yt.listMetadataForTarget(ve,Se),ne+=yt.listRegisteredBindingsForServiceIdentifier(_e,ve,Ee),new Error(ne);case kt.BindingCount.OnlyOneBindingAvailable:if(!Se.isArray())return Dt;case kt.BindingCount.MultipleBindingsAvailable:default:if(Se.isArray())return Dt;var ve=yt.getServiceIdentifierAsString(rt),ne=mt.AMBIGUOUS_MATCH+" "+ve;throw ne+=yt.listRegisteredBindingsForServiceIdentifier(_e,ve,Ee),new Error(ne)}}function le(rt,Dt,Se,_e,ve,ne){var xe,Je;if(ve===null){xe=b(rt,Dt,_e,null,ne),Je=new ot.Request(Se,_e,null,xe,ne);var Ot=new et.Plan(_e,Je);_e.addPlan(Ot)}else xe=b(rt,Dt,_e,ve,ne),Je=ve.addChildRequest(ne.serviceIdentifier,xe,ne);xe.forEach(function(te){var ft=null;if(ne.isArray())ft=Je.addChildRequest(te.serviceIdentifier,te,ne);else{if(te.cache)return;ft=Je}if(te.type===k.BindingTypeEnum.Instance&&te.implementationType!==null){var wt=be.getDependencies(rt,te.implementationType);if(!_e.container.options.skipBaseClassChecks){var Y=be.getBaseClassDependencyCount(rt,te.implementationType);if(wt.length<Y){var gt=mt.ARGUMENTS_LENGTH_MISMATCH(be.getFunctionName(te.implementationType));throw new Error(gt)}}wt.forEach(function(he){le(rt,!1,he.serviceIdentifier,_e,ft,he)})}})}function Ee(rt,Dt){var Se=[],_e=zt(rt);return _e.hasKey(Dt)?Se=_e.get(Dt):rt.parent!==null&&(Se=Ee(rt.parent,Dt)),Se}function ke(rt,Dt,Se,_e,ve,ne,xe,Je){Je===void 0&&(Je=!1);var Ot=new J.Context(Dt),te=P(Se,_e,ve,"",ne,xe);try{return le(rt,Je,ve,Ot,null,te),Ot}catch(ft){throw K.isStackOverflowExeption(ft)&&Ot.plan&&yt.circularDependencyToException(Ot.plan.rootRequest),ft}}Pt.plan=ke;function Tt(rt,Dt,Se,_e){var ve=new ut.Target(k.TargetTypeEnum.Variable,"",Dt,new pt.Metadata(Se,_e)),ne=new J.Context(rt),xe=new ot.Request(Dt,ne,null,[],ve);return xe}Pt.createMockRequest=Tt},83925:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.QueryableString=void 0;var nt=function(){function kt(mt){this.str=mt}return kt.prototype.startsWith=function(mt){return this.str.indexOf(mt)===0},kt.prototype.endsWith=function(mt){var k="",Et=mt.split("").reverse().join("");return k=this.str.split("").reverse().join(""),this.startsWith.call({str:k},Et)},kt.prototype.contains=function(mt){return this.str.indexOf(mt)!==-1},kt.prototype.equals=function(mt){return this.str===mt},kt.prototype.value=function(){return this.str},kt}();Pt.QueryableString=nt},73630:function(dn,Pt,nt){"use strict";var kt=this&&this.__spreadArray||function(b,W){for(var le=0,Ee=W.length,ke=b.length;le<Ee;le++,ke++)b[ke]=W[le];return b};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.getFunctionName=Pt.getBaseClassDependencyCount=Pt.getDependencies=void 0;var mt=nt(70105),k=nt(52050),Et=nt(88795),K=nt(91193),yt=nt(80030);Object.defineProperty(Pt,"getFunctionName",{enumerable:!0,get:function(){return yt.getFunctionName}});var J=nt(79060);function pt(b,W){var le=yt.getFunctionName(W),Ee=et(b,le,W,!1);return Ee}Pt.getDependencies=pt;function et(b,W,le,Ee){var ke=b.getConstructorMetadata(le),Tt=ke.compilerGeneratedMetadata;if(Tt===void 0){var rt=k.MISSING_INJECTABLE_ANNOTATION+" "+W+".";throw new Error(rt)}var Dt=ke.userGeneratedMetadata,Se=Object.keys(Dt),_e=le.length===0&&Se.length>0,ve=Se.length>le.length,ne=_e||ve?Se.length:le.length,xe=ot(Ee,W,Tt,Dt,ne),Je=ut(b,le),Ot=kt(kt([],xe),Je);return Ot}function be(b,W,le,Ee,ke){var Tt=ke[b.toString()]||[],rt=P(Tt),Dt=rt.unmanaged!==!0,Se=Ee[b],_e=rt.inject||rt.multiInject;if(Se=_e||Se,Se instanceof mt.LazyServiceIdentifer&&(Se=Se.unwrap()),Dt){var ve=Se===Object,ne=Se===Function,xe=Se===void 0,Je=ve||ne||xe;if(!W&&Je){var Ot=k.MISSING_INJECT_ANNOTATION+" argument "+b+" in class "+le+".";throw new Error(Ot)}var te=new J.Target(Et.TargetTypeEnum.ConstructorArgument,rt.targetName,Se);return te.metadata=Tt,te}return null}function ot(b,W,le,Ee,ke){for(var Tt=[],rt=0;rt<ke;rt++){var Dt=rt,Se=be(Dt,b,W,le,Ee);Se!==null&&Tt.push(Se)}return Tt}function ut(b,W){for(var le=b.getPropertiesMetadata(W),Ee=[],ke=Object.keys(le),Tt=0,rt=ke;Tt<rt.length;Tt++){var Dt=rt[Tt],Se=le[Dt],_e=P(le[Dt]),ve=_e.targetName||Dt,ne=_e.inject||_e.multiInject,xe=new J.Target(Et.TargetTypeEnum.ClassProperty,ve,ne);xe.metadata=Se,Ee.push(xe)}var Je=Object.getPrototypeOf(W.prototype).constructor;if(Je!==Object){var Ot=ut(b,Je);Ee=kt(kt([],Ee),Ot)}return Ee}function zt(b,W){var le=Object.getPrototypeOf(W.prototype).constructor;if(le!==Object){var Ee=yt.getFunctionName(le),ke=et(b,Ee,le,!0),Tt=ke.map(function(Se){return Se.metadata.filter(function(_e){return _e.key===K.UNMANAGED_TAG})}),rt=[].concat.apply([],Tt).length,Dt=ke.length-rt;return Dt>0?Dt:zt(b,le)}else return 0}Pt.getBaseClassDependencyCount=zt;function P(b){var W={};return b.forEach(function(le){W[le.key.toString()]=le.value}),{inject:W[K.INJECT_TAG],multiInject:W[K.MULTI_INJECT_TAG],targetName:W[K.NAME_TAG],unmanaged:W[K.UNMANAGED_TAG]}}},13571:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Request=void 0;var kt=nt(18576),mt=function(){function k(Et,K,yt,J,pt){this.id=kt.id(),this.serviceIdentifier=Et,this.parentContext=K,this.parentRequest=yt,this.target=pt,this.childRequests=[],this.bindings=Array.isArray(J)?J:[J],this.requestScope=yt===null?new Map:null}return k.prototype.addChildRequest=function(Et,K,yt){var J=new k(Et,this.parentContext,this,K,yt);return this.childRequests.push(J),J},k}();Pt.Request=mt},79060:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.Target=void 0;var kt=nt(91193),mt=nt(18576),k=nt(55650),Et=nt(83925),K=function(){function yt(J,pt,et,be){this.id=mt.id(),this.type=J,this.serviceIdentifier=et,this.name=new Et.QueryableString(pt||""),this.metadata=new Array;var ot=null;typeof be=="string"?ot=new k.Metadata(kt.NAMED_TAG,be):be instanceof k.Metadata&&(ot=be),ot!==null&&this.metadata.push(ot)}return yt.prototype.hasTag=function(J){for(var pt=0,et=this.metadata;pt<et.length;pt++){var be=et[pt];if(be.key===J)return!0}return!1},yt.prototype.isArray=function(){return this.hasTag(kt.MULTI_INJECT_TAG)},yt.prototype.matchesArray=function(J){return this.matchesTag(kt.MULTI_INJECT_TAG)(J)},yt.prototype.isNamed=function(){return this.hasTag(kt.NAMED_TAG)},yt.prototype.isTagged=function(){return this.metadata.some(function(J){return kt.NON_CUSTOM_TAG_KEYS.every(function(pt){return J.key!==pt})})},yt.prototype.isOptional=function(){return this.matchesTag(kt.OPTIONAL_TAG)(!0)},yt.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(J){return J.key===kt.NAMED_TAG})[0]:null},yt.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(J){return kt.NON_CUSTOM_TAG_KEYS.every(function(pt){return J.key!==pt})}):null},yt.prototype.matchesNamedTag=function(J){return this.matchesTag(kt.NAMED_TAG)(J)},yt.prototype.matchesTag=function(J){var pt=this;return function(et){for(var be=0,ot=pt.metadata;be<ot.length;be++){var ut=ot[be];if(ut.key===J&&ut.value===et)return!0}return!1}},yt}();Pt.Target=K},10003:function(dn,Pt,nt){"use strict";var kt=this&&this.__spreadArray||function(et,be){for(var ot=0,ut=be.length,zt=et.length;ot<ut;ot++,zt++)et[zt]=be[ot];return et};Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.resolveInstance=void 0;var mt=nt(52050),k=nt(88795),Et=nt(91193);function K(et,be,ot){var ut=be.filter(function(P){return P.target!==null&&P.target.type===k.TargetTypeEnum.ClassProperty}),zt=ut.map(ot);return ut.forEach(function(P,b){var W="";W=P.target.name.value();var le=zt[b];et[W]=le}),et}function yt(et,be){return new(et.bind.apply(et,kt([void 0],be)))}function J(et,be){if(Reflect.hasMetadata(Et.POST_CONSTRUCT,et)){var ot=Reflect.getMetadata(Et.POST_CONSTRUCT,et);try{be[ot.value]()}catch(ut){throw new Error(mt.POST_CONSTRUCT_ERROR(et.name,ut.message))}}}function pt(et,be,ot){var ut=null;if(be.length>0){var zt=be.filter(function(b){return b.target!==null&&b.target.type===k.TargetTypeEnum.ConstructorArgument}),P=zt.map(ot);ut=yt(et,P),ut=K(ut,be,ot)}else ut=new et;return J(et,ut),ut}Pt.resolveInstance=pt},87536:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.resolve=void 0;var kt=nt(52050),mt=nt(88795),k=nt(83817),Et=nt(80030),K=nt(10003),yt=function(et,be,ot){try{return ot()}catch(ut){throw k.isStackOverflowExeption(ut)?new Error(kt.CIRCULAR_DEPENDENCY_IN_FACTORY(et,be.toString())):ut}},J=function(et){return function(be){be.parentContext.setCurrentRequest(be);var ot=be.bindings,ut=be.childRequests,zt=be.target&&be.target.isArray(),P=!be.parentRequest||!be.parentRequest.target||!be.target||!be.parentRequest.target.matchesArray(be.target.serviceIdentifier);if(zt&&P)return ut.map(function(Tt){var rt=J(et);return rt(Tt)});var b=null;if(be.target.isOptional()&&ot.length===0)return;var W=ot[0],le=W.scope===mt.BindingScopeEnum.Singleton,Ee=W.scope===mt.BindingScopeEnum.Request;if(le&&W.activated)return W.cache;if(Ee&&et!==null&&et.has(W.id))return et.get(W.id);if(W.type===mt.BindingTypeEnum.ConstantValue)b=W.cache,W.activated=!0;else if(W.type===mt.BindingTypeEnum.Function)b=W.cache,W.activated=!0;else if(W.type===mt.BindingTypeEnum.Constructor)b=W.implementationType;else if(W.type===mt.BindingTypeEnum.DynamicValue&&W.dynamicValue!==null)b=yt("toDynamicValue",W.serviceIdentifier,function(){return W.dynamicValue(be.parentContext)});else if(W.type===mt.BindingTypeEnum.Factory&&W.factory!==null)b=yt("toFactory",W.serviceIdentifier,function(){return W.factory(be.parentContext)});else if(W.type===mt.BindingTypeEnum.Provider&&W.provider!==null)b=yt("toProvider",W.serviceIdentifier,function(){return W.provider(be.parentContext)});else if(W.type===mt.BindingTypeEnum.Instance&&W.implementationType!==null)b=K.resolveInstance(W.implementationType,ut,J(et));else{var ke=Et.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(kt.INVALID_BINDING_TYPE+" "+ke)}return typeof W.onActivation=="function"&&(b=W.onActivation(be.parentContext,b)),le&&(W.cache=b,W.activated=!0),Ee&&et!==null&&!et.has(W.id)&&et.set(W.id,b),b}};function pt(et){var be=J(et.plan.rootRequest.requestScope);return be(et.plan.rootRequest)}Pt.resolve=pt},55404:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingInSyntax=void 0;var kt=nt(88795),mt=nt(65408),k=function(){function Et(K){this._binding=K}return Et.prototype.inRequestScope=function(){return this._binding.scope=kt.BindingScopeEnum.Request,new mt.BindingWhenOnSyntax(this._binding)},Et.prototype.inSingletonScope=function(){return this._binding.scope=kt.BindingScopeEnum.Singleton,new mt.BindingWhenOnSyntax(this._binding)},Et.prototype.inTransientScope=function(){return this._binding.scope=kt.BindingScopeEnum.Transient,new mt.BindingWhenOnSyntax(this._binding)},Et}();Pt.BindingInSyntax=k},48971:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingInWhenOnSyntax=void 0;var kt=nt(55404),mt=nt(37326),k=nt(64957),Et=function(){function K(yt){this._binding=yt,this._bindingWhenSyntax=new k.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new mt.BindingOnSyntax(this._binding),this._bindingInSyntax=new kt.BindingInSyntax(yt)}return K.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},K.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},K.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},K.prototype.when=function(yt){return this._bindingWhenSyntax.when(yt)},K.prototype.whenTargetNamed=function(yt){return this._bindingWhenSyntax.whenTargetNamed(yt)},K.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},K.prototype.whenTargetTagged=function(yt,J){return this._bindingWhenSyntax.whenTargetTagged(yt,J)},K.prototype.whenInjectedInto=function(yt){return this._bindingWhenSyntax.whenInjectedInto(yt)},K.prototype.whenParentNamed=function(yt){return this._bindingWhenSyntax.whenParentNamed(yt)},K.prototype.whenParentTagged=function(yt,J){return this._bindingWhenSyntax.whenParentTagged(yt,J)},K.prototype.whenAnyAncestorIs=function(yt){return this._bindingWhenSyntax.whenAnyAncestorIs(yt)},K.prototype.whenNoAncestorIs=function(yt){return this._bindingWhenSyntax.whenNoAncestorIs(yt)},K.prototype.whenAnyAncestorNamed=function(yt){return this._bindingWhenSyntax.whenAnyAncestorNamed(yt)},K.prototype.whenAnyAncestorTagged=function(yt,J){return this._bindingWhenSyntax.whenAnyAncestorTagged(yt,J)},K.prototype.whenNoAncestorNamed=function(yt){return this._bindingWhenSyntax.whenNoAncestorNamed(yt)},K.prototype.whenNoAncestorTagged=function(yt,J){return this._bindingWhenSyntax.whenNoAncestorTagged(yt,J)},K.prototype.whenAnyAncestorMatches=function(yt){return this._bindingWhenSyntax.whenAnyAncestorMatches(yt)},K.prototype.whenNoAncestorMatches=function(yt){return this._bindingWhenSyntax.whenNoAncestorMatches(yt)},K.prototype.onActivation=function(yt){return this._bindingOnSyntax.onActivation(yt)},K}();Pt.BindingInWhenOnSyntax=Et},37326:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingOnSyntax=void 0;var kt=nt(64957),mt=function(){function k(Et){this._binding=Et}return k.prototype.onActivation=function(Et){return this._binding.onActivation=Et,new kt.BindingWhenSyntax(this._binding)},k}();Pt.BindingOnSyntax=mt},43085:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingToSyntax=void 0;var kt=nt(52050),mt=nt(88795),k=nt(48971),Et=nt(65408),K=function(){function yt(J){this._binding=J}return yt.prototype.to=function(J){return this._binding.type=mt.BindingTypeEnum.Instance,this._binding.implementationType=J,new k.BindingInWhenOnSyntax(this._binding)},yt.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+kt.INVALID_TO_SELF_VALUE);var J=this._binding.serviceIdentifier;return this.to(J)},yt.prototype.toConstantValue=function(J){return this._binding.type=mt.BindingTypeEnum.ConstantValue,this._binding.cache=J,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=mt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},yt.prototype.toDynamicValue=function(J){return this._binding.type=mt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=J,this._binding.implementationType=null,new k.BindingInWhenOnSyntax(this._binding)},yt.prototype.toConstructor=function(J){return this._binding.type=mt.BindingTypeEnum.Constructor,this._binding.implementationType=J,this._binding.scope=mt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},yt.prototype.toFactory=function(J){return this._binding.type=mt.BindingTypeEnum.Factory,this._binding.factory=J,this._binding.scope=mt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},yt.prototype.toFunction=function(J){if(typeof J!="function")throw new Error(kt.INVALID_FUNCTION_BINDING);var pt=this.toConstantValue(J);return this._binding.type=mt.BindingTypeEnum.Function,this._binding.scope=mt.BindingScopeEnum.Singleton,pt},yt.prototype.toAutoFactory=function(J){return this._binding.type=mt.BindingTypeEnum.Factory,this._binding.factory=function(pt){var et=function(){return pt.container.get(J)};return et},this._binding.scope=mt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},yt.prototype.toProvider=function(J){return this._binding.type=mt.BindingTypeEnum.Provider,this._binding.provider=J,this._binding.scope=mt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},yt.prototype.toService=function(J){this.toDynamicValue(function(pt){return pt.container.get(J)})},yt}();Pt.BindingToSyntax=K},65408:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingWhenOnSyntax=void 0;var kt=nt(37326),mt=nt(64957),k=function(){function Et(K){this._binding=K,this._bindingWhenSyntax=new mt.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new kt.BindingOnSyntax(this._binding)}return Et.prototype.when=function(K){return this._bindingWhenSyntax.when(K)},Et.prototype.whenTargetNamed=function(K){return this._bindingWhenSyntax.whenTargetNamed(K)},Et.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},Et.prototype.whenTargetTagged=function(K,yt){return this._bindingWhenSyntax.whenTargetTagged(K,yt)},Et.prototype.whenInjectedInto=function(K){return this._bindingWhenSyntax.whenInjectedInto(K)},Et.prototype.whenParentNamed=function(K){return this._bindingWhenSyntax.whenParentNamed(K)},Et.prototype.whenParentTagged=function(K,yt){return this._bindingWhenSyntax.whenParentTagged(K,yt)},Et.prototype.whenAnyAncestorIs=function(K){return this._bindingWhenSyntax.whenAnyAncestorIs(K)},Et.prototype.whenNoAncestorIs=function(K){return this._bindingWhenSyntax.whenNoAncestorIs(K)},Et.prototype.whenAnyAncestorNamed=function(K){return this._bindingWhenSyntax.whenAnyAncestorNamed(K)},Et.prototype.whenAnyAncestorTagged=function(K,yt){return this._bindingWhenSyntax.whenAnyAncestorTagged(K,yt)},Et.prototype.whenNoAncestorNamed=function(K){return this._bindingWhenSyntax.whenNoAncestorNamed(K)},Et.prototype.whenNoAncestorTagged=function(K,yt){return this._bindingWhenSyntax.whenNoAncestorTagged(K,yt)},Et.prototype.whenAnyAncestorMatches=function(K){return this._bindingWhenSyntax.whenAnyAncestorMatches(K)},Et.prototype.whenNoAncestorMatches=function(K){return this._bindingWhenSyntax.whenNoAncestorMatches(K)},Et.prototype.onActivation=function(K){return this._bindingOnSyntax.onActivation(K)},Et}();Pt.BindingWhenOnSyntax=k},64957:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.BindingWhenSyntax=void 0;var kt=nt(37326),mt=nt(18307),k=function(){function Et(K){this._binding=K}return Et.prototype.when=function(K){return this._binding.constraint=K,new kt.BindingOnSyntax(this._binding)},Et.prototype.whenTargetNamed=function(K){return this._binding.constraint=mt.namedConstraint(K),new kt.BindingOnSyntax(this._binding)},Et.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(K){var yt=K.target!==null&&!K.target.isNamed()&&!K.target.isTagged();return yt},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenTargetTagged=function(K,yt){return this._binding.constraint=mt.taggedConstraint(K)(yt),new kt.BindingOnSyntax(this._binding)},Et.prototype.whenInjectedInto=function(K){return this._binding.constraint=function(yt){return mt.typeConstraint(K)(yt.parentRequest)},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenParentNamed=function(K){return this._binding.constraint=function(yt){return mt.namedConstraint(K)(yt.parentRequest)},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenParentTagged=function(K,yt){return this._binding.constraint=function(J){return mt.taggedConstraint(K)(yt)(J.parentRequest)},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorIs=function(K){return this._binding.constraint=function(yt){return mt.traverseAncerstors(yt,mt.typeConstraint(K))},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorIs=function(K){return this._binding.constraint=function(yt){return!mt.traverseAncerstors(yt,mt.typeConstraint(K))},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorNamed=function(K){return this._binding.constraint=function(yt){return mt.traverseAncerstors(yt,mt.namedConstraint(K))},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorNamed=function(K){return this._binding.constraint=function(yt){return!mt.traverseAncerstors(yt,mt.namedConstraint(K))},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorTagged=function(K,yt){return this._binding.constraint=function(J){return mt.traverseAncerstors(J,mt.taggedConstraint(K)(yt))},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorTagged=function(K,yt){return this._binding.constraint=function(J){return!mt.traverseAncerstors(J,mt.taggedConstraint(K)(yt))},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorMatches=function(K){return this._binding.constraint=function(yt){return mt.traverseAncerstors(yt,K)},new kt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorMatches=function(K){return this._binding.constraint=function(yt){return!mt.traverseAncerstors(yt,K)},new kt.BindingOnSyntax(this._binding)},Et}();Pt.BindingWhenSyntax=k},18307:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.typeConstraint=Pt.namedConstraint=Pt.taggedConstraint=Pt.traverseAncerstors=void 0;var kt=nt(91193),mt=nt(55650),k=function(J,pt){var et=J.parentRequest;return et!==null?pt(et)?!0:k(et,pt):!1};Pt.traverseAncerstors=k;var Et=function(J){return function(pt){var et=function(be){return be!==null&&be.target!==null&&be.target.matchesTag(J)(pt)};return et.metaData=new mt.Metadata(J,pt),et}};Pt.taggedConstraint=Et;var K=Et(kt.NAMED_TAG);Pt.namedConstraint=K;var yt=function(J){return function(pt){var et=null;if(pt!==null)if(et=pt.bindings[0],typeof J=="string"){var be=et.serviceIdentifier;return be===J}else{var ot=pt.bindings[0].implementationType;return J===ot}return!1}};Pt.typeConstraint=yt},55605:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.multiBindToService=void 0;var nt=function(kt){return function(mt){return function(){for(var k=[],Et=0;Et<arguments.length;Et++)k[Et]=arguments[Et];return k.forEach(function(K){return kt.bind(K).toService(mt)})}}};Pt.multiBindToService=nt},83817:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isStackOverflowExeption=void 0;var kt=nt(52050);function mt(k){return k instanceof RangeError||k.message===kt.STACK_OVERFLOW}Pt.isStackOverflowExeption=mt},18576:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.id=void 0;var nt=0;function kt(){return nt++}Pt.id=kt},80030:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.circularDependencyToException=Pt.listMetadataForTarget=Pt.listRegisteredBindingsForServiceIdentifier=Pt.getServiceIdentifierAsString=Pt.getFunctionName=void 0;var kt=nt(52050);function mt(et){if(typeof et=="function"){var be=et;return be.name}else{if(typeof et=="symbol")return et.toString();var be=et;return be}}Pt.getServiceIdentifierAsString=mt;function k(et,be,ot){var ut="",zt=ot(et,be);return zt.length!==0&&(ut=`
Registered bindings:`,zt.forEach(function(P){var b="Object";P.implementationType!==null&&(b=pt(P.implementationType)),ut=ut+`
 `+b,P.constraint.metaData&&(ut=ut+" - "+P.constraint.metaData)})),ut}Pt.listRegisteredBindingsForServiceIdentifier=k;function Et(et,be){return et.parentRequest===null?!1:et.parentRequest.serviceIdentifier===be?!0:Et(et.parentRequest,be)}function K(et){function be(ut,zt){zt===void 0&&(zt=[]);var P=mt(ut.serviceIdentifier);return zt.push(P),ut.parentRequest!==null?be(ut.parentRequest,zt):zt}var ot=be(et);return ot.reverse().join(" --> ")}function yt(et){et.childRequests.forEach(function(be){if(Et(be,be.serviceIdentifier)){var ot=K(be);throw new Error(kt.CIRCULAR_DEPENDENCY+" "+ot)}else yt(be)})}Pt.circularDependencyToException=yt;function J(et,be){if(be.isTagged()||be.isNamed()){var ot="",ut=be.getNamedTag(),zt=be.getCustomTags();return ut!==null&&(ot+=ut.toString()+`
`),zt!==null&&zt.forEach(function(P){ot+=P.toString()+`
`})," "+et+`
 `+et+" - "+ot}else return" "+et}Pt.listMetadataForTarget=J;function pt(et){if(et.name)return et.name;var be=et.toString(),ot=be.match(/^function\s*([^\s(]+)/);return ot?ot[1]:"Anonymous function: "+be}Pt.getFunctionName=pt},78962:function(dn){"use strict";dn.exports=nt,dn.exports.default=nt;var Pt=1e20;function nt(K,yt,J,pt,et,be){this.fontSize=K||24,this.buffer=yt===void 0?3:yt,this.cutoff=pt||.25,this.fontFamily=et||"sans-serif",this.fontWeight=be||"normal",this.radius=J||8;var ot=this.size=this.fontSize+this.buffer*2,ut=ot+this.buffer*2,zt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;zt?this.canvas=my.createOffscreenCanvas(ot,ot,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=ot),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(ut*ut),this.gridInner=new Float64Array(ut*ut),this.f=new Float64Array(ut),this.z=new Float64Array(ut+1),this.v=new Uint16Array(ut),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,zt?this.middle=Math.round(ot/2*1):this.middle=Math.round(ot/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function kt(K,yt,J,pt,et,be,ot){be.fill(Pt,0,yt*J),ot.fill(0,0,yt*J);for(var ut=(yt-pt)/2,zt=0;zt<et;zt++)for(var P=0;P<pt;P++){var b=(zt+ut)*yt+P+ut,W=K.data[4*(zt*pt+P)+3]/255;if(W===1)be[b]=0,ot[b]=Pt;else if(W===0)be[b]=Pt,ot[b]=0;else{var le=Math.max(0,.5-W),Ee=Math.max(0,W-.5);be[b]=le*le,ot[b]=Ee*Ee}}}function mt(K,yt,J,pt,et,be,ot){for(var ut=0;ut<yt*J;ut++){var zt=Math.sqrt(pt[ut])-Math.sqrt(et[ut]);K[ut]=Math.round(255-255*(zt/be+ot))}}nt.prototype._draw=function(K,yt){var J=this.ctx.measureText(K),pt=J.width,et=2*this.buffer,be,ot,ut,zt,P,b,W,le;yt&&this.useMetrics?(P=Math.floor(J.actualBoundingBoxAscent),le=this.buffer+Math.ceil(J.actualBoundingBoxAscent),b=this.buffer,W=this.buffer,ot=Math.min(this.size,Math.ceil(J.actualBoundingBoxRight-J.actualBoundingBoxLeft)),zt=Math.min(this.size-b,Math.ceil(J.actualBoundingBoxAscent+J.actualBoundingBoxDescent)),be=ot+et,ut=zt+et,this.ctx.textBaseline="alphabetic"):(be=ot=this.size,ut=zt=this.size,P=19*this.fontSize/24,b=W=0,le=this.middle,this.ctx.textBaseline="middle");var Ee;ot&&zt&&(this.ctx.clearRect(W,b,ot,zt),this.ctx.fillText(K,this.buffer,le),Ee=this.ctx.getImageData(W,b,ot,zt));var ke=new Uint8ClampedArray(be*ut);return kt(Ee,be,ut,ot,zt,this.gridOuter,this.gridInner),k(this.gridOuter,be,ut,this.f,this.v,this.z),k(this.gridInner,be,ut,this.f,this.v,this.z),mt(ke,be,ut,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:ke,metrics:{width:ot,height:zt,sdfWidth:be,sdfHeight:ut,top:P,left:0,advance:pt}}},nt.prototype.draw=function(K){return this._draw(K,!1).data},nt.prototype.drawWithMetrics=function(K){return this._draw(K,!0)};function k(K,yt,J,pt,et,be){for(var ot=0;ot<yt;ot++)Et(K,ot,yt,J,pt,et,be);for(var ut=0;ut<J;ut++)Et(K,ut*yt,1,yt,pt,et,be)}function Et(K,yt,J,pt,et,be,ot){var ut,zt,P,b;for(be[0]=0,ot[0]=-Pt,ot[1]=Pt,ut=0;ut<pt;ut++)et[ut]=K[yt+ut*J];for(ut=1,zt=0,P=0;ut<pt;ut++){do b=be[zt],P=(et[ut]-et[b]+ut*ut-b*b)/(ut-b)/2;while(P<=ot[zt]&&--zt>-1);zt++,be[zt]=ut,ot[zt]=P,ot[zt+1]=Pt}for(ut=0,zt=0;ut<pt;ut++){for(;ot[zt+1]<ut;)zt++;b=be[zt],K[yt+ut*J]=et[b]+(ut-b)*(ut-b)}}},34306:function(dn,Pt,nt){"use strict";nt.r(Pt),nt.d(Pt,{Function:function(){return zu},Interpreter:function(){return Ts},default:function(){return Xc},evaluate:function(){return Ga},vm:function(){return kt}});var kt={};nt.r(kt),nt.d(kt,{Script:function(){return pl},compileFunction:function(){return Wc},createContext:function(){return jc},runInContext:function(){return xu},runInNewContext:function(){return Ms}});var mt={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},k="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Et={5:k,"5module":k+" export import",6:k+" const class extends export import super"},K=/^in(stanceof)?$/,yt="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",J="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",pt=new RegExp("["+yt+"]"),et=new RegExp("["+yt+J+"]");yt=J=null;var be=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],ot=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function ut(D,X){for(var Mt=65536,it=0;it<X.length;it+=2){if(Mt+=X[it],Mt>D)return!1;if(Mt+=X[it+1],Mt>=D)return!0}}function zt(D,X){return D<65?D===36:D<91?!0:D<97?D===95:D<123?!0:D<=65535?D>=170&&pt.test(String.fromCharCode(D)):X===!1?!1:ut(D,be)}function P(D,X){return D<48?D===36:D<58?!0:D<65?!1:D<91?!0:D<97?D===95:D<123?!0:D<=65535?D>=170&&et.test(String.fromCharCode(D)):X===!1?!1:ut(D,be)||ut(D,ot)}var b=function(X,Mt){Mt===void 0&&(Mt={}),this.label=X,this.keyword=Mt.keyword,this.beforeExpr=!!Mt.beforeExpr,this.startsExpr=!!Mt.startsExpr,this.isLoop=!!Mt.isLoop,this.isAssign=!!Mt.isAssign,this.prefix=!!Mt.prefix,this.postfix=!!Mt.postfix,this.binop=Mt.binop||null,this.updateContext=null};function W(D,X){return new b(D,{beforeExpr:!0,binop:X})}var le={beforeExpr:!0},Ee={startsExpr:!0},ke={};function Tt(D,X){return X===void 0&&(X={}),X.keyword=D,ke[D]=new b(D,X)}var rt={num:new b("num",Ee),regexp:new b("regexp",Ee),string:new b("string",Ee),name:new b("name",Ee),eof:new b("eof"),bracketL:new b("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new b("]"),braceL:new b("{",{beforeExpr:!0,startsExpr:!0}),braceR:new b("}"),parenL:new b("(",{beforeExpr:!0,startsExpr:!0}),parenR:new b(")"),comma:new b(",",le),semi:new b(";",le),colon:new b(":",le),dot:new b("."),question:new b("?",le),questionDot:new b("?."),arrow:new b("=>",le),template:new b("template"),invalidTemplate:new b("invalidTemplate"),ellipsis:new b("...",le),backQuote:new b("`",Ee),dollarBraceL:new b("${",{beforeExpr:!0,startsExpr:!0}),eq:new b("=",{beforeExpr:!0,isAssign:!0}),assign:new b("_=",{beforeExpr:!0,isAssign:!0}),incDec:new b("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new b("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:W("||",1),logicalAND:W("&&",2),bitwiseOR:W("|",3),bitwiseXOR:W("^",4),bitwiseAND:W("&",5),equality:W("==/!=/===/!==",6),relational:W("</>/<=/>=",7),bitShift:W("<</>>/>>>",8),plusMin:new b("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:W("%",10),star:W("*",10),slash:W("/",10),starstar:new b("**",{beforeExpr:!0}),coalesce:W("??",1),_break:Tt("break"),_case:Tt("case",le),_catch:Tt("catch"),_continue:Tt("continue"),_debugger:Tt("debugger"),_default:Tt("default",le),_do:Tt("do",{isLoop:!0,beforeExpr:!0}),_else:Tt("else",le),_finally:Tt("finally"),_for:Tt("for",{isLoop:!0}),_function:Tt("function",Ee),_if:Tt("if"),_return:Tt("return",le),_switch:Tt("switch"),_throw:Tt("throw",le),_try:Tt("try"),_var:Tt("var"),_const:Tt("const"),_while:Tt("while",{isLoop:!0}),_with:Tt("with"),_new:Tt("new",{beforeExpr:!0,startsExpr:!0}),_this:Tt("this",Ee),_super:Tt("super",Ee),_class:Tt("class",Ee),_extends:Tt("extends",le),_export:Tt("export"),_import:Tt("import",Ee),_null:Tt("null",Ee),_true:Tt("true",Ee),_false:Tt("false",Ee),_in:Tt("in",{beforeExpr:!0,binop:7}),_instanceof:Tt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Tt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Tt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Tt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Dt=/\r\n?|\n|\u2028|\u2029/,Se=new RegExp(Dt.source,"g");function _e(D,X){return D===10||D===13||!X&&(D===8232||D===8233)}var ve=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ne=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,xe=Object.prototype,Je=xe.hasOwnProperty,Ot=xe.toString;function te(D,X){return Je.call(D,X)}var ft=Array.isArray||function(D){return Ot.call(D)==="[object Array]"};function wt(D){return new RegExp("^(?:"+D.replace(/ /g,"|")+")$")}var Y=function(X,Mt){this.line=X,this.column=Mt};Y.prototype.offset=function(X){return new Y(this.line,this.column+X)};var gt=function(X,Mt,it){this.start=Mt,this.end=it,X.sourceFile!==null&&(this.source=X.sourceFile)};function he(D,X){for(var Mt=1,it=0;;){Se.lastIndex=it;var Jt=Se.exec(D);if(Jt&&Jt.index<X)++Mt,it=Jt.index+Jt[0].length;else return new Y(Mt,X-it)}}var Oe={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Le(D){var X={};for(var Mt in Oe)X[Mt]=D&&te(D,Mt)?D[Mt]:Oe[Mt];if(X.ecmaVersion>=2015&&(X.ecmaVersion-=2009),X.allowReserved==null&&(X.allowReserved=X.ecmaVersion<5),ft(X.onToken)){var it=X.onToken;X.onToken=function(Jt){return it.push(Jt)}}return ft(X.onComment)&&(X.onComment=Ve(X,X.onComment)),X}function Ve(D,X){return function(Mt,it,Jt,Ue,yr,Br){var zr={type:Mt?"Block":"Line",value:it,start:Jt,end:Ue};D.locations&&(zr.loc=new gt(this,yr,Br)),D.ranges&&(zr.range=[Jt,Ue]),X.push(zr)}}var Bt=1,re=2,ye=Bt|re,Yt=4,qe=8,vr=16,oe=32,qt=64,bt=128;function Wt(D,X){return re|(D?Yt:0)|(X?qe:0)}var $t=0,xt=1,St=2,ue=3,Pe=4,ze=5,Vt=function(X,Mt,it){this.options=X=Le(X),this.sourceFile=X.sourceFile,this.keywords=wt(Et[X.ecmaVersion>=6?6:X.sourceType==="module"?"5module":5]);var Jt="";if(X.allowReserved!==!0){for(var Ue=X.ecmaVersion;!(Jt=mt[Ue]);Ue--);X.sourceType==="module"&&(Jt+=" await")}this.reservedWords=wt(Jt);var yr=(Jt?Jt+" ":"")+mt.strict;this.reservedWordsStrict=wt(yr),this.reservedWordsStrictBind=wt(yr+" "+mt.strictBind),this.input=String(Mt),this.containsEsc=!1,it?(this.pos=it,this.lineStart=this.input.lastIndexOf(`
`,it-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Dt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=rt.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=X.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&X.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(Bt),this.regexpState=null},Ct={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Vt.prototype.parse=function(){var X=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(X)},Ct.inFunction.get=function(){return(this.currentVarScope().flags&re)>0},Ct.inGenerator.get=function(){return(this.currentVarScope().flags&qe)>0},Ct.inAsync.get=function(){return(this.currentVarScope().flags&Yt)>0},Ct.allowSuper.get=function(){return(this.currentThisScope().flags&qt)>0},Ct.allowDirectSuper.get=function(){return(this.currentThisScope().flags&bt)>0},Ct.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Vt.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&re)>0},Vt.extend=function(){for(var X=[],Mt=arguments.length;Mt--;)X[Mt]=arguments[Mt];for(var it=this,Jt=0;Jt<X.length;Jt++)it=X[Jt](it);return it},Vt.parse=function(X,Mt){return new this(Mt,X).parse()},Vt.parseExpressionAt=function(X,Mt,it){var Jt=new this(it,X,Mt);return Jt.nextToken(),Jt.parseExpression()},Vt.tokenizer=function(X,Mt){return new this(Mt,X)},Object.defineProperties(Vt.prototype,Ct);var At=Vt.prototype,Nt=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;At.strictDirective=function(D){for(;;){ne.lastIndex=D,D+=ne.exec(this.input)[0].length;var X=Nt.exec(this.input.slice(D));if(!X)return!1;if((X[1]||X[2])==="use strict"){ne.lastIndex=D+X[0].length;var Mt=ne.exec(this.input),it=Mt.index+Mt[0].length,Jt=this.input.charAt(it);return Jt===";"||Jt==="}"||Dt.test(Mt[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(Jt)||Jt==="!"&&this.input.charAt(it+1)==="=")}D+=X[0].length,ne.lastIndex=D,D+=ne.exec(this.input)[0].length,this.input[D]===";"&&D++}},At.eat=function(D){return this.type===D?(this.next(),!0):!1},At.isContextual=function(D){return this.type===rt.name&&this.value===D&&!this.containsEsc},At.eatContextual=function(D){return this.isContextual(D)?(this.next(),!0):!1},At.expectContextual=function(D){this.eatContextual(D)||this.unexpected()},At.canInsertSemicolon=function(){return this.type===rt.eof||this.type===rt.braceR||Dt.test(this.input.slice(this.lastTokEnd,this.start))},At.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},At.semicolon=function(){!this.eat(rt.semi)&&!this.insertSemicolon()&&this.unexpected()},At.afterTrailingComma=function(D,X){if(this.type===D)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),X||this.next(),!0},At.expect=function(D){this.eat(D)||this.unexpected()},At.unexpected=function(D){this.raise(D!=null?D:this.start,"Unexpected token")};function tt(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}At.checkPatternErrors=function(D,X){if(D){D.trailingComma>-1&&this.raiseRecoverable(D.trailingComma,"Comma is not permitted after the rest element");var Mt=X?D.parenthesizedAssign:D.parenthesizedBind;Mt>-1&&this.raiseRecoverable(Mt,"Parenthesized pattern")}},At.checkExpressionErrors=function(D,X){if(!D)return!1;var Mt=D.shorthandAssign,it=D.doubleProto;if(!X)return Mt>=0||it>=0;Mt>=0&&this.raise(Mt,"Shorthand property assignments are valid only in destructuring patterns"),it>=0&&this.raiseRecoverable(it,"Redefinition of __proto__ property")},At.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},At.isSimpleAssignTarget=function(D){return D.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(D.expression):D.type==="Identifier"||D.type==="MemberExpression"};var vt=Vt.prototype;vt.parseTopLevel=function(D){var X={};for(D.body||(D.body=[]);this.type!==rt.eof;){var Mt=this.parseStatement(null,!0,X);D.body.push(Mt)}if(this.inModule)for(var it=0,Jt=Object.keys(this.undefinedExports);it<Jt.length;it+=1){var Ue=Jt[it];this.raiseRecoverable(this.undefinedExports[Ue].start,"Export '"+Ue+"' is not defined")}return this.adaptDirectivePrologue(D.body),this.next(),D.sourceType=this.options.sourceType,this.finishNode(D,"Program")};var Ht={kind:"loop"},de={kind:"switch"};vt.isLet=function(D){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ne.lastIndex=this.pos;var X=ne.exec(this.input),Mt=this.pos+X[0].length,it=this.input.charCodeAt(Mt);if(it===91)return!0;if(D)return!1;if(it===123)return!0;if(zt(it,!0)){for(var Jt=Mt+1;P(this.input.charCodeAt(Jt),!0);)++Jt;var Ue=this.input.slice(Mt,Jt);if(!K.test(Ue))return!0}return!1},vt.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ne.lastIndex=this.pos;var D=ne.exec(this.input),X=this.pos+D[0].length;return!Dt.test(this.input.slice(this.pos,X))&&this.input.slice(X,X+8)==="function"&&(X+8===this.input.length||!P(this.input.charAt(X+8)))},vt.parseStatement=function(D,X,Mt){var it=this.type,Jt=this.startNode(),Ue;switch(this.isLet(D)&&(it=rt._var,Ue="let"),it){case rt._break:case rt._continue:return this.parseBreakContinueStatement(Jt,it.keyword);case rt._debugger:return this.parseDebuggerStatement(Jt);case rt._do:return this.parseDoStatement(Jt);case rt._for:return this.parseForStatement(Jt);case rt._function:return D&&(this.strict||D!=="if"&&D!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(Jt,!1,!D);case rt._class:return D&&this.unexpected(),this.parseClass(Jt,!0);case rt._if:return this.parseIfStatement(Jt);case rt._return:return this.parseReturnStatement(Jt);case rt._switch:return this.parseSwitchStatement(Jt);case rt._throw:return this.parseThrowStatement(Jt);case rt._try:return this.parseTryStatement(Jt);case rt._const:case rt._var:return Ue=Ue||this.value,D&&Ue!=="var"&&this.unexpected(),this.parseVarStatement(Jt,Ue);case rt._while:return this.parseWhileStatement(Jt);case rt._with:return this.parseWithStatement(Jt);case rt.braceL:return this.parseBlock(!0,Jt);case rt.semi:return this.parseEmptyStatement(Jt);case rt._export:case rt._import:if(this.options.ecmaVersion>10&&it===rt._import){ne.lastIndex=this.pos;var yr=ne.exec(this.input),Br=this.pos+yr[0].length,zr=this.input.charCodeAt(Br);if(zr===40||zr===46)return this.parseExpressionStatement(Jt,this.parseExpression())}return this.options.allowImportExportEverywhere||(X||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),it===rt._import?this.parseImport(Jt):this.parseExport(Jt,Mt);default:if(this.isAsyncFunction())return D&&this.unexpected(),this.next(),this.parseFunctionStatement(Jt,!0,!D);var Cn=this.value,Vn=this.parseExpression();return it===rt.name&&Vn.type==="Identifier"&&this.eat(rt.colon)?this.parseLabeledStatement(Jt,Cn,Vn,D):this.parseExpressionStatement(Jt,Vn)}},vt.parseBreakContinueStatement=function(D,X){var Mt=X==="break";this.next(),this.eat(rt.semi)||this.insertSemicolon()?D.label=null:this.type!==rt.name?this.unexpected():(D.label=this.parseIdent(),this.semicolon());for(var it=0;it<this.labels.length;++it){var Jt=this.labels[it];if((D.label==null||Jt.name===D.label.name)&&(Jt.kind!=null&&(Mt||Jt.kind==="loop")||D.label&&Mt))break}return it===this.labels.length&&this.raise(D.start,"Unsyntactic "+X),this.finishNode(D,Mt?"BreakStatement":"ContinueStatement")},vt.parseDebuggerStatement=function(D){return this.next(),this.semicolon(),this.finishNode(D,"DebuggerStatement")},vt.parseDoStatement=function(D){return this.next(),this.labels.push(Ht),D.body=this.parseStatement("do"),this.labels.pop(),this.expect(rt._while),D.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(rt.semi):this.semicolon(),this.finishNode(D,"DoWhileStatement")},vt.parseForStatement=function(D){this.next();var X=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Ht),this.enterScope(0),this.expect(rt.parenL),this.type===rt.semi)return X>-1&&this.unexpected(X),this.parseFor(D,null);var Mt=this.isLet();if(this.type===rt._var||this.type===rt._const||Mt){var it=this.startNode(),Jt=Mt?"let":this.value;return this.next(),this.parseVar(it,!0,Jt),this.finishNode(it,"VariableDeclaration"),(this.type===rt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&it.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===rt._in?X>-1&&this.unexpected(X):D.await=X>-1),this.parseForIn(D,it)):(X>-1&&this.unexpected(X),this.parseFor(D,it))}var Ue=new tt,yr=this.parseExpression(!0,Ue);return this.type===rt._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===rt._in?X>-1&&this.unexpected(X):D.await=X>-1),this.toAssignable(yr,!1,Ue),this.checkLVal(yr),this.parseForIn(D,yr)):(this.checkExpressionErrors(Ue,!0),X>-1&&this.unexpected(X),this.parseFor(D,yr))},vt.parseFunctionStatement=function(D,X,Mt){return this.next(),this.parseFunction(D,Ie|(Mt?0:We),!1,X)},vt.parseIfStatement=function(D){return this.next(),D.test=this.parseParenExpression(),D.consequent=this.parseStatement("if"),D.alternate=this.eat(rt._else)?this.parseStatement("if"):null,this.finishNode(D,"IfStatement")},vt.parseReturnStatement=function(D){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(rt.semi)||this.insertSemicolon()?D.argument=null:(D.argument=this.parseExpression(),this.semicolon()),this.finishNode(D,"ReturnStatement")},vt.parseSwitchStatement=function(D){this.next(),D.discriminant=this.parseParenExpression(),D.cases=[],this.expect(rt.braceL),this.labels.push(de),this.enterScope(0);for(var X,Mt=!1;this.type!==rt.braceR;)if(this.type===rt._case||this.type===rt._default){var it=this.type===rt._case;X&&this.finishNode(X,"SwitchCase"),D.cases.push(X=this.startNode()),X.consequent=[],this.next(),it?X.test=this.parseExpression():(Mt&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),Mt=!0,X.test=null),this.expect(rt.colon)}else X||this.unexpected(),X.consequent.push(this.parseStatement(null));return this.exitScope(),X&&this.finishNode(X,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(D,"SwitchStatement")},vt.parseThrowStatement=function(D){return this.next(),Dt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),D.argument=this.parseExpression(),this.semicolon(),this.finishNode(D,"ThrowStatement")};var jt=[];vt.parseTryStatement=function(D){if(this.next(),D.block=this.parseBlock(),D.handler=null,this.type===rt._catch){var X=this.startNode();if(this.next(),this.eat(rt.parenL)){X.param=this.parseBindingAtom();var Mt=X.param.type==="Identifier";this.enterScope(Mt?oe:0),this.checkLVal(X.param,Mt?Pe:St),this.expect(rt.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),X.param=null,this.enterScope(0);X.body=this.parseBlock(!1),this.exitScope(),D.handler=this.finishNode(X,"CatchClause")}return D.finalizer=this.eat(rt._finally)?this.parseBlock():null,!D.handler&&!D.finalizer&&this.raise(D.start,"Missing catch or finally clause"),this.finishNode(D,"TryStatement")},vt.parseVarStatement=function(D,X){return this.next(),this.parseVar(D,!1,X),this.semicolon(),this.finishNode(D,"VariableDeclaration")},vt.parseWhileStatement=function(D){return this.next(),D.test=this.parseParenExpression(),this.labels.push(Ht),D.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(D,"WhileStatement")},vt.parseWithStatement=function(D){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),D.object=this.parseParenExpression(),D.body=this.parseStatement("with"),this.finishNode(D,"WithStatement")},vt.parseEmptyStatement=function(D){return this.next(),this.finishNode(D,"EmptyStatement")},vt.parseLabeledStatement=function(D,X,Mt,it){for(var Jt=0,Ue=this.labels;Jt<Ue.length;Jt+=1){var yr=Ue[Jt];yr.name===X&&this.raise(Mt.start,"Label '"+X+"' is already declared")}for(var Br=this.type.isLoop?"loop":this.type===rt._switch?"switch":null,zr=this.labels.length-1;zr>=0;zr--){var Cn=this.labels[zr];if(Cn.statementStart===D.start)Cn.statementStart=this.start,Cn.kind=Br;else break}return this.labels.push({name:X,kind:Br,statementStart:this.start}),D.body=this.parseStatement(it?it.indexOf("label")===-1?it+"label":it:"label"),this.labels.pop(),D.label=Mt,this.finishNode(D,"LabeledStatement")},vt.parseExpressionStatement=function(D,X){return D.expression=X,this.semicolon(),this.finishNode(D,"ExpressionStatement")},vt.parseBlock=function(D,X,Mt){for(D===void 0&&(D=!0),X===void 0&&(X=this.startNode()),X.body=[],this.expect(rt.braceL),D&&this.enterScope(0);this.type!==rt.braceR;){var it=this.parseStatement(null);X.body.push(it)}return Mt&&(this.strict=!1),this.next(),D&&this.exitScope(),this.finishNode(X,"BlockStatement")},vt.parseFor=function(D,X){return D.init=X,this.expect(rt.semi),D.test=this.type===rt.semi?null:this.parseExpression(),this.expect(rt.semi),D.update=this.type===rt.parenR?null:this.parseExpression(),this.expect(rt.parenR),D.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(D,"ForStatement")},vt.parseForIn=function(D,X){var Mt=this.type===rt._in;return this.next(),X.type==="VariableDeclaration"&&X.declarations[0].init!=null&&(!Mt||this.options.ecmaVersion<8||this.strict||X.kind!=="var"||X.declarations[0].id.type!=="Identifier")?this.raise(X.start,(Mt?"for-in":"for-of")+" loop variable declaration may not have an initializer"):X.type==="AssignmentPattern"&&this.raise(X.start,"Invalid left-hand side in for-loop"),D.left=X,D.right=Mt?this.parseExpression():this.parseMaybeAssign(),this.expect(rt.parenR),D.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(D,Mt?"ForInStatement":"ForOfStatement")},vt.parseVar=function(D,X,Mt){for(D.declarations=[],D.kind=Mt;;){var it=this.startNode();if(this.parseVarId(it,Mt),this.eat(rt.eq)?it.init=this.parseMaybeAssign(X):Mt==="const"&&!(this.type===rt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():it.id.type!=="Identifier"&&!(X&&(this.type===rt._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):it.init=null,D.declarations.push(this.finishNode(it,"VariableDeclarator")),!this.eat(rt.comma))break}return D},vt.parseVarId=function(D,X){D.id=this.parseBindingAtom(),this.checkLVal(D.id,X==="var"?xt:St,!1)};var Ie=1,We=2,Ke=4;vt.parseFunction=function(D,X,Mt,it){this.initFunction(D),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!it)&&(this.type===rt.star&&X&We&&this.unexpected(),D.generator=this.eat(rt.star)),this.options.ecmaVersion>=8&&(D.async=!!it),X&Ie&&(D.id=X&Ke&&this.type!==rt.name?null:this.parseIdent(),D.id&&!(X&We)&&this.checkLVal(D.id,this.strict||D.generator||D.async?this.treatFunctionsAsVar?xt:St:ue));var Jt=this.yieldPos,Ue=this.awaitPos,yr=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Wt(D.async,D.generator)),X&Ie||(D.id=this.type===rt.name?this.parseIdent():null),this.parseFunctionParams(D),this.parseFunctionBody(D,Mt,!1),this.yieldPos=Jt,this.awaitPos=Ue,this.awaitIdentPos=yr,this.finishNode(D,X&Ie?"FunctionDeclaration":"FunctionExpression")},vt.parseFunctionParams=function(D){this.expect(rt.parenL),D.params=this.parseBindingList(rt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},vt.parseClass=function(D,X){this.next();var Mt=this.strict;this.strict=!0,this.parseClassId(D,X),this.parseClassSuper(D);var it=this.startNode(),Jt=!1;for(it.body=[],this.expect(rt.braceL);this.type!==rt.braceR;){var Ue=this.parseClassElement(D.superClass!==null);Ue&&(it.body.push(Ue),Ue.type==="MethodDefinition"&&Ue.kind==="constructor"&&(Jt&&this.raise(Ue.start,"Duplicate constructor in the same class"),Jt=!0))}return this.strict=Mt,this.next(),D.body=this.finishNode(it,"ClassBody"),this.finishNode(D,X?"ClassDeclaration":"ClassExpression")},vt.parseClassElement=function(D){var X=this;if(this.eat(rt.semi))return null;var Mt=this.startNode(),it=function(zr,Cn){Cn===void 0&&(Cn=!1);var Vn=X.start,Ki=X.startLoc;return X.eatContextual(zr)?X.type!==rt.parenL&&(!Cn||!X.canInsertSemicolon())?!0:(Mt.key&&X.unexpected(),Mt.computed=!1,Mt.key=X.startNodeAt(Vn,Ki),Mt.key.name=zr,X.finishNode(Mt.key,"Identifier"),!1):!1};Mt.kind="method",Mt.static=it("static");var Jt=this.eat(rt.star),Ue=!1;Jt||(this.options.ecmaVersion>=8&&it("async",!0)?(Ue=!0,Jt=this.options.ecmaVersion>=9&&this.eat(rt.star)):it("get")?Mt.kind="get":it("set")&&(Mt.kind="set")),Mt.key||this.parsePropertyName(Mt);var yr=Mt.key,Br=!1;return!Mt.computed&&!Mt.static&&(yr.type==="Identifier"&&yr.name==="constructor"||yr.type==="Literal"&&yr.value==="constructor")?(Mt.kind!=="method"&&this.raise(yr.start,"Constructor can't have get/set modifier"),Jt&&this.raise(yr.start,"Constructor can't be a generator"),Ue&&this.raise(yr.start,"Constructor can't be an async method"),Mt.kind="constructor",Br=D):Mt.static&&yr.type==="Identifier"&&yr.name==="prototype"&&this.raise(yr.start,"Classes may not have a static property named prototype"),this.parseClassMethod(Mt,Jt,Ue,Br),Mt.kind==="get"&&Mt.value.params.length!==0&&this.raiseRecoverable(Mt.value.start,"getter should have no params"),Mt.kind==="set"&&Mt.value.params.length!==1&&this.raiseRecoverable(Mt.value.start,"setter should have exactly one param"),Mt.kind==="set"&&Mt.value.params[0].type==="RestElement"&&this.raiseRecoverable(Mt.value.params[0].start,"Setter cannot use rest params"),Mt},vt.parseClassMethod=function(D,X,Mt,it){return D.value=this.parseMethod(X,Mt,it),this.finishNode(D,"MethodDefinition")},vt.parseClassId=function(D,X){this.type===rt.name?(D.id=this.parseIdent(),X&&this.checkLVal(D.id,St,!1)):(X===!0&&this.unexpected(),D.id=null)},vt.parseClassSuper=function(D){D.superClass=this.eat(rt._extends)?this.parseExprSubscripts():null},vt.parseExport=function(D,X){if(this.next(),this.eat(rt.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(D.exported=this.parseIdent(!0),this.checkExport(X,D.exported.name,this.lastTokStart)):D.exported=null),this.expectContextual("from"),this.type!==rt.string&&this.unexpected(),D.source=this.parseExprAtom(),this.semicolon(),this.finishNode(D,"ExportAllDeclaration");if(this.eat(rt._default)){this.checkExport(X,"default",this.lastTokStart);var Mt;if(this.type===rt._function||(Mt=this.isAsyncFunction())){var it=this.startNode();this.next(),Mt&&this.next(),D.declaration=this.parseFunction(it,Ie|Ke,!1,Mt)}else if(this.type===rt._class){var Jt=this.startNode();D.declaration=this.parseClass(Jt,"nullableID")}else D.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(D,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())D.declaration=this.parseStatement(null),D.declaration.type==="VariableDeclaration"?this.checkVariableExport(X,D.declaration.declarations):this.checkExport(X,D.declaration.id.name,D.declaration.id.start),D.specifiers=[],D.source=null;else{if(D.declaration=null,D.specifiers=this.parseExportSpecifiers(X),this.eatContextual("from"))this.type!==rt.string&&this.unexpected(),D.source=this.parseExprAtom();else{for(var Ue=0,yr=D.specifiers;Ue<yr.length;Ue+=1){var Br=yr[Ue];this.checkUnreserved(Br.local),this.checkLocalExport(Br.local)}D.source=null}this.semicolon()}return this.finishNode(D,"ExportNamedDeclaration")},vt.checkExport=function(D,X,Mt){D&&(te(D,X)&&this.raiseRecoverable(Mt,"Duplicate export '"+X+"'"),D[X]=!0)},vt.checkPatternExport=function(D,X){var Mt=X.type;if(Mt==="Identifier")this.checkExport(D,X.name,X.start);else if(Mt==="ObjectPattern")for(var it=0,Jt=X.properties;it<Jt.length;it+=1){var Ue=Jt[it];this.checkPatternExport(D,Ue)}else if(Mt==="ArrayPattern")for(var yr=0,Br=X.elements;yr<Br.length;yr+=1){var zr=Br[yr];zr&&this.checkPatternExport(D,zr)}else Mt==="Property"?this.checkPatternExport(D,X.value):Mt==="AssignmentPattern"?this.checkPatternExport(D,X.left):Mt==="RestElement"?this.checkPatternExport(D,X.argument):Mt==="ParenthesizedExpression"&&this.checkPatternExport(D,X.expression)},vt.checkVariableExport=function(D,X){if(D)for(var Mt=0,it=X;Mt<it.length;Mt+=1){var Jt=it[Mt];this.checkPatternExport(D,Jt.id)}},vt.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},vt.parseExportSpecifiers=function(D){var X=[],Mt=!0;for(this.expect(rt.braceL);!this.eat(rt.braceR);){if(Mt)Mt=!1;else if(this.expect(rt.comma),this.afterTrailingComma(rt.braceR))break;var it=this.startNode();it.local=this.parseIdent(!0),it.exported=this.eatContextual("as")?this.parseIdent(!0):it.local,this.checkExport(D,it.exported.name,it.exported.start),X.push(this.finishNode(it,"ExportSpecifier"))}return X},vt.parseImport=function(D){return this.next(),this.type===rt.string?(D.specifiers=jt,D.source=this.parseExprAtom()):(D.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),D.source=this.type===rt.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(D,"ImportDeclaration")},vt.parseImportSpecifiers=function(){var D=[],X=!0;if(this.type===rt.name){var Mt=this.startNode();if(Mt.local=this.parseIdent(),this.checkLVal(Mt.local,St),D.push(this.finishNode(Mt,"ImportDefaultSpecifier")),!this.eat(rt.comma))return D}if(this.type===rt.star){var it=this.startNode();return this.next(),this.expectContextual("as"),it.local=this.parseIdent(),this.checkLVal(it.local,St),D.push(this.finishNode(it,"ImportNamespaceSpecifier")),D}for(this.expect(rt.braceL);!this.eat(rt.braceR);){if(X)X=!1;else if(this.expect(rt.comma),this.afterTrailingComma(rt.braceR))break;var Jt=this.startNode();Jt.imported=this.parseIdent(!0),this.eatContextual("as")?Jt.local=this.parseIdent():(this.checkUnreserved(Jt.imported),Jt.local=Jt.imported),this.checkLVal(Jt.local,St),D.push(this.finishNode(Jt,"ImportSpecifier"))}return D},vt.adaptDirectivePrologue=function(D){for(var X=0;X<D.length&&this.isDirectiveCandidate(D[X]);++X)D[X].directive=D[X].expression.raw.slice(1,-1)},vt.isDirectiveCandidate=function(D){return D.type==="ExpressionStatement"&&D.expression.type==="Literal"&&typeof D.expression.value=="string"&&(this.input[D.start]==='"'||this.input[D.start]==="'")};var pr=Vt.prototype;pr.toAssignable=function(D,X,Mt){if(this.options.ecmaVersion>=6&&D)switch(D.type){case"Identifier":this.inAsync&&D.name==="await"&&this.raise(D.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":D.type="ObjectPattern",Mt&&this.checkPatternErrors(Mt,!0);for(var it=0,Jt=D.properties;it<Jt.length;it+=1){var Ue=Jt[it];this.toAssignable(Ue,X),Ue.type==="RestElement"&&(Ue.argument.type==="ArrayPattern"||Ue.argument.type==="ObjectPattern")&&this.raise(Ue.argument.start,"Unexpected token")}break;case"Property":D.kind!=="init"&&this.raise(D.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(D.value,X);break;case"ArrayExpression":D.type="ArrayPattern",Mt&&this.checkPatternErrors(Mt,!0),this.toAssignableList(D.elements,X);break;case"SpreadElement":D.type="RestElement",this.toAssignable(D.argument,X),D.argument.type==="AssignmentPattern"&&this.raise(D.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":D.operator!=="="&&this.raise(D.left.end,"Only '=' operator can be used for specifying default value."),D.type="AssignmentPattern",delete D.operator,this.toAssignable(D.left,X);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(D.expression,X,Mt);break;case"ChainExpression":this.raiseRecoverable(D.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!X)break;default:this.raise(D.start,"Assigning to rvalue")}else Mt&&this.checkPatternErrors(Mt,!0);return D},pr.toAssignableList=function(D,X){for(var Mt=D.length,it=0;it<Mt;it++){var Jt=D[it];Jt&&this.toAssignable(Jt,X)}if(Mt){var Ue=D[Mt-1];this.options.ecmaVersion===6&&X&&Ue&&Ue.type==="RestElement"&&Ue.argument.type!=="Identifier"&&this.unexpected(Ue.argument.start)}return D},pr.parseSpread=function(D){var X=this.startNode();return this.next(),X.argument=this.parseMaybeAssign(!1,D),this.finishNode(X,"SpreadElement")},pr.parseRestBinding=function(){var D=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==rt.name&&this.unexpected(),D.argument=this.parseBindingAtom(),this.finishNode(D,"RestElement")},pr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case rt.bracketL:var D=this.startNode();return this.next(),D.elements=this.parseBindingList(rt.bracketR,!0,!0),this.finishNode(D,"ArrayPattern");case rt.braceL:return this.parseObj(!0)}return this.parseIdent()},pr.parseBindingList=function(D,X,Mt){for(var it=[],Jt=!0;!this.eat(D);)if(Jt?Jt=!1:this.expect(rt.comma),X&&this.type===rt.comma)it.push(null);else{if(Mt&&this.afterTrailingComma(D))break;if(this.type===rt.ellipsis){var Ue=this.parseRestBinding();this.parseBindingListItem(Ue),it.push(Ue),this.type===rt.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(D);break}else{var yr=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(yr),it.push(yr)}}return it},pr.parseBindingListItem=function(D){return D},pr.parseMaybeDefault=function(D,X,Mt){if(Mt=Mt||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(rt.eq))return Mt;var it=this.startNodeAt(D,X);return it.left=Mt,it.right=this.parseMaybeAssign(),this.finishNode(it,"AssignmentPattern")},pr.checkLVal=function(D,X,Mt){switch(X===void 0&&(X=$t),D.type){case"Identifier":X===St&&D.name==="let"&&this.raiseRecoverable(D.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(D.name)&&this.raiseRecoverable(D.start,(X?"Binding ":"Assigning to ")+D.name+" in strict mode"),Mt&&(te(Mt,D.name)&&this.raiseRecoverable(D.start,"Argument name clash"),Mt[D.name]=!0),X!==$t&&X!==ze&&this.declareName(D.name,X,D.start);break;case"ChainExpression":this.raiseRecoverable(D.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":X&&this.raiseRecoverable(D.start,"Binding member expression");break;case"ObjectPattern":for(var it=0,Jt=D.properties;it<Jt.length;it+=1){var Ue=Jt[it];this.checkLVal(Ue,X,Mt)}break;case"Property":this.checkLVal(D.value,X,Mt);break;case"ArrayPattern":for(var yr=0,Br=D.elements;yr<Br.length;yr+=1){var zr=Br[yr];zr&&this.checkLVal(zr,X,Mt)}break;case"AssignmentPattern":this.checkLVal(D.left,X,Mt);break;case"RestElement":this.checkLVal(D.argument,X,Mt);break;case"ParenthesizedExpression":this.checkLVal(D.expression,X,Mt);break;default:this.raise(D.start,(X?"Binding":"Assigning to")+" rvalue")}};var lr=Vt.prototype;lr.checkPropClash=function(D,X,Mt){if(!(this.options.ecmaVersion>=9&&D.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(D.computed||D.method||D.shorthand))){var it=D.key,Jt;switch(it.type){case"Identifier":Jt=it.name;break;case"Literal":Jt=String(it.value);break;default:return}var Ue=D.kind;if(this.options.ecmaVersion>=6){Jt==="__proto__"&&Ue==="init"&&(X.proto&&(Mt?Mt.doubleProto<0&&(Mt.doubleProto=it.start):this.raiseRecoverable(it.start,"Redefinition of __proto__ property")),X.proto=!0);return}Jt="$"+Jt;var yr=X[Jt];if(yr){var Br;Ue==="init"?Br=this.strict&&yr.init||yr.get||yr.set:Br=yr.init||yr[Ue],Br&&this.raiseRecoverable(it.start,"Redefinition of property")}else yr=X[Jt]={init:!1,get:!1,set:!1};yr[Ue]=!0}},lr.parseExpression=function(D,X){var Mt=this.start,it=this.startLoc,Jt=this.parseMaybeAssign(D,X);if(this.type===rt.comma){var Ue=this.startNodeAt(Mt,it);for(Ue.expressions=[Jt];this.eat(rt.comma);)Ue.expressions.push(this.parseMaybeAssign(D,X));return this.finishNode(Ue,"SequenceExpression")}return Jt},lr.parseMaybeAssign=function(D,X,Mt){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(D);this.exprAllowed=!1}var it=!1,Jt=-1,Ue=-1;X?(Jt=X.parenthesizedAssign,Ue=X.trailingComma,X.parenthesizedAssign=X.trailingComma=-1):(X=new tt,it=!0);var yr=this.start,Br=this.startLoc;(this.type===rt.parenL||this.type===rt.name)&&(this.potentialArrowAt=this.start);var zr=this.parseMaybeConditional(D,X);if(Mt&&(zr=Mt.call(this,zr,yr,Br)),this.type.isAssign){var Cn=this.startNodeAt(yr,Br);return Cn.operator=this.value,Cn.left=this.type===rt.eq?this.toAssignable(zr,!1,X):zr,it||(X.parenthesizedAssign=X.trailingComma=X.doubleProto=-1),X.shorthandAssign>=Cn.left.start&&(X.shorthandAssign=-1),this.checkLVal(zr),this.next(),Cn.right=this.parseMaybeAssign(D),this.finishNode(Cn,"AssignmentExpression")}else it&&this.checkExpressionErrors(X,!0);return Jt>-1&&(X.parenthesizedAssign=Jt),Ue>-1&&(X.trailingComma=Ue),zr},lr.parseMaybeConditional=function(D,X){var Mt=this.start,it=this.startLoc,Jt=this.parseExprOps(D,X);if(this.checkExpressionErrors(X))return Jt;if(this.eat(rt.question)){var Ue=this.startNodeAt(Mt,it);return Ue.test=Jt,Ue.consequent=this.parseMaybeAssign(),this.expect(rt.colon),Ue.alternate=this.parseMaybeAssign(D),this.finishNode(Ue,"ConditionalExpression")}return Jt},lr.parseExprOps=function(D,X){var Mt=this.start,it=this.startLoc,Jt=this.parseMaybeUnary(X,!1);return this.checkExpressionErrors(X)||Jt.start===Mt&&Jt.type==="ArrowFunctionExpression"?Jt:this.parseExprOp(Jt,Mt,it,-1,D)},lr.parseExprOp=function(D,X,Mt,it,Jt){var Ue=this.type.binop;if(Ue!=null&&(!Jt||this.type!==rt._in)&&Ue>it){var yr=this.type===rt.logicalOR||this.type===rt.logicalAND,Br=this.type===rt.coalesce;Br&&(Ue=rt.logicalAND.binop);var zr=this.value;this.next();var Cn=this.start,Vn=this.startLoc,Ki=this.parseExprOp(this.parseMaybeUnary(null,!1),Cn,Vn,Ue,Jt),Ma=this.buildBinary(X,Mt,D,Ki,zr,yr||Br);return(yr&&this.type===rt.coalesce||Br&&(this.type===rt.logicalOR||this.type===rt.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Ma,X,Mt,it,Jt)}return D},lr.buildBinary=function(D,X,Mt,it,Jt,Ue){var yr=this.startNodeAt(D,X);return yr.left=Mt,yr.operator=Jt,yr.right=it,this.finishNode(yr,Ue?"LogicalExpression":"BinaryExpression")},lr.parseMaybeUnary=function(D,X){var Mt=this.start,it=this.startLoc,Jt;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))Jt=this.parseAwait(),X=!0;else if(this.type.prefix){var Ue=this.startNode(),yr=this.type===rt.incDec;Ue.operator=this.value,Ue.prefix=!0,this.next(),Ue.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(D,!0),yr?this.checkLVal(Ue.argument):this.strict&&Ue.operator==="delete"&&Ue.argument.type==="Identifier"?this.raiseRecoverable(Ue.start,"Deleting local variable in strict mode"):X=!0,Jt=this.finishNode(Ue,yr?"UpdateExpression":"UnaryExpression")}else{if(Jt=this.parseExprSubscripts(D),this.checkExpressionErrors(D))return Jt;for(;this.type.postfix&&!this.canInsertSemicolon();){var Br=this.startNodeAt(Mt,it);Br.operator=this.value,Br.prefix=!1,Br.argument=Jt,this.checkLVal(Jt),this.next(),Jt=this.finishNode(Br,"UpdateExpression")}}return!X&&this.eat(rt.starstar)?this.buildBinary(Mt,it,Jt,this.parseMaybeUnary(null,!1),"**",!1):Jt},lr.parseExprSubscripts=function(D){var X=this.start,Mt=this.startLoc,it=this.parseExprAtom(D);if(it.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return it;var Jt=this.parseSubscripts(it,X,Mt);return D&&Jt.type==="MemberExpression"&&(D.parenthesizedAssign>=Jt.start&&(D.parenthesizedAssign=-1),D.parenthesizedBind>=Jt.start&&(D.parenthesizedBind=-1)),Jt},lr.parseSubscripts=function(D,X,Mt,it){for(var Jt=this.options.ecmaVersion>=8&&D.type==="Identifier"&&D.name==="async"&&this.lastTokEnd===D.end&&!this.canInsertSemicolon()&&D.end-D.start===5&&this.potentialArrowAt===D.start,Ue=!1;;){var yr=this.parseSubscript(D,X,Mt,it,Jt,Ue);if(yr.optional&&(Ue=!0),yr===D||yr.type==="ArrowFunctionExpression"){if(Ue){var Br=this.startNodeAt(X,Mt);Br.expression=yr,yr=this.finishNode(Br,"ChainExpression")}return yr}D=yr}},lr.parseSubscript=function(D,X,Mt,it,Jt,Ue){var yr=this.options.ecmaVersion>=11,Br=yr&&this.eat(rt.questionDot);it&&Br&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var zr=this.eat(rt.bracketL);if(zr||Br&&this.type!==rt.parenL&&this.type!==rt.backQuote||this.eat(rt.dot)){var Cn=this.startNodeAt(X,Mt);Cn.object=D,Cn.property=zr?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),Cn.computed=!!zr,zr&&this.expect(rt.bracketR),yr&&(Cn.optional=Br),D=this.finishNode(Cn,"MemberExpression")}else if(!it&&this.eat(rt.parenL)){var Vn=new tt,Ki=this.yieldPos,Ma=this.awaitPos,xa=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var lo=this.parseExprList(rt.parenR,this.options.ecmaVersion>=8,!1,Vn);if(Jt&&!Br&&!this.canInsertSemicolon()&&this.eat(rt.arrow))return this.checkPatternErrors(Vn,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Ki,this.awaitPos=Ma,this.awaitIdentPos=xa,this.parseArrowExpression(this.startNodeAt(X,Mt),lo,!0);this.checkExpressionErrors(Vn,!0),this.yieldPos=Ki||this.yieldPos,this.awaitPos=Ma||this.awaitPos,this.awaitIdentPos=xa||this.awaitIdentPos;var Ro=this.startNodeAt(X,Mt);Ro.callee=D,Ro.arguments=lo,yr&&(Ro.optional=Br),D=this.finishNode(Ro,"CallExpression")}else if(this.type===rt.backQuote){(Br||Ue)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Io=this.startNodeAt(X,Mt);Io.tag=D,Io.quasi=this.parseTemplate({isTagged:!0}),D=this.finishNode(Io,"TaggedTemplateExpression")}return D},lr.parseExprAtom=function(D){this.type===rt.slash&&this.readRegexp();var X,Mt=this.potentialArrowAt===this.start;switch(this.type){case rt._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),X=this.startNode(),this.next(),this.type===rt.parenL&&!this.allowDirectSuper&&this.raise(X.start,"super() call outside constructor of a subclass"),this.type!==rt.dot&&this.type!==rt.bracketL&&this.type!==rt.parenL&&this.unexpected(),this.finishNode(X,"Super");case rt._this:return X=this.startNode(),this.next(),this.finishNode(X,"ThisExpression");case rt.name:var it=this.start,Jt=this.startLoc,Ue=this.containsEsc,yr=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Ue&&yr.name==="async"&&!this.canInsertSemicolon()&&this.eat(rt._function))return this.parseFunction(this.startNodeAt(it,Jt),0,!1,!0);if(Mt&&!this.canInsertSemicolon()){if(this.eat(rt.arrow))return this.parseArrowExpression(this.startNodeAt(it,Jt),[yr],!1);if(this.options.ecmaVersion>=8&&yr.name==="async"&&this.type===rt.name&&!Ue)return yr=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(rt.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(it,Jt),[yr],!0)}return yr;case rt.regexp:var Br=this.value;return X=this.parseLiteral(Br.value),X.regex={pattern:Br.pattern,flags:Br.flags},X;case rt.num:case rt.string:return this.parseLiteral(this.value);case rt._null:case rt._true:case rt._false:return X=this.startNode(),X.value=this.type===rt._null?null:this.type===rt._true,X.raw=this.type.keyword,this.next(),this.finishNode(X,"Literal");case rt.parenL:var zr=this.start,Cn=this.parseParenAndDistinguishExpression(Mt);return D&&(D.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Cn)&&(D.parenthesizedAssign=zr),D.parenthesizedBind<0&&(D.parenthesizedBind=zr)),Cn;case rt.bracketL:return X=this.startNode(),this.next(),X.elements=this.parseExprList(rt.bracketR,!0,!0,D),this.finishNode(X,"ArrayExpression");case rt.braceL:return this.parseObj(!1,D);case rt._function:return X=this.startNode(),this.next(),this.parseFunction(X,0);case rt._class:return this.parseClass(this.startNode(),!1);case rt._new:return this.parseNew();case rt.backQuote:return this.parseTemplate();case rt._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},lr.parseExprImport=function(){var D=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var X=this.parseIdent(!0);switch(this.type){case rt.parenL:return this.parseDynamicImport(D);case rt.dot:return D.meta=X,this.parseImportMeta(D);default:this.unexpected()}},lr.parseDynamicImport=function(D){if(this.next(),D.source=this.parseMaybeAssign(),!this.eat(rt.parenR)){var X=this.start;this.eat(rt.comma)&&this.eat(rt.parenR)?this.raiseRecoverable(X,"Trailing comma is not allowed in import()"):this.unexpected(X)}return this.finishNode(D,"ImportExpression")},lr.parseImportMeta=function(D){this.next();var X=this.containsEsc;return D.property=this.parseIdent(!0),D.property.name!=="meta"&&this.raiseRecoverable(D.property.start,"The only valid meta property for import is 'import.meta'"),X&&this.raiseRecoverable(D.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(D.start,"Cannot use 'import.meta' outside a module"),this.finishNode(D,"MetaProperty")},lr.parseLiteral=function(D){var X=this.startNode();return X.value=D,X.raw=this.input.slice(this.start,this.end),X.raw.charCodeAt(X.raw.length-1)===110&&(X.bigint=X.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(X,"Literal")},lr.parseParenExpression=function(){this.expect(rt.parenL);var D=this.parseExpression();return this.expect(rt.parenR),D},lr.parseParenAndDistinguishExpression=function(D){var X=this.start,Mt=this.startLoc,it,Jt=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Ue=this.start,yr=this.startLoc,Br=[],zr=!0,Cn=!1,Vn=new tt,Ki=this.yieldPos,Ma=this.awaitPos,xa;for(this.yieldPos=0,this.awaitPos=0;this.type!==rt.parenR;)if(zr?zr=!1:this.expect(rt.comma),Jt&&this.afterTrailingComma(rt.parenR,!0)){Cn=!0;break}else if(this.type===rt.ellipsis){xa=this.start,Br.push(this.parseParenItem(this.parseRestBinding())),this.type===rt.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else Br.push(this.parseMaybeAssign(!1,Vn,this.parseParenItem));var lo=this.start,Ro=this.startLoc;if(this.expect(rt.parenR),D&&!this.canInsertSemicolon()&&this.eat(rt.arrow))return this.checkPatternErrors(Vn,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Ki,this.awaitPos=Ma,this.parseParenArrowList(X,Mt,Br);(!Br.length||Cn)&&this.unexpected(this.lastTokStart),xa&&this.unexpected(xa),this.checkExpressionErrors(Vn,!0),this.yieldPos=Ki||this.yieldPos,this.awaitPos=Ma||this.awaitPos,Br.length>1?(it=this.startNodeAt(Ue,yr),it.expressions=Br,this.finishNodeAt(it,"SequenceExpression",lo,Ro)):it=Br[0]}else it=this.parseParenExpression();if(this.options.preserveParens){var Io=this.startNodeAt(X,Mt);return Io.expression=it,this.finishNode(Io,"ParenthesizedExpression")}else return it},lr.parseParenItem=function(D){return D},lr.parseParenArrowList=function(D,X,Mt){return this.parseArrowExpression(this.startNodeAt(D,X),Mt)};var Nr=[];lr.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var D=this.startNode(),X=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(rt.dot)){D.meta=X;var Mt=this.containsEsc;return D.property=this.parseIdent(!0),D.property.name!=="target"&&this.raiseRecoverable(D.property.start,"The only valid meta property for new is 'new.target'"),Mt&&this.raiseRecoverable(D.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(D.start,"'new.target' can only be used in functions"),this.finishNode(D,"MetaProperty")}var it=this.start,Jt=this.startLoc,Ue=this.type===rt._import;return D.callee=this.parseSubscripts(this.parseExprAtom(),it,Jt,!0),Ue&&D.callee.type==="ImportExpression"&&this.raise(it,"Cannot use new with import()"),this.eat(rt.parenL)?D.arguments=this.parseExprList(rt.parenR,this.options.ecmaVersion>=8,!1):D.arguments=Nr,this.finishNode(D,"NewExpression")},lr.parseTemplateElement=function(D){var X=D.isTagged,Mt=this.startNode();return this.type===rt.invalidTemplate?(X||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),Mt.value={raw:this.value,cooked:null}):Mt.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),Mt.tail=this.type===rt.backQuote,this.finishNode(Mt,"TemplateElement")},lr.parseTemplate=function(D){D===void 0&&(D={});var X=D.isTagged;X===void 0&&(X=!1);var Mt=this.startNode();this.next(),Mt.expressions=[];var it=this.parseTemplateElement({isTagged:X});for(Mt.quasis=[it];!it.tail;)this.type===rt.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(rt.dollarBraceL),Mt.expressions.push(this.parseExpression()),this.expect(rt.braceR),Mt.quasis.push(it=this.parseTemplateElement({isTagged:X}));return this.next(),this.finishNode(Mt,"TemplateLiteral")},lr.isAsyncProp=function(D){return!D.computed&&D.key.type==="Identifier"&&D.key.name==="async"&&(this.type===rt.name||this.type===rt.num||this.type===rt.string||this.type===rt.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===rt.star)&&!Dt.test(this.input.slice(this.lastTokEnd,this.start))},lr.parseObj=function(D,X){var Mt=this.startNode(),it=!0,Jt={};for(Mt.properties=[],this.next();!this.eat(rt.braceR);){if(it)it=!1;else if(this.expect(rt.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(rt.braceR))break;var Ue=this.parseProperty(D,X);D||this.checkPropClash(Ue,Jt,X),Mt.properties.push(Ue)}return this.finishNode(Mt,D?"ObjectPattern":"ObjectExpression")},lr.parseProperty=function(D,X){var Mt=this.startNode(),it,Jt,Ue,yr;if(this.options.ecmaVersion>=9&&this.eat(rt.ellipsis))return D?(Mt.argument=this.parseIdent(!1),this.type===rt.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(Mt,"RestElement")):(this.type===rt.parenL&&X&&(X.parenthesizedAssign<0&&(X.parenthesizedAssign=this.start),X.parenthesizedBind<0&&(X.parenthesizedBind=this.start)),Mt.argument=this.parseMaybeAssign(!1,X),this.type===rt.comma&&X&&X.trailingComma<0&&(X.trailingComma=this.start),this.finishNode(Mt,"SpreadElement"));this.options.ecmaVersion>=6&&(Mt.method=!1,Mt.shorthand=!1,(D||X)&&(Ue=this.start,yr=this.startLoc),D||(it=this.eat(rt.star)));var Br=this.containsEsc;return this.parsePropertyName(Mt),!D&&!Br&&this.options.ecmaVersion>=8&&!it&&this.isAsyncProp(Mt)?(Jt=!0,it=this.options.ecmaVersion>=9&&this.eat(rt.star),this.parsePropertyName(Mt,X)):Jt=!1,this.parsePropertyValue(Mt,D,it,Jt,Ue,yr,X,Br),this.finishNode(Mt,"Property")},lr.parsePropertyValue=function(D,X,Mt,it,Jt,Ue,yr,Br){if((Mt||it)&&this.type===rt.colon&&this.unexpected(),this.eat(rt.colon))D.value=X?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,yr),D.kind="init";else if(this.options.ecmaVersion>=6&&this.type===rt.parenL)X&&this.unexpected(),D.kind="init",D.method=!0,D.value=this.parseMethod(Mt,it);else if(!X&&!Br&&this.options.ecmaVersion>=5&&!D.computed&&D.key.type==="Identifier"&&(D.key.name==="get"||D.key.name==="set")&&this.type!==rt.comma&&this.type!==rt.braceR&&this.type!==rt.eq){(Mt||it)&&this.unexpected(),D.kind=D.key.name,this.parsePropertyName(D),D.value=this.parseMethod(!1);var zr=D.kind==="get"?0:1;if(D.value.params.length!==zr){var Cn=D.value.start;D.kind==="get"?this.raiseRecoverable(Cn,"getter should have no params"):this.raiseRecoverable(Cn,"setter should have exactly one param")}else D.kind==="set"&&D.value.params[0].type==="RestElement"&&this.raiseRecoverable(D.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!D.computed&&D.key.type==="Identifier"?((Mt||it)&&this.unexpected(),this.checkUnreserved(D.key),D.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Jt),D.kind="init",X?D.value=this.parseMaybeDefault(Jt,Ue,D.key):this.type===rt.eq&&yr?(yr.shorthandAssign<0&&(yr.shorthandAssign=this.start),D.value=this.parseMaybeDefault(Jt,Ue,D.key)):D.value=D.key,D.shorthand=!0):this.unexpected()},lr.parsePropertyName=function(D){if(this.options.ecmaVersion>=6){if(this.eat(rt.bracketL))return D.computed=!0,D.key=this.parseMaybeAssign(),this.expect(rt.bracketR),D.key;D.computed=!1}return D.key=this.type===rt.num||this.type===rt.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},lr.initFunction=function(D){D.id=null,this.options.ecmaVersion>=6&&(D.generator=D.expression=!1),this.options.ecmaVersion>=8&&(D.async=!1)},lr.parseMethod=function(D,X,Mt){var it=this.startNode(),Jt=this.yieldPos,Ue=this.awaitPos,yr=this.awaitIdentPos;return this.initFunction(it),this.options.ecmaVersion>=6&&(it.generator=D),this.options.ecmaVersion>=8&&(it.async=!!X),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Wt(X,it.generator)|qt|(Mt?bt:0)),this.expect(rt.parenL),it.params=this.parseBindingList(rt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(it,!1,!0),this.yieldPos=Jt,this.awaitPos=Ue,this.awaitIdentPos=yr,this.finishNode(it,"FunctionExpression")},lr.parseArrowExpression=function(D,X,Mt){var it=this.yieldPos,Jt=this.awaitPos,Ue=this.awaitIdentPos;return this.enterScope(Wt(Mt,!1)|vr),this.initFunction(D),this.options.ecmaVersion>=8&&(D.async=!!Mt),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,D.params=this.toAssignableList(X,!0),this.parseFunctionBody(D,!0,!1),this.yieldPos=it,this.awaitPos=Jt,this.awaitIdentPos=Ue,this.finishNode(D,"ArrowFunctionExpression")},lr.parseFunctionBody=function(D,X,Mt){var it=X&&this.type!==rt.braceL,Jt=this.strict,Ue=!1;if(it)D.body=this.parseMaybeAssign(),D.expression=!0,this.checkParams(D,!1);else{var yr=this.options.ecmaVersion>=7&&!this.isSimpleParamList(D.params);(!Jt||yr)&&(Ue=this.strictDirective(this.end),Ue&&yr&&this.raiseRecoverable(D.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var Br=this.labels;this.labels=[],Ue&&(this.strict=!0),this.checkParams(D,!Jt&&!Ue&&!X&&!Mt&&this.isSimpleParamList(D.params)),this.strict&&D.id&&this.checkLVal(D.id,ze),D.body=this.parseBlock(!1,void 0,Ue&&!Jt),D.expression=!1,this.adaptDirectivePrologue(D.body.body),this.labels=Br}this.exitScope()},lr.isSimpleParamList=function(D){for(var X=0,Mt=D;X<Mt.length;X+=1){var it=Mt[X];if(it.type!=="Identifier")return!1}return!0},lr.checkParams=function(D,X){for(var Mt={},it=0,Jt=D.params;it<Jt.length;it+=1){var Ue=Jt[it];this.checkLVal(Ue,xt,X?null:Mt)}},lr.parseExprList=function(D,X,Mt,it){for(var Jt=[],Ue=!0;!this.eat(D);){if(Ue)Ue=!1;else if(this.expect(rt.comma),X&&this.afterTrailingComma(D))break;var yr=void 0;Mt&&this.type===rt.comma?yr=null:this.type===rt.ellipsis?(yr=this.parseSpread(it),it&&this.type===rt.comma&&it.trailingComma<0&&(it.trailingComma=this.start)):yr=this.parseMaybeAssign(!1,it),Jt.push(yr)}return Jt},lr.checkUnreserved=function(D){var X=D.start,Mt=D.end,it=D.name;if(this.inGenerator&&it==="yield"&&this.raiseRecoverable(X,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&it==="await"&&this.raiseRecoverable(X,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(it)&&this.raise(X,"Unexpected keyword '"+it+"'"),!(this.options.ecmaVersion<6&&this.input.slice(X,Mt).indexOf("\\")!==-1)){var Jt=this.strict?this.reservedWordsStrict:this.reservedWords;Jt.test(it)&&(!this.inAsync&&it==="await"&&this.raiseRecoverable(X,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(X,"The keyword '"+it+"' is reserved"))}},lr.parseIdent=function(D,X){var Mt=this.startNode();return this.type===rt.name?Mt.name=this.value:this.type.keyword?(Mt.name=this.type.keyword,(Mt.name==="class"||Mt.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!D),this.finishNode(Mt,"Identifier"),D||(this.checkUnreserved(Mt),Mt.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=Mt.start)),Mt},lr.parseYield=function(D){this.yieldPos||(this.yieldPos=this.start);var X=this.startNode();return this.next(),this.type===rt.semi||this.canInsertSemicolon()||this.type!==rt.star&&!this.type.startsExpr?(X.delegate=!1,X.argument=null):(X.delegate=this.eat(rt.star),X.argument=this.parseMaybeAssign(D)),this.finishNode(X,"YieldExpression")},lr.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var D=this.startNode();return this.next(),D.argument=this.parseMaybeUnary(null,!1),this.finishNode(D,"AwaitExpression")};var Pr=Vt.prototype;Pr.raise=function(D,X){var Mt=he(this.input,D);X+=" ("+Mt.line+":"+Mt.column+")";var it=new SyntaxError(X);throw it.pos=D,it.loc=Mt,it.raisedAt=this.pos,it},Pr.raiseRecoverable=Pr.raise,Pr.curPosition=function(){if(this.options.locations)return new Y(this.curLine,this.pos-this.lineStart)};var Gr=Vt.prototype,Sn=function(X){this.flags=X,this.var=[],this.lexical=[],this.functions=[]};Gr.enterScope=function(D){this.scopeStack.push(new Sn(D))},Gr.exitScope=function(){this.scopeStack.pop()},Gr.treatFunctionsAsVarInScope=function(D){return D.flags&re||!this.inModule&&D.flags&Bt},Gr.declareName=function(D,X,Mt){var it=!1;if(X===St){var Jt=this.currentScope();it=Jt.lexical.indexOf(D)>-1||Jt.functions.indexOf(D)>-1||Jt.var.indexOf(D)>-1,Jt.lexical.push(D),this.inModule&&Jt.flags&Bt&&delete this.undefinedExports[D]}else if(X===Pe){var Ue=this.currentScope();Ue.lexical.push(D)}else if(X===ue){var yr=this.currentScope();this.treatFunctionsAsVar?it=yr.lexical.indexOf(D)>-1:it=yr.lexical.indexOf(D)>-1||yr.var.indexOf(D)>-1,yr.functions.push(D)}else for(var Br=this.scopeStack.length-1;Br>=0;--Br){var zr=this.scopeStack[Br];if(zr.lexical.indexOf(D)>-1&&!(zr.flags&oe&&zr.lexical[0]===D)||!this.treatFunctionsAsVarInScope(zr)&&zr.functions.indexOf(D)>-1){it=!0;break}if(zr.var.push(D),this.inModule&&zr.flags&Bt&&delete this.undefinedExports[D],zr.flags&ye)break}it&&this.raiseRecoverable(Mt,"Identifier '"+D+"' has already been declared")},Gr.checkLocalExport=function(D){this.scopeStack[0].lexical.indexOf(D.name)===-1&&this.scopeStack[0].var.indexOf(D.name)===-1&&(this.undefinedExports[D.name]=D)},Gr.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Gr.currentVarScope=function(){for(var D=this.scopeStack.length-1;;D--){var X=this.scopeStack[D];if(X.flags&ye)return X}},Gr.currentThisScope=function(){for(var D=this.scopeStack.length-1;;D--){var X=this.scopeStack[D];if(X.flags&ye&&!(X.flags&vr))return X}};var nn=function(X,Mt,it){this.type="",this.start=Mt,this.end=0,X.options.locations&&(this.loc=new gt(X,it)),X.options.directSourceFile&&(this.sourceFile=X.options.directSourceFile),X.options.ranges&&(this.range=[Mt,0])},Nn=Vt.prototype;Nn.startNode=function(){return new nn(this,this.start,this.startLoc)},Nn.startNodeAt=function(D,X){return new nn(this,D,X)};function Zn(D,X,Mt,it){return D.type=X,D.end=Mt,this.options.locations&&(D.loc.end=it),this.options.ranges&&(D.range[1]=Mt),D}Nn.finishNode=function(D,X){return Zn.call(this,D,X,this.lastTokEnd,this.lastTokEndLoc)},Nn.finishNodeAt=function(D,X,Mt,it){return Zn.call(this,D,X,Mt,it)};var Hn=function(X,Mt,it,Jt,Ue){this.token=X,this.isExpr=!!Mt,this.preserveSpace=!!it,this.override=Jt,this.generator=!!Ue},An={b_stat:new Hn("{",!1),b_expr:new Hn("{",!0),b_tmpl:new Hn("${",!1),p_stat:new Hn("(",!1),p_expr:new Hn("(",!0),q_tmpl:new Hn("`",!0,!0,function(D){return D.tryReadTemplateToken()}),f_stat:new Hn("function",!1),f_expr:new Hn("function",!0),f_expr_gen:new Hn("function",!0,!1,null,!0),f_gen:new Hn("function",!1,!1,null,!0)},$n=Vt.prototype;$n.initialContext=function(){return[An.b_stat]},$n.braceIsBlock=function(D){var X=this.curContext();return X===An.f_expr||X===An.f_stat?!0:D===rt.colon&&(X===An.b_stat||X===An.b_expr)?!X.isExpr:D===rt._return||D===rt.name&&this.exprAllowed?Dt.test(this.input.slice(this.lastTokEnd,this.start)):D===rt._else||D===rt.semi||D===rt.eof||D===rt.parenR||D===rt.arrow?!0:D===rt.braceL?X===An.b_stat:D===rt._var||D===rt._const||D===rt.name?!1:!this.exprAllowed},$n.inGeneratorContext=function(){for(var D=this.context.length-1;D>=1;D--){var X=this.context[D];if(X.token==="function")return X.generator}return!1},$n.updateContext=function(D){var X,Mt=this.type;Mt.keyword&&D===rt.dot?this.exprAllowed=!1:(X=Mt.updateContext)?X.call(this,D):this.exprAllowed=Mt.beforeExpr},rt.parenR.updateContext=rt.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var D=this.context.pop();D===An.b_stat&&this.curContext().token==="function"&&(D=this.context.pop()),this.exprAllowed=!D.isExpr},rt.braceL.updateContext=function(D){this.context.push(this.braceIsBlock(D)?An.b_stat:An.b_expr),this.exprAllowed=!0},rt.dollarBraceL.updateContext=function(){this.context.push(An.b_tmpl),this.exprAllowed=!0},rt.parenL.updateContext=function(D){var X=D===rt._if||D===rt._for||D===rt._with||D===rt._while;this.context.push(X?An.p_stat:An.p_expr),this.exprAllowed=!0},rt.incDec.updateContext=function(){},rt._function.updateContext=rt._class.updateContext=function(D){D.beforeExpr&&D!==rt.semi&&D!==rt._else&&!(D===rt._return&&Dt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((D===rt.colon||D===rt.braceL)&&this.curContext()===An.b_stat)?this.context.push(An.f_expr):this.context.push(An.f_stat),this.exprAllowed=!1},rt.backQuote.updateContext=function(){this.curContext()===An.q_tmpl?this.context.pop():this.context.push(An.q_tmpl),this.exprAllowed=!1},rt.star.updateContext=function(D){if(D===rt._function){var X=this.context.length-1;this.context[X]===An.f_expr?this.context[X]=An.f_expr_gen:this.context[X]=An.f_gen}this.exprAllowed=!0},rt.name.updateContext=function(D){var X=!1;this.options.ecmaVersion>=6&&D!==rt.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(X=!0),this.exprAllowed=X};var Rt="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Xt=Rt+" Extended_Pictographic",ae=Xt,we={9:Rt,10:Xt,11:ae},Ge="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",cr="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",br=cr+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Ce=br+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ar={9:cr,10:br,11:Ce},Hr={};function Tn(D){var X=Hr[D]={binary:wt(we[D]+" "+Ge),nonBinary:{General_Category:wt(Ge),Script:wt(ar[D])}};X.nonBinary.Script_Extensions=X.nonBinary.Script,X.nonBinary.gc=X.nonBinary.General_Category,X.nonBinary.sc=X.nonBinary.Script,X.nonBinary.scx=X.nonBinary.Script_Extensions}Tn(9),Tn(10),Tn(11);var Kr=Vt.prototype,an=function(X){this.parser=X,this.validFlags="gim"+(X.options.ecmaVersion>=6?"uy":"")+(X.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Hr[X.options.ecmaVersion>=11?11:X.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};an.prototype.reset=function(X,Mt,it){var Jt=it.indexOf("u")!==-1;this.start=X|0,this.source=Mt+"",this.flags=it,this.switchU=Jt&&this.parser.options.ecmaVersion>=6,this.switchN=Jt&&this.parser.options.ecmaVersion>=9},an.prototype.raise=function(X){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+X)},an.prototype.at=function(X,Mt){Mt===void 0&&(Mt=!1);var it=this.source,Jt=it.length;if(X>=Jt)return-1;var Ue=it.charCodeAt(X);if(!(Mt||this.switchU)||Ue<=55295||Ue>=57344||X+1>=Jt)return Ue;var yr=it.charCodeAt(X+1);return yr>=56320&&yr<=57343?(Ue<<10)+yr-56613888:Ue},an.prototype.nextIndex=function(X,Mt){Mt===void 0&&(Mt=!1);var it=this.source,Jt=it.length;if(X>=Jt)return Jt;var Ue=it.charCodeAt(X),yr;return!(Mt||this.switchU)||Ue<=55295||Ue>=57344||X+1>=Jt||(yr=it.charCodeAt(X+1))<56320||yr>57343?X+1:X+2},an.prototype.current=function(X){return X===void 0&&(X=!1),this.at(this.pos,X)},an.prototype.lookahead=function(X){return X===void 0&&(X=!1),this.at(this.nextIndex(this.pos,X),X)},an.prototype.advance=function(X){X===void 0&&(X=!1),this.pos=this.nextIndex(this.pos,X)},an.prototype.eat=function(X,Mt){return Mt===void 0&&(Mt=!1),this.current(Mt)===X?(this.advance(Mt),!0):!1};function Pn(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}Kr.validateRegExpFlags=function(D){for(var X=D.validFlags,Mt=D.flags,it=0;it<Mt.length;it++){var Jt=Mt.charAt(it);X.indexOf(Jt)===-1&&this.raise(D.start,"Invalid regular expression flag"),Mt.indexOf(Jt,it+1)>-1&&this.raise(D.start,"Duplicate regular expression flag")}},Kr.validateRegExpPattern=function(D){this.regexp_pattern(D),!D.switchN&&this.options.ecmaVersion>=9&&D.groupNames.length>0&&(D.switchN=!0,this.regexp_pattern(D))},Kr.regexp_pattern=function(D){D.pos=0,D.lastIntValue=0,D.lastStringValue="",D.lastAssertionIsQuantifiable=!1,D.numCapturingParens=0,D.maxBackReference=0,D.groupNames.length=0,D.backReferenceNames.length=0,this.regexp_disjunction(D),D.pos!==D.source.length&&(D.eat(41)&&D.raise("Unmatched ')'"),(D.eat(93)||D.eat(125))&&D.raise("Lone quantifier brackets")),D.maxBackReference>D.numCapturingParens&&D.raise("Invalid escape");for(var X=0,Mt=D.backReferenceNames;X<Mt.length;X+=1){var it=Mt[X];D.groupNames.indexOf(it)===-1&&D.raise("Invalid named capture referenced")}},Kr.regexp_disjunction=function(D){for(this.regexp_alternative(D);D.eat(124);)this.regexp_alternative(D);this.regexp_eatQuantifier(D,!0)&&D.raise("Nothing to repeat"),D.eat(123)&&D.raise("Lone quantifier brackets")},Kr.regexp_alternative=function(D){for(;D.pos<D.source.length&&this.regexp_eatTerm(D););},Kr.regexp_eatTerm=function(D){return this.regexp_eatAssertion(D)?(D.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(D)&&D.switchU&&D.raise("Invalid quantifier"),!0):(D.switchU?this.regexp_eatAtom(D):this.regexp_eatExtendedAtom(D))?(this.regexp_eatQuantifier(D),!0):!1},Kr.regexp_eatAssertion=function(D){var X=D.pos;if(D.lastAssertionIsQuantifiable=!1,D.eat(94)||D.eat(36))return!0;if(D.eat(92)){if(D.eat(66)||D.eat(98))return!0;D.pos=X}if(D.eat(40)&&D.eat(63)){var Mt=!1;if(this.options.ecmaVersion>=9&&(Mt=D.eat(60)),D.eat(61)||D.eat(33))return this.regexp_disjunction(D),D.eat(41)||D.raise("Unterminated group"),D.lastAssertionIsQuantifiable=!Mt,!0}return D.pos=X,!1},Kr.regexp_eatQuantifier=function(D,X){return X===void 0&&(X=!1),this.regexp_eatQuantifierPrefix(D,X)?(D.eat(63),!0):!1},Kr.regexp_eatQuantifierPrefix=function(D,X){return D.eat(42)||D.eat(43)||D.eat(63)||this.regexp_eatBracedQuantifier(D,X)},Kr.regexp_eatBracedQuantifier=function(D,X){var Mt=D.pos;if(D.eat(123)){var it=0,Jt=-1;if(this.regexp_eatDecimalDigits(D)&&(it=D.lastIntValue,D.eat(44)&&this.regexp_eatDecimalDigits(D)&&(Jt=D.lastIntValue),D.eat(125)))return Jt!==-1&&Jt<it&&!X&&D.raise("numbers out of order in {} quantifier"),!0;D.switchU&&!X&&D.raise("Incomplete quantifier"),D.pos=Mt}return!1},Kr.regexp_eatAtom=function(D){return this.regexp_eatPatternCharacters(D)||D.eat(46)||this.regexp_eatReverseSolidusAtomEscape(D)||this.regexp_eatCharacterClass(D)||this.regexp_eatUncapturingGroup(D)||this.regexp_eatCapturingGroup(D)},Kr.regexp_eatReverseSolidusAtomEscape=function(D){var X=D.pos;if(D.eat(92)){if(this.regexp_eatAtomEscape(D))return!0;D.pos=X}return!1},Kr.regexp_eatUncapturingGroup=function(D){var X=D.pos;if(D.eat(40)){if(D.eat(63)&&D.eat(58)){if(this.regexp_disjunction(D),D.eat(41))return!0;D.raise("Unterminated group")}D.pos=X}return!1},Kr.regexp_eatCapturingGroup=function(D){if(D.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(D):D.current()===63&&D.raise("Invalid group"),this.regexp_disjunction(D),D.eat(41))return D.numCapturingParens+=1,!0;D.raise("Unterminated group")}return!1},Kr.regexp_eatExtendedAtom=function(D){return D.eat(46)||this.regexp_eatReverseSolidusAtomEscape(D)||this.regexp_eatCharacterClass(D)||this.regexp_eatUncapturingGroup(D)||this.regexp_eatCapturingGroup(D)||this.regexp_eatInvalidBracedQuantifier(D)||this.regexp_eatExtendedPatternCharacter(D)},Kr.regexp_eatInvalidBracedQuantifier=function(D){return this.regexp_eatBracedQuantifier(D,!0)&&D.raise("Nothing to repeat"),!1},Kr.regexp_eatSyntaxCharacter=function(D){var X=D.current();return xi(X)?(D.lastIntValue=X,D.advance(),!0):!1};function xi(D){return D===36||D>=40&&D<=43||D===46||D===63||D>=91&&D<=94||D>=123&&D<=125}Kr.regexp_eatPatternCharacters=function(D){for(var X=D.pos,Mt=0;(Mt=D.current())!==-1&&!xi(Mt);)D.advance();return D.pos!==X},Kr.regexp_eatExtendedPatternCharacter=function(D){var X=D.current();return X!==-1&&X!==36&&!(X>=40&&X<=43)&&X!==46&&X!==63&&X!==91&&X!==94&&X!==124?(D.advance(),!0):!1},Kr.regexp_groupSpecifier=function(D){if(D.eat(63)){if(this.regexp_eatGroupName(D)){D.groupNames.indexOf(D.lastStringValue)!==-1&&D.raise("Duplicate capture group name"),D.groupNames.push(D.lastStringValue);return}D.raise("Invalid group")}},Kr.regexp_eatGroupName=function(D){if(D.lastStringValue="",D.eat(60)){if(this.regexp_eatRegExpIdentifierName(D)&&D.eat(62))return!0;D.raise("Invalid capture group name")}return!1},Kr.regexp_eatRegExpIdentifierName=function(D){if(D.lastStringValue="",this.regexp_eatRegExpIdentifierStart(D)){for(D.lastStringValue+=Pn(D.lastIntValue);this.regexp_eatRegExpIdentifierPart(D);)D.lastStringValue+=Pn(D.lastIntValue);return!0}return!1},Kr.regexp_eatRegExpIdentifierStart=function(D){var X=D.pos,Mt=this.options.ecmaVersion>=11,it=D.current(Mt);return D.advance(Mt),it===92&&this.regexp_eatRegExpUnicodeEscapeSequence(D,Mt)&&(it=D.lastIntValue),Ci(it)?(D.lastIntValue=it,!0):(D.pos=X,!1)};function Ci(D){return zt(D,!0)||D===36||D===95}Kr.regexp_eatRegExpIdentifierPart=function(D){var X=D.pos,Mt=this.options.ecmaVersion>=11,it=D.current(Mt);return D.advance(Mt),it===92&&this.regexp_eatRegExpUnicodeEscapeSequence(D,Mt)&&(it=D.lastIntValue),Qr(it)?(D.lastIntValue=it,!0):(D.pos=X,!1)};function Qr(D){return P(D,!0)||D===36||D===95||D===8204||D===8205}Kr.regexp_eatAtomEscape=function(D){return this.regexp_eatBackReference(D)||this.regexp_eatCharacterClassEscape(D)||this.regexp_eatCharacterEscape(D)||D.switchN&&this.regexp_eatKGroupName(D)?!0:(D.switchU&&(D.current()===99&&D.raise("Invalid unicode escape"),D.raise("Invalid escape")),!1)},Kr.regexp_eatBackReference=function(D){var X=D.pos;if(this.regexp_eatDecimalEscape(D)){var Mt=D.lastIntValue;if(D.switchU)return Mt>D.maxBackReference&&(D.maxBackReference=Mt),!0;if(Mt<=D.numCapturingParens)return!0;D.pos=X}return!1},Kr.regexp_eatKGroupName=function(D){if(D.eat(107)){if(this.regexp_eatGroupName(D))return D.backReferenceNames.push(D.lastStringValue),!0;D.raise("Invalid named reference")}return!1},Kr.regexp_eatCharacterEscape=function(D){return this.regexp_eatControlEscape(D)||this.regexp_eatCControlLetter(D)||this.regexp_eatZero(D)||this.regexp_eatHexEscapeSequence(D)||this.regexp_eatRegExpUnicodeEscapeSequence(D,!1)||!D.switchU&&this.regexp_eatLegacyOctalEscapeSequence(D)||this.regexp_eatIdentityEscape(D)},Kr.regexp_eatCControlLetter=function(D){var X=D.pos;if(D.eat(99)){if(this.regexp_eatControlLetter(D))return!0;D.pos=X}return!1},Kr.regexp_eatZero=function(D){return D.current()===48&&!Ca(D.lookahead())?(D.lastIntValue=0,D.advance(),!0):!1},Kr.regexp_eatControlEscape=function(D){var X=D.current();return X===116?(D.lastIntValue=9,D.advance(),!0):X===110?(D.lastIntValue=10,D.advance(),!0):X===118?(D.lastIntValue=11,D.advance(),!0):X===102?(D.lastIntValue=12,D.advance(),!0):X===114?(D.lastIntValue=13,D.advance(),!0):!1},Kr.regexp_eatControlLetter=function(D){var X=D.current();return Kn(X)?(D.lastIntValue=X%32,D.advance(),!0):!1};function Kn(D){return D>=65&&D<=90||D>=97&&D<=122}Kr.regexp_eatRegExpUnicodeEscapeSequence=function(D,X){X===void 0&&(X=!1);var Mt=D.pos,it=X||D.switchU;if(D.eat(117)){if(this.regexp_eatFixedHexDigits(D,4)){var Jt=D.lastIntValue;if(it&&Jt>=55296&&Jt<=56319){var Ue=D.pos;if(D.eat(92)&&D.eat(117)&&this.regexp_eatFixedHexDigits(D,4)){var yr=D.lastIntValue;if(yr>=56320&&yr<=57343)return D.lastIntValue=(Jt-55296)*1024+(yr-56320)+65536,!0}D.pos=Ue,D.lastIntValue=Jt}return!0}if(it&&D.eat(123)&&this.regexp_eatHexDigits(D)&&D.eat(125)&&ai(D.lastIntValue))return!0;it&&D.raise("Invalid unicode escape"),D.pos=Mt}return!1};function ai(D){return D>=0&&D<=1114111}Kr.regexp_eatIdentityEscape=function(D){if(D.switchU)return this.regexp_eatSyntaxCharacter(D)?!0:D.eat(47)?(D.lastIntValue=47,!0):!1;var X=D.current();return X!==99&&(!D.switchN||X!==107)?(D.lastIntValue=X,D.advance(),!0):!1},Kr.regexp_eatDecimalEscape=function(D){D.lastIntValue=0;var X=D.current();if(X>=49&&X<=57){do D.lastIntValue=10*D.lastIntValue+(X-48),D.advance();while((X=D.current())>=48&&X<=57);return!0}return!1},Kr.regexp_eatCharacterClassEscape=function(D){var X=D.current();if(fi(X))return D.lastIntValue=-1,D.advance(),!0;if(D.switchU&&this.options.ecmaVersion>=9&&(X===80||X===112)){if(D.lastIntValue=-1,D.advance(),D.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(D)&&D.eat(125))return!0;D.raise("Invalid property name")}return!1};function fi(D){return D===100||D===68||D===115||D===83||D===119||D===87}Kr.regexp_eatUnicodePropertyValueExpression=function(D){var X=D.pos;if(this.regexp_eatUnicodePropertyName(D)&&D.eat(61)){var Mt=D.lastStringValue;if(this.regexp_eatUnicodePropertyValue(D)){var it=D.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(D,Mt,it),!0}}if(D.pos=X,this.regexp_eatLoneUnicodePropertyNameOrValue(D)){var Jt=D.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(D,Jt),!0}return!1},Kr.regexp_validateUnicodePropertyNameAndValue=function(D,X,Mt){te(D.unicodeProperties.nonBinary,X)||D.raise("Invalid property name"),D.unicodeProperties.nonBinary[X].test(Mt)||D.raise("Invalid property value")},Kr.regexp_validateUnicodePropertyNameOrValue=function(D,X){D.unicodeProperties.binary.test(X)||D.raise("Invalid property name")},Kr.regexp_eatUnicodePropertyName=function(D){var X=0;for(D.lastStringValue="";oa(X=D.current());)D.lastStringValue+=Pn(X),D.advance();return D.lastStringValue!==""};function oa(D){return Kn(D)||D===95}Kr.regexp_eatUnicodePropertyValue=function(D){var X=0;for(D.lastStringValue="";Ai(X=D.current());)D.lastStringValue+=Pn(X),D.advance();return D.lastStringValue!==""};function Ai(D){return oa(D)||Ca(D)}Kr.regexp_eatLoneUnicodePropertyNameOrValue=function(D){return this.regexp_eatUnicodePropertyValue(D)},Kr.regexp_eatCharacterClass=function(D){if(D.eat(91)){if(D.eat(94),this.regexp_classRanges(D),D.eat(93))return!0;D.raise("Unterminated character class")}return!1},Kr.regexp_classRanges=function(D){for(;this.regexp_eatClassAtom(D);){var X=D.lastIntValue;if(D.eat(45)&&this.regexp_eatClassAtom(D)){var Mt=D.lastIntValue;D.switchU&&(X===-1||Mt===-1)&&D.raise("Invalid character class"),X!==-1&&Mt!==-1&&X>Mt&&D.raise("Range out of order in character class")}}},Kr.regexp_eatClassAtom=function(D){var X=D.pos;if(D.eat(92)){if(this.regexp_eatClassEscape(D))return!0;if(D.switchU){var Mt=D.current();(Mt===99||Va(Mt))&&D.raise("Invalid class escape"),D.raise("Invalid escape")}D.pos=X}var it=D.current();return it!==93?(D.lastIntValue=it,D.advance(),!0):!1},Kr.regexp_eatClassEscape=function(D){var X=D.pos;if(D.eat(98))return D.lastIntValue=8,!0;if(D.switchU&&D.eat(45))return D.lastIntValue=45,!0;if(!D.switchU&&D.eat(99)){if(this.regexp_eatClassControlLetter(D))return!0;D.pos=X}return this.regexp_eatCharacterClassEscape(D)||this.regexp_eatCharacterEscape(D)},Kr.regexp_eatClassControlLetter=function(D){var X=D.current();return Ca(X)||X===95?(D.lastIntValue=X%32,D.advance(),!0):!1},Kr.regexp_eatHexEscapeSequence=function(D){var X=D.pos;if(D.eat(120)){if(this.regexp_eatFixedHexDigits(D,2))return!0;D.switchU&&D.raise("Invalid escape"),D.pos=X}return!1},Kr.regexp_eatDecimalDigits=function(D){var X=D.pos,Mt=0;for(D.lastIntValue=0;Ca(Mt=D.current());)D.lastIntValue=10*D.lastIntValue+(Mt-48),D.advance();return D.pos!==X};function Ca(D){return D>=48&&D<=57}Kr.regexp_eatHexDigits=function(D){var X=D.pos,Mt=0;for(D.lastIntValue=0;po(Mt=D.current());)D.lastIntValue=16*D.lastIntValue+La(Mt),D.advance();return D.pos!==X};function po(D){return D>=48&&D<=57||D>=65&&D<=70||D>=97&&D<=102}function La(D){return D>=65&&D<=70?10+(D-65):D>=97&&D<=102?10+(D-97):D-48}Kr.regexp_eatLegacyOctalEscapeSequence=function(D){if(this.regexp_eatOctalDigit(D)){var X=D.lastIntValue;if(this.regexp_eatOctalDigit(D)){var Mt=D.lastIntValue;X<=3&&this.regexp_eatOctalDigit(D)?D.lastIntValue=X*64+Mt*8+D.lastIntValue:D.lastIntValue=X*8+Mt}else D.lastIntValue=X;return!0}return!1},Kr.regexp_eatOctalDigit=function(D){var X=D.current();return Va(X)?(D.lastIntValue=X-48,D.advance(),!0):(D.lastIntValue=0,!1)};function Va(D){return D>=48&&D<=55}Kr.regexp_eatFixedHexDigits=function(D,X){var Mt=D.pos;D.lastIntValue=0;for(var it=0;it<X;++it){var Jt=D.current();if(!po(Jt))return D.pos=Mt,!1;D.lastIntValue=16*D.lastIntValue+La(Jt),D.advance()}return!0};var _a=function(X){this.type=X.type,this.value=X.value,this.start=X.start,this.end=X.end,X.options.locations&&(this.loc=new gt(X,X.startLoc,X.endLoc)),X.options.ranges&&(this.range=[X.start,X.end])},ma=Vt.prototype;ma.next=function(D){!D&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new _a(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},ma.getToken=function(){return this.next(),new _a(this)},typeof Symbol!="undefined"&&(ma[Symbol.iterator]=function(){var D=this;return{next:function(){var X=D.getToken();return{done:X.type===rt.eof,value:X}}}}),ma.curContext=function(){return this.context[this.context.length-1]},ma.nextToken=function(){var D=this.curContext();if((!D||!D.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(rt.eof);if(D.override)return D.override(this);this.readToken(this.fullCharCodeAtPos())},ma.readToken=function(D){return zt(D,this.options.ecmaVersion>=6)||D===92?this.readWord():this.getTokenFromCode(D)},ma.fullCharCodeAtPos=function(){var D=this.input.charCodeAt(this.pos);if(D<=55295||D>=57344)return D;var X=this.input.charCodeAt(this.pos+1);return(D<<10)+X-56613888},ma.skipBlockComment=function(){var D=this.options.onComment&&this.curPosition(),X=this.pos,Mt=this.input.indexOf("*/",this.pos+=2);if(Mt===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=Mt+2,this.options.locations){Se.lastIndex=X;for(var it;(it=Se.exec(this.input))&&it.index<this.pos;)++this.curLine,this.lineStart=it.index+it[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(X+2,Mt),X,this.pos,D,this.curPosition())},ma.skipLineComment=function(D){for(var X=this.pos,Mt=this.options.onComment&&this.curPosition(),it=this.input.charCodeAt(this.pos+=D);this.pos<this.input.length&&!_e(it);)it=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(X+D,this.pos),X,this.pos,Mt,this.curPosition())},ma.skipSpace=function(){t:for(;this.pos<this.input.length;){var D=this.input.charCodeAt(this.pos);switch(D){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(D>8&&D<14||D>=5760&&ve.test(String.fromCharCode(D)))++this.pos;else break t}}},ma.finishToken=function(D,X){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var Mt=this.type;this.type=D,this.value=X,this.updateContext(Mt)},ma.readToken_dot=function(){var D=this.input.charCodeAt(this.pos+1);if(D>=48&&D<=57)return this.readNumber(!0);var X=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&D===46&&X===46?(this.pos+=3,this.finishToken(rt.ellipsis)):(++this.pos,this.finishToken(rt.dot))},ma.readToken_slash=function(){var D=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):D===61?this.finishOp(rt.assign,2):this.finishOp(rt.slash,1)},ma.readToken_mult_modulo_exp=function(D){var X=this.input.charCodeAt(this.pos+1),Mt=1,it=D===42?rt.star:rt.modulo;return this.options.ecmaVersion>=7&&D===42&&X===42&&(++Mt,it=rt.starstar,X=this.input.charCodeAt(this.pos+2)),X===61?this.finishOp(rt.assign,Mt+1):this.finishOp(it,Mt)},ma.readToken_pipe_amp=function(D){var X=this.input.charCodeAt(this.pos+1);if(X===D){if(this.options.ecmaVersion>=12){var Mt=this.input.charCodeAt(this.pos+2);if(Mt===61)return this.finishOp(rt.assign,3)}return this.finishOp(D===124?rt.logicalOR:rt.logicalAND,2)}return X===61?this.finishOp(rt.assign,2):this.finishOp(D===124?rt.bitwiseOR:rt.bitwiseAND,1)},ma.readToken_caret=function(){var D=this.input.charCodeAt(this.pos+1);return D===61?this.finishOp(rt.assign,2):this.finishOp(rt.bitwiseXOR,1)},ma.readToken_plus_min=function(D){var X=this.input.charCodeAt(this.pos+1);return X===D?X===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Dt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(rt.incDec,2):X===61?this.finishOp(rt.assign,2):this.finishOp(rt.plusMin,1)},ma.readToken_lt_gt=function(D){var X=this.input.charCodeAt(this.pos+1),Mt=1;return X===D?(Mt=D===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+Mt)===61?this.finishOp(rt.assign,Mt+1):this.finishOp(rt.bitShift,Mt)):X===33&&D===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(X===61&&(Mt=2),this.finishOp(rt.relational,Mt))},ma.readToken_eq_excl=function(D){var X=this.input.charCodeAt(this.pos+1);return X===61?this.finishOp(rt.equality,this.input.charCodeAt(this.pos+2)===61?3:2):D===61&&X===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(rt.arrow)):this.finishOp(D===61?rt.eq:rt.prefix,1)},ma.readToken_question=function(){var D=this.options.ecmaVersion;if(D>=11){var X=this.input.charCodeAt(this.pos+1);if(X===46){var Mt=this.input.charCodeAt(this.pos+2);if(Mt<48||Mt>57)return this.finishOp(rt.questionDot,2)}if(X===63){if(D>=12){var it=this.input.charCodeAt(this.pos+2);if(it===61)return this.finishOp(rt.assign,3)}return this.finishOp(rt.coalesce,2)}}return this.finishOp(rt.question,1)},ma.getTokenFromCode=function(D){switch(D){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(rt.parenL);case 41:return++this.pos,this.finishToken(rt.parenR);case 59:return++this.pos,this.finishToken(rt.semi);case 44:return++this.pos,this.finishToken(rt.comma);case 91:return++this.pos,this.finishToken(rt.bracketL);case 93:return++this.pos,this.finishToken(rt.bracketR);case 123:return++this.pos,this.finishToken(rt.braceL);case 125:return++this.pos,this.finishToken(rt.braceR);case 58:return++this.pos,this.finishToken(rt.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(rt.backQuote);case 48:var X=this.input.charCodeAt(this.pos+1);if(X===120||X===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(X===111||X===79)return this.readRadixNumber(8);if(X===98||X===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(D);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(D);case 124:case 38:return this.readToken_pipe_amp(D);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(D);case 60:case 62:return this.readToken_lt_gt(D);case 61:case 33:return this.readToken_eq_excl(D);case 63:return this.readToken_question();case 126:return this.finishOp(rt.prefix,1)}this.raise(this.pos,"Unexpected character '"+vo(D)+"'")},ma.finishOp=function(D,X){var Mt=this.input.slice(this.pos,this.pos+X);return this.pos+=X,this.finishToken(D,Mt)},ma.readRegexp=function(){for(var D,X,Mt=this.pos;;){this.pos>=this.input.length&&this.raise(Mt,"Unterminated regular expression");var it=this.input.charAt(this.pos);if(Dt.test(it)&&this.raise(Mt,"Unterminated regular expression"),D)D=!1;else{if(it==="[")X=!0;else if(it==="]"&&X)X=!1;else if(it==="/"&&!X)break;D=it==="\\"}++this.pos}var Jt=this.input.slice(Mt,this.pos);++this.pos;var Ue=this.pos,yr=this.readWord1();this.containsEsc&&this.unexpected(Ue);var Br=this.regexpState||(this.regexpState=new an(this));Br.reset(Mt,Jt,yr),this.validateRegExpFlags(Br),this.validateRegExpPattern(Br);var zr=null;try{zr=new RegExp(Jt,yr)}catch(Cn){}return this.finishToken(rt.regexp,{pattern:Jt,flags:yr,value:zr})},ma.readInt=function(D,X,Mt){for(var it=this.options.ecmaVersion>=12&&X===void 0,Jt=Mt&&this.input.charCodeAt(this.pos)===48,Ue=this.pos,yr=0,Br=0,zr=0,Cn=X==null?1/0:X;zr<Cn;++zr,++this.pos){var Vn=this.input.charCodeAt(this.pos),Ki=void 0;if(it&&Vn===95){Jt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),Br===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),zr===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Br=Vn;continue}if(Vn>=97?Ki=Vn-97+10:Vn>=65?Ki=Vn-65+10:Vn>=48&&Vn<=57?Ki=Vn-48:Ki=1/0,Ki>=D)break;Br=Vn,yr=yr*D+Ki}return it&&Br===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ue||X!=null&&this.pos-Ue!==X?null:yr};function Qa(D,X){return X?parseInt(D,8):parseFloat(D.replace(/_/g,""))}function Uo(D){return typeof BigInt!="function"?null:BigInt(D.replace(/_/g,""))}ma.readRadixNumber=function(D){var X=this.pos;this.pos+=2;var Mt=this.readInt(D);return Mt==null&&this.raise(this.start+2,"Expected number in radix "+D),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(Mt=Uo(this.input.slice(X,this.pos)),++this.pos):zt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(rt.num,Mt)},ma.readNumber=function(D){var X=this.pos;!D&&this.readInt(10,void 0,!0)===null&&this.raise(X,"Invalid number");var Mt=this.pos-X>=2&&this.input.charCodeAt(X)===48;Mt&&this.strict&&this.raise(X,"Invalid number");var it=this.input.charCodeAt(this.pos);if(!Mt&&!D&&this.options.ecmaVersion>=11&&it===110){var Jt=Uo(this.input.slice(X,this.pos));return++this.pos,zt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(rt.num,Jt)}Mt&&/[89]/.test(this.input.slice(X,this.pos))&&(Mt=!1),it===46&&!Mt&&(++this.pos,this.readInt(10),it=this.input.charCodeAt(this.pos)),(it===69||it===101)&&!Mt&&(it=this.input.charCodeAt(++this.pos),(it===43||it===45)&&++this.pos,this.readInt(10)===null&&this.raise(X,"Invalid number")),zt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ue=Qa(this.input.slice(X,this.pos),Mt);return this.finishToken(rt.num,Ue)},ma.readCodePoint=function(){var D=this.input.charCodeAt(this.pos),X;if(D===123){this.options.ecmaVersion<6&&this.unexpected();var Mt=++this.pos;X=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,X>1114111&&this.invalidStringToken(Mt,"Code point out of bounds")}else X=this.readHexChar(4);return X};function vo(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}ma.readString=function(D){for(var X="",Mt=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var it=this.input.charCodeAt(this.pos);if(it===D)break;it===92?(X+=this.input.slice(Mt,this.pos),X+=this.readEscapedChar(!1),Mt=this.pos):(_e(it,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return X+=this.input.slice(Mt,this.pos++),this.finishToken(rt.string,X)};var Ua={};ma.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(D){if(D===Ua)this.readInvalidTemplateToken();else throw D}this.inTemplateElement=!1},ma.invalidStringToken=function(D,X){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ua;this.raise(D,X)},ma.readTmplToken=function(){for(var D="",X=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var Mt=this.input.charCodeAt(this.pos);if(Mt===96||Mt===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===rt.template||this.type===rt.invalidTemplate)?Mt===36?(this.pos+=2,this.finishToken(rt.dollarBraceL)):(++this.pos,this.finishToken(rt.backQuote)):(D+=this.input.slice(X,this.pos),this.finishToken(rt.template,D));if(Mt===92)D+=this.input.slice(X,this.pos),D+=this.readEscapedChar(!0),X=this.pos;else if(_e(Mt)){switch(D+=this.input.slice(X,this.pos),++this.pos,Mt){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:D+=`
`;break;default:D+=String.fromCharCode(Mt);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),X=this.pos}else++this.pos}},ma.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(rt.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},ma.readEscapedChar=function(D){var X=this.input.charCodeAt(++this.pos);switch(++this.pos,X){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return vo(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(D){var Mt=this.pos-1;return this.invalidStringToken(Mt,"Invalid escape sequence in template string"),null}default:if(X>=48&&X<=55){var it=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],Jt=parseInt(it,8);return Jt>255&&(it=it.slice(0,-1),Jt=parseInt(it,8)),this.pos+=it.length-1,X=this.input.charCodeAt(this.pos),(it!=="0"||X===56||X===57)&&(this.strict||D)&&this.invalidStringToken(this.pos-1-it.length,D?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(Jt)}return _e(X)?"":String.fromCharCode(X)}},ma.readHexChar=function(D){var X=this.pos,Mt=this.readInt(16,D);return Mt===null&&this.invalidStringToken(X,"Bad character escape sequence"),Mt},ma.readWord1=function(){this.containsEsc=!1;for(var D="",X=!0,Mt=this.pos,it=this.options.ecmaVersion>=6;this.pos<this.input.length;){var Jt=this.fullCharCodeAtPos();if(P(Jt,it))this.pos+=Jt<=65535?1:2;else if(Jt===92){this.containsEsc=!0,D+=this.input.slice(Mt,this.pos);var Ue=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var yr=this.readCodePoint();(X?zt:P)(yr,it)||this.invalidStringToken(Ue,"Invalid Unicode escape"),D+=vo(yr),Mt=this.pos}else break;X=!1}return D+this.input.slice(Mt,this.pos)},ma.readWord=function(){var D=this.readWord1(),X=rt.name;return this.keywords.test(D)&&(X=ke[D]),this.finishToken(X,D)};var Xa="7.4.1";Vt.acorn={Parser:Vt,version:Xa,defaultOptions:Oe,Position:Y,SourceLocation:gt,getLineInfo:he,Node:nn,TokenType:b,tokTypes:rt,keywordTypes:ke,TokContext:Hn,tokContexts:An,isIdentifierChar:P,isIdentifierStart:zt,Token:_a,isNewLine:_e,lineBreak:Dt,lineBreakG:Se,nonASCIIwhitespace:ve};function Oo(D,X){return Vt.parse(D,X)}function Du(D,X,Mt){return Vt.parseExpressionAt(D,X,Mt)}function Yo(D,X){return Vt.tokenizer(D,X)}function _o(D,X){D.prototype=Object.create(X.prototype),D.prototype.constructor=D,D.__proto__=X}function ir(D){var X=typeof Map=="function"?new Map:void 0;return ir=function(it){if(it===null||!Ir(it))return it;if(typeof it!="function")throw new TypeError("Super expression must either be null or a function");if(typeof X!="undefined"){if(X.has(it))return X.get(it);X.set(it,Jt)}function Jt(){return He(it,arguments,On(this).constructor)}return Jt.prototype=Object.create(it.prototype,{constructor:{value:Jt,enumerable:!1,writable:!0,configurable:!0}}),en(Jt,it)},ir(D)}function ge(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(D){return!1}}function He(D,X,Mt){return ge()?He=Reflect.construct:He=function(Jt,Ue,yr){var Br=[null];Br.push.apply(Br,Ue);var zr=Function.bind.apply(Jt,Br),Cn=new zr;return yr&&en(Cn,yr.prototype),Cn},He.apply(null,arguments)}function Ir(D){return Function.toString.call(D).indexOf("[native code]")!==-1}function en(D,X){return en=Object.setPrototypeOf||function(it,Jt){return it.__proto__=Jt,it},en(D,X)}function On(D){return On=Object.setPrototypeOf?Object.getPrototypeOf:function(Mt){return Mt.__proto__||Object.getPrototypeOf(Mt)},On(D)}var zn=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(ir(Error)),kn=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(ir(SyntaxError)),qi=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(ir(ReferenceError)),Oa=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(ir(TypeError)),us=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(zn),Ao=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(kn),Ho=function(D){_o(X,D);function X(){return D.apply(this,arguments)||this}return X}(qi),uo={UnknownError:[3001,"%0",us],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",us],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Ho],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Ho],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Ho],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Ho],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Ho],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Ho],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Ho],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Ho],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Ho],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Ho],FunctionUndefinedReferenceError:[2001,"%0 is not a function",qi],VariableUndefinedReferenceError:[2002,"%0 is not defined",qi],IsNotConstructor:[2003,"%0 is not a constructor",Oa]};function Zo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(D){return!1}}function Qs(D,X,Mt){return Zo()?Qs=Reflect.construct:Qs=function(Jt,Ue,yr){var Br=[null];Br.push.apply(Br,Ue);var zr=Function.bind.apply(Jt,Br),Cn=new zr;return yr&&jo(Cn,yr.prototype),Cn},Qs.apply(null,arguments)}function jo(D,X){return jo=Object.setPrototypeOf||function(it,Jt){return it.__proto__=Jt,it},jo(D,X)}var _l="0.0.3";function Hc(D,X){Object.defineProperty(D,"name",{value:X,writable:!1,enumerable:!1,configurable:!0})}var $u=Object.prototype.hasOwnProperty,Ae=Symbol("Break"),Xe=Symbol("Continue"),Cr=Symbol("DefaultCase"),sn=Symbol("EmptyStatementReturn"),si=Symbol("WithScopeName"),Pi=Symbol("SuperScopeName"),ja=Symbol("RootScopeName"),vs=Symbol("GlobalScopeName");function $o(D){return typeof D=="function"}var qo=function(){function D(Mt){this.interpreter=Mt}var X=D.prototype;return X.generator=function(){var it=this.interpreter;function Jt(){return this.getCurrentScope()}function Ue(){return this.getGlobalScope()}function yr(){return this.getCurrentContext()}return{getOptions:it.getOptions.bind(it),getCurrentScope:Jt.bind(it),getGlobalScope:Ue.bind(it),getCurrentContext:yr.bind(it),getExecStartTime:it.getExecStartTime.bind(it)}},D}();function Js(D,X,Mt){if(Mt===void 0&&(Mt=!0),!(D instanceof qo))throw new Error("Illegal call");if(typeof X!="string")return X;if(X){var it=D.generator(),Jt=it.getOptions(),Ue={timeout:Jt.timeout,_initEnv:function(){Mt||this.setCurrentContext(it.getCurrentContext()),this.execStartTime=it.getExecStartTime(),this.execEndTime=this.execStartTime}},yr=Mt?it.getGlobalScope():it.getCurrentScope(),Br=new Ts(yr,Ue);return Br.evaluate(X)}}Object.defineProperty(Js,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function qu(D){if(!(D instanceof qo))throw new Error("Illegal call");for(var X=D.generator(),Mt=arguments.length,it=new Array(Mt>1?Mt-1:0),Jt=1;Jt<Mt;Jt++)it[Jt-1]=arguments[Jt];var Ue=it.pop(),yr=new Ts(X.getGlobalScope(),X.getOptions()),Br=`
		    (function anonymous(`+it.join(",")+`){
		        `+Ue+`
		    });
		    `;return yr.evaluate(Br)}Object.defineProperty(qu,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var yu=function(X){this.value=X},Zs=function(X){this.value=X},_u=function(X){this.value=X},Ku=function(X,Mt,it){Mt===void 0&&(Mt=null),this.name=it,this.parent=Mt,this.data=X,this.labelStack=[]};function Bu(){}function xl(D,X){return D===void 0&&(D=null),new Ku(Object.create(null),D,X)}function Nu(D){return Object.create(D)}var Fo={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:Js,Function:qu};typeof JSON!="undefined"&&(Fo.JSON=JSON),typeof Promise!="undefined"&&(Fo.Promise=Promise),typeof Set!="undefined"&&(Fo.Set=Set),typeof Map!="undefined"&&(Fo.Map=Map),typeof Symbol!="undefined"&&(Fo.Symbol=Symbol),typeof Proxy!="undefined"&&(Fo.Proxy=Proxy),typeof WeakMap!="undefined"&&(Fo.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(Fo.WeakSet=WeakSet),typeof Reflect!="undefined"&&(Fo.Reflect=Reflect);var Ts=function(){function D(Mt,it){Mt===void 0&&(Mt=D.global),it===void 0&&(it={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:it.ecmaVersion||D.ecmaVersion,timeout:it.timeout||0,rootContext:it.rootContext,globalContextInFunction:it.globalContextInFunction===void 0?D.globalContextInFunction:it.globalContextInFunction,_initEnv:it._initEnv},this.context=Mt||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var X=D.prototype;return X.initEnvironment=function(it){var Jt;if(it instanceof Ku)Jt=it;else{var Ue=null,yr=this.createSuperScope(it);this.options.rootContext&&(Ue=new Ku(Nu(this.options.rootContext),yr,ja)),Jt=new Ku(it,Ue||yr,vs)}this.globalScope=Jt,this.currentScope=this.globalScope,this.globalContext=Jt.data,this.currentContext=Jt.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var Br=this.options._initEnv;Br&&Br.call(this)},X.getExecStartTime=function(){return this.execStartTime},X.getExecutionTime=function(){return this.execEndTime-this.execStartTime},X.setExecTimeout=function(it){it===void 0&&(it=0),this.options.timeout=it},X.getOptions=function(){return this.options},X.getGlobalScope=function(){return this.globalScope},X.getCurrentScope=function(){return this.currentScope},X.getCurrentContext=function(){return this.currentContext},X.isInterruptThrow=function(it){return it instanceof us||it instanceof Ho||it instanceof Ao},X.createSuperScope=function(it){var Jt=Object.assign({},Fo),Ue=Object.keys(Jt);return Ue.forEach(function(yr){yr in it&&delete Jt[yr]}),new Ku(Jt,null,Pi)},X.setCurrentContext=function(it){this.currentContext=it},X.setCurrentScope=function(it){this.currentScope=it},X.evaluate=function(it){it===void 0&&(it="");var Jt;if(it)return Jt=Oo(it,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||D.ecmaVersion}),this.evaluateNode(Jt,it)},X.appendCode=function(it){return this.evaluate(it)},X.evaluateNode=function(it,Jt){var Ue=this;Jt===void 0&&(Jt=""),this.value=void 0,this.source=Jt,this.sourceList.push(Jt),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var yr=this.getCurrentScope(),Br=this.getCurrentContext(),zr=yr.labelStack.concat([]),Cn=this.callStack.concat([]),Vn=function(){Ue.setCurrentScope(yr),Ue.setCurrentContext(Br),yr.labelStack=zr,Ue.callStack=Cn};try{var Ki=this.createClosure(it);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Ki()}catch(Ma){throw Ma}finally{Vn(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},X.createErrorMessage=function(it,Jt,Ue){var yr=it[1].replace("%0",String(Jt));return Ue!==null&&(yr+=this.getNodePosition(Ue||this.lastExecNode)),yr},X.createError=function(it,Jt){return new Jt(it)},X.createThrowError=function(it,Jt){return this.createError(it,Jt)},X.createInternalThrowError=function(it,Jt,Ue){return this.createError(this.createErrorMessage(it,Jt,Ue),it[2])},X.checkTimeout=function(){if(!this.isRunning)return!1;var it=this.options.timeout||0,Jt=Date.now();return Jt-this.execStartTime>it},X.getNodePosition=function(it){if(it){var Jt="";return it.loc?" ["+it.loc.start.line+":"+it.loc.start.column+"]"+Jt:""}return""},X.createClosure=function(it){var Jt=this,Ue;switch(it.type){case"BinaryExpression":Ue=this.binaryExpressionHandler(it);break;case"LogicalExpression":Ue=this.logicalExpressionHandler(it);break;case"UnaryExpression":Ue=this.unaryExpressionHandler(it);break;case"UpdateExpression":Ue=this.updateExpressionHandler(it);break;case"ObjectExpression":Ue=this.objectExpressionHandler(it);break;case"ArrayExpression":Ue=this.arrayExpressionHandler(it);break;case"CallExpression":Ue=this.callExpressionHandler(it);break;case"NewExpression":Ue=this.newExpressionHandler(it);break;case"MemberExpression":Ue=this.memberExpressionHandler(it);break;case"ThisExpression":Ue=this.thisExpressionHandler(it);break;case"SequenceExpression":Ue=this.sequenceExpressionHandler(it);break;case"Literal":Ue=this.literalHandler(it);break;case"Identifier":Ue=this.identifierHandler(it);break;case"AssignmentExpression":Ue=this.assignmentExpressionHandler(it);break;case"FunctionDeclaration":Ue=this.functionDeclarationHandler(it);break;case"VariableDeclaration":Ue=this.variableDeclarationHandler(it);break;case"BlockStatement":case"Program":Ue=this.programHandler(it);break;case"ExpressionStatement":Ue=this.expressionStatementHandler(it);break;case"EmptyStatement":Ue=this.emptyStatementHandler(it);break;case"ReturnStatement":Ue=this.returnStatementHandler(it);break;case"FunctionExpression":Ue=this.functionExpressionHandler(it);break;case"IfStatement":Ue=this.ifStatementHandler(it);break;case"ConditionalExpression":Ue=this.conditionalExpressionHandler(it);break;case"ForStatement":Ue=this.forStatementHandler(it);break;case"WhileStatement":Ue=this.whileStatementHandler(it);break;case"DoWhileStatement":Ue=this.doWhileStatementHandler(it);break;case"ForInStatement":Ue=this.forInStatementHandler(it);break;case"WithStatement":Ue=this.withStatementHandler(it);break;case"ThrowStatement":Ue=this.throwStatementHandler(it);break;case"TryStatement":Ue=this.tryStatementHandler(it);break;case"ContinueStatement":Ue=this.continueStatementHandler(it);break;case"BreakStatement":Ue=this.breakStatementHandler(it);break;case"SwitchStatement":Ue=this.switchStatementHandler(it);break;case"LabeledStatement":Ue=this.labeledStatementHandler(it);break;case"DebuggerStatement":Ue=this.debuggerStatementHandler(it);break;default:throw this.createInternalThrowError(uo.NodeTypeSyntaxError,it.type,it)}return function(){var yr=Jt.options.timeout;if(yr&&yr>0&&Jt.checkTimeout())throw Jt.createInternalThrowError(uo.ExecutionTimeOutError,yr,null);return Jt.lastExecNode=it,Ue.apply(void 0,arguments)}},X.binaryExpressionHandler=function(it){var Jt=this,Ue=this.createClosure(it.left),yr=this.createClosure(it.right);return function(){var Br=Ue(),zr=yr();switch(it.operator){case"==":return Br==zr;case"!=":return Br!=zr;case"===":return Br===zr;case"!==":return Br!==zr;case"<":return Br<zr;case"<=":return Br<=zr;case">":return Br>zr;case">=":return Br>=zr;case"<<":return Br<<zr;case">>":return Br>>zr;case">>>":return Br>>>zr;case"+":return Br+zr;case"-":return Br-zr;case"*":return Br*zr;case"**":return Math.pow(Br,zr);case"/":return Br/zr;case"%":return Br%zr;case"|":return Br|zr;case"^":return Br^zr;case"&":return Br&zr;case"in":return Br in zr;case"instanceof":return Br instanceof zr;default:throw Jt.createInternalThrowError(uo.BinaryOperatorSyntaxError,it.operator,it)}}},X.logicalExpressionHandler=function(it){var Jt=this,Ue=this.createClosure(it.left),yr=this.createClosure(it.right);return function(){switch(it.operator){case"||":return Ue()||yr();case"&&":return Ue()&&yr();default:throw Jt.createInternalThrowError(uo.LogicalOperatorSyntaxError,it.operator,it)}}},X.unaryExpressionHandler=function(it){var Jt=this;switch(it.operator){case"delete":var Ue=this.createObjectGetter(it.argument),yr=this.createNameGetter(it.argument);return function(){var Vn=Ue(),Ki=yr();return delete Vn[Ki]};default:var Br;if(it.operator==="typeof"&&it.argument.type==="Identifier"){var zr=this.createObjectGetter(it.argument),Cn=this.createNameGetter(it.argument);Br=function(){return zr()[Cn()]}}else Br=this.createClosure(it.argument);return function(){var Vn=Br();switch(it.operator){case"-":return-Vn;case"+":return+Vn;case"!":return!Vn;case"~":return~Vn;case"void":return;case"typeof":return typeof Vn;default:throw Jt.createInternalThrowError(uo.UnaryOperatorSyntaxError,it.operator,it)}}}},X.updateExpressionHandler=function(it){var Jt=this,Ue=this.createObjectGetter(it.argument),yr=this.createNameGetter(it.argument);return function(){var Br=Ue(),zr=yr();switch(Jt.assertVariable(Br,zr,it),it.operator){case"++":return it.prefix?++Br[zr]:Br[zr]++;case"--":return it.prefix?--Br[zr]:Br[zr]--;default:throw Jt.createInternalThrowError(uo.UpdateOperatorSyntaxError,it.operator,it)}}},X.objectExpressionHandler=function(it){var Jt=this,Ue=[];function yr(zr){return zr.type==="Identifier"?zr.name:zr.type==="Literal"?zr.value:this.throwError(uo.ObjectStructureSyntaxError,zr.type,zr)}var Br=Object.create(null);return it.properties.forEach(function(zr){var Cn=zr.kind,Vn=yr(zr.key);(!Br[Vn]||Cn==="init")&&(Br[Vn]={}),Br[Vn][Cn]=Jt.createClosure(zr.value),Ue.push({key:Vn,property:zr})}),function(){for(var zr={},Cn=Ue.length,Vn=0;Vn<Cn;Vn++){var Ki=Ue[Vn],Ma=Ki.key,xa=Br[Ma],lo=xa.init?xa.init():void 0,Ro=xa.get?xa.get():function(){},Io=xa.set?xa.set():function(Ic){};if("set"in xa||"get"in xa){var fa={configurable:!0,enumerable:!0,get:Ro,set:Io};Object.defineProperty(zr,Ma,fa)}else{var bu=Ki.property,bl=bu.kind;bu.key.type==="Identifier"&&bu.value.type==="FunctionExpression"&&bl==="init"&&!bu.value.id&&Hc(lo,bu.key.name),zr[Ma]=lo}}return zr}},X.arrayExpressionHandler=function(it){var Jt=this,Ue=it.elements.map(function(yr){return yr&&Jt.createClosure(yr)});return function(){for(var yr=Ue.length,Br=Array(yr),zr=0;zr<yr;zr++){var Cn=Ue[zr];Cn&&(Br[zr]=Cn())}return Br}},X.safeObjectGet=function(it,Jt,Ue){return it[Jt]},X.createCallFunctionGetter=function(it){var Jt=this;switch(it.type){case"MemberExpression":var Ue=this.createClosure(it.object),yr=this.createMemberKeyGetter(it),Br=this.source;return function(){var Cn=Ue(),Vn=yr(),Ki=Jt.safeObjectGet(Cn,Vn,it);if(!Ki||!$o(Ki)){var Ma=Br.slice(it.start,it.end);throw Jt.createInternalThrowError(uo.FunctionUndefinedReferenceError,Ma,it)}return Ki.__IS_EVAL_FUNC?function(xa){return Ki(new qo(Jt),xa,!0)}:Ki.__IS_FUNCTION_FUNC?function(){for(var xa=arguments.length,lo=new Array(xa),Ro=0;Ro<xa;Ro++)lo[Ro]=arguments[Ro];return Ki.apply(void 0,[new qo(Jt)].concat(lo))}:Ki.bind(Cn)};default:var zr=this.createClosure(it);return function(){var Cn="";it.type==="Identifier"&&(Cn=it.name);var Vn=zr();if(!Vn||!$o(Vn))throw Jt.createInternalThrowError(uo.FunctionUndefinedReferenceError,Cn,it);if(it.type==="Identifier"&&Vn.__IS_EVAL_FUNC&&Cn==="eval")return function(xa){var lo=Jt.getScopeFromName(Cn,Jt.getCurrentScope()),Ro=lo.name===Pi||lo.name===vs||lo.name===ja;return Vn(new qo(Jt),xa,!Ro)};if(Vn.__IS_EVAL_FUNC)return function(xa){return Vn(new qo(Jt),xa,!0)};if(Vn.__IS_FUNCTION_FUNC)return function(){for(var xa=arguments.length,lo=new Array(xa),Ro=0;Ro<xa;Ro++)lo[Ro]=arguments[Ro];return Vn.apply(void 0,[new qo(Jt)].concat(lo))};var Ki=Jt.options.globalContextInFunction;if(it.type==="Identifier"){var Ma=Jt.getIdentifierScope(it);Ma.name===si&&(Ki=Ma.data)}return Vn.bind(Ki)}}},X.callExpressionHandler=function(it){var Jt=this,Ue=this.createCallFunctionGetter(it.callee),yr=it.arguments.map(function(Br){return Jt.createClosure(Br)});return function(){return Ue().apply(void 0,yr.map(function(Br){return Br()}))}},X.functionExpressionHandler=function(it){var Jt=this,Ue=this,yr=this.source,Br=this.collectDeclVars,zr=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Cn=it.id?it.id.name:"",Vn=it.params.length,Ki=it.params.map(function(Ro){return Jt.createParamNameGetter(Ro)}),Ma=this.createClosure(it.body),xa=this.collectDeclVars,lo=this.collectDeclFuncs;return this.collectDeclVars=Br,this.collectDeclFuncs=zr,function(){var Ro=Ue.getCurrentScope(),Io=function fa(){for(var bu=arguments.length,bl=new Array(bu),Ic=0;Ic<bu;Ic++)bl[Ic]=arguments[Ic];Ue.callStack.push(""+Cn);var Yc=Ue.getCurrentScope(),Fl=xl(Ro,"FunctionScope("+Cn+")");Ue.setCurrentScope(Fl),Ue.addDeclarationsToScope(xa,lo,Fl),Cn&&(Fl.data[Cn]=fa),Fl.data.arguments=arguments,Ki.forEach(function(js,ce){Fl.data[js()]=bl[ce]});var kc=Ue.getCurrentContext();Ue.setCurrentContext(this);var Uu=Ma();if(Ue.setCurrentContext(kc),Ue.setCurrentScope(Yc),Ue.callStack.pop(),Uu instanceof yu)return Uu.value};return Hc(Io,Cn),Object.defineProperty(Io,"length",{value:Vn,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Io,"toString",{value:function(){return yr.slice(it.start,it.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Io,"valueOf",{value:function(){return yr.slice(it.start,it.end)},writable:!0,configurable:!0,enumerable:!1}),Io}},X.newExpressionHandler=function(it){var Jt=this,Ue=this.source,yr=this.createClosure(it.callee),Br=it.arguments.map(function(zr){return Jt.createClosure(zr)});return function(){var zr=yr();if(!$o(zr)||zr.__IS_EVAL_FUNC){var Cn=it.callee,Vn=Ue.slice(Cn.start,Cn.end);throw Jt.createInternalThrowError(uo.IsNotConstructor,Vn,it)}return zr.__IS_FUNCTION_FUNC?zr.apply(void 0,[new qo(Jt)].concat(Br.map(function(Ki){return Ki()}))):Qs(zr,Br.map(function(Ki){return Ki()}))}},X.memberExpressionHandler=function(it){var Jt=this.createClosure(it.object),Ue=this.createMemberKeyGetter(it);return function(){var yr=Jt(),Br=Ue();return yr[Br]}},X.thisExpressionHandler=function(it){var Jt=this;return function(){return Jt.getCurrentContext()}},X.sequenceExpressionHandler=function(it){var Jt=this,Ue=it.expressions.map(function(yr){return Jt.createClosure(yr)});return function(){for(var yr,Br=Ue.length,zr=0;zr<Br;zr++){var Cn=Ue[zr];yr=Cn()}return yr}},X.literalHandler=function(it){return function(){return it.regex?new RegExp(it.regex.pattern,it.regex.flags):it.value}},X.identifierHandler=function(it){var Jt=this;return function(){var Ue=Jt.getCurrentScope(),yr=Jt.getScopeDataFromName(it.name,Ue);return Jt.assertVariable(yr,it.name,it),yr[it.name]}},X.getIdentifierScope=function(it){var Jt=this.getCurrentScope(),Ue=this.getScopeFromName(it.name,Jt);return Ue},X.assignmentExpressionHandler=function(it){var Jt=this;it.left.type==="Identifier"&&it.right.type==="FunctionExpression"&&!it.right.id&&(it.right.id={type:"Identifier",name:it.left.name});var Ue=this.createObjectGetter(it.left),yr=this.createNameGetter(it.left),Br=this.createClosure(it.right);return function(){var zr=Ue(),Cn=yr(),Vn=Br();switch(it.operator!=="="&&Jt.assertVariable(zr,Cn,it),it.operator){case"=":return zr[Cn]=Vn;case"+=":return zr[Cn]+=Vn;case"-=":return zr[Cn]-=Vn;case"*=":return zr[Cn]*=Vn;case"**=":return zr[Cn]=Math.pow(zr[Cn],Vn);case"/=":return zr[Cn]/=Vn;case"%=":return zr[Cn]%=Vn;case"<<=":return zr[Cn]<<=Vn;case">>=":return zr[Cn]>>=Vn;case">>>=":return zr[Cn]>>>=Vn;case"&=":return zr[Cn]&=Vn;case"^=":return zr[Cn]^=Vn;case"|=":return zr[Cn]|=Vn;default:throw Jt.createInternalThrowError(uo.AssignmentExpressionSyntaxError,it.type,it)}}},X.functionDeclarationHandler=function(it){if(it.id){var Jt=this.functionExpressionHandler(it);Object.defineProperty(Jt,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(it.id.name,Jt)}return function(){return sn}},X.getVariableName=function(it){if(it.type==="Identifier")return it.name;throw this.createInternalThrowError(uo.VariableTypeSyntaxError,it.type,it)},X.variableDeclarationHandler=function(it){for(var Jt=this,Ue,yr=[],Br=0;Br<it.declarations.length;Br++){var zr=it.declarations[Br];this.varDeclaration(this.getVariableName(zr.id)),zr.init&&yr.push({type:"AssignmentExpression",operator:"=",left:zr.id,right:zr.init})}return yr.length&&(Ue=this.createClosure({type:"BlockStatement",body:yr})),function(){if(Ue){var Cn=Jt.isVarDeclMode;Jt.isVarDeclMode=!0,Ue(),Jt.isVarDeclMode=Cn}return sn}},X.assertVariable=function(it,Jt,Ue){if(it===this.globalScope.data&&!(Jt in it))throw this.createInternalThrowError(uo.VariableUndefinedReferenceError,Jt,Ue)},X.programHandler=function(it){var Jt=this,Ue=it.body.map(function(yr){return Jt.createClosure(yr)});return function(){for(var yr=sn,Br=0;Br<Ue.length;Br++){var zr=Ue[Br],Cn=Jt.setValue(zr());if(Cn!==sn&&(yr=Cn,yr instanceof yu||yr instanceof Zs||yr instanceof _u||yr===Ae||yr===Xe))break}return yr}},X.expressionStatementHandler=function(it){return this.createClosure(it.expression)},X.emptyStatementHandler=function(it){return function(){return sn}},X.returnStatementHandler=function(it){var Jt=it.argument?this.createClosure(it.argument):Bu;return function(){return new yu(Jt())}},X.ifStatementHandler=function(it){var Jt=this.createClosure(it.test),Ue=this.createClosure(it.consequent),yr=it.alternate?this.createClosure(it.alternate):function(){return sn};return function(){return Jt()?Ue():yr()}},X.conditionalExpressionHandler=function(it){return this.ifStatementHandler(it)},X.forStatementHandler=function(it){var Jt=this,Ue=Bu,yr=it.test?this.createClosure(it.test):function(){return!0},Br=Bu,zr=this.createClosure(it.body);return it.type==="ForStatement"&&(Ue=it.init?this.createClosure(it.init):Ue,Br=it.update?this.createClosure(it.update):Bu),function(Cn){var Vn,Ki=sn,Ma=it.type==="DoWhileStatement";for(Cn&&Cn.type==="LabeledStatement"&&(Vn=Cn.label.name),Ue();Ma||yr();Br()){Ma=!1;var xa=Jt.setValue(zr());if(!(xa===sn||xa===Xe)){if(xa===Ae)break;if(Ki=xa,Ki instanceof _u&&Ki.value===Vn){Ki=sn;continue}if(Ki instanceof yu||Ki instanceof Zs||Ki instanceof _u)break}}return Ki}},X.whileStatementHandler=function(it){return this.forStatementHandler(it)},X.doWhileStatementHandler=function(it){return this.forStatementHandler(it)},X.forInStatementHandler=function(it){var Jt=this,Ue=it.left,yr=this.createClosure(it.right),Br=this.createClosure(it.body);return it.left.type==="VariableDeclaration"&&(this.createClosure(it.left)(),Ue=it.left.declarations[0].id),function(zr){var Cn,Vn=sn,Ki;zr&&zr.type==="LabeledStatement"&&(Cn=zr.label.name);var Ma=yr();for(Ki in Ma){Jt.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Ue,right:{type:"Literal",value:Ki}})();var xa=Jt.setValue(Br());if(!(xa===sn||xa===Xe)){if(xa===Ae)break;if(Vn=xa,Vn instanceof _u&&Vn.value===Cn){Vn=sn;continue}if(Vn instanceof yu||Vn instanceof Zs||Vn instanceof _u)break}}return Vn}},X.withStatementHandler=function(it){var Jt=this,Ue=this.createClosure(it.object),yr=this.createClosure(it.body);return function(){var Br=Ue(),zr=Jt.getCurrentScope(),Cn=new Ku(Br,zr,si);Jt.setCurrentScope(Cn);var Vn=Jt.setValue(yr());return Jt.setCurrentScope(zr),Vn}},X.throwStatementHandler=function(it){var Jt=this,Ue=this.createClosure(it.argument);return function(){throw Jt.setValue(void 0),Ue()}},X.tryStatementHandler=function(it){var Jt=this,Ue=this.createClosure(it.block),yr=it.handler?this.catchClauseHandler(it.handler):null,Br=it.finalizer?this.createClosure(it.finalizer):null;return function(){var zr=Jt.getCurrentScope(),Cn=Jt.getCurrentContext(),Vn=zr.labelStack.concat([]),Ki=Jt.callStack.concat([]),Ma=sn,xa,lo,Ro=function(){Jt.setCurrentScope(zr),Jt.setCurrentContext(Cn),zr.labelStack=Vn,Jt.callStack=Ki};try{Ma=Jt.setValue(Ue()),Ma instanceof yu&&(xa=Ma)}catch(Io){if(Ro(),Jt.isInterruptThrow(Io))throw Io;if(yr)try{Ma=Jt.setValue(yr(Io)),Ma instanceof yu&&(xa=Ma)}catch(fa){if(Ro(),Jt.isInterruptThrow(fa))throw fa;lo=fa}}if(Br)try{Ma=Br(),Ma instanceof yu&&(xa=Ma)}catch(Io){if(Ro(),Jt.isInterruptThrow(Io))throw Io;lo=Io}if(lo)throw lo;return xa||Ma}},X.catchClauseHandler=function(it){var Jt=this,Ue=this.createParamNameGetter(it.param),yr=this.createClosure(it.body);return function(Br){var zr,Cn=Jt.getCurrentScope(),Vn=Cn.data,Ki=Ue(),Ma=$u.call(Vn,Ki),xa=Vn[Ki];return Vn[Ki]=Br,zr=yr(),Ma?Vn[Ki]=xa:delete Vn[Ki],zr}},X.continueStatementHandler=function(it){return function(){return it.label?new _u(it.label.name):Xe}},X.breakStatementHandler=function(it){return function(){return it.label?new Zs(it.label.name):Ae}},X.switchStatementHandler=function(it){var Jt=this,Ue=this.createClosure(it.discriminant),yr=it.cases.map(function(Br){return Jt.switchCaseHandler(Br)});return function(){for(var Br=Ue(),zr=!1,Cn,Vn,Ki,Ma=0;Ma<yr.length;Ma++){var xa=yr[Ma](),lo=xa.testClosure();if(lo===Cr){Ki=xa;continue}if(zr||lo===Br){if(zr=!0,Vn=Jt.setValue(xa.bodyClosure()),Vn===sn)continue;if(Vn===Ae||(Cn=Vn,Cn instanceof yu||Cn instanceof Zs||Cn instanceof _u||Cn===Xe))break}}if(!zr&&Ki){Vn=Jt.setValue(Ki.bodyClosure());var Ro=Vn===sn||Vn===Ae||Vn===Xe;Ro||(Cn=Vn)}return Cn}},X.switchCaseHandler=function(it){var Jt=it.test?this.createClosure(it.test):function(){return Cr},Ue=this.createClosure({type:"BlockStatement",body:it.consequent});return function(){return{testClosure:Jt,bodyClosure:Ue}}},X.labeledStatementHandler=function(it){var Jt=this,Ue=it.label.name,yr=this.createClosure(it.body);return function(){var Br,zr=Jt.getCurrentScope();return zr.labelStack.push(Ue),Br=yr(it),Br instanceof Zs&&Br.value===Ue&&(Br=sn),zr.labelStack.pop(),Br}},X.debuggerStatementHandler=function(it){return function(){debugger;return sn}},X.createParamNameGetter=function(it){if(it.type==="Identifier")return function(){return it.name};throw this.createInternalThrowError(uo.ParamTypeSyntaxError,it.type,it)},X.createObjectKeyGetter=function(it){var Jt;return it.type==="Identifier"?Jt=function(){return it.name}:Jt=this.createClosure(it),function(){return Jt()}},X.createMemberKeyGetter=function(it){return it.computed?this.createClosure(it.property):this.createObjectKeyGetter(it.property)},X.createObjectGetter=function(it){var Jt=this;switch(it.type){case"Identifier":return function(){return Jt.getScopeDataFromName(it.name,Jt.getCurrentScope())};case"MemberExpression":return this.createClosure(it.object);default:throw this.createInternalThrowError(uo.AssignmentTypeSyntaxError,it.type,it)}},X.createNameGetter=function(it){switch(it.type){case"Identifier":return function(){return it.name};case"MemberExpression":return this.createMemberKeyGetter(it);default:throw this.createInternalThrowError(uo.AssignmentTypeSyntaxError,it.type,it)}},X.varDeclaration=function(it){var Jt=this.collectDeclVars;Jt[it]=void 0},X.funcDeclaration=function(it,Jt){var Ue=this.collectDeclFuncs;Ue[it]=Jt},X.addDeclarationsToScope=function(it,Jt,Ue){var yr=Ue.data;for(var Br in Jt){var zr=Jt[Br];yr[Br]=zr&&zr()}for(var Cn in it)Cn in yr||(yr[Cn]=void 0)},X.getScopeValue=function(it,Jt){var Ue=this.getScopeFromName(it,Jt);return Ue.data[it]},X.getScopeDataFromName=function(it,Jt){return this.getScopeFromName(it,Jt).data},X.getScopeFromName=function(it,Jt){var Ue=Jt;do if(it in Ue.data)return Ue;while(Ue=Ue.parent);return this.globalScope},X.setValue=function(it){var Jt=this.callStack.length;return this.isVarDeclMode||Jt||it===sn||it===Ae||it===Xe||it instanceof Zs||it instanceof _u||(this.value=it instanceof yu?it.value:it),it},X.getValue=function(){return this.value},D}();Ts.version=_l,Ts.eval=Js,Ts.Function=qu,Ts.ecmaVersion=5,Ts.globalContextInFunction=void 0,Ts.global=Object.create(null);function jc(D){return D===void 0&&(D=Object.create(null)),D}function Wc(D,X,Mt){X===void 0&&(X=[]),Mt===void 0&&(Mt={});var it=Mt.parsingContext,Jt=Mt.timeout===void 0?0:Mt.timeout,Ue=`
    (function anonymous(`+X.join(",")+`){
         `+D+`
    });
    `,yr=new Ts(it,{ecmaVersion:Mt.ecmaVersion,timeout:Jt,rootContext:Mt.rootContext,globalContextInFunction:Mt.globalContextInFunction});return yr.evaluate(Ue)}function xu(D,X,Mt){var it=new Ts(X,Mt);return it.evaluate(D)}var Ms=xu,pl=function(){function D(Mt){this._code=Mt}var X=D.prototype;return X.runInContext=function(it){return xu(this._code,it)},X.runInNewContext=function(it){return xu(this._code,it)},D}(),Ga=function(D,X,Mt){return xu(D,X,Mt)};function zu(){for(var D=arguments.length,X=new Array(D),Mt=0;Mt<D;Mt++)X[Mt]=arguments[Mt];var it=X.pop();return Wc(it||"",X)}var Xc=Ga},86105:function(dn,Pt,nt){var kt;(function(mt,k,Et,K){"use strict";var yt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,J=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),pt=yt||J,et=["","webkit","Moz","MS","ms","o"],be=pt?"":k.createElement("div"),ot="function",ut=Math.round,zt=Math.abs,P=Date.now;function b(Ae,Xe,Cr){return setTimeout(Se(Ae,Cr),Xe)}function W(Ae,Xe,Cr){return Array.isArray(Ae)?(le(Ae,Cr[Xe],Cr),!0):!1}function le(Ae,Xe,Cr){var sn;if(Ae)if(Ae.forEach)Ae.forEach(Xe,Cr);else if(Ae.length!==K)for(sn=0;sn<Ae.length;)Xe.call(Cr,Ae[sn],sn,Ae),sn++;else for(sn in Ae)Ae.hasOwnProperty(sn)&&Xe.call(Cr,Ae[sn],sn,Ae)}function Ee(Ae,Xe,Cr){var sn="DEPRECATED METHOD: "+Xe+`
`+Cr+` AT 
`;return function(){var si=new Error("get-stack-trace"),Pi=si&&si.stack?si.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ja=mt.console&&(mt.console.warn||mt.console.log);return ja&&ja.call(mt.console,sn,Pi),Ae.apply(this,arguments)}}var ke;typeof Object.assign!="function"?ke=function(Xe){if(Xe===K||Xe===null)throw new TypeError("Cannot convert undefined or null to object");for(var Cr=Object(Xe),sn=1;sn<arguments.length;sn++){var si=arguments[sn];if(si!==K&&si!==null)for(var Pi in si)si.hasOwnProperty(Pi)&&(Cr[Pi]=si[Pi])}return Cr}:ke=Object.assign;var Tt=Ee(function(Xe,Cr,sn){for(var si=Object.keys(Cr),Pi=0;Pi<si.length;)(!sn||sn&&Xe[si[Pi]]===K)&&(Xe[si[Pi]]=Cr[si[Pi]]),Pi++;return Xe},"extend","Use `assign`."),rt=Ee(function(Xe,Cr){return Tt(Xe,Cr,!0)},"merge","Use `assign`.");function Dt(Ae,Xe,Cr){var sn=Xe.prototype,si;si=Ae.prototype=Object.create(sn),si.constructor=Ae,si._super=sn,Cr&&ke(si,Cr)}function Se(Ae,Xe){return function(){return Ae.apply(Xe,arguments)}}function _e(Ae,Xe){return typeof Ae==ot?Ae.apply(Xe&&Xe[0]||K,Xe):Ae}function ve(Ae,Xe){return Ae===K?Xe:Ae}function ne(Ae,Xe,Cr){le(te(Xe),function(sn){Ae.addEventListener(sn,Cr,!1)})}function xe(Ae,Xe,Cr){le(te(Xe),function(sn){Ae.removeEventListener(sn,Cr,!1)})}function Je(Ae,Xe){for(;Ae;){if(Ae==Xe)return!0;Ae=Ae.parentNode}return!1}function Ot(Ae,Xe){return Ae.indexOf(Xe)>-1}function te(Ae){return Ae.trim().split(/\s+/g)}function ft(Ae,Xe,Cr){if(Ae.indexOf&&!Cr)return Ae.indexOf(Xe);for(var sn=0;sn<Ae.length;){if(Cr&&Ae[sn][Cr]==Xe||!Cr&&Ae[sn]===Xe)return sn;sn++}return-1}function wt(Ae){return Array.prototype.slice.call(Ae,0)}function Y(Ae,Xe,Cr){for(var sn=[],si=[],Pi=0;Pi<Ae.length;){var ja=Xe?Ae[Pi][Xe]:Ae[Pi];ft(si,ja)<0&&sn.push(Ae[Pi]),si[Pi]=ja,Pi++}return Cr&&(Xe?sn=sn.sort(function($o,qo){return $o[Xe]>qo[Xe]}):sn=sn.sort()),sn}function gt(Ae,Xe){for(var Cr,sn,si=Xe[0].toUpperCase()+Xe.slice(1),Pi=0;Pi<et.length;){if(Cr=et[Pi],sn=Cr?Cr+si:Xe,sn in Ae)return sn;Pi++}return K}var he=1;function Oe(){return he++}function Le(Ae){var Xe=Ae.ownerDocument||Ae;return Xe.defaultView||Xe.parentWindow||mt}var Ve=/mobile|tablet|ip(ad|hone|od)|android/i,Bt="ontouchstart"in mt,re=gt(mt,"PointerEvent")!==K,ye=Bt&&Ve.test(navigator.userAgent),Yt="touch",qe="pen",vr="mouse",oe="kinect",qt=25,bt=1,Wt=2,$t=4,xt=8,St=1,ue=2,Pe=4,ze=8,Vt=16,Ct=ue|Pe,At=ze|Vt,Nt=Ct|At,tt=["x","y"],vt=["clientX","clientY"];function Ht(Ae,Xe){var Cr=this;this.manager=Ae,this.callback=Xe,this.element=Ae.element,this.target=Ae.options.inputTarget,this.domHandler=function(sn){_e(Ae.options.enable,[Ae])&&Cr.handler(sn)},this.init()}Ht.prototype={handler:function(){},init:function(){this.evEl&&ne(this.element,this.evEl,this.domHandler),this.evTarget&&ne(this.target,this.evTarget,this.domHandler),this.evWin&&ne(Le(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&xe(this.element,this.evEl,this.domHandler),this.evTarget&&xe(this.target,this.evTarget,this.domHandler),this.evWin&&xe(Le(this.element),this.evWin,this.domHandler)}};function de(Ae){var Xe,Cr=Ae.options.inputClass;return Cr?Xe=Cr:re?Xe=Ge:ye?Xe=an:Bt?Xe=Qr:Xe=$n,new Xe(Ae,jt)}function jt(Ae,Xe,Cr){var sn=Cr.pointers.length,si=Cr.changedPointers.length,Pi=Xe&bt&&sn-si===0,ja=Xe&($t|xt)&&sn-si===0;Cr.isFirst=!!Pi,Cr.isFinal=!!ja,Pi&&(Ae.session={}),Cr.eventType=Xe,Ie(Ae,Cr),Ae.emit("hammer.input",Cr),Ae.recognize(Cr),Ae.session.prevInput=Cr}function Ie(Ae,Xe){var Cr=Ae.session,sn=Xe.pointers,si=sn.length;Cr.firstInput||(Cr.firstInput=pr(Xe)),si>1&&!Cr.firstMultiple?Cr.firstMultiple=pr(Xe):si===1&&(Cr.firstMultiple=!1);var Pi=Cr.firstInput,ja=Cr.firstMultiple,vs=ja?ja.center:Pi.center,$o=Xe.center=lr(sn);Xe.timeStamp=P(),Xe.deltaTime=Xe.timeStamp-Pi.timeStamp,Xe.angle=Sn(vs,$o),Xe.distance=Gr(vs,$o),We(Cr,Xe),Xe.offsetDirection=Pr(Xe.deltaX,Xe.deltaY);var qo=Nr(Xe.deltaTime,Xe.deltaX,Xe.deltaY);Xe.overallVelocityX=qo.x,Xe.overallVelocityY=qo.y,Xe.overallVelocity=zt(qo.x)>zt(qo.y)?qo.x:qo.y,Xe.scale=ja?Nn(ja.pointers,sn):1,Xe.rotation=ja?nn(ja.pointers,sn):0,Xe.maxPointers=Cr.prevInput?Xe.pointers.length>Cr.prevInput.maxPointers?Xe.pointers.length:Cr.prevInput.maxPointers:Xe.pointers.length,Ke(Cr,Xe);var Js=Ae.element;Je(Xe.srcEvent.target,Js)&&(Js=Xe.srcEvent.target),Xe.target=Js}function We(Ae,Xe){var Cr=Xe.center,sn=Ae.offsetDelta||{},si=Ae.prevDelta||{},Pi=Ae.prevInput||{};(Xe.eventType===bt||Pi.eventType===$t)&&(si=Ae.prevDelta={x:Pi.deltaX||0,y:Pi.deltaY||0},sn=Ae.offsetDelta={x:Cr.x,y:Cr.y}),Xe.deltaX=si.x+(Cr.x-sn.x),Xe.deltaY=si.y+(Cr.y-sn.y)}function Ke(Ae,Xe){var Cr=Ae.lastInterval||Xe,sn=Xe.timeStamp-Cr.timeStamp,si,Pi,ja,vs;if(Xe.eventType!=xt&&(sn>qt||Cr.velocity===K)){var $o=Xe.deltaX-Cr.deltaX,qo=Xe.deltaY-Cr.deltaY,Js=Nr(sn,$o,qo);Pi=Js.x,ja=Js.y,si=zt(Js.x)>zt(Js.y)?Js.x:Js.y,vs=Pr($o,qo),Ae.lastInterval=Xe}else si=Cr.velocity,Pi=Cr.velocityX,ja=Cr.velocityY,vs=Cr.direction;Xe.velocity=si,Xe.velocityX=Pi,Xe.velocityY=ja,Xe.direction=vs}function pr(Ae){for(var Xe=[],Cr=0;Cr<Ae.pointers.length;)Xe[Cr]={clientX:ut(Ae.pointers[Cr].clientX),clientY:ut(Ae.pointers[Cr].clientY)},Cr++;return{timeStamp:P(),pointers:Xe,center:lr(Xe),deltaX:Ae.deltaX,deltaY:Ae.deltaY}}function lr(Ae){var Xe=Ae.length;if(Xe===1)return{x:ut(Ae[0].clientX),y:ut(Ae[0].clientY)};for(var Cr=0,sn=0,si=0;si<Xe;)Cr+=Ae[si].clientX,sn+=Ae[si].clientY,si++;return{x:ut(Cr/Xe),y:ut(sn/Xe)}}function Nr(Ae,Xe,Cr){return{x:Xe/Ae||0,y:Cr/Ae||0}}function Pr(Ae,Xe){return Ae===Xe?St:zt(Ae)>=zt(Xe)?Ae<0?ue:Pe:Xe<0?ze:Vt}function Gr(Ae,Xe,Cr){Cr||(Cr=tt);var sn=Xe[Cr[0]]-Ae[Cr[0]],si=Xe[Cr[1]]-Ae[Cr[1]];return Math.sqrt(sn*sn+si*si)}function Sn(Ae,Xe,Cr){Cr||(Cr=tt);var sn=Xe[Cr[0]]-Ae[Cr[0]],si=Xe[Cr[1]]-Ae[Cr[1]];return Math.atan2(si,sn)*180/Math.PI}function nn(Ae,Xe){return Sn(Xe[1],Xe[0],vt)+Sn(Ae[1],Ae[0],vt)}function Nn(Ae,Xe){return Gr(Xe[0],Xe[1],vt)/Gr(Ae[0],Ae[1],vt)}var Zn={mousedown:bt,mousemove:Wt,mouseup:$t},Hn="mousedown",An="mousemove mouseup";function $n(){this.evEl=Hn,this.evWin=An,this.pressed=!1,Ht.apply(this,arguments)}Dt($n,Ht,{handler:function(Xe){var Cr=Zn[Xe.type];Cr&bt&&Xe.button===0&&(this.pressed=!0),Cr&Wt&&Xe.which!==1&&(Cr=$t),this.pressed&&(Cr&$t&&(this.pressed=!1),this.callback(this.manager,Cr,{pointers:[Xe],changedPointers:[Xe],pointerType:vr,srcEvent:Xe}))}});var Rt={pointerdown:bt,pointermove:Wt,pointerup:$t,pointercancel:xt,pointerout:xt},Xt={2:Yt,3:qe,4:vr,5:oe},ae="pointerdown",we="pointermove pointerup pointercancel";!pt&&mt.MSPointerEvent&&!mt.PointerEvent&&(ae="MSPointerDown",we="MSPointerMove MSPointerUp MSPointerCancel");function Ge(){this.evEl=ae,this.evWin=we,Ht.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Dt(Ge,Ht,{handler:function(Xe){var Cr=this.store,sn=!1,si=Xe.type.toLowerCase().replace("ms",""),Pi=Rt[si],ja=Xt[Xe.pointerType]||Xe.pointerType,vs=ja==Yt,$o=ft(Cr,Xe.pointerId,"pointerId");Pi&bt&&(Xe.button===0||vs)?$o<0&&(Cr.push(Xe),$o=Cr.length-1):Pi&($t|xt)&&(sn=!0),!($o<0)&&(Cr[$o]=Xe,this.callback(this.manager,Pi,{pointers:Cr,changedPointers:[Xe],pointerType:ja,srcEvent:Xe}),sn&&Cr.splice($o,1))}});var cr={touchstart:bt,touchmove:Wt,touchend:$t,touchcancel:xt},br="touchstart",Ce="touchstart touchmove touchend touchcancel";function ar(){this.evTarget=br,this.evWin=Ce,this.started=!1,Ht.apply(this,arguments)}Dt(ar,Ht,{handler:function(Xe){var Cr=cr[Xe.type];if(Cr===bt&&(this.started=!0),!!this.started){var sn=Hr.call(this,Xe,Cr);Cr&($t|xt)&&sn[0].length-sn[1].length===0&&(this.started=!1),this.callback(this.manager,Cr,{pointers:sn[0],changedPointers:sn[1],pointerType:Yt,srcEvent:Xe})}}});function Hr(Ae,Xe){var Cr=wt(Ae.touches),sn=wt(Ae.changedTouches);return Xe&($t|xt)&&(Cr=Y(Cr.concat(sn),"identifier",!0)),[Cr,sn]}var Tn={touchstart:bt,touchmove:Wt,touchend:$t,touchcancel:xt},Kr="touchstart touchmove touchend touchcancel";function an(){this.evTarget=Kr,this.targetIds={},Ht.apply(this,arguments)}Dt(an,Ht,{handler:function(Xe){var Cr=Tn[Xe.type],sn=Pn.call(this,Xe,Cr);sn&&this.callback(this.manager,Cr,{pointers:sn[0],changedPointers:sn[1],pointerType:Yt,srcEvent:Xe})}});function Pn(Ae,Xe){var Cr=wt(Ae.touches),sn=this.targetIds;if(Xe&(bt|Wt)&&Cr.length===1)return sn[Cr[0].identifier]=!0,[Cr,Cr];var si,Pi,ja=wt(Ae.changedTouches),vs=[],$o=this.target;if(Pi=Cr.filter(function(qo){return Je(qo.target,$o)}),Xe===bt)for(si=0;si<Pi.length;)sn[Pi[si].identifier]=!0,si++;for(si=0;si<ja.length;)sn[ja[si].identifier]&&vs.push(ja[si]),Xe&($t|xt)&&delete sn[ja[si].identifier],si++;if(vs.length)return[Y(Pi.concat(vs),"identifier",!0),vs]}var xi=2500,Ci=25;function Qr(){Ht.apply(this,arguments);var Ae=Se(this.handler,this);this.touch=new an(this.manager,Ae),this.mouse=new $n(this.manager,Ae),this.primaryTouch=null,this.lastTouches=[]}Dt(Qr,Ht,{handler:function(Xe,Cr,sn){var si=sn.pointerType==Yt,Pi=sn.pointerType==vr;if(!(Pi&&sn.sourceCapabilities&&sn.sourceCapabilities.firesTouchEvents)){if(si)Kn.call(this,Cr,sn);else if(Pi&&fi.call(this,sn))return;this.callback(Xe,Cr,sn)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Kn(Ae,Xe){Ae&bt?(this.primaryTouch=Xe.changedPointers[0].identifier,ai.call(this,Xe)):Ae&($t|xt)&&ai.call(this,Xe)}function ai(Ae){var Xe=Ae.changedPointers[0];if(Xe.identifier===this.primaryTouch){var Cr={x:Xe.clientX,y:Xe.clientY};this.lastTouches.push(Cr);var sn=this.lastTouches,si=function(){var Pi=sn.indexOf(Cr);Pi>-1&&sn.splice(Pi,1)};setTimeout(si,xi)}}function fi(Ae){for(var Xe=Ae.srcEvent.clientX,Cr=Ae.srcEvent.clientY,sn=0;sn<this.lastTouches.length;sn++){var si=this.lastTouches[sn],Pi=Math.abs(Xe-si.x),ja=Math.abs(Cr-si.y);if(Pi<=Ci&&ja<=Ci)return!0}return!1}var oa=pt?K:gt(be.style,"touchAction"),Ai=oa!==K,Ca="compute",po="auto",La="manipulation",Va="none",_a="pan-x",ma="pan-y",Qa=Ua();function Uo(Ae,Xe){this.manager=Ae,this.set(Xe)}Uo.prototype={set:function(Ae){Ae==Ca&&(Ae=this.compute()),Ai&&this.manager.element.style&&Qa[Ae]&&(this.manager.element.style[oa]=Ae),this.actions=Ae.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ae=[];return le(this.manager.recognizers,function(Xe){_e(Xe.options.enable,[Xe])&&(Ae=Ae.concat(Xe.getTouchAction()))}),vo(Ae.join(" "))},preventDefaults:function(Ae){var Xe=Ae.srcEvent,Cr=Ae.offsetDirection;if(this.manager.session.prevented){Xe.preventDefault();return}var sn=this.actions,si=Ot(sn,Va)&&!Qa[Va],Pi=Ot(sn,ma)&&!Qa[ma],ja=Ot(sn,_a)&&!Qa[_a];if(si){var vs=Ae.pointers.length===1,$o=Ae.distance<2,qo=Ae.deltaTime<250;if(vs&&$o&&qo)return}if(!(ja&&Pi)&&(si||Pi&&Cr&Ct||ja&&Cr&At))return this.preventSrc(Xe)},preventSrc:function(Ae){this.manager.session.prevented=!0,Ae.preventDefault()}};function vo(Ae){if(Ot(Ae,Va))return Va;var Xe=Ot(Ae,_a),Cr=Ot(Ae,ma);return Xe&&Cr?Va:Xe||Cr?Xe?_a:ma:Ot(Ae,La)?La:po}function Ua(){if(!Ai)return!1;var Ae={};if(pt)return Ae;var Xe=mt.CSS&&mt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Cr){Ae[Cr]=Xe?mt.CSS.supports("touch-action",Cr):!0}),Ae}var Xa=1,Oo=2,Du=4,Yo=8,_o=Yo,ir=16,ge=32;function He(Ae){this.options=ke({},this.defaults,Ae||{}),this.id=Oe(),this.manager=null,this.options.enable=ve(this.options.enable,!0),this.state=Xa,this.simultaneous={},this.requireFail=[]}He.prototype={defaults:{},set:function(Ae){return ke(this.options,Ae),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ae){if(W(Ae,"recognizeWith",this))return this;var Xe=this.simultaneous;return Ae=On(Ae,this),Xe[Ae.id]||(Xe[Ae.id]=Ae,Ae.recognizeWith(this)),this},dropRecognizeWith:function(Ae){return W(Ae,"dropRecognizeWith",this)?this:(Ae=On(Ae,this),delete this.simultaneous[Ae.id],this)},requireFailure:function(Ae){if(W(Ae,"requireFailure",this))return this;var Xe=this.requireFail;return Ae=On(Ae,this),ft(Xe,Ae)===-1&&(Xe.push(Ae),Ae.requireFailure(this)),this},dropRequireFailure:function(Ae){if(W(Ae,"dropRequireFailure",this))return this;Ae=On(Ae,this);var Xe=ft(this.requireFail,Ae);return Xe>-1&&this.requireFail.splice(Xe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ae){return!!this.simultaneous[Ae.id]},emit:function(Ae){var Xe=this,Cr=this.state;function sn(si){Xe.manager.emit(si,Ae)}Cr<Yo&&sn(Xe.options.event+Ir(Cr)),sn(Xe.options.event),Ae.additionalEvent&&sn(Ae.additionalEvent),Cr>=Yo&&sn(Xe.options.event+Ir(Cr))},tryEmit:function(Ae){if(this.canEmit())return this.emit(Ae);this.state=ge},canEmit:function(){for(var Ae=0;Ae<this.requireFail.length;){if(!(this.requireFail[Ae].state&(ge|Xa)))return!1;Ae++}return!0},recognize:function(Ae){var Xe=ke({},Ae);if(!_e(this.options.enable,[this,Xe])){this.reset(),this.state=ge;return}this.state&(_o|ir|ge)&&(this.state=Xa),this.state=this.process(Xe),this.state&(Oo|Du|Yo|ir)&&this.tryEmit(Xe)},process:function(Ae){},getTouchAction:function(){},reset:function(){}};function Ir(Ae){return Ae&ir?"cancel":Ae&Yo?"end":Ae&Du?"move":Ae&Oo?"start":""}function en(Ae){return Ae==Vt?"down":Ae==ze?"up":Ae==ue?"left":Ae==Pe?"right":""}function On(Ae,Xe){var Cr=Xe.manager;return Cr?Cr.get(Ae):Ae}function zn(){He.apply(this,arguments)}Dt(zn,He,{defaults:{pointers:1},attrTest:function(Ae){var Xe=this.options.pointers;return Xe===0||Ae.pointers.length===Xe},process:function(Ae){var Xe=this.state,Cr=Ae.eventType,sn=Xe&(Oo|Du),si=this.attrTest(Ae);return sn&&(Cr&xt||!si)?Xe|ir:sn||si?Cr&$t?Xe|Yo:Xe&Oo?Xe|Du:Oo:ge}});function kn(){zn.apply(this,arguments),this.pX=null,this.pY=null}Dt(kn,zn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Nt},getTouchAction:function(){var Ae=this.options.direction,Xe=[];return Ae&Ct&&Xe.push(ma),Ae&At&&Xe.push(_a),Xe},directionTest:function(Ae){var Xe=this.options,Cr=!0,sn=Ae.distance,si=Ae.direction,Pi=Ae.deltaX,ja=Ae.deltaY;return si&Xe.direction||(Xe.direction&Ct?(si=Pi===0?St:Pi<0?ue:Pe,Cr=Pi!=this.pX,sn=Math.abs(Ae.deltaX)):(si=ja===0?St:ja<0?ze:Vt,Cr=ja!=this.pY,sn=Math.abs(Ae.deltaY))),Ae.direction=si,Cr&&sn>Xe.threshold&&si&Xe.direction},attrTest:function(Ae){return zn.prototype.attrTest.call(this,Ae)&&(this.state&Oo||!(this.state&Oo)&&this.directionTest(Ae))},emit:function(Ae){this.pX=Ae.deltaX,this.pY=Ae.deltaY;var Xe=en(Ae.direction);Xe&&(Ae.additionalEvent=this.options.event+Xe),this._super.emit.call(this,Ae)}});function qi(){zn.apply(this,arguments)}Dt(qi,zn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Va]},attrTest:function(Ae){return this._super.attrTest.call(this,Ae)&&(Math.abs(Ae.scale-1)>this.options.threshold||this.state&Oo)},emit:function(Ae){if(Ae.scale!==1){var Xe=Ae.scale<1?"in":"out";Ae.additionalEvent=this.options.event+Xe}this._super.emit.call(this,Ae)}});function Oa(){He.apply(this,arguments),this._timer=null,this._input=null}Dt(Oa,He,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[po]},process:function(Ae){var Xe=this.options,Cr=Ae.pointers.length===Xe.pointers,sn=Ae.distance<Xe.threshold,si=Ae.deltaTime>Xe.time;if(this._input=Ae,!sn||!Cr||Ae.eventType&($t|xt)&&!si)this.reset();else if(Ae.eventType&bt)this.reset(),this._timer=b(function(){this.state=_o,this.tryEmit()},Xe.time,this);else if(Ae.eventType&$t)return _o;return ge},reset:function(){clearTimeout(this._timer)},emit:function(Ae){this.state===_o&&(Ae&&Ae.eventType&$t?this.manager.emit(this.options.event+"up",Ae):(this._input.timeStamp=P(),this.manager.emit(this.options.event,this._input)))}});function us(){zn.apply(this,arguments)}Dt(us,zn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Va]},attrTest:function(Ae){return this._super.attrTest.call(this,Ae)&&(Math.abs(Ae.rotation)>this.options.threshold||this.state&Oo)}});function Ao(){zn.apply(this,arguments)}Dt(Ao,zn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ct|At,pointers:1},getTouchAction:function(){return kn.prototype.getTouchAction.call(this)},attrTest:function(Ae){var Xe=this.options.direction,Cr;return Xe&(Ct|At)?Cr=Ae.overallVelocity:Xe&Ct?Cr=Ae.overallVelocityX:Xe&At&&(Cr=Ae.overallVelocityY),this._super.attrTest.call(this,Ae)&&Xe&Ae.offsetDirection&&Ae.distance>this.options.threshold&&Ae.maxPointers==this.options.pointers&&zt(Cr)>this.options.velocity&&Ae.eventType&$t},emit:function(Ae){var Xe=en(Ae.offsetDirection);Xe&&this.manager.emit(this.options.event+Xe,Ae),this.manager.emit(this.options.event,Ae)}});function Ho(){He.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Dt(Ho,He,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[La]},process:function(Ae){var Xe=this.options,Cr=Ae.pointers.length===Xe.pointers,sn=Ae.distance<Xe.threshold,si=Ae.deltaTime<Xe.time;if(this.reset(),Ae.eventType&bt&&this.count===0)return this.failTimeout();if(sn&&si&&Cr){if(Ae.eventType!=$t)return this.failTimeout();var Pi=this.pTime?Ae.timeStamp-this.pTime<Xe.interval:!0,ja=!this.pCenter||Gr(this.pCenter,Ae.center)<Xe.posThreshold;this.pTime=Ae.timeStamp,this.pCenter=Ae.center,!ja||!Pi?this.count=1:this.count+=1,this._input=Ae;var vs=this.count%Xe.taps;if(vs===0)return this.hasRequireFailures()?(this._timer=b(function(){this.state=_o,this.tryEmit()},Xe.interval,this),Oo):_o}return ge},failTimeout:function(){return this._timer=b(function(){this.state=ge},this.options.interval,this),ge},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==_o&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function uo(Ae,Xe){return Xe=Xe||{},Xe.recognizers=ve(Xe.recognizers,uo.defaults.preset),new jo(Ae,Xe)}uo.VERSION="2.0.7",uo.defaults={domEvents:!1,touchAction:Ca,enable:!0,inputTarget:null,inputClass:null,preset:[[us,{enable:!1}],[qi,{enable:!1},["rotate"]],[Ao,{direction:Ct}],[kn,{direction:Ct},["swipe"]],[Ho],[Ho,{event:"doubletap",taps:2},["tap"]],[Oa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Zo=1,Qs=2;function jo(Ae,Xe){this.options=ke({},uo.defaults,Xe||{}),this.options.inputTarget=this.options.inputTarget||Ae,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ae,this.input=de(this),this.touchAction=new Uo(this,this.options.touchAction),_l(this,!0),le(this.options.recognizers,function(Cr){var sn=this.add(new Cr[0](Cr[1]));Cr[2]&&sn.recognizeWith(Cr[2]),Cr[3]&&sn.requireFailure(Cr[3])},this)}jo.prototype={set:function(Ae){return ke(this.options,Ae),Ae.touchAction&&this.touchAction.update(),Ae.inputTarget&&(this.input.destroy(),this.input.target=Ae.inputTarget,this.input.init()),this},stop:function(Ae){this.session.stopped=Ae?Qs:Zo},recognize:function(Ae){var Xe=this.session;if(!Xe.stopped){this.touchAction.preventDefaults(Ae);var Cr,sn=this.recognizers,si=Xe.curRecognizer;(!si||si&&si.state&_o)&&(si=Xe.curRecognizer=null);for(var Pi=0;Pi<sn.length;)Cr=sn[Pi],Xe.stopped!==Qs&&(!si||Cr==si||Cr.canRecognizeWith(si))?Cr.recognize(Ae):Cr.reset(),!si&&Cr.state&(Oo|Du|Yo)&&(si=Xe.curRecognizer=Cr),Pi++}},get:function(Ae){if(Ae instanceof He)return Ae;for(var Xe=this.recognizers,Cr=0;Cr<Xe.length;Cr++)if(Xe[Cr].options.event==Ae)return Xe[Cr];return null},add:function(Ae){if(W(Ae,"add",this))return this;var Xe=this.get(Ae.options.event);return Xe&&this.remove(Xe),this.recognizers.push(Ae),Ae.manager=this,this.touchAction.update(),Ae},remove:function(Ae){if(W(Ae,"remove",this))return this;if(Ae=this.get(Ae),Ae){var Xe=this.recognizers,Cr=ft(Xe,Ae);Cr!==-1&&(Xe.splice(Cr,1),this.touchAction.update())}return this},on:function(Ae,Xe){if(Ae!==K&&Xe!==K){var Cr=this.handlers;return le(te(Ae),function(sn){Cr[sn]=Cr[sn]||[],Cr[sn].push(Xe)}),this}},off:function(Ae,Xe){if(Ae!==K){var Cr=this.handlers;return le(te(Ae),function(sn){Xe?Cr[sn]&&Cr[sn].splice(ft(Cr[sn],Xe),1):delete Cr[sn]}),this}},emit:function(Ae,Xe){this.options.domEvents&&Hc(Ae,Xe);var Cr=this.handlers[Ae]&&this.handlers[Ae].slice();if(!(!Cr||!Cr.length)){Xe.type=Ae,Xe.preventDefault=function(){Xe.srcEvent.preventDefault()};for(var sn=0;sn<Cr.length;)Cr[sn](Xe),sn++}},destroy:function(){this.element&&_l(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function _l(Ae,Xe){var Cr=Ae.element;if(Cr.style){var sn;le(Ae.options.cssProps,function(si,Pi){sn=gt(Cr.style,Pi),Xe?(Ae.oldCssProps[sn]=Cr.style[sn],Cr.style[sn]=si):Cr.style[sn]=Ae.oldCssProps[sn]||""}),Xe||(Ae.oldCssProps={})}}function Hc(Ae,Xe){if(!pt){var Cr=k.createEvent("Event");Cr.initEvent(Ae,!0,!0),Cr.gesture=Xe,Xe.target.dispatchEvent(Cr)}}if(!pt){ke(uo,{INPUT_START:bt,INPUT_MOVE:Wt,INPUT_END:$t,INPUT_CANCEL:xt,STATE_POSSIBLE:Xa,STATE_BEGAN:Oo,STATE_CHANGED:Du,STATE_ENDED:Yo,STATE_RECOGNIZED:_o,STATE_CANCELLED:ir,STATE_FAILED:ge,DIRECTION_NONE:St,DIRECTION_LEFT:ue,DIRECTION_RIGHT:Pe,DIRECTION_UP:ze,DIRECTION_DOWN:Vt,DIRECTION_HORIZONTAL:Ct,DIRECTION_VERTICAL:At,DIRECTION_ALL:Nt,Manager:jo,Input:Ht,TouchAction:Uo,TouchInput:an,MouseInput:$n,PointerEventInput:Ge,TouchMouseInput:Qr,SingleTouchInput:ar,Recognizer:He,AttrRecognizer:zn,Tap:Ho,Pan:kn,Swipe:Ao,Pinch:qi,Rotate:us,Press:Oa,on:ne,off:xe,each:le,merge:rt,extend:Tt,assign:ke,inherit:Dt,bindFn:Se,prefixed:gt});var $u=typeof window!="undefined"?window:typeof self!="undefined"?self:{};$u.Hammer=uo,kt=function(){return uo}.call(Pt,nt,Pt,dn),kt!==K&&(dn.exports=kt)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},87781:function(dn,Pt,nt){(function(kt,mt){dn.exports=mt(nt(34306))})(this,function(kt){"use strict";var mt=function(It){return It instanceof Uint8Array||It instanceof Uint16Array||It instanceof Uint32Array||It instanceof Int8Array||It instanceof Int16Array||It instanceof Int32Array||It instanceof Float32Array||It instanceof Float64Array||It instanceof Uint8ClampedArray},k=function(It,Re){for(var dr=Object.keys(Re),ln=0;ln<dr.length;++ln)It[dr[ln]]=Re[dr[ln]];return It},Et=`
`;function K(It){return typeof atob!="undefined"?atob(It):"base64:"+It}function yt(It){var Re=new Error("(regl) "+It);throw console.error(Re),Re}function J(It,Re){It||yt(Re)}function pt(It){return It?": "+It:""}function et(It,Re,dr){It in Re||yt("unknown parameter ("+It+")"+pt(dr)+". possible values: "+Object.keys(Re).join())}function be(It,Re){mt(It)||yt("invalid parameter type"+pt(Re)+". must be a typed array")}function ot(It,Re){switch(Re){case"number":return typeof It=="number";case"object":return typeof It=="object";case"string":return typeof It=="string";case"boolean":return typeof It=="boolean";case"function":return typeof It=="function";case"undefined":return typeof It=="undefined";case"symbol":return typeof It=="symbol"}}function ut(It,Re,dr){ot(It,Re)||yt("invalid parameter type"+pt(dr)+". expected "+Re+", got "+typeof It)}function zt(It,Re){It>=0&&(It|0)===It||yt("invalid parameter type, ("+It+")"+pt(Re)+". must be a nonnegative integer")}function P(It,Re,dr){Re.indexOf(It)<0&&yt("invalid value"+pt(dr)+". must be one of: "+Re)}var b=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function W(It){Object.keys(It).forEach(function(Re){b.indexOf(Re)<0&&yt('invalid regl constructor argument "'+Re+'". must be one of '+b)})}function le(It,Re){for(It=It+"";It.length<Re;)It=" "+It;return It}function Ee(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function ke(It,Re){this.number=It,this.line=Re,this.errors=[]}function Tt(It,Re,dr){this.file=It,this.line=Re,this.message=dr}function rt(){var It=new Error,Re=(It.stack||It).toString(),dr=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Re);if(dr)return dr[1];var ln=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Re);return ln?ln[1]:"unknown"}function Dt(){var It=new Error,Re=(It.stack||It).toString(),dr=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Re);if(dr)return dr[1];var ln=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Re);return ln?ln[1]:"unknown"}function Se(It,Re){var dr=It.split(`
`),ln=1,Ln=0,on={unknown:new Ee,0:new Ee};on.unknown.name=on[0].name=Re||rt(),on.unknown.lines.push(new ke(0,""));for(var En=0;En<dr.length;++En){var jr=dr[En],Xn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(jr);if(Xn)switch(Xn[1]){case"line":var Yn=/(\d+)(\s+\d+)?/.exec(Xn[2]);Yn&&(ln=Yn[1]|0,Yn[2]&&(Ln=Yn[2]|0,Ln in on||(on[Ln]=new Ee)));break;case"define":var ni=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Xn[2]);ni&&(on[Ln].name=ni[1]?K(ni[2]):ni[2]);break}on[Ln].lines.push(new ke(ln++,jr))}return Object.keys(on).forEach(function(Jn){var yi=on[Jn];yi.lines.forEach(function(qn){yi.index[qn.number]=qn})}),on}function _e(It){var Re=[];return It.split(`
`).forEach(function(dr){if(!(dr.length<5)){var ln=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(dr);ln?Re.push(new Tt(ln[1]|0,ln[2]|0,ln[3].trim())):dr.length>0&&Re.push(new Tt("unknown",0,dr))}}),Re}function ve(It,Re){Re.forEach(function(dr){var ln=It[dr.file];if(ln){var Ln=ln.index[dr.line];if(Ln){Ln.errors.push(dr),ln.hasErrors=!0;return}}It.unknown.hasErrors=!0,It.unknown.lines[0].errors.push(dr)})}function ne(It,Re,dr,ln,Ln){if(!It.getShaderParameter(Re,It.COMPILE_STATUS)){var on=It.getShaderInfoLog(Re),En=ln===It.FRAGMENT_SHADER?"fragment":"vertex";Y(dr,"string",En+" shader source must be a string",Ln);var jr=Se(dr,Ln),Xn=_e(on);ve(jr,Xn),Object.keys(jr).forEach(function(Yn){var ni=jr[Yn];if(!ni.hasErrors)return;var Jn=[""],yi=[""];function qn(ri,Zr){Jn.push(ri),yi.push(Zr||"")}qn("file number "+Yn+": "+ni.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ni.lines.forEach(function(ri){if(ri.errors.length>0){qn(le(ri.number,4)+"|  ","background-color:yellow; font-weight:bold"),qn(ri.line+Et,"color:red; background-color:yellow; font-weight:bold");var Zr=0;ri.errors.forEach(function(mn){var jn=mn.message,gi=/^\s*'(.*)'\s*:\s*(.*)$/.exec(jn);if(gi){var Dn=gi[1];switch(jn=gi[2],Dn){case"assign":Dn="=";break}Zr=Math.max(ri.line.indexOf(Dn,Zr),0)}else Zr=0;qn(le("| ",6)),qn(le("^^^",Zr+3)+Et,"font-weight:bold"),qn(le("| ",6)),qn(jn+Et,"font-weight:bold")}),qn(le("| ",6)+Et)}else qn(le(ri.number,4)+"|  "),qn(ri.line+Et,"color:red")}),typeof document!="undefined"&&!window.chrome?(yi[0]=Jn.join("%c"),console.log.apply(console,yi)):console.log(Jn.join(""))}),J.raise("Error compiling "+En+" shader, "+jr[0].name)}}function xe(It,Re,dr,ln,Ln){if(!It.getProgramParameter(Re,It.LINK_STATUS)){var on=It.getProgramInfoLog(Re),En=Se(dr,Ln),jr=Se(ln,Ln),Xn='Error linking program with vertex shader, "'+jr[0].name+'", and fragment shader "'+En[0].name+'"';typeof document!="undefined"?console.log("%c"+Xn+Et+"%c"+on,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Xn+Et+on),J.raise(Xn)}}function Je(It){It._commandRef=rt()}function Ot(It,Re,dr,ln){Je(It);function Ln(Xn){return Xn?ln.id(Xn):0}It._fragId=Ln(It.static.frag),It._vertId=Ln(It.static.vert);function on(Xn,Yn){Object.keys(Yn).forEach(function(ni){Xn[ln.id(ni)]=!0})}var En=It._uniformSet={};on(En,Re.static),on(En,Re.dynamic);var jr=It._attributeSet={};on(jr,dr.static),on(jr,dr.dynamic),It._hasCount="count"in It.static||"count"in It.dynamic||"elements"in It.static||"elements"in It.dynamic}function te(It,Re){var dr=Dt();yt(It+" in command "+(Re||rt())+(dr==="unknown"?"":" called from "+dr))}function ft(It,Re,dr){It||te(Re,dr||rt())}function wt(It,Re,dr,ln){It in Re||te("unknown parameter ("+It+")"+pt(dr)+". possible values: "+Object.keys(Re).join(),ln||rt())}function Y(It,Re,dr,ln){ot(It,Re)||te("invalid parameter type"+pt(dr)+". expected "+Re+", got "+typeof It,ln||rt())}function gt(It){It()}function he(It,Re,dr){It.texture?P(It.texture._texture.internalformat,Re,"unsupported texture format for attachment"):P(It.renderbuffer._renderbuffer.format,dr,"unsupported renderbuffer format for attachment")}var Oe=33071,Le=9728,Ve=9984,Bt=9985,re=9986,ye=9987,Yt=5120,qe=5121,vr=5122,oe=5123,qt=5124,bt=5125,Wt=5126,$t=32819,xt=32820,St=33635,ue=34042,Pe=36193,ze={};ze[Yt]=ze[qe]=1,ze[vr]=ze[oe]=ze[Pe]=ze[St]=ze[$t]=ze[xt]=2,ze[qt]=ze[bt]=ze[Wt]=ze[ue]=4;function Vt(It,Re){return It===xt||It===$t||It===St?2:It===ue?4:ze[It]*Re}function Ct(It){return!(It&It-1)&&!!It}function At(It,Re,dr){var ln,Ln=Re.width,on=Re.height,En=Re.channels;J(Ln>0&&Ln<=dr.maxTextureSize&&on>0&&on<=dr.maxTextureSize,"invalid texture shape"),(It.wrapS!==Oe||It.wrapT!==Oe)&&J(Ct(Ln)&&Ct(on),"incompatible wrap mode for texture, both width and height must be power of 2"),Re.mipmask===1?Ln!==1&&on!==1&&J(It.minFilter!==Ve&&It.minFilter!==re&&It.minFilter!==Bt&&It.minFilter!==ye,"min filter requires mipmap"):(J(Ct(Ln)&&Ct(on),"texture must be a square power of 2 to support mipmapping"),J(Re.mipmask===(Ln<<1)-1,"missing or incomplete mipmap data")),Re.type===Wt&&(dr.extensions.indexOf("oes_texture_float_linear")<0&&J(It.minFilter===Le&&It.magFilter===Le,"filter not supported, must enable oes_texture_float_linear"),J(!It.genMipmaps,"mipmap generation not supported with float textures"));var jr=Re.images;for(ln=0;ln<16;++ln)if(jr[ln]){var Xn=Ln>>ln,Yn=on>>ln;J(Re.mipmask&1<<ln,"missing mipmap data");var ni=jr[ln];if(J(ni.width===Xn&&ni.height===Yn,"invalid shape for mip images"),J(ni.format===Re.format&&ni.internalformat===Re.internalformat&&ni.type===Re.type,"incompatible type for mip image"),!ni.compressed)if(ni.data){var Jn=Math.ceil(Vt(ni.type,En)*Xn/ni.unpackAlignment)*ni.unpackAlignment;J(ni.data.byteLength===Jn*Yn,"invalid data for image, buffer size is inconsistent with image format")}else ni.element||ni.copy}else It.genMipmaps||J((Re.mipmask&1<<ln)===0,"extra mipmap data");Re.compressed&&J(!It.genMipmaps,"mipmap generation for compressed images not supported")}function Nt(It,Re,dr,ln){var Ln=It.width,on=It.height,En=It.channels;J(Ln>0&&Ln<=ln.maxTextureSize&&on>0&&on<=ln.maxTextureSize,"invalid texture shape"),J(Ln===on,"cube map must be square"),J(Re.wrapS===Oe&&Re.wrapT===Oe,"wrap mode not supported by cube map");for(var jr=0;jr<dr.length;++jr){var Xn=dr[jr];J(Xn.width===Ln&&Xn.height===on,"inconsistent cube map face shape"),Re.genMipmaps&&(J(!Xn.compressed,"can not generate mipmap for compressed textures"),J(Xn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Yn=Xn.images,ni=0;ni<16;++ni){var Jn=Yn[ni];if(Jn){var yi=Ln>>ni,qn=on>>ni;J(Xn.mipmask&1<<ni,"missing mipmap data"),J(Jn.width===yi&&Jn.height===qn,"invalid shape for mip images"),J(Jn.format===It.format&&Jn.internalformat===It.internalformat&&Jn.type===It.type,"incompatible type for mip image"),Jn.compressed||(Jn.data?J(Jn.data.byteLength===yi*qn*Math.max(Vt(Jn.type,En),Jn.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Jn.element||Jn.copy)}}}}var tt=k(J,{optional:gt,raise:yt,commandRaise:te,command:ft,parameter:et,commandParameter:wt,constructor:W,type:ut,commandType:Y,isTypedArray:be,nni:zt,oneOf:P,shaderError:ne,linkError:xe,callSite:Dt,saveCommandRef:Je,saveDrawInfo:Ot,framebufferFormat:he,guessCommand:rt,texture2D:At,textureCube:Nt}),vt=0,Ht=0,de=5,jt=6;function Ie(It,Re){this.id=vt++,this.type=It,this.data=Re}function We(It){return It.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Ke(It){if(It.length===0)return[];var Re=It.charAt(0),dr=It.charAt(It.length-1);if(It.length>1&&Re===dr&&(Re==='"'||Re==="'"))return['"'+We(It.substr(1,It.length-2))+'"'];var ln=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(It);if(ln)return Ke(It.substr(0,ln.index)).concat(Ke(ln[1])).concat(Ke(It.substr(ln.index+ln[0].length)));var Ln=It.split(".");if(Ln.length===1)return['"'+We(It)+'"'];for(var on=[],En=0;En<Ln.length;++En)on=on.concat(Ke(Ln[En]));return on}function pr(It){return"["+Ke(It).join("][")+"]"}function lr(It,Re){return new Ie(It,pr(Re+""))}function Nr(It){return typeof It=="function"&&!It._reglType||It instanceof Ie}function Pr(It,Re){if(typeof It=="function")return new Ie(Ht,It);if(typeof It=="number"||typeof It=="boolean")return new Ie(de,It);if(Array.isArray(It))return new Ie(jt,It.map(function(dr,ln){return Pr(dr,Re+"["+ln+"]")}));if(It instanceof Ie)return It;tt(!1,"invalid option type in uniform "+Re)}var Gr={DynamicVariable:Ie,define:lr,isDynamic:Nr,unbox:Pr,accessor:pr},Sn={next:typeof requestAnimationFrame=="function"?function(It){return requestAnimationFrame(It)}:function(It){return setTimeout(It,16)},cancel:typeof cancelAnimationFrame=="function"?function(It){return cancelAnimationFrame(It)}:clearTimeout},nn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Nn=nn?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Zn(){var It={"":0},Re=[""];return{id:function(dr){var ln=It[dr];return ln||(ln=It[dr]=Re.length,Re.push(dr),ln)},str:function(dr){return Re[dr]}}}function Hn(It,Re,dr){var ln=document.createElement("canvas");k(ln.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),It.appendChild(ln),It===document.body&&(ln.style.position="absolute",k(It.style,{margin:0,padding:0}));function Ln(){var jr=window.innerWidth,Xn=window.innerHeight;if(It!==document.body){var Yn=ln.getBoundingClientRect();jr=Yn.right-Yn.left,Xn=Yn.bottom-Yn.top}ln.width=dr*jr,ln.height=dr*Xn}var on;It!==document.body&&typeof ResizeObserver=="function"?(on=new ResizeObserver(function(){setTimeout(Ln)}),on.observe(It)):window.addEventListener("resize",Ln,!1);function En(){on?on.disconnect():window.removeEventListener("resize",Ln),It.removeChild(ln)}return Ln(),{canvas:ln,onDestroy:En}}function An(It,Re){function dr(ln){try{return It.getContext(ln,Re)}catch(Ln){return null}}return dr("webgl")||dr("experimental-webgl")||dr("webgl-experimental")}function $n(It){return typeof It.nodeName=="string"&&typeof It.appendChild=="function"&&typeof It.getBoundingClientRect=="function"}function Rt(It){return typeof It.drawArrays=="function"||typeof It.drawElements=="function"}function Xt(It){return typeof It=="string"?It.split():(tt(Array.isArray(It),"invalid extension array"),It)}function ae(It){return typeof It=="string"?(tt(typeof document!="undefined","not supported outside of DOM"),document.querySelector(It)):It}function we(It){var Re=It||{},dr,ln,Ln,on,En={},jr=[],Xn=[],Yn=typeof window=="undefined"?1:window.devicePixelRatio,ni=!1,Jn=function(ri){ri&&tt.raise(ri)},yi=function(){};if(typeof Re=="string"?(tt(typeof document!="undefined","selector queries only supported in DOM environments"),dr=document.querySelector(Re),tt(dr,"invalid query string for element")):typeof Re=="object"?$n(Re)?dr=Re:Rt(Re)?(on=Re,Ln=on.canvas):(tt.constructor(Re),"gl"in Re?on=Re.gl:"canvas"in Re?Ln=ae(Re.canvas):"container"in Re&&(ln=ae(Re.container)),"attributes"in Re&&(En=Re.attributes,tt.type(En,"object","invalid context attributes")),"extensions"in Re&&(jr=Xt(Re.extensions)),"optionalExtensions"in Re&&(Xn=Xt(Re.optionalExtensions)),"onDone"in Re&&(tt.type(Re.onDone,"function","invalid or missing onDone callback"),Jn=Re.onDone),"profile"in Re&&(ni=!!Re.profile),"pixelRatio"in Re&&(Yn=+Re.pixelRatio,tt(Yn>0,"invalid pixel ratio"))):tt.raise("invalid arguments to regl"),dr&&(dr.nodeName.toLowerCase()==="canvas"?Ln=dr:ln=dr),!on){if(!Ln){tt(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var qn=Hn(ln||document.body,Jn,Yn);if(!qn)return null;Ln=qn.canvas,yi=qn.onDestroy}En.premultipliedAlpha===void 0&&(En.premultipliedAlpha=!0),on=An(Ln,En)}return on?{gl:on,canvas:Ln,container:ln,extensions:jr,optionalExtensions:Xn,pixelRatio:Yn,profile:ni,onDone:Jn,onDestroy:yi}:(yi(),Jn("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Ge(It,Re){var dr={};function ln(jr){tt.type(jr,"string","extension name must be string");var Xn=jr.toLowerCase(),Yn;try{Yn=dr[Xn]=Ln(jr)}catch(ni){}return!!Yn}function Ln(jr){return It.getExtension(jr)?It.getExtension(jr):It.getExtension(jr.toLowerCase())?It.getExtension(jr.toLowerCase()):null}for(var on=0;on<Re.extensions.length;++on){var En=Re.extensions[on];if(!ln(En))return Re.onDestroy(),Re.onDone('"'+En+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Re.optionalExtensions.forEach(ln),{extensions:dr,restore:function(){Object.keys(dr).forEach(function(jr){if(dr[jr]&&!ln(jr))throw new Error("(regl): error restoring extension "+jr)})}}}function cr(It,Re){for(var dr=Array(It),ln=0;ln<It;++ln)dr[ln]=Re(ln);return dr}var br=5120,Ce=5121,ar=5122,Hr=5123,Tn=5124,Kr=5125,an=5126;function Pn(It){for(var Re=16;Re<=1<<28;Re*=16)if(It<=Re)return Re;return 0}function xi(It){var Re,dr;return Re=(It>65535)<<4,It>>>=Re,dr=(It>255)<<3,It>>>=dr,Re|=dr,dr=(It>15)<<2,It>>>=dr,Re|=dr,dr=(It>3)<<1,It>>>=dr,Re|=dr,Re|It>>1}function Ci(){var It=cr(8,function(){return[]});function Re(on){var En=Pn(on),jr=It[xi(En)>>2];return jr.length>0?jr.pop():new ArrayBuffer(En)}function dr(on){It[xi(on.byteLength)>>2].push(on)}function ln(on,En){var jr=null;switch(on){case br:jr=new Int8Array(Re(En),0,En);break;case Ce:jr=new Uint8Array(Re(En),0,En);break;case ar:jr=new Int16Array(Re(2*En),0,En);break;case Hr:jr=new Uint16Array(Re(2*En),0,En);break;case Tn:jr=new Int32Array(Re(4*En),0,En);break;case Kr:jr=new Uint32Array(Re(4*En),0,En);break;case an:jr=new Float32Array(Re(4*En),0,En);break;default:return null}return jr.length!==En?jr.subarray(0,En):jr}function Ln(on){dr(on.buffer)}return{alloc:Re,free:dr,allocType:ln,freeType:Ln}}var Qr=Ci();Qr.zero=Ci();var Kn=3408,ai=3410,fi=3411,oa=3412,Ai=3413,Ca=3414,po=3415,La=33901,Va=33902,_a=3379,ma=3386,Qa=34921,Uo=36347,vo=36348,Ua=35661,Xa=35660,Oo=34930,Du=36349,Yo=34076,_o=34024,ir=7936,ge=7937,He=7938,Ir=35724,en=34047,On=36063,zn=34852,kn=3553,qi=34067,Oa=34069,us=33984,Ao=6408,Ho=5126,uo=5121,Zo=36160,Qs=36053,jo=36064,_l=16384,Hc=function(It,Re){var dr=1;Re.ext_texture_filter_anisotropic&&(dr=It.getParameter(en));var ln=1,Ln=1;Re.webgl_draw_buffers&&(ln=It.getParameter(zn),Ln=It.getParameter(On));var on=!!Re.oes_texture_float;if(on){var En=It.createTexture();It.bindTexture(kn,En),It.texImage2D(kn,0,Ao,1,1,0,Ao,Ho,null);var jr=It.createFramebuffer();if(It.bindFramebuffer(Zo,jr),It.framebufferTexture2D(Zo,jo,kn,En,0),It.bindTexture(kn,null),It.checkFramebufferStatus(Zo)!==Qs)on=!1;else{It.viewport(0,0,1,1),It.clearColor(1,0,0,1),It.clear(_l);var Xn=Qr.allocType(Ho,4);It.readPixels(0,0,1,1,Ao,Ho,Xn),It.getError()?on=!1:(It.deleteFramebuffer(jr),It.deleteTexture(En),on=Xn[0]===1),Qr.freeType(Xn)}}var Yn=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ni=!0;if(!Yn){var Jn=It.createTexture(),yi=Qr.allocType(uo,36);It.activeTexture(us),It.bindTexture(qi,Jn),It.texImage2D(Oa,0,Ao,3,3,0,Ao,uo,yi),Qr.freeType(yi),It.bindTexture(qi,null),It.deleteTexture(Jn),ni=!It.getError()}return{colorBits:[It.getParameter(ai),It.getParameter(fi),It.getParameter(oa),It.getParameter(Ai)],depthBits:It.getParameter(Ca),stencilBits:It.getParameter(po),subpixelBits:It.getParameter(Kn),extensions:Object.keys(Re).filter(function(qn){return!!Re[qn]}),maxAnisotropic:dr,maxDrawbuffers:ln,maxColorAttachments:Ln,pointSizeDims:It.getParameter(La),lineWidthDims:It.getParameter(Va),maxViewportDims:It.getParameter(ma),maxCombinedTextureUnits:It.getParameter(Ua),maxCubeMapSize:It.getParameter(Yo),maxRenderbufferSize:It.getParameter(_o),maxTextureUnits:It.getParameter(Oo),maxTextureSize:It.getParameter(_a),maxAttributes:It.getParameter(Qa),maxVertexUniforms:It.getParameter(Uo),maxVertexTextureUnits:It.getParameter(Xa),maxVaryingVectors:It.getParameter(vo),maxFragmentUniforms:It.getParameter(Du),glsl:It.getParameter(Ir),renderer:It.getParameter(ge),vendor:It.getParameter(ir),version:It.getParameter(He),readFloat:on,npotTextureCube:ni}};function $u(It){return!!It&&typeof It=="object"&&Array.isArray(It.shape)&&Array.isArray(It.stride)&&typeof It.offset=="number"&&It.shape.length===It.stride.length&&(Array.isArray(It.data)||mt(It.data))}var Ae=function(It){return Object.keys(It).map(function(Re){return It[Re]})},Xe={shape:vs,flatten:ja};function Cr(It,Re,dr){for(var ln=0;ln<Re;++ln)dr[ln]=It[ln]}function sn(It,Re,dr,ln){for(var Ln=0,on=0;on<Re;++on)for(var En=It[on],jr=0;jr<dr;++jr)ln[Ln++]=En[jr]}function si(It,Re,dr,ln,Ln,on){for(var En=on,jr=0;jr<Re;++jr)for(var Xn=It[jr],Yn=0;Yn<dr;++Yn)for(var ni=Xn[Yn],Jn=0;Jn<ln;++Jn)Ln[En++]=ni[Jn]}function Pi(It,Re,dr,ln,Ln){for(var on=1,En=dr+1;En<Re.length;++En)on*=Re[En];var jr=Re[dr];if(Re.length-dr===4){var Xn=Re[dr+1],Yn=Re[dr+2],ni=Re[dr+3];for(En=0;En<jr;++En)si(It[En],Xn,Yn,ni,ln,Ln),Ln+=on}else for(En=0;En<jr;++En)Pi(It[En],Re,dr+1,ln,Ln),Ln+=on}function ja(It,Re,dr,ln){var Ln=1;if(Re.length)for(var on=0;on<Re.length;++on)Ln*=Re[on];else Ln=0;var En=ln||Qr.allocType(dr,Ln);switch(Re.length){case 0:break;case 1:Cr(It,Re[0],En);break;case 2:sn(It,Re[0],Re[1],En);break;case 3:si(It,Re[0],Re[1],Re[2],En,0);break;default:Pi(It,Re,0,En,0)}return En}function vs(It){for(var Re=[],dr=It;dr.length;dr=dr[0])Re.push(dr.length);return Re}var $o={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},qo=5120,Js=5122,qu=5124,yu=5121,Zs=5123,_u=5125,Ku=5126,Bu=5126,xl={int8:qo,int16:Js,int32:qu,uint8:yu,uint16:Zs,uint32:_u,float:Ku,float32:Bu},Nu=35048,Fo=35040,Ts={dynamic:Nu,stream:Fo,static:35044},jc=Xe.flatten,Wc=Xe.shape,xu=35044,Ms=35040,pl=5121,Ga=5126,zu=[];zu[5120]=1,zu[5122]=2,zu[5124]=4,zu[5121]=1,zu[5123]=2,zu[5125]=4,zu[5126]=4;function Xc(It){return $o[Object.prototype.toString.call(It)]|0}function D(It,Re){for(var dr=0;dr<Re.length;++dr)It[dr]=Re[dr]}function X(It,Re,dr,ln,Ln,on,En){for(var jr=0,Xn=0;Xn<dr;++Xn)for(var Yn=0;Yn<ln;++Yn)It[jr++]=Re[Ln*Xn+on*Yn+En]}function Mt(It,Re,dr,ln){var Ln=0,on={};function En(Zr){this.id=Ln++,this.buffer=It.createBuffer(),this.type=Zr,this.usage=xu,this.byteLength=0,this.dimension=1,this.dtype=pl,this.persistentData=null,dr.profile&&(this.stats={size:0})}En.prototype.bind=function(){It.bindBuffer(this.type,this.buffer)},En.prototype.destroy=function(){yi(this)};var jr=[];function Xn(Zr,mn){var jn=jr.pop();return jn||(jn=new En(Zr)),jn.bind(),Jn(jn,mn,Ms,0,1,!1),jn}function Yn(Zr){jr.push(Zr)}function ni(Zr,mn,jn){Zr.byteLength=mn.byteLength,It.bufferData(Zr.type,mn,jn)}function Jn(Zr,mn,jn,gi,Dn,ci){var Mi;if(Zr.usage=jn,Array.isArray(mn)){if(Zr.dtype=gi||Ga,mn.length>0){var la;if(Array.isArray(mn[0])){Mi=Wc(mn);for(var wn=1,In=1;In<Mi.length;++In)wn*=Mi[In];Zr.dimension=wn,la=jc(mn,Mi,Zr.dtype),ni(Zr,la,jn),ci?Zr.persistentData=la:Qr.freeType(la)}else if(typeof mn[0]=="number"){Zr.dimension=Dn;var Wi=Qr.allocType(Zr.dtype,mn.length);D(Wi,mn),ni(Zr,Wi,jn),ci?Zr.persistentData=Wi:Qr.freeType(Wi)}else mt(mn[0])?(Zr.dimension=mn[0].length,Zr.dtype=gi||Xc(mn[0])||Ga,la=jc(mn,[mn.length,mn[0].length],Zr.dtype),ni(Zr,la,jn),ci?Zr.persistentData=la:Qr.freeType(la)):tt.raise("invalid buffer data")}}else if(mt(mn))Zr.dtype=gi||Xc(mn),Zr.dimension=Dn,ni(Zr,mn,jn),ci&&(Zr.persistentData=new Uint8Array(new Uint8Array(mn.buffer)));else if($u(mn)){Mi=mn.shape;var bi=mn.stride,Qn=mn.offset,pi=0,hi=0,Na=0,wa=0;Mi.length===1?(pi=Mi[0],hi=1,Na=bi[0],wa=0):Mi.length===2?(pi=Mi[0],hi=Mi[1],Na=bi[0],wa=bi[1]):tt.raise("invalid shape"),Zr.dtype=gi||Xc(mn.data)||Ga,Zr.dimension=hi;var Ei=Qr.allocType(Zr.dtype,pi*hi);X(Ei,mn.data,pi,hi,Na,wa,Qn),ni(Zr,Ei,jn),ci?Zr.persistentData=Ei:Qr.freeType(Ei)}else mn instanceof ArrayBuffer?(Zr.dtype=pl,Zr.dimension=Dn,ni(Zr,mn,jn),ci&&(Zr.persistentData=new Uint8Array(new Uint8Array(mn)))):tt.raise("invalid buffer data")}function yi(Zr){Re.bufferCount--,ln(Zr);var mn=Zr.buffer;tt(mn,"buffer must not be deleted already"),It.deleteBuffer(mn),Zr.buffer=null,delete on[Zr.id]}function qn(Zr,mn,jn,gi){Re.bufferCount++;var Dn=new En(mn);on[Dn.id]=Dn;function ci(wn){var In=xu,Wi=null,bi=0,Qn=0,pi=1;return Array.isArray(wn)||mt(wn)||$u(wn)||wn instanceof ArrayBuffer?Wi=wn:typeof wn=="number"?bi=wn|0:wn&&(tt.type(wn,"object","buffer arguments must be an object, a number or an array"),"data"in wn&&(tt(Wi===null||Array.isArray(Wi)||mt(Wi)||$u(Wi),"invalid data for buffer"),Wi=wn.data),"usage"in wn&&(tt.parameter(wn.usage,Ts,"invalid buffer usage"),In=Ts[wn.usage]),"type"in wn&&(tt.parameter(wn.type,xl,"invalid buffer type"),Qn=xl[wn.type]),"dimension"in wn&&(tt.type(wn.dimension,"number","invalid dimension"),pi=wn.dimension|0),"length"in wn&&(tt.nni(bi,"buffer length must be a nonnegative integer"),bi=wn.length|0)),Dn.bind(),Wi?Jn(Dn,Wi,In,Qn,pi,gi):(bi&&It.bufferData(Dn.type,bi,In),Dn.dtype=Qn||pl,Dn.usage=In,Dn.dimension=pi,Dn.byteLength=bi),dr.profile&&(Dn.stats.size=Dn.byteLength*zu[Dn.dtype]),ci}function Mi(wn,In){tt(In+wn.byteLength<=Dn.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+wn.byteLength+" starting from offset "+In+" to a buffer of size "+Dn.byteLength),It.bufferSubData(Dn.type,In,wn)}function la(wn,In){var Wi=(In||0)|0,bi;if(Dn.bind(),mt(wn)||wn instanceof ArrayBuffer)Mi(wn,Wi);else if(Array.isArray(wn)){if(wn.length>0)if(typeof wn[0]=="number"){var Qn=Qr.allocType(Dn.dtype,wn.length);D(Qn,wn),Mi(Qn,Wi),Qr.freeType(Qn)}else if(Array.isArray(wn[0])||mt(wn[0])){bi=Wc(wn);var pi=jc(wn,bi,Dn.dtype);Mi(pi,Wi),Qr.freeType(pi)}else tt.raise("invalid buffer data")}else if($u(wn)){bi=wn.shape;var hi=wn.stride,Na=0,wa=0,Ei=0,Li=0;bi.length===1?(Na=bi[0],wa=1,Ei=hi[0],Li=0):bi.length===2?(Na=bi[0],wa=bi[1],Ei=hi[0],Li=hi[1]):tt.raise("invalid shape");var ga=Array.isArray(wn.data)?Dn.dtype:Xc(wn.data),Ta=Qr.allocType(ga,Na*wa);X(Ta,wn.data,Na,wa,Ei,Li,wn.offset),Mi(Ta,Wi),Qr.freeType(Ta)}else tt.raise("invalid data for buffer subdata");return ci}return jn||ci(Zr),ci._reglType="buffer",ci._buffer=Dn,ci.subdata=la,dr.profile&&(ci.stats=Dn.stats),ci.destroy=function(){yi(Dn)},ci}function ri(){Ae(on).forEach(function(Zr){Zr.buffer=It.createBuffer(),It.bindBuffer(Zr.type,Zr.buffer),It.bufferData(Zr.type,Zr.persistentData||Zr.byteLength,Zr.usage)})}return dr.profile&&(Re.getTotalBufferSize=function(){var Zr=0;return Object.keys(on).forEach(function(mn){Zr+=on[mn].stats.size}),Zr}),{create:qn,createStream:Xn,destroyStream:Yn,clear:function(){Ae(on).forEach(yi),jr.forEach(yi)},getBuffer:function(Zr){return Zr&&Zr._buffer instanceof En?Zr._buffer:null},restore:ri,_initBuffer:Jn}}var it=0,Jt=0,Ue=1,yr=1,Br=4,zr=4,Cn={points:it,point:Jt,lines:Ue,line:yr,triangles:Br,triangle:zr,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Vn=0,Ki=1,Ma=4,xa=5120,lo=5121,Ro=5122,Io=5123,fa=5124,bu=5125,bl=34963,Ic=35040,Yc=35044;function Fl(It,Re,dr,ln){var Ln={},on=0,En={uint8:lo,uint16:Io};Re.oes_element_index_uint&&(En.uint32=bu);function jr(ri){this.id=on++,Ln[this.id]=this,this.buffer=ri,this.primType=Ma,this.vertCount=0,this.type=0}jr.prototype.bind=function(){this.buffer.bind()};var Xn=[];function Yn(ri){var Zr=Xn.pop();return Zr||(Zr=new jr(dr.create(null,bl,!0,!1)._buffer)),Jn(Zr,ri,Ic,-1,-1,0,0),Zr}function ni(ri){Xn.push(ri)}function Jn(ri,Zr,mn,jn,gi,Dn,ci){ri.buffer.bind();var Mi;if(Zr){var la=ci;!ci&&(!mt(Zr)||$u(Zr)&&!mt(Zr.data))&&(la=Re.oes_element_index_uint?bu:Io),dr._initBuffer(ri.buffer,Zr,mn,la,3)}else It.bufferData(bl,Dn,mn),ri.buffer.dtype=Mi||lo,ri.buffer.usage=mn,ri.buffer.dimension=3,ri.buffer.byteLength=Dn;if(Mi=ci,!ci){switch(ri.buffer.dtype){case lo:case xa:Mi=lo;break;case Io:case Ro:Mi=Io;break;case bu:case fa:Mi=bu;break;default:tt.raise("unsupported type for element array")}ri.buffer.dtype=Mi}ri.type=Mi,tt(Mi!==bu||!!Re.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var wn=gi;wn<0&&(wn=ri.buffer.byteLength,Mi===Io?wn>>=1:Mi===bu&&(wn>>=2)),ri.vertCount=wn;var In=jn;if(jn<0){In=Ma;var Wi=ri.buffer.dimension;Wi===1&&(In=Vn),Wi===2&&(In=Ki),Wi===3&&(In=Ma)}ri.primType=In}function yi(ri){ln.elementsCount--,tt(ri.buffer!==null,"must not double destroy elements"),delete Ln[ri.id],ri.buffer.destroy(),ri.buffer=null}function qn(ri,Zr){var mn=dr.create(null,bl,!0),jn=new jr(mn._buffer);ln.elementsCount++;function gi(Dn){if(!Dn)mn(),jn.primType=Ma,jn.vertCount=0,jn.type=lo;else if(typeof Dn=="number")mn(Dn),jn.primType=Ma,jn.vertCount=Dn|0,jn.type=lo;else{var ci=null,Mi=Yc,la=-1,wn=-1,In=0,Wi=0;Array.isArray(Dn)||mt(Dn)||$u(Dn)?ci=Dn:(tt.type(Dn,"object","invalid arguments for elements"),"data"in Dn&&(ci=Dn.data,tt(Array.isArray(ci)||mt(ci)||$u(ci),"invalid data for element buffer")),"usage"in Dn&&(tt.parameter(Dn.usage,Ts,"invalid element buffer usage"),Mi=Ts[Dn.usage]),"primitive"in Dn&&(tt.parameter(Dn.primitive,Cn,"invalid element buffer primitive"),la=Cn[Dn.primitive]),"count"in Dn&&(tt(typeof Dn.count=="number"&&Dn.count>=0,"invalid vertex count for elements"),wn=Dn.count|0),"type"in Dn&&(tt.parameter(Dn.type,En,"invalid buffer type"),Wi=En[Dn.type]),"length"in Dn?In=Dn.length|0:(In=wn,Wi===Io||Wi===Ro?In*=2:(Wi===bu||Wi===fa)&&(In*=4))),Jn(jn,ci,Mi,la,wn,In,Wi)}return gi}return gi(ri),gi._reglType="elements",gi._elements=jn,gi.subdata=function(Dn,ci){return mn.subdata(Dn,ci),gi},gi.destroy=function(){yi(jn)},gi}return{create:qn,createStream:Yn,destroyStream:ni,getElements:function(ri){return typeof ri=="function"&&ri._elements instanceof jr?ri._elements:null},clear:function(){Ae(Ln).forEach(yi)}}}var kc=new Float32Array(1),Uu=new Uint32Array(kc.buffer),js=5123;function ce(It){for(var Re=Qr.allocType(js,It.length),dr=0;dr<It.length;++dr)if(isNaN(It[dr]))Re[dr]=65535;else if(It[dr]===1/0)Re[dr]=31744;else if(It[dr]===-1/0)Re[dr]=64512;else{kc[0]=It[dr];var ln=Uu[0],Ln=ln>>>31<<15,on=(ln<<1>>>24)-127,En=ln>>13&(1<<10)-1;if(on<-24)Re[dr]=Ln;else if(on<-14){var jr=-14-on;Re[dr]=Ln+(En+(1<<10)>>jr)}else on>15?Re[dr]=Ln+31744:Re[dr]=Ln+(on+15<<10)+En}return Re}function or(It){return Array.isArray(It)||mt(It)}var Fr=function(It){return!(It&It-1)&&!!It},Xr=34467,xn=3553,Ii=34067,ra=34069,Wa=6408,Eu=6406,Ws=6407,Ya=6409,Jl=6410,$c=32854,tc=32855,rd=36194,zf=32819,tv=32820,Ep=33635,Uf=34042,qc=6402,Zf=34041,Kc=35904,Vf=35906,fh=36193,Qc=33776,Rl=33777,wp=33778,hh=33779,Qu=35986,Jc=35987,Zh=34798,Gf=35840,ec=35841,Sp=35842,nd=35843,Cp=36196,rc=5121,id=5123,tf=5125,Hf=5126,gf=10242,ad=10243,od=10497,mf=33071,$v=33648,ph=10240,gs=10241,yf=9728,jf=9729,Dl=9984,Ja=9985,Wo=9986,ro=9987,Ap=33170,Bl=4352,Tp=4353,qv=4354,Ia=34046,Wf=3317,ef=37440,_f=37441,tu=37443,dh=37444,vh=33984,Fs=[Dl,Wo,Ja,ro],ji=[0,Ya,Jl,Ws,Wa],_s={};_s[Ya]=_s[Eu]=_s[qc]=1,_s[Zf]=_s[Jl]=2,_s[Ws]=_s[Kc]=3,_s[Wa]=_s[Vf]=4;function El(It){return"[object "+It+"]"}var Nl=El("HTMLCanvasElement"),vc=El("OffscreenCanvas"),Zu=El("CanvasRenderingContext2D"),sd=El("ImageBitmap"),Ti=El("HTMLImageElement"),Xf=El("HTMLVideoElement"),gh=Object.keys($o).concat([Nl,vc,Zu,sd,Ti,Xf]),rf=[];rf[rc]=1,rf[Hf]=4,rf[fh]=2,rf[id]=2,rf[tf]=4;var es=[];es[$c]=2,es[tc]=2,es[rd]=2,es[Zf]=4,es[Qc]=.5,es[Rl]=.5,es[wp]=1,es[hh]=1,es[Qu]=.5,es[Jc]=1,es[Zh]=1,es[Gf]=.5,es[ec]=.25,es[Sp]=.5,es[nd]=.25,es[Cp]=.5;function wu(It){return Array.isArray(It)&&(It.length===0||typeof It[0]=="number")}function xf(It){if(!Array.isArray(It))return!1;var Re=It.length;return!(Re===0||!or(It[0]))}function wl(It){return Object.prototype.toString.call(It)}function eu(It){return wl(It)===Nl}function nl(It){return wl(It)===vc}function Kv(It){return wl(It)===Zu}function Vh(It){return wl(It)===sd}function bf(It){return wl(It)===Ti}function ev(It){return wl(It)===Xf}function nc(It){var Re=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Re&&It&&It.getContext)}function dl(It){var Re=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Re&&It&&"src"in It&&"crossOrigin"in It)}function to(It){if(!It)return!1;if(nc(It)||dl(It))return!0;var Re=wl(It);return gh.indexOf(Re)>=0?!0:wu(It)||xf(It)||$u(It)}function mo(It){return $o[Object.prototype.toString.call(It)]|0}function ic(It,Re){var dr=Re.length;switch(It.type){case rc:case id:case tf:case Hf:var ln=Qr.allocType(It.type,dr);ln.set(Re),It.data=ln;break;case fh:It.data=ce(Re);break;default:tt.raise("unsupported texture type, must specify a typed array")}}function Xs(It,Re){return Qr.allocType(It.type===fh?Hf:It.type,Re)}function Yf(It,Re){It.type===fh?(It.data=ce(Re),Qr.freeType(Re)):It.data=Re}function nf(It,Re,dr,ln,Ln,on){for(var En=It.width,jr=It.height,Xn=It.channels,Yn=En*jr*Xn,ni=Xs(It,Yn),Jn=0,yi=0;yi<jr;++yi)for(var qn=0;qn<En;++qn)for(var ri=0;ri<Xn;++ri)ni[Jn++]=Re[dr*qn+ln*yi+Ln*ri+on];Yf(It,ni)}function Su(It,Re,dr,ln,Ln,on){var En;if(typeof es[It]!="undefined"?En=es[It]:En=_s[It]*rf[Re],on&&(En*=6),Ln){for(var jr=0,Xn=dr;Xn>=1;)jr+=En*Xn*Xn,Xn/=2;return jr}else return En*dr*ln}function fu(It,Re,dr,ln,Ln,on,En){var jr={"don't care":Bl,"dont care":Bl,nice:qv,fast:Tp},Xn={repeat:od,clamp:mf,mirror:$v},Yn={nearest:yf,linear:jf},ni=k({mipmap:ro,"nearest mipmap nearest":Dl,"linear mipmap nearest":Ja,"nearest mipmap linear":Wo,"linear mipmap linear":ro},Yn),Jn={none:0,browser:dh},yi={uint8:rc,rgba4:zf,rgb565:Ep,"rgb5 a1":tv},qn={alpha:Eu,luminance:Ya,"luminance alpha":Jl,rgb:Ws,rgba:Wa,rgba4:$c,"rgb5 a1":tc,rgb565:rd},ri={};Re.ext_srgb&&(qn.srgb=Kc,qn.srgba=Vf),Re.oes_texture_float&&(yi.float32=yi.float=Hf),Re.oes_texture_half_float&&(yi.float16=yi["half float"]=fh),Re.webgl_depth_texture&&(k(qn,{depth:qc,"depth stencil":Zf}),k(yi,{uint16:id,uint32:tf,"depth stencil":Uf})),Re.webgl_compressed_texture_s3tc&&k(ri,{"rgb s3tc dxt1":Qc,"rgba s3tc dxt1":Rl,"rgba s3tc dxt3":wp,"rgba s3tc dxt5":hh}),Re.webgl_compressed_texture_atc&&k(ri,{"rgb atc":Qu,"rgba atc explicit alpha":Jc,"rgba atc interpolated alpha":Zh}),Re.webgl_compressed_texture_pvrtc&&k(ri,{"rgb pvrtc 4bppv1":Gf,"rgb pvrtc 2bppv1":ec,"rgba pvrtc 4bppv1":Sp,"rgba pvrtc 2bppv1":nd}),Re.webgl_compressed_texture_etc1&&(ri["rgb etc1"]=Cp);var Zr=Array.prototype.slice.call(It.getParameter(Xr)||new Uint32Array(0));Object.keys(ri).forEach(function(sr){var fn=ri[sr];Zr.indexOf(fn)>=0&&(qn[sr]=fn)});var mn=Object.keys(qn);dr.textureFormats=mn;var jn=[];Object.keys(qn).forEach(function(sr){var fn=qn[sr];jn[fn]=sr});var gi=[];Object.keys(yi).forEach(function(sr){var fn=yi[sr];gi[fn]=sr});var Dn=[];Object.keys(Yn).forEach(function(sr){var fn=Yn[sr];Dn[fn]=sr});var ci=[];Object.keys(ni).forEach(function(sr){var fn=ni[sr];ci[fn]=sr});var Mi=[];Object.keys(Xn).forEach(function(sr){var fn=Xn[sr];Mi[fn]=sr});var la=mn.reduce(function(sr,fn){var rn=qn[fn];return rn===Ya||rn===Eu||rn===Ya||rn===Jl||rn===qc||rn===Zf||Re.ext_srgb&&(rn===Kc||rn===Vf)?sr[rn]=rn:rn===tc||fn.indexOf("rgba")>=0?sr[rn]=Wa:sr[rn]=Ws,sr},{});function wn(){this.internalformat=Wa,this.format=Wa,this.type=rc,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=dh,this.width=0,this.height=0,this.channels=0}function In(sr,fn){sr.internalformat=fn.internalformat,sr.format=fn.format,sr.type=fn.type,sr.compressed=fn.compressed,sr.premultiplyAlpha=fn.premultiplyAlpha,sr.flipY=fn.flipY,sr.unpackAlignment=fn.unpackAlignment,sr.colorSpace=fn.colorSpace,sr.width=fn.width,sr.height=fn.height,sr.channels=fn.channels}function Wi(sr,fn){if(!(typeof fn!="object"||!fn)){if("premultiplyAlpha"in fn&&(tt.type(fn.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),sr.premultiplyAlpha=fn.premultiplyAlpha),"flipY"in fn&&(tt.type(fn.flipY,"boolean","invalid texture flip"),sr.flipY=fn.flipY),"alignment"in fn&&(tt.oneOf(fn.alignment,[1,2,4,8],"invalid texture unpack alignment"),sr.unpackAlignment=fn.alignment),"colorSpace"in fn&&(tt.parameter(fn.colorSpace,Jn,"invalid colorSpace"),sr.colorSpace=Jn[fn.colorSpace]),"type"in fn){var rn=fn.type;tt(Re.oes_texture_float||!(rn==="float"||rn==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),tt(Re.oes_texture_half_float||!(rn==="half float"||rn==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),tt(Re.webgl_depth_texture||!(rn==="uint16"||rn==="uint32"||rn==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),tt.parameter(rn,yi,"invalid texture type"),sr.type=yi[rn]}var Gi=sr.width,oo=sr.height,tr=sr.channels,Te=!1;"shape"in fn?(tt(Array.isArray(fn.shape)&&fn.shape.length>=2,"shape must be an array"),Gi=fn.shape[0],oo=fn.shape[1],fn.shape.length===3&&(tr=fn.shape[2],tt(tr>0&&tr<=4,"invalid number of channels"),Te=!0),tt(Gi>=0&&Gi<=dr.maxTextureSize,"invalid width"),tt(oo>=0&&oo<=dr.maxTextureSize,"invalid height")):("radius"in fn&&(Gi=oo=fn.radius,tt(Gi>=0&&Gi<=dr.maxTextureSize,"invalid radius")),"width"in fn&&(Gi=fn.width,tt(Gi>=0&&Gi<=dr.maxTextureSize,"invalid width")),"height"in fn&&(oo=fn.height,tt(oo>=0&&oo<=dr.maxTextureSize,"invalid height")),"channels"in fn&&(tr=fn.channels,tt(tr>0&&tr<=4,"invalid number of channels"),Te=!0)),sr.width=Gi|0,sr.height=oo|0,sr.channels=tr|0;var xr=!1;if("format"in fn){var kr=fn.format;tt(Re.webgl_depth_texture||!(kr==="depth"||kr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),tt.parameter(kr,qn,"invalid texture format");var $r=sr.internalformat=qn[kr];sr.format=la[$r],kr in yi&&("type"in fn||(sr.type=yi[kr])),kr in ri&&(sr.compressed=!0),xr=!0}!Te&&xr?sr.channels=_s[sr.format]:Te&&!xr?sr.channels!==ji[sr.format]&&(sr.format=sr.internalformat=ji[sr.channels]):xr&&Te&&tt(sr.channels===_s[sr.format],"number of channels inconsistent with specified format")}}function bi(sr){It.pixelStorei(ef,sr.flipY),It.pixelStorei(_f,sr.premultiplyAlpha),It.pixelStorei(tu,sr.colorSpace),It.pixelStorei(Wf,sr.unpackAlignment)}function Qn(){wn.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function pi(sr,fn){var rn=null;if(to(fn)?rn=fn:fn&&(tt.type(fn,"object","invalid pixel data type"),Wi(sr,fn),"x"in fn&&(sr.xOffset=fn.x|0),"y"in fn&&(sr.yOffset=fn.y|0),to(fn.data)&&(rn=fn.data)),tt(!sr.compressed||rn instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),fn.copy){tt(!rn,"can not specify copy and data field for the same texture");var Gi=Ln.viewportWidth,oo=Ln.viewportHeight;sr.width=sr.width||Gi-sr.xOffset,sr.height=sr.height||oo-sr.yOffset,sr.needsCopy=!0,tt(sr.xOffset>=0&&sr.xOffset<Gi&&sr.yOffset>=0&&sr.yOffset<oo&&sr.width>0&&sr.width<=Gi&&sr.height>0&&sr.height<=oo,"copy texture read out of bounds")}else if(!rn)sr.width=sr.width||1,sr.height=sr.height||1,sr.channels=sr.channels||4;else if(mt(rn))sr.channels=sr.channels||4,sr.data=rn,!("type"in fn)&&sr.type===rc&&(sr.type=mo(rn));else if(wu(rn))sr.channels=sr.channels||4,ic(sr,rn),sr.alignment=1,sr.needsFree=!0;else if($u(rn)){var tr=rn.data;!Array.isArray(tr)&&sr.type===rc&&(sr.type=mo(tr));var Te=rn.shape,xr=rn.stride,kr,$r,Ar,Ye,Rr,je;Te.length===3?(Ar=Te[2],je=xr[2]):(tt(Te.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Ar=1,je=1),kr=Te[0],$r=Te[1],Ye=xr[0],Rr=xr[1],sr.alignment=1,sr.width=kr,sr.height=$r,sr.channels=Ar,sr.format=sr.internalformat=ji[Ar],sr.needsFree=!0,nf(sr,tr,Ye,Rr,je,rn.offset)}else if(nc(rn)||eu(rn)||nl(rn)||Kv(rn))nc(rn)||eu(rn)||nl(rn)?sr.element=rn:sr.element=rn.canvas,sr.width=sr.element.width,sr.height=sr.element.height,sr.channels=4;else if(Vh(rn))sr.element=rn,sr.width=rn.width,sr.height=rn.height,sr.channels=4;else if(bf(rn))sr.element=rn,sr.width=rn.naturalWidth,sr.height=rn.naturalHeight,sr.channels=4;else if(dl(rn))sr.element=rn,sr.width=rn.width,sr.height=rn.height,sr.channels=4;else if(ev(rn))sr.element=rn,sr.width=rn.videoWidth,sr.height=rn.videoHeight,sr.channels=4;else if(xf(rn)){var mr=sr.width||rn[0].length,rr=sr.height||rn.length,Mr=sr.channels;or(rn[0][0])?Mr=Mr||rn[0][0].length:Mr=Mr||1;for(var qr=Xe.shape(rn),Bn=1,ti=0;ti<qr.length;++ti)Bn*=qr[ti];var li=Xs(sr,Bn);Xe.flatten(rn,qr,"",li),Yf(sr,li),sr.alignment=1,sr.width=mr,sr.height=rr,sr.channels=Mr,sr.format=sr.internalformat=ji[Mr],sr.needsFree=!0}sr.type===Hf?tt(dr.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):sr.type===fh&&tt(dr.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function hi(sr,fn,rn){var Gi=sr.element,oo=sr.data,tr=sr.internalformat,Te=sr.format,xr=sr.type,kr=sr.width,$r=sr.height;bi(sr),Gi?It.texImage2D(fn,rn,Te,Te,xr,Gi):sr.compressed?It.compressedTexImage2D(fn,rn,tr,kr,$r,0,oo):sr.needsCopy?(ln(),It.copyTexImage2D(fn,rn,Te,sr.xOffset,sr.yOffset,kr,$r,0)):It.texImage2D(fn,rn,Te,kr,$r,0,Te,xr,oo||null)}function Na(sr,fn,rn,Gi,oo){var tr=sr.element,Te=sr.data,xr=sr.internalformat,kr=sr.format,$r=sr.type,Ar=sr.width,Ye=sr.height;bi(sr),tr?It.texSubImage2D(fn,oo,rn,Gi,kr,$r,tr):sr.compressed?It.compressedTexSubImage2D(fn,oo,rn,Gi,xr,Ar,Ye,Te):sr.needsCopy?(ln(),It.copyTexSubImage2D(fn,oo,rn,Gi,sr.xOffset,sr.yOffset,Ar,Ye)):It.texSubImage2D(fn,oo,rn,Gi,Ar,Ye,kr,$r,Te)}var wa=[];function Ei(){return wa.pop()||new Qn}function Li(sr){sr.needsFree&&Qr.freeType(sr.data),Qn.call(sr),wa.push(sr)}function ga(){wn.call(this),this.genMipmaps=!1,this.mipmapHint=Bl,this.mipmask=0,this.images=Array(16)}function Ta(sr,fn,rn){var Gi=sr.images[0]=Ei();sr.mipmask=1,Gi.width=sr.width=fn,Gi.height=sr.height=rn,Gi.channels=sr.channels=4}function no(sr,fn){var rn=null;if(to(fn))rn=sr.images[0]=Ei(),In(rn,sr),pi(rn,fn),sr.mipmask=1;else if(Wi(sr,fn),Array.isArray(fn.mipmap))for(var Gi=fn.mipmap,oo=0;oo<Gi.length;++oo)rn=sr.images[oo]=Ei(),In(rn,sr),rn.width>>=oo,rn.height>>=oo,pi(rn,Gi[oo]),sr.mipmask|=1<<oo;else rn=sr.images[0]=Ei(),In(rn,sr),pi(rn,fn),sr.mipmask=1;In(sr,sr.images[0]),sr.compressed&&(sr.internalformat===Qc||sr.internalformat===Rl||sr.internalformat===wp||sr.internalformat===hh)&&tt(sr.width%4===0&&sr.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ws(sr,fn){for(var rn=sr.images,Gi=0;Gi<rn.length;++Gi){if(!rn[Gi])return;hi(rn[Gi],fn,Gi)}}var Ss=[];function io(){var sr=Ss.pop()||new ga;wn.call(sr),sr.mipmask=0;for(var fn=0;fn<16;++fn)sr.images[fn]=null;return sr}function Bo(sr){for(var fn=sr.images,rn=0;rn<fn.length;++rn)fn[rn]&&Li(fn[rn]),fn[rn]=null;Ss.push(sr)}function Es(){this.minFilter=yf,this.magFilter=yf,this.wrapS=mf,this.wrapT=mf,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Bl}function du(sr,fn){if("min"in fn){var rn=fn.min;tt.parameter(rn,ni),sr.minFilter=ni[rn],Fs.indexOf(sr.minFilter)>=0&&!("faces"in fn)&&(sr.genMipmaps=!0)}if("mag"in fn){var Gi=fn.mag;tt.parameter(Gi,Yn),sr.magFilter=Yn[Gi]}var oo=sr.wrapS,tr=sr.wrapT;if("wrap"in fn){var Te=fn.wrap;typeof Te=="string"?(tt.parameter(Te,Xn),oo=tr=Xn[Te]):Array.isArray(Te)&&(tt.parameter(Te[0],Xn),tt.parameter(Te[1],Xn),oo=Xn[Te[0]],tr=Xn[Te[1]])}else{if("wrapS"in fn){var xr=fn.wrapS;tt.parameter(xr,Xn),oo=Xn[xr]}if("wrapT"in fn){var kr=fn.wrapT;tt.parameter(kr,Xn),tr=Xn[kr]}}if(sr.wrapS=oo,sr.wrapT=tr,"anisotropic"in fn){var $r=fn.anisotropic;tt(typeof $r=="number"&&$r>=1&&$r<=dr.maxAnisotropic,"aniso samples must be between 1 and "),sr.anisotropic=fn.anisotropic}if("mipmap"in fn){var Ar=!1;switch(typeof fn.mipmap){case"string":tt.parameter(fn.mipmap,jr,"invalid mipmap hint"),sr.mipmapHint=jr[fn.mipmap],sr.genMipmaps=!0,Ar=!0;break;case"boolean":Ar=sr.genMipmaps=fn.mipmap;break;case"object":tt(Array.isArray(fn.mipmap),"invalid mipmap type"),sr.genMipmaps=!1,Ar=!0;break;default:tt.raise("invalid mipmap type")}Ar&&!("min"in fn)&&(sr.minFilter=Dl)}}function Qo(sr,fn){It.texParameteri(fn,gs,sr.minFilter),It.texParameteri(fn,ph,sr.magFilter),It.texParameteri(fn,gf,sr.wrapS),It.texParameteri(fn,ad,sr.wrapT),Re.ext_texture_filter_anisotropic&&It.texParameteri(fn,Ia,sr.anisotropic),sr.genMipmaps&&(It.hint(Ap,sr.mipmapHint),It.generateMipmap(fn))}var Lu=0,Vs={},Gu=dr.maxTextureUnits,ks=Array(Gu).map(function(){return null});function Da(sr){wn.call(this),this.mipmask=0,this.internalformat=Wa,this.id=Lu++,this.refCount=1,this.target=sr,this.texture=It.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Es,En.profile&&(this.stats={size:0})}function $s(sr){It.activeTexture(vh),It.bindTexture(sr.target,sr.texture)}function bo(){var sr=ks[0];sr?It.bindTexture(sr.target,sr.texture):It.bindTexture(xn,null)}function Pu(sr){var fn=sr.texture;tt(fn,"must not double destroy texture");var rn=sr.unit,Gi=sr.target;rn>=0&&(It.activeTexture(vh+rn),It.bindTexture(Gi,null),ks[rn]=null),It.deleteTexture(fn),sr.texture=null,sr.params=null,sr.pixels=null,sr.refCount=0,delete Vs[sr.id],on.textureCount--}k(Da.prototype,{bind:function(){var sr=this;sr.bindCount+=1;var fn=sr.unit;if(fn<0){for(var rn=0;rn<Gu;++rn){var Gi=ks[rn];if(Gi){if(Gi.bindCount>0)continue;Gi.unit=-1}ks[rn]=sr,fn=rn;break}fn>=Gu&&tt.raise("insufficient number of texture units"),En.profile&&on.maxTextureUnits<fn+1&&(on.maxTextureUnits=fn+1),sr.unit=fn,It.activeTexture(vh+fn),It.bindTexture(sr.target,sr.texture)}return fn},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Pu(this)}});function ha(sr,fn){var rn=new Da(xn);Vs[rn.id]=rn,on.textureCount++;function Gi(Te,xr){var kr=rn.texInfo;Es.call(kr);var $r=io();return typeof Te=="number"?typeof xr=="number"?Ta($r,Te|0,xr|0):Ta($r,Te|0,Te|0):Te?(tt.type(Te,"object","invalid arguments to regl.texture"),du(kr,Te),no($r,Te)):Ta($r,1,1),kr.genMipmaps&&($r.mipmask=($r.width<<1)-1),rn.mipmask=$r.mipmask,In(rn,$r),tt.texture2D(kr,$r,dr),rn.internalformat=$r.internalformat,Gi.width=$r.width,Gi.height=$r.height,$s(rn),ws($r,xn),Qo(kr,xn),bo(),Bo($r),En.profile&&(rn.stats.size=Su(rn.internalformat,rn.type,$r.width,$r.height,kr.genMipmaps,!1)),Gi.format=jn[rn.internalformat],Gi.type=gi[rn.type],Gi.mag=Dn[kr.magFilter],Gi.min=ci[kr.minFilter],Gi.wrapS=Mi[kr.wrapS],Gi.wrapT=Mi[kr.wrapT],Gi}function oo(Te,xr,kr,$r){tt(!!Te,"must specify image data");var Ar=xr|0,Ye=kr|0,Rr=$r|0,je=Ei();return In(je,rn),je.width=0,je.height=0,pi(je,Te),je.width=je.width||(rn.width>>Rr)-Ar,je.height=je.height||(rn.height>>Rr)-Ye,tt(rn.type===je.type&&rn.format===je.format&&rn.internalformat===je.internalformat,"incompatible format for texture.subimage"),tt(Ar>=0&&Ye>=0&&Ar+je.width<=rn.width&&Ye+je.height<=rn.height,"texture.subimage write out of bounds"),tt(rn.mipmask&1<<Rr,"missing mipmap data"),tt(je.data||je.element||je.needsCopy,"missing image data"),$s(rn),Na(je,xn,Ar,Ye,Rr),bo(),Li(je),Gi}function tr(Te,xr){var kr=Te|0,$r=xr|0||kr;if(kr===rn.width&&$r===rn.height)return Gi;Gi.width=rn.width=kr,Gi.height=rn.height=$r,$s(rn);for(var Ar=0;rn.mipmask>>Ar;++Ar){var Ye=kr>>Ar,Rr=$r>>Ar;if(!Ye||!Rr)break;It.texImage2D(xn,Ar,rn.format,Ye,Rr,0,rn.format,rn.type,null)}return bo(),En.profile&&(rn.stats.size=Su(rn.internalformat,rn.type,kr,$r,!1,!1)),Gi}return Gi(sr,fn),Gi.subimage=oo,Gi.resize=tr,Gi._reglType="texture2d",Gi._texture=rn,En.profile&&(Gi.stats=rn.stats),Gi.destroy=function(){rn.decRef()},Gi}function ao(sr,fn,rn,Gi,oo,tr){var Te=new Da(Ii);Vs[Te.id]=Te,on.cubeCount++;var xr=new Array(6);function kr(Ye,Rr,je,mr,rr,Mr){var qr,Bn=Te.texInfo;for(Es.call(Bn),qr=0;qr<6;++qr)xr[qr]=io();if(typeof Ye=="number"||!Ye){var ti=Ye|0||1;for(qr=0;qr<6;++qr)Ta(xr[qr],ti,ti)}else if(typeof Ye=="object")if(Rr)no(xr[0],Ye),no(xr[1],Rr),no(xr[2],je),no(xr[3],mr),no(xr[4],rr),no(xr[5],Mr);else if(du(Bn,Ye),Wi(Te,Ye),"faces"in Ye){var li=Ye.faces;for(tt(Array.isArray(li)&&li.length===6,"cube faces must be a length 6 array"),qr=0;qr<6;++qr)tt(typeof li[qr]=="object"&&!!li[qr],"invalid input for cube map face"),In(xr[qr],Te),no(xr[qr],li[qr])}else for(qr=0;qr<6;++qr)no(xr[qr],Ye);else tt.raise("invalid arguments to cube map");for(In(Te,xr[0]),tt.optional(function(){dr.npotTextureCube||tt(Fr(Te.width)&&Fr(Te.height),"your browser does not support non power or two texture dimensions")}),Bn.genMipmaps?Te.mipmask=(xr[0].width<<1)-1:Te.mipmask=xr[0].mipmask,tt.textureCube(Te,Bn,xr,dr),Te.internalformat=xr[0].internalformat,kr.width=xr[0].width,kr.height=xr[0].height,$s(Te),qr=0;qr<6;++qr)ws(xr[qr],ra+qr);for(Qo(Bn,Ii),bo(),En.profile&&(Te.stats.size=Su(Te.internalformat,Te.type,kr.width,kr.height,Bn.genMipmaps,!0)),kr.format=jn[Te.internalformat],kr.type=gi[Te.type],kr.mag=Dn[Bn.magFilter],kr.min=ci[Bn.minFilter],kr.wrapS=Mi[Bn.wrapS],kr.wrapT=Mi[Bn.wrapT],qr=0;qr<6;++qr)Bo(xr[qr]);return kr}function $r(Ye,Rr,je,mr,rr){tt(!!Rr,"must specify image data"),tt(typeof Ye=="number"&&Ye===(Ye|0)&&Ye>=0&&Ye<6,"invalid face");var Mr=je|0,qr=mr|0,Bn=rr|0,ti=Ei();return In(ti,Te),ti.width=0,ti.height=0,pi(ti,Rr),ti.width=ti.width||(Te.width>>Bn)-Mr,ti.height=ti.height||(Te.height>>Bn)-qr,tt(Te.type===ti.type&&Te.format===ti.format&&Te.internalformat===ti.internalformat,"incompatible format for texture.subimage"),tt(Mr>=0&&qr>=0&&Mr+ti.width<=Te.width&&qr+ti.height<=Te.height,"texture.subimage write out of bounds"),tt(Te.mipmask&1<<Bn,"missing mipmap data"),tt(ti.data||ti.element||ti.needsCopy,"missing image data"),$s(Te),Na(ti,ra+Ye,Mr,qr,Bn),bo(),Li(ti),kr}function Ar(Ye){var Rr=Ye|0;if(Rr!==Te.width){kr.width=Te.width=Rr,kr.height=Te.height=Rr,$s(Te);for(var je=0;je<6;++je)for(var mr=0;Te.mipmask>>mr;++mr)It.texImage2D(ra+je,mr,Te.format,Rr>>mr,Rr>>mr,0,Te.format,Te.type,null);return bo(),En.profile&&(Te.stats.size=Su(Te.internalformat,Te.type,kr.width,kr.height,!1,!0)),kr}}return kr(sr,fn,rn,Gi,oo,tr),kr.subimage=$r,kr.resize=Ar,kr._reglType="textureCube",kr._texture=Te,En.profile&&(kr.stats=Te.stats),kr.destroy=function(){Te.decRef()},kr}function wo(){for(var sr=0;sr<Gu;++sr)It.activeTexture(vh+sr),It.bindTexture(xn,null),ks[sr]=null;Ae(Vs).forEach(Pu),on.cubeCount=0,on.textureCount=0}En.profile&&(on.getTotalTextureSize=function(){var sr=0;return Object.keys(Vs).forEach(function(fn){sr+=Vs[fn].stats.size}),sr});function Ds(){for(var sr=0;sr<Gu;++sr){var fn=ks[sr];fn&&(fn.bindCount=0,fn.unit=-1,ks[sr]=null)}Ae(Vs).forEach(function(rn){rn.texture=It.createTexture(),It.bindTexture(rn.target,rn.texture);for(var Gi=0;Gi<32;++Gi)if(rn.mipmask&1<<Gi)if(rn.target===xn)It.texImage2D(xn,Gi,rn.internalformat,rn.width>>Gi,rn.height>>Gi,0,rn.internalformat,rn.type,null);else for(var oo=0;oo<6;++oo)It.texImage2D(ra+oo,Gi,rn.internalformat,rn.width>>Gi,rn.height>>Gi,0,rn.internalformat,rn.type,null);Qo(rn.texInfo,rn.target)})}function Wl(){for(var sr=0;sr<Gu;++sr){var fn=ks[sr];fn&&(fn.bindCount=0,fn.unit=-1,ks[sr]=null),It.activeTexture(vh+sr),It.bindTexture(xn,null),It.bindTexture(Ii,null)}}return{create2D:ha,createCube:ao,clear:wo,getTexture:function(sr){return null},restore:Ds,refresh:Wl}}var Sl=36161,Qi=32854,ki=32855,Ef=36194,Ju=33189,Cu=36168,Vu=34041,gc=35907,ud=34836,zl=34842,Do=34843,rs=[];rs[Qi]=2,rs[ki]=2,rs[Ef]=2,rs[Ju]=2,rs[Cu]=1,rs[Vu]=4,rs[gc]=4,rs[ud]=16,rs[zl]=8,rs[Do]=6;function ld(It,Re,dr){return rs[It]*Re*dr}var $f=function(It,Re,dr,ln,Ln){var on={rgba4:Qi,rgb565:Ef,"rgb5 a1":ki,depth:Ju,stencil:Cu,"depth stencil":Vu};Re.ext_srgb&&(on.srgba=gc),Re.ext_color_buffer_half_float&&(on.rgba16f=zl,on.rgb16f=Do),Re.webgl_color_buffer_float&&(on.rgba32f=ud);var En=[];Object.keys(on).forEach(function(qn){var ri=on[qn];En[ri]=qn});var jr=0,Xn={};function Yn(qn){this.id=jr++,this.refCount=1,this.renderbuffer=qn,this.format=Qi,this.width=0,this.height=0,Ln.profile&&(this.stats={size:0})}Yn.prototype.decRef=function(){--this.refCount<=0&&ni(this)};function ni(qn){var ri=qn.renderbuffer;tt(ri,"must not double destroy renderbuffer"),It.bindRenderbuffer(Sl,null),It.deleteRenderbuffer(ri),qn.renderbuffer=null,qn.refCount=0,delete Xn[qn.id],ln.renderbufferCount--}function Jn(qn,ri){var Zr=new Yn(It.createRenderbuffer());Xn[Zr.id]=Zr,ln.renderbufferCount++;function mn(gi,Dn){var ci=0,Mi=0,la=Qi;if(typeof gi=="object"&&gi){var wn=gi;if("shape"in wn){var In=wn.shape;tt(Array.isArray(In)&&In.length>=2,"invalid renderbuffer shape"),ci=In[0]|0,Mi=In[1]|0}else"radius"in wn&&(ci=Mi=wn.radius|0),"width"in wn&&(ci=wn.width|0),"height"in wn&&(Mi=wn.height|0);"format"in wn&&(tt.parameter(wn.format,on,"invalid renderbuffer format"),la=on[wn.format])}else typeof gi=="number"?(ci=gi|0,typeof Dn=="number"?Mi=Dn|0:Mi=ci):gi?tt.raise("invalid arguments to renderbuffer constructor"):ci=Mi=1;if(tt(ci>0&&Mi>0&&ci<=dr.maxRenderbufferSize&&Mi<=dr.maxRenderbufferSize,"invalid renderbuffer size"),!(ci===Zr.width&&Mi===Zr.height&&la===Zr.format))return mn.width=Zr.width=ci,mn.height=Zr.height=Mi,Zr.format=la,It.bindRenderbuffer(Sl,Zr.renderbuffer),It.renderbufferStorage(Sl,la,ci,Mi),tt(It.getError()===0,"invalid render buffer format"),Ln.profile&&(Zr.stats.size=ld(Zr.format,Zr.width,Zr.height)),mn.format=En[Zr.format],mn}function jn(gi,Dn){var ci=gi|0,Mi=Dn|0||ci;return ci===Zr.width&&Mi===Zr.height||(tt(ci>0&&Mi>0&&ci<=dr.maxRenderbufferSize&&Mi<=dr.maxRenderbufferSize,"invalid renderbuffer size"),mn.width=Zr.width=ci,mn.height=Zr.height=Mi,It.bindRenderbuffer(Sl,Zr.renderbuffer),It.renderbufferStorage(Sl,Zr.format,ci,Mi),tt(It.getError()===0,"invalid render buffer format"),Ln.profile&&(Zr.stats.size=ld(Zr.format,Zr.width,Zr.height))),mn}return mn(qn,ri),mn.resize=jn,mn._reglType="renderbuffer",mn._renderbuffer=Zr,Ln.profile&&(mn.stats=Zr.stats),mn.destroy=function(){Zr.decRef()},mn}Ln.profile&&(ln.getTotalRenderbufferSize=function(){var qn=0;return Object.keys(Xn).forEach(function(ri){qn+=Xn[ri].stats.size}),qn});function yi(){Ae(Xn).forEach(function(qn){qn.renderbuffer=It.createRenderbuffer(),It.bindRenderbuffer(Sl,qn.renderbuffer),It.renderbufferStorage(Sl,qn.format,qn.width,qn.height)}),It.bindRenderbuffer(Sl,null)}return{create:Jn,clear:function(){Ae(Xn).forEach(ni)},restore:yi}},Cl=36160,il=36161,va=3553,Ul=34069,vl=36064,wf=36096,ac=36128,Lc=33306,Zl=36053,mh=36054,qf=36055,cd=36057,Sf=36061,Cf=36193,Mp=5121,Af=5126,Al=6407,Gh=6408,Hh=6402,Ip=[Al,Gh],oc=[];oc[Gh]=4,oc[Al]=3;var x=[];x[Mp]=1,x[Af]=4,x[Cf]=2;var C=32854,E=32855,M=36194,U=33189,H=36168,$=34041,ht=35907,Ut=34836,ie=34842,Be=34843,De=[C,E,M,ht,ie,Be,Ut],Ne={};Ne[Zl]="complete",Ne[mh]="incomplete attachment",Ne[cd]="incomplete dimensions",Ne[qf]="incomplete, missing attachment",Ne[Sf]="unsupported";function fr(It,Re,dr,ln,Ln,on){var En={cur:null,next:null,dirty:!1,setFBO:null},jr=["rgba"],Xn=["rgba4","rgb565","rgb5 a1"];Re.ext_srgb&&Xn.push("srgba"),Re.ext_color_buffer_half_float&&Xn.push("rgba16f","rgb16f"),Re.webgl_color_buffer_float&&Xn.push("rgba32f");var Yn=["uint8"];Re.oes_texture_half_float&&Yn.push("half float","float16"),Re.oes_texture_float&&Yn.push("float","float32");function ni(Qn,pi,hi){this.target=Qn,this.texture=pi,this.renderbuffer=hi;var Na=0,wa=0;pi?(Na=pi.width,wa=pi.height):hi&&(Na=hi.width,wa=hi.height),this.width=Na,this.height=wa}function Jn(Qn){Qn&&(Qn.texture&&Qn.texture._texture.decRef(),Qn.renderbuffer&&Qn.renderbuffer._renderbuffer.decRef())}function yi(Qn,pi,hi){if(Qn)if(Qn.texture){var Na=Qn.texture._texture,wa=Math.max(1,Na.width),Ei=Math.max(1,Na.height);tt(wa===pi&&Ei===hi,"inconsistent width/height for supplied texture"),Na.refCount+=1}else{var Li=Qn.renderbuffer._renderbuffer;tt(Li.width===pi&&Li.height===hi,"inconsistent width/height for renderbuffer"),Li.refCount+=1}}function qn(Qn,pi){pi&&(pi.texture?It.framebufferTexture2D(Cl,Qn,pi.target,pi.texture._texture.texture,0):It.framebufferRenderbuffer(Cl,Qn,il,pi.renderbuffer._renderbuffer.renderbuffer))}function ri(Qn){var pi=va,hi=null,Na=null,wa=Qn;typeof Qn=="object"&&(wa=Qn.data,"target"in Qn&&(pi=Qn.target|0)),tt.type(wa,"function","invalid attachment data");var Ei=wa._reglType;return Ei==="texture2d"?(hi=wa,tt(pi===va)):Ei==="textureCube"?(hi=wa,tt(pi>=Ul&&pi<Ul+6,"invalid cube map target")):Ei==="renderbuffer"?(Na=wa,pi=il):tt.raise("invalid regl object for attachment"),new ni(pi,hi,Na)}function Zr(Qn,pi,hi,Na,wa){if(hi){var Ei=ln.create2D({width:Qn,height:pi,format:Na,type:wa});return Ei._texture.refCount=0,new ni(va,Ei,null)}else{var Li=Ln.create({width:Qn,height:pi,format:Na});return Li._renderbuffer.refCount=0,new ni(il,null,Li)}}function mn(Qn){return Qn&&(Qn.texture||Qn.renderbuffer)}function jn(Qn,pi,hi){Qn&&(Qn.texture?Qn.texture.resize(pi,hi):Qn.renderbuffer&&Qn.renderbuffer.resize(pi,hi),Qn.width=pi,Qn.height=hi)}var gi=0,Dn={};function ci(){this.id=gi++,Dn[this.id]=this,this.framebuffer=It.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Mi(Qn){Qn.colorAttachments.forEach(Jn),Jn(Qn.depthAttachment),Jn(Qn.stencilAttachment),Jn(Qn.depthStencilAttachment)}function la(Qn){var pi=Qn.framebuffer;tt(pi,"must not double destroy framebuffer"),It.deleteFramebuffer(pi),Qn.framebuffer=null,on.framebufferCount--,delete Dn[Qn.id]}function wn(Qn){var pi;It.bindFramebuffer(Cl,Qn.framebuffer);var hi=Qn.colorAttachments;for(pi=0;pi<hi.length;++pi)qn(vl+pi,hi[pi]);for(pi=hi.length;pi<dr.maxColorAttachments;++pi)It.framebufferTexture2D(Cl,vl+pi,va,null,0);It.framebufferTexture2D(Cl,Lc,va,null,0),It.framebufferTexture2D(Cl,wf,va,null,0),It.framebufferTexture2D(Cl,ac,va,null,0),qn(wf,Qn.depthAttachment),qn(ac,Qn.stencilAttachment),qn(Lc,Qn.depthStencilAttachment);var Na=It.checkFramebufferStatus(Cl);!It.isContextLost()&&Na!==Zl&&tt.raise("framebuffer configuration not supported, status = "+Ne[Na]),It.bindFramebuffer(Cl,En.next?En.next.framebuffer:null),En.cur=En.next,It.getError()}function In(Qn,pi){var hi=new ci;on.framebufferCount++;function Na(Ei,Li){var ga;tt(En.next!==hi,"can not update framebuffer which is currently in use");var Ta=0,no=0,ws=!0,Ss=!0,io=null,Bo=!0,Es="rgba",du="uint8",Qo=1,Lu=null,Vs=null,Gu=null,ks=!1;if(typeof Ei=="number")Ta=Ei|0,no=Li|0||Ta;else if(!Ei)Ta=no=1;else{tt.type(Ei,"object","invalid arguments for framebuffer");var Da=Ei;if("shape"in Da){var $s=Da.shape;tt(Array.isArray($s)&&$s.length>=2,"invalid shape for framebuffer"),Ta=$s[0],no=$s[1]}else"radius"in Da&&(Ta=no=Da.radius),"width"in Da&&(Ta=Da.width),"height"in Da&&(no=Da.height);("color"in Da||"colors"in Da)&&(io=Da.color||Da.colors,Array.isArray(io)&&tt(io.length===1||Re.webgl_draw_buffers,"multiple render targets not supported")),io||("colorCount"in Da&&(Qo=Da.colorCount|0,tt(Qo>0,"invalid color buffer count")),"colorTexture"in Da&&(Bo=!!Da.colorTexture,Es="rgba4"),"colorType"in Da&&(du=Da.colorType,Bo?(tt(Re.oes_texture_float||!(du==="float"||du==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),tt(Re.oes_texture_half_float||!(du==="half float"||du==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):du==="half float"||du==="float16"?(tt(Re.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Es="rgba16f"):(du==="float"||du==="float32")&&(tt(Re.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Es="rgba32f"),tt.oneOf(du,Yn,"invalid color type")),"colorFormat"in Da&&(Es=Da.colorFormat,jr.indexOf(Es)>=0?Bo=!0:Xn.indexOf(Es)>=0?Bo=!1:tt.optional(function(){Bo?tt.oneOf(Da.colorFormat,jr,"invalid color format for texture"):tt.oneOf(Da.colorFormat,Xn,"invalid color format for renderbuffer")}))),("depthTexture"in Da||"depthStencilTexture"in Da)&&(ks=!!(Da.depthTexture||Da.depthStencilTexture),tt(!ks||Re.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Da&&(typeof Da.depth=="boolean"?ws=Da.depth:(Lu=Da.depth,Ss=!1)),"stencil"in Da&&(typeof Da.stencil=="boolean"?Ss=Da.stencil:(Vs=Da.stencil,ws=!1)),"depthStencil"in Da&&(typeof Da.depthStencil=="boolean"?ws=Ss=Da.depthStencil:(Gu=Da.depthStencil,ws=!1,Ss=!1))}var bo=null,Pu=null,ha=null,ao=null;if(Array.isArray(io))bo=io.map(ri);else if(io)bo=[ri(io)];else for(bo=new Array(Qo),ga=0;ga<Qo;++ga)bo[ga]=Zr(Ta,no,Bo,Es,du);tt(Re.webgl_draw_buffers||bo.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),tt(bo.length<=dr.maxColorAttachments,"too many color attachments, not supported"),Ta=Ta||bo[0].width,no=no||bo[0].height,Lu?Pu=ri(Lu):ws&&!Ss&&(Pu=Zr(Ta,no,ks,"depth","uint32")),Vs?ha=ri(Vs):Ss&&!ws&&(ha=Zr(Ta,no,!1,"stencil","uint8")),Gu?ao=ri(Gu):!Lu&&!Vs&&Ss&&ws&&(ao=Zr(Ta,no,ks,"depth stencil","depth stencil")),tt(!!Lu+!!Vs+!!Gu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var wo=null;for(ga=0;ga<bo.length;++ga)if(yi(bo[ga],Ta,no),tt(!bo[ga]||bo[ga].texture&&Ip.indexOf(bo[ga].texture._texture.format)>=0||bo[ga].renderbuffer&&De.indexOf(bo[ga].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+ga+" is invalid"),bo[ga]&&bo[ga].texture){var Ds=oc[bo[ga].texture._texture.format]*x[bo[ga].texture._texture.type];wo===null?wo=Ds:tt(wo===Ds,"all color attachments much have the same number of bits per pixel.")}return yi(Pu,Ta,no),tt(!Pu||Pu.texture&&Pu.texture._texture.format===Hh||Pu.renderbuffer&&Pu.renderbuffer._renderbuffer.format===U,"invalid depth attachment for framebuffer object"),yi(ha,Ta,no),tt(!ha||ha.renderbuffer&&ha.renderbuffer._renderbuffer.format===H,"invalid stencil attachment for framebuffer object"),yi(ao,Ta,no),tt(!ao||ao.texture&&ao.texture._texture.format===$||ao.renderbuffer&&ao.renderbuffer._renderbuffer.format===$,"invalid depth-stencil attachment for framebuffer object"),Mi(hi),hi.width=Ta,hi.height=no,hi.colorAttachments=bo,hi.depthAttachment=Pu,hi.stencilAttachment=ha,hi.depthStencilAttachment=ao,Na.color=bo.map(mn),Na.depth=mn(Pu),Na.stencil=mn(ha),Na.depthStencil=mn(ao),Na.width=hi.width,Na.height=hi.height,wn(hi),Na}function wa(Ei,Li){tt(En.next!==hi,"can not resize a framebuffer which is currently in use");var ga=Math.max(Ei|0,1),Ta=Math.max(Li|0||ga,1);if(ga===hi.width&&Ta===hi.height)return Na;for(var no=hi.colorAttachments,ws=0;ws<no.length;++ws)jn(no[ws],ga,Ta);return jn(hi.depthAttachment,ga,Ta),jn(hi.stencilAttachment,ga,Ta),jn(hi.depthStencilAttachment,ga,Ta),hi.width=Na.width=ga,hi.height=Na.height=Ta,wn(hi),Na}return Na(Qn,pi),k(Na,{resize:wa,_reglType:"framebuffer",_framebuffer:hi,destroy:function(){la(hi),Mi(hi)},use:function(Ei){En.setFBO({framebuffer:Na},Ei)}})}function Wi(Qn){var pi=Array(6);function hi(wa){var Ei;tt(pi.indexOf(En.next)<0,"can not update framebuffer which is currently in use");var Li={color:null},ga=0,Ta=null,no="rgba",ws="uint8",Ss=1;if(typeof wa=="number")ga=wa|0;else if(!wa)ga=1;else{tt.type(wa,"object","invalid arguments for framebuffer");var io=wa;if("shape"in io){var Bo=io.shape;tt(Array.isArray(Bo)&&Bo.length>=2,"invalid shape for framebuffer"),tt(Bo[0]===Bo[1],"cube framebuffer must be square"),ga=Bo[0]}else"radius"in io&&(ga=io.radius|0),"width"in io?(ga=io.width|0,"height"in io&&tt(io.height===ga,"must be square")):"height"in io&&(ga=io.height|0);("color"in io||"colors"in io)&&(Ta=io.color||io.colors,Array.isArray(Ta)&&tt(Ta.length===1||Re.webgl_draw_buffers,"multiple render targets not supported")),Ta||("colorCount"in io&&(Ss=io.colorCount|0,tt(Ss>0,"invalid color buffer count")),"colorType"in io&&(tt.oneOf(io.colorType,Yn,"invalid color type"),ws=io.colorType),"colorFormat"in io&&(no=io.colorFormat,tt.oneOf(io.colorFormat,jr,"invalid color format for texture"))),"depth"in io&&(Li.depth=io.depth),"stencil"in io&&(Li.stencil=io.stencil),"depthStencil"in io&&(Li.depthStencil=io.depthStencil)}var Es;if(Ta)if(Array.isArray(Ta))for(Es=[],Ei=0;Ei<Ta.length;++Ei)Es[Ei]=Ta[Ei];else Es=[Ta];else{Es=Array(Ss);var du={radius:ga,format:no,type:ws};for(Ei=0;Ei<Ss;++Ei)Es[Ei]=ln.createCube(du)}for(Li.color=Array(Es.length),Ei=0;Ei<Es.length;++Ei){var Qo=Es[Ei];tt(typeof Qo=="function"&&Qo._reglType==="textureCube","invalid cube map"),ga=ga||Qo.width,tt(Qo.width===ga&&Qo.height===ga,"invalid cube map shape"),Li.color[Ei]={target:Ul,data:Es[Ei]}}for(Ei=0;Ei<6;++Ei){for(var Lu=0;Lu<Es.length;++Lu)Li.color[Lu].target=Ul+Ei;Ei>0&&(Li.depth=pi[0].depth,Li.stencil=pi[0].stencil,Li.depthStencil=pi[0].depthStencil),pi[Ei]?pi[Ei](Li):pi[Ei]=In(Li)}return k(hi,{width:ga,height:ga,color:Es})}function Na(wa){var Ei,Li=wa|0;if(tt(Li>0&&Li<=dr.maxCubeMapSize,"invalid radius for cube fbo"),Li===hi.width)return hi;var ga=hi.color;for(Ei=0;Ei<ga.length;++Ei)ga[Ei].resize(Li);for(Ei=0;Ei<6;++Ei)pi[Ei].resize(Li);return hi.width=hi.height=Li,hi}return hi(Qn),k(hi,{faces:pi,resize:Na,_reglType:"framebufferCube",destroy:function(){pi.forEach(function(wa){wa.destroy()})}})}function bi(){En.cur=null,En.next=null,En.dirty=!0,Ae(Dn).forEach(function(Qn){Qn.framebuffer=It.createFramebuffer(),wn(Qn)})}return k(En,{getFramebuffer:function(Qn){if(typeof Qn=="function"&&Qn._reglType==="framebuffer"){var pi=Qn._framebuffer;if(pi instanceof ci)return pi}return null},create:In,createCube:Wi,clear:function(){Ae(Dn).forEach(la)},restore:bi})}var $e=5126,_r=34962,er=34963,Er=["attributes","elements","offset","count","primitive","instances"];function Or(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=$e,this.offset=0,this.stride=0,this.divisor=0}function Yr(It,Re,dr,ln,Ln,on,En){for(var jr=dr.maxAttributes,Xn=new Array(jr),Yn=0;Yn<jr;++Yn)Xn[Yn]=new Or;var ni=0,Jn={},yi={Record:Or,scope:{},state:Xn,currentVAO:null,targetVAO:null,restore:ri()?Mi:function(){},createVAO:la,getVAO:mn,destroyBuffer:qn,setVAO:ri()?jn:gi,clear:ri()?Dn:function(){}};function qn(wn){for(var In=0;In<Xn.length;++In){var Wi=Xn[In];Wi.buffer===wn&&(It.disableVertexAttribArray(In),Wi.buffer=null)}}function ri(){return Re.oes_vertex_array_object}function Zr(){return Re.angle_instanced_arrays}function mn(wn){return typeof wn=="function"&&wn._vao?wn._vao:null}function jn(wn){if(wn!==yi.currentVAO){var In=ri();wn?In.bindVertexArrayOES(wn.vao):In.bindVertexArrayOES(null),yi.currentVAO=wn}}function gi(wn){if(wn!==yi.currentVAO){if(wn)wn.bindAttrs();else{for(var In=Zr(),Wi=0;Wi<Xn.length;++Wi){var bi=Xn[Wi];bi.buffer?(It.enableVertexAttribArray(Wi),bi.buffer.bind(),It.vertexAttribPointer(Wi,bi.size,bi.type,bi.normalized,bi.stride,bi.offfset),In&&bi.divisor&&In.vertexAttribDivisorANGLE(Wi,bi.divisor)):(It.disableVertexAttribArray(Wi),It.vertexAttrib4f(Wi,bi.x,bi.y,bi.z,bi.w))}En.elements?It.bindBuffer(er,En.elements.buffer.buffer):It.bindBuffer(er,null)}yi.currentVAO=wn}}function Dn(){Ae(Jn).forEach(function(wn){wn.destroy()})}function ci(){this.id=++ni,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var wn=ri();wn?this.vao=wn.createVertexArrayOES():this.vao=null,Jn[this.id]=this,this.buffers=[]}ci.prototype.bindAttrs=function(){for(var wn=Zr(),In=this.attributes,Wi=0;Wi<In.length;++Wi){var bi=In[Wi];bi.buffer?(It.enableVertexAttribArray(Wi),It.bindBuffer(_r,bi.buffer.buffer),It.vertexAttribPointer(Wi,bi.size,bi.type,bi.normalized,bi.stride,bi.offset),wn&&bi.divisor&&wn.vertexAttribDivisorANGLE(Wi,bi.divisor)):(It.disableVertexAttribArray(Wi),It.vertexAttrib4f(Wi,bi.x,bi.y,bi.z,bi.w))}for(var Qn=In.length;Qn<jr;++Qn)It.disableVertexAttribArray(Qn);var pi=on.getElements(this.elements);pi?It.bindBuffer(er,pi.buffer.buffer):It.bindBuffer(er,null)},ci.prototype.refresh=function(){var wn=ri();wn&&(wn.bindVertexArrayOES(this.vao),this.bindAttrs(),yi.currentVAO=null,wn.bindVertexArrayOES(null))},ci.prototype.destroy=function(){if(this.vao){var wn=ri();this===yi.currentVAO&&(yi.currentVAO=null,wn.bindVertexArrayOES(null)),wn.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Jn[this.id]&&(delete Jn[this.id],ln.vaoCount-=1)};function Mi(){var wn=ri();wn&&Ae(Jn).forEach(function(In){In.refresh()})}function la(wn){var In=new ci;ln.vaoCount+=1;function Wi(bi){var Qn;if(Array.isArray(bi))Qn=bi,In.elements&&In.ownsElements&&In.elements.destroy(),In.elements=null,In.ownsElements=!1,In.offset=0,In.count=0,In.instances=-1,In.primitive=4;else{if(tt(typeof bi=="object","invalid arguments for create vao"),tt("attributes"in bi,"must specify attributes for vao"),bi.elements){var pi=bi.elements;In.ownsElements?typeof pi=="function"&&pi._reglType==="elements"?(In.elements.destroy(),In.ownsElements=!1):(In.elements(pi),In.ownsElements=!1):on.getElements(bi.elements)?(In.elements=bi.elements,In.ownsElements=!1):(In.elements=on.create(bi.elements),In.ownsElements=!0)}else In.elements=null,In.ownsElements=!1;Qn=bi.attributes,In.offset=0,In.count=-1,In.instances=-1,In.primitive=4,In.elements&&(In.count=In.elements._elements.vertCount,In.primitive=In.elements._elements.primType),"offset"in bi&&(In.offset=bi.offset|0),"count"in bi&&(In.count=bi.count|0),"instances"in bi&&(In.instances=bi.instances|0),"primitive"in bi&&(tt(bi.primitive in Cn,"bad primitive type: "+bi.primitive),In.primitive=Cn[bi.primitive]),tt.optional(function(){for(var ws=Object.keys(bi),Ss=0;Ss<ws.length;++Ss)tt(Er.indexOf(ws[Ss])>=0,'invalid option for vao: "'+ws[Ss]+'" valid options are '+Er)}),tt(Array.isArray(Qn),"attributes must be an array")}tt(Qn.length<jr,"too many attributes"),tt(Qn.length>0,"must specify at least one attribute");var hi={},Na=In.attributes;Na.length=Qn.length;for(var wa=0;wa<Qn.length;++wa){var Ei=Qn[wa],Li=Na[wa]=new Or,ga=Ei.data||Ei;if(Array.isArray(ga)||mt(ga)||$u(ga)){var Ta;In.buffers[wa]&&(Ta=In.buffers[wa],mt(ga)&&Ta._buffer.byteLength>=ga.byteLength?Ta.subdata(ga):(Ta.destroy(),In.buffers[wa]=null)),In.buffers[wa]||(Ta=In.buffers[wa]=Ln.create(Ei,_r,!1,!0)),Li.buffer=Ln.getBuffer(Ta),Li.size=Li.buffer.dimension|0,Li.normalized=!1,Li.type=Li.buffer.dtype,Li.offset=0,Li.stride=0,Li.divisor=0,Li.state=1,hi[wa]=1}else Ln.getBuffer(Ei)?(Li.buffer=Ln.getBuffer(Ei),Li.size=Li.buffer.dimension|0,Li.normalized=!1,Li.type=Li.buffer.dtype,Li.offset=0,Li.stride=0,Li.divisor=0,Li.state=1):Ln.getBuffer(Ei.buffer)?(Li.buffer=Ln.getBuffer(Ei.buffer),Li.size=(+Ei.size||Li.buffer.dimension)|0,Li.normalized=!!Ei.normalized||!1,"type"in Ei?(tt.parameter(Ei.type,xl,"invalid buffer type"),Li.type=xl[Ei.type]):Li.type=Li.buffer.dtype,Li.offset=(Ei.offset||0)|0,Li.stride=(Ei.stride||0)|0,Li.divisor=(Ei.divisor||0)|0,Li.state=1,tt(Li.size>=1&&Li.size<=4,"size must be between 1 and 4"),tt(Li.offset>=0,"invalid offset"),tt(Li.stride>=0&&Li.stride<=255,"stride must be between 0 and 255"),tt(Li.divisor>=0,"divisor must be positive"),tt(!Li.divisor||!!Re.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ei?(tt(wa>0,"first attribute must not be a constant"),Li.x=+Ei.x||0,Li.y=+Ei.y||0,Li.z=+Ei.z||0,Li.w=+Ei.w||0,Li.state=2):tt(!1,"invalid attribute spec for location "+wa)}for(var no=0;no<In.buffers.length;++no)!hi[no]&&In.buffers[no]&&(In.buffers[no].destroy(),In.buffers[no]=null);return In.refresh(),Wi}return Wi.destroy=function(){for(var bi=0;bi<In.buffers.length;++bi)In.buffers[bi]&&In.buffers[bi].destroy();In.buffers.length=0,In.ownsElements&&(In.elements.destroy(),In.elements=null,In.ownsElements=!1),In.destroy()},Wi._vao=In,Wi._reglType="vao",Wi(wn)}return yi}var gn=35632,vn=35633,_n=35718,Un=35721;function ui(It,Re,dr,ln){var Ln={},on={};function En(Zr,mn,jn,gi){this.name=Zr,this.id=mn,this.location=jn,this.info=gi}function jr(Zr,mn){for(var jn=0;jn<Zr.length;++jn)if(Zr[jn].id===mn.id){Zr[jn].location=mn.location;return}Zr.push(mn)}function Xn(Zr,mn,jn){var gi=Zr===gn?Ln:on,Dn=gi[mn];if(!Dn){var ci=Re.str(mn);Dn=It.createShader(Zr),It.shaderSource(Dn,ci),It.compileShader(Dn),tt.shaderError(It,Dn,ci,Zr,jn),gi[mn]=Dn}return Dn}var Yn={},ni=[],Jn=0;function yi(Zr,mn){this.id=Jn++,this.fragId=Zr,this.vertId=mn,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ln.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function qn(Zr,mn,jn){var gi,Dn,ci=Xn(gn,Zr.fragId),Mi=Xn(vn,Zr.vertId),la=Zr.program=It.createProgram();if(It.attachShader(la,ci),It.attachShader(la,Mi),jn)for(gi=0;gi<jn.length;++gi){var wn=jn[gi];It.bindAttribLocation(la,wn[0],wn[1])}It.linkProgram(la),tt.linkError(It,la,Re.str(Zr.fragId),Re.str(Zr.vertId),mn);var In=It.getProgramParameter(la,_n);ln.profile&&(Zr.stats.uniformsCount=In);var Wi=Zr.uniforms;for(gi=0;gi<In;++gi)if(Dn=It.getActiveUniform(la,gi),Dn)if(Dn.size>1)for(var bi=0;bi<Dn.size;++bi){var Qn=Dn.name.replace("[0]","["+bi+"]");jr(Wi,new En(Qn,Re.id(Qn),It.getUniformLocation(la,Qn),Dn))}else jr(Wi,new En(Dn.name,Re.id(Dn.name),It.getUniformLocation(la,Dn.name),Dn));var pi=It.getProgramParameter(la,Un);ln.profile&&(Zr.stats.attributesCount=pi);var hi=Zr.attributes;for(gi=0;gi<pi;++gi)Dn=It.getActiveAttrib(la,gi),Dn&&jr(hi,new En(Dn.name,Re.id(Dn.name),It.getAttribLocation(la,Dn.name),Dn))}ln.profile&&(dr.getMaxUniformsCount=function(){var Zr=0;return ni.forEach(function(mn){mn.stats.uniformsCount>Zr&&(Zr=mn.stats.uniformsCount)}),Zr},dr.getMaxAttributesCount=function(){var Zr=0;return ni.forEach(function(mn){mn.stats.attributesCount>Zr&&(Zr=mn.stats.attributesCount)}),Zr});function ri(){Ln={},on={};for(var Zr=0;Zr<ni.length;++Zr)qn(ni[Zr],null,ni[Zr].attributes.map(function(mn){return[mn.location,mn.name]}))}return{clear:function(){var Zr=It.deleteShader.bind(It);Ae(Ln).forEach(Zr),Ln={},Ae(on).forEach(Zr),on={},ni.forEach(function(mn){It.deleteProgram(mn.program)}),ni.length=0,Yn={},dr.shaderCount=0},program:function(Zr,mn,jn,gi){tt.command(Zr>=0,"missing vertex shader",jn),tt.command(mn>=0,"missing fragment shader",jn);var Dn=Yn[mn];Dn||(Dn=Yn[mn]={});var ci=Dn[Zr];if(ci&&(ci.refCount++,!gi))return ci;var Mi=new yi(mn,Zr);return dr.shaderCount++,qn(Mi,jn,gi),ci||(Dn[Zr]=Mi),ni.push(Mi),k(Mi,{destroy:function(){if(Mi.refCount--,Mi.refCount<=0){It.deleteProgram(Mi.program);var la=ni.indexOf(Mi);ni.splice(la,1),dr.shaderCount--}Dn[Mi.vertId].refCount<=0&&(It.deleteShader(on[Mi.vertId]),delete on[Mi.vertId],delete Yn[Mi.fragId][Mi.vertId]),Object.keys(Yn[Mi.fragId]).length||(It.deleteShader(Ln[Mi.fragId]),delete Ln[Mi.fragId],delete Yn[Mi.fragId])}})},restore:ri,shader:Xn,frag:-1,vert:-1}}var oi=6408,Ri=5121,Di=3333,ia=5126;function na(It,Re,dr,ln,Ln,on,En){function jr(ni){var Jn;Re.next===null?(tt(Ln.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Jn=Ri):(tt(Re.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Jn=Re.next.colorAttachments[0].texture._texture.type,tt.optional(function(){on.oes_texture_float?(tt(Jn===Ri||Jn===ia,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Jn===ia&&tt(En.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):tt(Jn===Ri,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var yi=0,qn=0,ri=ln.framebufferWidth,Zr=ln.framebufferHeight,mn=null;mt(ni)?mn=ni:ni&&(tt.type(ni,"object","invalid arguments to regl.read()"),yi=ni.x|0,qn=ni.y|0,tt(yi>=0&&yi<ln.framebufferWidth,"invalid x offset for regl.read"),tt(qn>=0&&qn<ln.framebufferHeight,"invalid y offset for regl.read"),ri=(ni.width||ln.framebufferWidth-yi)|0,Zr=(ni.height||ln.framebufferHeight-qn)|0,mn=ni.data||null),mn&&(Jn===Ri?tt(mn instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Jn===ia&&tt(mn instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),tt(ri>0&&ri+yi<=ln.framebufferWidth,"invalid width for read pixels"),tt(Zr>0&&Zr+qn<=ln.framebufferHeight,"invalid height for read pixels"),dr();var jn=ri*Zr*4;return mn||(Jn===Ri?mn=new Uint8Array(jn):Jn===ia&&(mn=mn||new Float32Array(jn))),tt.isTypedArray(mn,"data buffer for regl.read() must be a typedarray"),tt(mn.byteLength>=jn,"data buffer for regl.read() too small"),It.pixelStorei(Di,4),It.readPixels(yi,qn,ri,Zr,oi,Jn,mn),mn}function Xn(ni){var Jn;return Re.setFBO({framebuffer:ni.framebuffer},function(){Jn=jr(ni)}),Jn}function Yn(ni){return!ni||!("framebuffer"in ni)?jr(ni):Xn(ni)}return Yn}function co(It){return Array.prototype.slice.call(It)}function Bi(It){return co(It).join("")}function Pa(){var It=0,Re=[],dr=[];function ln(Jn){for(var yi=0;yi<dr.length;++yi)if(dr[yi]===Jn)return Re[yi];var qn="g"+It++;return Re.push(qn),dr.push(Jn),qn}function Ln(){var Jn=[];function yi(){Jn.push.apply(Jn,co(arguments))}var qn=[];function ri(){var Zr="v"+It++;return qn.push(Zr),arguments.length>0&&(Jn.push(Zr,"="),Jn.push.apply(Jn,co(arguments)),Jn.push(";")),Zr}return k(yi,{def:ri,toString:function(){return Bi([qn.length>0?"var "+qn.join(",")+";":"",Bi(Jn)])}})}function on(){var Jn=Ln(),yi=Ln(),qn=Jn.toString,ri=yi.toString;function Zr(mn,jn){yi(mn,jn,"=",Jn.def(mn,jn),";")}return k(function(){Jn.apply(Jn,co(arguments))},{def:Jn.def,entry:Jn,exit:yi,save:Zr,set:function(mn,jn,gi){Zr(mn,jn),Jn(mn,jn,"=",gi,";")},toString:function(){return qn()+ri()}})}function En(){var Jn=Bi(arguments),yi=on(),qn=on(),ri=yi.toString,Zr=qn.toString;return k(yi,{then:function(){return yi.apply(yi,co(arguments)),this},else:function(){return qn.apply(qn,co(arguments)),this},toString:function(){var mn=Zr();return mn&&(mn="else{"+mn+"}"),Bi(["if(",Jn,"){",ri(),"}",mn])}})}var jr=Ln(),Xn={};function Yn(Jn,yi){var qn=[];function ri(){var Dn="a"+qn.length;return qn.push(Dn),Dn}yi=yi||0;for(var Zr=0;Zr<yi;++Zr)ri();var mn=on(),jn=mn.toString,gi=Xn[Jn]=k(mn,{arg:ri,toString:function(){return Bi(["function(",qn.join(),"){",jn(),"}"])}});return gi}function ni(){var Jn=['"use strict";',jr,"return {"];Object.keys(Xn).forEach(function(Zr){Jn.push('"',Zr,'":',Xn[Zr].toString(),",")}),Jn.push("}");var yi=Bi(Jn).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),qn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ri=qn?kt.Function.apply(null,Re.concat(yi)):Function.apply(null,Re.concat(yi));return ri.apply(null,dr)}return{global:jr,link:ln,block:Ln,proc:Yn,scope:on,cond:En,compile:ni}}var Ra="xyzw".split(""),Aa=5121,ya=1,Ba=2,Ea=0,ca=1,Ys=2,xs=3,ru=4,hu=5,Ko=6,bs="dither",Au="blend.enable",nu="blend.color",mc="blend.equation",pu="blend.func",Vl="depth.enable",Tl="depth.func",Kf="depth.range",Qf="depth.mask",Ml="colorMask",Tf="cull.enable",yh="cull.face",sc="frontFace",Jf="lineWidth",Il="polygonOffset.enable",Rs="polygonOffset.offset",iu="sample.alpha",uc="sample.enable",Pc="sample.coverage",Eo="stencil.enable",Gl="stencil.mask",al="stencil.func",Oc="stencil.opFront",th="stencil.opBack",kp="scissor.enable",fd="scissor.box",au="viewport",kl="profile",ol="framebuffer",yc="vert",Mf="frag",Ll="elements",ou="primitive",Fc="count",_h="offset",_c="instances",hd="vao",rv="Width",nv="Height",If=ol+rv,pd=ol+nv,iv=au+rv,W0=au+nv,eh="drawingBuffer",dd=eh+rv,Og=eh+nv,xh=[pu,mc,al,Oc,th,Pc,au,fd,Rs],bh=34962,Lp=34963,Qv=35632,Fg=35633,rh=3553,ei=34067,av=2884,ov=3042,Tu=3024,ls=2960,Eh=2929,sv=3089,af=32823,Rc=32926,jh=32928,Jv=5126,vd=35664,of=35665,Wh=35666,xc=5124,gd=35667,nh=35668,t0=35669,md=35670,uv=35671,Pp=35672,Xh=35673,gl=35674,yd=35675,kf=35676,Op=35678,Fp=35680,_d=4,cs=1028,sl=1029,e0=2304,wh=2305,X0=32775,Y0=32776,Rp=519,Hl=7680,Mu=0,bc=1,Iu=32774,Lf=513,Rg=36160,xd=36064,jl={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ku=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Sh={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},lc={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Yh={frag:Qv,vert:Fg},r0={cw:e0,ccw:wh};function lv(It){return Array.isArray(It)||mt(It)||$u(It)}function n0(It){return It.sort(function(Re,dr){return Re===au?-1:dr===au?1:Re<dr?-1:1})}function ko(It,Re,dr,ln){this.thisDep=It,this.contextDep=Re,this.propDep=dr,this.append=ln}function Pf(It){return It&&!(It.thisDep||It.contextDep||It.propDep)}function Is(It){return new ko(!1,!1,!1,It)}function ul(It,Re){var dr=It.type;if(dr===Ea){var ln=It.data.length;return new ko(!0,ln>=1,ln>=2,Re)}else if(dr===ru){var Ln=It.data;return new ko(Ln.thisDep,Ln.contextDep,Ln.propDep,Re)}else{if(dr===hu)return new ko(!1,!1,!1,Re);if(dr===Ko){for(var on=!1,En=!1,jr=!1,Xn=0;Xn<It.data.length;++Xn){var Yn=It.data[Xn];if(Yn.type===ca)jr=!0;else if(Yn.type===Ys)En=!0;else if(Yn.type===xs)on=!0;else if(Yn.type===Ea){on=!0;var ni=Yn.data;ni>=1&&(En=!0),ni>=2&&(jr=!0)}else Yn.type===ru&&(on=on||Yn.data.thisDep,En=En||Yn.data.contextDep,jr=jr||Yn.data.propDep)}return new ko(on,En,jr,Re)}else return new ko(dr===xs,dr===Ys,dr===ca,Re)}}var cv=new ko(!1,!1,!1,function(){});function $0(It,Re,dr,ln,Ln,on,En,jr,Xn,Yn,ni,Jn,yi,qn,ri){var Zr=Yn.Record,mn={add:32774,subtract:32778,"reverse subtract":32779};dr.ext_blend_minmax&&(mn.min=X0,mn.max=Y0);var jn=dr.angle_instanced_arrays,gi=dr.webgl_draw_buffers,Dn=dr.oes_vertex_array_object,ci={dirty:!0,profile:ri.profile},Mi={},la=[],wn={},In={};function Wi(tr){return tr.replace(".","_")}function bi(tr,Te,xr){var kr=Wi(tr);la.push(tr),Mi[kr]=ci[kr]=!!xr,wn[kr]=Te}function Qn(tr,Te,xr){var kr=Wi(tr);la.push(tr),Array.isArray(xr)?(ci[kr]=xr.slice(),Mi[kr]=xr.slice()):ci[kr]=Mi[kr]=xr,In[kr]=Te}bi(bs,Tu),bi(Au,ov),Qn(nu,"blendColor",[0,0,0,0]),Qn(mc,"blendEquationSeparate",[Iu,Iu]),Qn(pu,"blendFuncSeparate",[bc,Mu,bc,Mu]),bi(Vl,Eh,!0),Qn(Tl,"depthFunc",Lf),Qn(Kf,"depthRange",[0,1]),Qn(Qf,"depthMask",!0),Qn(Ml,Ml,[!0,!0,!0,!0]),bi(Tf,av),Qn(yh,"cullFace",sl),Qn(sc,sc,wh),Qn(Jf,Jf,1),bi(Il,af),Qn(Rs,"polygonOffset",[0,0]),bi(iu,Rc),bi(uc,jh),Qn(Pc,"sampleCoverage",[1,!1]),bi(Eo,ls),Qn(Gl,"stencilMask",-1),Qn(al,"stencilFunc",[Rp,0,-1]),Qn(Oc,"stencilOpSeparate",[cs,Hl,Hl,Hl]),Qn(th,"stencilOpSeparate",[sl,Hl,Hl,Hl]),bi(kp,sv),Qn(fd,"scissor",[0,0,It.drawingBufferWidth,It.drawingBufferHeight]),Qn(au,au,[0,0,It.drawingBufferWidth,It.drawingBufferHeight]);var pi={gl:It,context:yi,strings:Re,next:Mi,current:ci,draw:Jn,elements:on,buffer:Ln,shader:ni,attributes:Yn.state,vao:Yn,uniforms:Xn,framebuffer:jr,extensions:dr,timer:qn,isBufferArgs:lv},hi={primTypes:Cn,compareFuncs:Sh,blendFuncs:jl,blendEquations:mn,stencilOps:lc,glTypes:xl,orientationType:r0};tt.optional(function(){pi.isArrayLike=or}),gi&&(hi.backBuffer=[sl],hi.drawBuffer=cr(ln.maxDrawbuffers,function(tr){return tr===0?[0]:cr(tr,function(Te){return xd+Te})}));var Na=0;function wa(){var tr=Pa(),Te=tr.link,xr=tr.global;tr.id=Na++,tr.batchId="0";var kr=Te(pi),$r=tr.shared={props:"a0"};Object.keys(pi).forEach(function(mr){$r[mr]=xr.def(kr,".",mr)}),tt.optional(function(){tr.CHECK=Te(tt),tr.commandStr=tt.guessCommand(),tr.command=Te(tr.commandStr),tr.assert=function(mr,rr,Mr){mr("if(!(",rr,"))",this.CHECK,".commandRaise(",Te(Mr),",",this.command,");")},hi.invalidBlendCombinations=ku});var Ar=tr.next={},Ye=tr.current={};Object.keys(In).forEach(function(mr){Array.isArray(ci[mr])&&(Ar[mr]=xr.def($r.next,".",mr),Ye[mr]=xr.def($r.current,".",mr))});var Rr=tr.constants={};Object.keys(hi).forEach(function(mr){Rr[mr]=xr.def(JSON.stringify(hi[mr]))}),tr.invoke=function(mr,rr){switch(rr.type){case Ea:var Mr=["this",$r.context,$r.props,tr.batchId];return mr.def(Te(rr.data),".call(",Mr.slice(0,Math.max(rr.data.length+1,4)),")");case ca:return mr.def($r.props,rr.data);case Ys:return mr.def($r.context,rr.data);case xs:return mr.def("this",rr.data);case ru:return rr.data.append(tr,mr),rr.data.ref;case hu:return rr.data.toString();case Ko:return rr.data.map(function(qr){return tr.invoke(mr,qr)})}},tr.attribCache={};var je={};return tr.scopeAttrib=function(mr){var rr=Re.id(mr);if(rr in je)return je[rr];var Mr=Yn.scope[rr];Mr||(Mr=Yn.scope[rr]=new Zr);var qr=je[rr]=Te(Mr);return qr},tr}function Ei(tr){var Te=tr.static,xr=tr.dynamic,kr;if(kl in Te){var $r=!!Te[kl];kr=Is(function(Ye,Rr){return $r}),kr.enable=$r}else if(kl in xr){var Ar=xr[kl];kr=ul(Ar,function(Ye,Rr){return Ye.invoke(Rr,Ar)})}return kr}function Li(tr,Te){var xr=tr.static,kr=tr.dynamic;if(ol in xr){var $r=xr[ol];return $r?($r=jr.getFramebuffer($r),tt.command($r,"invalid framebuffer object"),Is(function(Ye,Rr){var je=Ye.link($r),mr=Ye.shared;Rr.set(mr.framebuffer,".next",je);var rr=mr.context;return Rr.set(rr,"."+If,je+".width"),Rr.set(rr,"."+pd,je+".height"),je})):Is(function(Ye,Rr){var je=Ye.shared;Rr.set(je.framebuffer,".next","null");var mr=je.context;return Rr.set(mr,"."+If,mr+"."+dd),Rr.set(mr,"."+pd,mr+"."+Og),"null"})}else if(ol in kr){var Ar=kr[ol];return ul(Ar,function(Ye,Rr){var je=Ye.invoke(Rr,Ar),mr=Ye.shared,rr=mr.framebuffer,Mr=Rr.def(rr,".getFramebuffer(",je,")");tt.optional(function(){Ye.assert(Rr,"!"+je+"||"+Mr,"invalid framebuffer object")}),Rr.set(rr,".next",Mr);var qr=mr.context;return Rr.set(qr,"."+If,Mr+"?"+Mr+".width:"+qr+"."+dd),Rr.set(qr,"."+pd,Mr+"?"+Mr+".height:"+qr+"."+Og),Mr})}else return null}function ga(tr,Te,xr){var kr=tr.static,$r=tr.dynamic;function Ar(je){if(je in kr){var mr=kr[je];tt.commandType(mr,"object","invalid "+je,xr.commandStr);var rr=!0,Mr=mr.x|0,qr=mr.y|0,Bn,ti;return"width"in mr?(Bn=mr.width|0,tt.command(Bn>=0,"invalid "+je,xr.commandStr)):rr=!1,"height"in mr?(ti=mr.height|0,tt.command(ti>=0,"invalid "+je,xr.commandStr)):rr=!1,new ko(!rr&&Te&&Te.thisDep,!rr&&Te&&Te.contextDep,!rr&&Te&&Te.propDep,function(di,Ni){var Oi=di.shared.context,zi=Bn;"width"in mr||(zi=Ni.def(Oi,".",If,"-",Mr));var Ui=ti;return"height"in mr||(Ui=Ni.def(Oi,".",pd,"-",qr)),[Mr,qr,zi,Ui]})}else if(je in $r){var li=$r[je],wi=ul(li,function(di,Ni){var Oi=di.invoke(Ni,li);tt.optional(function(){di.assert(Ni,Oi+"&&typeof "+Oi+'==="object"',"invalid "+je)});var zi=di.shared.context,Ui=Ni.def(Oi,".x|0"),Hi=Ni.def(Oi,".y|0"),ba=Ni.def('"width" in ',Oi,"?",Oi,".width|0:","(",zi,".",If,"-",Ui,")"),Xo=Ni.def('"height" in ',Oi,"?",Oi,".height|0:","(",zi,".",pd,"-",Hi,")");return tt.optional(function(){di.assert(Ni,ba+">=0&&"+Xo+">=0","invalid "+je)}),[Ui,Hi,ba,Xo]});return Te&&(wi.thisDep=wi.thisDep||Te.thisDep,wi.contextDep=wi.contextDep||Te.contextDep,wi.propDep=wi.propDep||Te.propDep),wi}else return Te?new ko(Te.thisDep,Te.contextDep,Te.propDep,function(di,Ni){var Oi=di.shared.context;return[0,0,Ni.def(Oi,".",If),Ni.def(Oi,".",pd)]}):null}var Ye=Ar(au);if(Ye){var Rr=Ye;Ye=new ko(Ye.thisDep,Ye.contextDep,Ye.propDep,function(je,mr){var rr=Rr.append(je,mr),Mr=je.shared.context;return mr.set(Mr,"."+iv,rr[2]),mr.set(Mr,"."+W0,rr[3]),rr})}return{viewport:Ye,scissor_box:Ar(fd)}}function Ta(tr,Te){var xr=tr.static,kr=typeof xr[Mf]=="string"&&typeof xr[yc]=="string";if(kr){if(Object.keys(Te.dynamic).length>0)return null;var $r=Te.static,Ar=Object.keys($r);if(Ar.length>0&&typeof $r[Ar[0]]=="number"){for(var Ye=[],Rr=0;Rr<Ar.length;++Rr)tt(typeof $r[Ar[Rr]]=="number","must specify all vertex attribute locations when using vaos"),Ye.push([$r[Ar[Rr]]|0,Ar[Rr]]);return Ye}}return null}function no(tr,Te,xr){var kr=tr.static,$r=tr.dynamic;function Ar(rr){if(rr in kr){var Mr=Re.id(kr[rr]);tt.optional(function(){ni.shader(Yh[rr],Mr,tt.guessCommand())});var qr=Is(function(){return Mr});return qr.id=Mr,qr}else if(rr in $r){var Bn=$r[rr];return ul(Bn,function(ti,li){var wi=ti.invoke(li,Bn),di=li.def(ti.shared.strings,".id(",wi,")");return tt.optional(function(){li(ti.shared.shader,".shader(",Yh[rr],",",di,",",ti.command,");")}),di})}return null}var Ye=Ar(Mf),Rr=Ar(yc),je=null,mr;return Pf(Ye)&&Pf(Rr)?(je=ni.program(Rr.id,Ye.id,null,xr),mr=Is(function(rr,Mr){return rr.link(je)})):mr=new ko(Ye&&Ye.thisDep||Rr&&Rr.thisDep,Ye&&Ye.contextDep||Rr&&Rr.contextDep,Ye&&Ye.propDep||Rr&&Rr.propDep,function(rr,Mr){var qr=rr.shared.shader,Bn;Ye?Bn=Ye.append(rr,Mr):Bn=Mr.def(qr,".",Mf);var ti;Rr?ti=Rr.append(rr,Mr):ti=Mr.def(qr,".",yc);var li=qr+".program("+ti+","+Bn;return tt.optional(function(){li+=","+rr.command}),Mr.def(li+")")}),{frag:Ye,vert:Rr,progVar:mr,program:je}}function ws(tr,Te){var xr=tr.static,kr=tr.dynamic,$r={},Ar=!1;function Ye(){if(hd in xr){var Ni=xr[hd];return Ni!==null&&Yn.getVAO(Ni)===null&&(Ni=Yn.createVAO(Ni)),Ar=!0,$r.vao=Ni,Is(function(zi){var Ui=Yn.getVAO(Ni);return Ui?zi.link(Ui):"null"})}else if(hd in kr){Ar=!0;var Oi=kr[hd];return ul(Oi,function(zi,Ui){var Hi=zi.invoke(Ui,Oi);return Ui.def(zi.shared.vao+".getVAO("+Hi+")")})}return null}var Rr=Ye(),je=!1;function mr(){if(Ll in xr){var Ni=xr[Ll];if($r.elements=Ni,lv(Ni)){var Oi=$r.elements=on.create(Ni,!0);Ni=on.getElements(Oi),je=!0}else Ni&&(Ni=on.getElements(Ni),je=!0,tt.command(Ni,"invalid elements",Te.commandStr));var zi=Is(function(Hi,ba){if(Ni){var Xo=Hi.link(Ni);return Hi.ELEMENTS=Xo,Xo}return Hi.ELEMENTS=null,null});return zi.value=Ni,zi}else if(Ll in kr){je=!0;var Ui=kr[Ll];return ul(Ui,function(Hi,ba){var Xo=Hi.shared,Ou=Xo.isBufferArgs,fs=Xo.elements,Lo=Hi.invoke(ba,Ui),Of=ba.def("null"),ll=ba.def(Ou,"(",Lo,")"),Dc=Hi.cond(ll).then(Of,"=",fs,".createStream(",Lo,");").else(Of,"=",fs,".getElements(",Lo,");");return tt.optional(function(){Hi.assert(Dc.else,"!"+Lo+"||"+Of,"invalid elements")}),ba.entry(Dc),ba.exit(Hi.cond(ll).then(fs,".destroyStream(",Of,");")),Hi.ELEMENTS=Of,Of})}else if(Ar)return new ko(Rr.thisDep,Rr.contextDep,Rr.propDep,function(Hi,ba){return ba.def(Hi.shared.vao+".currentVAO?"+Hi.shared.elements+".getElements("+Hi.shared.vao+".currentVAO.elements):null")});return null}var rr=mr();function Mr(){if(ou in xr){var Ni=xr[ou];return $r.primitive=Ni,tt.commandParameter(Ni,Cn,"invalid primitve",Te.commandStr),Is(function(zi,Ui){return Cn[Ni]})}else if(ou in kr){var Oi=kr[ou];return ul(Oi,function(zi,Ui){var Hi=zi.constants.primTypes,ba=zi.invoke(Ui,Oi);return tt.optional(function(){zi.assert(Ui,ba+" in "+Hi,"invalid primitive, must be one of "+Object.keys(Cn))}),Ui.def(Hi,"[",ba,"]")})}else{if(je)return Pf(rr)?rr.value?Is(function(zi,Ui){return Ui.def(zi.ELEMENTS,".primType")}):Is(function(){return _d}):new ko(rr.thisDep,rr.contextDep,rr.propDep,function(zi,Ui){var Hi=zi.ELEMENTS;return Ui.def(Hi,"?",Hi,".primType:",_d)});if(Ar)return new ko(Rr.thisDep,Rr.contextDep,Rr.propDep,function(zi,Ui){return Ui.def(zi.shared.vao+".currentVAO?"+zi.shared.vao+".currentVAO.primitive:"+_d)})}return null}function qr(Ni,Oi){if(Ni in xr){var zi=xr[Ni]|0;return Oi?$r.offset=zi:$r.instances=zi,tt.command(!Oi||zi>=0,"invalid "+Ni,Te.commandStr),Is(function(Hi,ba){return Oi&&(Hi.OFFSET=zi),zi})}else if(Ni in kr){var Ui=kr[Ni];return ul(Ui,function(Hi,ba){var Xo=Hi.invoke(ba,Ui);return Oi&&(Hi.OFFSET=Xo,tt.optional(function(){Hi.assert(ba,Xo+">=0","invalid "+Ni)})),Xo})}else if(Oi){if(je)return Is(function(Hi,ba){return Hi.OFFSET=0,0});if(Ar)return new ko(Rr.thisDep,Rr.contextDep,Rr.propDep,function(Hi,ba){return ba.def(Hi.shared.vao+".currentVAO?"+Hi.shared.vao+".currentVAO.offset:0")})}else if(Ar)return new ko(Rr.thisDep,Rr.contextDep,Rr.propDep,function(Hi,ba){return ba.def(Hi.shared.vao+".currentVAO?"+Hi.shared.vao+".currentVAO.instances:-1")});return null}var Bn=qr(_h,!0);function ti(){if(Fc in xr){var Ni=xr[Fc]|0;return $r.count=Ni,tt.command(typeof Ni=="number"&&Ni>=0,"invalid vertex count",Te.commandStr),Is(function(){return Ni})}else if(Fc in kr){var Oi=kr[Fc];return ul(Oi,function(ba,Xo){var Ou=ba.invoke(Xo,Oi);return tt.optional(function(){ba.assert(Xo,"typeof "+Ou+'==="number"&&'+Ou+">=0&&"+Ou+"===("+Ou+"|0)","invalid vertex count")}),Ou})}else if(je)if(Pf(rr)){if(rr)return Bn?new ko(Bn.thisDep,Bn.contextDep,Bn.propDep,function(ba,Xo){var Ou=Xo.def(ba.ELEMENTS,".vertCount-",ba.OFFSET);return tt.optional(function(){ba.assert(Xo,Ou+">=0","invalid vertex offset/element buffer too small")}),Ou}):Is(function(ba,Xo){return Xo.def(ba.ELEMENTS,".vertCount")});var zi=Is(function(){return-1});return tt.optional(function(){zi.MISSING=!0}),zi}else{var Ui=new ko(rr.thisDep||Bn.thisDep,rr.contextDep||Bn.contextDep,rr.propDep||Bn.propDep,function(ba,Xo){var Ou=ba.ELEMENTS;return ba.OFFSET?Xo.def(Ou,"?",Ou,".vertCount-",ba.OFFSET,":-1"):Xo.def(Ou,"?",Ou,".vertCount:-1")});return tt.optional(function(){Ui.DYNAMIC=!0}),Ui}else if(Ar){var Hi=new ko(Rr.thisDep,Rr.contextDep,Rr.propDep,function(ba,Xo){return Xo.def(ba.shared.vao,".currentVAO?",ba.shared.vao,".currentVAO.count:-1")});return Hi}return null}var li=Mr(),wi=ti(),di=qr(_c,!1);return{elements:rr,primitive:li,count:wi,instances:di,offset:Bn,vao:Rr,vaoActive:Ar,elementsActive:je,static:$r}}function Ss(tr,Te){var xr=tr.static,kr=tr.dynamic,$r={};return la.forEach(function(Ar){var Ye=Wi(Ar);function Rr(je,mr){if(Ar in xr){var rr=je(xr[Ar]);$r[Ye]=Is(function(){return rr})}else if(Ar in kr){var Mr=kr[Ar];$r[Ye]=ul(Mr,function(qr,Bn){return mr(qr,Bn,qr.invoke(Bn,Mr))})}}switch(Ar){case Tf:case Au:case bs:case Eo:case Vl:case kp:case Il:case iu:case uc:case Qf:return Rr(function(je){return tt.commandType(je,"boolean",Ar,Te.commandStr),je},function(je,mr,rr){return tt.optional(function(){je.assert(mr,"typeof "+rr+'==="boolean"',"invalid flag "+Ar,je.commandStr)}),rr});case Tl:return Rr(function(je){return tt.commandParameter(je,Sh,"invalid "+Ar,Te.commandStr),Sh[je]},function(je,mr,rr){var Mr=je.constants.compareFuncs;return tt.optional(function(){je.assert(mr,rr+" in "+Mr,"invalid "+Ar+", must be one of "+Object.keys(Sh))}),mr.def(Mr,"[",rr,"]")});case Kf:return Rr(function(je){return tt.command(or(je)&&je.length===2&&typeof je[0]=="number"&&typeof je[1]=="number"&&je[0]<=je[1],"depth range is 2d array",Te.commandStr),je},function(je,mr,rr){tt.optional(function(){je.assert(mr,je.shared.isArrayLike+"("+rr+")&&"+rr+".length===2&&typeof "+rr+'[0]==="number"&&typeof '+rr+'[1]==="number"&&'+rr+"[0]<="+rr+"[1]","depth range must be a 2d array")});var Mr=mr.def("+",rr,"[0]"),qr=mr.def("+",rr,"[1]");return[Mr,qr]});case pu:return Rr(function(je){tt.commandType(je,"object","blend.func",Te.commandStr);var mr="srcRGB"in je?je.srcRGB:je.src,rr="srcAlpha"in je?je.srcAlpha:je.src,Mr="dstRGB"in je?je.dstRGB:je.dst,qr="dstAlpha"in je?je.dstAlpha:je.dst;return tt.commandParameter(mr,jl,Ye+".srcRGB",Te.commandStr),tt.commandParameter(rr,jl,Ye+".srcAlpha",Te.commandStr),tt.commandParameter(Mr,jl,Ye+".dstRGB",Te.commandStr),tt.commandParameter(qr,jl,Ye+".dstAlpha",Te.commandStr),tt.command(ku.indexOf(mr+", "+Mr)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+mr+", "+Mr+")",Te.commandStr),[jl[mr],jl[Mr],jl[rr],jl[qr]]},function(je,mr,rr){var Mr=je.constants.blendFuncs;tt.optional(function(){je.assert(mr,rr+"&&typeof "+rr+'==="object"',"invalid blend func, must be an object")});function qr(Oi,zi){var Ui=mr.def('"',Oi,zi,'" in ',rr,"?",rr,".",Oi,zi,":",rr,".",Oi);return tt.optional(function(){je.assert(mr,Ui+" in "+Mr,"invalid "+Ar+"."+Oi+zi+", must be one of "+Object.keys(jl))}),Ui}var Bn=qr("src","RGB"),ti=qr("dst","RGB");tt.optional(function(){var Oi=je.constants.invalidBlendCombinations;je.assert(mr,Oi+".indexOf("+Bn+'+", "+'+ti+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var li=mr.def(Mr,"[",Bn,"]"),wi=mr.def(Mr,"[",qr("src","Alpha"),"]"),di=mr.def(Mr,"[",ti,"]"),Ni=mr.def(Mr,"[",qr("dst","Alpha"),"]");return[li,di,wi,Ni]});case mc:return Rr(function(je){if(typeof je=="string")return tt.commandParameter(je,mn,"invalid "+Ar,Te.commandStr),[mn[je],mn[je]];if(typeof je=="object")return tt.commandParameter(je.rgb,mn,Ar+".rgb",Te.commandStr),tt.commandParameter(je.alpha,mn,Ar+".alpha",Te.commandStr),[mn[je.rgb],mn[je.alpha]];tt.commandRaise("invalid blend.equation",Te.commandStr)},function(je,mr,rr){var Mr=je.constants.blendEquations,qr=mr.def(),Bn=mr.def(),ti=je.cond("typeof ",rr,'==="string"');return tt.optional(function(){function li(wi,di,Ni){je.assert(wi,Ni+" in "+Mr,"invalid "+di+", must be one of "+Object.keys(mn))}li(ti.then,Ar,rr),je.assert(ti.else,rr+"&&typeof "+rr+'==="object"',"invalid "+Ar),li(ti.else,Ar+".rgb",rr+".rgb"),li(ti.else,Ar+".alpha",rr+".alpha")}),ti.then(qr,"=",Bn,"=",Mr,"[",rr,"];"),ti.else(qr,"=",Mr,"[",rr,".rgb];",Bn,"=",Mr,"[",rr,".alpha];"),mr(ti),[qr,Bn]});case nu:return Rr(function(je){return tt.command(or(je)&&je.length===4,"blend.color must be a 4d array",Te.commandStr),cr(4,function(mr){return+je[mr]})},function(je,mr,rr){return tt.optional(function(){je.assert(mr,je.shared.isArrayLike+"("+rr+")&&"+rr+".length===4","blend.color must be a 4d array")}),cr(4,function(Mr){return mr.def("+",rr,"[",Mr,"]")})});case Gl:return Rr(function(je){return tt.commandType(je,"number",Ye,Te.commandStr),je|0},function(je,mr,rr){return tt.optional(function(){je.assert(mr,"typeof "+rr+'==="number"',"invalid stencil.mask")}),mr.def(rr,"|0")});case al:return Rr(function(je){tt.commandType(je,"object",Ye,Te.commandStr);var mr=je.cmp||"keep",rr=je.ref||0,Mr="mask"in je?je.mask:-1;return tt.commandParameter(mr,Sh,Ar+".cmp",Te.commandStr),tt.commandType(rr,"number",Ar+".ref",Te.commandStr),tt.commandType(Mr,"number",Ar+".mask",Te.commandStr),[Sh[mr],rr,Mr]},function(je,mr,rr){var Mr=je.constants.compareFuncs;tt.optional(function(){function li(){je.assert(mr,Array.prototype.join.call(arguments,""),"invalid stencil.func")}li(rr+"&&typeof ",rr,'==="object"'),li('!("cmp" in ',rr,")||(",rr,".cmp in ",Mr,")")});var qr=mr.def('"cmp" in ',rr,"?",Mr,"[",rr,".cmp]",":",Hl),Bn=mr.def(rr,".ref|0"),ti=mr.def('"mask" in ',rr,"?",rr,".mask|0:-1");return[qr,Bn,ti]});case Oc:case th:return Rr(function(je){tt.commandType(je,"object",Ye,Te.commandStr);var mr=je.fail||"keep",rr=je.zfail||"keep",Mr=je.zpass||"keep";return tt.commandParameter(mr,lc,Ar+".fail",Te.commandStr),tt.commandParameter(rr,lc,Ar+".zfail",Te.commandStr),tt.commandParameter(Mr,lc,Ar+".zpass",Te.commandStr),[Ar===th?sl:cs,lc[mr],lc[rr],lc[Mr]]},function(je,mr,rr){var Mr=je.constants.stencilOps;tt.optional(function(){je.assert(mr,rr+"&&typeof "+rr+'==="object"',"invalid "+Ar)});function qr(Bn){return tt.optional(function(){je.assert(mr,'!("'+Bn+'" in '+rr+")||("+rr+"."+Bn+" in "+Mr+")","invalid "+Ar+"."+Bn+", must be one of "+Object.keys(lc))}),mr.def('"',Bn,'" in ',rr,"?",Mr,"[",rr,".",Bn,"]:",Hl)}return[Ar===th?sl:cs,qr("fail"),qr("zfail"),qr("zpass")]});case Rs:return Rr(function(je){tt.commandType(je,"object",Ye,Te.commandStr);var mr=je.factor|0,rr=je.units|0;return tt.commandType(mr,"number",Ye+".factor",Te.commandStr),tt.commandType(rr,"number",Ye+".units",Te.commandStr),[mr,rr]},function(je,mr,rr){tt.optional(function(){je.assert(mr,rr+"&&typeof "+rr+'==="object"',"invalid "+Ar)});var Mr=mr.def(rr,".factor|0"),qr=mr.def(rr,".units|0");return[Mr,qr]});case yh:return Rr(function(je){var mr=0;return je==="front"?mr=cs:je==="back"&&(mr=sl),tt.command(!!mr,Ye,Te.commandStr),mr},function(je,mr,rr){return tt.optional(function(){je.assert(mr,rr+'==="front"||'+rr+'==="back"',"invalid cull.face")}),mr.def(rr,'==="front"?',cs,":",sl)});case Jf:return Rr(function(je){return tt.command(typeof je=="number"&&je>=ln.lineWidthDims[0]&&je<=ln.lineWidthDims[1],"invalid line width, must be a positive number between "+ln.lineWidthDims[0]+" and "+ln.lineWidthDims[1],Te.commandStr),je},function(je,mr,rr){return tt.optional(function(){je.assert(mr,"typeof "+rr+'==="number"&&'+rr+">="+ln.lineWidthDims[0]+"&&"+rr+"<="+ln.lineWidthDims[1],"invalid line width")}),rr});case sc:return Rr(function(je){return tt.commandParameter(je,r0,Ye,Te.commandStr),r0[je]},function(je,mr,rr){return tt.optional(function(){je.assert(mr,rr+'==="cw"||'+rr+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),mr.def(rr+'==="cw"?'+e0+":"+wh)});case Ml:return Rr(function(je){return tt.command(or(je)&&je.length===4,"color.mask must be length 4 array",Te.commandStr),je.map(function(mr){return!!mr})},function(je,mr,rr){return tt.optional(function(){je.assert(mr,je.shared.isArrayLike+"("+rr+")&&"+rr+".length===4","invalid color.mask")}),cr(4,function(Mr){return"!!"+rr+"["+Mr+"]"})});case Pc:return Rr(function(je){tt.command(typeof je=="object"&&je,Ye,Te.commandStr);var mr="value"in je?je.value:1,rr=!!je.invert;return tt.command(typeof mr=="number"&&mr>=0&&mr<=1,"sample.coverage.value must be a number between 0 and 1",Te.commandStr),[mr,rr]},function(je,mr,rr){tt.optional(function(){je.assert(mr,rr+"&&typeof "+rr+'==="object"',"invalid sample.coverage")});var Mr=mr.def('"value" in ',rr,"?+",rr,".value:1"),qr=mr.def("!!",rr,".invert");return[Mr,qr]})}}),$r}function io(tr,Te){var xr=tr.static,kr=tr.dynamic,$r={};return Object.keys(xr).forEach(function(Ar){var Ye=xr[Ar],Rr;if(typeof Ye=="number"||typeof Ye=="boolean")Rr=Is(function(){return Ye});else if(typeof Ye=="function"){var je=Ye._reglType;je==="texture2d"||je==="textureCube"?Rr=Is(function(mr){return mr.link(Ye)}):je==="framebuffer"||je==="framebufferCube"?(tt.command(Ye.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ar+'"',Te.commandStr),Rr=Is(function(mr){return mr.link(Ye.color[0])})):tt.commandRaise('invalid data for uniform "'+Ar+'"',Te.commandStr)}else or(Ye)?Rr=Is(function(mr){var rr=mr.global.def("[",cr(Ye.length,function(Mr){return tt.command(typeof Ye[Mr]=="number"||typeof Ye[Mr]=="boolean","invalid uniform "+Ar,mr.commandStr),Ye[Mr]}),"]");return rr}):tt.commandRaise('invalid or missing data for uniform "'+Ar+'"',Te.commandStr);Rr.value=Ye,$r[Ar]=Rr}),Object.keys(kr).forEach(function(Ar){var Ye=kr[Ar];$r[Ar]=ul(Ye,function(Rr,je){return Rr.invoke(je,Ye)})}),$r}function Bo(tr,Te){var xr=tr.static,kr=tr.dynamic,$r={};return Object.keys(xr).forEach(function(Ar){var Ye=xr[Ar],Rr=Re.id(Ar),je=new Zr;if(lv(Ye))je.state=ya,je.buffer=Ln.getBuffer(Ln.create(Ye,bh,!1,!0)),je.type=0;else{var mr=Ln.getBuffer(Ye);if(mr)je.state=ya,je.buffer=mr,je.type=0;else if(tt.command(typeof Ye=="object"&&Ye,"invalid data for attribute "+Ar,Te.commandStr),"constant"in Ye){var rr=Ye.constant;je.buffer="null",je.state=Ba,typeof rr=="number"?je.x=rr:(tt.command(or(rr)&&rr.length>0&&rr.length<=4,"invalid constant for attribute "+Ar,Te.commandStr),Ra.forEach(function(di,Ni){Ni<rr.length&&(je[di]=rr[Ni])}))}else{lv(Ye.buffer)?mr=Ln.getBuffer(Ln.create(Ye.buffer,bh,!1,!0)):mr=Ln.getBuffer(Ye.buffer),tt.command(!!mr,'missing buffer for attribute "'+Ar+'"',Te.commandStr);var Mr=Ye.offset|0;tt.command(Mr>=0,'invalid offset for attribute "'+Ar+'"',Te.commandStr);var qr=Ye.stride|0;tt.command(qr>=0&&qr<256,'invalid stride for attribute "'+Ar+'", must be integer betweeen [0, 255]',Te.commandStr);var Bn=Ye.size|0;tt.command(!("size"in Ye)||Bn>0&&Bn<=4,'invalid size for attribute "'+Ar+'", must be 1,2,3,4',Te.commandStr);var ti=!!Ye.normalized,li=0;"type"in Ye&&(tt.commandParameter(Ye.type,xl,"invalid type for attribute "+Ar,Te.commandStr),li=xl[Ye.type]);var wi=Ye.divisor|0;tt.optional(function(){"divisor"in Ye&&(tt.command(wi===0||jn,'cannot specify divisor for attribute "'+Ar+'", instancing not supported',Te.commandStr),tt.command(wi>=0,'invalid divisor for attribute "'+Ar+'"',Te.commandStr));var di=Te.commandStr,Ni=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(Ye).forEach(function(Oi){tt.command(Ni.indexOf(Oi)>=0,'unknown parameter "'+Oi+'" for attribute pointer "'+Ar+'" (valid parameters are '+Ni+")",di)})}),je.buffer=mr,je.state=ya,je.size=Bn,je.normalized=ti,je.type=li||mr.dtype,je.offset=Mr,je.stride=qr,je.divisor=wi}}$r[Ar]=Is(function(di,Ni){var Oi=di.attribCache;if(Rr in Oi)return Oi[Rr];var zi={isStream:!1};return Object.keys(je).forEach(function(Ui){zi[Ui]=je[Ui]}),je.buffer&&(zi.buffer=di.link(je.buffer),zi.type=zi.type||zi.buffer+".dtype"),Oi[Rr]=zi,zi})}),Object.keys(kr).forEach(function(Ar){var Ye=kr[Ar];function Rr(je,mr){var rr=je.invoke(mr,Ye),Mr=je.shared,qr=je.constants,Bn=Mr.isBufferArgs,ti=Mr.buffer;tt.optional(function(){je.assert(mr,rr+"&&(typeof "+rr+'==="object"||typeof '+rr+'==="function")&&('+Bn+"("+rr+")||"+ti+".getBuffer("+rr+")||"+ti+".getBuffer("+rr+".buffer)||"+Bn+"("+rr+'.buffer)||("constant" in '+rr+"&&(typeof "+rr+'.constant==="number"||'+Mr.isArrayLike+"("+rr+".constant))))",'invalid dynamic attribute "'+Ar+'"')});var li={isStream:mr.def(!1)},wi=new Zr;wi.state=ya,Object.keys(wi).forEach(function(zi){li[zi]=mr.def(""+wi[zi])});var di=li.buffer,Ni=li.type;mr("if(",Bn,"(",rr,")){",li.isStream,"=true;",di,"=",ti,".createStream(",bh,",",rr,");",Ni,"=",di,".dtype;","}else{",di,"=",ti,".getBuffer(",rr,");","if(",di,"){",Ni,"=",di,".dtype;",'}else if("constant" in ',rr,"){",li.state,"=",Ba,";","if(typeof "+rr+'.constant === "number"){',li[Ra[0]],"=",rr,".constant;",Ra.slice(1).map(function(zi){return li[zi]}).join("="),"=0;","}else{",Ra.map(function(zi,Ui){return li[zi]+"="+rr+".constant.length>"+Ui+"?"+rr+".constant["+Ui+"]:0;"}).join(""),"}}else{","if(",Bn,"(",rr,".buffer)){",di,"=",ti,".createStream(",bh,",",rr,".buffer);","}else{",di,"=",ti,".getBuffer(",rr,".buffer);","}",Ni,'="type" in ',rr,"?",qr.glTypes,"[",rr,".type]:",di,".dtype;",li.normalized,"=!!",rr,".normalized;");function Oi(zi){mr(li[zi],"=",rr,".",zi,"|0;")}return Oi("size"),Oi("offset"),Oi("stride"),Oi("divisor"),mr("}}"),mr.exit("if(",li.isStream,"){",ti,".destroyStream(",di,");","}"),li}$r[Ar]=ul(Ye,Rr)}),$r}function Es(tr){var Te=tr.static,xr=tr.dynamic,kr={};return Object.keys(Te).forEach(function($r){var Ar=Te[$r];kr[$r]=Is(function(Ye,Rr){return typeof Ar=="number"||typeof Ar=="boolean"?""+Ar:Ye.link(Ar)})}),Object.keys(xr).forEach(function($r){var Ar=xr[$r];kr[$r]=ul(Ar,function(Ye,Rr){return Ye.invoke(Rr,Ar)})}),kr}function du(tr,Te,xr,kr,$r){var Ar=tr.static,Ye=tr.dynamic;tt.optional(function(){var Oi=[ol,yc,Mf,Ll,ou,_h,Fc,_c,kl,hd].concat(la);function zi(Ui){Object.keys(Ui).forEach(function(Hi){tt.command(Oi.indexOf(Hi)>=0,'unknown parameter "'+Hi+'"',$r.commandStr)})}zi(Ar),zi(Ye)});var Rr=Ta(tr,Te),je=Li(tr,$r),mr=ga(tr,je,$r),rr=ws(tr,$r),Mr=Ss(tr,$r),qr=no(tr,$r,Rr);function Bn(Oi){var zi=mr[Oi];zi&&(Mr[Oi]=zi)}Bn(au),Bn(Wi(fd));var ti=Object.keys(Mr).length>0,li={framebuffer:je,draw:rr,shader:qr,state:Mr,dirty:ti,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(li.profile=Ei(tr,$r),li.uniforms=io(xr,$r),li.drawVAO=li.scopeVAO=rr.vao,!li.drawVAO&&qr.program&&!Rr&&dr.angle_instanced_arrays&&rr.static.elements){var wi=!0,di=qr.program.attributes.map(function(Oi){var zi=Te.static[Oi];return wi=wi&&!!zi,zi});if(wi&&di.length>0){var Ni=Yn.getVAO(Yn.createVAO({attributes:di,elements:rr.static.elements}));li.drawVAO=new ko(null,null,null,function(Oi,zi){return Oi.link(Ni)}),li.useVAO=!0}}return Rr?li.useVAO=!0:li.attributes=Bo(Te,$r),li.context=Es(kr,$r),li}function Qo(tr,Te,xr){var kr=tr.shared,$r=kr.context,Ar=tr.scope();Object.keys(xr).forEach(function(Ye){Te.save($r,"."+Ye);var Rr=xr[Ye],je=Rr.append(tr,Te);Array.isArray(je)?Ar($r,".",Ye,"=[",je.join(),"];"):Ar($r,".",Ye,"=",je,";")}),Te(Ar)}function Lu(tr,Te,xr,kr){var $r=tr.shared,Ar=$r.gl,Ye=$r.framebuffer,Rr;gi&&(Rr=Te.def($r.extensions,".webgl_draw_buffers"));var je=tr.constants,mr=je.drawBuffer,rr=je.backBuffer,Mr;xr?Mr=xr.append(tr,Te):Mr=Te.def(Ye,".next"),kr||Te("if(",Mr,"!==",Ye,".cur){"),Te("if(",Mr,"){",Ar,".bindFramebuffer(",Rg,",",Mr,".framebuffer);"),gi&&Te(Rr,".drawBuffersWEBGL(",mr,"[",Mr,".colorAttachments.length]);"),Te("}else{",Ar,".bindFramebuffer(",Rg,",null);"),gi&&Te(Rr,".drawBuffersWEBGL(",rr,");"),Te("}",Ye,".cur=",Mr,";"),kr||Te("}")}function Vs(tr,Te,xr){var kr=tr.shared,$r=kr.gl,Ar=tr.current,Ye=tr.next,Rr=kr.current,je=kr.next,mr=tr.cond(Rr,".dirty");la.forEach(function(rr){var Mr=Wi(rr);if(!(Mr in xr.state)){var qr,Bn;if(Mr in Ye){qr=Ye[Mr],Bn=Ar[Mr];var ti=cr(ci[Mr].length,function(wi){return mr.def(qr,"[",wi,"]")});mr(tr.cond(ti.map(function(wi,di){return wi+"!=="+Bn+"["+di+"]"}).join("||")).then($r,".",In[Mr],"(",ti,");",ti.map(function(wi,di){return Bn+"["+di+"]="+wi}).join(";"),";"))}else{qr=mr.def(je,".",Mr);var li=tr.cond(qr,"!==",Rr,".",Mr);mr(li),Mr in wn?li(tr.cond(qr).then($r,".enable(",wn[Mr],");").else($r,".disable(",wn[Mr],");"),Rr,".",Mr,"=",qr,";"):li($r,".",In[Mr],"(",qr,");",Rr,".",Mr,"=",qr,";")}}}),Object.keys(xr.state).length===0&&mr(Rr,".dirty=false;"),Te(mr)}function Gu(tr,Te,xr,kr){var $r=tr.shared,Ar=tr.current,Ye=$r.current,Rr=$r.gl;n0(Object.keys(xr)).forEach(function(je){var mr=xr[je];if(!(kr&&!kr(mr))){var rr=mr.append(tr,Te);if(wn[je]){var Mr=wn[je];Pf(mr)?rr?Te(Rr,".enable(",Mr,");"):Te(Rr,".disable(",Mr,");"):Te(tr.cond(rr).then(Rr,".enable(",Mr,");").else(Rr,".disable(",Mr,");")),Te(Ye,".",je,"=",rr,";")}else if(or(rr)){var qr=Ar[je];Te(Rr,".",In[je],"(",rr,");",rr.map(function(Bn,ti){return qr+"["+ti+"]="+Bn}).join(";"),";")}else Te(Rr,".",In[je],"(",rr,");",Ye,".",je,"=",rr,";")}})}function ks(tr,Te){jn&&(tr.instancing=Te.def(tr.shared.extensions,".angle_instanced_arrays"))}function Da(tr,Te,xr,kr,$r){var Ar=tr.shared,Ye=tr.stats,Rr=Ar.current,je=Ar.timer,mr=xr.profile;function rr(){var Oi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Oi||typeof performance=="undefined"?"Date.now()":"performance.now()"}var Mr,qr;function Bn(Oi){Mr=Te.def(),Oi(Mr,"=",rr(),";"),typeof $r=="string"?Oi(Ye,".count+=",$r,";"):Oi(Ye,".count++;"),qn&&(kr?(qr=Te.def(),Oi(qr,"=",je,".getNumPendingQueries();")):Oi(je,".beginQuery(",Ye,");"))}function ti(Oi){Oi(Ye,".cpuTime+=",rr(),"-",Mr,";"),qn&&(kr?Oi(je,".pushScopeStats(",qr,",",je,".getNumPendingQueries(),",Ye,");"):Oi(je,".endQuery();"))}function li(Oi){var zi=Te.def(Rr,".profile");Te(Rr,".profile=",Oi,";"),Te.exit(Rr,".profile=",zi,";")}var wi;if(mr){if(Pf(mr)){mr.enable?(Bn(Te),ti(Te.exit),li("true")):li("false");return}wi=mr.append(tr,Te),li(wi)}else wi=Te.def(Rr,".profile");var di=tr.block();Bn(di),Te("if(",wi,"){",di,"}");var Ni=tr.block();ti(Ni),Te.exit("if(",wi,"){",Ni,"}")}function $s(tr,Te,xr,kr,$r){var Ar=tr.shared;function Ye(je){switch(je){case vd:case gd:case uv:return 2;case of:case nh:case Pp:return 3;case Wh:case t0:case Xh:return 4;default:return 1}}function Rr(je,mr,rr){var Mr=Ar.gl,qr=Te.def(je,".location"),Bn=Te.def(Ar.attributes,"[",qr,"]"),ti=rr.state,li=rr.buffer,wi=[rr.x,rr.y,rr.z,rr.w],di=["buffer","normalized","offset","stride"];function Ni(){Te("if(!",Bn,".buffer){",Mr,".enableVertexAttribArray(",qr,");}");var zi=rr.type,Ui;if(rr.size?Ui=Te.def(rr.size,"||",mr):Ui=mr,Te("if(",Bn,".type!==",zi,"||",Bn,".size!==",Ui,"||",di.map(function(ba){return Bn+"."+ba+"!=="+rr[ba]}).join("||"),"){",Mr,".bindBuffer(",bh,",",li,".buffer);",Mr,".vertexAttribPointer(",[qr,Ui,zi,rr.normalized,rr.stride,rr.offset],");",Bn,".type=",zi,";",Bn,".size=",Ui,";",di.map(function(ba){return Bn+"."+ba+"="+rr[ba]+";"}).join(""),"}"),jn){var Hi=rr.divisor;Te("if(",Bn,".divisor!==",Hi,"){",tr.instancing,".vertexAttribDivisorANGLE(",[qr,Hi],");",Bn,".divisor=",Hi,";}")}}function Oi(){Te("if(",Bn,".buffer){",Mr,".disableVertexAttribArray(",qr,");",Bn,".buffer=null;","}if(",Ra.map(function(zi,Ui){return Bn+"."+zi+"!=="+wi[Ui]}).join("||"),"){",Mr,".vertexAttrib4f(",qr,",",wi,");",Ra.map(function(zi,Ui){return Bn+"."+zi+"="+wi[Ui]+";"}).join(""),"}")}ti===ya?Ni():ti===Ba?Oi():(Te("if(",ti,"===",ya,"){"),Ni(),Te("}else{"),Oi(),Te("}"))}kr.forEach(function(je){var mr=je.name,rr=xr.attributes[mr],Mr;if(rr){if(!$r(rr))return;Mr=rr.append(tr,Te)}else{if(!$r(cv))return;var qr=tr.scopeAttrib(mr);tt.optional(function(){tr.assert(Te,qr+".state","missing attribute "+mr)}),Mr={},Object.keys(new Zr).forEach(function(Bn){Mr[Bn]=Te.def(qr,".",Bn)})}Rr(tr.link(je),Ye(je.info.type),Mr)})}function bo(tr,Te,xr,kr,$r,Ar){for(var Ye=tr.shared,Rr=Ye.gl,je,mr=0;mr<kr.length;++mr){var rr=kr[mr],Mr=rr.name,qr=rr.info.type,Bn=xr.uniforms[Mr],ti=tr.link(rr),li=ti+".location",wi;if(Bn){if(!$r(Bn))continue;if(Pf(Bn)){var di=Bn.value;if(tt.command(di!==null&&typeof di!="undefined",'missing uniform "'+Mr+'"',tr.commandStr),qr===Op||qr===Fp){tt.command(typeof di=="function"&&(qr===Op&&(di._reglType==="texture2d"||di._reglType==="framebuffer")||qr===Fp&&(di._reglType==="textureCube"||di._reglType==="framebufferCube")),"invalid texture for uniform "+Mr,tr.commandStr);var Ni=tr.link(di._texture||di.color[0]._texture);Te(Rr,".uniform1i(",li,",",Ni+".bind());"),Te.exit(Ni,".unbind();")}else if(qr===gl||qr===yd||qr===kf){tt.optional(function(){tt.command(or(di),"invalid matrix for uniform "+Mr,tr.commandStr),tt.command(qr===gl&&di.length===4||qr===yd&&di.length===9||qr===kf&&di.length===16,"invalid length for matrix uniform "+Mr,tr.commandStr)});var Oi=tr.global.def("new Float32Array(["+Array.prototype.slice.call(di)+"])"),zi=2;qr===yd?zi=3:qr===kf&&(zi=4),Te(Rr,".uniformMatrix",zi,"fv(",li,",false,",Oi,");")}else{switch(qr){case Jv:tt.commandType(di,"number","uniform "+Mr,tr.commandStr),je="1f";break;case vd:tt.command(or(di)&&di.length===2,"uniform "+Mr,tr.commandStr),je="2f";break;case of:tt.command(or(di)&&di.length===3,"uniform "+Mr,tr.commandStr),je="3f";break;case Wh:tt.command(or(di)&&di.length===4,"uniform "+Mr,tr.commandStr),je="4f";break;case md:tt.commandType(di,"boolean","uniform "+Mr,tr.commandStr),je="1i";break;case xc:tt.commandType(di,"number","uniform "+Mr,tr.commandStr),je="1i";break;case uv:tt.command(or(di)&&di.length===2,"uniform "+Mr,tr.commandStr),je="2i";break;case gd:tt.command(or(di)&&di.length===2,"uniform "+Mr,tr.commandStr),je="2i";break;case Pp:tt.command(or(di)&&di.length===3,"uniform "+Mr,tr.commandStr),je="3i";break;case nh:tt.command(or(di)&&di.length===3,"uniform "+Mr,tr.commandStr),je="3i";break;case Xh:tt.command(or(di)&&di.length===4,"uniform "+Mr,tr.commandStr),je="4i";break;case t0:tt.command(or(di)&&di.length===4,"uniform "+Mr,tr.commandStr),je="4i";break}Te(Rr,".uniform",je,"(",li,",",or(di)?Array.prototype.slice.call(di):di,");")}continue}else wi=Bn.append(tr,Te)}else{if(!$r(cv))continue;wi=Te.def(Ye.uniforms,"[",Re.id(Mr),"]")}qr===Op?(tt(!Array.isArray(wi),"must specify a scalar prop for textures"),Te("if(",wi,"&&",wi,'._reglType==="framebuffer"){',wi,"=",wi,".color[0];","}")):qr===Fp&&(tt(!Array.isArray(wi),"must specify a scalar prop for cube maps"),Te("if(",wi,"&&",wi,'._reglType==="framebufferCube"){',wi,"=",wi,".color[0];","}")),tt.optional(function(){function ll(Xl,ih){tr.assert(Te,Xl,'bad data or missing for uniform "'+Mr+'".  '+ih)}function Dc(Xl){tt(!Array.isArray(wi),"must not specify an array type for uniform"),ll("typeof "+wi+'==="'+Xl+'"',"invalid type, expected "+Xl)}function Ec(Xl,ih){Array.isArray(wi)?tt(wi.length===Xl,"must have length "+Xl):ll(Ye.isArrayLike+"("+wi+")&&"+wi+".length==="+Xl,"invalid vector, should have length "+Xl,tr.commandStr)}function vv(Xl){tt(!Array.isArray(wi),"must not specify a value type"),ll("typeof "+wi+'==="function"&&'+wi+'._reglType==="texture'+(Xl===rh?"2d":"Cube")+'"',"invalid texture type",tr.commandStr)}switch(qr){case xc:Dc("number");break;case gd:Ec(2,"number");break;case nh:Ec(3,"number");break;case t0:Ec(4,"number");break;case Jv:Dc("number");break;case vd:Ec(2,"number");break;case of:Ec(3,"number");break;case Wh:Ec(4,"number");break;case md:Dc("boolean");break;case uv:Ec(2,"boolean");break;case Pp:Ec(3,"boolean");break;case Xh:Ec(4,"boolean");break;case gl:Ec(4,"number");break;case yd:Ec(9,"number");break;case kf:Ec(16,"number");break;case Op:vv(rh);break;case Fp:vv(ei);break}});var Ui=1;switch(qr){case Op:case Fp:var Hi=Te.def(wi,"._texture");Te(Rr,".uniform1i(",li,",",Hi,".bind());"),Te.exit(Hi,".unbind();");continue;case xc:case md:je="1i";break;case gd:case uv:je="2i",Ui=2;break;case nh:case Pp:je="3i",Ui=3;break;case t0:case Xh:je="4i",Ui=4;break;case Jv:je="1f";break;case vd:je="2f",Ui=2;break;case of:je="3f",Ui=3;break;case Wh:je="4f",Ui=4;break;case gl:je="Matrix2fv";break;case yd:je="Matrix3fv";break;case kf:je="Matrix4fv";break}if(je.charAt(0)==="M"){Te(Rr,".uniform",je,"(",li,",");var ba=Math.pow(qr-gl+2,2),Xo=tr.global.def("new Float32Array(",ba,")");Array.isArray(wi)?Te("false,(",cr(ba,function(ll){return Xo+"["+ll+"]="+wi[ll]}),",",Xo,")"):Te("false,(Array.isArray(",wi,")||",wi," instanceof Float32Array)?",wi,":(",cr(ba,function(ll){return Xo+"["+ll+"]="+wi+"["+ll+"]"}),",",Xo,")"),Te(");")}else if(Ui>1){for(var Ou=[],fs=[],Lo=0;Lo<Ui;++Lo)Array.isArray(wi)?fs.push(wi[Lo]):fs.push(Te.def(wi+"["+Lo+"]")),Ar&&Ou.push(Te.def());Ar&&Te("if(!",tr.batchId,"||",Ou.map(function(ll,Dc){return ll+"!=="+fs[Dc]}).join("||"),"){",Ou.map(function(ll,Dc){return ll+"="+fs[Dc]+";"}).join("")),Te(Rr,".uniform",je,"(",li,",",fs.join(","),");"),Ar&&Te("}")}else{if(tt(!Array.isArray(wi),"uniform value must not be an array"),Ar){var Of=Te.def();Te("if(!",tr.batchId,"||",Of,"!==",wi,"){",Of,"=",wi,";")}Te(Rr,".uniform",je,"(",li,",",wi,");"),Ar&&Te("}")}}}function Pu(tr,Te,xr,kr){var $r=tr.shared,Ar=$r.gl,Ye=$r.draw,Rr=kr.draw;function je(){var Ui=Rr.elements,Hi,ba=Te;return Ui?((Ui.contextDep&&kr.contextDynamic||Ui.propDep)&&(ba=xr),Hi=Ui.append(tr,ba),Rr.elementsActive&&ba("if("+Hi+")"+Ar+".bindBuffer("+Lp+","+Hi+".buffer.buffer);")):(Hi=ba.def(),ba(Hi,"=",Ye,".",Ll,";","if(",Hi,"){",Ar,".bindBuffer(",Lp,",",Hi,".buffer.buffer);}","else if(",$r.vao,".currentVAO){",Hi,"=",tr.shared.elements+".getElements("+$r.vao,".currentVAO.elements);",Dn?"":"if("+Hi+")"+Ar+".bindBuffer("+Lp+","+Hi+".buffer.buffer);","}")),Hi}function mr(){var Ui=Rr.count,Hi,ba=Te;return Ui?((Ui.contextDep&&kr.contextDynamic||Ui.propDep)&&(ba=xr),Hi=Ui.append(tr,ba),tt.optional(function(){Ui.MISSING&&tr.assert(Te,"false","missing vertex count"),Ui.DYNAMIC&&tr.assert(ba,Hi+">=0","missing vertex count")})):(Hi=ba.def(Ye,".",Fc),tt.optional(function(){tr.assert(ba,Hi+">=0","missing vertex count")})),Hi}var rr=je();function Mr(Ui){var Hi=Rr[Ui];return Hi?Hi.contextDep&&kr.contextDynamic||Hi.propDep?Hi.append(tr,xr):Hi.append(tr,Te):Te.def(Ye,".",Ui)}var qr=Mr(ou),Bn=Mr(_h),ti=mr();if(typeof ti=="number"){if(ti===0)return}else xr("if(",ti,"){"),xr.exit("}");var li,wi;jn&&(li=Mr(_c),wi=tr.instancing);var di=rr+".type",Ni=Rr.elements&&Pf(Rr.elements)&&!Rr.vaoActive;function Oi(){function Ui(){xr(wi,".drawElementsInstancedANGLE(",[qr,ti,di,Bn+"<<(("+di+"-"+Aa+")>>1)",li],");")}function Hi(){xr(wi,".drawArraysInstancedANGLE(",[qr,Bn,ti,li],");")}rr&&rr!=="null"?Ni?Ui():(xr("if(",rr,"){"),Ui(),xr("}else{"),Hi(),xr("}")):Hi()}function zi(){function Ui(){xr(Ar+".drawElements("+[qr,ti,di,Bn+"<<(("+di+"-"+Aa+")>>1)"]+");")}function Hi(){xr(Ar+".drawArrays("+[qr,Bn,ti]+");")}rr&&rr!=="null"?Ni?Ui():(xr("if(",rr,"){"),Ui(),xr("}else{"),Hi(),xr("}")):Hi()}jn&&(typeof li!="number"||li>=0)?typeof li=="string"?(xr("if(",li,">0){"),Oi(),xr("}else if(",li,"<0){"),zi(),xr("}")):Oi():zi()}function ha(tr,Te,xr,kr,$r){var Ar=wa(),Ye=Ar.proc("body",$r);return tt.optional(function(){Ar.commandStr=Te.commandStr,Ar.command=Ar.link(Te.commandStr)}),jn&&(Ar.instancing=Ye.def(Ar.shared.extensions,".angle_instanced_arrays")),tr(Ar,Ye,xr,kr),Ar.compile().body}function ao(tr,Te,xr,kr){ks(tr,Te),xr.useVAO?xr.drawVAO?Te(tr.shared.vao,".setVAO(",xr.drawVAO.append(tr,Te),");"):Te(tr.shared.vao,".setVAO(",tr.shared.vao,".targetVAO);"):(Te(tr.shared.vao,".setVAO(null);"),$s(tr,Te,xr,kr.attributes,function(){return!0})),bo(tr,Te,xr,kr.uniforms,function(){return!0},!1),Pu(tr,Te,Te,xr)}function wo(tr,Te){var xr=tr.proc("draw",1);ks(tr,xr),Qo(tr,xr,Te.context),Lu(tr,xr,Te.framebuffer),Vs(tr,xr,Te),Gu(tr,xr,Te.state),Da(tr,xr,Te,!1,!0);var kr=Te.shader.progVar.append(tr,xr);if(xr(tr.shared.gl,".useProgram(",kr,".program);"),Te.shader.program)ao(tr,xr,Te,Te.shader.program);else{xr(tr.shared.vao,".setVAO(null);");var $r=tr.global.def("{}"),Ar=xr.def(kr,".id"),Ye=xr.def($r,"[",Ar,"]");xr(tr.cond(Ye).then(Ye,".call(this,a0);").else(Ye,"=",$r,"[",Ar,"]=",tr.link(function(Rr){return ha(ao,tr,Te,Rr,1)}),"(",kr,");",Ye,".call(this,a0);"))}Object.keys(Te.state).length>0&&xr(tr.shared.current,".dirty=true;"),tr.shared.vao&&xr(tr.shared.vao,".setVAO(null);")}function Ds(tr,Te,xr,kr){tr.batchId="a1",ks(tr,Te);function $r(){return!0}$s(tr,Te,xr,kr.attributes,$r),bo(tr,Te,xr,kr.uniforms,$r,!1),Pu(tr,Te,Te,xr)}function Wl(tr,Te,xr,kr){ks(tr,Te);var $r=xr.contextDep,Ar=Te.def(),Ye="a0",Rr="a1",je=Te.def();tr.shared.props=je,tr.batchId=Ar;var mr=tr.scope(),rr=tr.scope();Te(mr.entry,"for(",Ar,"=0;",Ar,"<",Rr,";++",Ar,"){",je,"=",Ye,"[",Ar,"];",rr,"}",mr.exit);function Mr(di){return di.contextDep&&$r||di.propDep}function qr(di){return!Mr(di)}if(xr.needsContext&&Qo(tr,rr,xr.context),xr.needsFramebuffer&&Lu(tr,rr,xr.framebuffer),Gu(tr,rr,xr.state,Mr),xr.profile&&Mr(xr.profile)&&Da(tr,rr,xr,!1,!0),kr)xr.useVAO?xr.drawVAO?Mr(xr.drawVAO)?rr(tr.shared.vao,".setVAO(",xr.drawVAO.append(tr,rr),");"):mr(tr.shared.vao,".setVAO(",xr.drawVAO.append(tr,mr),");"):mr(tr.shared.vao,".setVAO(",tr.shared.vao,".targetVAO);"):(mr(tr.shared.vao,".setVAO(null);"),$s(tr,mr,xr,kr.attributes,qr),$s(tr,rr,xr,kr.attributes,Mr)),bo(tr,mr,xr,kr.uniforms,qr,!1),bo(tr,rr,xr,kr.uniforms,Mr,!0),Pu(tr,mr,rr,xr);else{var Bn=tr.global.def("{}"),ti=xr.shader.progVar.append(tr,rr),li=rr.def(ti,".id"),wi=rr.def(Bn,"[",li,"]");rr(tr.shared.gl,".useProgram(",ti,".program);","if(!",wi,"){",wi,"=",Bn,"[",li,"]=",tr.link(function(di){return ha(Ds,tr,xr,di,2)}),"(",ti,");}",wi,".call(this,a0[",Ar,"],",Ar,");")}}function sr(tr,Te){var xr=tr.proc("batch",2);tr.batchId="0",ks(tr,xr);var kr=!1,$r=!0;Object.keys(Te.context).forEach(function(Bn){kr=kr||Te.context[Bn].propDep}),kr||(Qo(tr,xr,Te.context),$r=!1);var Ar=Te.framebuffer,Ye=!1;Ar?(Ar.propDep?kr=Ye=!0:Ar.contextDep&&kr&&(Ye=!0),Ye||Lu(tr,xr,Ar)):Lu(tr,xr,null),Te.state.viewport&&Te.state.viewport.propDep&&(kr=!0);function Rr(Bn){return Bn.contextDep&&kr||Bn.propDep}Vs(tr,xr,Te),Gu(tr,xr,Te.state,function(Bn){return!Rr(Bn)}),(!Te.profile||!Rr(Te.profile))&&Da(tr,xr,Te,!1,"a1"),Te.contextDep=kr,Te.needsContext=$r,Te.needsFramebuffer=Ye;var je=Te.shader.progVar;if(je.contextDep&&kr||je.propDep)Wl(tr,xr,Te,null);else{var mr=je.append(tr,xr);if(xr(tr.shared.gl,".useProgram(",mr,".program);"),Te.shader.program)Wl(tr,xr,Te,Te.shader.program);else{xr(tr.shared.vao,".setVAO(null);");var rr=tr.global.def("{}"),Mr=xr.def(mr,".id"),qr=xr.def(rr,"[",Mr,"]");xr(tr.cond(qr).then(qr,".call(this,a0,a1);").else(qr,"=",rr,"[",Mr,"]=",tr.link(function(Bn){return ha(Wl,tr,Te,Bn,2)}),"(",mr,");",qr,".call(this,a0,a1);"))}}Object.keys(Te.state).length>0&&xr(tr.shared.current,".dirty=true;"),tr.shared.vao&&xr(tr.shared.vao,".setVAO(null);")}function fn(tr,Te){var xr=tr.proc("scope",3);tr.batchId="a2";var kr=tr.shared,$r=kr.current;Qo(tr,xr,Te.context),Te.framebuffer&&Te.framebuffer.append(tr,xr),n0(Object.keys(Te.state)).forEach(function(Ye){var Rr=Te.state[Ye],je=Rr.append(tr,xr);or(je)?je.forEach(function(mr,rr){xr.set(tr.next[Ye],"["+rr+"]",mr)}):xr.set(kr.next,"."+Ye,je)}),Da(tr,xr,Te,!0,!0),[Ll,_h,Fc,_c,ou].forEach(function(Ye){var Rr=Te.draw[Ye];Rr&&xr.set(kr.draw,"."+Ye,""+Rr.append(tr,xr))}),Object.keys(Te.uniforms).forEach(function(Ye){var Rr=Te.uniforms[Ye].append(tr,xr);Array.isArray(Rr)&&(Rr="["+Rr.join()+"]"),xr.set(kr.uniforms,"["+Re.id(Ye)+"]",Rr)}),Object.keys(Te.attributes).forEach(function(Ye){var Rr=Te.attributes[Ye].append(tr,xr),je=tr.scopeAttrib(Ye);Object.keys(new Zr).forEach(function(mr){xr.set(je,"."+mr,Rr[mr])})}),Te.scopeVAO&&xr.set(kr.vao,".targetVAO",Te.scopeVAO.append(tr,xr));function Ar(Ye){var Rr=Te.shader[Ye];Rr&&xr.set(kr.shader,"."+Ye,Rr.append(tr,xr))}Ar(yc),Ar(Mf),Object.keys(Te.state).length>0&&(xr($r,".dirty=true;"),xr.exit($r,".dirty=true;")),xr("a1(",tr.shared.context,",a0,",tr.batchId,");")}function rn(tr){if(!(typeof tr!="object"||or(tr))){for(var Te=Object.keys(tr),xr=0;xr<Te.length;++xr)if(Gr.isDynamic(tr[Te[xr]]))return!0;return!1}}function Gi(tr,Te,xr){var kr=Te.static[xr];if(!kr||!rn(kr))return;var $r=tr.global,Ar=Object.keys(kr),Ye=!1,Rr=!1,je=!1,mr=tr.global.def("{}");Ar.forEach(function(Mr){var qr=kr[Mr];if(Gr.isDynamic(qr)){typeof qr=="function"&&(qr=kr[Mr]=Gr.unbox(qr));var Bn=ul(qr,null);Ye=Ye||Bn.thisDep,je=je||Bn.propDep,Rr=Rr||Bn.contextDep}else{switch($r(mr,".",Mr,"="),typeof qr){case"number":$r(qr);break;case"string":$r('"',qr,'"');break;case"object":Array.isArray(qr)&&$r("[",qr.join(),"]");break;default:$r(tr.link(qr));break}$r(";")}});function rr(Mr,qr){Ar.forEach(function(Bn){var ti=kr[Bn];if(Gr.isDynamic(ti)){var li=Mr.invoke(qr,ti);qr(mr,".",Bn,"=",li,";")}})}Te.dynamic[xr]=new Gr.DynamicVariable(ru,{thisDep:Ye,contextDep:Rr,propDep:je,ref:mr,append:rr}),delete Te.static[xr]}function oo(tr,Te,xr,kr,$r){var Ar=wa();Ar.stats=Ar.link($r),Object.keys(Te.static).forEach(function(Rr){Gi(Ar,Te,Rr)}),xh.forEach(function(Rr){Gi(Ar,tr,Rr)});var Ye=du(tr,Te,xr,kr,Ar);return wo(Ar,Ye),fn(Ar,Ye),sr(Ar,Ye),k(Ar.compile(),{destroy:function(){Ye.shader.program.destroy()}})}return{next:Mi,current:ci,procs:function(){var tr=wa(),Te=tr.proc("poll"),xr=tr.proc("refresh"),kr=tr.block();Te(kr),xr(kr);var $r=tr.shared,Ar=$r.gl,Ye=$r.next,Rr=$r.current;kr(Rr,".dirty=false;"),Lu(tr,Te),Lu(tr,xr,null,!0);var je;jn&&(je=tr.link(jn)),dr.oes_vertex_array_object&&xr(tr.link(dr.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var mr=0;mr<ln.maxAttributes;++mr){var rr=xr.def($r.attributes,"[",mr,"]"),Mr=tr.cond(rr,".buffer");Mr.then(Ar,".enableVertexAttribArray(",mr,");",Ar,".bindBuffer(",bh,",",rr,".buffer.buffer);",Ar,".vertexAttribPointer(",mr,",",rr,".size,",rr,".type,",rr,".normalized,",rr,".stride,",rr,".offset);").else(Ar,".disableVertexAttribArray(",mr,");",Ar,".vertexAttrib4f(",mr,",",rr,".x,",rr,".y,",rr,".z,",rr,".w);",rr,".buffer=null;"),xr(Mr),jn&&xr(je,".vertexAttribDivisorANGLE(",mr,",",rr,".divisor);")}return xr(tr.shared.vao,".currentVAO=null;",tr.shared.vao,".setVAO(",tr.shared.vao,".targetVAO);"),Object.keys(wn).forEach(function(qr){var Bn=wn[qr],ti=kr.def(Ye,".",qr),li=tr.block();li("if(",ti,"){",Ar,".enable(",Bn,")}else{",Ar,".disable(",Bn,")}",Rr,".",qr,"=",ti,";"),xr(li),Te("if(",ti,"!==",Rr,".",qr,"){",li,"}")}),Object.keys(In).forEach(function(qr){var Bn=In[qr],ti=ci[qr],li,wi,di=tr.block();if(di(Ar,".",Bn,"("),or(ti)){var Ni=ti.length;li=tr.global.def(Ye,".",qr),wi=tr.global.def(Rr,".",qr),di(cr(Ni,function(Oi){return li+"["+Oi+"]"}),");",cr(Ni,function(Oi){return wi+"["+Oi+"]="+li+"["+Oi+"];"}).join("")),Te("if(",cr(Ni,function(Oi){return li+"["+Oi+"]!=="+wi+"["+Oi+"]"}).join("||"),"){",di,"}")}else li=kr.def(Ye,".",qr),wi=kr.def(Rr,".",qr),di(li,");",Rr,".",qr,"=",li,";"),Te("if(",li,"!==",wi,"){",di,"}");xr(di)}),tr.compile()}(),compile:oo}}function Dg(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Bg=34918,fv=34919,hv=35007,i0=function(It,Re){if(!Re.ext_disjoint_timer_query)return null;var dr=[];function ln(){return dr.pop()||Re.ext_disjoint_timer_query.createQueryEXT()}function Ln(jn){dr.push(jn)}var on=[];function En(jn){var gi=ln();Re.ext_disjoint_timer_query.beginQueryEXT(hv,gi),on.push(gi),qn(on.length-1,on.length,jn)}function jr(){Re.ext_disjoint_timer_query.endQueryEXT(hv)}function Xn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Yn=[];function ni(){return Yn.pop()||new Xn}function Jn(jn){Yn.push(jn)}var yi=[];function qn(jn,gi,Dn){var ci=ni();ci.startQueryIndex=jn,ci.endQueryIndex=gi,ci.sum=0,ci.stats=Dn,yi.push(ci)}var ri=[],Zr=[];function mn(){var jn,gi,Dn=on.length;if(Dn!==0){Zr.length=Math.max(Zr.length,Dn+1),ri.length=Math.max(ri.length,Dn+1),ri[0]=0,Zr[0]=0;var ci=0;for(jn=0,gi=0;gi<on.length;++gi){var Mi=on[gi];Re.ext_disjoint_timer_query.getQueryObjectEXT(Mi,fv)?(ci+=Re.ext_disjoint_timer_query.getQueryObjectEXT(Mi,Bg),Ln(Mi)):on[jn++]=Mi,ri[gi+1]=ci,Zr[gi+1]=jn}for(on.length=jn,jn=0,gi=0;gi<yi.length;++gi){var la=yi[gi],wn=la.startQueryIndex,In=la.endQueryIndex;la.sum+=ri[In]-ri[wn];var Wi=Zr[wn],bi=Zr[In];bi===Wi?(la.stats.gpuTime+=la.sum/1e6,Jn(la)):(la.startQueryIndex=Wi,la.endQueryIndex=bi,yi[jn++]=la)}yi.length=jn}}return{beginQuery:En,endQuery:jr,pushScopeStats:qn,update:mn,getNumPendingQueries:function(){return on.length},clear:function(){dr.push.apply(dr,on);for(var jn=0;jn<dr.length;jn++)Re.ext_disjoint_timer_query.deleteQueryEXT(dr[jn]);on.length=0,dr.length=0},restore:function(){on.length=0,dr.length=0}}},a0=16384,Ch=256,o0=1024,pv=34962,Ah="webglcontextlost",ns="webglcontextrestored",dv=1,cc=2,fc=3;function s0(It,Re){for(var dr=0;dr<It.length;++dr)if(It[dr]===Re)return dr;return-1}function $h(It){var Re=we(It);if(!Re)return null;var dr=Re.gl,ln=dr.getContextAttributes(),Ln=dr.isContextLost(),on=Ge(dr,Re);if(!on)return null;var En=Zn(),jr=Dg(),Xn=on.extensions,Yn=i0(dr,Xn),ni=Nn(),Jn=dr.drawingBufferWidth,yi=dr.drawingBufferHeight,qn={tick:0,time:0,viewportWidth:Jn,viewportHeight:yi,framebufferWidth:Jn,framebufferHeight:yi,drawingBufferWidth:Jn,drawingBufferHeight:yi,pixelRatio:Re.pixelRatio},ri={},Zr={elements:null,primitive:4,count:-1,offset:0,instances:-1},mn=Hc(dr,Xn),jn=Mt(dr,jr,Re,ci),gi=Fl(dr,Xn,jn,jr),Dn=Yr(dr,Xn,mn,jr,jn,gi,Zr);function ci(ha){return Dn.destroyBuffer(ha)}var Mi=ui(dr,En,jr,Re),la=fu(dr,Xn,mn,function(){Wi.procs.poll()},qn,jr,Re),wn=$f(dr,Xn,mn,jr,Re),In=fr(dr,Xn,mn,la,wn,jr),Wi=$0(dr,En,Xn,mn,jn,gi,la,In,ri,Dn,Mi,Zr,qn,Yn,Re),bi=na(dr,In,Wi.procs.poll,qn,ln,Xn,mn),Qn=Wi.next,pi=dr.canvas,hi=[],Na=[],wa=[],Ei=[Re.onDestroy],Li=null;function ga(){if(hi.length===0){Yn&&Yn.update(),Li=null;return}Li=Sn.next(ga),ks();for(var ha=hi.length-1;ha>=0;--ha){var ao=hi[ha];ao&&ao(qn,null,0)}dr.flush(),Yn&&Yn.update()}function Ta(){!Li&&hi.length>0&&(Li=Sn.next(ga))}function no(){Li&&(Sn.cancel(ga),Li=null)}function ws(ha){ha.preventDefault(),Ln=!0,no(),Na.forEach(function(ao){ao()})}function Ss(ha){dr.getError(),Ln=!1,on.restore(),Mi.restore(),jn.restore(),la.restore(),wn.restore(),In.restore(),Dn.restore(),Yn&&Yn.restore(),Wi.procs.refresh(),Ta(),wa.forEach(function(ao){ao()})}var io=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!io&&pi&&(pi.addEventListener(Ah,ws,!1),pi.addEventListener(ns,Ss,!1));function Bo(){hi.length=0,no(),!io&&pi&&(pi.removeEventListener(Ah,ws),pi.removeEventListener(ns,Ss)),Mi.clear(),In.clear(),wn.clear(),Dn.clear(),la.clear(),gi.clear(),jn.clear(),Yn&&Yn.clear(),Ei.forEach(function(ha){ha()})}function Es(ha){tt(!!ha,"invalid args to regl({...})"),tt.type(ha,"object","invalid args to regl({...})");function ao(Ar){var Ye=k({},Ar);delete Ye.uniforms,delete Ye.attributes,delete Ye.context,delete Ye.vao,"stencil"in Ye&&Ye.stencil.op&&(Ye.stencil.opBack=Ye.stencil.opFront=Ye.stencil.op,delete Ye.stencil.op);function Rr(je){if(je in Ye){var mr=Ye[je];delete Ye[je],Object.keys(mr).forEach(function(rr){Ye[je+"."+rr]=mr[rr]})}}return Rr("blend"),Rr("depth"),Rr("cull"),Rr("stencil"),Rr("polygonOffset"),Rr("scissor"),Rr("sample"),"vao"in Ar&&(Ye.vao=Ar.vao),Ye}function wo(Ar,Ye){var Rr={},je={};return Object.keys(Ar).forEach(function(mr){var rr=Ar[mr];if(Gr.isDynamic(rr)){je[mr]=Gr.unbox(rr,mr);return}else if(Ye&&Array.isArray(rr)){for(var Mr=0;Mr<rr.length;++Mr)if(Gr.isDynamic(rr[Mr])){je[mr]=Gr.unbox(rr,mr);return}}Rr[mr]=rr}),{dynamic:je,static:Rr}}var Ds=wo(ha.context||{},!0),Wl=wo(ha.uniforms||{},!0),sr=wo(ha.attributes||{},!1),fn=wo(ao(ha),!1),rn={gpuTime:0,cpuTime:0,count:0},Gi=Wi.compile(fn,sr,Wl,Ds,rn),oo=Gi.draw,tr=Gi.batch,Te=Gi.scope,xr=[];function kr(Ar){for(;xr.length<Ar;)xr.push(null);return xr}function $r(Ar,Ye){var Rr;if(Ln&&tt.raise("context lost"),typeof Ar=="function")return Te.call(this,null,Ar,0);if(typeof Ye=="function")if(typeof Ar=="number")for(Rr=0;Rr<Ar;++Rr)Te.call(this,null,Ye,Rr);else if(Array.isArray(Ar))for(Rr=0;Rr<Ar.length;++Rr)Te.call(this,Ar[Rr],Ye,Rr);else return Te.call(this,Ar,Ye,0);else if(typeof Ar=="number"){if(Ar>0)return tr.call(this,kr(Ar|0),Ar|0)}else if(Array.isArray(Ar)){if(Ar.length)return tr.call(this,Ar,Ar.length)}else return oo.call(this,Ar)}return k($r,{stats:rn,destroy:function(){Gi.destroy()}})}var du=In.setFBO=Es({framebuffer:Gr.define.call(null,dv,"framebuffer")});function Qo(ha,ao){var wo=0;Wi.procs.poll();var Ds=ao.color;Ds&&(dr.clearColor(+Ds[0]||0,+Ds[1]||0,+Ds[2]||0,+Ds[3]||0),wo|=a0),"depth"in ao&&(dr.clearDepth(+ao.depth),wo|=Ch),"stencil"in ao&&(dr.clearStencil(ao.stencil|0),wo|=o0),tt(!!wo,"called regl.clear with no buffer specified"),dr.clear(wo)}function Lu(ha){if(tt(typeof ha=="object"&&ha,"regl.clear() takes an object as input"),"framebuffer"in ha)if(ha.framebuffer&&ha.framebuffer_reglType==="framebufferCube")for(var ao=0;ao<6;++ao)du(k({framebuffer:ha.framebuffer.faces[ao]},ha),Qo);else du(ha,Qo);else Qo(null,ha)}function Vs(ha){tt.type(ha,"function","regl.frame() callback must be a function"),hi.push(ha);function ao(){var wo=s0(hi,ha);tt(wo>=0,"cannot cancel a frame twice");function Ds(){var Wl=s0(hi,Ds);hi[Wl]=hi[hi.length-1],hi.length-=1,hi.length<=0&&no()}hi[wo]=Ds}return Ta(),{cancel:ao}}function Gu(){var ha=Qn.viewport,ao=Qn.scissor_box;ha[0]=ha[1]=ao[0]=ao[1]=0,qn.viewportWidth=qn.framebufferWidth=qn.drawingBufferWidth=ha[2]=ao[2]=dr.drawingBufferWidth,qn.viewportHeight=qn.framebufferHeight=qn.drawingBufferHeight=ha[3]=ao[3]=dr.drawingBufferHeight}function ks(){qn.tick+=1,qn.time=$s(),Gu(),Wi.procs.poll()}function Da(){la.refresh(),Gu(),Wi.procs.refresh(),Yn&&Yn.update()}function $s(){return(Nn()-ni)/1e3}Da();function bo(ha,ao){tt.type(ao,"function","listener callback must be a function");var wo;switch(ha){case"frame":return Vs(ao);case"lost":wo=Na;break;case"restore":wo=wa;break;case"destroy":wo=Ei;break;default:tt.raise("invalid event, must be one of frame,lost,restore,destroy")}return wo.push(ao),{cancel:function(){for(var Ds=0;Ds<wo.length;++Ds)if(wo[Ds]===ao){wo[Ds]=wo[wo.length-1],wo.pop();return}}}}var Pu=k(Es,{clear:Lu,prop:Gr.define.bind(null,dv),context:Gr.define.bind(null,cc),this:Gr.define.bind(null,fc),draw:Es({}),buffer:function(ha){return jn.create(ha,pv,!1,!1)},elements:function(ha){return gi.create(ha,!1)},texture:la.create2D,cube:la.createCube,renderbuffer:wn.create,framebuffer:In.create,framebufferCube:In.createCube,vao:Dn.createVAO,attributes:ln,frame:Vs,on:bo,limits:mn,hasExtension:function(ha){return mn.extensions.indexOf(ha.toLowerCase())>=0},read:bi,destroy:Bo,_gl:dr,_refresh:Da,poll:function(){ks(),Yn&&Yn.update()},now:$s,stats:jr});return Re.onDone(null,Pu),Pu}return $h})},80966:function(dn){(function(Pt,nt){dn.exports=nt()})(this,function(){"use strict";var Pt,nt,kt;function mt(k,Et){if(!Pt)Pt=Et;else if(!nt)nt=Et;else{var K="var sharedChunk = {}; ("+Pt+")(sharedChunk); ("+nt+")(sharedChunk);",yt={};Pt(yt),kt=Et(yt),typeof window!="undefined"&&(kt.workerUrl=window.URL.createObjectURL(new Blob([K],{type:"text/javascript"})))}}return mt(["exports"],function(k){"use strict";function Et(f,d){return f(d={exports:{}},d.exports),d.exports}var K=yt;function yt(f,d,y,T){this.cx=3*f,this.bx=3*(y-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(T-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=T,this.p2x=y,this.p2y=T}yt.prototype.sampleCurveX=function(f){return((this.ax*f+this.bx)*f+this.cx)*f},yt.prototype.sampleCurveY=function(f){return((this.ay*f+this.by)*f+this.cy)*f},yt.prototype.sampleCurveDerivativeX=function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},yt.prototype.solveCurveX=function(f,d){var y,T,O,N,Z;for(d===void 0&&(d=1e-6),O=f,Z=0;Z<8;Z++){if(N=this.sampleCurveX(O)-f,Math.abs(N)<d)return O;var q=this.sampleCurveDerivativeX(O);if(Math.abs(q)<1e-6)break;O-=N/q}if((O=f)<(y=0))return y;if(O>(T=1))return T;for(;y<T;){if(N=this.sampleCurveX(O),Math.abs(N-f)<d)return O;f>N?y=O:T=O,O=.5*(T-y)+y}return O},yt.prototype.solve=function(f,d){return this.sampleCurveY(this.solveCurveX(f,d))};var J=pt;function pt(f,d){this.x=f,this.y=d}pt.prototype={clone:function(){return new pt(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,d){return this.clone()._rotateAround(f,d)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var d=f.x-this.x,y=f.y-this.y;return d*d+y*y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,d){return Math.atan2(this.x*d-this.y*f,this.x*f+this.y*d)},_matMult:function(f){var d=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=d,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var d=Math.cos(f),y=Math.sin(f),T=y*this.x+d*this.y;return this.x=d*this.x-y*this.y,this.y=T,this},_rotateAround:function(f,d){var y=Math.cos(f),T=Math.sin(f),O=d.y+T*(this.x-d.x)+y*(this.y-d.y);return this.x=d.x+y*(this.x-d.x)-T*(this.y-d.y),this.y=O,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},pt.convert=function(f){return f instanceof pt?f:Array.isArray(f)?new pt(f[0],f[1]):f};var et=typeof self!="undefined"?self:{},be=Math.pow(2,53)-1;function ot(f,d,y,T){var O=new K(f,d,y,T);return function(N){return O.solve(N)}}var ut=ot(.25,.1,.25,1);function zt(f,d,y){return Math.min(y,Math.max(d,f))}function P(f,d,y){var T=y-d,O=((f-d)%T+T)%T+d;return O===d?y:O}function b(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];for(var T=0,O=d;T<O.length;T+=1){var N=O[T];for(var Z in N)f[Z]=N[Z]}return f}var W=1;function le(){return W++}function Ee(){return function f(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,f)}()}function ke(f){return!!f&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(f)}function Tt(f,d){f.forEach(function(y){d[y]&&(d[y]=d[y].bind(d))})}function rt(f,d){return f.indexOf(d,f.length-d.length)!==-1}function Dt(f,d,y){var T={};for(var O in f)T[O]=d.call(y||this,f[O],O,f);return T}function Se(f,d,y){var T={};for(var O in f)d.call(y||this,f[O],O,f)&&(T[O]=f[O]);return T}function _e(f){return Array.isArray(f)?f.map(_e):typeof f=="object"&&f?Dt(f,_e):f}var ve={};function ne(f){ve[f]||(typeof console!="undefined"&&console.warn(f),ve[f]=!0)}function xe(f,d,y){return(y.y-f.y)*(d.x-f.x)>(d.y-f.y)*(y.x-f.x)}function Je(f){for(var d=0,y=0,T=f.length,O=T-1,N=void 0,Z=void 0;y<T;O=y++)d+=((Z=f[O]).x-(N=f[y]).x)*(N.y+Z.y);return d}function Ot(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function te(f){var d={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(T,O,N,Z){var q=N||Z;return d[O]=!q||q.toLowerCase(),""}),d["max-age"]){var y=parseInt(d["max-age"],10);isNaN(y)?delete d["max-age"]:d["max-age"]=y}return d}var ft=null;function wt(f){if(ft==null){var d=f.navigator?f.navigator.userAgent:null;ft=!!f.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return ft}function Y(f){try{var d=et[f];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch(y){return!1}}var gt,he,Oe,Le,Ve=et.performance&&et.performance.now?et.performance.now.bind(et.performance):Date.now.bind(Date),Bt=et.requestAnimationFrame||et.mozRequestAnimationFrame||et.webkitRequestAnimationFrame||et.msRequestAnimationFrame,re=et.cancelAnimationFrame||et.mozCancelAnimationFrame||et.webkitCancelAnimationFrame||et.msCancelAnimationFrame,ye={now:Ve,frame:function(f){var d=Bt(f);return{cancel:function(){return re(d)}}},getImageData:function(f,d){d===void 0&&(d=0);var y=et.document.createElement("canvas"),T=y.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return y.width=f.width,y.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-d,-d,f.width+2*d,f.height+2*d)},resolveURL:function(f){return gt||(gt=et.document.createElement("a")),gt.href=f,gt.href},hardwareConcurrency:et.navigator&&et.navigator.hardwareConcurrency||4,get devicePixelRatio(){return et.devicePixelRatio},get prefersReducedMotion(){return!!et.matchMedia&&(he==null&&(he=et.matchMedia("(prefers-reduced-motion: reduce)")),he.matches)}},Yt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},qe={supported:!1,testSupport:function(f){!vr&&Le&&(oe?qt(f):Oe=f)}},vr=!1,oe=!1;function qt(f){var d=f.createTexture();f.bindTexture(f.TEXTURE_2D,d);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Le),f.isContextLost())return;qe.supported=!0}catch(y){}f.deleteTexture(d),vr=!0}et.document&&((Le=et.document.createElement("img")).onload=function(){Oe&&qt(Oe),Oe=null,oe=!0},Le.onerror=function(){vr=!0,Oe=null},Le.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var bt="01",Wt=function(f,d){this._transformRequestFn=f,this._customAccessToken=d,this._createSkuToken()};function $t(f){return f.indexOf("mapbox:")===0}Wt.prototype._createSkuToken=function(){var f=function(){for(var d="",y=0;y<10;y++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",bt,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=f.token,this._skuTokenExpiresAt=f.tokenExpiresAt},Wt.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Wt.prototype.transformRequest=function(f,d){return this._transformRequestFn&&this._transformRequestFn(f,d)||{url:f}},Wt.prototype.normalizeStyleURL=function(f,d){if(!$t(f))return f;var y=Pe(f);return y.path="/styles/v1"+y.path,this._makeAPIURL(y,this._customAccessToken||d)},Wt.prototype.normalizeGlyphsURL=function(f,d){if(!$t(f))return f;var y=Pe(f);return y.path="/fonts/v1"+y.path,this._makeAPIURL(y,this._customAccessToken||d)},Wt.prototype.normalizeSourceURL=function(f,d){if(!$t(f))return f;var y=Pe(f);return y.path="/v4/"+y.authority+".json",y.params.push("secure"),this._makeAPIURL(y,this._customAccessToken||d)},Wt.prototype.normalizeSpriteURL=function(f,d,y,T){var O=Pe(f);return $t(f)?(O.path="/styles/v1"+O.path+"/sprite"+d+y,this._makeAPIURL(O,this._customAccessToken||T)):(O.path+=""+d+y,ze(O))},Wt.prototype.normalizeTileURL=function(f,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),f&&!$t(f))return f;var y=Pe(f);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,(ye.devicePixelRatio>=2||d===512?"@2x":"")+(qe.supported?".webp":"$1")),y.path=y.path.replace(/^.+\/v4\//,"/"),y.path="/v4"+y.path;var T=this._customAccessToken||function(O){for(var N=0,Z=O;N<Z.length;N+=1){var q=Z[N].match(/^access_token=(.*)$/);if(q)return q[1]}return null}(y.params)||Yt.ACCESS_TOKEN;return Yt.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&y.params.push("sku="+this._skuToken),this._makeAPIURL(y,T)},Wt.prototype.canonicalizeTileURL=function(f,d){var y=Pe(f);if(!y.path.match(/(^\/v4\/)/)||!y.path.match(/\.[\w]+$/))return f;var T="mapbox://tiles/";T+=y.path.replace("/v4/","");var O=y.params;return d&&(O=O.filter(function(N){return!N.match(/^access_token=/)})),O.length&&(T+="?"+O.join("&")),T},Wt.prototype.canonicalizeTileset=function(f,d){for(var y=!!d&&$t(d),T=[],O=0,N=f.tiles||[];O<N.length;O+=1){var Z=N[O];St(Z)?T.push(this.canonicalizeTileURL(Z,y)):T.push(Z)}return T},Wt.prototype._makeAPIURL=function(f,d){var y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",T=Pe(Yt.API_URL);if(f.protocol=T.protocol,f.authority=T.authority,f.protocol==="http"){var O=f.params.indexOf("secure");O>=0&&f.params.splice(O,1)}if(T.path!=="/"&&(f.path=""+T.path+f.path),!Yt.REQUIRE_ACCESS_TOKEN)return ze(f);if(!(d=d||Yt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+y);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+y);return f.params=f.params.filter(function(N){return N.indexOf("access_token")===-1}),f.params.push("access_token="+d),ze(f)};var xt=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function St(f){return xt.test(f)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Pe(f){var d=f.match(ue);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function ze(f){var d=f.params.length?"?"+f.params.join("&"):"";return f.protocol+"://"+f.authority+f.path+d}function Vt(f){if(!f)return null;var d=f.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(et.atob(d[1]).split("").map(function(y){return"%"+("00"+y.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(y){return null}}var Ct=function(f){this.type=f,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Ct.prototype.getStorageKey=function(f){var d,y=Vt(Yt.ACCESS_TOKEN);return d=y&&y.u?et.btoa(encodeURIComponent(y.u).replace(/%([0-9A-F]{2})/g,function(T,O){return String.fromCharCode(Number("0x"+O))})):Yt.ACCESS_TOKEN||"",f?"mapbox.eventData."+f+":"+d:"mapbox.eventData:"+d},Ct.prototype.fetchEventData=function(){var f=Y("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(f)try{var T=et.localStorage.getItem(d);T&&(this.eventData=JSON.parse(T));var O=et.localStorage.getItem(y);O&&(this.anonId=O)}catch(N){ne("Unable to read from LocalStorage")}},Ct.prototype.saveEventData=function(){var f=Y("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(f)try{et.localStorage.setItem(y,this.anonId),Object.keys(this.eventData).length>=1&&et.localStorage.setItem(d,JSON.stringify(this.eventData))}catch(T){ne("Unable to write to LocalStorage")}},Ct.prototype.processRequests=function(f){},Ct.prototype.postEvent=function(f,d,y,T){var O=this;if(Yt.EVENTS_URL){var N=Pe(Yt.EVENTS_URL);N.params.push("access_token="+(T||Yt.ACCESS_TOKEN||""));var Z={event:this.type,created:new Date(f).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.3",skuId:bt,userId:this.anonId},q=d?b(Z,d):Z,dt={url:ze(N),headers:{"Content-Type":"text/plain"},body:JSON.stringify([q])};this.pendingRequest=$n(dt,function(Lt){O.pendingRequest=null,y(Lt),O.saveEventData(),O.processRequests(T)})}},Ct.prototype.queueRequest=function(f,d){this.queue.push(f),this.processRequests(d)};var At,Nt,tt=function(f){function d(){f.call(this,"map.load"),this.success={},this.skuToken=""}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(y,T,O,N){this.skuToken=O;var Z=!(!N&&!Yt.ACCESS_TOKEN),q=Array.isArray(y)&&y.some(function(dt){return $t(dt)||St(dt)});Yt.EVENTS_URL&&Z&&q&&this.queueRequest({id:T,timestamp:Date.now()},N)},d.prototype.processRequests=function(y){var T=this;if(!this.pendingRequest&&this.queue.length!==0){var O=this.queue.shift(),N=O.id,Z=O.timestamp;N&&this.success[N]||(this.anonId||this.fetchEventData(),ke(this.anonId)||(this.anonId=Ee()),this.postEvent(Z,{skuToken:this.skuToken},function(q){q||N&&(T.success[N]=!0)},y))}},d}(Ct),vt=new(function(f){function d(y){f.call(this,"appUserTurnstile"),this._customAccessToken=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(y,T){Yt.EVENTS_URL&&Yt.ACCESS_TOKEN&&Array.isArray(y)&&y.some(function(O){return $t(O)||St(O)})&&this.queueRequest(Date.now(),T)},d.prototype.processRequests=function(y){var T=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var O=Vt(Yt.ACCESS_TOKEN),N=O?O.u:Yt.ACCESS_TOKEN,Z=N!==this.eventData.tokenU;ke(this.anonId)||(this.anonId=Ee(),Z=!0);var q=this.queue.shift();if(this.eventData.lastSuccess){var dt=new Date(this.eventData.lastSuccess),Lt=new Date(q),Gt=(q-this.eventData.lastSuccess)/864e5;Z=Z||Gt>=1||Gt<-1||dt.getDate()!==Lt.getDate()}else Z=!0;if(!Z)return this.processRequests();this.postEvent(q,{"enabled.telemetry":!1},function(Qt){Qt||(T.eventData.lastSuccess=q,T.eventData.tokenU=N)},y)}},d}(Ct)),Ht=vt.postTurnstileEvent.bind(vt),de=new tt,jt=de.postMapLoadEvent.bind(de),Ie=500,We=50;function Ke(){et.caches&&!At&&(At=et.caches.open("mapbox-tiles"))}function pr(f){var d=f.indexOf("?");return d<0?f:f.slice(0,d)}var lr,Nr=1/0;function Pr(){return lr==null&&(lr=et.OffscreenCanvas&&new et.OffscreenCanvas(1,1).getContext("2d")&&typeof et.createImageBitmap=="function"),lr}var Gr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Gr);var Sn=function(f){function d(y,T,O){T===401&&St(O)&&(y+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),f.call(this,y),this.status=T,this.url=O,this.name=this.constructor.name,this.message=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),nn=Ot()?function(){return self.worker&&self.worker.referrer}:function(){return(et.location.protocol==="blob:"?et.parent:et).location.href},Nn,Zn,Hn=function(f,d){if(!(/^file:/.test(y=f.url)||/^file:/.test(nn())&&!/^\w+:/.test(y))){if(et.fetch&&et.Request&&et.AbortController&&et.Request.prototype.hasOwnProperty("signal"))return function(T,O){var N,Z=new et.AbortController,q=new et.Request(T.url,{method:T.method||"GET",body:T.body,credentials:T.credentials,headers:T.headers,referrer:nn(),signal:Z.signal}),dt=!1,Lt=!1,Gt=(N=q.url).indexOf("sku=")>0&&St(N);T.type==="json"&&q.headers.set("Accept","application/json");var Qt=function(Fe,nr,ur){if(!Lt){if(Fe&&Fe.message!=="SecurityError"&&ne(Fe),nr&&ur)return me(nr);var Sr=Date.now();et.fetch(q).then(function(gr){if(gr.ok){var Ur=Gt?gr.clone():null;return me(gr,Ur,Sr)}return O(new Sn(gr.statusText,gr.status,T.url))}).catch(function(gr){gr.code!==20&&O(new Error(gr.message))})}},me=function(Fe,nr,ur){(T.type==="arrayBuffer"?Fe.arrayBuffer():T.type==="json"?Fe.json():Fe.text()).then(function(Sr){Lt||(nr&&ur&&function(gr,Ur,tn){if(Ke(),At){var un={status:Ur.status,statusText:Ur.statusText,headers:new et.Headers};Ur.headers.forEach(function(Fn,ii){return un.headers.set(ii,Fn)});var yn=te(Ur.headers.get("Cache-Control")||"");yn["no-store"]||(yn["max-age"]&&un.headers.set("Expires",new Date(tn+1e3*yn["max-age"]).toUTCString()),new Date(un.headers.get("Expires")).getTime()-tn<42e4||function(Fn,ii){if(Nt===void 0)try{new Response(new ReadableStream),Nt=!0}catch(Si){Nt=!1}Nt?ii(Fn.body):Fn.blob().then(ii)}(Ur,function(Fn){var ii=new et.Response(Fn,un);Ke(),At&&At.then(function(Si){return Si.put(pr(gr.url),ii)}).catch(function(Si){return ne(Si.message)})}))}}(q,nr,ur),dt=!0,O(null,Sr,Fe.headers.get("Cache-Control"),Fe.headers.get("Expires")))}).catch(function(Sr){Lt||O(new Error(Sr.message))})};return Gt?function(Fe,nr){if(Ke(),!At)return nr(null);var ur=pr(Fe.url);At.then(function(Sr){Sr.match(ur).then(function(gr){var Ur=function(tn){if(!tn)return!1;var un=new Date(tn.headers.get("Expires")||0),yn=te(tn.headers.get("Cache-Control")||"");return un>Date.now()&&!yn["no-cache"]}(gr);Sr.delete(ur),Ur&&Sr.put(ur,gr.clone()),nr(null,gr,Ur)}).catch(nr)}).catch(nr)}(q,Qt):Qt(null,null),{cancel:function(){Lt=!0,dt||Z.abort()}}}(f,d);if(Ot()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,d,void 0,!0)}var y;return function(T,O){var N=new et.XMLHttpRequest;for(var Z in N.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(N.responseType="arraybuffer"),T.headers)N.setRequestHeader(Z,T.headers[Z]);return T.type==="json"&&(N.responseType="text",N.setRequestHeader("Accept","application/json")),N.withCredentials=T.credentials==="include",N.onerror=function(){O(new Error(N.statusText))},N.onload=function(){if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){var q=N.response;if(T.type==="json")try{q=JSON.parse(N.response)}catch(dt){return O(dt)}O(null,q,N.getResponseHeader("Cache-Control"),N.getResponseHeader("Expires"))}else O(new Sn(N.statusText,N.status,T.url))},N.send(T.body),{cancel:function(){return N.abort()}}}(f,d)},An=function(f,d){return Hn(b(f,{type:"arrayBuffer"}),d)},$n=function(f,d){return Hn(b(f,{method:"POST"}),d)},Rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Nn=[],Zn=0;var Xt=function(f,d){if(qe.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),Zn>=Yt.MAX_PARALLEL_IMAGE_REQUESTS){var y={requestParameters:f,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return Nn.push(y),y}Zn++;var T=!1,O=function(){if(!T)for(T=!0,Zn--;Nn.length&&Zn<Yt.MAX_PARALLEL_IMAGE_REQUESTS;){var Z=Nn.shift();Z.cancelled||(Z.cancel=Xt(Z.requestParameters,Z.callback).cancel)}},N=An(f,function(Z,q,dt,Lt){O(),Z?d(Z):q&&(Pr()?function(Gt,Qt){var me=new et.Blob([new Uint8Array(Gt)],{type:"image/png"});et.createImageBitmap(me).then(function(Fe){Qt(null,Fe)}).catch(function(Fe){Qt(new Error("Could not load image because of "+Fe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(q,d):function(Gt,Qt,me,Fe){var nr=new et.Image,ur=et.URL;nr.onload=function(){Qt(null,nr),ur.revokeObjectURL(nr.src),nr.onload=null,et.requestAnimationFrame(function(){nr.src=Rt})},nr.onerror=function(){return Qt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Sr=new et.Blob([new Uint8Array(Gt)],{type:"image/png"});nr.cacheControl=me,nr.expires=Fe,nr.src=Gt.byteLength?ur.createObjectURL(Sr):Rt}(q,d,dt,Lt))});return{cancel:function(){N.cancel(),O()}}};function ae(f,d,y){y[f]&&y[f].indexOf(d)!==-1||(y[f]=y[f]||[],y[f].push(d))}function we(f,d,y){if(y&&y[f]){var T=y[f].indexOf(d);T!==-1&&y[f].splice(T,1)}}var Ge=function(f,d){d===void 0&&(d={}),b(this,d),this.type=f},cr=function(f){function d(y,T){T===void 0&&(T={}),f.call(this,"error",b({error:y},T))}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Ge),br=function(){};br.prototype.on=function(f,d){return this._listeners=this._listeners||{},ae(f,d,this._listeners),this},br.prototype.off=function(f,d){return we(f,d,this._listeners),we(f,d,this._oneTimeListeners),this},br.prototype.once=function(f,d){return this._oneTimeListeners=this._oneTimeListeners||{},ae(f,d,this._oneTimeListeners),this},br.prototype.fire=function(f,d){typeof f=="string"&&(f=new Ge(f,d||{}));var y=f.type;if(this.listens(y)){f.target=this;for(var T=0,O=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];T<O.length;T+=1)O[T].call(this,f);for(var N=0,Z=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];N<Z.length;N+=1){var q=Z[N];we(y,q,this._oneTimeListeners),q.call(this,f)}var dt=this._eventedParent;dt&&(b(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),dt.fire(f))}else f instanceof cr&&console.error(f.error);return this},br.prototype.listens=function(f){return this._listeners&&this._listeners[f]&&this._listeners[f].length>0||this._oneTimeListeners&&this._oneTimeListeners[f]&&this._oneTimeListeners[f].length>0||this._eventedParent&&this._eventedParent.listens(f)},br.prototype.setEventedParent=function(f,d){return this._eventedParent=f,this._eventedParentData=d,this};var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ar=function(f,d,y,T){this.message=(f?f+": ":"")+y,T&&(this.identifier=T),d!=null&&d.__line__&&(this.line=d.__line__)};function Hr(f){var d=f.value;return d?[new ar(f.key,d,"constants have been deprecated as of v8")]:[]}function Tn(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];for(var T=0,O=d;T<O.length;T+=1){var N=O[T];for(var Z in N)f[Z]=N[Z]}return f}function Kr(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function an(f){if(Array.isArray(f))return f.map(an);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){var d={};for(var y in f)d[y]=an(f[y]);return d}return Kr(f)}var Pn=function(f){function d(y,T){f.call(this,T),this.message=T,this.key=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Error),xi=function(f,d){d===void 0&&(d=[]),this.parent=f,this.bindings={};for(var y=0,T=d;y<T.length;y+=1){var O=T[y];this.bindings[O[0]]=O[1]}};xi.prototype.concat=function(f){return new xi(this,f)},xi.prototype.get=function(f){if(this.bindings[f])return this.bindings[f];if(this.parent)return this.parent.get(f);throw new Error(f+" not found in scope.")},xi.prototype.has=function(f){return!!this.bindings[f]||!!this.parent&&this.parent.has(f)};var Ci={kind:"null"},Qr={kind:"number"},Kn={kind:"string"},ai={kind:"boolean"},fi={kind:"color"},oa={kind:"object"},Ai={kind:"value"},Ca={kind:"collator"},po={kind:"formatted"},La={kind:"resolvedImage"};function Va(f,d){return{kind:"array",itemType:f,N:d}}function _a(f){if(f.kind==="array"){var d=_a(f.itemType);return typeof f.N=="number"?"array<"+d+", "+f.N+">":f.itemType.kind==="value"?"array":"array<"+d+">"}return f.kind}var ma=[Ci,Qr,Kn,ai,fi,po,oa,Va(Ai),La];function Qa(f,d){if(d.kind==="error")return null;if(f.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!Qa(f.itemType,d.itemType))&&(typeof f.N!="number"||f.N===d.N))return null}else{if(f.kind===d.kind)return null;if(f.kind==="value"){for(var y=0,T=ma;y<T.length;y+=1)if(!Qa(T[y],d))return null}}return"Expected "+_a(f)+" but found "+_a(d)+" instead."}function Uo(f,d){return d.some(function(y){return y.kind===f.kind})}function vo(f,d){return d.some(function(y){return y==="null"?f===null:y==="array"?Array.isArray(f):y==="object"?f&&!Array.isArray(f)&&typeof f=="object":y===typeof f})}var Ua=Et(function(f,d){var y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function T(q){return(q=Math.round(q))<0?0:q>255?255:q}function O(q){return T(q[q.length-1]==="%"?parseFloat(q)/100*255:parseInt(q))}function N(q){return(dt=q[q.length-1]==="%"?parseFloat(q)/100:parseFloat(q))<0?0:dt>1?1:dt;var dt}function Z(q,dt,Lt){return Lt<0?Lt+=1:Lt>1&&(Lt-=1),6*Lt<1?q+(dt-q)*Lt*6:2*Lt<1?dt:3*Lt<2?q+(dt-q)*(2/3-Lt)*6:q}try{d.parseCSSColor=function(q){var dt,Lt=q.replace(/ /g,"").toLowerCase();if(Lt in y)return y[Lt].slice();if(Lt[0]==="#")return Lt.length===4?(dt=parseInt(Lt.substr(1),16))>=0&&dt<=4095?[(3840&dt)>>4|(3840&dt)>>8,240&dt|(240&dt)>>4,15&dt|(15&dt)<<4,1]:null:Lt.length===7&&(dt=parseInt(Lt.substr(1),16))>=0&&dt<=16777215?[(16711680&dt)>>16,(65280&dt)>>8,255&dt,1]:null;var Gt=Lt.indexOf("("),Qt=Lt.indexOf(")");if(Gt!==-1&&Qt+1===Lt.length){var me=Lt.substr(0,Gt),Fe=Lt.substr(Gt+1,Qt-(Gt+1)).split(","),nr=1;switch(me){case"rgba":if(Fe.length!==4)return null;nr=N(Fe.pop());case"rgb":return Fe.length!==3?null:[O(Fe[0]),O(Fe[1]),O(Fe[2]),nr];case"hsla":if(Fe.length!==4)return null;nr=N(Fe.pop());case"hsl":if(Fe.length!==3)return null;var ur=(parseFloat(Fe[0])%360+360)%360/360,Sr=N(Fe[1]),gr=N(Fe[2]),Ur=gr<=.5?gr*(Sr+1):gr+Sr-gr*Sr,tn=2*gr-Ur;return[T(255*Z(tn,Ur,ur+1/3)),T(255*Z(tn,Ur,ur)),T(255*Z(tn,Ur,ur-1/3)),nr];default:return null}}return null}}catch(q){}}).parseCSSColor,Xa=function(f,d,y,T){T===void 0&&(T=1),this.r=f,this.g=d,this.b=y,this.a=T};Xa.parse=function(f){if(f){if(f instanceof Xa)return f;if(typeof f=="string"){var d=Ua(f);if(d)return new Xa(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},Xa.prototype.toString=function(){var f=this.toArray(),d=f[1],y=f[2],T=f[3];return"rgba("+Math.round(f[0])+","+Math.round(d)+","+Math.round(y)+","+T+")"},Xa.prototype.toArray=function(){var f=this.a;return f===0?[0,0,0,0]:[255*this.r/f,255*this.g/f,255*this.b/f,f]},Xa.black=new Xa(0,0,0,1),Xa.white=new Xa(1,1,1,1),Xa.transparent=new Xa(0,0,0,0),Xa.red=new Xa(1,0,0,1);var Oo=function(f,d,y){this.sensitivity=f?d?"variant":"case":d?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Oo.prototype.compare=function(f,d){return this.collator.compare(f,d)},Oo.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Du=function(f,d,y,T,O){this.text=f,this.image=d,this.scale=y,this.fontStack=T,this.textColor=O},Yo=function(f){this.sections=f};Yo.fromString=function(f){return new Yo([new Du(f,null,null,null,null)])},Yo.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(f){return f.text.length!==0||f.image&&f.image.name.length!==0})},Yo.factory=function(f){return f instanceof Yo?f:Yo.fromString(f)},Yo.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(f){return f.text}).join("")},Yo.prototype.serialize=function(){for(var f=["format"],d=0,y=this.sections;d<y.length;d+=1){var T=y[d];if(T.image)f.push(["image",T.image.name]);else{f.push(T.text);var O={};T.fontStack&&(O["text-font"]=["literal",T.fontStack.split(",")]),T.scale&&(O["font-scale"]=T.scale),T.textColor&&(O["text-color"]=["rgba"].concat(T.textColor.toArray())),f.push(O)}}return f};var _o=function(f){this.name=f.name,this.available=f.available};function ir(f,d,y,T){return typeof f=="number"&&f>=0&&f<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof y=="number"&&y>=0&&y<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:"Invalid rgba value ["+[f,d,y,T].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof T=="number"?[f,d,y,T]:[f,d,y]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ge(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof Xa||f instanceof Oo||f instanceof Yo||f instanceof _o)return!0;if(Array.isArray(f)){for(var d=0,y=f;d<y.length;d+=1)if(!ge(y[d]))return!1;return!0}if(typeof f=="object"){for(var T in f)if(!ge(f[T]))return!1;return!0}return!1}function He(f){if(f===null)return Ci;if(typeof f=="string")return Kn;if(typeof f=="boolean")return ai;if(typeof f=="number")return Qr;if(f instanceof Xa)return fi;if(f instanceof Oo)return Ca;if(f instanceof Yo)return po;if(f instanceof _o)return La;if(Array.isArray(f)){for(var d,y=f.length,T=0,O=f;T<O.length;T+=1){var N=He(O[T]);if(d){if(d===N)continue;d=Ai;break}d=N}return Va(d||Ai,y)}return oa}function Ir(f){var d=typeof f;return f===null?"":d==="string"||d==="number"||d==="boolean"?String(f):f instanceof Xa||f instanceof Yo||f instanceof _o?f.toString():JSON.stringify(f)}_o.prototype.toString=function(){return this.name},_o.fromString=function(f){return f?new _o({name:f,available:!1}):null},_o.prototype.serialize=function(){return["image",this.name]};var en=function(f,d){this.type=f,this.value=d};en.parse=function(f,d){if(f.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(f.length-1)+" instead.");if(!ge(f[1]))return d.error("invalid value");var y=f[1],T=He(y),O=d.expectedType;return T.kind!=="array"||T.N!==0||!O||O.kind!=="array"||typeof O.N=="number"&&O.N!==0||(T=O),new en(T,y)},en.prototype.evaluate=function(){return this.value},en.prototype.eachChild=function(){},en.prototype.outputDefined=function(){return!0},en.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Xa?["rgba"].concat(this.value.toArray()):this.value instanceof Yo?this.value.serialize():this.value};var On=function(f){this.name="ExpressionEvaluationError",this.message=f};On.prototype.toJSON=function(){return this.message};var zn={string:Kn,number:Qr,boolean:ai,object:oa},kn=function(f,d){this.type=f,this.args=d};kn.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y,T=1,O=f[0];if(O==="array"){var N,Z;if(f.length>2){var q=f[1];if(typeof q!="string"||!(q in zn)||q==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);N=zn[q],T++}else N=Ai;if(f.length>3){if(f[2]!==null&&(typeof f[2]!="number"||f[2]<0||f[2]!==Math.floor(f[2])))return d.error('The length argument to "array" must be a positive integer literal',2);Z=f[2],T++}y=Va(N,Z)}else y=zn[O];for(var dt=[];T<f.length;T++){var Lt=d.parse(f[T],T,Ai);if(!Lt)return null;dt.push(Lt)}return new kn(y,dt)},kn.prototype.evaluate=function(f){for(var d=0;d<this.args.length;d++){var y=this.args[d].evaluate(f);if(!Qa(this.type,He(y)))return y;if(d===this.args.length-1)throw new On("Expected value to be of type "+_a(this.type)+", but found "+_a(He(y))+" instead.")}return null},kn.prototype.eachChild=function(f){this.args.forEach(f)},kn.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},kn.prototype.serialize=function(){var f=this.type,d=[f.kind];if(f.kind==="array"){var y=f.itemType;if(y.kind==="string"||y.kind==="number"||y.kind==="boolean"){d.push(y.kind);var T=f.N;(typeof T=="number"||this.args.length>1)&&d.push(T)}}return d.concat(this.args.map(function(O){return O.serialize()}))};var qi=function(f){this.type=po,this.sections=f};qi.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y=f[1];if(!Array.isArray(y)&&typeof y=="object")return d.error("First argument must be an image or text section.");for(var T=[],O=!1,N=1;N<=f.length-1;++N){var Z=f[N];if(O&&typeof Z=="object"&&!Array.isArray(Z)){O=!1;var q=null;if(Z["font-scale"]&&!(q=d.parse(Z["font-scale"],1,Qr)))return null;var dt=null;if(Z["text-font"]&&!(dt=d.parse(Z["text-font"],1,Va(Kn))))return null;var Lt=null;if(Z["text-color"]&&!(Lt=d.parse(Z["text-color"],1,fi)))return null;var Gt=T[T.length-1];Gt.scale=q,Gt.font=dt,Gt.textColor=Lt}else{var Qt=d.parse(f[N],1,Ai);if(!Qt)return null;var me=Qt.type.kind;if(me!=="string"&&me!=="value"&&me!=="null"&&me!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");O=!0,T.push({content:Qt,scale:null,font:null,textColor:null})}}return new qi(T)},qi.prototype.evaluate=function(f){return new Yo(this.sections.map(function(d){var y=d.content.evaluate(f);return He(y)===La?new Du("",y,null,null,null):new Du(Ir(y),null,d.scale?d.scale.evaluate(f):null,d.font?d.font.evaluate(f).join(","):null,d.textColor?d.textColor.evaluate(f):null)}))},qi.prototype.eachChild=function(f){for(var d=0,y=this.sections;d<y.length;d+=1){var T=y[d];f(T.content),T.scale&&f(T.scale),T.font&&f(T.font),T.textColor&&f(T.textColor)}},qi.prototype.outputDefined=function(){return!1},qi.prototype.serialize=function(){for(var f=["format"],d=0,y=this.sections;d<y.length;d+=1){var T=y[d];f.push(T.content.serialize());var O={};T.scale&&(O["font-scale"]=T.scale.serialize()),T.font&&(O["text-font"]=T.font.serialize()),T.textColor&&(O["text-color"]=T.textColor.serialize()),f.push(O)}return f};var Oa=function(f){this.type=La,this.input=f};Oa.parse=function(f,d){if(f.length!==2)return d.error("Expected two arguments.");var y=d.parse(f[1],1,Kn);return y?new Oa(y):d.error("No image name provided.")},Oa.prototype.evaluate=function(f){var d=this.input.evaluate(f),y=_o.fromString(d);return y&&f.availableImages&&(y.available=f.availableImages.indexOf(d)>-1),y},Oa.prototype.eachChild=function(f){f(this.input)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){return["image",this.input.serialize()]};var us={"to-boolean":ai,"to-color":fi,"to-number":Qr,"to-string":Kn},Ao=function(f,d){this.type=f,this.args=d};Ao.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y=f[0];if((y==="to-boolean"||y==="to-string")&&f.length!==2)return d.error("Expected one argument.");for(var T=us[y],O=[],N=1;N<f.length;N++){var Z=d.parse(f[N],N,Ai);if(!Z)return null;O.push(Z)}return new Ao(T,O)},Ao.prototype.evaluate=function(f){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(f));if(this.type.kind==="color"){for(var d,y,T=0,O=this.args;T<O.length;T+=1){if(y=null,(d=O[T].evaluate(f))instanceof Xa)return d;if(typeof d=="string"){var N=f.parseColor(d);if(N)return N}else if(Array.isArray(d)&&!(y=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":ir(d[0],d[1],d[2],d[3])))return new Xa(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new On(y||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var Z=null,q=0,dt=this.args;q<dt.length;q+=1){if((Z=dt[q].evaluate(f))===null)return 0;var Lt=Number(Z);if(!isNaN(Lt))return Lt}throw new On("Could not convert "+JSON.stringify(Z)+" to number.")}return this.type.kind==="formatted"?Yo.fromString(Ir(this.args[0].evaluate(f))):this.type.kind==="resolvedImage"?_o.fromString(Ir(this.args[0].evaluate(f))):Ir(this.args[0].evaluate(f))},Ao.prototype.eachChild=function(f){this.args.forEach(f)},Ao.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},Ao.prototype.serialize=function(){if(this.type.kind==="formatted")return new qi([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Oa(this.args[0]).serialize();var f=["to-"+this.type.kind];return this.eachChild(function(d){f.push(d.serialize())}),f};var Ho=["Unknown","Point","LineString","Polygon"],uo=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};uo.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},uo.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ho[this.feature.type]:this.feature.type:null},uo.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},uo.prototype.canonicalID=function(){return this.canonical},uo.prototype.properties=function(){return this.feature&&this.feature.properties||{}},uo.prototype.parseColor=function(f){var d=this._parseColorCache[f];return d||(d=this._parseColorCache[f]=Xa.parse(f)),d};var Zo=function(f,d,y,T){this.name=f,this.type=d,this._evaluate=y,this.args=T};Zo.prototype.evaluate=function(f){return this._evaluate(f,this.args)},Zo.prototype.eachChild=function(f){this.args.forEach(f)},Zo.prototype.outputDefined=function(){return!1},Zo.prototype.serialize=function(){return[this.name].concat(this.args.map(function(f){return f.serialize()}))},Zo.parse=function(f,d){var y,T=f[0],O=Zo.definitions[T];if(!O)return d.error('Unknown expression "'+T+'". If you wanted a literal array, use ["literal", [...]].',0);for(var N=Array.isArray(O)?O[0]:O.type,Z=Array.isArray(O)?[[O[1],O[2]]]:O.overloads,q=Z.filter(function(pa){var Rn=pa[0];return!Array.isArray(Rn)||Rn.length===f.length-1}),dt=null,Lt=0,Gt=q;Lt<Gt.length;Lt+=1){var Qt=Gt[Lt],me=Qt[0],Fe=Qt[1];dt=new Bu(d.registry,d.path,null,d.scope);for(var nr=[],ur=!1,Sr=1;Sr<f.length;Sr++){var gr=f[Sr],Ur=Array.isArray(me)?me[Sr-1]:me.type,tn=dt.parse(gr,1+nr.length,Ur);if(!tn){ur=!0;break}nr.push(tn)}if(!ur)if(Array.isArray(me)&&me.length!==nr.length)dt.error("Expected "+me.length+" arguments, but found "+nr.length+" instead.");else{for(var un=0;un<nr.length;un++){var yn=Array.isArray(me)?me[un]:me.type,Fn=nr[un];dt.concat(un+1).checkSubtype(yn,Fn.type)}if(dt.errors.length===0)return new Zo(T,N,Fe,nr)}}if(q.length===1)(y=d.errors).push.apply(y,dt.errors);else{for(var ii=(q.length?q:Z).map(function(pa){var Rn;return Rn=pa[0],Array.isArray(Rn)?"("+Rn.map(_a).join(", ")+")":"("+_a(Rn.type)+"...)"}).join(" | "),Si=[],sa=1;sa<f.length;sa++){var Zi=d.parse(f[sa],1+Si.length);if(!Zi)return null;Si.push(_a(Zi.type))}d.error("Expected arguments of type "+ii+", but found ("+Si.join(", ")+") instead.")}return null},Zo.register=function(f,d){for(var y in Zo.definitions=d,d)f[y]=Zo};var Qs=function(f,d,y){this.type=Ca,this.locale=y,this.caseSensitive=f,this.diacriticSensitive=d};function jo(f,d){f[0]=Math.min(f[0],d[0]),f[1]=Math.min(f[1],d[1]),f[2]=Math.max(f[2],d[0]),f[3]=Math.max(f[3],d[1])}function _l(f,d){return!(f[0]<=d[0]||f[2]>=d[2]||f[1]<=d[1]||f[3]>=d[3])}function Hc(f,d){var y=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,O=Math.pow(2,d.z);return[Math.round(y*O*8192),Math.round(T*O*8192)]}function $u(f,d,y){return d[1]>f[1]!=y[1]>f[1]&&f[0]<(y[0]-d[0])*(f[1]-d[1])/(y[1]-d[1])+d[0]}function Ae(f,d){for(var y,T,O,N,Z,q,dt,Lt=!1,Gt=0,Qt=d.length;Gt<Qt;Gt++)for(var me=d[Gt],Fe=0,nr=me.length;Fe<nr-1;Fe++){if((N=(y=f)[0]-(T=me[Fe])[0])*(dt=y[1]-(O=me[Fe+1])[1])-(q=y[0]-O[0])*(Z=y[1]-T[1])==0&&N*q<=0&&Z*dt<=0)return!1;$u(f,me[Fe],me[Fe+1])&&(Lt=!Lt)}return Lt}function Xe(f,d){for(var y=0;y<d.length;y++)if(Ae(f,d[y]))return!0;return!1}function Cr(f,d,y,T){var O=T[0]-y[0],N=T[1]-y[1],Z=(f[0]-y[0])*N-O*(f[1]-y[1]),q=(d[0]-y[0])*N-O*(d[1]-y[1]);return Z>0&&q<0||Z<0&&q>0}function sn(f,d,y){for(var T=0,O=y;T<O.length;T+=1)for(var N=O[T],Z=0;Z<N.length-1;++Z)if((Qt=[(Gt=N[Z+1])[0]-(Lt=N[Z])[0],Gt[1]-Lt[1]])[0]*(me=[(dt=d)[0]-(q=f)[0],dt[1]-q[1]])[1]-Qt[1]*me[0]!=0&&Cr(q,dt,Lt,Gt)&&Cr(Lt,Gt,q,dt))return!0;var q,dt,Lt,Gt,Qt,me;return!1}function si(f,d){for(var y=0;y<f.length;++y)if(!Ae(f[y],d))return!1;for(var T=0;T<f.length-1;++T)if(sn(f[T],f[T+1],d))return!1;return!0}function Pi(f,d){for(var y=0;y<d.length;y++)if(si(f,d[y]))return!0;return!1}function ja(f,d,y){for(var T=[],O=0;O<f.length;O++){for(var N=[],Z=0;Z<f[O].length;Z++){var q=Hc(f[O][Z],y);jo(d,q),N.push(q)}T.push(N)}return T}function vs(f,d,y){for(var T=[],O=0;O<f.length;O++){var N=ja(f[O],d,y);T.push(N)}return T}function $o(f,d,y,T){if(f[0]<y[0]||f[0]>y[2]){var O=.5*T,N=f[0]-y[0]>O?-T:y[0]-f[0]>O?T:0;N===0&&(N=f[0]-y[2]>O?-T:y[2]-f[0]>O?T:0),f[0]+=N}jo(d,f)}function qo(f,d,y,T){for(var O=8192*Math.pow(2,T.z),N=[8192*T.x,8192*T.y],Z=[],q=0,dt=f;q<dt.length;q+=1)for(var Lt=0,Gt=dt[q];Lt<Gt.length;Lt+=1){var Qt=Gt[Lt],me=[Qt.x+N[0],Qt.y+N[1]];$o(me,d,y,O),Z.push(me)}return Z}function Js(f,d,y,T){for(var O,N=8192*Math.pow(2,T.z),Z=[8192*T.x,8192*T.y],q=[],dt=0,Lt=f;dt<Lt.length;dt+=1){for(var Gt=[],Qt=0,me=Lt[dt];Qt<me.length;Qt+=1){var Fe=me[Qt],nr=[Fe.x+Z[0],Fe.y+Z[1]];jo(d,nr),Gt.push(nr)}q.push(Gt)}if(d[2]-d[0]<=N/2){(O=d)[0]=O[1]=1/0,O[2]=O[3]=-1/0;for(var ur=0,Sr=q;ur<Sr.length;ur+=1)for(var gr=0,Ur=Sr[ur];gr<Ur.length;gr+=1)$o(Ur[gr],d,y,N)}return q}Qs.parse=function(f,d){if(f.length!==2)return d.error("Expected one argument.");var y=f[1];if(typeof y!="object"||Array.isArray(y))return d.error("Collator options argument must be an object.");var T=d.parse(y["case-sensitive"]!==void 0&&y["case-sensitive"],1,ai);if(!T)return null;var O=d.parse(y["diacritic-sensitive"]!==void 0&&y["diacritic-sensitive"],1,ai);if(!O)return null;var N=null;return y.locale&&!(N=d.parse(y.locale,1,Kn))?null:new Qs(T,O,N)},Qs.prototype.evaluate=function(f){return new Oo(this.caseSensitive.evaluate(f),this.diacriticSensitive.evaluate(f),this.locale?this.locale.evaluate(f):null)},Qs.prototype.eachChild=function(f){f(this.caseSensitive),f(this.diacriticSensitive),this.locale&&f(this.locale)},Qs.prototype.outputDefined=function(){return!1},Qs.prototype.serialize=function(){var f={};return f["case-sensitive"]=this.caseSensitive.serialize(),f["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(f.locale=this.locale.serialize()),["collator",f]};var qu=function(f,d){this.type=ai,this.geojson=f,this.geometries=d};function yu(f){if(f instanceof Zo&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof qu)return!1;var d=!0;return f.eachChild(function(y){d&&!yu(y)&&(d=!1)}),d}function Zs(f){if(f instanceof Zo&&f.name==="feature-state")return!1;var d=!0;return f.eachChild(function(y){d&&!Zs(y)&&(d=!1)}),d}function _u(f,d){if(f instanceof Zo&&d.indexOf(f.name)>=0)return!1;var y=!0;return f.eachChild(function(T){y&&!_u(T,d)&&(y=!1)}),y}qu.parse=function(f,d){if(f.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(f.length-1)+" instead.");if(ge(f[1])){var y=f[1];if(y.type==="FeatureCollection")for(var T=0;T<y.features.length;++T){var O=y.features[T].geometry.type;if(O==="Polygon"||O==="MultiPolygon")return new qu(y,y.features[T].geometry)}else if(y.type==="Feature"){var N=y.geometry.type;if(N==="Polygon"||N==="MultiPolygon")return new qu(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new qu(y,y)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},qu.prototype.evaluate=function(f){if(f.geometry()!=null&&f.canonicalID()!=null){if(f.geometryType()==="Point")return function(d,y){var T=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(y.type==="Polygon"){var Z=ja(y.coordinates,O,N),q=qo(d.geometry(),T,O,N);if(!_l(T,O))return!1;for(var dt=0,Lt=q;dt<Lt.length;dt+=1)if(!Ae(Lt[dt],Z))return!1}if(y.type==="MultiPolygon"){var Gt=vs(y.coordinates,O,N),Qt=qo(d.geometry(),T,O,N);if(!_l(T,O))return!1;for(var me=0,Fe=Qt;me<Fe.length;me+=1)if(!Xe(Fe[me],Gt))return!1}return!0}(f,this.geometries);if(f.geometryType()==="LineString")return function(d,y){var T=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(y.type==="Polygon"){var Z=ja(y.coordinates,O,N),q=Js(d.geometry(),T,O,N);if(!_l(T,O))return!1;for(var dt=0,Lt=q;dt<Lt.length;dt+=1)if(!si(Lt[dt],Z))return!1}if(y.type==="MultiPolygon"){var Gt=vs(y.coordinates,O,N),Qt=Js(d.geometry(),T,O,N);if(!_l(T,O))return!1;for(var me=0,Fe=Qt;me<Fe.length;me+=1)if(!Pi(Fe[me],Gt))return!1}return!0}(f,this.geometries)}return!1},qu.prototype.eachChild=function(){},qu.prototype.outputDefined=function(){return!0},qu.prototype.serialize=function(){return["within",this.geojson]};var Ku=function(f,d){this.type=d.type,this.name=f,this.boundExpression=d};Ku.parse=function(f,d){if(f.length!==2||typeof f[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var y=f[1];return d.scope.has(y)?new Ku(y,d.scope.get(y)):d.error('Unknown variable "'+y+'". Make sure "'+y+'" has been bound in an enclosing "let" expression before using it.',1)},Ku.prototype.evaluate=function(f){return this.boundExpression.evaluate(f)},Ku.prototype.eachChild=function(){},Ku.prototype.outputDefined=function(){return!1},Ku.prototype.serialize=function(){return["var",this.name]};var Bu=function(f,d,y,T,O){d===void 0&&(d=[]),T===void 0&&(T=new xi),O===void 0&&(O=[]),this.registry=f,this.path=d,this.key=d.map(function(N){return"["+N+"]"}).join(""),this.scope=T,this.errors=O,this.expectedType=y};function xl(f,d){for(var y,T=f.length-1,O=0,N=T,Z=0;O<=N;)if((y=f[Z=Math.floor((O+N)/2)])<=d){if(Z===T||d<f[Z+1])return Z;O=Z+1}else{if(!(y>d))throw new On("Input is not a number.");N=Z-1}return 0}Bu.prototype.parse=function(f,d,y,T,O){return O===void 0&&(O={}),d?this.concat(d,y,T)._parse(f,O):this._parse(f,O)},Bu.prototype._parse=function(f,d){function y(Lt,Gt,Qt){return Qt==="assert"?new kn(Gt,[Lt]):Qt==="coerce"?new Ao(Gt,[Lt]):Lt}if(f!==null&&typeof f!="string"&&typeof f!="boolean"&&typeof f!="number"||(f=["literal",f]),Array.isArray(f)){if(f.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var T=f[0];if(typeof T!="string")return this.error("Expression name must be a string, but found "+typeof T+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var O=this.registry[T];if(O){var N=O.parse(f,this);if(!N)return null;if(this.expectedType){var Z=this.expectedType,q=N.type;if(Z.kind!=="string"&&Z.kind!=="number"&&Z.kind!=="boolean"&&Z.kind!=="object"&&Z.kind!=="array"||q.kind!=="value")if(Z.kind!=="color"&&Z.kind!=="formatted"&&Z.kind!=="resolvedImage"||q.kind!=="value"&&q.kind!=="string"){if(this.checkSubtype(Z,q))return null}else N=y(N,Z,d.typeAnnotation||"coerce");else N=y(N,Z,d.typeAnnotation||"assert")}if(!(N instanceof en)&&N.type.kind!=="resolvedImage"&&function Lt(Gt){if(Gt instanceof Ku)return Lt(Gt.boundExpression);if(Gt instanceof Zo&&Gt.name==="error"||Gt instanceof Qs||Gt instanceof qu)return!1;var Qt=Gt instanceof Ao||Gt instanceof kn,me=!0;return Gt.eachChild(function(Fe){me=Qt?me&&Lt(Fe):me&&Fe instanceof en}),!!me&&yu(Gt)&&_u(Gt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(N)){var dt=new uo;try{N=new en(N.type,N.evaluate(dt))}catch(Lt){return this.error(Lt.message),null}}return N}return this.error('Unknown expression "'+T+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(f===void 0?"'undefined' value invalid. Use null instead.":typeof f=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof f+" instead.")},Bu.prototype.concat=function(f,d,y){var T=typeof f=="number"?this.path.concat(f):this.path,O=y?this.scope.concat(y):this.scope;return new Bu(this.registry,T,d||null,O,this.errors)},Bu.prototype.error=function(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];var T=""+this.key+d.map(function(O){return"["+O+"]"}).join("");this.errors.push(new Pn(T,f))},Bu.prototype.checkSubtype=function(f,d){var y=Qa(f,d);return y&&this.error(y),y};var Nu=function(f,d,y){this.type=f,this.input=d,this.labels=[],this.outputs=[];for(var T=0,O=y;T<O.length;T+=1){var N=O[T],Z=N[1];this.labels.push(N[0]),this.outputs.push(Z)}};function Fo(f,d,y){return f*(1-y)+d*y}Nu.parse=function(f,d){if(f.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if((f.length-1)%2!=0)return d.error("Expected an even number of arguments.");var y=d.parse(f[1],1,Qr);if(!y)return null;var T=[],O=null;d.expectedType&&d.expectedType.kind!=="value"&&(O=d.expectedType);for(var N=1;N<f.length;N+=2){var Z=N===1?-1/0:f[N],q=f[N+1],dt=N,Lt=N+1;if(typeof Z!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',dt);if(T.length&&T[T.length-1][0]>=Z)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',dt);var Gt=d.parse(q,Lt,O);if(!Gt)return null;O=O||Gt.type,T.push([Z,Gt])}return new Nu(O,y,T)},Nu.prototype.evaluate=function(f){var d=this.labels,y=this.outputs;if(d.length===1)return y[0].evaluate(f);var T=this.input.evaluate(f);if(T<=d[0])return y[0].evaluate(f);var O=d.length;return T>=d[O-1]?y[O-1].evaluate(f):y[xl(d,T)].evaluate(f)},Nu.prototype.eachChild=function(f){f(this.input);for(var d=0,y=this.outputs;d<y.length;d+=1)f(y[d])},Nu.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})},Nu.prototype.serialize=function(){for(var f=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&f.push(this.labels[d]),f.push(this.outputs[d].serialize());return f};var Ts=Object.freeze({__proto__:null,number:Fo,color:function(f,d,y){return new Xa(Fo(f.r,d.r,y),Fo(f.g,d.g,y),Fo(f.b,d.b,y),Fo(f.a,d.a,y))},array:function(f,d,y){return f.map(function(T,O){return Fo(T,d[O],y)})}}),jc=6/29*3*(6/29),Wc=Math.PI/180,xu=180/Math.PI;function Ms(f){return f>.008856451679035631?Math.pow(f,1/3):f/jc+4/29}function pl(f){return f>6/29?f*f*f:jc*(f-4/29)}function Ga(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function zu(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function Xc(f){var d=zu(f.r),y=zu(f.g),T=zu(f.b),O=Ms((.4124564*d+.3575761*y+.1804375*T)/.95047),N=Ms((.2126729*d+.7151522*y+.072175*T)/1);return{l:116*N-16,a:500*(O-N),b:200*(N-Ms((.0193339*d+.119192*y+.9503041*T)/1.08883)),alpha:f.a}}function D(f){var d=(f.l+16)/116,y=isNaN(f.a)?d:d+f.a/500,T=isNaN(f.b)?d:d-f.b/200;return d=1*pl(d),y=.95047*pl(y),T=1.08883*pl(T),new Xa(Ga(3.2404542*y-1.5371385*d-.4985314*T),Ga(-.969266*y+1.8760108*d+.041556*T),Ga(.0556434*y-.2040259*d+1.0572252*T),f.alpha)}function X(f,d,y){var T=d-f;return f+y*(T>180||T<-180?T-360*Math.round(T/360):T)}var Mt={forward:Xc,reverse:D,interpolate:function(f,d,y){return{l:Fo(f.l,d.l,y),a:Fo(f.a,d.a,y),b:Fo(f.b,d.b,y),alpha:Fo(f.alpha,d.alpha,y)}}},it={forward:function(f){var d=Xc(f),y=d.l,T=d.a,O=d.b,N=Math.atan2(O,T)*xu;return{h:N<0?N+360:N,c:Math.sqrt(T*T+O*O),l:y,alpha:f.a}},reverse:function(f){var d=f.h*Wc,y=f.c;return D({l:f.l,a:Math.cos(d)*y,b:Math.sin(d)*y,alpha:f.alpha})},interpolate:function(f,d,y){return{h:X(f.h,d.h,y),c:Fo(f.c,d.c,y),l:Fo(f.l,d.l,y),alpha:Fo(f.alpha,d.alpha,y)}}},Jt=Object.freeze({__proto__:null,lab:Mt,hcl:it}),Ue=function(f,d,y,T,O){this.type=f,this.operator=d,this.interpolation=y,this.input=T,this.labels=[],this.outputs=[];for(var N=0,Z=O;N<Z.length;N+=1){var q=Z[N],dt=q[1];this.labels.push(q[0]),this.outputs.push(dt)}};function yr(f,d,y,T){var O=T-y,N=f-y;return O===0?0:d===1?N/O:(Math.pow(d,N)-1)/(Math.pow(d,O)-1)}Ue.interpolationFactor=function(f,d,y,T){var O=0;if(f.name==="exponential")O=yr(d,f.base,y,T);else if(f.name==="linear")O=yr(d,1,y,T);else if(f.name==="cubic-bezier"){var N=f.controlPoints;O=new K(N[0],N[1],N[2],N[3]).solve(yr(d,1,y,T))}return O},Ue.parse=function(f,d){var y=f[0],T=f[1],O=f[2],N=f.slice(3);if(!Array.isArray(T)||T.length===0)return d.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){var Z=T[1];if(typeof Z!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:Z}}else{if(T[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(T[0]),1,0);var q=T.slice(1);if(q.length!==4||q.some(function(Sr){return typeof Sr!="number"||Sr<0||Sr>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:q}}if(f.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if((f.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(O=d.parse(O,2,Qr)))return null;var dt=[],Lt=null;y==="interpolate-hcl"||y==="interpolate-lab"?Lt=fi:d.expectedType&&d.expectedType.kind!=="value"&&(Lt=d.expectedType);for(var Gt=0;Gt<N.length;Gt+=2){var Qt=N[Gt],me=N[Gt+1],Fe=Gt+3,nr=Gt+4;if(typeof Qt!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Fe);if(dt.length&&dt[dt.length-1][0]>=Qt)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Fe);var ur=d.parse(me,nr,Lt);if(!ur)return null;Lt=Lt||ur.type,dt.push([Qt,ur])}return Lt.kind==="number"||Lt.kind==="color"||Lt.kind==="array"&&Lt.itemType.kind==="number"&&typeof Lt.N=="number"?new Ue(Lt,y,T,O,dt):d.error("Type "+_a(Lt)+" is not interpolatable.")},Ue.prototype.evaluate=function(f){var d=this.labels,y=this.outputs;if(d.length===1)return y[0].evaluate(f);var T=this.input.evaluate(f);if(T<=d[0])return y[0].evaluate(f);var O=d.length;if(T>=d[O-1])return y[O-1].evaluate(f);var N=xl(d,T),Z=Ue.interpolationFactor(this.interpolation,T,d[N],d[N+1]),q=y[N].evaluate(f),dt=y[N+1].evaluate(f);return this.operator==="interpolate"?Ts[this.type.kind.toLowerCase()](q,dt,Z):this.operator==="interpolate-hcl"?it.reverse(it.interpolate(it.forward(q),it.forward(dt),Z)):Mt.reverse(Mt.interpolate(Mt.forward(q),Mt.forward(dt),Z))},Ue.prototype.eachChild=function(f){f(this.input);for(var d=0,y=this.outputs;d<y.length;d+=1)f(y[d])},Ue.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})},Ue.prototype.serialize=function(){var f;f=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,f,this.input.serialize()],y=0;y<this.labels.length;y++)d.push(this.labels[y],this.outputs[y].serialize());return d};var Br=function(f,d){this.type=f,this.args=d};Br.parse=function(f,d){if(f.length<2)return d.error("Expectected at least one argument.");var y=null,T=d.expectedType;T&&T.kind!=="value"&&(y=T);for(var O=[],N=0,Z=f.slice(1);N<Z.length;N+=1){var q=d.parse(Z[N],1+O.length,y,void 0,{typeAnnotation:"omit"});if(!q)return null;y=y||q.type,O.push(q)}var dt=T&&O.some(function(Lt){return Qa(T,Lt.type)});return new Br(dt?Ai:y,O)},Br.prototype.evaluate=function(f){for(var d,y=null,T=0,O=0,N=this.args;O<N.length&&(T++,(y=N[O].evaluate(f))&&y instanceof _o&&!y.available&&(d||(d=y.name),y=null,T===this.args.length&&(y=d)),y===null);O+=1);return y},Br.prototype.eachChild=function(f){this.args.forEach(f)},Br.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},Br.prototype.serialize=function(){var f=["coalesce"];return this.eachChild(function(d){f.push(d.serialize())}),f};var zr=function(f,d){this.type=d.type,this.bindings=[].concat(f),this.result=d};zr.prototype.evaluate=function(f){return this.result.evaluate(f)},zr.prototype.eachChild=function(f){for(var d=0,y=this.bindings;d<y.length;d+=1)f(y[d][1]);f(this.result)},zr.parse=function(f,d){if(f.length<4)return d.error("Expected at least 3 arguments, but found "+(f.length-1)+" instead.");for(var y=[],T=1;T<f.length-1;T+=2){var O=f[T];if(typeof O!="string")return d.error("Expected string, but found "+typeof O+" instead.",T);if(/[^a-zA-Z0-9_]/.test(O))return d.error("Variable names must contain only alphanumeric characters or '_'.",T);var N=d.parse(f[T+1],T+1);if(!N)return null;y.push([O,N])}var Z=d.parse(f[f.length-1],f.length-1,d.expectedType,y);return Z?new zr(y,Z):null},zr.prototype.outputDefined=function(){return this.result.outputDefined()},zr.prototype.serialize=function(){for(var f=["let"],d=0,y=this.bindings;d<y.length;d+=1){var T=y[d];f.push(T[0],T[1].serialize())}return f.push(this.result.serialize()),f};var Cn=function(f,d,y){this.type=f,this.index=d,this.input=y};Cn.parse=function(f,d){if(f.length!==3)return d.error("Expected 2 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Qr),T=d.parse(f[2],2,Va(d.expectedType||Ai));return y&&T?new Cn(T.type.itemType,y,T):null},Cn.prototype.evaluate=function(f){var d=this.index.evaluate(f),y=this.input.evaluate(f);if(d<0)throw new On("Array index out of bounds: "+d+" < 0.");if(d>=y.length)throw new On("Array index out of bounds: "+d+" > "+(y.length-1)+".");if(d!==Math.floor(d))throw new On("Array index must be an integer, but found "+d+" instead.");return y[d]},Cn.prototype.eachChild=function(f){f(this.index),f(this.input)},Cn.prototype.outputDefined=function(){return!1},Cn.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Vn=function(f,d){this.type=ai,this.needle=f,this.haystack=d};Vn.parse=function(f,d){if(f.length!==3)return d.error("Expected 2 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ai),T=d.parse(f[2],2,Ai);return y&&T?Uo(y.type,[ai,Kn,Qr,Ci,Ai])?new Vn(y,T):d.error("Expected first argument to be of type boolean, string, number or null, but found "+_a(y.type)+" instead"):null},Vn.prototype.evaluate=function(f){var d=this.needle.evaluate(f),y=this.haystack.evaluate(f);if(!y)return!1;if(!vo(d,["boolean","string","number","null"]))throw new On("Expected first argument to be of type boolean, string, number or null, but found "+_a(He(d))+" instead.");if(!vo(y,["string","array"]))throw new On("Expected second argument to be of type array or string, but found "+_a(He(y))+" instead.");return y.indexOf(d)>=0},Vn.prototype.eachChild=function(f){f(this.needle),f(this.haystack)},Vn.prototype.outputDefined=function(){return!0},Vn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ki=function(f,d,y){this.type=Qr,this.needle=f,this.haystack=d,this.fromIndex=y};Ki.parse=function(f,d){if(f.length<=2||f.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ai),T=d.parse(f[2],2,Ai);if(!y||!T)return null;if(!Uo(y.type,[ai,Kn,Qr,Ci,Ai]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+_a(y.type)+" instead");if(f.length===4){var O=d.parse(f[3],3,Qr);return O?new Ki(y,T,O):null}return new Ki(y,T)},Ki.prototype.evaluate=function(f){var d=this.needle.evaluate(f),y=this.haystack.evaluate(f);if(!vo(d,["boolean","string","number","null"]))throw new On("Expected first argument to be of type boolean, string, number or null, but found "+_a(He(d))+" instead.");if(!vo(y,["string","array"]))throw new On("Expected second argument to be of type array or string, but found "+_a(He(y))+" instead.");if(this.fromIndex){var T=this.fromIndex.evaluate(f);return y.indexOf(d,T)}return y.indexOf(d)},Ki.prototype.eachChild=function(f){f(this.needle),f(this.haystack),this.fromIndex&&f(this.fromIndex)},Ki.prototype.outputDefined=function(){return!1},Ki.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var f=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),f]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ma=function(f,d,y,T,O,N){this.inputType=f,this.type=d,this.input=y,this.cases=T,this.outputs=O,this.otherwise=N};Ma.parse=function(f,d){if(f.length<5)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if(f.length%2!=1)return d.error("Expected an even number of arguments.");var y,T;d.expectedType&&d.expectedType.kind!=="value"&&(T=d.expectedType);for(var O={},N=[],Z=2;Z<f.length-1;Z+=2){var q=f[Z],dt=f[Z+1];Array.isArray(q)||(q=[q]);var Lt=d.concat(Z);if(q.length===0)return Lt.error("Expected at least one branch label.");for(var Gt=0,Qt=q;Gt<Qt.length;Gt+=1){var me=Qt[Gt];if(typeof me!="number"&&typeof me!="string")return Lt.error("Branch labels must be numbers or strings.");if(typeof me=="number"&&Math.abs(me)>Number.MAX_SAFE_INTEGER)return Lt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof me=="number"&&Math.floor(me)!==me)return Lt.error("Numeric branch labels must be integer values.");if(y){if(Lt.checkSubtype(y,He(me)))return null}else y=He(me);if(O[String(me)]!==void 0)return Lt.error("Branch labels must be unique.");O[String(me)]=N.length}var Fe=d.parse(dt,Z,T);if(!Fe)return null;T=T||Fe.type,N.push(Fe)}var nr=d.parse(f[1],1,Ai);if(!nr)return null;var ur=d.parse(f[f.length-1],f.length-1,T);return ur?nr.type.kind!=="value"&&d.concat(1).checkSubtype(y,nr.type)?null:new Ma(y,T,nr,O,N,ur):null},Ma.prototype.evaluate=function(f){var d=this.input.evaluate(f);return(He(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(f)},Ma.prototype.eachChild=function(f){f(this.input),this.outputs.forEach(f),f(this.otherwise)},Ma.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})&&this.otherwise.outputDefined()},Ma.prototype.serialize=function(){for(var f=this,d=["match",this.input.serialize()],y=[],T={},O=0,N=Object.keys(this.cases).sort();O<N.length;O+=1){var Z=N[O];(Qt=T[this.cases[Z]])===void 0?(T[this.cases[Z]]=y.length,y.push([this.cases[Z],[Z]])):y[Qt][1].push(Z)}for(var q=function(Fe){return f.inputType.kind==="number"?Number(Fe):Fe},dt=0,Lt=y;dt<Lt.length;dt+=1){var Gt=Lt[dt],Qt=Gt[0],me=Gt[1];d.push(me.length===1?q(me[0]):me.map(q)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var xa=function(f,d,y){this.type=f,this.branches=d,this.otherwise=y};xa.parse=function(f,d){if(f.length<4)return d.error("Expected at least 3 arguments, but found only "+(f.length-1)+".");if(f.length%2!=0)return d.error("Expected an odd number of arguments.");var y;d.expectedType&&d.expectedType.kind!=="value"&&(y=d.expectedType);for(var T=[],O=1;O<f.length-1;O+=2){var N=d.parse(f[O],O,ai);if(!N)return null;var Z=d.parse(f[O+1],O+1,y);if(!Z)return null;T.push([N,Z]),y=y||Z.type}var q=d.parse(f[f.length-1],f.length-1,y);return q?new xa(y,T,q):null},xa.prototype.evaluate=function(f){for(var d=0,y=this.branches;d<y.length;d+=1){var T=y[d],O=T[1];if(T[0].evaluate(f))return O.evaluate(f)}return this.otherwise.evaluate(f)},xa.prototype.eachChild=function(f){for(var d=0,y=this.branches;d<y.length;d+=1){var T=y[d],O=T[1];f(T[0]),f(O)}f(this.otherwise)},xa.prototype.outputDefined=function(){return this.branches.every(function(f){return f[1].outputDefined()})&&this.otherwise.outputDefined()},xa.prototype.serialize=function(){var f=["case"];return this.eachChild(function(d){f.push(d.serialize())}),f};var lo=function(f,d,y,T){this.type=f,this.input=d,this.beginIndex=y,this.endIndex=T};function Ro(f,d){return f==="=="||f==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function Io(f,d,y,T){return T.compare(d,y)===0}function fa(f,d,y){var T=f!=="=="&&f!=="!=";return function(){function O(N,Z,q){this.type=ai,this.lhs=N,this.rhs=Z,this.collator=q,this.hasUntypedArgument=N.type.kind==="value"||Z.type.kind==="value"}return O.parse=function(N,Z){if(N.length!==3&&N.length!==4)return Z.error("Expected two or three arguments.");var q=N[0],dt=Z.parse(N[1],1,Ai);if(!dt)return null;if(!Ro(q,dt.type))return Z.concat(1).error('"'+q+`" comparisons are not supported for type '`+_a(dt.type)+"'.");var Lt=Z.parse(N[2],2,Ai);if(!Lt)return null;if(!Ro(q,Lt.type))return Z.concat(2).error('"'+q+`" comparisons are not supported for type '`+_a(Lt.type)+"'.");if(dt.type.kind!==Lt.type.kind&&dt.type.kind!=="value"&&Lt.type.kind!=="value")return Z.error("Cannot compare types '"+_a(dt.type)+"' and '"+_a(Lt.type)+"'.");T&&(dt.type.kind==="value"&&Lt.type.kind!=="value"?dt=new kn(Lt.type,[dt]):dt.type.kind!=="value"&&Lt.type.kind==="value"&&(Lt=new kn(dt.type,[Lt])));var Gt=null;if(N.length===4){if(dt.type.kind!=="string"&&Lt.type.kind!=="string"&&dt.type.kind!=="value"&&Lt.type.kind!=="value")return Z.error("Cannot use collator to compare non-string types.");if(!(Gt=Z.parse(N[3],3,Ca)))return null}return new O(dt,Lt,Gt)},O.prototype.evaluate=function(N){var Z=this.lhs.evaluate(N),q=this.rhs.evaluate(N);if(T&&this.hasUntypedArgument){var dt=He(Z),Lt=He(q);if(dt.kind!==Lt.kind||dt.kind!=="string"&&dt.kind!=="number")throw new On('Expected arguments for "'+f+'" to be (string, string) or (number, number), but found ('+dt.kind+", "+Lt.kind+") instead.")}if(this.collator&&!T&&this.hasUntypedArgument){var Gt=He(Z),Qt=He(q);if(Gt.kind!=="string"||Qt.kind!=="string")return d(N,Z,q)}return this.collator?y(N,Z,q,this.collator.evaluate(N)):d(N,Z,q)},O.prototype.eachChild=function(N){N(this.lhs),N(this.rhs),this.collator&&N(this.collator)},O.prototype.outputDefined=function(){return!0},O.prototype.serialize=function(){var N=[f];return this.eachChild(function(Z){N.push(Z.serialize())}),N},O}()}lo.parse=function(f,d){if(f.length<=2||f.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ai),T=d.parse(f[2],2,Qr);if(!y||!T)return null;if(!Uo(y.type,[Va(Ai),Kn,Ai]))return d.error("Expected first argument to be of type array or string, but found "+_a(y.type)+" instead");if(f.length===4){var O=d.parse(f[3],3,Qr);return O?new lo(y.type,y,T,O):null}return new lo(y.type,y,T)},lo.prototype.evaluate=function(f){var d=this.input.evaluate(f),y=this.beginIndex.evaluate(f);if(!vo(d,["string","array"]))throw new On("Expected first argument to be of type array or string, but found "+_a(He(d))+" instead.");if(this.endIndex){var T=this.endIndex.evaluate(f);return d.slice(y,T)}return d.slice(y)},lo.prototype.eachChild=function(f){f(this.input),f(this.beginIndex),this.endIndex&&f(this.endIndex)},lo.prototype.outputDefined=function(){return!1},lo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var f=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),f]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var bu=fa("==",function(f,d,y){return d===y},Io),bl=fa("!=",function(f,d,y){return d!==y},function(f,d,y,T){return!Io(0,d,y,T)}),Ic=fa("<",function(f,d,y){return d<y},function(f,d,y,T){return T.compare(d,y)<0}),Yc=fa(">",function(f,d,y){return d>y},function(f,d,y,T){return T.compare(d,y)>0}),Fl=fa("<=",function(f,d,y){return d<=y},function(f,d,y,T){return T.compare(d,y)<=0}),kc=fa(">=",function(f,d,y){return d>=y},function(f,d,y,T){return T.compare(d,y)>=0}),Uu=function(f,d,y,T,O){this.type=Kn,this.number=f,this.locale=d,this.currency=y,this.minFractionDigits=T,this.maxFractionDigits=O};Uu.parse=function(f,d){if(f.length!==3)return d.error("Expected two arguments.");var y=d.parse(f[1],1,Qr);if(!y)return null;var T=f[2];if(typeof T!="object"||Array.isArray(T))return d.error("NumberFormat options argument must be an object.");var O=null;if(T.locale&&!(O=d.parse(T.locale,1,Kn)))return null;var N=null;if(T.currency&&!(N=d.parse(T.currency,1,Kn)))return null;var Z=null;if(T["min-fraction-digits"]&&!(Z=d.parse(T["min-fraction-digits"],1,Qr)))return null;var q=null;return T["max-fraction-digits"]&&!(q=d.parse(T["max-fraction-digits"],1,Qr))?null:new Uu(y,O,N,Z,q)},Uu.prototype.evaluate=function(f){return new Intl.NumberFormat(this.locale?this.locale.evaluate(f):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(f):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(f):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(f):void 0}).format(this.number.evaluate(f))},Uu.prototype.eachChild=function(f){f(this.number),this.locale&&f(this.locale),this.currency&&f(this.currency),this.minFractionDigits&&f(this.minFractionDigits),this.maxFractionDigits&&f(this.maxFractionDigits)},Uu.prototype.outputDefined=function(){return!1},Uu.prototype.serialize=function(){var f={};return this.locale&&(f.locale=this.locale.serialize()),this.currency&&(f.currency=this.currency.serialize()),this.minFractionDigits&&(f["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(f["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),f]};var js=function(f){this.type=Qr,this.input=f};js.parse=function(f,d){if(f.length!==2)return d.error("Expected 1 argument, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+_a(y.type)+" instead."):new js(y):null},js.prototype.evaluate=function(f){var d=this.input.evaluate(f);if(typeof d=="string"||Array.isArray(d))return d.length;throw new On("Expected value to be of type string or array, but found "+_a(He(d))+" instead.")},js.prototype.eachChild=function(f){f(this.input)},js.prototype.outputDefined=function(){return!1},js.prototype.serialize=function(){var f=["length"];return this.eachChild(function(d){f.push(d.serialize())}),f};var ce={"==":bu,"!=":bl,">":Yc,"<":Ic,">=":kc,"<=":Fl,array:kn,at:Cn,boolean:kn,case:xa,coalesce:Br,collator:Qs,format:qi,image:Oa,in:Vn,"index-of":Ki,interpolate:Ue,"interpolate-hcl":Ue,"interpolate-lab":Ue,length:js,let:zr,literal:en,match:Ma,number:kn,"number-format":Uu,object:kn,slice:lo,step:Nu,string:kn,"to-boolean":Ao,"to-color":Ao,"to-number":Ao,"to-string":Ao,var:Ku,within:qu};function or(f,d){var y=d[0],T=d[1],O=d[2],N=d[3];y=y.evaluate(f),T=T.evaluate(f),O=O.evaluate(f);var Z=N?N.evaluate(f):1,q=ir(y,T,O,Z);if(q)throw new On(q);return new Xa(y/255*Z,T/255*Z,O/255*Z,Z)}function Fr(f,d){return f in d}function Xr(f,d){var y=d[f];return y===void 0?null:y}function xn(f){return{type:f}}function Ii(f){return{result:"success",value:f}}function ra(f){return{result:"error",value:f}}function Wa(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function Eu(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function Ws(f){return!!f.expression&&f.expression.interpolated}function Ya(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Jl(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function $c(f){return f}function tc(f,d,y){return f!==void 0?f:d!==void 0?d:y!==void 0?y:void 0}function rd(f,d,y,T,O){return tc(typeof y===O?T[y]:void 0,f.default,d.default)}function zf(f,d,y){if(Ya(y)!=="number")return tc(f.default,d.default);var T=f.stops.length;if(T===1||y<=f.stops[0][0])return f.stops[0][1];if(y>=f.stops[T-1][0])return f.stops[T-1][1];var O=xl(f.stops.map(function(N){return N[0]}),y);return f.stops[O][1]}function tv(f,d,y){var T=f.base!==void 0?f.base:1;if(Ya(y)!=="number")return tc(f.default,d.default);var O=f.stops.length;if(O===1||y<=f.stops[0][0])return f.stops[0][1];if(y>=f.stops[O-1][0])return f.stops[O-1][1];var N=xl(f.stops.map(function(Qt){return Qt[0]}),y),Z=function(Qt,me,Fe,nr){var ur=nr-Fe,Sr=Qt-Fe;return ur===0?0:me===1?Sr/ur:(Math.pow(me,Sr)-1)/(Math.pow(me,ur)-1)}(y,T,f.stops[N][0],f.stops[N+1][0]),q=f.stops[N][1],dt=f.stops[N+1][1],Lt=Ts[d.type]||$c;if(f.colorSpace&&f.colorSpace!=="rgb"){var Gt=Jt[f.colorSpace];Lt=function(Qt,me){return Gt.reverse(Gt.interpolate(Gt.forward(Qt),Gt.forward(me),Z))}}return typeof q.evaluate=="function"?{evaluate:function(){for(var Qt=[],me=arguments.length;me--;)Qt[me]=arguments[me];var Fe=q.evaluate.apply(void 0,Qt),nr=dt.evaluate.apply(void 0,Qt);if(Fe!==void 0&&nr!==void 0)return Lt(Fe,nr,Z)}}:Lt(q,dt,Z)}function Ep(f,d,y){return d.type==="color"?y=Xa.parse(y):d.type==="formatted"?y=Yo.fromString(y.toString()):d.type==="resolvedImage"?y=_o.fromString(y.toString()):Ya(y)===d.type||d.type==="enum"&&d.values[y]||(y=void 0),tc(y,f.default,d.default)}Zo.register(ce,{error:[{kind:"error"},[Kn],function(f,d){throw new On(d[0].evaluate(f))}],typeof:[Kn,[Ai],function(f,d){return _a(He(d[0].evaluate(f)))}],"to-rgba":[Va(Qr,4),[fi],function(f,d){return d[0].evaluate(f).toArray()}],rgb:[fi,[Qr,Qr,Qr],or],rgba:[fi,[Qr,Qr,Qr,Qr],or],has:{type:ai,overloads:[[[Kn],function(f,d){return Fr(d[0].evaluate(f),f.properties())}],[[Kn,oa],function(f,d){var y=d[1];return Fr(d[0].evaluate(f),y.evaluate(f))}]]},get:{type:Ai,overloads:[[[Kn],function(f,d){return Xr(d[0].evaluate(f),f.properties())}],[[Kn,oa],function(f,d){var y=d[1];return Xr(d[0].evaluate(f),y.evaluate(f))}]]},"feature-state":[Ai,[Kn],function(f,d){return Xr(d[0].evaluate(f),f.featureState||{})}],properties:[oa,[],function(f){return f.properties()}],"geometry-type":[Kn,[],function(f){return f.geometryType()}],id:[Ai,[],function(f){return f.id()}],zoom:[Qr,[],function(f){return f.globals.zoom}],"heatmap-density":[Qr,[],function(f){return f.globals.heatmapDensity||0}],"line-progress":[Qr,[],function(f){return f.globals.lineProgress||0}],accumulated:[Ai,[],function(f){return f.globals.accumulated===void 0?null:f.globals.accumulated}],"+":[Qr,xn(Qr),function(f,d){for(var y=0,T=0,O=d;T<O.length;T+=1)y+=O[T].evaluate(f);return y}],"*":[Qr,xn(Qr),function(f,d){for(var y=1,T=0,O=d;T<O.length;T+=1)y*=O[T].evaluate(f);return y}],"-":{type:Qr,overloads:[[[Qr,Qr],function(f,d){var y=d[1];return d[0].evaluate(f)-y.evaluate(f)}],[[Qr],function(f,d){return-d[0].evaluate(f)}]]},"/":[Qr,[Qr,Qr],function(f,d){var y=d[1];return d[0].evaluate(f)/y.evaluate(f)}],"%":[Qr,[Qr,Qr],function(f,d){var y=d[1];return d[0].evaluate(f)%y.evaluate(f)}],ln2:[Qr,[],function(){return Math.LN2}],pi:[Qr,[],function(){return Math.PI}],e:[Qr,[],function(){return Math.E}],"^":[Qr,[Qr,Qr],function(f,d){var y=d[1];return Math.pow(d[0].evaluate(f),y.evaluate(f))}],sqrt:[Qr,[Qr],function(f,d){return Math.sqrt(d[0].evaluate(f))}],log10:[Qr,[Qr],function(f,d){return Math.log(d[0].evaluate(f))/Math.LN10}],ln:[Qr,[Qr],function(f,d){return Math.log(d[0].evaluate(f))}],log2:[Qr,[Qr],function(f,d){return Math.log(d[0].evaluate(f))/Math.LN2}],sin:[Qr,[Qr],function(f,d){return Math.sin(d[0].evaluate(f))}],cos:[Qr,[Qr],function(f,d){return Math.cos(d[0].evaluate(f))}],tan:[Qr,[Qr],function(f,d){return Math.tan(d[0].evaluate(f))}],asin:[Qr,[Qr],function(f,d){return Math.asin(d[0].evaluate(f))}],acos:[Qr,[Qr],function(f,d){return Math.acos(d[0].evaluate(f))}],atan:[Qr,[Qr],function(f,d){return Math.atan(d[0].evaluate(f))}],min:[Qr,xn(Qr),function(f,d){return Math.min.apply(Math,d.map(function(y){return y.evaluate(f)}))}],max:[Qr,xn(Qr),function(f,d){return Math.max.apply(Math,d.map(function(y){return y.evaluate(f)}))}],abs:[Qr,[Qr],function(f,d){return Math.abs(d[0].evaluate(f))}],round:[Qr,[Qr],function(f,d){var y=d[0].evaluate(f);return y<0?-Math.round(-y):Math.round(y)}],floor:[Qr,[Qr],function(f,d){return Math.floor(d[0].evaluate(f))}],ceil:[Qr,[Qr],function(f,d){return Math.ceil(d[0].evaluate(f))}],"filter-==":[ai,[Kn,Ai],function(f,d){var y=d[0],T=d[1];return f.properties()[y.value]===T.value}],"filter-id-==":[ai,[Ai],function(f,d){var y=d[0];return f.id()===y.value}],"filter-type-==":[ai,[Kn],function(f,d){var y=d[0];return f.geometryType()===y.value}],"filter-<":[ai,[Kn,Ai],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O<N}],"filter-id-<":[ai,[Ai],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T<O}],"filter->":[ai,[Kn,Ai],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O>N}],"filter-id->":[ai,[Ai],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T>O}],"filter-<=":[ai,[Kn,Ai],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O<=N}],"filter-id-<=":[ai,[Ai],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T<=O}],"filter->=":[ai,[Kn,Ai],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O>=N}],"filter-id->=":[ai,[Ai],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T>=O}],"filter-has":[ai,[Ai],function(f,d){return d[0].value in f.properties()}],"filter-has-id":[ai,[],function(f){return f.id()!==null&&f.id()!==void 0}],"filter-type-in":[ai,[Va(Kn)],function(f,d){return d[0].value.indexOf(f.geometryType())>=0}],"filter-id-in":[ai,[Va(Ai)],function(f,d){return d[0].value.indexOf(f.id())>=0}],"filter-in-small":[ai,[Kn,Va(Ai)],function(f,d){var y=d[0];return d[1].value.indexOf(f.properties()[y.value])>=0}],"filter-in-large":[ai,[Kn,Va(Ai)],function(f,d){var y=d[0],T=d[1];return function(O,N,Z,q){for(;Z<=q;){var dt=Z+q>>1;if(N[dt]===O)return!0;N[dt]>O?q=dt-1:Z=dt+1}return!1}(f.properties()[y.value],T.value,0,T.value.length-1)}],all:{type:ai,overloads:[[[ai,ai],function(f,d){var y=d[1];return d[0].evaluate(f)&&y.evaluate(f)}],[xn(ai),function(f,d){for(var y=0,T=d;y<T.length;y+=1)if(!T[y].evaluate(f))return!1;return!0}]]},any:{type:ai,overloads:[[[ai,ai],function(f,d){var y=d[1];return d[0].evaluate(f)||y.evaluate(f)}],[xn(ai),function(f,d){for(var y=0,T=d;y<T.length;y+=1)if(T[y].evaluate(f))return!0;return!1}]]},"!":[ai,[ai],function(f,d){return!d[0].evaluate(f)}],"is-supported-script":[ai,[Kn],function(f,d){var y=f.globals&&f.globals.isSupportedScript;return!y||y(d[0].evaluate(f))}],upcase:[Kn,[Kn],function(f,d){return d[0].evaluate(f).toUpperCase()}],downcase:[Kn,[Kn],function(f,d){return d[0].evaluate(f).toLowerCase()}],concat:[Kn,xn(Ai),function(f,d){return d.map(function(y){return Ir(y.evaluate(f))}).join("")}],"resolved-locale":[Kn,[Ca],function(f,d){return d[0].evaluate(f).resolvedLocale()}]});var Uf=function(f,d){this.expression=f,this._warningHistory={},this._evaluator=new uo,this._defaultValue=d?function(y){return y.type==="color"&&Jl(y.default)?new Xa(0,0,0,0):y.type==="color"?Xa.parse(y.default)||null:y.default===void 0?null:y.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function qc(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in ce}function Zf(f,d){var y=new Bu(ce,[],d?function(O){var N={color:fi,string:Kn,number:Qr,enum:Kn,boolean:ai,formatted:po,resolvedImage:La};return O.type==="array"?Va(N[O.value]||Ai,O.length):N[O.type]}(d):void 0),T=y.parse(f,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?Ii(new Uf(T,d)):ra(y.errors)}Uf.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._evaluator.globals=f,this._evaluator.feature=d,this._evaluator.featureState=y,this._evaluator.canonical=T,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=N,this.expression.evaluate(this._evaluator)},Uf.prototype.evaluate=function(f,d,y,T,O,N){this._evaluator.globals=f,this._evaluator.feature=d||null,this._evaluator.featureState=y||null,this._evaluator.canonical=T,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=N||null;try{var Z=this.expression.evaluate(this._evaluator);if(Z==null||typeof Z=="number"&&Z!=Z)return this._defaultValue;if(this._enumValues&&!(Z in this._enumValues))throw new On("Expected value to be one of "+Object.keys(this._enumValues).map(function(q){return JSON.stringify(q)}).join(", ")+", but found "+JSON.stringify(Z)+" instead.");return Z}catch(q){return this._warningHistory[q.message]||(this._warningHistory[q.message]=!0,typeof console!="undefined"&&console.warn(q.message)),this._defaultValue}};var Kc=function(f,d){this.kind=f,this._styleExpression=d,this.isStateDependent=f!=="constant"&&!Zs(d.expression)};Kc.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._styleExpression.evaluateWithoutErrorHandling(f,d,y,T,O,N)},Kc.prototype.evaluate=function(f,d,y,T,O,N){return this._styleExpression.evaluate(f,d,y,T,O,N)};var Vf=function(f,d,y,T){this.kind=f,this.zoomStops=y,this._styleExpression=d,this.isStateDependent=f!=="camera"&&!Zs(d.expression),this.interpolationType=T};function fh(f,d){if((f=Zf(f,d)).result==="error")return f;var y=f.value.expression,T=yu(y);if(!T&&!Wa(d))return ra([new Pn("","data expressions not supported")]);var O=_u(y,["zoom"]);if(!O&&!Eu(d))return ra([new Pn("","zoom expressions not supported")]);var N=function Z(q){var dt=null;if(q instanceof zr)dt=Z(q.result);else if(q instanceof Br)for(var Lt=0,Gt=q.args;Lt<Gt.length&&!(dt=Z(Gt[Lt]));Lt+=1);else(q instanceof Nu||q instanceof Ue)&&q.input instanceof Zo&&q.input.name==="zoom"&&(dt=q);return dt instanceof Pn||q.eachChild(function(Qt){var me=Z(Qt);me instanceof Pn?dt=me:!dt&&me?dt=new Pn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):dt&&me&&dt!==me&&(dt=new Pn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),dt}(y);return N||O?N instanceof Pn?ra([N]):N instanceof Ue&&!Ws(d)?ra([new Pn("",'"interpolate" expressions cannot be used with this property')]):Ii(N?new Vf(T?"camera":"composite",f.value,N.labels,N instanceof Ue?N.interpolation:void 0):new Kc(T?"constant":"source",f.value)):ra([new Pn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Vf.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._styleExpression.evaluateWithoutErrorHandling(f,d,y,T,O,N)},Vf.prototype.evaluate=function(f,d,y,T,O,N){return this._styleExpression.evaluate(f,d,y,T,O,N)},Vf.prototype.interpolationFactor=function(f,d,y){return this.interpolationType?Ue.interpolationFactor(this.interpolationType,f,d,y):0};var Qc=function(f,d){this._parameters=f,this._specification=d,Tn(this,function y(T,O){var N,Z,q,dt=O.type==="color",Lt=T.stops&&typeof T.stops[0][0]=="object",Gt=Lt||!(Lt||T.property!==void 0),Qt=T.type||(Ws(O)?"exponential":"interval");if(dt&&((T=Tn({},T)).stops&&(T.stops=T.stops.map(function(Zi){return[Zi[0],Xa.parse(Zi[1])]})),T.default=Xa.parse(T.default?T.default:O.default)),T.colorSpace&&T.colorSpace!=="rgb"&&!Jt[T.colorSpace])throw new Error("Unknown color space: "+T.colorSpace);if(Qt==="exponential")N=tv;else if(Qt==="interval")N=zf;else if(Qt==="categorical"){N=rd,Z=Object.create(null);for(var me=0,Fe=T.stops;me<Fe.length;me+=1){var nr=Fe[me];Z[nr[0]]=nr[1]}q=typeof T.stops[0][0]}else{if(Qt!=="identity")throw new Error('Unknown function type "'+Qt+'"');N=Ep}if(Lt){for(var ur={},Sr=[],gr=0;gr<T.stops.length;gr++){var Ur=T.stops[gr],tn=Ur[0].zoom;ur[tn]===void 0&&(ur[tn]={zoom:tn,type:T.type,property:T.property,default:T.default,stops:[]},Sr.push(tn)),ur[tn].stops.push([Ur[0].value,Ur[1]])}for(var un=[],yn=0,Fn=Sr;yn<Fn.length;yn+=1){var ii=Fn[yn];un.push([ur[ii].zoom,y(ur[ii],O)])}var Si={name:"linear"};return{kind:"composite",interpolationType:Si,interpolationFactor:Ue.interpolationFactor.bind(void 0,Si),zoomStops:un.map(function(Zi){return Zi[0]}),evaluate:function(Zi,pa){var Rn=Zi.zoom;return tv({stops:un,base:T.base},O,Rn).evaluate(Rn,pa)}}}if(Gt){var sa=Qt==="exponential"?{name:"exponential",base:T.base!==void 0?T.base:1}:null;return{kind:"camera",interpolationType:sa,interpolationFactor:Ue.interpolationFactor.bind(void 0,sa),zoomStops:T.stops.map(function(Zi){return Zi[0]}),evaluate:function(Zi){return N(T,O,Zi.zoom,Z,q)}}}return{kind:"source",evaluate:function(Zi,pa){var Rn=pa&&pa.properties?pa.properties[T.property]:void 0;return Rn===void 0?tc(T.default,O.default):N(T,O,Rn,Z,q)}}}(this._parameters,this._specification))};function Rl(f){var d=f.key,y=f.value,T=f.valueSpec||{},O=f.objectElementValidators||{},N=f.style,Z=f.styleSpec,q=[],dt=Ya(y);if(dt!=="object")return[new ar(d,y,"object expected, "+dt+" found")];for(var Lt in y){var Gt=Lt.split(".")[0],Qt=T[Gt]||T["*"],me=void 0;if(O[Gt])me=O[Gt];else if(T[Gt])me=Ja;else if(O["*"])me=O["*"];else{if(!T["*"]){q.push(new ar(d,y[Lt],'unknown property "'+Lt+'"'));continue}me=Ja}q=q.concat(me({key:(d&&d+".")+Lt,value:y[Lt],valueSpec:Qt,style:N,styleSpec:Z,object:y,objectKey:Lt},y))}for(var Fe in T)O[Fe]||T[Fe].required&&T[Fe].default===void 0&&y[Fe]===void 0&&q.push(new ar(d,y,'missing required property "'+Fe+'"'));return q}function wp(f){var d=f.value,y=f.valueSpec,T=f.style,O=f.styleSpec,N=f.key,Z=f.arrayElementValidator||Ja;if(Ya(d)!=="array")return[new ar(N,d,"array expected, "+Ya(d)+" found")];if(y.length&&d.length!==y.length)return[new ar(N,d,"array length "+y.length+" expected, length "+d.length+" found")];if(y["min-length"]&&d.length<y["min-length"])return[new ar(N,d,"array length at least "+y["min-length"]+" expected, length "+d.length+" found")];var q={type:y.value,values:y.values};O.$version<7&&(q.function=y.function),Ya(y.value)==="object"&&(q=y.value);for(var dt=[],Lt=0;Lt<d.length;Lt++)dt=dt.concat(Z({array:d,arrayIndex:Lt,value:d[Lt],valueSpec:q,style:T,styleSpec:O,key:N+"["+Lt+"]"}));return dt}function hh(f){var d=f.key,y=f.value,T=f.valueSpec,O=Ya(y);return O==="number"&&y!=y&&(O="NaN"),O!=="number"?[new ar(d,y,"number expected, "+O+" found")]:"minimum"in T&&y<T.minimum?[new ar(d,y,y+" is less than the minimum value "+T.minimum)]:"maximum"in T&&y>T.maximum?[new ar(d,y,y+" is greater than the maximum value "+T.maximum)]:[]}function Qu(f){var d,y,T,O=f.valueSpec,N=Kr(f.value.type),Z={},q=N!=="categorical"&&f.value.property===void 0,dt=!q,Lt=Ya(f.value.stops)==="array"&&Ya(f.value.stops[0])==="array"&&Ya(f.value.stops[0][0])==="object",Gt=Rl({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(Fe){if(N==="identity")return[new ar(Fe.key,Fe.value,'identity function may not have a "stops" property')];var nr=[],ur=Fe.value;return nr=nr.concat(wp({key:Fe.key,value:ur,valueSpec:Fe.valueSpec,style:Fe.style,styleSpec:Fe.styleSpec,arrayElementValidator:Qt})),Ya(ur)==="array"&&ur.length===0&&nr.push(new ar(Fe.key,ur,"array must have at least one stop")),nr},default:function(Fe){return Ja({key:Fe.key,value:Fe.value,valueSpec:O,style:Fe.style,styleSpec:Fe.styleSpec})}}});return N==="identity"&&q&&Gt.push(new ar(f.key,f.value,'missing required property "property"')),N==="identity"||f.value.stops||Gt.push(new ar(f.key,f.value,'missing required property "stops"')),N==="exponential"&&f.valueSpec.expression&&!Ws(f.valueSpec)&&Gt.push(new ar(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(dt&&!Wa(f.valueSpec)?Gt.push(new ar(f.key,f.value,"property functions not supported")):q&&!Eu(f.valueSpec)&&Gt.push(new ar(f.key,f.value,"zoom functions not supported"))),N!=="categorical"&&!Lt||f.value.property!==void 0||Gt.push(new ar(f.key,f.value,'"property" property is required')),Gt;function Qt(Fe){var nr=[],ur=Fe.value,Sr=Fe.key;if(Ya(ur)!=="array")return[new ar(Sr,ur,"array expected, "+Ya(ur)+" found")];if(ur.length!==2)return[new ar(Sr,ur,"array length 2 expected, length "+ur.length+" found")];if(Lt){if(Ya(ur[0])!=="object")return[new ar(Sr,ur,"object expected, "+Ya(ur[0])+" found")];if(ur[0].zoom===void 0)return[new ar(Sr,ur,"object stop key must have zoom")];if(ur[0].value===void 0)return[new ar(Sr,ur,"object stop key must have value")];if(T&&T>Kr(ur[0].zoom))return[new ar(Sr,ur[0].zoom,"stop zoom values must appear in ascending order")];Kr(ur[0].zoom)!==T&&(T=Kr(ur[0].zoom),y=void 0,Z={}),nr=nr.concat(Rl({key:Sr+"[0]",value:ur[0],valueSpec:{zoom:{}},style:Fe.style,styleSpec:Fe.styleSpec,objectElementValidators:{zoom:hh,value:me}}))}else nr=nr.concat(me({key:Sr+"[0]",value:ur[0],valueSpec:{},style:Fe.style,styleSpec:Fe.styleSpec},ur));return qc(an(ur[1]))?nr.concat([new ar(Sr+"[1]",ur[1],"expressions are not allowed in function stops.")]):nr.concat(Ja({key:Sr+"[1]",value:ur[1],valueSpec:O,style:Fe.style,styleSpec:Fe.styleSpec}))}function me(Fe,nr){var ur=Ya(Fe.value),Sr=Kr(Fe.value),gr=Fe.value!==null?Fe.value:nr;if(d){if(ur!==d)return[new ar(Fe.key,gr,ur+" stop domain type must match previous stop domain type "+d)]}else d=ur;if(ur!=="number"&&ur!=="string"&&ur!=="boolean")return[new ar(Fe.key,gr,"stop domain value must be a number, string, or boolean")];if(ur!=="number"&&N!=="categorical"){var Ur="number expected, "+ur+" found";return Wa(O)&&N===void 0&&(Ur+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ar(Fe.key,gr,Ur)]}return N!=="categorical"||ur!=="number"||isFinite(Sr)&&Math.floor(Sr)===Sr?N!=="categorical"&&ur==="number"&&y!==void 0&&Sr<y?[new ar(Fe.key,gr,"stop domain values must appear in ascending order")]:(y=Sr,N==="categorical"&&Sr in Z?[new ar(Fe.key,gr,"stop domain values must be unique")]:(Z[Sr]=!0,[])):[new ar(Fe.key,gr,"integer expected, found "+Sr)]}}function Jc(f){var d=(f.expressionContext==="property"?fh:Zf)(an(f.value),f.valueSpec);if(d.result==="error")return d.value.map(function(T){return new ar(""+f.key+T.key,f.value,T.message)});var y=d.value.expression||d.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!y.outputDefined())return[new ar(f.key,f.value,'Invalid data expression for "'+f.propertyKey+'". Output values must be contained as literals within the expression.')];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!Zs(y))return[new ar(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!Zs(y))return[new ar(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!_u(y,["zoom","feature-state"]))return[new ar(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!yu(y))return[new ar(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zh(f){var d=f.key,y=f.value,T=f.valueSpec,O=[];return Array.isArray(T.values)?T.values.indexOf(Kr(y))===-1&&O.push(new ar(d,y,"expected one of ["+T.values.join(", ")+"], "+JSON.stringify(y)+" found")):Object.keys(T.values).indexOf(Kr(y))===-1&&O.push(new ar(d,y,"expected one of ["+Object.keys(T.values).join(", ")+"], "+JSON.stringify(y)+" found")),O}function Gf(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(var d=0,y=f.slice(1);d<y.length;d+=1){var T=y[d];if(!Gf(T)&&typeof T!="boolean")return!1}return!0;default:return!0}}Qc.deserialize=function(f){return new Qc(f._parameters,f._specification)},Qc.serialize=function(f){return{_parameters:f._parameters,_specification:f._specification}};var ec={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Sp(f){if(f==null)return{filter:function(){return!0},needGeometry:!1};Gf(f)||(f=Cp(f));var d=Zf(f,ec);if(d.result==="error")throw new Error(d.value.map(function(y){return y.key+": "+y.message}).join(", "));return{filter:function(y,T,O){return d.value.evaluate(y,T,{},O)},needGeometry:function y(T){if(!Array.isArray(T))return!1;if(T[0]==="within")return!0;for(var O=1;O<T.length;O++)if(y(T[O]))return!0;return!1}(f)}}function nd(f,d){return f<d?-1:f>d?1:0}function Cp(f){if(!f)return!0;var d,y=f[0];return f.length<=1?y!=="any":y==="=="?rc(f[1],f[2],"=="):y==="!="?Hf(rc(f[1],f[2],"==")):y==="<"||y===">"||y==="<="||y===">="?rc(f[1],f[2],y):y==="any"?(d=f.slice(1),["any"].concat(d.map(Cp))):y==="all"?["all"].concat(f.slice(1).map(Cp)):y==="none"?["all"].concat(f.slice(1).map(Cp).map(Hf)):y==="in"?id(f[1],f.slice(2)):y==="!in"?Hf(id(f[1],f.slice(2))):y==="has"?tf(f[1]):y==="!has"?Hf(tf(f[1])):y!=="within"||f}function rc(f,d,y){switch(f){case"$type":return["filter-type-"+y,d];case"$id":return["filter-id-"+y,d];default:return["filter-"+y,f,d]}}function id(f,d){if(d.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(y){return typeof y!=typeof d[0]})?["filter-in-large",f,["literal",d.sort(nd)]]:["filter-in-small",f,["literal",d]]}}function tf(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Hf(f){return["!",f]}function gf(f){return Gf(an(f.value))?Jc(Tn({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(y){var T=y.value,O=y.key;if(Ya(T)!=="array")return[new ar(O,T,"array expected, "+Ya(T)+" found")];var N,Z=y.styleSpec,q=[];if(T.length<1)return[new ar(O,T,"filter array must have at least 1 element")];switch(q=q.concat(Zh({key:O+"[0]",value:T[0],valueSpec:Z.filter_operator,style:y.style,styleSpec:y.styleSpec})),Kr(T[0])){case"<":case"<=":case">":case">=":T.length>=2&&Kr(T[1])==="$type"&&q.push(new ar(O,T,'"$type" cannot be use with operator "'+T[0]+'"'));case"==":case"!=":T.length!==3&&q.push(new ar(O,T,'filter array for operator "'+T[0]+'" must have 3 elements'));case"in":case"!in":T.length>=2&&(N=Ya(T[1]))!=="string"&&q.push(new ar(O+"[1]",T[1],"string expected, "+N+" found"));for(var dt=2;dt<T.length;dt++)N=Ya(T[dt]),Kr(T[1])==="$type"?q=q.concat(Zh({key:O+"["+dt+"]",value:T[dt],valueSpec:Z.geometry_type,style:y.style,styleSpec:y.styleSpec})):N!=="string"&&N!=="number"&&N!=="boolean"&&q.push(new ar(O+"["+dt+"]",T[dt],"string, number, or boolean expected, "+N+" found"));break;case"any":case"all":case"none":for(var Lt=1;Lt<T.length;Lt++)q=q.concat(d({key:O+"["+Lt+"]",value:T[Lt],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":N=Ya(T[1]),T.length!==2?q.push(new ar(O,T,'filter array for "'+T[0]+'" operator must have 2 elements')):N!=="string"&&q.push(new ar(O+"[1]",T[1],"string expected, "+N+" found"));break;case"within":N=Ya(T[1]),T.length!==2?q.push(new ar(O,T,'filter array for "'+T[0]+'" operator must have 2 elements')):N!=="object"&&q.push(new ar(O+"[1]",T[1],"object expected, "+N+" found"))}return q}(f)}function ad(f,d){var y=f.key,T=f.style,O=f.styleSpec,N=f.value,Z=f.objectKey,q=O[d+"_"+f.layerType];if(!q)return[];var dt=Z.match(/^(.*)-transition$/);if(d==="paint"&&dt&&q[dt[1]]&&q[dt[1]].transition)return Ja({key:y,value:N,valueSpec:O.transition,style:T,styleSpec:O});var Lt,Gt=f.valueSpec||q[Z];if(!Gt)return[new ar(y,N,'unknown property "'+Z+'"')];if(Ya(N)==="string"&&Wa(Gt)&&!Gt.tokens&&(Lt=/^{([^}]+)}$/.exec(N)))return[new ar(y,N,'"'+Z+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Lt[1])+" }`.")];var Qt=[];return f.layerType==="symbol"&&(Z==="text-field"&&T&&!T.glyphs&&Qt.push(new ar(y,N,'use of "text-field" requires a style "glyphs" property')),Z==="text-font"&&Jl(an(N))&&Kr(N.type)==="identity"&&Qt.push(new ar(y,N,'"text-font" does not support identity functions'))),Qt.concat(Ja({key:f.key,value:N,valueSpec:Gt,style:T,styleSpec:O,expressionContext:"property",propertyType:d,propertyKey:Z}))}function od(f){return ad(f,"paint")}function mf(f){return ad(f,"layout")}function $v(f){var d=[],y=f.value,T=f.key,O=f.style,N=f.styleSpec;y.type||y.ref||d.push(new ar(T,y,'either "type" or "ref" is required'));var Z,q=Kr(y.type),dt=Kr(y.ref);if(y.id)for(var Lt=Kr(y.id),Gt=0;Gt<f.arrayIndex;Gt++){var Qt=O.layers[Gt];Kr(Qt.id)===Lt&&d.push(new ar(T,y.id,'duplicate layer id "'+y.id+'", previously used at line '+Qt.id.__line__))}if("ref"in y)["type","source","source-layer","filter","layout"].forEach(function(nr){nr in y&&d.push(new ar(T,y[nr],'"'+nr+'" is prohibited for ref layers'))}),O.layers.forEach(function(nr){Kr(nr.id)===dt&&(Z=nr)}),Z?Z.ref?d.push(new ar(T,y.ref,"ref cannot reference another ref layer")):q=Kr(Z.type):d.push(new ar(T,y.ref,'ref layer "'+dt+'" not found'));else if(q!=="background")if(y.source){var me=O.sources&&O.sources[y.source],Fe=me&&Kr(me.type);me?Fe==="vector"&&q==="raster"?d.push(new ar(T,y.source,'layer "'+y.id+'" requires a raster source')):Fe==="raster"&&q!=="raster"?d.push(new ar(T,y.source,'layer "'+y.id+'" requires a vector source')):Fe!=="vector"||y["source-layer"]?Fe==="raster-dem"&&q!=="hillshade"?d.push(new ar(T,y.source,"raster-dem source can only be used with layer type 'hillshade'.")):q!=="line"||!y.paint||!y.paint["line-gradient"]||Fe==="geojson"&&me.lineMetrics||d.push(new ar(T,y,'layer "'+y.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new ar(T,y,'layer "'+y.id+'" must specify a "source-layer"')):d.push(new ar(T,y.source,'source "'+y.source+'" not found'))}else d.push(new ar(T,y,'missing required property "source"'));return d=d.concat(Rl({key:T,value:y,valueSpec:N.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ja({key:T+".type",value:y.type,valueSpec:N.layer.type,style:f.style,styleSpec:f.styleSpec,object:y,objectKey:"type"})},filter:gf,layout:function(nr){return Rl({layer:y,key:nr.key,value:nr.value,style:nr.style,styleSpec:nr.styleSpec,objectElementValidators:{"*":function(ur){return mf(Tn({layerType:q},ur))}}})},paint:function(nr){return Rl({layer:y,key:nr.key,value:nr.value,style:nr.style,styleSpec:nr.styleSpec,objectElementValidators:{"*":function(ur){return od(Tn({layerType:q},ur))}}})}}}))}function ph(f){var d=f.value,y=f.key,T=Ya(d);return T!=="string"?[new ar(y,d,"string expected, "+T+" found")]:[]}var gs={promoteId:function(f){var d=f.key,y=f.value;if(Ya(y)==="string")return ph({key:d,value:y});var T=[];for(var O in y)T.push.apply(T,ph({key:d+"."+O,value:y[O]}));return T}};function yf(f){var d=f.value,y=f.key,T=f.styleSpec,O=f.style;if(!d.type)return[new ar(y,d,'"type" is required')];var N,Z=Kr(d.type);switch(Z){case"vector":case"raster":case"raster-dem":return Rl({key:y,value:d,valueSpec:T["source_"+Z.replace("-","_")],style:f.style,styleSpec:T,objectElementValidators:gs});case"geojson":if(N=Rl({key:y,value:d,valueSpec:T.source_geojson,style:O,styleSpec:T,objectElementValidators:gs}),d.cluster)for(var q in d.clusterProperties){var dt=d.clusterProperties[q],Lt=dt[0],Gt=typeof Lt=="string"?[Lt,["accumulated"],["get",q]]:Lt;N.push.apply(N,Jc({key:y+"."+q+".map",value:dt[1],expressionContext:"cluster-map"})),N.push.apply(N,Jc({key:y+"."+q+".reduce",value:Gt,expressionContext:"cluster-reduce"}))}return N;case"video":return Rl({key:y,value:d,valueSpec:T.source_video,style:O,styleSpec:T});case"image":return Rl({key:y,value:d,valueSpec:T.source_image,style:O,styleSpec:T});case"canvas":return[new ar(y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zh({key:y+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:O,styleSpec:T})}}function jf(f){var d=f.value,y=f.styleSpec,T=y.light,O=f.style,N=[],Z=Ya(d);if(d===void 0)return N;if(Z!=="object")return N.concat([new ar("light",d,"object expected, "+Z+" found")]);for(var q in d){var dt=q.match(/^(.*)-transition$/);N=N.concat(dt&&T[dt[1]]&&T[dt[1]].transition?Ja({key:q,value:d[q],valueSpec:y.transition,style:O,styleSpec:y}):T[q]?Ja({key:q,value:d[q],valueSpec:T[q],style:O,styleSpec:y}):[new ar(q,d[q],'unknown property "'+q+'"')])}return N}var Dl={"*":function(){return[]},array:wp,boolean:function(f){var d=f.value,y=f.key,T=Ya(d);return T!=="boolean"?[new ar(y,d,"boolean expected, "+T+" found")]:[]},number:hh,color:function(f){var d=f.key,y=f.value,T=Ya(y);return T!=="string"?[new ar(d,y,"color expected, "+T+" found")]:Ua(y)===null?[new ar(d,y,'color expected, "'+y+'" found')]:[]},constants:Hr,enum:Zh,filter:gf,function:Qu,layer:$v,object:Rl,source:yf,light:jf,string:ph,formatted:function(f){return ph(f).length===0?[]:Jc(f)},resolvedImage:function(f){return ph(f).length===0?[]:Jc(f)}};function Ja(f){var d=f.value,y=f.valueSpec,T=f.styleSpec;return y.expression&&Jl(Kr(d))?Qu(f):y.expression&&qc(an(d))?Jc(f):y.type&&Dl[y.type]?Dl[y.type](f):Rl(Tn({},f,{valueSpec:y.type?T[y.type]:y}))}function Wo(f){var d=f.value,y=f.key,T=ph(f);return T.length||(d.indexOf("{fontstack}")===-1&&T.push(new ar(y,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&T.push(new ar(y,d,'"glyphs" url must include a "{range}" token'))),T}function ro(f,d){d===void 0&&(d=Ce);var y=[];return y=y.concat(Ja({key:"",value:f,valueSpec:d.$root,styleSpec:d,style:f,objectElementValidators:{glyphs:Wo,"*":function(){return[]}}})),f.constants&&(y=y.concat(Hr({key:"constants",value:f.constants,style:f,styleSpec:d}))),Ap(y)}function Ap(f){return[].concat(f).sort(function(d,y){return d.line-y.line})}function Bl(f){return function(){for(var d=[],y=arguments.length;y--;)d[y]=arguments[y];return Ap(f.apply(this,d))}}ro.source=Bl(yf),ro.light=Bl(jf),ro.layer=Bl($v),ro.filter=Bl(gf),ro.paintProperty=Bl(od),ro.layoutProperty=Bl(mf);var Tp=ro,qv=Tp.light,Ia=Tp.paintProperty,Wf=Tp.layoutProperty;function ef(f,d){var y=!1;if(d&&d.length)for(var T=0,O=d;T<O.length;T+=1)f.fire(new cr(new Error(O[T].message))),y=!0;return y}var _f=tu;function tu(f,d,y){var T=this.cells=[];if(f instanceof ArrayBuffer){this.arrayBuffer=f;var O=new Int32Array(this.arrayBuffer);f=O[0],this.d=(d=O[1])+2*(y=O[2]);for(var N=0;N<this.d*this.d;N++){var Z=O[3+N],q=O[3+N+1];T.push(Z===q?null:O.subarray(Z,q))}var dt=O[3+T.length+1];this.keys=O.subarray(O[3+T.length],dt),this.bboxes=O.subarray(dt),this.insert=this._insertReadonly}else{this.d=d+2*y;for(var Lt=0;Lt<this.d*this.d;Lt++)T.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=f,this.padding=y,this.scale=d/f,this.uid=0;var Gt=y/d*f;this.min=-Gt,this.max=f+Gt}tu.prototype.insert=function(f,d,y,T,O){this._forEachCell(d,y,T,O,this._insertCell,this.uid++),this.keys.push(f),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(T),this.bboxes.push(O)},tu.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},tu.prototype._insertCell=function(f,d,y,T,O,N){this.cells[O].push(N)},tu.prototype.query=function(f,d,y,T,O){var N=this.min,Z=this.max;if(f<=N&&d<=N&&Z<=y&&Z<=T&&!O)return Array.prototype.slice.call(this.keys);var q=[];return this._forEachCell(f,d,y,T,this._queryCell,q,{},O),q},tu.prototype._queryCell=function(f,d,y,T,O,N,Z,q){var dt=this.cells[O];if(dt!==null)for(var Lt=this.keys,Gt=this.bboxes,Qt=0;Qt<dt.length;Qt++){var me=dt[Qt];if(Z[me]===void 0){var Fe=4*me;(q?q(Gt[Fe+0],Gt[Fe+1],Gt[Fe+2],Gt[Fe+3]):f<=Gt[Fe+2]&&d<=Gt[Fe+3]&&y>=Gt[Fe+0]&&T>=Gt[Fe+1])?(Z[me]=!0,N.push(Lt[me])):Z[me]=!1}}},tu.prototype._forEachCell=function(f,d,y,T,O,N,Z,q){for(var dt=this._convertToCellCoord(f),Lt=this._convertToCellCoord(d),Gt=this._convertToCellCoord(y),Qt=this._convertToCellCoord(T),me=dt;me<=Gt;me++)for(var Fe=Lt;Fe<=Qt;Fe++){var nr=this.d*Fe+me;if((!q||q(this._convertFromCellCoord(me),this._convertFromCellCoord(Fe),this._convertFromCellCoord(me+1),this._convertFromCellCoord(Fe+1)))&&O.call(this,f,d,y,T,nr,N,Z,q))return}},tu.prototype._convertFromCellCoord=function(f){return(f-this.padding)/this.scale},tu.prototype._convertToCellCoord=function(f){return Math.max(0,Math.min(this.d-1,Math.floor(f*this.scale)+this.padding))},tu.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var f=this.cells,d=3+this.cells.length+1+1,y=0,T=0;T<this.cells.length;T++)y+=this.cells[T].length;var O=new Int32Array(d+y+this.keys.length+this.bboxes.length);O[0]=this.extent,O[1]=this.n,O[2]=this.padding;for(var N=d,Z=0;Z<f.length;Z++){var q=f[Z];O[3+Z]=N,O.set(q,N),N+=q.length}return O[3+f.length]=N,O.set(this.keys,N),O[3+f.length+1]=N+=this.keys.length,O.set(this.bboxes,N),N+=this.bboxes.length,O.buffer};var dh=et.ImageData,vh=et.ImageBitmap,Fs={};function ji(f,d,y){y===void 0&&(y={}),Object.defineProperty(d,"_classRegistryKey",{value:f,writeable:!1}),Fs[f]={klass:d,omit:y.omit||[],shallow:y.shallow||[]}}for(var _s in ji("Object",Object),_f.serialize=function(f,d){var y=f.toArrayBuffer();return d&&d.push(y),{buffer:y}},_f.deserialize=function(f){return new _f(f.buffer)},ji("Grid",_f),ji("Color",Xa),ji("Error",Error),ji("ResolvedImage",_o),ji("StylePropertyFunction",Qc),ji("StyleExpression",Uf,{omit:["_evaluator"]}),ji("ZoomDependentExpression",Vf),ji("ZoomConstantExpression",Kc),ji("CompoundExpression",Zo,{omit:["_evaluate"]}),ce)ce[_s]._classRegistryKey||ji("Expression_"+_s,ce[_s]);function El(f){return f&&typeof ArrayBuffer!="undefined"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Nl(f){return vh&&f instanceof vh}function vc(f,d){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp)return f;if(El(f)||Nl(f))return d&&d.push(f),f;if(ArrayBuffer.isView(f)){var y=f;return d&&d.push(y.buffer),y}if(f instanceof dh)return d&&d.push(f.data.buffer),f;if(Array.isArray(f)){for(var T=[],O=0,N=f;O<N.length;O+=1)T.push(vc(N[O],d));return T}if(typeof f=="object"){var Z=f.constructor,q=Z._classRegistryKey;if(!q)throw new Error("can't serialize object of unregistered class");var dt=Z.serialize?Z.serialize(f,d):{};if(!Z.serialize){for(var Lt in f)if(f.hasOwnProperty(Lt)&&!(Fs[q].omit.indexOf(Lt)>=0)){var Gt=f[Lt];dt[Lt]=Fs[q].shallow.indexOf(Lt)>=0?Gt:vc(Gt,d)}f instanceof Error&&(dt.message=f.message)}if(dt.$name)throw new Error("$name property is reserved for worker serialization logic.");return q!=="Object"&&(dt.$name=q),dt}throw new Error("can't serialize object of type "+typeof f)}function Zu(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||El(f)||Nl(f)||ArrayBuffer.isView(f)||f instanceof dh)return f;if(Array.isArray(f))return f.map(Zu);if(typeof f=="object"){var d=f.$name||"Object",y=Fs[d].klass;if(!y)throw new Error("can't deserialize unregistered class "+d);if(y.deserialize)return y.deserialize(f);for(var T=Object.create(y.prototype),O=0,N=Object.keys(f);O<N.length;O+=1){var Z=N[O];if(Z!=="$name"){var q=f[Z];T[Z]=Fs[d].shallow.indexOf(Z)>=0?q:Zu(q)}}return T}throw new Error("can't deserialize object of type "+typeof f)}var sd=function(){this.first=!0};sd.prototype.update=function(f,d){var y=Math.floor(f);return this.first?(this.first=!1,this.lastIntegerZoom=y,this.lastIntegerZoomTime=0,this.lastZoom=f,this.lastFloorZoom=y,!0):(this.lastFloorZoom>y?(this.lastIntegerZoom=y+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<y&&(this.lastIntegerZoom=y,this.lastIntegerZoomTime=d),f!==this.lastZoom&&(this.lastZoom=f,this.lastFloorZoom=y,!0))};var Ti={"Latin-1 Supplement":function(f){return f>=128&&f<=255},Arabic:function(f){return f>=1536&&f<=1791},"Arabic Supplement":function(f){return f>=1872&&f<=1919},"Arabic Extended-A":function(f){return f>=2208&&f<=2303},"Hangul Jamo":function(f){return f>=4352&&f<=4607},"Unified Canadian Aboriginal Syllabics":function(f){return f>=5120&&f<=5759},Khmer:function(f){return f>=6016&&f<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(f){return f>=6320&&f<=6399},"General Punctuation":function(f){return f>=8192&&f<=8303},"Letterlike Symbols":function(f){return f>=8448&&f<=8527},"Number Forms":function(f){return f>=8528&&f<=8591},"Miscellaneous Technical":function(f){return f>=8960&&f<=9215},"Control Pictures":function(f){return f>=9216&&f<=9279},"Optical Character Recognition":function(f){return f>=9280&&f<=9311},"Enclosed Alphanumerics":function(f){return f>=9312&&f<=9471},"Geometric Shapes":function(f){return f>=9632&&f<=9727},"Miscellaneous Symbols":function(f){return f>=9728&&f<=9983},"Miscellaneous Symbols and Arrows":function(f){return f>=11008&&f<=11263},"CJK Radicals Supplement":function(f){return f>=11904&&f<=12031},"Kangxi Radicals":function(f){return f>=12032&&f<=12255},"Ideographic Description Characters":function(f){return f>=12272&&f<=12287},"CJK Symbols and Punctuation":function(f){return f>=12288&&f<=12351},Hiragana:function(f){return f>=12352&&f<=12447},Katakana:function(f){return f>=12448&&f<=12543},Bopomofo:function(f){return f>=12544&&f<=12591},"Hangul Compatibility Jamo":function(f){return f>=12592&&f<=12687},Kanbun:function(f){return f>=12688&&f<=12703},"Bopomofo Extended":function(f){return f>=12704&&f<=12735},"CJK Strokes":function(f){return f>=12736&&f<=12783},"Katakana Phonetic Extensions":function(f){return f>=12784&&f<=12799},"Enclosed CJK Letters and Months":function(f){return f>=12800&&f<=13055},"CJK Compatibility":function(f){return f>=13056&&f<=13311},"CJK Unified Ideographs Extension A":function(f){return f>=13312&&f<=19903},"Yijing Hexagram Symbols":function(f){return f>=19904&&f<=19967},"CJK Unified Ideographs":function(f){return f>=19968&&f<=40959},"Yi Syllables":function(f){return f>=40960&&f<=42127},"Yi Radicals":function(f){return f>=42128&&f<=42191},"Hangul Jamo Extended-A":function(f){return f>=43360&&f<=43391},"Hangul Syllables":function(f){return f>=44032&&f<=55215},"Hangul Jamo Extended-B":function(f){return f>=55216&&f<=55295},"Private Use Area":function(f){return f>=57344&&f<=63743},"CJK Compatibility Ideographs":function(f){return f>=63744&&f<=64255},"Arabic Presentation Forms-A":function(f){return f>=64336&&f<=65023},"Vertical Forms":function(f){return f>=65040&&f<=65055},"CJK Compatibility Forms":function(f){return f>=65072&&f<=65103},"Small Form Variants":function(f){return f>=65104&&f<=65135},"Arabic Presentation Forms-B":function(f){return f>=65136&&f<=65279},"Halfwidth and Fullwidth Forms":function(f){return f>=65280&&f<=65519}};function Xf(f){for(var d=0,y=f;d<y.length;d+=1)if(gh(y[d].charCodeAt(0)))return!0;return!1}function gh(f){return!(f!==746&&f!==747&&(f<4352||!(Ti["Bopomofo Extended"](f)||Ti.Bopomofo(f)||Ti["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Ti["CJK Compatibility Ideographs"](f)||Ti["CJK Compatibility"](f)||Ti["CJK Radicals Supplement"](f)||Ti["CJK Strokes"](f)||!(!Ti["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Ti["CJK Unified Ideographs Extension A"](f)||Ti["CJK Unified Ideographs"](f)||Ti["Enclosed CJK Letters and Months"](f)||Ti["Hangul Compatibility Jamo"](f)||Ti["Hangul Jamo Extended-A"](f)||Ti["Hangul Jamo Extended-B"](f)||Ti["Hangul Jamo"](f)||Ti["Hangul Syllables"](f)||Ti.Hiragana(f)||Ti["Ideographic Description Characters"](f)||Ti.Kanbun(f)||Ti["Kangxi Radicals"](f)||Ti["Katakana Phonetic Extensions"](f)||Ti.Katakana(f)&&f!==12540||!(!Ti["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Ti["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Ti["Unified Canadian Aboriginal Syllabics"](f)||Ti["Unified Canadian Aboriginal Syllabics Extended"](f)||Ti["Vertical Forms"](f)||Ti["Yijing Hexagram Symbols"](f)||Ti["Yi Syllables"](f)||Ti["Yi Radicals"](f))))}function rf(f){return!(gh(f)||function(d){return!!(Ti["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Ti["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Ti["Letterlike Symbols"](d)||Ti["Number Forms"](d)||Ti["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Ti["Control Pictures"](d)&&d!==9251||Ti["Optical Character Recognition"](d)||Ti["Enclosed Alphanumerics"](d)||Ti["Geometric Shapes"](d)||Ti["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Ti["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Ti["CJK Symbols and Punctuation"](d)||Ti.Katakana(d)||Ti["Private Use Area"](d)||Ti["CJK Compatibility Forms"](d)||Ti["Small Form Variants"](d)||Ti["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(f))}function es(f){return f>=1424&&f<=2303||Ti["Arabic Presentation Forms-A"](f)||Ti["Arabic Presentation Forms-B"](f)}function wu(f,d){return!(!d&&es(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Ti.Khmer(f))}function xf(f){for(var d=0,y=f;d<y.length;d+=1)if(es(y[d].charCodeAt(0)))return!0;return!1}var wl=null,eu="unavailable",nl=null,Kv=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(eu="error"),wl&&wl(f)};function Vh(){bf.fire(new Ge("pluginStateChange",{pluginStatus:eu,pluginURL:nl}))}var bf=new br,ev=function(){return eu},nc=function(){if(eu!=="deferred"||!nl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");eu="loading",Vh(),nl&&An({url:nl},function(f){f?Kv(f):(eu="loaded",Vh())})},dl={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return eu==="loaded"||dl.applyArabicShaping!=null},isLoading:function(){return eu==="loading"},setState:function(f){eu=f.pluginStatus,nl=f.pluginURL},isParsed:function(){return dl.applyArabicShaping!=null&&dl.processBidirectionalText!=null&&dl.processStyledBidirectionalText!=null},getPluginURL:function(){return nl}},to=function(f,d){this.zoom=f,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new sd,this.transition={})};to.prototype.isSupportedScript=function(f){return function(d,y){for(var T=0,O=d;T<O.length;T+=1)if(!wu(O[T].charCodeAt(0),y))return!1;return!0}(f,dl.isLoaded())},to.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},to.prototype.getCrossfadeParameters=function(){var f=this.zoom,d=f-Math.floor(f),y=this.crossFadingFactor();return f>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*y}:{fromScale:.5,toScale:1,t:1-(1-y)*d}};var mo=function(f,d){this.property=f,this.value=d,this.expression=function(y,T){if(Jl(y))return new Qc(y,T);if(qc(y)){var O=fh(y,T);if(O.result==="error")throw new Error(O.value.map(function(Z){return Z.key+": "+Z.message}).join(", "));return O.value}var N=y;return typeof y=="string"&&T.type==="color"&&(N=Xa.parse(y)),{kind:"constant",evaluate:function(){return N}}}(d===void 0?f.specification.default:d,f.specification)};mo.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},mo.prototype.possiblyEvaluate=function(f,d,y){return this.property.possiblyEvaluate(this,f,d,y)};var ic=function(f){this.property=f,this.value=new mo(f,void 0)};ic.prototype.transitioned=function(f,d){return new Yf(this.property,this.value,d,b({},f.transition,this.transition),f.now)},ic.prototype.untransitioned=function(){return new Yf(this.property,this.value,null,{},0)};var Xs=function(f){this._properties=f,this._values=Object.create(f.defaultTransitionablePropertyValues)};Xs.prototype.getValue=function(f){return _e(this._values[f].value.value)},Xs.prototype.setValue=function(f,d){this._values.hasOwnProperty(f)||(this._values[f]=new ic(this._values[f].property)),this._values[f].value=new mo(this._values[f].property,d===null?void 0:_e(d))},Xs.prototype.getTransition=function(f){return _e(this._values[f].transition)},Xs.prototype.setTransition=function(f,d){this._values.hasOwnProperty(f)||(this._values[f]=new ic(this._values[f].property)),this._values[f].transition=_e(d)||void 0},Xs.prototype.serialize=function(){for(var f={},d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d],O=this.getValue(T);O!==void 0&&(f[T]=O);var N=this.getTransition(T);N!==void 0&&(f[T+"-transition"]=N)}return f},Xs.prototype.transitioned=function(f,d){for(var y=new nf(this._properties),T=0,O=Object.keys(this._values);T<O.length;T+=1){var N=O[T];y._values[N]=this._values[N].transitioned(f,d._values[N])}return y},Xs.prototype.untransitioned=function(){for(var f=new nf(this._properties),d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d];f._values[T]=this._values[T].untransitioned()}return f};var Yf=function(f,d,y,T,O){this.property=f,this.value=d,this.begin=O+T.delay||0,this.end=this.begin+T.duration||0,f.specification.transition&&(T.delay||T.duration)&&(this.prior=y)};Yf.prototype.possiblyEvaluate=function(f,d,y){var T=f.now||0,O=this.value.possiblyEvaluate(f,d,y),N=this.prior;if(N){if(T>this.end)return this.prior=null,O;if(this.value.isDataDriven())return this.prior=null,O;if(T<this.begin)return N.possiblyEvaluate(f,d,y);var Z=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(N.possiblyEvaluate(f,d,y),O,function(q){if(q<=0)return 0;if(q>=1)return 1;var dt=q*q,Lt=dt*q;return 4*(q<.5?Lt:3*(q-dt)+Lt-.75)}(Z))}return O};var nf=function(f){this._properties=f,this._values=Object.create(f.defaultTransitioningPropertyValues)};nf.prototype.possiblyEvaluate=function(f,d,y){for(var T=new Sl(this._properties),O=0,N=Object.keys(this._values);O<N.length;O+=1){var Z=N[O];T._values[Z]=this._values[Z].possiblyEvaluate(f,d,y)}return T},nf.prototype.hasTransition=function(){for(var f=0,d=Object.keys(this._values);f<d.length;f+=1)if(this._values[d[f]].prior)return!0;return!1};var Su=function(f){this._properties=f,this._values=Object.create(f.defaultPropertyValues)};Su.prototype.getValue=function(f){return _e(this._values[f].value)},Su.prototype.setValue=function(f,d){this._values[f]=new mo(this._values[f].property,d===null?void 0:_e(d))},Su.prototype.serialize=function(){for(var f={},d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d],O=this.getValue(T);O!==void 0&&(f[T]=O)}return f},Su.prototype.possiblyEvaluate=function(f,d,y){for(var T=new Sl(this._properties),O=0,N=Object.keys(this._values);O<N.length;O+=1){var Z=N[O];T._values[Z]=this._values[Z].possiblyEvaluate(f,d,y)}return T};var fu=function(f,d,y){this.property=f,this.value=d,this.parameters=y};fu.prototype.isConstant=function(){return this.value.kind==="constant"},fu.prototype.constantOr=function(f){return this.value.kind==="constant"?this.value.value:f},fu.prototype.evaluate=function(f,d,y,T){return this.property.evaluate(this.value,this.parameters,f,d,y,T)};var Sl=function(f){this._properties=f,this._values=Object.create(f.defaultPossiblyEvaluatedValues)};Sl.prototype.get=function(f){return this._values[f]};var Qi=function(f){this.specification=f};Qi.prototype.possiblyEvaluate=function(f,d){return f.expression.evaluate(d)},Qi.prototype.interpolate=function(f,d,y){var T=Ts[this.specification.type];return T?T(f,d,y):f};var ki=function(f,d){this.specification=f,this.overrides=d};ki.prototype.possiblyEvaluate=function(f,d,y,T){return new fu(this,f.expression.kind==="constant"||f.expression.kind==="camera"?{kind:"constant",value:f.expression.evaluate(d,null,{},y,T)}:f.expression,d)},ki.prototype.interpolate=function(f,d,y){if(f.value.kind!=="constant"||d.value.kind!=="constant")return f;if(f.value.value===void 0||d.value.value===void 0)return new fu(this,{kind:"constant",value:void 0},f.parameters);var T=Ts[this.specification.type];return T?new fu(this,{kind:"constant",value:T(f.value.value,d.value.value,y)},f.parameters):f},ki.prototype.evaluate=function(f,d,y,T,O,N){return f.kind==="constant"?f.value:f.evaluate(d,y,T,O,N)};var Ef=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(y,T,O,N){if(y.value===void 0)return new fu(this,{kind:"constant",value:void 0},T);if(y.expression.kind==="constant"){var Z=y.expression.evaluate(T,null,{},O,N),q=y.property.specification.type==="resolvedImage"&&typeof Z!="string"?Z.name:Z,dt=this._calculate(q,q,q,T);return new fu(this,{kind:"constant",value:dt},T)}if(y.expression.kind==="camera"){var Lt=this._calculate(y.expression.evaluate({zoom:T.zoom-1}),y.expression.evaluate({zoom:T.zoom}),y.expression.evaluate({zoom:T.zoom+1}),T);return new fu(this,{kind:"constant",value:Lt},T)}return new fu(this,y.expression,T)},d.prototype.evaluate=function(y,T,O,N,Z,q){if(y.kind==="source"){var dt=y.evaluate(T,O,N,Z,q);return this._calculate(dt,dt,dt,T)}return y.kind==="composite"?this._calculate(y.evaluate({zoom:Math.floor(T.zoom)-1},O,N),y.evaluate({zoom:Math.floor(T.zoom)},O,N),y.evaluate({zoom:Math.floor(T.zoom)+1},O,N),T):y.value},d.prototype._calculate=function(y,T,O,N){return N.zoom>N.zoomHistory.lastIntegerZoom?{from:y,to:T}:{from:O,to:T}},d.prototype.interpolate=function(y){return y},d}(ki),Ju=function(f){this.specification=f};Ju.prototype.possiblyEvaluate=function(f,d,y,T){if(f.value!==void 0){if(f.expression.kind==="constant"){var O=f.expression.evaluate(d,null,{},y,T);return this._calculate(O,O,O,d)}return this._calculate(f.expression.evaluate(new to(Math.floor(d.zoom-1),d)),f.expression.evaluate(new to(Math.floor(d.zoom),d)),f.expression.evaluate(new to(Math.floor(d.zoom+1),d)),d)}},Ju.prototype._calculate=function(f,d,y,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:f,to:d}:{from:y,to:d}},Ju.prototype.interpolate=function(f){return f};var Cu=function(f){this.specification=f};Cu.prototype.possiblyEvaluate=function(f,d,y,T){return!!f.expression.evaluate(d,null,{},y,T)},Cu.prototype.interpolate=function(){return!1};var Vu=function(f){for(var d in this.properties=f,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],f){var y=f[d];y.specification.overridable&&this.overridableProperties.push(d);var T=this.defaultPropertyValues[d]=new mo(y,void 0),O=this.defaultTransitionablePropertyValues[d]=new ic(y);this.defaultTransitioningPropertyValues[d]=O.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=T.possiblyEvaluate({})}};ji("DataDrivenProperty",ki),ji("DataConstantProperty",Qi),ji("CrossFadedDataDrivenProperty",Ef),ji("CrossFadedProperty",Ju),ji("ColorRampProperty",Cu);var gc=function(f){function d(y,T){if(f.call(this),this.id=y.id,this.type=y.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},y.type!=="custom"&&(this.metadata=(y=y).metadata,this.minzoom=y.minzoom,this.maxzoom=y.maxzoom,y.type!=="background"&&(this.source=y.source,this.sourceLayer=y["source-layer"],this.filter=y.filter),T.layout&&(this._unevaluatedLayout=new Su(T.layout)),T.paint)){for(var O in this._transitionablePaint=new Xs(T.paint),y.paint)this.setPaintProperty(O,y.paint[O],{validate:!1});for(var N in y.layout)this.setLayoutProperty(N,y.layout[N],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Sl(T.paint)}}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(y){return y==="visibility"?this.visibility:this._unevaluatedLayout.getValue(y)},d.prototype.setLayoutProperty=function(y,T,O){O===void 0&&(O={}),T!=null&&this._validate(Wf,"layers."+this.id+".layout."+y,y,T,O)||(y!=="visibility"?this._unevaluatedLayout.setValue(y,T):this.visibility=T)},d.prototype.getPaintProperty=function(y){return rt(y,"-transition")?this._transitionablePaint.getTransition(y.slice(0,-11)):this._transitionablePaint.getValue(y)},d.prototype.setPaintProperty=function(y,T,O){if(O===void 0&&(O={}),T!=null&&this._validate(Ia,"layers."+this.id+".paint."+y,y,T,O))return!1;if(rt(y,"-transition"))return this._transitionablePaint.setTransition(y.slice(0,-11),T||void 0),!1;var N=this._transitionablePaint._values[y],Z=N.property.specification["property-type"]==="cross-faded-data-driven",q=N.value.isDataDriven(),dt=N.value;this._transitionablePaint.setValue(y,T),this._handleSpecialPaintPropertyUpdate(y);var Lt=this._transitionablePaint._values[y].value;return Lt.isDataDriven()||q||Z||this._handleOverridablePaintPropertyUpdate(y,dt,Lt)},d.prototype._handleSpecialPaintPropertyUpdate=function(y){},d.prototype._handleOverridablePaintPropertyUpdate=function(y,T,O){return!1},d.prototype.isHidden=function(y){return!!(this.minzoom&&y<this.minzoom)||!!(this.maxzoom&&y>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(y){this._transitioningPaint=this._transitionablePaint.transitioned(y,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(y,T){y.getCrossfadeParameters&&(this._crossfadeParameters=y.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(y,void 0,T)),this.paint=this._transitioningPaint.possiblyEvaluate(y,void 0,T)},d.prototype.serialize=function(){var y={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(y.layout=y.layout||{},y.layout.visibility=this.visibility),Se(y,function(T,O){return!(T===void 0||O==="layout"&&!Object.keys(T).length||O==="paint"&&!Object.keys(T).length)})},d.prototype._validate=function(y,T,O,N,Z){return Z===void 0&&(Z={}),(!Z||Z.validate!==!1)&&ef(this,y.call(Tp,{key:T,layerType:this.type,objectKey:O,value:N,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var y in this.paint._values){var T=this.paint.get(y);if(T instanceof fu&&Wa(T.property.specification)&&(T.value.kind==="source"||T.value.kind==="composite")&&T.value.isStateDependent)return!0}return!1},d}(br),ud={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},zl=function(f,d){this._structArray=f,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Do=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function rs(f,d){d===void 0&&(d=1);var y=0,T=0;return{members:f.map(function(O){var N=ud[O.type].BYTES_PER_ELEMENT,Z=y=ld(y,Math.max(d,N)),q=O.components||1;return T=Math.max(T,N),y+=N*q,{name:O.name,type:O.type,components:q,offset:Z}}),size:ld(y,Math.max(T,d)),alignment:d}}function ld(f,d){return Math.ceil(f/d)*d}Do.serialize=function(f,d){return f._trim(),d&&(f.isTransferred=!0,d.push(f.arrayBuffer)),{length:f.length,arrayBuffer:f.arrayBuffer}},Do.deserialize=function(f){var d=Object.create(this.prototype);return d.arrayBuffer=f.arrayBuffer,d.length=f.length,d.capacity=f.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},Do.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Do.prototype.clear=function(){this.length=0},Do.prototype.resize=function(f){this.reserve(f),this.length=f},Do.prototype.reserve=function(f){if(f>this.capacity){this.capacity=Math.max(f,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},Do.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var $f=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.int16[N+0]=T,this.int16[N+1]=O,y},d}(Do);$f.prototype.bytesPerElement=4,ji("StructArrayLayout2i4",$f);var Cl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var q=4*y;return this.int16[q+0]=T,this.int16[q+1]=O,this.int16[q+2]=N,this.int16[q+3]=Z,y},d}(Do);Cl.prototype.bytesPerElement=8,ji("StructArrayLayout4i8",Cl);var il=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q){var dt=this.length;return this.resize(dt+1),this.emplace(dt,y,T,O,N,Z,q)},d.prototype.emplace=function(y,T,O,N,Z,q,dt){var Lt=6*y;return this.int16[Lt+0]=T,this.int16[Lt+1]=O,this.int16[Lt+2]=N,this.int16[Lt+3]=Z,this.int16[Lt+4]=q,this.int16[Lt+5]=dt,y},d}(Do);il.prototype.bytesPerElement=12,ji("StructArrayLayout2i4i12",il);var va=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q){var dt=this.length;return this.resize(dt+1),this.emplace(dt,y,T,O,N,Z,q)},d.prototype.emplace=function(y,T,O,N,Z,q,dt){var Lt=4*y,Gt=8*y;return this.int16[Lt+0]=T,this.int16[Lt+1]=O,this.uint8[Gt+4]=N,this.uint8[Gt+5]=Z,this.uint8[Gt+6]=q,this.uint8[Gt+7]=dt,y},d}(Do);va.prototype.bytesPerElement=8,ji("StructArrayLayout2i4ub8",va);var Ul=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.float32[N+0]=T,this.float32[N+1]=O,y},d}(Do);Ul.prototype.bytesPerElement=8,ji("StructArrayLayout2f8",Ul);var vl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt){var me=this.length;return this.resize(me+1),this.emplace(me,y,T,O,N,Z,q,dt,Lt,Gt,Qt)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me){var Fe=10*y;return this.uint16[Fe+0]=T,this.uint16[Fe+1]=O,this.uint16[Fe+2]=N,this.uint16[Fe+3]=Z,this.uint16[Fe+4]=q,this.uint16[Fe+5]=dt,this.uint16[Fe+6]=Lt,this.uint16[Fe+7]=Gt,this.uint16[Fe+8]=Qt,this.uint16[Fe+9]=me,y},d}(Do);vl.prototype.bytesPerElement=20,ji("StructArrayLayout10ui20",vl);var wf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe){var nr=this.length;return this.resize(nr+1),this.emplace(nr,y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr){var ur=12*y;return this.int16[ur+0]=T,this.int16[ur+1]=O,this.int16[ur+2]=N,this.int16[ur+3]=Z,this.uint16[ur+4]=q,this.uint16[ur+5]=dt,this.uint16[ur+6]=Lt,this.uint16[ur+7]=Gt,this.int16[ur+8]=Qt,this.int16[ur+9]=me,this.int16[ur+10]=Fe,this.int16[ur+11]=nr,y},d}(Do);wf.prototype.bytesPerElement=24,ji("StructArrayLayout4i4ui4i24",wf);var ac=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.float32[Z+0]=T,this.float32[Z+1]=O,this.float32[Z+2]=N,y},d}(Do);ac.prototype.bytesPerElement=12,ji("StructArrayLayout3f12",ac);var Lc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.uint32[1*y+0]=T,y},d}(Do);Lc.prototype.bytesPerElement=4,ji("StructArrayLayout1ul4",Lc);var Zl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Lt,Gt){var Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,y,T,O,N,Z,q,dt,Lt,Gt)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt){var me=10*y,Fe=5*y;return this.int16[me+0]=T,this.int16[me+1]=O,this.int16[me+2]=N,this.int16[me+3]=Z,this.int16[me+4]=q,this.int16[me+5]=dt,this.uint32[Fe+3]=Lt,this.uint16[me+8]=Gt,this.uint16[me+9]=Qt,y},d}(Do);Zl.prototype.bytesPerElement=20,ji("StructArrayLayout6i1ul2ui20",Zl);var mh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q){var dt=this.length;return this.resize(dt+1),this.emplace(dt,y,T,O,N,Z,q)},d.prototype.emplace=function(y,T,O,N,Z,q,dt){var Lt=6*y;return this.int16[Lt+0]=T,this.int16[Lt+1]=O,this.int16[Lt+2]=N,this.int16[Lt+3]=Z,this.int16[Lt+4]=q,this.int16[Lt+5]=dt,y},d}(Do);mh.prototype.bytesPerElement=12,ji("StructArrayLayout2i2i2i12",mh);var qf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z){var q=this.length;return this.resize(q+1),this.emplace(q,y,T,O,N,Z)},d.prototype.emplace=function(y,T,O,N,Z,q){var dt=4*y,Lt=8*y;return this.float32[dt+0]=T,this.float32[dt+1]=O,this.float32[dt+2]=N,this.int16[Lt+6]=Z,this.int16[Lt+7]=q,y},d}(Do);qf.prototype.bytesPerElement=16,ji("StructArrayLayout2f1f2i16",qf);var cd=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var q=12*y,dt=3*y;return this.uint8[q+0]=T,this.uint8[q+1]=O,this.float32[dt+1]=N,this.float32[dt+2]=Z,y},d}(Do);cd.prototype.bytesPerElement=12,ji("StructArrayLayout2ub2f12",cd);var Sf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.uint16[Z+0]=T,this.uint16[Z+1]=O,this.uint16[Z+2]=N,y},d}(Do);Sf.prototype.bytesPerElement=6,ji("StructArrayLayout3ui6",Sf);var Cf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur,Sr,gr,Ur){var tn=this.length;return this.resize(tn+1),this.emplace(tn,y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur,Sr,gr,Ur)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur,Sr,gr,Ur,tn){var un=24*y,yn=12*y,Fn=48*y;return this.int16[un+0]=T,this.int16[un+1]=O,this.uint16[un+2]=N,this.uint16[un+3]=Z,this.uint32[yn+2]=q,this.uint32[yn+3]=dt,this.uint32[yn+4]=Lt,this.uint16[un+10]=Gt,this.uint16[un+11]=Qt,this.uint16[un+12]=me,this.float32[yn+7]=Fe,this.float32[yn+8]=nr,this.uint8[Fn+36]=ur,this.uint8[Fn+37]=Sr,this.uint8[Fn+38]=gr,this.uint32[yn+10]=Ur,this.int16[un+22]=tn,y},d}(Do);Cf.prototype.bytesPerElement=48,ji("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Cf);var Mp=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur,Sr,gr,Ur,tn,un,yn,Fn,ii,Si,sa,Zi,pa,Rn,Fi){var aa=this.length;return this.resize(aa+1),this.emplace(aa,y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur,Sr,gr,Ur,tn,un,yn,Fn,ii,Si,sa,Zi,pa,Rn,Fi)},d.prototype.emplace=function(y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur,Sr,gr,Ur,tn,un,yn,Fn,ii,Si,sa,Zi,pa,Rn,Fi,aa){var Ji=34*y,ho=17*y;return this.int16[Ji+0]=T,this.int16[Ji+1]=O,this.int16[Ji+2]=N,this.int16[Ji+3]=Z,this.int16[Ji+4]=q,this.int16[Ji+5]=dt,this.int16[Ji+6]=Lt,this.int16[Ji+7]=Gt,this.uint16[Ji+8]=Qt,this.uint16[Ji+9]=me,this.uint16[Ji+10]=Fe,this.uint16[Ji+11]=nr,this.uint16[Ji+12]=ur,this.uint16[Ji+13]=Sr,this.uint16[Ji+14]=gr,this.uint16[Ji+15]=Ur,this.uint16[Ji+16]=tn,this.uint16[Ji+17]=un,this.uint16[Ji+18]=yn,this.uint16[Ji+19]=Fn,this.uint16[Ji+20]=ii,this.uint16[Ji+21]=Si,this.uint16[Ji+22]=sa,this.uint32[ho+12]=Zi,this.float32[ho+13]=pa,this.float32[ho+14]=Rn,this.float32[ho+15]=Fi,this.float32[ho+16]=aa,y},d}(Do);Mp.prototype.bytesPerElement=68,ji("StructArrayLayout8i15ui1ul4f68",Mp);var Af=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.float32[1*y+0]=T,y},d}(Do);Af.prototype.bytesPerElement=4,ji("StructArrayLayout1f4",Af);var Al=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.int16[Z+0]=T,this.int16[Z+1]=O,this.int16[Z+2]=N,y},d}(Do);Al.prototype.bytesPerElement=6,ji("StructArrayLayout3i6",Al);var Gh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=4*y;return this.uint32[2*y+0]=T,this.uint16[Z+2]=O,this.uint16[Z+3]=N,y},d}(Do);Gh.prototype.bytesPerElement=8,ji("StructArrayLayout1ul2ui8",Gh);var Hh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.uint16[N+0]=T,this.uint16[N+1]=O,y},d}(Do);Hh.prototype.bytesPerElement=4,ji("StructArrayLayout2ui4",Hh);var Ip=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.uint16[1*y+0]=T,y},d}(Do);Ip.prototype.bytesPerElement=2,ji("StructArrayLayout1ui2",Ip);var oc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var q=4*y;return this.float32[q+0]=T,this.float32[q+1]=O,this.float32[q+2]=N,this.float32[q+3]=Z,y},d}(Do);oc.prototype.bytesPerElement=16,ji("StructArrayLayout4f16",oc);var x=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return y.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},y.x1.get=function(){return this._structArray.int16[this._pos2+2]},y.y1.get=function(){return this._structArray.int16[this._pos2+3]},y.x2.get=function(){return this._structArray.int16[this._pos2+4]},y.y2.get=function(){return this._structArray.int16[this._pos2+5]},y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},y.anchorPoint.get=function(){return new J(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,y),d}(zl);x.prototype.size=20;var C=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new x(this,y)},d}(Zl);ji("CollisionBoxArray",C);var E=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},y.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},y.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},y.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},y.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},y.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},y.segment.get=function(){return this._structArray.uint16[this._pos2+10]},y.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},y.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},y.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},y.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},y.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},y.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},y.placedOrientation.set=function(T){this._structArray.uint8[this._pos1+37]=T},y.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},y.hidden.set=function(T){this._structArray.uint8[this._pos1+38]=T},y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},y.crossTileID.set=function(T){this._structArray.uint32[this._pos4+10]=T},y.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,y),d}(zl);E.prototype.size=48;var M=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new E(this,y)},d}(Cf);ji("PlacedSymbolArray",M);var U=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},y.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},y.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},y.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},y.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},y.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},y.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},y.key.get=function(){return this._structArray.uint16[this._pos2+8]},y.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},y.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},y.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},y.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},y.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},y.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},y.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},y.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},y.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},y.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},y.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},y.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},y.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},y.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},y.crossTileID.set=function(T){this._structArray.uint32[this._pos4+12]=T},y.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},y.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},y.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},y.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,y),d}(zl);U.prototype.size=68;var H=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new U(this,y)},d}(Mp);ji("SymbolInstanceArray",H);var $=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getoffsetX=function(y){return this.float32[1*y+0]},d}(Af);ji("GlyphOffsetArray",$);var ht=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getx=function(y){return this.int16[3*y+0]},d.prototype.gety=function(y){return this.int16[3*y+1]},d.prototype.gettileUnitDistanceFromAnchor=function(y){return this.int16[3*y+2]},d}(Al);ji("SymbolLineVertexArray",ht);var Ut=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,y),d}(zl);Ut.prototype.size=8;var ie=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new Ut(this,y)},d}(Gh);ji("FeatureIndexArray",ie);var Be=rs([{name:"a_pos",components:2,type:"Int16"}],4).members,De=function(f){f===void 0&&(f=[]),this.segments=f};function Ne(f,d){return 256*(f=zt(Math.floor(f),0,255))+zt(Math.floor(d),0,255)}De.prototype.prepareSegment=function(f,d,y,T){var O=this.segments[this.segments.length-1];return f>De.MAX_VERTEX_ARRAY_LENGTH&&ne("Max vertices per segment is "+De.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+f),(!O||O.vertexLength+f>De.MAX_VERTEX_ARRAY_LENGTH||O.sortKey!==T)&&(O={vertexOffset:d.length,primitiveOffset:y.length,vertexLength:0,primitiveLength:0},T!==void 0&&(O.sortKey=T),this.segments.push(O)),O},De.prototype.get=function(){return this.segments},De.prototype.destroy=function(){for(var f=0,d=this.segments;f<d.length;f+=1){var y=d[f];for(var T in y.vaos)y.vaos[T].destroy()}},De.simpleSegment=function(f,d,y,T){return new De([{vertexOffset:f,primitiveOffset:d,vertexLength:y,primitiveLength:T,vaos:{},sortKey:0}])},De.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ji("SegmentVector",De);var fr=rs([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$e=Et(function(f){f.exports=function(d,y){var T,O,N,Z,q,dt,Lt,Gt;for(O=d.length-(T=3&d.length),N=y,q=3432918353,dt=461845907,Gt=0;Gt<O;)Lt=255&d.charCodeAt(Gt)|(255&d.charCodeAt(++Gt))<<8|(255&d.charCodeAt(++Gt))<<16|(255&d.charCodeAt(++Gt))<<24,++Gt,N=27492+(65535&(Z=5*(65535&(N=(N^=Lt=(65535&(Lt=(Lt=(65535&Lt)*q+(((Lt>>>16)*q&65535)<<16)&4294967295)<<15|Lt>>>17))*dt+(((Lt>>>16)*dt&65535)<<16)&4294967295)<<13|N>>>19))+((5*(N>>>16)&65535)<<16)&4294967295))+((58964+(Z>>>16)&65535)<<16);switch(Lt=0,T){case 3:Lt^=(255&d.charCodeAt(Gt+2))<<16;case 2:Lt^=(255&d.charCodeAt(Gt+1))<<8;case 1:N^=Lt=(65535&(Lt=(Lt=(65535&(Lt^=255&d.charCodeAt(Gt)))*q+(((Lt>>>16)*q&65535)<<16)&4294967295)<<15|Lt>>>17))*dt+(((Lt>>>16)*dt&65535)<<16)&4294967295}return N^=d.length,N=2246822507*(65535&(N^=N>>>16))+((2246822507*(N>>>16)&65535)<<16)&4294967295,N=3266489909*(65535&(N^=N>>>13))+((3266489909*(N>>>16)&65535)<<16)&4294967295,(N^=N>>>16)>>>0}}),_r=Et(function(f){f.exports=function(d,y){for(var T,O=d.length,N=y^O,Z=0;O>=4;)T=1540483477*(65535&(T=255&d.charCodeAt(Z)|(255&d.charCodeAt(++Z))<<8|(255&d.charCodeAt(++Z))<<16|(255&d.charCodeAt(++Z))<<24))+((1540483477*(T>>>16)&65535)<<16),N=1540483477*(65535&N)+((1540483477*(N>>>16)&65535)<<16)^(T=1540483477*(65535&(T^=T>>>24))+((1540483477*(T>>>16)&65535)<<16)),O-=4,++Z;switch(O){case 3:N^=(255&d.charCodeAt(Z+2))<<16;case 2:N^=(255&d.charCodeAt(Z+1))<<8;case 1:N=1540483477*(65535&(N^=255&d.charCodeAt(Z)))+((1540483477*(N>>>16)&65535)<<16)}return N=1540483477*(65535&(N^=N>>>13))+((1540483477*(N>>>16)&65535)<<16),(N^=N>>>15)>>>0}}),er=$e,Er=_r;er.murmur3=$e,er.murmur2=Er;var Or=function(){this.ids=[],this.positions=[],this.indexed=!1};Or.prototype.add=function(f,d,y,T){this.ids.push(gn(f)),this.positions.push(d,y,T)},Or.prototype.getPositions=function(f){for(var d=gn(f),y=0,T=this.ids.length-1;y<T;){var O=y+T>>1;this.ids[O]>=d?T=O:y=O+1}for(var N=[];this.ids[y]===d;)N.push({index:this.positions[3*y],start:this.positions[3*y+1],end:this.positions[3*y+2]}),y++;return N},Or.serialize=function(f,d){var y=new Float64Array(f.ids),T=new Uint32Array(f.positions);return function O(N,Z,q,dt){for(;q<dt;){for(var Lt=N[q+dt>>1],Gt=q-1,Qt=dt+1;;){do Gt++;while(N[Gt]<Lt);do Qt--;while(N[Qt]>Lt);if(Gt>=Qt)break;vn(N,Gt,Qt),vn(Z,3*Gt,3*Qt),vn(Z,3*Gt+1,3*Qt+1),vn(Z,3*Gt+2,3*Qt+2)}Qt-q<dt-Qt?(O(N,Z,q,Qt),q=Qt+1):(O(N,Z,Qt+1,dt),dt=Qt)}}(y,T,0,y.length-1),d&&d.push(y.buffer,T.buffer),{ids:y,positions:T}},Or.deserialize=function(f){var d=new Or;return d.ids=f.ids,d.positions=f.positions,d.indexed=!0,d};var Yr=Math.pow(2,53)-1;function gn(f){var d=+f;return!isNaN(d)&&d<=Yr?d:er(String(f))}function vn(f,d,y){var T=f[d];f[d]=f[y],f[y]=T}ji("FeaturePositionMap",Or);var _n=function(f,d){this.gl=f.gl,this.location=d},Un=function(f){function d(y,T){f.call(this,y,T),this.current=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){this.current!==y&&(this.current=y,this.gl.uniform1i(this.location,y))},d}(_n),ui=function(f){function d(y,T){f.call(this,y,T),this.current=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){this.current!==y&&(this.current=y,this.gl.uniform1f(this.location,y))},d}(_n),oi=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]||(this.current=y,this.gl.uniform2f(this.location,y[0],y[1]))},d}(_n),Ri=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]||(this.current=y,this.gl.uniform3f(this.location,y[0],y[1],y[2]))},d}(_n),Di=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0,0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]&&y[3]===this.current[3]||(this.current=y,this.gl.uniform4f(this.location,y[0],y[1],y[2],y[3]))},d}(_n),ia=function(f){function d(y,T){f.call(this,y,T),this.current=Xa.transparent}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y.r===this.current.r&&y.g===this.current.g&&y.b===this.current.b&&y.a===this.current.a||(this.current=y,this.gl.uniform4f(this.location,y.r,y.g,y.b,y.a))},d}(_n),na=new Float32Array(16),co=function(f){function d(y,T){f.call(this,y,T),this.current=na}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){if(y[12]!==this.current[12]||y[0]!==this.current[0])return this.current=y,void this.gl.uniformMatrix4fv(this.location,!1,y);for(var T=1;T<16;T++)if(y[T]!==this.current[T]){this.current=y,this.gl.uniformMatrix4fv(this.location,!1,y);break}},d}(_n);function Bi(f){return[Ne(255*f.r,255*f.g),Ne(255*f.b,255*f.a)]}var Pa=function(f,d,y){this.value=f,this.uniformNames=d.map(function(T){return"u_"+T}),this.type=y};Pa.prototype.setUniform=function(f,d,y){f.set(y.constantOr(this.value))},Pa.prototype.getBinding=function(f,d,y){return this.type==="color"?new ia(f,d):new ui(f,d)};var Ra=function(f,d){this.uniformNames=d.map(function(y){return"u_"+y}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ra.prototype.setConstantPatternPositions=function(f,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=f.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=f.tlbr},Ra.prototype.setUniform=function(f,d,y,T){var O=T==="u_pattern_to"?this.patternTo:T==="u_pattern_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;O&&f.set(O)},Ra.prototype.getBinding=function(f,d,y){return y.substr(0,9)==="u_pattern"?new Di(f,d):new ui(f,d)};var Aa=function(f,d,y,T){this.expression=f,this.type=y,this.maxValue=0,this.paintVertexAttributes=d.map(function(O){return{name:"a_"+O,type:"Float32",components:y==="color"?2:1,offset:0}}),this.paintVertexArray=new T};Aa.prototype.populatePaintArray=function(f,d,y,T,O){var N=this.paintVertexArray.length,Z=this.expression.evaluate(new to(0),d,{},T,[],O);this.paintVertexArray.resize(f),this._setPaintValue(N,f,Z)},Aa.prototype.updatePaintArray=function(f,d,y,T){var O=this.expression.evaluate({zoom:0},y,T);this._setPaintValue(f,d,O)},Aa.prototype._setPaintValue=function(f,d,y){if(this.type==="color")for(var T=Bi(y),O=f;O<d;O++)this.paintVertexArray.emplace(O,T[0],T[1]);else{for(var N=f;N<d;N++)this.paintVertexArray.emplace(N,y);this.maxValue=Math.max(this.maxValue,Math.abs(y))}},Aa.prototype.upload=function(f){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=f.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Aa.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var ya=function(f,d,y,T,O,N){this.expression=f,this.uniformNames=d.map(function(Z){return"u_"+Z+"_t"}),this.type=y,this.useIntegerZoom=T,this.zoom=O,this.maxValue=0,this.paintVertexAttributes=d.map(function(Z){return{name:"a_"+Z,type:"Float32",components:y==="color"?4:2,offset:0}}),this.paintVertexArray=new N};ya.prototype.populatePaintArray=function(f,d,y,T,O){var N=this.expression.evaluate(new to(this.zoom),d,{},T,[],O),Z=this.expression.evaluate(new to(this.zoom+1),d,{},T,[],O),q=this.paintVertexArray.length;this.paintVertexArray.resize(f),this._setPaintValue(q,f,N,Z)},ya.prototype.updatePaintArray=function(f,d,y,T){var O=this.expression.evaluate({zoom:this.zoom},y,T),N=this.expression.evaluate({zoom:this.zoom+1},y,T);this._setPaintValue(f,d,O,N)},ya.prototype._setPaintValue=function(f,d,y,T){if(this.type==="color")for(var O=Bi(y),N=Bi(T),Z=f;Z<d;Z++)this.paintVertexArray.emplace(Z,O[0],O[1],N[0],N[1]);else{for(var q=f;q<d;q++)this.paintVertexArray.emplace(q,y,T);this.maxValue=Math.max(this.maxValue,Math.abs(y),Math.abs(T))}},ya.prototype.upload=function(f){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=f.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},ya.prototype.setUniform=function(f,d){var y=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,T=zt(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);f.set(T)},ya.prototype.getBinding=function(f,d,y){return new ui(f,d)};var Ba=function(f,d,y,T,O,N){this.expression=f,this.type=d,this.useIntegerZoom=y,this.zoom=T,this.layerId=N,this.zoomInPaintVertexArray=new O,this.zoomOutPaintVertexArray=new O};Ba.prototype.populatePaintArray=function(f,d,y){var T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(f),this.zoomOutPaintVertexArray.resize(f),this._setPaintValues(T,f,d.patterns&&d.patterns[this.layerId],y)},Ba.prototype.updatePaintArray=function(f,d,y,T,O){this._setPaintValues(f,d,y.patterns&&y.patterns[this.layerId],O)},Ba.prototype._setPaintValues=function(f,d,y,T){if(T&&y){var O=T[y.min],N=T[y.mid],Z=T[y.max];if(O&&N&&Z)for(var q=f;q<d;q++)this.zoomInPaintVertexArray.emplace(q,N.tl[0],N.tl[1],N.br[0],N.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],N.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(q,N.tl[0],N.tl[1],N.br[0],N.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],N.pixelRatio,Z.pixelRatio)}},Ba.prototype.upload=function(f){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=f.createVertexBuffer(this.zoomInPaintVertexArray,fr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=f.createVertexBuffer(this.zoomOutPaintVertexArray,fr.members,this.expression.isStateDependent))},Ba.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ea=function(f,d,y){this.binders={},this._buffers=[];var T=[];for(var O in f.paint._values)if(y(O)){var N=f.paint.get(O);if(N instanceof fu&&Wa(N.property.specification)){var Z=Ys(O,f.type),q=N.value,dt=N.property.specification.type,Lt=N.property.useIntegerZoom,Gt=N.property.specification["property-type"],Qt=Gt==="cross-faded"||Gt==="cross-faded-data-driven";if(q.kind==="constant")this.binders[O]=Qt?new Ra(q.value,Z):new Pa(q.value,Z,dt),T.push("/u_"+O);else if(q.kind==="source"||Qt){var me=xs(O,dt,"source");this.binders[O]=Qt?new Ba(q,dt,Lt,d,me,f.id):new Aa(q,Z,dt,me),T.push("/a_"+O)}else{var Fe=xs(O,dt,"composite");this.binders[O]=new ya(q,Z,dt,Lt,d,Fe),T.push("/z_"+O)}}}this.cacheKey=T.sort().join("")};Ea.prototype.getMaxValue=function(f){var d=this.binders[f];return d instanceof Aa||d instanceof ya?d.maxValue:0},Ea.prototype.populatePaintArrays=function(f,d,y,T,O){for(var N in this.binders){var Z=this.binders[N];(Z instanceof Aa||Z instanceof ya||Z instanceof Ba)&&Z.populatePaintArray(f,d,y,T,O)}},Ea.prototype.setConstantPatternPositions=function(f,d){for(var y in this.binders){var T=this.binders[y];T instanceof Ra&&T.setConstantPatternPositions(f,d)}},Ea.prototype.updatePaintArrays=function(f,d,y,T,O){var N=!1;for(var Z in f)for(var q=0,dt=d.getPositions(Z);q<dt.length;q+=1){var Lt=dt[q],Gt=y.feature(Lt.index);for(var Qt in this.binders){var me=this.binders[Qt];if((me instanceof Aa||me instanceof ya||me instanceof Ba)&&me.expression.isStateDependent===!0){var Fe=T.paint.get(Qt);me.expression=Fe.value,me.updatePaintArray(Lt.start,Lt.end,Gt,f[Z],O),N=!0}}}return N},Ea.prototype.defines=function(){var f=[];for(var d in this.binders){var y=this.binders[d];(y instanceof Pa||y instanceof Ra)&&f.push.apply(f,y.uniformNames.map(function(T){return"#define HAS_UNIFORM_"+T}))}return f},Ea.prototype.getBinderAttributes=function(){var f=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof Aa||y instanceof ya)for(var T=0;T<y.paintVertexAttributes.length;T++)f.push(y.paintVertexAttributes[T].name);else if(y instanceof Ba)for(var O=0;O<fr.members.length;O++)f.push(fr.members[O].name)}return f},Ea.prototype.getBinderUniforms=function(){var f=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof Pa||y instanceof Ra||y instanceof ya)for(var T=0,O=y.uniformNames;T<O.length;T+=1)f.push(O[T])}return f},Ea.prototype.getPaintVertexBuffers=function(){return this._buffers},Ea.prototype.getUniforms=function(f,d){var y=[];for(var T in this.binders){var O=this.binders[T];if(O instanceof Pa||O instanceof Ra||O instanceof ya)for(var N=0,Z=O.uniformNames;N<Z.length;N+=1){var q=Z[N];if(d[q]){var dt=O.getBinding(f,d[q],q);y.push({name:q,property:T,binding:dt})}}}return y},Ea.prototype.setUniforms=function(f,d,y,T){for(var O=0,N=d;O<N.length;O+=1){var Z=N[O],q=Z.name,dt=Z.property;this.binders[dt].setUniform(Z.binding,T,y.get(dt),q)}},Ea.prototype.updatePaintBuffers=function(f){for(var d in this._buffers=[],this.binders){var y=this.binders[d];if(f&&y instanceof Ba){var T=f.fromScale===2?y.zoomInPaintVertexBuffer:y.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(y instanceof Aa||y instanceof ya)&&y.paintVertexBuffer&&this._buffers.push(y.paintVertexBuffer)}},Ea.prototype.upload=function(f){for(var d in this.binders){var y=this.binders[d];(y instanceof Aa||y instanceof ya||y instanceof Ba)&&y.upload(f)}this.updatePaintBuffers()},Ea.prototype.destroy=function(){for(var f in this.binders){var d=this.binders[f];(d instanceof Aa||d instanceof ya||d instanceof Ba)&&d.destroy()}};var ca=function(f,d,y){y===void 0&&(y=function(){return!0}),this.programConfigurations={};for(var T=0,O=f;T<O.length;T+=1){var N=O[T];this.programConfigurations[N.id]=new Ea(N,d,y)}this.needsUpload=!1,this._featureMap=new Or,this._bufferOffset=0};function Ys(f,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(d+"-","").replace(/-/g,"_")]}function xs(f,d,y){var T={color:{source:Ul,composite:oc},number:{source:Af,composite:Ul}},O=function(N){return{"line-pattern":{source:vl,composite:vl},"fill-pattern":{source:vl,composite:vl},"fill-extrusion-pattern":{source:vl,composite:vl}}[N]}(f);return O&&O[y]||T[d][y]}ca.prototype.populatePaintArrays=function(f,d,y,T,O,N){for(var Z in this.programConfigurations)this.programConfigurations[Z].populatePaintArrays(f,d,T,O,N);d.id!==void 0&&this._featureMap.add(d.id,y,this._bufferOffset,f),this._bufferOffset=f,this.needsUpload=!0},ca.prototype.updatePaintArrays=function(f,d,y,T){for(var O=0,N=y;O<N.length;O+=1){var Z=N[O];this.needsUpload=this.programConfigurations[Z.id].updatePaintArrays(f,this._featureMap,d,Z,T)||this.needsUpload}},ca.prototype.get=function(f){return this.programConfigurations[f]},ca.prototype.upload=function(f){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(f);this.needsUpload=!1}},ca.prototype.destroy=function(){for(var f in this.programConfigurations)this.programConfigurations[f].destroy()},ji("ConstantBinder",Pa),ji("CrossFadedConstantBinder",Ra),ji("SourceExpressionBinder",Aa),ji("CrossFadedCompositeBinder",Ba),ji("CompositeExpressionBinder",ya),ji("ProgramConfiguration",Ea,{omit:["_buffers"]}),ji("ProgramConfigurationSet",ca);var ru=Math.pow(2,14)-1,hu=-ru-1;function Ko(f){for(var d=8192/f.extent,y=f.loadGeometry(),T=0;T<y.length;T++)for(var O=y[T],N=0;N<O.length;N++){var Z=O[N],q=Math.round(Z.x*d),dt=Math.round(Z.y*d);Z.x=zt(q,hu,ru),Z.y=zt(dt,hu,ru),(q<Z.x||q>Z.x+1||dt<Z.y||dt>Z.y+1)&&ne("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return y}function bs(f,d){return{type:f.type,id:f.id,properties:f.properties,geometry:d?Ko(f):[]}}function Au(f,d,y,T,O){f.emplaceBack(2*d+(T+1)/2,2*y+(O+1)/2)}var nu=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.layoutVertexArray=new $f,this.indexArray=new Sf,this.segments=new De,this.programConfigurations=new ca(f.layers,f.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function mc(f,d){for(var y=0;y<f.length;y++)if(sc(d,f[y]))return!0;for(var T=0;T<d.length;T++)if(sc(f,d[T]))return!0;return!!Kf(f,d)}function pu(f,d,y){return!!sc(f,d)||!!Ml(d,f,y)}function Vl(f,d){if(f.length===1)return yh(d,f[0]);for(var y=0;y<d.length;y++)for(var T=d[y],O=0;O<T.length;O++)if(sc(f,T[O]))return!0;for(var N=0;N<f.length;N++)if(yh(d,f[N]))return!0;for(var Z=0;Z<d.length;Z++)if(Kf(f,d[Z]))return!0;return!1}function Tl(f,d,y){if(f.length>1){if(Kf(f,d))return!0;for(var T=0;T<d.length;T++)if(Ml(d[T],f,y))return!0}for(var O=0;O<f.length;O++)if(Ml(f[O],d,y))return!0;return!1}function Kf(f,d){if(f.length===0||d.length===0)return!1;for(var y=0;y<f.length-1;y++)for(var T=f[y],O=f[y+1],N=0;N<d.length-1;N++)if(Qf(T,O,d[N],d[N+1]))return!0;return!1}function Qf(f,d,y,T){return xe(f,y,T)!==xe(d,y,T)&&xe(f,d,y)!==xe(f,d,T)}function Ml(f,d,y){var T=y*y;if(d.length===1)return f.distSqr(d[0])<T;for(var O=1;O<d.length;O++)if(Tf(f,d[O-1],d[O])<T)return!0;return!1}function Tf(f,d,y){var T=d.distSqr(y);if(T===0)return f.distSqr(d);var O=((f.x-d.x)*(y.x-d.x)+(f.y-d.y)*(y.y-d.y))/T;return f.distSqr(O<0?d:O>1?y:y.sub(d)._mult(O)._add(d))}function yh(f,d){for(var y,T,O,N=!1,Z=0;Z<f.length;Z++)for(var q=0,dt=(y=f[Z]).length-1;q<y.length;dt=q++)(T=y[q]).y>d.y!=(O=y[dt]).y>d.y&&d.x<(O.x-T.x)*(d.y-T.y)/(O.y-T.y)+T.x&&(N=!N);return N}function sc(f,d){for(var y=!1,T=0,O=f.length-1;T<f.length;O=T++){var N=f[T],Z=f[O];N.y>d.y!=Z.y>d.y&&d.x<(Z.x-N.x)*(d.y-N.y)/(Z.y-N.y)+N.x&&(y=!y)}return y}function Jf(f,d,y){var T=y[0],O=y[2];if(f.x<T.x&&d.x<T.x||f.x>O.x&&d.x>O.x||f.y<T.y&&d.y<T.y||f.y>O.y&&d.y>O.y)return!1;var N=xe(f,d,y[0]);return N!==xe(f,d,y[1])||N!==xe(f,d,y[2])||N!==xe(f,d,y[3])}function Il(f,d,y){var T=d.paint.get(f).value;return T.kind==="constant"?T.value:y.programConfigurations.get(d.id).getMaxValue(f)}function Rs(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function iu(f,d,y,T,O){if(!d[0]&&!d[1])return f;var N=J.convert(d)._mult(O);y==="viewport"&&N._rotate(-T);for(var Z=[],q=0;q<f.length;q++)Z.push(f[q].sub(N));return Z}nu.prototype.populate=function(f,d,y){var T=this.layers[0],O=[],N=null;T.type==="circle"&&(N=T.layout.get("circle-sort-key"));for(var Z=0,q=f;Z<q.length;Z+=1){var dt=q[Z],Lt=dt.feature,Gt=dt.id,Qt=dt.index,me=dt.sourceLayerIndex,Fe=this.layers[0]._featureFilter.needGeometry,nr=bs(Lt,Fe);if(this.layers[0]._featureFilter.filter(new to(this.zoom),nr,y)){var ur=N?N.evaluate(nr,{},y):void 0,Sr={id:Gt,properties:Lt.properties,type:Lt.type,sourceLayerIndex:me,index:Qt,geometry:Fe?nr.geometry:Ko(Lt),patterns:{},sortKey:ur};O.push(Sr)}}N&&O.sort(function(Si,sa){return Si.sortKey-sa.sortKey});for(var gr=0,Ur=O;gr<Ur.length;gr+=1){var tn=Ur[gr],un=tn.geometry,yn=tn.index,Fn=tn.sourceLayerIndex,ii=f[yn].feature;this.addFeature(tn,un,yn,y),d.featureIndex.insert(ii,un,yn,Fn,this.index)}},nu.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},nu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},nu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},nu.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Be),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},nu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},nu.prototype.addFeature=function(f,d,y,T){for(var O=0,N=d;O<N.length;O+=1)for(var Z=0,q=N[O];Z<q.length;Z+=1){var dt=q[Z],Lt=dt.x,Gt=dt.y;if(!(Lt<0||Lt>=8192||Gt<0||Gt>=8192)){var Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,f.sortKey),me=Qt.vertexLength;Au(this.layoutVertexArray,Lt,Gt,-1,-1),Au(this.layoutVertexArray,Lt,Gt,1,-1),Au(this.layoutVertexArray,Lt,Gt,1,1),Au(this.layoutVertexArray,Lt,Gt,-1,1),this.indexArray.emplaceBack(me,me+1,me+2),this.indexArray.emplaceBack(me,me+3,me+2),Qt.vertexLength+=4,Qt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,{},T)},ji("CircleBucket",nu,{omit:["layers"]});var uc=new Vu({"circle-sort-key":new ki(Ce.layout_circle["circle-sort-key"])}),Pc={paint:new Vu({"circle-radius":new ki(Ce.paint_circle["circle-radius"]),"circle-color":new ki(Ce.paint_circle["circle-color"]),"circle-blur":new ki(Ce.paint_circle["circle-blur"]),"circle-opacity":new ki(Ce.paint_circle["circle-opacity"]),"circle-translate":new Qi(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new Qi(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Qi(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Qi(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ki(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ki(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ki(Ce.paint_circle["circle-stroke-opacity"])}),layout:uc},Eo=typeof Float32Array!="undefined"?Float32Array:Array;function Gl(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function al(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3],q=d[4],dt=d[5],Lt=d[6],Gt=d[7],Qt=d[8],me=d[9],Fe=d[10],nr=d[11],ur=d[12],Sr=d[13],gr=d[14],Ur=d[15],tn=y[0],un=y[1],yn=y[2],Fn=y[3];return f[0]=tn*T+un*q+yn*Qt+Fn*ur,f[1]=tn*O+un*dt+yn*me+Fn*Sr,f[2]=tn*N+un*Lt+yn*Fe+Fn*gr,f[3]=tn*Z+un*Gt+yn*nr+Fn*Ur,f[4]=(tn=y[4])*T+(un=y[5])*q+(yn=y[6])*Qt+(Fn=y[7])*ur,f[5]=tn*O+un*dt+yn*me+Fn*Sr,f[6]=tn*N+un*Lt+yn*Fe+Fn*gr,f[7]=tn*Z+un*Gt+yn*nr+Fn*Ur,f[8]=(tn=y[8])*T+(un=y[9])*q+(yn=y[10])*Qt+(Fn=y[11])*ur,f[9]=tn*O+un*dt+yn*me+Fn*Sr,f[10]=tn*N+un*Lt+yn*Fe+Fn*gr,f[11]=tn*Z+un*Gt+yn*nr+Fn*Ur,f[12]=(tn=y[12])*T+(un=y[13])*q+(yn=y[14])*Qt+(Fn=y[15])*ur,f[13]=tn*O+un*dt+yn*me+Fn*Sr,f[14]=tn*N+un*Lt+yn*Fe+Fn*gr,f[15]=tn*Z+un*Gt+yn*nr+Fn*Ur,f}Math.hypot||(Math.hypot=function(){for(var f=arguments,d=0,y=arguments.length;y--;)d+=f[y]*f[y];return Math.sqrt(d)});var Oc,th=al;function kp(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3];return f[0]=y[0]*T+y[4]*O+y[8]*N+y[12]*Z,f[1]=y[1]*T+y[5]*O+y[9]*N+y[13]*Z,f[2]=y[2]*T+y[6]*O+y[10]*N+y[14]*Z,f[3]=y[3]*T+y[7]*O+y[11]*N+y[15]*Z,f}Oc=new Eo(3),Eo!=Float32Array&&(Oc[0]=0,Oc[1]=0,Oc[2]=0),function(){var f=new Eo(4);Eo!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0,f[3]=0)}();var fd=(function(){var f=new Eo(2);Eo!=Float32Array&&(f[0]=0,f[1]=0)}(),function(f){function d(y){f.call(this,y,Pc)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new nu(y)},d.prototype.queryRadius=function(y){var T=y;return Il("circle-radius",this,T)+Il("circle-stroke-width",this,T)+Rs(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt,Lt){for(var Gt=iu(y,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),q.angle,dt),Qt=this.paint.get("circle-radius").evaluate(T,O)+this.paint.get("circle-stroke-width").evaluate(T,O),me=this.paint.get("circle-pitch-alignment")==="map",Fe=me?Gt:function(ii,Si){return ii.map(function(sa){return au(sa,Si)})}(Gt,Lt),nr=me?Qt*dt:Qt,ur=0,Sr=N;ur<Sr.length;ur+=1)for(var gr=0,Ur=Sr[ur];gr<Ur.length;gr+=1){var tn=Ur[gr],un=me?tn:au(tn,Lt),yn=nr,Fn=kp([],[tn.x,tn.y,0,1],Lt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?yn*=Fn[3]/q.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(yn*=q.cameraToCenterDistance/Fn[3]),pu(Fe,un,yn))return!0}return!1},d}(gc));function au(f,d){var y=kp([],[f.x,f.y,0,1],d);return new J(y[0]/y[3],y[1]/y[3])}var kl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(nu);function ol(f,d,y,T){var O=d.width,N=d.height;if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==O*N*y)throw new RangeError("mismatched image size")}else T=new Uint8Array(O*N*y);return f.width=O,f.height=N,f.data=T,f}function yc(f,d,y){var T=d.width,O=d.height;if(T!==f.width||O!==f.height){var N=ol({},{width:T,height:O},y);Mf(f,N,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,T),height:Math.min(f.height,O)},y),f.width=T,f.height=O,f.data=N.data}}function Mf(f,d,y,T,O,N){if(O.width===0||O.height===0)return d;if(O.width>f.width||O.height>f.height||y.x>f.width-O.width||y.y>f.height-O.height)throw new RangeError("out of range source coordinates for image copy");if(O.width>d.width||O.height>d.height||T.x>d.width-O.width||T.y>d.height-O.height)throw new RangeError("out of range destination coordinates for image copy");for(var Z=f.data,q=d.data,dt=0;dt<O.height;dt++)for(var Lt=((y.y+dt)*f.width+y.x)*N,Gt=((T.y+dt)*d.width+T.x)*N,Qt=0;Qt<O.width*N;Qt++)q[Gt+Qt]=Z[Lt+Qt];return d}ji("HeatmapBucket",kl,{omit:["layers"]});var Ll=function(f,d){ol(this,f,1,d)};Ll.prototype.resize=function(f){yc(this,f,1)},Ll.prototype.clone=function(){return new Ll({width:this.width,height:this.height},new Uint8Array(this.data))},Ll.copy=function(f,d,y,T,O){Mf(f,d,y,T,O,1)};var ou=function(f,d){ol(this,f,4,d)};ou.prototype.resize=function(f){yc(this,f,4)},ou.prototype.replace=function(f,d){d?this.data.set(f):this.data=f instanceof Uint8ClampedArray?new Uint8Array(f.buffer):f},ou.prototype.clone=function(){return new ou({width:this.width,height:this.height},new Uint8Array(this.data))},ou.copy=function(f,d,y,T,O){Mf(f,d,y,T,O,4)},ji("AlphaImage",Ll),ji("RGBAImage",ou);var Fc={paint:new Vu({"heatmap-radius":new ki(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ki(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Qi(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Cu(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Qi(Ce.paint_heatmap["heatmap-opacity"])})};function _h(f){var d={},y=f.resolution||256,T=f.clips?f.clips.length:1,O=f.image||new ou({width:y,height:T}),N=function(nr,ur,Sr){d[f.evaluationKey]=Sr;var gr=f.expression.evaluate(d);O.data[nr+ur+0]=Math.floor(255*gr.r/gr.a),O.data[nr+ur+1]=Math.floor(255*gr.g/gr.a),O.data[nr+ur+2]=Math.floor(255*gr.b/gr.a),O.data[nr+ur+3]=Math.floor(255*gr.a)};if(f.clips)for(var Z=0,q=0;Z<T;++Z,q+=4*y)for(var dt=0,Lt=0;dt<y;dt++,Lt+=4){var Gt=dt/(y-1),Qt=f.clips[Z];N(q,Lt,Qt.start*(1-Gt)+Qt.end*Gt)}else for(var me=0,Fe=0;me<y;me++,Fe+=4)N(0,Fe,me/(y-1));return O}var _c=function(f){function d(y){f.call(this,y,Fc),this._updateColorRamp()}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new kl(y)},d.prototype._handleSpecialPaintPropertyUpdate=function(y){y==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=_h({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(gc),hd={paint:new Vu({"hillshade-illumination-direction":new Qi(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Qi(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Qi(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Qi(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Qi(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Qi(Ce.paint_hillshade["hillshade-accent-color"])})},rv=function(f){function d(y){f.call(this,y,hd)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(gc),nv=rs([{name:"a_pos",components:2,type:"Int16"}],4).members,If=iv,pd=iv;function iv(f,d,y){y=y||2;var T,O,N,Z,q,dt,Lt,Gt=d&&d.length,Qt=Gt?d[0]*y:f.length,me=W0(f,0,Qt,y,!0),Fe=[];if(!me||me.next===me.prev)return Fe;if(Gt&&(me=function(ur,Sr,gr,Ur){var tn,un,yn,Fn=[];for(tn=0,un=Sr.length;tn<un;tn++)(yn=W0(ur,Sr[tn]*Ur,tn<un-1?Sr[tn+1]*Ur:ur.length,Ur,!1))===yn.next&&(yn.steiner=!0),Fn.push(av(yn));for(Fn.sort(Qv),tn=0;tn<Fn.length;tn++)Fg(Fn[tn],gr),gr=eh(gr,gr.next);return gr}(f,d,me,y)),f.length>80*y){T=N=f[0],O=Z=f[1];for(var nr=y;nr<Qt;nr+=y)(q=f[nr])<T&&(T=q),(dt=f[nr+1])<O&&(O=dt),q>N&&(N=q),dt>Z&&(Z=dt);Lt=(Lt=Math.max(N-T,Z-O))!==0?1/Lt:0}return dd(me,Fe,y,T,O,Lt),Fe}function W0(f,d,y,T,O){var N,Z;if(O===xc(f,d,y,T)>0)for(N=d;N<y;N+=T)Z=vd(N,f[N],f[N+1],Z);else for(N=y-T;N>=d;N-=T)Z=vd(N,f[N],f[N+1],Z);return Z&&Eh(Z,Z.next)&&(of(Z),Z=Z.next),Z}function eh(f,d){if(!f)return f;d||(d=f);var y,T=f;do if(y=!1,T.steiner||!Eh(T,T.next)&&ls(T.prev,T,T.next)!==0)T=T.next;else{if(of(T),(T=d=T.prev)===T.next)break;y=!0}while(y||T!==d);return d}function dd(f,d,y,T,O,N,Z){if(f){!Z&&N&&function(Gt,Qt,me,Fe){var nr=Gt;do nr.z===null&&(nr.z=ei(nr.x,nr.y,Qt,me,Fe)),nr.prevZ=nr.prev,nr.nextZ=nr.next,nr=nr.next;while(nr!==Gt);nr.prevZ.nextZ=null,nr.prevZ=null,function(ur){var Sr,gr,Ur,tn,un,yn,Fn,ii,Si=1;do{for(gr=ur,ur=null,un=null,yn=0;gr;){for(yn++,Ur=gr,Fn=0,Sr=0;Sr<Si&&(Fn++,Ur=Ur.nextZ);Sr++);for(ii=Si;Fn>0||ii>0&&Ur;)Fn!==0&&(ii===0||!Ur||gr.z<=Ur.z)?(tn=gr,gr=gr.nextZ,Fn--):(tn=Ur,Ur=Ur.nextZ,ii--),un?un.nextZ=tn:ur=tn,tn.prevZ=un,un=tn;gr=Ur}un.nextZ=null,Si*=2}while(yn>1)}(nr)}(f,T,O,N);for(var q,dt,Lt=f;f.prev!==f.next;)if(q=f.prev,dt=f.next,N?xh(f,T,O,N):Og(f))d.push(q.i/y),d.push(f.i/y),d.push(dt.i/y),of(f),f=dt.next,Lt=dt.next;else if((f=dt)===Lt){Z?Z===1?dd(f=bh(eh(f),d,y),d,y,T,O,N,2):Z===2&&Lp(f,d,y,T,O,N):dd(eh(f),d,y,T,O,N,1);break}}}function Og(f){var d=f.prev,y=f,T=f.next;if(ls(d,y,T)>=0)return!1;for(var O=f.next.next;O!==f.prev;){if(ov(d.x,d.y,y.x,y.y,T.x,T.y,O.x,O.y)&&ls(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function xh(f,d,y,T){var O=f.prev,N=f,Z=f.next;if(ls(O,N,Z)>=0)return!1;for(var q=O.x>N.x?O.x>Z.x?O.x:Z.x:N.x>Z.x?N.x:Z.x,dt=O.y>N.y?O.y>Z.y?O.y:Z.y:N.y>Z.y?N.y:Z.y,Lt=ei(O.x<N.x?O.x<Z.x?O.x:Z.x:N.x<Z.x?N.x:Z.x,O.y<N.y?O.y<Z.y?O.y:Z.y:N.y<Z.y?N.y:Z.y,d,y,T),Gt=ei(q,dt,d,y,T),Qt=f.prevZ,me=f.nextZ;Qt&&Qt.z>=Lt&&me&&me.z<=Gt;){if(Qt!==f.prev&&Qt!==f.next&&ov(O.x,O.y,N.x,N.y,Z.x,Z.y,Qt.x,Qt.y)&&ls(Qt.prev,Qt,Qt.next)>=0||(Qt=Qt.prevZ,me!==f.prev&&me!==f.next&&ov(O.x,O.y,N.x,N.y,Z.x,Z.y,me.x,me.y)&&ls(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;Qt&&Qt.z>=Lt;){if(Qt!==f.prev&&Qt!==f.next&&ov(O.x,O.y,N.x,N.y,Z.x,Z.y,Qt.x,Qt.y)&&ls(Qt.prev,Qt,Qt.next)>=0)return!1;Qt=Qt.prevZ}for(;me&&me.z<=Gt;){if(me!==f.prev&&me!==f.next&&ov(O.x,O.y,N.x,N.y,Z.x,Z.y,me.x,me.y)&&ls(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function bh(f,d,y){var T=f;do{var O=T.prev,N=T.next.next;!Eh(O,N)&&sv(O,T,T.next,N)&&jh(O,N)&&jh(N,O)&&(d.push(O.i/y),d.push(T.i/y),d.push(N.i/y),of(T),of(T.next),T=f=N),T=T.next}while(T!==f);return eh(T)}function Lp(f,d,y,T,O,N){var Z=f;do{for(var q=Z.next.next;q!==Z.prev;){if(Z.i!==q.i&&Tu(Z,q)){var dt=Jv(Z,q);return Z=eh(Z,Z.next),dt=eh(dt,dt.next),dd(Z,d,y,T,O,N),void dd(dt,d,y,T,O,N)}q=q.next}Z=Z.next}while(Z!==f)}function Qv(f,d){return f.x-d.x}function Fg(f,d){if(d=function(T,O){var N,Z=O,q=T.x,dt=T.y,Lt=-1/0;do{if(dt<=Z.y&&dt>=Z.next.y&&Z.next.y!==Z.y){var Gt=Z.x+(dt-Z.y)*(Z.next.x-Z.x)/(Z.next.y-Z.y);if(Gt<=q&&Gt>Lt){if(Lt=Gt,Gt===q){if(dt===Z.y)return Z;if(dt===Z.next.y)return Z.next}N=Z.x<Z.next.x?Z:Z.next}}Z=Z.next}while(Z!==O);if(!N)return null;if(q===Lt)return N;var Qt,me=N,Fe=N.x,nr=N.y,ur=1/0;Z=N;do q>=Z.x&&Z.x>=Fe&&q!==Z.x&&ov(dt<nr?q:Lt,dt,Fe,nr,dt<nr?Lt:q,dt,Z.x,Z.y)&&(Qt=Math.abs(dt-Z.y)/(q-Z.x),jh(Z,T)&&(Qt<ur||Qt===ur&&(Z.x>N.x||Z.x===N.x&&rh(N,Z)))&&(N=Z,ur=Qt)),Z=Z.next;while(Z!==me);return N}(f,d)){var y=Jv(d,f);eh(d,d.next),eh(y,y.next)}}function rh(f,d){return ls(f.prev,f,d.prev)<0&&ls(d.next,f,f.next)<0}function ei(f,d,y,T,O){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=32767*(f-y)*O)|f<<8))|f<<4))|f<<2))|f<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-T)*O)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function av(f){var d=f,y=f;do(d.x<y.x||d.x===y.x&&d.y<y.y)&&(y=d),d=d.next;while(d!==f);return y}function ov(f,d,y,T,O,N,Z,q){return(O-Z)*(d-q)-(f-Z)*(N-q)>=0&&(f-Z)*(T-q)-(y-Z)*(d-q)>=0&&(y-Z)*(N-q)-(O-Z)*(T-q)>=0}function Tu(f,d){return f.next.i!==d.i&&f.prev.i!==d.i&&!function(y,T){var O=y;do{if(O.i!==y.i&&O.next.i!==y.i&&O.i!==T.i&&O.next.i!==T.i&&sv(O,O.next,y,T))return!0;O=O.next}while(O!==y);return!1}(f,d)&&(jh(f,d)&&jh(d,f)&&function(y,T){var O=y,N=!1,Z=(y.x+T.x)/2,q=(y.y+T.y)/2;do O.y>q!=O.next.y>q&&O.next.y!==O.y&&Z<(O.next.x-O.x)*(q-O.y)/(O.next.y-O.y)+O.x&&(N=!N),O=O.next;while(O!==y);return N}(f,d)&&(ls(f.prev,f,d.prev)||ls(f,d.prev,d))||Eh(f,d)&&ls(f.prev,f,f.next)>0&&ls(d.prev,d,d.next)>0)}function ls(f,d,y){return(d.y-f.y)*(y.x-d.x)-(d.x-f.x)*(y.y-d.y)}function Eh(f,d){return f.x===d.x&&f.y===d.y}function sv(f,d,y,T){var O=Rc(ls(f,d,y)),N=Rc(ls(f,d,T)),Z=Rc(ls(y,T,f)),q=Rc(ls(y,T,d));return O!==N&&Z!==q||!(O!==0||!af(f,y,d))||!(N!==0||!af(f,T,d))||!(Z!==0||!af(y,f,T))||!(q!==0||!af(y,d,T))}function af(f,d,y){return d.x<=Math.max(f.x,y.x)&&d.x>=Math.min(f.x,y.x)&&d.y<=Math.max(f.y,y.y)&&d.y>=Math.min(f.y,y.y)}function Rc(f){return f>0?1:f<0?-1:0}function jh(f,d){return ls(f.prev,f,f.next)<0?ls(f,d,f.next)>=0&&ls(f,f.prev,d)>=0:ls(f,d,f.prev)<0||ls(f,f.next,d)<0}function Jv(f,d){var y=new Wh(f.i,f.x,f.y),T=new Wh(d.i,d.x,d.y),O=f.next,N=d.prev;return f.next=d,d.prev=f,y.next=O,O.prev=y,T.next=y,y.prev=T,N.next=T,T.prev=N,T}function vd(f,d,y,T){var O=new Wh(f,d,y);return T?(O.next=T.next,O.prev=T,T.next.prev=O,T.next=O):(O.prev=O,O.next=O),O}function of(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function Wh(f,d,y){this.i=f,this.x=d,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xc(f,d,y,T){for(var O=0,N=d,Z=y-T;N<y;N+=T)O+=(f[Z]-f[N])*(f[N+1]+f[Z+1]),Z=N;return O}function gd(f,d,y,T,O){(function N(Z,q,dt,Lt,Gt){for(;Lt>dt;){if(Lt-dt>600){var Qt=Lt-dt+1,me=q-dt+1,Fe=Math.log(Qt),nr=.5*Math.exp(2*Fe/3),ur=.5*Math.sqrt(Fe*nr*(Qt-nr)/Qt)*(me-Qt/2<0?-1:1);N(Z,q,Math.max(dt,Math.floor(q-me*nr/Qt+ur)),Math.min(Lt,Math.floor(q+(Qt-me)*nr/Qt+ur)),Gt)}var Sr=Z[q],gr=dt,Ur=Lt;for(nh(Z,dt,q),Gt(Z[Lt],Sr)>0&&nh(Z,dt,Lt);gr<Ur;){for(nh(Z,gr,Ur),gr++,Ur--;Gt(Z[gr],Sr)<0;)gr++;for(;Gt(Z[Ur],Sr)>0;)Ur--}Gt(Z[dt],Sr)===0?nh(Z,dt,Ur):nh(Z,++Ur,Lt),Ur<=q&&(dt=Ur+1),q<=Ur&&(Lt=Ur-1)}})(f,d,y||0,T||f.length-1,O||t0)}function nh(f,d,y){var T=f[d];f[d]=f[y],f[y]=T}function t0(f,d){return f<d?-1:f>d?1:0}function md(f,d){var y=f.length;if(y<=1)return[f];for(var T,O,N=[],Z=0;Z<y;Z++){var q=Je(f[Z]);q!==0&&(f[Z].area=Math.abs(q),O===void 0&&(O=q<0),O===q<0?(T&&N.push(T),T=[f[Z]]):T.push(f[Z]))}if(T&&N.push(T),d>1)for(var dt=0;dt<N.length;dt++)N[dt].length<=d||(gd(N[dt],d,1,N[dt].length-1,uv),N[dt]=N[dt].slice(0,d));return N}function uv(f,d){return d.area-f.area}function Pp(f,d,y){for(var T=y.patternDependencies,O=!1,N=0,Z=d;N<Z.length;N+=1){var q=Z[N].paint.get(f+"-pattern");q.isConstant()||(O=!0);var dt=q.constantOr(null);dt&&(O=!0,T[dt.to]=!0,T[dt.from]=!0)}return O}function Xh(f,d,y,T,O){for(var N=O.patternDependencies,Z=0,q=d;Z<q.length;Z+=1){var dt=q[Z],Lt=dt.paint.get(f+"-pattern").value;if(Lt.kind!=="constant"){var Gt=Lt.evaluate({zoom:T-1},y,{},O.availableImages),Qt=Lt.evaluate({zoom:T},y,{},O.availableImages),me=Lt.evaluate({zoom:T+1},y,{},O.availableImages);Qt=Qt&&Qt.name?Qt.name:Qt,me=me&&me.name?me.name:me,N[Gt=Gt&&Gt.name?Gt.name:Gt]=!0,N[Qt]=!0,N[me]=!0,y.patterns[dt.id]={min:Gt,mid:Qt,max:me}}}return y}iv.deviation=function(f,d,y,T){var O=d&&d.length,N=Math.abs(xc(f,0,O?d[0]*y:f.length,y));if(O)for(var Z=0,q=d.length;Z<q;Z++)N-=Math.abs(xc(f,d[Z]*y,Z<q-1?d[Z+1]*y:f.length,y));var dt=0;for(Z=0;Z<T.length;Z+=3){var Lt=T[Z]*y,Gt=T[Z+1]*y,Qt=T[Z+2]*y;dt+=Math.abs((f[Lt]-f[Qt])*(f[Gt+1]-f[Lt+1])-(f[Lt]-f[Gt])*(f[Qt+1]-f[Lt+1]))}return N===0&&dt===0?0:Math.abs((dt-N)/N)},iv.flatten=function(f){for(var d=f[0][0].length,y={vertices:[],holes:[],dimensions:d},T=0,O=0;O<f.length;O++){for(var N=0;N<f[O].length;N++)for(var Z=0;Z<d;Z++)y.vertices.push(f[O][N][Z]);O>0&&y.holes.push(T+=f[O-1].length)}return y},If.default=pd;var gl=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $f,this.indexArray=new Sf,this.indexArray2=new Hh,this.programConfigurations=new ca(f.layers,f.zoom),this.segments=new De,this.segments2=new De,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};gl.prototype.populate=function(f,d,y){this.hasPattern=Pp("fill",this.layers,d);for(var T=this.layers[0].layout.get("fill-sort-key"),O=[],N=0,Z=f;N<Z.length;N+=1){var q=Z[N],dt=q.feature,Lt=q.id,Gt=q.index,Qt=q.sourceLayerIndex,me=this.layers[0]._featureFilter.needGeometry,Fe=bs(dt,me);if(this.layers[0]._featureFilter.filter(new to(this.zoom),Fe,y)){var nr=T?T.evaluate(Fe,{},y,d.availableImages):void 0,ur={id:Lt,properties:dt.properties,type:dt.type,sourceLayerIndex:Qt,index:Gt,geometry:me?Fe.geometry:Ko(dt),patterns:{},sortKey:nr};O.push(ur)}}T&&O.sort(function(ii,Si){return ii.sortKey-Si.sortKey});for(var Sr=0,gr=O;Sr<gr.length;Sr+=1){var Ur=gr[Sr],tn=Ur.geometry,un=Ur.index,yn=Ur.sourceLayerIndex;if(this.hasPattern){var Fn=Xh("fill",this.layers,Ur,this.zoom,d);this.patternFeatures.push(Fn)}else this.addFeature(Ur,tn,un,y,{});d.featureIndex.insert(f[un].feature,tn,un,yn,this.index)}},gl.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},gl.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.patternFeatures;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},gl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},gl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},gl.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,nv),this.indexBuffer=f.createIndexBuffer(this.indexArray),this.indexBuffer2=f.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(f),this.uploaded=!0},gl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},gl.prototype.addFeature=function(f,d,y,T,O){for(var N=0,Z=md(d,500);N<Z.length;N+=1){for(var q=Z[N],dt=0,Lt=0,Gt=q;Lt<Gt.length;Lt+=1)dt+=Gt[Lt].length;for(var Qt=this.segments.prepareSegment(dt,this.layoutVertexArray,this.indexArray),me=Qt.vertexLength,Fe=[],nr=[],ur=0,Sr=q;ur<Sr.length;ur+=1){var gr=Sr[ur];if(gr.length!==0){gr!==q[0]&&nr.push(Fe.length/2);var Ur=this.segments2.prepareSegment(gr.length,this.layoutVertexArray,this.indexArray2),tn=Ur.vertexLength;this.layoutVertexArray.emplaceBack(gr[0].x,gr[0].y),this.indexArray2.emplaceBack(tn+gr.length-1,tn),Fe.push(gr[0].x),Fe.push(gr[0].y);for(var un=1;un<gr.length;un++)this.layoutVertexArray.emplaceBack(gr[un].x,gr[un].y),this.indexArray2.emplaceBack(tn+un-1,tn+un),Fe.push(gr[un].x),Fe.push(gr[un].y);Ur.vertexLength+=gr.length,Ur.primitiveLength+=gr.length}}for(var yn=If(Fe,nr),Fn=0;Fn<yn.length;Fn+=3)this.indexArray.emplaceBack(me+yn[Fn],me+yn[Fn+1],me+yn[Fn+2]);Qt.vertexLength+=dt,Qt.primitiveLength+=yn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},ji("FillBucket",gl,{omit:["layers","patternFeatures"]});var yd=new Vu({"fill-sort-key":new ki(Ce.layout_fill["fill-sort-key"])}),kf={paint:new Vu({"fill-antialias":new Qi(Ce.paint_fill["fill-antialias"]),"fill-opacity":new ki(Ce.paint_fill["fill-opacity"]),"fill-color":new ki(Ce.paint_fill["fill-color"]),"fill-outline-color":new ki(Ce.paint_fill["fill-outline-color"]),"fill-translate":new Qi(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new Qi(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ef(Ce.paint_fill["fill-pattern"])}),layout:yd},Op=function(f){function d(y){f.call(this,y,kf)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.recalculate=function(y,T){f.prototype.recalculate.call(this,y,T);var O=this.paint._values["fill-outline-color"];O.value.kind==="constant"&&O.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(y){return new gl(y)},d.prototype.queryRadius=function(){return Rs(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt){return Vl(iu(y,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),q.angle,dt),N)},d.prototype.isTileClipped=function(){return!0},d}(gc),Fp=rs([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,_d=cs;function cs(f,d,y,T,O){this.properties={},this.extent=y,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=O,f.readFields(sl,this,d)}function sl(f,d,y){f==1?d.id=y.readVarint():f==2?function(T,O){for(var N=T.readVarint()+T.pos;T.pos<N;){var Z=O._keys[T.readVarint()],q=O._values[T.readVarint()];O.properties[Z]=q}}(y,d):f==3?d.type=y.readVarint():f==4&&(d._geometry=y.pos)}function e0(f){for(var d,y,T=0,O=0,N=f.length,Z=N-1;O<N;Z=O++)T+=((y=f[Z]).x-(d=f[O]).x)*(d.y+y.y);return T}cs.types=["Unknown","Point","LineString","Polygon"],cs.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var d,y=f.readVarint()+f.pos,T=1,O=0,N=0,Z=0,q=[];f.pos<y;){if(O<=0){var dt=f.readVarint();T=7&dt,O=dt>>3}if(O--,T===1||T===2)N+=f.readSVarint(),Z+=f.readSVarint(),T===1&&(d&&q.push(d),d=[]),d.push(new J(N,Z));else{if(T!==7)throw new Error("unknown command "+T);d&&d.push(d[0].clone())}}return d&&q.push(d),q},cs.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var d=f.readVarint()+f.pos,y=1,T=0,O=0,N=0,Z=1/0,q=-1/0,dt=1/0,Lt=-1/0;f.pos<d;){if(T<=0){var Gt=f.readVarint();y=7&Gt,T=Gt>>3}if(T--,y===1||y===2)(O+=f.readSVarint())<Z&&(Z=O),O>q&&(q=O),(N+=f.readSVarint())<dt&&(dt=N),N>Lt&&(Lt=N);else if(y!==7)throw new Error("unknown command "+y)}return[Z,dt,q,Lt]},cs.prototype.toGeoJSON=function(f,d,y){var T,O,N=this.extent*Math.pow(2,y),Z=this.extent*f,q=this.extent*d,dt=this.loadGeometry(),Lt=cs.types[this.type];function Gt(Fe){for(var nr=0;nr<Fe.length;nr++){var ur=Fe[nr];Fe[nr]=[360*(ur.x+Z)/N-180,360/Math.PI*Math.atan(Math.exp((180-360*(ur.y+q)/N)*Math.PI/180))-90]}}switch(this.type){case 1:var Qt=[];for(T=0;T<dt.length;T++)Qt[T]=dt[T][0];Gt(dt=Qt);break;case 2:for(T=0;T<dt.length;T++)Gt(dt[T]);break;case 3:for(dt=function(Fe){var nr=Fe.length;if(nr<=1)return[Fe];for(var ur,Sr,gr=[],Ur=0;Ur<nr;Ur++){var tn=e0(Fe[Ur]);tn!==0&&(Sr===void 0&&(Sr=tn<0),Sr===tn<0?(ur&&gr.push(ur),ur=[Fe[Ur]]):ur.push(Fe[Ur]))}return ur&&gr.push(ur),gr}(dt),T=0;T<dt.length;T++)for(O=0;O<dt[T].length;O++)Gt(dt[T][O])}dt.length===1?dt=dt[0]:Lt="Multi"+Lt;var me={type:"Feature",geometry:{type:Lt,coordinates:dt},properties:this.properties};return"id"in this&&(me.id=this.id),me};var wh=X0;function X0(f,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(Y0,this,d),this.length=this._features.length}function Y0(f,d,y){f===15?d.version=y.readVarint():f===1?d.name=y.readString():f===5?d.extent=y.readVarint():f===2?d._features.push(y.pos):f===3?d._keys.push(y.readString()):f===4&&d._values.push(function(T){for(var O=null,N=T.readVarint()+T.pos;T.pos<N;){var Z=T.readVarint()>>3;O=Z===1?T.readString():Z===2?T.readFloat():Z===3?T.readDouble():Z===4?T.readVarint64():Z===5?T.readVarint():Z===6?T.readSVarint():Z===7?T.readBoolean():null}return O}(y))}function Rp(f,d,y){if(f===3){var T=new wh(y,y.readVarint()+y.pos);T.length&&(d[T.name]=T)}}X0.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var d=this._pbf.readVarint()+this._pbf.pos;return new _d(this._pbf,d,this.extent,this._keys,this._values)};var Hl={VectorTile:function(f,d){this.layers=f.readFields(Rp,{},d)},VectorTileFeature:_d,VectorTileLayer:wh},Mu=Hl.VectorTileFeature.types,bc=Math.pow(2,13);function Iu(f,d,y,T,O,N,Z,q){f.emplaceBack(d,y,2*Math.floor(T*bc)+Z,O*bc*2,N*bc*2,Math.round(q))}var Lf=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.layoutVertexArray=new il,this.indexArray=new Sf,this.programConfigurations=new ca(f.layers,f.zoom),this.segments=new De,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function Rg(f,d){return f.x===d.x&&(f.x<0||f.x>8192)||f.y===d.y&&(f.y<0||f.y>8192)}Lf.prototype.populate=function(f,d,y){this.features=[],this.hasPattern=Pp("fill-extrusion",this.layers,d);for(var T=0,O=f;T<O.length;T+=1){var N=O[T],Z=N.feature,q=N.id,dt=N.index,Lt=N.sourceLayerIndex,Gt=this.layers[0]._featureFilter.needGeometry,Qt=bs(Z,Gt);if(this.layers[0]._featureFilter.filter(new to(this.zoom),Qt,y)){var me={id:q,sourceLayerIndex:Lt,index:dt,geometry:Gt?Qt.geometry:Ko(Z),properties:Z.properties,type:Z.type,patterns:{}};this.hasPattern?this.features.push(Xh("fill-extrusion",this.layers,me,this.zoom,d)):this.addFeature(me,me.geometry,dt,y,{}),d.featureIndex.insert(Z,me.geometry,dt,Lt,this.index,!0)}}},Lf.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.features;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},Lf.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Lf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Lf.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Lf.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Fp),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},Lf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Lf.prototype.addFeature=function(f,d,y,T,O){for(var N=0,Z=md(d,500);N<Z.length;N+=1){for(var q=Z[N],dt=0,Lt=0,Gt=q;Lt<Gt.length;Lt+=1)dt+=Gt[Lt].length;for(var Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),me=0,Fe=q;me<Fe.length;me+=1){var nr=Fe[me];if(nr.length!==0&&!((ho=nr).every(function(Ha){return Ha.x<0})||ho.every(function(Ha){return Ha.x>8192})||ho.every(function(Ha){return Ha.y<0})||ho.every(function(Ha){return Ha.y>8192})))for(var ur=0,Sr=0;Sr<nr.length;Sr++){var gr=nr[Sr];if(Sr>=1){var Ur=nr[Sr-1];if(!Rg(gr,Ur)){Qt.vertexLength+4>De.MAX_VERTEX_ARRAY_LENGTH&&(Qt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var tn=gr.sub(Ur)._perp()._unit(),un=Ur.dist(gr);ur+un>32768&&(ur=0),Iu(this.layoutVertexArray,gr.x,gr.y,tn.x,tn.y,0,0,ur),Iu(this.layoutVertexArray,gr.x,gr.y,tn.x,tn.y,0,1,ur),Iu(this.layoutVertexArray,Ur.x,Ur.y,tn.x,tn.y,0,0,ur+=un),Iu(this.layoutVertexArray,Ur.x,Ur.y,tn.x,tn.y,0,1,ur);var yn=Qt.vertexLength;this.indexArray.emplaceBack(yn,yn+2,yn+1),this.indexArray.emplaceBack(yn+1,yn+2,yn+3),Qt.vertexLength+=4,Qt.primitiveLength+=2}}}}if(Qt.vertexLength+dt>De.MAX_VERTEX_ARRAY_LENGTH&&(Qt=this.segments.prepareSegment(dt,this.layoutVertexArray,this.indexArray)),Mu[f.type]==="Polygon"){for(var Fn=[],ii=[],Si=Qt.vertexLength,sa=0,Zi=q;sa<Zi.length;sa+=1){var pa=Zi[sa];if(pa.length!==0){pa!==q[0]&&ii.push(Fn.length/2);for(var Rn=0;Rn<pa.length;Rn++){var Fi=pa[Rn];Iu(this.layoutVertexArray,Fi.x,Fi.y,0,0,1,1,0),Fn.push(Fi.x),Fn.push(Fi.y)}}}for(var aa=If(Fn,ii),Ji=0;Ji<aa.length;Ji+=3)this.indexArray.emplaceBack(Si+aa[Ji],Si+aa[Ji+2],Si+aa[Ji+1]);Qt.primitiveLength+=aa.length/3,Qt.vertexLength+=dt}}var ho;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},ji("FillExtrusionBucket",Lf,{omit:["layers","features"]});var xd={paint:new Vu({"fill-extrusion-opacity":new Qi(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ki(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Qi(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Qi(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ef(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ki(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ki(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Qi(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},jl=function(f){function d(y){f.call(this,y,xd)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new Lf(y)},d.prototype.queryRadius=function(){return Rs(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt,Lt){var Gt=iu(y,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),q.angle,dt),Qt=this.paint.get("fill-extrusion-height").evaluate(T,O),me=this.paint.get("fill-extrusion-base").evaluate(T,O),Fe=function(ur,Sr,gr,Ur){for(var tn=[],un=0,yn=ur;un<yn.length;un+=1){var Fn=yn[un],ii=[Fn.x,Fn.y,0,1];kp(ii,ii,Sr),tn.push(new J(ii[0]/ii[3],ii[1]/ii[3]))}return tn}(Gt,Lt),nr=function(ur,Sr,gr,Ur){for(var tn=[],un=[],yn=Ur[8]*Sr,Fn=Ur[9]*Sr,ii=Ur[10]*Sr,Si=Ur[11]*Sr,sa=Ur[8]*gr,Zi=Ur[9]*gr,pa=Ur[10]*gr,Rn=Ur[11]*gr,Fi=0,aa=ur;Fi<aa.length;Fi+=1){for(var Ji=[],ho=[],Ha=0,so=aa[Fi];Ha<so.length;Ha+=1){var _i=so[Ha],No=_i.x,Bs=_i.y,qs=Ur[0]*No+Ur[4]*Bs+Ur[12],Cs=Ur[1]*No+Ur[5]*Bs+Ur[13],Ls=Ur[2]*No+Ur[6]*Bs+Ur[14],uu=Ur[3]*No+Ur[7]*Bs+Ur[15],Ns=Ls+ii,vu=uu+Si,Hu=qs+sa,cl=Cs+Zi,ml=Ls+pa,Fu=uu+Rn,fl=new J((qs+yn)/vu,(Cs+Fn)/vu);fl.z=Ns/vu,Ji.push(fl);var qa=new J(Hu/Fu,cl/Fu);qa.z=ml/Fu,ho.push(qa)}tn.push(Ji),un.push(ho)}return[tn,un]}(N,me,Qt,Lt);return function(ur,Sr,gr){var Ur=1/0;Vl(gr,Sr)&&(Ur=Sh(gr,Sr[0]));for(var tn=0;tn<Sr.length;tn++)for(var un=Sr[tn],yn=ur[tn],Fn=0;Fn<un.length-1;Fn++){var ii=un[Fn],Si=[ii,un[Fn+1],yn[Fn+1],yn[Fn],ii];mc(gr,Si)&&(Ur=Math.min(Ur,Sh(gr,Si)))}return Ur!==1/0&&Ur}(nr[0],nr[1],Fe)},d}(gc);function ku(f,d){return f.x*d.x+f.y*d.y}function Sh(f,d){if(f.length===1){for(var y,T=0,O=d[T++];!y||O.equals(y);)if(!(y=d[T++]))return 1/0;for(;T<d.length;T++){var N=d[T],Z=f[0],q=y.sub(O),dt=N.sub(O),Lt=Z.sub(O),Gt=ku(q,q),Qt=ku(q,dt),me=ku(dt,dt),Fe=ku(Lt,q),nr=ku(Lt,dt),ur=Gt*me-Qt*Qt,Sr=(me*Fe-Qt*nr)/ur,gr=(Gt*nr-Qt*Fe)/ur,Ur=O.z*(1-Sr-gr)+y.z*Sr+N.z*gr;if(isFinite(Ur))return Ur}return 1/0}for(var tn=1/0,un=0,yn=d;un<yn.length;un+=1)tn=Math.min(tn,yn[un].z);return tn}var lc=rs([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Yh=rs([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,r0=Hl.VectorTileFeature.types,lv=Math.cos(Math.PI/180*37.5),n0=Math.pow(2,14)/.5,ko=function(f){var d=this;this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(y){return y.id}),this.index=f.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(y){d.gradients[y.id]={}}),this.layoutVertexArray=new va,this.layoutVertexArray2=new Ul,this.indexArray=new Sf,this.programConfigurations=new ca(f.layers,f.zoom),this.segments=new De,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(y){return y.isStateDependent()}).map(function(y){return y.id})};ko.prototype.populate=function(f,d,y){this.hasPattern=Pp("line",this.layers,d);for(var T=this.layers[0].layout.get("line-sort-key"),O=[],N=0,Z=f;N<Z.length;N+=1){var q=Z[N],dt=q.feature,Lt=q.id,Gt=q.index,Qt=q.sourceLayerIndex,me=this.layers[0]._featureFilter.needGeometry,Fe=bs(dt,me);if(this.layers[0]._featureFilter.filter(new to(this.zoom),Fe,y)){var nr=T?T.evaluate(Fe,{},y):void 0,ur={id:Lt,properties:dt.properties,type:dt.type,sourceLayerIndex:Qt,index:Gt,geometry:me?Fe.geometry:Ko(dt),patterns:{},sortKey:nr};O.push(ur)}}T&&O.sort(function(ii,Si){return ii.sortKey-Si.sortKey});for(var Sr=0,gr=O;Sr<gr.length;Sr+=1){var Ur=gr[Sr],tn=Ur.geometry,un=Ur.index,yn=Ur.sourceLayerIndex;if(this.hasPattern){var Fn=Xh("line",this.layers,Ur,this.zoom,d);this.patternFeatures.push(Fn)}else this.addFeature(Ur,tn,un,y,{});d.featureIndex.insert(f[un].feature,tn,un,yn,this.index)}},ko.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},ko.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.patternFeatures;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},ko.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ko.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ko.prototype.upload=function(f){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=f.createVertexBuffer(this.layoutVertexArray2,Yh)),this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,lc),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},ko.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ko.prototype.lineFeatureClips=function(f){if(f.properties&&f.properties.hasOwnProperty("mapbox_clip_start")&&f.properties.hasOwnProperty("mapbox_clip_end"))return{start:+f.properties.mapbox_clip_start,end:+f.properties.mapbox_clip_end}},ko.prototype.addFeature=function(f,d,y,T,O){var N=this.layers[0].layout,Z=N.get("line-join").evaluate(f,{}),q=N.get("line-cap"),dt=N.get("line-miter-limit"),Lt=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(f);for(var Gt=0,Qt=d;Gt<Qt.length;Gt+=1)this.addLine(Qt[Gt],f,Z,q,dt,Lt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},ko.prototype.addLine=function(f,d,y,T,O,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var Z=0;Z<f.length-1;Z++)this.totalDistance+=f[Z].dist(f[Z+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var q=r0[d.type]==="Polygon",dt=f.length;dt>=2&&f[dt-1].equals(f[dt-2]);)dt--;for(var Lt=0;Lt<dt-1&&f[Lt].equals(f[Lt+1]);)Lt++;if(!(dt<(q?3:2))){y==="bevel"&&(O=1.05);var Gt,Qt=this.overscaling<=16?122880/(512*this.overscaling):0,me=this.segments.prepareSegment(10*dt,this.layoutVertexArray,this.indexArray),Fe=void 0,nr=void 0,ur=void 0,Sr=void 0;this.e1=this.e2=-1,q&&(Sr=f[Lt].sub(Gt=f[dt-2])._unit()._perp());for(var gr=Lt;gr<dt;gr++)if(!(nr=gr===dt-1?q?f[Lt+1]:void 0:f[gr+1])||!f[gr].equals(nr)){Sr&&(ur=Sr),Gt&&(Fe=Gt),Gt=f[gr],Sr=nr?nr.sub(Gt)._unit()._perp():ur;var Ur=(ur=ur||Sr).add(Sr);Ur.x===0&&Ur.y===0||Ur._unit();var tn=ur.x*Sr.x+ur.y*Sr.y,un=Ur.x*Sr.x+Ur.y*Sr.y,yn=un!==0?1/un:1/0,Fn=2*Math.sqrt(2-2*un),ii=un<lv&&Fe&&nr,Si=ur.x*Sr.y-ur.y*Sr.x>0;if(ii&&gr>Lt){var sa=Gt.dist(Fe);if(sa>2*Qt){var Zi=Gt.sub(Gt.sub(Fe)._mult(Qt/sa)._round());this.updateDistance(Fe,Zi),this.addCurrentVertex(Zi,ur,0,0,me),Fe=Zi}}var pa=Fe&&nr,Rn=pa?y:q?"butt":T;if(pa&&Rn==="round"&&(yn<N?Rn="miter":yn<=2&&(Rn="fakeround")),Rn==="miter"&&yn>O&&(Rn="bevel"),Rn==="bevel"&&(yn>2&&(Rn="flipbevel"),yn<O&&(Rn="miter")),Fe&&this.updateDistance(Fe,Gt),Rn==="miter")Ur._mult(yn),this.addCurrentVertex(Gt,Ur,0,0,me);else if(Rn==="flipbevel"){if(yn>100)Ur=Sr.mult(-1);else{var Fi=yn*ur.add(Sr).mag()/ur.sub(Sr).mag();Ur._perp()._mult(Fi*(Si?-1:1))}this.addCurrentVertex(Gt,Ur,0,0,me),this.addCurrentVertex(Gt,Ur.mult(-1),0,0,me)}else if(Rn==="bevel"||Rn==="fakeround"){var aa=-Math.sqrt(yn*yn-1),Ji=Si?aa:0,ho=Si?0:aa;if(Fe&&this.addCurrentVertex(Gt,ur,Ji,ho,me),Rn==="fakeround")for(var Ha=Math.round(180*Fn/Math.PI/20),so=1;so<Ha;so++){var _i=so/Ha;if(_i!==.5){var No=_i-.5;_i+=_i*No*(_i-1)*((1.0904+tn*(tn*(3.55645-1.43519*tn)-3.2452))*No*No+(.848013+tn*(.215638*tn-1.06021)))}var Bs=Sr.sub(ur)._mult(_i)._add(ur)._unit()._mult(Si?-1:1);this.addHalfVertex(Gt,Bs.x,Bs.y,!1,Si,0,me)}nr&&this.addCurrentVertex(Gt,Sr,-Ji,-ho,me)}else if(Rn==="butt")this.addCurrentVertex(Gt,Ur,0,0,me);else if(Rn==="square"){var qs=Fe?1:-1;this.addCurrentVertex(Gt,Ur,qs,qs,me)}else Rn==="round"&&(Fe&&(this.addCurrentVertex(Gt,ur,0,0,me),this.addCurrentVertex(Gt,ur,1,1,me,!0)),nr&&(this.addCurrentVertex(Gt,Sr,-1,-1,me,!0),this.addCurrentVertex(Gt,Sr,0,0,me)));if(ii&&gr<dt-1){var Cs=Gt.dist(nr);if(Cs>2*Qt){var Ls=Gt.add(nr.sub(Gt)._mult(Qt/Cs)._round());this.updateDistance(Gt,Ls),this.addCurrentVertex(Ls,Sr,0,0,me),Gt=Ls}}}}},ko.prototype.addCurrentVertex=function(f,d,y,T,O,N){N===void 0&&(N=!1);var Z=d.y*T-d.x,q=-d.y-d.x*T;this.addHalfVertex(f,d.x+d.y*y,d.y-d.x*y,N,!1,y,O),this.addHalfVertex(f,Z,q,N,!0,-T,O),this.distance>n0/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(f,d,y,T,O,N))},ko.prototype.addHalfVertex=function(f,d,y,T,O,N,Z){var q=.5*(this.lineClips?this.scaledDistance*(n0-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((f.x<<1)+(T?1:0),(f.y<<1)+(O?1:0),Math.round(63*d)+128,Math.round(63*y)+128,1+(N===0?0:N<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var dt=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,dt),Z.primitiveLength++),O?this.e2=dt:this.e1=dt},ko.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},ko.prototype.updateDistance=function(f,d){this.distance+=f.dist(d),this.updateScaledDistance()},ji("LineBucket",ko,{omit:["layers","patternFeatures"]});var Pf=new Vu({"line-cap":new Qi(Ce.layout_line["line-cap"]),"line-join":new ki(Ce.layout_line["line-join"]),"line-miter-limit":new Qi(Ce.layout_line["line-miter-limit"]),"line-round-limit":new Qi(Ce.layout_line["line-round-limit"]),"line-sort-key":new ki(Ce.layout_line["line-sort-key"])}),Is={paint:new Vu({"line-opacity":new ki(Ce.paint_line["line-opacity"]),"line-color":new ki(Ce.paint_line["line-color"]),"line-translate":new Qi(Ce.paint_line["line-translate"]),"line-translate-anchor":new Qi(Ce.paint_line["line-translate-anchor"]),"line-width":new ki(Ce.paint_line["line-width"]),"line-gap-width":new ki(Ce.paint_line["line-gap-width"]),"line-offset":new ki(Ce.paint_line["line-offset"]),"line-blur":new ki(Ce.paint_line["line-blur"]),"line-dasharray":new Ju(Ce.paint_line["line-dasharray"]),"line-pattern":new Ef(Ce.paint_line["line-pattern"]),"line-gradient":new Cu(Ce.paint_line["line-gradient"])}),layout:Pf},ul=new(function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(y,T){return T=new to(Math.floor(T.zoom),{now:T.now,fadeDuration:T.fadeDuration,zoomHistory:T.zoomHistory,transition:T.transition}),f.prototype.possiblyEvaluate.call(this,y,T)},d.prototype.evaluate=function(y,T,O,N){return T=b({},T,{zoom:Math.floor(T.zoom)}),f.prototype.evaluate.call(this,y,T,O,N)},d}(ki))(Is.paint.properties["line-width"].specification);ul.useIntegerZoom=!0;var cv=function(f){function d(y){f.call(this,y,Is),this.gradientVersion=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(y){y==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Nu,this.gradientVersion=(this.gradientVersion+1)%be)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(y,T){f.prototype.recalculate.call(this,y,T),this.paint._values["line-floorwidth"]=ul.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,y)},d.prototype.createBucket=function(y){return new ko(y)},d.prototype.queryRadius=function(y){var T=y,O=$0(Il("line-width",this,T),Il("line-gap-width",this,T)),N=Il("line-offset",this,T);return O/2+Math.abs(N)+Rs(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,q,dt){var Lt=iu(y,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),q.angle,dt),Gt=dt/2*$0(this.paint.get("line-width").evaluate(T,O),this.paint.get("line-gap-width").evaluate(T,O)),Qt=this.paint.get("line-offset").evaluate(T,O);return Qt&&(N=function(me,Fe){for(var nr=[],ur=new J(0,0),Sr=0;Sr<me.length;Sr++){for(var gr=me[Sr],Ur=[],tn=0;tn<gr.length;tn++){var un=gr[tn],yn=gr[tn+1],Fn=tn===0?ur:un.sub(gr[tn-1])._unit()._perp(),ii=tn===gr.length-1?ur:yn.sub(un)._unit()._perp(),Si=Fn._add(ii)._unit();Si._mult(1/(Si.x*ii.x+Si.y*ii.y)),Ur.push(Si._mult(Fe)._add(un))}nr.push(Ur)}return nr}(N,Qt*dt)),function(me,Fe,nr){for(var ur=0;ur<Fe.length;ur++){var Sr=Fe[ur];if(me.length>=3){for(var gr=0;gr<Sr.length;gr++)if(sc(me,Sr[gr]))return!0}if(Tl(me,Sr,nr))return!0}return!1}(Lt,N,Gt)},d.prototype.isTileClipped=function(){return!0},d}(gc);function $0(f,d){return d>0?d+2*f:f}var Dg=rs([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Bg=rs([{name:"a_projected_pos",components:3,type:"Float32"}],4),fv=(rs([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),rs([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),hv=(rs([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),rs([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),i0=rs([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function a0(f,d,y){return f.sections.forEach(function(T){T.text=function(O,N,Z){var q=N.layout.get("text-transform").evaluate(Z,{});return q==="uppercase"?O=O.toLocaleUpperCase():q==="lowercase"&&(O=O.toLocaleLowerCase()),dl.applyArabicShaping&&(O=dl.applyArabicShaping(O)),O}(T.text,d,y)}),f}rs([{name:"triangle",components:3,type:"Uint16"}]),rs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),rs([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),rs([{type:"Float32",name:"offsetX"}]),rs([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Ch={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},o0=function(f,d,y,T,O){var N,Z,q=8*O-T-1,dt=(1<<q)-1,Lt=dt>>1,Gt=-7,Qt=y?O-1:0,me=y?-1:1,Fe=f[d+Qt];for(Qt+=me,N=Fe&(1<<-Gt)-1,Fe>>=-Gt,Gt+=q;Gt>0;N=256*N+f[d+Qt],Qt+=me,Gt-=8);for(Z=N&(1<<-Gt)-1,N>>=-Gt,Gt+=T;Gt>0;Z=256*Z+f[d+Qt],Qt+=me,Gt-=8);if(N===0)N=1-Lt;else{if(N===dt)return Z?NaN:1/0*(Fe?-1:1);Z+=Math.pow(2,T),N-=Lt}return(Fe?-1:1)*Z*Math.pow(2,N-T)},pv=function(f,d,y,T,O,N){var Z,q,dt,Lt=8*N-O-1,Gt=(1<<Lt)-1,Qt=Gt>>1,me=O===23?Math.pow(2,-24)-Math.pow(2,-77):0,Fe=T?0:N-1,nr=T?1:-1,ur=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(q=isNaN(d)?1:0,Z=Gt):(Z=Math.floor(Math.log(d)/Math.LN2),d*(dt=Math.pow(2,-Z))<1&&(Z--,dt*=2),(d+=Z+Qt>=1?me/dt:me*Math.pow(2,1-Qt))*dt>=2&&(Z++,dt/=2),Z+Qt>=Gt?(q=0,Z=Gt):Z+Qt>=1?(q=(d*dt-1)*Math.pow(2,O),Z+=Qt):(q=d*Math.pow(2,Qt-1)*Math.pow(2,O),Z=0));O>=8;f[y+Fe]=255&q,Fe+=nr,q/=256,O-=8);for(Z=Z<<O|q,Lt+=O;Lt>0;f[y+Fe]=255&Z,Fe+=nr,Z/=256,Lt-=8);f[y+Fe-nr]|=128*ur},Ah=ns;function ns(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}ns.Varint=0,ns.Fixed64=1,ns.Bytes=2,ns.Fixed32=5;var dv=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function cc(f){return f.type===ns.Bytes?f.readVarint()+f.pos:f.pos+1}function fc(f,d,y){return y?4294967296*d+(f>>>0):4294967296*(d>>>0)+(f>>>0)}function s0(f,d,y){var T=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));y.realloc(T);for(var O=y.pos-1;O>=f;O--)y.buf[O+T]=y.buf[O]}function $h(f,d){for(var y=0;y<f.length;y++)d.writeVarint(f[y])}function It(f,d){for(var y=0;y<f.length;y++)d.writeSVarint(f[y])}function Re(f,d){for(var y=0;y<f.length;y++)d.writeFloat(f[y])}function dr(f,d){for(var y=0;y<f.length;y++)d.writeDouble(f[y])}function ln(f,d){for(var y=0;y<f.length;y++)d.writeBoolean(f[y])}function Ln(f,d){for(var y=0;y<f.length;y++)d.writeFixed32(f[y])}function on(f,d){for(var y=0;y<f.length;y++)d.writeSFixed32(f[y])}function En(f,d){for(var y=0;y<f.length;y++)d.writeFixed64(f[y])}function jr(f,d){for(var y=0;y<f.length;y++)d.writeSFixed64(f[y])}function Xn(f,d){return(f[d]|f[d+1]<<8|f[d+2]<<16)+16777216*f[d+3]}function Yn(f,d,y){f[y]=d,f[y+1]=d>>>8,f[y+2]=d>>>16,f[y+3]=d>>>24}function ni(f,d){return(f[d]|f[d+1]<<8|f[d+2]<<16)+(f[d+3]<<24)}function Jn(f,d,y){f===1&&y.readMessage(yi,d)}function yi(f,d,y){if(f===3){var T=y.readMessage(qn,{}),O=T.width,N=T.height,Z=T.left,q=T.top,dt=T.advance;d.push({id:T.id,bitmap:new Ll({width:O+6,height:N+6},T.bitmap),metrics:{width:O,height:N,left:Z,top:q,advance:dt}})}}function qn(f,d,y){f===1?d.id=y.readVarint():f===2?d.bitmap=y.readBytes():f===3?d.width=y.readVarint():f===4?d.height=y.readVarint():f===5?d.left=y.readSVarint():f===6?d.top=y.readSVarint():f===7&&(d.advance=y.readVarint())}function ri(f){for(var d=0,y=0,T=0,O=f;T<O.length;T+=1){var N=O[T];d+=N.w*N.h,y=Math.max(y,N.w)}f.sort(function(ur,Sr){return Sr.h-ur.h});for(var Z=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),y),h:1/0}],q=0,dt=0,Lt=0,Gt=f;Lt<Gt.length;Lt+=1)for(var Qt=Gt[Lt],me=Z.length-1;me>=0;me--){var Fe=Z[me];if(!(Qt.w>Fe.w||Qt.h>Fe.h)){if(Qt.x=Fe.x,Qt.y=Fe.y,dt=Math.max(dt,Qt.y+Qt.h),q=Math.max(q,Qt.x+Qt.w),Qt.w===Fe.w&&Qt.h===Fe.h){var nr=Z.pop();me<Z.length&&(Z[me]=nr)}else Qt.h===Fe.h?(Fe.x+=Qt.w,Fe.w-=Qt.w):Qt.w===Fe.w?(Fe.y+=Qt.h,Fe.h-=Qt.h):(Z.push({x:Fe.x+Qt.w,y:Fe.y,w:Fe.w-Qt.w,h:Qt.h}),Fe.y+=Qt.h,Fe.h-=Qt.h);break}}return{w:q,h:dt,fill:d/(q*dt)||0}}ns.prototype={destroy:function(){this.buf=null},readFields:function(f,d,y){for(y=y||this.length;this.pos<y;){var T=this.readVarint(),O=T>>3,N=this.pos;this.type=7&T,f(O,d,this),this.pos===N&&this.skip(T)}return d},readMessage:function(f,d){return this.readFields(f,d,this.readVarint()+this.pos)},readFixed32:function(){var f=Xn(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=ni(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=Xn(this.buf,this.pos)+4294967296*Xn(this.buf,this.pos+4);return this.pos+=8,f},readSFixed64:function(){var f=Xn(this.buf,this.pos)+4294967296*ni(this.buf,this.pos+4);return this.pos+=8,f},readFloat:function(){var f=o0(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=o0(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var d,y,T=this.buf;return d=127&(y=T[this.pos++]),y<128?d:(d|=(127&(y=T[this.pos++]))<<7,y<128?d:(d|=(127&(y=T[this.pos++]))<<14,y<128?d:(d|=(127&(y=T[this.pos++]))<<21,y<128?d:function(O,N,Z){var q,dt,Lt=Z.buf;if(q=(112&(dt=Lt[Z.pos++]))>>4,dt<128||(q|=(127&(dt=Lt[Z.pos++]))<<3,dt<128)||(q|=(127&(dt=Lt[Z.pos++]))<<10,dt<128)||(q|=(127&(dt=Lt[Z.pos++]))<<17,dt<128)||(q|=(127&(dt=Lt[Z.pos++]))<<24,dt<128)||(q|=(1&(dt=Lt[Z.pos++]))<<31,dt<128))return fc(O,q,N);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(y=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var f=this.readVarint()+this.pos,d=this.pos;return this.pos=f,f-d>=12&&dv?function(y,T,O){return dv.decode(y.subarray(T,O))}(this.buf,d,f):function(y,T,O){for(var N="",Z=T;Z<O;){var q,dt,Lt,Gt=y[Z],Qt=null,me=Gt>239?4:Gt>223?3:Gt>191?2:1;if(Z+me>O)break;me===1?Gt<128&&(Qt=Gt):me===2?(192&(q=y[Z+1]))==128&&(Qt=(31&Gt)<<6|63&q)<=127&&(Qt=null):me===3?(dt=y[Z+2],(192&(q=y[Z+1]))==128&&(192&dt)==128&&((Qt=(15&Gt)<<12|(63&q)<<6|63&dt)<=2047||Qt>=55296&&Qt<=57343)&&(Qt=null)):me===4&&(dt=y[Z+2],Lt=y[Z+3],(192&(q=y[Z+1]))==128&&(192&dt)==128&&(192&Lt)==128&&((Qt=(15&Gt)<<18|(63&q)<<12|(63&dt)<<6|63&Lt)<=65535||Qt>=1114112)&&(Qt=null)),Qt===null?(Qt=65533,me=1):Qt>65535&&(Qt-=65536,N+=String.fromCharCode(Qt>>>10&1023|55296),Qt=56320|1023&Qt),N+=String.fromCharCode(Qt),Z+=me}return N}(this.buf,d,f)},readBytes:function(){var f=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,f);return this.pos=f,d},readPackedVarint:function(f,d){if(this.type!==ns.Bytes)return f.push(this.readVarint(d));var y=cc(this);for(f=f||[];this.pos<y;)f.push(this.readVarint(d));return f},readPackedSVarint:function(f){if(this.type!==ns.Bytes)return f.push(this.readSVarint());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==ns.Bytes)return f.push(this.readBoolean());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==ns.Bytes)return f.push(this.readFloat());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==ns.Bytes)return f.push(this.readDouble());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==ns.Bytes)return f.push(this.readFixed32());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==ns.Bytes)return f.push(this.readSFixed32());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==ns.Bytes)return f.push(this.readFixed64());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==ns.Bytes)return f.push(this.readSFixed64());var d=cc(this);for(f=f||[];this.pos<d;)f.push(this.readSFixed64());return f},skip:function(f){var d=7&f;if(d===ns.Varint)for(;this.buf[this.pos++]>127;);else if(d===ns.Bytes)this.pos=this.readVarint()+this.pos;else if(d===ns.Fixed32)this.pos+=4;else{if(d!==ns.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(f,d){this.writeVarint(f<<3|d)},realloc:function(f){for(var d=this.length||16;d<this.pos+f;)d*=2;if(d!==this.length){var y=new Uint8Array(d);y.set(this.buf),this.buf=y,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),Yn(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),Yn(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),Yn(this.buf,-1&f,this.pos),Yn(this.buf,Math.floor(f*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),Yn(this.buf,-1&f,this.pos),Yn(this.buf,Math.floor(f*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(d,y){var T,O;if(d>=0?(T=d%4294967296|0,O=d/4294967296|0):(O=~(-d/4294967296),4294967295^(T=~(-d%4294967296))?T=T+1|0:(T=0,O=O+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");y.realloc(10),function(N,Z,q){q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,N>>>=7,q.buf[q.pos++]=127&N|128,q.buf[q.pos]=127&(N>>>=7)}(T,0,y),function(N,Z){var q=(7&N)<<4;Z.buf[Z.pos++]|=q|((N>>>=3)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N)))))}(O,y)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(Boolean(f))},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var d=this.pos;this.pos=function(T,O,N){for(var Z,q,dt=0;dt<O.length;dt++){if((Z=O.charCodeAt(dt))>55295&&Z<57344){if(!q){Z>56319||dt+1===O.length?(T[N++]=239,T[N++]=191,T[N++]=189):q=Z;continue}if(Z<56320){T[N++]=239,T[N++]=191,T[N++]=189,q=Z;continue}Z=q-55296<<10|Z-56320|65536,q=null}else q&&(T[N++]=239,T[N++]=191,T[N++]=189,q=null);Z<128?T[N++]=Z:(Z<2048?T[N++]=Z>>6|192:(Z<65536?T[N++]=Z>>12|224:(T[N++]=Z>>18|240,T[N++]=Z>>12&63|128),T[N++]=Z>>6&63|128),T[N++]=63&Z|128)}return N}(this.buf,f,this.pos);var y=this.pos-d;y>=128&&s0(d,y,this),this.pos=d-1,this.writeVarint(y),this.pos+=y},writeFloat:function(f){this.realloc(4),pv(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),pv(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var d=f.length;this.writeVarint(d),this.realloc(d);for(var y=0;y<d;y++)this.buf[this.pos++]=f[y]},writeRawMessage:function(f,d){this.pos++;var y=this.pos;f(d,this);var T=this.pos-y;T>=128&&s0(y,T,this),this.pos=y-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,d,y){this.writeTag(f,ns.Bytes),this.writeRawMessage(d,y)},writePackedVarint:function(f,d){d.length&&this.writeMessage(f,$h,d)},writePackedSVarint:function(f,d){d.length&&this.writeMessage(f,It,d)},writePackedBoolean:function(f,d){d.length&&this.writeMessage(f,ln,d)},writePackedFloat:function(f,d){d.length&&this.writeMessage(f,Re,d)},writePackedDouble:function(f,d){d.length&&this.writeMessage(f,dr,d)},writePackedFixed32:function(f,d){d.length&&this.writeMessage(f,Ln,d)},writePackedSFixed32:function(f,d){d.length&&this.writeMessage(f,on,d)},writePackedFixed64:function(f,d){d.length&&this.writeMessage(f,En,d)},writePackedSFixed64:function(f,d){d.length&&this.writeMessage(f,jr,d)},writeBytesField:function(f,d){this.writeTag(f,ns.Bytes),this.writeBytes(d)},writeFixed32Field:function(f,d){this.writeTag(f,ns.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(f,d){this.writeTag(f,ns.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(f,d){this.writeTag(f,ns.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(f,d){this.writeTag(f,ns.Fixed64),this.writeSFixed64(d)},writeVarintField:function(f,d){this.writeTag(f,ns.Varint),this.writeVarint(d)},writeSVarintField:function(f,d){this.writeTag(f,ns.Varint),this.writeSVarint(d)},writeStringField:function(f,d){this.writeTag(f,ns.Bytes),this.writeString(d)},writeFloatField:function(f,d){this.writeTag(f,ns.Fixed32),this.writeFloat(d)},writeDoubleField:function(f,d){this.writeTag(f,ns.Fixed64),this.writeDouble(d)},writeBooleanField:function(f,d){this.writeVarintField(f,Boolean(d))}};var Zr=function(f,d){var y=d.pixelRatio,T=d.version,O=d.stretchX,N=d.stretchY,Z=d.content;this.paddedRect=f,this.pixelRatio=y,this.stretchX=O,this.stretchY=N,this.content=Z,this.version=T},mn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};mn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},mn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},mn.tlbr.get=function(){return this.tl.concat(this.br)},mn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Zr.prototype,mn);var jn=function(f,d){var y={},T={};this.haveRenderCallbacks=[];var O=[];this.addImages(f,y,O),this.addImages(d,T,O);var N=ri(O),Z=new ou({width:N.w||1,height:N.h||1});for(var q in f){var dt=f[q],Lt=y[q].paddedRect;ou.copy(dt.data,Z,{x:0,y:0},{x:Lt.x+1,y:Lt.y+1},dt.data)}for(var Gt in d){var Qt=d[Gt],me=T[Gt].paddedRect,Fe=me.x+1,nr=me.y+1,ur=Qt.data.width,Sr=Qt.data.height;ou.copy(Qt.data,Z,{x:0,y:0},{x:Fe,y:nr},Qt.data),ou.copy(Qt.data,Z,{x:0,y:Sr-1},{x:Fe,y:nr-1},{width:ur,height:1}),ou.copy(Qt.data,Z,{x:0,y:0},{x:Fe,y:nr+Sr},{width:ur,height:1}),ou.copy(Qt.data,Z,{x:ur-1,y:0},{x:Fe-1,y:nr},{width:1,height:Sr}),ou.copy(Qt.data,Z,{x:0,y:0},{x:Fe+ur,y:nr},{width:1,height:Sr})}this.image=Z,this.iconPositions=y,this.patternPositions=T};jn.prototype.addImages=function(f,d,y){for(var T in f){var O=f[T],N={x:0,y:0,w:O.data.width+2,h:O.data.height+2};y.push(N),d[T]=new Zr(N,O),O.hasRenderCallback&&this.haveRenderCallbacks.push(T)}},jn.prototype.patchUpdatedImages=function(f,d){for(var y in f.dispatchRenderCallbacks(this.haveRenderCallbacks),f.updatedImages)this.patchUpdatedImage(this.iconPositions[y],f.getImage(y),d),this.patchUpdatedImage(this.patternPositions[y],f.getImage(y),d)},jn.prototype.patchUpdatedImage=function(f,d,y){if(f&&d&&f.version!==d.version){f.version=d.version;var T=f.tl;y.update(d.data,void 0,{x:T[0],y:T[1]})}},ji("ImagePosition",Zr),ji("ImageAtlas",jn);var gi={horizontal:1,vertical:2,horizontalOnly:3},Dn=function(){this.scale=1,this.fontStack="",this.imageName=null};Dn.forText=function(f,d){var y=new Dn;return y.scale=f||1,y.fontStack=d,y},Dn.forImage=function(f){var d=new Dn;return d.imageName=f,d};var ci=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Mi(f,d,y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur){var Sr,gr=ci.fromFeature(f,O);Qt===gi.vertical&&gr.verticalizePunctuation();var Ur=dl.processBidirectionalText,tn=dl.processStyledBidirectionalText;if(Ur&&gr.sections.length===1){Sr=[];for(var un=0,yn=Ur(gr.toString(),pi(gr,Lt,N,d,T,Fe,nr));un<yn.length;un+=1){var Fn=yn[un],ii=new ci;ii.text=Fn,ii.sections=gr.sections;for(var Si=0;Si<Fn.length;Si++)ii.sectionIndex.push(0);Sr.push(ii)}}else if(tn){Sr=[];for(var sa=0,Zi=tn(gr.text,gr.sectionIndex,pi(gr,Lt,N,d,T,Fe,nr));sa<Zi.length;sa+=1){var pa=Zi[sa],Rn=new ci;Rn.text=pa[0],Rn.sectionIndex=pa[1],Rn.sections=gr.sections,Sr.push(Rn)}}else Sr=function(Ji,ho){for(var Ha=[],so=Ji.text,_i=0,No=0,Bs=ho;No<Bs.length;No+=1){var qs=Bs[No];Ha.push(Ji.substring(_i,qs)),_i=qs}return _i<so.length&&Ha.push(Ji.substring(_i,so.length)),Ha}(gr,pi(gr,Lt,N,d,T,Fe,nr));var Fi=[],aa={positionedLines:Fi,text:gr.toString(),top:Gt[1],bottom:Gt[1],left:Gt[0],right:Gt[0],writingMode:Qt,iconsInText:!1,verticalizable:!1};return function(Ji,ho,Ha,so,_i,No,Bs,qs,Cs,Ls,uu,Ns){for(var vu=0,Hu=-17,cl=0,ml=0,Fu=qs==="right"?1:qs==="left"?0:.5,fl=0,qa=0,hs=_i;qa<hs.length;qa+=1){var as=hs[qa];as.trim();var Po=as.getMaxScale(),Yl=24*(Po-1),Pl={positionedGlyphs:[],lineOffset:0};Ji.positionedLines[fl]=Pl;var Ps=Pl.positionedGlyphs,gu=0;if(as.length()){for(var tl=0;tl<as.length();tl++){var To=as.getSection(tl),oh=as.getSectionIndex(tl),yl=as.getCharCode(tl),Kh=0,mu=null,Qh=null,Ff=null,Ed=24,wd=!(Cs===gi.horizontal||!uu&&!gh(yl)||uu&&(la[yl]||(el=yl,Ti.Arabic(el)||Ti["Arabic Supplement"](el)||Ti["Arabic Extended-A"](el)||Ti["Arabic Presentation Forms-A"](el)||Ti["Arabic Presentation Forms-B"](el))));if(To.imageName){var c0=so[To.imageName];if(!c0)continue;Ff=To.imageName,Ji.iconsInText=Ji.iconsInText||!0,Qh=c0.paddedRect;var Jh=c0.displaySize;To.scale=24*To.scale/Ns,Kh=Yl+(24-Jh[1]*To.scale),Ed=(mu={width:Jh[0],height:Jh[1],left:1,top:-3,advance:wd?Jh[1]:Jh[0]}).advance;var Sd=wd?Jh[0]*To.scale-24*Po:Jh[1]*To.scale-24*Po;Sd>0&&Sd>gu&&(gu=Sd)}else{var q0=Ha[To.fontStack],sh=q0&&q0[yl];if(sh&&sh.rect)Qh=sh.rect,mu=sh.metrics;else{var gv=ho[To.fontStack],mv=gv&&gv[yl];if(!mv)continue;mu=mv.metrics}Kh=24*(Po-To.scale)}wd?(Ji.verticalizable=!0,Ps.push({glyph:yl,imageName:Ff,x:vu,y:Hu+Kh,vertical:wd,scale:To.scale,fontStack:To.fontStack,sectionIndex:oh,metrics:mu,rect:Qh}),vu+=Ed*To.scale+Ls):(Ps.push({glyph:yl,imageName:Ff,x:vu,y:Hu+Kh,vertical:wd,scale:To.scale,fontStack:To.fontStack,sectionIndex:oh,metrics:mu,rect:Qh}),vu+=mu.advance*To.scale+Ls)}Ps.length!==0&&(cl=Math.max(vu-Ls,cl),Na(Ps,0,Ps.length-1,Fu,gu)),vu=0;var Gs=No*Po+gu;Pl.lineOffset=Math.max(gu,Yl),Hu+=Gs,ml=Math.max(Gs,ml),++fl}else Hu+=No,++fl}var el,sf=Hu- -17,Cd=hi(Bs),Mh=Cd.horizontalAlign,Ad=Cd.verticalAlign;(function(zp,f0,yv,K0,Ng,Up,os,uf,Jo){var $l,_v=(f0-yv)*Ng;$l=Up!==os?-uf*K0- -17:(-K0*Jo+.5)*os;for(var Td=0,h0=zp;Td<h0.length;Td+=1)for(var Md=0,p0=h0[Td].positionedGlyphs;Md<p0.length;Md+=1){var Id=p0[Md];Id.x+=_v,Id.y+=$l}})(Ji.positionedLines,Fu,Mh,Ad,cl,ml,No,sf,_i.length),Ji.top+=-Ad*sf,Ji.bottom=Ji.top+sf,Ji.left+=-Mh*cl,Ji.right=Ji.left+cl}(aa,d,y,T,Sr,Z,q,dt,Qt,Lt,me,ur),!function(Ji){for(var ho=0,Ha=Ji;ho<Ha.length;ho+=1)if(Ha[ho].positionedGlyphs.length!==0)return!1;return!0}(Fi)&&aa}ci.fromFeature=function(f,d){for(var y=new ci,T=0;T<f.sections.length;T++){var O=f.sections[T];O.image?y.addImageSection(O):y.addTextSection(O,d)}return y},ci.prototype.length=function(){return this.text.length},ci.prototype.getSection=function(f){return this.sections[this.sectionIndex[f]]},ci.prototype.getSectionIndex=function(f){return this.sectionIndex[f]},ci.prototype.getCharCode=function(f){return this.text.charCodeAt(f)},ci.prototype.verticalizePunctuation=function(){this.text=function(f){for(var d="",y=0;y<f.length;y++){var T=f.charCodeAt(y+1)||null,O=f.charCodeAt(y-1)||null;d+=T&&rf(T)&&!Ch[f[y+1]]||O&&rf(O)&&!Ch[f[y-1]]||!Ch[f[y]]?f[y]:Ch[f[y]]}return d}(this.text)},ci.prototype.trim=function(){for(var f=0,d=0;d<this.text.length&&la[this.text.charCodeAt(d)];d++)f++;for(var y=this.text.length,T=this.text.length-1;T>=0&&T>=f&&la[this.text.charCodeAt(T)];T--)y--;this.text=this.text.substring(f,y),this.sectionIndex=this.sectionIndex.slice(f,y)},ci.prototype.substring=function(f,d){var y=new ci;return y.text=this.text.substring(f,d),y.sectionIndex=this.sectionIndex.slice(f,d),y.sections=this.sections,y},ci.prototype.toString=function(){return this.text},ci.prototype.getMaxScale=function(){var f=this;return this.sectionIndex.reduce(function(d,y){return Math.max(d,f.sections[y].scale)},0)},ci.prototype.addTextSection=function(f,d){this.text+=f.text,this.sections.push(Dn.forText(f.scale,f.fontStack||d));for(var y=this.sections.length-1,T=0;T<f.text.length;++T)this.sectionIndex.push(y)},ci.prototype.addImageSection=function(f){var d=f.image?f.image.name:"";if(d.length!==0){var y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCharCode(y),this.sections.push(Dn.forImage(d)),this.sectionIndex.push(this.sections.length-1)):ne("Reached maximum number of images 6401")}else ne("Can't add FormattedSection with an empty image.")},ci.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var la={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wn={};function In(f,d,y,T,O,N){if(d.imageName){var Z=T[d.imageName];return Z?Z.displaySize[0]*d.scale*24/N+O:0}var q=y[d.fontStack],dt=q&&q[f];return dt?dt.metrics.advance*d.scale+O:0}function Wi(f,d,y,T){var O=Math.pow(f-d,2);return T?f<d?O/2:2*O:O+Math.abs(y)*y}function bi(f,d,y){var T=0;return f===10&&(T-=1e4),y&&(T+=150),f!==40&&f!==65288||(T+=50),d!==41&&d!==65289||(T+=50),T}function Qn(f,d,y,T,O,N){for(var Z=null,q=Wi(d,y,O,N),dt=0,Lt=T;dt<Lt.length;dt+=1){var Gt=Lt[dt],Qt=Wi(d-Gt.x,y,O,N)+Gt.badness;Qt<=q&&(Z=Gt,q=Qt)}return{index:f,x:d,priorBreak:Z,badness:q}}function pi(f,d,y,T,O,N,Z){if(N!=="point")return[];if(!f)return[];for(var q,dt=[],Lt=function(Sr,gr,Ur,tn,un,yn){for(var Fn=0,ii=0;ii<Sr.length();ii++){var Si=Sr.getSection(ii);Fn+=In(Sr.getCharCode(ii),Si,tn,un,gr,yn)}return Fn/Math.max(1,Math.ceil(Fn/Ur))}(f,d,y,T,O,Z),Gt=f.text.indexOf("\u200B")>=0,Qt=0,me=0;me<f.length();me++){var Fe=f.getSection(me),nr=f.getCharCode(me);if(la[nr]||(Qt+=In(nr,Fe,T,O,d,Z)),me<f.length()-1){var ur=!((q=nr)<11904||!(Ti["Bopomofo Extended"](q)||Ti.Bopomofo(q)||Ti["CJK Compatibility Forms"](q)||Ti["CJK Compatibility Ideographs"](q)||Ti["CJK Compatibility"](q)||Ti["CJK Radicals Supplement"](q)||Ti["CJK Strokes"](q)||Ti["CJK Symbols and Punctuation"](q)||Ti["CJK Unified Ideographs Extension A"](q)||Ti["CJK Unified Ideographs"](q)||Ti["Enclosed CJK Letters and Months"](q)||Ti["Halfwidth and Fullwidth Forms"](q)||Ti.Hiragana(q)||Ti["Ideographic Description Characters"](q)||Ti["Kangxi Radicals"](q)||Ti["Katakana Phonetic Extensions"](q)||Ti.Katakana(q)||Ti["Vertical Forms"](q)||Ti["Yi Radicals"](q)||Ti["Yi Syllables"](q)));(wn[nr]||ur||Fe.imageName)&&dt.push(Qn(me+1,Qt,Lt,dt,bi(nr,f.getCharCode(me+1),ur&&Gt),!1))}}return function Sr(gr){return gr?Sr(gr.priorBreak).concat(gr.index):[]}(Qn(f.length(),Qt,Lt,dt,0,!0))}function hi(f){var d=.5,y=.5;switch(f){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":y=1;break;case"top":case"top-right":case"top-left":y=0}return{horizontalAlign:d,verticalAlign:y}}function Na(f,d,y,T,O){if(T||O)for(var N=f[y],Z=(f[y].x+N.metrics.advance*N.scale)*T,q=d;q<=y;q++)f[q].x-=Z,f[q].y+=O}function wa(f,d,y,T,O,N){var Z,q=f.image;if(q.content){var dt=q.content,Lt=q.pixelRatio||1;Z=[dt[0]/Lt,dt[1]/Lt,q.displaySize[0]-dt[2]/Lt,q.displaySize[1]-dt[3]/Lt]}var Gt,Qt,me,Fe,nr=d.left*N,ur=d.right*N;y==="width"||y==="both"?(Fe=O[0]+nr-T[3],Qt=O[0]+ur+T[1]):Qt=(Fe=O[0]+(nr+ur-q.displaySize[0])/2)+q.displaySize[0];var Sr=d.top*N,gr=d.bottom*N;return y==="height"||y==="both"?(Gt=O[1]+Sr-T[0],me=O[1]+gr+T[2]):me=(Gt=O[1]+(Sr+gr-q.displaySize[1])/2)+q.displaySize[1],{image:q,top:Gt,right:Qt,bottom:me,left:Fe,collisionPadding:Z}}wn[10]=!0,wn[32]=!0,wn[38]=!0,wn[40]=!0,wn[41]=!0,wn[43]=!0,wn[45]=!0,wn[47]=!0,wn[173]=!0,wn[183]=!0,wn[8203]=!0,wn[8208]=!0,wn[8211]=!0,wn[8231]=!0;var Ei=function(f){function d(y,T,O,N){f.call(this,y,T),this.angle=O,N!==void 0&&(this.segment=N)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(J);function Li(f,d){var y=d.expression;if(y.kind==="constant")return{kind:"constant",layoutSize:y.evaluate(new to(f+1))};if(y.kind==="source")return{kind:"source"};for(var T=y.zoomStops,O=y.interpolationType,N=0;N<T.length&&T[N]<=f;)N++;for(var Z=N=Math.max(0,N-1);Z<T.length&&T[Z]<f+1;)Z++;Z=Math.min(T.length-1,Z);var q=T[N],dt=T[Z];return y.kind==="composite"?{kind:"composite",minZoom:q,maxZoom:dt,interpolationType:O}:{kind:"camera",minZoom:q,maxZoom:dt,minSize:y.evaluate(new to(q)),maxSize:y.evaluate(new to(dt)),interpolationType:O}}function ga(f,d,y){var T=d.uSize,O=y.lowerSize;return f.kind==="source"?O/128:f.kind==="composite"?Fo(O/128,y.upperSize/128,d.uSizeT):T}function Ta(f,d){var y=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){var O=f.interpolationType,N=O?zt(Ue.interpolationFactor(O,d,f.minZoom,f.maxZoom),0,1):0;f.kind==="camera"?T=Fo(f.minSize,f.maxSize,N):y=N}return{uSizeT:y,uSize:T}}ji("Anchor",Ei);var no=Object.freeze({__proto__:null,getSizeData:Li,evaluateSizeForFeature:ga,evaluateSizeForZoom:Ta,SIZE_PACK_FACTOR:128});function ws(f,d,y,T,O){if(d.segment===void 0)return!0;for(var N=d,Z=d.segment+1,q=0;q>-y/2;){if(--Z<0)return!1;q-=f[Z].dist(N),N=f[Z]}q+=f[Z].dist(f[Z+1]),Z++;for(var dt=[],Lt=0;q<y/2;){var Gt=f[Z],Qt=f[Z+1];if(!Qt)return!1;var me=f[Z-1].angleTo(Gt)-Gt.angleTo(Qt);for(me=Math.abs((me+3*Math.PI)%(2*Math.PI)-Math.PI),dt.push({distance:q,angleDelta:me}),Lt+=me;q-dt[0].distance>T;)Lt-=dt.shift().angleDelta;if(Lt>O)return!1;Z++,q+=Gt.dist(Qt)}return!0}function Ss(f){for(var d=0,y=0;y<f.length-1;y++)d+=f[y].dist(f[y+1]);return d}function io(f,d,y){return f?.6*d*y:0}function Bo(f,d){return Math.max(f?f.right-f.left:0,d?d.right-d.left:0)}function Es(f,d,y,T,O,N){for(var Z=io(y,O,N),q=Bo(y,T)*N,dt=0,Lt=Ss(f)/2,Gt=0;Gt<f.length-1;Gt++){var Qt=f[Gt],me=f[Gt+1],Fe=Qt.dist(me);if(dt+Fe>Lt){var nr=(Lt-dt)/Fe,ur=Fo(Qt.x,me.x,nr),Sr=Fo(Qt.y,me.y,nr),gr=new Ei(ur,Sr,me.angleTo(Qt),Gt);return gr._round(),!Z||ws(f,gr,q,Z,d)?gr:void 0}dt+=Fe}}function du(f,d,y,T,O,N,Z,q,dt){var Lt=io(T,N,Z),Gt=Bo(T,O),Qt=Gt*Z,me=f[0].x===0||f[0].x===dt||f[0].y===0||f[0].y===dt;return d-Qt<d/4&&(d=Qt+d/4),function Fe(nr,ur,Sr,gr,Ur,tn,un,yn,Fn){for(var ii=tn/2,Si=Ss(nr),sa=0,Zi=ur-Sr,pa=[],Rn=0;Rn<nr.length-1;Rn++){for(var Fi=nr[Rn],aa=nr[Rn+1],Ji=Fi.dist(aa),ho=aa.angleTo(Fi);Zi+Sr<sa+Ji;){var Ha=((Zi+=Sr)-sa)/Ji,so=Fo(Fi.x,aa.x,Ha),_i=Fo(Fi.y,aa.y,Ha);if(so>=0&&so<Fn&&_i>=0&&_i<Fn&&Zi-ii>=0&&Zi+ii<=Si){var No=new Ei(so,_i,ho,Rn);No._round(),gr&&!ws(nr,No,tn,gr,Ur)||pa.push(No)}}sa+=Ji}return yn||pa.length||un||(pa=Fe(nr,sa/2,Sr,gr,Ur,tn,un,!0,Fn)),pa}(f,me?d/2*q%d:(Gt/2+2*N)*Z*q%d,d,Lt,y,Qt,me,!1,dt)}function Qo(f,d,y,T,O){for(var N=[],Z=0;Z<f.length;Z++)for(var q=f[Z],dt=void 0,Lt=0;Lt<q.length-1;Lt++){var Gt=q[Lt],Qt=q[Lt+1];Gt.x<d&&Qt.x<d||(Gt.x<d?Gt=new J(d,Gt.y+(d-Gt.x)/(Qt.x-Gt.x)*(Qt.y-Gt.y))._round():Qt.x<d&&(Qt=new J(d,Gt.y+(d-Gt.x)/(Qt.x-Gt.x)*(Qt.y-Gt.y))._round()),Gt.y<y&&Qt.y<y||(Gt.y<y?Gt=new J(Gt.x+(y-Gt.y)/(Qt.y-Gt.y)*(Qt.x-Gt.x),y)._round():Qt.y<y&&(Qt=new J(Gt.x+(y-Gt.y)/(Qt.y-Gt.y)*(Qt.x-Gt.x),y)._round()),Gt.x>=T&&Qt.x>=T||(Gt.x>=T?Gt=new J(T,Gt.y+(T-Gt.x)/(Qt.x-Gt.x)*(Qt.y-Gt.y))._round():Qt.x>=T&&(Qt=new J(T,Gt.y+(T-Gt.x)/(Qt.x-Gt.x)*(Qt.y-Gt.y))._round()),Gt.y>=O&&Qt.y>=O||(Gt.y>=O?Gt=new J(Gt.x+(O-Gt.y)/(Qt.y-Gt.y)*(Qt.x-Gt.x),O)._round():Qt.y>=O&&(Qt=new J(Gt.x+(O-Gt.y)/(Qt.y-Gt.y)*(Qt.x-Gt.x),O)._round()),dt&&Gt.equals(dt[dt.length-1])||N.push(dt=[Gt]),dt.push(Qt)))))}return N}function Lu(f,d,y,T){var O=[],N=f.image,Z=N.pixelRatio,q=N.paddedRect.w-2,dt=N.paddedRect.h-2,Lt=f.right-f.left,Gt=f.bottom-f.top,Qt=N.stretchX||[[0,q]],me=N.stretchY||[[0,dt]],Fe=function(so,_i){return so+_i[1]-_i[0]},nr=Qt.reduce(Fe,0),ur=me.reduce(Fe,0),Sr=q-nr,gr=dt-ur,Ur=0,tn=nr,un=0,yn=ur,Fn=0,ii=Sr,Si=0,sa=gr;if(N.content&&T){var Zi=N.content;Ur=Vs(Qt,0,Zi[0]),un=Vs(me,0,Zi[1]),tn=Vs(Qt,Zi[0],Zi[2]),yn=Vs(me,Zi[1],Zi[3]),Fn=Zi[0]-Ur,Si=Zi[1]-un,ii=Zi[2]-Zi[0]-tn,sa=Zi[3]-Zi[1]-yn}var pa=function(so,_i,No,Bs){var qs=ks(so.stretch-Ur,tn,Lt,f.left),Cs=Da(so.fixed-Fn,ii,so.stretch,nr),Ls=ks(_i.stretch-un,yn,Gt,f.top),uu=Da(_i.fixed-Si,sa,_i.stretch,ur),Ns=ks(No.stretch-Ur,tn,Lt,f.left),vu=Da(No.fixed-Fn,ii,No.stretch,nr),Hu=ks(Bs.stretch-un,yn,Gt,f.top),cl=Da(Bs.fixed-Si,sa,Bs.stretch,ur),ml=new J(qs,Ls),Fu=new J(Ns,Ls),fl=new J(Ns,Hu),qa=new J(qs,Hu),hs=new J(Cs/Z,uu/Z),as=new J(vu/Z,cl/Z),Po=d*Math.PI/180;if(Po){var Yl=Math.sin(Po),Pl=Math.cos(Po),Ps=[Pl,-Yl,Yl,Pl];ml._matMult(Ps),Fu._matMult(Ps),qa._matMult(Ps),fl._matMult(Ps)}var gu=so.stretch+so.fixed,tl=_i.stretch+_i.fixed;return{tl:ml,tr:Fu,bl:qa,br:fl,tex:{x:N.paddedRect.x+1+gu,y:N.paddedRect.y+1+tl,w:No.stretch+No.fixed-gu,h:Bs.stretch+Bs.fixed-tl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hs,pixelOffsetBR:as,minFontScaleX:ii/Z/Lt,minFontScaleY:sa/Z/Gt,isSDF:y}};if(T&&(N.stretchX||N.stretchY))for(var Rn=Gu(Qt,Sr,nr),Fi=Gu(me,gr,ur),aa=0;aa<Rn.length-1;aa++)for(var Ji=Rn[aa],ho=Rn[aa+1],Ha=0;Ha<Fi.length-1;Ha++)O.push(pa(Ji,Fi[Ha],ho,Fi[Ha+1]));else O.push(pa({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:q+1},{fixed:0,stretch:dt+1}));return O}function Vs(f,d,y){for(var T=0,O=0,N=f;O<N.length;O+=1){var Z=N[O];T+=Math.max(d,Math.min(y,Z[1]))-Math.max(d,Math.min(y,Z[0]))}return T}function Gu(f,d,y){for(var T=[{fixed:-1,stretch:0}],O=0,N=f;O<N.length;O+=1){var Z=N[O],q=Z[0],dt=Z[1],Lt=T[T.length-1];T.push({fixed:q-Lt.stretch,stretch:Lt.stretch}),T.push({fixed:q-Lt.stretch,stretch:Lt.stretch+(dt-q)})}return T.push({fixed:d+1,stretch:y}),T}function ks(f,d,y,T){return f/d*y+T}function Da(f,d,y,T){return f-d*y/T}var $s=function(f,d,y,T,O,N,Z,q,dt,Lt){if(this.boxStartIndex=f.length,dt){var Gt=N.top,Qt=N.bottom,me=N.collisionPadding;me&&(Gt-=me[1],Qt+=me[3]);var Fe=Qt-Gt;Fe>0&&(Fe=Math.max(10,Fe),this.circleDiameter=Fe)}else{var nr=N.top*Z-q,ur=N.bottom*Z+q,Sr=N.left*Z-q,gr=N.right*Z+q,Ur=N.collisionPadding;if(Ur&&(Sr-=Ur[0]*Z,nr-=Ur[1]*Z,gr+=Ur[2]*Z,ur+=Ur[3]*Z),Lt){var tn=new J(Sr,nr),un=new J(gr,nr),yn=new J(Sr,ur),Fn=new J(gr,ur),ii=Lt*Math.PI/180;tn._rotate(ii),un._rotate(ii),yn._rotate(ii),Fn._rotate(ii),Sr=Math.min(tn.x,un.x,yn.x,Fn.x),gr=Math.max(tn.x,un.x,yn.x,Fn.x),nr=Math.min(tn.y,un.y,yn.y,Fn.y),ur=Math.max(tn.y,un.y,yn.y,Fn.y)}f.emplaceBack(d.x,d.y,Sr,nr,gr,ur,y,T,O)}this.boxEndIndex=f.length},bo=function(f,d){if(f===void 0&&(f=[]),d===void 0&&(d=Pu),this.data=f,this.length=this.data.length,this.compare=d,this.length>0)for(var y=(this.length>>1)-1;y>=0;y--)this._down(y)};function Pu(f,d){return f<d?-1:f>d?1:0}function ha(f,d,y){d===void 0&&(d=1),y===void 0&&(y=!1);for(var T=1/0,O=1/0,N=-1/0,Z=-1/0,q=f[0],dt=0;dt<q.length;dt++){var Lt=q[dt];(!dt||Lt.x<T)&&(T=Lt.x),(!dt||Lt.y<O)&&(O=Lt.y),(!dt||Lt.x>N)&&(N=Lt.x),(!dt||Lt.y>Z)&&(Z=Lt.y)}var Gt=Math.min(N-T,Z-O),Qt=Gt/2,me=new bo([],ao);if(Gt===0)return new J(T,O);for(var Fe=T;Fe<N;Fe+=Gt)for(var nr=O;nr<Z;nr+=Gt)me.push(new wo(Fe+Qt,nr+Qt,Qt,f));for(var ur=function(Ur){for(var tn=0,un=0,yn=0,Fn=Ur[0],ii=0,Si=Fn.length,sa=Si-1;ii<Si;sa=ii++){var Zi=Fn[ii],pa=Fn[sa],Rn=Zi.x*pa.y-pa.x*Zi.y;un+=(Zi.x+pa.x)*Rn,yn+=(Zi.y+pa.y)*Rn,tn+=3*Rn}return new wo(un/tn,yn/tn,0,Ur)}(f),Sr=me.length;me.length;){var gr=me.pop();(gr.d>ur.d||!ur.d)&&(ur=gr,y&&console.log("found best %d after %d probes",Math.round(1e4*gr.d)/1e4,Sr)),gr.max-ur.d<=d||(me.push(new wo(gr.p.x-(Qt=gr.h/2),gr.p.y-Qt,Qt,f)),me.push(new wo(gr.p.x+Qt,gr.p.y-Qt,Qt,f)),me.push(new wo(gr.p.x-Qt,gr.p.y+Qt,Qt,f)),me.push(new wo(gr.p.x+Qt,gr.p.y+Qt,Qt,f)),Sr+=4)}return y&&(console.log("num probes: "+Sr),console.log("best distance: "+ur.d)),ur.p}function ao(f,d){return d.max-f.max}function wo(f,d,y,T){this.p=new J(f,d),this.h=y,this.d=function(O,N){for(var Z=!1,q=1/0,dt=0;dt<N.length;dt++)for(var Lt=N[dt],Gt=0,Qt=Lt.length,me=Qt-1;Gt<Qt;me=Gt++){var Fe=Lt[Gt],nr=Lt[me];Fe.y>O.y!=nr.y>O.y&&O.x<(nr.x-Fe.x)*(O.y-Fe.y)/(nr.y-Fe.y)+Fe.x&&(Z=!Z),q=Math.min(q,Tf(O,Fe,nr))}return(Z?1:-1)*Math.sqrt(q)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}bo.prototype.push=function(f){this.data.push(f),this.length++,this._up(this.length-1)},bo.prototype.pop=function(){if(this.length!==0){var f=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),f}},bo.prototype.peek=function(){return this.data[0]},bo.prototype._up=function(f){for(var d=this.data,y=this.compare,T=d[f];f>0;){var O=f-1>>1,N=d[O];if(y(T,N)>=0)break;d[f]=N,f=O}d[f]=T},bo.prototype._down=function(f){for(var d=this.data,y=this.compare,T=this.length>>1,O=d[f];f<T;){var N=1+(f<<1),Z=d[N],q=N+1;if(q<this.length&&y(d[q],Z)<0&&(N=q,Z=d[q]),y(Z,O)>=0)break;d[f]=Z,f=N}d[f]=O};var Ds=Number.POSITIVE_INFINITY;function Wl(f,d){return d[1]!==Ds?function(y,T,O){var N=0,Z=0;switch(T=Math.abs(T),O=Math.abs(O),y){case"top-right":case"top-left":case"top":Z=O-7;break;case"bottom-right":case"bottom-left":case"bottom":Z=7-O}switch(y){case"top-right":case"bottom-right":case"right":N=-T;break;case"top-left":case"bottom-left":case"left":N=T}return[N,Z]}(f,d[0],d[1]):function(y,T){var O=0,N=0;T<0&&(T=0);var Z=T/Math.sqrt(2);switch(y){case"top-right":case"top-left":N=Z-7;break;case"bottom-right":case"bottom-left":N=7-Z;break;case"bottom":N=7-T;break;case"top":N=T-7}switch(y){case"top-right":case"bottom-right":O=-Z;break;case"top-left":case"bottom-left":O=Z;break;case"left":O=T;break;case"right":O=-T}return[O,N]}(f,d[0])}function sr(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function fn(f,d,y,T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr){var ur=function(un,yn,Fn,ii,Si,sa,Zi,pa){for(var Rn=ii.layout.get("text-rotate").evaluate(sa,{})*Math.PI/180,Fi=[],aa=0,Ji=yn.positionedLines;aa<Ji.length;aa+=1)for(var ho=Ji[aa],Ha=0,so=ho.positionedGlyphs;Ha<so.length;Ha+=1){var _i=so[Ha];if(_i.rect){var No=_i.rect||{},Bs=4,qs=!0,Cs=1,Ls=0,uu=(Si||pa)&&_i.vertical,Ns=_i.metrics.advance*_i.scale/2;if(pa&&yn.verticalizable&&(Ls=ho.lineOffset/2-(_i.imageName?-(24-_i.metrics.width*_i.scale)/2:24*(_i.scale-1))),_i.imageName){var vu=Zi[_i.imageName];qs=vu.sdf,Bs=1/(Cs=vu.pixelRatio)}var Hu=Si?[_i.x+Ns,_i.y]:[0,0],cl=Si?[0,0]:[_i.x+Ns+Fn[0],_i.y+Fn[1]-Ls],ml=[0,0];uu&&(ml=cl,cl=[0,0]);var Fu=(_i.metrics.left-Bs)*_i.scale-Ns+cl[0],fl=(-_i.metrics.top-Bs)*_i.scale+cl[1],qa=Fu+No.w*_i.scale/Cs,hs=fl+No.h*_i.scale/Cs,as=new J(Fu,fl),Po=new J(qa,fl),Yl=new J(Fu,hs),Pl=new J(qa,hs);if(uu){var Ps=new J(-Ns,Ns- -17),gu=-Math.PI/2,tl=12-Ns,To=new J(22-tl,-(_i.imageName?tl:0)),oh=new(Function.prototype.bind.apply(J,[null].concat(ml)));as._rotateAround(gu,Ps)._add(To)._add(oh),Po._rotateAround(gu,Ps)._add(To)._add(oh),Yl._rotateAround(gu,Ps)._add(To)._add(oh),Pl._rotateAround(gu,Ps)._add(To)._add(oh)}if(Rn){var yl=Math.sin(Rn),Kh=Math.cos(Rn),mu=[Kh,-yl,yl,Kh];as._matMult(mu),Po._matMult(mu),Yl._matMult(mu),Pl._matMult(mu)}var Qh=new J(0,0),Ff=new J(0,0);Fi.push({tl:as,tr:Po,bl:Yl,br:Pl,tex:No,writingMode:yn.writingMode,glyphOffset:Hu,sectionIndex:_i.sectionIndex,isSDF:qs,pixelOffsetTL:Qh,pixelOffsetBR:Ff,minFontScaleX:0,minFontScaleY:0})}}return Fi}(0,y,q,O,N,Z,T,f.allowVerticalPlacement),Sr=f.textSizeData,gr=null;Sr.kind==="source"?(gr=[128*O.layout.get("text-size").evaluate(Z,{})])[0]>32640&&ne(f.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Sr.kind==="composite"&&((gr=[128*Fe.compositeTextSizes[0].evaluate(Z,{},nr),128*Fe.compositeTextSizes[1].evaluate(Z,{},nr)])[0]>32640||gr[1]>32640)&&ne(f.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),f.addSymbols(f.text,ur,gr,q,N,Z,Lt,d,dt.lineStartIndex,dt.lineLength,me,nr);for(var Ur=0,tn=Gt;Ur<tn.length;Ur+=1)Qt[tn[Ur]]=f.text.placedSymbolArray.length-1;return 4*ur.length}function rn(f){for(var d in f)return f[d];return null}function Gi(f,d,y,T){var O=f.compareText;if(d in O){for(var N=O[d],Z=N.length-1;Z>=0;Z--)if(T.dist(N[Z])<y)return!0}else O[d]=[];return O[d].push(T),!1}var oo=Hl.VectorTileFeature.types,tr=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Te(f,d,y,T,O,N,Z,q,dt,Lt,Gt,Qt,me){var Fe=q?Math.min(32640,Math.round(q[0])):0,nr=q?Math.min(32640,Math.round(q[1])):0;f.emplaceBack(d,y,Math.round(32*T),Math.round(32*O),N,Z,(Fe<<1)+(dt?1:0),nr,16*Lt,16*Gt,256*Qt,256*me)}function xr(f,d,y){f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y)}function kr(f){for(var d=0,y=f.sections;d<y.length;d+=1)if(xf(y[d].text))return!0;return!1}var $r=function(f){this.layoutVertexArray=new wf,this.indexArray=new Sf,this.programConfigurations=f,this.segments=new De,this.dynamicLayoutVertexArray=new ac,this.opacityVertexArray=new Lc,this.placedSymbolArray=new M};$r.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},$r.prototype.upload=function(f,d,y,T){this.isEmpty()||(y&&(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Dg.members),this.indexBuffer=f.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=f.createVertexBuffer(this.dynamicLayoutVertexArray,Bg.members,!0),this.opacityVertexBuffer=f.createVertexBuffer(this.opacityVertexArray,tr,!0),this.opacityVertexBuffer.itemSize=1),(y||T)&&this.programConfigurations.upload(f))},$r.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ji("SymbolBuffers",$r);var Ar=function(f,d,y){this.layoutVertexArray=new f,this.layoutAttributes=d,this.indexArray=new y,this.segments=new De,this.collisionVertexArray=new cd};Ar.prototype.upload=function(f){this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=f.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=f.createVertexBuffer(this.collisionVertexArray,fv.members,!0)},Ar.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ji("CollisionBuffers",Ar);var Ye=function(f){this.collisionBoxArray=f.collisionBoxArray,this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=f.index,this.pixelRatio=f.pixelRatio,this.sourceLayerIndex=f.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Gl([]),this.placementViewportMatrix=Gl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Li(this.zoom,d["text-size"]),this.iconSizeData=Li(this.zoom,d["icon-size"]);var y=this.layers[0].layout,T=y.get("symbol-sort-key"),O=y.get("symbol-z-order");this.canOverlap=y.get("text-allow-overlap")||y.get("icon-allow-overlap")||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey=O!=="viewport-y"&&T.constantOr(1)!==void 0,this.sortFeaturesByY=(O==="viewport-y"||O==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,y.get("symbol-placement")==="point"&&(this.writingModes=y.get("text-writing-mode").map(function(N){return gi[N]})),this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id}),this.sourceID=f.sourceID};Ye.prototype.createArrays=function(){this.text=new $r(new ca(this.layers,this.zoom,function(f){return/^text/.test(f)})),this.icon=new $r(new ca(this.layers,this.zoom,function(f){return/^icon/.test(f)})),this.glyphOffsetArray=new $,this.lineVertexArray=new ht,this.symbolInstances=new H},Ye.prototype.calculateGlyphDependencies=function(f,d,y,T,O){for(var N=0;N<f.length;N++)if(d[f.charCodeAt(N)]=!0,(y||T)&&O){var Z=Ch[f.charAt(N)];Z&&(d[Z.charCodeAt(0)]=!0)}},Ye.prototype.populate=function(f,d,y){var T=this.layers[0],O=T.layout,N=O.get("text-font"),Z=O.get("text-field"),q=O.get("icon-image"),dt=(Z.value.kind!=="constant"||Z.value.value instanceof Yo&&!Z.value.value.isEmpty()||Z.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),Lt=q.value.kind!=="constant"||!!q.value.value||Object.keys(q.parameters).length>0,Gt=O.get("symbol-sort-key");if(this.features=[],dt||Lt){for(var Qt=d.iconDependencies,me=d.glyphDependencies,Fe=d.availableImages,nr=new to(this.zoom),ur=0,Sr=f;ur<Sr.length;ur+=1){var gr=Sr[ur],Ur=gr.feature,tn=gr.id,un=gr.index,yn=gr.sourceLayerIndex,Fn=T._featureFilter.needGeometry,ii=bs(Ur,Fn);if(T._featureFilter.filter(nr,ii,y)){Fn||(ii.geometry=Ko(Ur));var Si=void 0;if(dt){var sa=T.getValueAndResolveTokens("text-field",ii,y,Fe),Zi=Yo.factory(sa);kr(Zi)&&(this.hasRTLText=!0),(!this.hasRTLText||ev()==="unavailable"||this.hasRTLText&&dl.isParsed())&&(Si=a0(Zi,T,ii))}var pa=void 0;if(Lt){var Rn=T.getValueAndResolveTokens("icon-image",ii,y,Fe);pa=Rn instanceof _o?Rn:_o.fromString(Rn)}if(Si||pa){var Fi=this.sortFeaturesByKey?Gt.evaluate(ii,{},y):void 0;if(this.features.push({id:tn,text:Si,icon:pa,index:un,sourceLayerIndex:yn,geometry:ii.geometry,properties:Ur.properties,type:oo[Ur.type],sortKey:Fi}),pa&&(Qt[pa.name]=!0),Si){var aa=N.evaluate(ii,{},y).join(","),Ji=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(gi.vertical)>=0;for(var ho=0,Ha=Si.sections;ho<Ha.length;ho+=1){var so=Ha[ho];if(so.image)Qt[so.image.name]=!0;else{var _i=Xf(Si.toString()),No=so.fontStack||aa,Bs=me[No]=me[No]||{};this.calculateGlyphDependencies(so.text,Bs,Ji,this.allowVerticalPlacement,_i)}}}}}}O.get("symbol-placement")==="line"&&(this.features=function(qs){var Cs={},Ls={},uu=[],Ns=0;function vu(Ps){uu.push(qs[Ps]),Ns++}function Hu(Ps,gu,tl){var To=Ls[Ps];return delete Ls[Ps],Ls[gu]=To,uu[To].geometry[0].pop(),uu[To].geometry[0]=uu[To].geometry[0].concat(tl[0]),To}function cl(Ps,gu,tl){var To=Cs[gu];return delete Cs[gu],Cs[Ps]=To,uu[To].geometry[0].shift(),uu[To].geometry[0]=tl[0].concat(uu[To].geometry[0]),To}function ml(Ps,gu,tl){var To=tl?gu[0][gu[0].length-1]:gu[0][0];return Ps+":"+To.x+":"+To.y}for(var Fu=0;Fu<qs.length;Fu++){var fl=qs[Fu],qa=fl.geometry,hs=fl.text?fl.text.toString():null;if(hs){var as=ml(hs,qa),Po=ml(hs,qa,!0);if(as in Ls&&Po in Cs&&Ls[as]!==Cs[Po]){var Yl=cl(as,Po,qa),Pl=Hu(as,Po,uu[Yl].geometry);delete Cs[as],delete Ls[Po],Ls[ml(hs,uu[Pl].geometry,!0)]=Pl,uu[Yl].geometry=null}else as in Ls?Hu(as,Po,qa):Po in Cs?cl(as,Po,qa):(vu(Fu),Cs[as]=Ns-1,Ls[Po]=Ns-1)}else vu(Fu)}return uu.filter(function(Ps){return Ps.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(qs,Cs){return qs.sortKey-Cs.sortKey})}},Ye.prototype.update=function(f,d,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(f,d,this.layers,y),this.icon.programConfigurations.updatePaintArrays(f,d,this.layers,y))},Ye.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Ye.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Ye.prototype.upload=function(f){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(f),this.iconCollisionBox.upload(f)),this.text.upload(f,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(f,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Ye.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Ye.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Ye.prototype.addToLineVertexArray=function(f,d){var y=this.lineVertexArray.length;if(f.segment!==void 0){for(var T=f.dist(d[f.segment+1]),O=f.dist(d[f.segment]),N={},Z=f.segment+1;Z<d.length;Z++)N[Z]={x:d[Z].x,y:d[Z].y,tileUnitDistanceFromAnchor:T},Z<d.length-1&&(T+=d[Z+1].dist(d[Z]));for(var q=f.segment||0;q>=0;q--)N[q]={x:d[q].x,y:d[q].y,tileUnitDistanceFromAnchor:O},q>0&&(O+=d[q-1].dist(d[q]));for(var dt=0;dt<d.length;dt++){var Lt=N[dt];this.lineVertexArray.emplaceBack(Lt.x,Lt.y,Lt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:y,lineLength:this.lineVertexArray.length-y}},Ye.prototype.addSymbols=function(f,d,y,T,O,N,Z,q,dt,Lt,Gt,Qt){for(var me=f.indexArray,Fe=f.layoutVertexArray,nr=f.segments.prepareSegment(4*d.length,Fe,me,this.canOverlap?N.sortKey:void 0),ur=this.glyphOffsetArray.length,Sr=nr.vertexLength,gr=this.allowVerticalPlacement&&Z===gi.vertical?Math.PI/2:0,Ur=N.text&&N.text.sections,tn=0;tn<d.length;tn++){var un=d[tn],yn=un.tl,Fn=un.tr,ii=un.bl,Si=un.br,sa=un.tex,Zi=un.pixelOffsetTL,pa=un.pixelOffsetBR,Rn=un.minFontScaleX,Fi=un.minFontScaleY,aa=un.glyphOffset,Ji=un.isSDF,ho=un.sectionIndex,Ha=nr.vertexLength,so=aa[1];Te(Fe,q.x,q.y,yn.x,so+yn.y,sa.x,sa.y,y,Ji,Zi.x,Zi.y,Rn,Fi),Te(Fe,q.x,q.y,Fn.x,so+Fn.y,sa.x+sa.w,sa.y,y,Ji,pa.x,Zi.y,Rn,Fi),Te(Fe,q.x,q.y,ii.x,so+ii.y,sa.x,sa.y+sa.h,y,Ji,Zi.x,pa.y,Rn,Fi),Te(Fe,q.x,q.y,Si.x,so+Si.y,sa.x+sa.w,sa.y+sa.h,y,Ji,pa.x,pa.y,Rn,Fi),xr(f.dynamicLayoutVertexArray,q,gr),me.emplaceBack(Ha,Ha+1,Ha+2),me.emplaceBack(Ha+1,Ha+2,Ha+3),nr.vertexLength+=4,nr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(aa[0]),tn!==d.length-1&&ho===d[tn+1].sectionIndex||f.programConfigurations.populatePaintArrays(Fe.length,N,N.index,{},Qt,Ur&&Ur[ho])}f.placedSymbolArray.emplaceBack(q.x,q.y,ur,this.glyphOffsetArray.length-ur,Sr,dt,Lt,q.segment,y?y[0]:0,y?y[1]:0,T[0],T[1],Z,0,!1,0,Gt)},Ye.prototype._addCollisionDebugVertex=function(f,d,y,T,O,N){return d.emplaceBack(0,0),f.emplaceBack(y.x,y.y,T,O,Math.round(N.x),Math.round(N.y))},Ye.prototype.addCollisionDebugVertices=function(f,d,y,T,O,N,Z){var q=O.segments.prepareSegment(4,O.layoutVertexArray,O.indexArray),dt=q.vertexLength,Lt=O.layoutVertexArray,Gt=O.collisionVertexArray,Qt=Z.anchorX,me=Z.anchorY;this._addCollisionDebugVertex(Lt,Gt,N,Qt,me,new J(f,d)),this._addCollisionDebugVertex(Lt,Gt,N,Qt,me,new J(y,d)),this._addCollisionDebugVertex(Lt,Gt,N,Qt,me,new J(y,T)),this._addCollisionDebugVertex(Lt,Gt,N,Qt,me,new J(f,T)),q.vertexLength+=4;var Fe=O.indexArray;Fe.emplaceBack(dt,dt+1),Fe.emplaceBack(dt+1,dt+2),Fe.emplaceBack(dt+2,dt+3),Fe.emplaceBack(dt+3,dt),q.primitiveLength+=4},Ye.prototype.addDebugCollisionBoxes=function(f,d,y,T){for(var O=f;O<d;O++){var N=this.collisionBoxArray.get(O);this.addCollisionDebugVertices(N.x1,N.y1,N.x2,N.y2,T?this.textCollisionBox:this.iconCollisionBox,N.anchorPoint,y)}},Ye.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ar(mh,hv.members,Hh),this.iconCollisionBox=new Ar(mh,hv.members,Hh);for(var f=0;f<this.symbolInstances.length;f++){var d=this.symbolInstances.get(f);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},Ye.prototype._deserializeCollisionBoxesForSymbol=function(f,d,y,T,O,N,Z,q,dt){for(var Lt={},Gt=d;Gt<y;Gt++){var Qt=f.get(Gt);Lt.textBox={x1:Qt.x1,y1:Qt.y1,x2:Qt.x2,y2:Qt.y2,anchorPointX:Qt.anchorPointX,anchorPointY:Qt.anchorPointY},Lt.textFeatureIndex=Qt.featureIndex;break}for(var me=T;me<O;me++){var Fe=f.get(me);Lt.verticalTextBox={x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,anchorPointX:Fe.anchorPointX,anchorPointY:Fe.anchorPointY},Lt.verticalTextFeatureIndex=Fe.featureIndex;break}for(var nr=N;nr<Z;nr++){var ur=f.get(nr);Lt.iconBox={x1:ur.x1,y1:ur.y1,x2:ur.x2,y2:ur.y2,anchorPointX:ur.anchorPointX,anchorPointY:ur.anchorPointY},Lt.iconFeatureIndex=ur.featureIndex;break}for(var Sr=q;Sr<dt;Sr++){var gr=f.get(Sr);Lt.verticalIconBox={x1:gr.x1,y1:gr.y1,x2:gr.x2,y2:gr.y2,anchorPointX:gr.anchorPointX,anchorPointY:gr.anchorPointY},Lt.verticalIconFeatureIndex=gr.featureIndex;break}return Lt},Ye.prototype.deserializeCollisionBoxes=function(f){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var y=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(f,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}},Ye.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ye.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ye.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Ye.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Ye.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Ye.prototype.addIndicesForPlacedSymbol=function(f,d){for(var y=f.placedSymbolArray.get(d),T=y.vertexStartIndex+4*y.numGlyphs,O=y.vertexStartIndex;O<T;O+=4)f.indexArray.emplaceBack(O,O+1,O+2),f.indexArray.emplaceBack(O+1,O+2,O+3)},Ye.prototype.getSortedSymbolIndexes=function(f){if(this.sortedAngle===f&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(f),y=Math.cos(f),T=[],O=[],N=[],Z=0;Z<this.symbolInstances.length;++Z){N.push(Z);var q=this.symbolInstances.get(Z);T.push(0|Math.round(d*q.anchorX+y*q.anchorY)),O.push(q.featureIndex)}return N.sort(function(dt,Lt){return T[dt]-T[Lt]||O[Lt]-O[dt]}),N},Ye.prototype.addToSortKeyRanges=function(f,d){var y=this.sortKeyRanges[this.sortKeyRanges.length-1];y&&y.sortKey===d?y.symbolInstanceEnd=f+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:f,symbolInstanceEnd:f+1})},Ye.prototype.sortFeatures=function(f){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==f&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(f),this.sortedAngle=f,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var y=0,T=this.symbolInstanceIndexes;y<T.length;y+=1){var O=this.symbolInstances.get(T[y]);this.featureSortOrder.push(O.featureIndex),[O.rightJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.leftJustifiedTextSymbolIndex].forEach(function(N,Z,q){N>=0&&q.indexOf(N)===Z&&d.addIndicesForPlacedSymbol(d.text,N)}),O.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,O.verticalPlacedTextSymbolIndex),O.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.placedIconSymbolIndex),O.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ji("SymbolBucket",Ye,{omit:["layers","collisionBoxArray","features","compareText"]}),Ye.MAX_GLYPHS=65535,Ye.addDynamicAttributes=xr;var Rr=new Vu({"symbol-placement":new Qi(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new Qi(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Qi(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ki(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Qi(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Qi(Ce.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Qi(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new Qi(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Qi(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new ki(Ce.layout_symbol["icon-size"]),"icon-text-fit":new Qi(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qi(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new ki(Ce.layout_symbol["icon-image"]),"icon-rotate":new ki(Ce.layout_symbol["icon-rotate"]),"icon-padding":new Qi(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new Qi(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new ki(Ce.layout_symbol["icon-offset"]),"icon-anchor":new ki(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Qi(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Qi(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Qi(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new ki(Ce.layout_symbol["text-field"]),"text-font":new ki(Ce.layout_symbol["text-font"]),"text-size":new ki(Ce.layout_symbol["text-size"]),"text-max-width":new ki(Ce.layout_symbol["text-max-width"]),"text-line-height":new Qi(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new ki(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new ki(Ce.layout_symbol["text-justify"]),"text-radial-offset":new ki(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Qi(Ce.layout_symbol["text-variable-anchor"]),"text-anchor":new ki(Ce.layout_symbol["text-anchor"]),"text-max-angle":new Qi(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new Qi(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new ki(Ce.layout_symbol["text-rotate"]),"text-padding":new Qi(Ce.layout_symbol["text-padding"]),"text-keep-upright":new Qi(Ce.layout_symbol["text-keep-upright"]),"text-transform":new ki(Ce.layout_symbol["text-transform"]),"text-offset":new ki(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new Qi(Ce.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Qi(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new Qi(Ce.layout_symbol["text-optional"])}),je={paint:new Vu({"icon-opacity":new ki(Ce.paint_symbol["icon-opacity"]),"icon-color":new ki(Ce.paint_symbol["icon-color"]),"icon-halo-color":new ki(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new ki(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ki(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new Qi(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new Qi(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new ki(Ce.paint_symbol["text-opacity"]),"text-color":new ki(Ce.paint_symbol["text-color"],{runtimeType:fi,getOverride:function(f){return f.textColor},hasOverride:function(f){return!!f.textColor}}),"text-halo-color":new ki(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new ki(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new ki(Ce.paint_symbol["text-halo-blur"]),"text-translate":new Qi(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new Qi(Ce.paint_symbol["text-translate-anchor"])}),layout:Rr},mr=function(f){this.type=f.property.overrides?f.property.overrides.runtimeType:Ci,this.defaultValue=f};mr.prototype.evaluate=function(f){if(f.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(f.formattedSection))return d.getOverride(f.formattedSection)}return f.feature&&f.featureState?this.defaultValue.evaluate(f.feature,f.featureState):this.defaultValue.property.specification.default},mr.prototype.eachChild=function(f){this.defaultValue.isConstant()||f(this.defaultValue.value._styleExpression.expression)},mr.prototype.outputDefined=function(){return!1},mr.prototype.serialize=function(){return null},ji("FormatSectionOverride",mr,{omit:["defaultValue"]});var rr=function(f){function d(y){f.call(this,y,je)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.recalculate=function(y,T){if(f.prototype.recalculate.call(this,y,T),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var O=this.layout.get("text-writing-mode");if(O){for(var N=[],Z=0,q=O;Z<q.length;Z+=1){var dt=q[Z];N.indexOf(dt)<0&&N.push(dt)}this.layout._values["text-writing-mode"]=N}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(y,T,O,N){var Z=this.layout.get(y).evaluate(T,{},O,N),q=this._unevaluatedLayout._values[y];return q.isDataDriven()||qc(q.value)||!Z?Z:function(dt,Lt){return Lt.replace(/{([^{}]+)}/g,function(Gt,Qt){return Qt in dt?String(dt[Qt]):""})}(T.properties,Z)},d.prototype.createBucket=function(y){return new Ye(y)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var y=0,T=je.paint.overridableProperties;y<T.length;y+=1){var O=T[y];if(d.hasPaintOverride(this.layout,O)){var N,Z=this.paint.get(O),q=new mr(Z),dt=new Uf(q,Z.property.specification);N=Z.value.kind==="constant"||Z.value.kind==="source"?new Kc("source",dt):new Vf("composite",dt,Z.value.zoomStops,Z.value._interpolationType),this.paint._values[O]=new fu(Z.property,N,Z.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(y,T,O){return!(!this.layout||T.isDataDriven()||O.isDataDriven())&&d.hasPaintOverride(this.layout,y)},d.hasPaintOverride=function(y,T){var O=y.get("text-field"),N=je.paint.properties[T],Z=!1,q=function(Gt){for(var Qt=0,me=Gt;Qt<me.length;Qt+=1)if(N.overrides&&N.overrides.hasOverride(me[Qt]))return void(Z=!0)};if(O.value.kind==="constant"&&O.value.value instanceof Yo)q(O.value.value.sections);else if(O.value.kind==="source"){var dt=function(Gt){Z||(Gt instanceof en&&He(Gt.value)===po?q(Gt.value.sections):Gt instanceof qi?q(Gt.sections):Gt.eachChild(dt))},Lt=O.value;Lt._styleExpression&&dt(Lt._styleExpression.expression)}return Z},d}(gc),Mr={paint:new Vu({"background-color":new Qi(Ce.paint_background["background-color"]),"background-pattern":new Ju(Ce.paint_background["background-pattern"]),"background-opacity":new Qi(Ce.paint_background["background-opacity"])})},qr=function(f){function d(y){f.call(this,y,Mr)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(gc),Bn={paint:new Vu({"raster-opacity":new Qi(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new Qi(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Qi(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Qi(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new Qi(Ce.paint_raster["raster-saturation"]),"raster-contrast":new Qi(Ce.paint_raster["raster-contrast"]),"raster-resampling":new Qi(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new Qi(Ce.paint_raster["raster-fade-duration"])})},ti=function(f){function d(y){f.call(this,y,Bn)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(gc),li=function(f){function d(y){f.call(this,y,{}),this.implementation=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(y){this.implementation.onAdd&&this.implementation.onAdd(y,y.painter.context.gl)},d.prototype.onRemove=function(y){this.implementation.onRemove&&this.implementation.onRemove(y,y.painter.context.gl)},d}(gc),wi={circle:fd,heatmap:_c,hillshade:rv,fill:Op,"fill-extrusion":jl,line:cv,symbol:rr,background:qr,raster:ti},di=et.HTMLImageElement,Ni=et.HTMLCanvasElement,Oi=et.HTMLVideoElement,zi=et.ImageData,Ui=et.ImageBitmap,Hi=function(f,d,y,T){this.context=f,this.format=y,this.texture=f.gl.createTexture(),this.update(d,T)};Hi.prototype.update=function(f,d,y){var T=f.width,O=f.height,N=!(this.size&&this.size[0]===T&&this.size[1]===O||y),Z=this.context,q=Z.gl;if(this.useMipmap=Boolean(d&&d.useMipmap),q.bindTexture(q.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===q.RGBA&&(!d||d.premultiply!==!1)),N)this.size=[T,O],f instanceof di||f instanceof Ni||f instanceof Oi||f instanceof zi||Ui&&f instanceof Ui?q.texImage2D(q.TEXTURE_2D,0,this.format,this.format,q.UNSIGNED_BYTE,f):q.texImage2D(q.TEXTURE_2D,0,this.format,T,O,0,this.format,q.UNSIGNED_BYTE,f.data);else{var dt=y||{x:0,y:0},Lt=dt.x,Gt=dt.y;f instanceof di||f instanceof Ni||f instanceof Oi||f instanceof zi||Ui&&f instanceof Ui?q.texSubImage2D(q.TEXTURE_2D,0,Lt,Gt,q.RGBA,q.UNSIGNED_BYTE,f):q.texSubImage2D(q.TEXTURE_2D,0,Lt,Gt,T,O,q.RGBA,q.UNSIGNED_BYTE,f.data)}this.useMipmap&&this.isSizePowerOfTwo()&&q.generateMipmap(q.TEXTURE_2D)},Hi.prototype.bind=function(f,d,y){var T=this.context.gl;T.bindTexture(T.TEXTURE_2D,this.texture),y!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=T.LINEAR),f!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,f),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,y||f),this.filter=f),d!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,d),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,d),this.wrap=d)},Hi.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Hi.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ba=function(f){var d=this;this._callback=f,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};ba.prototype.trigger=function(){var f=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){f._triggered=!1,f._callback()},0))},ba.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Xo=function(f,d,y){this.target=f,this.parent=d,this.mapId=y,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Tt(["receive","process"],this),this.invoker=new ba(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ot()?f:et};function Ou(f,d,y){var T=2*Math.PI*6378137/256/Math.pow(2,y);return[f*T-2*Math.PI*6378137/2,d*T-2*Math.PI*6378137/2]}Xo.prototype.send=function(f,d,y,T,O){var N=this;O===void 0&&(O=!1);var Z=Math.round(1e18*Math.random()).toString(36).substring(0,10);y&&(this.callbacks[Z]=y);var q=wt(this.globalScope)?void 0:[];return this.target.postMessage({id:Z,type:f,hasCallback:!!y,targetMapId:T,mustQueue:O,sourceMapId:this.mapId,data:vc(d,q)},q),{cancel:function(){y&&delete N.callbacks[Z],N.target.postMessage({id:Z,type:"<cancel>",targetMapId:T,sourceMapId:N.mapId})}}},Xo.prototype.receive=function(f){var d=f.data,y=d.id;if(y&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[y];var T=this.cancelCallbacks[y];delete this.cancelCallbacks[y],T&&T()}else Ot()||d.mustQueue?(this.tasks[y]=d,this.taskQueue.push(y),this.invoker.trigger()):this.processTask(y,d)},Xo.prototype.process=function(){if(this.taskQueue.length){var f=this.taskQueue.shift(),d=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(f,d)}},Xo.prototype.processTask=function(f,d){var y=this;if(d.type==="<response>"){var T=this.callbacks[f];delete this.callbacks[f],T&&(d.error?T(Zu(d.error)):T(null,Zu(d.data)))}else{var O=!1,N=wt(this.globalScope)?void 0:[],Z=d.hasCallback?function(Gt,Qt){O=!0,delete y.cancelCallbacks[f],y.target.postMessage({id:f,type:"<response>",sourceMapId:y.mapId,error:Gt?vc(Gt):null,data:vc(Qt,N)},N)}:function(Gt){O=!0},q=null,dt=Zu(d.data);if(this.parent[d.type])q=this.parent[d.type](d.sourceMapId,dt,Z);else if(this.parent.getWorkerSource){var Lt=d.type.split(".");q=this.parent.getWorkerSource(d.sourceMapId,Lt[0],dt.source)[Lt[1]](dt,Z)}else Z(new Error("Could not find function "+d.type));!O&&q&&q.cancel&&(this.cancelCallbacks[f]=q.cancel)}},Xo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var fs=function(f,d){f&&(d?this.setSouthWest(f).setNorthEast(d):f.length===4?this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]]):this.setSouthWest(f[0]).setNorthEast(f[1]))};fs.prototype.setNorthEast=function(f){return this._ne=f instanceof Lo?new Lo(f.lng,f.lat):Lo.convert(f),this},fs.prototype.setSouthWest=function(f){return this._sw=f instanceof Lo?new Lo(f.lng,f.lat):Lo.convert(f),this},fs.prototype.extend=function(f){var d,y,T=this._sw,O=this._ne;if(f instanceof Lo)d=f,y=f;else{if(!(f instanceof fs))return Array.isArray(f)?f.length===4||f.every(Array.isArray)?this.extend(fs.convert(f)):this.extend(Lo.convert(f)):this;if(y=f._ne,!(d=f._sw)||!y)return this}return T||O?(T.lng=Math.min(d.lng,T.lng),T.lat=Math.min(d.lat,T.lat),O.lng=Math.max(y.lng,O.lng),O.lat=Math.max(y.lat,O.lat)):(this._sw=new Lo(d.lng,d.lat),this._ne=new Lo(y.lng,y.lat)),this},fs.prototype.getCenter=function(){return new Lo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},fs.prototype.getSouthWest=function(){return this._sw},fs.prototype.getNorthEast=function(){return this._ne},fs.prototype.getNorthWest=function(){return new Lo(this.getWest(),this.getNorth())},fs.prototype.getSouthEast=function(){return new Lo(this.getEast(),this.getSouth())},fs.prototype.getWest=function(){return this._sw.lng},fs.prototype.getSouth=function(){return this._sw.lat},fs.prototype.getEast=function(){return this._ne.lng},fs.prototype.getNorth=function(){return this._ne.lat},fs.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},fs.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},fs.prototype.isEmpty=function(){return!(this._sw&&this._ne)},fs.prototype.contains=function(f){var d=Lo.convert(f),y=d.lng,T=d.lat,O=this._sw.lng<=y&&y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=y&&y>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&O},fs.convert=function(f){return!f||f instanceof fs?f:new fs(f)};var Lo=function(f,d){if(isNaN(f)||isNaN(d))throw new Error("Invalid LngLat object: ("+f+", "+d+")");if(this.lng=+f,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Lo.prototype.wrap=function(){return new Lo(P(this.lng,-180,180),this.lat)},Lo.prototype.toArray=function(){return[this.lng,this.lat]},Lo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Lo.prototype.distanceTo=function(f){var d=Math.PI/180,y=this.lat*d,T=f.lat*d,O=Math.sin(y)*Math.sin(T)+Math.cos(y)*Math.cos(T)*Math.cos((f.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(O,1))},Lo.prototype.toBounds=function(f){f===void 0&&(f=0);var d=360*f/40075017,y=d/Math.cos(Math.PI/180*this.lat);return new fs(new Lo(this.lng-y,this.lat-d),new Lo(this.lng+y,this.lat+d))},Lo.convert=function(f){if(f instanceof Lo)return f;if(Array.isArray(f)&&(f.length===2||f.length===3))return new Lo(Number(f[0]),Number(f[1]));if(!Array.isArray(f)&&typeof f=="object"&&f!==null)return new Lo(Number("lng"in f?f.lng:f.lon),Number(f.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Of=2*Math.PI*63710088e-1;function ll(f){return Of*Math.cos(f*Math.PI/180)}function Dc(f){return(180+f)/360}function Ec(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function vv(f,d){return f/ll(d)}function Xl(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}var ih=function(f,d,y){y===void 0&&(y=0),this.x=+f,this.y=+d,this.z=+y};ih.fromLngLat=function(f,d){d===void 0&&(d=0);var y=Lo.convert(f);return new ih(Dc(y.lng),Ec(y.lat),vv(d,y.lat))},ih.prototype.toLngLat=function(){return new Lo(360*this.x-180,Xl(this.y))},ih.prototype.toAltitude=function(){return this.z*ll(Xl(this.y))},ih.prototype.meterInMercatorCoordinateUnits=function(){return 1/Of*(f=Xl(this.y),1/Math.cos(f*Math.PI/180));var f};var Dp=function(f,d,y){this.z=f,this.x=d,this.y=y,this.key=l0(0,f,f,d,y)};Dp.prototype.equals=function(f){return this.z===f.z&&this.x===f.x&&this.y===f.y},Dp.prototype.url=function(f,d){var y,T,O,N,Z,q=(T=this.y,O=this.z,N=Ou(256*(y=this.x),256*(T=Math.pow(2,O)-T-1),O),Z=Ou(256*(y+1),256*(T+1),O),N[0]+","+N[1]+","+Z[0]+","+Z[1]),dt=function(Lt,Gt,Qt){for(var me,Fe="",nr=Lt;nr>0;nr--)Fe+=(Gt&(me=1<<nr-1)?1:0)+(Qt&me?2:0);return Fe}(this.z,this.x,this.y);return f[(this.x+this.y)%f.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",dt).replace("{bbox-epsg-3857}",q)},Dp.prototype.getTilePoint=function(f){var d=Math.pow(2,this.z);return new J(8192*(f.x*d-this.x),8192*(f.y*d-this.y))},Dp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var u0=function(f,d){this.wrap=f,this.canonical=d,this.key=l0(f,d.z,d.z,d.x,d.y)},su=function(f,d,y,T,O){this.overscaledZ=f,this.wrap=d,this.canonical=new Dp(y,+T,+O),this.key=l0(d,f,y,T,O)};function l0(f,d,y,T,O){(f*=2)<0&&(f=-1*f-1);var N=1<<y;return(N*N*f+N*O+T).toString(36)+y.toString(36)+d.toString(36)}su.prototype.equals=function(f){return this.overscaledZ===f.overscaledZ&&this.wrap===f.wrap&&this.canonical.equals(f.canonical)},su.prototype.scaledTo=function(f){var d=this.canonical.z-f;return f>this.canonical.z?new su(f,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new su(f,this.wrap,f,this.canonical.x>>d,this.canonical.y>>d)},su.prototype.calculateScaledKey=function(f,d){var y=this.canonical.z-f;return f>this.canonical.z?l0(this.wrap*+d,f,this.canonical.z,this.canonical.x,this.canonical.y):l0(this.wrap*+d,f,f,this.canonical.x>>y,this.canonical.y>>y)},su.prototype.isChildOf=function(f){if(f.wrap!==this.wrap)return!1;var d=this.canonical.z-f.canonical.z;return f.overscaledZ===0||f.overscaledZ<this.overscaledZ&&f.canonical.x===this.canonical.x>>d&&f.canonical.y===this.canonical.y>>d},su.prototype.children=function(f){if(this.overscaledZ>=f)return[new su(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,y=2*this.canonical.x,T=2*this.canonical.y;return[new su(d,this.wrap,d,y,T),new su(d,this.wrap,d,y+1,T),new su(d,this.wrap,d,y,T+1),new su(d,this.wrap,d,y+1,T+1)]},su.prototype.isLessThan=function(f){return this.wrap<f.wrap||!(this.wrap>f.wrap)&&(this.overscaledZ<f.overscaledZ||!(this.overscaledZ>f.overscaledZ)&&(this.canonical.x<f.canonical.x||!(this.canonical.x>f.canonical.x)&&this.canonical.y<f.canonical.y))},su.prototype.wrapped=function(){return new su(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},su.prototype.unwrapTo=function(f){return new su(this.overscaledZ,f,this.canonical.z,this.canonical.x,this.canonical.y)},su.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},su.prototype.toUnwrapped=function(){return new u0(this.wrap,this.canonical)},su.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},su.prototype.getTilePoint=function(f){return this.canonical.getTilePoint(new ih(f.x-this.wrap,f.y))},ji("CanonicalTileID",Dp),ji("OverscaledTileID",su,{omit:["posMatrix"]});var ah=function(f,d,y){if(this.uid=f,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(y&&y!=="mapbox"&&y!=="terrarium")return ne('"'+y+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var T=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=y||"mapbox";for(var O=0;O<T;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(T,O)]=this.data[this._idx(T-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,T)]=this.data[this._idx(O,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)]};ah.prototype.get=function(f,d){var y=new Uint8Array(this.data.buffer),T=4*this._idx(f,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(y[T],y[T+1],y[T+2])},ah.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ah.prototype._idx=function(f,d){if(f<-1||f>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(f+1)},ah.prototype._unpackMapbox=function(f,d,y){return(256*f*256+256*d+y)/10-1e4},ah.prototype._unpackTerrarium=function(f,d,y){return 256*f+d+y/256-32768},ah.prototype.getPixels=function(){return new ou({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ah.prototype.backfillBorder=function(f,d,y){if(this.dim!==f.dim)throw new Error("dem dimension mismatch");var T=d*this.dim,O=d*this.dim+this.dim,N=y*this.dim,Z=y*this.dim+this.dim;switch(d){case-1:T=O-1;break;case 1:O=T+1}switch(y){case-1:N=Z-1;break;case 1:Z=N+1}for(var q=-d*this.dim,dt=-y*this.dim,Lt=N;Lt<Z;Lt++)for(var Gt=T;Gt<O;Gt++)this.data[this._idx(Gt,Lt)]=f.data[this._idx(Gt+q,Lt+dt)]},ji("DEMData",ah);var Bp=function(f){this._stringToNumber={},this._numberToString=[];for(var d=0;d<f.length;d++){var y=f[d];this._stringToNumber[y]=d,this._numberToString[d]=y}};Bp.prototype.encode=function(f){return this._stringToNumber[f]},Bp.prototype.decode=function(f){return this._numberToString[f]};var Th=function(f,d,y,T,O){this.type="Feature",this._vectorTileFeature=f,f._z=d,f._x=y,f._y=T,this.properties=f.properties,this.id=O},py={geometry:{configurable:!0}};py.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},py.geometry.set=function(f){this._geometry=f},Th.prototype.toJSON=function(){var f={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(f[d]=this[d]);return f},Object.defineProperties(Th.prototype,py);var bd=function(){this.state={},this.stateChanges={},this.deletedStates={}};bd.prototype.updateState=function(f,d,y){var T=String(d);if(this.stateChanges[f]=this.stateChanges[f]||{},this.stateChanges[f][T]=this.stateChanges[f][T]||{},b(this.stateChanges[f][T],y),this.deletedStates[f]===null)for(var O in this.deletedStates[f]={},this.state[f])O!==T&&(this.deletedStates[f][O]=null);else if(this.deletedStates[f]&&this.deletedStates[f][T]===null)for(var N in this.deletedStates[f][T]={},this.state[f][T])y[N]||(this.deletedStates[f][T][N]=null);else for(var Z in y)this.deletedStates[f]&&this.deletedStates[f][T]&&this.deletedStates[f][T][Z]===null&&delete this.deletedStates[f][T][Z]},bd.prototype.removeFeatureState=function(f,d,y){if(this.deletedStates[f]!==null){var T=String(d);if(this.deletedStates[f]=this.deletedStates[f]||{},y&&d!==void 0)this.deletedStates[f][T]!==null&&(this.deletedStates[f][T]=this.deletedStates[f][T]||{},this.deletedStates[f][T][y]=null);else if(d!==void 0)if(this.stateChanges[f]&&this.stateChanges[f][T])for(y in this.deletedStates[f][T]={},this.stateChanges[f][T])this.deletedStates[f][T][y]=null;else this.deletedStates[f][T]=null;else this.deletedStates[f]=null}},bd.prototype.getState=function(f,d){var y=String(d),T=b({},(this.state[f]||{})[y],(this.stateChanges[f]||{})[y]);if(this.deletedStates[f]===null)return{};if(this.deletedStates[f]){var O=this.deletedStates[f][d];if(O===null)return{};for(var N in O)delete T[N]}return T},bd.prototype.initializeTileState=function(f,d){f.setFeatureState(this.state,d)},bd.prototype.coalesceChanges=function(f,d){var y={};for(var T in this.stateChanges){this.state[T]=this.state[T]||{};var O={};for(var N in this.stateChanges[T])this.state[T][N]||(this.state[T][N]={}),b(this.state[T][N],this.stateChanges[T][N]),O[N]=this.state[T][N];y[T]=O}for(var Z in this.deletedStates){this.state[Z]=this.state[Z]||{};var q={};if(this.deletedStates[Z]===null)for(var dt in this.state[Z])q[dt]={},this.state[Z][dt]={};else for(var Lt in this.deletedStates[Z]){if(this.deletedStates[Z][Lt]===null)this.state[Z][Lt]={};else for(var Gt=0,Qt=Object.keys(this.deletedStates[Z][Lt]);Gt<Qt.length;Gt+=1)delete this.state[Z][Lt][Qt[Gt]];q[Lt]=this.state[Z][Lt]}y[Z]=y[Z]||{},b(y[Z],q)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(var me in f)f[me].setFeatureState(y,d)};var qh=function(f,d){this.tileID=f,this.x=f.canonical.x,this.y=f.canonical.y,this.z=f.canonical.z,this.grid=new _f(8192,16,0),this.grid3D=new _f(8192,16,0),this.featureIndexArray=new ie,this.promoteId=d};function dy(f,d,y,T,O){return Dt(f,function(N,Z){var q=d instanceof Sl?d.get(Z):null;return q&&q.evaluate?q.evaluate(y,T,O):q})}function vy(f){for(var d=1/0,y=1/0,T=-1/0,O=-1/0,N=0,Z=f;N<Z.length;N+=1){var q=Z[N];d=Math.min(d,q.x),y=Math.min(y,q.y),T=Math.max(T,q.x),O=Math.max(O,q.y)}return{minX:d,minY:y,maxX:T,maxY:O}}function d_(f,d){return d-f}qh.prototype.insert=function(f,d,y,T,O,N){var Z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(y,T,O);for(var q=N?this.grid3D:this.grid,dt=0;dt<d.length;dt++){for(var Lt=d[dt],Gt=[1/0,1/0,-1/0,-1/0],Qt=0;Qt<Lt.length;Qt++){var me=Lt[Qt];Gt[0]=Math.min(Gt[0],me.x),Gt[1]=Math.min(Gt[1],me.y),Gt[2]=Math.max(Gt[2],me.x),Gt[3]=Math.max(Gt[3],me.y)}Gt[0]<8192&&Gt[1]<8192&&Gt[2]>=0&&Gt[3]>=0&&q.insert(Z,Gt[0],Gt[1],Gt[2],Gt[3])}},qh.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Hl.VectorTile(new Ah(this.rawTileData)).layers,this.sourceLayerCoder=new Bp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},qh.prototype.query=function(f,d,y,T){var O=this;this.loadVTLayers();for(var N=f.params||{},Z=8192/f.tileSize/f.scale,q=Sp(N.filter),dt=f.queryGeometry,Lt=f.queryPadding*Z,Gt=vy(dt),Qt=this.grid.query(Gt.minX-Lt,Gt.minY-Lt,Gt.maxX+Lt,Gt.maxY+Lt),me=vy(f.cameraQueryGeometry),Fe=this.grid3D.query(me.minX-Lt,me.minY-Lt,me.maxX+Lt,me.maxY+Lt,function(un,yn,Fn,ii){return function(Si,sa,Zi,pa,Rn){for(var Fi=0,aa=Si;Fi<aa.length;Fi+=1){var Ji=aa[Fi];if(sa<=Ji.x&&Zi<=Ji.y&&pa>=Ji.x&&Rn>=Ji.y)return!0}var ho=[new J(sa,Zi),new J(sa,Rn),new J(pa,Rn),new J(pa,Zi)];if(Si.length>2){for(var Ha=0,so=ho;Ha<so.length;Ha+=1)if(sc(Si,so[Ha]))return!0}for(var _i=0;_i<Si.length-1;_i++)if(Jf(Si[_i],Si[_i+1],ho))return!0;return!1}(f.cameraQueryGeometry,un-Lt,yn-Lt,Fn+Lt,ii+Lt)}),nr=0,ur=Fe;nr<ur.length;nr+=1)Qt.push(ur[nr]);Qt.sort(d_);for(var Sr,gr={},Ur=function(un){var yn=Qt[un];if(yn!==Sr){Sr=yn;var Fn=O.featureIndexArray.get(yn),ii=null;O.loadMatchingFeature(gr,Fn.bucketIndex,Fn.sourceLayerIndex,Fn.featureIndex,q,N.layers,N.availableImages,d,y,T,function(Si,sa,Zi){return ii||(ii=Ko(Si)),sa.queryIntersectsFeature(dt,Si,Zi,ii,O.z,f.transform,Z,f.pixelPosMatrix)})}},tn=0;tn<Qt.length;tn++)Ur(tn);return gr},qh.prototype.loadMatchingFeature=function(f,d,y,T,O,N,Z,q,dt,Lt,Gt){var Qt=this.bucketLayerIDs[d];if(!N||function(Si,sa){for(var Zi=0;Zi<Si.length;Zi++)if(sa.indexOf(Si[Zi])>=0)return!0;return!1}(N,Qt)){var me=this.sourceLayerCoder.decode(y),Fe=this.vtLayers[me].feature(T);if(O.needGeometry){var nr=bs(Fe,!0);if(!O.filter(new to(this.tileID.overscaledZ),nr,this.tileID.canonical))return}else if(!O.filter(new to(this.tileID.overscaledZ),Fe))return;for(var ur=this.getId(Fe,me),Sr=0;Sr<Qt.length;Sr++){var gr=Qt[Sr];if(!(N&&N.indexOf(gr)<0)){var Ur=q[gr];if(Ur){var tn={};ur!==void 0&&Lt&&(tn=Lt.getState(Ur.sourceLayer||"_geojsonTileLayer",ur));var un=b({},dt[gr]);un.paint=dy(un.paint,Ur.paint,Fe,tn,Z),un.layout=dy(un.layout,Ur.layout,Fe,tn,Z);var yn=!Gt||Gt(Fe,Ur,tn);if(yn){var Fn=new Th(Fe,this.z,this.x,this.y,ur);Fn.layer=un;var ii=f[gr];ii===void 0&&(ii=f[gr]=[]),ii.push({featureIndex:T,feature:Fn,intersectionZ:yn})}}}}}},qh.prototype.lookupSymbolFeatures=function(f,d,y,T,O,N,Z,q){var dt={};this.loadVTLayers();for(var Lt=Sp(O),Gt=0,Qt=f;Gt<Qt.length;Gt+=1)this.loadMatchingFeature(dt,y,T,Qt[Gt],Lt,N,Z,q,d);return dt},qh.prototype.hasLayer=function(f){for(var d=0,y=this.bucketLayerIDs;d<y.length;d+=1)for(var T=0,O=y[d];T<O.length;T+=1)if(f===O[T])return!0;return!1},qh.prototype.getId=function(f,d){var y=f.id;return this.promoteId&&typeof(y=f.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(y=Number(y)),y},ji("FeatureIndex",qh,{omit:["rawTileData","sourceLayerCoder"]});var fo=function(f,d){this.tileID=f,this.uid=le(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};fo.prototype.registerFadeDuration=function(f){var d=f+this.timeAdded;d<ye.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},fo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},fo.prototype.loadVectorData=function(f,d,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",f){for(var T in f.featureIndex&&(this.latestFeatureIndex=f.featureIndex,f.rawTileData?(this.latestRawTileData=f.rawTileData,this.latestFeatureIndex.rawTileData=f.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=f.collisionBoxArray,this.buckets=function(Lt,Gt){var Qt={};if(!Gt)return Qt;for(var me=function(){var ur=nr[Fe],Sr=ur.layerIds.map(function(tn){return Gt.getLayer(tn)}).filter(Boolean);if(Sr.length!==0){ur.layers=Sr,ur.stateDependentLayerIds&&(ur.stateDependentLayers=ur.stateDependentLayerIds.map(function(tn){return Sr.filter(function(un){return un.id===tn})[0]}));for(var gr=0,Ur=Sr;gr<Ur.length;gr+=1)Qt[Ur[gr].id]=ur}},Fe=0,nr=Lt;Fe<nr.length;Fe+=1)me();return Qt}(f.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var O=this.buckets[T];if(O instanceof Ye){if(this.hasSymbolBuckets=!0,!y)break;O.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var N in this.buckets){var Z=this.buckets[N];if(Z instanceof Ye&&Z.hasRTLText){this.hasRTLText=!0,dl.isLoading()||dl.isLoaded()||ev()!=="deferred"||nc();break}}for(var q in this.queryPadding=0,this.buckets){var dt=this.buckets[q];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(q).queryRadius(dt))}f.imageAtlas&&(this.imageAtlas=f.imageAtlas),f.glyphAtlasImage&&(this.glyphAtlasImage=f.glyphAtlasImage)}else this.collisionBoxArray=new C},fo.prototype.unloadVectorData=function(){for(var f in this.buckets)this.buckets[f].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},fo.prototype.getBucket=function(f){return this.buckets[f.id]},fo.prototype.upload=function(f){for(var d in this.buckets){var y=this.buckets[d];y.uploadPending()&&y.upload(f)}var T=f.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Hi(f,this.imageAtlas.image,T.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Hi(f,this.glyphAtlasImage,T.ALPHA),this.glyphAtlasImage=null)},fo.prototype.prepare=function(f){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(f,this.imageAtlasTexture)},fo.prototype.queryRenderedFeatures=function(f,d,y,T,O,N,Z,q,dt,Lt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:T,cameraQueryGeometry:O,scale:N,tileSize:this.tileSize,pixelPosMatrix:Lt,transform:q,params:Z,queryPadding:this.queryPadding*dt},f,d,y):{}},fo.prototype.querySourceFeatures=function(f,d){var y=this.latestFeatureIndex;if(y&&y.rawTileData){var T=y.loadVTLayers(),O=d?d.sourceLayer:"",N=T._geojsonTileLayer||T[O];if(N)for(var Z=Sp(d&&d.filter),q=this.tileID.canonical,dt=q.z,Lt=q.x,Gt=q.y,Qt={z:dt,x:Lt,y:Gt},me=0;me<N.length;me++){var Fe=N.feature(me);if(Z.needGeometry){var nr=bs(Fe,!0);if(!Z.filter(new to(this.tileID.overscaledZ),nr,this.tileID.canonical))continue}else if(!Z.filter(new to(this.tileID.overscaledZ),Fe))continue;var ur=y.getId(Fe,O),Sr=new Th(Fe,dt,Lt,Gt,ur);Sr.tile=Qt,f.push(Sr)}}},fo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},fo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},fo.prototype.setExpiryData=function(f){var d=this.expirationTime;if(f.cacheControl){var y=te(f.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else f.expires&&(this.expirationTime=new Date(f.expires).getTime());if(this.expirationTime){var T=Date.now(),O=!1;if(this.expirationTime>T)O=!1;else if(d)if(this.expirationTime<d)O=!0;else{var N=this.expirationTime-d;N?this.expirationTime=T+Math.max(N,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},fo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},fo.prototype.setFeatureState=function(f,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(f).length!==0){var y=this.latestFeatureIndex.loadVTLayers();for(var T in this.buckets)if(d.style.hasLayer(T)){var O=this.buckets[T],N=O.layers[0].sourceLayer||"_geojsonTileLayer",Z=y[N],q=f[N];if(Z&&q&&Object.keys(q).length!==0){O.update(q,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});var dt=d&&d.style&&d.style.getLayer(T);dt&&(this.queryPadding=Math.max(this.queryPadding,dt.queryRadius(O)))}}}},fo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},fo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ye.now()},fo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},fo.prototype.setHoldDuration=function(f){this.symbolFadeHoldUntil=ye.now()+f},fo.prototype.setDependencies=function(f,d){for(var y={},T=0,O=d;T<O.length;T+=1)y[O[T]]=!0;this.dependencies[f]=y},fo.prototype.hasDependency=function(f,d){for(var y=0,T=f;y<T.length;y+=1){var O=this.dependencies[T[y]];if(O){for(var N=0,Z=d;N<Z.length;N+=1)if(O[Z[N]])return!0}}return!1};var Np=et.performance,gy=function(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},Np.mark(this._marks.start)};gy.prototype.finish=function(){Np.mark(this._marks.end);var f=Np.getEntriesByName(this._marks.measure);return f.length===0&&(Np.measure(this._marks.measure,this._marks.start,this._marks.end),f=Np.getEntriesByName(this._marks.measure),Np.clearMarks(this._marks.start),Np.clearMarks(this._marks.end),Np.clearMeasures(this._marks.measure)),f},k.Actor=Xo,k.AlphaImage=Ll,k.CanonicalTileID=Dp,k.CollisionBoxArray=C,k.Color=Xa,k.DEMData=ah,k.DataConstantProperty=Qi,k.DictionaryCoder=Bp,k.EXTENT=8192,k.ErrorEvent=cr,k.EvaluationParameters=to,k.Event=Ge,k.Evented=br,k.FeatureIndex=qh,k.FillBucket=gl,k.FillExtrusionBucket=Lf,k.ImageAtlas=jn,k.ImagePosition=Zr,k.LineBucket=ko,k.LngLat=Lo,k.LngLatBounds=fs,k.MercatorCoordinate=ih,k.ONE_EM=24,k.OverscaledTileID=su,k.Point=J,k.Point$1=J,k.Properties=Vu,k.Protobuf=Ah,k.RGBAImage=ou,k.RequestManager=Wt,k.RequestPerformance=gy,k.ResourceType=Gr,k.SegmentVector=De,k.SourceFeatureState=bd,k.StructArrayLayout1ui2=Ip,k.StructArrayLayout2f1f2i16=qf,k.StructArrayLayout2i4=$f,k.StructArrayLayout3ui6=Sf,k.StructArrayLayout4i8=Cl,k.SymbolBucket=Ye,k.Texture=Hi,k.Tile=fo,k.Transitionable=Xs,k.Uniform1f=ui,k.Uniform1i=Un,k.Uniform2f=oi,k.Uniform3f=Ri,k.Uniform4f=Di,k.UniformColor=ia,k.UniformMatrix4f=co,k.UnwrappedTileID=u0,k.ValidationError=ar,k.WritingMode=gi,k.ZoomHistory=sd,k.add=function(f,d,y){return f[0]=d[0]+y[0],f[1]=d[1]+y[1],f[2]=d[2]+y[2],f},k.addDynamicAttributes=xr,k.asyncAll=function(f,d,y){if(!f.length)return y(null,[]);var T=f.length,O=new Array(f.length),N=null;f.forEach(function(Z,q){d(Z,function(dt,Lt){dt&&(N=dt),O[q]=Lt,--T==0&&y(N,O)})})},k.bezier=ot,k.bindAll=Tt,k.browser=ye,k.cacheEntryPossiblyAdded=function(f){++Nr>We&&(f.getActor().send("enforceCacheSizeLimit",Ie),Nr=0)},k.clamp=zt,k.clearTileCache=function(f){var d=et.caches.delete("mapbox-tiles");f&&d.catch(f).then(function(){return f()})},k.clipLine=Qo,k.clone=function(f){var d=new Eo(16);return d[0]=f[0],d[1]=f[1],d[2]=f[2],d[3]=f[3],d[4]=f[4],d[5]=f[5],d[6]=f[6],d[7]=f[7],d[8]=f[8],d[9]=f[9],d[10]=f[10],d[11]=f[11],d[12]=f[12],d[13]=f[13],d[14]=f[14],d[15]=f[15],d},k.clone$1=_e,k.clone$2=function(f){var d=new Eo(3);return d[0]=f[0],d[1]=f[1],d[2]=f[2],d},k.collisionCircleLayout=i0,k.config=Yt,k.create=function(){var f=new Eo(16);return Eo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},k.create$1=function(){var f=new Eo(9);return Eo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f},k.create$2=function(){var f=new Eo(4);return Eo!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f},k.createCommonjsModule=Et,k.createExpression=Zf,k.createLayout=rs,k.createStyleLayer=function(f){return f.type==="custom"?new li(f):new wi[f.type](f)},k.cross=function(f,d,y){var T=d[0],O=d[1],N=d[2],Z=y[0],q=y[1],dt=y[2];return f[0]=O*dt-N*q,f[1]=N*Z-T*dt,f[2]=T*q-O*Z,f},k.deepEqual=function f(d,y){if(Array.isArray(d)){if(!Array.isArray(y)||d.length!==y.length)return!1;for(var T=0;T<d.length;T++)if(!f(d[T],y[T]))return!1;return!0}if(typeof d=="object"&&d!==null&&y!==null){if(typeof y!="object"||Object.keys(d).length!==Object.keys(y).length)return!1;for(var O in d)if(!f(d[O],y[O]))return!1;return!0}return d===y},k.dot=function(f,d){return f[0]*d[0]+f[1]*d[1]+f[2]*d[2]},k.dot$1=function(f,d){return f[0]*d[0]+f[1]*d[1]+f[2]*d[2]+f[3]*d[3]},k.ease=ut,k.emitValidationErrors=ef,k.endsWith=rt,k.enforceCacheSizeLimit=function(f){Ke(),At&&At.then(function(d){d.keys().then(function(y){for(var T=0;T<y.length-f;T++)d.delete(y[T])})})},k.evaluateSizeForFeature=ga,k.evaluateSizeForZoom=Ta,k.evaluateVariableOffset=Wl,k.evented=bf,k.extend=b,k.featureFilter=Sp,k.filterObject=Se,k.fromRotation=function(f,d){var y=Math.sin(d),T=Math.cos(d);return f[0]=T,f[1]=y,f[2]=0,f[3]=-y,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},k.getAnchorAlignment=hi,k.getAnchorJustification=sr,k.getArrayBuffer=An,k.getImage=Xt,k.getJSON=function(f,d){return Hn(b(f,{type:"json"}),d)},k.getRTLTextPluginStatus=ev,k.getReferrer=nn,k.getVideo=function(f,d){var y,T,O=et.document.createElement("video");O.muted=!0,O.onloadstart=function(){d(null,O)};for(var N=0;N<f.length;N++){var Z=et.document.createElement("source");y=f[N],T=void 0,(T=et.document.createElement("a")).href=y,(T.protocol!==et.document.location.protocol||T.host!==et.document.location.host)&&(O.crossOrigin="Anonymous"),Z.src=f[N],O.appendChild(Z)}return{cancel:function(){}}},k.identity=Gl,k.invert=function(f,d){var y=d[0],T=d[1],O=d[2],N=d[3],Z=d[4],q=d[5],dt=d[6],Lt=d[7],Gt=d[8],Qt=d[9],me=d[10],Fe=d[11],nr=d[12],ur=d[13],Sr=d[14],gr=d[15],Ur=y*q-T*Z,tn=y*dt-O*Z,un=y*Lt-N*Z,yn=T*dt-O*q,Fn=T*Lt-N*q,ii=O*Lt-N*dt,Si=Gt*ur-Qt*nr,sa=Gt*Sr-me*nr,Zi=Gt*gr-Fe*nr,pa=Qt*Sr-me*ur,Rn=Qt*gr-Fe*ur,Fi=me*gr-Fe*Sr,aa=Ur*Fi-tn*Rn+un*pa+yn*Zi-Fn*sa+ii*Si;return aa?(f[0]=(q*Fi-dt*Rn+Lt*pa)*(aa=1/aa),f[1]=(O*Rn-T*Fi-N*pa)*aa,f[2]=(ur*ii-Sr*Fn+gr*yn)*aa,f[3]=(me*Fn-Qt*ii-Fe*yn)*aa,f[4]=(dt*Zi-Z*Fi-Lt*sa)*aa,f[5]=(y*Fi-O*Zi+N*sa)*aa,f[6]=(Sr*un-nr*ii-gr*tn)*aa,f[7]=(Gt*ii-me*un+Fe*tn)*aa,f[8]=(Z*Rn-q*Zi+Lt*Si)*aa,f[9]=(T*Zi-y*Rn-N*Si)*aa,f[10]=(nr*Fn-ur*un+gr*Ur)*aa,f[11]=(Qt*un-Gt*Fn-Fe*Ur)*aa,f[12]=(q*sa-Z*pa-dt*Si)*aa,f[13]=(y*pa-T*sa+O*Si)*aa,f[14]=(ur*tn-nr*yn-Sr*Ur)*aa,f[15]=(Gt*yn-Qt*tn+me*Ur)*aa,f):null},k.isChar=Ti,k.isMapboxURL=$t,k.keysDifference=function(f,d){var y=[];for(var T in f)T in d||y.push(T);return y},k.makeRequest=Hn,k.mapObject=Dt,k.mercatorXfromLng=Dc,k.mercatorYfromLat=Ec,k.mercatorZfromAltitude=vv,k.mul=th,k.multiply=al,k.mvt=Hl,k.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},k.normalize=function(f,d){var y=d[0],T=d[1],O=d[2],N=y*y+T*T+O*O;return N>0&&(N=1/Math.sqrt(N)),f[0]=d[0]*N,f[1]=d[1]*N,f[2]=d[2]*N,f},k.number=Fo,k.offscreenCanvasSupported=Pr,k.ortho=function(f,d,y,T,O,N,Z){var q=1/(d-y),dt=1/(T-O),Lt=1/(N-Z);return f[0]=-2*q,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*dt,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*Lt,f[11]=0,f[12]=(d+y)*q,f[13]=(O+T)*dt,f[14]=(Z+N)*Lt,f[15]=1,f},k.parseGlyphPBF=function(f){return new Ah(f).readFields(Jn,[])},k.pbf=Ah,k.performSymbolLayout=function(f,d,y,T,O,N,Z){f.createArrays(),f.tilePixelRatio=8192/(512*f.overscaling),f.compareText={},f.iconsNeedLinear=!1;var q=f.layers[0].layout,dt=f.layers[0]._unevaluatedLayout._values,Lt={};if(f.textSizeData.kind==="composite"){var Gt=f.textSizeData,Qt=Gt.maxZoom;Lt.compositeTextSizes=[dt["text-size"].possiblyEvaluate(new to(Gt.minZoom),Z),dt["text-size"].possiblyEvaluate(new to(Qt),Z)]}if(f.iconSizeData.kind==="composite"){var me=f.iconSizeData,Fe=me.maxZoom;Lt.compositeIconSizes=[dt["icon-size"].possiblyEvaluate(new to(me.minZoom),Z),dt["icon-size"].possiblyEvaluate(new to(Fe),Z)]}Lt.layoutTextSize=dt["text-size"].possiblyEvaluate(new to(f.zoom+1),Z),Lt.layoutIconSize=dt["icon-size"].possiblyEvaluate(new to(f.zoom+1),Z),Lt.textMaxSize=dt["text-size"].possiblyEvaluate(new to(18));for(var nr=24*q.get("text-line-height"),ur=q.get("text-rotation-alignment")==="map"&&q.get("symbol-placement")!=="point",Sr=q.get("text-keep-upright"),gr=q.get("text-size"),Ur=function(){var yn=un[tn],Fn=q.get("text-font").evaluate(yn,{},Z).join(","),ii=gr.evaluate(yn,{},Z),Si=Lt.layoutTextSize.evaluate(yn,{},Z),sa=Lt.layoutIconSize.evaluate(yn,{},Z),Zi={horizontal:{},vertical:void 0},pa=yn.text,Rn=[0,0];if(pa){var Fi=pa.toString(),aa=24*q.get("text-letter-spacing").evaluate(yn,{},Z),Ji=function(qa){for(var hs=0,as=qa;hs<as.length;hs+=1)if(Po=as[hs].charCodeAt(0),Ti.Arabic(Po)||Ti["Arabic Supplement"](Po)||Ti["Arabic Extended-A"](Po)||Ti["Arabic Presentation Forms-A"](Po)||Ti["Arabic Presentation Forms-B"](Po))return!1;var Po;return!0}(Fi)?aa:0,ho=q.get("text-anchor").evaluate(yn,{},Z),Ha=q.get("text-variable-anchor");if(!Ha){var so=q.get("text-radial-offset").evaluate(yn,{},Z);Rn=so?Wl(ho,[24*so,Ds]):q.get("text-offset").evaluate(yn,{},Z).map(function(qa){return 24*qa})}var _i=ur?"center":q.get("text-justify").evaluate(yn,{},Z),No=q.get("symbol-placement"),Bs=No==="point"?24*q.get("text-max-width").evaluate(yn,{},Z):0,qs=function(){f.allowVerticalPlacement&&Xf(Fi)&&(Zi.vertical=Mi(pa,d,y,O,Fn,Bs,nr,ho,"left",Ji,Rn,gi.vertical,!0,No,Si,ii))};if(!ur&&Ha){for(var Cs=_i==="auto"?Ha.map(function(qa){return sr(qa)}):[_i],Ls=!1,uu=0;uu<Cs.length;uu++){var Ns=Cs[uu];if(!Zi.horizontal[Ns])if(Ls)Zi.horizontal[Ns]=Zi.horizontal[0];else{var vu=Mi(pa,d,y,O,Fn,Bs,nr,"center",Ns,Ji,Rn,gi.horizontal,!1,No,Si,ii);vu&&(Zi.horizontal[Ns]=vu,Ls=vu.positionedLines.length===1)}}qs()}else{_i==="auto"&&(_i=sr(ho));var Hu=Mi(pa,d,y,O,Fn,Bs,nr,ho,_i,Ji,Rn,gi.horizontal,!1,No,Si,ii);Hu&&(Zi.horizontal[_i]=Hu),qs(),Xf(Fi)&&ur&&Sr&&(Zi.vertical=Mi(pa,d,y,O,Fn,Bs,nr,ho,_i,Ji,Rn,gi.vertical,!1,No,Si,ii))}}var cl=void 0,ml=!1;if(yn.icon&&yn.icon.name){var Fu=T[yn.icon.name];Fu&&(cl=function(qa,hs,as){var Po=hi(as),Yl=hs[0]-qa.displaySize[0]*Po.horizontalAlign,Pl=hs[1]-qa.displaySize[1]*Po.verticalAlign;return{image:qa,top:Pl,bottom:Pl+qa.displaySize[1],left:Yl,right:Yl+qa.displaySize[0]}}(O[yn.icon.name],q.get("icon-offset").evaluate(yn,{},Z),q.get("icon-anchor").evaluate(yn,{},Z)),ml=Fu.sdf,f.sdfIcons===void 0?f.sdfIcons=Fu.sdf:f.sdfIcons!==Fu.sdf&&ne("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Fu.pixelRatio!==f.pixelRatio||q.get("icon-rotate").constantOr(1)!==0)&&(f.iconsNeedLinear=!0))}var fl=rn(Zi.horizontal)||Zi.vertical;f.iconsInText=!!fl&&fl.iconsInText,(fl||cl)&&function(qa,hs,as,Po,Yl,Pl,Ps,gu,tl,To,oh){var yl=Pl.textMaxSize.evaluate(hs,{});yl===void 0&&(yl=Ps);var Kh,mu=qa.layers[0].layout,Qh=mu.get("icon-offset").evaluate(hs,{},oh),Ff=rn(as.horizontal),Ed=Ps/24,wd=qa.tilePixelRatio*Ed,c0=qa.tilePixelRatio*yl/24,Jh=qa.tilePixelRatio*gu,Sd=qa.tilePixelRatio*mu.get("symbol-spacing"),q0=mu.get("text-padding")*qa.tilePixelRatio,sh=mu.get("icon-padding")*qa.tilePixelRatio,gv=mu.get("text-max-angle")/180*Math.PI,mv=mu.get("text-rotation-alignment")==="map"&&mu.get("symbol-placement")!=="point",Gs=mu.get("icon-rotation-alignment")==="map"&&mu.get("symbol-placement")!=="point",el=mu.get("symbol-placement"),sf=Sd/2,Cd=mu.get("icon-text-fit");Po&&Cd!=="none"&&(qa.allowVerticalPlacement&&as.vertical&&(Kh=wa(Po,as.vertical,Cd,mu.get("icon-text-fit-padding"),Qh,Ed)),Ff&&(Po=wa(Po,Ff,Cd,mu.get("icon-text-fit-padding"),Qh,Ed)));var Mh=function(yy,bv){bv.x<0||bv.x>=8192||bv.y<0||bv.y>=8192||function(Hs,lf,_y,ep,rp,Ug,d0,Bc,kd,Ld,Pd,Od,Fd,v0,np,J0,Ev,ip,g0,tg,wc,Ih,eg,kh,Zg){var ql,ap,wv,Rd,Dd,Sv=Hs.addToLineVertexArray(lf,_y),Cv=0,Vg=0,Gg=0,m0=0,y0=-1,Nc=-1,op={},xy=er(""),Zp=0,_0=0;if(Bc._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Zp=(ql=Bc.layout.get("text-offset").evaluate(wc,{},kh).map(function(Tv){return 24*Tv}))[0],_0=ql[1]):(Zp=24*Bc.layout.get("text-radial-offset").evaluate(wc,{},kh),_0=Ds),Hs.allowVerticalPlacement&&ep.vertical){var rg=Bc.layout.get("text-rotate").evaluate(wc,{},kh)+90;Rd=new $s(kd,lf,Ld,Pd,Od,ep.vertical,Fd,v0,np,rg),d0&&(Dd=new $s(kd,lf,Ld,Pd,Od,d0,Ev,ip,np,rg))}if(rp){var Bd=Bc.layout.get("icon-rotate").evaluate(wc,{}),x0=Bc.layout.get("icon-text-fit")!=="none",ng=Lu(rp,Bd,eg,x0),hl=d0?Lu(d0,Bd,eg,x0):void 0;wv=new $s(kd,lf,Ld,Pd,Od,rp,Ev,ip,!1,Bd),Cv=4*ng.length;var Rf=Hs.iconSizeData,sp=null;Rf.kind==="source"?(sp=[128*Bc.layout.get("icon-size").evaluate(wc,{})])[0]>32640&&ne(Hs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Rf.kind==="composite"&&((sp=[128*Ih.compositeIconSizes[0].evaluate(wc,{},kh),128*Ih.compositeIconSizes[1].evaluate(wc,{},kh)])[0]>32640||sp[1]>32640)&&ne(Hs.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Hs.addSymbols(Hs.icon,ng,sp,tg,g0,wc,!1,lf,Sv.lineStartIndex,Sv.lineLength,-1,kh),y0=Hs.icon.placedSymbolArray.length-1,hl&&(Vg=4*hl.length,Hs.addSymbols(Hs.icon,hl,sp,tg,g0,wc,gi.vertical,lf,Sv.lineStartIndex,Sv.lineLength,-1,kh),Nc=Hs.icon.placedSymbolArray.length-1)}for(var Sc in ep.horizontal){var Av=ep.horizontal[Sc];if(!ap){xy=er(Av.text);var Hg=Bc.layout.get("text-rotate").evaluate(wc,{},kh);ap=new $s(kd,lf,Ld,Pd,Od,Av,Fd,v0,np,Hg)}var up=Av.positionedLines.length===1;if(Gg+=fn(Hs,lf,Av,Ug,Bc,np,wc,J0,Sv,ep.vertical?gi.horizontal:gi.horizontalOnly,up?Object.keys(ep.horizontal):[Sc],op,y0,Ih,kh),up)break}ep.vertical&&(m0+=fn(Hs,lf,ep.vertical,Ug,Bc,np,wc,J0,Sv,gi.vertical,["vertical"],op,Nc,Ih,kh));var by=ap?ap.boxStartIndex:Hs.collisionBoxArray.length,v_=ap?ap.boxEndIndex:Hs.collisionBoxArray.length,jg=Rd?Rd.boxStartIndex:Hs.collisionBoxArray.length,Ey=Rd?Rd.boxEndIndex:Hs.collisionBoxArray.length,Wg=wv?wv.boxStartIndex:Hs.collisionBoxArray.length,lp=wv?wv.boxEndIndex:Hs.collisionBoxArray.length,g_=Dd?Dd.boxStartIndex:Hs.collisionBoxArray.length,m_=Dd?Dd.boxEndIndex:Hs.collisionBoxArray.length,Lh=-1,b0=function(Tv,wy){return Tv&&Tv.circleDiameter?Math.max(Tv.circleDiameter,wy):wy};Lh=b0(ap,Lh),Lh=b0(Rd,Lh),Lh=b0(wv,Lh);var E0=(Lh=b0(Dd,Lh))>-1?1:0;E0&&(Lh*=Zg/24),Hs.glyphOffsetArray.length>=Ye.MAX_GLYPHS&&ne("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),wc.sortKey!==void 0&&Hs.addToSortKeyRanges(Hs.symbolInstances.length,wc.sortKey),Hs.symbolInstances.emplaceBack(lf.x,lf.y,op.right>=0?op.right:-1,op.center>=0?op.center:-1,op.left>=0?op.left:-1,op.vertical||-1,y0,Nc,xy,by,v_,jg,Ey,Wg,lp,g_,m_,Ld,Gg,m0,Cv,Vg,E0,0,Fd,Zp,_0,Lh)}(qa,bv,yy,as,Po,Yl,Kh,qa.layers[0],qa.collisionBoxArray,hs.index,hs.sourceLayerIndex,qa.index,wd,q0,mv,tl,Jh,sh,Gs,Qh,hs,Pl,To,oh,Ps)};if(el==="line")for(var Ad=0,zp=Qo(hs.geometry,0,0,8192,8192);Ad<zp.length;Ad+=1)for(var f0=zp[Ad],yv=0,K0=du(f0,Sd,gv,as.vertical||Ff,Po,24,c0,qa.overscaling,8192);yv<K0.length;yv+=1){var Ng=K0[yv];Ff&&Gi(qa,Ff.text,sf,Ng)||Mh(f0,Ng)}else if(el==="line-center")for(var Up=0,os=hs.geometry;Up<os.length;Up+=1){var uf=os[Up];if(uf.length>1){var Jo=Es(uf,gv,as.vertical||Ff,Po,24,c0);Jo&&Mh(uf,Jo)}}else if(hs.type==="Polygon")for(var $l=0,_v=md(hs.geometry,0);$l<_v.length;$l+=1){var Td=_v[$l],h0=ha(Td,16);Mh(Td[0],new Ei(h0.x,h0.y,0))}else if(hs.type==="LineString")for(var Md=0,p0=hs.geometry;Md<p0.length;Md+=1){var Id=p0[Md];Mh(Id,new Ei(Id[0].x,Id[0].y,0))}else if(hs.type==="Point")for(var tp=0,xv=hs.geometry;tp<xv.length;tp+=1)for(var zg=0,se=xv[tp];zg<se.length;zg+=1){var Q0=se[zg];Mh([Q0],new Ei(Q0.x,Q0.y,0))}}(f,yn,Zi,cl,T,Lt,Si,sa,Rn,ml,Z)},tn=0,un=f.features;tn<un.length;tn+=1)Ur();N&&f.generateCollisionDebugBuffers()},k.perspective=function(f,d,y,T,O){var N,Z=1/Math.tan(d/2);return f[0]=Z/y,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,O!=null&&O!==1/0?(f[10]=(O+T)*(N=1/(T-O)),f[14]=2*O*T*N):(f[10]=-1,f[14]=-2*T),f},k.pick=function(f,d){for(var y={},T=0;T<d.length;T++){var O=d[T];O in f&&(y[O]=f[O])}return y},k.plugin=dl,k.polygonIntersectsPolygon=mc,k.postMapLoadEvent=jt,k.postTurnstileEvent=Ht,k.potpack=ri,k.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],k.register=ji,k.registerForPluginStateChange=function(f){return f({pluginStatus:eu,pluginURL:nl}),bf.on("pluginStateChange",f),f},k.renderColorRamp=_h,k.rotate=function(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3],q=Math.sin(y),dt=Math.cos(y);return f[0]=T*dt+N*q,f[1]=O*dt+Z*q,f[2]=T*-q+N*dt,f[3]=O*-q+Z*dt,f},k.rotateX=function(f,d,y){var T=Math.sin(y),O=Math.cos(y),N=d[4],Z=d[5],q=d[6],dt=d[7],Lt=d[8],Gt=d[9],Qt=d[10],me=d[11];return d!==f&&(f[0]=d[0],f[1]=d[1],f[2]=d[2],f[3]=d[3],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]),f[4]=N*O+Lt*T,f[5]=Z*O+Gt*T,f[6]=q*O+Qt*T,f[7]=dt*O+me*T,f[8]=Lt*O-N*T,f[9]=Gt*O-Z*T,f[10]=Qt*O-q*T,f[11]=me*O-dt*T,f},k.rotateZ=function(f,d,y){var T=Math.sin(y),O=Math.cos(y),N=d[0],Z=d[1],q=d[2],dt=d[3],Lt=d[4],Gt=d[5],Qt=d[6],me=d[7];return d!==f&&(f[8]=d[8],f[9]=d[9],f[10]=d[10],f[11]=d[11],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]),f[0]=N*O+Lt*T,f[1]=Z*O+Gt*T,f[2]=q*O+Qt*T,f[3]=dt*O+me*T,f[4]=Lt*O-N*T,f[5]=Gt*O-Z*T,f[6]=Qt*O-q*T,f[7]=me*O-dt*T,f},k.scale=function(f,d,y){var T=y[0],O=y[1],N=y[2];return f[0]=d[0]*T,f[1]=d[1]*T,f[2]=d[2]*T,f[3]=d[3]*T,f[4]=d[4]*O,f[5]=d[5]*O,f[6]=d[6]*O,f[7]=d[7]*O,f[8]=d[8]*N,f[9]=d[9]*N,f[10]=d[10]*N,f[11]=d[11]*N,f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15],f},k.scale$1=function(f,d,y){return f[0]=d[0]*y,f[1]=d[1]*y,f[2]=d[2]*y,f[3]=d[3]*y,f},k.scale$2=function(f,d,y){return f[0]=d[0]*y,f[1]=d[1]*y,f[2]=d[2]*y,f},k.setCacheLimits=function(f,d){Ie=f,We=d},k.setRTLTextPlugin=function(f,d,y){if(y===void 0&&(y=!1),eu==="deferred"||eu==="loading"||eu==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");nl=ye.resolveURL(f),eu="deferred",wl=d,Vh(),y||nc()},k.sphericalToCartesian=function(f){var d=f[0],y=f[1],T=f[2];return y+=90,y*=Math.PI/180,T*=Math.PI/180,{x:d*Math.cos(y)*Math.sin(T),y:d*Math.sin(y)*Math.sin(T),z:d*Math.cos(T)}},k.sqrLen=function(f){var d=f[0],y=f[1];return d*d+y*y},k.styleSpec=Ce,k.sub=function(f,d,y){return f[0]=d[0]-y[0],f[1]=d[1]-y[1],f[2]=d[2]-y[2],f},k.symbolSize=no,k.transformMat3=function(f,d,y){var T=d[0],O=d[1],N=d[2];return f[0]=T*y[0]+O*y[3]+N*y[6],f[1]=T*y[1]+O*y[4]+N*y[7],f[2]=T*y[2]+O*y[5]+N*y[8],f},k.transformMat4=kp,k.translate=function(f,d,y){var T,O,N,Z,q,dt,Lt,Gt,Qt,me,Fe,nr,ur=y[0],Sr=y[1],gr=y[2];return d===f?(f[12]=d[0]*ur+d[4]*Sr+d[8]*gr+d[12],f[13]=d[1]*ur+d[5]*Sr+d[9]*gr+d[13],f[14]=d[2]*ur+d[6]*Sr+d[10]*gr+d[14],f[15]=d[3]*ur+d[7]*Sr+d[11]*gr+d[15]):(O=d[1],N=d[2],Z=d[3],q=d[4],dt=d[5],Lt=d[6],Gt=d[7],Qt=d[8],me=d[9],Fe=d[10],nr=d[11],f[0]=T=d[0],f[1]=O,f[2]=N,f[3]=Z,f[4]=q,f[5]=dt,f[6]=Lt,f[7]=Gt,f[8]=Qt,f[9]=me,f[10]=Fe,f[11]=nr,f[12]=T*ur+q*Sr+Qt*gr+d[12],f[13]=O*ur+dt*Sr+me*gr+d[13],f[14]=N*ur+Lt*Sr+Fe*gr+d[14],f[15]=Z*ur+Gt*Sr+nr*gr+d[15]),f},k.triggerPluginCompletionEvent=Kv,k.uniqueId=le,k.validateCustomStyleLayer=function(f){var d=[],y=f.id;return y===void 0&&d.push({message:"layers."+y+': missing required property "id"'}),f.render===void 0&&d.push({message:"layers."+y+': missing required method "render"'}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&d.push({message:"layers."+y+': property "renderingMode" must be either "2d" or "3d"'}),d},k.validateLight=qv,k.validateStyle=Tp,k.values=function(f){var d=[];for(var y in f)d.push(f[y]);return d},k.vectorTile=Hl,k.version="1.13.3",k.warnOnce=ne,k.webpSupported=qe,k.window=et,k.wrap=P}),mt(["./shared"],function(k){"use strict";function Et(Rt){var Xt=typeof Rt;if(Xt==="number"||Xt==="boolean"||Xt==="string"||Rt==null)return JSON.stringify(Rt);if(Array.isArray(Rt)){for(var ae="[",we=0,Ge=Rt;we<Ge.length;we+=1)ae+=Et(Ge[we])+",";return ae+"]"}for(var cr=Object.keys(Rt).sort(),br="{",Ce=0;Ce<cr.length;Ce++)br+=JSON.stringify(cr[Ce])+":"+Et(Rt[cr[Ce]])+",";return br+"}"}function K(Rt){for(var Xt="",ae=0,we=k.refProperties;ae<we.length;ae+=1)Xt+="/"+Et(Rt[we[ae]]);return Xt}var yt=function(Rt){this.keyCache={},Rt&&this.replace(Rt)};yt.prototype.replace=function(Rt){this._layerConfigs={},this._layers={},this.update(Rt,[])},yt.prototype.update=function(Rt,Xt){for(var ae=this,we=0,Ge=Rt;we<Ge.length;we+=1){var cr=Ge[we];this._layerConfigs[cr.id]=cr;var br=this._layers[cr.id]=k.createStyleLayer(cr);br._featureFilter=k.featureFilter(br.filter),this.keyCache[cr.id]&&delete this.keyCache[cr.id]}for(var Ce=0,ar=Xt;Ce<ar.length;Ce+=1){var Hr=ar[Ce];delete this.keyCache[Hr],delete this._layerConfigs[Hr],delete this._layers[Hr]}this.familiesBySource={};for(var Tn=0,Kr=function(ai,fi){for(var oa={},Ai=0;Ai<ai.length;Ai++){var Ca=fi&&fi[ai[Ai].id]||K(ai[Ai]);fi&&(fi[ai[Ai].id]=Ca);var po=oa[Ca];po||(po=oa[Ca]=[]),po.push(ai[Ai])}var La=[];for(var Va in oa)La.push(oa[Va]);return La}(k.values(this._layerConfigs),this.keyCache);Tn<Kr.length;Tn+=1){var an=Kr[Tn].map(function(ai){return ae._layers[ai.id]}),Pn=an[0];if(Pn.visibility!=="none"){var xi=Pn.source||"",Ci=this.familiesBySource[xi];Ci||(Ci=this.familiesBySource[xi]={});var Qr=Pn.sourceLayer||"_geojsonTileLayer",Kn=Ci[Qr];Kn||(Kn=Ci[Qr]=[]),Kn.push(an)}}};var J=function(Rt){var Xt={},ae=[];for(var we in Rt){var Ge=Rt[we],cr=Xt[we]={};for(var br in Ge){var Ce=Ge[+br];if(Ce&&Ce.bitmap.width!==0&&Ce.bitmap.height!==0){var ar={x:0,y:0,w:Ce.bitmap.width+2,h:Ce.bitmap.height+2};ae.push(ar),cr[br]={rect:ar,metrics:Ce.metrics}}}}var Hr=k.potpack(ae),Tn=new k.AlphaImage({width:Hr.w||1,height:Hr.h||1});for(var Kr in Rt){var an=Rt[Kr];for(var Pn in an){var xi=an[+Pn];if(xi&&xi.bitmap.width!==0&&xi.bitmap.height!==0){var Ci=Xt[Kr][Pn].rect;k.AlphaImage.copy(xi.bitmap,Tn,{x:0,y:0},{x:Ci.x+1,y:Ci.y+1},xi.bitmap)}}}this.image=Tn,this.positions=Xt};k.register("GlyphAtlas",J);var pt=function(Rt){this.tileID=new k.OverscaledTileID(Rt.tileID.overscaledZ,Rt.tileID.wrap,Rt.tileID.canonical.z,Rt.tileID.canonical.x,Rt.tileID.canonical.y),this.uid=Rt.uid,this.zoom=Rt.zoom,this.pixelRatio=Rt.pixelRatio,this.tileSize=Rt.tileSize,this.source=Rt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Rt.showCollisionBoxes,this.collectResourceTiming=!!Rt.collectResourceTiming,this.returnDependencies=!!Rt.returnDependencies,this.promoteId=Rt.promoteId};function et(Rt,Xt,ae){for(var we=new k.EvaluationParameters(Xt),Ge=0,cr=Rt;Ge<cr.length;Ge+=1)cr[Ge].recalculate(we,ae)}function be(Rt,Xt){var ae=k.getArrayBuffer(Rt.request,function(we,Ge,cr,br){we?Xt(we):Ge&&Xt(null,{vectorTile:new k.vectorTile.VectorTile(new k.pbf(Ge)),rawData:Ge,cacheControl:cr,expires:br})});return function(){ae.cancel(),Xt()}}pt.prototype.parse=function(Rt,Xt,ae,we,Ge){var cr=this;this.status="parsing",this.data=Rt,this.collisionBoxArray=new k.CollisionBoxArray;var br=new k.DictionaryCoder(Object.keys(Rt.layers).sort()),Ce=new k.FeatureIndex(this.tileID,this.promoteId);Ce.bucketLayerIDs=[];var ar,Hr,Tn,Kr,an={},Pn={featureIndex:Ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ae},xi=Xt.familiesBySource[this.source];for(var Ci in xi){var Qr=Rt.layers[Ci];if(Qr){Qr.version===1&&k.warnOnce('Vector tile source "'+this.source+'" layer "'+Ci+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Kn=br.encode(Ci),ai=[],fi=0;fi<Qr.length;fi++){var oa=Qr.feature(fi),Ai=Ce.getId(oa,Ci);ai.push({feature:oa,id:Ai,index:fi,sourceLayerIndex:Kn})}for(var Ca=0,po=xi[Ci];Ca<po.length;Ca+=1){var La=po[Ca],Va=La[0];Va.minzoom&&this.zoom<Math.floor(Va.minzoom)||Va.maxzoom&&this.zoom>=Va.maxzoom||Va.visibility!=="none"&&(et(La,this.zoom,ae),(an[Va.id]=Va.createBucket({index:Ce.bucketLayerIDs.length,layers:La,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Kn,sourceID:this.source})).populate(ai,Pn,this.tileID.canonical),Ce.bucketLayerIDs.push(La.map(function(vo){return vo.id})))}}}var _a=k.mapObject(Pn.glyphDependencies,function(vo){return Object.keys(vo).map(Number)});Object.keys(_a).length?we.send("getGlyphs",{uid:this.uid,stacks:_a},function(vo,Ua){ar||(ar=vo,Hr=Ua,Uo.call(cr))}):Hr={};var ma=Object.keys(Pn.iconDependencies);ma.length?we.send("getImages",{icons:ma,source:this.source,tileID:this.tileID,type:"icons"},function(vo,Ua){ar||(ar=vo,Tn=Ua,Uo.call(cr))}):Tn={};var Qa=Object.keys(Pn.patternDependencies);function Uo(){if(ar)return Ge(ar);if(Hr&&Tn&&Kr){var vo=new J(Hr),Ua=new k.ImageAtlas(Tn,Kr);for(var Xa in an){var Oo=an[Xa];Oo instanceof k.SymbolBucket?(et(Oo.layers,this.zoom,ae),k.performSymbolLayout(Oo,Hr,vo.positions,Tn,Ua.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Oo.hasPattern&&(Oo instanceof k.LineBucket||Oo instanceof k.FillBucket||Oo instanceof k.FillExtrusionBucket)&&(et(Oo.layers,this.zoom,ae),Oo.addFeatures(Pn,this.tileID.canonical,Ua.patternPositions))}this.status="done",Ge(null,{buckets:k.values(an).filter(function(Du){return!Du.isEmpty()}),featureIndex:Ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vo.image,imageAtlas:Ua,glyphMap:this.returnDependencies?Hr:null,iconMap:this.returnDependencies?Tn:null,glyphPositions:this.returnDependencies?vo.positions:null})}}Qa.length?we.send("getImages",{icons:Qa,source:this.source,tileID:this.tileID,type:"patterns"},function(vo,Ua){ar||(ar=vo,Kr=Ua,Uo.call(cr))}):Kr={},Uo.call(this)};var ot=function(Rt,Xt,ae,we){this.actor=Rt,this.layerIndex=Xt,this.availableImages=ae,this.loadVectorData=we||be,this.loading={},this.loaded={}};ot.prototype.loadTile=function(Rt,Xt){var ae=this,we=Rt.uid;this.loading||(this.loading={});var Ge=!!(Rt&&Rt.request&&Rt.request.collectResourceTiming)&&new k.RequestPerformance(Rt.request),cr=this.loading[we]=new pt(Rt);cr.abort=this.loadVectorData(Rt,function(br,Ce){if(delete ae.loading[we],br||!Ce)return cr.status="done",ae.loaded[we]=cr,Xt(br);var ar=Ce.rawData,Hr={};Ce.expires&&(Hr.expires=Ce.expires),Ce.cacheControl&&(Hr.cacheControl=Ce.cacheControl);var Tn={};if(Ge){var Kr=Ge.finish();Kr&&(Tn.resourceTiming=JSON.parse(JSON.stringify(Kr)))}cr.vectorTile=Ce.vectorTile,cr.parse(Ce.vectorTile,ae.layerIndex,ae.availableImages,ae.actor,function(an,Pn){if(an||!Pn)return Xt(an);Xt(null,k.extend({rawTileData:ar.slice(0)},Pn,Hr,Tn))}),ae.loaded=ae.loaded||{},ae.loaded[we]=cr})},ot.prototype.reloadTile=function(Rt,Xt){var ae=this,we=this.loaded,Ge=Rt.uid,cr=this;if(we&&we[Ge]){var br=we[Ge];br.showCollisionBoxes=Rt.showCollisionBoxes;var Ce=function(ar,Hr){var Tn=br.reloadCallback;Tn&&(delete br.reloadCallback,br.parse(br.vectorTile,cr.layerIndex,ae.availableImages,cr.actor,Tn)),Xt(ar,Hr)};br.status==="parsing"?br.reloadCallback=Ce:br.status==="done"&&(br.vectorTile?br.parse(br.vectorTile,this.layerIndex,this.availableImages,this.actor,Ce):Ce())}},ot.prototype.abortTile=function(Rt,Xt){var ae=this.loading,we=Rt.uid;ae&&ae[we]&&ae[we].abort&&(ae[we].abort(),delete ae[we]),Xt()},ot.prototype.removeTile=function(Rt,Xt){var ae=this.loaded,we=Rt.uid;ae&&ae[we]&&delete ae[we],Xt()};var ut=k.window.ImageBitmap,zt=function(){this.loaded={}};function P(Rt,Xt){if(Rt.length!==0){b(Rt[0],Xt);for(var ae=1;ae<Rt.length;ae++)b(Rt[ae],!Xt)}}function b(Rt,Xt){for(var ae=0,we=0,Ge=0,cr=Rt.length,br=cr-1;Ge<cr;br=Ge++){var Ce=(Rt[Ge][0]-Rt[br][0])*(Rt[br][1]+Rt[Ge][1]),ar=ae+Ce;we+=Math.abs(ae)>=Math.abs(Ce)?ae-ar+Ce:Ce-ar+ae,ae=ar}ae+we>=0!=!!Xt&&Rt.reverse()}zt.prototype.loadTile=function(Rt,Xt){var ae=Rt.uid,we=Rt.encoding,Ge=Rt.rawImageData,cr=ut&&Ge instanceof ut?this.getImageData(Ge):Ge,br=new k.DEMData(ae,cr,we);this.loaded=this.loaded||{},this.loaded[ae]=br,Xt(null,br)},zt.prototype.getImageData=function(Rt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Rt.width,Rt.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Rt.width,this.offscreenCanvas.height=Rt.height,this.offscreenCanvasContext.drawImage(Rt,0,0,Rt.width,Rt.height);var Xt=this.offscreenCanvasContext.getImageData(-1,-1,Rt.width+2,Rt.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new k.RGBAImage({width:Xt.width,height:Xt.height},Xt.data)},zt.prototype.removeTile=function(Rt){var Xt=this.loaded,ae=Rt.uid;Xt&&Xt[ae]&&delete Xt[ae]};var W=k.vectorTile.VectorTileFeature.prototype.toGeoJSON,le=function(Rt){this._feature=Rt,this.extent=k.EXTENT,this.type=Rt.type,this.properties=Rt.tags,"id"in Rt&&!isNaN(Rt.id)&&(this.id=parseInt(Rt.id,10))};le.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Rt=[],Xt=0,ae=this._feature.geometry;Xt<ae.length;Xt+=1){var we=ae[Xt];Rt.push([new k.Point$1(we[0],we[1])])}return Rt}for(var Ge=[],cr=0,br=this._feature.geometry;cr<br.length;cr+=1){for(var Ce=[],ar=0,Hr=br[cr];ar<Hr.length;ar+=1){var Tn=Hr[ar];Ce.push(new k.Point$1(Tn[0],Tn[1]))}Ge.push(Ce)}return Ge},le.prototype.toGeoJSON=function(Rt,Xt,ae){return W.call(this,Rt,Xt,ae)};var Ee=function(Rt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=k.EXTENT,this.length=Rt.length,this._features=Rt};Ee.prototype.feature=function(Rt){return new le(this._features[Rt])};var ke=k.vectorTile.VectorTileFeature,Tt=rt;function rt(Rt,Xt){this.options=Xt||{},this.features=Rt,this.length=Rt.length}function Dt(Rt,Xt){this.id=typeof Rt.id=="number"?Rt.id:void 0,this.type=Rt.type,this.rawGeometry=Rt.type===1?[Rt.geometry]:Rt.geometry,this.properties=Rt.tags,this.extent=Xt||4096}rt.prototype.feature=function(Rt){return new Dt(this.features[Rt],this.options.extent)},Dt.prototype.loadGeometry=function(){var Rt=this.rawGeometry;this.geometry=[];for(var Xt=0;Xt<Rt.length;Xt++){for(var ae=Rt[Xt],we=[],Ge=0;Ge<ae.length;Ge++)we.push(new k.Point$1(ae[Ge][0],ae[Ge][1]));this.geometry.push(we)}return this.geometry},Dt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Rt=this.geometry,Xt=1/0,ae=-1/0,we=1/0,Ge=-1/0,cr=0;cr<Rt.length;cr++)for(var br=Rt[cr],Ce=0;Ce<br.length;Ce++){var ar=br[Ce];Xt=Math.min(Xt,ar.x),ae=Math.max(ae,ar.x),we=Math.min(we,ar.y),Ge=Math.max(Ge,ar.y)}return[Xt,we,ae,Ge]},Dt.prototype.toGeoJSON=ke.prototype.toGeoJSON;var Se=ve,_e=Tt;function ve(Rt){var Xt=new k.pbf;return function(ae,we){for(var Ge in ae.layers)we.writeMessage(3,ne,ae.layers[Ge])}(Rt,Xt),Xt.finish()}function ne(Rt,Xt){var ae;Xt.writeVarintField(15,Rt.version||1),Xt.writeStringField(1,Rt.name||""),Xt.writeVarintField(5,Rt.extent||4096);var we={keys:[],values:[],keycache:{},valuecache:{}};for(ae=0;ae<Rt.length;ae++)we.feature=Rt.feature(ae),Xt.writeMessage(2,xe,we);var Ge=we.keys;for(ae=0;ae<Ge.length;ae++)Xt.writeStringField(3,Ge[ae]);var cr=we.values;for(ae=0;ae<cr.length;ae++)Xt.writeMessage(4,wt,cr[ae])}function xe(Rt,Xt){var ae=Rt.feature;ae.id!==void 0&&Xt.writeVarintField(1,ae.id),Xt.writeMessage(2,Je,Rt),Xt.writeVarintField(3,ae.type),Xt.writeMessage(4,ft,ae)}function Je(Rt,Xt){var ae=Rt.feature,we=Rt.keys,Ge=Rt.values,cr=Rt.keycache,br=Rt.valuecache;for(var Ce in ae.properties){var ar=cr[Ce];ar===void 0&&(we.push(Ce),cr[Ce]=ar=we.length-1),Xt.writeVarint(ar);var Hr=ae.properties[Ce],Tn=typeof Hr;Tn!=="string"&&Tn!=="boolean"&&Tn!=="number"&&(Hr=JSON.stringify(Hr));var Kr=Tn+":"+Hr,an=br[Kr];an===void 0&&(Ge.push(Hr),br[Kr]=an=Ge.length-1),Xt.writeVarint(an)}}function Ot(Rt,Xt){return(Xt<<3)+(7&Rt)}function te(Rt){return Rt<<1^Rt>>31}function ft(Rt,Xt){for(var ae=Rt.loadGeometry(),we=Rt.type,Ge=0,cr=0,br=ae.length,Ce=0;Ce<br;Ce++){var ar=ae[Ce],Hr=1;we===1&&(Hr=ar.length),Xt.writeVarint(Ot(1,Hr));for(var Tn=we===3?ar.length-1:ar.length,Kr=0;Kr<Tn;Kr++){Kr===1&&we!==1&&Xt.writeVarint(Ot(2,Tn-1));var an=ar[Kr].x-Ge,Pn=ar[Kr].y-cr;Xt.writeVarint(te(an)),Xt.writeVarint(te(Pn)),Ge+=an,cr+=Pn}we===3&&Xt.writeVarint(Ot(7,1))}}function wt(Rt,Xt){var ae=typeof Rt;ae==="string"?Xt.writeStringField(1,Rt):ae==="boolean"?Xt.writeBooleanField(7,Rt):ae==="number"&&(Rt%1!=0?Xt.writeDoubleField(3,Rt):Rt<0?Xt.writeSVarintField(6,Rt):Xt.writeVarintField(5,Rt))}function Y(Rt,Xt,ae,we){gt(Rt,ae,we),gt(Xt,2*ae,2*we),gt(Xt,2*ae+1,2*we+1)}function gt(Rt,Xt,ae){var we=Rt[Xt];Rt[Xt]=Rt[ae],Rt[ae]=we}function he(Rt,Xt,ae,we){var Ge=Rt-ae,cr=Xt-we;return Ge*Ge+cr*cr}Se.fromVectorTileJs=ve,Se.fromGeojsonVt=function(Rt,Xt){Xt=Xt||{};var ae={};for(var we in Rt)ae[we]=new Tt(Rt[we].features,Xt),ae[we].name=we,ae[we].version=Xt.version,ae[we].extent=Xt.extent;return ve({layers:ae})},Se.GeoJSONWrapper=_e;var Oe=function(Rt){return Rt[0]},Le=function(Rt){return Rt[1]},Ve=function(Rt,Xt,ae,we,Ge){Xt===void 0&&(Xt=Oe),ae===void 0&&(ae=Le),we===void 0&&(we=64),Ge===void 0&&(Ge=Float64Array),this.nodeSize=we,this.points=Rt;for(var cr=Rt.length<65536?Uint16Array:Uint32Array,br=this.ids=new cr(Rt.length),Ce=this.coords=new Ge(2*Rt.length),ar=0;ar<Rt.length;ar++)br[ar]=ar,Ce[2*ar]=Xt(Rt[ar]),Ce[2*ar+1]=ae(Rt[ar]);(function Hr(Tn,Kr,an,Pn,xi,Ci){if(!(xi-Pn<=an)){var Qr=Pn+xi>>1;(function Kn(ai,fi,oa,Ai,Ca,po){for(;Ca>Ai;){if(Ca-Ai>600){var La=Ca-Ai+1,Va=oa-Ai+1,_a=Math.log(La),ma=.5*Math.exp(2*_a/3),Qa=.5*Math.sqrt(_a*ma*(La-ma)/La)*(Va-La/2<0?-1:1);Kn(ai,fi,oa,Math.max(Ai,Math.floor(oa-Va*ma/La+Qa)),Math.min(Ca,Math.floor(oa+(La-Va)*ma/La+Qa)),po)}var Uo=fi[2*oa+po],vo=Ai,Ua=Ca;for(Y(ai,fi,Ai,oa),fi[2*Ca+po]>Uo&&Y(ai,fi,Ai,Ca);vo<Ua;){for(Y(ai,fi,vo,Ua),vo++,Ua--;fi[2*vo+po]<Uo;)vo++;for(;fi[2*Ua+po]>Uo;)Ua--}fi[2*Ai+po]===Uo?Y(ai,fi,Ai,Ua):Y(ai,fi,++Ua,Ca),Ua<=oa&&(Ai=Ua+1),oa<=Ua&&(Ca=Ua-1)}})(Tn,Kr,Qr,Pn,xi,Ci%2),Hr(Tn,Kr,an,Pn,Qr-1,Ci+1),Hr(Tn,Kr,an,Qr+1,xi,Ci+1)}})(br,Ce,we,0,br.length-1,0)};Ve.prototype.range=function(Rt,Xt,ae,we){return function(Ge,cr,br,Ce,ar,Hr,Tn){for(var Kr,an,Pn=[0,Ge.length-1,0],xi=[];Pn.length;){var Ci=Pn.pop(),Qr=Pn.pop(),Kn=Pn.pop();if(Qr-Kn<=Tn)for(var ai=Kn;ai<=Qr;ai++)an=cr[2*ai+1],(Kr=cr[2*ai])>=br&&Kr<=ar&&an>=Ce&&an<=Hr&&xi.push(Ge[ai]);else{var fi=Math.floor((Kn+Qr)/2);an=cr[2*fi+1],(Kr=cr[2*fi])>=br&&Kr<=ar&&an>=Ce&&an<=Hr&&xi.push(Ge[fi]);var oa=(Ci+1)%2;(Ci===0?br<=Kr:Ce<=an)&&(Pn.push(Kn),Pn.push(fi-1),Pn.push(oa)),(Ci===0?ar>=Kr:Hr>=an)&&(Pn.push(fi+1),Pn.push(Qr),Pn.push(oa))}}return xi}(this.ids,this.coords,Rt,Xt,ae,we,this.nodeSize)},Ve.prototype.within=function(Rt,Xt,ae){return function(we,Ge,cr,br,Ce,ar){for(var Hr=[0,we.length-1,0],Tn=[],Kr=Ce*Ce;Hr.length;){var an=Hr.pop(),Pn=Hr.pop(),xi=Hr.pop();if(Pn-xi<=ar)for(var Ci=xi;Ci<=Pn;Ci++)he(Ge[2*Ci],Ge[2*Ci+1],cr,br)<=Kr&&Tn.push(we[Ci]);else{var Qr=Math.floor((xi+Pn)/2),Kn=Ge[2*Qr],ai=Ge[2*Qr+1];he(Kn,ai,cr,br)<=Kr&&Tn.push(we[Qr]);var fi=(an+1)%2;(an===0?cr-Ce<=Kn:br-Ce<=ai)&&(Hr.push(xi),Hr.push(Qr-1),Hr.push(fi)),(an===0?cr+Ce>=Kn:br+Ce>=ai)&&(Hr.push(Qr+1),Hr.push(Pn),Hr.push(fi))}}return Tn}(this.ids,this.coords,Rt,Xt,ae,this.nodeSize)};var Bt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Rt){return Rt}},re=function(Rt){this.options=bt(Object.create(Bt),Rt),this.trees=new Array(this.options.maxZoom+1)};function ye(Rt,Xt,ae,we,Ge){return{x:Rt,y:Xt,zoom:1/0,id:ae,parentId:-1,numPoints:we,properties:Ge}}function Yt(Rt,Xt){var ae=Rt.geometry.coordinates,we=ae[1];return{x:oe(ae[0]),y:qt(we),zoom:1/0,index:Xt,parentId:-1}}function qe(Rt){return{type:"Feature",id:Rt.id,properties:vr(Rt),geometry:{type:"Point",coordinates:[(we=Rt.x,360*(we-.5)),(Xt=Rt.y,ae=(180-360*Xt)*Math.PI/180,360*Math.atan(Math.exp(ae))/Math.PI-90)]}};var Xt,ae,we}function vr(Rt){var Xt=Rt.numPoints,ae=Xt>=1e4?Math.round(Xt/1e3)+"k":Xt>=1e3?Math.round(Xt/100)/10+"k":Xt;return bt(bt({},Rt.properties),{cluster:!0,cluster_id:Rt.id,point_count:Xt,point_count_abbreviated:ae})}function oe(Rt){return Rt/360+.5}function qt(Rt){var Xt=Math.sin(Rt*Math.PI/180),ae=.5-.25*Math.log((1+Xt)/(1-Xt))/Math.PI;return ae<0?0:ae>1?1:ae}function bt(Rt,Xt){for(var ae in Xt)Rt[ae]=Xt[ae];return Rt}function Wt(Rt){return Rt.x}function $t(Rt){return Rt.y}function xt(Rt,Xt,ae,we,Ge,cr){var br=Ge-ae,Ce=cr-we;if(br!==0||Ce!==0){var ar=((Rt-ae)*br+(Xt-we)*Ce)/(br*br+Ce*Ce);ar>1?(ae=Ge,we=cr):ar>0&&(ae+=br*ar,we+=Ce*ar)}return(br=Rt-ae)*br+(Ce=Xt-we)*Ce}function St(Rt,Xt,ae,we){var Ge={id:Rt===void 0?null:Rt,type:Xt,geometry:ae,tags:we,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(cr){var br=cr.geometry,Ce=cr.type;if(Ce==="Point"||Ce==="MultiPoint"||Ce==="LineString")ue(cr,br);else if(Ce==="Polygon"||Ce==="MultiLineString")for(var ar=0;ar<br.length;ar++)ue(cr,br[ar]);else if(Ce==="MultiPolygon")for(ar=0;ar<br.length;ar++)for(var Hr=0;Hr<br[ar].length;Hr++)ue(cr,br[ar][Hr])}(Ge),Ge}function ue(Rt,Xt){for(var ae=0;ae<Xt.length;ae+=3)Rt.minX=Math.min(Rt.minX,Xt[ae]),Rt.minY=Math.min(Rt.minY,Xt[ae+1]),Rt.maxX=Math.max(Rt.maxX,Xt[ae]),Rt.maxY=Math.max(Rt.maxY,Xt[ae+1])}function Pe(Rt,Xt,ae,we){if(Xt.geometry){var Ge=Xt.geometry.coordinates,cr=Xt.geometry.type,br=Math.pow(ae.tolerance/((1<<ae.maxZoom)*ae.extent),2),Ce=[],ar=Xt.id;if(ae.promoteId?ar=Xt.properties[ae.promoteId]:ae.generateId&&(ar=we||0),cr==="Point")ze(Ge,Ce);else if(cr==="MultiPoint")for(var Hr=0;Hr<Ge.length;Hr++)ze(Ge[Hr],Ce);else if(cr==="LineString")Vt(Ge,Ce,br,!1);else if(cr==="MultiLineString"){if(ae.lineMetrics){for(Hr=0;Hr<Ge.length;Hr++)Vt(Ge[Hr],Ce=[],br,!1),Rt.push(St(ar,"LineString",Ce,Xt.properties));return}Ct(Ge,Ce,br,!1)}else if(cr==="Polygon")Ct(Ge,Ce,br,!0);else{if(cr!=="MultiPolygon"){if(cr==="GeometryCollection"){for(Hr=0;Hr<Xt.geometry.geometries.length;Hr++)Pe(Rt,{id:ar,geometry:Xt.geometry.geometries[Hr],properties:Xt.properties},ae,we);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Hr=0;Hr<Ge.length;Hr++){var Tn=[];Ct(Ge[Hr],Tn,br,!0),Ce.push(Tn)}}Rt.push(St(ar,cr,Ce,Xt.properties))}}function ze(Rt,Xt){Xt.push(At(Rt[0])),Xt.push(Nt(Rt[1])),Xt.push(0)}function Vt(Rt,Xt,ae,we){for(var Ge,cr,br=0,Ce=0;Ce<Rt.length;Ce++){var ar=At(Rt[Ce][0]),Hr=Nt(Rt[Ce][1]);Xt.push(ar),Xt.push(Hr),Xt.push(0),Ce>0&&(br+=we?(Ge*Hr-ar*cr)/2:Math.sqrt(Math.pow(ar-Ge,2)+Math.pow(Hr-cr,2))),Ge=ar,cr=Hr}var Tn=Xt.length-3;Xt[2]=1,function Kr(an,Pn,xi,Ci){for(var Qr,Kn=Ci,ai=xi-Pn>>1,fi=xi-Pn,oa=an[Pn],Ai=an[Pn+1],Ca=an[xi],po=an[xi+1],La=Pn+3;La<xi;La+=3){var Va=xt(an[La],an[La+1],oa,Ai,Ca,po);if(Va>Kn)Qr=La,Kn=Va;else if(Va===Kn){var _a=Math.abs(La-ai);_a<fi&&(Qr=La,fi=_a)}}Kn>Ci&&(Qr-Pn>3&&Kr(an,Pn,Qr,Ci),an[Qr+2]=Kn,xi-Qr>3&&Kr(an,Qr,xi,Ci))}(Xt,0,Tn,ae),Xt[Tn+2]=1,Xt.size=Math.abs(br),Xt.start=0,Xt.end=Xt.size}function Ct(Rt,Xt,ae,we){for(var Ge=0;Ge<Rt.length;Ge++){var cr=[];Vt(Rt[Ge],cr,ae,we),Xt.push(cr)}}function At(Rt){return Rt/360+.5}function Nt(Rt){var Xt=Math.sin(Rt*Math.PI/180),ae=.5-.25*Math.log((1+Xt)/(1-Xt))/Math.PI;return ae<0?0:ae>1?1:ae}function tt(Rt,Xt,ae,we,Ge,cr,br,Ce){if(we/=Xt,cr>=(ae/=Xt)&&br<we)return Rt;if(br<ae||cr>=we)return null;for(var ar=[],Hr=0;Hr<Rt.length;Hr++){var Tn=Rt[Hr],Kr=Tn.geometry,an=Tn.type,Pn=Ge===0?Tn.minX:Tn.minY,xi=Ge===0?Tn.maxX:Tn.maxY;if(Pn>=ae&&xi<we)ar.push(Tn);else if(!(xi<ae||Pn>=we)){var Ci=[];if(an==="Point"||an==="MultiPoint")vt(Kr,Ci,ae,we,Ge);else if(an==="LineString")Ht(Kr,Ci,ae,we,Ge,!1,Ce.lineMetrics);else if(an==="MultiLineString")jt(Kr,Ci,ae,we,Ge,!1);else if(an==="Polygon")jt(Kr,Ci,ae,we,Ge,!0);else if(an==="MultiPolygon")for(var Qr=0;Qr<Kr.length;Qr++){var Kn=[];jt(Kr[Qr],Kn,ae,we,Ge,!0),Kn.length&&Ci.push(Kn)}if(Ci.length){if(Ce.lineMetrics&&an==="LineString"){for(Qr=0;Qr<Ci.length;Qr++)ar.push(St(Tn.id,an,Ci[Qr],Tn.tags));continue}an!=="LineString"&&an!=="MultiLineString"||(Ci.length===1?(an="LineString",Ci=Ci[0]):an="MultiLineString"),an!=="Point"&&an!=="MultiPoint"||(an=Ci.length===3?"Point":"MultiPoint"),ar.push(St(Tn.id,an,Ci,Tn.tags))}}}return ar.length?ar:null}function vt(Rt,Xt,ae,we,Ge){for(var cr=0;cr<Rt.length;cr+=3){var br=Rt[cr+Ge];br>=ae&&br<=we&&(Xt.push(Rt[cr]),Xt.push(Rt[cr+1]),Xt.push(Rt[cr+2]))}}function Ht(Rt,Xt,ae,we,Ge,cr,br){for(var Ce,ar,Hr=de(Rt),Tn=Ge===0?We:Ke,Kr=Rt.start,an=0;an<Rt.length-3;an+=3){var Pn=Rt[an],xi=Rt[an+1],Ci=Rt[an+2],Qr=Rt[an+3],Kn=Rt[an+4],ai=Ge===0?Pn:xi,fi=Ge===0?Qr:Kn,oa=!1;br&&(Ce=Math.sqrt(Math.pow(Pn-Qr,2)+Math.pow(xi-Kn,2))),ai<ae?fi>ae&&(ar=Tn(Hr,Pn,xi,Qr,Kn,ae),br&&(Hr.start=Kr+Ce*ar)):ai>we?fi<we&&(ar=Tn(Hr,Pn,xi,Qr,Kn,we),br&&(Hr.start=Kr+Ce*ar)):Ie(Hr,Pn,xi,Ci),fi<ae&&ai>=ae&&(ar=Tn(Hr,Pn,xi,Qr,Kn,ae),oa=!0),fi>we&&ai<=we&&(ar=Tn(Hr,Pn,xi,Qr,Kn,we),oa=!0),!cr&&oa&&(br&&(Hr.end=Kr+Ce*ar),Xt.push(Hr),Hr=de(Rt)),br&&(Kr+=Ce)}var Ai=Rt.length-3;Pn=Rt[Ai],xi=Rt[Ai+1],Ci=Rt[Ai+2],(ai=Ge===0?Pn:xi)>=ae&&ai<=we&&Ie(Hr,Pn,xi,Ci),Ai=Hr.length-3,cr&&Ai>=3&&(Hr[Ai]!==Hr[0]||Hr[Ai+1]!==Hr[1])&&Ie(Hr,Hr[0],Hr[1],Hr[2]),Hr.length&&Xt.push(Hr)}function de(Rt){var Xt=[];return Xt.size=Rt.size,Xt.start=Rt.start,Xt.end=Rt.end,Xt}function jt(Rt,Xt,ae,we,Ge,cr){for(var br=0;br<Rt.length;br++)Ht(Rt[br],Xt,ae,we,Ge,cr,!1)}function Ie(Rt,Xt,ae,we){Rt.push(Xt),Rt.push(ae),Rt.push(we)}function We(Rt,Xt,ae,we,Ge,cr){var br=(cr-Xt)/(we-Xt);return Rt.push(cr),Rt.push(ae+(Ge-ae)*br),Rt.push(1),br}function Ke(Rt,Xt,ae,we,Ge,cr){var br=(cr-ae)/(Ge-ae);return Rt.push(Xt+(we-Xt)*br),Rt.push(cr),Rt.push(1),br}function pr(Rt,Xt){for(var ae=[],we=0;we<Rt.length;we++){var Ge,cr=Rt[we],br=cr.type;if(br==="Point"||br==="MultiPoint"||br==="LineString")Ge=lr(cr.geometry,Xt);else if(br==="MultiLineString"||br==="Polygon"){Ge=[];for(var Ce=0;Ce<cr.geometry.length;Ce++)Ge.push(lr(cr.geometry[Ce],Xt))}else if(br==="MultiPolygon")for(Ge=[],Ce=0;Ce<cr.geometry.length;Ce++){for(var ar=[],Hr=0;Hr<cr.geometry[Ce].length;Hr++)ar.push(lr(cr.geometry[Ce][Hr],Xt));Ge.push(ar)}ae.push(St(cr.id,br,Ge,cr.tags))}return ae}function lr(Rt,Xt){var ae=[];ae.size=Rt.size,Rt.start!==void 0&&(ae.start=Rt.start,ae.end=Rt.end);for(var we=0;we<Rt.length;we+=3)ae.push(Rt[we]+Xt,Rt[we+1],Rt[we+2]);return ae}function Nr(Rt,Xt){if(Rt.transformed)return Rt;var ae,we,Ge,cr=1<<Rt.z,br=Rt.x,Ce=Rt.y;for(ae=0;ae<Rt.features.length;ae++){var ar=Rt.features[ae],Hr=ar.geometry,Tn=ar.type;if(ar.geometry=[],Tn===1)for(we=0;we<Hr.length;we+=2)ar.geometry.push(Pr(Hr[we],Hr[we+1],Xt,cr,br,Ce));else for(we=0;we<Hr.length;we++){var Kr=[];for(Ge=0;Ge<Hr[we].length;Ge+=2)Kr.push(Pr(Hr[we][Ge],Hr[we][Ge+1],Xt,cr,br,Ce));ar.geometry.push(Kr)}}return Rt.transformed=!0,Rt}function Pr(Rt,Xt,ae,we,Ge,cr){return[Math.round(ae*(Rt*we-Ge)),Math.round(ae*(Xt*we-cr))]}function Gr(Rt,Xt,ae,we,Ge){for(var cr=Xt===Ge.maxZoom?0:Ge.tolerance/((1<<Xt)*Ge.extent),br={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ae,y:we,z:Xt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ce=0;Ce<Rt.length;Ce++){br.numFeatures++,Sn(br,Rt[Ce],cr,Ge);var ar=Rt[Ce].minX,Hr=Rt[Ce].minY,Tn=Rt[Ce].maxX,Kr=Rt[Ce].maxY;ar<br.minX&&(br.minX=ar),Hr<br.minY&&(br.minY=Hr),Tn>br.maxX&&(br.maxX=Tn),Kr>br.maxY&&(br.maxY=Kr)}return br}function Sn(Rt,Xt,ae,we){var Ge=Xt.geometry,cr=Xt.type,br=[];if(cr==="Point"||cr==="MultiPoint")for(var Ce=0;Ce<Ge.length;Ce+=3)br.push(Ge[Ce]),br.push(Ge[Ce+1]),Rt.numPoints++,Rt.numSimplified++;else if(cr==="LineString")nn(br,Ge,Rt,ae,!1,!1);else if(cr==="MultiLineString"||cr==="Polygon")for(Ce=0;Ce<Ge.length;Ce++)nn(br,Ge[Ce],Rt,ae,cr==="Polygon",Ce===0);else if(cr==="MultiPolygon")for(var ar=0;ar<Ge.length;ar++){var Hr=Ge[ar];for(Ce=0;Ce<Hr.length;Ce++)nn(br,Hr[Ce],Rt,ae,!0,Ce===0)}if(br.length){var Tn=Xt.tags||null;if(cr==="LineString"&&we.lineMetrics){for(var Kr in Tn={},Xt.tags)Tn[Kr]=Xt.tags[Kr];Tn.mapbox_clip_start=Ge.start/Ge.size,Tn.mapbox_clip_end=Ge.end/Ge.size}var an={geometry:br,type:cr==="Polygon"||cr==="MultiPolygon"?3:cr==="LineString"||cr==="MultiLineString"?2:1,tags:Tn};Xt.id!==null&&(an.id=Xt.id),Rt.features.push(an)}}function nn(Rt,Xt,ae,we,Ge,cr){var br=we*we;if(we>0&&Xt.size<(Ge?br:we))ae.numPoints+=Xt.length/3;else{for(var Ce=[],ar=0;ar<Xt.length;ar+=3)(we===0||Xt[ar+2]>br)&&(ae.numSimplified++,Ce.push(Xt[ar]),Ce.push(Xt[ar+1])),ae.numPoints++;Ge&&function(Hr,Tn){for(var Kr=0,an=0,Pn=Hr.length,xi=Pn-2;an<Pn;xi=an,an+=2)Kr+=(Hr[an]-Hr[xi])*(Hr[an+1]+Hr[xi+1]);if(Kr>0===Tn)for(an=0,Pn=Hr.length;an<Pn/2;an+=2){var Ci=Hr[an],Qr=Hr[an+1];Hr[an]=Hr[Pn-2-an],Hr[an+1]=Hr[Pn-1-an],Hr[Pn-2-an]=Ci,Hr[Pn-1-an]=Qr}}(Ce,cr),Rt.push(Ce)}}function Nn(Rt,Xt){var ae=(Xt=this.options=function(Ge,cr){for(var br in cr)Ge[br]=cr[br];return Ge}(Object.create(this.options),Xt)).debug;if(ae&&console.time("preprocess data"),Xt.maxZoom<0||Xt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Xt.promoteId&&Xt.generateId)throw new Error("promoteId and generateId cannot be used together.");var we=function(Ge,cr){var br=[];if(Ge.type==="FeatureCollection")for(var Ce=0;Ce<Ge.features.length;Ce++)Pe(br,Ge.features[Ce],cr,Ce);else Pe(br,Ge.type==="Feature"?Ge:{geometry:Ge},cr);return br}(Rt,Xt);this.tiles={},this.tileCoords=[],ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Xt.indexMaxZoom,Xt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(we=function(Ge,cr){var br=cr.buffer/cr.extent,Ce=Ge,ar=tt(Ge,1,-1-br,br,0,-1,2,cr),Hr=tt(Ge,1,1-br,2+br,0,-1,2,cr);return(ar||Hr)&&(Ce=tt(Ge,1,-br,1+br,0,-1,2,cr)||[],ar&&(Ce=pr(ar,1).concat(Ce)),Hr&&(Ce=Ce.concat(pr(Hr,-1)))),Ce}(we,Xt)).length&&this.splitTile(we,0,0,0),ae&&(we.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Zn(Rt,Xt,ae){return 32*((1<<Rt)*ae+Xt)+Rt}function Hn(Rt,Xt){var ae=Rt.tileID.canonical;if(!this._geoJSONIndex)return Xt(null,null);var we=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!we)return Xt(null,null);var Ge=new Ee(we.features),cr=Se(Ge);cr.byteOffset===0&&cr.byteLength===cr.buffer.byteLength||(cr=new Uint8Array(cr)),Xt(null,{vectorTile:Ge,rawData:cr.buffer})}re.prototype.load=function(Rt){var Xt=this.options,ae=Xt.log,we=Xt.minZoom,Ge=Xt.maxZoom,cr=Xt.nodeSize;ae&&console.time("total time");var br="prepare "+Rt.length+" points";ae&&console.time(br),this.points=Rt;for(var Ce=[],ar=0;ar<Rt.length;ar++)Rt[ar].geometry&&Ce.push(Yt(Rt[ar],ar));this.trees[Ge+1]=new Ve(Ce,Wt,$t,cr,Float32Array),ae&&console.timeEnd(br);for(var Hr=Ge;Hr>=we;Hr--){var Tn=+Date.now();Ce=this._cluster(Ce,Hr),this.trees[Hr]=new Ve(Ce,Wt,$t,cr,Float32Array),ae&&console.log("z%d: %d clusters in %dms",Hr,Ce.length,+Date.now()-Tn)}return ae&&console.timeEnd("total time"),this},re.prototype.getClusters=function(Rt,Xt){var ae=((Rt[0]+180)%360+360)%360-180,we=Math.max(-90,Math.min(90,Rt[1])),Ge=Rt[2]===180?180:((Rt[2]+180)%360+360)%360-180,cr=Math.max(-90,Math.min(90,Rt[3]));if(Rt[2]-Rt[0]>=360)ae=-180,Ge=180;else if(ae>Ge){var br=this.getClusters([ae,we,180,cr],Xt),Ce=this.getClusters([-180,we,Ge,cr],Xt);return br.concat(Ce)}for(var ar=this.trees[this._limitZoom(Xt)],Hr=[],Tn=0,Kr=ar.range(oe(ae),qt(cr),oe(Ge),qt(we));Tn<Kr.length;Tn+=1){var an=ar.points[Kr[Tn]];Hr.push(an.numPoints?qe(an):this.points[an.index])}return Hr},re.prototype.getChildren=function(Rt){var Xt=this._getOriginId(Rt),ae=this._getOriginZoom(Rt),we="No cluster with the specified id.",Ge=this.trees[ae];if(!Ge)throw new Error(we);var cr=Ge.points[Xt];if(!cr)throw new Error(we);for(var br=this.options.radius/(this.options.extent*Math.pow(2,ae-1)),Ce=[],ar=0,Hr=Ge.within(cr.x,cr.y,br);ar<Hr.length;ar+=1){var Tn=Ge.points[Hr[ar]];Tn.parentId===Rt&&Ce.push(Tn.numPoints?qe(Tn):this.points[Tn.index])}if(Ce.length===0)throw new Error(we);return Ce},re.prototype.getLeaves=function(Rt,Xt,ae){var we=[];return this._appendLeaves(we,Rt,Xt=Xt||10,ae=ae||0,0),we},re.prototype.getTile=function(Rt,Xt,ae){var we=this.trees[this._limitZoom(Rt)],Ge=Math.pow(2,Rt),cr=this.options,br=cr.radius/cr.extent,Ce=(ae-br)/Ge,ar=(ae+1+br)/Ge,Hr={features:[]};return this._addTileFeatures(we.range((Xt-br)/Ge,Ce,(Xt+1+br)/Ge,ar),we.points,Xt,ae,Ge,Hr),Xt===0&&this._addTileFeatures(we.range(1-br/Ge,Ce,1,ar),we.points,Ge,ae,Ge,Hr),Xt===Ge-1&&this._addTileFeatures(we.range(0,Ce,br/Ge,ar),we.points,-1,ae,Ge,Hr),Hr.features.length?Hr:null},re.prototype.getClusterExpansionZoom=function(Rt){for(var Xt=this._getOriginZoom(Rt)-1;Xt<=this.options.maxZoom;){var ae=this.getChildren(Rt);if(Xt++,ae.length!==1)break;Rt=ae[0].properties.cluster_id}return Xt},re.prototype._appendLeaves=function(Rt,Xt,ae,we,Ge){for(var cr=0,br=this.getChildren(Xt);cr<br.length;cr+=1){var Ce=br[cr],ar=Ce.properties;if(ar&&ar.cluster?Ge+ar.point_count<=we?Ge+=ar.point_count:Ge=this._appendLeaves(Rt,ar.cluster_id,ae,we,Ge):Ge<we?Ge++:Rt.push(Ce),Rt.length===ae)break}return Ge},re.prototype._addTileFeatures=function(Rt,Xt,ae,we,Ge,cr){for(var br=0,Ce=Rt;br<Ce.length;br+=1){var ar=Xt[Ce[br]],Hr=ar.numPoints,Tn={type:1,geometry:[[Math.round(this.options.extent*(ar.x*Ge-ae)),Math.round(this.options.extent*(ar.y*Ge-we))]],tags:Hr?vr(ar):this.points[ar.index].properties},Kr=void 0;Hr?Kr=ar.id:this.options.generateId?Kr=ar.index:this.points[ar.index].id&&(Kr=this.points[ar.index].id),Kr!==void 0&&(Tn.id=Kr),cr.features.push(Tn)}},re.prototype._limitZoom=function(Rt){return Math.max(this.options.minZoom,Math.min(+Rt,this.options.maxZoom+1))},re.prototype._cluster=function(Rt,Xt){for(var ae=[],we=this.options,Ge=we.reduce,cr=we.minPoints,br=we.radius/(we.extent*Math.pow(2,Xt)),Ce=0;Ce<Rt.length;Ce++){var ar=Rt[Ce];if(!(ar.zoom<=Xt)){ar.zoom=Xt;for(var Hr=this.trees[Xt+1],Tn=Hr.within(ar.x,ar.y,br),Kr=ar.numPoints||1,an=Kr,Pn=0,xi=Tn;Pn<xi.length;Pn+=1){var Ci=Hr.points[xi[Pn]];Ci.zoom>Xt&&(an+=Ci.numPoints||1)}if(an>=cr){for(var Qr=ar.x*Kr,Kn=ar.y*Kr,ai=Ge&&Kr>1?this._map(ar,!0):null,fi=(Ce<<5)+(Xt+1)+this.points.length,oa=0,Ai=Tn;oa<Ai.length;oa+=1){var Ca=Hr.points[Ai[oa]];if(!(Ca.zoom<=Xt)){Ca.zoom=Xt;var po=Ca.numPoints||1;Qr+=Ca.x*po,Kn+=Ca.y*po,Ca.parentId=fi,Ge&&(ai||(ai=this._map(ar,!0)),Ge(ai,this._map(Ca)))}}ar.parentId=fi,ae.push(ye(Qr/an,Kn/an,fi,an,ai))}else if(ae.push(ar),an>1)for(var La=0,Va=Tn;La<Va.length;La+=1){var _a=Hr.points[Va[La]];_a.zoom<=Xt||(_a.zoom=Xt,ae.push(_a))}}}return ae},re.prototype._getOriginId=function(Rt){return Rt-this.points.length>>5},re.prototype._getOriginZoom=function(Rt){return(Rt-this.points.length)%32},re.prototype._map=function(Rt,Xt){if(Rt.numPoints)return Xt?bt({},Rt.properties):Rt.properties;var ae=this.points[Rt.index].properties,we=this.options.map(ae);return Xt&&we===ae?bt({},we):we},Nn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Nn.prototype.splitTile=function(Rt,Xt,ae,we,Ge,cr,br){for(var Ce=[Rt,Xt,ae,we],ar=this.options,Hr=ar.debug;Ce.length;){we=Ce.pop(),ae=Ce.pop(),Xt=Ce.pop(),Rt=Ce.pop();var Tn=1<<Xt,Kr=Zn(Xt,ae,we),an=this.tiles[Kr];if(!an&&(Hr>1&&console.time("creation"),an=this.tiles[Kr]=Gr(Rt,Xt,ae,we,ar),this.tileCoords.push({z:Xt,x:ae,y:we}),Hr)){Hr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Xt,ae,we,an.numFeatures,an.numPoints,an.numSimplified),console.timeEnd("creation"));var Pn="z"+Xt;this.stats[Pn]=(this.stats[Pn]||0)+1,this.total++}if(an.source=Rt,Ge){if(Xt===ar.maxZoom||Xt===Ge)continue;var xi=1<<Ge-Xt;if(ae!==Math.floor(cr/xi)||we!==Math.floor(br/xi))continue}else if(Xt===ar.indexMaxZoom||an.numPoints<=ar.indexMaxPoints)continue;if(an.source=null,Rt.length!==0){Hr>1&&console.time("clipping");var Ci,Qr,Kn,ai,fi,oa,Ai=.5*ar.buffer/ar.extent,Ca=.5-Ai,po=.5+Ai,La=1+Ai;Ci=Qr=Kn=ai=null,fi=tt(Rt,Tn,ae-Ai,ae+po,0,an.minX,an.maxX,ar),oa=tt(Rt,Tn,ae+Ca,ae+La,0,an.minX,an.maxX,ar),Rt=null,fi&&(Ci=tt(fi,Tn,we-Ai,we+po,1,an.minY,an.maxY,ar),Qr=tt(fi,Tn,we+Ca,we+La,1,an.minY,an.maxY,ar),fi=null),oa&&(Kn=tt(oa,Tn,we-Ai,we+po,1,an.minY,an.maxY,ar),ai=tt(oa,Tn,we+Ca,we+La,1,an.minY,an.maxY,ar),oa=null),Hr>1&&console.timeEnd("clipping"),Ce.push(Ci||[],Xt+1,2*ae,2*we),Ce.push(Qr||[],Xt+1,2*ae,2*we+1),Ce.push(Kn||[],Xt+1,2*ae+1,2*we),Ce.push(ai||[],Xt+1,2*ae+1,2*we+1)}}},Nn.prototype.getTile=function(Rt,Xt,ae){var we=this.options,Ge=we.extent,cr=we.debug;if(Rt<0||Rt>24)return null;var br=1<<Rt,Ce=Zn(Rt,Xt=(Xt%br+br)%br,ae);if(this.tiles[Ce])return Nr(this.tiles[Ce],Ge);cr>1&&console.log("drilling down to z%d-%d-%d",Rt,Xt,ae);for(var ar,Hr=Rt,Tn=Xt,Kr=ae;!ar&&Hr>0;)Hr--,Tn=Math.floor(Tn/2),Kr=Math.floor(Kr/2),ar=this.tiles[Zn(Hr,Tn,Kr)];return ar&&ar.source?(cr>1&&console.log("found parent tile z%d-%d-%d",Hr,Tn,Kr),cr>1&&console.time("drilling down"),this.splitTile(ar.source,Hr,Tn,Kr,Rt,Xt,ae),cr>1&&console.timeEnd("drilling down"),this.tiles[Ce]?Nr(this.tiles[Ce],Ge):null):null};var An=function(Rt){function Xt(ae,we,Ge,cr){Rt.call(this,ae,we,Ge,Hn),cr&&(this.loadGeoJSON=cr)}return Rt&&(Xt.__proto__=Rt),(Xt.prototype=Object.create(Rt&&Rt.prototype)).constructor=Xt,Xt.prototype.loadData=function(ae,we){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=we,this._pendingLoadDataParams=ae,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Xt.prototype._loadData=function(){var ae=this;if(this._pendingCallback&&this._pendingLoadDataParams){var we=this._pendingCallback,Ge=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var cr=!!(Ge&&Ge.request&&Ge.request.collectResourceTiming)&&new k.RequestPerformance(Ge.request);this.loadGeoJSON(Ge,function(br,Ce){if(br||!Ce)return we(br);if(typeof Ce!="object")return we(new Error("Input data given to '"+Ge.source+"' is not a valid GeoJSON object."));(function an(Pn,xi){var Ci,Qr=Pn&&Pn.type;if(Qr==="FeatureCollection")for(Ci=0;Ci<Pn.features.length;Ci++)an(Pn.features[Ci],xi);else if(Qr==="GeometryCollection")for(Ci=0;Ci<Pn.geometries.length;Ci++)an(Pn.geometries[Ci],xi);else if(Qr==="Feature")an(Pn.geometry,xi);else if(Qr==="Polygon")P(Pn.coordinates,xi);else if(Qr==="MultiPolygon")for(Ci=0;Ci<Pn.coordinates.length;Ci++)P(Pn.coordinates[Ci],xi);return Pn})(Ce,!0);try{if(Ge.filter){var ar=k.createExpression(Ge.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ar.result==="error")throw new Error(ar.value.map(function(an){return an.key+": "+an.message}).join(", "));var Hr=Ce.features.filter(function(an){return ar.value.evaluate({zoom:0},an)});Ce={type:"FeatureCollection",features:Hr}}ae._geoJSONIndex=Ge.cluster?new re(function(an){var Pn=an.superclusterOptions,xi=an.clusterProperties;if(!xi||!Pn)return Pn;for(var Ci={},Qr={},Kn={accumulated:null,zoom:0},ai={properties:null},fi=Object.keys(xi),oa=0,Ai=fi;oa<Ai.length;oa+=1){var Ca=Ai[oa],po=xi[Ca],La=po[0],Va=k.createExpression(po[1]),_a=k.createExpression(typeof La=="string"?[La,["accumulated"],["get",Ca]]:La);Ci[Ca]=Va.value,Qr[Ca]=_a.value}return Pn.map=function(ma){ai.properties=ma;for(var Qa={},Uo=0,vo=fi;Uo<vo.length;Uo+=1){var Ua=vo[Uo];Qa[Ua]=Ci[Ua].evaluate(Kn,ai)}return Qa},Pn.reduce=function(ma,Qa){ai.properties=Qa;for(var Uo=0,vo=fi;Uo<vo.length;Uo+=1){var Ua=vo[Uo];Kn.accumulated=ma[Ua],ma[Ua]=Qr[Ua].evaluate(Kn,ai)}},Pn}(Ge)).load(Ce.features):function(an,Pn){return new Nn(an,Pn)}(Ce,Ge.geojsonVtOptions)}catch(an){return we(an)}ae.loaded={};var Tn={};if(cr){var Kr=cr.finish();Kr&&(Tn.resourceTiming={},Tn.resourceTiming[Ge.source]=JSON.parse(JSON.stringify(Kr)))}we(null,Tn)})}},Xt.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Xt.prototype.reloadTile=function(ae,we){var Ge=this.loaded;return Ge&&Ge[ae.uid]?Rt.prototype.reloadTile.call(this,ae,we):this.loadTile(ae,we)},Xt.prototype.loadGeoJSON=function(ae,we){if(ae.request)k.getJSON(ae.request,we);else{if(typeof ae.data!="string")return we(new Error("Input data given to '"+ae.source+"' is not a valid GeoJSON object."));try{return we(null,JSON.parse(ae.data))}catch(Ge){return we(new Error("Input data given to '"+ae.source+"' is not a valid GeoJSON object."))}}},Xt.prototype.removeSource=function(ae,we){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),we()},Xt.prototype.getClusterExpansionZoom=function(ae,we){try{we(null,this._geoJSONIndex.getClusterExpansionZoom(ae.clusterId))}catch(Ge){we(Ge)}},Xt.prototype.getClusterChildren=function(ae,we){try{we(null,this._geoJSONIndex.getChildren(ae.clusterId))}catch(Ge){we(Ge)}},Xt.prototype.getClusterLeaves=function(ae,we){try{we(null,this._geoJSONIndex.getLeaves(ae.clusterId,ae.limit,ae.offset))}catch(Ge){we(Ge)}},Xt}(ot),$n=function(Rt){var Xt=this;this.self=Rt,this.actor=new k.Actor(Rt,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:ot,geojson:An},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ae,we){if(Xt.workerSourceTypes[ae])throw new Error('Worker source with name "'+ae+'" already registered.');Xt.workerSourceTypes[ae]=we},this.self.registerRTLTextPlugin=function(ae){if(k.plugin.isParsed())throw new Error("RTL text plugin already registered.");k.plugin.applyArabicShaping=ae.applyArabicShaping,k.plugin.processBidirectionalText=ae.processBidirectionalText,k.plugin.processStyledBidirectionalText=ae.processStyledBidirectionalText}};return $n.prototype.setReferrer=function(Rt,Xt){this.referrer=Xt},$n.prototype.setImages=function(Rt,Xt,ae){for(var we in this.availableImages[Rt]=Xt,this.workerSources[Rt]){var Ge=this.workerSources[Rt][we];for(var cr in Ge)Ge[cr].availableImages=Xt}ae()},$n.prototype.setLayers=function(Rt,Xt,ae){this.getLayerIndex(Rt).replace(Xt),ae()},$n.prototype.updateLayers=function(Rt,Xt,ae){this.getLayerIndex(Rt).update(Xt.layers,Xt.removedIds),ae()},$n.prototype.loadTile=function(Rt,Xt,ae){this.getWorkerSource(Rt,Xt.type,Xt.source).loadTile(Xt,ae)},$n.prototype.loadDEMTile=function(Rt,Xt,ae){this.getDEMWorkerSource(Rt,Xt.source).loadTile(Xt,ae)},$n.prototype.reloadTile=function(Rt,Xt,ae){this.getWorkerSource(Rt,Xt.type,Xt.source).reloadTile(Xt,ae)},$n.prototype.abortTile=function(Rt,Xt,ae){this.getWorkerSource(Rt,Xt.type,Xt.source).abortTile(Xt,ae)},$n.prototype.removeTile=function(Rt,Xt,ae){this.getWorkerSource(Rt,Xt.type,Xt.source).removeTile(Xt,ae)},$n.prototype.removeDEMTile=function(Rt,Xt){this.getDEMWorkerSource(Rt,Xt.source).removeTile(Xt)},$n.prototype.removeSource=function(Rt,Xt,ae){if(this.workerSources[Rt]&&this.workerSources[Rt][Xt.type]&&this.workerSources[Rt][Xt.type][Xt.source]){var we=this.workerSources[Rt][Xt.type][Xt.source];delete this.workerSources[Rt][Xt.type][Xt.source],we.removeSource!==void 0?we.removeSource(Xt,ae):ae()}},$n.prototype.loadWorkerSource=function(Rt,Xt,ae){try{this.self.importScripts(Xt.url),ae()}catch(we){ae(we.toString())}},$n.prototype.syncRTLPluginState=function(Rt,Xt,ae){try{k.plugin.setState(Xt);var we=k.plugin.getPluginURL();if(k.plugin.isLoaded()&&!k.plugin.isParsed()&&we!=null){this.self.importScripts(we);var Ge=k.plugin.isParsed();ae(Ge?void 0:new Error("RTL Text Plugin failed to import scripts from "+we),Ge)}}catch(cr){ae(cr.toString())}},$n.prototype.getAvailableImages=function(Rt){var Xt=this.availableImages[Rt];return Xt||(Xt=[]),Xt},$n.prototype.getLayerIndex=function(Rt){var Xt=this.layerIndexes[Rt];return Xt||(Xt=this.layerIndexes[Rt]=new yt),Xt},$n.prototype.getWorkerSource=function(Rt,Xt,ae){var we=this;return this.workerSources[Rt]||(this.workerSources[Rt]={}),this.workerSources[Rt][Xt]||(this.workerSources[Rt][Xt]={}),this.workerSources[Rt][Xt][ae]||(this.workerSources[Rt][Xt][ae]=new this.workerSourceTypes[Xt]({send:function(Ge,cr,br){we.actor.send(Ge,cr,br,Rt)}},this.getLayerIndex(Rt),this.getAvailableImages(Rt))),this.workerSources[Rt][Xt][ae]},$n.prototype.getDEMWorkerSource=function(Rt,Xt){return this.demWorkerSources[Rt]||(this.demWorkerSources[Rt]={}),this.demWorkerSources[Rt][Xt]||(this.demWorkerSources[Rt][Xt]=new zt),this.demWorkerSources[Rt][Xt]},$n.prototype.enforceCacheSizeLimit=function(Rt,Xt){k.enforceCacheSizeLimit(Xt)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new $n(self)),$n}),mt(["./shared"],function(k){"use strict";var Et=k.createCommonjsModule(function(x){function C(U){return!E(U)}function E(U){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var $,ht,Ut=new Blob([""],{type:"text/javascript"}),ie=URL.createObjectURL(Ut);try{ht=new Worker(ie),$=!0}catch(Be){$=!1}return ht&&ht.terminate(),URL.revokeObjectURL(ie),$}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var $=document.createElement("canvas");$.width=$.height=1;var ht=$.getContext("2d");if(!ht)return!1;var Ut=ht.getImageData(0,0,1,1);return Ut&&Ut.width===$.width}()?(M[H=U&&U.failIfMajorPerformanceCaveat]===void 0&&(M[H]=function($){var ht=function(ie){var Be=document.createElement("canvas"),De=Object.create(C.webGLContextAttributes);return De.failIfMajorPerformanceCaveat=ie,Be.probablySupportsContext?Be.probablySupportsContext("webgl",De)||Be.probablySupportsContext("experimental-webgl",De):Be.supportsContext?Be.supportsContext("webgl",De)||Be.supportsContext("experimental-webgl",De):Be.getContext("webgl",De)||Be.getContext("experimental-webgl",De)}($);if(!ht)return!1;var Ut=ht.createShader(ht.VERTEX_SHADER);return!(!Ut||ht.isContextLost())&&(ht.shaderSource(Ut,"void main() {}"),ht.compileShader(Ut),ht.getShaderParameter(Ut,ht.COMPILE_STATUS)===!0)}(H)),M[H]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var H}x.exports?x.exports=C:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=C,window.mapboxgl.notSupportedReason=E);var M={};C.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),K={create:function(x,C,E){var M=k.window.document.createElement(x);return C!==void 0&&(M.className=C),E&&E.appendChild(M),M},createNS:function(x,C){return k.window.document.createElementNS(x,C)}},yt=k.window.document&&k.window.document.documentElement.style;function J(x){if(!yt)return x[0];for(var C=0;C<x.length;C++)if(x[C]in yt)return x[C];return x[0]}var pt,et=J(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);K.disableDrag=function(){yt&&et&&(pt=yt[et],yt[et]="none")},K.enableDrag=function(){yt&&et&&(yt[et]=pt)};var be=J(["transform","WebkitTransform"]);K.setTransform=function(x,C){x.style[be]=C};var ot=!1;try{var ut=Object.defineProperty({},"passive",{get:function(){ot=!0}});k.window.addEventListener("test",ut,ut),k.window.removeEventListener("test",ut,ut)}catch(x){ot=!1}K.addEventListener=function(x,C,E,M){M===void 0&&(M={}),x.addEventListener(C,E,"passive"in M&&ot?M:M.capture)},K.removeEventListener=function(x,C,E,M){M===void 0&&(M={}),x.removeEventListener(C,E,"passive"in M&&ot?M:M.capture)};var zt=function(x){x.preventDefault(),x.stopPropagation(),k.window.removeEventListener("click",zt,!0)};function P(x){var C=x.userImage;return!!(C&&C.render&&C.render())&&(x.data.replace(new Uint8Array(C.data.buffer)),!0)}K.suppressClick=function(){k.window.addEventListener("click",zt,!0),k.window.setTimeout(function(){k.window.removeEventListener("click",zt,!0)},0)},K.mousePos=function(x,C){var E=x.getBoundingClientRect();return new k.Point(C.clientX-E.left-x.clientLeft,C.clientY-E.top-x.clientTop)},K.touchPos=function(x,C){for(var E=x.getBoundingClientRect(),M=[],U=0;U<C.length;U++)M.push(new k.Point(C[U].clientX-E.left-x.clientLeft,C[U].clientY-E.top-x.clientTop));return M},K.mouseButton=function(x){return k.window.InstallTrigger!==void 0&&x.button===2&&x.ctrlKey&&k.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:x.button},K.remove=function(x){x.parentNode&&x.parentNode.removeChild(x)};var b=function(x){function C(){x.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new k.RGBAImage({width:1,height:1}),this.dirty=!0}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.isLoaded=function(){return this.loaded},C.prototype.setLoaded=function(E){if(this.loaded!==E&&(this.loaded=E,E)){for(var M=0,U=this.requestors;M<U.length;M+=1){var H=U[M];this._notify(H.ids,H.callback)}this.requestors=[]}},C.prototype.getImage=function(E){return this.images[E]},C.prototype.addImage=function(E,M){this._validate(E,M)&&(this.images[E]=M)},C.prototype._validate=function(E,M){var U=!0;return this._validateStretch(M.stretchX,M.data&&M.data.width)||(this.fire(new k.ErrorEvent(new Error('Image "'+E+'" has invalid "stretchX" value'))),U=!1),this._validateStretch(M.stretchY,M.data&&M.data.height)||(this.fire(new k.ErrorEvent(new Error('Image "'+E+'" has invalid "stretchY" value'))),U=!1),this._validateContent(M.content,M)||(this.fire(new k.ErrorEvent(new Error('Image "'+E+'" has invalid "content" value'))),U=!1),U},C.prototype._validateStretch=function(E,M){if(!E)return!0;for(var U=0,H=0,$=E;H<$.length;H+=1){var ht=$[H];if(ht[0]<U||ht[1]<ht[0]||M<ht[1])return!1;U=ht[1]}return!0},C.prototype._validateContent=function(E,M){return!(E&&(E.length!==4||E[0]<0||M.data.width<E[0]||E[1]<0||M.data.height<E[1]||E[2]<0||M.data.width<E[2]||E[3]<0||M.data.height<E[3]||E[2]<E[0]||E[3]<E[1]))},C.prototype.updateImage=function(E,M){M.version=this.images[E].version+1,this.images[E]=M,this.updatedImages[E]=!0},C.prototype.removeImage=function(E){var M=this.images[E];delete this.images[E],delete this.patterns[E],M.userImage&&M.userImage.onRemove&&M.userImage.onRemove()},C.prototype.listImages=function(){return Object.keys(this.images)},C.prototype.getImages=function(E,M){var U=!0;if(!this.isLoaded())for(var H=0,$=E;H<$.length;H+=1)this.images[$[H]]||(U=!1);this.isLoaded()||U?this._notify(E,M):this.requestors.push({ids:E,callback:M})},C.prototype._notify=function(E,M){for(var U={},H=0,$=E;H<$.length;H+=1){var ht=$[H];this.images[ht]||this.fire(new k.Event("styleimagemissing",{id:ht}));var Ut=this.images[ht];Ut?U[ht]={data:Ut.data.clone(),pixelRatio:Ut.pixelRatio,sdf:Ut.sdf,version:Ut.version,stretchX:Ut.stretchX,stretchY:Ut.stretchY,content:Ut.content,hasRenderCallback:Boolean(Ut.userImage&&Ut.userImage.render)}:k.warnOnce('Image "'+ht+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}M(null,U)},C.prototype.getPixelSize=function(){var E=this.atlasImage;return{width:E.width,height:E.height}},C.prototype.getPattern=function(E){var M=this.patterns[E],U=this.getImage(E);if(!U)return null;if(M&&M.position.version===U.version)return M.position;if(M)M.position.version=U.version;else{var H={w:U.data.width+2,h:U.data.height+2,x:0,y:0},$=new k.ImagePosition(H,U);this.patterns[E]={bin:H,position:$}}return this._updatePatternAtlas(),this.patterns[E].position},C.prototype.bind=function(E){var M=E.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new k.Texture(E,this.atlasImage,M.RGBA),this.atlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE)},C.prototype._updatePatternAtlas=function(){var E=[];for(var M in this.patterns)E.push(this.patterns[M].bin);var U=k.potpack(E),H=U.w,$=U.h,ht=this.atlasImage;for(var Ut in ht.resize({width:H||1,height:$||1}),this.patterns){var ie=this.patterns[Ut].bin,Be=ie.x+1,De=ie.y+1,Ne=this.images[Ut].data,fr=Ne.width,$e=Ne.height;k.RGBAImage.copy(Ne,ht,{x:0,y:0},{x:Be,y:De},{width:fr,height:$e}),k.RGBAImage.copy(Ne,ht,{x:0,y:$e-1},{x:Be,y:De-1},{width:fr,height:1}),k.RGBAImage.copy(Ne,ht,{x:0,y:0},{x:Be,y:De+$e},{width:fr,height:1}),k.RGBAImage.copy(Ne,ht,{x:fr-1,y:0},{x:Be-1,y:De},{width:1,height:$e}),k.RGBAImage.copy(Ne,ht,{x:0,y:0},{x:Be+fr,y:De},{width:1,height:$e})}this.dirty=!0},C.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},C.prototype.dispatchRenderCallbacks=function(E){for(var M=0,U=E;M<U.length;M+=1){var H=U[M];if(!this.callbackDispatchedThisFrame[H]){this.callbackDispatchedThisFrame[H]=!0;var $=this.images[H];P($)&&this.updateImage(H,$)}}},C}(k.Evented),W=ke,le=ke,Ee=1e20;function ke(x,C,E,M,U,H){this.fontSize=x||24,this.buffer=C===void 0?3:C,this.cutoff=M||.25,this.fontFamily=U||"sans-serif",this.fontWeight=H||"normal",this.radius=E||8;var $=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=$,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array($*$),this.gridInner=new Float64Array($*$),this.f=new Float64Array($),this.d=new Float64Array($),this.z=new Float64Array($+1),this.v=new Int16Array($),this.middle=Math.round($/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Tt(x,C,E,M,U,H,$){for(var ht=0;ht<C;ht++){for(var Ut=0;Ut<E;Ut++)M[Ut]=x[Ut*C+ht];for(rt(M,U,H,$,E),Ut=0;Ut<E;Ut++)x[Ut*C+ht]=U[Ut]}for(Ut=0;Ut<E;Ut++){for(ht=0;ht<C;ht++)M[ht]=x[Ut*C+ht];for(rt(M,U,H,$,C),ht=0;ht<C;ht++)x[Ut*C+ht]=Math.sqrt(U[ht])}}function rt(x,C,E,M,U){E[0]=0,M[0]=-Ee,M[1]=+Ee;for(var H=1,$=0;H<U;H++){for(var ht=(x[H]+H*H-(x[E[$]]+E[$]*E[$]))/(2*H-2*E[$]);ht<=M[$];)$--,ht=(x[H]+H*H-(x[E[$]]+E[$]*E[$]))/(2*H-2*E[$]);E[++$]=H,M[$]=ht,M[$+1]=+Ee}for(H=0,$=0;H<U;H++){for(;M[$+1]<H;)$++;C[H]=(H-E[$])*(H-E[$])+x[E[$]]}}ke.prototype.draw=function(x){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(x,this.buffer,this.middle);for(var C=this.ctx.getImageData(0,0,this.size,this.size),E=new Uint8ClampedArray(this.size*this.size),M=0;M<this.size*this.size;M++){var U=C.data[4*M+3]/255;this.gridOuter[M]=U===1?0:U===0?Ee:Math.pow(Math.max(0,.5-U),2),this.gridInner[M]=U===1?Ee:U===0?0:Math.pow(Math.max(0,U-.5),2)}for(Tt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Tt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),M=0;M<this.size*this.size;M++)E[M]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[M]-this.gridInner[M])/this.radius+this.cutoff))));return E},W.default=le;var Dt=function(x,C){this.requestManager=x,this.localIdeographFontFamily=C,this.entries={}};Dt.prototype.setURL=function(x){this.url=x},Dt.prototype.getGlyphs=function(x,C){var E=this,M=[];for(var U in x)for(var H=0,$=x[U];H<$.length;H+=1)M.push({stack:U,id:$[H]});k.asyncAll(M,function(ht,Ut){var ie=ht.stack,Be=ht.id,De=E.entries[ie];De||(De=E.entries[ie]={glyphs:{},requests:{},ranges:{}});var Ne=De.glyphs[Be];if(Ne===void 0){if(Ne=E._tinySDF(De,ie,Be))return De.glyphs[Be]=Ne,void Ut(null,{stack:ie,id:Be,glyph:Ne});var fr=Math.floor(Be/256);if(256*fr>65535)Ut(new Error("glyphs > 65535 not supported"));else if(De.ranges[fr])Ut(null,{stack:ie,id:Be,glyph:Ne});else{var $e=De.requests[fr];$e||($e=De.requests[fr]=[],Dt.loadGlyphRange(ie,fr,E.url,E.requestManager,function(_r,er){if(er){for(var Er in er)E._doesCharSupportLocalGlyph(+Er)||(De.glyphs[+Er]=er[+Er]);De.ranges[fr]=!0}for(var Or=0,Yr=$e;Or<Yr.length;Or+=1)(0,Yr[Or])(_r,er);delete De.requests[fr]})),$e.push(function(_r,er){_r?Ut(_r):er&&Ut(null,{stack:ie,id:Be,glyph:er[Be]||null})})}}else Ut(null,{stack:ie,id:Be,glyph:Ne})},function(ht,Ut){if(ht)C(ht);else if(Ut){for(var ie={},Be=0,De=Ut;Be<De.length;Be+=1){var Ne=De[Be],fr=Ne.stack,$e=Ne.id,_r=Ne.glyph;(ie[fr]||(ie[fr]={}))[$e]=_r&&{id:_r.id,bitmap:_r.bitmap.clone(),metrics:_r.metrics}}C(null,ie)}})},Dt.prototype._doesCharSupportLocalGlyph=function(x){return!!this.localIdeographFontFamily&&(k.isChar["CJK Unified Ideographs"](x)||k.isChar["Hangul Syllables"](x)||k.isChar.Hiragana(x)||k.isChar.Katakana(x))},Dt.prototype._tinySDF=function(x,C,E){var M=this.localIdeographFontFamily;if(M&&this._doesCharSupportLocalGlyph(E)){var U=x.tinySDF;if(!U){var H="400";/bold/i.test(C)?H="900":/medium/i.test(C)?H="500":/light/i.test(C)&&(H="200"),U=x.tinySDF=new Dt.TinySDF(24,3,8,.25,M,H)}return{id:E,bitmap:new k.AlphaImage({width:30,height:30},U.draw(String.fromCharCode(E))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Dt.loadGlyphRange=function(x,C,E,M,U){var H=256*C,$=H+255,ht=M.transformRequest(M.normalizeGlyphsURL(E).replace("{fontstack}",x).replace("{range}",H+"-"+$),k.ResourceType.Glyphs);k.getArrayBuffer(ht,function(Ut,ie){if(Ut)U(Ut);else if(ie){for(var Be={},De=0,Ne=k.parseGlyphPBF(ie);De<Ne.length;De+=1){var fr=Ne[De];Be[fr.id]=fr}U(null,Be)}})},Dt.TinySDF=W;var Se=function(){this.specification=k.styleSpec.light.position};Se.prototype.possiblyEvaluate=function(x,C){return k.sphericalToCartesian(x.expression.evaluate(C))},Se.prototype.interpolate=function(x,C,E){return{x:k.number(x.x,C.x,E),y:k.number(x.y,C.y,E),z:k.number(x.z,C.z,E)}};var _e=new k.Properties({anchor:new k.DataConstantProperty(k.styleSpec.light.anchor),position:new Se,color:new k.DataConstantProperty(k.styleSpec.light.color),intensity:new k.DataConstantProperty(k.styleSpec.light.intensity)}),ve=function(x){function C(E){x.call(this),this._transitionable=new k.Transitionable(_e),this.setLight(E),this._transitioning=this._transitionable.untransitioned()}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getLight=function(){return this._transitionable.serialize()},C.prototype.setLight=function(E,M){if(M===void 0&&(M={}),!this._validate(k.validateLight,E,M))for(var U in E){var H=E[U];k.endsWith(U,"-transition")?this._transitionable.setTransition(U.slice(0,-11),H):this._transitionable.setValue(U,H)}},C.prototype.updateTransitions=function(E){this._transitioning=this._transitionable.transitioned(E,this._transitioning)},C.prototype.hasTransition=function(){return this._transitioning.hasTransition()},C.prototype.recalculate=function(E){this.properties=this._transitioning.possiblyEvaluate(E)},C.prototype._validate=function(E,M,U){return(!U||U.validate!==!1)&&k.emitValidationErrors(this,E.call(k.validateStyle,k.extend({value:M,style:{glyphs:!0,sprite:!0},styleSpec:k.styleSpec})))},C}(k.Evented),ne=function(x,C){this.width=x,this.height=C,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ne.prototype.getDash=function(x,C){var E=x.join(",")+String(C);return this.dashEntry[E]||(this.dashEntry[E]=this.addDash(x,C)),this.dashEntry[E]},ne.prototype.getDashRanges=function(x,C,E){var M=[],U=x.length%2==1?-x[x.length-1]*E:0,H=x[0]*E,$=!0;M.push({left:U,right:H,isDash:$,zeroLength:x[0]===0});for(var ht=x[0],Ut=1;Ut<x.length;Ut++){var ie=x[Ut];M.push({left:U=ht*E,right:H=(ht+=ie)*E,isDash:$=!$,zeroLength:ie===0})}return M},ne.prototype.addRoundDash=function(x,C,E){for(var M=C/2,U=-E;U<=E;U++)for(var H=this.width*(this.nextRow+E+U),$=0,ht=x[$],Ut=0;Ut<this.width;Ut++){Ut/ht.right>1&&(ht=x[++$]);var ie=Math.abs(Ut-ht.left),Be=Math.abs(Ut-ht.right),De=Math.min(ie,Be),Ne=void 0,fr=U/E*(M+1);if(ht.isDash){var $e=M-Math.abs(fr);Ne=Math.sqrt(De*De+$e*$e)}else Ne=M-Math.sqrt(De*De+fr*fr);this.data[H+Ut]=Math.max(0,Math.min(255,Ne+128))}},ne.prototype.addRegularDash=function(x){for(var C=x.length-1;C>=0;--C){var E=x[C],M=x[C+1];E.zeroLength?x.splice(C,1):M&&M.isDash===E.isDash&&(M.left=E.left,x.splice(C,1))}var U=x[0],H=x[x.length-1];U.isDash===H.isDash&&(U.left=H.left-this.width,H.right=U.right+this.width);for(var $=this.width*this.nextRow,ht=0,Ut=x[ht],ie=0;ie<this.width;ie++){ie/Ut.right>1&&(Ut=x[++ht]);var Be=Math.abs(ie-Ut.left),De=Math.abs(ie-Ut.right),Ne=Math.min(Be,De);this.data[$+ie]=Math.max(0,Math.min(255,(Ut.isDash?Ne:-Ne)+128))}},ne.prototype.addDash=function(x,C){var E=C?7:0,M=2*E+1;if(this.nextRow+M>this.height)return k.warnOnce("LineAtlas out of space"),null;for(var U=0,H=0;H<x.length;H++)U+=x[H];if(U!==0){var $=this.width/U,ht=this.getDashRanges(x,this.width,$);C?this.addRoundDash(ht,$,E):this.addRegularDash(ht)}var Ut={y:(this.nextRow+E+.5)/this.height,height:2*E/this.height,width:U};return this.nextRow+=M,this.dirty=!0,Ut},ne.prototype.bind=function(x){var C=x.gl;this.texture?(C.bindTexture(C.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,C.texSubImage2D(C.TEXTURE_2D,0,0,0,this.width,this.height,C.ALPHA,C.UNSIGNED_BYTE,this.data))):(this.texture=C.createTexture(),C.bindTexture(C.TEXTURE_2D,this.texture),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.LINEAR),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.LINEAR),C.texImage2D(C.TEXTURE_2D,0,C.ALPHA,this.width,this.height,0,C.ALPHA,C.UNSIGNED_BYTE,this.data))};var xe=function x(C,E){this.workerPool=C,this.actors=[],this.currentActor=0,this.id=k.uniqueId();for(var M=this.workerPool.acquire(this.id),U=0;U<M.length;U++){var H=new x.Actor(M[U],E,this.id);H.name="Worker "+U,this.actors.push(H)}};function Je(x,C,E){var M=function(U,H){if(U)return E(U);if(H){var $=k.pick(k.extend(H,x),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);H.vector_layers&&($.vectorLayers=H.vector_layers,$.vectorLayerIds=$.vectorLayers.map(function(ht){return ht.id})),$.tiles=C.canonicalizeTileset($,x.url),E(null,$)}};return x.url?k.getJSON(C.transformRequest(C.normalizeSourceURL(x.url),k.ResourceType.Source),M):k.browser.frame(function(){return M(null,x)})}xe.prototype.broadcast=function(x,C,E){k.asyncAll(this.actors,function(M,U){M.send(x,C,U)},E=E||function(){})},xe.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},xe.prototype.remove=function(){this.actors.forEach(function(x){x.remove()}),this.actors=[],this.workerPool.release(this.id)},xe.Actor=k.Actor;var Ot=function(x,C,E){this.bounds=k.LngLatBounds.convert(this.validateBounds(x)),this.minzoom=C||0,this.maxzoom=E||24};Ot.prototype.validateBounds=function(x){return Array.isArray(x)&&x.length===4?[Math.max(-180,x[0]),Math.max(-90,x[1]),Math.min(180,x[2]),Math.min(90,x[3])]:[-180,-90,180,90]},Ot.prototype.contains=function(x){var C=Math.pow(2,x.z),E=Math.floor(k.mercatorXfromLng(this.bounds.getWest())*C),M=Math.floor(k.mercatorYfromLat(this.bounds.getNorth())*C),U=Math.ceil(k.mercatorXfromLng(this.bounds.getEast())*C),H=Math.ceil(k.mercatorYfromLat(this.bounds.getSouth())*C);return x.x>=E&&x.x<U&&x.y>=M&&x.y<H};var te=function(x){function C(E,M,U,H){if(x.call(this),this.id=E,this.dispatcher=U,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,k.extend(this,k.pick(M,["url","scheme","tileSize","promoteId"])),this._options=k.extend({type:"vector"},M),this._collectResourceTiming=M.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(H)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var E=this;this._loaded=!1,this.fire(new k.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Je(this._options,this.map._requestManager,function(M,U){E._tileJSONRequest=null,E._loaded=!0,M?E.fire(new k.ErrorEvent(M)):U&&(k.extend(E,U),U.bounds&&(E.tileBounds=new Ot(U.bounds,E.minzoom,E.maxzoom)),k.postTurnstileEvent(U.tiles,E.map._requestManager._customAccessToken),k.postMapLoadEvent(U.tiles,E.map._getMapId(),E.map._requestManager._skuToken,E.map._requestManager._customAccessToken),E.fire(new k.Event("data",{dataType:"source",sourceDataType:"metadata"})),E.fire(new k.Event("data",{dataType:"source",sourceDataType:"content"})))})},C.prototype.loaded=function(){return this._loaded},C.prototype.hasTile=function(E){return!this.tileBounds||this.tileBounds.contains(E.canonical)},C.prototype.onAdd=function(E){this.map=E,this.load()},C.prototype.setSourceProperty=function(E){this._tileJSONRequest&&this._tileJSONRequest.cancel(),E(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},C.prototype.setTiles=function(E){var M=this;return this.setSourceProperty(function(){M._options.tiles=E}),this},C.prototype.setUrl=function(E){var M=this;return this.setSourceProperty(function(){M.url=E,M._options.url=E}),this},C.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},C.prototype.serialize=function(){return k.extend({},this._options)},C.prototype.loadTile=function(E,M){var U=this.map._requestManager.normalizeTileURL(E.tileID.canonical.url(this.tiles,this.scheme)),H={request:this.map._requestManager.transformRequest(U,k.ResourceType.Tile),uid:E.uid,tileID:E.tileID,zoom:E.tileID.overscaledZ,tileSize:this.tileSize*E.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:k.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function $(ht,Ut){return delete E.request,E.aborted?M(null):ht&&ht.status!==404?M(ht):(Ut&&Ut.resourceTiming&&(E.resourceTiming=Ut.resourceTiming),this.map._refreshExpiredTiles&&Ut&&E.setExpiryData(Ut),E.loadVectorData(Ut,this.map.painter),k.cacheEntryPossiblyAdded(this.dispatcher),M(null),void(E.reloadCallback&&(this.loadTile(E,E.reloadCallback),E.reloadCallback=null)))}H.request.collectResourceTiming=this._collectResourceTiming,E.actor&&E.state!=="expired"?E.state==="loading"?E.reloadCallback=M:E.request=E.actor.send("reloadTile",H,$.bind(this)):(E.actor=this.dispatcher.getActor(),E.request=E.actor.send("loadTile",H,$.bind(this)))},C.prototype.abortTile=function(E){E.request&&(E.request.cancel(),delete E.request),E.actor&&E.actor.send("abortTile",{uid:E.uid,type:this.type,source:this.id},void 0)},C.prototype.unloadTile=function(E){E.unloadVectorData(),E.actor&&E.actor.send("removeTile",{uid:E.uid,type:this.type,source:this.id},void 0)},C.prototype.hasTransition=function(){return!1},C}(k.Evented),ft=function(x){function C(E,M,U,H){x.call(this),this.id=E,this.dispatcher=U,this.setEventedParent(H),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=k.extend({type:"raster"},M),k.extend(this,k.pick(M,["url","scheme","tileSize"]))}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var E=this;this._loaded=!1,this.fire(new k.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Je(this._options,this.map._requestManager,function(M,U){E._tileJSONRequest=null,E._loaded=!0,M?E.fire(new k.ErrorEvent(M)):U&&(k.extend(E,U),U.bounds&&(E.tileBounds=new Ot(U.bounds,E.minzoom,E.maxzoom)),k.postTurnstileEvent(U.tiles),k.postMapLoadEvent(U.tiles,E.map._getMapId(),E.map._requestManager._skuToken),E.fire(new k.Event("data",{dataType:"source",sourceDataType:"metadata"})),E.fire(new k.Event("data",{dataType:"source",sourceDataType:"content"})))})},C.prototype.loaded=function(){return this._loaded},C.prototype.onAdd=function(E){this.map=E,this.load()},C.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},C.prototype.serialize=function(){return k.extend({},this._options)},C.prototype.hasTile=function(E){return!this.tileBounds||this.tileBounds.contains(E.canonical)},C.prototype.loadTile=function(E,M){var U=this,H=this.map._requestManager.normalizeTileURL(E.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);E.request=k.getImage(this.map._requestManager.transformRequest(H,k.ResourceType.Tile),function($,ht){if(delete E.request,E.aborted)E.state="unloaded",M(null);else if($)E.state="errored",M($);else if(ht){U.map._refreshExpiredTiles&&E.setExpiryData(ht),delete ht.cacheControl,delete ht.expires;var Ut=U.map.painter.context,ie=Ut.gl;E.texture=U.map.painter.getTileTexture(ht.width),E.texture?E.texture.update(ht,{useMipmap:!0}):(E.texture=new k.Texture(Ut,ht,ie.RGBA,{useMipmap:!0}),E.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),Ut.extTextureFilterAnisotropic&&ie.texParameterf(ie.TEXTURE_2D,Ut.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ut.extTextureFilterAnisotropicMax)),E.state="loaded",k.cacheEntryPossiblyAdded(U.dispatcher),M(null)}})},C.prototype.abortTile=function(E,M){E.request&&(E.request.cancel(),delete E.request),M()},C.prototype.unloadTile=function(E,M){E.texture&&this.map.painter.saveTileTexture(E.texture),M()},C.prototype.hasTransition=function(){return!1},C}(k.Evented),wt=function(x){function C(E,M,U,H){x.call(this,E,M,U,H),this.type="raster-dem",this.maxzoom=22,this._options=k.extend({type:"raster-dem"},M),this.encoding=M.encoding||"mapbox"}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},C.prototype.loadTile=function(E,M){var U=this.map._requestManager.normalizeTileURL(E.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function H($,ht){$&&(E.state="errored",M($)),ht&&(E.dem=ht,E.needsHillshadePrepare=!0,E.state="loaded",M(null))}E.request=k.getImage(this.map._requestManager.transformRequest(U,k.ResourceType.Tile),function($,ht){if(delete E.request,E.aborted)E.state="unloaded",M(null);else if($)E.state="errored",M($);else if(ht){this.map._refreshExpiredTiles&&E.setExpiryData(ht),delete ht.cacheControl,delete ht.expires;var Ut=k.window.ImageBitmap&&ht instanceof k.window.ImageBitmap&&k.offscreenCanvasSupported()?ht:k.browser.getImageData(ht,1),ie={uid:E.uid,coord:E.tileID,source:this.id,rawImageData:Ut,encoding:this.encoding};E.actor&&E.state!=="expired"||(E.actor=this.dispatcher.getActor(),E.actor.send("loadDEMTile",ie,H.bind(this)))}}.bind(this)),E.neighboringTiles=this._getNeighboringTiles(E.tileID)},C.prototype._getNeighboringTiles=function(E){var M=E.canonical,U=Math.pow(2,M.z),H=(M.x-1+U)%U,$=M.x===0?E.wrap-1:E.wrap,ht=(M.x+1+U)%U,Ut=M.x+1===U?E.wrap+1:E.wrap,ie={};return ie[new k.OverscaledTileID(E.overscaledZ,$,M.z,H,M.y).key]={backfilled:!1},ie[new k.OverscaledTileID(E.overscaledZ,Ut,M.z,ht,M.y).key]={backfilled:!1},M.y>0&&(ie[new k.OverscaledTileID(E.overscaledZ,$,M.z,H,M.y-1).key]={backfilled:!1},ie[new k.OverscaledTileID(E.overscaledZ,E.wrap,M.z,M.x,M.y-1).key]={backfilled:!1},ie[new k.OverscaledTileID(E.overscaledZ,Ut,M.z,ht,M.y-1).key]={backfilled:!1}),M.y+1<U&&(ie[new k.OverscaledTileID(E.overscaledZ,$,M.z,H,M.y+1).key]={backfilled:!1},ie[new k.OverscaledTileID(E.overscaledZ,E.wrap,M.z,M.x,M.y+1).key]={backfilled:!1},ie[new k.OverscaledTileID(E.overscaledZ,Ut,M.z,ht,M.y+1).key]={backfilled:!1}),ie},C.prototype.unloadTile=function(E){E.demTexture&&this.map.painter.saveTileTexture(E.demTexture),E.fbo&&(E.fbo.destroy(),delete E.fbo),E.dem&&delete E.dem,delete E.neighboringTiles,E.state="unloaded",E.actor&&E.actor.send("removeDEMTile",{uid:E.uid,source:this.id})},C}(ft),Y=function(x){function C(E,M,U,H){x.call(this),this.id=E,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=U.getActor(),this.setEventedParent(H),this._data=M.data,this._options=k.extend({},M),this._collectResourceTiming=M.collectResourceTiming,this._resourceTiming=[],M.maxzoom!==void 0&&(this.maxzoom=M.maxzoom),M.type&&(this.type=M.type),M.attribution&&(this.attribution=M.attribution),this.promoteId=M.promoteId;var $=k.EXTENT/this.tileSize;this.workerOptions=k.extend({source:this.id,cluster:M.cluster||!1,geojsonVtOptions:{buffer:(M.buffer!==void 0?M.buffer:128)*$,tolerance:(M.tolerance!==void 0?M.tolerance:.375)*$,extent:k.EXTENT,maxZoom:this.maxzoom,lineMetrics:M.lineMetrics||!1,generateId:M.generateId||!1},superclusterOptions:{maxZoom:M.clusterMaxZoom!==void 0?Math.min(M.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,M.clusterMinPoints||2),extent:k.EXTENT,radius:(M.clusterRadius||50)*$,log:!1,generateId:M.generateId||!1},clusterProperties:M.clusterProperties,filter:M.filter},M.workerOptions)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var E=this;this.fire(new k.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(M){if(M)E.fire(new k.ErrorEvent(M));else{var U={dataType:"source",sourceDataType:"metadata"};E._collectResourceTiming&&E._resourceTiming&&E._resourceTiming.length>0&&(U.resourceTiming=E._resourceTiming,E._resourceTiming=[]),E.fire(new k.Event("data",U))}})},C.prototype.onAdd=function(E){this.map=E,this.load()},C.prototype.setData=function(E){var M=this;return this._data=E,this.fire(new k.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(U){if(U)M.fire(new k.ErrorEvent(U));else{var H={dataType:"source",sourceDataType:"content"};M._collectResourceTiming&&M._resourceTiming&&M._resourceTiming.length>0&&(H.resourceTiming=M._resourceTiming,M._resourceTiming=[]),M.fire(new k.Event("data",H))}}),this},C.prototype.getClusterExpansionZoom=function(E,M){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:E,source:this.id},M),this},C.prototype.getClusterChildren=function(E,M){return this.actor.send("geojson.getClusterChildren",{clusterId:E,source:this.id},M),this},C.prototype.getClusterLeaves=function(E,M,U,H){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:E,limit:M,offset:U},H),this},C.prototype._updateWorkerData=function(E){var M=this;this._loaded=!1;var U=k.extend({},this.workerOptions),H=this._data;typeof H=="string"?(U.request=this.map._requestManager.transformRequest(k.browser.resolveURL(H),k.ResourceType.Source),U.request.collectResourceTiming=this._collectResourceTiming):U.data=JSON.stringify(H),this.actor.send(this.type+".loadData",U,function($,ht){M._removed||ht&&ht.abandoned||(M._loaded=!0,ht&&ht.resourceTiming&&ht.resourceTiming[M.id]&&(M._resourceTiming=ht.resourceTiming[M.id].slice(0)),M.actor.send(M.type+".coalesce",{source:U.source},null),E($))})},C.prototype.loaded=function(){return this._loaded},C.prototype.loadTile=function(E,M){var U=this,H=E.actor?"reloadTile":"loadTile";E.actor=this.actor,E.request=this.actor.send(H,{type:this.type,uid:E.uid,tileID:E.tileID,zoom:E.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:k.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function($,ht){return delete E.request,E.unloadVectorData(),E.aborted?M(null):$?M($):(E.loadVectorData(ht,U.map.painter,H==="reloadTile"),M(null))})},C.prototype.abortTile=function(E){E.request&&(E.request.cancel(),delete E.request),E.aborted=!0},C.prototype.unloadTile=function(E){E.unloadVectorData(),this.actor.send("removeTile",{uid:E.uid,type:this.type,source:this.id})},C.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},C.prototype.serialize=function(){return k.extend({},this._options,{type:this.type,data:this._data})},C.prototype.hasTransition=function(){return!1},C}(k.Evented),gt=k.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),he=function(x){function C(E,M,U,H){x.call(this),this.id=E,this.dispatcher=U,this.coordinates=M.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(H),this.options=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(E,M){var U=this;this._loaded=!1,this.fire(new k.Event("dataloading",{dataType:"source"})),this.url=this.options.url,k.getImage(this.map._requestManager.transformRequest(this.url,k.ResourceType.Image),function(H,$){U._loaded=!0,H?U.fire(new k.ErrorEvent(H)):$&&(U.image=$,E&&(U.coordinates=E),M&&M(),U._finishLoading())})},C.prototype.loaded=function(){return this._loaded},C.prototype.updateImage=function(E){var M=this;return this.image&&E.url?(this.options.url=E.url,this.load(E.coordinates,function(){M.texture=null}),this):this},C.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new k.Event("data",{dataType:"source",sourceDataType:"metadata"})))},C.prototype.onAdd=function(E){this.map=E,this.load()},C.prototype.setCoordinates=function(E){var M=this;this.coordinates=E;var U=E.map(k.MercatorCoordinate.fromLngLat);this.tileID=function($){for(var ht=1/0,Ut=1/0,ie=-1/0,Be=-1/0,De=0,Ne=$;De<Ne.length;De+=1){var fr=Ne[De];ht=Math.min(ht,fr.x),Ut=Math.min(Ut,fr.y),ie=Math.max(ie,fr.x),Be=Math.max(Be,fr.y)}var $e=Math.max(ie-ht,Be-Ut),_r=Math.max(0,Math.floor(-Math.log($e)/Math.LN2)),er=Math.pow(2,_r);return new k.CanonicalTileID(_r,Math.floor((ht+ie)/2*er),Math.floor((Ut+Be)/2*er))}(U),this.minzoom=this.maxzoom=this.tileID.z;var H=U.map(function($){return M.tileID.getTilePoint($)._round()});return this._boundsArray=new k.StructArrayLayout4i8,this._boundsArray.emplaceBack(H[0].x,H[0].y,0,0),this._boundsArray.emplaceBack(H[1].x,H[1].y,k.EXTENT,0),this._boundsArray.emplaceBack(H[3].x,H[3].y,0,k.EXTENT),this._boundsArray.emplaceBack(H[2].x,H[2].y,k.EXTENT,k.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new k.Event("data",{dataType:"source",sourceDataType:"content"})),this},C.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var E=this.map.painter.context,M=E.gl;for(var U in this.boundsBuffer||(this.boundsBuffer=E.createVertexBuffer(this._boundsArray,gt.members)),this.boundsSegments||(this.boundsSegments=k.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new k.Texture(E,this.image,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[U];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},C.prototype.loadTile=function(E,M){this.tileID&&this.tileID.equals(E.tileID.canonical)?(this.tiles[String(E.tileID.wrap)]=E,E.buckets={},M(null)):(E.state="errored",M(null))},C.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},C.prototype.hasTransition=function(){return!1},C}(k.Evented),Oe=function(x){function C(E,M,U,H){x.call(this,E,M,U,H),this.roundZoom=!0,this.type="video",this.options=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var E=this;this._loaded=!1;var M=this.options;this.urls=[];for(var U=0,H=M.urls;U<H.length;U+=1)this.urls.push(this.map._requestManager.transformRequest(H[U],k.ResourceType.Source).url);k.getVideo(this.urls,function($,ht){E._loaded=!0,$?E.fire(new k.ErrorEvent($)):ht&&(E.video=ht,E.video.loop=!0,E.video.setAttribute("playsinline",""),E.video.addEventListener("playing",function(){E.map.triggerRepaint()}),E.map&&E.video.play(),E._finishLoading())})},C.prototype.pause=function(){this.video&&this.video.pause()},C.prototype.play=function(){this.video&&this.video.play()},C.prototype.seek=function(E){if(this.video){var M=this.video.seekable;E<M.start(0)||E>M.end(0)?this.fire(new k.ErrorEvent(new k.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+M.start(0)+" and "+M.end(0)+"-second mark."))):this.video.currentTime=E}},C.prototype.getVideo=function(){return this.video},C.prototype.onAdd=function(E){this.map||(this.map=E,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},C.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var E=this.map.painter.context,M=E.gl;for(var U in this.boundsBuffer||(this.boundsBuffer=E.createVertexBuffer(this._boundsArray,gt.members)),this.boundsSegments||(this.boundsSegments=k.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.texSubImage2D(M.TEXTURE_2D,0,0,0,M.RGBA,M.UNSIGNED_BYTE,this.video)):(this.texture=new k.Texture(E,this.video,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[U];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},C.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},C.prototype.hasTransition=function(){return this.video&&!this.video.paused},C}(he),Le=function(x){function C(E,M,U,H){x.call(this,E,M,U,H),M.coordinates?Array.isArray(M.coordinates)&&M.coordinates.length===4&&!M.coordinates.some(function($){return!Array.isArray($)||$.length!==2||$.some(function(ht){return typeof ht!="number"})})||this.fire(new k.ErrorEvent(new k.ValidationError("sources."+E,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new k.ErrorEvent(new k.ValidationError("sources."+E,null,'missing required property "coordinates"'))),M.animate&&typeof M.animate!="boolean"&&this.fire(new k.ErrorEvent(new k.ValidationError("sources."+E,null,'optional "animate" property must be a boolean value'))),M.canvas?typeof M.canvas=="string"||M.canvas instanceof k.window.HTMLCanvasElement||this.fire(new k.ErrorEvent(new k.ValidationError("sources."+E,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new k.ErrorEvent(new k.ValidationError("sources."+E,null,'missing required property "canvas"'))),this.options=M,this.animate=M.animate===void 0||M.animate}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof k.window.HTMLCanvasElement?this.options.canvas:k.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new k.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},C.prototype.getCanvas=function(){return this.canvas},C.prototype.onAdd=function(E){this.map=E,this.load(),this.canvas&&this.animate&&this.play()},C.prototype.onRemove=function(){this.pause()},C.prototype.prepare=function(){var E=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,E=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,E=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var M=this.map.painter.context,U=M.gl;for(var H in this.boundsBuffer||(this.boundsBuffer=M.createVertexBuffer(this._boundsArray,gt.members)),this.boundsSegments||(this.boundsSegments=k.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(E||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new k.Texture(M,this.canvas,U.RGBA,{premultiply:!0}),this.tiles){var $=this.tiles[H];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}}},C.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},C.prototype.hasTransition=function(){return this._playing},C.prototype._hasInvalidDimensions=function(){for(var E=0,M=[this.canvas.width,this.canvas.height];E<M.length;E+=1){var U=M[E];if(isNaN(U)||U<=0)return!0}return!1},C}(he),Ve={vector:te,raster:ft,"raster-dem":wt,geojson:Y,video:Oe,image:he,canvas:Le};function Bt(x,C){var E=k.identity([]);return k.translate(E,E,[1,1,0]),k.scale(E,E,[.5*x.width,.5*x.height,1]),k.multiply(E,E,x.calculatePosMatrix(C.toUnwrapped()))}function re(x,C,E,M,U,H){var $=function(_r,er,Er){if(_r)for(var Or=0,Yr=_r;Or<Yr.length;Or+=1){var gn=er[Yr[Or]];if(gn&&gn.source===Er&&gn.type==="fill-extrusion")return!0}else for(var vn in er){var _n=er[vn];if(_n.source===Er&&_n.type==="fill-extrusion")return!0}return!1}(U&&U.layers,C,x.id),ht=H.maxPitchScaleFactor(),Ut=x.tilesIn(M,ht,$);Ut.sort(ye);for(var ie=[],Be=0,De=Ut;Be<De.length;Be+=1){var Ne=De[Be];ie.push({wrappedTileID:Ne.tileID.wrapped().key,queryResults:Ne.tile.queryRenderedFeatures(C,E,x._state,Ne.queryGeometry,Ne.cameraQueryGeometry,Ne.scale,U,H,ht,Bt(x.transform,Ne.tileID))})}var fr=function(_r){for(var er={},Er={},Or=0,Yr=_r;Or<Yr.length;Or+=1){var gn=Yr[Or],vn=gn.queryResults,_n=gn.wrappedTileID,Un=Er[_n]=Er[_n]||{};for(var ui in vn)for(var oi=vn[ui],Ri=Un[ui]=Un[ui]||{},Di=er[ui]=er[ui]||[],ia=0,na=oi;ia<na.length;ia+=1){var co=na[ia];Ri[co.featureIndex]||(Ri[co.featureIndex]=!0,Di.push(co))}}return er}(ie);for(var $e in fr)fr[$e].forEach(function(_r){var er=_r.feature,Er=x.getFeatureState(er.layer["source-layer"],er.id);er.source=er.layer.source,er.layer["source-layer"]&&(er.sourceLayer=er.layer["source-layer"]),er.state=Er});return fr}function ye(x,C){var E=x.tileID,M=C.tileID;return E.overscaledZ-M.overscaledZ||E.canonical.y-M.canonical.y||E.wrap-M.wrap||E.canonical.x-M.canonical.x}var Yt=function(x,C){this.max=x,this.onRemove=C,this.reset()};Yt.prototype.reset=function(){for(var x in this.data)for(var C=0,E=this.data[x];C<E.length;C+=1){var M=E[C];M.timeout&&clearTimeout(M.timeout),this.onRemove(M.value)}return this.data={},this.order=[],this},Yt.prototype.add=function(x,C,E){var M=this,U=x.wrapped().key;this.data[U]===void 0&&(this.data[U]=[]);var H={value:C,timeout:void 0};if(E!==void 0&&(H.timeout=setTimeout(function(){M.remove(x,H)},E)),this.data[U].push(H),this.order.push(U),this.order.length>this.max){var $=this._getAndRemoveByKey(this.order[0]);$&&this.onRemove($)}return this},Yt.prototype.has=function(x){return x.wrapped().key in this.data},Yt.prototype.getAndRemove=function(x){return this.has(x)?this._getAndRemoveByKey(x.wrapped().key):null},Yt.prototype._getAndRemoveByKey=function(x){var C=this.data[x].shift();return C.timeout&&clearTimeout(C.timeout),this.data[x].length===0&&delete this.data[x],this.order.splice(this.order.indexOf(x),1),C.value},Yt.prototype.getByKey=function(x){var C=this.data[x];return C?C[0].value:null},Yt.prototype.get=function(x){return this.has(x)?this.data[x.wrapped().key][0].value:null},Yt.prototype.remove=function(x,C){if(!this.has(x))return this;var E=x.wrapped().key,M=C===void 0?0:this.data[E].indexOf(C),U=this.data[E][M];return this.data[E].splice(M,1),U.timeout&&clearTimeout(U.timeout),this.data[E].length===0&&delete this.data[E],this.onRemove(U.value),this.order.splice(this.order.indexOf(E),1),this},Yt.prototype.setMaxSize=function(x){for(this.max=x;this.order.length>this.max;){var C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this},Yt.prototype.filter=function(x){var C=[];for(var E in this.data)for(var M=0,U=this.data[E];M<U.length;M+=1){var H=U[M];x(H.value)||C.push(H)}for(var $=0,ht=C;$<ht.length;$+=1){var Ut=ht[$];this.remove(Ut.value.tileID,Ut)}};var qe=function(x,C,E){this.context=x;var M=x.gl;this.buffer=M.createBuffer(),this.dynamicDraw=Boolean(E),this.context.unbindVAO(),x.bindElementBuffer.set(this.buffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer};qe.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},qe.prototype.updateData=function(x){var C=this.context.gl;this.context.unbindVAO(),this.bind(),C.bufferSubData(C.ELEMENT_ARRAY_BUFFER,0,x.arrayBuffer)},qe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var vr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},oe=function(x,C,E,M){this.length=C.length,this.attributes=E,this.itemSize=C.bytesPerElement,this.dynamicDraw=M,this.context=x;var U=x.gl;this.buffer=U.createBuffer(),x.bindVertexBuffer.set(this.buffer),U.bufferData(U.ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?U.DYNAMIC_DRAW:U.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer};oe.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},oe.prototype.updateData=function(x){var C=this.context.gl;this.bind(),C.bufferSubData(C.ARRAY_BUFFER,0,x.arrayBuffer)},oe.prototype.enableAttributes=function(x,C){for(var E=0;E<this.attributes.length;E++){var M=C.attributes[this.attributes[E].name];M!==void 0&&x.enableVertexAttribArray(M)}},oe.prototype.setVertexAttribPointers=function(x,C,E){for(var M=0;M<this.attributes.length;M++){var U=this.attributes[M],H=C.attributes[U.name];H!==void 0&&x.vertexAttribPointer(H,U.components,x[vr[U.type]],!1,this.itemSize,U.offset+this.itemSize*(E||0))}},oe.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var qt=function(x){this.gl=x.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};qt.prototype.get=function(){return this.current},qt.prototype.set=function(x){},qt.prototype.getDefault=function(){return this.default},qt.prototype.setDefault=function(){this.set(this.default)};var bt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return k.Color.transparent},C.prototype.set=function(E){var M=this.current;(E.r!==M.r||E.g!==M.g||E.b!==M.b||E.a!==M.a||this.dirty)&&(this.gl.clearColor(E.r,E.g,E.b,E.a),this.current=E,this.dirty=!1)},C}(qt),Wt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 1},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.clearDepth(E),this.current=E,this.dirty=!1)},C}(qt),$t=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 0},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.clearStencil(E),this.current=E,this.dirty=!1)},C}(qt),xt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return[!0,!0,!0,!0]},C.prototype.set=function(E){var M=this.current;(E[0]!==M[0]||E[1]!==M[1]||E[2]!==M[2]||E[3]!==M[3]||this.dirty)&&(this.gl.colorMask(E[0],E[1],E[2],E[3]),this.current=E,this.dirty=!1)},C}(qt),St=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!0},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.depthMask(E),this.current=E,this.dirty=!1)},C}(qt),ue=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 255},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.stencilMask(E),this.current=E,this.dirty=!1)},C}(qt),Pe=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},C.prototype.set=function(E){var M=this.current;(E.func!==M.func||E.ref!==M.ref||E.mask!==M.mask||this.dirty)&&(this.gl.stencilFunc(E.func,E.ref,E.mask),this.current=E,this.dirty=!1)},C}(qt),ze=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var E=this.gl;return[E.KEEP,E.KEEP,E.KEEP]},C.prototype.set=function(E){var M=this.current;(E[0]!==M[0]||E[1]!==M[1]||E[2]!==M[2]||this.dirty)&&(this.gl.stencilOp(E[0],E[1],E[2]),this.current=E,this.dirty=!1)},C}(qt),Vt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;E?M.enable(M.STENCIL_TEST):M.disable(M.STENCIL_TEST),this.current=E,this.dirty=!1}},C}(qt),Ct=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return[0,1]},C.prototype.set=function(E){var M=this.current;(E[0]!==M[0]||E[1]!==M[1]||this.dirty)&&(this.gl.depthRange(E[0],E[1]),this.current=E,this.dirty=!1)},C}(qt),At=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;E?M.enable(M.DEPTH_TEST):M.disable(M.DEPTH_TEST),this.current=E,this.dirty=!1}},C}(qt),Nt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.LESS},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.depthFunc(E),this.current=E,this.dirty=!1)},C}(qt),tt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;E?M.enable(M.BLEND):M.disable(M.BLEND),this.current=E,this.dirty=!1}},C}(qt),vt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var E=this.gl;return[E.ONE,E.ZERO]},C.prototype.set=function(E){var M=this.current;(E[0]!==M[0]||E[1]!==M[1]||this.dirty)&&(this.gl.blendFunc(E[0],E[1]),this.current=E,this.dirty=!1)},C}(qt),Ht=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return k.Color.transparent},C.prototype.set=function(E){var M=this.current;(E.r!==M.r||E.g!==M.g||E.b!==M.b||E.a!==M.a||this.dirty)&&(this.gl.blendColor(E.r,E.g,E.b,E.a),this.current=E,this.dirty=!1)},C}(qt),de=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.FUNC_ADD},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.blendEquation(E),this.current=E,this.dirty=!1)},C}(qt),jt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;E?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),this.current=E,this.dirty=!1}},C}(qt),Ie=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.BACK},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.cullFace(E),this.current=E,this.dirty=!1)},C}(qt),We=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.CCW},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.frontFace(E),this.current=E,this.dirty=!1)},C}(qt),Ke=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.useProgram(E),this.current=E,this.dirty=!1)},C}(qt),pr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.TEXTURE0},C.prototype.set=function(E){(E!==this.current||this.dirty)&&(this.gl.activeTexture(E),this.current=E,this.dirty=!1)},C}(qt),lr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var E=this.gl;return[0,0,E.drawingBufferWidth,E.drawingBufferHeight]},C.prototype.set=function(E){var M=this.current;(E[0]!==M[0]||E[1]!==M[1]||E[2]!==M[2]||E[3]!==M[3]||this.dirty)&&(this.gl.viewport(E[0],E[1],E[2],E[3]),this.current=E,this.dirty=!1)},C}(qt),Nr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.bindFramebuffer(M.FRAMEBUFFER,E),this.current=E,this.dirty=!1}},C}(qt),Pr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.bindRenderbuffer(M.RENDERBUFFER,E),this.current=E,this.dirty=!1}},C}(qt),Gr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.bindTexture(M.TEXTURE_2D,E),this.current=E,this.dirty=!1}},C}(qt),Sn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.bindBuffer(M.ARRAY_BUFFER,E),this.current=E,this.dirty=!1}},C}(qt),nn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){var M=this.gl;M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,E),this.current=E,this.dirty=!1},C}(qt),Nn=function(x){function C(E){x.call(this,E),this.vao=E.extVertexArrayObject}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(E){this.vao&&(E!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(E),this.current=E,this.dirty=!1)},C}(qt),Zn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 4},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_ALIGNMENT,E),this.current=E,this.dirty=!1}},C}(qt),Hn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,E),this.current=E,this.dirty=!1}},C}(qt),An=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(E){if(E!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,E),this.current=E,this.dirty=!1}},C}(qt),$n=function(x){function C(E,M){x.call(this,E),this.context=E,this.parent=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C}(qt),Rt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.setDirty=function(){this.dirty=!0},C.prototype.set=function(E){if(E!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,E,0),this.current=E,this.dirty=!1}},C}($n),Xt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.set=function(E){if(E!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,E),this.current=E,this.dirty=!1}},C}($n),ae=function(x,C,E,M){this.context=x,this.width=C,this.height=E;var U=this.framebuffer=x.gl.createFramebuffer();this.colorAttachment=new Rt(x,U),M&&(this.depthAttachment=new Xt(x,U))};ae.prototype.destroy=function(){var x=this.context.gl,C=this.colorAttachment.get();if(C&&x.deleteTexture(C),this.depthAttachment){var E=this.depthAttachment.get();E&&x.deleteRenderbuffer(E)}x.deleteFramebuffer(this.framebuffer)};var we=function(x,C,E){this.func=x,this.mask=C,this.range=E};we.ReadOnly=!1,we.ReadWrite=!0,we.disabled=new we(519,we.ReadOnly,[0,1]);var Ge=function(x,C,E,M,U,H){this.test=x,this.ref=C,this.mask=E,this.fail=M,this.depthFail=U,this.pass=H};Ge.disabled=new Ge({func:519,mask:0},0,0,7680,7680,7680);var cr=function(x,C,E){this.blendFunction=x,this.blendColor=C,this.mask=E};cr.disabled=new cr(cr.Replace=[1,0],k.Color.transparent,[!1,!1,!1,!1]),cr.unblended=new cr(cr.Replace,k.Color.transparent,[!0,!0,!0,!0]),cr.alphaBlended=new cr([1,771],k.Color.transparent,[!0,!0,!0,!0]);var br=function(x,C,E){this.enable=x,this.mode=C,this.frontFace=E};br.disabled=new br(!1,1029,2305),br.backCCW=new br(!0,1029,2305);var Ce=function(x){this.gl=x,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new bt(this),this.clearDepth=new Wt(this),this.clearStencil=new $t(this),this.colorMask=new xt(this),this.depthMask=new St(this),this.stencilMask=new ue(this),this.stencilFunc=new Pe(this),this.stencilOp=new ze(this),this.stencilTest=new Vt(this),this.depthRange=new Ct(this),this.depthTest=new At(this),this.depthFunc=new Nt(this),this.blend=new tt(this),this.blendFunc=new vt(this),this.blendColor=new Ht(this),this.blendEquation=new de(this),this.cullFace=new jt(this),this.cullFaceSide=new Ie(this),this.frontFace=new We(this),this.program=new Ke(this),this.activeTexture=new pr(this),this.viewport=new lr(this),this.bindFramebuffer=new Nr(this),this.bindRenderbuffer=new Pr(this),this.bindTexture=new Gr(this),this.bindVertexBuffer=new Sn(this),this.bindElementBuffer=new nn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Nn(this),this.pixelStoreUnpack=new Zn(this),this.pixelStoreUnpackPremultiplyAlpha=new Hn(this),this.pixelStoreUnpackFlipY=new An(this),this.extTextureFilterAnisotropic=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=x.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=x.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(x.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=x.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=x.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=x.getParameter(x.MAX_TEXTURE_SIZE)};Ce.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ce.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ce.prototype.createIndexBuffer=function(x,C){return new qe(this,x,C)},Ce.prototype.createVertexBuffer=function(x,C,E){return new oe(this,x,C,E)},Ce.prototype.createRenderbuffer=function(x,C,E){var M=this.gl,U=M.createRenderbuffer();return this.bindRenderbuffer.set(U),M.renderbufferStorage(M.RENDERBUFFER,x,C,E),this.bindRenderbuffer.set(null),U},Ce.prototype.createFramebuffer=function(x,C,E){return new ae(this,x,C,E)},Ce.prototype.clear=function(x){var C=x.color,E=x.depth,M=this.gl,U=0;C&&(U|=M.COLOR_BUFFER_BIT,this.clearColor.set(C),this.colorMask.set([!0,!0,!0,!0])),E!==void 0&&(U|=M.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(E),this.depthMask.set(!0)),M.clear(U)},Ce.prototype.setCullFace=function(x){x.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(x.mode),this.frontFace.set(x.frontFace))},Ce.prototype.setDepthMode=function(x){x.func!==this.gl.ALWAYS||x.mask?(this.depthTest.set(!0),this.depthFunc.set(x.func),this.depthMask.set(x.mask),this.depthRange.set(x.range)):this.depthTest.set(!1)},Ce.prototype.setStencilMode=function(x){x.test.func!==this.gl.ALWAYS||x.mask?(this.stencilTest.set(!0),this.stencilMask.set(x.mask),this.stencilOp.set([x.fail,x.depthFail,x.pass]),this.stencilFunc.set({func:x.test.func,ref:x.ref,mask:x.test.mask})):this.stencilTest.set(!1)},Ce.prototype.setColorMode=function(x){k.deepEqual(x.blendFunction,cr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(x.blendFunction),this.blendColor.set(x.blendColor)),this.colorMask.set(x.mask)},Ce.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ar=function(x){function C(E,M,U){var H=this;x.call(this),this.id=E,this.dispatcher=U,this.on("data",function($){$.dataType==="source"&&$.sourceDataType==="metadata"&&(H._sourceLoaded=!0),H._sourceLoaded&&!H._paused&&$.dataType==="source"&&$.sourceDataType==="content"&&(H.reload(),H.transform&&H.update(H.transform))}),this.on("error",function(){H._sourceErrored=!0}),this._source=function($,ht,Ut,ie){var Be=new Ve[ht.type]($,ht,Ut,ie);if(Be.id!==$)throw new Error("Expected Source id to be "+$+" instead of "+Be.id);return k.bindAll(["load","abort","unload","serialize","prepare"],Be),Be}(E,M,U,this),this._tiles={},this._cache=new Yt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new k.SourceFeatureState}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.onAdd=function(E){this.map=E,this._maxTileCacheSize=E?E._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(E)},C.prototype.onRemove=function(E){this._source&&this._source.onRemove&&this._source.onRemove(E)},C.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var E in this._tiles){var M=this._tiles[E];if(M.state!=="loaded"&&M.state!=="errored")return!1}return!0},C.prototype.getSource=function(){return this._source},C.prototype.pause=function(){this._paused=!0},C.prototype.resume=function(){if(this._paused){var E=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,E&&this.reload(),this.transform&&this.update(this.transform)}},C.prototype._loadTile=function(E,M){return this._source.loadTile(E,M)},C.prototype._unloadTile=function(E){if(this._source.unloadTile)return this._source.unloadTile(E,function(){})},C.prototype._abortTile=function(E){if(this._source.abortTile)return this._source.abortTile(E,function(){})},C.prototype.serialize=function(){return this._source.serialize()},C.prototype.prepare=function(E){for(var M in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var U=this._tiles[M];U.upload(E),U.prepare(this.map.style.imageManager)}},C.prototype.getIds=function(){return k.values(this._tiles).map(function(E){return E.tileID}).sort(Hr).map(function(E){return E.key})},C.prototype.getRenderableIds=function(E){var M=this,U=[];for(var H in this._tiles)this._isIdRenderable(H,E)&&U.push(this._tiles[H]);return E?U.sort(function($,ht){var Ut=$.tileID,ie=ht.tileID,Be=new k.Point(Ut.canonical.x,Ut.canonical.y)._rotate(M.transform.angle),De=new k.Point(ie.canonical.x,ie.canonical.y)._rotate(M.transform.angle);return Ut.overscaledZ-ie.overscaledZ||De.y-Be.y||De.x-Be.x}).map(function($){return $.tileID.key}):U.map(function($){return $.tileID}).sort(Hr).map(function($){return $.key})},C.prototype.hasRenderableParent=function(E){var M=this.findLoadedParent(E,0);return!!M&&this._isIdRenderable(M.tileID.key)},C.prototype._isIdRenderable=function(E,M){return this._tiles[E]&&this._tiles[E].hasData()&&!this._coveredTiles[E]&&(M||!this._tiles[E].holdingForFade())},C.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var E in this._cache.reset(),this._tiles)this._tiles[E].state!=="errored"&&this._reloadTile(E,"reloading")},C.prototype._reloadTile=function(E,M){var U=this._tiles[E];U&&(U.state!=="loading"&&(U.state=M),this._loadTile(U,this._tileLoaded.bind(this,U,E,M)))},C.prototype._tileLoaded=function(E,M,U,H){if(H)return E.state="errored",void(H.status!==404?this._source.fire(new k.ErrorEvent(H,{tile:E})):this.update(this.transform));E.timeAdded=k.browser.now(),U==="expired"&&(E.refreshedUponExpiration=!0),this._setTileReloadTimer(M,E),this.getSource().type==="raster-dem"&&E.dem&&this._backfillDEM(E),this._state.initializeTileState(E,this.map?this.map.painter:null),this._source.fire(new k.Event("data",{dataType:"source",tile:E,coord:E.tileID}))},C.prototype._backfillDEM=function(E){for(var M=this.getRenderableIds(),U=0;U<M.length;U++){var H=M[U];if(E.neighboringTiles&&E.neighboringTiles[H]){var $=this.getTileByID(H);ht(E,$),ht($,E)}}function ht(Ut,ie){Ut.needsHillshadePrepare=!0;var Be=ie.tileID.canonical.x-Ut.tileID.canonical.x,De=ie.tileID.canonical.y-Ut.tileID.canonical.y,Ne=Math.pow(2,Ut.tileID.canonical.z),fr=ie.tileID.key;Be===0&&De===0||Math.abs(De)>1||(Math.abs(Be)>1&&(Math.abs(Be+Ne)===1?Be+=Ne:Math.abs(Be-Ne)===1&&(Be-=Ne)),ie.dem&&Ut.dem&&(Ut.dem.backfillBorder(ie.dem,Be,De),Ut.neighboringTiles&&Ut.neighboringTiles[fr]&&(Ut.neighboringTiles[fr].backfilled=!0)))}},C.prototype.getTile=function(E){return this.getTileByID(E.key)},C.prototype.getTileByID=function(E){return this._tiles[E]},C.prototype._retainLoadedChildren=function(E,M,U,H){for(var $ in this._tiles){var ht=this._tiles[$];if(!(H[$]||!ht.hasData()||ht.tileID.overscaledZ<=M||ht.tileID.overscaledZ>U)){for(var Ut=ht.tileID;ht&&ht.tileID.overscaledZ>M+1;){var ie=ht.tileID.scaledTo(ht.tileID.overscaledZ-1);(ht=this._tiles[ie.key])&&ht.hasData()&&(Ut=ie)}for(var Be=Ut;Be.overscaledZ>M;)if(E[(Be=Be.scaledTo(Be.overscaledZ-1)).key]){H[Ut.key]=Ut;break}}}},C.prototype.findLoadedParent=function(E,M){if(E.key in this._loadedParentTiles){var U=this._loadedParentTiles[E.key];return U&&U.tileID.overscaledZ>=M?U:null}for(var H=E.overscaledZ-1;H>=M;H--){var $=E.scaledTo(H),ht=this._getLoadedTile($);if(ht)return ht}},C.prototype._getLoadedTile=function(E){var M=this._tiles[E.key];return M&&M.hasData()?M:this._cache.getByKey(E.wrapped().key)},C.prototype.updateCacheSize=function(E){var M=Math.ceil(E.width/this._source.tileSize)+1,U=Math.ceil(E.height/this._source.tileSize)+1,H=Math.floor(M*U*5),$=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,H):H;this._cache.setMaxSize($)},C.prototype.handleWrapJump=function(E){var M=Math.round((E-(this._prevLng===void 0?E:this._prevLng))/360);if(this._prevLng=E,M){var U={};for(var H in this._tiles){var $=this._tiles[H];$.tileID=$.tileID.unwrapTo($.tileID.wrap+M),U[$.tileID.key]=$}for(var ht in this._tiles=U,this._timers)clearTimeout(this._timers[ht]),delete this._timers[ht];for(var Ut in this._tiles)this._setTileReloadTimer(Ut,this._tiles[Ut])}},C.prototype.update=function(E){var M=this;if(this.transform=E,this._sourceLoaded&&!this._paused){var U;this.updateCacheSize(E),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?U=E.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Un){return new k.OverscaledTileID(Un.canonical.z,Un.wrap,Un.canonical.z,Un.canonical.x,Un.canonical.y)}):(U=E.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(U=U.filter(function(Un){return M._source.hasTile(Un)}))):U=[];var H=E.coveringZoomLevel(this._source),$=Math.max(H-C.maxOverzooming,this._source.minzoom),ht=Math.max(H+C.maxUnderzooming,this._source.minzoom),Ut=this._updateRetainedTiles(U,H);if(Tn(this._source.type)){for(var ie={},Be={},De=0,Ne=Object.keys(Ut);De<Ne.length;De+=1){var fr=Ne[De],$e=Ut[fr],_r=this._tiles[fr];if(_r&&!(_r.fadeEndTime&&_r.fadeEndTime<=k.browser.now())){var er=this.findLoadedParent($e,$);er&&(this._addTile(er.tileID),ie[er.tileID.key]=er.tileID),Be[fr]=$e}}for(var Er in this._retainLoadedChildren(Be,H,ht,Ut),ie)Ut[Er]||(this._coveredTiles[Er]=!0,Ut[Er]=ie[Er])}for(var Or in Ut)this._tiles[Or].clearFadeHold();for(var Yr=0,gn=k.keysDifference(this._tiles,Ut);Yr<gn.length;Yr+=1){var vn=gn[Yr],_n=this._tiles[vn];_n.hasSymbolBuckets&&!_n.holdingForFade()?_n.setHoldDuration(this.map._fadeDuration):_n.hasSymbolBuckets&&!_n.symbolFadeFinished()||this._removeTile(vn)}this._updateLoadedParentTileCache()}},C.prototype.releaseSymbolFadeTiles=function(){for(var E in this._tiles)this._tiles[E].holdingForFade()&&this._removeTile(E)},C.prototype._updateRetainedTiles=function(E,M){for(var U={},H={},$=Math.max(M-C.maxOverzooming,this._source.minzoom),ht=Math.max(M+C.maxUnderzooming,this._source.minzoom),Ut={},ie=0,Be=E;ie<Be.length;ie+=1){var De=Be[ie],Ne=this._addTile(De);U[De.key]=De,Ne.hasData()||M<this._source.maxzoom&&(Ut[De.key]=De)}this._retainLoadedChildren(Ut,M,ht,U);for(var fr=0,$e=E;fr<$e.length;fr+=1){var _r=$e[fr],er=this._tiles[_r.key];if(!er.hasData()){if(M+1>this._source.maxzoom){var Er=_r.children(this._source.maxzoom)[0],Or=this.getTile(Er);if(Or&&Or.hasData()){U[Er.key]=Er;continue}}else{var Yr=_r.children(this._source.maxzoom);if(U[Yr[0].key]&&U[Yr[1].key]&&U[Yr[2].key]&&U[Yr[3].key])continue}for(var gn=er.wasRequested(),vn=_r.overscaledZ-1;vn>=$;--vn){var _n=_r.scaledTo(vn);if(H[_n.key]||(H[_n.key]=!0,!(er=this.getTile(_n))&&gn&&(er=this._addTile(_n)),er&&(U[_n.key]=_n,gn=er.wasRequested(),er.hasData())))break}}}return U},C.prototype._updateLoadedParentTileCache=function(){for(var E in this._loadedParentTiles={},this._tiles){for(var M=[],U=void 0,H=this._tiles[E].tileID;H.overscaledZ>0;){if(H.key in this._loadedParentTiles){U=this._loadedParentTiles[H.key];break}M.push(H.key);var $=H.scaledTo(H.overscaledZ-1);if(U=this._getLoadedTile($))break;H=$}for(var ht=0,Ut=M;ht<Ut.length;ht+=1)this._loadedParentTiles[Ut[ht]]=U}},C.prototype._addTile=function(E){var M=this._tiles[E.key];if(M)return M;(M=this._cache.getAndRemove(E))&&(this._setTileReloadTimer(E.key,M),M.tileID=E,this._state.initializeTileState(M,this.map?this.map.painter:null),this._cacheTimers[E.key]&&(clearTimeout(this._cacheTimers[E.key]),delete this._cacheTimers[E.key],this._setTileReloadTimer(E.key,M)));var U=Boolean(M);return U||(M=new k.Tile(E,this._source.tileSize*E.overscaleFactor()),this._loadTile(M,this._tileLoaded.bind(this,M,E.key,M.state))),M?(M.uses++,this._tiles[E.key]=M,U||this._source.fire(new k.Event("dataloading",{tile:M,coord:M.tileID,dataType:"source"})),M):null},C.prototype._setTileReloadTimer=function(E,M){var U=this;E in this._timers&&(clearTimeout(this._timers[E]),delete this._timers[E]);var H=M.getExpiryTimeout();H&&(this._timers[E]=setTimeout(function(){U._reloadTile(E,"expired"),delete U._timers[E]},H))},C.prototype._removeTile=function(E){var M=this._tiles[E];M&&(M.uses--,delete this._tiles[E],this._timers[E]&&(clearTimeout(this._timers[E]),delete this._timers[E]),M.uses>0||(M.hasData()&&M.state!=="reloading"?this._cache.add(M.tileID,M,M.getExpiryTimeout()):(M.aborted=!0,this._abortTile(M),this._unloadTile(M))))},C.prototype.clearTiles=function(){for(var E in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(E);this._cache.reset()},C.prototype.tilesIn=function(E,M,U){var H=this,$=[],ht=this.transform;if(!ht)return $;for(var Ut=U?ht.getCameraQueryGeometry(E):E,ie=E.map(function(vn){return ht.pointCoordinate(vn)}),Be=Ut.map(function(vn){return ht.pointCoordinate(vn)}),De=this.getIds(),Ne=1/0,fr=1/0,$e=-1/0,_r=-1/0,er=0,Er=Be;er<Er.length;er+=1){var Or=Er[er];Ne=Math.min(Ne,Or.x),fr=Math.min(fr,Or.y),$e=Math.max($e,Or.x),_r=Math.max(_r,Or.y)}for(var Yr=function(vn){var _n=H._tiles[De[vn]];if(!_n.holdingForFade()){var Un=_n.tileID,ui=Math.pow(2,ht.zoom-_n.tileID.overscaledZ),oi=M*_n.queryPadding*k.EXTENT/_n.tileSize/ui,Ri=[Un.getTilePoint(new k.MercatorCoordinate(Ne,fr)),Un.getTilePoint(new k.MercatorCoordinate($e,_r))];if(Ri[0].x-oi<k.EXTENT&&Ri[0].y-oi<k.EXTENT&&Ri[1].x+oi>=0&&Ri[1].y+oi>=0){var Di=ie.map(function(na){return Un.getTilePoint(na)}),ia=Be.map(function(na){return Un.getTilePoint(na)});$.push({tile:_n,tileID:Un,queryGeometry:Di,cameraQueryGeometry:ia,scale:ui})}}},gn=0;gn<De.length;gn++)Yr(gn);return $},C.prototype.getVisibleCoordinates=function(E){for(var M=this,U=this.getRenderableIds(E).map(function(Ut){return M._tiles[Ut].tileID}),H=0,$=U;H<$.length;H+=1){var ht=$[H];ht.posMatrix=this.transform.calculatePosMatrix(ht.toUnwrapped())}return U},C.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Tn(this._source.type))for(var E in this._tiles){var M=this._tiles[E];if(M.fadeEndTime!==void 0&&M.fadeEndTime>=k.browser.now())return!0}return!1},C.prototype.setFeatureState=function(E,M,U){this._state.updateState(E=E||"_geojsonTileLayer",M,U)},C.prototype.removeFeatureState=function(E,M,U){this._state.removeFeatureState(E=E||"_geojsonTileLayer",M,U)},C.prototype.getFeatureState=function(E,M){return this._state.getState(E=E||"_geojsonTileLayer",M)},C.prototype.setDependencies=function(E,M,U){var H=this._tiles[E];H&&H.setDependencies(M,U)},C.prototype.reloadTilesForDependencies=function(E,M){for(var U in this._tiles)this._tiles[U].hasDependency(E,M)&&this._reloadTile(U,"reloading");this._cache.filter(function(H){return!H.hasDependency(E,M)})},C}(k.Evented);function Hr(x,C){var E=Math.abs(2*x.wrap)-+(x.wrap<0),M=Math.abs(2*C.wrap)-+(C.wrap<0);return x.overscaledZ-C.overscaledZ||M-E||C.canonical.y-x.canonical.y||C.canonical.x-x.canonical.x}function Tn(x){return x==="raster"||x==="image"||x==="video"}function Kr(){return new k.window.Worker(oc.workerUrl)}ar.maxOverzooming=10,ar.maxUnderzooming=3;var an="mapboxgl_preloaded_worker_pool",Pn=function(){this.active={}};Pn.prototype.acquire=function(x){if(!this.workers)for(this.workers=[];this.workers.length<Pn.workerCount;)this.workers.push(new Kr);return this.active[x]=!0,this.workers.slice()},Pn.prototype.release=function(x){delete this.active[x],this.numActive()===0&&(this.workers.forEach(function(C){C.terminate()}),this.workers=null)},Pn.prototype.isPreloaded=function(){return!!this.active[an]},Pn.prototype.numActive=function(){return Object.keys(this.active).length};var xi,Ci=Math.floor(k.browser.hardwareConcurrency/2);function Qr(){return xi||(xi=new Pn),xi}function Kn(x,C){var E={};for(var M in x)M!=="ref"&&(E[M]=x[M]);return k.refProperties.forEach(function(U){U in C&&(E[U]=C[U])}),E}function ai(x){x=x.slice();for(var C=Object.create(null),E=0;E<x.length;E++)C[x[E].id]=x[E];for(var M=0;M<x.length;M++)"ref"in x[M]&&(x[M]=Kn(x[M],C[x[M].ref]));return x}Pn.workerCount=Math.max(Math.min(Ci,6),1);var fi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function oa(x,C,E){E.push({command:fi.addSource,args:[x,C[x]]})}function Ai(x,C,E){C.push({command:fi.removeSource,args:[x]}),E[x]=!0}function Ca(x,C,E,M){Ai(x,E,M),oa(x,C,E)}function po(x,C,E){var M;for(M in x[E])if(x[E].hasOwnProperty(M)&&M!=="data"&&!k.deepEqual(x[E][M],C[E][M]))return!1;for(M in C[E])if(C[E].hasOwnProperty(M)&&M!=="data"&&!k.deepEqual(x[E][M],C[E][M]))return!1;return!0}function La(x,C,E,M,U,H){var $;for($ in C=C||{},x=x||{})x.hasOwnProperty($)&&(k.deepEqual(x[$],C[$])||E.push({command:H,args:[M,$,C[$],U]}));for($ in C)C.hasOwnProperty($)&&!x.hasOwnProperty($)&&(k.deepEqual(x[$],C[$])||E.push({command:H,args:[M,$,C[$],U]}))}function Va(x){return x.id}function _a(x,C){return x[C.id]=C,x}var ma=function(x,C){this.reset(x,C)};ma.prototype.reset=function(x,C){this.points=x||[],this._distances=[0];for(var E=1;E<this.points.length;E++)this._distances[E]=this._distances[E-1]+this.points[E].dist(this.points[E-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(C||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ma.prototype.lerp=function(x){if(this.points.length===1)return this.points[0];x=k.clamp(x,0,1);for(var C=1,E=this._distances[C],M=x*this.paddedLength+this.padding;E<M&&C<this._distances.length;)E=this._distances[++C];var U=C-1,H=this._distances[U],$=E-H,ht=$>0?(M-H)/$:0;return this.points[U].mult(1-ht).add(this.points[C].mult(ht))};var Qa=function(x,C,E){var M=this.boxCells=[],U=this.circleCells=[];this.xCellCount=Math.ceil(x/E),this.yCellCount=Math.ceil(C/E);for(var H=0;H<this.xCellCount*this.yCellCount;H++)M.push([]),U.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=x,this.height=C,this.xScale=this.xCellCount/x,this.yScale=this.yCellCount/C,this.boxUid=0,this.circleUid=0};function Uo(x,C,E,M,U){var H=k.create();return C?(k.scale(H,H,[1/U,1/U,1]),E||k.rotateZ(H,H,M.angle)):k.multiply(H,M.labelPlaneMatrix,x),H}function vo(x,C,E,M,U){if(C){var H=k.clone(x);return k.scale(H,H,[U,U,1]),E||k.rotateZ(H,H,-M.angle),H}return M.glCoordMatrix}function Ua(x,C){var E=[x.x,x.y,0,1];On(E,E,C);var M=E[3];return{point:new k.Point(E[0]/M,E[1]/M),signedDistanceFromCamera:M}}function Xa(x,C){return .5+x/C*.5}function Oo(x,C){var E=x[0]/x[3],M=x[1]/x[3];return E>=-C[0]&&E<=C[0]&&M>=-C[1]&&M<=C[1]}function Du(x,C,E,M,U,H,$,ht){var Ut=M?x.textSizeData:x.iconSizeData,ie=k.evaluateSizeForZoom(Ut,E.transform.zoom),Be=[256/E.width*2+1,256/E.height*2+1],De=M?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;De.clear();for(var Ne=x.lineVertexArray,fr=M?x.text.placedSymbolArray:x.icon.placedSymbolArray,$e=E.transform.width/E.transform.height,_r=!1,er=0;er<fr.length;er++){var Er=fr.get(er);if(Er.hidden||Er.writingMode===k.WritingMode.vertical&&!_r)en(Er.numGlyphs,De);else{_r=!1;var Or=[Er.anchorX,Er.anchorY,0,1];if(k.transformMat4(Or,Or,C),Oo(Or,Be)){var Yr=Xa(E.transform.cameraToCenterDistance,Or[3]),gn=k.evaluateSizeForFeature(Ut,ie,Er),vn=$?gn/Yr:gn*Yr,_n=new k.Point(Er.anchorX,Er.anchorY),Un=Ua(_n,U).point,ui={},oi=ir(Er,vn,!1,ht,C,U,H,x.glyphOffsetArray,Ne,De,Un,_n,ui,$e);_r=oi.useVertical,(oi.notEnoughRoom||_r||oi.needsFlipping&&ir(Er,vn,!0,ht,C,U,H,x.glyphOffsetArray,Ne,De,Un,_n,ui,$e).notEnoughRoom)&&en(Er.numGlyphs,De)}else en(Er.numGlyphs,De)}}M?x.text.dynamicLayoutVertexBuffer.updateData(De):x.icon.dynamicLayoutVertexBuffer.updateData(De)}function Yo(x,C,E,M,U,H,$,ht,Ut,ie,Be){var De=ht.glyphStartIndex+ht.numGlyphs,Ne=ht.lineStartIndex,fr=ht.lineStartIndex+ht.lineLength,$e=C.getoffsetX(ht.glyphStartIndex),_r=C.getoffsetX(De-1),er=He(x*$e,E,M,U,H,$,ht.segment,Ne,fr,Ut,ie,Be);if(!er)return null;var Er=He(x*_r,E,M,U,H,$,ht.segment,Ne,fr,Ut,ie,Be);return Er?{first:er,last:Er}:null}function _o(x,C,E,M){return x===k.WritingMode.horizontal&&Math.abs(E.y-C.y)>Math.abs(E.x-C.x)*M?{useVertical:!0}:(x===k.WritingMode.vertical?C.y<E.y:C.x>E.x)?{needsFlipping:!0}:null}function ir(x,C,E,M,U,H,$,ht,Ut,ie,Be,De,Ne,fr){var $e,_r=C/24,er=x.lineOffsetX*_r,Er=x.lineOffsetY*_r;if(x.numGlyphs>1){var Or=x.glyphStartIndex+x.numGlyphs,Yr=x.lineStartIndex,gn=x.lineStartIndex+x.lineLength,vn=Yo(_r,ht,er,Er,E,Be,De,x,Ut,H,Ne);if(!vn)return{notEnoughRoom:!0};var _n=Ua(vn.first.point,$).point,Un=Ua(vn.last.point,$).point;if(M&&!E){var ui=_o(x.writingMode,_n,Un,fr);if(ui)return ui}$e=[vn.first];for(var oi=x.glyphStartIndex+1;oi<Or-1;oi++)$e.push(He(_r*ht.getoffsetX(oi),er,Er,E,Be,De,x.segment,Yr,gn,Ut,H,Ne));$e.push(vn.last)}else{if(M&&!E){var Ri=Ua(De,U).point,Di=x.lineStartIndex+x.segment+1,ia=new k.Point(Ut.getx(Di),Ut.gety(Di)),na=Ua(ia,U),co=na.signedDistanceFromCamera>0?na.point:ge(De,ia,Ri,1,U),Bi=_o(x.writingMode,Ri,co,fr);if(Bi)return Bi}var Pa=He(_r*ht.getoffsetX(x.glyphStartIndex),er,Er,E,Be,De,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,Ut,H,Ne);if(!Pa)return{notEnoughRoom:!0};$e=[Pa]}for(var Ra=0,Aa=$e;Ra<Aa.length;Ra+=1){var ya=Aa[Ra];k.addDynamicAttributes(ie,ya.point,ya.angle)}return{}}function ge(x,C,E,M,U){var H=Ua(x.add(x.sub(C)._unit()),U).point,$=E.sub(H);return E.add($._mult(M/$.mag()))}function He(x,C,E,M,U,H,$,ht,Ut,ie,Be,De){var Ne=M?x-C:x+C,fr=Ne>0?1:-1,$e=0;M&&(fr*=-1,$e=Math.PI),fr<0&&($e+=Math.PI);for(var _r=fr>0?ht+$:ht+$+1,er=U,Er=U,Or=0,Yr=0,gn=Math.abs(Ne),vn=[];Or+Yr<=gn;){if((_r+=fr)<ht||_r>=Ut)return null;if(Er=er,vn.push(er),(er=De[_r])===void 0){var _n=new k.Point(ie.getx(_r),ie.gety(_r)),Un=Ua(_n,Be);if(Un.signedDistanceFromCamera>0)er=De[_r]=Un.point;else{var ui=_r-fr;er=ge(Or===0?H:new k.Point(ie.getx(ui),ie.gety(ui)),_n,Er,gn-Or+1,Be)}}Or+=Yr,Yr=Er.dist(er)}var oi=(gn-Or)/Yr,Ri=er.sub(Er),Di=Ri.mult(oi)._add(Er);Di._add(Ri._unit()._perp()._mult(E*fr));var ia=$e+Math.atan2(er.y-Er.y,er.x-Er.x);return vn.push(Di),{point:Di,angle:ia,path:vn}}Qa.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Qa.prototype.insert=function(x,C,E,M,U){this._forEachCell(C,E,M,U,this._insertBoxCell,this.boxUid++),this.boxKeys.push(x),this.bboxes.push(C),this.bboxes.push(E),this.bboxes.push(M),this.bboxes.push(U)},Qa.prototype.insertCircle=function(x,C,E,M){this._forEachCell(C-M,E-M,C+M,E+M,this._insertCircleCell,this.circleUid++),this.circleKeys.push(x),this.circles.push(C),this.circles.push(E),this.circles.push(M)},Qa.prototype._insertBoxCell=function(x,C,E,M,U,H){this.boxCells[U].push(H)},Qa.prototype._insertCircleCell=function(x,C,E,M,U,H){this.circleCells[U].push(H)},Qa.prototype._query=function(x,C,E,M,U,H){if(E<0||x>this.width||M<0||C>this.height)return!U&&[];var $=[];if(x<=0&&C<=0&&this.width<=E&&this.height<=M){if(U)return!0;for(var ht=0;ht<this.boxKeys.length;ht++)$.push({key:this.boxKeys[ht],x1:this.bboxes[4*ht],y1:this.bboxes[4*ht+1],x2:this.bboxes[4*ht+2],y2:this.bboxes[4*ht+3]});for(var Ut=0;Ut<this.circleKeys.length;Ut++){var ie=this.circles[3*Ut],Be=this.circles[3*Ut+1],De=this.circles[3*Ut+2];$.push({key:this.circleKeys[Ut],x1:ie-De,y1:Be-De,x2:ie+De,y2:Be+De})}return H?$.filter(H):$}return this._forEachCell(x,C,E,M,this._queryCell,$,{hitTest:U,seenUids:{box:{},circle:{}}},H),U?$.length>0:$},Qa.prototype._queryCircle=function(x,C,E,M,U){var H=x-E,$=x+E,ht=C-E,Ut=C+E;if($<0||H>this.width||Ut<0||ht>this.height)return!M&&[];var ie=[];return this._forEachCell(H,ht,$,Ut,this._queryCellCircle,ie,{hitTest:M,circle:{x,y:C,radius:E},seenUids:{box:{},circle:{}}},U),M?ie.length>0:ie},Qa.prototype.query=function(x,C,E,M,U){return this._query(x,C,E,M,!1,U)},Qa.prototype.hitTest=function(x,C,E,M,U){return this._query(x,C,E,M,!0,U)},Qa.prototype.hitTestCircle=function(x,C,E,M){return this._queryCircle(x,C,E,!0,M)},Qa.prototype._queryCell=function(x,C,E,M,U,H,$,ht){var Ut=$.seenUids,ie=this.boxCells[U];if(ie!==null)for(var Be=this.bboxes,De=0,Ne=ie;De<Ne.length;De+=1){var fr=Ne[De];if(!Ut.box[fr]){Ut.box[fr]=!0;var $e=4*fr;if(x<=Be[$e+2]&&C<=Be[$e+3]&&E>=Be[$e+0]&&M>=Be[$e+1]&&(!ht||ht(this.boxKeys[fr]))){if($.hitTest)return H.push(!0),!0;H.push({key:this.boxKeys[fr],x1:Be[$e],y1:Be[$e+1],x2:Be[$e+2],y2:Be[$e+3]})}}}var _r=this.circleCells[U];if(_r!==null)for(var er=this.circles,Er=0,Or=_r;Er<Or.length;Er+=1){var Yr=Or[Er];if(!Ut.circle[Yr]){Ut.circle[Yr]=!0;var gn=3*Yr;if(this._circleAndRectCollide(er[gn],er[gn+1],er[gn+2],x,C,E,M)&&(!ht||ht(this.circleKeys[Yr]))){if($.hitTest)return H.push(!0),!0;var vn=er[gn],_n=er[gn+1],Un=er[gn+2];H.push({key:this.circleKeys[Yr],x1:vn-Un,y1:_n-Un,x2:vn+Un,y2:_n+Un})}}}},Qa.prototype._queryCellCircle=function(x,C,E,M,U,H,$,ht){var Ut=$.circle,ie=$.seenUids,Be=this.boxCells[U];if(Be!==null)for(var De=this.bboxes,Ne=0,fr=Be;Ne<fr.length;Ne+=1){var $e=fr[Ne];if(!ie.box[$e]){ie.box[$e]=!0;var _r=4*$e;if(this._circleAndRectCollide(Ut.x,Ut.y,Ut.radius,De[_r+0],De[_r+1],De[_r+2],De[_r+3])&&(!ht||ht(this.boxKeys[$e])))return H.push(!0),!0}}var er=this.circleCells[U];if(er!==null)for(var Er=this.circles,Or=0,Yr=er;Or<Yr.length;Or+=1){var gn=Yr[Or];if(!ie.circle[gn]){ie.circle[gn]=!0;var vn=3*gn;if(this._circlesCollide(Er[vn],Er[vn+1],Er[vn+2],Ut.x,Ut.y,Ut.radius)&&(!ht||ht(this.circleKeys[gn])))return H.push(!0),!0}}},Qa.prototype._forEachCell=function(x,C,E,M,U,H,$,ht){for(var Ut=this._convertToXCellCoord(x),ie=this._convertToYCellCoord(C),Be=this._convertToXCellCoord(E),De=this._convertToYCellCoord(M),Ne=Ut;Ne<=Be;Ne++)for(var fr=ie;fr<=De;fr++)if(U.call(this,x,C,E,M,this.xCellCount*fr+Ne,H,$,ht))return},Qa.prototype._convertToXCellCoord=function(x){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(x*this.xScale)))},Qa.prototype._convertToYCellCoord=function(x){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(x*this.yScale)))},Qa.prototype._circlesCollide=function(x,C,E,M,U,H){var $=M-x,ht=U-C,Ut=E+H;return Ut*Ut>$*$+ht*ht},Qa.prototype._circleAndRectCollide=function(x,C,E,M,U,H,$){var ht=(H-M)/2,Ut=Math.abs(x-(M+ht));if(Ut>ht+E)return!1;var ie=($-U)/2,Be=Math.abs(C-(U+ie));if(Be>ie+E)return!1;if(Ut<=ht||Be<=ie)return!0;var De=Ut-ht,Ne=Be-ie;return De*De+Ne*Ne<=E*E};var Ir=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function en(x,C){for(var E=0;E<x;E++){var M=C.length;C.resize(M+4),C.float32.set(Ir,3*M)}}function On(x,C,E){var M=C[0],U=C[1];return x[0]=E[0]*M+E[4]*U+E[12],x[1]=E[1]*M+E[5]*U+E[13],x[3]=E[3]*M+E[7]*U+E[15],x}var zn=function(x,C,E){C===void 0&&(C=new Qa(x.width+200,x.height+200,25)),E===void 0&&(E=new Qa(x.width+200,x.height+200,25)),this.transform=x,this.grid=C,this.ignoredGrid=E,this.pitchfactor=Math.cos(x._pitch)*x.cameraToCenterDistance,this.screenRightBoundary=x.width+100,this.screenBottomBoundary=x.height+100,this.gridRightBoundary=x.width+200,this.gridBottomBoundary=x.height+200};function kn(x,C,E){return C*(k.EXTENT/(x.tileSize*Math.pow(2,E-x.tileID.overscaledZ)))}zn.prototype.placeCollisionBox=function(x,C,E,M,U){var H=this.projectAndGetPerspectiveRatio(M,x.anchorPointX,x.anchorPointY),$=E*H.perspectiveRatio,ht=x.x1*$+H.point.x,Ut=x.y1*$+H.point.y,ie=x.x2*$+H.point.x,Be=x.y2*$+H.point.y;return!this.isInsideGrid(ht,Ut,ie,Be)||!C&&this.grid.hitTest(ht,Ut,ie,Be,U)?{box:[],offscreen:!1}:{box:[ht,Ut,ie,Be],offscreen:this.isOffscreen(ht,Ut,ie,Be)}},zn.prototype.placeCollisionCircles=function(x,C,E,M,U,H,$,ht,Ut,ie,Be,De,Ne){var fr=[],$e=new k.Point(C.anchorX,C.anchorY),_r=Ua($e,H),er=Xa(this.transform.cameraToCenterDistance,_r.signedDistanceFromCamera),Er=(ie?U/er:U*er)/k.ONE_EM,Or=Ua($e,$).point,Yr=Yo(Er,M,C.lineOffsetX*Er,C.lineOffsetY*Er,!1,Or,$e,C,E,$,{}),gn=!1,vn=!1,_n=!0;if(Yr){for(var Un=.5*De*er+Ne,ui=new k.Point(-100,-100),oi=new k.Point(this.screenRightBoundary,this.screenBottomBoundary),Ri=new ma,Di=Yr.first,ia=Yr.last,na=[],co=Di.path.length-1;co>=1;co--)na.push(Di.path[co]);for(var Bi=1;Bi<ia.path.length;Bi++)na.push(ia.path[Bi]);var Pa=2.5*Un;if(ht){var Ra=na.map(function(Tl){return Ua(Tl,ht)});na=Ra.some(function(Tl){return Tl.signedDistanceFromCamera<=0})?[]:Ra.map(function(Tl){return Tl.point})}var Aa=[];if(na.length>0){for(var ya=na[0].clone(),Ba=na[0].clone(),Ea=1;Ea<na.length;Ea++)ya.x=Math.min(ya.x,na[Ea].x),ya.y=Math.min(ya.y,na[Ea].y),Ba.x=Math.max(Ba.x,na[Ea].x),Ba.y=Math.max(Ba.y,na[Ea].y);Aa=ya.x>=ui.x&&Ba.x<=oi.x&&ya.y>=ui.y&&Ba.y<=oi.y?[na]:Ba.x<ui.x||ya.x>oi.x||Ba.y<ui.y||ya.y>oi.y?[]:k.clipLine([na],ui.x,ui.y,oi.x,oi.y)}for(var ca=0,Ys=Aa;ca<Ys.length;ca+=1){var xs;Ri.reset(Ys[ca],.25*Un),xs=Ri.length<=.5*Un?1:Math.ceil(Ri.paddedLength/Pa)+1;for(var ru=0;ru<xs;ru++){var hu=ru/Math.max(xs-1,1),Ko=Ri.lerp(hu),bs=Ko.x+100,Au=Ko.y+100;fr.push(bs,Au,Un,0);var nu=bs-Un,mc=Au-Un,pu=bs+Un,Vl=Au+Un;if(_n=_n&&this.isOffscreen(nu,mc,pu,Vl),vn=vn||this.isInsideGrid(nu,mc,pu,Vl),!x&&this.grid.hitTestCircle(bs,Au,Un,Be)&&(gn=!0,!Ut))return{circles:[],offscreen:!1,collisionDetected:gn}}}}return{circles:!Ut&&gn||!vn?[]:fr,offscreen:_n,collisionDetected:gn}},zn.prototype.queryRenderedSymbols=function(x){if(x.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var C=[],E=1/0,M=1/0,U=-1/0,H=-1/0,$=0,ht=x;$<ht.length;$+=1){var Ut=ht[$],ie=new k.Point(Ut.x+100,Ut.y+100);E=Math.min(E,ie.x),M=Math.min(M,ie.y),U=Math.max(U,ie.x),H=Math.max(H,ie.y),C.push(ie)}for(var Be={},De={},Ne=0,fr=this.grid.query(E,M,U,H).concat(this.ignoredGrid.query(E,M,U,H));Ne<fr.length;Ne+=1){var $e=fr[Ne],_r=$e.key;if(Be[_r.bucketInstanceId]===void 0&&(Be[_r.bucketInstanceId]={}),!Be[_r.bucketInstanceId][_r.featureIndex]){var er=[new k.Point($e.x1,$e.y1),new k.Point($e.x2,$e.y1),new k.Point($e.x2,$e.y2),new k.Point($e.x1,$e.y2)];k.polygonIntersectsPolygon(C,er)&&(Be[_r.bucketInstanceId][_r.featureIndex]=!0,De[_r.bucketInstanceId]===void 0&&(De[_r.bucketInstanceId]=[]),De[_r.bucketInstanceId].push(_r.featureIndex))}}return De},zn.prototype.insertCollisionBox=function(x,C,E,M,U){(C?this.ignoredGrid:this.grid).insert({bucketInstanceId:E,featureIndex:M,collisionGroupID:U},x[0],x[1],x[2],x[3])},zn.prototype.insertCollisionCircles=function(x,C,E,M,U){for(var H=C?this.ignoredGrid:this.grid,$={bucketInstanceId:E,featureIndex:M,collisionGroupID:U},ht=0;ht<x.length;ht+=4)H.insertCircle($,x[ht],x[ht+1],x[ht+2])},zn.prototype.projectAndGetPerspectiveRatio=function(x,C,E){var M=[C,E,0,1];return On(M,M,x),{point:new k.Point((M[0]/M[3]+1)/2*this.transform.width+100,(-M[1]/M[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M[3]*.5}},zn.prototype.isOffscreen=function(x,C,E,M){return E<100||x>=this.screenRightBoundary||M<100||C>this.screenBottomBoundary},zn.prototype.isInsideGrid=function(x,C,E,M){return E>=0&&x<this.gridRightBoundary&&M>=0&&C<this.gridBottomBoundary},zn.prototype.getViewportMatrix=function(){var x=k.identity([]);return k.translate(x,x,[-100,-100,0]),x};var qi=function(x,C,E,M){this.opacity=x?Math.max(0,Math.min(1,x.opacity+(x.placed?C:-C))):M&&E?1:0,this.placed=E};qi.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Oa=function(x,C,E,M,U){this.text=new qi(x?x.text:null,C,E,U),this.icon=new qi(x?x.icon:null,C,M,U)};Oa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var us=function(x,C,E){this.text=x,this.icon=C,this.skipFade=E},Ao=function(){this.invProjMatrix=k.create(),this.viewportMatrix=k.create(),this.circles=[]},Ho=function(x,C,E,M,U){this.bucketInstanceId=x,this.featureIndex=C,this.sourceLayerIndex=E,this.bucketIndex=M,this.tileID=U},uo=function(x){this.crossSourceCollisions=x,this.maxGroupID=0,this.collisionGroups={}};function Zo(x,C,E,M,U){var H=k.getAnchorAlignment(x),$=-(H.horizontalAlign-.5)*C,ht=-(H.verticalAlign-.5)*E,Ut=k.evaluateVariableOffset(x,M);return new k.Point($+Ut[0]*U,ht+Ut[1]*U)}function Qs(x,C,E,M,U,H){var $=x.x1,ht=x.x2,Ut=x.y1,ie=x.y2,Be=x.anchorPointX,De=x.anchorPointY,Ne=new k.Point(C,E);return M&&Ne._rotate(U?H:-H),{x1:$+Ne.x,y1:Ut+Ne.y,x2:ht+Ne.x,y2:ie+Ne.y,anchorPointX:Be,anchorPointY:De}}uo.prototype.get=function(x){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[x]){var C=++this.maxGroupID;this.collisionGroups[x]={ID:C,predicate:function(E){return E.collisionGroupID===C}}}return this.collisionGroups[x]};var jo=function(x,C,E,M){this.transform=x.clone(),this.collisionIndex=new zn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=C,this.retainedQueryData={},this.collisionGroups=new uo(E),this.collisionCircleArrays={},this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}};function _l(x,C,E,M,U){x.emplaceBack(C?1:0,E?1:0,M||0,U||0),x.emplaceBack(C?1:0,E?1:0,M||0,U||0),x.emplaceBack(C?1:0,E?1:0,M||0,U||0),x.emplaceBack(C?1:0,E?1:0,M||0,U||0)}jo.prototype.getBucketParts=function(x,C,E,M){var U=E.getBucket(C),H=E.latestFeatureIndex;if(U&&H&&C.id===U.layerIds[0]){var $=E.collisionBoxArray,ht=U.layers[0].layout,Ut=Math.pow(2,this.transform.zoom-E.tileID.overscaledZ),ie=E.tileSize/k.EXTENT,Be=this.transform.calculatePosMatrix(E.tileID.toUnwrapped()),De=ht.get("text-pitch-alignment")==="map",Ne=ht.get("text-rotation-alignment")==="map",fr=kn(E,1,this.transform.zoom),$e=Uo(Be,De,Ne,this.transform,fr),_r=null;if(De){var er=vo(Be,De,Ne,this.transform,fr);_r=k.multiply([],this.transform.labelPlaneMatrix,er)}this.retainedQueryData[U.bucketInstanceId]=new Ho(U.bucketInstanceId,H,U.sourceLayerIndex,U.index,E.tileID);var Er={bucket:U,layout:ht,posMatrix:Be,textLabelPlaneMatrix:$e,labelToScreenMatrix:_r,scale:Ut,textPixelRatio:ie,holdingForFade:E.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:k.evaluateSizeForZoom(U.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(U.sourceID)};if(M)for(var Or=0,Yr=U.sortKeyRanges;Or<Yr.length;Or+=1){var gn=Yr[Or];x.push({sortKey:gn.sortKey,symbolInstanceStart:gn.symbolInstanceStart,symbolInstanceEnd:gn.symbolInstanceEnd,parameters:Er})}else x.push({symbolInstanceStart:0,symbolInstanceEnd:U.symbolInstances.length,parameters:Er})}},jo.prototype.attemptAnchorPlacement=function(x,C,E,M,U,H,$,ht,Ut,ie,Be,De,Ne,fr,$e){var _r,er=[De.textOffset0,De.textOffset1],Er=Zo(x,E,M,er,U),Or=this.collisionIndex.placeCollisionBox(Qs(C,Er.x,Er.y,H,$,this.transform.angle),Be,ht,Ut,ie.predicate);if(!$e||this.collisionIndex.placeCollisionBox(Qs($e,Er.x,Er.y,H,$,this.transform.angle),Be,ht,Ut,ie.predicate).box.length!==0)return Or.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID].text&&(_r=this.prevPlacement.variableOffsets[De.crossTileID].anchor),this.variableOffsets[De.crossTileID]={textOffset:er,width:E,height:M,anchor:x,textBoxScale:U,prevAnchor:_r},this.markUsedJustification(Ne,x,De,fr),Ne.allowVerticalPlacement&&(this.markUsedOrientation(Ne,fr,De),this.placedOrientations[De.crossTileID]=fr),{shift:Er,placedGlyphBoxes:Or}):void 0},jo.prototype.placeLayerBucketPart=function(x,C,E){var M=this,U=x.parameters,H=U.bucket,$=U.layout,ht=U.posMatrix,Ut=U.textLabelPlaneMatrix,ie=U.labelToScreenMatrix,Be=U.textPixelRatio,De=U.holdingForFade,Ne=U.collisionBoxArray,fr=U.partiallyEvaluatedTextSize,$e=U.collisionGroup,_r=$.get("text-optional"),er=$.get("icon-optional"),Er=$.get("text-allow-overlap"),Or=$.get("icon-allow-overlap"),Yr=$.get("text-rotation-alignment")==="map",gn=$.get("text-pitch-alignment")==="map",vn=$.get("icon-text-fit")!=="none",_n=$.get("symbol-z-order")==="viewport-y",Un=Er&&(Or||!H.hasIconData()||er),ui=Or&&(Er||!H.hasTextData()||_r);!H.collisionArrays&&Ne&&H.deserializeCollisionBoxes(Ne);var oi=function(Bi,Pa){if(!C[Bi.crossTileID])if(De)M.placements[Bi.crossTileID]=new us(!1,!1,!1);else{var Ra,Aa=!1,ya=!1,Ba=!0,Ea=null,ca={box:null,offscreen:null},Ys={box:null,offscreen:null},xs=null,ru=null,hu=0,Ko=0,bs=0;Pa.textFeatureIndex?hu=Pa.textFeatureIndex:Bi.useRuntimeCollisionCircles&&(hu=Bi.featureIndex),Pa.verticalTextFeatureIndex&&(Ko=Pa.verticalTextFeatureIndex);var Au=Pa.textBox;if(Au){var nu=function(Eo){var Gl=k.WritingMode.horizontal;if(H.allowVerticalPlacement&&!Eo&&M.prevPlacement){var al=M.prevPlacement.placedOrientations[Bi.crossTileID];al&&(M.placedOrientations[Bi.crossTileID]=al,M.markUsedOrientation(H,Gl=al,Bi))}return Gl},mc=function(Eo,Gl){if(H.allowVerticalPlacement&&Bi.numVerticalGlyphVertices>0&&Pa.verticalTextBox)for(var al=0,Oc=H.writingModes;al<Oc.length&&(Oc[al]===k.WritingMode.vertical?(ca=Gl(),Ys=ca):ca=Eo(),!(ca&&ca.box&&ca.box.length));al+=1);else ca=Eo()};if($.get("text-variable-anchor")){var pu=$.get("text-variable-anchor");if(M.prevPlacement&&M.prevPlacement.variableOffsets[Bi.crossTileID]){var Vl=M.prevPlacement.variableOffsets[Bi.crossTileID];pu.indexOf(Vl.anchor)>0&&(pu=pu.filter(function(Eo){return Eo!==Vl.anchor})).unshift(Vl.anchor)}var Tl=function(Eo,Gl,al){for(var Oc=Eo.x2-Eo.x1,th=Eo.y2-Eo.y1,kp=Bi.textBoxScale,fd=vn&&!Or?Gl:null,au={box:[],offscreen:!1},kl=Er?2*pu.length:pu.length,ol=0;ol<kl;++ol){var yc=M.attemptAnchorPlacement(pu[ol%pu.length],Eo,Oc,th,kp,Yr,gn,Be,ht,$e,ol>=pu.length,Bi,H,al,fd);if(yc&&(au=yc.placedGlyphBoxes)&&au.box&&au.box.length){Aa=!0,Ea=yc.shift;break}}return au};mc(function(){return Tl(Au,Pa.iconBox,k.WritingMode.horizontal)},function(){var Eo=Pa.verticalTextBox;return H.allowVerticalPlacement&&!(ca&&ca.box&&ca.box.length)&&Bi.numVerticalGlyphVertices>0&&Eo?Tl(Eo,Pa.verticalIconBox,k.WritingMode.vertical):{box:null,offscreen:null}}),ca&&(Aa=ca.box,Ba=ca.offscreen);var Kf=nu(ca&&ca.box);if(!Aa&&M.prevPlacement){var Qf=M.prevPlacement.variableOffsets[Bi.crossTileID];Qf&&(M.variableOffsets[Bi.crossTileID]=Qf,M.markUsedJustification(H,Qf.anchor,Bi,Kf))}}else{var Ml=function(Eo,Gl){var al=M.collisionIndex.placeCollisionBox(Eo,Er,Be,ht,$e.predicate);return al&&al.box&&al.box.length&&(M.markUsedOrientation(H,Gl,Bi),M.placedOrientations[Bi.crossTileID]=Gl),al};mc(function(){return Ml(Au,k.WritingMode.horizontal)},function(){var Eo=Pa.verticalTextBox;return H.allowVerticalPlacement&&Bi.numVerticalGlyphVertices>0&&Eo?Ml(Eo,k.WritingMode.vertical):{box:null,offscreen:null}}),nu(ca&&ca.box&&ca.box.length)}}if(Aa=(Ra=ca)&&Ra.box&&Ra.box.length>0,Ba=Ra&&Ra.offscreen,Bi.useRuntimeCollisionCircles){var Tf=H.text.placedSymbolArray.get(Bi.centerJustifiedTextSymbolIndex),yh=k.evaluateSizeForFeature(H.textSizeData,fr,Tf),sc=$.get("text-padding");xs=M.collisionIndex.placeCollisionCircles(Er,Tf,H.lineVertexArray,H.glyphOffsetArray,yh,ht,Ut,ie,E,gn,$e.predicate,Bi.collisionCircleDiameter,sc),Aa=Er||xs.circles.length>0&&!xs.collisionDetected,Ba=Ba&&xs.offscreen}if(Pa.iconFeatureIndex&&(bs=Pa.iconFeatureIndex),Pa.iconBox){var Jf=function(Eo){var Gl=vn&&Ea?Qs(Eo,Ea.x,Ea.y,Yr,gn,M.transform.angle):Eo;return M.collisionIndex.placeCollisionBox(Gl,Or,Be,ht,$e.predicate)};ya=Ys&&Ys.box&&Ys.box.length&&Pa.verticalIconBox?(ru=Jf(Pa.verticalIconBox)).box.length>0:(ru=Jf(Pa.iconBox)).box.length>0,Ba=Ba&&ru.offscreen}var Il=_r||Bi.numHorizontalGlyphVertices===0&&Bi.numVerticalGlyphVertices===0,Rs=er||Bi.numIconVertices===0;if(Il||Rs?Rs?Il||(ya=ya&&Aa):Aa=ya&&Aa:ya=Aa=ya&&Aa,Aa&&Ra&&Ra.box&&M.collisionIndex.insertCollisionBox(Ra.box,$.get("text-ignore-placement"),H.bucketInstanceId,Ys&&Ys.box&&Ko?Ko:hu,$e.ID),ya&&ru&&M.collisionIndex.insertCollisionBox(ru.box,$.get("icon-ignore-placement"),H.bucketInstanceId,bs,$e.ID),xs&&(Aa&&M.collisionIndex.insertCollisionCircles(xs.circles,$.get("text-ignore-placement"),H.bucketInstanceId,hu,$e.ID),E)){var iu=H.bucketInstanceId,uc=M.collisionCircleArrays[iu];uc===void 0&&(uc=M.collisionCircleArrays[iu]=new Ao);for(var Pc=0;Pc<xs.circles.length;Pc+=4)uc.circles.push(xs.circles[Pc+0]),uc.circles.push(xs.circles[Pc+1]),uc.circles.push(xs.circles[Pc+2]),uc.circles.push(xs.collisionDetected?1:0)}M.placements[Bi.crossTileID]=new us(Aa||Un,ya||ui,Ba||H.justReloaded),C[Bi.crossTileID]=!0}};if(_n)for(var Ri=H.getSortedSymbolIndexes(this.transform.angle),Di=Ri.length-1;Di>=0;--Di){var ia=Ri[Di];oi(H.symbolInstances.get(ia),H.collisionArrays[ia])}else for(var na=x.symbolInstanceStart;na<x.symbolInstanceEnd;na++)oi(H.symbolInstances.get(na),H.collisionArrays[na]);if(E&&H.bucketInstanceId in this.collisionCircleArrays){var co=this.collisionCircleArrays[H.bucketInstanceId];k.invert(co.invProjMatrix,ht),co.viewportMatrix=this.collisionIndex.getViewportMatrix()}H.justReloaded=!1},jo.prototype.markUsedJustification=function(x,C,E,M){var U;U=M===k.WritingMode.vertical?E.verticalPlacedTextSymbolIndex:{left:E.leftJustifiedTextSymbolIndex,center:E.centerJustifiedTextSymbolIndex,right:E.rightJustifiedTextSymbolIndex}[k.getAnchorJustification(C)];for(var H=0,$=[E.leftJustifiedTextSymbolIndex,E.centerJustifiedTextSymbolIndex,E.rightJustifiedTextSymbolIndex,E.verticalPlacedTextSymbolIndex];H<$.length;H+=1){var ht=$[H];ht>=0&&(x.text.placedSymbolArray.get(ht).crossTileID=U>=0&&ht!==U?0:E.crossTileID)}},jo.prototype.markUsedOrientation=function(x,C,E){for(var M=C===k.WritingMode.horizontal||C===k.WritingMode.horizontalOnly?C:0,U=C===k.WritingMode.vertical?C:0,H=0,$=[E.leftJustifiedTextSymbolIndex,E.centerJustifiedTextSymbolIndex,E.rightJustifiedTextSymbolIndex];H<$.length;H+=1)x.text.placedSymbolArray.get($[H]).placedOrientation=M;E.verticalPlacedTextSymbolIndex&&(x.text.placedSymbolArray.get(E.verticalPlacedTextSymbolIndex).placedOrientation=U)},jo.prototype.commit=function(x){this.commitTime=x,this.zoomAtLastRecencyCheck=this.transform.zoom;var C=this.prevPlacement,E=!1;this.prevZoomAdjustment=C?C.zoomAdjustment(this.transform.zoom):0;var M=C?C.symbolFadeChange(x):1,U=C?C.opacities:{},H=C?C.variableOffsets:{},$=C?C.placedOrientations:{};for(var ht in this.placements){var Ut=this.placements[ht],ie=U[ht];ie?(this.opacities[ht]=new Oa(ie,M,Ut.text,Ut.icon),E=E||Ut.text!==ie.text.placed||Ut.icon!==ie.icon.placed):(this.opacities[ht]=new Oa(null,M,Ut.text,Ut.icon,Ut.skipFade),E=E||Ut.text||Ut.icon)}for(var Be in U){var De=U[Be];if(!this.opacities[Be]){var Ne=new Oa(De,M,!1,!1);Ne.isHidden()||(this.opacities[Be]=Ne,E=E||De.text.placed||De.icon.placed)}}for(var fr in H)this.variableOffsets[fr]||!this.opacities[fr]||this.opacities[fr].isHidden()||(this.variableOffsets[fr]=H[fr]);for(var $e in $)this.placedOrientations[$e]||!this.opacities[$e]||this.opacities[$e].isHidden()||(this.placedOrientations[$e]=$[$e]);E?this.lastPlacementChangeTime=x:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=C?C.lastPlacementChangeTime:x)},jo.prototype.updateLayerOpacities=function(x,C){for(var E={},M=0,U=C;M<U.length;M+=1){var H=U[M],$=H.getBucket(x);$&&H.latestFeatureIndex&&x.id===$.layerIds[0]&&this.updateBucketOpacities($,E,H.collisionBoxArray)}},jo.prototype.updateBucketOpacities=function(x,C,E){var M=this;x.hasTextData()&&x.text.opacityVertexArray.clear(),x.hasIconData()&&x.icon.opacityVertexArray.clear(),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexArray.clear(),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexArray.clear();var U=x.layers[0].layout,H=new Oa(null,0,!1,!1,!0),$=U.get("text-allow-overlap"),ht=U.get("icon-allow-overlap"),Ut=U.get("text-variable-anchor"),ie=U.get("text-rotation-alignment")==="map",Be=U.get("text-pitch-alignment")==="map",De=U.get("icon-text-fit")!=="none",Ne=new Oa(null,0,$&&(ht||!x.hasIconData()||U.get("icon-optional")),ht&&($||!x.hasTextData()||U.get("text-optional")),!0);!x.collisionArrays&&E&&(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData())&&x.deserializeCollisionBoxes(E);for(var fr=function(Er,Or,Yr){for(var gn=0;gn<Or/4;gn++)Er.opacityVertexArray.emplaceBack(Yr)},$e=function(Er){var Or=x.symbolInstances.get(Er),Yr=Or.numHorizontalGlyphVertices,gn=Or.numVerticalGlyphVertices,vn=Or.crossTileID,_n=M.opacities[vn];C[vn]?_n=H:_n||(M.opacities[vn]=_n=Ne),C[vn]=!0;var Un=Or.numIconVertices>0,ui=M.placedOrientations[Or.crossTileID],oi=ui===k.WritingMode.vertical,Ri=ui===k.WritingMode.horizontal||ui===k.WritingMode.horizontalOnly;if(Yr>0||gn>0){var Di=Pi(_n.text);fr(x.text,Yr,oi?ja:Di),fr(x.text,gn,Ri?ja:Di);var ia=_n.text.isHidden();[Or.rightJustifiedTextSymbolIndex,Or.centerJustifiedTextSymbolIndex,Or.leftJustifiedTextSymbolIndex].forEach(function(ca){ca>=0&&(x.text.placedSymbolArray.get(ca).hidden=ia||oi?1:0)}),Or.verticalPlacedTextSymbolIndex>=0&&(x.text.placedSymbolArray.get(Or.verticalPlacedTextSymbolIndex).hidden=ia||Ri?1:0);var na=M.variableOffsets[Or.crossTileID];na&&M.markUsedJustification(x,na.anchor,Or,ui);var co=M.placedOrientations[Or.crossTileID];co&&(M.markUsedJustification(x,"left",Or,co),M.markUsedOrientation(x,co,Or))}if(Un){var Bi=Pi(_n.icon),Pa=!(De&&Or.verticalPlacedIconSymbolIndex&&oi);Or.placedIconSymbolIndex>=0&&(fr(x.icon,Or.numIconVertices,Pa?Bi:ja),x.icon.placedSymbolArray.get(Or.placedIconSymbolIndex).hidden=_n.icon.isHidden()),Or.verticalPlacedIconSymbolIndex>=0&&(fr(x.icon,Or.numVerticalIconVertices,Pa?ja:Bi),x.icon.placedSymbolArray.get(Or.verticalPlacedIconSymbolIndex).hidden=_n.icon.isHidden())}if(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData()){var Ra=x.collisionArrays[Er];if(Ra){var Aa=new k.Point(0,0);if(Ra.textBox||Ra.verticalTextBox){var ya=!0;if(Ut){var Ba=M.variableOffsets[vn];Ba?(Aa=Zo(Ba.anchor,Ba.width,Ba.height,Ba.textOffset,Ba.textBoxScale),ie&&Aa._rotate(Be?M.transform.angle:-M.transform.angle)):ya=!1}Ra.textBox&&_l(x.textCollisionBox.collisionVertexArray,_n.text.placed,!ya||oi,Aa.x,Aa.y),Ra.verticalTextBox&&_l(x.textCollisionBox.collisionVertexArray,_n.text.placed,!ya||Ri,Aa.x,Aa.y)}var Ea=Boolean(!Ri&&Ra.verticalIconBox);Ra.iconBox&&_l(x.iconCollisionBox.collisionVertexArray,_n.icon.placed,Ea,De?Aa.x:0,De?Aa.y:0),Ra.verticalIconBox&&_l(x.iconCollisionBox.collisionVertexArray,_n.icon.placed,!Ea,De?Aa.x:0,De?Aa.y:0)}}},_r=0;_r<x.symbolInstances.length;_r++)$e(_r);if(x.sortFeatures(this.transform.angle),this.retainedQueryData[x.bucketInstanceId]&&(this.retainedQueryData[x.bucketInstanceId].featureSortOrder=x.featureSortOrder),x.hasTextData()&&x.text.opacityVertexBuffer&&x.text.opacityVertexBuffer.updateData(x.text.opacityVertexArray),x.hasIconData()&&x.icon.opacityVertexBuffer&&x.icon.opacityVertexBuffer.updateData(x.icon.opacityVertexArray),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexBuffer&&x.iconCollisionBox.collisionVertexBuffer.updateData(x.iconCollisionBox.collisionVertexArray),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexBuffer&&x.textCollisionBox.collisionVertexBuffer.updateData(x.textCollisionBox.collisionVertexArray),x.bucketInstanceId in this.collisionCircleArrays){var er=this.collisionCircleArrays[x.bucketInstanceId];x.placementInvProjMatrix=er.invProjMatrix,x.placementViewportMatrix=er.viewportMatrix,x.collisionCircleArray=er.circles,delete this.collisionCircleArrays[x.bucketInstanceId]}},jo.prototype.symbolFadeChange=function(x){return this.fadeDuration===0?1:(x-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},jo.prototype.zoomAdjustment=function(x){return Math.max(0,(this.transform.zoom-x)/1.5)},jo.prototype.hasTransitions=function(x){return this.stale||x-this.lastPlacementChangeTime<this.fadeDuration},jo.prototype.stillRecent=function(x,C){var E=this.zoomAtLastRecencyCheck===C?1-this.zoomAdjustment(C):1;return this.zoomAtLastRecencyCheck=C,this.commitTime+this.fadeDuration*E>x},jo.prototype.setStale=function(){this.stale=!0};var Hc=Math.pow(2,25),$u=Math.pow(2,24),Ae=Math.pow(2,17),Xe=Math.pow(2,16),Cr=Math.pow(2,9),sn=Math.pow(2,8),si=Math.pow(2,1);function Pi(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;var C=x.placed?1:0,E=Math.floor(127*x.opacity);return E*Hc+C*$u+E*Ae+C*Xe+E*Cr+C*sn+E*si+C}var ja=0,vs=function(x){this._sortAcrossTiles=x.layout.get("symbol-z-order")!=="viewport-y"&&x.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};vs.prototype.continuePlacement=function(x,C,E,M,U){for(var H=this._bucketParts;this._currentTileIndex<x.length;)if(C.getBucketParts(H,M,x[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,U())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,H.sort(function($,ht){return $.sortKey-ht.sortKey}));this._currentPartIndex<H.length;)if(C.placeLayerBucketPart(H[this._currentPartIndex],this._seenCrossTileIDs,E),this._currentPartIndex++,U())return!0;return!1};var $o=function(x,C,E,M,U,H,$){this.placement=new jo(x,U,H,$),this._currentPlacementIndex=C.length-1,this._forceFullPlacement=E,this._showCollisionBoxes=M,this._done=!1};$o.prototype.isDone=function(){return this._done},$o.prototype.continuePlacement=function(x,C,E){for(var M=this,U=k.browser.now(),H=function(){var Ut=k.browser.now()-U;return!M._forceFullPlacement&&Ut>2};this._currentPlacementIndex>=0;){var $=C[x[this._currentPlacementIndex]],ht=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=ht)&&(!$.maxzoom||$.maxzoom>ht)){if(this._inProgressLayer||(this._inProgressLayer=new vs($)),this._inProgressLayer.continuePlacement(E[$.source],this.placement,this._showCollisionBoxes,$,H))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},$o.prototype.commit=function(x){return this.placement.commit(x),this.placement};var qo=512/k.EXTENT/2,Js=function(x,C,E){this.tileID=x,this.indexedSymbolInstances={},this.bucketInstanceId=E;for(var M=0;M<C.length;M++){var U=C.get(M),H=U.key;this.indexedSymbolInstances[H]||(this.indexedSymbolInstances[H]=[]),this.indexedSymbolInstances[H].push({crossTileID:U.crossTileID,coord:this.getScaledCoordinates(U,x)})}};Js.prototype.getScaledCoordinates=function(x,C){var E=qo/Math.pow(2,C.canonical.z-this.tileID.canonical.z);return{x:Math.floor((C.canonical.x*k.EXTENT+x.anchorX)*E),y:Math.floor((C.canonical.y*k.EXTENT+x.anchorY)*E)}},Js.prototype.findMatches=function(x,C,E){for(var M=this.tileID.canonical.z<C.canonical.z?1:Math.pow(2,this.tileID.canonical.z-C.canonical.z),U=0;U<x.length;U++){var H=x.get(U);if(!H.crossTileID){var $=this.indexedSymbolInstances[H.key];if($)for(var ht=this.getScaledCoordinates(H,C),Ut=0,ie=$;Ut<ie.length;Ut+=1){var Be=ie[Ut];if(Math.abs(Be.coord.x-ht.x)<=M&&Math.abs(Be.coord.y-ht.y)<=M&&!E[Be.crossTileID]){E[Be.crossTileID]=!0,H.crossTileID=Be.crossTileID;break}}}}};var qu=function(){this.maxCrossTileID=0};qu.prototype.generate=function(){return++this.maxCrossTileID};var yu=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};yu.prototype.handleWrapJump=function(x){var C=Math.round((x-this.lng)/360);if(C!==0)for(var E in this.indexes){var M=this.indexes[E],U={};for(var H in M){var $=M[H];$.tileID=$.tileID.unwrapTo($.tileID.wrap+C),U[$.tileID.key]=$}this.indexes[E]=U}this.lng=x},yu.prototype.addBucket=function(x,C,E){if(this.indexes[x.overscaledZ]&&this.indexes[x.overscaledZ][x.key]){if(this.indexes[x.overscaledZ][x.key].bucketInstanceId===C.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(x.overscaledZ,this.indexes[x.overscaledZ][x.key])}for(var M=0;M<C.symbolInstances.length;M++)C.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[x.overscaledZ]||(this.usedCrossTileIDs[x.overscaledZ]={});var U=this.usedCrossTileIDs[x.overscaledZ];for(var H in this.indexes){var $=this.indexes[H];if(Number(H)>x.overscaledZ)for(var ht in $){var Ut=$[ht];Ut.tileID.isChildOf(x)&&Ut.findMatches(C.symbolInstances,x,U)}else{var ie=$[x.scaledTo(Number(H)).key];ie&&ie.findMatches(C.symbolInstances,x,U)}}for(var Be=0;Be<C.symbolInstances.length;Be++){var De=C.symbolInstances.get(Be);De.crossTileID||(De.crossTileID=E.generate(),U[De.crossTileID]=!0)}return this.indexes[x.overscaledZ]===void 0&&(this.indexes[x.overscaledZ]={}),this.indexes[x.overscaledZ][x.key]=new Js(x,C.symbolInstances,C.bucketInstanceId),!0},yu.prototype.removeBucketCrossTileIDs=function(x,C){for(var E in C.indexedSymbolInstances)for(var M=0,U=C.indexedSymbolInstances[E];M<U.length;M+=1)delete this.usedCrossTileIDs[x][U[M].crossTileID]},yu.prototype.removeStaleBuckets=function(x){var C=!1;for(var E in this.indexes){var M=this.indexes[E];for(var U in M)x[M[U].bucketInstanceId]||(this.removeBucketCrossTileIDs(E,M[U]),delete M[U],C=!0)}return C};var Zs=function(){this.layerIndexes={},this.crossTileIDs=new qu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Zs.prototype.addLayer=function(x,C,E){var M=this.layerIndexes[x.id];M===void 0&&(M=this.layerIndexes[x.id]=new yu);var U=!1,H={};M.handleWrapJump(E);for(var $=0,ht=C;$<ht.length;$+=1){var Ut=ht[$],ie=Ut.getBucket(x);ie&&x.id===ie.layerIds[0]&&(ie.bucketInstanceId||(ie.bucketInstanceId=++this.maxBucketInstanceId),M.addBucket(Ut.tileID,ie,this.crossTileIDs)&&(U=!0),H[ie.bucketInstanceId]=!0)}return M.removeStaleBuckets(H)&&(U=!0),U},Zs.prototype.pruneUnusedLayers=function(x){var C={};for(var E in x.forEach(function(M){C[M]=!0}),this.layerIndexes)C[E]||delete this.layerIndexes[E]};var _u=function(x,C){return k.emitValidationErrors(x,C&&C.filter(function(E){return E.identifier!=="source.canvas"}))},Ku=k.pick(fi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Bu=k.pick(fi,["setCenter","setZoom","setBearing","setPitch"]),xl=function(){var x={},C=k.styleSpec.$version;for(var E in k.styleSpec.$root){var M,U=k.styleSpec.$root[E];U.required&&(M=E==="version"?C:U.type==="array"?[]:{})!=null&&(x[E]=M)}return x}(),Nu=function(x){function C(E,M){var U=this;M===void 0&&(M={}),x.call(this),this.map=E,this.dispatcher=new xe(Qr(),this),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new Dt(E._requestManager,M.localIdeographFontFamily),this.lineAtlas=new ne(256,512),this.crossTileSymbolIndex=new Zs,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new k.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",k.getReferrer());var H=this;this._rtlTextPluginCallback=C.registerForPluginStateChange(function($){H.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:$.pluginStatus,pluginURL:$.pluginURL},function(ht,Ut){if(k.triggerPluginCompletionEvent(ht),Ut&&Ut.every(function(Be){return Be}))for(var ie in H.sourceCaches)H.sourceCaches[ie].reload()})}),this.on("data",function($){if($.dataType==="source"&&$.sourceDataType==="metadata"){var ht=U.sourceCaches[$.sourceId];if(ht){var Ut=ht.getSource();if(Ut&&Ut.vectorLayerIds)for(var ie in U._layers){var Be=U._layers[ie];Be.source===Ut.id&&U._validateLayer(Be)}}}})}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.loadURL=function(E,M){var U=this;M===void 0&&(M={}),this.fire(new k.Event("dataloading",{dataType:"style"}));var H=typeof M.validate=="boolean"?M.validate:!k.isMapboxURL(E);E=this.map._requestManager.normalizeStyleURL(E,M.accessToken);var $=this.map._requestManager.transformRequest(E,k.ResourceType.Style);this._request=k.getJSON($,function(ht,Ut){U._request=null,ht?U.fire(new k.ErrorEvent(ht)):Ut&&U._load(Ut,H)})},C.prototype.loadJSON=function(E,M){var U=this;M===void 0&&(M={}),this.fire(new k.Event("dataloading",{dataType:"style"})),this._request=k.browser.frame(function(){U._request=null,U._load(E,M.validate!==!1)})},C.prototype.loadEmpty=function(){this.fire(new k.Event("dataloading",{dataType:"style"})),this._load(xl,!1)},C.prototype._load=function(E,M){if(!M||!_u(this,k.validateStyle(E))){for(var U in this._loaded=!0,this.stylesheet=E,E.sources)this.addSource(U,E.sources[U],{validate:!1});E.sprite?this._loadSprite(E.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(E.glyphs);var H=ai(this.stylesheet.layers);this._order=H.map(function(ie){return ie.id}),this._layers={},this._serializedLayers={};for(var $=0,ht=H;$<ht.length;$+=1){var Ut=ht[$];(Ut=k.createStyleLayer(Ut)).setEventedParent(this,{layer:{id:Ut.id}}),this._layers[Ut.id]=Ut,this._serializedLayers[Ut.id]=Ut.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ve(this.stylesheet.light),this.fire(new k.Event("data",{dataType:"style"})),this.fire(new k.Event("style.load"))}},C.prototype._loadSprite=function(E){var M=this;this._spriteRequest=function(U,H,$){var ht,Ut,ie,Be=k.browser.devicePixelRatio>1?"@2x":"",De=k.getJSON(H.transformRequest(H.normalizeSpriteURL(U,Be,".json"),k.ResourceType.SpriteJSON),function($e,_r){De=null,ie||(ie=$e,ht=_r,fr())}),Ne=k.getImage(H.transformRequest(H.normalizeSpriteURL(U,Be,".png"),k.ResourceType.SpriteImage),function($e,_r){Ne=null,ie||(ie=$e,Ut=_r,fr())});function fr(){if(ie)$(ie);else if(ht&&Ut){var $e=k.browser.getImageData(Ut),_r={};for(var er in ht){var Er=ht[er],Or=Er.width,Yr=Er.height,gn=Er.x,vn=Er.y,_n=Er.sdf,Un=Er.pixelRatio,ui=Er.stretchX,oi=Er.stretchY,Ri=Er.content,Di=new k.RGBAImage({width:Or,height:Yr});k.RGBAImage.copy($e,Di,{x:gn,y:vn},{x:0,y:0},{width:Or,height:Yr}),_r[er]={data:Di,pixelRatio:Un,sdf:_n,stretchX:ui,stretchY:oi,content:Ri}}$(null,_r)}}return{cancel:function(){De&&(De.cancel(),De=null),Ne&&(Ne.cancel(),Ne=null)}}}(E,this.map._requestManager,function(U,H){if(M._spriteRequest=null,U)M.fire(new k.ErrorEvent(U));else if(H)for(var $ in H)M.imageManager.addImage($,H[$]);M.imageManager.setLoaded(!0),M._availableImages=M.imageManager.listImages(),M.dispatcher.broadcast("setImages",M._availableImages),M.fire(new k.Event("data",{dataType:"style"}))})},C.prototype._validateLayer=function(E){var M=this.sourceCaches[E.source];if(M){var U=E.sourceLayer;if(U){var H=M.getSource();(H.type==="geojson"||H.vectorLayerIds&&H.vectorLayerIds.indexOf(U)===-1)&&this.fire(new k.ErrorEvent(new Error('Source layer "'+U+'" does not exist on source "'+H.id+'" as specified by style layer "'+E.id+'"')))}}},C.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var E in this.sourceCaches)if(!this.sourceCaches[E].loaded())return!1;return!!this.imageManager.isLoaded()},C.prototype._serializeLayers=function(E){for(var M=[],U=0,H=E;U<H.length;U+=1){var $=this._layers[H[U]];$.type!=="custom"&&M.push($.serialize())}return M},C.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var E in this.sourceCaches)if(this.sourceCaches[E].hasTransition())return!0;for(var M in this._layers)if(this._layers[M].hasTransition())return!0;return!1},C.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},C.prototype.update=function(E){if(this._loaded){var M=this._changed;if(this._changed){var U=Object.keys(this._updatedLayers),H=Object.keys(this._removedLayers);for(var $ in(U.length||H.length)&&this._updateWorkerLayers(U,H),this._updatedSources){var ht=this._updatedSources[$];ht==="reload"?this._reloadSource($):ht==="clear"&&this._clearSource($)}for(var Ut in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Ut].updateTransitions(E);this.light.updateTransitions(E),this._resetUpdates()}var ie={};for(var Be in this.sourceCaches){var De=this.sourceCaches[Be];ie[Be]=De.used,De.used=!1}for(var Ne=0,fr=this._order;Ne<fr.length;Ne+=1){var $e=this._layers[fr[Ne]];$e.recalculate(E,this._availableImages),!$e.isHidden(E.zoom)&&$e.source&&(this.sourceCaches[$e.source].used=!0)}for(var _r in ie){var er=this.sourceCaches[_r];ie[_r]!==er.used&&er.fire(new k.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:_r}))}this.light.recalculate(E),this.z=E.zoom,M&&this.fire(new k.Event("data",{dataType:"style"}))}},C.prototype._updateTilesForChangedImages=function(){var E=Object.keys(this._changedImages);if(E.length){for(var M in this.sourceCaches)this.sourceCaches[M].reloadTilesForDependencies(["icons","patterns"],E);this._changedImages={}}},C.prototype._updateWorkerLayers=function(E,M){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(E),removedIds:M})},C.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},C.prototype.setState=function(E){var M=this;if(this._checkLoaded(),_u(this,k.validateStyle(E)))return!1;(E=k.clone$1(E)).layers=ai(E.layers);var U=function($,ht){if(!$)return[{command:fi.setStyle,args:[ht]}];var Ut=[];try{if(!k.deepEqual($.version,ht.version))return[{command:fi.setStyle,args:[ht]}];k.deepEqual($.center,ht.center)||Ut.push({command:fi.setCenter,args:[ht.center]}),k.deepEqual($.zoom,ht.zoom)||Ut.push({command:fi.setZoom,args:[ht.zoom]}),k.deepEqual($.bearing,ht.bearing)||Ut.push({command:fi.setBearing,args:[ht.bearing]}),k.deepEqual($.pitch,ht.pitch)||Ut.push({command:fi.setPitch,args:[ht.pitch]}),k.deepEqual($.sprite,ht.sprite)||Ut.push({command:fi.setSprite,args:[ht.sprite]}),k.deepEqual($.glyphs,ht.glyphs)||Ut.push({command:fi.setGlyphs,args:[ht.glyphs]}),k.deepEqual($.transition,ht.transition)||Ut.push({command:fi.setTransition,args:[ht.transition]}),k.deepEqual($.light,ht.light)||Ut.push({command:fi.setLight,args:[ht.light]});var ie={},Be=[];(function(Ne,fr,$e,_r){var er;for(er in fr=fr||{},Ne=Ne||{})Ne.hasOwnProperty(er)&&(fr.hasOwnProperty(er)||Ai(er,$e,_r));for(er in fr)fr.hasOwnProperty(er)&&(Ne.hasOwnProperty(er)?k.deepEqual(Ne[er],fr[er])||(Ne[er].type==="geojson"&&fr[er].type==="geojson"&&po(Ne,fr,er)?$e.push({command:fi.setGeoJSONSourceData,args:[er,fr[er].data]}):Ca(er,fr,$e,_r)):oa(er,fr,$e))})($.sources,ht.sources,Be,ie);var De=[];$.layers&&$.layers.forEach(function(Ne){ie[Ne.source]?Ut.push({command:fi.removeLayer,args:[Ne.id]}):De.push(Ne)}),Ut=Ut.concat(Be),function(Ne,fr,$e){fr=fr||[];var _r,er,Er,Or,Yr,gn,vn,_n=(Ne=Ne||[]).map(Va),Un=fr.map(Va),ui=Ne.reduce(_a,{}),oi=fr.reduce(_a,{}),Ri=_n.slice(),Di=Object.create(null);for(_r=0,er=0;_r<_n.length;_r++)oi.hasOwnProperty(Er=_n[_r])?er++:($e.push({command:fi.removeLayer,args:[Er]}),Ri.splice(Ri.indexOf(Er,er),1));for(_r=0,er=0;_r<Un.length;_r++)Ri[Ri.length-1-_r]!==(Er=Un[Un.length-1-_r])&&(ui.hasOwnProperty(Er)?($e.push({command:fi.removeLayer,args:[Er]}),Ri.splice(Ri.lastIndexOf(Er,Ri.length-er),1)):er++,$e.push({command:fi.addLayer,args:[oi[Er],gn=Ri[Ri.length-_r]]}),Ri.splice(Ri.length-_r,0,Er),Di[Er]=!0);for(_r=0;_r<Un.length;_r++)if(Or=ui[Er=Un[_r]],Yr=oi[Er],!Di[Er]&&!k.deepEqual(Or,Yr))if(k.deepEqual(Or.source,Yr.source)&&k.deepEqual(Or["source-layer"],Yr["source-layer"])&&k.deepEqual(Or.type,Yr.type)){for(vn in La(Or.layout,Yr.layout,$e,Er,null,fi.setLayoutProperty),La(Or.paint,Yr.paint,$e,Er,null,fi.setPaintProperty),k.deepEqual(Or.filter,Yr.filter)||$e.push({command:fi.setFilter,args:[Er,Yr.filter]}),k.deepEqual(Or.minzoom,Yr.minzoom)&&k.deepEqual(Or.maxzoom,Yr.maxzoom)||$e.push({command:fi.setLayerZoomRange,args:[Er,Yr.minzoom,Yr.maxzoom]}),Or)Or.hasOwnProperty(vn)&&vn!=="layout"&&vn!=="paint"&&vn!=="filter"&&vn!=="metadata"&&vn!=="minzoom"&&vn!=="maxzoom"&&(vn.indexOf("paint.")===0?La(Or[vn],Yr[vn],$e,Er,vn.slice(6),fi.setPaintProperty):k.deepEqual(Or[vn],Yr[vn])||$e.push({command:fi.setLayerProperty,args:[Er,vn,Yr[vn]]}));for(vn in Yr)Yr.hasOwnProperty(vn)&&!Or.hasOwnProperty(vn)&&vn!=="layout"&&vn!=="paint"&&vn!=="filter"&&vn!=="metadata"&&vn!=="minzoom"&&vn!=="maxzoom"&&(vn.indexOf("paint.")===0?La(Or[vn],Yr[vn],$e,Er,vn.slice(6),fi.setPaintProperty):k.deepEqual(Or[vn],Yr[vn])||$e.push({command:fi.setLayerProperty,args:[Er,vn,Yr[vn]]}))}else $e.push({command:fi.removeLayer,args:[Er]}),gn=Ri[Ri.lastIndexOf(Er)+1],$e.push({command:fi.addLayer,args:[Yr,gn]})}(De,ht.layers,Ut)}catch(Ne){console.warn("Unable to compute style diff:",Ne),Ut=[{command:fi.setStyle,args:[ht]}]}return Ut}(this.serialize(),E).filter(function($){return!($.command in Bu)});if(U.length===0)return!1;var H=U.filter(function($){return!($.command in Ku)});if(H.length>0)throw new Error("Unimplemented: "+H.map(function($){return $.command}).join(", ")+".");return U.forEach(function($){$.command!=="setTransition"&&M[$.command].apply(M,$.args)}),this.stylesheet=E,!0},C.prototype.addImage=function(E,M){if(this.getImage(E))return this.fire(new k.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(E,M),this._afterImageUpdated(E)},C.prototype.updateImage=function(E,M){this.imageManager.updateImage(E,M)},C.prototype.getImage=function(E){return this.imageManager.getImage(E)},C.prototype.removeImage=function(E){if(!this.getImage(E))return this.fire(new k.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(E),this._afterImageUpdated(E)},C.prototype._afterImageUpdated=function(E){this._availableImages=this.imageManager.listImages(),this._changedImages[E]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new k.Event("data",{dataType:"style"}))},C.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},C.prototype.addSource=function(E,M,U){var H=this;if(U===void 0&&(U={}),this._checkLoaded(),this.sourceCaches[E]!==void 0)throw new Error("There is already a source with this ID");if(!M.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(M).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(M.type)>=0&&this._validate(k.validateStyle.source,"sources."+E,M,null,U))){this.map&&this.map._collectResourceTiming&&(M.collectResourceTiming=!0);var $=this.sourceCaches[E]=new ar(E,M,this.dispatcher);$.style=this,$.setEventedParent(this,function(){return{isSourceLoaded:H.loaded(),source:$.serialize(),sourceId:E}}),$.onAdd(this.map),this._changed=!0}},C.prototype.removeSource=function(E){if(this._checkLoaded(),this.sourceCaches[E]===void 0)throw new Error("There is no source with this ID");for(var M in this._layers)if(this._layers[M].source===E)return this.fire(new k.ErrorEvent(new Error('Source "'+E+'" cannot be removed while layer "'+M+'" is using it.')));var U=this.sourceCaches[E];delete this.sourceCaches[E],delete this._updatedSources[E],U.fire(new k.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:E})),U.setEventedParent(null),U.clearTiles(),U.onRemove&&U.onRemove(this.map),this._changed=!0},C.prototype.setGeoJSONSourceData=function(E,M){this._checkLoaded(),this.sourceCaches[E].getSource().setData(M),this._changed=!0},C.prototype.getSource=function(E){return this.sourceCaches[E]&&this.sourceCaches[E].getSource()},C.prototype.addLayer=function(E,M,U){U===void 0&&(U={}),this._checkLoaded();var H=E.id;if(this.getLayer(H))this.fire(new k.ErrorEvent(new Error('Layer with id "'+H+'" already exists on this map')));else{var $;if(E.type==="custom"){if(_u(this,k.validateCustomStyleLayer(E)))return;$=k.createStyleLayer(E)}else{if(typeof E.source=="object"&&(this.addSource(H,E.source),E=k.clone$1(E),E=k.extend(E,{source:H})),this._validate(k.validateStyle.layer,"layers."+H,E,{arrayIndex:-1},U))return;$=k.createStyleLayer(E),this._validateLayer($),$.setEventedParent(this,{layer:{id:H}}),this._serializedLayers[$.id]=$.serialize()}var ht=M?this._order.indexOf(M):this._order.length;if(M&&ht===-1)this.fire(new k.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.')));else{if(this._order.splice(ht,0,H),this._layerOrderChanged=!0,this._layers[H]=$,this._removedLayers[H]&&$.source&&$.type!=="custom"){var Ut=this._removedLayers[H];delete this._removedLayers[H],Ut.type!==$.type?this._updatedSources[$.source]="clear":(this._updatedSources[$.source]="reload",this.sourceCaches[$.source].pause())}this._updateLayer($),$.onAdd&&$.onAdd(this.map)}}},C.prototype.moveLayer=function(E,M){if(this._checkLoaded(),this._changed=!0,this._layers[E]){if(E!==M){var U=this._order.indexOf(E);this._order.splice(U,1);var H=M?this._order.indexOf(M):this._order.length;M&&H===-1?this.fire(new k.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.'))):(this._order.splice(H,0,E),this._layerOrderChanged=!0)}}else this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style and cannot be moved.")))},C.prototype.removeLayer=function(E){this._checkLoaded();var M=this._layers[E];if(M){M.setEventedParent(null);var U=this._order.indexOf(E);this._order.splice(U,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[E]=M,delete this._layers[E],delete this._serializedLayers[E],delete this._updatedLayers[E],delete this._updatedPaintProps[E],M.onRemove&&M.onRemove(this.map)}else this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style and cannot be removed.")))},C.prototype.getLayer=function(E){return this._layers[E]},C.prototype.hasLayer=function(E){return E in this._layers},C.prototype.setLayerZoomRange=function(E,M,U){this._checkLoaded();var H=this.getLayer(E);H?H.minzoom===M&&H.maxzoom===U||(M!=null&&(H.minzoom=M),U!=null&&(H.maxzoom=U),this._updateLayer(H)):this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style and cannot have zoom extent.")))},C.prototype.setFilter=function(E,M,U){U===void 0&&(U={}),this._checkLoaded();var H=this.getLayer(E);if(H){if(!k.deepEqual(H.filter,M))return M==null?(H.filter=void 0,void this._updateLayer(H)):void(this._validate(k.validateStyle.filter,"layers."+H.id+".filter",M,null,U)||(H.filter=k.clone$1(M),this._updateLayer(H)))}else this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style and cannot be filtered.")))},C.prototype.getFilter=function(E){return k.clone$1(this.getLayer(E).filter)},C.prototype.setLayoutProperty=function(E,M,U,H){H===void 0&&(H={}),this._checkLoaded();var $=this.getLayer(E);$?k.deepEqual($.getLayoutProperty(M),U)||($.setLayoutProperty(M,U,H),this._updateLayer($)):this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style and cannot be styled.")))},C.prototype.getLayoutProperty=function(E,M){var U=this.getLayer(E);if(U)return U.getLayoutProperty(M);this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style.")))},C.prototype.setPaintProperty=function(E,M,U,H){H===void 0&&(H={}),this._checkLoaded();var $=this.getLayer(E);$?k.deepEqual($.getPaintProperty(M),U)||($.setPaintProperty(M,U,H)&&this._updateLayer($),this._changed=!0,this._updatedPaintProps[E]=!0):this.fire(new k.ErrorEvent(new Error("The layer '"+E+"' does not exist in the map's style and cannot be styled.")))},C.prototype.getPaintProperty=function(E,M){return this.getLayer(E).getPaintProperty(M)},C.prototype.setFeatureState=function(E,M){this._checkLoaded();var U=E.source,H=E.sourceLayer,$=this.sourceCaches[U];if($!==void 0){var ht=$.getSource().type;ht==="geojson"&&H?this.fire(new k.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ht!=="vector"||H?(E.id===void 0&&this.fire(new k.ErrorEvent(new Error("The feature id parameter must be provided."))),$.setFeatureState(H,E.id,M)):this.fire(new k.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new k.ErrorEvent(new Error("The source '"+U+"' does not exist in the map's style.")))},C.prototype.removeFeatureState=function(E,M){this._checkLoaded();var U=E.source,H=this.sourceCaches[U];if(H!==void 0){var $=H.getSource().type,ht=$==="vector"?E.sourceLayer:void 0;$!=="vector"||ht?M&&typeof E.id!="string"&&typeof E.id!="number"?this.fire(new k.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):H.removeFeatureState(ht,E.id,M):this.fire(new k.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new k.ErrorEvent(new Error("The source '"+U+"' does not exist in the map's style.")))},C.prototype.getFeatureState=function(E){this._checkLoaded();var M=E.source,U=E.sourceLayer,H=this.sourceCaches[M];if(H!==void 0){if(H.getSource().type!=="vector"||U)return E.id===void 0&&this.fire(new k.ErrorEvent(new Error("The feature id parameter must be provided."))),H.getFeatureState(U,E.id);this.fire(new k.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new k.ErrorEvent(new Error("The source '"+M+"' does not exist in the map's style.")))},C.prototype.getTransition=function(){return k.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},C.prototype.serialize=function(){return k.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:k.mapObject(this.sourceCaches,function(E){return E.serialize()}),layers:this._serializeLayers(this._order)},function(E){return E!==void 0})},C.prototype._updateLayer=function(E){this._updatedLayers[E.id]=!0,E.source&&!this._updatedSources[E.source]&&this.sourceCaches[E.source].getSource().type!=="raster"&&(this._updatedSources[E.source]="reload",this.sourceCaches[E.source].pause()),this._changed=!0},C.prototype._flattenAndSortRenderedFeatures=function(E){for(var M=this,U=function(ui){return M._layers[ui].type==="fill-extrusion"},H={},$=[],ht=this._order.length-1;ht>=0;ht--){var Ut=this._order[ht];if(U(Ut)){H[Ut]=ht;for(var ie=0,Be=E;ie<Be.length;ie+=1){var De=Be[ie][Ut];if(De)for(var Ne=0,fr=De;Ne<fr.length;Ne+=1)$.push(fr[Ne])}}}$.sort(function(ui,oi){return oi.intersectionZ-ui.intersectionZ});for(var $e=[],_r=this._order.length-1;_r>=0;_r--){var er=this._order[_r];if(U(er))for(var Er=$.length-1;Er>=0;Er--){var Or=$[Er].feature;if(H[Or.layer.id]<_r)break;$e.push(Or),$.pop()}else for(var Yr=0,gn=E;Yr<gn.length;Yr+=1){var vn=gn[Yr][er];if(vn)for(var _n=0,Un=vn;_n<Un.length;_n+=1)$e.push(Un[_n].feature)}}return $e},C.prototype.queryRenderedFeatures=function(E,M,U){M&&M.filter&&this._validate(k.validateStyle.filter,"queryRenderedFeatures.filter",M.filter,null,M);var H={};if(M&&M.layers){if(!Array.isArray(M.layers))return this.fire(new k.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var $=0,ht=M.layers;$<ht.length;$+=1){var Ut=ht[$],ie=this._layers[Ut];if(!ie)return this.fire(new k.ErrorEvent(new Error("The layer '"+Ut+"' does not exist in the map's style and cannot be queried for features."))),[];H[ie.source]=!0}}var Be=[];for(var De in M.availableImages=this._availableImages,this.sourceCaches)M.layers&&!H[De]||Be.push(re(this.sourceCaches[De],this._layers,this._serializedLayers,E,M,U));return this.placement&&Be.push(function(Ne,fr,$e,_r,er,Er,Or){for(var Yr={},gn=Er.queryRenderedSymbols(_r),vn=[],_n=0,Un=Object.keys(gn).map(Number);_n<Un.length;_n+=1)vn.push(Or[Un[_n]]);vn.sort(ye);for(var ui=function(){var na=Ri[oi],co=na.featureIndex.lookupSymbolFeatures(gn[na.bucketInstanceId],fr,na.bucketIndex,na.sourceLayerIndex,er.filter,er.layers,er.availableImages,Ne);for(var Bi in co){var Pa=Yr[Bi]=Yr[Bi]||[],Ra=co[Bi];Ra.sort(function(Ba,Ea){var ca=na.featureSortOrder;if(ca){var Ys=ca.indexOf(Ba.featureIndex);return ca.indexOf(Ea.featureIndex)-Ys}return Ea.featureIndex-Ba.featureIndex});for(var Aa=0,ya=Ra;Aa<ya.length;Aa+=1)Pa.push(ya[Aa])}},oi=0,Ri=vn;oi<Ri.length;oi+=1)ui();var Di=function(na){Yr[na].forEach(function(co){var Bi=co.feature,Pa=$e[Ne[na].source].getFeatureState(Bi.layer["source-layer"],Bi.id);Bi.source=Bi.layer.source,Bi.layer["source-layer"]&&(Bi.sourceLayer=Bi.layer["source-layer"]),Bi.state=Pa})};for(var ia in Yr)Di(ia);return Yr}(this._layers,this._serializedLayers,this.sourceCaches,E,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Be)},C.prototype.querySourceFeatures=function(E,M){M&&M.filter&&this._validate(k.validateStyle.filter,"querySourceFeatures.filter",M.filter,null,M);var U=this.sourceCaches[E];return U?function(H,$){for(var ht=H.getRenderableIds().map(function(fr){return H.getTileByID(fr)}),Ut=[],ie={},Be=0;Be<ht.length;Be++){var De=ht[Be],Ne=De.tileID.canonical.key;ie[Ne]||(ie[Ne]=!0,De.querySourceFeatures(Ut,$))}return Ut}(U,M):[]},C.prototype.addSourceType=function(E,M,U){return C.getSourceType(E)?U(new Error('A source type called "'+E+'" already exists.')):(C.setSourceType(E,M),M.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:E,url:M.workerSourceURL},U):U(null,null))},C.prototype.getLight=function(){return this.light.getLight()},C.prototype.setLight=function(E,M){M===void 0&&(M={}),this._checkLoaded();var U=this.light.getLight(),H=!1;for(var $ in E)if(!k.deepEqual(E[$],U[$])){H=!0;break}if(H){var ht={now:k.browser.now(),transition:k.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(E,M),this.light.updateTransitions(ht)}},C.prototype._validate=function(E,M,U,H,$){return $===void 0&&($={}),(!$||$.validate!==!1)&&_u(this,E.call(k.validateStyle,k.extend({key:M,style:this.serialize(),value:U,styleSpec:k.styleSpec},H)))},C.prototype._remove=function(){for(var E in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),k.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[E].setEventedParent(null);for(var M in this.sourceCaches)this.sourceCaches[M].clearTiles(),this.sourceCaches[M].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},C.prototype._clearSource=function(E){this.sourceCaches[E].clearTiles()},C.prototype._reloadSource=function(E){this.sourceCaches[E].resume(),this.sourceCaches[E].reload()},C.prototype._updateSources=function(E){for(var M in this.sourceCaches)this.sourceCaches[M].update(E)},C.prototype._generateCollisionBoxes=function(){for(var E in this.sourceCaches)this._reloadSource(E)},C.prototype._updatePlacement=function(E,M,U,H,$){$===void 0&&($=!1);for(var ht=!1,Ut=!1,ie={},Be=0,De=this._order;Be<De.length;Be+=1){var Ne=this._layers[De[Be]];if(Ne.type==="symbol"){if(!ie[Ne.source]){var fr=this.sourceCaches[Ne.source];ie[Ne.source]=fr.getRenderableIds(!0).map(function(Or){return fr.getTileByID(Or)}).sort(function(Or,Yr){return Yr.tileID.overscaledZ-Or.tileID.overscaledZ||(Or.tileID.isLessThan(Yr.tileID)?-1:1)})}var $e=this.crossTileSymbolIndex.addLayer(Ne,ie[Ne.source],E.center.lng);ht=ht||$e}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),(($=$||this._layerOrderChanged||U===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(k.browser.now(),E.zoom))&&(this.pauseablePlacement=new $o(E,this._order,$,M,U,H,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ie),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(k.browser.now()),Ut=!0),ht&&this.pauseablePlacement.placement.setStale()),Ut||ht)for(var _r=0,er=this._order;_r<er.length;_r+=1){var Er=this._layers[er[_r]];Er.type==="symbol"&&this.placement.updateLayerOpacities(Er,ie[Er.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(k.browser.now())},C.prototype._releaseSymbolFadeTiles=function(){for(var E in this.sourceCaches)this.sourceCaches[E].releaseSymbolFadeTiles()},C.prototype.getImages=function(E,M,U){this.imageManager.getImages(M.icons,U),this._updateTilesForChangedImages();var H=this.sourceCaches[M.source];H&&H.setDependencies(M.tileID.key,M.type,M.icons)},C.prototype.getGlyphs=function(E,M,U){this.glyphManager.getGlyphs(M.stacks,U)},C.prototype.getResource=function(E,M,U){return k.makeRequest(M,U)},C}(k.Evented);Nu.getSourceType=function(x){return Ve[x]},Nu.setSourceType=function(x,C){Ve[x]=C},Nu.registerForPluginStateChange=k.registerForPluginStateChange;var Fo=k.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ts=fa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),jc=fa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Wc=fa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),xu=fa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ms=fa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),pl=fa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Ga=fa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),zu=fa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Xc=fa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),D=fa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),X=fa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Mt=fa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),it=fa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Jt=fa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ue=fa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),yr=fa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),Br=fa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),zr=fa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Cn=fa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Vn=fa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ki=fa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Ma=fa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),xa=fa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),lo=fa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Ro=fa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Io=fa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function fa(x,C){var E=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,M=C.match(/attribute ([\w]+) ([\w]+)/g),U=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),H=C.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),$=H?H.concat(U):U,ht={};return{fragmentSource:x=x.replace(E,function(Ut,ie,Be,De,Ne){return ht[Ne]=!0,ie==="define"?`
#ifndef HAS_UNIFORM_u_`+Ne+`
varying `+Be+" "+De+" "+Ne+`;
#else
uniform `+Be+" "+De+" u_"+Ne+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Ne+`
    `+Be+" "+De+" "+Ne+" = u_"+Ne+`;
#endif
`}),vertexSource:C=C.replace(E,function(Ut,ie,Be,De,Ne){var fr=De==="float"?"vec2":"vec4",$e=Ne.match(/color/)?"color":fr;return ht[Ne]?ie==="define"?`
#ifndef HAS_UNIFORM_u_`+Ne+`
uniform lowp float u_`+Ne+`_t;
attribute `+Be+" "+fr+" a_"+Ne+`;
varying `+Be+" "+De+" "+Ne+`;
#else
uniform `+Be+" "+De+" u_"+Ne+`;
#endif
`:$e==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Ne+`
    `+Ne+" = a_"+Ne+`;
#else
    `+Be+" "+De+" "+Ne+" = u_"+Ne+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Ne+`
    `+Ne+" = unpack_mix_"+$e+"(a_"+Ne+", u_"+Ne+`_t);
#else
    `+Be+" "+De+" "+Ne+" = u_"+Ne+`;
#endif
`:ie==="define"?`
#ifndef HAS_UNIFORM_u_`+Ne+`
uniform lowp float u_`+Ne+`_t;
attribute `+Be+" "+fr+" a_"+Ne+`;
#else
uniform `+Be+" "+De+" u_"+Ne+`;
#endif
`:$e==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Ne+`
    `+Be+" "+De+" "+Ne+" = a_"+Ne+`;
#else
    `+Be+" "+De+" "+Ne+" = u_"+Ne+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Ne+`
    `+Be+" "+De+" "+Ne+" = unpack_mix_"+$e+"(a_"+Ne+", u_"+Ne+`_t);
#else
    `+Be+" "+De+" "+Ne+" = u_"+Ne+`;
#endif
`}),staticAttributes:M,staticUniforms:$}}var bu=Object.freeze({__proto__:null,prelude:Ts,background:jc,backgroundPattern:Wc,circle:xu,clippingMask:Ms,heatmap:pl,heatmapTexture:Ga,collisionBox:zu,collisionCircle:Xc,debug:D,fill:X,fillOutline:Mt,fillOutlinePattern:it,fillPattern:Jt,fillExtrusion:Ue,fillExtrusionPattern:yr,hillshadePrepare:Br,hillshade:zr,line:Cn,lineGradient:Vn,linePattern:Ki,lineSDF:Ma,raster:xa,symbolIcon:lo,symbolSDF:Ro,symbolTextAndIcon:Io}),bl=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Ic(x){for(var C=[],E=0;E<x.length;E++)if(x[E]!==null){var M=x[E].split(" ");C.push(M.pop())}return C}bl.prototype.bind=function(x,C,E,M,U,H,$,ht){this.context=x;for(var Ut=this.boundPaintVertexBuffers.length!==M.length,ie=0;!Ut&&ie<M.length;ie++)this.boundPaintVertexBuffers[ie]!==M[ie]&&(Ut=!0);x.extVertexArrayObject&&this.vao&&this.boundProgram===C&&this.boundLayoutVertexBuffer===E&&!Ut&&this.boundIndexBuffer===U&&this.boundVertexOffset===H&&this.boundDynamicVertexBuffer===$&&this.boundDynamicVertexBuffer2===ht?(x.bindVertexArrayOES.set(this.vao),$&&$.bind(),U&&U.dynamicDraw&&U.bind(),ht&&ht.bind()):this.freshBind(C,E,M,U,H,$,ht)},bl.prototype.freshBind=function(x,C,E,M,U,H,$){var ht,Ut=x.numAttributes,ie=this.context,Be=ie.gl;if(ie.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ie.extVertexArrayObject.createVertexArrayOES(),ie.bindVertexArrayOES.set(this.vao),ht=0,this.boundProgram=x,this.boundLayoutVertexBuffer=C,this.boundPaintVertexBuffers=E,this.boundIndexBuffer=M,this.boundVertexOffset=U,this.boundDynamicVertexBuffer=H,this.boundDynamicVertexBuffer2=$;else{ht=ie.currentNumAttributes||0;for(var De=Ut;De<ht;De++)Be.disableVertexAttribArray(De)}C.enableAttributes(Be,x);for(var Ne=0,fr=E;Ne<fr.length;Ne+=1)fr[Ne].enableAttributes(Be,x);H&&H.enableAttributes(Be,x),$&&$.enableAttributes(Be,x),C.bind(),C.setVertexAttribPointers(Be,x,U);for(var $e=0,_r=E;$e<_r.length;$e+=1){var er=_r[$e];er.bind(),er.setVertexAttribPointers(Be,x,U)}H&&(H.bind(),H.setVertexAttribPointers(Be,x,U)),M&&M.bind(),$&&($.bind(),$.setVertexAttribPointers(Be,x,U)),ie.currentNumAttributes=Ut},bl.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Yc=function(x,C,E,M,U,H){var $=x.gl;this.program=$.createProgram();for(var ht=Ic(E.staticAttributes),Ut=M?M.getBinderAttributes():[],ie=ht.concat(Ut),Be=E.staticUniforms?Ic(E.staticUniforms):[],De=M?M.getBinderUniforms():[],Ne=[],fr=0,$e=Be.concat(De);fr<$e.length;fr+=1){var _r=$e[fr];Ne.indexOf(_r)<0&&Ne.push(_r)}var er=M?M.defines():[];H&&er.push("#define OVERDRAW_INSPECTOR;");var Er=er.concat(Ts.fragmentSource,E.fragmentSource).join(`
`),Or=er.concat(Ts.vertexSource,E.vertexSource).join(`
`),Yr=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(Yr,Er),$.compileShader(Yr),$.attachShader(this.program,Yr);var gn=$.createShader($.VERTEX_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(gn,Or),$.compileShader(gn),$.attachShader(this.program,gn),this.attributes={};var vn={};this.numAttributes=ie.length;for(var _n=0;_n<this.numAttributes;_n++)ie[_n]&&($.bindAttribLocation(this.program,_n,ie[_n]),this.attributes[ie[_n]]=_n);$.linkProgram(this.program),$.deleteShader(gn),$.deleteShader(Yr);for(var Un=0;Un<Ne.length;Un++){var ui=Ne[Un];if(ui&&!vn[ui]){var oi=$.getUniformLocation(this.program,ui);oi&&(vn[ui]=oi)}}this.fixedUniforms=U(x,vn),this.binderUniforms=M?M.getUniforms(x,vn):[]}}};function Fl(x,C,E){var M=1/kn(E,1,C.transform.tileZoom),U=Math.pow(2,E.tileID.overscaledZ),H=E.tileSize*Math.pow(2,C.transform.tileZoom)/U,$=H*(E.tileID.canonical.x+E.tileID.wrap*U),ht=H*E.tileID.canonical.y;return{u_image:0,u_texsize:E.imageAtlasTexture.size,u_scale:[M,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[$>>16,ht>>16],u_pixel_coord_lower:[65535&$,65535&ht]}}Yc.prototype.draw=function(x,C,E,M,U,H,$,ht,Ut,ie,Be,De,Ne,fr,$e,_r){var er,Er=x.gl;if(!this.failedToCreate){for(var Or in x.program.set(this.program),x.setDepthMode(E),x.setStencilMode(M),x.setColorMode(U),x.setCullFace(H),this.fixedUniforms)this.fixedUniforms[Or].set($[Or]);fr&&fr.setUniforms(x,this.binderUniforms,De,{zoom:Ne});for(var Yr=(er={},er[Er.LINES]=2,er[Er.TRIANGLES]=3,er[Er.LINE_STRIP]=1,er)[C],gn=0,vn=Be.get();gn<vn.length;gn+=1){var _n=vn[gn],Un=_n.vaos||(_n.vaos={});(Un[ht]||(Un[ht]=new bl)).bind(x,this,Ut,fr?fr.getPaintVertexBuffers():[],ie,_n.vertexOffset,$e,_r),Er.drawElements(C,_n.primitiveLength*Yr,Er.UNSIGNED_SHORT,_n.primitiveOffset*Yr*2)}}};var kc=function(x,C,E,M){var U=C.style.light,H=U.properties.get("position"),$=[H.x,H.y,H.z],ht=k.create$1();U.properties.get("anchor")==="viewport"&&k.fromRotation(ht,-C.transform.angle),k.transformMat3($,$,ht);var Ut=U.properties.get("color");return{u_matrix:x,u_lightpos:$,u_lightintensity:U.properties.get("intensity"),u_lightcolor:[Ut.r,Ut.g,Ut.b],u_vertical_gradient:+E,u_opacity:M}},Uu=function(x,C,E,M,U,H,$){return k.extend(kc(x,C,E,M),Fl(H,C,$),{u_height_factor:-Math.pow(2,U.overscaledZ)/$.tileSize/8})},js=function(x){return{u_matrix:x}},ce=function(x,C,E,M){return k.extend(js(x),Fl(E,C,M))},or=function(x,C){return{u_matrix:x,u_world:C}},Fr=function(x,C,E,M,U){return k.extend(ce(x,C,E,M),{u_world:U})},Xr=function(x,C,E,M){var U,H,$=x.transform;if(M.paint.get("circle-pitch-alignment")==="map"){var ht=kn(E,1,$.zoom);U=!0,H=[ht,ht]}else U=!1,H=$.pixelsToGLUnits;return{u_camera_to_center_distance:$.cameraToCenterDistance,u_scale_with_map:+(M.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(C.posMatrix,E,M.paint.get("circle-translate"),M.paint.get("circle-translate-anchor")),u_pitch_with_map:+U,u_device_pixel_ratio:k.browser.devicePixelRatio,u_extrude_scale:H}},xn=function(x,C,E){var M=kn(E,1,C.zoom),U=Math.pow(2,C.zoom-E.tileID.overscaledZ),H=E.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:C.cameraToCenterDistance,u_pixels_to_tile_units:M,u_extrude_scale:[C.pixelsToGLUnits[0]/(M*U),C.pixelsToGLUnits[1]/(M*U)],u_overscale_factor:H}},Ii=function(x,C,E){return{u_matrix:x,u_inv_matrix:C,u_camera_to_center_distance:E.cameraToCenterDistance,u_viewport_size:[E.width,E.height]}},ra=function(x,C,E){return E===void 0&&(E=1),{u_matrix:x,u_color:C,u_overlay:0,u_overlay_scale:E}},Wa=function(x){return{u_matrix:x}},Eu=function(x,C,E,M){return{u_matrix:x,u_extrude_scale:kn(C,1,E),u_intensity:M}},Ws=function(x,C,E){var M=x.transform;return{u_matrix:rd(x,C,E),u_ratio:1/kn(C,1,M.zoom),u_device_pixel_ratio:k.browser.devicePixelRatio,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},Ya=function(x,C,E,M){return k.extend(Ws(x,C,E),{u_image:0,u_image_height:M})},Jl=function(x,C,E,M){var U=x.transform,H=tc(C,U);return{u_matrix:rd(x,C,E),u_texsize:C.imageAtlasTexture.size,u_ratio:1/kn(C,1,U.zoom),u_device_pixel_ratio:k.browser.devicePixelRatio,u_image:0,u_scale:[H,M.fromScale,M.toScale],u_fade:M.t,u_units_to_pixels:[1/U.pixelsToGLUnits[0],1/U.pixelsToGLUnits[1]]}},$c=function(x,C,E,M,U){var H=x.lineAtlas,$=tc(C,x.transform),ht=E.layout.get("line-cap")==="round",Ut=H.getDash(M.from,ht),ie=H.getDash(M.to,ht),Be=Ut.width*U.fromScale,De=ie.width*U.toScale;return k.extend(Ws(x,C,E),{u_patternscale_a:[$/Be,-Ut.height/2],u_patternscale_b:[$/De,-ie.height/2],u_sdfgamma:H.width/(256*Math.min(Be,De)*k.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ut.y,u_tex_y_b:ie.y,u_mix:U.t})};function tc(x,C){return 1/kn(x,1,C.tileZoom)}function rd(x,C,E){return x.translatePosMatrix(C.tileID.posMatrix,C,E.paint.get("line-translate"),E.paint.get("line-translate-anchor"))}var zf=function(x,C,E,M,U){return{u_matrix:x,u_tl_parent:C,u_scale_parent:E,u_buffer_scale:1,u_fade_t:M.mix,u_opacity:M.opacity*U.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:U.paint.get("raster-brightness-min"),u_brightness_high:U.paint.get("raster-brightness-max"),u_saturation_factor:($=U.paint.get("raster-saturation"),$>0?1-1/(1.001-$):-$),u_contrast_factor:(H=U.paint.get("raster-contrast"),H>0?1/(1-H):1+H),u_spin_weights:tv(U.paint.get("raster-hue-rotate"))};var H,$};function tv(x){x*=Math.PI/180;var C=Math.sin(x),E=Math.cos(x);return[(2*E+1)/3,(-Math.sqrt(3)*C-E+1)/3,(Math.sqrt(3)*C-E+1)/3]}var Ep,Uf=function(x,C,E,M,U,H,$,ht,Ut,ie){var Be=U.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:C?C.uSizeT:0,u_size:C?C.uSize:0,u_camera_to_center_distance:Be.cameraToCenterDistance,u_pitch:Be.pitch/360*2*Math.PI,u_rotate_symbol:+E,u_aspect_ratio:Be.width/Be.height,u_fade_change:U.options.fadeDuration?U.symbolFadeChange:1,u_matrix:H,u_label_plane_matrix:$,u_coord_matrix:ht,u_is_text:+Ut,u_pitch_with_map:+M,u_texsize:ie,u_texture:0}},qc=function(x,C,E,M,U,H,$,ht,Ut,ie,Be){var De=U.transform;return k.extend(Uf(x,C,E,M,U,H,$,ht,Ut,ie),{u_gamma_scale:M?Math.cos(De._pitch)*De.cameraToCenterDistance:1,u_device_pixel_ratio:k.browser.devicePixelRatio,u_is_halo:+Be})},Zf=function(x,C,E,M,U,H,$,ht,Ut,ie){return k.extend(qc(x,C,E,M,U,H,$,ht,!0,Ut,!0),{u_texsize_icon:ie,u_texture_icon:1})},Kc=function(x,C,E){return{u_matrix:x,u_opacity:C,u_color:E}},Vf=function(x,C,E,M,U,H){return k.extend(function($,ht,Ut,ie){var Be=Ut.imageManager.getPattern($.from.toString()),De=Ut.imageManager.getPattern($.to.toString()),Ne=Ut.imageManager.getPixelSize(),fr=Ne.width,$e=Ne.height,_r=Math.pow(2,ie.tileID.overscaledZ),er=ie.tileSize*Math.pow(2,Ut.transform.tileZoom)/_r,Er=er*(ie.tileID.canonical.x+ie.tileID.wrap*_r),Or=er*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Be.tl,u_pattern_br_a:Be.br,u_pattern_tl_b:De.tl,u_pattern_br_b:De.br,u_texsize:[fr,$e],u_mix:ht.t,u_pattern_size_a:Be.displaySize,u_pattern_size_b:De.displaySize,u_scale_a:ht.fromScale,u_scale_b:ht.toScale,u_tile_units_to_pixels:1/kn(ie,1,Ut.transform.tileZoom),u_pixel_coord_upper:[Er>>16,Or>>16],u_pixel_coord_lower:[65535&Er,65535&Or]}}(M,H,E,U),{u_matrix:x,u_opacity:C})},fh={fillExtrusion:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_lightpos:new k.Uniform3f(x,C.u_lightpos),u_lightintensity:new k.Uniform1f(x,C.u_lightintensity),u_lightcolor:new k.Uniform3f(x,C.u_lightcolor),u_vertical_gradient:new k.Uniform1f(x,C.u_vertical_gradient),u_opacity:new k.Uniform1f(x,C.u_opacity)}},fillExtrusionPattern:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_lightpos:new k.Uniform3f(x,C.u_lightpos),u_lightintensity:new k.Uniform1f(x,C.u_lightintensity),u_lightcolor:new k.Uniform3f(x,C.u_lightcolor),u_vertical_gradient:new k.Uniform1f(x,C.u_vertical_gradient),u_height_factor:new k.Uniform1f(x,C.u_height_factor),u_image:new k.Uniform1i(x,C.u_image),u_texsize:new k.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new k.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new k.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new k.Uniform3f(x,C.u_scale),u_fade:new k.Uniform1f(x,C.u_fade),u_opacity:new k.Uniform1f(x,C.u_opacity)}},fill:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix)}},fillPattern:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_image:new k.Uniform1i(x,C.u_image),u_texsize:new k.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new k.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new k.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new k.Uniform3f(x,C.u_scale),u_fade:new k.Uniform1f(x,C.u_fade)}},fillOutline:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_world:new k.Uniform2f(x,C.u_world)}},fillOutlinePattern:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_world:new k.Uniform2f(x,C.u_world),u_image:new k.Uniform1i(x,C.u_image),u_texsize:new k.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new k.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new k.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new k.Uniform3f(x,C.u_scale),u_fade:new k.Uniform1f(x,C.u_fade)}},circle:function(x,C){return{u_camera_to_center_distance:new k.Uniform1f(x,C.u_camera_to_center_distance),u_scale_with_map:new k.Uniform1i(x,C.u_scale_with_map),u_pitch_with_map:new k.Uniform1i(x,C.u_pitch_with_map),u_extrude_scale:new k.Uniform2f(x,C.u_extrude_scale),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_matrix:new k.UniformMatrix4f(x,C.u_matrix)}},collisionBox:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_camera_to_center_distance:new k.Uniform1f(x,C.u_camera_to_center_distance),u_pixels_to_tile_units:new k.Uniform1f(x,C.u_pixels_to_tile_units),u_extrude_scale:new k.Uniform2f(x,C.u_extrude_scale),u_overscale_factor:new k.Uniform1f(x,C.u_overscale_factor)}},collisionCircle:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_inv_matrix:new k.UniformMatrix4f(x,C.u_inv_matrix),u_camera_to_center_distance:new k.Uniform1f(x,C.u_camera_to_center_distance),u_viewport_size:new k.Uniform2f(x,C.u_viewport_size)}},debug:function(x,C){return{u_color:new k.UniformColor(x,C.u_color),u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_overlay:new k.Uniform1i(x,C.u_overlay),u_overlay_scale:new k.Uniform1f(x,C.u_overlay_scale)}},clippingMask:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix)}},heatmap:function(x,C){return{u_extrude_scale:new k.Uniform1f(x,C.u_extrude_scale),u_intensity:new k.Uniform1f(x,C.u_intensity),u_matrix:new k.UniformMatrix4f(x,C.u_matrix)}},heatmapTexture:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_world:new k.Uniform2f(x,C.u_world),u_image:new k.Uniform1i(x,C.u_image),u_color_ramp:new k.Uniform1i(x,C.u_color_ramp),u_opacity:new k.Uniform1f(x,C.u_opacity)}},hillshade:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_image:new k.Uniform1i(x,C.u_image),u_latrange:new k.Uniform2f(x,C.u_latrange),u_light:new k.Uniform2f(x,C.u_light),u_shadow:new k.UniformColor(x,C.u_shadow),u_highlight:new k.UniformColor(x,C.u_highlight),u_accent:new k.UniformColor(x,C.u_accent)}},hillshadePrepare:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_image:new k.Uniform1i(x,C.u_image),u_dimension:new k.Uniform2f(x,C.u_dimension),u_zoom:new k.Uniform1f(x,C.u_zoom),u_unpack:new k.Uniform4f(x,C.u_unpack)}},line:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_ratio:new k.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new k.Uniform2f(x,C.u_units_to_pixels)}},lineGradient:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_ratio:new k.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new k.Uniform2f(x,C.u_units_to_pixels),u_image:new k.Uniform1i(x,C.u_image),u_image_height:new k.Uniform1f(x,C.u_image_height)}},linePattern:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_texsize:new k.Uniform2f(x,C.u_texsize),u_ratio:new k.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_image:new k.Uniform1i(x,C.u_image),u_units_to_pixels:new k.Uniform2f(x,C.u_units_to_pixels),u_scale:new k.Uniform3f(x,C.u_scale),u_fade:new k.Uniform1f(x,C.u_fade)}},lineSDF:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_ratio:new k.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new k.Uniform2f(x,C.u_units_to_pixels),u_patternscale_a:new k.Uniform2f(x,C.u_patternscale_a),u_patternscale_b:new k.Uniform2f(x,C.u_patternscale_b),u_sdfgamma:new k.Uniform1f(x,C.u_sdfgamma),u_image:new k.Uniform1i(x,C.u_image),u_tex_y_a:new k.Uniform1f(x,C.u_tex_y_a),u_tex_y_b:new k.Uniform1f(x,C.u_tex_y_b),u_mix:new k.Uniform1f(x,C.u_mix)}},raster:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_tl_parent:new k.Uniform2f(x,C.u_tl_parent),u_scale_parent:new k.Uniform1f(x,C.u_scale_parent),u_buffer_scale:new k.Uniform1f(x,C.u_buffer_scale),u_fade_t:new k.Uniform1f(x,C.u_fade_t),u_opacity:new k.Uniform1f(x,C.u_opacity),u_image0:new k.Uniform1i(x,C.u_image0),u_image1:new k.Uniform1i(x,C.u_image1),u_brightness_low:new k.Uniform1f(x,C.u_brightness_low),u_brightness_high:new k.Uniform1f(x,C.u_brightness_high),u_saturation_factor:new k.Uniform1f(x,C.u_saturation_factor),u_contrast_factor:new k.Uniform1f(x,C.u_contrast_factor),u_spin_weights:new k.Uniform3f(x,C.u_spin_weights)}},symbolIcon:function(x,C){return{u_is_size_zoom_constant:new k.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new k.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new k.Uniform1f(x,C.u_size_t),u_size:new k.Uniform1f(x,C.u_size),u_camera_to_center_distance:new k.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new k.Uniform1f(x,C.u_pitch),u_rotate_symbol:new k.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new k.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new k.Uniform1f(x,C.u_fade_change),u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new k.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new k.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new k.Uniform1i(x,C.u_is_text),u_pitch_with_map:new k.Uniform1i(x,C.u_pitch_with_map),u_texsize:new k.Uniform2f(x,C.u_texsize),u_texture:new k.Uniform1i(x,C.u_texture)}},symbolSDF:function(x,C){return{u_is_size_zoom_constant:new k.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new k.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new k.Uniform1f(x,C.u_size_t),u_size:new k.Uniform1f(x,C.u_size),u_camera_to_center_distance:new k.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new k.Uniform1f(x,C.u_pitch),u_rotate_symbol:new k.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new k.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new k.Uniform1f(x,C.u_fade_change),u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new k.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new k.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new k.Uniform1i(x,C.u_is_text),u_pitch_with_map:new k.Uniform1i(x,C.u_pitch_with_map),u_texsize:new k.Uniform2f(x,C.u_texsize),u_texture:new k.Uniform1i(x,C.u_texture),u_gamma_scale:new k.Uniform1f(x,C.u_gamma_scale),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_is_halo:new k.Uniform1i(x,C.u_is_halo)}},symbolTextAndIcon:function(x,C){return{u_is_size_zoom_constant:new k.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new k.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new k.Uniform1f(x,C.u_size_t),u_size:new k.Uniform1f(x,C.u_size),u_camera_to_center_distance:new k.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new k.Uniform1f(x,C.u_pitch),u_rotate_symbol:new k.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new k.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new k.Uniform1f(x,C.u_fade_change),u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new k.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new k.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new k.Uniform1i(x,C.u_is_text),u_pitch_with_map:new k.Uniform1i(x,C.u_pitch_with_map),u_texsize:new k.Uniform2f(x,C.u_texsize),u_texsize_icon:new k.Uniform2f(x,C.u_texsize_icon),u_texture:new k.Uniform1i(x,C.u_texture),u_texture_icon:new k.Uniform1i(x,C.u_texture_icon),u_gamma_scale:new k.Uniform1f(x,C.u_gamma_scale),u_device_pixel_ratio:new k.Uniform1f(x,C.u_device_pixel_ratio),u_is_halo:new k.Uniform1i(x,C.u_is_halo)}},background:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_opacity:new k.Uniform1f(x,C.u_opacity),u_color:new k.UniformColor(x,C.u_color)}},backgroundPattern:function(x,C){return{u_matrix:new k.UniformMatrix4f(x,C.u_matrix),u_opacity:new k.Uniform1f(x,C.u_opacity),u_image:new k.Uniform1i(x,C.u_image),u_pattern_tl_a:new k.Uniform2f(x,C.u_pattern_tl_a),u_pattern_br_a:new k.Uniform2f(x,C.u_pattern_br_a),u_pattern_tl_b:new k.Uniform2f(x,C.u_pattern_tl_b),u_pattern_br_b:new k.Uniform2f(x,C.u_pattern_br_b),u_texsize:new k.Uniform2f(x,C.u_texsize),u_mix:new k.Uniform1f(x,C.u_mix),u_pattern_size_a:new k.Uniform2f(x,C.u_pattern_size_a),u_pattern_size_b:new k.Uniform2f(x,C.u_pattern_size_b),u_scale_a:new k.Uniform1f(x,C.u_scale_a),u_scale_b:new k.Uniform1f(x,C.u_scale_b),u_pixel_coord_upper:new k.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new k.Uniform2f(x,C.u_pixel_coord_lower),u_tile_units_to_pixels:new k.Uniform1f(x,C.u_tile_units_to_pixels)}}};function Qc(x,C,E,M,U,H,$){for(var ht=x.context,Ut=ht.gl,ie=x.useProgram("collisionBox"),Be=[],De=0,Ne=0,fr=0;fr<M.length;fr++){var $e=M[fr],_r=C.getTile($e),er=_r.getBucket(E);if(er){var Er=$e.posMatrix;U[0]===0&&U[1]===0||(Er=x.translatePosMatrix($e.posMatrix,_r,U,H));var Or=$?er.textCollisionBox:er.iconCollisionBox,Yr=er.collisionCircleArray;if(Yr.length>0){var gn=k.create(),vn=Er;k.mul(gn,er.placementInvProjMatrix,x.transform.glCoordMatrix),k.mul(gn,gn,er.placementViewportMatrix),Be.push({circleArray:Yr,circleOffset:Ne,transform:vn,invTransform:gn}),Ne=De+=Yr.length/4}Or&&ie.draw(ht,Ut.LINES,we.disabled,Ge.disabled,x.colorModeForRenderPass(),br.disabled,xn(Er,x.transform,_r),E.id,Or.layoutVertexBuffer,Or.indexBuffer,Or.segments,null,x.transform.zoom,null,null,Or.collisionVertexBuffer)}}if($&&Be.length){var _n=x.useProgram("collisionCircle"),Un=new k.StructArrayLayout2f1f2i16;Un.resize(4*De),Un._trim();for(var ui=0,oi=0,Ri=Be;oi<Ri.length;oi+=1)for(var Di=Ri[oi],ia=0;ia<Di.circleArray.length/4;ia++){var na=4*ia,co=Di.circleArray[na+0],Bi=Di.circleArray[na+1],Pa=Di.circleArray[na+2],Ra=Di.circleArray[na+3];Un.emplace(ui++,co,Bi,Pa,Ra,0),Un.emplace(ui++,co,Bi,Pa,Ra,1),Un.emplace(ui++,co,Bi,Pa,Ra,2),Un.emplace(ui++,co,Bi,Pa,Ra,3)}(!Ep||Ep.length<2*De)&&(Ep=function(xs){var ru=2*xs,hu=new k.StructArrayLayout3ui6;hu.resize(ru),hu._trim();for(var Ko=0;Ko<ru;Ko++){var bs=6*Ko;hu.uint16[bs+0]=4*Ko+0,hu.uint16[bs+1]=4*Ko+1,hu.uint16[bs+2]=4*Ko+2,hu.uint16[bs+3]=4*Ko+2,hu.uint16[bs+4]=4*Ko+3,hu.uint16[bs+5]=4*Ko+0}return hu}(De));for(var Aa=ht.createIndexBuffer(Ep,!0),ya=ht.createVertexBuffer(Un,k.collisionCircleLayout.members,!0),Ba=0,Ea=Be;Ba<Ea.length;Ba+=1){var ca=Ea[Ba],Ys=Ii(ca.transform,ca.invTransform,x.transform);_n.draw(ht,Ut.TRIANGLES,we.disabled,Ge.disabled,x.colorModeForRenderPass(),br.disabled,Ys,E.id,ya,Aa,k.SegmentVector.simpleSegment(0,2*ca.circleOffset,ca.circleArray.length,ca.circleArray.length/2),null,x.transform.zoom,null,null,null)}ya.destroy(),Aa.destroy()}}var Rl=k.identity(new Float32Array(16));function wp(x,C,E,M,U,H){var $=k.getAnchorAlignment(x),ht=-($.horizontalAlign-.5)*C,Ut=-($.verticalAlign-.5)*E,ie=k.evaluateVariableOffset(x,M);return new k.Point((ht/U+ie[0])*H,(Ut/U+ie[1])*H)}function hh(x,C,E,M,U,H,$,ht,Ut,ie,Be){var De=x.text.placedSymbolArray,Ne=x.text.dynamicLayoutVertexArray,fr=x.icon.dynamicLayoutVertexArray,$e={};Ne.clear();for(var _r=0;_r<De.length;_r++){var er=De.get(_r),Er=er.hidden||!er.crossTileID||x.allowVerticalPlacement&&!er.placedOrientation?null:M[er.crossTileID];if(Er){var Or=new k.Point(er.anchorX,er.anchorY),Yr=Ua(Or,E?ht:$),gn=Xa(H.cameraToCenterDistance,Yr.signedDistanceFromCamera),vn=U.evaluateSizeForFeature(x.textSizeData,ie,er)*gn/k.ONE_EM;E&&(vn*=x.tilePixelRatio/Ut);for(var _n=wp(Er.anchor,Er.width,Er.height,Er.textOffset,Er.textBoxScale,vn),Un=E?Ua(Or.add(_n),$).point:Yr.point.add(C?_n.rotate(-H.angle):_n),ui=x.allowVerticalPlacement&&er.placedOrientation===k.WritingMode.vertical?Math.PI/2:0,oi=0;oi<er.numGlyphs;oi++)k.addDynamicAttributes(Ne,Un,ui);Be&&er.associatedIconIndex>=0&&($e[er.associatedIconIndex]={shiftedAnchor:Un,angle:ui})}else en(er.numGlyphs,Ne)}if(Be){fr.clear();for(var Ri=x.icon.placedSymbolArray,Di=0;Di<Ri.length;Di++){var ia=Ri.get(Di);if(ia.hidden)en(ia.numGlyphs,fr);else{var na=$e[Di];if(na)for(var co=0;co<ia.numGlyphs;co++)k.addDynamicAttributes(fr,na.shiftedAnchor,na.angle);else en(ia.numGlyphs,fr)}}x.icon.dynamicLayoutVertexBuffer.updateData(fr)}x.text.dynamicLayoutVertexBuffer.updateData(Ne)}function Qu(x,C,E){return E.iconsInText&&C?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function Jc(x,C,E,M,U,H,$,ht,Ut,ie,Be,De){for(var Ne=x.context,fr=Ne.gl,$e=x.transform,_r=ht==="map",er=Ut==="map",Er=_r&&E.layout.get("symbol-placement")!=="point",Or=_r&&!er&&!Er,Yr=E.layout.get("symbol-sort-key").constantOr(1)!==void 0,gn=!1,vn=x.depthModeForSublayer(0,we.ReadOnly),_n=E.layout.get("text-variable-anchor"),Un=[],ui=0,oi=M;ui<oi.length;ui+=1){var Ri=oi[ui],Di=C.getTile(Ri),ia=Di.getBucket(E);if(ia){var na=U?ia.text:ia.icon;if(na&&na.segments.get().length){var co=na.programConfigurations.get(E.id),Bi=U||ia.sdfIcons,Pa=U?ia.textSizeData:ia.iconSizeData,Ra=er||$e.pitch!==0,Aa=x.useProgram(Qu(Bi,U,ia),co),ya=k.evaluateSizeForZoom(Pa,$e.zoom),Ba=void 0,Ea=[0,0],ca=void 0,Ys=void 0,xs=null,ru=void 0;if(U)ca=Di.glyphAtlasTexture,Ys=fr.LINEAR,Ba=Di.glyphAtlasTexture.size,ia.iconsInText&&(Ea=Di.imageAtlasTexture.size,xs=Di.imageAtlasTexture,ru=Ra||x.options.rotating||x.options.zooming||Pa.kind==="composite"||Pa.kind==="camera"?fr.LINEAR:fr.NEAREST);else{var hu=E.layout.get("icon-size").constantOr(0)!==1||ia.iconsNeedLinear;ca=Di.imageAtlasTexture,Ys=Bi||x.options.rotating||x.options.zooming||hu||Ra?fr.LINEAR:fr.NEAREST,Ba=Di.imageAtlasTexture.size}var Ko=kn(Di,1,x.transform.zoom),bs=Uo(Ri.posMatrix,er,_r,x.transform,Ko),Au=vo(Ri.posMatrix,er,_r,x.transform,Ko),nu=_n&&ia.hasTextData(),mc=E.layout.get("icon-text-fit")!=="none"&&nu&&ia.hasIconData();Er&&Du(ia,Ri.posMatrix,x,U,bs,Au,er,ie);var pu=x.translatePosMatrix(Ri.posMatrix,Di,H,$),Vl=Er||U&&_n||mc?Rl:bs,Tl=x.translatePosMatrix(Au,Di,H,$,!0),Kf=Bi&&E.paint.get(U?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Qf={program:Aa,buffers:na,uniformValues:Bi?ia.iconsInText?Zf(Pa.kind,ya,Or,er,x,pu,Vl,Tl,Ba,Ea):qc(Pa.kind,ya,Or,er,x,pu,Vl,Tl,U,Ba,!0):Uf(Pa.kind,ya,Or,er,x,pu,Vl,Tl,U,Ba),atlasTexture:ca,atlasTextureIcon:xs,atlasInterpolation:Ys,atlasInterpolationIcon:ru,isSDF:Bi,hasHalo:Kf};if(Yr&&ia.canOverlap){gn=!0;for(var Ml=0,Tf=na.segments.get();Ml<Tf.length;Ml+=1){var yh=Tf[Ml];Un.push({segments:new k.SegmentVector([yh]),sortKey:yh.sortKey,state:Qf})}}else Un.push({segments:na.segments,sortKey:0,state:Qf})}}}gn&&Un.sort(function(uc,Pc){return uc.sortKey-Pc.sortKey});for(var sc=0,Jf=Un;sc<Jf.length;sc+=1){var Il=Jf[sc],Rs=Il.state;if(Ne.activeTexture.set(fr.TEXTURE0),Rs.atlasTexture.bind(Rs.atlasInterpolation,fr.CLAMP_TO_EDGE),Rs.atlasTextureIcon&&(Ne.activeTexture.set(fr.TEXTURE1),Rs.atlasTextureIcon&&Rs.atlasTextureIcon.bind(Rs.atlasInterpolationIcon,fr.CLAMP_TO_EDGE)),Rs.isSDF){var iu=Rs.uniformValues;Rs.hasHalo&&(iu.u_is_halo=1,Zh(Rs.buffers,Il.segments,E,x,Rs.program,vn,Be,De,iu)),iu.u_is_halo=0}Zh(Rs.buffers,Il.segments,E,x,Rs.program,vn,Be,De,Rs.uniformValues)}}function Zh(x,C,E,M,U,H,$,ht,Ut){var ie=M.context;U.draw(ie,ie.gl.TRIANGLES,H,$,ht,br.disabled,Ut,E.id,x.layoutVertexBuffer,x.indexBuffer,C,E.paint,M.transform.zoom,x.programConfigurations.get(E.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function Gf(x,C,E,M,U,H,$){var ht,Ut,ie,Be,De,Ne=x.context.gl,fr=E.paint.get("fill-pattern"),$e=fr&&fr.constantOr(1),_r=E.getCrossfadeParameters();$?(Ut=$e&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ht=Ne.LINES):(Ut=$e?"fillPattern":"fill",ht=Ne.TRIANGLES);for(var er=0,Er=M;er<Er.length;er+=1){var Or=Er[er],Yr=C.getTile(Or);if(!$e||Yr.patternsLoaded()){var gn=Yr.getBucket(E);if(gn){var vn=gn.programConfigurations.get(E.id),_n=x.useProgram(Ut,vn);$e&&(x.context.activeTexture.set(Ne.TEXTURE0),Yr.imageAtlasTexture.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE),vn.updatePaintBuffers(_r));var Un=fr.constantOr(null);if(Un&&Yr.imageAtlas){var ui=Yr.imageAtlas,oi=ui.patternPositions[Un.to.toString()],Ri=ui.patternPositions[Un.from.toString()];oi&&Ri&&vn.setConstantPatternPositions(oi,Ri)}var Di=x.translatePosMatrix(Or.posMatrix,Yr,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));if($){Be=gn.indexBuffer2,De=gn.segments2;var ia=[Ne.drawingBufferWidth,Ne.drawingBufferHeight];ie=Ut==="fillOutlinePattern"&&$e?Fr(Di,x,_r,Yr,ia):or(Di,ia)}else Be=gn.indexBuffer,De=gn.segments,ie=$e?ce(Di,x,_r,Yr):js(Di);_n.draw(x.context,ht,U,x.stencilModeForClipping(Or),H,br.disabled,ie,E.id,gn.layoutVertexBuffer,Be,De,E.paint,x.transform.zoom,vn)}}}}function ec(x,C,E,M,U,H,$){for(var ht=x.context,Ut=ht.gl,ie=E.paint.get("fill-extrusion-pattern"),Be=ie.constantOr(1),De=E.getCrossfadeParameters(),Ne=E.paint.get("fill-extrusion-opacity"),fr=0,$e=M;fr<$e.length;fr+=1){var _r=$e[fr],er=C.getTile(_r),Er=er.getBucket(E);if(Er){var Or=Er.programConfigurations.get(E.id),Yr=x.useProgram(Be?"fillExtrusionPattern":"fillExtrusion",Or);Be&&(x.context.activeTexture.set(Ut.TEXTURE0),er.imageAtlasTexture.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE),Or.updatePaintBuffers(De));var gn=ie.constantOr(null);if(gn&&er.imageAtlas){var vn=er.imageAtlas,_n=vn.patternPositions[gn.to.toString()],Un=vn.patternPositions[gn.from.toString()];_n&&Un&&Or.setConstantPatternPositions(_n,Un)}var ui=x.translatePosMatrix(_r.posMatrix,er,E.paint.get("fill-extrusion-translate"),E.paint.get("fill-extrusion-translate-anchor")),oi=E.paint.get("fill-extrusion-vertical-gradient"),Ri=Be?Uu(ui,x,oi,Ne,_r,De,er):kc(ui,x,oi,Ne);Yr.draw(ht,ht.gl.TRIANGLES,U,H,$,br.backCCW,Ri,E.id,Er.layoutVertexBuffer,Er.indexBuffer,Er.segments,E.paint,x.transform.zoom,Or)}}}function Sp(x,C,E,M,U,H){var $=x.context,ht=$.gl,Ut=C.fbo;if(Ut){var ie=x.useProgram("hillshade");$.activeTexture.set(ht.TEXTURE0),ht.bindTexture(ht.TEXTURE_2D,Ut.colorAttachment.get());var Be=function(De,Ne,fr){var $e=fr.paint.get("hillshade-shadow-color"),_r=fr.paint.get("hillshade-highlight-color"),er=fr.paint.get("hillshade-accent-color"),Er=fr.paint.get("hillshade-illumination-direction")*(Math.PI/180);fr.paint.get("hillshade-illumination-anchor")==="viewport"&&(Er-=De.transform.angle);var Or,Yr,gn,vn=!De.options.moving;return{u_matrix:De.transform.calculatePosMatrix(Ne.tileID.toUnwrapped(),vn),u_image:0,u_latrange:(Or=Ne.tileID,Yr=Math.pow(2,Or.canonical.z),gn=Or.canonical.y,[new k.MercatorCoordinate(0,gn/Yr).toLngLat().lat,new k.MercatorCoordinate(0,(gn+1)/Yr).toLngLat().lat]),u_light:[fr.paint.get("hillshade-exaggeration"),Er],u_shadow:$e,u_highlight:_r,u_accent:er}}(x,C,E);ie.draw($,ht.TRIANGLES,M,U,H,br.disabled,Be,E.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}}function nd(x,C,E,M,U,H){var $=x.context,ht=$.gl,Ut=C.dem;if(Ut&&Ut.data){var ie=Ut.dim,Be=Ut.stride,De=Ut.getPixels();if($.activeTexture.set(ht.TEXTURE1),$.pixelStoreUnpackPremultiplyAlpha.set(!1),C.demTexture=C.demTexture||x.getTileTexture(Be),C.demTexture){var Ne=C.demTexture;Ne.update(De,{premultiply:!1}),Ne.bind(ht.NEAREST,ht.CLAMP_TO_EDGE)}else C.demTexture=new k.Texture($,De,ht.RGBA,{premultiply:!1}),C.demTexture.bind(ht.NEAREST,ht.CLAMP_TO_EDGE);$.activeTexture.set(ht.TEXTURE0);var fr=C.fbo;if(!fr){var $e=new k.Texture($,{width:ie,height:ie,data:null},ht.RGBA);$e.bind(ht.LINEAR,ht.CLAMP_TO_EDGE),(fr=C.fbo=$.createFramebuffer(ie,ie,!0)).colorAttachment.set($e.texture)}$.bindFramebuffer.set(fr.framebuffer),$.viewport.set([0,0,ie,ie]),x.useProgram("hillshadePrepare").draw($,ht.TRIANGLES,M,U,H,br.disabled,function(_r,er){var Er=er.stride,Or=k.create();return k.ortho(Or,0,k.EXTENT,-k.EXTENT,0,0,1),k.translate(Or,Or,[0,-k.EXTENT,0]),{u_matrix:Or,u_image:1,u_dimension:[Er,Er],u_zoom:_r.overscaledZ,u_unpack:er.getUnpackVector()}}(C.tileID,Ut),E.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),C.needsHillshadePrepare=!1}}function Cp(x,C,E,M,U){var H=M.paint.get("raster-fade-duration");if(H>0){var $=k.browser.now(),ht=($-x.timeAdded)/H,Ut=C?($-C.timeAdded)/H:-1,ie=E.getSource(),Be=U.coveringZoomLevel({tileSize:ie.tileSize,roundZoom:ie.roundZoom}),De=!C||Math.abs(C.tileID.overscaledZ-Be)>Math.abs(x.tileID.overscaledZ-Be),Ne=De&&x.refreshedUponExpiration?1:k.clamp(De?ht:1-Ut,0,1);return x.refreshedUponExpiration&&ht>=1&&(x.refreshedUponExpiration=!1),C?{opacity:1,mix:1-Ne}:{opacity:Ne,mix:0}}return{opacity:1,mix:0}}var rc=new k.Color(1,0,0,1),id=new k.Color(0,1,0,1),tf=new k.Color(0,0,1,1),Hf=new k.Color(1,0,1,1),gf=new k.Color(0,1,1,1);function ad(x,C,E,M){mf(x,0,C+E/2,x.transform.width,E,M)}function od(x,C,E,M){mf(x,C-E/2,0,E,x.transform.height,M)}function mf(x,C,E,M,U,H){var $=x.context,ht=$.gl;ht.enable(ht.SCISSOR_TEST),ht.scissor(C*k.browser.devicePixelRatio,E*k.browser.devicePixelRatio,M*k.browser.devicePixelRatio,U*k.browser.devicePixelRatio),$.clear({color:H}),ht.disable(ht.SCISSOR_TEST)}function $v(x,C,E){var M=x.context,U=M.gl,H=E.posMatrix,$=x.useProgram("debug"),ht=we.disabled,Ut=Ge.disabled,ie=x.colorModeForRenderPass();M.activeTexture.set(U.TEXTURE0),x.emptyTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),$.draw(M,U.LINE_STRIP,ht,Ut,ie,br.disabled,ra(H,k.Color.red),"$debug",x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments);var Be=C.getTileByID(E.key).latestRawTileData,De=Math.floor((Be&&Be.byteLength||0)/1024),Ne=C.getTile(E).tileSize,fr=512/Math.min(Ne,512)*(E.overscaledZ/x.transform.zoom)*.5,$e=E.canonical.toString();E.overscaledZ!==E.canonical.z&&($e+=" => "+E.overscaledZ),function(_r,er){_r.initDebugOverlayCanvas();var Er=_r.debugOverlayCanvas,Or=_r.context.gl,Yr=_r.debugOverlayCanvas.getContext("2d");Yr.clearRect(0,0,Er.width,Er.height),Yr.shadowColor="white",Yr.shadowBlur=2,Yr.lineWidth=1.5,Yr.strokeStyle="white",Yr.textBaseline="top",Yr.font="bold 36px Open Sans, sans-serif",Yr.fillText(er,5,5),Yr.strokeText(er,5,5),_r.debugOverlayTexture.update(Er),_r.debugOverlayTexture.bind(Or.LINEAR,Or.CLAMP_TO_EDGE)}(x,$e+" "+De+"kb"),$.draw(M,U.TRIANGLES,ht,Ut,cr.alphaBlended,br.disabled,ra(H,k.Color.transparent,fr),"$debug",x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments)}var ph={symbol:function(x,C,E,M,U){if(x.renderPass==="translucent"){var H=Ge.disabled,$=x.colorModeForRenderPass();E.layout.get("text-variable-anchor")&&function(ht,Ut,ie,Be,De,Ne,fr){for(var $e=Ut.transform,_r=De==="map",er=Ne==="map",Er=0,Or=ht;Er<Or.length;Er+=1){var Yr=Or[Er],gn=Be.getTile(Yr),vn=gn.getBucket(ie);if(vn&&vn.text&&vn.text.segments.get().length){var _n=k.evaluateSizeForZoom(vn.textSizeData,$e.zoom),Un=kn(gn,1,Ut.transform.zoom),ui=Uo(Yr.posMatrix,er,_r,Ut.transform,Un),oi=ie.layout.get("icon-text-fit")!=="none"&&vn.hasIconData();if(_n){var Ri=Math.pow(2,$e.zoom-gn.tileID.overscaledZ);hh(vn,_r,er,fr,k.symbolSize,$e,ui,Yr.posMatrix,Ri,_n,oi)}}}}(M,x,E,C,E.layout.get("text-rotation-alignment"),E.layout.get("text-pitch-alignment"),U),E.paint.get("icon-opacity").constantOr(1)!==0&&Jc(x,C,E,M,!1,E.paint.get("icon-translate"),E.paint.get("icon-translate-anchor"),E.layout.get("icon-rotation-alignment"),E.layout.get("icon-pitch-alignment"),E.layout.get("icon-keep-upright"),H,$),E.paint.get("text-opacity").constantOr(1)!==0&&Jc(x,C,E,M,!0,E.paint.get("text-translate"),E.paint.get("text-translate-anchor"),E.layout.get("text-rotation-alignment"),E.layout.get("text-pitch-alignment"),E.layout.get("text-keep-upright"),H,$),C.map.showCollisionBoxes&&(Qc(x,C,E,M,E.paint.get("text-translate"),E.paint.get("text-translate-anchor"),!0),Qc(x,C,E,M,E.paint.get("icon-translate"),E.paint.get("icon-translate-anchor"),!1))}},circle:function(x,C,E,M){if(x.renderPass==="translucent"){var U=E.paint.get("circle-opacity"),H=E.paint.get("circle-stroke-width"),$=E.paint.get("circle-stroke-opacity"),ht=E.layout.get("circle-sort-key").constantOr(1)!==void 0;if(U.constantOr(1)!==0||H.constantOr(1)!==0&&$.constantOr(1)!==0){for(var Ut=x.context,ie=Ut.gl,Be=x.depthModeForSublayer(0,we.ReadOnly),De=Ge.disabled,Ne=x.colorModeForRenderPass(),fr=[],$e=0;$e<M.length;$e++){var _r=M[$e],er=C.getTile(_r),Er=er.getBucket(E);if(Er){var Or=Er.programConfigurations.get(E.id),Yr={programConfiguration:Or,program:x.useProgram("circle",Or),layoutVertexBuffer:Er.layoutVertexBuffer,indexBuffer:Er.indexBuffer,uniformValues:Xr(x,_r,er,E)};if(ht)for(var gn=0,vn=Er.segments.get();gn<vn.length;gn+=1){var _n=vn[gn];fr.push({segments:new k.SegmentVector([_n]),sortKey:_n.sortKey,state:Yr})}else fr.push({segments:Er.segments,sortKey:0,state:Yr})}}ht&&fr.sort(function(Di,ia){return Di.sortKey-ia.sortKey});for(var Un=0,ui=fr;Un<ui.length;Un+=1){var oi=ui[Un],Ri=oi.state;Ri.program.draw(Ut,ie.TRIANGLES,Be,De,Ne,br.disabled,Ri.uniformValues,E.id,Ri.layoutVertexBuffer,Ri.indexBuffer,oi.segments,E.paint,x.transform.zoom,Ri.programConfiguration)}}}},heatmap:function(x,C,E,M){if(E.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){var U=x.context,H=U.gl,$=Ge.disabled,ht=new cr([H.ONE,H.ONE],k.Color.transparent,[!0,!0,!0,!0]);(function(fr,$e,_r){var er=fr.gl;fr.activeTexture.set(er.TEXTURE1),fr.viewport.set([0,0,$e.width/4,$e.height/4]);var Er=_r.heatmapFbo;if(Er)er.bindTexture(er.TEXTURE_2D,Er.colorAttachment.get()),fr.bindFramebuffer.set(Er.framebuffer);else{var Or=er.createTexture();er.bindTexture(er.TEXTURE_2D,Or),er.texParameteri(er.TEXTURE_2D,er.TEXTURE_WRAP_S,er.CLAMP_TO_EDGE),er.texParameteri(er.TEXTURE_2D,er.TEXTURE_WRAP_T,er.CLAMP_TO_EDGE),er.texParameteri(er.TEXTURE_2D,er.TEXTURE_MIN_FILTER,er.LINEAR),er.texParameteri(er.TEXTURE_2D,er.TEXTURE_MAG_FILTER,er.LINEAR),Er=_r.heatmapFbo=fr.createFramebuffer($e.width/4,$e.height/4,!1),function(Yr,gn,vn,_n){var Un=Yr.gl;Un.texImage2D(Un.TEXTURE_2D,0,Un.RGBA,gn.width/4,gn.height/4,0,Un.RGBA,Yr.extRenderToTextureHalfFloat?Yr.extTextureHalfFloat.HALF_FLOAT_OES:Un.UNSIGNED_BYTE,null),_n.colorAttachment.set(vn)}(fr,$e,Or,Er)}})(U,x,E),U.clear({color:k.Color.transparent});for(var Ut=0;Ut<M.length;Ut++){var ie=M[Ut];if(!C.hasRenderableParent(ie)){var Be=C.getTile(ie),De=Be.getBucket(E);if(De){var Ne=De.programConfigurations.get(E.id);x.useProgram("heatmap",Ne).draw(U,H.TRIANGLES,we.disabled,$,ht,br.disabled,Eu(ie.posMatrix,Be,x.transform.zoom,E.paint.get("heatmap-intensity")),E.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,E.paint,x.transform.zoom,Ne)}}}U.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(fr,$e){var _r=fr.context,er=_r.gl,Er=$e.heatmapFbo;if(Er){_r.activeTexture.set(er.TEXTURE0),er.bindTexture(er.TEXTURE_2D,Er.colorAttachment.get()),_r.activeTexture.set(er.TEXTURE1);var Or=$e.colorRampTexture;Or||(Or=$e.colorRampTexture=new k.Texture(_r,$e.colorRamp,er.RGBA)),Or.bind(er.LINEAR,er.CLAMP_TO_EDGE),fr.useProgram("heatmapTexture").draw(_r,er.TRIANGLES,we.disabled,Ge.disabled,fr.colorModeForRenderPass(),br.disabled,function(Yr,gn,vn,_n){var Un=k.create();k.ortho(Un,0,Yr.width,Yr.height,0,0,1);var ui=Yr.context.gl;return{u_matrix:Un,u_world:[ui.drawingBufferWidth,ui.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:gn.paint.get("heatmap-opacity")}}(fr,$e),$e.id,fr.viewportBuffer,fr.quadTriangleIndexBuffer,fr.viewportSegments,$e.paint,fr.transform.zoom)}}(x,E))},line:function(x,C,E,M){if(x.renderPass==="translucent"){var U=E.paint.get("line-opacity"),H=E.paint.get("line-width");if(U.constantOr(1)!==0&&H.constantOr(1)!==0)for(var $=x.depthModeForSublayer(0,we.ReadOnly),ht=x.colorModeForRenderPass(),Ut=E.paint.get("line-dasharray"),ie=E.paint.get("line-pattern"),Be=ie.constantOr(1),De=E.paint.get("line-gradient"),Ne=E.getCrossfadeParameters(),fr=Be?"linePattern":Ut?"lineSDF":De?"lineGradient":"line",$e=x.context,_r=$e.gl,er=!0,Er=0,Or=M;Er<Or.length;Er+=1){var Yr=Or[Er],gn=C.getTile(Yr);if(!Be||gn.patternsLoaded()){var vn=gn.getBucket(E);if(vn){var _n=vn.programConfigurations.get(E.id),Un=x.context.program.get(),ui=x.useProgram(fr,_n),oi=er||ui.program!==Un,Ri=ie.constantOr(null);if(Ri&&gn.imageAtlas){var Di=gn.imageAtlas,ia=Di.patternPositions[Ri.to.toString()],na=Di.patternPositions[Ri.from.toString()];ia&&na&&_n.setConstantPatternPositions(ia,na)}var co=Be?Jl(x,gn,E,Ne):Ut?$c(x,gn,E,Ut,Ne):De?Ya(x,gn,E,vn.lineClipsArray.length):Ws(x,gn,E);if(Be)$e.activeTexture.set(_r.TEXTURE0),gn.imageAtlasTexture.bind(_r.LINEAR,_r.CLAMP_TO_EDGE),_n.updatePaintBuffers(Ne);else if(Ut&&(oi||x.lineAtlas.dirty))$e.activeTexture.set(_r.TEXTURE0),x.lineAtlas.bind($e);else if(De){var Bi=vn.gradients[E.id],Pa=Bi.texture;if(E.gradientVersion!==Bi.version){var Ra=256;if(E.stepInterpolant){var Aa=C.getSource().maxzoom,ya=Yr.canonical.z===Aa?Math.ceil(1<<x.transform.maxZoom-Yr.canonical.z):1;Ra=k.clamp(k.nextPowerOfTwo(vn.maxLineLength/k.EXTENT*1024*ya),256,$e.maxTextureSize)}Bi.gradient=k.renderColorRamp({expression:E.gradientExpression(),evaluationKey:"lineProgress",resolution:Ra,image:Bi.gradient||void 0,clips:vn.lineClipsArray}),Bi.texture?Bi.texture.update(Bi.gradient):Bi.texture=new k.Texture($e,Bi.gradient,_r.RGBA),Bi.version=E.gradientVersion,Pa=Bi.texture}$e.activeTexture.set(_r.TEXTURE0),Pa.bind(E.stepInterpolant?_r.NEAREST:_r.LINEAR,_r.CLAMP_TO_EDGE)}ui.draw($e,_r.TRIANGLES,$,x.stencilModeForClipping(Yr),ht,br.disabled,co,E.id,vn.layoutVertexBuffer,vn.indexBuffer,vn.segments,E.paint,x.transform.zoom,_n,vn.layoutVertexBuffer2),er=!1}}}}},fill:function(x,C,E,M){var U=E.paint.get("fill-color"),H=E.paint.get("fill-opacity");if(H.constantOr(1)!==0){var $=x.colorModeForRenderPass(),ht=E.paint.get("fill-pattern"),Ut=x.opaquePassEnabledForLayer()&&!ht.constantOr(1)&&U.constantOr(k.Color.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===Ut){var ie=x.depthModeForSublayer(1,x.renderPass==="opaque"?we.ReadWrite:we.ReadOnly);Gf(x,C,E,M,ie,$,!1)}if(x.renderPass==="translucent"&&E.paint.get("fill-antialias")){var Be=x.depthModeForSublayer(E.getPaintProperty("fill-outline-color")?2:0,we.ReadOnly);Gf(x,C,E,M,Be,$,!0)}}},"fill-extrusion":function(x,C,E,M){var U=E.paint.get("fill-extrusion-opacity");if(U!==0&&x.renderPass==="translucent"){var H=new we(x.context.gl.LEQUAL,we.ReadWrite,x.depthRangeFor3D);if(U!==1||E.paint.get("fill-extrusion-pattern").constantOr(1))ec(x,C,E,M,H,Ge.disabled,cr.disabled),ec(x,C,E,M,H,x.stencilModeFor3D(),x.colorModeForRenderPass());else{var $=x.colorModeForRenderPass();ec(x,C,E,M,H,Ge.disabled,$)}}},hillshade:function(x,C,E,M){if(x.renderPass==="offscreen"||x.renderPass==="translucent"){for(var U=x.context,H=x.depthModeForSublayer(0,we.ReadOnly),$=x.colorModeForRenderPass(),ht=x.renderPass==="translucent"?x.stencilConfigForOverlap(M):[{},M],Ut=ht[0],ie=0,Be=ht[1];ie<Be.length;ie+=1){var De=Be[ie],Ne=C.getTile(De);Ne.needsHillshadePrepare&&x.renderPass==="offscreen"?nd(x,Ne,E,H,Ge.disabled,$):x.renderPass==="translucent"&&Sp(x,Ne,E,H,Ut[De.overscaledZ],$)}U.viewport.set([0,0,x.width,x.height])}},raster:function(x,C,E,M){if(x.renderPass==="translucent"&&E.paint.get("raster-opacity")!==0&&M.length)for(var U=x.context,H=U.gl,$=C.getSource(),ht=x.useProgram("raster"),Ut=x.colorModeForRenderPass(),ie=$ instanceof he?[{},M]:x.stencilConfigForOverlap(M),Be=ie[0],De=ie[1],Ne=De[De.length-1].overscaledZ,fr=!x.options.moving,$e=0,_r=De;$e<_r.length;$e+=1){var er=_r[$e],Er=x.depthModeForSublayer(er.overscaledZ-Ne,E.paint.get("raster-opacity")===1?we.ReadWrite:we.ReadOnly,H.LESS),Or=C.getTile(er),Yr=x.transform.calculatePosMatrix(er.toUnwrapped(),fr);Or.registerFadeDuration(E.paint.get("raster-fade-duration"));var gn=C.findLoadedParent(er,0),vn=Cp(Or,gn,C,E,x.transform),_n=void 0,Un=void 0,ui=E.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;U.activeTexture.set(H.TEXTURE0),Or.texture.bind(ui,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),U.activeTexture.set(H.TEXTURE1),gn?(gn.texture.bind(ui,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),_n=Math.pow(2,gn.tileID.overscaledZ-Or.tileID.overscaledZ),Un=[Or.tileID.canonical.x*_n%1,Or.tileID.canonical.y*_n%1]):Or.texture.bind(ui,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);var oi=zf(Yr,Un||[0,0],_n||1,vn,E);$ instanceof he?ht.draw(U,H.TRIANGLES,Er,Ge.disabled,Ut,br.disabled,oi,E.id,$.boundsBuffer,x.quadTriangleIndexBuffer,$.boundsSegments):ht.draw(U,H.TRIANGLES,Er,Be[er.overscaledZ],Ut,br.disabled,oi,E.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}},background:function(x,C,E){var M=E.paint.get("background-color"),U=E.paint.get("background-opacity");if(U!==0){var H=x.context,$=H.gl,ht=x.transform,Ut=ht.tileSize,ie=E.paint.get("background-pattern");if(!x.isPatternMissing(ie)){var Be=!ie&&M.a===1&&U===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass===Be){var De=Ge.disabled,Ne=x.depthModeForSublayer(0,Be==="opaque"?we.ReadWrite:we.ReadOnly),fr=x.colorModeForRenderPass(),$e=x.useProgram(ie?"backgroundPattern":"background"),_r=ht.coveringTiles({tileSize:Ut});ie&&(H.activeTexture.set($.TEXTURE0),x.imageManager.bind(x.context));for(var er=E.getCrossfadeParameters(),Er=0,Or=_r;Er<Or.length;Er+=1){var Yr=Or[Er],gn=x.transform.calculatePosMatrix(Yr.toUnwrapped()),vn=ie?Vf(gn,U,x,ie,{tileID:Yr,tileSize:Ut},er):Kc(gn,U,M);$e.draw(H,$.TRIANGLES,Ne,De,fr,br.disabled,vn,E.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}}}},debug:function(x,C,E){for(var M=0;M<E.length;M++)$v(x,C,E[M])},custom:function(x,C,E){var M=x.context,U=E.implementation;if(x.renderPass==="offscreen"){var H=U.prerender;H&&(x.setCustomLayerDefaults(),M.setColorMode(x.colorModeForRenderPass()),H.call(U,M.gl,x.transform.customLayerMatrix()),M.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),M.setColorMode(x.colorModeForRenderPass()),M.setStencilMode(Ge.disabled);var $=U.renderingMode==="3d"?new we(x.context.gl.LEQUAL,we.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,we.ReadOnly);M.setDepthMode($),U.render(M.gl,x.transform.customLayerMatrix()),M.setDirty(),x.setBaseState(),M.bindFramebuffer.set(null)}}},gs=function(x,C){this.context=new Ce(x),this.transform=C,this._tileTextures={},this.setup(),this.numSublayers=ar.maxUnderzooming+ar.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Zs,this.gpuTimers={}};gs.prototype.resize=function(x,C){if(this.width=x*k.browser.devicePixelRatio,this.height=C*k.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var E=0,M=this.style._order;E<M.length;E+=1)this.style._layers[M[E]].resize()},gs.prototype.setup=function(){var x=this.context,C=new k.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(k.EXTENT,0),C.emplaceBack(0,k.EXTENT),C.emplaceBack(k.EXTENT,k.EXTENT),this.tileExtentBuffer=x.createVertexBuffer(C,Fo.members),this.tileExtentSegments=k.SegmentVector.simpleSegment(0,0,4,2);var E=new k.StructArrayLayout2i4;E.emplaceBack(0,0),E.emplaceBack(k.EXTENT,0),E.emplaceBack(0,k.EXTENT),E.emplaceBack(k.EXTENT,k.EXTENT),this.debugBuffer=x.createVertexBuffer(E,Fo.members),this.debugSegments=k.SegmentVector.simpleSegment(0,0,4,5);var M=new k.StructArrayLayout4i8;M.emplaceBack(0,0,0,0),M.emplaceBack(k.EXTENT,0,k.EXTENT,0),M.emplaceBack(0,k.EXTENT,0,k.EXTENT),M.emplaceBack(k.EXTENT,k.EXTENT,k.EXTENT,k.EXTENT),this.rasterBoundsBuffer=x.createVertexBuffer(M,gt.members),this.rasterBoundsSegments=k.SegmentVector.simpleSegment(0,0,4,2);var U=new k.StructArrayLayout2i4;U.emplaceBack(0,0),U.emplaceBack(1,0),U.emplaceBack(0,1),U.emplaceBack(1,1),this.viewportBuffer=x.createVertexBuffer(U,Fo.members),this.viewportSegments=k.SegmentVector.simpleSegment(0,0,4,2);var H=new k.StructArrayLayout1ui2;H.emplaceBack(0),H.emplaceBack(1),H.emplaceBack(3),H.emplaceBack(2),H.emplaceBack(0),this.tileBorderIndexBuffer=x.createIndexBuffer(H);var $=new k.StructArrayLayout3ui6;$.emplaceBack(0,1,2),$.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=x.createIndexBuffer($),this.emptyTexture=new k.Texture(x,{width:1,height:1,data:new Uint8Array([0,0,0,0])},x.gl.RGBA);var ht=this.context.gl;this.stencilClearMode=new Ge({func:ht.ALWAYS,mask:0},0,255,ht.ZERO,ht.ZERO,ht.ZERO)},gs.prototype.clearStencil=function(){var x=this.context,C=x.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var E=k.create();k.ortho(E,0,this.width,this.height,0,0,1),k.scale(E,E,[C.drawingBufferWidth,C.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(x,C.TRIANGLES,we.disabled,this.stencilClearMode,cr.disabled,br.disabled,Wa(E),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},gs.prototype._renderTileClippingMasks=function(x,C){if(this.currentStencilSource!==x.source&&x.isTileClipped()&&C&&C.length){this.currentStencilSource=x.source;var E=this.context,M=E.gl;this.nextStencilID+C.length>256&&this.clearStencil(),E.setColorMode(cr.disabled),E.setDepthMode(we.disabled);var U=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var H=0,$=C;H<$.length;H+=1){var ht=$[H],Ut=this._tileClippingMaskIDs[ht.key]=this.nextStencilID++;U.draw(E,M.TRIANGLES,we.disabled,new Ge({func:M.ALWAYS,mask:0},Ut,255,M.KEEP,M.KEEP,M.REPLACE),cr.disabled,br.disabled,Wa(ht.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},gs.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var x=this.nextStencilID++,C=this.context.gl;return new Ge({func:C.NOTEQUAL,mask:255},x,255,C.KEEP,C.KEEP,C.REPLACE)},gs.prototype.stencilModeForClipping=function(x){var C=this.context.gl;return new Ge({func:C.EQUAL,mask:255},this._tileClippingMaskIDs[x.key],0,C.KEEP,C.KEEP,C.REPLACE)},gs.prototype.stencilConfigForOverlap=function(x){var C,E=this.context.gl,M=x.sort(function(Ut,ie){return ie.overscaledZ-Ut.overscaledZ}),U=M[M.length-1].overscaledZ,H=M[0].overscaledZ-U+1;if(H>1){this.currentStencilSource=void 0,this.nextStencilID+H>256&&this.clearStencil();for(var $={},ht=0;ht<H;ht++)$[ht+U]=new Ge({func:E.GEQUAL,mask:255},ht+this.nextStencilID,255,E.KEEP,E.KEEP,E.REPLACE);return this.nextStencilID+=H,[$,M]}return[(C={},C[U]=Ge.disabled,C),M]},gs.prototype.colorModeForRenderPass=function(){var x=this.context.gl;return this._showOverdrawInspector?new cr([x.CONSTANT_COLOR,x.ONE],new k.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?cr.unblended:cr.alphaBlended},gs.prototype.depthModeForSublayer=function(x,C,E){if(!this.opaquePassEnabledForLayer())return we.disabled;var M=1-((1+this.currentLayer)*this.numSublayers+x)*this.depthEpsilon;return new we(E||this.context.gl.LEQUAL,C,[M,M])},gs.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},gs.prototype.render=function(x,C){var E=this;this.style=x,this.options=C,this.lineAtlas=x.lineAtlas,this.imageManager=x.imageManager,this.glyphManager=x.glyphManager,this.symbolFadeChange=x.placement.symbolFadeChange(k.browser.now()),this.imageManager.beginFrame();var M=this.style._order,U=this.style.sourceCaches;for(var H in U){var $=U[H];$.used&&$.prepare(this.context)}var ht,Ut,ie={},Be={},De={};for(var Ne in U){var fr=U[Ne];ie[Ne]=fr.getVisibleCoordinates(),Be[Ne]=ie[Ne].slice().reverse(),De[Ne]=fr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var $e=0;$e<M.length;$e++)if(this.style._layers[M[$e]].is3D()){this.opaquePassCutoff=$e;break}this.renderPass="offscreen";for(var _r=0,er=M;_r<er.length;_r+=1){var Er=this.style._layers[er[_r]];if(Er.hasOffscreenPass()&&!Er.isHidden(this.transform.zoom)){var Or=Be[Er.source];(Er.type==="custom"||Or.length)&&this.renderLayer(this,U[Er.source],Er,Or)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:C.showOverdrawInspector?k.Color.black:k.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=C.showOverdrawInspector,this.depthRangeFor3D=[0,1-(x._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){var Yr=this.style._layers[M[this.currentLayer]],gn=U[Yr.source],vn=ie[Yr.source];this._renderTileClippingMasks(Yr,vn),this.renderLayer(this,gn,Yr,vn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){var _n=this.style._layers[M[this.currentLayer]],Un=U[_n.source],ui=(_n.type==="symbol"?De:Be)[_n.source];this._renderTileClippingMasks(_n,ie[_n.source]),this.renderLayer(this,Un,_n,ui)}this.options.showTileBoundaries&&(k.values(this.style._layers).forEach(function(oi){oi.source&&!oi.isHidden(E.transform.zoom)&&(oi.source!==(Ut&&Ut.id)&&(Ut=E.style.sourceCaches[oi.source]),(!ht||ht.getSource().maxzoom<Ut.getSource().maxzoom)&&(ht=Ut))}),ht&&ph.debug(this,ht,ht.getVisibleCoordinates())),this.options.showPadding&&function(oi){var Ri=oi.transform.padding;ad(oi,oi.transform.height-(Ri.top||0),3,rc),ad(oi,Ri.bottom||0,3,id),od(oi,Ri.left||0,3,tf),od(oi,oi.transform.width-(Ri.right||0),3,Hf);var Di=oi.transform.centerPoint;(function(ia,na,co,Bi){mf(ia,na-1,co-10,2,20,Bi),mf(ia,na-10,co-1,20,2,Bi)})(oi,Di.x,oi.transform.height-Di.y,gf)}(this),this.context.setDefault()},gs.prototype.renderLayer=function(x,C,E,M){E.isHidden(this.transform.zoom)||(E.type==="background"||E.type==="custom"||M.length)&&(this.id=E.id,this.gpuTimingStart(E),ph[E.type](x,C,E,M,this.style.placement.variableOffsets),this.gpuTimingEnd())},gs.prototype.gpuTimingStart=function(x){if(this.options.gpuTiming){var C=this.context.extTimerQuery,E=this.gpuTimers[x.id];E||(E=this.gpuTimers[x.id]={calls:0,cpuTime:0,query:C.createQueryEXT()}),E.calls++,C.beginQueryEXT(C.TIME_ELAPSED_EXT,E.query)}},gs.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var x=this.context.extTimerQuery;x.endQueryEXT(x.TIME_ELAPSED_EXT)}},gs.prototype.collectGpuTimers=function(){var x=this.gpuTimers;return this.gpuTimers={},x},gs.prototype.queryGpuTimers=function(x){var C={};for(var E in x){var M=x[E],U=this.context.extTimerQuery,H=U.getQueryObjectEXT(M.query,U.QUERY_RESULT_EXT)/1e6;U.deleteQueryEXT(M.query),C[E]=H}return C},gs.prototype.translatePosMatrix=function(x,C,E,M,U){if(!E[0]&&!E[1])return x;var H=U?M==="map"?this.transform.angle:0:M==="viewport"?-this.transform.angle:0;if(H){var $=Math.sin(H),ht=Math.cos(H);E=[E[0]*ht-E[1]*$,E[0]*$+E[1]*ht]}var Ut=[U?E[0]:kn(C,E[0],this.transform.zoom),U?E[1]:kn(C,E[1],this.transform.zoom),0],ie=new Float32Array(16);return k.translate(ie,x,Ut),ie},gs.prototype.saveTileTexture=function(x){var C=this._tileTextures[x.size[0]];C?C.push(x):this._tileTextures[x.size[0]]=[x]},gs.prototype.getTileTexture=function(x){var C=this._tileTextures[x];return C&&C.length>0?C.pop():null},gs.prototype.isPatternMissing=function(x){if(!x)return!1;if(!x.from||!x.to)return!0;var C=this.imageManager.getPattern(x.from.toString()),E=this.imageManager.getPattern(x.to.toString());return!C||!E},gs.prototype.useProgram=function(x,C){this.cache=this.cache||{};var E=""+x+(C?C.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[E]||(this.cache[E]=new Yc(this.context,x,bu[x],C,fh[x],this._showOverdrawInspector)),this.cache[E]},gs.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},gs.prototype.setBaseState=function(){var x=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(x.FUNC_ADD)},gs.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=k.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new k.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},gs.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var yf=function(x,C){this.points=x,this.planes=C};yf.fromInvProjectionMatrix=function(x,C,E){var M=Math.pow(2,E),U=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function($){return k.transformMat4([],$,x)}).map(function($){return k.scale$1([],$,1/$[3]/C*M)}),H=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function($){var ht=k.sub([],U[$[0]],U[$[1]]),Ut=k.sub([],U[$[2]],U[$[1]]),ie=k.normalize([],k.cross([],ht,Ut)),Be=-k.dot(ie,U[$[1]]);return ie.concat(Be)});return new yf(U,H)};var jf=function(x,C){this.min=x,this.max=C,this.center=k.scale$2([],k.add([],this.min,this.max),.5)};jf.prototype.quadrant=function(x){for(var C=[x%2==0,x<2],E=k.clone$2(this.min),M=k.clone$2(this.max),U=0;U<C.length;U++)E[U]=C[U]?this.min[U]:this.center[U],M[U]=C[U]?this.center[U]:this.max[U];return M[2]=this.max[2],new jf(E,M)},jf.prototype.distanceX=function(x){return Math.max(Math.min(this.max[0],x[0]),this.min[0])-x[0]},jf.prototype.distanceY=function(x){return Math.max(Math.min(this.max[1],x[1]),this.min[1])-x[1]},jf.prototype.intersects=function(x){for(var C=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],E=!0,M=0;M<x.planes.length;M++){for(var U=x.planes[M],H=0,$=0;$<C.length;$++)H+=k.dot$1(U,C[$])>=0;if(H===0)return 0;H!==C.length&&(E=!1)}if(E)return 2;for(var ht=0;ht<3;ht++){for(var Ut=Number.MAX_VALUE,ie=-Number.MAX_VALUE,Be=0;Be<x.points.length;Be++){var De=x.points[Be][ht]-this.min[ht];Ut=Math.min(Ut,De),ie=Math.max(ie,De)}if(ie<0||Ut>this.max[ht]-this.min[ht])return 0}return 1};var Dl=function(x,C,E,M){if(x===void 0&&(x=0),C===void 0&&(C=0),E===void 0&&(E=0),M===void 0&&(M=0),isNaN(x)||x<0||isNaN(C)||C<0||isNaN(E)||E<0||isNaN(M)||M<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=x,this.bottom=C,this.left=E,this.right=M};Dl.prototype.interpolate=function(x,C,E){return C.top!=null&&x.top!=null&&(this.top=k.number(x.top,C.top,E)),C.bottom!=null&&x.bottom!=null&&(this.bottom=k.number(x.bottom,C.bottom,E)),C.left!=null&&x.left!=null&&(this.left=k.number(x.left,C.left,E)),C.right!=null&&x.right!=null&&(this.right=k.number(x.right,C.right,E)),this},Dl.prototype.getCenter=function(x,C){var E=k.clamp((this.left+x-this.right)/2,0,x),M=k.clamp((this.top+C-this.bottom)/2,0,C);return new k.Point(E,M)},Dl.prototype.equals=function(x){return this.top===x.top&&this.bottom===x.bottom&&this.left===x.left&&this.right===x.right},Dl.prototype.clone=function(){return new Dl(this.top,this.bottom,this.left,this.right)},Dl.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ja=function(x,C,E,M,U){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=U===void 0||U,this._minZoom=x||0,this._maxZoom=C||22,this._minPitch=E==null?0:E,this._maxPitch=M==null?60:M,this.setMaxBounds(),this.width=0,this.height=0,this._center=new k.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Dl,this._posMatrixCache={},this._alignedPosMatrixCache={}},Wo={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ja.prototype.clone=function(){var x=new Ja(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return x.tileSize=this.tileSize,x.latRange=this.latRange,x.width=this.width,x.height=this.height,x._center=this._center,x.zoom=this.zoom,x.angle=this.angle,x._fov=this._fov,x._pitch=this._pitch,x._unmodified=this._unmodified,x._edgeInsets=this._edgeInsets.clone(),x._calcMatrices(),x},Wo.minZoom.get=function(){return this._minZoom},Wo.minZoom.set=function(x){this._minZoom!==x&&(this._minZoom=x,this.zoom=Math.max(this.zoom,x))},Wo.maxZoom.get=function(){return this._maxZoom},Wo.maxZoom.set=function(x){this._maxZoom!==x&&(this._maxZoom=x,this.zoom=Math.min(this.zoom,x))},Wo.minPitch.get=function(){return this._minPitch},Wo.minPitch.set=function(x){this._minPitch!==x&&(this._minPitch=x,this.pitch=Math.max(this.pitch,x))},Wo.maxPitch.get=function(){return this._maxPitch},Wo.maxPitch.set=function(x){this._maxPitch!==x&&(this._maxPitch=x,this.pitch=Math.min(this.pitch,x))},Wo.renderWorldCopies.get=function(){return this._renderWorldCopies},Wo.renderWorldCopies.set=function(x){x===void 0?x=!0:x===null&&(x=!1),this._renderWorldCopies=x},Wo.worldSize.get=function(){return this.tileSize*this.scale},Wo.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Wo.size.get=function(){return new k.Point(this.width,this.height)},Wo.bearing.get=function(){return-this.angle/Math.PI*180},Wo.bearing.set=function(x){var C=-k.wrap(x,-180,180)*Math.PI/180;this.angle!==C&&(this._unmodified=!1,this.angle=C,this._calcMatrices(),this.rotationMatrix=k.create$2(),k.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Wo.pitch.get=function(){return this._pitch/Math.PI*180},Wo.pitch.set=function(x){var C=k.clamp(x,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==C&&(this._unmodified=!1,this._pitch=C,this._calcMatrices())},Wo.fov.get=function(){return this._fov/Math.PI*180},Wo.fov.set=function(x){x=Math.max(.01,Math.min(60,x)),this._fov!==x&&(this._unmodified=!1,this._fov=x/180*Math.PI,this._calcMatrices())},Wo.zoom.get=function(){return this._zoom},Wo.zoom.set=function(x){var C=Math.min(Math.max(x,this.minZoom),this.maxZoom);this._zoom!==C&&(this._unmodified=!1,this._zoom=C,this.scale=this.zoomScale(C),this.tileZoom=Math.floor(C),this.zoomFraction=C-this.tileZoom,this._constrain(),this._calcMatrices())},Wo.center.get=function(){return this._center},Wo.center.set=function(x){x.lat===this._center.lat&&x.lng===this._center.lng||(this._unmodified=!1,this._center=x,this._constrain(),this._calcMatrices())},Wo.padding.get=function(){return this._edgeInsets.toJSON()},Wo.padding.set=function(x){this._edgeInsets.equals(x)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,x,1),this._calcMatrices())},Wo.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ja.prototype.isPaddingEqual=function(x){return this._edgeInsets.equals(x)},Ja.prototype.interpolatePadding=function(x,C,E){this._unmodified=!1,this._edgeInsets.interpolate(x,C,E),this._constrain(),this._calcMatrices()},Ja.prototype.coveringZoomLevel=function(x){var C=(x.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/x.tileSize));return Math.max(0,C)},Ja.prototype.getVisibleUnwrappedCoordinates=function(x){var C=[new k.UnwrappedTileID(0,x)];if(this._renderWorldCopies)for(var E=this.pointCoordinate(new k.Point(0,0)),M=this.pointCoordinate(new k.Point(this.width,0)),U=this.pointCoordinate(new k.Point(this.width,this.height)),H=this.pointCoordinate(new k.Point(0,this.height)),$=Math.floor(Math.min(E.x,M.x,U.x,H.x)),ht=Math.floor(Math.max(E.x,M.x,U.x,H.x)),Ut=$-1;Ut<=ht+1;Ut++)Ut!==0&&C.push(new k.UnwrappedTileID(Ut,x));return C},Ja.prototype.coveringTiles=function(x){var C=this.coveringZoomLevel(x),E=C;if(x.minzoom!==void 0&&C<x.minzoom)return[];x.maxzoom!==void 0&&C>x.maxzoom&&(C=x.maxzoom);var M=k.MercatorCoordinate.fromLngLat(this.center),U=Math.pow(2,C),H=[U*M.x,U*M.y,0],$=yf.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C),ht=x.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ht=C);var Ut=function(oi){return{aabb:new jf([oi*U,0,0],[(oi+1)*U,U,0]),zoom:0,x:0,y:0,wrap:oi,fullyVisible:!1}},ie=[],Be=[],De=C,Ne=x.reparseOverscaled?E:C;if(this._renderWorldCopies)for(var fr=1;fr<=3;fr++)ie.push(Ut(-fr)),ie.push(Ut(fr));for(ie.push(Ut(0));ie.length>0;){var $e=ie.pop(),_r=$e.x,er=$e.y,Er=$e.fullyVisible;if(!Er){var Or=$e.aabb.intersects($);if(Or===0)continue;Er=Or===2}var Yr=$e.aabb.distanceX(H),gn=$e.aabb.distanceY(H),vn=Math.max(Math.abs(Yr),Math.abs(gn));if($e.zoom===De||vn>3+(1<<De-$e.zoom)-2&&$e.zoom>=ht)Be.push({tileID:new k.OverscaledTileID($e.zoom===De?Ne:$e.zoom,$e.wrap,$e.zoom,_r,er),distanceSq:k.sqrLen([H[0]-.5-_r,H[1]-.5-er])});else for(var _n=0;_n<4;_n++){var Un=(_r<<1)+_n%2,ui=(er<<1)+(_n>>1);ie.push({aabb:$e.aabb.quadrant(_n),zoom:$e.zoom+1,x:Un,y:ui,wrap:$e.wrap,fullyVisible:Er})}}return Be.sort(function(oi,Ri){return oi.distanceSq-Ri.distanceSq}).map(function(oi){return oi.tileID})},Ja.prototype.resize=function(x,C){this.width=x,this.height=C,this.pixelsToGLUnits=[2/x,-2/C],this._constrain(),this._calcMatrices()},Wo.unmodified.get=function(){return this._unmodified},Ja.prototype.zoomScale=function(x){return Math.pow(2,x)},Ja.prototype.scaleZoom=function(x){return Math.log(x)/Math.LN2},Ja.prototype.project=function(x){var C=k.clamp(x.lat,-this.maxValidLatitude,this.maxValidLatitude);return new k.Point(k.mercatorXfromLng(x.lng)*this.worldSize,k.mercatorYfromLat(C)*this.worldSize)},Ja.prototype.unproject=function(x){return new k.MercatorCoordinate(x.x/this.worldSize,x.y/this.worldSize).toLngLat()},Wo.point.get=function(){return this.project(this.center)},Ja.prototype.setLocationAtPoint=function(x,C){var E=this.pointCoordinate(C),M=this.pointCoordinate(this.centerPoint),U=this.locationCoordinate(x),H=new k.MercatorCoordinate(U.x-(E.x-M.x),U.y-(E.y-M.y));this.center=this.coordinateLocation(H),this._renderWorldCopies&&(this.center=this.center.wrap())},Ja.prototype.locationPoint=function(x){return this.coordinatePoint(this.locationCoordinate(x))},Ja.prototype.pointLocation=function(x){return this.coordinateLocation(this.pointCoordinate(x))},Ja.prototype.locationCoordinate=function(x){return k.MercatorCoordinate.fromLngLat(x)},Ja.prototype.coordinateLocation=function(x){return x.toLngLat()},Ja.prototype.pointCoordinate=function(x){var C=[x.x,x.y,0,1],E=[x.x,x.y,1,1];k.transformMat4(C,C,this.pixelMatrixInverse),k.transformMat4(E,E,this.pixelMatrixInverse);var M=C[3],U=E[3],H=C[1]/M,$=E[1]/U,ht=C[2]/M,Ut=E[2]/U,ie=ht===Ut?0:(0-ht)/(Ut-ht);return new k.MercatorCoordinate(k.number(C[0]/M,E[0]/U,ie)/this.worldSize,k.number(H,$,ie)/this.worldSize)},Ja.prototype.coordinatePoint=function(x){var C=[x.x*this.worldSize,x.y*this.worldSize,0,1];return k.transformMat4(C,C,this.pixelMatrix),new k.Point(C[0]/C[3],C[1]/C[3])},Ja.prototype.getBounds=function(){return new k.LngLatBounds().extend(this.pointLocation(new k.Point(0,0))).extend(this.pointLocation(new k.Point(this.width,0))).extend(this.pointLocation(new k.Point(this.width,this.height))).extend(this.pointLocation(new k.Point(0,this.height)))},Ja.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new k.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ja.prototype.setMaxBounds=function(x){x?(this.lngRange=[x.getWest(),x.getEast()],this.latRange=[x.getSouth(),x.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ja.prototype.calculatePosMatrix=function(x,C){C===void 0&&(C=!1);var E=x.key,M=C?this._alignedPosMatrixCache:this._posMatrixCache;if(M[E])return M[E];var U=x.canonical,H=this.worldSize/this.zoomScale(U.z),$=U.x+Math.pow(2,U.z)*x.wrap,ht=k.identity(new Float64Array(16));return k.translate(ht,ht,[$*H,U.y*H,0]),k.scale(ht,ht,[H/k.EXTENT,H/k.EXTENT,1]),k.multiply(ht,C?this.alignedProjMatrix:this.projMatrix,ht),M[E]=new Float32Array(ht),M[E]},Ja.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ja.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var x,C,E,M,U=-90,H=90,$=-180,ht=180,Ut=this.size,ie=this._unmodified;if(this.latRange){var Be=this.latRange;U=k.mercatorYfromLat(Be[1])*this.worldSize,x=(H=k.mercatorYfromLat(Be[0])*this.worldSize)-U<Ut.y?Ut.y/(H-U):0}if(this.lngRange){var De=this.lngRange;$=k.mercatorXfromLng(De[0])*this.worldSize,C=(ht=k.mercatorXfromLng(De[1])*this.worldSize)-$<Ut.x?Ut.x/(ht-$):0}var Ne=this.point,fr=Math.max(C||0,x||0);if(fr)return this.center=this.unproject(new k.Point(C?(ht+$)/2:Ne.x,x?(H+U)/2:Ne.y)),this.zoom+=this.scaleZoom(fr),this._unmodified=ie,void(this._constraining=!1);if(this.latRange){var $e=Ne.y,_r=Ut.y/2;$e-_r<U&&(M=U+_r),$e+_r>H&&(M=H-_r)}if(this.lngRange){var er=Ne.x,Er=Ut.x/2;er-Er<$&&(E=$+Er),er+Er>ht&&(E=ht-Er)}E===void 0&&M===void 0||(this.center=this.unproject(new k.Point(E!==void 0?E:Ne.x,M!==void 0?M:Ne.y))),this._unmodified=ie,this._constraining=!1}},Ja.prototype._calcMatrices=function(){if(this.height){var x=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var C=Math.PI/2+this._pitch,E=this._fov*(.5+x.y/this.height),M=Math.sin(E)*this.cameraToCenterDistance/Math.sin(k.clamp(Math.PI-C-E,.01,Math.PI-.01)),U=this.point,H=U.x,$=U.y,ht=1.01*(Math.cos(Math.PI/2-this._pitch)*M+this.cameraToCenterDistance),Ut=this.height/50,ie=new Float64Array(16);k.perspective(ie,this._fov,this.width/this.height,Ut,ht),ie[8]=2*-x.x/this.width,ie[9]=2*x.y/this.height,k.scale(ie,ie,[1,-1,1]),k.translate(ie,ie,[0,0,-this.cameraToCenterDistance]),k.rotateX(ie,ie,this._pitch),k.rotateZ(ie,ie,this.angle),k.translate(ie,ie,[-H,-$,0]),this.mercatorMatrix=k.scale([],ie,[this.worldSize,this.worldSize,this.worldSize]),k.scale(ie,ie,[1,1,k.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ie,this.invProjMatrix=k.invert([],this.projMatrix);var Be=this.width%2/2,De=this.height%2/2,Ne=Math.cos(this.angle),fr=Math.sin(this.angle),$e=H-Math.round(H)+Ne*Be+fr*De,_r=$-Math.round($)+Ne*De+fr*Be,er=new Float64Array(ie);if(k.translate(er,er,[$e>.5?$e-1:$e,_r>.5?_r-1:_r,0]),this.alignedProjMatrix=er,ie=k.create(),k.scale(ie,ie,[this.width/2,-this.height/2,1]),k.translate(ie,ie,[1,-1,0]),this.labelPlaneMatrix=ie,ie=k.create(),k.scale(ie,ie,[1,-1,1]),k.translate(ie,ie,[-1,-1,0]),k.scale(ie,ie,[2/this.width,2/this.height,1]),this.glCoordMatrix=ie,this.pixelMatrix=k.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ie=k.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ie,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ja.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var x=this.pointCoordinate(new k.Point(0,0)),C=[x.x*this.worldSize,x.y*this.worldSize,0,1];return k.transformMat4(C,C,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ja.prototype.getCameraPoint=function(){var x=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new k.Point(0,x))},Ja.prototype.getCameraQueryGeometry=function(x){var C=this.getCameraPoint();if(x.length===1)return[x[0],C];for(var E=C.x,M=C.y,U=C.x,H=C.y,$=0,ht=x;$<ht.length;$+=1){var Ut=ht[$];E=Math.min(E,Ut.x),M=Math.min(M,Ut.y),U=Math.max(U,Ut.x),H=Math.max(H,Ut.y)}return[new k.Point(E,M),new k.Point(U,M),new k.Point(U,H),new k.Point(E,H),new k.Point(E,M)]},Object.defineProperties(Ja.prototype,Wo);var ro=function(x){var C,E,M,U;this._hashName=x&&encodeURIComponent(x),k.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(C=this._updateHashUnthrottled.bind(this),E=!1,M=null,U=function(){M=null,E&&(C(),M=setTimeout(U,300),E=!1)},function(){return E=!0,M||U(),M})};ro.prototype.addTo=function(x){return this._map=x,k.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ro.prototype.remove=function(){return k.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ro.prototype.getHashString=function(x){var C=this._map.getCenter(),E=Math.round(100*this._map.getZoom())/100,M=Math.ceil((E*Math.LN2+Math.log(512/360/.5))/Math.LN10),U=Math.pow(10,M),H=Math.round(C.lng*U)/U,$=Math.round(C.lat*U)/U,ht=this._map.getBearing(),Ut=this._map.getPitch(),ie="";if(ie+=x?"/"+H+"/"+$+"/"+E:E+"/"+$+"/"+H,(ht||Ut)&&(ie+="/"+Math.round(10*ht)/10),Ut&&(ie+="/"+Math.round(Ut)),this._hashName){var Be=this._hashName,De=!1,Ne=k.window.location.hash.slice(1).split("&").map(function(fr){var $e=fr.split("=")[0];return $e===Be?(De=!0,$e+"="+ie):fr}).filter(function(fr){return fr});return De||Ne.push(Be+"="+ie),"#"+Ne.join("&")}return"#"+ie},ro.prototype._getCurrentHash=function(){var x,C=this,E=k.window.location.hash.replace("#","");return this._hashName?(E.split("&").map(function(M){return M.split("=")}).forEach(function(M){M[0]===C._hashName&&(x=M)}),(x&&x[1]||"").split("/")):E.split("/")},ro.prototype._onHashChange=function(){var x=this._getCurrentHash();if(x.length>=3&&!x.some(function(E){return isNaN(E)})){var C=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(x[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+x[2],+x[1]],zoom:+x[0],bearing:C,pitch:+(x[4]||0)}),!0}return!1},ro.prototype._updateHashUnthrottled=function(){var x=k.window.location.href.replace(/(#.+)?$/,this.getHashString());try{k.window.history.replaceState(k.window.history.state,null,x)}catch(C){}};var Ap={linearity:.3,easing:k.bezier(0,0,.3,1)},Bl=k.extend({deceleration:2500,maxSpeed:1400},Ap),Tp=k.extend({deceleration:20,maxSpeed:1400},Ap),qv=k.extend({deceleration:1e3,maxSpeed:360},Ap),Ia=k.extend({deceleration:1e3,maxSpeed:90},Ap),Wf=function(x){this._map=x,this.clear()};function ef(x,C){(!x.duration||x.duration<C.duration)&&(x.duration=C.duration,x.easing=C.easing)}function _f(x,C,E){var M=E.maxSpeed,U=E.linearity,H=E.deceleration,$=k.clamp(x*U/(C/1e3),-M,M),ht=Math.abs($)/(H*U);return{easing:E.easing,duration:1e3*ht,amount:$*(ht/2)}}Wf.prototype.clear=function(){this._inertiaBuffer=[]},Wf.prototype.record=function(x){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:k.browser.now(),settings:x})},Wf.prototype._drainInertiaBuffer=function(){for(var x=this._inertiaBuffer,C=k.browser.now();x.length>0&&C-x[0].time>160;)x.shift()},Wf.prototype._onMoveEnd=function(x){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var C={zoom:0,bearing:0,pitch:0,pan:new k.Point(0,0),pinchAround:void 0,around:void 0},E=0,M=this._inertiaBuffer;E<M.length;E+=1){var U=M[E].settings;C.zoom+=U.zoomDelta||0,C.bearing+=U.bearingDelta||0,C.pitch+=U.pitchDelta||0,U.panDelta&&C.pan._add(U.panDelta),U.around&&(C.around=U.around),U.pinchAround&&(C.pinchAround=U.pinchAround)}var H=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,$={};if(C.pan.mag()){var ht=_f(C.pan.mag(),H,k.extend({},Bl,x||{}));$.offset=C.pan.mult(ht.amount/C.pan.mag()),$.center=this._map.transform.center,ef($,ht)}if(C.zoom){var Ut=_f(C.zoom,H,Tp);$.zoom=this._map.transform.zoom+Ut.amount,ef($,Ut)}if(C.bearing){var ie=_f(C.bearing,H,qv);$.bearing=this._map.transform.bearing+k.clamp(ie.amount,-179,179),ef($,ie)}if(C.pitch){var Be=_f(C.pitch,H,Ia);$.pitch=this._map.transform.pitch+Be.amount,ef($,Be)}if($.zoom||$.bearing){var De=C.pinchAround===void 0?C.around:C.pinchAround;$.around=De?this._map.unproject(De):this._map.getCenter()}return this.clear(),k.extend($,{noMoveStart:!0})}};var tu=function(x){function C(M,U,H,$){$===void 0&&($={});var ht=K.mousePos(U.getCanvasContainer(),H),Ut=U.unproject(ht);x.call(this,M,k.extend({point:ht,lngLat:Ut,originalEvent:H},$)),this._defaultPrevented=!1,this.target=U}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var E={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},E.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,E),C}(k.Event),dh=function(x){function C(M,U,H){var $=M==="touchend"?H.changedTouches:H.touches,ht=K.touchPos(U.getCanvasContainer(),$),Ut=ht.map(function(De){return U.unproject(De)}),ie=ht.reduce(function(De,Ne,fr,$e){return De.add(Ne.div($e.length))},new k.Point(0,0)),Be=U.unproject(ie);x.call(this,M,{points:ht,point:ie,lngLats:Ut,lngLat:Be,originalEvent:H}),this._defaultPrevented=!1}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var E={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},E.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,E),C}(k.Event),vh=function(x){function C(M,U,H){x.call(this,M,{originalEvent:H}),this._defaultPrevented=!1}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var E={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},E.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,E),C}(k.Event),Fs=function(x,C){this._map=x,this._clickTolerance=C.clickTolerance};Fs.prototype.reset=function(){delete this._mousedownPos},Fs.prototype.wheel=function(x){return this._firePreventable(new vh(x.type,this._map,x))},Fs.prototype.mousedown=function(x,C){return this._mousedownPos=C,this._firePreventable(new tu(x.type,this._map,x))},Fs.prototype.mouseup=function(x){this._map.fire(new tu(x.type,this._map,x))},Fs.prototype.click=function(x,C){this._mousedownPos&&this._mousedownPos.dist(C)>=this._clickTolerance||this._map.fire(new tu(x.type,this._map,x))},Fs.prototype.dblclick=function(x){return this._firePreventable(new tu(x.type,this._map,x))},Fs.prototype.mouseover=function(x){this._map.fire(new tu(x.type,this._map,x))},Fs.prototype.mouseout=function(x){this._map.fire(new tu(x.type,this._map,x))},Fs.prototype.touchstart=function(x){return this._firePreventable(new dh(x.type,this._map,x))},Fs.prototype.touchmove=function(x){this._map.fire(new dh(x.type,this._map,x))},Fs.prototype.touchend=function(x){this._map.fire(new dh(x.type,this._map,x))},Fs.prototype.touchcancel=function(x){this._map.fire(new dh(x.type,this._map,x))},Fs.prototype._firePreventable=function(x){if(this._map.fire(x),x.defaultPrevented)return{}},Fs.prototype.isEnabled=function(){return!0},Fs.prototype.isActive=function(){return!1},Fs.prototype.enable=function(){},Fs.prototype.disable=function(){};var ji=function(x){this._map=x};ji.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ji.prototype.mousemove=function(x){this._map.fire(new tu(x.type,this._map,x))},ji.prototype.mousedown=function(){this._delayContextMenu=!0},ji.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new tu("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ji.prototype.contextmenu=function(x){this._delayContextMenu?this._contextMenuEvent=x:this._map.fire(new tu(x.type,this._map,x)),this._map.listens("contextmenu")&&x.preventDefault()},ji.prototype.isEnabled=function(){return!0},ji.prototype.isActive=function(){return!1},ji.prototype.enable=function(){},ji.prototype.disable=function(){};var _s=function(x,C){this._map=x,this._el=x.getCanvasContainer(),this._container=x.getContainer(),this._clickTolerance=C.clickTolerance||1};function El(x,C){for(var E={},M=0;M<x.length;M++)E[x[M].identifier]=C[M];return E}_s.prototype.isEnabled=function(){return!!this._enabled},_s.prototype.isActive=function(){return!!this._active},_s.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},_s.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},_s.prototype.mousedown=function(x,C){this.isEnabled()&&x.shiftKey&&x.button===0&&(K.disableDrag(),this._startPos=this._lastPos=C,this._active=!0)},_s.prototype.mousemoveWindow=function(x,C){if(this._active){var E=C;if(!(this._lastPos.equals(E)||!this._box&&E.dist(this._startPos)<this._clickTolerance)){var M=this._startPos;this._lastPos=E,this._box||(this._box=K.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",x));var U=Math.min(M.x,E.x),H=Math.max(M.x,E.x),$=Math.min(M.y,E.y),ht=Math.max(M.y,E.y);K.setTransform(this._box,"translate("+U+"px,"+$+"px)"),this._box.style.width=H-U+"px",this._box.style.height=ht-$+"px"}}},_s.prototype.mouseupWindow=function(x,C){var E=this;if(this._active&&x.button===0){var M=this._startPos,U=C;if(this.reset(),K.suppressClick(),M.x!==U.x||M.y!==U.y)return this._map.fire(new k.Event("boxzoomend",{originalEvent:x})),{cameraAnimation:function(H){return H.fitScreenCoordinates(M,U,E._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",x)}},_s.prototype.keydown=function(x){this._active&&x.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",x))},_s.prototype.blur=function(){this.reset()},_s.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(K.remove(this._box),this._box=null),K.enableDrag(),delete this._startPos,delete this._lastPos},_s.prototype._fireEvent=function(x,C){return this._map.fire(new k.Event(x,{originalEvent:C}))};var Nl=function(x){this.reset(),this.numTouches=x.numTouches};Nl.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Nl.prototype.touchstart=function(x,C,E){(this.centroid||E.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=x.timeStamp),E.length===this.numTouches&&(this.centroid=function(M){for(var U=new k.Point(0,0),H=0,$=M;H<$.length;H+=1)U._add($[H]);return U.div(M.length)}(C),this.touches=El(E,C)))},Nl.prototype.touchmove=function(x,C,E){if(!this.aborted&&this.centroid){var M=El(E,C);for(var U in this.touches){var H=M[U];(!H||H.dist(this.touches[U])>30)&&(this.aborted=!0)}}},Nl.prototype.touchend=function(x,C,E){if((!this.centroid||x.timeStamp-this.startTime>500)&&(this.aborted=!0),E.length===0){var M=!this.aborted&&this.centroid;if(this.reset(),M)return M}};var vc=function(x){this.singleTap=new Nl(x),this.numTaps=x.numTaps,this.reset()};vc.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},vc.prototype.touchstart=function(x,C,E){this.singleTap.touchstart(x,C,E)},vc.prototype.touchmove=function(x,C,E){this.singleTap.touchmove(x,C,E)},vc.prototype.touchend=function(x,C,E){var M=this.singleTap.touchend(x,C,E);if(M){var U=x.timeStamp-this.lastTime<500,H=!this.lastTap||this.lastTap.dist(M)<30;if(U&&H||this.reset(),this.count++,this.lastTime=x.timeStamp,this.lastTap=M,this.count===this.numTaps)return this.reset(),M}};var Zu=function(){this._zoomIn=new vc({numTouches:1,numTaps:2}),this._zoomOut=new vc({numTouches:2,numTaps:1}),this.reset()};Zu.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Zu.prototype.touchstart=function(x,C,E){this._zoomIn.touchstart(x,C,E),this._zoomOut.touchstart(x,C,E)},Zu.prototype.touchmove=function(x,C,E){this._zoomIn.touchmove(x,C,E),this._zoomOut.touchmove(x,C,E)},Zu.prototype.touchend=function(x,C,E){var M=this,U=this._zoomIn.touchend(x,C,E),H=this._zoomOut.touchend(x,C,E);return U?(this._active=!0,x.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function($){return $.easeTo({duration:300,zoom:$.getZoom()+1,around:$.unproject(U)},{originalEvent:x})}}):H?(this._active=!0,x.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function($){return $.easeTo({duration:300,zoom:$.getZoom()-1,around:$.unproject(H)},{originalEvent:x})}}):void 0},Zu.prototype.touchcancel=function(){this.reset()},Zu.prototype.enable=function(){this._enabled=!0},Zu.prototype.disable=function(){this._enabled=!1,this.reset()},Zu.prototype.isEnabled=function(){return this._enabled},Zu.prototype.isActive=function(){return this._active};var sd={0:1,2:2},Ti=function(x){this.reset(),this._clickTolerance=x.clickTolerance||1};Ti.prototype.blur=function(){this.reset()},Ti.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ti.prototype._correctButton=function(x,C){return!1},Ti.prototype._move=function(x,C){return{}},Ti.prototype.mousedown=function(x,C){if(!this._lastPoint){var E=K.mouseButton(x);this._correctButton(x,E)&&(this._lastPoint=C,this._eventButton=E)}},Ti.prototype.mousemoveWindow=function(x,C){var E=this._lastPoint;if(E){if(x.preventDefault(),function(M,U){var H=sd[U];return M.buttons===void 0||(M.buttons&H)!==H}(x,this._eventButton))this.reset();else if(this._moved||!(C.dist(E)<this._clickTolerance))return this._moved=!0,this._lastPoint=C,this._move(E,C)}},Ti.prototype.mouseupWindow=function(x){this._lastPoint&&K.mouseButton(x)===this._eventButton&&(this._moved&&K.suppressClick(),this.reset())},Ti.prototype.enable=function(){this._enabled=!0},Ti.prototype.disable=function(){this._enabled=!1,this.reset()},Ti.prototype.isEnabled=function(){return this._enabled},Ti.prototype.isActive=function(){return this._active};var Xf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.mousedown=function(E,M){x.prototype.mousedown.call(this,E,M),this._lastPoint&&(this._active=!0)},C.prototype._correctButton=function(E,M){return M===0&&!E.ctrlKey},C.prototype._move=function(E,M){return{around:M,panDelta:M.sub(E)}},C}(Ti),gh=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype._correctButton=function(E,M){return M===0&&E.ctrlKey||M===2},C.prototype._move=function(E,M){var U=.8*(M.x-E.x);if(U)return this._active=!0,{bearingDelta:U}},C.prototype.contextmenu=function(E){E.preventDefault()},C}(Ti),rf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype._correctButton=function(E,M){return M===0&&E.ctrlKey||M===2},C.prototype._move=function(E,M){var U=-.5*(M.y-E.y);if(U)return this._active=!0,{pitchDelta:U}},C.prototype.contextmenu=function(E){E.preventDefault()},C}(Ti),es=function(x){this._minTouches=1,this._clickTolerance=x.clickTolerance||1,this.reset()};es.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new k.Point(0,0)},es.prototype.touchstart=function(x,C,E){return this._calculateTransform(x,C,E)},es.prototype.touchmove=function(x,C,E){if(this._active&&!(E.length<this._minTouches))return x.preventDefault(),this._calculateTransform(x,C,E)},es.prototype.touchend=function(x,C,E){this._calculateTransform(x,C,E),this._active&&E.length<this._minTouches&&this.reset()},es.prototype.touchcancel=function(){this.reset()},es.prototype._calculateTransform=function(x,C,E){E.length>0&&(this._active=!0);var M=El(E,C),U=new k.Point(0,0),H=new k.Point(0,0),$=0;for(var ht in M){var Ut=M[ht],ie=this._touches[ht];ie&&(U._add(Ut),H._add(Ut.sub(ie)),$++,M[ht]=Ut)}if(this._touches=M,!($<this._minTouches)&&H.mag()){var Be=H.div($);if(this._sum._add(Be),!(this._sum.mag()<this._clickTolerance))return{around:U.div($),panDelta:Be}}},es.prototype.enable=function(){this._enabled=!0},es.prototype.disable=function(){this._enabled=!1,this.reset()},es.prototype.isEnabled=function(){return this._enabled},es.prototype.isActive=function(){return this._active};var wu=function(){this.reset()};function xf(x,C,E){for(var M=0;M<x.length;M++)if(x[M].identifier===E)return C[M]}function wl(x,C){return Math.log(x/C)/Math.LN2}wu.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},wu.prototype._start=function(x){},wu.prototype._move=function(x,C,E){return{}},wu.prototype.touchstart=function(x,C,E){this._firstTwoTouches||E.length<2||(this._firstTwoTouches=[E[0].identifier,E[1].identifier],this._start([C[0],C[1]]))},wu.prototype.touchmove=function(x,C,E){if(this._firstTwoTouches){x.preventDefault();var M=this._firstTwoTouches,U=M[1],H=xf(E,C,M[0]),$=xf(E,C,U);if(H&&$){var ht=this._aroundCenter?null:H.add($).div(2);return this._move([H,$],ht,x)}}},wu.prototype.touchend=function(x,C,E){if(this._firstTwoTouches){var M=this._firstTwoTouches,U=M[1],H=xf(E,C,M[0]),$=xf(E,C,U);H&&$||(this._active&&K.suppressClick(),this.reset())}},wu.prototype.touchcancel=function(){this.reset()},wu.prototype.enable=function(x){this._enabled=!0,this._aroundCenter=!!x&&x.around==="center"},wu.prototype.disable=function(){this._enabled=!1,this.reset()},wu.prototype.isEnabled=function(){return this._enabled},wu.prototype.isActive=function(){return this._active};var eu=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),delete this._distance,delete this._startDistance},C.prototype._start=function(E){this._startDistance=this._distance=E[0].dist(E[1])},C.prototype._move=function(E,M){var U=this._distance;if(this._distance=E[0].dist(E[1]),this._active||!(Math.abs(wl(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:wl(this._distance,U),pinchAround:M}},C}(wu);function nl(x,C){return 180*x.angleWith(C)/Math.PI}var Kv=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},C.prototype._start=function(E){this._startVector=this._vector=E[0].sub(E[1]),this._minDiameter=E[0].dist(E[1])},C.prototype._move=function(E,M){var U=this._vector;if(this._vector=E[0].sub(E[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:nl(this._vector,U),pinchAround:M}},C.prototype._isBelowThreshold=function(E){this._minDiameter=Math.min(this._minDiameter,E.mag());var M=25/(Math.PI*this._minDiameter)*360,U=nl(E,this._startVector);return Math.abs(U)<M},C}(wu);function Vh(x){return Math.abs(x.y)>Math.abs(x.x)}var bf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},C.prototype._start=function(E){this._lastPoints=E,Vh(E[0].sub(E[1]))&&(this._valid=!1)},C.prototype._move=function(E,M,U){var H=E[0].sub(this._lastPoints[0]),$=E[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(H,$,U.timeStamp),this._valid)return this._lastPoints=E,this._active=!0,{pitchDelta:(H.y+$.y)/2*-.5}},C.prototype.gestureBeginsVertically=function(E,M,U){if(this._valid!==void 0)return this._valid;var H=E.mag()>=2,$=M.mag()>=2;if(H||$){if(!H||!$)return this._firstMove===void 0&&(this._firstMove=U),U-this._firstMove<100&&void 0;var ht=E.y>0==M.y>0;return Vh(E)&&Vh(M)&&ht}},C}(wu),ev={panStep:100,bearingStep:15,pitchStep:10},nc=function(){var x=ev;this._panStep=x.panStep,this._bearingStep=x.bearingStep,this._pitchStep=x.pitchStep,this._rotationDisabled=!1};function dl(x){return x*(2-x)}nc.prototype.blur=function(){this.reset()},nc.prototype.reset=function(){this._active=!1},nc.prototype.keydown=function(x){var C=this;if(!(x.altKey||x.ctrlKey||x.metaKey)){var E=0,M=0,U=0,H=0,$=0;switch(x.keyCode){case 61:case 107:case 171:case 187:E=1;break;case 189:case 109:case 173:E=-1;break;case 37:x.shiftKey?M=-1:(x.preventDefault(),H=-1);break;case 39:x.shiftKey?M=1:(x.preventDefault(),H=1);break;case 38:x.shiftKey?U=1:(x.preventDefault(),$=-1);break;case 40:x.shiftKey?U=-1:(x.preventDefault(),$=1);break;default:return}return this._rotationDisabled&&(M=0,U=0),{cameraAnimation:function(ht){var Ut=ht.getZoom();ht.easeTo({duration:300,easeId:"keyboardHandler",easing:dl,zoom:E?Math.round(Ut)+E*(x.shiftKey?2:1):Ut,bearing:ht.getBearing()+M*C._bearingStep,pitch:ht.getPitch()+U*C._pitchStep,offset:[-H*C._panStep,-$*C._panStep],center:ht.getCenter()},{originalEvent:x})}}}},nc.prototype.enable=function(){this._enabled=!0},nc.prototype.disable=function(){this._enabled=!1,this.reset()},nc.prototype.isEnabled=function(){return this._enabled},nc.prototype.isActive=function(){return this._active},nc.prototype.disableRotation=function(){this._rotationDisabled=!0},nc.prototype.enableRotation=function(){this._rotationDisabled=!1};var to=function(x,C){this._map=x,this._el=x.getCanvasContainer(),this._handler=C,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,k.bindAll(["_onTimeout"],this)};to.prototype.setZoomRate=function(x){this._defaultZoomRate=x},to.prototype.setWheelZoomRate=function(x){this._wheelZoomRate=x},to.prototype.isEnabled=function(){return!!this._enabled},to.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},to.prototype.isZooming=function(){return!!this._zooming},to.prototype.enable=function(x){this.isEnabled()||(this._enabled=!0,this._aroundCenter=x&&x.around==="center")},to.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},to.prototype.wheel=function(x){if(this.isEnabled()){var C=x.deltaMode===k.window.WheelEvent.DOM_DELTA_LINE?40*x.deltaY:x.deltaY,E=k.browser.now(),M=E-(this._lastWheelEventTime||0);this._lastWheelEventTime=E,C!==0&&C%4.000244140625==0?this._type="wheel":C!==0&&Math.abs(C)<4?this._type="trackpad":M>400?(this._type=null,this._lastValue=C,this._timeout=setTimeout(this._onTimeout,40,x)):this._type||(this._type=Math.abs(M*C)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,C+=this._lastValue)),x.shiftKey&&C&&(C/=4),this._type&&(this._lastWheelEvent=x,this._delta-=C,this._active||this._start(x)),x.preventDefault()}},to.prototype._onTimeout=function(x){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(x)},to.prototype._start=function(x){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var C=K.mousePos(this._el,x);this._around=k.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(C)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},to.prototype.renderFrame=function(){var x=this;if(this._frameId&&(this._frameId=null,this.isActive())){var C=this._map.transform;if(this._delta!==0){var E=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,M=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&M!==0&&(M=1/M);var U=typeof this._targetZoom=="number"?C.zoomScale(this._targetZoom):C.scale;this._targetZoom=Math.min(C.maxZoom,Math.max(C.minZoom,C.scaleZoom(U*M))),this._type==="wheel"&&(this._startZoom=C.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var H,$=typeof this._targetZoom=="number"?this._targetZoom:C.zoom,ht=this._startZoom,Ut=this._easing,ie=!1;if(this._type==="wheel"&&ht&&Ut){var Be=Math.min((k.browser.now()-this._lastWheelEventTime)/200,1),De=Ut(Be);H=k.number(ht,$,De),Be<1?this._frameId||(this._frameId=!0):ie=!0}else H=$,ie=!0;return this._active=!0,ie&&(this._active=!1,this._finishTimeout=setTimeout(function(){x._zooming=!1,x._handler._triggerRenderFrame(),delete x._targetZoom,delete x._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ie,zoomDelta:H-C.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},to.prototype._smoothOutEasing=function(x){var C=k.ease;if(this._prevEase){var E=this._prevEase,M=(k.browser.now()-E.start)/E.duration,U=E.easing(M+.01)-E.easing(M),H=.27/Math.sqrt(U*U+1e-4)*.01,$=Math.sqrt(.0729-H*H);C=k.bezier(H,$,.25,1)}return this._prevEase={start:k.browser.now(),duration:x,easing:C},C},to.prototype.blur=function(){this.reset()},to.prototype.reset=function(){this._active=!1};var mo=function(x,C){this._clickZoom=x,this._tapZoom=C};mo.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},mo.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},mo.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},mo.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ic=function(){this.reset()};ic.prototype.reset=function(){this._active=!1},ic.prototype.blur=function(){this.reset()},ic.prototype.dblclick=function(x,C){return x.preventDefault(),{cameraAnimation:function(E){E.easeTo({duration:300,zoom:E.getZoom()+(x.shiftKey?-1:1),around:E.unproject(C)},{originalEvent:x})}}},ic.prototype.enable=function(){this._enabled=!0},ic.prototype.disable=function(){this._enabled=!1,this.reset()},ic.prototype.isEnabled=function(){return this._enabled},ic.prototype.isActive=function(){return this._active};var Xs=function(){this._tap=new vc({numTouches:1,numTaps:1}),this.reset()};Xs.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Xs.prototype.touchstart=function(x,C,E){this._swipePoint||(this._tapTime&&x.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?E.length>0&&(this._swipePoint=C[0],this._swipeTouch=E[0].identifier):this._tap.touchstart(x,C,E))},Xs.prototype.touchmove=function(x,C,E){if(this._tapTime){if(this._swipePoint){if(E[0].identifier!==this._swipeTouch)return;var M=C[0],U=M.y-this._swipePoint.y;return this._swipePoint=M,x.preventDefault(),this._active=!0,{zoomDelta:U/128}}}else this._tap.touchmove(x,C,E)},Xs.prototype.touchend=function(x,C,E){this._tapTime?this._swipePoint&&E.length===0&&this.reset():this._tap.touchend(x,C,E)&&(this._tapTime=x.timeStamp)},Xs.prototype.touchcancel=function(){this.reset()},Xs.prototype.enable=function(){this._enabled=!0},Xs.prototype.disable=function(){this._enabled=!1,this.reset()},Xs.prototype.isEnabled=function(){return this._enabled},Xs.prototype.isActive=function(){return this._active};var Yf=function(x,C,E){this._el=x,this._mousePan=C,this._touchPan=E};Yf.prototype.enable=function(x){this._inertiaOptions=x||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},Yf.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},Yf.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},Yf.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var nf=function(x,C,E){this._pitchWithRotate=x.pitchWithRotate,this._mouseRotate=C,this._mousePitch=E};nf.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},nf.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},nf.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},nf.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Su=function(x,C,E,M){this._el=x,this._touchZoom=C,this._touchRotate=E,this._tapDragZoom=M,this._rotationDisabled=!1,this._enabled=!0};Su.prototype.enable=function(x){this._touchZoom.enable(x),this._rotationDisabled||this._touchRotate.enable(x),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Su.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Su.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Su.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Su.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Su.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var fu=function(x){return x.zoom||x.drag||x.pitch||x.rotate},Sl=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C}(k.Event);function Qi(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}var ki=function(x,C){this._map=x,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Wf(x),this._bearingSnap=C.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(C),k.bindAll(["handleEvent","handleWindowEvent"],this);var E=this._el;this._listeners=[[E,"touchstart",{passive:!0}],[E,"touchmove",{passive:!1}],[E,"touchend",void 0],[E,"touchcancel",void 0],[E,"mousedown",void 0],[E,"mousemove",void 0],[E,"mouseup",void 0],[k.window.document,"mousemove",{capture:!0}],[k.window.document,"mouseup",void 0],[E,"mouseover",void 0],[E,"mouseout",void 0],[E,"dblclick",void 0],[E,"click",void 0],[E,"keydown",{capture:!1}],[E,"keyup",void 0],[E,"wheel",{passive:!1}],[E,"contextmenu",void 0],[k.window,"blur",void 0]];for(var M=0,U=this._listeners;M<U.length;M+=1){var H=U[M],$=H[0];K.addEventListener($,H[1],$===k.window.document?this.handleWindowEvent:this.handleEvent,H[2])}};ki.prototype.destroy=function(){for(var x=0,C=this._listeners;x<C.length;x+=1){var E=C[x],M=E[0];K.removeEventListener(M,E[1],M===k.window.document?this.handleWindowEvent:this.handleEvent,E[2])}},ki.prototype._addDefaultHandlers=function(x){var C=this._map,E=C.getCanvasContainer();this._add("mapEvent",new Fs(C,x));var M=C.boxZoom=new _s(C,x);this._add("boxZoom",M);var U=new Zu,H=new ic;C.doubleClickZoom=new mo(H,U),this._add("tapZoom",U),this._add("clickZoom",H);var $=new Xs;this._add("tapDragZoom",$);var ht=C.touchPitch=new bf;this._add("touchPitch",ht);var Ut=new gh(x),ie=new rf(x);C.dragRotate=new nf(x,Ut,ie),this._add("mouseRotate",Ut,["mousePitch"]),this._add("mousePitch",ie,["mouseRotate"]);var Be=new Xf(x),De=new es(x);C.dragPan=new Yf(E,Be,De),this._add("mousePan",Be),this._add("touchPan",De,["touchZoom","touchRotate"]);var Ne=new Kv,fr=new eu;C.touchZoomRotate=new Su(E,fr,Ne,$),this._add("touchRotate",Ne,["touchPan","touchZoom"]),this._add("touchZoom",fr,["touchPan","touchRotate"]);var $e=C.scrollZoom=new to(C,this);this._add("scrollZoom",$e,["mousePan"]);var _r=C.keyboard=new nc;this._add("keyboard",_r),this._add("blockableMapEvent",new ji(C));for(var er=0,Er=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];er<Er.length;er+=1){var Or=Er[er];x.interactive&&x[Or]&&C[Or].enable(x[Or])}},ki.prototype._add=function(x,C,E){this._handlers.push({handlerName:x,handler:C,allowed:E}),this._handlersById[x]=C},ki.prototype.stop=function(x){if(!this._updatingCamera){for(var C=0,E=this._handlers;C<E.length;C+=1)E[C].handler.reset();this._inertia.clear(),this._fireEvents({},{},x),this._changes=[]}},ki.prototype.isActive=function(){for(var x=0,C=this._handlers;x<C.length;x+=1)if(C[x].handler.isActive())return!0;return!1},ki.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},ki.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},ki.prototype.isMoving=function(){return Boolean(fu(this._eventsInProgress))||this.isZooming()},ki.prototype._blockedByActive=function(x,C,E){for(var M in x)if(M!==E&&(!C||C.indexOf(M)<0))return!0;return!1},ki.prototype.handleWindowEvent=function(x){this.handleEvent(x,x.type+"Window")},ki.prototype._getMapTouches=function(x){for(var C=[],E=0,M=x;E<M.length;E+=1){var U=M[E];this._el.contains(U.target)&&C.push(U)}return C},ki.prototype.handleEvent=function(x,C){this._updatingCamera=!0;for(var E=x.type==="renderFrame"?void 0:x,M={needsRenderFrame:!1},U={},H={},$=x.touches?this._getMapTouches(x.touches):void 0,ht=$?K.touchPos(this._el,$):K.mousePos(this._el,x),Ut=0,ie=this._handlers;Ut<ie.length;Ut+=1){var Be=ie[Ut],De=Be.handlerName,Ne=Be.handler,fr=Be.allowed;if(Ne.isEnabled()){var $e=void 0;this._blockedByActive(H,fr,De)?Ne.reset():Ne[C||x.type]&&($e=Ne[C||x.type](x,ht,$),this.mergeHandlerResult(M,U,$e,De,E),$e&&$e.needsRenderFrame&&this._triggerRenderFrame()),($e||Ne.isActive())&&(H[De]=Ne)}}var _r={};for(var er in this._previousActiveHandlers)H[er]||(_r[er]=E);this._previousActiveHandlers=H,(Object.keys(_r).length||Qi(M))&&(this._changes.push([M,U,_r]),this._triggerRenderFrame()),(Object.keys(H).length||Qi(M))&&this._map._stop(!0),this._updatingCamera=!1;var Er=M.cameraAnimation;Er&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Er(this._map))},ki.prototype.mergeHandlerResult=function(x,C,E,M,U){if(E){k.extend(x,E);var H={handlerName:M,originalEvent:E.originalEvent||U};E.zoomDelta!==void 0&&(C.zoom=H),E.panDelta!==void 0&&(C.drag=H),E.pitchDelta!==void 0&&(C.pitch=H),E.bearingDelta!==void 0&&(C.rotate=H)}},ki.prototype._applyChanges=function(){for(var x={},C={},E={},M=0,U=this._changes;M<U.length;M+=1){var H=U[M],$=H[0],ht=H[1],Ut=H[2];$.panDelta&&(x.panDelta=(x.panDelta||new k.Point(0,0))._add($.panDelta)),$.zoomDelta&&(x.zoomDelta=(x.zoomDelta||0)+$.zoomDelta),$.bearingDelta&&(x.bearingDelta=(x.bearingDelta||0)+$.bearingDelta),$.pitchDelta&&(x.pitchDelta=(x.pitchDelta||0)+$.pitchDelta),$.around!==void 0&&(x.around=$.around),$.pinchAround!==void 0&&(x.pinchAround=$.pinchAround),$.noInertia&&(x.noInertia=$.noInertia),k.extend(C,ht),k.extend(E,Ut)}this._updateMapTransform(x,C,E),this._changes=[]},ki.prototype._updateMapTransform=function(x,C,E){var M=this._map,U=M.transform;if(!Qi(x))return this._fireEvents(C,E,!0);var H=x.panDelta,$=x.zoomDelta,ht=x.bearingDelta,Ut=x.pitchDelta,ie=x.around,Be=x.pinchAround;Be!==void 0&&(ie=Be),M._stop(!0),ie=ie||M.transform.centerPoint;var De=U.pointLocation(H?ie.sub(H):ie);ht&&(U.bearing+=ht),Ut&&(U.pitch+=Ut),$&&(U.zoom+=$),U.setLocationAtPoint(De,ie),this._map._update(),x.noInertia||this._inertia.record(x),this._fireEvents(C,E,!0)},ki.prototype._fireEvents=function(x,C,E){var M=this,U=fu(this._eventsInProgress),H=fu(x),$={};for(var ht in x)this._eventsInProgress[ht]||($[ht+"start"]=x[ht].originalEvent),this._eventsInProgress[ht]=x[ht];for(var Ut in!U&&H&&this._fireEvent("movestart",H.originalEvent),$)this._fireEvent(Ut,$[Ut]);for(var ie in H&&this._fireEvent("move",H.originalEvent),x)this._fireEvent(ie,x[ie].originalEvent);var Be,De={};for(var Ne in this._eventsInProgress){var fr=this._eventsInProgress[Ne],$e=fr.handlerName,_r=fr.originalEvent;this._handlersById[$e].isActive()||(delete this._eventsInProgress[Ne],De[Ne+"end"]=Be=C[$e]||_r)}for(var er in De)this._fireEvent(er,De[er]);var Er=fu(this._eventsInProgress);if(E&&(U||H)&&!Er){this._updatingCamera=!0;var Or=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Yr=function(gn){return gn!==0&&-M._bearingSnap<gn&&gn<M._bearingSnap};Or?(Yr(Or.bearing||this._map.getBearing())&&(Or.bearing=0),this._map.easeTo(Or,{originalEvent:Be})):(this._map.fire(new k.Event("moveend",{originalEvent:Be})),Yr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},ki.prototype._fireEvent=function(x,C){this._map.fire(new k.Event(x,C?{originalEvent:C}:{}))},ki.prototype._requestFrame=function(){var x=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(C){delete x._frameId,x.handleEvent(new Sl("renderFrame",{timeStamp:C})),x._applyChanges()})},ki.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Ef=function(x){function C(E,M){x.call(this),this._moving=!1,this._zooming=!1,this.transform=E,this._bearingSnap=M.bearingSnap,k.bindAll(["_renderFrameCallback"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getCenter=function(){return new k.LngLat(this.transform.center.lng,this.transform.center.lat)},C.prototype.setCenter=function(E,M){return this.jumpTo({center:E},M)},C.prototype.panBy=function(E,M,U){return E=k.Point.convert(E).mult(-1),this.panTo(this.transform.center,k.extend({offset:E},M),U)},C.prototype.panTo=function(E,M,U){return this.easeTo(k.extend({center:E},M),U)},C.prototype.getZoom=function(){return this.transform.zoom},C.prototype.setZoom=function(E,M){return this.jumpTo({zoom:E},M),this},C.prototype.zoomTo=function(E,M,U){return this.easeTo(k.extend({zoom:E},M),U)},C.prototype.zoomIn=function(E,M){return this.zoomTo(this.getZoom()+1,E,M),this},C.prototype.zoomOut=function(E,M){return this.zoomTo(this.getZoom()-1,E,M),this},C.prototype.getBearing=function(){return this.transform.bearing},C.prototype.setBearing=function(E,M){return this.jumpTo({bearing:E},M),this},C.prototype.getPadding=function(){return this.transform.padding},C.prototype.setPadding=function(E,M){return this.jumpTo({padding:E},M),this},C.prototype.rotateTo=function(E,M,U){return this.easeTo(k.extend({bearing:E},M),U)},C.prototype.resetNorth=function(E,M){return this.rotateTo(0,k.extend({duration:1e3},E),M),this},C.prototype.resetNorthPitch=function(E,M){return this.easeTo(k.extend({bearing:0,pitch:0,duration:1e3},E),M),this},C.prototype.snapToNorth=function(E,M){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(E,M):this},C.prototype.getPitch=function(){return this.transform.pitch},C.prototype.setPitch=function(E,M){return this.jumpTo({pitch:E},M),this},C.prototype.cameraForBounds=function(E,M){E=k.LngLatBounds.convert(E);var U=M&&M.bearing||0;return this._cameraForBoxAndBearing(E.getNorthWest(),E.getSouthEast(),U,M)},C.prototype._cameraForBoxAndBearing=function(E,M,U,H){var $={top:0,bottom:0,right:0,left:0};if(typeof(H=k.extend({padding:$,offset:[0,0],maxZoom:this.transform.maxZoom},H)).padding=="number"){var ht=H.padding;H.padding={top:ht,bottom:ht,right:ht,left:ht}}H.padding=k.extend($,H.padding);var Ut=this.transform,ie=Ut.padding,Be=Ut.project(k.LngLat.convert(E)),De=Ut.project(k.LngLat.convert(M)),Ne=Be.rotate(-U*Math.PI/180),fr=De.rotate(-U*Math.PI/180),$e=new k.Point(Math.max(Ne.x,fr.x),Math.max(Ne.y,fr.y)),_r=new k.Point(Math.min(Ne.x,fr.x),Math.min(Ne.y,fr.y)),er=$e.sub(_r),Er=(Ut.width-(ie.left+ie.right+H.padding.left+H.padding.right))/er.x,Or=(Ut.height-(ie.top+ie.bottom+H.padding.top+H.padding.bottom))/er.y;if(!(Or<0||Er<0)){var Yr=Math.min(Ut.scaleZoom(Ut.scale*Math.min(Er,Or)),H.maxZoom),gn=typeof H.offset.x=="number"?new k.Point(H.offset.x,H.offset.y):k.Point.convert(H.offset),vn=new k.Point((H.padding.left-H.padding.right)/2,(H.padding.top-H.padding.bottom)/2).rotate(U*Math.PI/180),_n=gn.add(vn).mult(Ut.scale/Ut.zoomScale(Yr));return{center:Ut.unproject(Be.add(De).div(2).sub(_n)),zoom:Yr,bearing:U}}k.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},C.prototype.fitBounds=function(E,M,U){return this._fitInternal(this.cameraForBounds(E,M),M,U)},C.prototype.fitScreenCoordinates=function(E,M,U,H,$){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(k.Point.convert(E)),this.transform.pointLocation(k.Point.convert(M)),U,H),H,$)},C.prototype._fitInternal=function(E,M,U){return E?(delete(M=k.extend(E,M)).padding,M.linear?this.easeTo(M,U):this.flyTo(M,U)):this},C.prototype.jumpTo=function(E,M){this.stop();var U=this.transform,H=!1,$=!1,ht=!1;return"zoom"in E&&U.zoom!==+E.zoom&&(H=!0,U.zoom=+E.zoom),E.center!==void 0&&(U.center=k.LngLat.convert(E.center)),"bearing"in E&&U.bearing!==+E.bearing&&($=!0,U.bearing=+E.bearing),"pitch"in E&&U.pitch!==+E.pitch&&(ht=!0,U.pitch=+E.pitch),E.padding==null||U.isPaddingEqual(E.padding)||(U.padding=E.padding),this.fire(new k.Event("movestart",M)).fire(new k.Event("move",M)),H&&this.fire(new k.Event("zoomstart",M)).fire(new k.Event("zoom",M)).fire(new k.Event("zoomend",M)),$&&this.fire(new k.Event("rotatestart",M)).fire(new k.Event("rotate",M)).fire(new k.Event("rotateend",M)),ht&&this.fire(new k.Event("pitchstart",M)).fire(new k.Event("pitch",M)).fire(new k.Event("pitchend",M)),this.fire(new k.Event("moveend",M))},C.prototype.easeTo=function(E,M){var U=this;this._stop(!1,E.easeId),((E=k.extend({offset:[0,0],duration:500,easing:k.ease},E)).animate===!1||!E.essential&&k.browser.prefersReducedMotion)&&(E.duration=0);var H=this.transform,$=this.getZoom(),ht=this.getBearing(),Ut=this.getPitch(),ie=this.getPadding(),Be="zoom"in E?+E.zoom:$,De="bearing"in E?this._normalizeBearing(E.bearing,ht):ht,Ne="pitch"in E?+E.pitch:Ut,fr="padding"in E?E.padding:H.padding,$e=k.Point.convert(E.offset),_r=H.centerPoint.add($e),er=H.pointLocation(_r),Er=k.LngLat.convert(E.center||er);this._normalizeCenter(Er);var Or,Yr,gn=H.project(er),vn=H.project(Er).sub(gn),_n=H.zoomScale(Be-$);E.around&&(Or=k.LngLat.convert(E.around),Yr=H.locationPoint(Or));var Un={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Be!==$,this._rotating=this._rotating||ht!==De,this._pitching=this._pitching||Ne!==Ut,this._padding=!H.isPaddingEqual(fr),this._easeId=E.easeId,this._prepareEase(M,E.noMoveStart,Un),this._ease(function(ui){if(U._zooming&&(H.zoom=k.number($,Be,ui)),U._rotating&&(H.bearing=k.number(ht,De,ui)),U._pitching&&(H.pitch=k.number(Ut,Ne,ui)),U._padding&&(H.interpolatePadding(ie,fr,ui),_r=H.centerPoint.add($e)),Or)H.setLocationAtPoint(Or,Yr);else{var oi=H.zoomScale(H.zoom-$),Ri=Be>$?Math.min(2,_n):Math.max(.5,_n),Di=Math.pow(Ri,1-ui),ia=H.unproject(gn.add(vn.mult(ui*Di)).mult(oi));H.setLocationAtPoint(H.renderWorldCopies?ia.wrap():ia,_r)}U._fireMoveEvents(M)},function(ui){U._afterEase(M,ui)},E),this},C.prototype._prepareEase=function(E,M,U){U===void 0&&(U={}),this._moving=!0,M||U.moving||this.fire(new k.Event("movestart",E)),this._zooming&&!U.zooming&&this.fire(new k.Event("zoomstart",E)),this._rotating&&!U.rotating&&this.fire(new k.Event("rotatestart",E)),this._pitching&&!U.pitching&&this.fire(new k.Event("pitchstart",E))},C.prototype._fireMoveEvents=function(E){this.fire(new k.Event("move",E)),this._zooming&&this.fire(new k.Event("zoom",E)),this._rotating&&this.fire(new k.Event("rotate",E)),this._pitching&&this.fire(new k.Event("pitch",E))},C.prototype._afterEase=function(E,M){if(!this._easeId||!M||this._easeId!==M){delete this._easeId;var U=this._zooming,H=this._rotating,$=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,U&&this.fire(new k.Event("zoomend",E)),H&&this.fire(new k.Event("rotateend",E)),$&&this.fire(new k.Event("pitchend",E)),this.fire(new k.Event("moveend",E))}},C.prototype.flyTo=function(E,M){var U=this;if(!E.essential&&k.browser.prefersReducedMotion){var H=k.pick(E,["center","zoom","bearing","pitch","around"]);return this.jumpTo(H,M)}this.stop(),E=k.extend({offset:[0,0],speed:1.2,curve:1.42,easing:k.ease},E);var $=this.transform,ht=this.getZoom(),Ut=this.getBearing(),ie=this.getPitch(),Be=this.getPadding(),De="zoom"in E?k.clamp(+E.zoom,$.minZoom,$.maxZoom):ht,Ne="bearing"in E?this._normalizeBearing(E.bearing,Ut):Ut,fr="pitch"in E?+E.pitch:ie,$e="padding"in E?E.padding:$.padding,_r=$.zoomScale(De-ht),er=k.Point.convert(E.offset),Er=$.centerPoint.add(er),Or=$.pointLocation(Er),Yr=k.LngLat.convert(E.center||Or);this._normalizeCenter(Yr);var gn=$.project(Or),vn=$.project(Yr).sub(gn),_n=E.curve,Un=Math.max($.width,$.height),ui=Un/_r,oi=vn.mag();if("minZoom"in E){var Ri=k.clamp(Math.min(E.minZoom,ht,De),$.minZoom,$.maxZoom),Di=Un/$.zoomScale(Ri-ht);_n=Math.sqrt(Di/oi*2)}var ia=_n*_n;function na(Ea){var ca=(ui*ui-Un*Un+(Ea?-1:1)*ia*ia*oi*oi)/(2*(Ea?ui:Un)*ia*oi);return Math.log(Math.sqrt(ca*ca+1)-ca)}function co(Ea){return(Math.exp(Ea)-Math.exp(-Ea))/2}function Bi(Ea){return(Math.exp(Ea)+Math.exp(-Ea))/2}var Pa=na(0),Ra=function(Ea){return Bi(Pa)/Bi(Pa+_n*Ea)},Aa=function(Ea){return Un*((Bi(Pa)*(co(ca=Pa+_n*Ea)/Bi(ca))-co(Pa))/ia)/oi;var ca},ya=(na(1)-Pa)/_n;if(Math.abs(oi)<1e-6||!isFinite(ya)){if(Math.abs(Un-ui)<1e-6)return this.easeTo(E,M);var Ba=ui<Un?-1:1;ya=Math.abs(Math.log(ui/Un))/_n,Aa=function(){return 0},Ra=function(Ea){return Math.exp(Ba*_n*Ea)}}return E.duration="duration"in E?+E.duration:1e3*ya/("screenSpeed"in E?+E.screenSpeed/_n:+E.speed),E.maxDuration&&E.duration>E.maxDuration&&(E.duration=0),this._zooming=!0,this._rotating=Ut!==Ne,this._pitching=fr!==ie,this._padding=!$.isPaddingEqual($e),this._prepareEase(M,!1),this._ease(function(Ea){var ca=Ea*ya,Ys=1/Ra(ca);$.zoom=Ea===1?De:ht+$.scaleZoom(Ys),U._rotating&&($.bearing=k.number(Ut,Ne,Ea)),U._pitching&&($.pitch=k.number(ie,fr,Ea)),U._padding&&($.interpolatePadding(Be,$e,Ea),Er=$.centerPoint.add(er));var xs=Ea===1?Yr:$.unproject(gn.add(vn.mult(Aa(ca))).mult(Ys));$.setLocationAtPoint($.renderWorldCopies?xs.wrap():xs,Er),U._fireMoveEvents(M)},function(){return U._afterEase(M)},E),this},C.prototype.isEasing=function(){return!!this._easeFrameId},C.prototype.stop=function(){return this._stop()},C.prototype._stop=function(E,M){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var U=this._onEaseEnd;delete this._onEaseEnd,U.call(this,M)}if(!E){var H=this.handlers;H&&H.stop(!1)}return this},C.prototype._ease=function(E,M,U){U.animate===!1||U.duration===0?(E(1),M()):(this._easeStart=k.browser.now(),this._easeOptions=U,this._onEaseFrame=E,this._onEaseEnd=M,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},C.prototype._renderFrameCallback=function(){var E=Math.min((k.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(E)),E<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},C.prototype._normalizeBearing=function(E,M){E=k.wrap(E,-180,180);var U=Math.abs(E-M);return Math.abs(E-360-M)<U&&(E-=360),Math.abs(E+360-M)<U&&(E+=360),E},C.prototype._normalizeCenter=function(E){var M=this.transform;if(M.renderWorldCopies&&!M.lngRange){var U=E.lng-M.center.lng;E.lng+=U>180?-360:U<-180?360:0}},C}(k.Evented),Ju=function(x){x===void 0&&(x={}),this.options=x,k.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};Ju.prototype.getDefaultPosition=function(){return"bottom-right"},Ju.prototype.onAdd=function(x){var C=this.options&&this.options.compact;return this._map=x,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=K.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=K.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),C&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),C===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ju.prototype.onRemove=function(){K.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ju.prototype._setElementTitle=function(x,C){var E=this._map._getUIString("AttributionControl."+C);x.title=E,x.setAttribute("aria-label",E)},Ju.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},Ju.prototype._updateEditLink=function(){var x=this._editLink;x||(x=this._editLink=this._container.querySelector(".mapbox-improve-map"));var C=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||k.config.ACCESS_TOKEN}];if(x){var E=C.reduce(function(M,U,H){return U.value&&(M+=U.key+"="+U.value+(H<C.length-1?"&":"")),M},"?");x.href=k.config.FEEDBACK_URL+"/"+E+(this._map._hash?this._map._hash.getHashString(!0):""),x.rel="noopener nofollow",this._setElementTitle(x,"MapFeedback")}},Ju.prototype._updateData=function(x){!x||x.sourceDataType!=="metadata"&&x.sourceDataType!=="visibility"&&x.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Ju.prototype._updateAttributions=function(){if(this._map.style){var x=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?x=x.concat(this.options.customAttribution.map(function(ht){return typeof ht!="string"?"":ht})):typeof this.options.customAttribution=="string"&&x.push(this.options.customAttribution)),this._map.style.stylesheet){var C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}var E=this._map.style.sourceCaches;for(var M in E){var U=E[M];if(U.used){var H=U.getSource();H.attribution&&x.indexOf(H.attribution)<0&&x.push(H.attribution)}}x.sort(function(ht,Ut){return ht.length-Ut.length});var $=(x=x.filter(function(ht,Ut){for(var ie=Ut+1;ie<x.length;ie++)if(x[ie].indexOf(ht)>=0)return!1;return!0})).join(" | ");$!==this._attribHTML&&(this._attribHTML=$,x.length?(this._innerContainer.innerHTML=$,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ju.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Cu=function(){k.bindAll(["_updateLogo"],this),k.bindAll(["_updateCompact"],this)};Cu.prototype.onAdd=function(x){this._map=x,this._container=K.create("div","mapboxgl-ctrl");var C=K.create("a","mapboxgl-ctrl-logo");return C.target="_blank",C.rel="noopener nofollow",C.href="https://www.mapbox.com/",C.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),C.setAttribute("rel","noopener nofollow"),this._container.appendChild(C),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Cu.prototype.onRemove=function(){K.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Cu.prototype.getDefaultPosition=function(){return"bottom-left"},Cu.prototype._updateLogo=function(x){x&&x.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},Cu.prototype._logoRequired=function(){if(this._map.style){var x=this._map.style.sourceCaches;for(var C in x)if(x[C].getSource().mapbox_logo)return!0;return!1}},Cu.prototype._updateCompact=function(){var x=this._container.children;if(x.length){var C=x[0];this._map.getCanvasContainer().offsetWidth<250?C.classList.add("mapboxgl-compact"):C.classList.remove("mapboxgl-compact")}};var Vu=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Vu.prototype.add=function(x){var C=++this._id;return this._queue.push({callback:x,id:C,cancelled:!1}),C},Vu.prototype.remove=function(x){for(var C=this._currentlyRunning,E=0,M=C?this._queue.concat(C):this._queue;E<M.length;E+=1){var U=M[E];if(U.id===x)return void(U.cancelled=!0)}},Vu.prototype.run=function(x){x===void 0&&(x=0);var C=this._currentlyRunning=this._queue;this._queue=[];for(var E=0,M=C;E<M.length;E+=1){var U=M[E];if(!U.cancelled&&(U.callback(x),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Vu.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var gc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ud=k.window.HTMLImageElement,zl=k.window.HTMLElement,Do=k.window.ImageBitmap,rs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ld=function(x){function C(M){var U=this;if((M=k.extend({},rs,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var H=new Ja(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies);if(x.call(this,H,M),this._interactive=M.interactive,this._maxTileCacheSize=M.maxTileCacheSize,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new Vu,this._controls=[],this._mapId=k.uniqueId(),this._locale=k.extend({},gc,M.locale),this._clickTolerance=M.clickTolerance,this._requestManager=new k.RequestManager(M.transformRequest,M.accessToken),typeof M.container=="string"){if(this._container=k.window.document.getElementById(M.container),!this._container)throw new Error("Container '"+M.container+"' not found.")}else{if(!(M.container instanceof zl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),k.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return U._update(!1)}),this.on("moveend",function(){return U._update(!1)}),this.on("zoom",function(){return U._update(!0)}),k.window!==void 0&&(k.window.addEventListener("online",this._onWindowOnline,!1),k.window.addEventListener("resize",this._onWindowResize,!1),k.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new ki(this,M),this._hash=M.hash&&new ro(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,k.extend({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new Ju({customAttribution:M.customAttribution})),this.addControl(new Cu,M.logoPosition),this.on("style.load",function(){U.transform.unmodified&&U.jumpTo(U.style.stylesheet)}),this.on("data",function($){U._update($.dataType==="style"),U.fire(new k.Event($.dataType+"data",$))}),this.on("dataloading",function($){U.fire(new k.Event($.dataType+"dataloading",$))})}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var E={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return C.prototype._getMapId=function(){return this._mapId},C.prototype.addControl=function(M,U){if(U===void 0&&(U=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new k.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var H=M.onAdd(this);this._controls.push(M);var $=this._controlPositions[U];return U.indexOf("bottom")!==-1?$.insertBefore(H,$.firstChild):$.appendChild(H),this},C.prototype.removeControl=function(M){if(!M||!M.onRemove)return this.fire(new k.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var U=this._controls.indexOf(M);return U>-1&&this._controls.splice(U,1),M.onRemove(this),this},C.prototype.hasControl=function(M){return this._controls.indexOf(M)>-1},C.prototype.resize=function(M){var U=this._containerDimensions(),H=U[0],$=U[1];if(H===this.transform.width&&$===this.transform.height)return this;this._resizeCanvas(H,$),this.transform.resize(H,$),this.painter.resize(H,$);var ht=!this._moving;return ht&&this.fire(new k.Event("movestart",M)).fire(new k.Event("move",M)),this.fire(new k.Event("resize",M)),ht&&this.fire(new k.Event("moveend",M)),this},C.prototype.getBounds=function(){return this.transform.getBounds()},C.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},C.prototype.setMaxBounds=function(M){return this.transform.setMaxBounds(k.LngLatBounds.convert(M)),this._update()},C.prototype.setMinZoom=function(M){if((M=M==null?-2:M)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},C.prototype.getMinZoom=function(){return this.transform.minZoom},C.prototype.setMaxZoom=function(M){if((M=M==null?22:M)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")},C.prototype.getMaxZoom=function(){return this.transform.maxZoom},C.prototype.setMinPitch=function(M){if((M=M==null?0:M)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},C.prototype.getMinPitch=function(){return this.transform.minPitch},C.prototype.setMaxPitch=function(M){if((M=M==null?60:M)>60)throw new Error("maxPitch must be less than or equal to 60");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")},C.prototype.getMaxPitch=function(){return this.transform.maxPitch},C.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},C.prototype.setRenderWorldCopies=function(M){return this.transform.renderWorldCopies=M,this._update()},C.prototype.project=function(M){return this.transform.locationPoint(k.LngLat.convert(M))},C.prototype.unproject=function(M){return this.transform.pointLocation(k.Point.convert(M))},C.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},C.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},C.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},C.prototype._createDelegatedListener=function(M,U,H){var $,ht=this;if(M==="mouseenter"||M==="mouseover"){var Ut=!1;return{layer:U,listener:H,delegates:{mousemove:function(Be){var De=ht.getLayer(U)?ht.queryRenderedFeatures(Be.point,{layers:[U]}):[];De.length?Ut||(Ut=!0,H.call(ht,new tu(M,ht,Be.originalEvent,{features:De}))):Ut=!1},mouseout:function(){Ut=!1}}}}if(M==="mouseleave"||M==="mouseout"){var ie=!1;return{layer:U,listener:H,delegates:{mousemove:function(Be){(ht.getLayer(U)?ht.queryRenderedFeatures(Be.point,{layers:[U]}):[]).length?ie=!0:ie&&(ie=!1,H.call(ht,new tu(M,ht,Be.originalEvent)))},mouseout:function(Be){ie&&(ie=!1,H.call(ht,new tu(M,ht,Be.originalEvent)))}}}}return{layer:U,listener:H,delegates:($={},$[M]=function(Be){var De=ht.getLayer(U)?ht.queryRenderedFeatures(Be.point,{layers:[U]}):[];De.length&&(Be.features=De,H.call(ht,Be),delete Be.features)},$)}},C.prototype.on=function(M,U,H){if(H===void 0)return x.prototype.on.call(this,M,U);var $=this._createDelegatedListener(M,U,H);for(var ht in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push($),$.delegates)this.on(ht,$.delegates[ht]);return this},C.prototype.once=function(M,U,H){if(H===void 0)return x.prototype.once.call(this,M,U);var $=this._createDelegatedListener(M,U,H);for(var ht in $.delegates)this.once(ht,$.delegates[ht]);return this},C.prototype.off=function(M,U,H){var $=this;return H===void 0?x.prototype.off.call(this,M,U):(this._delegatedListeners&&this._delegatedListeners[M]&&function(ht){for(var Ut=ht[M],ie=0;ie<Ut.length;ie++){var Be=Ut[ie];if(Be.layer===U&&Be.listener===H){for(var De in Be.delegates)$.off(De,Be.delegates[De]);return Ut.splice(ie,1),$}}}(this._delegatedListeners),this)},C.prototype.queryRenderedFeatures=function(M,U){if(!this.style)return[];var H;if(U!==void 0||M===void 0||M instanceof k.Point||Array.isArray(M)||(U=M,M=void 0),U=U||{},(M=M||[[0,0],[this.transform.width,this.transform.height]])instanceof k.Point||typeof M[0]=="number")H=[k.Point.convert(M)];else{var $=k.Point.convert(M[0]),ht=k.Point.convert(M[1]);H=[$,new k.Point(ht.x,$.y),ht,new k.Point($.x,ht.y),$]}return this.style.queryRenderedFeatures(H,U,this.transform)},C.prototype.querySourceFeatures=function(M,U){return this.style.querySourceFeatures(M,U)},C.prototype.setStyle=function(M,U){return(U=k.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},U)).diff!==!1&&U.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,U),this):(this._localIdeographFontFamily=U.localIdeographFontFamily,this._updateStyle(M,U))},C.prototype._getUIString=function(M){var U=this._locale[M];if(U==null)throw new Error("Missing UI string '"+M+"'");return U},C.prototype._updateStyle=function(M,U){return this.style&&(this.style.setEventedParent(null),this.style._remove()),M?(this.style=new Nu(this,U||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M):this.style.loadJSON(M),this):(delete this.style,this)},C.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Nu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},C.prototype._diffStyle=function(M,U){var H=this;if(typeof M=="string"){var $=this._requestManager.normalizeStyleURL(M),ht=this._requestManager.transformRequest($,k.ResourceType.Style);k.getJSON(ht,function(Ut,ie){Ut?H.fire(new k.ErrorEvent(Ut)):ie&&H._updateDiff(ie,U)})}else typeof M=="object"&&this._updateDiff(M,U)},C.prototype._updateDiff=function(M,U){try{this.style.setState(M)&&this._update(!0)}catch(H){k.warnOnce("Unable to perform style diff: "+(H.message||H.error||H)+".  Rebuilding the style from scratch."),this._updateStyle(M,U)}},C.prototype.getStyle=function(){if(this.style)return this.style.serialize()},C.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():k.warnOnce("There is no style added to the map.")},C.prototype.addSource=function(M,U){return this._lazyInitEmptyStyle(),this.style.addSource(M,U),this._update(!0)},C.prototype.isSourceLoaded=function(M){var U=this.style&&this.style.sourceCaches[M];if(U!==void 0)return U.loaded();this.fire(new k.ErrorEvent(new Error("There is no source with ID '"+M+"'")))},C.prototype.areTilesLoaded=function(){var M=this.style&&this.style.sourceCaches;for(var U in M){var H=M[U]._tiles;for(var $ in H){var ht=H[$];if(ht.state!=="loaded"&&ht.state!=="errored")return!1}}return!0},C.prototype.addSourceType=function(M,U,H){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,U,H)},C.prototype.removeSource=function(M){return this.style.removeSource(M),this._update(!0)},C.prototype.getSource=function(M){return this.style.getSource(M)},C.prototype.addImage=function(M,U,H){H===void 0&&(H={});var $=H.pixelRatio;$===void 0&&($=1);var ht=H.sdf;ht===void 0&&(ht=!1);var Ut=H.stretchX,ie=H.stretchY,Be=H.content;if(this._lazyInitEmptyStyle(),U instanceof ud||Do&&U instanceof Do){var De=k.browser.getImageData(U);this.style.addImage(M,{data:new k.RGBAImage({width:De.width,height:De.height},De.data),pixelRatio:$,stretchX:Ut,stretchY:ie,content:Be,sdf:ht,version:0})}else{if(U.width===void 0||U.height===void 0)return this.fire(new k.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Ne=U;this.style.addImage(M,{data:new k.RGBAImage({width:U.width,height:U.height},new Uint8Array(U.data)),pixelRatio:$,stretchX:Ut,stretchY:ie,content:Be,sdf:ht,version:0,userImage:Ne}),Ne.onAdd&&Ne.onAdd(this,M)}},C.prototype.updateImage=function(M,U){var H=this.style.getImage(M);if(!H)return this.fire(new k.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var $=U instanceof ud||Do&&U instanceof Do?k.browser.getImageData(U):U,ht=$.width,Ut=$.height,ie=$.data;return ht===void 0||Ut===void 0?this.fire(new k.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ht!==H.data.width||Ut!==H.data.height?this.fire(new k.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(H.data.replace(ie,!(U instanceof ud||Do&&U instanceof Do)),void this.style.updateImage(M,H))},C.prototype.hasImage=function(M){return M?!!this.style.getImage(M):(this.fire(new k.ErrorEvent(new Error("Missing required image id"))),!1)},C.prototype.removeImage=function(M){this.style.removeImage(M)},C.prototype.loadImage=function(M,U){k.getImage(this._requestManager.transformRequest(M,k.ResourceType.Image),U)},C.prototype.listImages=function(){return this.style.listImages()},C.prototype.addLayer=function(M,U){return this._lazyInitEmptyStyle(),this.style.addLayer(M,U),this._update(!0)},C.prototype.moveLayer=function(M,U){return this.style.moveLayer(M,U),this._update(!0)},C.prototype.removeLayer=function(M){return this.style.removeLayer(M),this._update(!0)},C.prototype.getLayer=function(M){return this.style.getLayer(M)},C.prototype.setLayerZoomRange=function(M,U,H){return this.style.setLayerZoomRange(M,U,H),this._update(!0)},C.prototype.setFilter=function(M,U,H){return H===void 0&&(H={}),this.style.setFilter(M,U,H),this._update(!0)},C.prototype.getFilter=function(M){return this.style.getFilter(M)},C.prototype.setPaintProperty=function(M,U,H,$){return $===void 0&&($={}),this.style.setPaintProperty(M,U,H,$),this._update(!0)},C.prototype.getPaintProperty=function(M,U){return this.style.getPaintProperty(M,U)},C.prototype.setLayoutProperty=function(M,U,H,$){return $===void 0&&($={}),this.style.setLayoutProperty(M,U,H,$),this._update(!0)},C.prototype.getLayoutProperty=function(M,U){return this.style.getLayoutProperty(M,U)},C.prototype.setLight=function(M,U){return U===void 0&&(U={}),this._lazyInitEmptyStyle(),this.style.setLight(M,U),this._update(!0)},C.prototype.getLight=function(){return this.style.getLight()},C.prototype.setFeatureState=function(M,U){return this.style.setFeatureState(M,U),this._update()},C.prototype.removeFeatureState=function(M,U){return this.style.removeFeatureState(M,U),this._update()},C.prototype.getFeatureState=function(M){return this.style.getFeatureState(M)},C.prototype.getContainer=function(){return this._container},C.prototype.getCanvasContainer=function(){return this._canvasContainer},C.prototype.getCanvas=function(){return this._canvas},C.prototype._containerDimensions=function(){var M=0,U=0;return this._container&&(M=this._container.clientWidth||400,U=this._container.clientHeight||300),[M,U]},C.prototype._detectMissingCSS=function(){k.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&k.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},C.prototype._setupContainer=function(){var M=this._container;M.classList.add("mapboxgl-map"),(this._missingCSSCanary=K.create("div","mapboxgl-canary",M)).style.visibility="hidden",this._detectMissingCSS();var U=this._canvasContainer=K.create("div","mapboxgl-canvas-container",M);this._interactive&&U.classList.add("mapboxgl-interactive"),this._canvas=K.create("canvas","mapboxgl-canvas",U),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var H=this._containerDimensions();this._resizeCanvas(H[0],H[1]);var $=this._controlContainer=K.create("div","mapboxgl-control-container",M),ht=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ut){ht[Ut]=K.create("div","mapboxgl-ctrl-"+Ut,$)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},C.prototype._resizeCanvas=function(M,U){var H=k.browser.devicePixelRatio||1;this._canvas.width=H*M,this._canvas.height=H*U,this._canvas.style.width=M+"px",this._canvas.style.height=U+"px"},C.prototype._setupPainter=function(){var M=k.extend({},Et.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),U=this._canvas.getContext("webgl",M)||this._canvas.getContext("experimental-webgl",M);U?(this.painter=new gs(U,this.transform),k.webpSupported.testSupport(U)):this.fire(new k.ErrorEvent(new Error("Failed to initialize WebGL")))},C.prototype._contextLost=function(M){M.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new k.Event("webglcontextlost",{originalEvent:M}))},C.prototype._contextRestored=function(M){this._setupPainter(),this.resize(),this._update(),this.fire(new k.Event("webglcontextrestored",{originalEvent:M}))},C.prototype._onMapScroll=function(M){if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},C.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},C.prototype._update=function(M){return this.style?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this},C.prototype._requestRenderFrame=function(M){return this._update(),this._renderTaskQueue.add(M)},C.prototype._cancelRenderFrame=function(M){this._renderTaskQueue.remove(M)},C.prototype._render=function(M){var U,H=this,$=0,ht=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(U=ht.createQueryEXT(),ht.beginQueryEXT(ht.TIME_ELAPSED_EXT,U),$=k.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),!this._removed){var Ut=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ie=this.transform.zoom,Be=k.browser.now();this.style.zoomHistory.update(ie,Be);var De=new k.EvaluationParameters(ie,{now:Be,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ne=De.crossFadingFactor();Ne===1&&Ne===this._crossFadingFactor||(Ut=!0,this._crossFadingFactor=Ne),this.style.update(De)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new k.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new k.Event("load"))),this.style&&(this.style.hasTransitions()||Ut)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var fr=k.browser.now()-$;ht.endQueryEXT(ht.TIME_ELAPSED_EXT,U),setTimeout(function(){var er=ht.getQueryObjectEXT(U,ht.QUERY_RESULT_EXT)/1e6;ht.deleteQueryEXT(U),H.fire(new k.Event("gpu-timing-frame",{cpuTime:fr,gpuTime:er}))},50)}if(this.listens("gpu-timing-layer")){var $e=this.painter.collectGpuTimers();setTimeout(function(){var er=H.painter.queryGpuTimers($e);H.fire(new k.Event("gpu-timing-layer",{layerTimes:er}))},50)}var _r=this._sourcesDirty||this._styleDirty||this._placementDirty;return _r||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new k.Event("idle")),!this._loaded||this._fullyLoaded||_r||(this._fullyLoaded=!0),this}},C.prototype.remove=function(){this._hash&&this._hash.remove();for(var M=0,U=this._controls;M<U.length;M+=1)U[M].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),k.window!==void 0&&(k.window.removeEventListener("resize",this._onWindowResize,!1),k.window.removeEventListener("orientationchange",this._onWindowResize,!1),k.window.removeEventListener("online",this._onWindowOnline,!1));var H=this.painter.context.gl.getExtension("WEBGL_lose_context");H&&H.loseContext(),$f(this._canvasContainer),$f(this._controlContainer),$f(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new k.Event("remove"))},C.prototype.triggerRepaint=function(){var M=this;this.style&&!this._frame&&(this._frame=k.browser.frame(function(U){M._frame=null,M._render(U)}))},C.prototype._onWindowOnline=function(){this._update()},C.prototype._onWindowResize=function(M){this._trackResize&&this.resize({originalEvent:M})._update()},E.showTileBoundaries.get=function(){return!!this._showTileBoundaries},E.showTileBoundaries.set=function(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())},E.showPadding.get=function(){return!!this._showPadding},E.showPadding.set=function(M){this._showPadding!==M&&(this._showPadding=M,this._update())},E.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},E.showCollisionBoxes.set=function(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())},E.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},E.showOverdrawInspector.set=function(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())},E.repaint.get=function(){return!!this._repaint},E.repaint.set=function(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())},E.vertices.get=function(){return!!this._vertices},E.vertices.set=function(M){this._vertices=M,this._update()},C.prototype._setCacheLimits=function(M,U){k.setCacheLimits(M,U)},E.version.get=function(){return k.version},Object.defineProperties(C.prototype,E),C}(Ef);function $f(x){x.parentNode&&x.parentNode.removeChild(x)}var Cl={showCompass:!0,showZoom:!0,visualizePitch:!1},il=function(x){var C=this;this.options=k.extend({},Cl,x),this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(E){return E.preventDefault()}),this.options.showZoom&&(k.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(E){return C._map.zoomIn({},{originalEvent:E})}),K.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(E){return C._map.zoomOut({},{originalEvent:E})}),K.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(k.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(E){C.options.visualizePitch?C._map.resetNorthPitch({},{originalEvent:E}):C._map.resetNorth({},{originalEvent:E})}),this._compassIcon=K.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};il.prototype._updateZoomButtons=function(){var x=this._map.getZoom(),C=x===this._map.getMaxZoom(),E=x===this._map.getMinZoom();this._zoomInButton.disabled=C,this._zoomOutButton.disabled=E,this._zoomInButton.setAttribute("aria-disabled",C.toString()),this._zoomOutButton.setAttribute("aria-disabled",E.toString())},il.prototype._rotateCompassArrow=function(){var x=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=x},il.prototype.onAdd=function(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new va(this._map,this._compass,this.options.visualizePitch)),this._container},il.prototype.onRemove=function(){K.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},il.prototype._createButton=function(x,C){var E=K.create("button",x,this._container);return E.type="button",E.addEventListener("click",C),E},il.prototype._setButtonTitle=function(x,C){var E=this._map._getUIString("NavigationControl."+C);x.title=E,x.setAttribute("aria-label",E)};var va=function(x,C,E){E===void 0&&(E=!1),this._clickTolerance=10,this.element=C,this.mouseRotate=new gh({clickTolerance:x.dragRotate._mouseRotate._clickTolerance}),this.map=x,E&&(this.mousePitch=new rf({clickTolerance:x.dragRotate._mousePitch._clickTolerance})),k.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),K.addEventListener(C,"mousedown",this.mousedown),K.addEventListener(C,"touchstart",this.touchstart,{passive:!1}),K.addEventListener(C,"touchmove",this.touchmove),K.addEventListener(C,"touchend",this.touchend),K.addEventListener(C,"touchcancel",this.reset)};function Ul(x,C,E){if(x=new k.LngLat(x.lng,x.lat),C){var M=new k.LngLat(x.lng-360,x.lat),U=new k.LngLat(x.lng+360,x.lat),H=E.locationPoint(x).distSqr(C);E.locationPoint(M).distSqr(C)<H?x=M:E.locationPoint(U).distSqr(C)<H&&(x=U)}for(;Math.abs(x.lng-E.center.lng)>180;){var $=E.locationPoint(x);if($.x>=0&&$.y>=0&&$.x<=E.width&&$.y<=E.height)break;x.lng>E.center.lng?x.lng-=360:x.lng+=360}return x}va.prototype.down=function(x,C){this.mouseRotate.mousedown(x,C),this.mousePitch&&this.mousePitch.mousedown(x,C),K.disableDrag()},va.prototype.move=function(x,C){var E=this.map,M=this.mouseRotate.mousemoveWindow(x,C);if(M&&M.bearingDelta&&E.setBearing(E.getBearing()+M.bearingDelta),this.mousePitch){var U=this.mousePitch.mousemoveWindow(x,C);U&&U.pitchDelta&&E.setPitch(E.getPitch()+U.pitchDelta)}},va.prototype.off=function(){var x=this.element;K.removeEventListener(x,"mousedown",this.mousedown),K.removeEventListener(x,"touchstart",this.touchstart,{passive:!1}),K.removeEventListener(x,"touchmove",this.touchmove),K.removeEventListener(x,"touchend",this.touchend),K.removeEventListener(x,"touchcancel",this.reset),this.offTemp()},va.prototype.offTemp=function(){K.enableDrag(),K.removeEventListener(k.window,"mousemove",this.mousemove),K.removeEventListener(k.window,"mouseup",this.mouseup)},va.prototype.mousedown=function(x){this.down(k.extend({},x,{ctrlKey:!0,preventDefault:function(){return x.preventDefault()}}),K.mousePos(this.element,x)),K.addEventListener(k.window,"mousemove",this.mousemove),K.addEventListener(k.window,"mouseup",this.mouseup)},va.prototype.mousemove=function(x){this.move(x,K.mousePos(this.element,x))},va.prototype.mouseup=function(x){this.mouseRotate.mouseupWindow(x),this.mousePitch&&this.mousePitch.mouseupWindow(x),this.offTemp()},va.prototype.touchstart=function(x){x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=K.touchPos(this.element,x.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return x.preventDefault()}},this._startPos))},va.prototype.touchmove=function(x){x.targetTouches.length!==1?this.reset():(this._lastPos=K.touchPos(this.element,x.targetTouches)[0],this.move({preventDefault:function(){return x.preventDefault()}},this._lastPos))},va.prototype.touchend=function(x){x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},va.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function wf(x,C,E){var M=x.classList;for(var U in vl)M.remove("mapboxgl-"+E+"-anchor-"+U);M.add("mapboxgl-"+E+"-anchor-"+C)}var ac,Lc=function(x){function C(E,M){if(x.call(this),(E instanceof k.window.HTMLElement||M)&&(E=k.extend({element:E},M)),k.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=E&&E.anchor||"center",this._color=E&&E.color||"#3FB1CE",this._scale=E&&E.scale||1,this._draggable=E&&E.draggable||!1,this._clickTolerance=E&&E.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=E&&E.rotation||0,this._rotationAlignment=E&&E.rotationAlignment||"auto",this._pitchAlignment=E&&E.pitchAlignment&&E.pitchAlignment!=="auto"?E.pitchAlignment:this._rotationAlignment,E&&E.element)this._element=E.element,this._offset=k.Point.convert(E&&E.offset||[0,0]);else{this._defaultMarker=!0,this._element=K.create("div"),this._element.setAttribute("aria-label","Map marker");var U=K.createNS("http://www.w3.org/2000/svg","svg");U.setAttributeNS(null,"display","block"),U.setAttributeNS(null,"height","41px"),U.setAttributeNS(null,"width","27px"),U.setAttributeNS(null,"viewBox","0 0 27 41");var H=K.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"stroke","none"),H.setAttributeNS(null,"stroke-width","1"),H.setAttributeNS(null,"fill","none"),H.setAttributeNS(null,"fill-rule","evenodd");var $=K.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"fill-rule","nonzero");var ht=K.createNS("http://www.w3.org/2000/svg","g");ht.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ht.setAttributeNS(null,"fill","#000000");for(var Ut=0,ie=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ut<ie.length;Ut+=1){var Be=ie[Ut],De=K.createNS("http://www.w3.org/2000/svg","ellipse");De.setAttributeNS(null,"opacity","0.04"),De.setAttributeNS(null,"cx","10.5"),De.setAttributeNS(null,"cy","5.80029008"),De.setAttributeNS(null,"rx",Be.rx),De.setAttributeNS(null,"ry",Be.ry),ht.appendChild(De)}var Ne=K.createNS("http://www.w3.org/2000/svg","g");Ne.setAttributeNS(null,"fill",this._color);var fr=K.createNS("http://www.w3.org/2000/svg","path");fr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ne.appendChild(fr);var $e=K.createNS("http://www.w3.org/2000/svg","g");$e.setAttributeNS(null,"opacity","0.25"),$e.setAttributeNS(null,"fill","#000000");var _r=K.createNS("http://www.w3.org/2000/svg","path");_r.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$e.appendChild(_r);var er=K.createNS("http://www.w3.org/2000/svg","g");er.setAttributeNS(null,"transform","translate(6.0, 7.0)"),er.setAttributeNS(null,"fill","#FFFFFF");var Er=K.createNS("http://www.w3.org/2000/svg","g");Er.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Or=K.createNS("http://www.w3.org/2000/svg","circle");Or.setAttributeNS(null,"fill","#000000"),Or.setAttributeNS(null,"opacity","0.25"),Or.setAttributeNS(null,"cx","5.5"),Or.setAttributeNS(null,"cy","5.5"),Or.setAttributeNS(null,"r","5.4999962");var Yr=K.createNS("http://www.w3.org/2000/svg","circle");Yr.setAttributeNS(null,"fill","#FFFFFF"),Yr.setAttributeNS(null,"cx","5.5"),Yr.setAttributeNS(null,"cy","5.5"),Yr.setAttributeNS(null,"r","5.4999962"),Er.appendChild(Or),Er.appendChild(Yr),$.appendChild(ht),$.appendChild(Ne),$.appendChild($e),$.appendChild(er),$.appendChild(Er),U.appendChild($),U.setAttributeNS(null,"height",41*this._scale+"px"),U.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(U),this._offset=k.Point.convert(E&&E.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(gn){gn.preventDefault()}),this._element.addEventListener("mousedown",function(gn){gn.preventDefault()}),wf(this._element,this._anchor,"marker"),this._popup=null}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.addTo=function(E){return this.remove(),this._map=E,E.getCanvasContainer().appendChild(this._element),E.on("move",this._update),E.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},C.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),K.remove(this._element),this._popup&&this._popup.remove(),this},C.prototype.getLngLat=function(){return this._lngLat},C.prototype.setLngLat=function(E){return this._lngLat=k.LngLat.convert(E),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},C.prototype.getElement=function(){return this._element},C.prototype.setPopup=function(E){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),E){if(!("offset"in E.options)){var M=Math.sqrt(Math.pow(13.5,2)/2);E.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[M,-1*(24.6+M)],"bottom-right":[-M,-1*(24.6+M)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=E,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},C.prototype._onKeyPress=function(E){var M=E.code,U=E.charCode||E.keyCode;M!=="Space"&&M!=="Enter"&&U!==32&&U!==13||this.togglePopup()},C.prototype._onMapClick=function(E){var M=E.originalEvent.target,U=this._element;this._popup&&(M===U||U.contains(M))&&this.togglePopup()},C.prototype.getPopup=function(){return this._popup},C.prototype.togglePopup=function(){var E=this._popup;return E?(E.isOpen()?E.remove():E.addTo(this._map),this):this},C.prototype._update=function(E){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ul(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var M="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?M="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(M="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var U="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?U="rotateX(0deg)":this._pitchAlignment==="map"&&(U="rotateX("+this._map.getPitch()+"deg)"),E&&E.type!=="moveend"||(this._pos=this._pos.round()),K.setTransform(this._element,vl[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+U+" "+M)}},C.prototype.getOffset=function(){return this._offset},C.prototype.setOffset=function(E){return this._offset=k.Point.convert(E),this._update(),this},C.prototype._onMove=function(E){if(!this._isDragging){var M=this._clickTolerance||this._map._clickTolerance;this._isDragging=E.point.dist(this._pointerdownPos)>=M}this._isDragging&&(this._pos=E.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new k.Event("dragstart"))),this.fire(new k.Event("drag")))},C.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new k.Event("dragend")),this._state="inactive"},C.prototype._addDragHandler=function(E){this._element.contains(E.originalEvent.target)&&(E.preventDefault(),this._positionDelta=E.point.sub(this._pos).add(this._offset),this._pointerdownPos=E.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},C.prototype.setDraggable=function(E){return this._draggable=!!E,this._map&&(E?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},C.prototype.isDraggable=function(){return this._draggable},C.prototype.setRotation=function(E){return this._rotation=E||0,this._update(),this},C.prototype.getRotation=function(){return this._rotation},C.prototype.setRotationAlignment=function(E){return this._rotationAlignment=E||"auto",this._update(),this},C.prototype.getRotationAlignment=function(){return this._rotationAlignment},C.prototype.setPitchAlignment=function(E){return this._pitchAlignment=E&&E!=="auto"?E:this._rotationAlignment,this._update(),this},C.prototype.getPitchAlignment=function(){return this._pitchAlignment},C}(k.Evented),Zl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},mh=0,qf=!1,cd=function(x){function C(E){x.call(this),this.options=k.extend({},Zl,E),k.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.onAdd=function(E){var M;return this._map=E,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),M=this._setupUI,ac!==void 0?M(ac):k.window.navigator.permissions!==void 0?k.window.navigator.permissions.query({name:"geolocation"}).then(function(U){M(ac=U.state!=="denied")}):M(ac=!!k.window.navigator.geolocation),this._container},C.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(k.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),K.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,mh=0,qf=!1},C.prototype._isOutOfMapMaxBounds=function(E){var M=this._map.getMaxBounds(),U=E.coords;return M&&(U.longitude<M.getWest()||U.longitude>M.getEast()||U.latitude<M.getSouth()||U.latitude>M.getNorth())},C.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},C.prototype._onSuccess=function(E){if(this._map){if(this._isOutOfMapMaxBounds(E))return this._setErrorState(),this.fire(new k.Event("outofmaxbounds",E)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=E,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(E),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(E),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new k.Event("geolocate",E)),this._finish()}},C.prototype._updateCamera=function(E){var M=new k.LngLat(E.coords.longitude,E.coords.latitude),U=E.coords.accuracy,H=this._map.getBearing(),$=k.extend({bearing:H},this.options.fitBoundsOptions);this._map.fitBounds(M.toBounds(U),$,{geolocateSource:!0})},C.prototype._updateMarker=function(E){if(E){var M=new k.LngLat(E.coords.longitude,E.coords.latitude);this._accuracyCircleMarker.setLngLat(M).addTo(this._map),this._userLocationDotMarker.setLngLat(M).addTo(this._map),this._accuracy=E.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},C.prototype._updateCircleRadius=function(){var E=this._map._container.clientHeight/2,M=this._map.unproject([0,E]),U=this._map.unproject([1,E]),H=M.distanceTo(U),$=Math.ceil(2*this._accuracy/H);this._circleElement.style.width=$+"px",this._circleElement.style.height=$+"px"},C.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},C.prototype._onError=function(E){if(this._map){if(this.options.trackUserLocation)if(E.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var M=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(E.code===3&&qf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new k.Event("error",E)),this._finish()}},C.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},C.prototype._setupUI=function(E){var M=this;if(this._container.addEventListener("contextmenu",function($){return $.preventDefault()}),this._geolocateButton=K.create("button","mapboxgl-ctrl-geolocate",this._container),K.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",E===!1){k.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var U=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=U,this._geolocateButton.setAttribute("aria-label",U)}else{var H=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=H,this._geolocateButton.setAttribute("aria-label",H)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=K.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Lc(this._dotElement),this._circleElement=K.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Lc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function($){$.geolocateSource||M._watchState!=="ACTIVE_LOCK"||$.originalEvent&&$.originalEvent.type==="resize"||(M._watchState="BACKGROUND",M._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),M._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),M.fire(new k.Event("trackuserlocationend")))})},C.prototype.trigger=function(){if(!this._setup)return k.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new k.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":mh--,qf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new k.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new k.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var E;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++mh>1?(E={maximumAge:6e5,timeout:0},qf=!0):(E=this.options.positionOptions,qf=!1),this._geolocationWatchID=k.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,E)}}else k.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},C.prototype._clearWatch=function(){k.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},C}(k.Evented),Sf={maxWidth:100,unit:"metric"},Cf=function(x){this.options=k.extend({},Sf,x),k.bindAll(["_onMove","setUnit"],this)};function Mp(x,C,E){var M=E&&E.maxWidth||100,U=x._container.clientHeight/2,H=x.unproject([0,U]),$=x.unproject([M,U]),ht=H.distanceTo($);if(E&&E.unit==="imperial"){var Ut=3.2808*ht;Ut>5280?Af(C,M,Ut/5280,x._getUIString("ScaleControl.Miles")):Af(C,M,Ut,x._getUIString("ScaleControl.Feet"))}else E&&E.unit==="nautical"?Af(C,M,ht/1852,x._getUIString("ScaleControl.NauticalMiles")):ht>=1e3?Af(C,M,ht/1e3,x._getUIString("ScaleControl.Kilometers")):Af(C,M,ht,x._getUIString("ScaleControl.Meters"))}function Af(x,C,E,M){var U,H,$,ht=(U=E,(H=Math.pow(10,(""+Math.floor(U)).length-1))*($=($=U/H)>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(Ut){var ie=Math.pow(10,Math.ceil(-Math.log(Ut)/Math.LN10));return Math.round(Ut*ie)/ie}($)));x.style.width=C*(ht/E)+"px",x.innerHTML=ht+"&nbsp;"+M}Cf.prototype.getDefaultPosition=function(){return"bottom-left"},Cf.prototype._onMove=function(){Mp(this._map,this._container,this.options)},Cf.prototype.onAdd=function(x){return this._map=x,this._container=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Cf.prototype.onRemove=function(){K.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Cf.prototype.setUnit=function(x){this.options.unit=x,Mp(this._map,this._container,this.options)};var Al=function(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof k.window.HTMLElement?this._container=x.container:k.warnOnce("Full screen control 'container' must be a DOM element.")),k.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in k.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in k.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in k.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in k.window.document&&(this._fullscreenchange="MSFullscreenChange")};Al.prototype.onAdd=function(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=K.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",k.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Al.prototype.onRemove=function(){K.remove(this._controlContainer),this._map=null,k.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Al.prototype._checkFullscreenSupport=function(){return!!(k.window.document.fullscreenEnabled||k.window.document.mozFullScreenEnabled||k.window.document.msFullscreenEnabled||k.window.document.webkitFullscreenEnabled)},Al.prototype._setupUI=function(){var x=this._fullscreenButton=K.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);K.create("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden",!0),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),k.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Al.prototype._updateTitle=function(){var x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x},Al.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Al.prototype._isFullscreen=function(){return this._fullscreen},Al.prototype._changeIcon=function(){(k.window.document.fullscreenElement||k.window.document.mozFullScreenElement||k.window.document.webkitFullscreenElement||k.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Al.prototype._onClickFullscreen=function(){this._isFullscreen()?k.window.document.exitFullscreen?k.window.document.exitFullscreen():k.window.document.mozCancelFullScreen?k.window.document.mozCancelFullScreen():k.window.document.msExitFullscreen?k.window.document.msExitFullscreen():k.window.document.webkitCancelFullScreen&&k.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Gh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Hh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Ip=function(x){function C(E){x.call(this),this.options=k.extend(Object.create(Gh),E),k.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.addTo=function(E){return this._map&&this.remove(),this._map=E,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new k.Event("open")),this},C.prototype.isOpen=function(){return!!this._map},C.prototype.remove=function(){return this._content&&K.remove(this._content),this._container&&(K.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new k.Event("close")),this},C.prototype.getLngLat=function(){return this._lngLat},C.prototype.setLngLat=function(E){return this._lngLat=k.LngLat.convert(E),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},C.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},C.prototype.getElement=function(){return this._container},C.prototype.setText=function(E){return this.setDOMContent(k.window.document.createTextNode(E))},C.prototype.setHTML=function(E){var M,U=k.window.document.createDocumentFragment(),H=k.window.document.createElement("body");for(H.innerHTML=E;M=H.firstChild;)U.appendChild(M);return this.setDOMContent(U)},C.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},C.prototype.setMaxWidth=function(E){return this.options.maxWidth=E,this._update(),this},C.prototype.setDOMContent=function(E){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=K.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(E),this._createCloseButton(),this._update(),this._focusFirstElement(),this},C.prototype.addClassName=function(E){this._container&&this._container.classList.add(E)},C.prototype.removeClassName=function(E){this._container&&this._container.classList.remove(E)},C.prototype.setOffset=function(E){return this.options.offset=E,this._update(),this},C.prototype.toggleClassName=function(E){if(this._container)return this._container.classList.toggle(E)},C.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=K.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},C.prototype._onMouseUp=function(E){this._update(E.point)},C.prototype._onMouseMove=function(E){this._update(E.point)},C.prototype._onDrag=function(E){this._update(E.point)},C.prototype._update=function(E){var M=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=K.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=K.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(De){return M._container.classList.add(De)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ul(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||E)){var U=this._pos=this._trackPointer&&E?E:this._map.project(this._lngLat),H=this.options.anchor,$=function De(Ne){if(Ne){if(typeof Ne=="number"){var fr=Math.round(Math.sqrt(.5*Math.pow(Ne,2)));return{center:new k.Point(0,0),top:new k.Point(0,Ne),"top-left":new k.Point(fr,fr),"top-right":new k.Point(-fr,fr),bottom:new k.Point(0,-Ne),"bottom-left":new k.Point(fr,-fr),"bottom-right":new k.Point(-fr,-fr),left:new k.Point(Ne,0),right:new k.Point(-Ne,0)}}if(Ne instanceof k.Point||Array.isArray(Ne)){var $e=k.Point.convert(Ne);return{center:$e,top:$e,"top-left":$e,"top-right":$e,bottom:$e,"bottom-left":$e,"bottom-right":$e,left:$e,right:$e}}return{center:k.Point.convert(Ne.center||[0,0]),top:k.Point.convert(Ne.top||[0,0]),"top-left":k.Point.convert(Ne["top-left"]||[0,0]),"top-right":k.Point.convert(Ne["top-right"]||[0,0]),bottom:k.Point.convert(Ne.bottom||[0,0]),"bottom-left":k.Point.convert(Ne["bottom-left"]||[0,0]),"bottom-right":k.Point.convert(Ne["bottom-right"]||[0,0]),left:k.Point.convert(Ne.left||[0,0]),right:k.Point.convert(Ne.right||[0,0])}}return De(new k.Point(0,0))}(this.options.offset);if(!H){var ht,Ut=this._container.offsetWidth,ie=this._container.offsetHeight;ht=U.y+$.bottom.y<ie?["top"]:U.y>this._map.transform.height-ie?["bottom"]:[],U.x<Ut/2?ht.push("left"):U.x>this._map.transform.width-Ut/2&&ht.push("right"),H=ht.length===0?"bottom":ht.join("-")}var Be=U.add($[H]).round();K.setTransform(this._container,vl[H]+" translate("+Be.x+"px,"+Be.y+"px)"),wf(this._container,H,"popup")}},C.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var E=this._container.querySelector(Hh);E&&E.focus()}},C.prototype._onClose=function(){this.remove()},C}(k.Evented),oc={version:k.version,supported:Et,setRTLTextPlugin:k.setRTLTextPlugin,getRTLTextPluginStatus:k.getRTLTextPluginStatus,Map:ld,NavigationControl:il,GeolocateControl:cd,AttributionControl:Ju,ScaleControl:Cf,FullscreenControl:Al,Popup:Ip,Marker:Lc,Style:Nu,LngLat:k.LngLat,LngLatBounds:k.LngLatBounds,Point:k.Point,MercatorCoordinate:k.MercatorCoordinate,Evented:k.Evented,config:k.config,prewarm:function(){Qr().acquire(an)},clearPrewarmedResources:function(){var x=xi;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(an),xi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return k.config.ACCESS_TOKEN},set accessToken(x){k.config.ACCESS_TOKEN=x},get baseApiUrl(){return k.config.API_URL},set baseApiUrl(x){k.config.API_URL=x},get workerCount(){return Pn.workerCount},set workerCount(x){Pn.workerCount=x},get maxParallelImageRequests(){return k.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){k.config.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage:function(x){k.clearTileCache(x)},workerUrl:""};return oc}),kt})},43548:function(dn,Pt,nt){"use strict";dn.exports=mt;var kt=nt(11542);function mt(Ot){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Ot)?Ot:new Uint8Array(Ot||0),this.pos=0,this.type=0,this.length=this.buf.length}mt.Varint=0,mt.Fixed64=1,mt.Bytes=2,mt.Fixed32=5;var k=(1<<16)*(1<<16),Et=1/k,K=12,yt=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");mt.prototype={destroy:function(){this.buf=null},readFields:function(Ot,te,ft){for(ft=ft||this.length;this.pos<ft;){var wt=this.readVarint(),Y=wt>>3,gt=this.pos;this.type=wt&7,Ot(Y,te,this),this.pos===gt&&this.skip(wt)}return te},readMessage:function(Ot,te){return this.readFields(Ot,te,this.readVarint()+this.pos)},readFixed32:function(){var Ot=Se(this.buf,this.pos);return this.pos+=4,Ot},readSFixed32:function(){var Ot=ve(this.buf,this.pos);return this.pos+=4,Ot},readFixed64:function(){var Ot=Se(this.buf,this.pos)+Se(this.buf,this.pos+4)*k;return this.pos+=8,Ot},readSFixed64:function(){var Ot=Se(this.buf,this.pos)+ve(this.buf,this.pos+4)*k;return this.pos+=8,Ot},readFloat:function(){var Ot=kt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,Ot},readDouble:function(){var Ot=kt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,Ot},readVarint:function(Ot){var te=this.buf,ft,wt;return wt=te[this.pos++],ft=wt&127,wt<128||(wt=te[this.pos++],ft|=(wt&127)<<7,wt<128)||(wt=te[this.pos++],ft|=(wt&127)<<14,wt<128)||(wt=te[this.pos++],ft|=(wt&127)<<21,wt<128)?ft:(wt=te[this.pos],ft|=(wt&15)<<28,J(ft,Ot,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Ot=this.readVarint();return Ot%2===1?(Ot+1)/-2:Ot/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var Ot=this.readVarint()+this.pos,te=this.pos;return this.pos=Ot,Ot-te>=K&&yt?xe(this.buf,te,Ot):ne(this.buf,te,Ot)},readBytes:function(){var Ot=this.readVarint()+this.pos,te=this.buf.subarray(this.pos,Ot);return this.pos=Ot,te},readPackedVarint:function(Ot,te){if(this.type!==mt.Bytes)return Ot.push(this.readVarint(te));var ft=pt(this);for(Ot=Ot||[];this.pos<ft;)Ot.push(this.readVarint(te));return Ot},readPackedSVarint:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readSVarint());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readSVarint());return Ot},readPackedBoolean:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readBoolean());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readBoolean());return Ot},readPackedFloat:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readFloat());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readFloat());return Ot},readPackedDouble:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readDouble());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readDouble());return Ot},readPackedFixed32:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readFixed32());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readFixed32());return Ot},readPackedSFixed32:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readSFixed32());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readSFixed32());return Ot},readPackedFixed64:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readFixed64());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readFixed64());return Ot},readPackedSFixed64:function(Ot){if(this.type!==mt.Bytes)return Ot.push(this.readSFixed64());var te=pt(this);for(Ot=Ot||[];this.pos<te;)Ot.push(this.readSFixed64());return Ot},skip:function(Ot){var te=Ot&7;if(te===mt.Varint)for(;this.buf[this.pos++]>127;);else if(te===mt.Bytes)this.pos=this.readVarint()+this.pos;else if(te===mt.Fixed32)this.pos+=4;else if(te===mt.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+te)},writeTag:function(Ot,te){this.writeVarint(Ot<<3|te)},realloc:function(Ot){for(var te=this.length||16;te<this.pos+Ot;)te*=2;if(te!==this.length){var ft=new Uint8Array(te);ft.set(this.buf),this.buf=ft,this.length=te}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Ot){this.realloc(4),_e(this.buf,Ot,this.pos),this.pos+=4},writeSFixed32:function(Ot){this.realloc(4),_e(this.buf,Ot,this.pos),this.pos+=4},writeFixed64:function(Ot){this.realloc(8),_e(this.buf,Ot&-1,this.pos),_e(this.buf,Math.floor(Ot*Et),this.pos+4),this.pos+=8},writeSFixed64:function(Ot){this.realloc(8),_e(this.buf,Ot&-1,this.pos),_e(this.buf,Math.floor(Ot*Et),this.pos+4),this.pos+=8},writeVarint:function(Ot){if(Ot=+Ot||0,Ot>268435455||Ot<0){be(Ot,this);return}this.realloc(4),this.buf[this.pos++]=Ot&127|(Ot>127?128:0),!(Ot<=127)&&(this.buf[this.pos++]=(Ot>>>=7)&127|(Ot>127?128:0),!(Ot<=127)&&(this.buf[this.pos++]=(Ot>>>=7)&127|(Ot>127?128:0),!(Ot<=127)&&(this.buf[this.pos++]=Ot>>>7&127)))},writeSVarint:function(Ot){this.writeVarint(Ot<0?-Ot*2-1:Ot*2)},writeBoolean:function(Ot){this.writeVarint(Boolean(Ot))},writeString:function(Ot){Ot=String(Ot),this.realloc(Ot.length*4),this.pos++;var te=this.pos;this.pos=Je(this.buf,Ot,this.pos);var ft=this.pos-te;ft>=128&&zt(te,ft,this),this.pos=te-1,this.writeVarint(ft),this.pos+=ft},writeFloat:function(Ot){this.realloc(4),kt.write(this.buf,Ot,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Ot){this.realloc(8),kt.write(this.buf,Ot,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Ot){var te=Ot.length;this.writeVarint(te),this.realloc(te);for(var ft=0;ft<te;ft++)this.buf[this.pos++]=Ot[ft]},writeRawMessage:function(Ot,te){this.pos++;var ft=this.pos;Ot(te,this);var wt=this.pos-ft;wt>=128&&zt(ft,wt,this),this.pos=ft-1,this.writeVarint(wt),this.pos+=wt},writeMessage:function(Ot,te,ft){this.writeTag(Ot,mt.Bytes),this.writeRawMessage(te,ft)},writePackedVarint:function(Ot,te){te.length&&this.writeMessage(Ot,P,te)},writePackedSVarint:function(Ot,te){te.length&&this.writeMessage(Ot,b,te)},writePackedBoolean:function(Ot,te){te.length&&this.writeMessage(Ot,Ee,te)},writePackedFloat:function(Ot,te){te.length&&this.writeMessage(Ot,W,te)},writePackedDouble:function(Ot,te){te.length&&this.writeMessage(Ot,le,te)},writePackedFixed32:function(Ot,te){te.length&&this.writeMessage(Ot,ke,te)},writePackedSFixed32:function(Ot,te){te.length&&this.writeMessage(Ot,Tt,te)},writePackedFixed64:function(Ot,te){te.length&&this.writeMessage(Ot,rt,te)},writePackedSFixed64:function(Ot,te){te.length&&this.writeMessage(Ot,Dt,te)},writeBytesField:function(Ot,te){this.writeTag(Ot,mt.Bytes),this.writeBytes(te)},writeFixed32Field:function(Ot,te){this.writeTag(Ot,mt.Fixed32),this.writeFixed32(te)},writeSFixed32Field:function(Ot,te){this.writeTag(Ot,mt.Fixed32),this.writeSFixed32(te)},writeFixed64Field:function(Ot,te){this.writeTag(Ot,mt.Fixed64),this.writeFixed64(te)},writeSFixed64Field:function(Ot,te){this.writeTag(Ot,mt.Fixed64),this.writeSFixed64(te)},writeVarintField:function(Ot,te){this.writeTag(Ot,mt.Varint),this.writeVarint(te)},writeSVarintField:function(Ot,te){this.writeTag(Ot,mt.Varint),this.writeSVarint(te)},writeStringField:function(Ot,te){this.writeTag(Ot,mt.Bytes),this.writeString(te)},writeFloatField:function(Ot,te){this.writeTag(Ot,mt.Fixed32),this.writeFloat(te)},writeDoubleField:function(Ot,te){this.writeTag(Ot,mt.Fixed64),this.writeDouble(te)},writeBooleanField:function(Ot,te){this.writeVarintField(Ot,Boolean(te))}};function J(Ot,te,ft){var wt=ft.buf,Y,gt;if(gt=wt[ft.pos++],Y=(gt&112)>>4,gt<128||(gt=wt[ft.pos++],Y|=(gt&127)<<3,gt<128)||(gt=wt[ft.pos++],Y|=(gt&127)<<10,gt<128)||(gt=wt[ft.pos++],Y|=(gt&127)<<17,gt<128)||(gt=wt[ft.pos++],Y|=(gt&127)<<24,gt<128)||(gt=wt[ft.pos++],Y|=(gt&1)<<31,gt<128))return et(Ot,Y,te);throw new Error("Expected varint not more than 10 bytes")}function pt(Ot){return Ot.type===mt.Bytes?Ot.readVarint()+Ot.pos:Ot.pos+1}function et(Ot,te,ft){return ft?te*4294967296+(Ot>>>0):(te>>>0)*4294967296+(Ot>>>0)}function be(Ot,te){var ft,wt;if(Ot>=0?(ft=Ot%4294967296|0,wt=Ot/4294967296|0):(ft=~(-Ot%4294967296),wt=~(-Ot/4294967296),ft^4294967295?ft=ft+1|0:(ft=0,wt=wt+1|0)),Ot>=18446744073709552e3||Ot<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");te.realloc(10),ot(ft,wt,te),ut(wt,te)}function ot(Ot,te,ft){ft.buf[ft.pos++]=Ot&127|128,Ot>>>=7,ft.buf[ft.pos++]=Ot&127|128,Ot>>>=7,ft.buf[ft.pos++]=Ot&127|128,Ot>>>=7,ft.buf[ft.pos++]=Ot&127|128,Ot>>>=7,ft.buf[ft.pos]=Ot&127}function ut(Ot,te){var ft=(Ot&7)<<4;te.buf[te.pos++]|=ft|((Ot>>>=3)?128:0),Ot&&(te.buf[te.pos++]=Ot&127|((Ot>>>=7)?128:0),Ot&&(te.buf[te.pos++]=Ot&127|((Ot>>>=7)?128:0),Ot&&(te.buf[te.pos++]=Ot&127|((Ot>>>=7)?128:0),Ot&&(te.buf[te.pos++]=Ot&127|((Ot>>>=7)?128:0),Ot&&(te.buf[te.pos++]=Ot&127)))))}function zt(Ot,te,ft){var wt=te<=16383?1:te<=2097151?2:te<=268435455?3:Math.floor(Math.log(te)/(Math.LN2*7));ft.realloc(wt);for(var Y=ft.pos-1;Y>=Ot;Y--)ft.buf[Y+wt]=ft.buf[Y]}function P(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeVarint(Ot[ft])}function b(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeSVarint(Ot[ft])}function W(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeFloat(Ot[ft])}function le(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeDouble(Ot[ft])}function Ee(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeBoolean(Ot[ft])}function ke(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeFixed32(Ot[ft])}function Tt(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeSFixed32(Ot[ft])}function rt(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeFixed64(Ot[ft])}function Dt(Ot,te){for(var ft=0;ft<Ot.length;ft++)te.writeSFixed64(Ot[ft])}function Se(Ot,te){return(Ot[te]|Ot[te+1]<<8|Ot[te+2]<<16)+Ot[te+3]*16777216}function _e(Ot,te,ft){Ot[ft]=te,Ot[ft+1]=te>>>8,Ot[ft+2]=te>>>16,Ot[ft+3]=te>>>24}function ve(Ot,te){return(Ot[te]|Ot[te+1]<<8|Ot[te+2]<<16)+(Ot[te+3]<<24)}function ne(Ot,te,ft){for(var wt="",Y=te;Y<ft;){var gt=Ot[Y],he=null,Oe=gt>239?4:gt>223?3:gt>191?2:1;if(Y+Oe>ft)break;var Le,Ve,Bt;Oe===1?gt<128&&(he=gt):Oe===2?(Le=Ot[Y+1],(Le&192)===128&&(he=(gt&31)<<6|Le&63,he<=127&&(he=null))):Oe===3?(Le=Ot[Y+1],Ve=Ot[Y+2],(Le&192)===128&&(Ve&192)===128&&(he=(gt&15)<<12|(Le&63)<<6|Ve&63,(he<=2047||he>=55296&&he<=57343)&&(he=null))):Oe===4&&(Le=Ot[Y+1],Ve=Ot[Y+2],Bt=Ot[Y+3],(Le&192)===128&&(Ve&192)===128&&(Bt&192)===128&&(he=(gt&15)<<18|(Le&63)<<12|(Ve&63)<<6|Bt&63,(he<=65535||he>=1114112)&&(he=null))),he===null?(he=65533,Oe=1):he>65535&&(he-=65536,wt+=String.fromCharCode(he>>>10&1023|55296),he=56320|he&1023),wt+=String.fromCharCode(he),Y+=Oe}return wt}function xe(Ot,te,ft){return yt.decode(Ot.subarray(te,ft))}function Je(Ot,te,ft){for(var wt=0,Y,gt;wt<te.length;wt++){if(Y=te.charCodeAt(wt),Y>55295&&Y<57344)if(gt)if(Y<56320){Ot[ft++]=239,Ot[ft++]=191,Ot[ft++]=189,gt=Y;continue}else Y=gt-55296<<10|Y-56320|65536,gt=null;else{Y>56319||wt+1===te.length?(Ot[ft++]=239,Ot[ft++]=191,Ot[ft++]=189):gt=Y;continue}else gt&&(Ot[ft++]=239,Ot[ft++]=191,Ot[ft++]=189,gt=null);Y<128?Ot[ft++]=Y:(Y<2048?Ot[ft++]=Y>>6|192:(Y<65536?Ot[ft++]=Y>>12|224:(Ot[ft++]=Y>>18|240,Ot[ft++]=Y>>12&63|128),Ot[ft++]=Y>>6&63|128),Ot[ft++]=Y&63|128)}return ft}},86319:function(dn){"use strict";var Pt=dn.exports;dn.exports.isNumber=function(nt){return typeof nt=="number"},dn.exports.findMin=function(nt){if(nt.length===0)return 1/0;for(var kt=nt[0],mt=1;mt<nt.length;mt++)kt=Math.min(kt,nt[mt]);return kt},dn.exports.findMax=function(nt){if(nt.length===0)return-1/0;for(var kt=nt[0],mt=1;mt<nt.length;mt++)kt=Math.max(kt,nt[mt]);return kt},dn.exports.findMinMulti=function(nt){for(var kt=Pt.findMin(nt[0]),mt=1;mt<nt.length;mt++)kt=Math.min(kt,Pt.findMin(nt[mt]));return kt},dn.exports.findMaxMulti=function(nt){for(var kt=Pt.findMax(nt[0]),mt=1;mt<nt.length;mt++)kt=Math.max(kt,Pt.findMax(nt[mt]));return kt},dn.exports.inside=function(nt,kt,mt){return nt<=mt&&mt<=kt}},50517:function(dn,Pt,nt){"use strict";var kt=50,mt=2,k=Math.log(2),Et=dn.exports,K=nt(86319);function yt(pt){return 1-Math.abs(pt)}dn.exports.getUnifiedMinMax=function(pt,et){return Et.getUnifiedMinMaxMulti([pt],et)},dn.exports.getUnifiedMinMaxMulti=function(pt,et){et=et||{};var be=!1,ot=!1,ut=K.isNumber(et.width)?et.width:mt,zt=K.isNumber(et.size)?et.size:kt,P=K.isNumber(et.min)?et.min:(be=!0,K.findMinMulti(pt)),b=K.isNumber(et.max)?et.max:(ot=!0,K.findMaxMulti(pt)),W=b-P,le=W/(zt-1);return be&&(P=P-2*ut*le),ot&&(b=b+2*ut*le),{min:P,max:b}},dn.exports.create=function(pt,et){if(et=et||{},!pt||pt.length===0)return[];var be=K.isNumber(et.size)?et.size:kt,ot=K.isNumber(et.width)?et.width:mt,ut=Et.getUnifiedMinMax(pt,{size:be,width:ot,min:et.min,max:et.max}),zt=ut.min,P=ut.max,b=P-zt,W=b/(be-1);if(b===0)return[{x:zt,y:1}];for(var le=[],Ee=0;Ee<be;Ee++)le.push({x:zt+Ee*W,y:0});var ke=function(xe){return Math.floor((xe-zt)/W)},Tt=J(yt,ot),rt=Tt[ot],Dt=Tt[ot-1]-Tt[ot-2],Se=0;pt.forEach(function(xe){var Je=ke(xe);if(!(Je+ot<0||Je-ot>=le.length)){var Ot=Math.max(Je-ot,0),te=Je,ft=Math.min(Je+ot,le.length-1),wt=Ot-(Je-ot),Y=Je+ot-ft,gt=Tt[-ot-1+wt]||0,he=Tt[-ot-1+Y]||0,Oe=rt/(rt-gt-he);wt>0&&(Se+=Oe*(wt-1)*Dt);var Le=Math.max(0,Je-ot+1);K.inside(0,le.length-1,Le)&&(le[Le].y+=Oe*1*Dt),K.inside(0,le.length-1,te+1)&&(le[te+1].y-=Oe*2*Dt),K.inside(0,le.length-1,ft+1)&&(le[ft+1].y+=Oe*1*Dt)}});var _e=Se,ve=0,ne=0;return le.forEach(function(xe){ve+=xe.y,_e+=ve,xe.y=_e,ne+=_e}),ne>0&&le.forEach(function(xe){xe.y/=ne}),le};function J(pt,et){for(var be={},ot=0,ut=-et;ut<=et;ut++)ot+=pt(ut/et),be[ut]=ot;return be}dn.exports.getExpectedValueFromPdf=function(pt){if(!(!pt||pt.length===0)){var et=0;return pt.forEach(function(be){et+=be.x*be.y}),et}},dn.exports.getXWithLeftTailArea=function(pt,et){if(!(!pt||pt.length===0)){for(var be=0,ot=0,ut=0;ut<pt.length&&(ot=ut,be+=pt[ut].y,!(be>=et));ut++);return pt[ot].x}},dn.exports.getPerplexity=function(pt){if(!(!pt||pt.length===0)){var et=0;return pt.forEach(function(be){var ot=Math.log(be.y);isFinite(ot)&&(et+=be.y*ot)}),et=-et/k,Math.pow(2,et)}}},37824:function(dn,Pt,nt){var kt=nt(93738);(function(mt,k){dn.exports=k()})(this,function(){"use strict";function mt(Vt,Ct){if(!(Vt instanceof Ct))throw new TypeError("Cannot call a class as a function")}function k(Vt,Ct){for(var At=0;At<Ct.length;At++){var Nt=Ct[At];Nt.enumerable=Nt.enumerable||!1,Nt.configurable=!0,"value"in Nt&&(Nt.writable=!0),Object.defineProperty(Vt,Nt.key,Nt)}}function Et(Vt,Ct,At){return Ct&&k(Vt.prototype,Ct),At&&k(Vt,At),Vt}var K=function(){function Vt(Ct,At){this.next=null,this.key=Ct,this.data=At,this.left=null,this.right=null}return Vt}();function yt(Vt,Ct){return Vt>Ct?1:Vt<Ct?-1:0}function J(Vt,Ct,At){for(var Nt=new K(null,null),tt=Nt,vt=Nt;;){var Ht=At(Vt,Ct.key);if(Ht<0){if(Ct.left===null)break;if(At(Vt,Ct.left.key)<0){var de=Ct.left;if(Ct.left=de.right,de.right=Ct,Ct=de,Ct.left===null)break}vt.left=Ct,vt=Ct,Ct=Ct.left}else if(Ht>0){if(Ct.right===null)break;if(At(Vt,Ct.right.key)>0){var de=Ct.right;if(Ct.right=de.left,de.left=Ct,Ct=de,Ct.right===null)break}tt.right=Ct,tt=Ct,Ct=Ct.right}else break}return tt.right=Ct.left,vt.left=Ct.right,Ct.left=Nt.right,Ct.right=Nt.left,Ct}function pt(Vt,Ct,At,Nt){var tt=new K(Vt,Ct);if(At===null)return tt.left=tt.right=null,tt;At=J(Vt,At,Nt);var vt=Nt(Vt,At.key);return vt<0?(tt.left=At.left,tt.right=At,At.left=null):vt>=0&&(tt.right=At.right,tt.left=At,At.right=null),tt}function et(Vt,Ct,At){var Nt=null,tt=null;if(Ct){Ct=J(Vt,Ct,At);var vt=At(Ct.key,Vt);vt===0?(Nt=Ct.left,tt=Ct.right):vt<0?(tt=Ct.right,Ct.right=null,Nt=Ct):(Nt=Ct.left,Ct.left=null,tt=Ct)}return{left:Nt,right:tt}}function be(Vt,Ct,At){return Ct===null?Vt:(Vt===null||(Ct=J(Vt.key,Ct,At),Ct.left=Vt),Ct)}function ot(Vt,Ct,At,Nt,tt){if(Vt){Nt(""+Ct+(At?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+tt(Vt)+`
`);var vt=Ct+(At?"    ":"\u2502   ");Vt.left&&ot(Vt.left,vt,!1,Nt,tt),Vt.right&&ot(Vt.right,vt,!0,Nt,tt)}}var ut=function(){function Vt(Ct){Ct===void 0&&(Ct=yt),this._root=null,this._size=0,this._comparator=Ct}return Vt.prototype.insert=function(Ct,At){return this._size++,this._root=pt(Ct,At,this._root,this._comparator)},Vt.prototype.add=function(Ct,At){var Nt=new K(Ct,At);this._root===null&&(Nt.left=Nt.right=null,this._size++,this._root=Nt);var tt=this._comparator,vt=J(Ct,this._root,tt),Ht=tt(Ct,vt.key);return Ht===0?this._root=vt:(Ht<0?(Nt.left=vt.left,Nt.right=vt,vt.left=null):Ht>0&&(Nt.right=vt.right,Nt.left=vt,vt.right=null),this._size++,this._root=Nt),this._root},Vt.prototype.remove=function(Ct){this._root=this._remove(Ct,this._root,this._comparator)},Vt.prototype._remove=function(Ct,At,Nt){var tt;if(At===null)return null;At=J(Ct,At,Nt);var vt=Nt(Ct,At.key);return vt===0?(At.left===null?tt=At.right:(tt=J(Ct,At.left,Nt),tt.right=At.right),this._size--,tt):At},Vt.prototype.pop=function(){var Ct=this._root;if(Ct){for(;Ct.left;)Ct=Ct.left;return this._root=J(Ct.key,this._root,this._comparator),this._root=this._remove(Ct.key,this._root,this._comparator),{key:Ct.key,data:Ct.data}}return null},Vt.prototype.findStatic=function(Ct){for(var At=this._root,Nt=this._comparator;At;){var tt=Nt(Ct,At.key);if(tt===0)return At;tt<0?At=At.left:At=At.right}return null},Vt.prototype.find=function(Ct){return this._root&&(this._root=J(Ct,this._root,this._comparator),this._comparator(Ct,this._root.key)!==0)?null:this._root},Vt.prototype.contains=function(Ct){for(var At=this._root,Nt=this._comparator;At;){var tt=Nt(Ct,At.key);if(tt===0)return!0;tt<0?At=At.left:At=At.right}return!1},Vt.prototype.forEach=function(Ct,At){for(var Nt=this._root,tt=[],vt=!1;!vt;)Nt!==null?(tt.push(Nt),Nt=Nt.left):tt.length!==0?(Nt=tt.pop(),Ct.call(At,Nt),Nt=Nt.right):vt=!0;return this},Vt.prototype.range=function(Ct,At,Nt,tt){for(var vt=[],Ht=this._comparator,de=this._root,jt;vt.length!==0||de;)if(de)vt.push(de),de=de.left;else{if(de=vt.pop(),jt=Ht(de.key,At),jt>0)break;if(Ht(de.key,Ct)>=0&&Nt.call(tt,de))return this;de=de.right}return this},Vt.prototype.keys=function(){var Ct=[];return this.forEach(function(At){var Nt=At.key;return Ct.push(Nt)}),Ct},Vt.prototype.values=function(){var Ct=[];return this.forEach(function(At){var Nt=At.data;return Ct.push(Nt)}),Ct},Vt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},Vt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},Vt.prototype.minNode=function(Ct){if(Ct===void 0&&(Ct=this._root),Ct)for(;Ct.left;)Ct=Ct.left;return Ct},Vt.prototype.maxNode=function(Ct){if(Ct===void 0&&(Ct=this._root),Ct)for(;Ct.right;)Ct=Ct.right;return Ct},Vt.prototype.at=function(Ct){for(var At=this._root,Nt=!1,tt=0,vt=[];!Nt;)if(At)vt.push(At),At=At.left;else if(vt.length>0){if(At=vt.pop(),tt===Ct)return At;tt++,At=At.right}else Nt=!0;return null},Vt.prototype.next=function(Ct){var At=this._root,Nt=null;if(Ct.right){for(Nt=Ct.right;Nt.left;)Nt=Nt.left;return Nt}for(var tt=this._comparator;At;){var vt=tt(Ct.key,At.key);if(vt===0)break;vt<0?(Nt=At,At=At.left):At=At.right}return Nt},Vt.prototype.prev=function(Ct){var At=this._root,Nt=null;if(Ct.left!==null){for(Nt=Ct.left;Nt.right;)Nt=Nt.right;return Nt}for(var tt=this._comparator;At;){var vt=tt(Ct.key,At.key);if(vt===0)break;vt<0?At=At.left:(Nt=At,At=At.right)}return Nt},Vt.prototype.clear=function(){return this._root=null,this._size=0,this},Vt.prototype.toList=function(){return b(this._root)},Vt.prototype.load=function(Ct,At,Nt){At===void 0&&(At=[]),Nt===void 0&&(Nt=!1);var tt=Ct.length,vt=this._comparator;if(Nt&&Ee(Ct,At,0,tt-1,vt),this._root===null)this._root=zt(Ct,At,0,tt),this._size=tt;else{var Ht=le(this.toList(),P(Ct,At),vt);tt=this._size+tt,this._root=W({head:Ht},0,tt)}return this},Vt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(Vt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Vt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Vt.prototype.toString=function(Ct){Ct===void 0&&(Ct=function(tt){return String(tt.key)});var At=[];return ot(this._root,"",!0,function(Nt){return At.push(Nt)},Ct),At.join("")},Vt.prototype.update=function(Ct,At,Nt){var tt=this._comparator,vt=et(Ct,this._root,tt),Ht=vt.left,de=vt.right;tt(Ct,At)<0?de=pt(At,Nt,de,tt):Ht=pt(At,Nt,Ht,tt),this._root=be(Ht,de,tt)},Vt.prototype.split=function(Ct){return et(Ct,this._root,this._comparator)},Vt}();function zt(Vt,Ct,At,Nt){var tt=Nt-At;if(tt>0){var vt=At+Math.floor(tt/2),Ht=Vt[vt],de=Ct[vt],jt=new K(Ht,de);return jt.left=zt(Vt,Ct,At,vt),jt.right=zt(Vt,Ct,vt+1,Nt),jt}return null}function P(Vt,Ct){for(var At=new K(null,null),Nt=At,tt=0;tt<Vt.length;tt++)Nt=Nt.next=new K(Vt[tt],Ct[tt]);return Nt.next=null,At.next}function b(Vt){for(var Ct=Vt,At=[],Nt=!1,tt=new K(null,null),vt=tt;!Nt;)Ct?(At.push(Ct),Ct=Ct.left):At.length>0?(Ct=vt=vt.next=At.pop(),Ct=Ct.right):Nt=!0;return vt.next=null,tt.next}function W(Vt,Ct,At){var Nt=At-Ct;if(Nt>0){var tt=Ct+Math.floor(Nt/2),vt=W(Vt,Ct,tt),Ht=Vt.head;return Ht.left=vt,Vt.head=Vt.head.next,Ht.right=W(Vt,tt+1,At),Ht}return null}function le(Vt,Ct,At){for(var Nt=new K(null,null),tt=Nt,vt=Vt,Ht=Ct;vt!==null&&Ht!==null;)At(vt.key,Ht.key)<0?(tt.next=vt,vt=vt.next):(tt.next=Ht,Ht=Ht.next),tt=tt.next;return vt!==null?tt.next=vt:Ht!==null&&(tt.next=Ht),Nt.next}function Ee(Vt,Ct,At,Nt,tt){if(!(At>=Nt)){for(var vt=Vt[At+Nt>>1],Ht=At-1,de=Nt+1;;){do Ht++;while(tt(Vt[Ht],vt)<0);do de--;while(tt(Vt[de],vt)>0);if(Ht>=de)break;var jt=Vt[Ht];Vt[Ht]=Vt[de],Vt[de]=jt,jt=Ct[Ht],Ct[Ht]=Ct[de],Ct[de]=jt}Ee(Vt,Ct,At,de,tt),Ee(Vt,Ct,de+1,Nt,tt)}}var ke=function(Ct,At){return Ct.ll.x<=At.x&&At.x<=Ct.ur.x&&Ct.ll.y<=At.y&&At.y<=Ct.ur.y},Tt=function(Ct,At){if(At.ur.x<Ct.ll.x||Ct.ur.x<At.ll.x||At.ur.y<Ct.ll.y||Ct.ur.y<At.ll.y)return null;var Nt=Ct.ll.x<At.ll.x?At.ll.x:Ct.ll.x,tt=Ct.ur.x<At.ur.x?Ct.ur.x:At.ur.x,vt=Ct.ll.y<At.ll.y?At.ll.y:Ct.ll.y,Ht=Ct.ur.y<At.ur.y?Ct.ur.y:At.ur.y;return{ll:{x:Nt,y:vt},ur:{x:tt,y:Ht}}},rt=Number.EPSILON;rt===void 0&&(rt=Math.pow(2,-52));var Dt=rt*rt,Se=function(Ct,At){if(-rt<Ct&&Ct<rt&&-rt<At&&At<rt)return 0;var Nt=Ct-At;return Nt*Nt<Dt*Ct*At?0:Ct<At?-1:1},_e=function(){function Vt(){mt(this,Vt),this.reset()}return Et(Vt,[{key:"reset",value:function(){this.xRounder=new ve,this.yRounder=new ve}},{key:"round",value:function(At,Nt){return{x:this.xRounder.round(At),y:this.yRounder.round(Nt)}}}]),Vt}(),ve=function(){function Vt(){mt(this,Vt),this.tree=new ut,this.round(0)}return Et(Vt,[{key:"round",value:function(At){var Nt=this.tree.add(At),tt=this.tree.prev(Nt);if(tt!==null&&Se(Nt.key,tt.key)===0)return this.tree.remove(At),tt.key;var vt=this.tree.next(Nt);return vt!==null&&Se(Nt.key,vt.key)===0?(this.tree.remove(At),vt.key):At}}]),Vt}(),ne=new _e,xe=function(Ct,At){return Ct.x*At.y-Ct.y*At.x},Je=function(Ct,At){return Ct.x*At.x+Ct.y*At.y},Ot=function(Ct,At,Nt){var tt={x:At.x-Ct.x,y:At.y-Ct.y},vt={x:Nt.x-Ct.x,y:Nt.y-Ct.y},Ht=xe(tt,vt);return Se(Ht,0)},te=function(Ct){return Math.sqrt(Je(Ct,Ct))},ft=function(Ct,At,Nt){var tt={x:At.x-Ct.x,y:At.y-Ct.y},vt={x:Nt.x-Ct.x,y:Nt.y-Ct.y};return xe(vt,tt)/te(vt)/te(tt)},wt=function(Ct,At,Nt){var tt={x:At.x-Ct.x,y:At.y-Ct.y},vt={x:Nt.x-Ct.x,y:Nt.y-Ct.y};return Je(vt,tt)/te(vt)/te(tt)},Y=function(Ct,At,Nt){return At.y===0?null:{x:Ct.x+At.x/At.y*(Nt-Ct.y),y:Nt}},gt=function(Ct,At,Nt){return At.x===0?null:{x:Nt,y:Ct.y+At.y/At.x*(Nt-Ct.x)}},he=function(Ct,At,Nt,tt){if(At.x===0)return gt(Nt,tt,Ct.x);if(tt.x===0)return gt(Ct,At,Nt.x);if(At.y===0)return Y(Nt,tt,Ct.y);if(tt.y===0)return Y(Ct,At,Nt.y);var vt=xe(At,tt);if(vt==0)return null;var Ht={x:Nt.x-Ct.x,y:Nt.y-Ct.y},de=xe(Ht,At)/vt,jt=xe(Ht,tt)/vt,Ie=Ct.x+jt*At.x,We=Nt.x+de*tt.x,Ke=Ct.y+jt*At.y,pr=Nt.y+de*tt.y,lr=(Ie+We)/2,Nr=(Ke+pr)/2;return{x:lr,y:Nr}},Oe=function(){Et(Vt,null,[{key:"compare",value:function(At,Nt){var tt=Vt.comparePoints(At.point,Nt.point);return tt!==0?tt:(At.point!==Nt.point&&At.link(Nt),At.isLeft!==Nt.isLeft?At.isLeft?1:-1:Ve.compare(At.segment,Nt.segment))}},{key:"comparePoints",value:function(At,Nt){return At.x<Nt.x?-1:At.x>Nt.x?1:At.y<Nt.y?-1:At.y>Nt.y?1:0}}]);function Vt(Ct,At){mt(this,Vt),Ct.events===void 0?Ct.events=[this]:Ct.events.push(this),this.point=Ct,this.isLeft=At}return Et(Vt,[{key:"link",value:function(At){if(At.point===this.point)throw new Error("Tried to link already linked events");for(var Nt=At.point.events,tt=0,vt=Nt.length;tt<vt;tt++){var Ht=Nt[tt];this.point.events.push(Ht),Ht.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var At=this.point.events.length,Nt=0;Nt<At;Nt++){var tt=this.point.events[Nt];if(tt.segment.consumedBy===void 0)for(var vt=Nt+1;vt<At;vt++){var Ht=this.point.events[vt];Ht.consumedBy===void 0&&tt.otherSE.point.events===Ht.otherSE.point.events&&tt.segment.consume(Ht.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var At=[],Nt=0,tt=this.point.events.length;Nt<tt;Nt++){var vt=this.point.events[Nt];vt!==this&&!vt.segment.ringOut&&vt.segment.isInResult()&&At.push(vt)}return At}},{key:"getLeftmostComparator",value:function(At){var Nt=this,tt=new Map,vt=function(de){var jt=de.otherSE;tt.set(de,{sine:ft(Nt.point,At.point,jt.point),cosine:wt(Nt.point,At.point,jt.point)})};return function(Ht,de){tt.has(Ht)||vt(Ht),tt.has(de)||vt(de);var jt=tt.get(Ht),Ie=jt.sine,We=jt.cosine,Ke=tt.get(de),pr=Ke.sine,lr=Ke.cosine;return Ie>=0&&pr>=0?We<lr?1:We>lr?-1:0:Ie<0&&pr<0?We<lr?-1:We>lr?1:0:pr<Ie?-1:pr>Ie?1:0}}}]),Vt}(),Le=0,Ve=function(){Et(Vt,null,[{key:"compare",value:function(At,Nt){var tt=At.leftSE.point.x,vt=Nt.leftSE.point.x,Ht=At.rightSE.point.x,de=Nt.rightSE.point.x;if(de<tt)return 1;if(Ht<vt)return-1;var jt=At.leftSE.point.y,Ie=Nt.leftSE.point.y,We=At.rightSE.point.y,Ke=Nt.rightSE.point.y;if(tt<vt){if(Ie<jt&&Ie<We)return 1;if(Ie>jt&&Ie>We)return-1;var pr=At.comparePoint(Nt.leftSE.point);if(pr<0)return 1;if(pr>0)return-1;var lr=Nt.comparePoint(At.rightSE.point);return lr!==0?lr:-1}if(tt>vt){if(jt<Ie&&jt<Ke)return-1;if(jt>Ie&&jt>Ke)return 1;var Nr=Nt.comparePoint(At.leftSE.point);if(Nr!==0)return Nr;var Pr=At.comparePoint(Nt.rightSE.point);return Pr<0?1:Pr>0?-1:1}if(jt<Ie)return-1;if(jt>Ie)return 1;if(Ht<de){var Gr=Nt.comparePoint(At.rightSE.point);if(Gr!==0)return Gr}if(Ht>de){var Sn=At.comparePoint(Nt.rightSE.point);if(Sn<0)return 1;if(Sn>0)return-1}if(Ht!==de){var nn=We-jt,Nn=Ht-tt,Zn=Ke-Ie,Hn=de-vt;if(nn>Nn&&Zn<Hn)return 1;if(nn<Nn&&Zn>Hn)return-1}return Ht>de?1:Ht<de||We<Ke?-1:We>Ke?1:At.id<Nt.id?-1:At.id>Nt.id?1:0}}]);function Vt(Ct,At,Nt,tt){mt(this,Vt),this.id=++Le,this.leftSE=Ct,Ct.segment=this,Ct.otherSE=At,this.rightSE=At,At.segment=this,At.otherSE=Ct,this.rings=Nt,this.windings=tt}return Et(Vt,[{key:"replaceRightSE",value:function(At){this.rightSE=At,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var At=this.leftSE.point.y,Nt=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:At<Nt?At:Nt},ur:{x:this.rightSE.point.x,y:At>Nt?At:Nt}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(At){return At.x===this.leftSE.point.x&&At.y===this.leftSE.point.y||At.x===this.rightSE.point.x&&At.y===this.rightSE.point.y}},{key:"comparePoint",value:function(At){if(this.isAnEndpoint(At))return 0;var Nt=this.leftSE.point,tt=this.rightSE.point,vt=this.vector();if(Nt.x===tt.x)return At.x===Nt.x?0:At.x<Nt.x?1:-1;var Ht=(At.y-Nt.y)/vt.y,de=Nt.x+Ht*vt.x;if(At.x===de)return 0;var jt=(At.x-Nt.x)/vt.x,Ie=Nt.y+jt*vt.y;return At.y===Ie?0:At.y<Ie?-1:1}},{key:"getIntersection",value:function(At){var Nt=this.bbox(),tt=At.bbox(),vt=Tt(Nt,tt);if(vt===null)return null;var Ht=this.leftSE.point,de=this.rightSE.point,jt=At.leftSE.point,Ie=At.rightSE.point,We=ke(Nt,jt)&&this.comparePoint(jt)===0,Ke=ke(tt,Ht)&&At.comparePoint(Ht)===0,pr=ke(Nt,Ie)&&this.comparePoint(Ie)===0,lr=ke(tt,de)&&At.comparePoint(de)===0;if(Ke&&We)return lr&&!pr?de:!lr&&pr?Ie:null;if(Ke)return pr&&Ht.x===Ie.x&&Ht.y===Ie.y?null:Ht;if(We)return lr&&de.x===jt.x&&de.y===jt.y?null:jt;if(lr&&pr)return null;if(lr)return de;if(pr)return Ie;var Nr=he(Ht,this.vector(),jt,At.vector());return Nr===null||!ke(vt,Nr)?null:ne.round(Nr.x,Nr.y)}},{key:"split",value:function(At){var Nt=[],tt=At.events!==void 0,vt=new Oe(At,!0),Ht=new Oe(At,!1),de=this.rightSE;this.replaceRightSE(Ht),Nt.push(Ht),Nt.push(vt);var jt=new Vt(vt,de,this.rings.slice(),this.windings.slice());return Oe.comparePoints(jt.leftSE.point,jt.rightSE.point)>0&&jt.swapEvents(),Oe.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),tt&&(vt.checkForConsuming(),Ht.checkForConsuming()),Nt}},{key:"swapEvents",value:function(){var At=this.rightSE;this.rightSE=this.leftSE,this.leftSE=At,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var Nt=0,tt=this.windings.length;Nt<tt;Nt++)this.windings[Nt]*=-1}},{key:"consume",value:function(At){for(var Nt=this,tt=At;Nt.consumedBy;)Nt=Nt.consumedBy;for(;tt.consumedBy;)tt=tt.consumedBy;var vt=Vt.compare(Nt,tt);if(vt!==0){if(vt>0){var Ht=Nt;Nt=tt,tt=Ht}if(Nt.prev===tt){var de=Nt;Nt=tt,tt=de}for(var jt=0,Ie=tt.rings.length;jt<Ie;jt++){var We=tt.rings[jt],Ke=tt.windings[jt],pr=Nt.rings.indexOf(We);pr===-1?(Nt.rings.push(We),Nt.windings.push(Ke)):Nt.windings[pr]+=Ke}tt.rings=null,tt.windings=null,tt.consumedBy=Nt,tt.leftSE.consumedBy=Nt.leftSE,tt.rightSE.consumedBy=Nt.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var At=this.prev.consumedBy||this.prev;this._beforeState=At.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var At=this.beforeState();this._afterState={rings:At.rings.slice(0),windings:At.windings.slice(0),multiPolys:[]};for(var Nt=this._afterState.rings,tt=this._afterState.windings,vt=this._afterState.multiPolys,Ht=0,de=this.rings.length;Ht<de;Ht++){var jt=this.rings[Ht],Ie=this.windings[Ht],We=Nt.indexOf(jt);We===-1?(Nt.push(jt),tt.push(Ie)):tt[We]+=Ie}for(var Ke=[],pr=[],lr=0,Nr=Nt.length;lr<Nr;lr++)if(tt[lr]!==0){var Pr=Nt[lr],Gr=Pr.poly;if(pr.indexOf(Gr)===-1)if(Pr.isExterior)Ke.push(Gr);else{pr.indexOf(Gr)===-1&&pr.push(Gr);var Sn=Ke.indexOf(Pr.poly);Sn!==-1&&Ke.splice(Sn,1)}}for(var nn=0,Nn=Ke.length;nn<Nn;nn++){var Zn=Ke[nn].multiPoly;vt.indexOf(Zn)===-1&&vt.push(Zn)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var At=this.beforeState().multiPolys,Nt=this.afterState().multiPolys;switch($t.type){case"union":{var tt=At.length===0,vt=Nt.length===0;this._isInResult=tt!==vt;break}case"intersection":{var Ht,de;At.length<Nt.length?(Ht=At.length,de=Nt.length):(Ht=Nt.length,de=At.length),this._isInResult=de===$t.numMultiPolys&&Ht<de;break}case"xor":{var jt=Math.abs(At.length-Nt.length);this._isInResult=jt%2===1;break}case"difference":{var Ie=function(Ke){return Ke.length===1&&Ke[0].isSubject};this._isInResult=Ie(At)!==Ie(Nt);break}default:throw new Error("Unrecognized operation type found ".concat($t.type))}return this._isInResult}}],[{key:"fromRing",value:function(At,Nt,tt){var vt,Ht,de,jt=Oe.comparePoints(At,Nt);if(jt<0)vt=At,Ht=Nt,de=1;else if(jt>0)vt=Nt,Ht=At,de=-1;else throw new Error("Tried to create degenerate segment at [".concat(At.x,", ").concat(At.y,"]"));var Ie=new Oe(vt,!0),We=new Oe(Ht,!1);return new Vt(Ie,We,[tt],[de])}}]),Vt}(),Bt=function(){function Vt(Ct,At,Nt){if(mt(this,Vt),!Array.isArray(Ct)||Ct.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=At,this.isExterior=Nt,this.segments=[],typeof Ct[0][0]!="number"||typeof Ct[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var tt=ne.round(Ct[0][0],Ct[0][1]);this.bbox={ll:{x:tt.x,y:tt.y},ur:{x:tt.x,y:tt.y}};for(var vt=tt,Ht=1,de=Ct.length;Ht<de;Ht++){if(typeof Ct[Ht][0]!="number"||typeof Ct[Ht][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var jt=ne.round(Ct[Ht][0],Ct[Ht][1]);jt.x===vt.x&&jt.y===vt.y||(this.segments.push(Ve.fromRing(vt,jt,this)),jt.x<this.bbox.ll.x&&(this.bbox.ll.x=jt.x),jt.y<this.bbox.ll.y&&(this.bbox.ll.y=jt.y),jt.x>this.bbox.ur.x&&(this.bbox.ur.x=jt.x),jt.y>this.bbox.ur.y&&(this.bbox.ur.y=jt.y),vt=jt)}(tt.x!==vt.x||tt.y!==vt.y)&&this.segments.push(Ve.fromRing(vt,tt,this))}return Et(Vt,[{key:"getSweepEvents",value:function(){for(var At=[],Nt=0,tt=this.segments.length;Nt<tt;Nt++){var vt=this.segments[Nt];At.push(vt.leftSE),At.push(vt.rightSE)}return At}}]),Vt}(),re=function(){function Vt(Ct,At){if(mt(this,Vt),!Array.isArray(Ct))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Bt(Ct[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var Nt=1,tt=Ct.length;Nt<tt;Nt++){var vt=new Bt(Ct[Nt],this,!1);vt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=vt.bbox.ll.x),vt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=vt.bbox.ll.y),vt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=vt.bbox.ur.x),vt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=vt.bbox.ur.y),this.interiorRings.push(vt)}this.multiPoly=At}return Et(Vt,[{key:"getSweepEvents",value:function(){for(var At=this.exteriorRing.getSweepEvents(),Nt=0,tt=this.interiorRings.length;Nt<tt;Nt++)for(var vt=this.interiorRings[Nt].getSweepEvents(),Ht=0,de=vt.length;Ht<de;Ht++)At.push(vt[Ht]);return At}}]),Vt}(),ye=function(){function Vt(Ct,At){if(mt(this,Vt),!Array.isArray(Ct))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof Ct[0][0][0]=="number"&&(Ct=[Ct])}catch(Ht){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var Nt=0,tt=Ct.length;Nt<tt;Nt++){var vt=new re(Ct[Nt],this);vt.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=vt.bbox.ll.x),vt.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=vt.bbox.ll.y),vt.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=vt.bbox.ur.x),vt.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=vt.bbox.ur.y),this.polys.push(vt)}this.isSubject=At}return Et(Vt,[{key:"getSweepEvents",value:function(){for(var At=[],Nt=0,tt=this.polys.length;Nt<tt;Nt++)for(var vt=this.polys[Nt].getSweepEvents(),Ht=0,de=vt.length;Ht<de;Ht++)At.push(vt[Ht]);return At}}]),Vt}(),Yt=function(){Et(Vt,null,[{key:"factory",value:function(At){for(var Nt=[],tt=0,vt=At.length;tt<vt;tt++){var Ht=At[tt];if(!(!Ht.isInResult()||Ht.ringOut)){for(var de=null,jt=Ht.leftSE,Ie=Ht.rightSE,We=[jt],Ke=jt.point,pr=[];de=jt,jt=Ie,We.push(jt),jt.point!==Ke;)for(;;){var lr=jt.getAvailableLinkedEvents();if(lr.length===0){var Nr=We[0].point,Pr=We[We.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Nr.x,",")+" ".concat(Nr.y,"]. Last matching segment found ends at")+" [".concat(Pr.x,", ").concat(Pr.y,"]."))}if(lr.length===1){Ie=lr[0].otherSE;break}for(var Gr=null,Sn=0,nn=pr.length;Sn<nn;Sn++)if(pr[Sn].point===jt.point){Gr=Sn;break}if(Gr!==null){var Nn=pr.splice(Gr)[0],Zn=We.splice(Nn.index);Zn.unshift(Zn[0].otherSE),Nt.push(new Vt(Zn.reverse()));continue}pr.push({index:We.length,point:jt.point});var Hn=jt.getLeftmostComparator(de);Ie=lr.sort(Hn)[0].otherSE;break}Nt.push(new Vt(We))}}return Nt}}]);function Vt(Ct){mt(this,Vt),this.events=Ct;for(var At=0,Nt=Ct.length;At<Nt;At++)Ct[At].segment.ringOut=this;this.poly=null}return Et(Vt,[{key:"getGeom",value:function(){for(var At=this.events[0].point,Nt=[At],tt=1,vt=this.events.length-1;tt<vt;tt++){var Ht=this.events[tt].point,de=this.events[tt+1].point;Ot(Ht,At,de)!==0&&(Nt.push(Ht),At=Ht)}if(Nt.length===1)return null;var jt=Nt[0],Ie=Nt[1];Ot(jt,At,Ie)===0&&Nt.shift(),Nt.push(Nt[0]);for(var We=this.isExteriorRing()?1:-1,Ke=this.isExteriorRing()?0:Nt.length-1,pr=this.isExteriorRing()?Nt.length:-1,lr=[],Nr=Ke;Nr!=pr;Nr+=We)lr.push([Nt[Nr].x,Nt[Nr].y]);return lr}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var At=this.enclosingRing();this._isExteriorRing=At?!At.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var At=this.events[0],Nt=1,tt=this.events.length;Nt<tt;Nt++){var vt=this.events[Nt];Oe.compare(At,vt)>0&&(At=vt)}for(var Ht=At.segment.prevInResult(),de=Ht?Ht.prevInResult():null;;){if(!Ht)return null;if(!de)return Ht.ringOut;if(de.ringOut!==Ht.ringOut)return de.ringOut.enclosingRing()!==Ht.ringOut?Ht.ringOut:Ht.ringOut.enclosingRing();Ht=de.prevInResult(),de=Ht?Ht.prevInResult():null}}}]),Vt}(),qe=function(){function Vt(Ct){mt(this,Vt),this.exteriorRing=Ct,Ct.poly=this,this.interiorRings=[]}return Et(Vt,[{key:"addInterior",value:function(At){this.interiorRings.push(At),At.poly=this}},{key:"getGeom",value:function(){var At=[this.exteriorRing.getGeom()];if(At[0]===null)return null;for(var Nt=0,tt=this.interiorRings.length;Nt<tt;Nt++){var vt=this.interiorRings[Nt].getGeom();vt!==null&&At.push(vt)}return At}}]),Vt}(),vr=function(){function Vt(Ct){mt(this,Vt),this.rings=Ct,this.polys=this._composePolys(Ct)}return Et(Vt,[{key:"getGeom",value:function(){for(var At=[],Nt=0,tt=this.polys.length;Nt<tt;Nt++){var vt=this.polys[Nt].getGeom();vt!==null&&At.push(vt)}return At}},{key:"_composePolys",value:function(At){for(var Nt=[],tt=0,vt=At.length;tt<vt;tt++){var Ht=At[tt];if(!Ht.poly)if(Ht.isExteriorRing())Nt.push(new qe(Ht));else{var de=Ht.enclosingRing();de.poly||Nt.push(new qe(de)),de.poly.addInterior(Ht)}}return Nt}}]),Vt}(),oe=function(){function Vt(Ct){var At=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ve.compare;mt(this,Vt),this.queue=Ct,this.tree=new ut(At),this.segments=[]}return Et(Vt,[{key:"process",value:function(At){var Nt=At.segment,tt=[];if(At.consumedBy)return At.isLeft?this.queue.remove(At.otherSE):this.tree.remove(Nt),tt;var vt=At.isLeft?this.tree.insert(Nt):this.tree.find(Nt);if(!vt)throw new Error("Unable to find segment #".concat(Nt.id," ")+"[".concat(Nt.leftSE.point.x,", ").concat(Nt.leftSE.point.y,"] -> ")+"[".concat(Nt.rightSE.point.x,", ").concat(Nt.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Ht=vt,de=vt,jt=void 0,Ie=void 0;jt===void 0;)Ht=this.tree.prev(Ht),Ht===null?jt=null:Ht.key.consumedBy===void 0&&(jt=Ht.key);for(;Ie===void 0;)de=this.tree.next(de),de===null?Ie=null:de.key.consumedBy===void 0&&(Ie=de.key);if(At.isLeft){var We=null;if(jt){var Ke=jt.getIntersection(Nt);if(Ke!==null&&(Nt.isAnEndpoint(Ke)||(We=Ke),!jt.isAnEndpoint(Ke)))for(var pr=this._splitSafely(jt,Ke),lr=0,Nr=pr.length;lr<Nr;lr++)tt.push(pr[lr])}var Pr=null;if(Ie){var Gr=Ie.getIntersection(Nt);if(Gr!==null&&(Nt.isAnEndpoint(Gr)||(Pr=Gr),!Ie.isAnEndpoint(Gr)))for(var Sn=this._splitSafely(Ie,Gr),nn=0,Nn=Sn.length;nn<Nn;nn++)tt.push(Sn[nn])}if(We!==null||Pr!==null){var Zn=null;if(We===null)Zn=Pr;else if(Pr===null)Zn=We;else{var Hn=Oe.comparePoints(We,Pr);Zn=Hn<=0?We:Pr}this.queue.remove(Nt.rightSE),tt.push(Nt.rightSE);for(var An=Nt.split(Zn),$n=0,Rt=An.length;$n<Rt;$n++)tt.push(An[$n])}tt.length>0?(this.tree.remove(Nt),tt.push(At)):(this.segments.push(Nt),Nt.prev=jt)}else{if(jt&&Ie){var Xt=jt.getIntersection(Ie);if(Xt!==null){if(!jt.isAnEndpoint(Xt))for(var ae=this._splitSafely(jt,Xt),we=0,Ge=ae.length;we<Ge;we++)tt.push(ae[we]);if(!Ie.isAnEndpoint(Xt))for(var cr=this._splitSafely(Ie,Xt),br=0,Ce=cr.length;br<Ce;br++)tt.push(cr[br])}}this.tree.remove(Nt)}return tt}},{key:"_splitSafely",value:function(At,Nt){this.tree.remove(At);var tt=At.rightSE;this.queue.remove(tt);var vt=At.split(Nt);return vt.push(tt),At.consumedBy===void 0&&this.tree.insert(At),vt}}]),Vt}(),qt=typeof kt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,bt=typeof kt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Wt=function(){function Vt(){mt(this,Vt)}return Et(Vt,[{key:"run",value:function(At,Nt,tt){$t.type=At,ne.reset();for(var vt=[new ye(Nt,!0)],Ht=0,de=tt.length;Ht<de;Ht++)vt.push(new ye(tt[Ht],!1));if($t.numMultiPolys=vt.length,$t.type==="difference")for(var jt=vt[0],Ie=1;Ie<vt.length;)Tt(vt[Ie].bbox,jt.bbox)!==null?Ie++:vt.splice(Ie,1);if($t.type==="intersection"){for(var We=0,Ke=vt.length;We<Ke;We++)for(var pr=vt[We],lr=We+1,Nr=vt.length;lr<Nr;lr++)if(Tt(pr.bbox,vt[lr].bbox)===null)return[]}for(var Pr=new ut(Oe.compare),Gr=0,Sn=vt.length;Gr<Sn;Gr++)for(var nn=vt[Gr].getSweepEvents(),Nn=0,Zn=nn.length;Nn<Zn;Nn++)if(Pr.insert(nn[Nn]),Pr.size>qt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Hn=new oe(Pr),An=Pr.size,$n=Pr.pop();$n;){var Rt=$n.key;if(Pr.size===An){var Xt=Rt.segment;throw new Error("Unable to pop() ".concat(Rt.isLeft?"left":"right"," SweepEvent ")+"[".concat(Rt.point.x,", ").concat(Rt.point.y,"] from segment #").concat(Xt.id," ")+"[".concat(Xt.leftSE.point.x,", ").concat(Xt.leftSE.point.y,"] -> ")+"[".concat(Xt.rightSE.point.x,", ").concat(Xt.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Pr.size>qt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Hn.segments.length>bt)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var ae=Hn.process(Rt),we=0,Ge=ae.length;we<Ge;we++){var cr=ae[we];cr.consumedBy===void 0&&Pr.insert(cr)}An=Pr.size,$n=Pr.pop()}ne.reset();var br=Yt.factory(Hn.segments),Ce=new vr(br);return Ce.getGeom()}}]),Vt}(),$t=new Wt,xt=function(Ct){for(var At=arguments.length,Nt=new Array(At>1?At-1:0),tt=1;tt<At;tt++)Nt[tt-1]=arguments[tt];return $t.run("union",Ct,Nt)},St=function(Ct){for(var At=arguments.length,Nt=new Array(At>1?At-1:0),tt=1;tt<At;tt++)Nt[tt-1]=arguments[tt];return $t.run("intersection",Ct,Nt)},ue=function(Ct){for(var At=arguments.length,Nt=new Array(At>1?At-1:0),tt=1;tt<At;tt++)Nt[tt-1]=arguments[tt];return $t.run("xor",Ct,Nt)},Pe=function(Ct){for(var At=arguments.length,Nt=new Array(At>1?At-1:0),tt=1;tt<At;tt++)Nt[tt-1]=arguments[tt];return $t.run("difference",Ct,Nt)},ze={union:xt,intersection:St,xor:ue,difference:Pe};return ze})},87488:function(dn,Pt,nt){"use strict";var kt=nt(79685);var mt=function(){return mt=Object.assign||function(zt){for(var P,b=1,W=arguments.length;b<W;b++){P=arguments[b];for(var le in P)Object.prototype.hasOwnProperty.call(P,le)&&(zt[le]=P[le])}return zt},mt.apply(this,arguments)};function k(ut,zt){var P={};for(var b in ut)Object.prototype.hasOwnProperty.call(ut,b)&&zt.indexOf(b)<0&&(P[b]=ut[b]);if(ut!=null&&typeof Object.getOwnPropertySymbols=="function")for(var W=0,b=Object.getOwnPropertySymbols(ut);W<b.length;W++)zt.indexOf(b[W])<0&&Object.prototype.propertyIsEnumerable.call(ut,b[W])&&(P[b[W]]=ut[b[W]]);return P}var Et=function(){return Math.random().toString(36).substring(6)},K=function(ut){var zt=ut.animate,P=ut.backgroundColor,b=ut.backgroundOpacity,W=ut.baseUrl,le=ut.children,Ee=ut.foregroundColor,ke=ut.foregroundOpacity,Tt=ut.gradientRatio,rt=ut.uniqueKey,Dt=ut.interval,Se=ut.rtl,_e=ut.speed,ve=ut.style,ne=ut.title,xe=k(ut,["animate","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","uniqueKey","interval","rtl","speed","style","title"]),Je=rt||Et(),Ot=Je+"-diff",te=Je+"-animated-diff",ft=Je+"-aria",wt=Se?{transform:"scaleX(-1)"}:null,Y="0; "+Dt+"; 1",gt=_e+"s";return(0,kt.createElement)("svg",mt({"aria-labelledby":ft,role:"img",style:mt(mt({},ve),wt)},xe),ne?(0,kt.createElement)("title",{id:ft},ne):null,(0,kt.createElement)("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+W+"#"+Ot+")",style:{fill:"url("+W+"#"+te+")"}}),(0,kt.createElement)("defs",{role:"presentation"},(0,kt.createElement)("clipPath",{id:Ot},le),(0,kt.createElement)("linearGradient",{id:te},(0,kt.createElement)("stop",{offset:"0%",stopColor:P,stopOpacity:b},zt&&(0,kt.createElement)("animate",{attributeName:"offset",values:-Tt+"; "+-Tt+"; 1",keyTimes:Y,dur:gt,repeatCount:"indefinite"})),(0,kt.createElement)("stop",{offset:"50%",stopColor:Ee,stopOpacity:ke},zt&&(0,kt.createElement)("animate",{attributeName:"offset",values:-Tt/2+"; "+-Tt/2+"; "+(1+Tt/2),keyTimes:Y,dur:gt,repeatCount:"indefinite"})),(0,kt.createElement)("stop",{offset:"100%",stopColor:P,stopOpacity:b},zt&&(0,kt.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+Tt),keyTimes:Y,dur:gt,repeatCount:"indefinite"})))))};K.defaultProps={animate:!0,backgroundColor:"#f5f6f7",backgroundOpacity:1,baseUrl:"",foregroundColor:"#eee",foregroundOpacity:1,gradientRatio:2,id:null,interval:.25,rtl:!1,speed:1.2,style:{},title:"Loading..."};var yt=function(ut){return ut.children?(0,kt.createElement)(K,mt({},ut)):(0,kt.createElement)(J,mt({},ut))},J=function(ut){return(0,kt.createElement)(yt,mt({viewBox:"0 0 476 124"},ut),(0,kt.createElement)("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),(0,kt.createElement)("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),(0,kt.createElement)("circle",{cx:"20",cy:"20",r:"20"}))},pt=function(ut){return createElement(yt,mt({viewBox:"0 0 400 460"},ut),createElement("circle",{cx:"31",cy:"31",r:"15"}),createElement("rect",{x:"58",y:"18",rx:"2",ry:"2",width:"140",height:"10"}),createElement("rect",{x:"58",y:"34",rx:"2",ry:"2",width:"140",height:"10"}),createElement("rect",{x:"0",y:"60",rx:"2",ry:"2",width:"400",height:"400"}))},et=function(ut){return createElement(yt,mt({viewBox:"0 0 340 84"},ut),createElement("rect",{x:"0",y:"0",width:"67",height:"11",rx:"3"}),createElement("rect",{x:"76",y:"0",width:"140",height:"11",rx:"3"}),createElement("rect",{x:"127",y:"48",width:"53",height:"11",rx:"3"}),createElement("rect",{x:"187",y:"48",width:"72",height:"11",rx:"3"}),createElement("rect",{x:"18",y:"48",width:"100",height:"11",rx:"3"}),createElement("rect",{x:"0",y:"71",width:"37",height:"11",rx:"3"}),createElement("rect",{x:"18",y:"23",width:"140",height:"11",rx:"3"}),createElement("rect",{x:"166",y:"23",width:"173",height:"11",rx:"3"}))},be=function(ut){return createElement(yt,mt({viewBox:"0 0 400 110"},ut),createElement("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"250",height:"10"}),createElement("rect",{x:"20",y:"20",rx:"3",ry:"3",width:"220",height:"10"}),createElement("rect",{x:"20",y:"40",rx:"3",ry:"3",width:"170",height:"10"}),createElement("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"250",height:"10"}),createElement("rect",{x:"20",y:"80",rx:"3",ry:"3",width:"200",height:"10"}),createElement("rect",{x:"20",y:"100",rx:"3",ry:"3",width:"80",height:"10"}))},ot=function(ut){return createElement(yt,mt({viewBox:"0 0 245 125"},ut),createElement("circle",{cx:"10",cy:"20",r:"8"}),createElement("rect",{x:"25",y:"15",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"50",r:"8"}),createElement("rect",{x:"25",y:"45",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"80",r:"8"}),createElement("rect",{x:"25",y:"75",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"110",r:"8"}),createElement("rect",{x:"25",y:"105",rx:"5",ry:"5",width:"220",height:"10"}))};Pt.ZP=yt},14299:function(dn,Pt,nt){var kt=nt(93738);var mt;(function(k){(function(Et){var K=typeof nt.g=="object"?nt.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),yt=J(k);typeof K.Reflect=="undefined"?K.Reflect=k:yt=J(K.Reflect,yt),Et(yt);function J(pt,et){return function(be,ot){typeof pt[be]!="function"&&Object.defineProperty(pt,be,{configurable:!0,writable:!0,value:ot}),et&&et(be,ot)}}})(function(Et){var K=Object.prototype.hasOwnProperty,yt=typeof Symbol=="function",J=yt&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",pt=yt&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",et=typeof Object.create=="function",be={__proto__:[]}instanceof Array,ot=!et&&!be,ut={create:et?function(){return de(Object.create(null))}:be?function(){return de({__proto__:null})}:function(){return de({})},has:ot?function(jt,Ie){return K.call(jt,Ie)}:function(jt,Ie){return Ie in jt},get:ot?function(jt,Ie){return K.call(jt,Ie)?jt[Ie]:void 0}:function(jt,Ie){return jt[Ie]}},zt=Object.getPrototypeOf(Function),P=typeof kt=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",b=!P&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:tt(),W=!P&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:vt(),le=!P&&typeof WeakMap=="function"?WeakMap:Ht(),Ee=new le;function ke(jt,Ie,We,Ke){if(re(We)){if(!$t(jt))throw new TypeError;if(!St(Ie))throw new TypeError;return Ot(jt,Ie)}else{if(!$t(jt))throw new TypeError;if(!qe(Ie))throw new TypeError;if(!qe(Ke)&&!re(Ke)&&!ye(Ke))throw new TypeError;return ye(Ke)&&(Ke=void 0),We=Wt(We),te(jt,Ie,We,Ke)}}Et("decorate",ke);function Tt(jt,Ie){function We(Ke,pr){if(!qe(Ke))throw new TypeError;if(!re(pr)&&!ue(pr))throw new TypeError;Oe(jt,Ie,Ke,pr)}return We}Et("metadata",Tt);function rt(jt,Ie,We,Ke){if(!qe(We))throw new TypeError;return re(Ke)||(Ke=Wt(Ke)),Oe(jt,Ie,We,Ke)}Et("defineMetadata",rt);function Dt(jt,Ie,We){if(!qe(Ie))throw new TypeError;return re(We)||(We=Wt(We)),wt(jt,Ie,We)}Et("hasMetadata",Dt);function Se(jt,Ie,We){if(!qe(Ie))throw new TypeError;return re(We)||(We=Wt(We)),Y(jt,Ie,We)}Et("hasOwnMetadata",Se);function _e(jt,Ie,We){if(!qe(Ie))throw new TypeError;return re(We)||(We=Wt(We)),gt(jt,Ie,We)}Et("getMetadata",_e);function ve(jt,Ie,We){if(!qe(Ie))throw new TypeError;return re(We)||(We=Wt(We)),he(jt,Ie,We)}Et("getOwnMetadata",ve);function ne(jt,Ie){if(!qe(jt))throw new TypeError;return re(Ie)||(Ie=Wt(Ie)),Le(jt,Ie)}Et("getMetadataKeys",ne);function xe(jt,Ie){if(!qe(jt))throw new TypeError;return re(Ie)||(Ie=Wt(Ie)),Ve(jt,Ie)}Et("getOwnMetadataKeys",xe);function Je(jt,Ie,We){if(!qe(Ie))throw new TypeError;re(We)||(We=Wt(We));var Ke=ft(Ie,We,!1);if(re(Ke)||!Ke.delete(jt))return!1;if(Ke.size>0)return!0;var pr=Ee.get(Ie);return pr.delete(We),pr.size>0||Ee.delete(Ie),!0}Et("deleteMetadata",Je);function Ot(jt,Ie){for(var We=jt.length-1;We>=0;--We){var Ke=jt[We],pr=Ke(Ie);if(!re(pr)&&!ye(pr)){if(!St(pr))throw new TypeError;Ie=pr}}return Ie}function te(jt,Ie,We,Ke){for(var pr=jt.length-1;pr>=0;--pr){var lr=jt[pr],Nr=lr(Ie,We,Ke);if(!re(Nr)&&!ye(Nr)){if(!qe(Nr))throw new TypeError;Ke=Nr}}return Ke}function ft(jt,Ie,We){var Ke=Ee.get(jt);if(re(Ke)){if(!We)return;Ke=new b,Ee.set(jt,Ke)}var pr=Ke.get(Ie);if(re(pr)){if(!We)return;pr=new b,Ke.set(Ie,pr)}return pr}function wt(jt,Ie,We){var Ke=Y(jt,Ie,We);if(Ke)return!0;var pr=Nt(Ie);return ye(pr)?!1:wt(jt,pr,We)}function Y(jt,Ie,We){var Ke=ft(Ie,We,!1);return re(Ke)?!1:qt(Ke.has(jt))}function gt(jt,Ie,We){var Ke=Y(jt,Ie,We);if(Ke)return he(jt,Ie,We);var pr=Nt(Ie);if(!ye(pr))return gt(jt,pr,We)}function he(jt,Ie,We){var Ke=ft(Ie,We,!1);if(!re(Ke))return Ke.get(jt)}function Oe(jt,Ie,We,Ke){var pr=ft(We,Ke,!0);pr.set(jt,Ie)}function Le(jt,Ie){var We=Ve(jt,Ie),Ke=Nt(jt);if(Ke===null)return We;var pr=Le(Ke,Ie);if(pr.length<=0)return We;if(We.length<=0)return pr;for(var lr=new W,Nr=[],Pr=0,Gr=We;Pr<Gr.length;Pr++){var Sn=Gr[Pr],nn=lr.has(Sn);nn||(lr.add(Sn),Nr.push(Sn))}for(var Nn=0,Zn=pr;Nn<Zn.length;Nn++){var Sn=Zn[Nn],nn=lr.has(Sn);nn||(lr.add(Sn),Nr.push(Sn))}return Nr}function Ve(jt,Ie){var We=[],Ke=ft(jt,Ie,!1);if(re(Ke))return We;for(var pr=Ke.keys(),lr=ze(pr),Nr=0;;){var Pr=Ct(lr);if(!Pr)return We.length=Nr,We;var Gr=Vt(Pr);try{We[Nr]=Gr}catch(Sn){try{At(lr)}finally{throw Sn}}Nr++}}function Bt(jt){if(jt===null)return 1;switch(typeof jt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return jt===null?1:6;default:return 6}}function re(jt){return jt===void 0}function ye(jt){return jt===null}function Yt(jt){return typeof jt=="symbol"}function qe(jt){return typeof jt=="object"?jt!==null:typeof jt=="function"}function vr(jt,Ie){switch(Bt(jt)){case 0:return jt;case 1:return jt;case 2:return jt;case 3:return jt;case 4:return jt;case 5:return jt}var We=Ie===3?"string":Ie===5?"number":"default",Ke=Pe(jt,J);if(Ke!==void 0){var pr=Ke.call(jt,We);if(qe(pr))throw new TypeError;return pr}return oe(jt,We==="default"?"number":We)}function oe(jt,Ie){if(Ie==="string"){var We=jt.toString;if(xt(We)){var Ke=We.call(jt);if(!qe(Ke))return Ke}var pr=jt.valueOf;if(xt(pr)){var Ke=pr.call(jt);if(!qe(Ke))return Ke}}else{var pr=jt.valueOf;if(xt(pr)){var Ke=pr.call(jt);if(!qe(Ke))return Ke}var lr=jt.toString;if(xt(lr)){var Ke=lr.call(jt);if(!qe(Ke))return Ke}}throw new TypeError}function qt(jt){return!!jt}function bt(jt){return""+jt}function Wt(jt){var Ie=vr(jt,3);return Yt(Ie)?Ie:bt(Ie)}function $t(jt){return Array.isArray?Array.isArray(jt):jt instanceof Object?jt instanceof Array:Object.prototype.toString.call(jt)==="[object Array]"}function xt(jt){return typeof jt=="function"}function St(jt){return typeof jt=="function"}function ue(jt){switch(Bt(jt)){case 3:return!0;case 4:return!0;default:return!1}}function Pe(jt,Ie){var We=jt[Ie];if(We!=null){if(!xt(We))throw new TypeError;return We}}function ze(jt){var Ie=Pe(jt,pt);if(!xt(Ie))throw new TypeError;var We=Ie.call(jt);if(!qe(We))throw new TypeError;return We}function Vt(jt){return jt.value}function Ct(jt){var Ie=jt.next();return Ie.done?!1:Ie}function At(jt){var Ie=jt.return;Ie&&Ie.call(jt)}function Nt(jt){var Ie=Object.getPrototypeOf(jt);if(typeof jt!="function"||jt===zt||Ie!==zt)return Ie;var We=jt.prototype,Ke=We&&Object.getPrototypeOf(We);if(Ke==null||Ke===Object.prototype)return Ie;var pr=Ke.constructor;return typeof pr!="function"||pr===jt?Ie:pr}function tt(){var jt={},Ie=[],We=function(){function Nr(Pr,Gr,Sn){this._index=0,this._keys=Pr,this._values=Gr,this._selector=Sn}return Nr.prototype["@@iterator"]=function(){return this},Nr.prototype[pt]=function(){return this},Nr.prototype.next=function(){var Pr=this._index;if(Pr>=0&&Pr<this._keys.length){var Gr=this._selector(this._keys[Pr],this._values[Pr]);return Pr+1>=this._keys.length?(this._index=-1,this._keys=Ie,this._values=Ie):this._index++,{value:Gr,done:!1}}return{value:void 0,done:!0}},Nr.prototype.throw=function(Pr){throw this._index>=0&&(this._index=-1,this._keys=Ie,this._values=Ie),Pr},Nr.prototype.return=function(Pr){return this._index>=0&&(this._index=-1,this._keys=Ie,this._values=Ie),{value:Pr,done:!0}},Nr}();return function(){function Nr(){this._keys=[],this._values=[],this._cacheKey=jt,this._cacheIndex=-2}return Object.defineProperty(Nr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Nr.prototype.has=function(Pr){return this._find(Pr,!1)>=0},Nr.prototype.get=function(Pr){var Gr=this._find(Pr,!1);return Gr>=0?this._values[Gr]:void 0},Nr.prototype.set=function(Pr,Gr){var Sn=this._find(Pr,!0);return this._values[Sn]=Gr,this},Nr.prototype.delete=function(Pr){var Gr=this._find(Pr,!1);if(Gr>=0){for(var Sn=this._keys.length,nn=Gr+1;nn<Sn;nn++)this._keys[nn-1]=this._keys[nn],this._values[nn-1]=this._values[nn];return this._keys.length--,this._values.length--,Pr===this._cacheKey&&(this._cacheKey=jt,this._cacheIndex=-2),!0}return!1},Nr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=jt,this._cacheIndex=-2},Nr.prototype.keys=function(){return new We(this._keys,this._values,Ke)},Nr.prototype.values=function(){return new We(this._keys,this._values,pr)},Nr.prototype.entries=function(){return new We(this._keys,this._values,lr)},Nr.prototype["@@iterator"]=function(){return this.entries()},Nr.prototype[pt]=function(){return this.entries()},Nr.prototype._find=function(Pr,Gr){return this._cacheKey!==Pr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Pr)),this._cacheIndex<0&&Gr&&(this._cacheIndex=this._keys.length,this._keys.push(Pr),this._values.push(void 0)),this._cacheIndex},Nr}();function Ke(Nr,Pr){return Nr}function pr(Nr,Pr){return Pr}function lr(Nr,Pr){return[Nr,Pr]}}function vt(){return function(){function jt(){this._map=new b}return Object.defineProperty(jt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),jt.prototype.has=function(Ie){return this._map.has(Ie)},jt.prototype.add=function(Ie){return this._map.set(Ie,Ie),this},jt.prototype.delete=function(Ie){return this._map.delete(Ie)},jt.prototype.clear=function(){this._map.clear()},jt.prototype.keys=function(){return this._map.keys()},jt.prototype.values=function(){return this._map.values()},jt.prototype.entries=function(){return this._map.entries()},jt.prototype["@@iterator"]=function(){return this.keys()},jt.prototype[pt]=function(){return this.keys()},jt}()}function Ht(){var jt=16,Ie=ut.create(),We=Ke();return function(){function Gr(){this._key=Ke()}return Gr.prototype.has=function(Sn){var nn=pr(Sn,!1);return nn!==void 0?ut.has(nn,this._key):!1},Gr.prototype.get=function(Sn){var nn=pr(Sn,!1);return nn!==void 0?ut.get(nn,this._key):void 0},Gr.prototype.set=function(Sn,nn){var Nn=pr(Sn,!0);return Nn[this._key]=nn,this},Gr.prototype.delete=function(Sn){var nn=pr(Sn,!1);return nn!==void 0?delete nn[this._key]:!1},Gr.prototype.clear=function(){this._key=Ke()},Gr}();function Ke(){var Gr;do Gr="@@WeakMap@@"+Pr();while(ut.has(Ie,Gr));return Ie[Gr]=!0,Gr}function pr(Gr,Sn){if(!K.call(Gr,We)){if(!Sn)return;Object.defineProperty(Gr,We,{value:ut.create()})}return Gr[We]}function lr(Gr,Sn){for(var nn=0;nn<Sn;++nn)Gr[nn]=Math.random()*255|0;return Gr}function Nr(Gr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Gr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Gr)):lr(new Uint8Array(Gr),Gr):lr(new Array(Gr),Gr)}function Pr(){var Gr=Nr(jt);Gr[6]=Gr[6]&79|64,Gr[8]=Gr[8]&191|128;for(var Sn="",nn=0;nn<jt;++nn){var Nn=Gr[nn];(nn===4||nn===6||nn===8)&&(Sn+="-"),Nn<16&&(Sn+="0"),Sn+=Nn.toString(16).toLowerCase()}return Sn}}function de(jt){return jt.__=void 0,delete jt.__,jt}})})(mt||(mt={}))},46612:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.SensorTabIndex=Pt.SensorClassName=Pt.SizeSensorId=void 0;var nt="size-sensor-id";Pt.SizeSensorId=nt;var kt="size-sensor-object";Pt.SensorClassName=kt;var mt="-1";Pt.SensorTabIndex=mt},51793:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.default=void 0;var nt=function(mt){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,Et=null;return function(){for(var K=this,yt=arguments.length,J=new Array(yt),pt=0;pt<yt;pt++)J[pt]=arguments[pt];clearTimeout(Et),Et=setTimeout(function(){mt.apply(K,J)},k)}};Pt.default=nt},8664:function(dn,Pt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.default=void 0;var nt=1,kt=function(){return"".concat(nt++)};Pt.default=kt},1375:function(dn,Pt,nt){"use strict";var kt;kt={value:!0},kt=kt=Pt.ak=void 0;var mt=nt(43337),k=function(J,pt){var et=(0,mt.getSensor)(J);return et.bind(pt),function(){et.unbind(pt)}};Pt.ak=k;var Et=function(J){var pt=(0,mt.getSensor)(J);(0,mt.removeSensor)(pt)};kt=Et;var K="1.0.1";kt=K},43337:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.removeSensor=Pt.getSensor=void 0;var kt=Et(nt(8664)),mt=nt(69075),k=nt(46612);function Et(pt){return pt&&pt.__esModule?pt:{default:pt}}var K={},yt=function(et){var be=et.getAttribute(k.SizeSensorId);if(be&&K[be])return K[be];var ot=(0,kt.default)();et.setAttribute(k.SizeSensorId,ot);var ut=(0,mt.createSensor)(et);return K[ot]=ut,ut};Pt.getSensor=yt;var J=function(et){var be=et.element.getAttribute(k.SizeSensorId);et.element.removeAttribute(k.SizeSensorId),et.destroy(),be&&K[be]&&delete K[be]};Pt.removeSensor=J},69075:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.createSensor=void 0;var kt=nt(94482),mt=nt(40763),k=typeof ResizeObserver!="undefined"?mt.createSensor:kt.createSensor;Pt.createSensor=k},94482:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.createSensor=void 0;var kt=k(nt(51793)),mt=nt(46612);function k(K){return K&&K.__esModule?K:{default:K}}var Et=function(yt){var J=void 0,pt=[],et=function(){getComputedStyle(yt).position==="static"&&(yt.style.position="relative");var b=document.createElement("object");return b.onload=function(){b.contentDocument.defaultView.addEventListener("resize",be),be()},b.style.display="block",b.style.position="absolute",b.style.top="0",b.style.left="0",b.style.height="100%",b.style.width="100%",b.style.overflow="hidden",b.style.pointerEvents="none",b.style.zIndex="-1",b.style.opacity="0",b.setAttribute("class",mt.SensorClassName),b.setAttribute("tabindex",mt.SensorTabIndex),b.type="text/html",yt.appendChild(b),b.data="about:blank",b},be=(0,kt.default)(function(){pt.forEach(function(P){P(yt)})}),ot=function(b){J||(J=et()),pt.indexOf(b)===-1&&pt.push(b)},ut=function(){J&&J.parentNode&&(J.contentDocument&&J.contentDocument.defaultView.removeEventListener("resize",be),J.parentNode.removeChild(J),J=void 0,pt=[])},zt=function(b){var W=pt.indexOf(b);W!==-1&&pt.splice(W,1),pt.length===0&&J&&ut()};return{element:yt,bind:ot,destroy:ut,unbind:zt}};Pt.createSensor=Et},40763:function(dn,Pt,nt){"use strict";Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.createSensor=void 0;var kt=mt(nt(51793));function mt(Et){return Et&&Et.__esModule?Et:{default:Et}}var k=function(K){var yt=void 0,J=[],pt=(0,kt.default)(function(){J.forEach(function(zt){zt(K)})}),et=function(){var P=new ResizeObserver(pt);return P.observe(K),pt(),P},be=function(P){yt||(yt=et()),J.indexOf(P)===-1&&J.push(P)},ot=function(){yt.disconnect(),J=[],yt=void 0},ut=function(P){var b=J.indexOf(P);b!==-1&&J.splice(b,1),J.length===0&&yt&&ot()};return{element:K,bind:be,destroy:ot,unbind:ut}};Pt.createSensor=k},39720:function(dn){(function(Pt,nt){dn.exports=nt()})(this,function(){"use strict";function Pt(Se,_e,ve,ne,xe,Je){if(!(xe-ne<=ve)){var Ot=ne+xe>>1;nt(Se,_e,Ot,ne,xe,Je%2),Pt(Se,_e,ve,ne,Ot-1,Je+1),Pt(Se,_e,ve,Ot+1,xe,Je+1)}}function nt(Se,_e,ve,ne,xe,Je){for(;xe>ne;){if(xe-ne>600){var Ot=xe-ne+1,te=ve-ne+1,ft=Math.log(Ot),wt=.5*Math.exp(2*ft/3),Y=.5*Math.sqrt(ft*wt*(Ot-wt)/Ot)*(te-Ot/2<0?-1:1),gt=Math.max(ne,Math.floor(ve-te*wt/Ot+Y)),he=Math.min(xe,Math.floor(ve+(Ot-te)*wt/Ot+Y));nt(Se,_e,ve,gt,he,Je)}var Oe=_e[2*ve+Je],Le=ne,Ve=xe;for(kt(Se,_e,ne,ve),_e[2*xe+Je]>Oe&&kt(Se,_e,ne,xe);Le<Ve;){for(kt(Se,_e,Le,Ve),Le++,Ve--;_e[2*Le+Je]<Oe;)Le++;for(;_e[2*Ve+Je]>Oe;)Ve--}_e[2*ne+Je]===Oe?kt(Se,_e,ne,Ve):(Ve++,kt(Se,_e,Ve,xe)),Ve<=ve&&(ne=Ve+1),ve<=Ve&&(xe=Ve-1)}}function kt(Se,_e,ve,ne){mt(Se,ve,ne),mt(_e,2*ve,2*ne),mt(_e,2*ve+1,2*ne+1)}function mt(Se,_e,ve){var ne=Se[_e];Se[_e]=Se[ve],Se[ve]=ne}function k(Se,_e,ve,ne,xe,Je,Ot){for(var te=[0,Se.length-1,0],ft=[],wt,Y;te.length;){var gt=te.pop(),he=te.pop(),Oe=te.pop();if(he-Oe<=Ot){for(var Le=Oe;Le<=he;Le++)wt=_e[2*Le],Y=_e[2*Le+1],wt>=ve&&wt<=xe&&Y>=ne&&Y<=Je&&ft.push(Se[Le]);continue}var Ve=Math.floor((Oe+he)/2);wt=_e[2*Ve],Y=_e[2*Ve+1],wt>=ve&&wt<=xe&&Y>=ne&&Y<=Je&&ft.push(Se[Ve]);var Bt=(gt+1)%2;(gt===0?ve<=wt:ne<=Y)&&(te.push(Oe),te.push(Ve-1),te.push(Bt)),(gt===0?xe>=wt:Je>=Y)&&(te.push(Ve+1),te.push(he),te.push(Bt))}return ft}function Et(Se,_e,ve,ne,xe,Je){for(var Ot=[0,Se.length-1,0],te=[],ft=xe*xe;Ot.length;){var wt=Ot.pop(),Y=Ot.pop(),gt=Ot.pop();if(Y-gt<=Je){for(var he=gt;he<=Y;he++)K(_e[2*he],_e[2*he+1],ve,ne)<=ft&&te.push(Se[he]);continue}var Oe=Math.floor((gt+Y)/2),Le=_e[2*Oe],Ve=_e[2*Oe+1];K(Le,Ve,ve,ne)<=ft&&te.push(Se[Oe]);var Bt=(wt+1)%2;(wt===0?ve-xe<=Le:ne-xe<=Ve)&&(Ot.push(gt),Ot.push(Oe-1),Ot.push(Bt)),(wt===0?ve+xe>=Le:ne+xe>=Ve)&&(Ot.push(Oe+1),Ot.push(Y),Ot.push(Bt))}return te}function K(Se,_e,ve,ne){var xe=Se-ve,Je=_e-ne;return xe*xe+Je*Je}var yt=function(Se){return Se[0]},J=function(Se){return Se[1]},pt=function(_e,ve,ne,xe,Je){ve===void 0&&(ve=yt),ne===void 0&&(ne=J),xe===void 0&&(xe=64),Je===void 0&&(Je=Float64Array),this.nodeSize=xe,this.points=_e;for(var Ot=_e.length<65536?Uint16Array:Uint32Array,te=this.ids=new Ot(_e.length),ft=this.coords=new Je(_e.length*2),wt=0;wt<_e.length;wt++)te[wt]=wt,ft[2*wt]=ve(_e[wt]),ft[2*wt+1]=ne(_e[wt]);Pt(te,ft,xe,0,te.length-1,0)};pt.prototype.range=function(_e,ve,ne,xe){return k(this.ids,this.coords,_e,ve,ne,xe,this.nodeSize)},pt.prototype.within=function(_e,ve,ne){return Et(this.ids,this.coords,_e,ve,ne,this.nodeSize)};var et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Se){return Se}},be=Math.fround||function(Se){return function(_e){return Se[0]=+_e,Se[0]}}(new Float32Array(1)),ot=function(_e){this.options=Tt(Object.create(et),_e),this.trees=new Array(this.options.maxZoom+1)};ot.prototype.load=function(_e){var ve=this.options,ne=ve.log,xe=ve.minZoom,Je=ve.maxZoom,Ot=ve.nodeSize;ne&&console.time("total time");var te="prepare "+_e.length+" points";ne&&console.time(te),this.points=_e;for(var ft=[],wt=0;wt<_e.length;wt++)_e[wt].geometry&&ft.push(zt(_e[wt],wt));this.trees[Je+1]=new pt(ft,rt,Dt,Ot,Float32Array),ne&&console.timeEnd(te);for(var Y=Je;Y>=xe;Y--){var gt=+Date.now();ft=this._cluster(ft,Y),this.trees[Y]=new pt(ft,rt,Dt,Ot,Float32Array),ne&&console.log("z%d: %d clusters in %dms",Y,ft.length,+Date.now()-gt)}return ne&&console.timeEnd("total time"),this},ot.prototype.getClusters=function(_e,ve){var ne=((_e[0]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,_e[1])),Je=_e[2]===180?180:((_e[2]+180)%360+360)%360-180,Ot=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)ne=-180,Je=180;else if(ne>Je){var te=this.getClusters([ne,xe,180,Ot],ve),ft=this.getClusters([-180,xe,Je,Ot],ve);return te.concat(ft)}for(var wt=this.trees[this._limitZoom(ve)],Y=wt.range(W(ne),le(Ot),W(Je),le(xe)),gt=[],he=0,Oe=Y;he<Oe.length;he+=1){var Le=Oe[he],Ve=wt.points[Le];gt.push(Ve.numPoints?P(Ve):this.points[Ve.index])}return gt},ot.prototype.getChildren=function(_e){var ve=this._getOriginId(_e),ne=this._getOriginZoom(_e),xe="No cluster with the specified id.",Je=this.trees[ne];if(!Je)throw new Error(xe);var Ot=Je.points[ve];if(!Ot)throw new Error(xe);for(var te=this.options.radius/(this.options.extent*Math.pow(2,ne-1)),ft=Je.within(Ot.x,Ot.y,te),wt=[],Y=0,gt=ft;Y<gt.length;Y+=1){var he=gt[Y],Oe=Je.points[he];Oe.parentId===_e&&wt.push(Oe.numPoints?P(Oe):this.points[Oe.index])}if(wt.length===0)throw new Error(xe);return wt},ot.prototype.getLeaves=function(_e,ve,ne){ve=ve||10,ne=ne||0;var xe=[];return this._appendLeaves(xe,_e,ve,ne,0),xe},ot.prototype.getTile=function(_e,ve,ne){var xe=this.trees[this._limitZoom(_e)],Je=Math.pow(2,_e),Ot=this.options,te=Ot.extent,ft=Ot.radius,wt=ft/te,Y=(ne-wt)/Je,gt=(ne+1+wt)/Je,he={features:[]};return this._addTileFeatures(xe.range((ve-wt)/Je,Y,(ve+1+wt)/Je,gt),xe.points,ve,ne,Je,he),ve===0&&this._addTileFeatures(xe.range(1-wt/Je,Y,1,gt),xe.points,Je,ne,Je,he),ve===Je-1&&this._addTileFeatures(xe.range(0,Y,wt/Je,gt),xe.points,-1,ne,Je,he),he.features.length?he:null},ot.prototype.getClusterExpansionZoom=function(_e){for(var ve=this._getOriginZoom(_e)-1;ve<=this.options.maxZoom;){var ne=this.getChildren(_e);if(ve++,ne.length!==1)break;_e=ne[0].properties.cluster_id}return ve},ot.prototype._appendLeaves=function(_e,ve,ne,xe,Je){for(var Ot=this.getChildren(ve),te=0,ft=Ot;te<ft.length;te+=1){var wt=ft[te],Y=wt.properties;if(Y&&Y.cluster?Je+Y.point_count<=xe?Je+=Y.point_count:Je=this._appendLeaves(_e,Y.cluster_id,ne,xe,Je):Je<xe?Je++:_e.push(wt),_e.length===ne)break}return Je},ot.prototype._addTileFeatures=function(_e,ve,ne,xe,Je,Ot){for(var te=0,ft=_e;te<ft.length;te+=1){var wt=ft[te],Y=ve[wt],gt=Y.numPoints,he=void 0,Oe=void 0,Le=void 0;if(gt)he=b(Y),Oe=Y.x,Le=Y.y;else{var Ve=this.points[Y.index];he=Ve.properties,Oe=W(Ve.geometry.coordinates[0]),Le=le(Ve.geometry.coordinates[1])}var Bt={type:1,geometry:[[Math.round(this.options.extent*(Oe*Je-ne)),Math.round(this.options.extent*(Le*Je-xe))]],tags:he},re=void 0;gt?re=Y.id:this.options.generateId?re=Y.index:this.points[Y.index].id&&(re=this.points[Y.index].id),re!==void 0&&(Bt.id=re),Ot.features.push(Bt)}},ot.prototype._limitZoom=function(_e){return Math.max(this.options.minZoom,Math.min(Math.floor(+_e),this.options.maxZoom+1))},ot.prototype._cluster=function(_e,ve){for(var ne=[],xe=this.options,Je=xe.radius,Ot=xe.extent,te=xe.reduce,ft=xe.minPoints,wt=Je/(Ot*Math.pow(2,ve)),Y=0;Y<_e.length;Y++){var gt=_e[Y];if(!(gt.zoom<=ve)){gt.zoom=ve;for(var he=this.trees[ve+1],Oe=he.within(gt.x,gt.y,wt),Le=gt.numPoints||1,Ve=Le,Bt=0,re=Oe;Bt<re.length;Bt+=1){var ye=re[Bt],Yt=he.points[ye];Yt.zoom>ve&&(Ve+=Yt.numPoints||1)}if(Ve>Le&&Ve>=ft){for(var qe=gt.x*Le,vr=gt.y*Le,oe=te&&Le>1?this._map(gt,!0):null,qt=(Y<<5)+(ve+1)+this.points.length,bt=0,Wt=Oe;bt<Wt.length;bt+=1){var $t=Wt[bt],xt=he.points[$t];if(!(xt.zoom<=ve)){xt.zoom=ve;var St=xt.numPoints||1;qe+=xt.x*St,vr+=xt.y*St,xt.parentId=qt,te&&(oe||(oe=this._map(gt,!0)),te(oe,this._map(xt)))}}gt.parentId=qt,ne.push(ut(qe/Ve,vr/Ve,qt,Ve,oe))}else if(ne.push(gt),Ve>1)for(var ue=0,Pe=Oe;ue<Pe.length;ue+=1){var ze=Pe[ue],Vt=he.points[ze];Vt.zoom<=ve||(Vt.zoom=ve,ne.push(Vt))}}}return ne},ot.prototype._getOriginId=function(_e){return _e-this.points.length>>5},ot.prototype._getOriginZoom=function(_e){return(_e-this.points.length)%32},ot.prototype._map=function(_e,ve){if(_e.numPoints)return ve?Tt({},_e.properties):_e.properties;var ne=this.points[_e.index].properties,xe=this.options.map(ne);return ve&&xe===ne?Tt({},xe):xe};function ut(Se,_e,ve,ne,xe){return{x:be(Se),y:be(_e),zoom:1/0,id:ve,parentId:-1,numPoints:ne,properties:xe}}function zt(Se,_e){var ve=Se.geometry.coordinates,ne=ve[0],xe=ve[1];return{x:be(W(ne)),y:be(le(xe)),zoom:1/0,index:_e,parentId:-1}}function P(Se){return{type:"Feature",id:Se.id,properties:b(Se),geometry:{type:"Point",coordinates:[Ee(Se.x),ke(Se.y)]}}}function b(Se){var _e=Se.numPoints,ve=_e>=1e4?Math.round(_e/1e3)+"k":_e>=1e3?Math.round(_e/100)/10+"k":_e;return Tt(Tt({},Se.properties),{cluster:!0,cluster_id:Se.id,point_count:_e,point_count_abbreviated:ve})}function W(Se){return Se/360+.5}function le(Se){var _e=Math.sin(Se*Math.PI/180),ve=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return ve<0?0:ve>1?1:ve}function Ee(Se){return(Se-.5)*360}function ke(Se){var _e=(180-Se*360)*Math.PI/180;return 360*Math.atan(Math.exp(_e))/Math.PI-90}function Tt(Se,_e){for(var ve in _e)Se[ve]=_e[ve];return Se}function rt(Se){return Se.x}function Dt(Se){return Se.y}return ot})},47087:function(dn,Pt,nt){var kt=nt(3824).default;function mt(){"use strict";dn.exports=mt=function(){return k},dn.exports.__esModule=!0,dn.exports.default=dn.exports;var k={},Et=Object.prototype,K=Et.hasOwnProperty,yt=Object.defineProperty||function(ft,wt,Y){ft[wt]=Y.value},J=typeof Symbol=="function"?Symbol:{},pt=J.iterator||"@@iterator",et=J.asyncIterator||"@@asyncIterator",be=J.toStringTag||"@@toStringTag";function ot(ft,wt,Y){return Object.defineProperty(ft,wt,{value:Y,enumerable:!0,configurable:!0,writable:!0}),ft[wt]}try{ot({},"")}catch(ft){ot=function(Y,gt,he){return Y[gt]=he}}function ut(ft,wt,Y,gt){var he=wt&&wt.prototype instanceof b?wt:b,Oe=Object.create(he.prototype),Le=new Je(gt||[]);return yt(Oe,"_invoke",{value:_e(ft,Y,Le)}),Oe}function zt(ft,wt,Y){try{return{type:"normal",arg:ft.call(wt,Y)}}catch(gt){return{type:"throw",arg:gt}}}k.wrap=ut;var P={};function b(){}function W(){}function le(){}var Ee={};ot(Ee,pt,function(){return this});var ke=Object.getPrototypeOf,Tt=ke&&ke(ke(Ot([])));Tt&&Tt!==Et&&K.call(Tt,pt)&&(Ee=Tt);var rt=le.prototype=b.prototype=Object.create(Ee);function Dt(ft){["next","throw","return"].forEach(function(wt){ot(ft,wt,function(Y){return this._invoke(wt,Y)})})}function Se(ft,wt){function Y(he,Oe,Le,Ve){var Bt=zt(ft[he],ft,Oe);if(Bt.type!=="throw"){var re=Bt.arg,ye=re.value;return ye&&kt(ye)=="object"&&K.call(ye,"__await")?wt.resolve(ye.__await).then(function(Yt){Y("next",Yt,Le,Ve)},function(Yt){Y("throw",Yt,Le,Ve)}):wt.resolve(ye).then(function(Yt){re.value=Yt,Le(re)},function(Yt){return Y("throw",Yt,Le,Ve)})}Ve(Bt.arg)}var gt;yt(this,"_invoke",{value:function(Oe,Le){function Ve(){return new wt(function(Bt,re){Y(Oe,Le,Bt,re)})}return gt=gt?gt.then(Ve,Ve):Ve()}})}function _e(ft,wt,Y){var gt="suspendedStart";return function(he,Oe){if(gt==="executing")throw new Error("Generator is already running");if(gt==="completed"){if(he==="throw")throw Oe;return te()}for(Y.method=he,Y.arg=Oe;;){var Le=Y.delegate;if(Le){var Ve=ve(Le,Y);if(Ve){if(Ve===P)continue;return Ve}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(gt==="suspendedStart")throw gt="completed",Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);gt="executing";var Bt=zt(ft,wt,Y);if(Bt.type==="normal"){if(gt=Y.done?"completed":"suspendedYield",Bt.arg===P)continue;return{value:Bt.arg,done:Y.done}}Bt.type==="throw"&&(gt="completed",Y.method="throw",Y.arg=Bt.arg)}}}function ve(ft,wt){var Y=wt.method,gt=ft.iterator[Y];if(gt===void 0)return wt.delegate=null,Y==="throw"&&ft.iterator.return&&(wt.method="return",wt.arg=void 0,ve(ft,wt),wt.method==="throw")||Y!=="return"&&(wt.method="throw",wt.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),P;var he=zt(gt,ft.iterator,wt.arg);if(he.type==="throw")return wt.method="throw",wt.arg=he.arg,wt.delegate=null,P;var Oe=he.arg;return Oe?Oe.done?(wt[ft.resultName]=Oe.value,wt.next=ft.nextLoc,wt.method!=="return"&&(wt.method="next",wt.arg=void 0),wt.delegate=null,P):Oe:(wt.method="throw",wt.arg=new TypeError("iterator result is not an object"),wt.delegate=null,P)}function ne(ft){var wt={tryLoc:ft[0]};1 in ft&&(wt.catchLoc=ft[1]),2 in ft&&(wt.finallyLoc=ft[2],wt.afterLoc=ft[3]),this.tryEntries.push(wt)}function xe(ft){var wt=ft.completion||{};wt.type="normal",delete wt.arg,ft.completion=wt}function Je(ft){this.tryEntries=[{tryLoc:"root"}],ft.forEach(ne,this),this.reset(!0)}function Ot(ft){if(ft){var wt=ft[pt];if(wt)return wt.call(ft);if(typeof ft.next=="function")return ft;if(!isNaN(ft.length)){var Y=-1,gt=function he(){for(;++Y<ft.length;)if(K.call(ft,Y))return he.value=ft[Y],he.done=!1,he;return he.value=void 0,he.done=!0,he};return gt.next=gt}}return{next:te}}function te(){return{value:void 0,done:!0}}return W.prototype=le,yt(rt,"constructor",{value:le,configurable:!0}),yt(le,"constructor",{value:W,configurable:!0}),W.displayName=ot(le,be,"GeneratorFunction"),k.isGeneratorFunction=function(ft){var wt=typeof ft=="function"&&ft.constructor;return!!wt&&(wt===W||(wt.displayName||wt.name)==="GeneratorFunction")},k.mark=function(ft){return Object.setPrototypeOf?Object.setPrototypeOf(ft,le):(ft.__proto__=le,ot(ft,be,"GeneratorFunction")),ft.prototype=Object.create(rt),ft},k.awrap=function(ft){return{__await:ft}},Dt(Se.prototype),ot(Se.prototype,et,function(){return this}),k.AsyncIterator=Se,k.async=function(ft,wt,Y,gt,he){he===void 0&&(he=Promise);var Oe=new Se(ut(ft,wt,Y,gt),he);return k.isGeneratorFunction(wt)?Oe:Oe.next().then(function(Le){return Le.done?Le.value:Oe.next()})},Dt(rt),ot(rt,be,"Generator"),ot(rt,pt,function(){return this}),ot(rt,"toString",function(){return"[object Generator]"}),k.keys=function(ft){var wt=Object(ft),Y=[];for(var gt in wt)Y.push(gt);return Y.reverse(),function he(){for(;Y.length;){var Oe=Y.pop();if(Oe in wt)return he.value=Oe,he.done=!1,he}return he.done=!0,he}},k.values=Ot,Je.prototype={constructor:Je,reset:function(wt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(xe),!wt)for(var Y in this)Y.charAt(0)==="t"&&K.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=void 0)},stop:function(){this.done=!0;var wt=this.tryEntries[0].completion;if(wt.type==="throw")throw wt.arg;return this.rval},dispatchException:function(wt){if(this.done)throw wt;var Y=this;function gt(re,ye){return Le.type="throw",Le.arg=wt,Y.next=re,ye&&(Y.method="next",Y.arg=void 0),!!ye}for(var he=this.tryEntries.length-1;he>=0;--he){var Oe=this.tryEntries[he],Le=Oe.completion;if(Oe.tryLoc==="root")return gt("end");if(Oe.tryLoc<=this.prev){var Ve=K.call(Oe,"catchLoc"),Bt=K.call(Oe,"finallyLoc");if(Ve&&Bt){if(this.prev<Oe.catchLoc)return gt(Oe.catchLoc,!0);if(this.prev<Oe.finallyLoc)return gt(Oe.finallyLoc)}else if(Ve){if(this.prev<Oe.catchLoc)return gt(Oe.catchLoc,!0)}else{if(!Bt)throw new Error("try statement without catch or finally");if(this.prev<Oe.finallyLoc)return gt(Oe.finallyLoc)}}}},abrupt:function(wt,Y){for(var gt=this.tryEntries.length-1;gt>=0;--gt){var he=this.tryEntries[gt];if(he.tryLoc<=this.prev&&K.call(he,"finallyLoc")&&this.prev<he.finallyLoc){var Oe=he;break}}Oe&&(wt==="break"||wt==="continue")&&Oe.tryLoc<=Y&&Y<=Oe.finallyLoc&&(Oe=null);var Le=Oe?Oe.completion:{};return Le.type=wt,Le.arg=Y,Oe?(this.method="next",this.next=Oe.finallyLoc,P):this.complete(Le)},complete:function(wt,Y){if(wt.type==="throw")throw wt.arg;return wt.type==="break"||wt.type==="continue"?this.next=wt.arg:wt.type==="return"?(this.rval=this.arg=wt.arg,this.method="return",this.next="end"):wt.type==="normal"&&Y&&(this.next=Y),P},finish:function(wt){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var gt=this.tryEntries[Y];if(gt.finallyLoc===wt)return this.complete(gt.completion,gt.afterLoc),xe(gt),P}},catch:function(wt){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var gt=this.tryEntries[Y];if(gt.tryLoc===wt){var he=gt.completion;if(he.type==="throw"){var Oe=he.arg;xe(gt)}return Oe}}throw new Error("illegal catch attempt")},delegateYield:function(wt,Y,gt){return this.delegate={iterator:Ot(wt),resultName:Y,nextLoc:gt},this.method==="next"&&(this.arg=void 0),P}},k}dn.exports=mt,dn.exports.__esModule=!0,dn.exports.default=dn.exports},34001:function(dn,Pt,nt){var kt=nt(47087)();dn.exports=kt;try{regeneratorRuntime=kt}catch(mt){typeof globalThis=="object"?globalThis.regeneratorRuntime=kt:Function("r","regeneratorRuntime = r")(kt)}},39588:function(dn,Pt){"use strict";var nt=Array.isArray;Pt.Z=nt}}]);
