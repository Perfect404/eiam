/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2022 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
"use strict";(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[8724],{38692:function(Oe,ae,r){r.r(ae),r.d(ae,{default:function(){return Zr}});var le=r(11281),I=r.n(le),oe=r(97983),s=r.n(oe),ne=r(40794),x=r.n(ne),J=r(12741),y=r.n(J),C=r(137),k=r(84865),de=r(85307),be=r(38345),te=r(62113),ze=r(76509),Le=r(14459),Me=r(2236),He=r(78234),ce=r(2093),Q=r(2453),Ee=r(21687),Ie=r(57953),Ne=r(96486),d=r(67294),D=r(5966),Ue=r(17057),V;(function(u){u.config="config",u.sync_history="sync-history",u.event_record="event-record"})(V||(V={}));var L;(function(u){u.dingtalk="dingtalk",u.wework="wechat_work",u.feishu="feishu"})(L||(L={}));var M;(function(u){u.period="period",u.timed="timed"})(M||(M={}));var We={labelCol:{span:5},wrapperCol:{span:15}},c={appId:["basicConfig","appId"],appKey:["basicConfig","appKey"],corpId:["basicConfig","corpId"],appSecret:["basicConfig","appSecret"],secret:["basicConfig","secret"],callbackUrl:["basicConfig","callbackUrl"]},ue=r(71577),e=r(85893),Ge=function(i){var p=i.configured,t=i.onConfigValidator,l=i.formRef,f=i.basicConfigRef;(0,d.useEffect)(function(){},[p]);var h=(0,d.useCallback)(x()(s()().mark(function S(){var a,v;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=l==null?void 0:l.current,n.prev=1,n.next=4,a==null?void 0:a.validateFields([c.corpId,c.appKey,c.appSecret]);case 4:return n.next=6,t({provider:L.dingtalk,corpId:a==null?void 0:a.getFieldValue(c.corpId),appKey:a==null?void 0:a.getFieldValue(c.appKey),appSecret:a==null?void 0:a.getFieldValue(c.appSecret)});case 6:if(v=n.sent,v){n.next=12;break}return a==null||a.setFields([{name:c.corpId,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),a==null||a.setFields([{name:c.appKey,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),a==null||a.setFields([{name:c.appSecret,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),n.abrupt("return",!1);case 12:return Q.ZP.success("\u6D4B\u8BD5\u6210\u529F"),n.abrupt("return",!0);case 16:return n.prev=16,n.t0=n.catch(1),n.abrupt("return",!1);case 19:case"end":return n.stop()}},S,null,[[1,16]])})),[l,t]);return(0,d.useImperativeHandle)(f,function(){return{configValidator:h}},[h]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{name:c.corpId,label:"\u4F01\u4E1AID",placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1AID",extra:"\u4F60\u53EF\u4EE5\u5728\u9489\u9489\u5F00\u653E\u5E73\u53F0(https://open-dev.dingtalk.com/)\u9996\u9875\u53F3\u4E0A\u89D2\u83B7\u53D6\u4F01\u4E1A ID\uFF08CorpId\uFF09\u3002"}),(0,e.jsx)(D.Z,{name:c.appKey,label:"\u5E94\u7528\u5F00\u53D1Key",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u5F00\u53D1Key",extra:"\u4F60\u53EF\u4EE5\u5728\u9489\u9489\u5F00\u653E\u5E73\u53F0(https://open-dev.dingtalk.com/)\u5E94\u7528\u8BE6\u60C5\u7684\u300C\u57FA\u7840\u4FE1\u606F\u300D\u9875\u9762\u83B7\u53D6 AppKey\u3002",rules:[{required:!0,message:"\u5E94\u7528\u5F00\u53D1Key\u4E3A\u5FC5\u586B\u9879"}]}),(0,e.jsx)(D.Z.Password,{name:c.appSecret,label:"\u5E94\u7528\u51ED\u8BC1\u5BC6\u94A5",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u51ED\u8BC1\u5BC6\u94A5",extra:"\u4F60\u53EF\u4EE5\u5728\u9489\u9489\u5F00\u653E\u5E73\u53F0(https://open-dev.dingtalk.com/)\u5E94\u7528\u8BE6\u60C5\u7684\u300C\u57FA\u7840\u4FE1\u606F\u300D\u9875\u9762\u83B7\u53D6 AppSecret\u3002",fieldProps:{autoComplete:"new-password"},rules:[{required:!0,message:"\u5E94\u7528\u51ED\u8BC1\u5BC6\u94A5\u4E3A\u5FC5\u586B\u9879"}],addonAfter:(0,e.jsx)(ue.Z,{type:"default",onClick:h,children:"\u6D4B\u8BD5\u8FDE\u63A5"})}),(0,e.jsx)(D.Z.Password,{name:["basicConfig","aesKey"],label:"\u52A0\u5BC6AesKey",extra:"\u4F60\u53EF\u4EE5\u5728\u9489\u9489\u5F00\u653E\u5E73\u53F0(https://open-dev.dingtalk.com/)\u5E94\u7528\u8BE6\u60C5\u7684\u300C\u4E8B\u4EF6\u8BA2\u9605\u300D\u9875\u9762\u83B7\u53D6\u52A0\u5BC6 aes_key\u3002\u5982\u679C\u4F60\u9700\u8981\u5F00\u542F\u5B9E\u65F6\u540C\u6B65\uFF0C\u6B64\u53C2\u6570\u5FC5\u586B\u3002",fieldProps:{autoComplete:"new-password"}}),(0,e.jsx)(D.Z.Password,{name:["basicConfig","token"],label:"\u7B7E\u540DToken",extra:"\u4F60\u53EF\u4EE5\u5728\u9489\u9489\u5F00\u653E\u5E73\u53F0(https://open-dev.dingtalk.com/)\u5E94\u7528\u8BE6\u60C5\u7684\u300C\u4E8B\u4EF6\u8BA2\u9605\u300D\u9875\u9762\u83B7\u53D6\u7B7E\u540D token\u3002\u5982\u679C\u4F60\u9700\u8981\u5F00\u542F\u5B9E\u65F6\u540C\u6B65\uFF0C\u6B64\u53C2\u6570\u5FC5\u586B\u3002",fieldProps:{autoComplete:"new-password"}})]})},Je=Ge,Qe=function(i){var p=i.configured,t=i.formRef,l=i.basicConfigRef,f=i.onConfigValidator;(0,d.useEffect)(function(){},[p]);var h=(0,d.useCallback)(x()(s()().mark(function S(){var a,v;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t==null?void 0:t.current,n.prev=1,n.next=4,a==null?void 0:a.validateFields([c.appId,c.appSecret]);case 4:return n.next=6,f({provider:L.feishu,appId:a==null?void 0:a.getFieldValue(c.appId),appSecret:a==null?void 0:a.getFieldValue(c.appSecret)});case 6:if(v=n.sent,v){n.next=11;break}return a==null||a.setFields([{name:c.appId,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),a==null||a.setFields([{name:c.appSecret,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),n.abrupt("return",!1);case 11:return n.abrupt("return",!0);case 14:return n.prev=14,n.t0=n.catch(1),n.abrupt("return",!1);case 17:case"end":return n.stop()}},S,null,[[1,14]])})),[t,f]);return(0,d.useImperativeHandle)(l,function(){return{configValidator:h}},[h]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{name:c.appId,label:"\u5E94\u7528 ID",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528ID",extra:"\u767B\u5F55\u5F00\u653E\u4E2D\u5FC3\uFF0C\u70B9\u51FB\u5E94\u7528 \uFF0C\u5728\u51ED\u8BC1\u4E0E\u57FA\u7840\u4FE1\u606F\u9875\u9762\u67E5\u770BAPP ID\u3002",rules:[{required:!0,message:"\u5E94\u7528ID\u4E3A\u5FC5\u586B\u9879"}]}),(0,e.jsx)(D.Z.Password,{name:c.appSecret,label:"\u5E94\u7528\u51ED\u8BC1\u5BC6\u94A5",placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u51ED\u8BC1\u5BC6\u94A5",extra:"\u767B\u5F55\u5F00\u653E\u4E2D\u5FC3\uFF0C\u70B9\u51FB\u5E94\u7528 \uFF0C\u5728\u51ED\u8BC1\u4E0E\u57FA\u7840\u4FE1\u606F\u9875\u9762\u67E5\u770B APP Secret\u3002",fieldProps:{autoComplete:"new-password"},rules:[{required:!0,message:"\u5E94\u7528\u51ED\u8BC1\u5BC6\u94A5\u4E3A\u5FC5\u586B\u9879"}],addonAfter:(0,e.jsx)(ue.Z,{type:"default",onClick:h,children:"\u6D4B\u8BD5\u8FDE\u63A5"})}),(0,e.jsx)(D.Z.Password,{name:["basicConfig","encryptKey"],label:"EncryptKey",extra:"\u98DE\u4E66\u4E8B\u4EF6\u8BA2\u9605\u7684 EncryptKey\uFF0C\u53EF\u4EE5\u5728\u98DE\u4E66\u5F00\u653E\u5E73\u53F0\u5E94\u7528\u8BE6\u60C5\u7684\u300C\u4E8B\u4EF6\u8BA2\u9605\u300D\u9875\u9762\u83B7\u53D6\u3002\u5982\u679C\u4F60\u9700\u8981\u5F00\u542F\u5B9E\u65F6\u540C\u6B65\uFF0C\u6B64\u53C2\u6570\u5FC5\u586B\u3002",fieldProps:{autoComplete:"new-password"}}),(0,e.jsx)(D.Z.Password,{name:["basicConfig","verificationToken"],label:"VerificationToken",extra:"\u98DE\u4E66\u4E8B\u4EF6\u8BA2\u9605\u7684 VerificationToken\uFF0C\u53EF\u4EE5\u5728\u98DE\u4E66\u5F00\u653E\u5E73\u53F0\u5E94\u7528\u8BE6\u60C5\u7684\u300C\u4E8B\u4EF6\u8BA2\u9605\u300D\u9875\u9762\u83B7\u53D6\u3002\u5982\u679C\u4F60\u9700\u8981\u5F00\u542F\u5B9E\u65F6\u540C\u6B65\uFF0C\u6B64\u53C2\u6570\u5FC5\u586B\u3002",fieldProps:{autoComplete:"new-password"}})]})},Ye=Qe,Xe=function(i){var p=i.configured,t=i.formRef,l=i.onConfigValidator,f=i.basicConfigRef;(0,d.useEffect)(function(){},[p]);var h=(0,d.useCallback)(x()(s()().mark(function S(){var a,v;return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return a=t==null?void 0:t.current,n.prev=1,a==null||a.validateFields([c.corpId,c.corpId]),n.next=5,l({corpId:a==null?void 0:a.getFieldValue(c.corpId),secret:a==null?void 0:a.getFieldValue(c.secret),provider:L.wework});case 5:if(v=n.sent,v){n.next=10;break}return a==null||a.setFields([{name:c.corpId,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),a==null||a.setFields([{name:c.secret,errors:["\u6D4B\u8BD5\u8FDE\u63A5\u5931\u8D25\uFF0C\u8BF7\u6838\u5B9E\u53C2\u6570\u4FE1\u606F"]}]),n.abrupt("return",!1);case 10:return n.abrupt("return",!0);case 13:return n.prev=13,n.t0=n.catch(1),n.abrupt("return",!1);case 16:case"end":return n.stop()}},S,null,[[1,13]])})),[t,l]);return(0,d.useImperativeHandle)(f,function(){return{configValidator:h}},[h]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(D.Z,{name:c.corpId,label:"\u4F01\u4E1A ID",placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1A ID\uFF08CorpId\uFF09",extra:"\u4F60\u53EF\u4EE5\u5728\u4F01\u4E1A\u5FAE\u4FE1\u540E\u53F0\uFF08https://work.weixin.qq.com/\uFF09\u300C\u6211\u7684\u4F01\u4E1A\u300D-\u300C\u4F01\u4E1A\u4FE1\u606F\u300D\u9875\u9762\u83B7\u53D6\u4F01\u4E1A ID\uFF08CorpId\uFF09\u3002",rules:[{required:!0,message:"\u4F01\u4E1A ID\uFF08CorpId\uFF09\u4E3A\u5FC5\u586B\u9879"}]}),(0,e.jsx)(D.Z.Password,{name:c.secret,label:"\u5BC6\u94A5 Secret",placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1A\u5FAE\u4FE1\u901A\u8BAF\u5F55\u5BC6\u94A5 Secret",fieldProps:{autoComplete:"new-password"},rules:[{required:!0,message:"\u4F01\u4E1A\u5FAE\u4FE1\u901A\u8BAF\u5F55\u5BC6\u94A5 Secret\u4E3A\u5FC5\u586B\u9879"}],addonAfter:(0,e.jsx)(ue.Z,{type:"default",onClick:h,children:"\u6D4B\u8BD5\u8FDE\u63A5"})}),(0,e.jsx)(D.Z.Password,{name:["basicConfig","token"],label:"\u4E8B\u4EF6\u56DE\u8C03 Token",placeholder:"\u8BF7\u8F93\u5165\u4F01\u4E1A\u5FAE\u4FE1\u56DE\u8C03 Token",fieldProps:{autoComplete:"new-password"},extra:"\u4F60\u53EF\u4EE5\u5728\u4F01\u4E1A\u5FAE\u4FE1\u540E\u53F0\uFF08https://work.weixin.qq.com/\uFF09\u300C\u7BA1\u7406\u5DE5\u5177\u300D-\u300C\u901A\u8BAF\u5F55\u540C\u6B65\u300D\u9875\u9762\u70B9\u51FB\u300C\u8BBE\u7F6E\u63A5\u6536\u4E8B\u4EF6\u670D\u52A1\u5668\u300D\u6309\u94AE\uFF0C\u4E4B\u540E\u53EF\u4EE5\u83B7\u53D6\u5230\u6B64 Token\u3002\u5982\u679C\u4F60\u9700\u8981\u5F00\u542F\u5B9E\u65F6\u540C\u6B65\uFF0C\u6B64\u53C2\u6570\u5FC5\u586B\u3002"}),(0,e.jsx)(D.Z.Password,{name:["basicConfig","encodingAESKey"],label:"EncodingAESKey",placeholder:"\u8BF7\u8F93\u5165\u901A\u8BAF\u5F55\u4E8B\u4EF6\u540C\u6B65 EncodingAESKey",fieldProps:{autoComplete:"new-password"},extra:"\u4F60\u53EF\u4EE5\u5728\u4F01\u4E1A\u5FAE\u4FE1\u540E\u53F0\uFF08https://work.weixin.qq.com/\uFF09\u300C\u7BA1\u7406\u5DE5\u5177\u300D-\u300C\u901A\u8BAF\u5F55\u540C\u6B65\u300D\u9875\u9762\u70B9\u51FB\u300C\u8BBE\u7F6E\u63A5\u6536\u4E8B\u4EF6\u670D\u52A1\u5668\u300D\u6309\u94AE\uFF0C\u4E4B\u540E\u53EF\u4EE5\u83B7\u53D6\u5230\u6B64 EncodingAESKey\u3002\u5982\u679C\u4F60\u9700\u8981\u5F00\u542F\u5B9E\u65F6\u540C\u6B65\uFF0C\u6B64\u53C2\u6570\u5FC5\u586B\u3002"})]})},qe=Xe,_e=Ue.Z.Paragraph,er=function(u){var i=u.provider,p=u.configured,t=u.basicConfigRef,l=u.onConfigValidator,f=u.formRef;return(0,e.jsxs)(e.Fragment,{children:[i===L.dingtalk&&(0,e.jsx)(Je,{configured:p,basicConfigRef:t,onConfigValidator:l,formRef:f}),i===L.wework&&(0,e.jsx)(qe,{configured:p,basicConfigRef:t,onConfigValidator:l,formRef:f}),i===L.feishu&&(0,e.jsx)(Ye,{configured:p,basicConfigRef:t,onConfigValidator:l,formRef:f}),(0,e.jsx)(D.Z,{label:"\u56DE\u8C03\u5730\u5740",name:c.callbackUrl,proFieldProps:{render:function(S){return S&&(0,e.jsx)(_e,{copyable:{text:S},style:{marginBottom:"0"},children:(0,e.jsx)("span",{dangerouslySetInnerHTML:{__html:"<span>".concat(S,"</span>")}})})}},readonly:!0,fieldProps:{autoComplete:"off"}})]})},Se=r(63434),rr=r(86615),ar=r(97462),nr=r(31199),tr=r(33725),Te=r(99138),se=r(96074),ur=function(u){var i=u.configured;return(0,d.useEffect)(function(){},[i]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Te.Z,{type:"info",banner:!0,showIcon:!0,description:"\u5B9A\u65F6\u914D\u7F6E\u5FC5\u987B\u540C\u65F6\u914D\u7F6E\u661F\u671F\u6570\u53CA\u6267\u884C\u65B9\u5F0F\u3002\u4F8B\uFF1A\u52FE\u9009\u5468\u4E8C\u5E76\u9009\u62E9\u6BCF\u96942\u5C0F\u65F6\u6267\u884C\u4E00\u6B21\u65F6\uFF0C\u8868\u793A\u5728\u6BCF\u4E2A\u5468\u4E8C\uFF0C\u6BCF\u96942\u5C0F\u65F6\u6267\u884C\u4E00\u6B21\u540C\u6B65\u3002"}),(0,e.jsx)("br",{}),(0,e.jsxs)(be.Z,{bordered:!0,headerBordered:!0,children:[(0,e.jsx)(Se.Z.Group,{name:["jobConfig","dayOfWeek"],options:[{label:"\u6BCF\u5929",value:"always"}],rules:[{required:!0,message:"\u8BE5\u9879\u4E3A\u5FC5\u9009\u9879"}]}),(0,e.jsx)(se.Z,{}),(0,e.jsx)(Se.Z.Group,{name:["jobConfig","dayOfWeek"],rules:[{required:!0,message:"\u8BE5\u9879\u4E3A\u5FC5\u9009\u9879"}],options:[{label:"\u5468\u4E00",value:"monday"},{label:"\u5468\u4E8C",value:"tuesday"},{label:"\u5468\u4E09",value:"wednesday"},{label:"\u5468\u56DB",value:"thursday"},{label:"\u5468\u4E94",value:"friday"},{label:"\u5468\u516D",value:"saturday"},{label:"\u5468\u5929",value:"sunday"}]}),(0,e.jsx)(se.Z,{}),(0,e.jsx)(rr.Z.Group,{name:["jobConfig","mode"],options:[{label:"\u5468\u671F\u6267\u884C",value:M.period},{label:"\u5B9A\u65F6\u6267\u884C",value:M.timed}],rules:[{required:!0,message:"\u8BF7\u914D\u7F6E\u6267\u884C\u65B9\u5F0F"}]}),(0,e.jsx)(ar.Z,{name:["jobConfig","mode"],children:function(t){var l=t.jobConfig;return(l==null?void 0:l.mode)===M.period?(0,e.jsx)(nr.Z,{min:1,max:24,name:["jobConfig","interval"],width:"xs",addonBefore:"\u6BCF\u9694",addonAfter:"\u5C0F\u65F6\u6267\u884C\u4E00\u6B21",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u95F4\u9694\u5C0F\u65F6"}]}):(l==null?void 0:l.mode)===M.timed?(0,e.jsx)(tr.Z,{addonBefore:"\u6267\u884C\u65F6\u95F4",width:"xs",name:["jobConfig","time"],rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6267\u884C\u65F6\u95F4"}]}):(0,e.jsx)(e.Fragment,{})}})]})]})},sr=r(78098),ir=r(4499),Ze=r(52688),lr=r(59847),or=function(u){var i=u.configured;(0,d.useEffect)(function(){},[i]);var p=(0,d.useState)([]),t=y()(p,2),l=t[0],f=t[1],h=function(){var v=x()(s()().mark(function b(){var n,$,K;return s()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,(0,C.mB)();case 2:if(g.t0=g.sent,g.t0){g.next=5;break}g.t0={};case 5:n=g.t0,$=n.success,K=n.result,$&&K&&f([K]);case 9:case"end":return g.stop()}},b)}));return function(){return v.apply(this,arguments)}}(),S=function(){var v=x()(s()().mark(function b(n){var $;return s()().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return P.next=2,(0,C.z3)(n);case 2:return $=P.sent,$.success&&f(function(g){return(0,sr.J)(g,n,$.result)}),P.abrupt("return",Promise.resolve());case 5:case"end":return P.stop()}},b)}));return function(n){return v.apply(this,arguments)}}();(0,ce.Z)(x()(s()().mark(function v(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h();case 2:case"end":return n.stop()}},v)})),[]);var a=(0,e.jsxs)("span",{children:[(0,e.jsx)(e.Fragment,{children:"\u8EAB\u4EFD\u6E90\u7EC4\u7EC7\u540C\u6B65\u81F3 TopIAM \u540E\u7684\u7236\u7EA7\u7EC4\u7EC7\u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)(e.Fragment,{children:"\u5982\u679C\u4E0D\u586B\uFF0C\u5C06\u81EA\u52A8\u521B\u5EFA\u9876\u5C42\u7EC4\u7EC7\u3002\u914D\u7F6E\u540E\u4E0D\u53EF\u66F4\u6539\u3002"})," "]});return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{orientation:"left",plain:!0,children:"\u7EC4\u7EC7\u76F8\u5173\u7B56\u7565"}),(0,e.jsx)(ir.Z,{name:["strategyConfig","organization","targetId"],label:"\u76EE\u6807\u6839\u7EC4\u7EC7",extra:a,children:(0,e.jsx)(lr.Z,{placeholder:"\u8BF7\u9009\u62E9\u76EE\u6807\u6839\u7EC4\u7EC7",allowClear:!0,labelInValue:!0,loadData:function(b){return S(b.id)},treeData:l,treeNodeFilterProp:"name",fieldNames:{label:"name",value:"id"}})}),(0,e.jsx)(se.Z,{orientation:"left",plain:!0,children:"\u7528\u6237\u76F8\u5173\u7B56\u7565"}),(0,e.jsx)(D.Z.Password,{name:["strategyConfig","user","defaultPassword"],label:"\u9ED8\u8BA4\u5BC6\u7801",extra:"\u540C\u6B65\u8D26\u6237\u65F6\u7ED9\u8D26\u6237\u8BBE\u7F6E\u7684\u9ED8\u8BA4\u5BC6\u7801\uFF0C\u82E5\u4E0D\u8BBE\u7F6E\uFF0C\u5C06\u4F7F\u7528\u8BBE\u7F6E\u4E2D\u5BC6\u7801\u7B56\u7565\u968F\u673A\u751F\u6210\u3002",placeholder:"\u8BF7\u8F93\u5165\u9ED8\u8BA4\u5BC6\u7801",fieldProps:{autoComplete:"new-password"}}),(0,e.jsx)(Ze.Z,{name:["strategyConfig","user","enabled"],label:"\u662F\u5426\u542F\u7528",initialValue:!0,extra:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("span",{children:"\u9ED8\u8BA4\u542F\u7528\uFF0C\u9996\u6B21\u540C\u6B65\u7528\u6237\u65F6\uFF0C\u7528\u6237\u662F\u5426\u5728 TopIAM \u4E2D\u542F\u7528\u3002"}),(0,e.jsx)("br",{}),(0,e.jsx)("span",{style:{color:"red"},children:"\u6CE8\u610F\uFF1A\u8EAB\u4EFD\u6E90\u7528\u6237\u672A\u542F\u7528\u65F6\uFF0C\u5C06\u5DF2\u8EAB\u4EFD\u6E90\u4E3A\u51C6\u3002"})]})}),(0,e.jsx)(Ze.Z,{name:["strategyConfig","user","emailNotify"],label:"\u90AE\u4EF6\u901A\u77E5",initialValue:!0,extra:"\u9ED8\u8BA4\u542F\u7528\uFF0C\u9996\u6B21\u540C\u6B65\u7528\u6237\u6210\u529F\u540E\uFF0C\u5C06\u53D1\u9001\u7535\u5B50\u90AE\u4EF6\uFF0C\u82E5\u6CA1\u6709\u83B7\u53D6\u5230\u90AE\u4EF6\u5730\u5740\uFF0C\u5C06\u65E0\u6CD5\u8FDB\u884C\u53D1\u9001\u3002"})]})},dr=r(98165),cr=r(62548),fe=r(1914),De=r(26713),O=r(51904),fr=r(69400),vr=r(12812),ve=r.n(vr),Re=r(8751),we=r(18429),Ae=r(11475),pr=r(58455),Pe=r(38755),mr=function(u){var i=u.syncHistoryId,p=u.open,t=u.onClose,l=u.objectType,f=(0,d.useRef)(),h=[{title:"\u52A8\u4F5C\u7C7B\u578B",dataIndex:"actionType",align:"center",width:80,ellipsis:!0,valueType:"select",valueEnum:{insert:{text:"\u65B0\u589E"},update:{text:"\u4FEE\u6539"},delete:{text:"\u5220\u9664"}}},{title:"\u5BF9\u8C61 ID",dataIndex:"objectId",ellipsis:!0,search:!1},{title:"\u5BF9\u8C61\u540D\u79F0",dataIndex:"objectName",ellipsis:!0,search:!1},{title:"\u63CF\u8FF0",dataIndex:"desc",ellipsis:!0,search:!1},{title:"\u72B6\u6001",dataIndex:"status",align:"center",valueType:"select",width:80,valueEnum:{success:{text:"\u6210\u529F"},fail:{text:"\u5931\u8D25"},skip:{text:"\u8DF3\u8FC7"}},renderText:function(v){return(0,e.jsxs)(e.Fragment,{children:[v==="success"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(Re.Z,{}),color:"#87d068",children:"\u6210\u529F"}),v==="fail"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(we.Z,{}),color:"#e54545",children:"\u5931\u8D25"}),v==="skip"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(Ae.Z,{}),color:"#faad14",children:"\u8DF3\u8FC7"})]})}}],S=(0,Pe.l)(function(){return ve()({},".ant-pro-card .ant-pro-card-body",{padding:"24px 0px 0px"})});return(0,e.jsx)(pr.Z,{open:p,title:"\u8BE6\u60C5\u8BB0\u5F55",onClose:t,width:630,destroyOnClose:!0,bodyStyle:{paddingTop:0},children:(0,e.jsx)(fe.Z,{actionRef:f,className:S,columns:h,search:{filterType:"light"},params:{syncHistoryId:i,objectType:l},request:C.eU,rowKey:"id",pagination:{defaultPageSize:10,showQuickJumper:!1}})})},gr=mr,hr=function(u){var i=u.identitySourceId,p=(0,d.useRef)(),t=(0,d.useState)(!1),l=y()(t,2),f=l[0],h=l[1],S=(0,d.useState)(),a=y()(S,2),v=a[0],b=a[1],n=(0,d.useState)(),$=y()(n,2),K=$[0],P=$[1],g=[{title:"\u6279\u53F7",fixed:"left",width:100,dataIndex:"batch",align:"center",search:!1},{title:"\u89E6\u53D1\u7C7B\u578B",dataIndex:"triggerType",ellipsis:!0,filterSearch:!0,align:"center",valueType:"select",valueEnum:{manual:{text:"\u624B\u52A8\u89E6\u53D1"},job:{text:"\u4EFB\u52A1\u89E6\u53D1"}}},{title:"\u5BF9\u8C61\u7C7B\u578B",dataIndex:"objectType",align:"center",valueType:"select",ellipsis:!0,filterSearch:!0,valueEnum:{user:{text:"\u7528\u6237"},organization:{text:"\u7EC4\u7EC7"}}},{title:"\u521B\u5EFA\u6570\u91CF",dataIndex:"createdCount",search:!1},{title:"\u66F4\u65B0\u6570\u91CF",dataIndex:"updatedCount",search:!1},{title:"\u5220\u9664\u6570\u91CF",dataIndex:"deletedCount",search:!1},{title:"\u8DF3\u8FC7\u6570\u91CF",dataIndex:"skippedCount",search:!1},{title:"\u5F00\u59CB\u65F6\u95F4",dataIndex:"startTime",ellipsis:!0,search:!1,align:"center",valueType:"dateTime"},{title:"\u7ED3\u675F\u65F6\u95F4",dataIndex:"endTime",ellipsis:!0,search:!1,align:"center",valueType:"dateTime"},{title:"\u8017\u65F6",dataIndex:"spendTime",valueType:"second",search:!1},{title:"\u72B6\u6001",dataIndex:"status",filterSearch:!0,valueType:"select",width:100,valueEnum:{success:{text:"\u6210\u529F"},fail:{text:"\u5931\u8D25"},pending:{text:"\u540C\u6B65\u4E2D"}},renderText:function(H){return(0,e.jsxs)(De.Z,{children:[H==="success"&&(0,e.jsx)(O.Z,{color:"#87d068",children:"\u6210\u529F"}),H==="fail"&&(0,e.jsx)(O.Z,{color:"#e54545",children:"\u5931\u8D25"}),H==="pending"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(dr.Z,{spin:!0}),color:"#1677ff",children:"\u540C\u6B65\u4E2D"})]})}},{title:"\u64CD\u4F5C",align:"center",valueType:"option",width:100,fixed:"right",render:function(H,N){return[(0,e.jsx)("a",{target:"_blank",onClick:function(){b(N.id),h(!0),P(N.objectType)},children:"\u8BE6\u60C5"},"details")]}}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(fe.Z,{actionRef:p,columns:g,params:{identitySourceId:i},request:C.QA,rowKey:"id",pagination:{defaultPageSize:10,showQuickJumper:!0},scroll:{x:1300},search:{filterType:"light"},toolBarRender:function(){return[(0,e.jsx)(ue.Z,{icon:(0,e.jsx)(cr.Z,{}),type:"primary",onClick:function(){fr.Z.info({title:"\u4E00\u952E\u62C9\u53D6",width:500,onOk:function(){var N=x()(s()().mark(function me(){var q,B;return s()().wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return z.next=2,(0,C.nv)(i);case 2:q=z.sent,B=q.success,B&&(Q.ZP.success("\u4EFB\u52A1\u89E6\u53D1\u6210\u529F"),window.setInterval(function(){var U;(U=p.current)===null||U===void 0||U.reload()},5e3));case 5:case"end":return z.stop()}},me)}));function X(){return N.apply(this,arguments)}return X}(),content:(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(De.Z,{direction:"vertical",children:[(0,e.jsx)("span",{children:"TopIAM \u5C06\u5168\u91CF\u62C9\u53D6\u8EAB\u4EFD\u6E90\u6388\u6743\u8303\u56F4\u5185\u90E8\u95E8\u548C\u8D26\u6237\uFF0C\u7F6E\u4E8E\u540C\u6B65\u76EE\u6807\u7EC4\u7EC7\u4E0B\u3002"}),(0,e.jsx)(Te.Z,{type:"info",banner:!0,showIcon:!1,description:"\u5DF2\u62C9\u53D6\u8FC7\u7684\u7EC4\u7EC7\u3001\u8D26\u6237\u4E0D\u4F1A\u91CD\u590D\u521B\u5EFA\uFF0C\u800C\u4F1A\u8986\u76D6\u66F4\u65B0\u3002\u53EF\u4EE5\u53CD\u590D\u89E6\u53D1\u62C9\u53D6\uFF0C\u5C06\u4E24\u4FA7\u6570\u636E\u62C9\u9F50\u3002"})]})}),okText:"\u786E\u8BA4",okType:"primary",centered:!1,maskClosable:!1,okCancel:!0})},children:"\u4E00\u952E\u62C9\u53D6"},"pull")]}}),v&&K&&(0,e.jsx)(gr,{open:f,syncHistoryId:v,objectType:K,onClose:function(){h(!1)}})]})},Cr=hr,yr=r(46986),jr=yr.ZP.ConfigContext;function Fr(){var u=(0,d.useContext)(jr),i=u.getPrefixCls,p=".".concat(i()),t=(0,Pe.l)(function(){return ve()({},"".concat(p,"-form-item"),ve()({},"".concat(p,"-form-item-control-input"),{width:"100%"}))});return{className:t}}var pe=r(67038),xr=r(98971),br=function(u){var i=(0,d.useRef)(),p=u.identitySourceId,t=[{title:"\u52A8\u4F5C\u7C7B\u578B",dataIndex:"actionType",align:"center",ellipsis:!0,width:100,valueType:"select",valueEnum:{insert:{text:"\u65B0\u589E"},update:{text:"\u4FEE\u6539"},delete:{text:"\u5220\u9664"}}},{title:"\u5BF9\u8C61\u7C7B\u578B",dataIndex:"objectType",align:"center",valueType:"select",width:100,ellipsis:!0,filterSearch:!0,valueEnum:{user:{text:"\u7528\u6237"},organization:{text:"\u7EC4\u7EC7"}}},{title:"\u5BF9\u8C61 ID",dataIndex:"objectId",ellipsis:!0,search:!1},{title:"\u5BF9\u8C61\u540D\u79F0",dataIndex:"objectName",search:!1},{title:"\u4E8B\u4EF6\u65F6\u95F4",dataIndex:"eventTime",align:"center",search:!1,ellipsis:!0,valueType:"dateTime"},{title:"\u63CF\u8FF0",dataIndex:"desc",ellipsis:!0,search:!1},{title:"\u4E8B\u4EF6\u72B6\u6001",dataIndex:"status",align:"center",valueType:"select",width:80,valueEnum:{success:{text:"\u6210\u529F"},fail:{text:"\u5931\u8D25"},skip:{text:"\u8DF3\u8FC7"}},renderText:function(f){return(0,e.jsxs)(e.Fragment,{children:[f==="success"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(Re.Z,{}),color:"#87d068",children:"\u6210\u529F"}),f==="fail"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(we.Z,{}),color:"#e54545",children:"\u5931\u8D25"}),f==="skip"&&(0,e.jsx)(O.Z,{icon:(0,e.jsx)(Ae.Z,{}),color:"#faad14",children:"\u8DF3\u8FC7"})]})}}];return(0,e.jsx)(fe.Z,{actionRef:i,params:{identitySourceId:p},columns:t,rowKey:"id",search:{filterType:"light"},scroll:{x:900},pagination:{defaultPageSize:10,showQuickJumper:!1},request:C.mo,toolBarRender:function(){return[]}})},Er=br,Ir=r(27484),Sr=r.n(Ir),Tr=function(){var u=(0,xr.useLocation)(),i=(0,pe.parse)(u.search),p=i,t=p.id,l=i,f=l.tab,h=i,S=h.provider,a=(0,d.useState)(),v=y()(a,2),b=v[0],n=v[1],$=(0,d.useState)(!1),K=y()($,2),P=K[0],g=K[1],Y=(0,d.useState)(!1),H=y()(Y,2),N=H[0],X=H[1],me=(0,d.useState)(),q=y()(me,2),B=q[0],ge=q[1],z=(0,d.useRef)(),U=(0,d.useRef)(),Be=(0,d.useRef)(),ke=(0,d.useRef)(),Dr=(0,d.useState)(0),Ve=y()(Dr,2),Rr=Ve[0],$e=Ve[1],wr=(0,d.useState)(!1),Ke=y()(wr,2),_=Ke[0],Ar=Ke[1],Pr=Fr(),Br=Pr.className;(0,He.Z)(x()(s()().mark(function T(){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(t){o.next=4;break}return Q.ZP.warning("\u8EAB\u4EFD\u6E90\u4E0D\u5B58\u5728"),k.m.push("/account/identity-source"),o.abrupt("return");case 4:if(f){o.next=8;break}return n(V.config),k.m.push({pathname:u.pathname,search:(0,pe.stringify)({tab:V.config,id:t})}),o.abrupt("return");case 8:n(f);case 9:case"end":return o.stop()}},T)}))),(0,ce.Z)(x()(s()().mark(function T(){var m,o,j;return s()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:if(!t){Z.next=8;break}return g(!0),Z.next=4,(0,C.bh)(t);case 4:m=Z.sent,o=m.success,j=m.result,o&&j&&(ge(j),g(!1));case 8:case"end":return Z.stop()}},T)})),[t]),(0,ce.Z)(x()(s()().mark(function T(){return s()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:f===V.config&&(X(!0),(0,C.$C)(t).then(function(){var j=x()(s()().mark(function E(Z){var R,w,W,ie,F,he,Ce,A,ee,ye,re,je,Fe,xe;return s()().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:if(A=Z.result,Ar(A==null?void 0:A.configured),ee=(R=A.strategyConfig)===null||R===void 0||(w=R.organization)===null||w===void 0?void 0:w.targetId,ye=A.strategyConfig,!(ee&&A!==null&&A!==void 0&&A.configured)){G.next=11;break}return G.next=7,(0,C.Xu)(ee);case 7:re=G.sent,je={value:ee,label:void 0},re&&re.success&&re.result&&(je={value:ee,label:re.result.name}),ye=I()(I()({},A.strategyConfig),{},{organization:I()(I()({},A.strategyConfig.organization),{},{targetId:je})});case 11:(W=z.current)===null||W===void 0||W.setFieldsValue({basicConfig:I()({},A.basicConfig)}),(ie=ke.current)===null||ie===void 0||ie.setFieldsValue({strategyConfig:I()({},ye)}),Fe=(F=A.jobConfig)===null||F===void 0?void 0:F.mode,xe=(he=A.jobConfig)===null||he===void 0?void 0:he.value,(Ce=Be.current)===null||Ce===void 0||Ce.setFieldsValue({jobConfig:I()(I()({},A.jobConfig),{},{interval:Fe===M.period?xe:void 0,time:Fe===M.timed?Sr()(xe,"HH:mm:ss"):void 0})}),X(!1);case 17:case"end":return G.stop()}},E)}));return function(E){return j.apply(this,arguments)}}()));case 1:case"end":return o.stop()}},T)})),[f]);var kr=function(){var T=x()(s()().mark(function m(o,j){var E,Z;return s()().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,(0,C.Iw)({id:j.id,name:j.name,remark:j.remark});case 2:if(E=w.sent,Z=E.success,!Z){w.next=8;break}return Q.ZP.success("\u64CD\u4F5C\u6210\u529F"),ge(I()({},j)),w.abrupt("return",Promise.resolve(!0));case 8:return w.abrupt("return",Promise.resolve(!1));case 9:case"end":return w.stop()}},m)}));return function(o,j){return T.apply(this,arguments)}}(),Vr=(0,e.jsx)(ze.X.Consumer,{children:function(m){var o=m.isMobile;return P?(0,e.jsx)(Ee.Z,{active:!0,paragraph:{rows:1}}):(0,e.jsxs)(de.vY,{size:"small",column:o?1:2,dataSource:I()({},B),editable:{onSave:kr},children:[(0,e.jsx)(de.vY.Item,{dataIndex:"name",label:"\u540D\u79F0"}),(0,e.jsx)(de.vY.Item,{dataIndex:"remark",label:"\u5907\u6CE8",valueType:"textarea",fieldProps:{rows:2,maxLength:20}})]})}});return(0,e.jsxs)(Le._z,{onBack:function(){k.m.push("/account/identity-source")},title:P?(0,e.jsx)(Ee.Z.Input,{style:{width:50},active:!0,size:"small"}):B==null?void 0:B.name,content:Vr,tabList:[{key:V.config,tab:"\u540C\u6B65\u914D\u7F6E"},{key:V.sync_history,tab:"\u540C\u6B65\u5386\u53F2"},{key:V.event_record,tab:"\u4E8B\u4EF6\u8BB0\u5F55"}],tabActiveKey:b,onTabChange:function(m){n(m),k.m.replace({pathname:u.pathname,search:(0,pe.stringify)({tab:m,id:t})})},children:[V.config===b&&(0,e.jsx)(be.Z,{children:(0,e.jsx)(Ie.Z,{spinning:P,children:(0,e.jsxs)(te.L,{current:Rr,onCurrentChange:$e,formProps:I()({layout:"horizontal"},We),onFinish:function(){var T=x()(s()().mark(function m(o){var j,E,Z,R,w,W;return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.prev=0,g(!0),F.next=4,(0,C.NK)(I()(I()({id:t},(0,Ne.omit)(o,"strategyConfig")),{},{strategyConfig:I()(I()({},o.strategyConfig),{},{organization:{targetId:o==null||(j=o.strategyConfig)===null||j===void 0||(E=j.organization)===null||E===void 0||(Z=E.targetId)===null||Z===void 0?void 0:Z.value}})}));case 4:if(R=F.sent,w=R.result,W=R.success,!(W&&w)){F.next=13;break}return $e(0),Q.ZP.success("\u64CD\u4F5C\u6210\u529F"),F.next=12,(0,C.bh)(t);case 12:return F.abrupt("return");case 13:g(!1),F.next=18;break;case 16:F.prev=16,F.t0=F.catch(0);case 18:return F.prev=18,g(!1),F.finish(18);case 21:case"end":return F.stop()}},m,null,[[0,16,18,21]])}));return function(m){return T.apply(this,arguments)}}(),submitter:{render:function(m,o){return(0,e.jsx)(Me.S,{children:o})}},children:[(0,e.jsx)(te.L.StepForm,{scrollToFirstError:!0,name:"base-config",title:"\u57FA\u672C\u914D\u7F6E",formRef:z,className:Br,onFinish:x()(s()().mark(function T(){var m,o;return s()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return o=(m=U.current)===null||m===void 0?void 0:m.configValidator(),E.abrupt("return",Promise.resolve(o));case 2:case"end":return E.stop()}},T)})),children:(0,e.jsx)(Ie.Z,{spinning:N,children:(0,e.jsx)(er,{provider:(B==null?void 0:B.provider)||S,configured:_,formRef:z,basicConfigRef:U,onConfigValidator:function(){var T=x()(s()().mark(function m(o){var j,E;return s()().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return g(!0),R.next=3,(0,C.jA)({provider:B==null?void 0:B.provider,config:o});case 3:return j=R.sent,E=j.result,g(!1),R.abrupt("return",E);case 7:case"end":return R.stop()}},m)}));return function(m){return T.apply(this,arguments)}}()})})}),(0,e.jsx)(te.L.StepForm,{scrollToFirstError:!0,name:"strategy-config",title:"\u9AD8\u7EA7\u914D\u7F6E",formRef:ke,children:_!==void 0&&(0,e.jsx)(or,{configured:_})}),(0,e.jsx)(te.L.StepForm,{scrollToFirstError:!0,name:"job-config",title:"\u4EFB\u52A1\u914D\u7F6E",formRef:Be,children:_!==void 0&&(0,e.jsx)(ur,{configured:_})})]})})}),V.sync_history===b&&(0,e.jsx)(Cr,{identitySourceId:t}),V.event_record===b&&(0,e.jsx)(Er,{identitySourceId:t})]})},Zr=Tr},78098:function(Oe,ae,r){r.d(ae,{J:function(){return ne},h:function(){return x}});var le=r(64129),I=r.n(le),oe=r(11281),s=r.n(oe);function ne(J,y,C){return J.map(function(k){return k.id===y?s()(s()({},k),{},{isLeaf:!1,children:C}):k.children?s()(s()({},k),{},{children:ne(k.children,y,C)}):k})}function x(J){var y=[];return J.forEach(function(C){return y.push(C.id),C.children&&y.push.apply(y,I()(x(C.children))),y}),y}}}]);
