/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2022 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[2051],{11911:function(z,L,e){"use strict";e.d(L,{Gh:function(){return y},SC:function(){return N},Zw:function(){return s},b$:function(){return j},n6:function(){return F},pR:function(){return B},rD:function(){return A}});var A;(function(r){r.EX900005="EX900005",r.EX000102="EX000102",r.EX000202="EX000202",r.SUCCESS="200"})(A||(A={}));var s;(function(r){r.ALIYUN="aliyun",r.QI_NIU="qiniu",r.TENCENT="tencent",r.NET_EASE="netease",r.MAXMIND="maxmind"})(s||(s={}));var F;(function(r){r.ALIYUN="aliyun",r.TENCENT="tencent",r.GEE_TEST="geetest",r.HCAPTCHA="hcaptcha",r.RECAPTCHA="recaptcha"})(F||(F={}));var B;(function(r){r.STANDARD="standard",r.CUSTOM_MADE="custom_made"})(B||(B={}));var j;(function(r){r.SAML2="saml2",r.OIDC="oidc",r.CAS="cas",r.JWT="jwt",r.FORM="form",r.OAUTH2="oauth2"})(j||(j={}));var y;(function(r){r.ALLOW="ALLOW",r.DENY="DENY"})(y||(y={}));var N;(function(r){r.ROLE="ROLE",r.RESOURCE="RESOURCE",r.USER="USER",r.ORGANIZATION="ORGANIZATION",r.USER_GROUP="USER_GROUP"})(N||(N={}))},19882:function(z,L,e){"use strict";e.r(L),e.d(L,{default:function(){return ge}});var A=e(97983),s=e.n(A),F=e(11281),B=e.n(F),j=e(40794),y=e.n(j),N=e(12741),r=e.n(N),D=e(11911),O=e(64348),W=e(81354),U=e.n(W),K=function(i,f){var t=U().enc.Base64.parse(f),o=U().enc.Utf8.parse(i),g=U().AES.encrypt(o,t,{mode:U().mode.ECB,padding:U().pad.Pkcs7});return g.toString()};function Be(h,i){var f=CryptoJS.enc.Base64.parse(i),t=CryptoJS.AES.decrypt(h,f,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Utf8.stringify(t)}function Ae(h){var i=h.text,f=h.secretKey,t=CryptoJS.enc.Base64.parse(f),o=t.clone();o.sigBytes=16,o.words.splice(4);var g=CryptoJS.enc.Utf8.parse(i),p=CryptoJS.AES.encrypt(g,t,{iv:o,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return p.toString()}function Fe(h){var i=h.textBase64,f=h.secretKey,t=CryptoJS.enc.Base64.parse(f),o=t.clone();o.sigBytes=16,o.words.splice(4);var g=CryptoJS.AES.decrypt(i,t,{iv:o,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Utf8.stringify(g)}var Y=e(87547),Q=e(94149),k=e(26),P=e(5966),V=e(63434),q=e(78234),_=e(2093),ee=e(49807),re=e(99138),ne=e(43825),J=e(2453),ae=e(67294),E=e(98971),T=e(67038),te=e(73935),se=e(94184),I=e.n(se),oe=e(12812),C=e.n(oe),ue=e(38755);function ie(h){var i=".".concat(h),f=(0,ue.l)(function(t){var o,g,p,M=t.token;return p={},C()(p,"".concat(i),(o={padding:"24px"},C()(o,"".concat(i,"-form-prefix-icon"),{color:M.colorPrimary,fontSize:M.fontSize}),C()(o,".ant-pro-form-login-page-logo",{width:"200px",height:"50px",marginRight:0,fontSize:"18px",lineHeight:"50px",textAlign:"center",verticalAlign:"top"}),C()(o,".ant-pro-form-login-page-desc",{marginTop:"30px",marginBottom:"25px",color:"rgba(0, 0, 0, 0.45)",fontSize:"14px"}),o)),C()(p,"@media screen and (max-width: ".concat(M.screenLG,"px)"),C()({},"".concat(i),(g={},C()(g,".ant-pro-form-login-page",{backgroundImage:"none !important"}),C()(g,".ant-pro-form-login-page-notice ",{display:"none"}),C()(g,".ant-pro-form-login-page-container",{maxWidth:"none"}),g))),p});return{className:f}}var le=e(34441),a=e(85893),Z="login",G=!0,ce=function(i){var f=i.content;return(0,a.jsx)(re.Z,{message:f,type:"error",showIcon:!0})},de=function(){var i=(0,ae.useState)(),f=r()(i,2),t=f[0],o=f[1],g=(0,E.useModel)("@@initialState"),p=g.initialState,M=g.setInitialState,me=ne.Z.useForm(),pe=r()(me,1),b=pe[0],w=(0,E.useIntl)(),ve=ie(Z),he=ve.className,ye=function(){var l=y()(s()().mark(function u(){var n,m;return s()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,p==null||(n=p.fetchUserInfo)===null||n===void 0?void 0:n.call(p);case 2:m=x.sent,m&&(0,te.flushSync)(function(){M(function(c){return B()(B()({},c),{},{currentUser:m})})});case 4:case"end":return x.stop()}},u)}));return function(){return l.apply(this,arguments)}}(),H=function(){if(!!E.history){var u=(0,T.parse)(E.history.location.search),n=u,m=n.redirect_uri;window.location.replace(m||"/")}},Se=function(){var l=y()(s()().mark(function u(){var n,m,v;return s()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,(0,O.qX)();case 2:if(n=c.sent,m=n.success,v=n.result,!(m&&v)){c.next=7;break}return c.abrupt("return",Promise.resolve(v.secret));case 7:return c.abrupt("return",Promise.resolve(void 0));case 8:case"end":return c.stop()}},u)}));return function(){return l.apply(this,arguments)}}();(0,q.Z)(y()(s()().mark(function l(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(p&&p.currentUser)){n.next=4;break}return n.next=3,H();case 3:return n.abrupt("return");case 4:case"end":return n.stop()}},l)}))),(0,_.Z)(y()(s()().mark(function l(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:G&&b.setFieldsValue({username:"admin",password:"NI7k1FxahAPv2oy4"});case 1:case"end":return n.stop()}},l)})),[]);var R=function(){var l=y()(s()().mark(function u(n){var m,v,x,c,S;return s()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return m=n.password,d.next=3,Se().then(function(X){X&&(m=K(m,X))});case 3:return v=(0,T.parse)(E.history.location.search),x=v,c=x.redirect_uri,c||(c=window.location.href),d.next=8,(0,O.vq)(B()(B()({},n),{},{password:m,redirect_uri:c}));case 8:if(S=d.sent,o({message:"",status:""}),!(S!=null&&S.success)){d.next=18;break}return d.next=13,ye();case 13:return J.ZP.loading({content:"\u767B\u5F55\u6210\u529F\uFF01\u6B63\u5728\u8DF3\u8F6C...",key:"loading",duration:0}),d.next=16,H();case 16:return J.ZP.destroy("loading"),d.abrupt("return",Promise.resolve(!0));case 18:if(!(!S.success&&S.status===D.rD.EX900005)){d.next=22;break}return d.next=21,R(n);case 21:return d.abrupt("return",d.sent);case 22:return o({message:S.message,status:S==null?void 0:S.result}),d.abrupt("return",Promise.resolve(!1));case 24:case"end":return d.stop()}},u)}));return function(n){return l.apply(this,arguments)}}(),$=(0,ee.Z)(R,{debounceWait:0,manual:!0}),Ee=$.data,Ce=$.loading,xe=$.run;return(0,a.jsxs)("div",{className:he,children:[G&&(0,a.jsx)(le.Z,{}),(0,a.jsx)("div",{className:I()("".concat(Z)),children:(0,a.jsx)("div",{style:{backgroundColor:"white",height:"calc(100vh - 48px)",border:"1px solid rgb(240, 240, 240)"},children:(0,a.jsxs)(k.B,{backgroundImageUrl:"/login-background.png",logo:"/full-logo.svg",subTitle:"\u4F01\u4E1A\u7EA7\u8EAB\u4EFD\u7BA1\u7406\u548C\u8BBF\u95EE\u7BA1\u7406\u7A0B\u5E8F\uFF0C\u4E3A\u6570\u5B57\u8EAB\u4EFD\u5B89\u5168\u8D4B\u80FD\uFF01",initialValues:{"remember-me":!1},form:b,scrollToFirstError:!0,submitter:{searchConfig:{submitText:w.formatMessage({id:"pages.login.submit",defaultMessage:"\u767B\u5F55"})},render:function(u,n){return n.pop()},submitButtonProps:{loading:Ce,size:"large",style:{width:"100%"}}},onFinish:function(){var l=y()(s()().mark(function u(n){return s()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,xe(n);case 2:return v.abrupt("return",Ee);case 3:case"end":return v.stop()}},u)}));return function(u){return l.apply(this,arguments)}}(),children:[(t==null?void 0:t.status)!==D.rD.SUCCESS&&(t==null?void 0:t.message)&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ce,{content:t==null?void 0:t.message}),(0,a.jsx)("br",{})]}),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{name:"username",fieldProps:{size:"large",prefix:(0,a.jsx)(Y.Z,{className:I()("".concat(Z,"-form-prefix-icon"))}),autoComplete:"off"},placeholder:w.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D / \u624B\u673A\u53F7 / \u90AE\u7BB1"}),rules:[{required:!0,message:(0,a.jsx)(E.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8D26\u53F7\u672A\u586B\u5199"})}]}),(0,a.jsx)(P.Z.Password,{name:"password",fieldProps:{size:"large",autoComplete:"new-password",prefix:(0,a.jsx)(Q.Z,{className:I()("".concat(Z,"-form-prefix-icon"))})},placeholder:w.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u8BF7\u8F93\u5165\u767B\u5F55\u5BC6\u7801"}),rules:[{required:!0,message:(0,a.jsx)(E.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u5BC6\u7801\u672A\u586B\u5199"})}]})]}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)(V.Z,{noStyle:!0,name:"remember-me",children:(0,a.jsx)(E.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,a.jsx)("a",{style:{float:"right"},onClick:y()(s()().mark(function l(){return s()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:J.ZP.info("\u6682\u672A\u5B9E\u73B0");case 1:case"end":return n.stop()}},l)})),children:(0,a.jsx)(E.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})})})]})},fe=de,ge=fe},42480:function(){}}]);
