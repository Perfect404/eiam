/*
 * eiam-console - Employee Identity and Access Management Program
 * Copyright Â© 2020-2022 TopIAM (support@topiam.cn)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(self.webpackChunktopiam_console=self.webpackChunktopiam_console||[]).push([[7820],{81618:function(vn){"use strict";(function(Ft,ot){vn.exports=ot()})(this,function(){function Ft(ct){var et=[];return ct.AMapUI&&et.push(ot(ct.AMapUI)),ct.Loca&&et.push(Lt(ct.Loca)),Promise.all(et)}function ot(ct){return new Promise(function(et,Ee){var it=[];if(ct.plugins)for(var st=0;st<ct.plugins.length;st+=1)I.AMapUI.plugins.indexOf(ct.plugins[st])==-1&&it.push(ct.plugins[st]);if(Et.AMapUI===wt.failed)Ee("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(Et.AMapUI===wt.notload){Et.AMapUI=wt.loading,I.AMapUI.version=ct.version||I.AMapUI.version,st=I.AMapUI.version;var Zt=document.body||document.head,P=document.createElement("script");P.type="text/javascript",P.src="https://webapi.amap.com/ui/"+st+"/main.js",P.onerror=function(b){Et.AMapUI=wt.failed,Ee("\u8BF7\u6C42 AMapUI \u5931\u8D25")},P.onload=function(){if(Et.AMapUI=wt.loaded,it.length)window.AMapUI.loadUI(it,function(){for(var b=0,X=it.length;b<X;b++){var le=it[b].split("/").slice(-1)[0];window.AMapUI[le]=arguments[b]}for(et();q.AMapUI.length;)q.AMapUI.splice(0,1)[0]()});else for(et();q.AMapUI.length;)q.AMapUI.splice(0,1)[0]()},Zt.appendChild(P)}else Et.AMapUI===wt.loaded?ct.version&&ct.version!==I.AMapUI.version?Ee("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):it.length?window.AMapUI.loadUI(it,function(){for(var b=0,X=it.length;b<X;b++){var le=it[b].split("/").slice(-1)[0];window.AMapUI[le]=arguments[b]}et()}):et():ct.version&&ct.version!==I.AMapUI.version?Ee("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):q.AMapUI.push(function(b){b?Ee(b):it.length?window.AMapUI.loadUI(it,function(){for(var X=0,le=it.length;X<le;X++){var Se=it[X].split("/").slice(-1)[0];window.AMapUI[Se]=arguments[X]}et()}):et()})})}function Lt(ct){return new Promise(function(et,Ee){if(Et.Loca===wt.failed)Ee("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(Et.Loca===wt.notload){Et.Loca=wt.loading,I.Loca.version=ct.version||I.Loca.version;var it=I.Loca.version,st=I.AMap.version.startsWith("2"),Zt=it.startsWith("2");if(st&&!Zt||!st&&Zt)Ee("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{st=I.key,Zt=document.body||document.head;var P=document.createElement("script");P.type="text/javascript",P.src="https://webapi.amap.com/loca?v="+it+"&key="+st,P.onerror=function(b){Et.Loca=wt.failed,Ee("\u8BF7\u6C42 AMapUI \u5931\u8D25")},P.onload=function(){for(Et.Loca=wt.loaded,et();q.Loca.length;)q.Loca.splice(0,1)[0]()},Zt.appendChild(P)}}else Et.Loca===wt.loaded?ct.version&&ct.version!==I.Loca.version?Ee("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):et():ct.version&&ct.version!==I.Loca.version?Ee("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):q.Loca.push(function(b){b?Ee(b):Ee()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var wt;(function(ct){ct.notload="notload",ct.loading="loading",ct.loaded="loaded",ct.failed="failed"})(wt||(wt={}));var I={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Et={AMap:wt.notload,AMapUI:wt.notload,Loca:wt.notload},q={AMap:[],AMapUI:[],Loca:[]},lt=[],ht=function(ct){typeof ct=="function"&&(Et.AMap===wt.loaded?ct(window.AMap):lt.push(ct))};return{load:function(ct){return new Promise(function(et,Ee){if(Et.AMap==wt.failed)Ee("");else if(Et.AMap==wt.notload){var it=ct.key,st=ct.version,Zt=ct.plugins;it?(window.AMap&&location.host!=="lbs.amap.com"&&Ee("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),I.key=it,I.AMap.version=st||I.AMap.version,I.AMap.plugins=Zt||I.AMap.plugins,Et.AMap=wt.loading,st=document.body||document.head,window.___onAPILoaded=function(b){if(delete window.___onAPILoaded,b)Et.AMap=wt.failed,Ee(b);else for(Et.AMap=wt.loaded,Ft(ct).then(function(){et(window.AMap)}).catch(Ee);lt.length;)lt.splice(0,1)[0]()},Zt=document.createElement("script"),Zt.type="text/javascript",Zt.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+I.AMap.version+"&key="+it+"&plugin="+I.AMap.plugins.join(","),Zt.onerror=function(b){Et.AMap=wt.failed,Ee(b)},st.appendChild(Zt)):Ee("\u8BF7\u586B\u5199key")}else if(Et.AMap==wt.loaded)if(ct.key&&ct.key!==I.key)Ee("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(ct.version&&ct.version!==I.AMap.version)Ee("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(it=[],ct.plugins)for(st=0;st<ct.plugins.length;st+=1)I.AMap.plugins.indexOf(ct.plugins[st])==-1&&it.push(ct.plugins[st]);it.length?window.AMap.plugin(it,function(){Ft(ct).then(function(){et(window.AMap)}).catch(Ee)}):Ft(ct).then(function(){et(window.AMap)}).catch(Ee)}else if(ct.key&&ct.key!==I.key)Ee("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(ct.version&&ct.version!==I.AMap.version)Ee("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var P=[];if(ct.plugins)for(st=0;st<ct.plugins.length;st+=1)I.AMap.plugins.indexOf(ct.plugins[st])==-1&&P.push(ct.plugins[st]);ht(function(){P.length?window.AMap.plugin(P,function(){Ft(ct).then(function(){et(window.AMap)}).catch(Ee)}):Ft(ct).then(function(){et(window.AMap)}).catch(Ee)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,I={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},Et={AMap:wt.notload,AMapUI:wt.notload,Loca:wt.notload},q={AMap:[],AMapUI:[],Loca:[]}}}})},67841:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return ht}});var Lt=ot(1413),wt=ot(67294),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 736c0-111.6-65.4-208-160-252.9V317.3c0-15.1-5.3-29.7-15.1-41.2L536.5 95.4C530.1 87.8 521 84 512 84s-18.1 3.8-24.5 11.4L335.1 276.1a63.97 63.97 0 00-15.1 41.2v165.8C225.4 528 160 624.4 160 736h156.5c-2.3 7.2-3.5 15-3.5 23.8 0 22.1 7.6 43.7 21.4 60.8a97.2 97.2 0 0043.1 30.6c23.1 54 75.6 88.8 134.5 88.8 29.1 0 57.3-8.6 81.4-24.8 23.6-15.8 41.9-37.9 53-64a97 97 0 0043.1-30.5 97.52 97.52 0 0021.4-60.8c0-8.4-1.1-16.4-3.1-23.8H864zM762.3 621.4c9.4 14.6 17 30.3 22.5 46.6H700V558.7a211.6 211.6 0 0162.3 62.7zM388 483.1V318.8l124-147 124 147V668H388V483.1zM239.2 668c5.5-16.3 13.1-32 22.5-46.6 16.3-25.2 37.5-46.5 62.3-62.7V668h-84.8zm388.9 116.2c-5.2 3-11.2 4.2-17.1 3.4l-19.5-2.4-2.8 19.4c-5.4 37.9-38.4 66.5-76.7 66.5-38.3 0-71.3-28.6-76.7-66.5l-2.8-19.5-19.5 2.5a27.7 27.7 0 01-17.1-3.5c-8.7-5-14.1-14.3-14.1-24.4 0-10.6 5.9-19.4 14.6-23.8h231.3c8.8 4.5 14.6 13.3 14.6 23.8-.1 10.2-5.5 19.6-14.2 24.5zM464 400a48 48 0 1096 0 48 48 0 10-96 0z"}}]},name:"rocket",theme:"outlined"},Et=I,q=ot(84089),lt=function(et,Ee){return wt.createElement(q.Z,(0,Lt.Z)((0,Lt.Z)({},et),{},{ref:Ee,icon:Et}))};lt.displayName="RocketOutlined";var ht=wt.forwardRef(lt)},98869:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return I8}});var Lt={};ot.r(Lt),ot.d(Lt,{add:function(){return mv},adjoint:function(){return Xr},clone:function(){return an},copy:function(){return en},create:function(){return Je},determinant:function(){return sn},equals:function(){return Kp},exactEquals:function(){return Zg},frob:function(){return ku},fromQuat:function(){return Iu},fromQuat2:function(){return Pi},fromRotation:function(){return gi},fromRotationTranslation:function(){return Xi},fromRotationTranslationScale:function(){return Ea},fromRotationTranslationScaleOrigin:function(){return jo},fromScaling:function(){return Bn},fromTranslation:function(){return Jr},fromValues:function(){return Ri},fromXRotation:function(){return mi},fromYRotation:function(){return pi},fromZRotation:function(){return fi},frustum:function(){return _a},getRotation:function(){return Ni},getScaling:function(){return kn},getTranslation:function(){return Gi},identity:function(){return qe},invert:function(){return yr},lookAt:function(){return rh},mul:function(){return Ih},multiply:function(){return mr},multiplyScalar:function(){return i0},multiplyScalarAndAdd:function(){return $0},ortho:function(){return Y0},orthoNO:function(){return Zl},orthoZO:function(){return Ll},perspective:function(){return Oc},perspectiveFromFieldOfView:function(){return lf},perspectiveNO:function(){return mo},perspectiveZO:function(){return Al},rotate:function(){return Ge},rotateX:function(){return vr},rotateY:function(){return tr},rotateZ:function(){return Hr},scale:function(){return kr},set:function(){return so},str:function(){return gv},sub:function(){return jm},subtract:function(){return Mh},targetTo:function(){return cp},translate:function(){return pr},transpose:function(){return Re}});var wt=ot(67294),I=ot(70655),Et=ot(45098),q=ot(1413),lt=ot(15861),ht=ot(97685),ct=ot(15671),et=ot(43144),Ee=ot(64687),it=ot.n(Ee),st=ot(97326),Zt=ot(60136),P=ot(82963),b=ot(61120),X=ot(4942),le=ot(28660),Se=ot(26729),Ie=ot.n(Se),It=ot(86700),rt=ot(84879),Dt={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")};function Ae(n){var l=131,a=137,s=0;n+="x";for(var o=Math.floor(9007199254740991/a),h=0;h<n.length;h++)s>o&&(s=Math.floor(s/a)),s=s*l+n.charCodeAt(h);return s}function be(n){n=n.toString();for(var l=5381,a=n.length;a;)l=l*33^n.charCodeAt(--a);return l>>>0}var me=ot(74902),ee=ot(96486),we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _e(n){this.message=n}_e.prototype=new Error,_e.prototype.name="InvalidCharacterError";function gt(n){var l=String(n).replace(/=+$/,"");if(l.length%4===1)throw new _e("'atob' failed: The string to be decoded is not correctly encoded.");for(var a="",s=0,o,h,v=0;h=l.charAt(v++);~h&&(o=s%4?o*64+h:h,s++%4)?a+=String.fromCharCode(255&o>>(-2*s&6)):0)h=we.indexOf(h);return a}function Pt(n){n=String(n);for(var l,a,s,o,h="",v=0,m=n.length%3;v<n.length;){if((a=n.charCodeAt(v++))>255||(s=n.charCodeAt(v++))>255||(o=n.charCodeAt(v++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");l=a<<16|s<<8|o,h+=we.charAt(l>>18&63)+we.charAt(l>>12&63)+we.charAt(l>>6&63)+we.charAt(l&63)}return m?h.slice(0,m-3)+"===".substring(m):h}var J=function(){function n(l,a){(0,ct.Z)(this,n),this.buffers=l,this.type=a}return(0,et.Z)(n,[{key:"arraybuffer",value:function(){return Promise.resolve(this.buffers[0])}},{key:"stream",value:function(){throw new Error("not implemented")}},{key:"text",value:function(){throw new Error("not implemented")}},{key:"slice",value:function(a,s,o){throw new Error("not implemented")}}]),n}(),vt,W=function(){return vt||(vt=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof ot.g!="undefined"?ot.g:{})};vt=W();var dt;typeof window=="undefined"?dt={devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(l){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(l){return null},clearMeasures:function(l){return null},clearMarks:function(l){return null},measure:function(l,a,s){return{duration:0}},now:function(){return new Date().getTime()}},Blob:"",dispatchEvent:function(l){return!0},Event:function(l,a){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:dt=window;var Vt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ne=Vt?my.getSystemInfoSync().pixelRatio:dt.devicePixelRatio,ge=(0,et.Z)(function n(l,a){(0,ct.Z)(this,n),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=l,this.timeStamp=Date.now()});function $e(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=jt(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function jt(n,l){if(!!n){if(typeof n=="string")return Qt(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qt(n,l)}}function Qt(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Te=new WeakMap,ae=function(){function n(){(0,ct.Z)(this,n),Te.set(this,{})}return(0,et.Z)(n,[{key:"addEventListener",value:function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=Te.get(this);h||(h={}),h[a]||(h[a]=[]),h[a].push(s),Te.set(this,h),o.capture,o.once,o.passive}},{key:"removeEventListener",value:function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=Te.get(this);if(h){var v=h[a];if(v&&v.length>0){for(var m=v.length;m--;m>0)if(v[m]===s){v.splice(m,1);break}}}}},{key:"dispatchEvent",value:function(a){var s=Te.get(this)[a.type];if(s){var o=$e(s),h;try{for(o.s();!(h=o.n()).done;){var v=h.value;v(a)}}catch(m){o.e(m)}finally{o.f()}}}}]),n}();function Ke(n){var l=or();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function or(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ie=function(n){(0,Zt.Z)(a,n);var l=Ke(a);function a(){var s;return(0,ct.Z)(this,a),s=l.call(this),s.childNodes=[],s}return(0,et.Z)(a,[{key:"appendChild",value:function(o){this.childNodes.push(o)}},{key:"cloneNode",value:function(){var o=Object.create(this);return Object.assign(o,this),o}},{key:"removeChild",value:function(o){var h=this.childNodes.findIndex(function(v){return v===o});return h>-1?this.childNodes.splice(h,1):null}}]),a}(ae);function te(n){var l=St();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function St(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var qt=function(n){(0,Zt.Z)(a,n);var l=te(a);function a(){var s;return(0,ct.Z)(this,a),s=l.call(this),s.className="",s.children=[],s}return(0,et.Z)(a,[{key:"setAttribute",value:function(o,h){this[o]=h}},{key:"getAttribute",value:function(o){return this[o]}},{key:"setAttributeNS",value:function(o,h){this[o]=h}},{key:"getAttributeNS",value:function(o){return this[o]}}]),a}(ie),$t=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Ct,Tt,ue,Oe;if($t){var We=my.getSystemInfoSync();Ct=We.screenWidth,Tt=We.screenHeight,ue=We.windowWidth,Oe=We.windowHeight}else{var zt=dt.innerWidth,At=dt.innerHeight;Ct=zt,Tt=At,ue=zt,Oe=At}var Mt={width:Ct,height:Tt,availWidth:ue,availHeight:Oe,availLeft:0,availTop:0},Rt=Mt.availWidth,tt=Mt.availHeight,_t={style:[]};function Xt(n,l){if(!("parentNode"in n)){var a;l===0?a=function(){return null}:l===1?a=function(){return _t}:a=function(){return null},Object.defineProperty(n,"parentNode",{enumerable:!0,get:a})}if(!("parentElement"in n)){var s;l===0?s=function(){return null}:l===1?s=function(){return _t}:s=function(){return null},Object.defineProperty(n,"parentElement",{enumerable:!0,get:s})}}function ve(n){n.style=n.style||{},Object.assign(n.style,{top:"0px",left:"0px",width:Rt+"px",height:tt+"px",margin:"0px",padding:"0px"})}function Wt(n){"clientLeft"in n||(n.clientLeft=0,n.clientTop=0),"clientWidth"in n||(n.clientWidth=Rt,n.clientHeight=tt),"getBoundingClientRect"in n||(n.getBoundingClientRect=function(){var l={x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight};return l})}function Me(n){"offsetLeft"in n||(n.offsetLeft=0,n.offsetTop=0),"offsetWidth"in n||(n.offsetWidth=Rt,n.offsetHeight=tt)}function je(n){"scrollLeft"in n||(n.scrollLeft=0,n.scrollTop=0),"scrollWidth"in n||(n.scrollWidth=Rt,n.scrollHeight=tt)}function Qe(n){var l=function(){return!0};n.classList=[],n.classList.add=l,n.classList.remove=l,n.classList.contains=l,n.classList.toggle=l}function hr(n){var l=er();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function er(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function Br(){}var Lr=function(n){(0,Zt.Z)(a,n);var l=hr(a);function a(){var s,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",h=arguments.length>1?arguments[1]:void 0;return(0,ct.Z)(this,a),s=l.call(this),s.className="",s.children=[],s.focus=Br,s.blur=Br,s.insertBefore=Br,s.appendChild=Br,s.removeChild=Br,s.remove=Br,s.innerHTML="",s.tagName=o.toUpperCase(),Xt((0,st.Z)(s),h),ve((0,st.Z)(s)),Qe((0,st.Z)(s)),Wt((0,st.Z)(s)),Me((0,st.Z)(s)),je((0,st.Z)(s)),s}return(0,et.Z)(a)}(qt);function Zr(n){var l=Tn();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Tn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rn=function(n){(0,Zt.Z)(a,n);var l=Zr(a);function a(s){return(0,ct.Z)(this,a),l.call(this,s)}return(0,et.Z)(a,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),a}(Lr);function Nn(n){var l=zn();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function zn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var jn=function(n){(0,Zt.Z)(a,n);var l=Nn(a);function a(){return(0,ct.Z)(this,a),l.call(this,"video")}return(0,et.Z)(a)}(rn),wn={},Wn={};function Bt(n,l){wn=n,wn.id=l,"tagName"in wn||(wn.tagName="CANVAS"),wn.type="canvas",Mixin.parentNode(wn),Mixin.style(wn),Mixin.classList(wn),Mixin.clientRegion(wn),Mixin.offsetRegion(wn),wn.focus=function(){},wn.blur=function(){}}function Yt(n,l){var a=1024,s=1024;Wn={width:a,height:s,clientWidth:a/devicePixelRatio,clientHeight:s/devicePixelRatio,id:l,type:"canvas"},"tagName"in Wn||(Wn.tagName="CANVAS"),Mixin.parentNode(Wn),Mixin.style(Wn),Mixin.classList(Wn),Mixin.clientRegion(Wn),Mixin.offsetRegion(Wn),Wn.getContext=function(o){if(o==="2d")return n},Wn.focus=function(){},Wn.blur=function(){}}function oe(){return wn}function Ce(){return Wn}var Ue=(0,et.Z)(function n(){(0,ct.Z)(this,n);var l=oe(),a=l.createImage&&l.createImage()||{};return"tagName"in a||(a.tagName="IMG",a.__proto__=n.prototype),Xt(a),Qe(a),Object.assign(a,{addEventListener:function(o,h){a["on".concat(o)]=h.bind(a)},removeEventListener:function(o){a["on".concat(o)]=null}}),a}),fr={href:"",protocol:"",host:""};function Sr(n){var l=Pe();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Pe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ur=function(n){(0,Zt.Z)(a,n);var l=Sr(a);function a(){return(0,ct.Z)(this,a),l.call(this,"body",0)}return(0,et.Z)(a,[{key:"addEventListener",value:function(o,h){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(o,h,v){}},{key:"dispatchEvent",value:function(o){}}]),a}(Lr),Wr=function(n){(0,Zt.Z)(a,n);var l=Sr(a);function a(){return(0,ct.Z)(this,a),l.call(this,"html",0)}return(0,et.Z)(a,[{key:"addEventListener",value:function(o,h){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{}}},{key:"removeEventListener",value:function(o,h){}},{key:"dispatchEvent",value:function(o){}}]),a}(Lr),Sn={},qr={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:fr,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(l){return l=l.toLowerCase(),l==="canvas"?my.createOffscreenCanvas(1024,128,"2d"):l==="img"?new Ue:l==="video"?new jn:new Lr(l)},createElementNS:function(l,a){return this.createElement(a)},createTextNode:function(l){return l},getElementById:function(l){return null},getElementsByTagName:function(l){return l=l.toLowerCase(),[]},getElementsByTagNameNS:function(l,a){return this.getElementsByTagName(a)},getElementsByName:function(l){return[]},querySelector:function(l){return null},querySelectorAll:function(l){return[]},addEventListener:function(l,a,s){Sn[l]||(Sn[l]=[]),Sn[l].push(a)},removeEventListener:function(l,a){var s=Sn[l];if(s&&s.length>0){for(var o=s.length;o--;o>0)if(s[o]===a){s.splice(o,1);break}}},dispatchEvent:function(l){var a=l.type,s=Sn[a];if(s)for(var o=0;o<s.length;o++)s[o](l);l.target&&typeof l.target["on"+a]=="function"&&l.target["on"+a](l)},createEvent:function(l){return new ge(l)}};qr.documentElement=new Wr,qr.head=new Lr("head"),qr.body=new ur;var Qr=Object,Mn=ot(71002),bi=function(){function n(){(0,ct.Z)(this,n);var l=arguments.length;if(l===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){this._w=arguments[0],this._h=arguments[1],this._data=new Uint8ClampedArray(this._w*this._h*4);return}}else l===3&&(0,Mn.Z)(arguments[0])==="object"&&typeof arguments[1]=="number"&&typeof arguments[2]=="number"&&(this._data=arguments[0],this._w=arguments[1],this._h=arguments[2]);throw new Error("ImageData: params error")}return(0,et.Z)(n,[{key:"width",get:function(){return this._w}},{key:"height",get:function(){return this._h}},{key:"data",get:function(){return this._data}}]),n}(),Si=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Kr,ai,li;if(Si){var hi=my.getSystemInfoSync();Kr=hi.system,ai=hi.platform,li=hi.language}else{var ra={versions:function(){var n=dt.navigator.userAgent;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")===-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1||n.indexOf("Linux")>-1,iPhone:n.indexOf("iPhone")>-1,iPad:n.indexOf("iPad")>-1,webApp:n.indexOf("Safari")===-1,weixin:n.indexOf("MicroMessenger")>-1,qq:n.match(/\sQQ/i)===" qq"}}(),language:(dt.navigator.browserLanguage||dt.navigator.language).toLowerCase()};ra.versions.android?ai="android":ra.versions.trident?ai="IE":ra.versions.presto?ai="Opera":ra.versions.webKit?ai="webKit":ra.versions.gecko?ai="Firefox":ra.versions.mobile?ai="mobile":ra.versions.ios?ai="ios":ra.versions.iPhone?ai="iPhone":ra.versions.iPad?ai="ipad":ra.versions.webApp?ai="webApp":ra.versions.weixin?ai="weixin":ra.versions.qq&&(ai="qq"),Kr=dt.navigator.userAgent,li=ra.language}var Ci=Kr.toLowerCase().indexOf("android")!==-1,Ba=Ci?"Android; CPU Android 6.0":"iPhone; CPU iPhone OS 10_3_1 like Mac OS X",po="Mozilla/5.0 (".concat(Ba,") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/6.6.0 MiniGame NetType/WIFI Language/").concat(li),za={platform:ai,language:li,appVersion:"5.0 (".concat(Ba,") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"),userAgent:po},Xa={mark:function(l){return null},clearMeasures:function(l){return null},clearMarks:function(l){return null},measure:function(l,a,s){return{duration:0}},now:function(){}},Ta=0,ga=0;function no(n){var l=Date.now(),a=Math.max(Ta+23,l);return ga=setTimeout(function(){n(Ta=a)},a-l),ga}function Vo(n){var l=oe();return l.requestAnimationFrame?l.requestAnimationFrame(n):no(n)}function vo(n){var l=oe();return l.cancelAnimationFrame?l.cancelAnimationFrame(n):clearTimeout(n)}var ja=function(){function n(l){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if((0,ct.Z)(this,n),l.indexOf("http://")==0||l.indexOf("https://")==0){this.href=l;return}this.href=a+l}return(0,et.Z)(n,null,[{key:"createObjectURL",value:function(a){var s=a.buffers[0],o=a.type,h=to(s),v="data:".concat(o,";base64, ");return v+h}}]),n}();function to(n){for(var l="",a=new Uint8Array(n),s=a.byteLength,o=0;o<s;o++)l+=String.fromCharCode(a[o]);return Pt(l)}var Uo={GCCSO_SHADER_BINARY_FJ:37472,_3DC_XY_AMD:34810,_3DC_X_AMD:34809,ACTIVE_ATTRIBUTES:35721,ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_PROGRAM_EXT:33369,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORMS:35718,ACTIVE_UNIFORM_MAX_LENGTH:35719,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALL_COMPLETED_NV:34034,ALL_SHADER_BITS_EXT:4294967295,ALPHA:6406,ALPHA16F_EXT:34844,ALPHA32F_EXT:34838,ALPHA8_EXT:32828,ALPHA8_OES:32828,ALPHA_BITS:3413,ALPHA_TEST_FUNC_QCOM:3009,ALPHA_TEST_QCOM:3008,ALPHA_TEST_REF_QCOM:3010,ALREADY_SIGNALED_APPLE:37146,ALWAYS:519,AMD_compressed_3DC_texture:1,AMD_compressed_ATC_texture:1,AMD_performance_monitor:1,AMD_program_binary_Z400:1,ANGLE_depth_texture:1,ANGLE_framebuffer_blit:1,ANGLE_framebuffer_multisample:1,ANGLE_instanced_arrays:1,ANGLE_pack_reverse_row_order:1,ANGLE_program_binary:1,ANGLE_texture_compression_dxt3:1,ANGLE_texture_compression_dxt5:1,ANGLE_texture_usage:1,ANGLE_translated_shader_source:1,ANY_SAMPLES_PASSED_CONSERVATIVE_EXT:36202,ANY_SAMPLES_PASSED_EXT:35887,APPLE_copy_texture_levels:1,APPLE_framebuffer_multisample:1,APPLE_rgb_422:1,APPLE_sync:1,APPLE_texture_format_BGRA8888:1,APPLE_texture_max_level:1,ARM_mali_program_binary:1,ARM_mali_shader_binary:1,ARM_rgba8:1,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATC_RGBA_EXPLICIT_ALPHA_AMD:35987,ATC_RGBA_INTERPOLATED_ALPHA_AMD:34798,ATC_RGB_AMD:35986,ATTACHED_SHADERS:35717,BACK:1029,BGRA8_EXT:37793,BGRA_EXT:32993,BGRA_IMG:32993,BINNING_CONTROL_HINT_QCOM:36784,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER:33504,BUFFER_ACCESS_OES:35003,BUFFER_MAPPED_OES:35004,BUFFER_MAP_POINTER_OES:35005,BUFFER_OBJECT_EXT:37201,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_BORDER_NV:33069,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_ATTACHMENT0_NV:36064,COLOR_ATTACHMENT10_NV:36074,COLOR_ATTACHMENT11_NV:36075,COLOR_ATTACHMENT12_NV:36076,COLOR_ATTACHMENT13_NV:36077,COLOR_ATTACHMENT14_NV:36078,COLOR_ATTACHMENT15_NV:36079,COLOR_ATTACHMENT1_NV:36065,COLOR_ATTACHMENT2_NV:36066,COLOR_ATTACHMENT3_NV:36067,COLOR_ATTACHMENT4_NV:36068,COLOR_ATTACHMENT5_NV:36069,COLOR_ATTACHMENT6_NV:36070,COLOR_ATTACHMENT7_NV:36071,COLOR_ATTACHMENT8_NV:36072,COLOR_ATTACHMENT9_NV:36073,COLOR_ATTACHMENT_EXT:37104,COLOR_BUFFER_BIT:16384,COLOR_BUFFER_BIT0_QCOM:1,COLOR_BUFFER_BIT1_QCOM:2,COLOR_BUFFER_BIT2_QCOM:4,COLOR_BUFFER_BIT3_QCOM:8,COLOR_BUFFER_BIT4_QCOM:16,COLOR_BUFFER_BIT5_QCOM:32,COLOR_BUFFER_BIT6_QCOM:64,COLOR_BUFFER_BIT7_QCOM:128,COLOR_CLEAR_VALUE:3106,COLOR_EXT:6144,COLOR_WRITEMASK:3107,COMPARE_REF_TO_TEXTURE_EXT:34894,COMPILE_STATUS:35713,COMPRESSED_RGBA_ASTC_10x10_KHR:37819,COMPRESSED_RGBA_ASTC_10x5_KHR:37816,COMPRESSED_RGBA_ASTC_10x6_KHR:37817,COMPRESSED_RGBA_ASTC_10x8_KHR:37818,COMPRESSED_RGBA_ASTC_12x10_KHR:37820,COMPRESSED_RGBA_ASTC_12x12_KHR:37821,COMPRESSED_RGBA_ASTC_4x4_KHR:37808,COMPRESSED_RGBA_ASTC_5x4_KHR:37809,COMPRESSED_RGBA_ASTC_5x5_KHR:37810,COMPRESSED_RGBA_ASTC_6x5_KHR:37811,COMPRESSED_RGBA_ASTC_6x6_KHR:37812,COMPRESSED_RGBA_ASTC_8x5_KHR:37813,COMPRESSED_RGBA_ASTC_8x6_KHR:37814,COMPRESSED_RGBA_ASTC_8x8_KHR:37815,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGBA_PVRTC_2BPPV2_IMG:37175,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_4BPPV2_IMG:37176,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_ANGLE:33778,COMPRESSED_RGBA_S3TC_DXT5_ANGLE:33779,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:37853,COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:37847,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_NV:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_NV:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_NV:35919,COMPRESSED_SRGB_S3TC_DXT1_NV:35916,COMPRESSED_TEXTURE_FORMATS:34467,CONDITION_SATISFIED_APPLE:37148,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CONTEXT_FLAG_DEBUG_BIT:2,CONTEXT_ROBUST_ACCESS_EXT:37107,COUNTER_RANGE_AMD:35777,COUNTER_TYPE_AMD:35776,COVERAGE_ALL_FRAGMENTS_NV:36565,COVERAGE_ATTACHMENT_NV:36562,COVERAGE_AUTOMATIC_NV:36567,COVERAGE_BUFFERS_NV:36563,COVERAGE_BUFFER_BIT_NV:32768,COVERAGE_COMPONENT4_NV:36561,COVERAGE_COMPONENT_NV:36560,COVERAGE_EDGE_FRAGMENTS_NV:36566,COVERAGE_SAMPLES_NV:36564,CPU_OPTIMIZED_QCOM:36785,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_QUERY_EXT:34917,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DEBUG_CALLBACK_FUNCTION:33348,DEBUG_CALLBACK_USER_PARAM:33349,DEBUG_GROUP_STACK_DEPTH:33389,DEBUG_LOGGED_MESSAGES:37189,DEBUG_NEXT_LOGGED_MESSAGE_LENGTH:33347,DEBUG_OUTPUT:37600,DEBUG_OUTPUT_SYNCHRONOUS:33346,DEBUG_SEVERITY_HIGH:37190,DEBUG_SEVERITY_LOW:37192,DEBUG_SEVERITY_MEDIUM:37191,DEBUG_SEVERITY_NOTIFICATION:33387,DEBUG_SOURCE_API:33350,DEBUG_SOURCE_APPLICATION:33354,DEBUG_SOURCE_OTHER:33355,DEBUG_SOURCE_SHADER_COMPILER:33352,DEBUG_SOURCE_THIRD_PARTY:33353,DEBUG_SOURCE_WINDOW_SYSTEM:33351,DEBUG_TYPE_DEPRECATED_BEHAVIOR:33357,DEBUG_TYPE_ERROR:33356,DEBUG_TYPE_MARKER:33384,DEBUG_TYPE_OTHER:33361,DEBUG_TYPE_PERFORMANCE:33360,DEBUG_TYPE_POP_GROUP:33386,DEBUG_TYPE_PORTABILITY:33359,DEBUG_TYPE_PUSH_GROUP:33385,DEBUG_TYPE_UNDEFINED_BEHAVIOR:33358,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH24_STENCIL8_OES:35056,DEPTH_ATTACHMENT:36096,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_BUFFER_BIT0_QCOM:256,DEPTH_BUFFER_BIT1_QCOM:512,DEPTH_BUFFER_BIT2_QCOM:1024,DEPTH_BUFFER_BIT3_QCOM:2048,DEPTH_BUFFER_BIT4_QCOM:4096,DEPTH_BUFFER_BIT5_QCOM:8192,DEPTH_BUFFER_BIT6_QCOM:16384,DEPTH_BUFFER_BIT7_QCOM:32768,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_COMPONENT16_NONLINEAR_NV:36396,DEPTH_COMPONENT16_OES:33189,DEPTH_COMPONENT24_OES:33190,DEPTH_COMPONENT32_OES:33191,DEPTH_EXT:6145,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_OES:34041,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DMP_shader_binary:1,DONT_CARE:4352,DRAW_BUFFER0_NV:34853,DRAW_BUFFER10_NV:34863,DRAW_BUFFER11_NV:34864,DRAW_BUFFER12_NV:34865,DRAW_BUFFER13_NV:34866,DRAW_BUFFER14_NV:34867,DRAW_BUFFER15_NV:34868,DRAW_BUFFER1_NV:34854,DRAW_BUFFER2_NV:34855,DRAW_BUFFER3_NV:34856,DRAW_BUFFER4_NV:34857,DRAW_BUFFER5_NV:34858,DRAW_BUFFER6_NV:34859,DRAW_BUFFER7_NV:34860,DRAW_BUFFER8_NV:34861,DRAW_BUFFER9_NV:34862,DRAW_BUFFER_EXT:3073,DRAW_FRAMEBUFFER_ANGLE:36009,DRAW_FRAMEBUFFER_APPLE:36009,DRAW_FRAMEBUFFER_BINDING_ANGLE:36006,DRAW_FRAMEBUFFER_BINDING_APPLE:36006,DRAW_FRAMEBUFFER_BINDING_NV:36006,DRAW_FRAMEBUFFER_NV:36009,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,ES_VERSION_2_0:1,ETC1_RGB8_OES:36196,ETC1_SRGB8_NV:35054,EXTENSIONS:7939,EXT_blend_minmax:1,EXT_color_buffer_half_float:1,EXT_debug_label:1,EXT_debug_marker:1,EXT_discard_framebuffer:1,EXT_map_buffer_range:1,EXT_multi_draw_arrays:1,EXT_multisampled_render_to_texture:1,EXT_multiview_draw_buffers:1,EXT_occlusion_query_boolean:1,EXT_read_format_bgra:1,EXT_robustness:1,EXT_sRGB:1,EXT_separate_shader_objects:1,EXT_shader_framebuffer_fetch:1,EXT_shader_texture_lod:1,EXT_shadow_samplers:1,EXT_texture_compression_dxt1:1,EXT_texture_filter_anisotropic:1,EXT_texture_format_BGRA8888:1,EXT_texture_rg:1,EXT_texture_storage:1,EXT_texture_type_2_10_10_10_REV:1,EXT_unpack_subimage:1,FALSE:0,FASTEST:4353,FENCE_CONDITION_NV:34036,FENCE_STATUS_NV:34035,FIXED:5132,FJ_shader_binary_GCCSO:1,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAGMENT_SHADER_BIT_EXT:2,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,FRAGMENT_SHADER_DISCARDS_SAMPLES_EXT:35410,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_ANGLE:37795,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_3D_ZOFFSET_OES:36052,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_SAMPLES_EXT:36204,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_ANGLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_APPLE:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_EXT:36182,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_IMG:37172,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE_NV:36182,FRAMEBUFFER_UNDEFINED_OES:33305,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GPU_OPTIMIZED_QCOM:36786,GREATER:516,GREEN_BITS:3411,GUILTY_CONTEXT_RESET_EXT:33363,HALF_FLOAT_OES:36193,HIGH_FLOAT:36338,HIGH_INT:36341,IMG_multisampled_render_to_texture:1,IMG_program_binary:1,IMG_read_format:1,IMG_shader_binary:1,IMG_texture_compression_pvrtc:1,IMG_texture_compression_pvrtc2:1,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INNOCENT_CONTEXT_RESET_EXT:33364,INT:5124,INT_10_10_10_2_OES:36343,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,KHR_debug:1,KHR_texture_compression_astc_ldr:1,LEFT:1030,LEQUAL:515,LESS:513,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINK_STATUS:35714,LOSE_CONTEXT_ON_RESET_EXT:33362,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE16F_EXT:34846,LUMINANCE32F_EXT:34840,LUMINANCE4_ALPHA4_OES:32835,LUMINANCE8_ALPHA8_EXT:32837,LUMINANCE8_ALPHA8_OES:32837,LUMINANCE8_EXT:32832,LUMINANCE8_OES:32832,LUMINANCE_ALPHA:6410,LUMINANCE_ALPHA16F_EXT:34847,LUMINANCE_ALPHA32F_EXT:34841,MALI_PROGRAM_BINARY_ARM:36705,MALI_SHADER_BINARY_ARM:36704,MAP_FLUSH_EXPLICIT_BIT_EXT:16,MAP_INVALIDATE_BUFFER_BIT_EXT:8,MAP_INVALIDATE_RANGE_BIT_EXT:4,MAP_READ_BIT_EXT:1,MAP_UNSYNCHRONIZED_BIT_EXT:32,MAP_WRITE_BIT_EXT:2,MAX_3D_TEXTURE_SIZE_OES:32883,MAX_COLOR_ATTACHMENTS_NV:36063,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_DEBUG_GROUP_STACK_DEPTH:33388,MAX_DEBUG_LOGGED_MESSAGES:37188,MAX_DEBUG_MESSAGE_LENGTH:37187,MAX_DRAW_BUFFERS_NV:34852,MAX_EXT:32776,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_LABEL_LENGTH:33512,MAX_MULTIVIEW_BUFFERS_EXT:37106,MAX_RENDERBUFFER_SIZE:34024,MAX_SAMPLES_ANGLE:36183,MAX_SAMPLES_APPLE:36183,MAX_SAMPLES_EXT:36183,MAX_SAMPLES_IMG:37173,MAX_SAMPLES_NV:36183,MAX_SERVER_WAIT_TIMEOUT_APPLE:37137,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIN_EXT:32775,MIRRORED_REPEAT:33648,MULTISAMPLE_BUFFER_BIT0_QCOM:16777216,MULTISAMPLE_BUFFER_BIT1_QCOM:33554432,MULTISAMPLE_BUFFER_BIT2_QCOM:67108864,MULTISAMPLE_BUFFER_BIT3_QCOM:134217728,MULTISAMPLE_BUFFER_BIT4_QCOM:268435456,MULTISAMPLE_BUFFER_BIT5_QCOM:536870912,MULTISAMPLE_BUFFER_BIT6_QCOM:1073741824,MULTISAMPLE_BUFFER_BIT7_QCOM:2147483648,MULTIVIEW_EXT:37105,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NONE:0,NOTEQUAL:517,NO_ERROR:0,NO_RESET_NOTIFICATION_EXT:33377,NUM_COMPRESSED_TEXTURE_FORMATS:34466,NUM_PROGRAM_BINARY_FORMATS_OES:34814,NUM_SHADER_BINARY_FORMATS:36345,NV_coverage_sample:1,NV_depth_nonlinear:1,NV_draw_buffers:1,NV_draw_instanced:1,NV_fbo_color_attachments:1,NV_fence:1,NV_framebuffer_blit:1,NV_framebuffer_multisample:1,NV_generate_mipmap_sRGB:1,NV_instanced_arrays:1,NV_read_buffer:1,NV_read_buffer_front:1,NV_read_depth:1,NV_read_depth_stencil:1,NV_read_stencil:1,NV_sRGB_formats:1,NV_shadow_samplers_array:1,NV_shadow_samplers_cube:1,NV_texture_border_clamp:1,NV_texture_compression_s3tc_update:1,NV_texture_npot_2D_mipmap:1,OBJECT_TYPE_APPLE:37138,OES_EGL_image:1,OES_EGL_image_external:1,OES_compressed_ETC1_RGB8_texture:1,OES_compressed_paletted_texture:1,OES_depth24:1,OES_depth32:1,OES_depth_texture:1,OES_element_index_uint:1,OES_fbo_render_mipmap:1,OES_fragment_precision_high:1,OES_get_program_binary:1,OES_mapbuffer:1,OES_packed_depth_stencil:1,OES_required_internalformat:1,OES_rgb8_rgba8:1,OES_standard_derivatives:1,OES_stencil1:1,OES_stencil4:1,OES_surfaceless_context:1,OES_texture_3D:1,OES_texture_float:1,OES_texture_float_linear:1,OES_texture_half_float:1,OES_texture_half_float_linear:1,OES_texture_npot:1,OES_vertex_array_object:1,OES_vertex_half_float:1,OES_vertex_type_10_10_10_2:1,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,PACK_REVERSE_ROW_ORDER_ANGLE:37796,PALETTE4_R5_G6_B5_OES:35730,PALETTE4_RGB5_A1_OES:35732,PALETTE4_RGB8_OES:35728,PALETTE4_RGBA4_OES:35731,PALETTE4_RGBA8_OES:35729,PALETTE8_R5_G6_B5_OES:35735,PALETTE8_RGB5_A1_OES:35737,PALETTE8_RGB8_OES:35733,PALETTE8_RGBA4_OES:35736,PALETTE8_RGBA8_OES:35734,PERCENTAGE_AMD:35779,PERFMON_GLOBAL_MODE_QCOM:36768,PERFMON_RESULT_AMD:35782,PERFMON_RESULT_AVAILABLE_AMD:35780,PERFMON_RESULT_SIZE_AMD:35781,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,PROGRAM:33506,PROGRAM_BINARY_ANGLE:37798,PROGRAM_BINARY_FORMATS_OES:34815,PROGRAM_BINARY_LENGTH_OES:34625,PROGRAM_OBJECT_EXT:35648,PROGRAM_PIPELINE_BINDING_EXT:33370,PROGRAM_PIPELINE_OBJECT_EXT:35407,PROGRAM_SEPARABLE_EXT:33368,QCOM_alpha_test:1,QCOM_binning_control:1,QCOM_driver_control:1,QCOM_extended_get:1,QCOM_extended_get2:1,QCOM_perfmon_global_mode:1,QCOM_tiled_rendering:1,QCOM_writeonly_rendering:1,QUERY:33507,QUERY_OBJECT_EXT:37203,QUERY_RESULT_AVAILABLE_EXT:34919,QUERY_RESULT_EXT:34918,R16F_EXT:33325,R32F_EXT:33326,R8_EXT:33321,READ_BUFFER_EXT:3074,READ_BUFFER_NV:3074,READ_FRAMEBUFFER_ANGLE:36008,READ_FRAMEBUFFER_APPLE:36008,READ_FRAMEBUFFER_BINDING_ANGLE:36010,READ_FRAMEBUFFER_BINDING_APPLE:36010,READ_FRAMEBUFFER_BINDING_NV:36010,READ_FRAMEBUFFER_NV:36008,RED_BITS:3410,RED_EXT:6403,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_SAMPLES_ANGLE:36011,RENDERBUFFER_SAMPLES_APPLE:36011,RENDERBUFFER_SAMPLES_EXT:36011,RENDERBUFFER_SAMPLES_IMG:37171,RENDERBUFFER_SAMPLES_NV:36011,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,RENDER_DIRECT_TO_FRAMEBUFFER_QCOM:36787,REPEAT:10497,REPLACE:7681,REQUIRED_TEXTURE_IMAGE_UNITS_OES:36200,RESET_NOTIFICATION_STRATEGY_EXT:33366,RG16F_EXT:33327,RG32F_EXT:33328,RG8_EXT:33323,RGB:6407,RGB10_A2_EXT:32857,RGB10_EXT:32850,RGB16F_EXT:34843,RGB32F_EXT:34837,RGB565:36194,RGB565_OES:36194,RGB5_A1:32855,RGB5_A1_OES:32855,RGB8_OES:32849,RGBA:6408,RGBA16F_EXT:34842,RGBA32F_EXT:34836,RGBA4:32854,RGBA4_OES:32854,RGBA8_OES:32856,RGB_422_APPLE:35359,RG_EXT:33319,RIGHT:1031,SAMPLER:33510,SAMPLER_2D:35678,SAMPLER_2D_ARRAY_SHADOW_NV:36292,SAMPLER_2D_SHADOW_EXT:35682,SAMPLER_3D_OES:35679,SAMPLER_CUBE:35680,SAMPLER_CUBE_SHADOW_NV:36293,SAMPLER_EXTERNAL_OES:36198,SAMPLES:32937,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SGX_BINARY_IMG:35850,SGX_PROGRAM_BINARY_IMG:37168,SHADER:33505,SHADER_BINARY_DMP:37456,SHADER_BINARY_FORMATS:36344,SHADER_BINARY_VIV:36804,SHADER_COMPILER:36346,SHADER_OBJECT_EXT:35656,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SIGNALED_APPLE:37145,SLUMINANCE8_ALPHA8_NV:35909,SLUMINANCE8_NV:35911,SLUMINANCE_ALPHA_NV:35908,SLUMINANCE_NV:35910,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,SRGB8_ALPHA8_EXT:35907,SRGB8_NV:35905,SRGB_ALPHA_EXT:35906,SRGB_EXT:35904,STACK_OVERFLOW:1283,STACK_UNDERFLOW:1284,STATE_RESTORE:35804,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_BUFFER_BIT0_QCOM:65536,STENCIL_BUFFER_BIT1_QCOM:131072,STENCIL_BUFFER_BIT2_QCOM:262144,STENCIL_BUFFER_BIT3_QCOM:524288,STENCIL_BUFFER_BIT4_QCOM:1048576,STENCIL_BUFFER_BIT5_QCOM:2097152,STENCIL_BUFFER_BIT6_QCOM:4194304,STENCIL_BUFFER_BIT7_QCOM:8388608,STENCIL_CLEAR_VALUE:2961,STENCIL_EXT:6146,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX1_OES:36166,STENCIL_INDEX4_OES:36167,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,SYNC_CONDITION_APPLE:37139,SYNC_FENCE_APPLE:37142,SYNC_FLAGS_APPLE:37141,SYNC_FLUSH_COMMANDS_BIT_APPLE:1,SYNC_GPU_COMMANDS_COMPLETE_APPLE:37143,SYNC_OBJECT_APPLE:35411,SYNC_STATUS_APPLE:37140,TEXTURE:5890,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE_2D:3553,TEXTURE_3D_OES:32879,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_3D_OES:32874,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_BINDING_EXTERNAL_OES:36199,TEXTURE_BORDER_COLOR_NV:4100,TEXTURE_COMPARE_FUNC_EXT:34893,TEXTURE_COMPARE_MODE_EXT:34892,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_DEPTH_QCOM:35796,TEXTURE_EXTERNAL_OES:36197,TEXTURE_FORMAT_QCOM:35798,TEXTURE_HEIGHT_QCOM:35795,TEXTURE_IMAGE_VALID_QCOM:35800,TEXTURE_IMMUTABLE_FORMAT_EXT:37167,TEXTURE_INTERNAL_FORMAT_QCOM:35797,TEXTURE_MAG_FILTER:10240,TEXTURE_MAX_ANISOTROPY_EXT:34046,TEXTURE_MAX_LEVEL_APPLE:33085,TEXTURE_MIN_FILTER:10241,TEXTURE_NUM_LEVELS_QCOM:35801,TEXTURE_OBJECT_VALID_QCOM:35803,TEXTURE_SAMPLES_IMG:37174,TEXTURE_TARGET_QCOM:35802,TEXTURE_TYPE_QCOM:35799,TEXTURE_USAGE_ANGLE:37794,TEXTURE_WIDTH_QCOM:35794,TEXTURE_WRAP_R_OES:32882,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TIMEOUT_EXPIRED_APPLE:37147,TIMEOUT_IGNORED_APPLE:18446744073709552e3,TRANSLATED_SHADER_SOURCE_LENGTH_ANGLE:37792,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRUE:1,UNKNOWN_CONTEXT_RESET_EXT:33365,UNPACK_ALIGNMENT:3317,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_PIXELS:3316,UNPACK_SKIP_ROWS:3315,UNSIGNALED_APPLE:37144,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_INT64_AMD:35778,UNSIGNED_INT_10_10_10_2_OES:36342,UNSIGNED_INT_24_8_OES:34042,UNSIGNED_INT_2_10_10_10_REV_EXT:33640,UNSIGNED_NORMALIZED_EXT:35863,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_1_5_5_5_REV_EXT:33638,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_4_4_4_4_REV_EXT:33637,UNSIGNED_SHORT_4_4_4_4_REV_IMG:33637,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,UNSIGNED_SHORT_8_8_APPLE:34234,UNSIGNED_SHORT_8_8_REV_APPLE:34235,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ARRAY_BINDING_OES:34229,VERTEX_ARRAY_OBJECT_EXT:37204,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,VERTEX_ATTRIB_ARRAY_DIVISOR_NV:35070,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VERTEX_SHADER_BIT_EXT:1,VIEWPORT:2978,VIV_shader_binary:1,WAIT_FAILED_APPLE:37149,WRITEONLY_RENDERING_QCOM:34851,WRITE_ONLY_OES:35001,Z400_BINARY_AMD:34624,ZERO:0,RASTERIZER_DISCARD:35977,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444},ju={};function Wo(n){var l=bo();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function bo(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var nr=new Map,xe=new Map,He=new Map,Mr={json:"application/json",text:"application/text",arraybuffer:"application/octet-stream"};function tn(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:this};typeof this["on".concat(n)]=="function"&&this["on".concat(n)].call(this,l)}function In(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{readyState:n};this.readyState=n,tn.call(this,"readystatechange",l)}var Un=function(n){(0,Zt.Z)(a,n);var l=Wo(a);function a(){var s;return(0,ct.Z)(this,a),s=l.call(this),s.onabort=null,s.onerror=null,s.onload=null,s.onloadstart=null,s.onprogress=null,s.ontimeout=null,s.onloadend=null,s.onreadystatechange=null,s.readyState=0,s.response=null,s.responseText=null,s._responseType="text",s.responseXML=null,s.status=0,s.statusText="",s.upload={},s.withCredentials=!1,nr.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),s}return(0,et.Z)(a,[{key:"responseType",set:function(o){this._responseType=o}},{key:"abort",value:function(){var o=He.get("requestTask");o&&o.abort()}},{key:"getAllResponseHeaders",value:function(){var o=xe.get("responseHeader");return Object.keys(o).map(function(h){return"".concat(h,": ").concat(o[h])}).join(`
`)}},{key:"getResponseHeader",value:function(o){return xe.get("responseHeader")[o]}},{key:"open",value:function(o,h,v){this._method=o,this._url=h}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:""}},{key:"setRequestHeader",value:function(o,h){var v=nr.get("requestHeader");v[o]=h,nr.set("requestHeader",v)}},{key:"addEventListener",value:function(o,h){var v=this;typeof h=="function"&&(this["on"+o]=function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.target=m.target||v,h.call(v,m)})}},{key:"removeEventListener",value:function(o,h){this["on"+o]===h&&(this["on"+o]=null)}}]),a}(ae);Un.UNSEND=0,Un.OPENED=1,Un.HEADERS_RECEIVED=2,Un.LOADING=3,Un.DONE=4;function Cn(n){var l=ta();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ta(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wa=function(n){(0,Zt.Z)(a,n);var l=Cn(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this,s),o.touches=[],o.targetTouches=[],o.changedTouches=[],o.target=oe(),o.currentTarget=oe(),o}return(0,et.Z)(a)}(ge);function es(n){var l=n||{},a=l.x,s=a===void 0?0:a,o=l.y,h=o===void 0?0:o,v=l.clientX,m=v===void 0?0:v,E=l.clientY,A=E===void 0?0:E;Object.keys(n).indexOf("x")!==-1?(n.pageX=n.clientX=s,n.pageY=n.clientY=h):(n.x=m,n.y=A)}function ko(n){return function(l){var a=new Wa(n);a.changedTouches=l.changedTouches,a.touches=l.touches,a.targetTouches=Array.prototype.slice.call(l.touches),a.timeStamp=l.timeStamp,a.changedTouches.forEach(function(s){return es(s)}),a.touches.forEach(function(s){return es(s)}),a.targetTouches.forEach(function(s){return es(s)}),qr.dispatchEvent(a)}}function ns(n){return function(l){l.type=n,qr.dispatchEvent(l)}}var Ya=ko("touchstart"),Go=ko("touchmove"),pu=ko("touchend"),ys=ns("mapCameaParams");function Rl(n){var l=mf();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function mf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wu=function(n){(0,Zt.Z)(a,n);var l=Rl(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this,s),o.target=oe(),o.currentTarget=oe(),o}return(0,et.Z)(a)}(ge),ke=["bubbles","cancelable","view","detail","screenX","screenY","clientX","clientY","ctrlKey","altKey","shiftKey","metaKey","button","relatedTarget","pointerId","width","height","pressure","tiltX","tiltY","pointerType","hwTimestamp","isPrimary","pageX","pageY","timeStamp"],Xe=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,0,0,0,0,0,"",0,!1,0,0,0],Tr="touch";function un(n,l,a){for(var s=new Wu(n),o=0;o<ke.length;o++){var h=ke[o];s[h]=l[h]||Xe[o]}return s.type=n,s.target=oe(),s.currentTarget=oe(),s.buttons=si(n),s.which=s.buttons,s.pointerId=(l.identifier||0)+2,s.bubbles=!0,s.cancelable=!0,s.button=0,s.width=(l.radiusX||.5)*2,s.height=(l.radiusY||.5)*2,s.pressure=l.force||.5,s.isPrimary=Ma(l),s.pointerType=Tr,s.altKey=a.altKey,s.ctrlKey=a.ctrlKey,s.metaKey=a.metaKey,s.shiftKey=a.shiftKey,a.preventDefault&&(s.preventDefault=function(){a.preventDefault()}),s}function si(n){var l=0;return(n==="touchstart"||n==="touchmove"||n==="pointerdown"||n==="pointermove")&&(l=1),l}var ji=null;function Ma(n){return ji===n.identifier}function ds(n){ji===null&&(ji=n.identifier)}function Ho(n){ji===n.identifier&&(ji=null)}function qo(n){return function(l){for(var a=l.changedTouches,s=0;s<a.length;s++){var o=a[s];s===0&&n==="pointerdown"?ds(o):(n==="pointerup"||n==="pointercancel")&&Ho(o);var h=un(n,o,l);qr.dispatchEvent(h)}}}var Hs=qo("pointerdown"),Xu=qo("pointermove"),_s=qo("pointerup");function vs(n){var l=Ou();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ou(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rl=function(n){(0,Zt.Z)(a,n);var l=vs(a);function a(s){return(0,ct.Z)(this,a),l.call(this,s)}return(0,et.Z)(a)}(ge);function nu(n){return function(l){l.type=n,qr.dispatchEvent(l)}}var dl=nu("mousedown"),Fu=nu("mousemove"),Fo=nu("mouseup"),rs=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Uc=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),_u=rs||Uc,Zc={atob:gt,btoa:Pt,devicePixelRatio:ne,Blob:J,document:qr,Element:qt,Event:ge,EventTarget:ae,HTMLCanvasElement:Qr,HTMLElement:Lr,HTMLMediaElement:rn,HTMLVideoElement:jn,Image:Ue,ImageData:bi,navigator:za,Node:ie,requestAnimationFrame:Vo,cancelAnimationFrame:vo,screen:Mt,XMLHttpRequest:Un,performance:Xa,URL:ja,WebGLRenderingContext:Uo,WebGL2RenderingContext:ju,addEventListener:function(l,a){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};qr.addEventListener(l,a,s)},removeEventListener:function(l,a,s){qr.removeEventListener(l,a)},dispatchEvent:function(l){qr.dispatchEvent(l)},innerWidth:Mt.availWidth,innerHeight:Mt.availHeight,setTimeout,clearTimeout,setInterval,clearInterval},Co=_u?Zc:dt,sc=_u?Un:dt.XMLHttpRequest,Xl=_u?fr:dt.location;function nl(n){var l=n;return typeof n=="string"&&(l=Co.document.getElementById(n)),l}function uc(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function D(n){return uc(n).split(/\s+/)}function Y(n){var l,a,s=Co==null||(l=Co.document)===null||l===void 0||(a=l.documentElement)===null||a===void 0?void 0:a.style;if(!s)return n[0];for(var o in n)if(n[o]&&n[o]in s)return n[o];return n[0]}function bt(n,l,a){var s=Co.document.createElement(n);return l&&(s.className=l||""),a&&a.appendChild(s),s}function nt(n){var l=n.parentNode;l&&l.removeChild(n)}function se(n,l){if(n.classList!==void 0)for(var a=D(l),s=0,o=a.length;s<o;s++)n.classList.add(a[s]);else if(!wr(n,l)){var h=Vr(n);jr(n,(h?h+" ":"")+l)}}function Ve(n,l){n.classList!==void 0?n.classList.remove(l):jr(n,uc((" "+Vr(n)+" ").replace(" "+l+" "," ")))}function wr(n,l){if(n.classList!==void 0)return n.classList.contains(l);var a=Vr(n);return a.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(a)}function jr(n,l){n instanceof HTMLElement?n.className=l:n.className.baseVal=l}function Vr(n){return n instanceof SVGElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Ln(n){for(;n&&n.firstChild;)n.removeChild(n.firstChild)}var Gn=Y(["transform","WebkitTransform"]);function $i(n,l){n.style[Gn]=l}function Pa(){if(typeof Event=="function")Co.dispatchEvent(new Event("resize"));else{var n=Co.document.createEvent("UIEvents");n.initUIEvent("resize",!0,!1,Co,0),Co.dispatchEvent(n)}}function ba(n){var l=["padding: "+(n.height/2-8)+"px "+n.width/2+"px;","line-height: "+n.height+"px;","background-image: url("+n.toDataURL()+");"];console.log(`%c
`,l.join(""))}function uo(){var n,l=Co.document.querySelector('meta[name="viewport"]');if(!l)return 1;var a=(n=l.content)===null||n===void 0?void 0:n.split(","),s=a.find(function(o){var h=o.split("="),v=(0,ht.Z)(h,1),m=v[0];return m==="initial-scale"});return s?s.split("=")[1]*1:1}var Ca=uo()<1?1:Co.devicePixelRatio;function Ao(n,l){n.setAttribute("style","".concat(n.style.cssText).concat(l))}function qa(n){return n.split(";").map(function(l){return l.trim()}).filter(function(l){return l})}function gs(n,l){var a,s=qa((a=n.getAttribute("style"))!==null&&a!==void 0?a:""),o=qa(l),h=ee.pull.apply(void 0,[s].concat((0,me.Z)(o)));n.setAttribute("style",h.join(";"))}function xu(n){return Object.entries(n).map(function(l){var a=(0,ht.Z)(l,2),s=a[0],o=a[1];return"".concat(s,": ").concat(o)}).join(";")}function il(n,l){return{left:n.left-l.left,top:n.top-l.top,right:l.left+l.width-n.left-n.width,bottom:l.top+l.height-n.top-n.height}}function bu(n,l){n.checked=l,l?n.setAttribute("checked","true"):n.removeAttribute("checked")}function iu(n){n.innerHTML=""}function Vc(n){n.setAttribute("draggable","false")}function $s(n,l){if(typeof l=="string"){var a=document.createElement("div");for(a.innerHTML=l;a.firstChild;)n.append(a.firstChild)}else Array.isArray(l)?n.append.apply(n,(0,me.Z)(l)):n.append(l)}function Yl(n){if(n.length===0)throw new Error("max requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]>l&&(l=n[a]);return l*1}function ye(n){if(n.length===0)throw new Error("min requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]<l&&(l=n[a]);return l*1}function ir(n){if(n.length===0)return 0;for(var l=n[0]*1,a=1;a<n.length;a++)l+=n[a]*1;return l}function Or(n){if(n.length===0)throw new Error("mean requires at least one data point");return ir(n)/n.length}function $r(n){if(n.length===0)throw new Error("mean requires at least one data point");if(n.length<3)return n[0];n.sort();for(var l=n[0],a=NaN,s=0,o=1,h=1;h<n.length+1;h++)n[h]!==l?(o>s&&(s=o,a=l),o=1,l=n[h]):o++;return a*1}var xn={min:ye,max:Yl,mean:Or,sum:ir,mode:$r};function _i(n,l){return n.map(function(a){return a[l]})}function qi(n,l){return xn[n](l)}var Ia=ot(89611);function du(n){return Function.toString.call(n).indexOf("[native code]")!==-1}var qs=ot(78814);function $a(n,l,a){return(0,qs.Z)()?$a=Reflect.construct.bind():$a=function(o,h,v){var m=[null];m.push.apply(m,h);var E=Function.bind.apply(o,m),A=new E;return v&&(0,Ia.Z)(A,v.prototype),A},$a.apply(null,arguments)}function Dl(n){var l=typeof Map=="function"?new Map:void 0;return Dl=function(s){if(s===null||!du(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l!="undefined"){if(l.has(s))return l.get(s);l.set(s,o)}function o(){return $a(s,arguments,(0,b.Z)(this).constructor)}return o.prototype=Object.create(s.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),(0,Ia.Z)(o,s)},Dl(n)}function av(n){var l=yf();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function yf(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var vd=function(n){(0,Zt.Z)(a,n);var l=av(a);function a(s,o,h,v){var m;return(0,ct.Z)(this,a),m=l.call(this,"AJAXError: ".concat(o," (").concat(s,"): ").concat(h)),m.status=s,m.statusText=o,m.url=h,m.body=v,m}return(0,et.Z)(a)}(Dl(Error));function ov(n,l){var a=new sc,s=Array.isArray(n.url)?n.url[0]:n.url;a.open(n.method||"GET",s,!0),n.type==="arrayBuffer"&&(a.responseType="arraybuffer");for(var o in n.headers)n.headers.hasOwnProperty(o)&&a.setRequestHeader(o,n.headers[o]);return n.type==="json"&&(a.responseType="text",a.setRequestHeader("Accept","application/json")),a.withCredentials=n.credentials==="include",a.onerror=function(){l(new Error(a.statusText))},a.onload=function(){if((a.status>=200&&a.status<300||a.status===0)&&a.response!==null){var h=a.response;if(n.type==="json")try{h=JSON.parse(a.response)}catch(m){return l(m)}l(null,h,a.getResponseHeader("Cache-Control"),a.getResponseHeader("Expires"),a)}else{var v=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});l(new vd(a.status,a.statusText,s.toString(),v))}},a.send(n.body),a}function sv(n){return new Promise(function(l,a){ov(n,function(s,o,h,v,m){s?a({err:s,data:null,xhr:m}):l({err:null,data:o,cacheControl:h,expires:v,xhr:m})})})}function dh(n,l){return ov(n,l)}var zf=function(l,a){return dh((0,q.Z)((0,q.Z)({},l),{},{type:"json"}),a)},Gc=function(l,a){return dh((0,q.Z)((0,q.Z)({},l),{},{type:"arrayBuffer"}),a)},vh=function(l,a){return dh(_objectSpread(_objectSpread({},l),{},{method:"POST"}),a)};function Uf(n){var l=$window.document.createElement("a");return l.href=n,l.protocol===$window.document.location.protocol&&l.host===$window.document.location.host}var lc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function al(n,l){var a=new Co.Image,s=Co.URL||Co.webkitURL;a.crossOrigin="anonymous",a.onload=function(){l(null,a),s.revokeObjectURL(a.src),a.onload=null,window.requestAnimationFrame(function(){a.src=lc})},a.onerror=function(){return l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var o=new Blob([new Uint8Array(n)],{type:"image/png"});a.src=n.byteLength?s.createObjectURL(o):lc}function _f(n,l){var a=new Blob([new Uint8Array(n)],{type:"image/png"});createImageBitmap(a).then(function(s){l(null,s)}).catch(function(s){l(new Error("Could not load image because of ".concat(s.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")))})}var vl=function(l,a,s){var o=function(v,m){if(v)a(v);else if(m){var E=typeof createImageBitmap=="function",A=s?s(m):m;E?_f(A,a):al(A,a)}};return l.type==="json"?zf(l,o):Gc(l,o)},Eu=63710088e-1,Yh={centimeters:Eu*100,centimetres:Eu*100,degrees:Eu/111325,feet:Eu*3.28084,inches:Eu*39.37,kilometers:Eu/1e3,kilometres:Eu/1e3,meters:Eu,metres:Eu,miles:Eu/1609.344,millimeters:Eu*1e3,millimetres:Eu*1e3,nauticalmiles:Eu/1852,radians:1,yards:Eu*1.0936},Pp={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Eu,yards:1.0936133},Sc={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function gl(n,l,a){a===void 0&&(a={});var s={type:"Feature"};return(a.id===0||a.id)&&(s.id=a.id),a.bbox&&(s.bbox=a.bbox),s.properties=l||{},s.geometry=n,s}function $h(n,l,a){switch(a===void 0&&(a={}),n){case"Point":return qh(l).geometry;case"LineString":return $l(l).geometry;case"Polygon":return Hc(l).geometry;case"MultiPoint":return gd(l).geometry;case"MultiLineString":return Tl(l).geometry;case"MultiPolygon":return md(l).geometry;default:throw new Error(n+" is invalid")}}function qh(n,l,a){if(a===void 0&&(a={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Yu(n[0])||!Yu(n[1]))throw new Error("coordinates must contain numbers");var s={type:"Point",coordinates:n};return gl(s,l,a)}function Op(n,l,a){return a===void 0&&(a={}),Zf(n.map(function(s){return qh(s,l)}),a)}function Hc(n,l,a){a===void 0&&(a={});for(var s=0,o=n;s<o.length;s++){var h=o[s];if(h.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var v=0;v<h[h.length-1].length;v++)if(h[h.length-1][v]!==h[0][v])throw new Error("First and last Position are not equivalent.")}var m={type:"Polygon",coordinates:n};return gl(m,l,a)}function Kh(n,l,a){return a===void 0&&(a={}),Zf(n.map(function(s){return Hc(s,l)}),a)}function $l(n,l,a){if(a===void 0&&(a={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var s={type:"LineString",coordinates:n};return gl(s,l,a)}function Qh(n,l,a){return a===void 0&&(a={}),Zf(n.map(function(s){return $l(s,l)}),a)}function Zf(n,l){l===void 0&&(l={});var a={type:"FeatureCollection"};return l.id&&(a.id=l.id),l.bbox&&(a.bbox=l.bbox),a.features=n,a}function Tl(n,l,a){a===void 0&&(a={});var s={type:"MultiLineString",coordinates:n};return gl(s,l,a)}function gd(n,l,a){a===void 0&&(a={});var s={type:"MultiPoint",coordinates:n};return gl(s,l,a)}function md(n,l,a){a===void 0&&(a={});var s={type:"MultiPolygon",coordinates:n};return gl(s,l,a)}function yd(n,l,a){a===void 0&&(a={});var s={type:"GeometryCollection",geometries:n};return gl(s,l,a)}function gh(n,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var a=Math.pow(10,l||0);return Math.round(n*a)/a}function _d(n,l){l===void 0&&(l="kilometers");var a=Yh[l];if(!a)throw new Error(l+" units is invalid");return n*a}function xf(n,l){l===void 0&&(l="kilometers");var a=Yh[l];if(!a)throw new Error(l+" units is invalid");return n/a}function xs(n,l){return Vf(xf(n,l))}function Jh(n){var l=n%360;return l<0&&(l+=360),l}function Vf(n){var l=n%(2*Math.PI);return l*180/Math.PI}function Bl(n){var l=n%360;return l*Math.PI/180}function go(n,l,a){if(l===void 0&&(l="kilometers"),a===void 0&&(a="kilometers"),!(n>=0))throw new Error("length must be a positive number");return _d(xf(n,l),a)}function is(n,l,a){if(l===void 0&&(l="meters"),a===void 0&&(a="kilometers"),!(n>=0))throw new Error("area must be a positive number");var s=Sc[l];if(!s)throw new Error("invalid original units");var o=Sc[a];if(!o)throw new Error("invalid final units");return n/s*o}function Yu(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Fp(n){return!!n&&n.constructor===Object}function bf(n){if(!n)throw new Error("bbox is required");if(!Array.isArray(n))throw new Error("bbox must be an Array");if(n.length!==4&&n.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");n.forEach(function(l){if(!Yu(l))throw new Error("bbox must only contain numbers")})}function tp(n){if(!n)throw new Error("id is required");if(["string","number"].indexOf(typeof n)===-1)throw new Error("id must be a number or a string")}function xd(n){return typeof n=="number"}function ep(n,l,a){if(n!==null)for(var s,o,h,v,m,E,A,F=0,B=0,V,j=n.type,at=j==="FeatureCollection",ut=j==="Feature",xt=at?n.features.length:1,Nt=0;Nt<xt;Nt++){A=at?n.features[Nt].geometry:ut?n.geometry:n,V=A?A.type==="GeometryCollection":!1,m=V?A.geometries.length:1;for(var de=0;de<m;de++){var fe=0,Ne=0;if(v=V?A.geometries[de]:A,v!==null){E=v.coordinates;var Ye=v.type;switch(F=a&&(Ye==="Polygon"||Ye==="MultiPolygon")?1:0,Ye){case null:break;case"Point":if(l(E,B,Nt,fe,Ne)===!1)return!1;B++,fe++;break;case"LineString":case"MultiPoint":for(s=0;s<E.length;s++){if(l(E[s],B,Nt,fe,Ne)===!1)return!1;B++,Ye==="MultiPoint"&&fe++}Ye==="LineString"&&fe++;break;case"Polygon":case"MultiLineString":for(s=0;s<E.length;s++){for(o=0;o<E[s].length-F;o++){if(l(E[s][o],B,Nt,fe,Ne)===!1)return!1;B++}Ye==="MultiLineString"&&fe++,Ye==="Polygon"&&Ne++}Ye==="Polygon"&&fe++;break;case"MultiPolygon":for(s=0;s<E.length;s++){for(Ne=0,o=0;o<E[s].length;o++){for(h=0;h<E[s][o].length-F;h++){if(l(E[s][o][h],B,Nt,fe,Ne)===!1)return!1;B++}Ne++}fe++}break;case"GeometryCollection":for(s=0;s<v.geometries.length;s++)if(ep(v.geometries[s],l,a)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Rp(n,l,a,s){var o=a;return ep(n,function(h,v,m,E,A){v===0&&a===void 0?o=h:o=l(o,h,v,m,E,A)},s),o}function rp(n,l){var a;switch(n.type){case"FeatureCollection":for(a=0;a<n.features.length&&l(n.features[a].properties,a)!==!1;a++);break;case"Feature":l(n.properties,0);break}}function Ef(n,l,a){var s=a;return rp(n,function(o,h){h===0&&a===void 0?s=o:s=l(s,o,h)}),s}function au(n,l){if(n.type==="Feature")l(n,0);else if(n.type==="FeatureCollection")for(var a=0;a<n.features.length&&l(n.features[a],a)!==!1;a++);}function wf(n,l,a){var s=a;return au(n,function(o,h){h===0&&a===void 0?s=o:s=l(s,o,h)}),s}function np(n){var l=[];return ep(n,function(a){l.push(a)}),l}function As(n,l){var a,s,o,h,v,m,E,A,F,B,V=0,j=n.type==="FeatureCollection",at=n.type==="Feature",ut=j?n.features.length:1;for(a=0;a<ut;a++){for(m=j?n.features[a].geometry:at?n.geometry:n,A=j?n.features[a].properties:at?n.properties:{},F=j?n.features[a].bbox:at?n.bbox:void 0,B=j?n.features[a].id:at?n.id:void 0,E=m?m.type==="GeometryCollection":!1,v=E?m.geometries.length:1,o=0;o<v;o++){if(h=E?m.geometries[o]:m,h===null){if(l(null,V,A,F,B)===!1)return!1;continue}switch(h.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(h,V,A,F,B)===!1)return!1;break}case"GeometryCollection":{for(s=0;s<h.geometries.length;s++)if(l(h.geometries[s],V,A,F,B)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}V++}}function Zi(n,l,a){var s=a;return As(n,function(o,h,v,m,E){h===0&&a===void 0?s=o:s=l(s,o,h,v,m,E)}),s}function as(n,l){As(n,function(a,s,o,h,v){var m=a===null?null:a.type;switch(m){case null:case"Point":case"LineString":case"Polygon":return l(gl(a,o,{bbox:h,id:v}),s,0)===!1?!1:void 0}var E;switch(m){case"MultiPoint":E="Point";break;case"MultiLineString":E="LineString";break;case"MultiPolygon":E="Polygon";break}for(var A=0;A<a.coordinates.length;A++){var F=a.coordinates[A],B={type:E,coordinates:F};if(l(gl(B,o),s,A)===!1)return!1}})}function Sf(n,l,a){var s=a;return as(n,function(o,h,v){h===0&&v===0&&a===void 0?s=o:s=l(s,o,h,v)}),s}function Gf(n,l){as(n,function(a,s,o){var h=0;if(!!a.geometry){var v=a.geometry.type;if(!(v==="Point"||v==="MultiPoint")){var m,E=0,A=0,F=0;if(ep(a,function(B,V,j,at,ut){if(m===void 0||s>E||at>A||ut>F){m=B,E=s,A=at,F=ut,h=0;return}var xt=lineString([m,B],a.properties);if(l(xt,s,o,ut,h)===!1)return!1;h++,m=B})===!1)return!1}}})}function cc(n,l,a){var s=a,o=!1;return Gf(n,function(h,v,m,E,A){o===!1&&a===void 0?s=h:s=l(s,h,v,m,E,A),o=!0}),s}function ml(n,l){if(!n)throw new Error("geojson is required");as(n,function(a,s,o){if(a.geometry!==null){var h=a.geometry.type,v=a.geometry.coordinates;switch(h){case"LineString":if(l(a,s,o,0,0)===!1)return!1;break;case"Polygon":for(var m=0;m<v.length;m++)if(l(lineString(v[m],a.properties),s,o,m)===!1)return!1;break}}})}function Dp(n,l,a){var s=a;return ml(n,function(o,h,v,m){h===0&&a===void 0?s=o:s=l(s,o,h,v,m)}),s}function Ai(n,l){if(l=l||{},!isObject(l))throw new Error("options is invalid");var a=l.featureIndex||0,s=l.multiFeatureIndex||0,o=l.geometryIndex||0,h=l.segmentIndex||0,v=l.properties,m;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),v=v||n.features[a].properties,m=n.features[a].geometry;break;case"Feature":v=v||n.properties,m=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=n;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var E=m.coordinates;switch(m.type){case"Point":case"MultiPoint":return null;case"LineString":return h<0&&(h=E.length+h-1),lineString([E[h],E[h+1]],v,l);case"Polygon":return o<0&&(o=E.length+o),h<0&&(h=E[o].length+h-1),lineString([E[o][h],E[o][h+1]],v,l);case"MultiLineString":return s<0&&(s=E.length+s),h<0&&(h=E[s].length+h-1),lineString([E[s][h],E[s][h+1]],v,l);case"MultiPolygon":return s<0&&(s=E.length+s),o<0&&(o=E[s].length+o),h<0&&(h=E[s][o].length-h-1),lineString([E[s][o][h],E[s][o][h+1]],v,l)}throw new Error("geojson is invalid")}function Hf(n,l){if(l=l||{},!isObject(l))throw new Error("options is invalid");var a=l.featureIndex||0,s=l.multiFeatureIndex||0,o=l.geometryIndex||0,h=l.coordIndex||0,v=l.properties,m;switch(n.type){case"FeatureCollection":a<0&&(a=n.features.length+a),v=v||n.features[a].properties,m=n.features[a].geometry;break;case"Feature":v=v||n.properties,m=n.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":m=n;break;default:throw new Error("geojson is invalid")}if(m===null)return null;var E=m.coordinates;switch(m.type){case"Point":return point(E,v,l);case"MultiPoint":return s<0&&(s=E.length+s),point(E[s],v,l);case"LineString":return h<0&&(h=E.length+h),point(E[h],v,l);case"Polygon":return o<0&&(o=E.length+o),h<0&&(h=E[o].length+h),point(E[o][h],v,l);case"MultiLineString":return s<0&&(s=E.length+s),h<0&&(h=E[s].length+h),point(E[s][h],v,l);case"MultiPolygon":return s<0&&(s=E.length+s),o<0&&(o=E[s].length+o),h<0&&(h=E[s][o].length-h),point(E[s][o][h],v,l)}throw new Error("geojson is invalid")}function Cc(n){var l=[1/0,1/0,-1/0,-1/0];return ep(n,function(a){l[0]>a[0]&&(l[0]=a[0]),l[1]>a[1]&&(l[1]=a[1]),l[2]<a[0]&&(l[2]=a[0]),l[3]<a[1]&&(l[3]=a[1])}),l}Cc.default=Cc;var Cf=Cc,ma=2*Math.PI*6378137/2;function yl(n,l){var a=(0,ht.Z)(l,4),s=a[0],o=a[1],h=a[2],v=a[3];return n.lng>s&&n.lng<=h&&n.lat>o&&n.lat<=v}function jf(n){var l=[1/0,1/0,-1/0,-1/0];return n.forEach(function(a){var s=a.coordinates;fc(l,s)}),l}function fc(n,l){return Array.isArray(l[0])?l.forEach(function(a){fc(n,a)}):(n[0]>l[0]&&(n[0]=l[0]),n[1]>l[1]&&(n[1]=l[1]),n[2]<l[0]&&(n[2]=l[0]),n[3]<l[1]&&(n[3]=l[1])),n}function _l(n,l){return sa(n,l)}function sa(n,l){return Array.isArray(n[0])?n.map(function(a){return sa(a,l)}):l(n)}function Bp(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{enable:!0,decimal:1};n=Ml(n,l);var s=n[0],o=n[1],h=s*ma/180,v=Math.log(Math.tan((90+o)*Math.PI/360))/(Math.PI/180);return v=v*ma/180,a.enable&&(h=Number(h.toFixed(a.decimal)),v=Number(v.toFixed(a.decimal))),n.length===3?[h,v,n[2]]:[h,v]}function Np(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=n[0],s=n[1],o=a/ma*180,h=s/ma*180;return h=180/Math.PI*(2*Math.atan(Math.exp(h*Math.PI/180))-Math.PI/2),l!=null&&(o=Number(o.toFixed(l)),h=Number(h.toFixed(l))),n.length===3?[o,h,n[2]]:[o,h]}function bd(n){if(n==null)throw new Error("lng is required");return(n>180||n<-180)&&(n=n%360,n>180&&(n=-360+n),n<-180&&(n=360+n),n===0&&(n=0)),n}function Ed(n){if(n==null)throw new Error("lat is required");return(n>90||n<-90)&&(n=n%180,n>90&&(n=-180+n),n<-90&&(n=180+n),n===0&&(n=0)),n}function Ml(n,l){if(l===!1)return n;var a=bd(n[0]),s=Ed(n[1]);return s>85&&(s=85),s<-85&&(s=-85),n.length===3?[a,s,n[2]]:[a,s]}function Ko(n){var l=85.0511287798,a=Math.max(Math.min(l,n[1]),-l),s=256<<20,o=Math.PI/180,h=n[0]*o,v=a*o;v=Math.log(Math.tan(Math.PI/4+v/2));var m=.5/Math.PI,E=.5,A=-.5/Math.PI;return o=.5,h=s*(m*h+E),v=s*(A*v+o),[Math.floor(h),Math.floor(v)]}function Ka(n){var l=.5/Math.PI,a=.5,s=-.5/Math.PI,o=.5,h=256<<20,v=_slicedToArray(n,2),m=v[0],E=v[1];m=(m/h-a)/l,E=(E/h-o)/s,E=(Math.atan(Math.pow(Math.E,E))-Math.PI/4)*2,o=Math.PI/180;var A=E/o,F=m/o;return[F,A]}function xl(n,l){var a=85.0511287798,s=Math.PI/180,o=6378137;return l=Math.max(Math.min(a,l),-a),n*=s,l*=s,l=Math.log(Math.tan(Math.PI/4+l/2)),[n*o,l*o]}function ql(n,l){var a=Math.PI/180,s=6378137,o=n/s/a,h=2*(Math.atan(Math.exp(l/s))-Math.PI/4)/a;return[o,h]}function Ts(n,l,a){var s=Bl(l[1]-n[1]),o=Bl(l[0]-n[0]),h=Bl(n[1]),v=Bl(l[1]),m=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(h)*Math.cos(v);return _d(2*Math.atan2(Math.sqrt(m),Math.sqrt(1-m)),a="meters")}function jc(n){var l=Math.PI/180,a=85.0511287798,s=6378137,o=Math.max(Math.min(a,n[1]),-a),h=Math.sin(o*l),v=s*n[0]*l,m=s*Math.log((1+h)/(1-h))/2;return[v,m]}function Nl(n,l){var a=Math.abs(n[1][1]-n[0][1])*l,s=Math.abs(n[1][0]-n[0][0])*l;return[[n[0][0]-s,n[0][1]-a],[n[1][0]+s,n[1][1]+a]]}function wu(n,l){return n[0][0]<=l[0][0]&&n[0][1]<=l[0][1]&&n[1][0]>=l[1][0]&&n[1][1]>=l[1][1]}function Su(n){return[[n[0],n[1]],[n[2],n[3]]]}function Il(n){var l=Ki(n,[0,0]);return[n[0]/l,n[1]/l]}function Ki(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function Wi(n,l){return n[0]*l[0]+n[1]*l[1]}function Af(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function ol(n,l){return Math.acos(Wi(n,l)/(Af(n)*Af(l)))*180/Math.PI}function sl(n,l){return l[0]>0?l[1]>0?90-Math.atan(l[1]/l[0])*180/Math.PI:90+Math.atan(-l[1]/l[0])*180/Math.PI:l[1]<0?180+(90-Math.atan(l[1]/l[0])*180/Math.PI):270+Math.atan(l[1]/-l[0])*180/Math.PI}function Ru(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;if(!(!n||n.length<2)){for(var a=[0,1],s=0,o=[],h=0;h<n.length-1;h++){var v=n[h],m=n[h+1],E=Ki(v,m);s+=E;var A=[v[0]-m[0],v[1]-m[1]],F=sl(a,A);if(h>0){var B=o[h-1].rotation;B-F>360-B+F&&(F=F+360)}o.push({start:v,end:m,dis:E,rotation:F,duration:0})}return o.map(function(V){V.duration=l*(V.dis/s)}),o}}function bs(n){if(xd(n[0]))return n;if(xd(n[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(xd(n[0][0][0])){var l=n,a=0,s=0,o=0;return l.forEach(function(h){h.forEach(function(v){a+=v[0],s+=v[1],o++})}),[a/o,s/o,0]}else throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}function Ac(n){for(var l=n[0],a=n[1],s=n[0],o=n[1],h=0,v=0,m=0,E=0;E<n.length;E+=2){var A=n[E],F=n[E+1];A&&F&&(l=Math.max(A,l),a=Math.max(F,a),s=Math.min(A,s),o=Math.min(F,o),h+=A,v+=F,m++)}return{center:[h/m,v/m],radius:Math.sqrt(Math.pow(l-s,2)+Math.pow(a-o,2))/2}}function Tc(n){return Cf(Zf([$l(n)]))}var No=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:50,a=arguments.length>1?arguments[1]:void 0;(0,ct.Z)(this,n),this.limit=l,this.destroy=a||this.defaultDestroy,this.order=[],this.clear()}return(0,et.Z)(n,[{key:"clear",value:function(){var a=this;this.order.forEach(function(s){a.delete(s)}),this.cache={},this.order=[]}},{key:"get",value:function(a){var s=this.cache[a];return s&&(this.deleteOrder(a),this.appendOrder(a)),s}},{key:"set",value:function(a,s){this.cache[a]?(this.delete(a),this.cache[a]=s,this.appendOrder(a)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[a]=s,this.appendOrder(a))}},{key:"delete",value:function(a){var s=this.cache[a];s&&(this.deleteCache(a),this.deleteOrder(a),this.destroy(s,a))}},{key:"deleteCache",value:function(a){delete this.cache[a]}},{key:"deleteOrder",value:function(a){var s=this.order.findIndex(function(o){return o===a});s>=0&&this.order.splice(s,1)}},{key:"appendOrder",value:function(a){this.order.push(a)}},{key:"defaultDestroy",value:function(a,s){return null}}]),n}();function os(n,l){n.forEach(function(a){!l[a]||(l[a]=l[a].bind(l))})}var ip=null;function Wc(n,l,a){n.prototype=l.prototype=a,a.constructor=n}function hc(n,l){var a=Object.create(n.prototype);for(var s in l)a[s]=l[s];return a}function ul(){}var Fs=.7,Ms=1/Fs,$u="\\s*([+-]?\\d+)\\s*",Xc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ll="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Wf=/^#([0-9a-f]{3,8})$/,Mc=new RegExp("^rgb\\("+[$u,$u,$u]+"\\)$"),mh=new RegExp("^rgb\\("+[ll,ll,ll]+"\\)$"),Xf=new RegExp("^rgba\\("+[$u,$u,$u,Xc]+"\\)$"),wd=new RegExp("^rgba\\("+[ll,ll,ll,Xc]+"\\)$"),Rs=new RegExp("^hsl\\("+[Xc,ll,ll]+"\\)$"),Ic=new RegExp("^hsla\\("+[Xc,ll,ll,Xc]+"\\)$"),ap={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Wc(ul,pc,{copy:function(n){return Object.assign(new this.constructor,this,n)},displayable:function(){return this.rgb().displayable()},hex:bl,formatHex:bl,formatHsl:zl,formatRgb:op,toString:op});function bl(){return this.rgb().formatHex()}function zl(){return ft(this).formatHsl()}function op(){return this.rgb().formatRgb()}function pc(n){var l,a;return n=(n+"").trim().toLowerCase(),(l=Wf.exec(n))?(a=l[1].length,l=parseInt(l[1],16),a===6?zp(l):a===3?new w(l>>8&15|l>>4&240,l>>4&15|l&240,(l&15)<<4|l&15,1):a===8?Yc(l>>24&255,l>>16&255,l>>8&255,(l&255)/255):a===4?Yc(l>>12&15|l>>8&240,l>>8&15|l>>4&240,l>>4&15|l&240,((l&15)<<4|l&15)/255):null):(l=Mc.exec(n))?new w(l[1],l[2],l[3],1):(l=mh.exec(n))?new w(l[1]*255/100,l[2]*255/100,l[3]*255/100,1):(l=Xf.exec(n))?Yc(l[1],l[2],l[3],l[4]):(l=wd.exec(n))?Yc(l[1]*255/100,l[2]*255/100,l[3]*255/100,l[4]):(l=Rs.exec(n))?$(l[1],l[2]/100,l[3]/100,1):(l=Ic.exec(n))?$(l[1],l[2]/100,l[3]/100,l[4]):ap.hasOwnProperty(n)?zp(ap[n]):n==="transparent"?new w(NaN,NaN,NaN,0):null}function zp(n){return new w(n>>16&255,n>>8&255,n&255,1)}function Yc(n,l,a,s){return s<=0&&(n=l=a=NaN),new w(n,l,a,s)}function x(n){return n instanceof ul||(n=pc(n)),n?(n=n.rgb(),new w(n.r,n.g,n.b,n.opacity)):new w}function C(n,l,a,s){return arguments.length===1?x(n):new w(n,l,a,s==null?1:s)}function w(n,l,a,s){this.r=+n,this.g=+l,this.b=+a,this.opacity=+s}Wc(w,C,hc(ul,{brighter:function(n){return n=n==null?Ms:Math.pow(Ms,n),new w(this.r*n,this.g*n,this.b*n,this.opacity)},darker:function(n){return n=n==null?Fs:Math.pow(Fs,n),new w(this.r*n,this.g*n,this.b*n,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M,formatHex:M,formatRgb:z,toString:z}));function M(){return"#"+H(this.r)+H(this.g)+H(this.b)}function z(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(n===1?")":", "+n+")")}function H(n){return n=Math.max(0,Math.min(255,Math.round(n)||0)),(n<16?"0":"")+n.toString(16)}function $(n,l,a,s){return s<=0?n=l=a=NaN:a<=0||a>=1?n=l=NaN:l<=0&&(n=NaN),new re(n,l,a,s)}function ft(n){if(n instanceof re)return new re(n.h,n.s,n.l,n.opacity);if(n instanceof ul||(n=pc(n)),!n)return new re;if(n instanceof re)return n;n=n.rgb();var l=n.r/255,a=n.g/255,s=n.b/255,o=Math.min(l,a,s),h=Math.max(l,a,s),v=NaN,m=h-o,E=(h+o)/2;return m?(l===h?v=(a-s)/m+(a<s)*6:a===h?v=(s-l)/m+2:v=(l-a)/m+4,m/=E<.5?h+o:2-h-o,v*=60):m=E>0&&E<1?0:v,new re(v,m,E,n.opacity)}function Ut(n,l,a,s){return arguments.length===1?ft(n):new re(n,l,a,s==null?1:s)}function re(n,l,a,s){this.h=+n,this.s=+l,this.l=+a,this.opacity=+s}Wc(re,Ut,hc(ul,{brighter:function(n){return n=n==null?Ms:Math.pow(Ms,n),new re(this.h,this.s,this.l*n,this.opacity)},darker:function(n){return n=n==null?Fs:Math.pow(Fs,n),new re(this.h,this.s,this.l*n,this.opacity)},rgb:function(){var n=this.h%360+(this.h<0)*360,l=isNaN(n)||isNaN(this.s)?0:this.s,a=this.l,s=a+(a<.5?a:1-a)*l,o=2*a-s;return new w(De(n>=240?n-240:n+120,o,s),De(n,o,s),De(n<120?n+240:n-120,o,s),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var n=this.opacity;return n=isNaN(n)?1:Math.max(0,Math.min(1,n)),(n===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(n===1?")":", "+n+")")}}));function De(n,l,a){return(n<60?l+(a-l)*n/60:n<180?a:n<240?l+(a-l)*(240-n)/60:l)*255}function Be(n){return typeof n=="string"?!!d3.color(n):!1}function Le(n){var l=pc(n),a=[0,0,0,0];return l!=null&&(a[0]=l.r/255,a[1]=l.g/255,a[2]=l.b/255,a[3]=l.opacity),a}function cr(n){var l=n&&n[0],a=n&&n[1],s=n&&n[2],o=l+a*256+s*65536-1;return o}function ar(n){return[n+1&255,n+1>>8&255,n+1>>8>>8&255]}function br(n){var l=Co.document.createElement("canvas"),a=l.getContext("2d");l.width=256,l.height=1;var s=null;if(n.weights){var o=0;n.weights.map(function(V,j){var at=n.colors[j]||"rgba(0, 0, 0, 0)",ut=o+V;a.fillStyle=at,a.fillRect(o*256,0,ut*256,1),o=ut})}else{for(var h=a.createLinearGradient(0,0,256,1),v=n.positions[0],m=n.positions[n.positions.length-1],E=0;E<n.colors.length;++E){var A=(n.positions[E]-v)/(m-v);h.addColorStop(A,n.colors[E])}a.fillStyle=h,a.fillRect(0,0,256,1)}if(_u)return s=new Uint8ClampedArray(a.getImageData(0,0,256,1).data),l=null,a=null,{data:s,width:256,height:1};s=a.getImageData(0,0,256,1).data;for(var F=a.createImageData(256,1),B=0;B<F.data.length;B+=4)F.data[B+0]=s[B+0],F.data[B+1]=s[B+1],F.data[B+2]=s[B+2],F.data[B+3]=s[B+3];return l=null,a=null,F}var rr;(function(n){n.CENTER="center",n.TOP="top",n["TOP-LEFT"]="top-left",n["TOP-RIGHT"]="top-right",n.BOTTOM="bottom",n["BOTTOM-LEFT"]="bottom-left",n["BOTTOM-RIGHT"]="bottom-right",n.LEFT="left",n.RIGHT="right"})(rr||(rr={}));var xr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Pr(n,l,a){var s=n.classList;for(var o in xr)xr.hasOwnProperty(o)&&s.remove("l7-".concat(a,"-anchor-").concat(o));s.add("l7-".concat(a,"-anchor-").concat(l))}function Rr(n,l){return{enable:n,mask:255,func:{cmp:514,ref:l?1:0,mask:255}}}function gn(n,l){if(!n)throw new Error(l||"web worker helper assertion failed.")}var ln={self:typeof self!="undefined"&&self,window:typeof window!="undefined"&&window,document:typeof document!="undefined"&&document},bn=ln.self||ln.window||{},Zn=ln.window||ln.self||{},Kn=ln.self||ln.window||{},ci=ln.document||{},Oi=typeof importScripts=="function",na=typeof window!="undefined"&&typeof window.orientation!="undefined",ia=function(){function n(l,a){var s=this;this.name=l,this.workerThread=a,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise(function(o,h){s.resolve=o,s.reject=h})}return n.prototype.postMessage=function(l,a){this.workerThread.postMessage({source:"Main thread",type:l,payload:a})},n.prototype.done=function(l){gn(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(l)},n.prototype.error=function(l){gn(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(l)},n}(),ua=ia,Qa=new Map;function Fi(n){gn(n.source&&!n.url||!n.source&&n.url);var l=Qa.get(n.source||n.url);return l||(n.url&&(l=Ra(n.url),Qa.set(n.url,l)),n.source&&(l=Aa(n.source),Qa.set(n.source,l))),gn(l),l}function Ra(n){if(!n.startsWith("http"))return n;var l=ka(n);return Aa(l)}function Aa(n){var l=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(l)}function ka(n){return`try {
  importScripts('`+n+`');
} catch (error) {
  console.error(error);
  throw error;
}`}function la(n,l,a){l===void 0&&(l=!0);var s=a||new Set;if(n){if(Na(n))s.add(n);else if(Na(n.buffer))s.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(l&&typeof n=="object")for(var o in n)la(n[o],l,s)}}return a===void 0?Array.from(s):[]}function Na(n){return n?n instanceof ArrayBuffer||typeof MessagePort!="undefined"&&n instanceof MessagePort||typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap||typeof OffscreenCanvas!="undefined"&&n instanceof OffscreenCanvas:!1}var pa=function(){},da=function(){function n(l){this.terminated=!1,this.loadableURL="";var a=l.name,s=l.source,o=l.url;gn(s||o),this.name=a,this.source=s,this.url=o,this.onMessage=pa,this.onError=function(h){return console.log(h)},this.worker=this.createBrowserWorker()}return n.isSupported=function(){return typeof Worker!="undefined"},n.prototype.destroy=function(){this.onMessage=pa,this.onError=pa,this.worker.terminate(),this.terminated=!0},Object.defineProperty(n.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),n.prototype.postMessage=function(l,a){a=a||la(l),this.worker.postMessage(l,a)},n.prototype.getErrorFromErrorEvent=function(l){var a="Failed to load ";return a+="worker "+this.name+" from "+this.url+". ",l.message&&(a+=l.message+" in "),l.lineno&&(a+=":"+l.lineno+":"+l.colno),new Error(a)},n.prototype.createBrowserWorker=function(){var l=this;this.loadableURL=Fi({source:this.source,url:this.url});var a=new Worker(this.loadableURL,{name:this.name});return a.onmessage=function(s){s.data?l.onMessage(s.data):l.onError(new Error("No data received"))},a.onerror=function(s){l.onError(l.getErrorFromErrorEvent(s)),l.terminated=!0},a.onmessageerror=function(s){return console.error("worker "+l.name+", message error: "+s)},a},n}(),Ds=da,ss=function(){return ss=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},ss.apply(this,arguments)},ou=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},Ks=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},ls=function(){function n(l){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=l.source,this.url=l.url,this.setProps(l)}return n.prototype.destroy=function(){this.idleQueue.forEach(function(l){return l.destroy()}),this.isDestroyed=!0},n.prototype.setProps=function(l){this.props=ss(ss({},this.props),l),l.name!==void 0&&(this.name=l.name),l.maxConcurrency!==void 0&&(this.maxConcurrency=l.maxConcurrency),l.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=l.maxMobileConcurrency),l.reuseWorkers!==void 0&&(this.reuseWorkers=l.reuseWorkers),l.onDebug!==void 0&&(this.onDebug=l.onDebug)},n.prototype.startJob=function(l,a,s){return a===void 0&&(a=function(o,h,v){return o.done(v)}),s===void 0&&(s=function(o,h){return o.error(h)}),ou(this,void 0,void 0,function(){var o,h=this;return Ks(this,function(v){switch(v.label){case 0:return o=new Promise(function(m){return h.jobQueue.push({name:l,onMessage:a,onError:s,onStart:m}),h}),this.startQueuedJob(),[4,o];case 1:return[2,v.sent()]}})})},n.prototype.startQueuedJob=function(){return ou(this,void 0,void 0,function(){var l,a,s;return Ks(this,function(o){switch(o.label){case 0:if(!this.jobQueue.length)return[2];if(l=this.getAvailableWorker(),!l)return[2];if(a=this.jobQueue.shift(),!a)return[3,4];this.onDebug({message:"Starting job",name:a.name,backlog:this.jobQueue.length,workerThread:l}),s=new ua(a.name,l),l.onMessage=function(h){return a.onMessage(s,h.type,h.payload)},l.onError=function(h){return a.onError(s,h)},a.onStart(s),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,s.result];case 2:return o.sent(),[3,4];case 3:return this.returnWorkerToQueue(l),[7];case 4:return[2]}})})},n.prototype.returnWorkerToQueue=function(l){var a=this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency();a?(l.destroy(),this.count--):this.idleQueue.push(l),this.isDestroyed||this.startQueuedJob()},n.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var l=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new Ds({name:l,source:this.source,url:this.url})}return null},n.prototype.getMaxConcurrency=function(){return na?this.maxMobileConcurrency:this.maxConcurrency},n}(),cs=ls,vu=function(){return vu=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},vu.apply(this,arguments)},Du=function(n){var l=typeof Symbol=="function"&&Symbol.iterator,a=l&&n[l],s=0;if(a)return a.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(l?"Object is not iterable.":"Symbol.iterator is not defined.")},kc={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},qu=function(){function n(l){this.workerPools=new Map,this.props=vu({},kc),this.setProps(l),this.workerPools=new Map}return n.isSupported=function(){return Ds.isSupported()},n.getWorkerFarm=function(l){return l===void 0&&(l={}),n.workerFarm=n.workerFarm||new n({}),n.workerFarm.setProps(l),n.workerFarm},n.prototype.destroy=function(){var l,a;try{for(var s=Du(this.workerPools.values()),o=s.next();!o.done;o=s.next()){var h=o.value;h.destroy()}}catch(v){l={error:v}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(l)throw l.error}}},n.prototype.setProps=function(l){var a,s;this.props=vu(vu({},this.props),l);try{for(var o=Du(this.workerPools.values()),h=o.next();!h.done;h=o.next()){var v=h.value;v.setProps(this.getWorkerPoolProps())}}catch(m){a={error:m}}finally{try{h&&!h.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}},n.prototype.getWorkerPool=function(l){var a=l.name,s=l.source,o=l.url,h=this.workerPools.get(a);return h||(h=new cs({name:a,source:s,url:o}),h.setProps(this.getWorkerPoolProps()),this.workerPools.set(a,h)),h},n.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}},n}(),Kl=qu,cl=new Map,yh=function(){function n(){}return Object.defineProperty(n,"onmessage",{set:function(l){self.onmessage=function(a){if(!!Ql(a)){var s=a.data,o=s.type,h=s.payload;l(o,h)}}},enumerable:!1,configurable:!0}),n.addEventListener=function(l){var a=cl.get(l);a||(a=function(s){if(!!Ql(s)){var o=s.data,h=o.type,v=o.payload;l(h,v)}}),self.addEventListener("message",a)},n.removeEventListener=function(l){var a=cl.get(l);cl.delete(l),self.removeEventListener("message",a)},n.postMessage=function(l,a){if(self){var s={source:"Worker thread",type:l,payload:a},o=la(a);self.postMessage(s,o)}},n}(),El=yh;function Ql(n){var l=n.type,a=n.data;return l==="message"&&a&&typeof a.source=="string"&&a.source==="Main thread"}function _h(n){return JSON.parse(Yf(n))}function Yf(n){var l=new Set;return JSON.stringify(n,function(a,s){if(typeof s=="object"&&s!==null){if(l.has(s))try{return JSON.parse(JSON.stringify(s))}catch(o){return}l.add(s)}return s})}function dc(n){return""+n.name}function xh(n,l){l===void 0&&(l={});var a=l[n.id]||{},s=n.name+".worker.js",o=a.workerUrl;return l._workerType==="test"&&(o=n.module+"/dist/"+s),o||(o="https://unpkg.com/"+n.module+"/dist/"+s),assert(o),o}var Jl=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},js=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}};function $c(n,l){return WorkerFarm.isSupported()?n.worker&&(l==null?void 0:l.worker):!1}function Tf(n,l,a,s){return a===void 0&&(a={}),s===void 0&&(s={}),Jl(this,void 0,void 0,function(){var o,h,v,m,E,A,F,B;return js(this,function(V){switch(V.label){case 0:return o=getWorkerName(n),h=getWorkerURL(n,a),v=WorkerFarm.getWorkerFarm(a),m=v.getWorkerPool({name:o,url:h}),E=a.jobName||n.name,[4,m.startJob(E,vc.bind(null,s))];case 1:return A=V.sent(),F=removeNontransferableOptions(a),A.postMessage("process",{input:l,options:F}),[4,A.result];case 2:return B=V.sent(),[2,B.result]}})})}function vc(n,l,a,s){return Jl(this,void 0,void 0,function(){var o,h,v,m,E,A,F;return js(this,function(B){switch(B.label){case 0:switch(o=a,o){case"done":return[3,1];case"error":return[3,2];case"process":return[3,3]}return[3,8];case 1:return l.done(s),[3,9];case 2:return l.error(new Error(s.error)),[3,9];case 3:h=s.id,v=s.input,m=s.options,B.label=4;case 4:return B.trys.push([4,6,,7]),n.process?[4,n.process(v,m)]:(l.postMessage("error",{id:h,error:"Worker not set up to process on main thread"}),[2]);case 5:return E=B.sent(),l.postMessage("done",{id:h,result:E}),[3,7];case 6:return A=B.sent(),F=A instanceof Error?A.message:"unknown error",l.postMessage("error",{id:h,error:F}),[3,7];case 7:return[3,9];case 8:console.warn("process-on-worker: unknown message "+a),B.label=9;case 9:return[2]}})})}var Lo=function(){function n(){this._values=[],this._settlers=[],this._closed=!1}return n.prototype[Symbol.asyncIterator]=function(){return this},n.prototype.push=function(l){return this.enqueue(l)},n.prototype.enqueue=function(l){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var a=this._settlers.shift();l instanceof Error?a.reject(l):a.resolve({value:l})}else this._values.push(l)},n.prototype.close=function(){for(;this._settlers.length>0;){var l=this._settlers.shift();l.resolve({done:!0})}this._closed=!0},n.prototype.next=function(){var l=this;if(this._values.length>0){var a=this._values.shift();return a instanceof Error?Promise.reject(a):Promise.resolve({done:!1,value:a})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise(function(s,o){l._settlers.push({resolve:s,reject:o})})},n}(),wl=Lo,Ku=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},qc=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},Kc=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l=n[Symbol.asyncIterator],a;return l?l.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),a={},s("next"),s("throw"),s("return"),a[Symbol.asyncIterator]=function(){return this},a);function s(h){a[h]=n[h]&&function(v){return new Promise(function(m,E){v=n[h](v),o(m,E,v.done,v.value)})}}function o(h,v,m,E){Promise.resolve(E).then(function(A){h({value:A,done:m})},v)}},$f=0,Qc,Bu;function bh(n,l){var a=this;if(typeof self!="undefined"){var s={process:tc};El.onmessage=function(o,h){return Ku(a,void 0,void 0,function(){var v,m,E,A,F,B,V,j,at,ut,xt;return qc(this,function(Nt){switch(Nt.label){case 0:switch(Nt.trys.push([0,19,,20]),v=o,v){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!n)throw new Error("Worker does not support atomic processing");return[4,n(h.input,h.options||{},s)];case 2:return m=Nt.sent(),El.postMessage("done",{result:m}),[3,18];case 3:if(!l)throw new Error("Worker does not support batched processing");Qc=new wl,Bu=h.options||{},E=l(Qc,Bu,s),Nt.label=4;case 4:Nt.trys.push([4,9,10,15]),A=Kc(E),Nt.label=5;case 5:return[4,A.next()];case 6:if(F=Nt.sent(),!!F.done)return[3,8];B=F.value,El.postMessage("output-batch",{result:B}),Nt.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return V=Nt.sent(),ut={error:V},[3,15];case 10:return Nt.trys.push([10,,13,14]),F&&!F.done&&(xt=A.return)?[4,xt.call(A)]:[3,12];case 11:Nt.sent(),Nt.label=12;case 12:return[3,14];case 13:if(ut)throw ut.error;return[7];case 14:return[7];case 15:return El.postMessage("done",{}),[3,18];case 16:return Qc.push(h.input),[3,18];case 17:return Qc.close(),[3,18];case 18:return[3,20];case 19:return j=Nt.sent(),at=j instanceof Error?j.message:"",El.postMessage("error",{error:at}),[3,20];case 20:return[2]}})})}}}function tc(n,l){return l===void 0&&(l={}),new Promise(function(a,s){var o=$f++,h=function(m,E){if(E.id===o)switch(m){case"done":El.removeEventListener(h),a(E.result);break;case"error":El.removeEventListener(h),s(E.error);break;default:}};El.addEventListener(h);var v={id:o,input:n,options:l};El.postMessage("process",v)})}var Jc=function(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})},Eh=function(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}},kl={};function Cu(n,l,a){return l===void 0&&(l=null),a===void 0&&(a={}),Jc(this,void 0,void 0,function(){return Eh(this,function(s){switch(s.label){case 0:return l&&(n=sp(n,l,a)),kl[n]=kl[n]||Sd(n),[4,kl[n]];case 1:return[2,s.sent()]}})})}function sp(n,l,a){if(n.startsWith("http"))return n;var s=a.modules||{};return s[n]?s[n]:a.CDN?(assert(a.CDN.startsWith("http")),a.CDN+"/"+l+"/dist/libs/"+n):isWorker?"../src/libs/"+n:"modules/"+l+"/src/libs/"+n}function Sd(n){return Jc(this,void 0,void 0,function(){var l,a,s;return Eh(this,function(o){switch(o.label){case 0:return n.endsWith("wasm")?[4,fetch(n)]:[3,3];case 1:return l=o.sent(),[4,l.arrayBuffer()];case 2:return[2,o.sent()];case 3:return isWorker?[2,importScripts(n)]:[4,fetch(n)];case 4:return a=o.sent(),[4,a.text()];case 5:return s=o.sent(),[2,uv(s,n)]}})})}function uv(n,l){if(isWorker)return eval.call(global,n),null;var a=document.createElement("script");a.id=l;try{a.appendChild(document.createTextNode(n))}catch(s){a.text=n}return document.body.appendChild(a),null}var lv="0.0.3",G0={id:"null",name:"null",module:"web-worker-helper",options:{}};function Up(n){var l=n.color;return!l||!l.length?[1,1,1,1]:l}function Lc(n,l,a){return a.length===2?[a[0],a[1],0]:[a[0],a[1],a[2]]}function tf(n){var l=n.filter;return l?[1]:[0]}function wh(n,l){return[l]}var cv=ot(9187),Sl=ot.n(cv),ei=ot(31437),Cd=ei.Ue(),Gm=ei.Ue(),Bs=ei.Ue(),Mf=ei.Ue(),Zp=ei.Ue();function ef(n,l,a,s,o){ei.IH(n,a,s),ei.Fv(n,n),l=ei.al(-n[1],n[0]);var h=ei.al(-a[1],a[0]);return[o/ei.AK(l,h),l]}function Cl(n,l){return ei.t8(n,-l[1],l[0])}function Pc(n,l,a){return ei.lu(n,l,a),ei.Fv(n,n),n}function Vp(n,l){return n[0]===l[0]&&n[1]===l[1]}function Sh(n){for(var l=new Map,a=0;a<n.length;a++){var s=n[0].toString()+"-"+n[1].toString();l.get(s)?(n.splice(a,1),a++):l.set(s,s)}return n}var fv=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ct.Z)(this,n),(0,X.Z)(this,"lastFlip",-1),(0,X.Z)(this,"miter",ei.al(0,0)),(0,X.Z)(this,"started",!1),(0,X.Z)(this,"dash",!1),(0,X.Z)(this,"totalDistance",0),(0,X.Z)(this,"currentIndex",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,et.Z)(n,[{key:"extrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var at=s[m],ut=m<a.length-1?[].concat((0,me.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,xt=m<s.length-1?s[m+1]:null,Nt=this.segment_gaode2(o,v,B,j,ut,V,at,xt);v+=Nt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"simpleExtrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var at=s[m],ut=m<a.length-1?[].concat((0,me.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,xt=m<s.length-1?s[m+1]:null,Nt=this.simpleSegment(o,v,B,j,ut,V,at,xt);v+=Nt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"extrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.segment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleExtrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.simpleSegment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"segment_gaode2",value:function(a,s,o,h,v,m,E,A){var F=0,B=a.indices,V=a.positions,j=a.normals,at=this.cap==="square",ut=this.join==="bevel",xt=Ko([E[0],E[1]]),Nt=Ko([m[0],m[1]]);Pc(Bs,h,o);var de=0;if(this.dash&&(de=this.lineSegmentDistance(xt,Nt),this.totalDistance+=de),this.normal||(this.normal=ei.Ue(),Cl(this.normal,Bs)),!this.started)if(this.started=!0,at){var fe=ei.Ue(),Ne=ei.Ue();ei.IH(fe,this.normal,Bs),ei.IH(Ne,this.normal,Bs),j.push(Ne[0],Ne[1],0),j.push(fe[0],fe[1],0),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,o,this.normal,this.thickness,this.totalDistance-de);if(B.push(s+0,s+1,s+2),v){Vp(h,v)&&ei.IH(v,h,ei.Fv(v,ei.$X(v,h,o))),Pc(Mf,v,h);var Ir=ef(Zp,ei.Ue(),Bs,Mf,this.thickness),Nr=(0,ht.Z)(Ir,2),Yr=Nr[0],yn=Nr[1],fn=ei.AK(Zp,this.normal)<0?-1:1,$n=ut;if(!$n&&this.join==="miter"){var di=Yr;di>this.miterLimit&&($n=!0)}$n?(j.push(this.normal[0],this.normal[1],0),j.push(yn[0],yn[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,B.push.apply(B,(0,me.Z)(this.lastFlip!==-fn?[s,s+2,s+3]:[s+2,s+1,s+3])),B.push(s+2,s+3,s+4),Cl(Cd,Mf),ei.JG(this.normal,Cd),j.push(this.normal[0],this.normal[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,F+=3):(this.extrusions(V,j,h,yn,Yr,this.totalDistance),B.push.apply(B,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fn=-1,ei.JG(this.normal,yn),F+=2),this.lastFlip=fn}else{if(Cl(this.normal,Bs),at){var Ye=ei.Ue(),_r=ei.Ue();ei.lu(_r,Bs,this.normal),ei.IH(Ye,Bs,this.normal),j.push(_r[0],_r[1],0),j.push(Ye[0],Ye[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,h,this.normal,this.thickness,this.totalDistance);B.push.apply(B,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),F+=2}return F}},{key:"simpleSegment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=Ko([h[0],h[1]]),V=Ko([o[0],o[1]]);Pc(Bs,B,V);var j=0;if(this.dash&&(j=this.lineSegmentDistance(B,V),this.totalDistance+=j),this.normal||(this.normal=ei.Ue(),Cl(this.normal,Bs)),this.started||(this.started=!0,this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-j)),E.push(s+0,s+1,s+2),!v)Cl(this.normal,Bs),this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance),E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2;else{var at=Ko([v[0],v[1]]);Vp(B,at)&&ei.IH(at,B,ei.Fv(at,ei.$X(at,B,V))),Pc(Mf,at,B);var ut=ef(Zp,ei.Ue(),Bs,Mf,this.thickness),xt=(0,ht.Z)(ut,2),Nt=xt[0],de=xt[1],fe=ei.AK(Zp,this.normal)<0?-1:1;this.extrusions(A,F,h,de,Nt,this.totalDistance),E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fe=-1,ei.JG(this.normal,de),m+=2,this.lastFlip=fe}return m}},{key:"segment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=this.cap==="square",V=this.join==="bevel",j=Ko([h[0],h[1]]),at=Ko([o[0],o[1]]);Pc(Bs,j,at);var ut=0;if(this.dash&&(ut=this.lineSegmentDistance(j,at),this.totalDistance+=ut),this.normal||(this.normal=ei.Ue(),Cl(this.normal,Bs)),!this.started)if(this.started=!0,B){var xt=ei.Ue(),Nt=ei.Ue();ei.IH(xt,this.normal,Bs),ei.IH(Nt,this.normal,Bs),F.push(Nt[0],Nt[1],0),F.push(xt[0],xt[1],0),A.push(o[0],o[1],o[2]|0,this.totalDistance-ut,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),A.push(o[0],o[1],o[2]|0,this.totalDistance-ut,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-ut);if(E.push(s+0,s+1,s+2),v){var Ne=Ko([v[0],v[1]]);Vp(j,Ne)&&ei.IH(Ne,j,ei.Fv(Ne,ei.$X(Ne,j,at))),Pc(Mf,Ne,j);var Ye=ef(Zp,ei.Ue(),Bs,Mf,this.thickness),_r=(0,ht.Z)(Ye,2),Ir=_r[0],Nr=_r[1],Yr=ei.AK(Zp,this.normal)<0?-1:1,yn=V;if(!yn&&this.join==="miter"){var fn=Ir;fn>this.miterLimit&&(yn=!0)}yn?(F.push(this.normal[0],this.normal[1],0),F.push(Nr[0],Nr[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,E.push.apply(E,(0,me.Z)(this.lastFlip!==-Yr?[s,s+2,s+3]:[s+2,s+1,s+3])),E.push(s+2,s+3,s+4),Cl(Cd,Mf),ei.JG(this.normal,Cd),F.push(this.normal[0],this.normal[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,m+=3):(this.extrusions(A,F,h,Nr,Ir,this.totalDistance),E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),Yr=-1,ei.JG(this.normal,Nr),m+=2),this.lastFlip=Yr}else{if(Cl(this.normal,Bs),B){var de=ei.Ue(),fe=ei.Ue();ei.lu(fe,Bs,this.normal),ei.IH(de,Bs,this.normal),F.push(fe[0],fe[1],0),F.push(de[0],de[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance);E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2}return m}},{key:"extrusions",value:function(a,s,o,h,v,m){s.push(h[0],h[1],0),s.push(h[0],h[1],0),a.push(o[0],o[1],o[2]|0,m,-v,o[2]|0),this.complex.indexes.push(this.currentIndex),a.push(o[0],o[1],o[2]|0,m,v,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(a,s){var o=s[0]-a[0],h=s[1]-a[1];return Math.sqrt(o*o+h*h)}}]),n}();function Ns(n){var l=n.coordinates,a=n.originCoordinates,s=n.version,o=new fv({dash:!0,join:"bevel"});if(s==="GAODE2.x"){var h=l;Array.isArray(h[0][0])||(h=[l]);var v=a;Array.isArray(v[0][0])||(v=[a]);for(var m=0;m<h.length;m++){var E=h[m],A=v[m];o.extrude_gaode2(E,A)}}else{var F=l;F[0]&&!Array.isArray(F[0][0])&&(F=[l]),F.forEach(function(V){o.extrude(V)})}var B=o.complex;return{vertices:B.positions,indices:B.indices,normals:B.normals,indexes:B.indexes,size:6}}function qf(n){var l=bs(n.coordinates);return{vertices:[].concat((0,me.Z)(l),(0,me.Z)(l),(0,me.Z)(l),(0,me.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function Ad(n){for(var l=n.coordinates,a=Sl().flatten(l),s=a.vertices,o=a.dimensions,h=a.holes,v=0;v<s.length;v+=o)s[v+1]=gc(s[v+1]);for(var m=Sl()(s,h,o),E=0;E<s.length;E+=o)s[E+1]=hv(s[E+1]);return{indices:m,vertices:s,size:o}}function gc(n){return n>85||n<-85?n:Math.log(Math.tan(Math.PI*n/360))}function hv(n){return n>85||n<-85?n:Math.atan(Math.exp(n))*360/Math.PI}var Td=function(){var n=(0,lt.Z)(it().mark(function l(a){var s,o,h,v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=a.descriptors,o=a.features,h=a.enablePicking,v=a.iconMap,m={a_Color:Up,a_Position:Lc,filter:tf,a_vertexId:wh,a_PickingColor:function(ut){var xt=ut.id;return h?ar(xt):[0,0,0]},a_DistanceAndIndex:function(ut,xt,Nt,de,fe,Ne){return Ne===void 0?[Nt[3],10]:[Nt[3],Ne]},a_Total_Distance:function(ut,xt,Nt){return[Nt[5]]},a_Size:function(ut){var xt=ut.size,Nt=xt===void 0?1:xt;return Array.isArray(Nt)?[Nt[0],Nt[1]]:[Nt,0]},a_Normal:function(ut,xt,Nt,de,fe){return fe},a_Miter:function(ut,xt,Nt){return[Nt[4]]},a_iconMapUV:function(ut){var xt=ut.texture,Nt=v[xt]||{x:0,y:0},de=Nt.x,fe=Nt.y;return[de,fe]}},E={sizePerElement:0,elements:[]},A=0,F=[],B=3,o.forEach(function(at,ut){var xt=Ns(at),Nt=xt.indices,de=xt.vertices,fe=xt.normals,Ne=xt.size,Ye=xt.indexes;Nt.forEach(function(Yr){F.push(Yr+A)}),B=Ne;var _r=de.length/Ne;E.sizePerElement=B,E.elements.push({featureIdx:ut,vertices:de,normals:fe,offset:A}),A+=_r;for(var Ir=function(yn){var fn=(fe==null?void 0:fe.slice(yn*3,yn*3+3))||[],$n=de.slice(yn*Ne,yn*Ne+Ne),di=0;Ye&&Ye[yn]!==void 0&&(di=Ye[yn]),s.forEach(function(Yi){if(Yi&&m[Yi.name]){var ho;(ho=Yi.buffer.data).push.apply(ho,(0,me.Z)(m[Yi.name](at,ut,$n,yn,fn,di)))}})},Nr=0;Nr<_r;Nr++)Ir(Nr)}),j.abrupt("return",{descriptors:s,featureLayout:E,indices:F});case 8:case"end":return j.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),pv=function(){var n=(0,lt.Z)(it().mark(function l(a){var s,o,h,v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return s=a.descriptors,o=a.features,h=a.enablePicking,v=a.shape2d,m={a_Color:Up,a_Position:Lc,filter:tf,a_vertexId:wh,a_PickingColor:function(ut){var xt=ut.id;return h?ar(xt):[0,0,0]},a_Shape:function(ut){var xt=ut.shape,Nt=xt===void 0?2:xt,de=v.indexOf(Nt);return[de]},a_Extrude:function(ut,xt,Nt,de){var fe=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],Ne=de%4*3;return[fe[Ne],fe[Ne+1],fe[Ne+2]]},a_Size:function(ut){var xt=ut.size,Nt=xt===void 0?5:xt;return Array.isArray(Nt)?[Nt[0]]:[Nt]}},E={sizePerElement:0,elements:[]},A=0,F=[],B=3,o.forEach(function(at,ut){var xt=qf(at),Nt=xt.indices,de=xt.vertices,fe=xt.normals,Ne=xt.size,Ye=xt.indexes;Nt.forEach(function(Yr){F.push(Yr+A)}),B=Ne;var _r=de.length/Ne;E.sizePerElement=B,E.elements.push({featureIdx:ut,vertices:de,normals:fe,offset:A}),A+=_r;for(var Ir=function(yn){var fn=(fe==null?void 0:fe.slice(yn*3,yn*3+3))||[],$n=de.slice(yn*Ne,yn*Ne+Ne),di=0;Ye&&Ye[yn]!==void 0&&(di=Ye[yn]),s.forEach(function(Yi){if(Yi&&m[Yi.name]){var ho;(ho=Yi.buffer.data).push.apply(ho,(0,me.Z)(m[Yi.name](at,ut,$n,yn,fn,di)))}})},Nr=0;Nr<_r;Nr++)Ir(Nr)}),j.abrupt("return",{descriptors:s,featureLayout:E,indices:F});case 8:case"end":return j.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),Md=function(){var n=(0,lt.Z)(it().mark(function l(a){var s,o,h,v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return s=a.descriptors,o=a.features,h=a.enablePicking,v={a_Color:Up,a_Position:Lc,filter:tf,a_vertexId:wh,a_PickingColor:function(at){var ut=at.id;return h?ar(ut):[0,0,0]}},m={sizePerElement:0,elements:[]},E=0,A=[],F=3,o.forEach(function(j,at){var ut=Ad(j),xt=ut.indices,Nt=ut.vertices,de=ut.normals,fe=ut.size,Ne=ut.indexes;xt.forEach(function(Nr){A.push(Nr+E)}),F=fe;var Ye=Nt.length/fe;m.sizePerElement=F,m.elements.push({featureIdx:at,vertices:Nt,normals:de,offset:E}),E+=Ye;for(var _r=function(Yr){var yn=(de==null?void 0:de.slice(Yr*3,Yr*3+3))||[],fn=Nt.slice(Yr*fe,Yr*fe+fe),$n=0;Ne&&Ne[Yr]!==void 0&&($n=Ne[Yr]),s.forEach(function(di){if(di&&v[di.name]){var Yi;(Yi=di.buffer.data).push.apply(Yi,(0,me.Z)(v[di.name](j,at,fn,Yr,yn,$n)))}})},Ir=0;Ir<Ye;Ir++)_r(Ir)}),V.abrupt("return",{descriptors:s,featureLayout:m,indices:A});case 8:case"end":return V.stop()}},l)}));return function(a){return n.apply(this,arguments)}}(),Kf={pointFill:pv,line:Td,polygonFill:Md},up=(0,q.Z)({},Kf);function Id(n){return Gp.apply(this,arguments)}function Gp(){return Gp=(0,lt.Z)(it().mark(function n(l){var a,s;return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(a=l.workerType,s=l.data,!up[a]){h.next=3;break}return h.abrupt("return",up[a](s));case 3:return h.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(a,'" non-existent.'))));case 4:case"end":return h.stop()}},n)})),Gp.apply(this,arguments)}bh(Id);var Qf=new Map;function dv(n,l){Qf.set(n,l)}function rf(n){var l=Qf.get(n);return l}var vv=`var L7=function(t){"use strict";function e(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function r(){r=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),u=new T(n||[]);return o(a,"_invoke",{value:E(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=f;var h={};function p(){}function v(){}function d(){}var y={};c(y,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(k([])));m&&m!==e&&n.call(m,a)&&(y=m);var x=d.prototype=p.prototype=Object.create(y);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){var r;o(this,"_invoke",{value:function(o,i){function a(){return new e((function(r,a){!function r(o,i,a,u){var s=l(t[o],t,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}})}function E(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return I()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=A(a,r);if(u){if(u===h)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function A(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,A(t,e),"throw"===e.method))return h;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,h;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,h):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function k(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return v.prototype=d,o(x,"constructor",{value:d,configurable:!0}),o(d,"constructor",{value:v,configurable:!0}),v.displayName=c(d,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,s,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},b(w.prototype),c(w.prototype,u,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(f(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(x),c(x,s,"Generator"),c(x,a,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=k,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;S(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:k(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},t}function n(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var a=t.apply(e,r);function u(t){n(a,o,i,u,s,"next",t)}function s(t){n(a,o,i,u,s,"throw",t)}u(void 0)}))}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e)}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function v(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=f(t);if(e){var o=f(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return p(this,r)}}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,u=!1;try{for(r=r.call(t);!(a=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);a=!0);}catch(t){u=!0,o=t}finally{try{a||null==r.return||r.return()}finally{if(u)throw o}}return i}(t,e)||g(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||g(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(t,e){if(t){if("string"==typeof t)return m(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function b(t,e){return t(e={exports:{}},e.exports),e.exports}var w,E,A=function(t){return t&&t.Math==Math&&t},O=A("object"==typeof globalThis&&globalThis)||A("object"==typeof window&&window)||A("object"==typeof self&&self)||A("object"==typeof x&&x)||function(){return this}()||Function("return this")(),S=Object.defineProperty,T=function(t,e){try{S(O,t,{value:e,configurable:!0,writable:!0})}catch(r){O[t]=e}return e},k=O["__core-js_shared__"]||T("__core-js_shared__",{}),I=b((function(t){(t.exports=function(t,e){return k[t]||(k[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.26.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.26.1/LICENSE",source:"https://github.com/zloirock/core-js"})})),j=function(t){try{return!!t()}catch(t){return!0}},P=!j((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),_=Function.prototype,M=_.call,L=P&&_.bind.bind(M,M),R=P?L:function(t){return function(){return M.apply(t,arguments)}},C=function(t){return null==t},N=TypeError,D=function(t){if(C(t))throw N("Can't call method on "+t);return t},F=Object,W=function(t){return F(D(t))},z=R({}.hasOwnProperty),B=Object.hasOwn||function(t,e){return z(W(t),e)},U=0,G=Math.random(),H=R(1..toString),V=function(t){return"Symbol("+(void 0===t?"":t)+")_"+H(++U+G,36)},q="object"==typeof document&&document.all,Z={all:q,IS_HTMLDDA:void 0===q&&void 0!==q},Y=Z.all,$=Z.IS_HTMLDDA?function(t){return"function"==typeof t||t===Y}:function(t){return"function"==typeof t},K=function(t){return $(t)?t:void 0},Q=function(t,e){return arguments.length<2?K(O[t]):O[t]&&O[t][e]},X=Q("navigator","userAgent")||"",J=O.process,tt=O.Deno,et=J&&J.versions||tt&&tt.version,rt=et&&et.v8;rt&&(E=(w=rt.split("."))[0]>0&&w[0]<4?1:+(w[0]+w[1])),!E&&X&&(!(w=X.match(/Edge\\/(\\d+)/))||w[1]>=74)&&(w=X.match(/Chrome\\/(\\d+)/))&&(E=+w[1]);var nt=E,ot=!!Object.getOwnPropertySymbols&&!j((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&nt&&nt<41})),it=ot&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,at=I("wks"),ut=O.Symbol,st=ut&&ut.for,ct=it?ut:ut&&ut.withoutSetter||V,ft=function(t){if(!B(at,t)||!ot&&"string"!=typeof at[t]){var e="Symbol."+t;ot&&B(ut,t)?at[t]=ut[t]:at[t]=it&&st?st(e):ct(e)}return at[t]},lt={};lt[ft("toStringTag")]="z";var ht="[object z]"===String(lt),pt=!j((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),vt=Z.all,dt=Z.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:$(t)||t===vt}:function(t){return"object"==typeof t?null!==t:$(t)},yt=O.document,gt=dt(yt)&&dt(yt.createElement),mt=function(t){return gt?yt.createElement(t):{}},xt=!pt&&!j((function(){return 7!=Object.defineProperty(mt("div"),"a",{get:function(){return 7}}).a})),bt=pt&&j((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),wt=String,Et=TypeError,At=function(t){if(dt(t))return t;throw Et(wt(t)+" is not an object")},Ot=Function.prototype.call,St=P?Ot.bind(Ot):function(){return Ot.apply(Ot,arguments)},Tt=R({}.isPrototypeOf),kt=Object,It=it?function(t){return"symbol"==typeof t}:function(t){var e=Q("Symbol");return $(e)&&Tt(e.prototype,kt(t))},jt=String,Pt=function(t){try{return jt(t)}catch(t){return"Object"}},_t=TypeError,Mt=function(t){if($(t))return t;throw _t(Pt(t)+" is not a function")},Lt=function(t,e){var r=t[e];return C(r)?void 0:Mt(r)},Rt=TypeError,Ct=TypeError,Nt=ft("toPrimitive"),Dt=function(t,e){if(!dt(t)||It(t))return t;var r,n=Lt(t,Nt);if(n){if(void 0===e&&(e="default"),r=St(n,t,e),!dt(r)||It(r))return r;throw Ct("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var r,n;if("string"===e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;if($(r=t.valueOf)&&!dt(n=St(r,t)))return n;if("string"!==e&&$(r=t.toString)&&!dt(n=St(r,t)))return n;throw Rt("Can't convert object to primitive value")}(t,e)},Ft=function(t){var e=Dt(t,"string");return It(e)?e:e+""},Wt=TypeError,zt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,Ut={f:pt?bt?function(t,e,r){if(At(t),e=Ft(e),At(r),"function"==typeof t&&"prototype"===e&&"value"in r&&"writable"in r&&!r.writable){var n=Bt(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return zt(t,e,r)}:zt:function(t,e,r){if(At(t),e=Ft(e),At(r),xt)try{return zt(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Wt("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},Gt=Function.prototype,Ht=pt&&Object.getOwnPropertyDescriptor,Vt=B(Gt,"name"),qt={EXISTS:Vt,PROPER:Vt&&"something"===function(){}.name,CONFIGURABLE:Vt&&(!pt||pt&&Ht(Gt,"name").configurable)},Zt=R(Function.toString);$(k.inspectSource)||(k.inspectSource=function(t){return Zt(t)});var Yt,$t,Kt,Qt=k.inspectSource,Xt=O.WeakMap,Jt=$(Xt)&&/native code/.test(String(Xt)),te=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},ee=pt?function(t,e,r){return Ut.f(t,e,te(1,r))}:function(t,e,r){return t[e]=r,t},re=I("keys"),ne=function(t){return re[t]||(re[t]=V(t))},oe={},ie=O.TypeError,ae=O.WeakMap;if(Jt||k.state){var ue=k.state||(k.state=new ae);ue.get=ue.get,ue.has=ue.has,ue.set=ue.set,Yt=function(t,e){if(ue.has(t))throw ie("Object already initialized");return e.facade=t,ue.set(t,e),e},$t=function(t){return ue.get(t)||{}},Kt=function(t){return ue.has(t)}}else{var se=ne("state");oe[se]=!0,Yt=function(t,e){if(B(t,se))throw ie("Object already initialized");return e.facade=t,ee(t,se,e),e},$t=function(t){return B(t,se)?t[se]:{}},Kt=function(t){return B(t,se)}}var ce={set:Yt,get:$t,has:Kt,enforce:function(t){return Kt(t)?$t(t):Yt(t,{})},getterFor:function(t){return function(e){var r;if(!dt(e)||(r=$t(e)).type!==t)throw ie("Incompatible receiver, "+t+" required");return r}}},fe=b((function(t){var e=qt.CONFIGURABLE,r=ce.enforce,n=ce.get,o=Object.defineProperty,i=pt&&!j((function(){return 8!==o((function(){}),"length",{value:8}).length})),a=String(String).split("String"),u=t.exports=function(t,n,u){"Symbol("===String(n).slice(0,7)&&(n="["+String(n).replace(/^Symbol\\(([^)]*)\\)/,"$1")+"]"),u&&u.getter&&(n="get "+n),u&&u.setter&&(n="set "+n),(!B(t,"name")||e&&t.name!==n)&&(pt?o(t,"name",{value:n,configurable:!0}):t.name=n),i&&u&&B(u,"arity")&&t.length!==u.arity&&o(t,"length",{value:u.arity});try{u&&B(u,"constructor")&&u.constructor?pt&&o(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var s=r(t);return B(s,"source")||(s.source=a.join("string"==typeof n?n:"")),t};Function.prototype.toString=u((function(){return $(this)&&n(this).source||Qt(this)}),"toString")})),le=function(t,e,r,n){n||(n={});var o=n.enumerable,i=void 0!==n.name?n.name:e;if($(r)&&fe(r,i,n),n.global)o?t[e]=r:T(e,r);else{try{n.unsafe?t[e]&&(o=!0):delete t[e]}catch(t){}o?t[e]=r:Ut.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},he=R({}.toString),pe=R("".slice),ve=function(t){return pe(he(t),8,-1)},de=ft("toStringTag"),ye=Object,ge="Arguments"==ve(function(){return arguments}()),me=ht?ve:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=ye(t),de))?r:ge?ve(e):"Object"==(n=ve(e))&&$(e.callee)?"Arguments":n},xe=ht?{}.toString:function(){return"[object "+me(this)+"]"};ht||le(Object.prototype,"toString",xe,{unsafe:!0});var be={}.propertyIsEnumerable,we=Object.getOwnPropertyDescriptor,Ee={f:we&&!be.call({1:2},1)?function(t){var e=we(this,t);return!!e&&e.enumerable}:be},Ae=Object,Oe=R("".split),Se=j((function(){return!Ae("z").propertyIsEnumerable(0)}))?function(t){return"String"==ve(t)?Oe(t,""):Ae(t)}:Ae,Te=function(t){return Se(D(t))},ke=Object.getOwnPropertyDescriptor,Ie={f:pt?ke:function(t,e){if(t=Te(t),e=Ft(e),xt)try{return ke(t,e)}catch(t){}if(B(t,e))return te(!St(Ee.f,t,e),t[e])}},je=Math.ceil,Pe=Math.floor,_e=Math.trunc||function(t){var e=+t;return(e>0?Pe:je)(e)},Me=function(t){var e=+t;return e!=e||0===e?0:_e(e)},Le=Math.max,Re=Math.min,Ce=function(t,e){var r=Me(t);return r<0?Le(r+e,0):Re(r,e)},Ne=Math.min,De=function(t){return t>0?Ne(Me(t),9007199254740991):0},Fe=function(t){return De(t.length)},We=function(t){return function(e,r,n){var o,i=Te(e),a=Fe(i),u=Ce(n,a);if(t&&r!=r){for(;a>u;)if((o=i[u++])!=o)return!0}else for(;a>u;u++)if((t||u in i)&&i[u]===r)return t||u||0;return!t&&-1}},ze={includes:We(!0),indexOf:We(!1)},Be=ze.indexOf,Ue=R([].push),Ge=function(t,e){var r,n=Te(t),o=0,i=[];for(r in n)!B(oe,r)&&B(n,r)&&Ue(i,r);for(;e.length>o;)B(n,r=e[o++])&&(~Be(i,r)||Ue(i,r));return i},He=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ve=He.concat("length","prototype"),qe={f:Object.getOwnPropertyNames||function(t){return Ge(t,Ve)}},Ze={f:Object.getOwnPropertySymbols},Ye=R([].concat),$e=Q("Reflect","ownKeys")||function(t){var e=qe.f(At(t)),r=Ze.f;return r?Ye(e,r(t)):e},Ke=function(t,e,r){for(var n=$e(e),o=Ut.f,i=Ie.f,a=0;a<n.length;a++){var u=n[a];B(t,u)||r&&B(r,u)||o(t,u,i(e,u))}},Qe=/#|\\.prototype\\./,Xe=function(t,e){var r=tr[Je(t)];return r==rr||r!=er&&($(e)?j(e):!!e)},Je=Xe.normalize=function(t){return String(t).replace(Qe,".").toLowerCase()},tr=Xe.data={},er=Xe.NATIVE="N",rr=Xe.POLYFILL="P",nr=Xe,or=Ie.f,ir=function(t,e){var r,n,o,i,a,u=t.target,s=t.global,c=t.stat;if(r=s?O:c?O[u]||T(u,{}):(O[u]||{}).prototype)for(n in e){if(i=e[n],o=t.dontCallGetSet?(a=or(r,n))&&a.value:r[n],!nr(s?n:u+(c?".":"#")+n,t.forced)&&void 0!==o){if(typeof i==typeof o)continue;Ke(i,o)}(t.sham||o&&o.sham)&&ee(i,"sham",!0),le(r,n,i,t)}},ar="process"==ve(O.process),ur=String,sr=TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=R(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return At(r),function(t){if("object"==typeof t||$(t))return t;throw sr("Can't set "+ur(t)+" as a prototype")}(n),e?t(r,n):r.__proto__=n,r}}():void 0),fr=Ut.f,lr=ft("toStringTag"),hr=function(t,e,r){t&&!r&&(t=t.prototype),t&&!B(t,lr)&&fr(t,lr,{configurable:!0,value:e})},pr=ft("species"),vr=function(t){var e=Q(t),r=Ut.f;pt&&e&&!e[pr]&&r(e,pr,{configurable:!0,get:function(){return this}})},dr=TypeError,yr=function(t,e){if(Tt(e,t))return t;throw dr("Incorrect invocation")},gr=function(){},mr=[],xr=Q("Reflect","construct"),br=/^\\s*(?:class|function)\\b/,wr=R(br.exec),Er=!br.exec(gr),Ar=function(t){if(!$(t))return!1;try{return xr(gr,mr,t),!0}catch(t){return!1}},Or=function(t){if(!$(t))return!1;switch(me(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Er||!!wr(br,Qt(t))}catch(t){return!0}};Or.sham=!0;var Sr,Tr,kr,Ir,jr=!xr||j((function(){var t;return Ar(Ar.call)||!Ar(Object)||!Ar((function(){t=!0}))||t}))?Or:Ar,Pr=TypeError,_r=function(t){if(jr(t))return t;throw Pr(Pt(t)+" is not a constructor")},Mr=ft("species"),Lr=function(t,e){var r,n=At(t).constructor;return void 0===n||C(r=At(n)[Mr])?e:_r(r)},Rr=Function.prototype,Cr=Rr.apply,Nr=Rr.call,Dr="object"==typeof Reflect&&Reflect.apply||(P?Nr.bind(Cr):function(){return Nr.apply(Cr,arguments)}),Fr=function(t){if("Function"===ve(t))return R(t)},Wr=Fr(Fr.bind),zr=function(t,e){return Mt(t),void 0===e?t:P?Wr(t,e):function(){return t.apply(e,arguments)}},Br=Q("document","documentElement"),Ur=R([].slice),Gr=TypeError,Hr=function(t,e){if(t<e)throw Gr("Not enough arguments");return t},Vr=/(?:ipad|iphone|ipod).*applewebkit/i.test(X),qr=O.setImmediate,Zr=O.clearImmediate,Yr=O.process,$r=O.Dispatch,Kr=O.Function,Qr=O.MessageChannel,Xr=O.String,Jr=0,tn={};try{Sr=O.location}catch(t){}var en=function(t){if(B(tn,t)){var e=tn[t];delete tn[t],e()}},rn=function(t){return function(){en(t)}},nn=function(t){en(t.data)},on=function(t){O.postMessage(Xr(t),Sr.protocol+"//"+Sr.host)};qr&&Zr||(qr=function(t){Hr(arguments.length,1);var e=$(t)?t:Kr(t),r=Ur(arguments,1);return tn[++Jr]=function(){Dr(e,void 0,r)},Tr(Jr),Jr},Zr=function(t){delete tn[t]},ar?Tr=function(t){Yr.nextTick(rn(t))}:$r&&$r.now?Tr=function(t){$r.now(rn(t))}:Qr&&!Vr?(Ir=(kr=new Qr).port2,kr.port1.onmessage=nn,Tr=zr(Ir.postMessage,Ir)):O.addEventListener&&$(O.postMessage)&&!O.importScripts&&Sr&&"file:"!==Sr.protocol&&!j(on)?(Tr=on,O.addEventListener("message",nn,!1)):Tr="onreadystatechange"in mt("script")?function(t){Br.appendChild(mt("script")).onreadystatechange=function(){Br.removeChild(this),en(t)}}:function(t){setTimeout(rn(t),0)});var an,un,sn,cn,fn,ln,hn,pn,vn={set:qr,clear:Zr},dn=/ipad|iphone|ipod/i.test(X)&&void 0!==O.Pebble,yn=/web0s(?!.*chrome)/i.test(X),gn=Ie.f,mn=vn.set,xn=O.MutationObserver||O.WebKitMutationObserver,bn=O.document,wn=O.process,En=O.Promise,An=gn(O,"queueMicrotask"),On=An&&An.value;On||(an=function(){var t,e;for(ar&&(t=wn.domain)&&t.exit();un;){e=un.fn,un=un.next;try{e()}catch(t){throw un?cn():sn=void 0,t}}sn=void 0,t&&t.enter()},Vr||ar||yn||!xn||!bn?!dn&&En&&En.resolve?((hn=En.resolve(void 0)).constructor=En,pn=zr(hn.then,hn),cn=function(){pn(an)}):ar?cn=function(){wn.nextTick(an)}:(mn=zr(mn,O),cn=function(){mn(an)}):(fn=!0,ln=bn.createTextNode(""),new xn(an).observe(ln,{characterData:!0}),cn=function(){ln.data=fn=!fn}));var Sn=On||function(t){var e={fn:t,next:void 0};sn&&(sn.next=e),un||(un=e,cn()),sn=e},Tn=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},kn=function(){this.head=null,this.tail=null};kn.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var In,jn,Pn,_n=kn,Mn=O.Promise,Ln="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Rn=!Ln&&!ar&&"object"==typeof window&&"object"==typeof document,Cn=(Mn&&Mn.prototype,ft("species")),Nn=!1,Dn=$(O.PromiseRejectionEvent),Fn={CONSTRUCTOR:nr("Promise",(function(){var t=Qt(Mn),e=t!==String(Mn);if(!e&&66===nt)return!0;if(!nt||nt<51||!/native code/.test(t)){var r=new Mn((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Cn]=n,!(Nn=r.then((function(){}))instanceof n))return!0}return!e&&(Rn||Ln)&&!Dn})),REJECTION_EVENT:Dn,SUBCLASSING:Nn},Wn=TypeError,zn=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw Wn("Bad Promise constructor");e=t,r=n})),this.resolve=Mt(e),this.reject=Mt(r)},Bn={f:function(t){return new zn(t)}},Un=vn.set,Gn=Fn.CONSTRUCTOR,Hn=Fn.REJECTION_EVENT,Vn=Fn.SUBCLASSING,qn=ce.getterFor("Promise"),Zn=ce.set,Yn=Mn&&Mn.prototype,$n=Mn,Kn=Yn,Qn=O.TypeError,Xn=O.document,Jn=O.process,to=Bn.f,eo=to,ro=!!(Xn&&Xn.createEvent&&O.dispatchEvent),no=function(t){var e;return!(!dt(t)||!$(e=t.then))&&e},oo=function(t,e){var r,n,o,i=e.value,a=1==e.state,u=a?t.ok:t.fail,s=t.resolve,c=t.reject,f=t.domain;try{u?(a||(2===e.rejection&&co(e),e.rejection=1),!0===u?r=i:(f&&f.enter(),r=u(i),f&&(f.exit(),o=!0)),r===t.promise?c(Qn("Promise-chain cycle")):(n=no(r))?St(n,r,s,c):s(r)):c(i)}catch(t){f&&!o&&f.exit(),c(t)}},io=function(t,e){t.notified||(t.notified=!0,Sn((function(){for(var r,n=t.reactions;r=n.get();)oo(r,t);t.notified=!1,e&&!t.rejection&&uo(t)})))},ao=function(t,e,r){var n,o;ro?((n=Xn.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),O.dispatchEvent(n)):n={promise:e,reason:r},!Hn&&(o=O["on"+t])?o(n):"unhandledrejection"===t&&function(t,e){var r=O.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))}("Unhandled promise rejection",r)},uo=function(t){St(Un,O,(function(){var e,r=t.facade,n=t.value;if(so(t)&&(e=Tn((function(){ar?Jn.emit("unhandledRejection",n,r):ao("unhandledrejection",r,n)})),t.rejection=ar||so(t)?2:1,e.error))throw e.value}))},so=function(t){return 1!==t.rejection&&!t.parent},co=function(t){St(Un,O,(function(){var e=t.facade;ar?Jn.emit("rejectionHandled",e):ao("rejectionhandled",e,t.value)}))},fo=function(t,e,r){return function(n){t(e,n,r)}},lo=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,io(t,!0))},ho=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Qn("Promise can't be resolved itself");var n=no(e);n?Sn((function(){var r={done:!1};try{St(n,e,fo(ho,r,t),fo(lo,r,t))}catch(e){lo(r,e,t)}})):(t.value=e,t.state=1,io(t,!1))}catch(e){lo({done:!1},e,t)}}};if(Gn&&(Kn=($n=function(t){yr(this,Kn),Mt(t),St(In,this);var e=qn(this);try{t(fo(ho,e),fo(lo,e))}catch(t){lo(e,t)}}).prototype,(In=function(t){Zn(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new _n,rejection:!1,state:0,value:void 0})}).prototype=le(Kn,"then",(function(t,e){var r=qn(this),n=to(Lr(this,$n));return r.parent=!0,n.ok=!$(t)||t,n.fail=$(e)&&e,n.domain=ar?Jn.domain:void 0,0==r.state?r.reactions.add(n):Sn((function(){oo(n,r)})),n.promise})),jn=function(){var t=new In,e=qn(t);this.promise=t,this.resolve=fo(ho,e),this.reject=fo(lo,e)},Bn.f=to=function(t){return t===$n||void 0===t?new jn(t):eo(t)},$(Mn)&&Yn!==Object.prototype)){Pn=Yn.then,Vn||le(Yn,"then",(function(t,e){var r=this;return new $n((function(t,e){St(Pn,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete Yn.constructor}catch(t){}cr&&cr(Yn,Kn)}ir({global:!0,constructor:!0,wrap:!0,forced:Gn},{Promise:$n}),hr($n,"Promise",!1),vr("Promise");var po={},vo=ft("iterator"),yo=Array.prototype,go=function(t){return void 0!==t&&(po.Array===t||yo[vo]===t)},mo=ft("iterator"),xo=function(t){if(!C(t))return Lt(t,mo)||Lt(t,"@@iterator")||po[me(t)]},bo=TypeError,wo=function(t,e){var r=arguments.length<2?xo(t):e;if(Mt(r))return At(St(r,t));throw bo(Pt(t)+" is not iterable")},Eo=function(t,e,r){var n,o;At(t);try{if(!(n=Lt(t,"return"))){if("throw"===e)throw r;return r}n=St(n,t)}catch(t){o=!0,n=t}if("throw"===e)throw r;if(o)throw n;return At(n),r},Ao=TypeError,Oo=function(t,e){this.stopped=t,this.result=e},So=Oo.prototype,To=function(t,e,r){var n,o,i,a,u,s,c,f=r&&r.that,l=!(!r||!r.AS_ENTRIES),h=!(!r||!r.IS_RECORD),p=!(!r||!r.IS_ITERATOR),v=!(!r||!r.INTERRUPTED),d=zr(e,f),y=function(t){return n&&Eo(n,"normal",t),new Oo(!0,t)},g=function(t){return l?(At(t),v?d(t[0],t[1],y):d(t[0],t[1])):v?d(t,y):d(t)};if(h)n=t.iterator;else if(p)n=t;else{if(!(o=xo(t)))throw Ao(Pt(t)+" is not iterable");if(go(o)){for(i=0,a=Fe(t);a>i;i++)if((u=g(t[i]))&&Tt(So,u))return u;return new Oo(!1)}n=wo(t,o)}for(s=h?t.next:n.next;!(c=St(s,n)).done;){try{u=g(c.value)}catch(t){Eo(n,"throw",t)}if("object"==typeof u&&u&&Tt(So,u))return u}return new Oo(!1)},ko=ft("iterator"),Io=!1;try{var jo=0,Po={next:function(){return{done:!!jo++}},return:function(){Io=!0}};Po[ko]=function(){return this},Array.from(Po,(function(){throw 2}))}catch(t){}var _o=function(t,e){if(!e&&!Io)return!1;var r=!1;try{var n={};n[ko]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Mo=Fn.CONSTRUCTOR||!_o((function(t){Mn.all(t).then(void 0,(function(){}))}));ir({target:"Promise",stat:!0,forced:Mo},{all:function(t){var e=this,r=Bn.f(e),n=r.resolve,o=r.reject,i=Tn((function(){var r=Mt(e.resolve),i=[],a=0,u=1;To(t,(function(t){var s=a++,c=!1;u++,St(r,e,t).then((function(t){c||(c=!0,i[s]=t,--u||n(i))}),o)})),--u||n(i)}));return i.error&&o(i.value),r.promise}});var Lo=Fn.CONSTRUCTOR,Ro=Mn&&Mn.prototype;if(ir({target:"Promise",proto:!0,forced:Lo,real:!0},{catch:function(t){return this.then(void 0,t)}}),$(Mn)){var Co=Q("Promise").prototype.catch;Ro.catch!==Co&&le(Ro,"catch",Co,{unsafe:!0})}ir({target:"Promise",stat:!0,forced:Mo},{race:function(t){var e=this,r=Bn.f(e),n=r.reject,o=Tn((function(){var o=Mt(e.resolve);To(t,(function(t){St(o,e,t).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}}),ir({target:"Promise",stat:!0,forced:Fn.CONSTRUCTOR},{reject:function(t){var e=Bn.f(this);return St(e.reject,void 0,t),e.promise}});var No=Fn.CONSTRUCTOR;Q("Promise");function Do(t,e){if(!t)throw new Error(e||"web worker helper assertion failed.")}ir({target:"Promise",stat:!0,forced:No},{resolve:function(t){return function(t,e){if(At(t),dt(e)&&e.constructor===t)return e;var r=Bn.f(t);return(0,r.resolve)(e),r.promise}(this,t)}});var Fo="undefined"!=typeof window&&void 0!==window.orientation,Wo=function(){function t(t,e){var r=this;this.name=t,this.workerThread=e,this.isRunning=!0,this.resolve=function(){},this.reject=function(){},this.result=new Promise((function(t,e){r.resolve=t,r.reject=e}))}return t.prototype.postMessage=function(t,e){this.workerThread.postMessage({source:"Main thread",type:t,payload:e})},t.prototype.done=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.resolve(t)},t.prototype.error=function(t){Do(this.isRunning,"WorkerJob isRunning false."),this.isRunning=!1,this.reject(t)},t}(),zo=new Map;function Bo(t){Do(t.source&&!t.url||!t.source&&t.url);var e=zo.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return Uo((e=t,"try {\\n  importScripts('"+e+"');\\n} catch (error) {\\n  console.error(error);\\n  throw error;\\n}"));var e}(t.url),zo.set(t.url,e)),t.source&&(e=Uo(t.source),zo.set(t.source,e))),Do(e),e}function Uo(t){var e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Go(t,e,r){void 0===e&&(e=!0);var n=r||new Set;if(t){if(Ho(t))n.add(t);else if(Ho(t.buffer))n.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(var o in t)Go(t[o],e,n)}else;return void 0===r?Array.from(n):[]}function Ho(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!=typeof MessagePort&&t instanceof MessagePort||("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}var Vo=function(){},qo=function(){function t(t){this.terminated=!1,this.loadableURL="";var e=t.name,r=t.source,n=t.url;Do(r||n),this.name=e,this.source=r,this.url=n,this.onMessage=Vo,this.onError=function(t){return console.log(t)},this.worker=this.createBrowserWorker()}return t.isSupported=function(){return"undefined"!=typeof Worker},t.prototype.destroy=function(){this.onMessage=Vo,this.onError=Vo,this.worker.terminate(),this.terminated=!0},Object.defineProperty(t.prototype,"isRunning",{get:function(){return Boolean(this.onMessage)},enumerable:!1,configurable:!0}),t.prototype.postMessage=function(t,e){e=e||Go(t),this.worker.postMessage(t,e)},t.prototype.getErrorFromErrorEvent=function(t){var e="Failed to load ";return e+="worker "+this.name+" from "+this.url+". ",t.message&&(e+=t.message+" in "),t.lineno&&(e+=":"+t.lineno+":"+t.colno),new Error(e)},t.prototype.createBrowserWorker=function(){var t=this;this.loadableURL=Bo({source:this.source,url:this.url});var e=new Worker(this.loadableURL,{name:this.name});return e.onmessage=function(e){e.data?t.onMessage(e.data):t.onError(new Error("No data received"))},e.onerror=function(e){t.onError(t.getErrorFromErrorEvent(e)),t.terminated=!0},e.onmessageerror=function(e){return console.error("worker "+t.name+", message error: "+e)},e},t}(),Zo=self&&self.__assign||function(){return(Zo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Yo=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},$o=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ko=function(){function t(t){this.name="unnamed",this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=function(){},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}return t.prototype.destroy=function(){this.idleQueue.forEach((function(t){return t.destroy()})),this.isDestroyed=!0},t.prototype.setProps=function(t){this.props=Zo(Zo({},this.props),t),void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)},t.prototype.startJob=function(t,e,r){return void 0===e&&(e=function(t,e,r){return t.done(r)}),void 0===r&&(r=function(t,e){return t.error(e)}),Yo(this,void 0,void 0,(function(){var n,o=this;return $o(this,(function(i){switch(i.label){case 0:return n=new Promise((function(n){return o.jobQueue.push({name:t,onMessage:e,onError:r,onStart:n}),o})),this.startQueuedJob(),[4,n];case 1:return[2,i.sent()]}}))}))},t.prototype.startQueuedJob=function(){return Yo(this,void 0,void 0,(function(){var t,e,r;return $o(this,(function(n){switch(n.label){case 0:if(!this.jobQueue.length)return[2];if(!(t=this.getAvailableWorker()))return[2];if(!(e=this.jobQueue.shift()))return[3,4];this.onDebug({message:"Starting job",name:e.name,backlog:this.jobQueue.length,workerThread:t}),r=new Wo(e.name,t),t.onMessage=function(t){return e.onMessage(r,t.type,t.payload)},t.onError=function(t){return e.onError(r,t)},e.onStart(r),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,r.result];case 2:return n.sent(),[3,4];case 3:return this.returnWorkerToQueue(t),[7];case 4:return[2]}}))}))},t.prototype.returnWorkerToQueue=function(t){this.isDestroyed||!this.reuseWorkers||this.count>this.getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this.startQueuedJob()},t.prototype.getAvailableWorker=function(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this.getMaxConcurrency()){this.count++;var t=this.name.toLowerCase()+" (#"+this.count+" of "+this.maxConcurrency+")";return new qo({name:t,source:this.source,url:this.url})}return null},t.prototype.getMaxConcurrency=function(){return Fo?this.maxMobileConcurrency:this.maxConcurrency},t}(),Qo=self&&self.__assign||function(){return(Qo=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},Xo=self&&self.__values||function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jo={maxConcurrency:3,maxMobileConcurrency:1,onDebug:function(){},reuseWorkers:!0},ti=(function(){function t(t){this.workerPools=new Map,this.props=Qo({},Jo),this.setProps(t),this.workerPools=new Map}t.isSupported=function(){return qo.isSupported()},t.getWorkerFarm=function(e){return void 0===e&&(e={}),t.workerFarm=t.workerFarm||new t({}),t.workerFarm.setProps(e),t.workerFarm},t.prototype.destroy=function(){var t,e;try{for(var r=Xo(this.workerPools.values()),n=r.next();!n.done;n=r.next()){n.value.destroy()}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},t.prototype.setProps=function(t){var e,r;this.props=Qo(Qo({},this.props),t);try{for(var n=Xo(this.workerPools.values()),o=n.next();!o.done;o=n.next()){o.value.setProps(this.getWorkerPoolProps())}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}},t.prototype.getWorkerPool=function(t){var e=t.name,r=t.source,n=t.url,o=this.workerPools.get(e);return o||((o=new Ko({name:e,source:r,url:n})).setProps(this.getWorkerPoolProps()),this.workerPools.set(e,o)),o},t.prototype.getWorkerPoolProps=function(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(),new Map),ei=function(){function t(){}return Object.defineProperty(t,"onmessage",{set:function(t){self.onmessage=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}},enumerable:!1,configurable:!0}),t.addEventListener=function(t){var e=ti.get(t);e||(e=function(e){if(ri(e)){var r=e.data,n=r.type,o=r.payload;t(n,o)}}),self.addEventListener("message",e)},t.removeEventListener=function(t){var e=ti.get(t);ti.delete(t),self.removeEventListener("message",e)},t.postMessage=function(t,e){if(self){var r={source:"Worker thread",type:t,payload:e},n=Go(e);self.postMessage(r,n)}},t}();function ri(t){var e=t.type,r=t.data;return"message"===e&&r&&"string"==typeof r.source&&"Main thread"===r.source}self&&self.__awaiter,self&&self.__generator;var ni,oi,ii=function(){function t(){this._values=[],this._settlers=[],this._closed=!1}return t.prototype[Symbol.asyncIterator]=function(){return this},t.prototype.push=function(t){return this.enqueue(t)},t.prototype.enqueue=function(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");var e=this._settlers.shift();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.push(t)},t.prototype.close=function(){for(;this._settlers.length>0;){this._settlers.shift().resolve({done:!0})}this._closed=!0},t.prototype.next=function(){var t=this;if(this._values.length>0){var e=this._values.shift();return e instanceof Error?Promise.reject(e):Promise.resolve({done:!1,value:e})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0,value:void 0})}return new Promise((function(e,r){t._settlers.push({resolve:e,reject:r})}))},t}(),ai=self&&self.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,u)}s((n=n.apply(t,e||[])).next())}))},ui=self&&self.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},si=self&&self.__asyncValues||function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},ci=0;function fi(t,e){var r=this;if("undefined"!=typeof self){var n={process:li};ei.onmessage=function(o,i){return ai(r,void 0,void 0,(function(){var r,a,u,s,c,f,l,h,p,v;return ui(this,(function(d){switch(d.label){case 0:switch(d.trys.push([0,19,,20]),o){case"process":return[3,1];case"process-in-batches":return[3,3];case"input-batch":return[3,16];case"input-done":return[3,17]}return[3,18];case 1:if(!t)throw new Error("Worker does not support atomic processing");return[4,t(i.input,i.options||{},n)];case 2:return r=d.sent(),ei.postMessage("done",{result:r}),[3,18];case 3:if(!e)throw new Error("Worker does not support batched processing");ni=new ii,oi=i.options||{},a=e(ni,oi,n),d.label=4;case 4:d.trys.push([4,9,10,15]),u=si(a),d.label=5;case 5:return[4,u.next()];case 6:if((s=d.sent()).done)return[3,8];c=s.value,ei.postMessage("output-batch",{result:c}),d.label=7;case 7:return[3,5];case 8:return[3,15];case 9:return f=d.sent(),p={error:f},[3,15];case 10:return d.trys.push([10,,13,14]),s&&!s.done&&(v=u.return)?[4,v.call(u)]:[3,12];case 11:d.sent(),d.label=12;case 12:return[3,14];case 13:if(p)throw p.error;return[7];case 14:return[7];case 15:return ei.postMessage("done",{}),[3,18];case 16:return ni.push(i.input),[3,18];case 17:return ni.close(),[3,18];case 18:return[3,20];case 19:return l=d.sent(),h=l instanceof Error?l.message:"",ei.postMessage("error",{error:h}),[3,20];case 20:return[2]}}))}))}}}function li(t,e){return void 0===e&&(e={}),new Promise((function(r,n){var o=ci++,i=function(t,e){if(e.id===o)switch(t){case"done":ei.removeEventListener(i),r(e.result);break;case"error":ei.removeEventListener(i),n(e.error)}};ei.addEventListener(i);var a={id:o,input:t,options:e};ei.postMessage("process",a)}))}self&&self.__awaiter,self&&self.__generator;var hi={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},pi=mt("span").classList,vi=pi&&pi.constructor&&pi.constructor.prototype,di=vi===Object.prototype?void 0:vi,yi=Array.isArray||function(t){return"Array"==ve(t)},gi=ft("species"),mi=Array,xi=function(t,e){return new(function(t){var e;return yi(t)&&(e=t.constructor,(jr(e)&&(e===mi||yi(e.prototype))||dt(e)&&null===(e=e[gi]))&&(e=void 0)),void 0===e?mi:e}(t))(0===e?0:e)},bi=R([].push),wi=function(t){var e=1==t,r=2==t,n=3==t,o=4==t,i=6==t,a=7==t,u=5==t||i;return function(s,c,f,l){for(var h,p,v=W(s),d=Se(v),y=zr(c,f),g=Fe(d),m=0,x=l||xi,b=e?x(s,g):r||a?x(s,0):void 0;g>m;m++)if((u||m in d)&&(p=y(h=d[m],m,v),t))if(e)b[m]=p;else if(p)switch(t){case 3:return!0;case 5:return h;case 6:return m;case 2:bi(b,h)}else switch(t){case 4:return!1;case 7:bi(b,h)}return i?-1:n||o?o:b}},Ei={forEach:wi(0),map:wi(1),filter:wi(2),some:wi(3),every:wi(4),find:wi(5),findIndex:wi(6),filterReject:wi(7)},Ai=function(t,e){var r=[][t];return!!r&&j((function(){r.call(null,e||function(){return 1},1)}))},Oi=Ei.forEach,Si=Ai("forEach")?[].forEach:function(t){return Oi(this,t,arguments.length>1?arguments[1]:void 0)},Ti=function(t){if(t&&t.forEach!==Si)try{ee(t,"forEach",Si)}catch(e){t.forEach=Si}};for(var ki in hi)hi[ki]&&Ti(O[ki]&&O[ki].prototype);Ti(di);var Ii=function(t,e,r){var n=Ft(e);n in t?Ut.f(t,n,te(0,r)):t[n]=r},ji=ft("species"),Pi=function(t){return nt>=51||!j((function(){var e=[];return(e.constructor={})[ji]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},_i=Pi("slice"),Mi=ft("species"),Li=Array,Ri=Math.max;ir({target:"Array",proto:!0,forced:!_i},{slice:function(t,e){var r,n,o,i=Te(this),a=Fe(i),u=Ce(t,a),s=Ce(void 0===e?a:e,a);if(yi(i)&&(r=i.constructor,(jr(r)&&(r===Li||yi(r.prototype))||dt(r)&&null===(r=r[Mi]))&&(r=void 0),r===Li||void 0===r))return Ur(i,u,s);for(n=new(void 0===r?Li:r)(Ri(s-u,0)),o=0;u<s;u++,o++)u in i&&Ii(n,o,i[u]);return n.length=o,n}});var Ci=qt.EXISTS,Ni=Ut.f,Di=Function.prototype,Fi=R(Di.toString),Wi=/function\\b(?:\\s|\\/\\*[\\S\\s]*?\\*\\/|\\/\\/[^\\n\\r]*[\\n\\r]+)*([^\\s(/]*)/,zi=R(Wi.exec);pt&&!Ci&&Ni(Di,"name",{configurable:!0,get:function(){try{return zi(Wi,Fi(this))[1]}catch(t){return""}}});var Bi=Ei.map,Ui=Pi("map");ir({target:"Array",proto:!0,forced:!Ui},{map:function(t){return Bi(this,t,arguments.length>1?arguments[1]:void 0)}});var Gi,Hi=Object.keys||function(t){return Ge(t,He)},Vi={f:pt&&!bt?Object.defineProperties:function(t,e){At(t);for(var r,n=Te(e),o=Hi(e),i=o.length,a=0;i>a;)Ut.f(t,r=o[a++],n[r]);return t}},qi=ne("IE_PROTO"),Zi=function(){},Yi=function(t){return"<script>"+t+"<\\/script>"},$i=function(t){t.write(Yi("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ki=function(){try{Gi=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ki="undefined"!=typeof document?document.domain&&Gi?$i(Gi):((e=mt("iframe")).style.display="none",Br.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Yi("document.F=Object")),t.close(),t.F):$i(Gi);for(var r=He.length;r--;)delete Ki.prototype[He[r]];return Ki()};oe[qi]=!0;var Qi=Object.create||function(t,e){var r;return null!==t?(Zi.prototype=At(t),r=new Zi,Zi.prototype=null,r[qi]=t):r=Ki(),void 0===e?r:Vi.f(r,e)},Xi=Ut.f,Ji=ft("unscopables"),ta=Array.prototype;null==ta[Ji]&&Xi(ta,Ji,{configurable:!0,value:Qi(null)});var ea,ra,na,oa=function(t){ta[Ji][t]=!0},ia=!j((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=ne("IE_PROTO"),ua=Object,sa=ua.prototype,ca=ia?ua.getPrototypeOf:function(t){var e=W(t);if(B(e,aa))return e[aa];var r=e.constructor;return $(r)&&e instanceof r?r.prototype:e instanceof ua?sa:null},fa=ft("iterator"),la=!1;[].keys&&("next"in(na=[].keys())?(ra=ca(ca(na)))!==Object.prototype&&(ea=ra):la=!0),(!dt(ea)||j((function(){var t={};return ea[fa].call(t)!==t})))&&(ea={}),$(ea[fa])||le(ea,fa,(function(){return this}));var ha={IteratorPrototype:ea,BUGGY_SAFARI_ITERATORS:la},pa=ha.IteratorPrototype,va=function(){return this},da=qt.PROPER,ya=qt.CONFIGURABLE,ga=ha.IteratorPrototype,ma=ha.BUGGY_SAFARI_ITERATORS,xa=ft("iterator"),ba=function(){return this},wa=function(t,e,r,n,o,i,a){!function(t,e,r,n){var o=e+" Iterator";t.prototype=Qi(pa,{next:te(+!n,r)}),hr(t,o,!1),po[o]=va}(r,e,n);var u,s,c,f=function(t){if(t===o&&d)return d;if(!ma&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},l=e+" Iterator",h=!1,p=t.prototype,v=p[xa]||p["@@iterator"]||o&&p[o],d=!ma&&v||f(o),y="Array"==e&&p.entries||v;if(y&&(u=ca(y.call(new t)))!==Object.prototype&&u.next&&(ca(u)!==ga&&(cr?cr(u,ga):$(u[xa])||le(u,xa,ba)),hr(u,l,!0)),da&&"values"==o&&v&&"values"!==v.name&&(ya?ee(p,"name","values"):(h=!0,d=function(){return St(v,this)})),o)if(s={values:f("values"),keys:i?d:f("keys"),entries:f("entries")},a)for(c in s)(ma||h||!(c in p))&&le(p,c,s[c]);else ir({target:e,proto:!0,forced:ma||h},s);return p[xa]!==d&&le(p,xa,d,{name:o}),po[e]=d,s},Ea=function(t,e){return{value:t,done:e}},Aa=Ut.f,Oa=ce.set,Sa=ce.getterFor("Array Iterator"),Ta=wa(Array,"Array",(function(t,e){Oa(this,{type:"Array Iterator",target:Te(t),index:0,kind:e})}),(function(){var t=Sa(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,Ea(void 0,!0)):Ea("keys"==r?n:"values"==r?e[n]:[n,e[n]],!1)}),"values"),ka=po.Arguments=po.Array;if(oa("keys"),oa("values"),oa("entries"),pt&&"values"!==ka.name)try{Aa(ka,"name",{value:"values"})}catch(t){}var Ia,ja,Pa,_a="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,Ma=Ut.f,La=ce.enforce,Ra=ce.get,Ca=O.Int8Array,Na=Ca&&Ca.prototype,Da=O.Uint8ClampedArray,Fa=Da&&Da.prototype,Wa=Ca&&ca(Ca),za=Na&&ca(Na),Ba=Object.prototype,Ua=O.TypeError,Ga=ft("toStringTag"),Ha=V("TYPED_ARRAY_TAG"),Va=_a&&!!cr&&"Opera"!==me(O.opera),qa=!1,Za={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Ya={BigInt64Array:8,BigUint64Array:8},$a=function(t){var e=ca(t);if(dt(e)){var r=Ra(e);return r&&B(r,"TypedArrayConstructor")?r.TypedArrayConstructor:$a(e)}},Ka=function(t){if(!dt(t))return!1;var e=me(t);return B(Za,e)||B(Ya,e)};for(Ia in Za)(Pa=(ja=O[Ia])&&ja.prototype)?La(Pa).TypedArrayConstructor=ja:Va=!1;for(Ia in Ya)(Pa=(ja=O[Ia])&&ja.prototype)&&(La(Pa).TypedArrayConstructor=ja);if((!Va||!$(Wa)||Wa===Function.prototype)&&(Wa=function(){throw Ua("Incorrect invocation")},Va))for(Ia in Za)O[Ia]&&cr(O[Ia],Wa);if((!Va||!za||za===Ba)&&(za=Wa.prototype,Va))for(Ia in Za)O[Ia]&&cr(O[Ia].prototype,za);if(Va&&ca(Fa)!==za&&cr(Fa,za),pt&&!B(za,Ga))for(Ia in qa=!0,Ma(za,Ga,{get:function(){return dt(this)?this[Ha]:void 0}}),Za)O[Ia]&&ee(O[Ia],Ha,Ia);var Qa={NATIVE_ARRAY_BUFFER_VIEWS:Va,TYPED_ARRAY_TAG:qa&&Ha,aTypedArray:function(t){if(Ka(t))return t;throw Ua("Target is not a typed array")},aTypedArrayConstructor:function(t){if($(t)&&(!cr||Tt(Wa,t)))return t;throw Ua(Pt(t)+" is not a typed array constructor")},exportTypedArrayMethod:function(t,e,r,n){if(pt){if(r)for(var o in Za){var i=O[o];if(i&&B(i.prototype,t))try{delete i.prototype[t]}catch(r){try{i.prototype[t]=e}catch(t){}}}za[t]&&!r||le(za,t,r?e:Va&&Na[t]||e,n)}},exportTypedArrayStaticMethod:function(t,e,r){var n,o;if(pt){if(cr){if(r)for(n in Za)if((o=O[n])&&B(o,t))try{delete o[t]}catch(t){}if(Wa[t]&&!r)return;try{return le(Wa,t,r?e:Va&&Wa[t]||e)}catch(t){}}for(n in Za)!(o=O[n])||o[t]&&!r||le(o,t,e)}},getTypedArrayConstructor:$a,isView:function(t){if(!dt(t))return!1;var e=me(t);return"DataView"===e||B(Za,e)||B(Ya,e)},isTypedArray:Ka,TypedArray:Wa,TypedArrayPrototype:za},Xa=Qa.NATIVE_ARRAY_BUFFER_VIEWS,Ja=O.ArrayBuffer,tu=O.Int8Array,eu=!Xa||!j((function(){tu(1)}))||!j((function(){new tu(-1)}))||!_o((function(t){new tu,new tu(null),new tu(1.5),new tu(t)}),!0)||j((function(){return 1!==new tu(new Ja(2),1,void 0).length})),ru=function(t,e,r){for(var n in e)le(t,n,e[n],r);return t},nu=RangeError,ou=function(t){if(void 0===t)return 0;var e=Me(t),r=De(e);if(e!==r)throw nu("Wrong length or index");return r},iu=Array,au=Math.abs,uu=Math.pow,su=Math.floor,cu=Math.log,fu=Math.LN2,lu=function(t,e,r){var n,o,i,a=iu(r),u=8*r-e-1,s=(1<<u)-1,c=s>>1,f=23===e?uu(2,-24)-uu(2,-77):0,l=t<0||0===t&&1/t<0?1:0,h=0;for((t=au(t))!=t||t===1/0?(o=t!=t?1:0,n=s):(n=su(cu(t)/fu),t*(i=uu(2,-n))<1&&(n--,i*=2),(t+=n+c>=1?f/i:f*uu(2,1-c))*i>=2&&(n++,i/=2),n+c>=s?(o=0,n=s):n+c>=1?(o=(t*i-1)*uu(2,e),n+=c):(o=t*uu(2,c-1)*uu(2,e),n=0));e>=8;)a[h++]=255&o,o/=256,e-=8;for(n=n<<e|o,u+=e;u>0;)a[h++]=255&n,n/=256,u-=8;return a[--h]|=128*l,a},hu=function(t,e){var r,n=t.length,o=8*n-e-1,i=(1<<o)-1,a=i>>1,u=o-7,s=n-1,c=t[s--],f=127&c;for(c>>=7;u>0;)f=256*f+t[s--],u-=8;for(r=f&(1<<-u)-1,f>>=-u,u+=e;u>0;)r=256*r+t[s--],u-=8;if(0===f)f=1-a;else{if(f===i)return r?NaN:c?-1/0:1/0;r+=uu(2,e),f-=a}return(c?-1:1)*r*uu(2,f-e)},pu=function(t){for(var e=W(this),r=Fe(e),n=arguments.length,o=Ce(n>1?arguments[1]:void 0,r),i=n>2?arguments[2]:void 0,a=void 0===i?r:Ce(i,r);a>o;)e[o++]=t;return e},vu=Array,du=Math.max,yu=function(t,e,r){for(var n=Fe(t),o=Ce(e,n),i=Ce(void 0===r?n:r,n),a=vu(du(i-o,0)),u=0;o<i;o++,u++)Ii(a,u,t[o]);return a.length=u,a},gu=qe.f,mu=Ut.f,xu=qt.PROPER,bu=qt.CONFIGURABLE,wu=ce.get,Eu=ce.set,Au=O.ArrayBuffer,Ou=Au,Su=Ou&&Ou.prototype,Tu=O.DataView,ku=Tu&&Tu.prototype,Iu=Object.prototype,ju=O.Array,Pu=O.RangeError,_u=R(pu),Mu=R([].reverse),Lu=lu,Ru=hu,Cu=function(t){return[255&t]},Nu=function(t){return[255&t,t>>8&255]},Du=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},Fu=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},Wu=function(t){return Lu(t,23,4)},zu=function(t){return Lu(t,52,8)},Bu=function(t,e){mu(t.prototype,e,{get:function(){return wu(this)[e]}})},Uu=function(t,e,r,n){var o=ou(r),i=wu(t);if(o+e>i.byteLength)throw Pu("Wrong index");var a=wu(i.buffer).bytes,u=o+i.byteOffset,s=yu(a,u,u+e);return n?s:Mu(s)},Gu=function(t,e,r,n,o,i){var a=ou(r),u=wu(t);if(a+e>u.byteLength)throw Pu("Wrong index");for(var s=wu(u.buffer).bytes,c=a+u.byteOffset,f=n(+o),l=0;l<e;l++)s[c+l]=f[i?l:e-l-1]};if(_a){var Hu=xu&&"ArrayBuffer"!==Au.name;if(j((function(){Au(1)}))&&j((function(){new Au(-1)}))&&!j((function(){return new Au,new Au(1.5),new Au(NaN),1!=Au.length||Hu&&!bu})))Hu&&bu&&ee(Au,"name","ArrayBuffer");else{(Ou=function(t){return yr(this,Su),new Au(ou(t))}).prototype=Su;for(var Vu,qu=gu(Au),Zu=0;qu.length>Zu;)(Vu=qu[Zu++])in Ou||ee(Ou,Vu,Au[Vu]);Su.constructor=Ou}cr&&ca(ku)!==Iu&&cr(ku,Iu);var Yu=new Tu(new Ou(2)),$u=R(ku.setInt8);Yu.setInt8(0,2147483648),Yu.setInt8(1,2147483649),!Yu.getInt8(0)&&Yu.getInt8(1)||ru(ku,{setInt8:function(t,e){$u(this,t,e<<24>>24)},setUint8:function(t,e){$u(this,t,e<<24>>24)}},{unsafe:!0})}else Su=(Ou=function(t){yr(this,Su);var e=ou(t);Eu(this,{bytes:_u(ju(e),0),byteLength:e}),pt||(this.byteLength=e)}).prototype,ku=(Tu=function(t,e,r){yr(this,ku),yr(t,Su);var n=wu(t).byteLength,o=Me(e);if(o<0||o>n)throw Pu("Wrong offset");if(o+(r=void 0===r?n-o:De(r))>n)throw Pu("Wrong length");Eu(this,{buffer:t,byteLength:r,byteOffset:o}),pt||(this.buffer=t,this.byteLength=r,this.byteOffset=o)}).prototype,pt&&(Bu(Ou,"byteLength"),Bu(Tu,"buffer"),Bu(Tu,"byteLength"),Bu(Tu,"byteOffset")),ru(ku,{getInt8:function(t){return Uu(this,1,t)[0]<<24>>24},getUint8:function(t){return Uu(this,1,t)[0]},getInt16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=Uu(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Fu(Uu(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return Ru(Uu(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return Ru(Uu(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){Gu(this,1,t,Cu,e)},setUint8:function(t,e){Gu(this,1,t,Cu,e)},setInt16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){Gu(this,2,t,Nu,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){Gu(this,4,t,Du,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){Gu(this,4,t,Wu,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){Gu(this,8,t,zu,e,arguments.length>2?arguments[2]:void 0)}});hr(Ou,"ArrayBuffer"),hr(Tu,"DataView");var Ku={ArrayBuffer:Ou,DataView:Tu},Qu=Math.floor,Xu=Number.isInteger||function(t){return!dt(t)&&isFinite(t)&&Qu(t)===t},Ju=RangeError,ts=RangeError,es=function(t,e){var r=function(t){var e=Me(t);if(e<0)throw Ju("The argument can't be less than 0");return e}(t);if(r%e)throw ts("Wrong offset");return r},rs=R("".slice),ns=function(t){return"Big"===rs(me(t),0,3)},os=TypeError,is=function(t){var e=Dt(t,"number");if("number"==typeof e)throw os("Can't convert number to bigint");return BigInt(e)},as=Qa.aTypedArrayConstructor,us=function(t){var e,r,n,o,i,a,u,s,c=_r(this),f=W(t),l=arguments.length,h=l>1?arguments[1]:void 0,p=void 0!==h,v=xo(f);if(v&&!go(v))for(s=(u=wo(f,v)).next,f=[];!(a=St(s,u)).done;)f.push(a.value);for(p&&l>2&&(h=zr(h,arguments[2])),r=Fe(f),n=new(as(c))(r),o=ns(n),e=0;r>e;e++)i=p?h(f[e],e):f[e],n[e]=o?is(i):+i;return n},ss=function(t,e,r){var n,o;return cr&&$(n=e.constructor)&&n!==r&&dt(o=n.prototype)&&o!==r.prototype&&cr(t,o),t},cs=b((function(t){var e=qe.f,r=Ei.forEach,n=ce.get,o=ce.set,i=ce.enforce,a=Ut.f,u=Ie.f,s=Math.round,c=O.RangeError,f=Ku.ArrayBuffer,l=f.prototype,h=Ku.DataView,p=Qa.NATIVE_ARRAY_BUFFER_VIEWS,v=Qa.TYPED_ARRAY_TAG,d=Qa.TypedArray,y=Qa.TypedArrayPrototype,g=Qa.aTypedArrayConstructor,m=Qa.isTypedArray,x=function(t,e){g(t);for(var r=0,n=e.length,o=new t(n);n>r;)o[r]=e[r++];return o},b=function(t,e){a(t,e,{get:function(){return n(this)[e]}})},w=function(t){var e;return Tt(l,t)||"ArrayBuffer"==(e=me(t))||"SharedArrayBuffer"==e},E=function(t,e){return m(t)&&!It(e)&&e in t&&Xu(+e)&&e>=0},A=function(t,e){return e=Ft(e),E(t,e)?te(2,t[e]):u(t,e)},S=function(t,e,r){return e=Ft(e),!(E(t,e)&&dt(r)&&B(r,"value"))||B(r,"get")||B(r,"set")||r.configurable||B(r,"writable")&&!r.writable||B(r,"enumerable")&&!r.enumerable?a(t,e,r):(t[e]=r.value,t)};pt?(p||(Ie.f=A,Ut.f=S,b(y,"buffer"),b(y,"byteOffset"),b(y,"byteLength"),b(y,"length")),ir({target:"Object",stat:!0,forced:!p},{getOwnPropertyDescriptor:A,defineProperty:S}),t.exports=function(t,u,l){var g=t.match(/\\d+$/)[0]/8,b=t+(l?"Clamped":"")+"Array",E="get"+t,A="set"+t,S=O[b],T=S,k=T&&T.prototype,I={},j=function(t,e){a(t,e,{get:function(){return function(t,e){var r=n(t);return r.view[E](e*g+r.byteOffset,!0)}(this,e)},set:function(t){return function(t,e,r){var o=n(t);l&&(r=(r=s(r))<0?0:r>255?255:255&r),o.view[A](e*g+o.byteOffset,r,!0)}(this,e,t)},enumerable:!0})};p?eu&&(T=u((function(t,e,r,n){return yr(t,k),ss(dt(e)?w(e)?void 0!==n?new S(e,es(r,g),n):void 0!==r?new S(e,es(r,g)):new S(e):m(e)?x(T,e):St(us,T,e):new S(ou(e)),t,T)})),cr&&cr(T,d),r(e(S),(function(t){t in T||ee(T,t,S[t])})),T.prototype=k):(T=u((function(t,e,r,n){yr(t,k);var i,a,u,s=0,l=0;if(dt(e)){if(!w(e))return m(e)?x(T,e):St(us,T,e);i=e,l=es(r,g);var p=e.byteLength;if(void 0===n){if(p%g)throw c("Wrong length");if((a=p-l)<0)throw c("Wrong length")}else if((a=De(n)*g)+l>p)throw c("Wrong length");u=a/g}else u=ou(e),i=new f(a=u*g);for(o(t,{buffer:i,byteOffset:l,byteLength:a,length:u,view:new h(i)});s<u;)j(t,s++)})),cr&&cr(T,d),k=T.prototype=Qi(y)),k.constructor!==T&&ee(k,"constructor",T),i(k).TypedArrayConstructor=T,v&&ee(k,v,b);var P=T!=S;I[b]=T,ir({global:!0,constructor:!0,forced:P,sham:!p},I),"BYTES_PER_ELEMENT"in T||ee(T,"BYTES_PER_ELEMENT",g),"BYTES_PER_ELEMENT"in k||ee(k,"BYTES_PER_ELEMENT",g),vr(b)}):t.exports=function(){}}));cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}),!0);var fs=TypeError,ls=function(t,e){if(!delete t[e])throw fs("Cannot delete property "+Pt(e)+" of "+Pt(t))},hs=Math.min,ps=R([].copyWithin||function(t,e){var r=W(this),n=Fe(r),o=Ce(t,n),i=Ce(e,n),a=arguments.length>2?arguments[2]:void 0,u=hs((void 0===a?n:Ce(a,n))-i,n-o),s=1;for(i<o&&o<i+u&&(s=-1,i+=u-1,o+=u-1);u-- >0;)i in r?r[o]=r[i]:ls(r,o),o+=s,i+=s;return r}),vs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("copyWithin",(function(t,e){return ps(vs(this),t,e,arguments.length>2?arguments[2]:void 0)}));var ds=Ei.every,ys=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("every",(function(t){return ds(ys(this),t,arguments.length>1?arguments[1]:void 0)}));var gs=Qa.aTypedArray,ms=Qa.exportTypedArrayMethod,xs=R("".slice);ms("fill",(function(t){var e=arguments.length;gs(this);var r="Big"===xs(me(this),0,3)?is(t):+t;return St(pu,this,r,e>1?arguments[1]:void 0,e>2?arguments[2]:void 0)}),j((function(){var t=0;return new Int8Array(2).fill({valueOf:function(){return t++}}),1!==t})));var bs=Qa.aTypedArrayConstructor,ws=Qa.getTypedArrayConstructor,Es=function(t){return bs(Lr(t,ws(t)))},As=function(t,e){return function(t,e){for(var r=0,n=Fe(e),o=new t(n);n>r;)o[r]=e[r++];return o}(Es(t),e)},Os=Ei.filter,Ss=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("filter",(function(t){var e=Os(Ss(this),t,arguments.length>1?arguments[1]:void 0);return As(this,e)}));var Ts=Ei.find,ks=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("find",(function(t){return Ts(ks(this),t,arguments.length>1?arguments[1]:void 0)}));var Is=Ei.findIndex,js=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("findIndex",(function(t){return Is(js(this),t,arguments.length>1?arguments[1]:void 0)}));var Ps=Ei.forEach,_s=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("forEach",(function(t){Ps(_s(this),t,arguments.length>1?arguments[1]:void 0)}));var Ms=ze.includes,Ls=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("includes",(function(t){return Ms(Ls(this),t,arguments.length>1?arguments[1]:void 0)}));var Rs=ze.indexOf,Cs=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("indexOf",(function(t){return Rs(Cs(this),t,arguments.length>1?arguments[1]:void 0)}));var Ns=ft("iterator"),Ds=O.Uint8Array,Fs=R(Ta.values),Ws=R(Ta.keys),zs=R(Ta.entries),Bs=Qa.aTypedArray,Us=Qa.exportTypedArrayMethod,Gs=Ds&&Ds.prototype,Hs=!j((function(){Gs[Ns].call([1])})),Vs=!!Gs&&Gs.values&&Gs[Ns]===Gs.values&&"values"===Gs.values.name,qs=function(){return Fs(Bs(this))};Us("entries",(function(){return zs(Bs(this))}),Hs),Us("keys",(function(){return Ws(Bs(this))}),Hs),Us("values",qs,Hs||!Vs,{name:"values"}),Us(Ns,qs,Hs||!Vs,{name:"values"});var Zs=Qa.aTypedArray,Ys=Qa.exportTypedArrayMethod,$s=R([].join);Ys("join",(function(t){return $s(Zs(this),t)}));var Ks=Math.min,Qs=[].lastIndexOf,Xs=!!Qs&&1/[1].lastIndexOf(1,-0)<0,Js=Ai("lastIndexOf"),tc=Xs||!Js?function(t){if(Xs)return Dr(Qs,this,arguments)||0;var e=Te(this),r=Fe(e),n=r-1;for(arguments.length>1&&(n=Ks(n,Me(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Qs,ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("lastIndexOf",(function(t){var e=arguments.length;return Dr(tc,ec(this),e>1?[t,arguments[1]]:[t])}));var rc=Ei.map,nc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("map",(function(t){return rc(nc(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(Es(t))(e)}))}));var oc=TypeError,ic=function(t){return function(e,r,n,o){Mt(r);var i=W(e),a=Se(i),u=Fe(i),s=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(s in a){o=a[s],s+=c;break}if(s+=c,t?s<0:u<=s)throw oc("Reduce of empty array with no initial value")}for(;t?s>=0:u>s;s+=c)s in a&&(o=r(o,a[s],s,i));return o}},ac={left:ic(!1),right:ic(!0)},uc=ac.left,sc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduce",(function(t){var e=arguments.length;return uc(sc(this),t,e,e>1?arguments[1]:void 0)}));var cc=ac.right,fc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("reduceRight",(function(t){var e=arguments.length;return cc(fc(this),t,e,e>1?arguments[1]:void 0)}));var lc=Qa.aTypedArray,hc=Qa.exportTypedArrayMethod,pc=Math.floor;hc("reverse",(function(){for(var t,e=lc(this).length,r=pc(e/2),n=0;n<r;)t=this[n],this[n++]=this[--e],this[e]=t;return this}));var vc=O.RangeError,dc=O.Int8Array,yc=dc&&dc.prototype,gc=yc&&yc.set,mc=Qa.aTypedArray,xc=Qa.exportTypedArrayMethod,bc=!j((function(){var t=new Uint8ClampedArray(2);return St(gc,t,{length:1,0:3},1),3!==t[1]})),wc=bc&&Qa.NATIVE_ARRAY_BUFFER_VIEWS&&j((function(){var t=new dc(2);return t.set(1),t.set("2",1),0!==t[0]||2!==t[1]}));xc("set",(function(t){mc(this);var e=es(arguments.length>1?arguments[1]:void 0,1),r=W(t);if(bc)return St(gc,this,r,e);var n=this.length,o=Fe(r),i=0;if(o+e>n)throw vc("Wrong length");for(;i<o;)this[e+i]=r[i++]}),!bc||wc);var Ec=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("slice",(function(t,e){for(var r=Ur(Ec(this),t,e),n=Es(this),o=0,i=r.length,a=new n(i);i>o;)a[o]=r[o++];return a}),j((function(){new Int8Array(1).slice()})));var Ac=Ei.some,Oc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("some",(function(t){return Ac(Oc(this),t,arguments.length>1?arguments[1]:void 0)}));var Sc=Math.floor,Tc=function(t,e){var r=t.length,n=Sc(r/2);return r<8?kc(t,e):Ic(t,Tc(yu(t,0,n),e),Tc(yu(t,n),e),e)},kc=function(t,e){for(var r,n,o=t.length,i=1;i<o;){for(n=i,r=t[i];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==i++&&(t[n]=r)}return t},Ic=function(t,e,r,n){for(var o=e.length,i=r.length,a=0,u=0;a<o||u<i;)t[a+u]=a<o&&u<i?n(e[a],r[u])<=0?e[a++]:r[u++]:a<o?e[a++]:r[u++];return t},jc=Tc,Pc=X.match(/firefox\\/(\\d+)/i),_c=!!Pc&&+Pc[1],Mc=/MSIE|Trident/.test(X),Lc=X.match(/AppleWebKit\\/(\\d+)\\./),Rc=!!Lc&&+Lc[1],Cc=Qa.aTypedArray,Nc=Qa.exportTypedArrayMethod,Dc=O.Uint16Array,Fc=Dc&&Fr(Dc.prototype.sort),Wc=!(!Fc||j((function(){Fc(new Dc(2),null)}))&&j((function(){Fc(new Dc(2),{})}))),zc=!!Fc&&!j((function(){if(nt)return nt<74;if(_c)return _c<67;if(Mc)return!0;if(Rc)return Rc<602;var t,e,r=new Dc(516),n=Array(516);for(t=0;t<516;t++)e=t%4,r[t]=515-t,n[t]=t-2*e+3;for(Fc(r,(function(t,e){return(t/4|0)-(e/4|0)})),t=0;t<516;t++)if(r[t]!==n[t])return!0}));Nc("sort",(function(t){return void 0!==t&&Mt(t),zc?Fc(this,t):jc(Cc(this),function(t){return function(e,r){return void 0!==t?+t(e,r)||0:r!=r?-1:e!=e?1:0===e&&0===r?1/e>0&&1/r<0?1:-1:e>r}}(t))}),!zc||Wc);var Bc=Qa.aTypedArray;(0,Qa.exportTypedArrayMethod)("subarray",(function(t,e){var r=Bc(this),n=r.length,o=Ce(t,n);return new(Es(r))(r.buffer,r.byteOffset+o*r.BYTES_PER_ELEMENT,De((void 0===e?n:Ce(e,n))-o))}));var Uc=O.Int8Array,Gc=Qa.aTypedArray,Hc=Qa.exportTypedArrayMethod,Vc=[].toLocaleString,qc=!!Uc&&j((function(){Vc.call(new Uc(1))}));Hc("toLocaleString",(function(){return Dr(Vc,qc?Ur(Gc(this)):Gc(this),Ur(arguments))}),j((function(){return[1,2].toLocaleString()!=new Uc([1,2]).toLocaleString()}))||!j((function(){Uc.prototype.toLocaleString.call([1,2])})));var Zc=Qa.exportTypedArrayMethod,Yc=O.Uint8Array,$c=Yc&&Yc.prototype||{},Kc=[].toString,Qc=R([].join);j((function(){Kc.call({})}))&&(Kc=function(){return Qc(this)});var Xc=$c.toString!=Kc;Zc("toString",Kc,Xc);var Jc,tf,ef=String,rf=function(t){if("Symbol"===me(t))throw TypeError("Cannot convert a Symbol value to a string");return ef(t)},nf=function(){var t=At(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},of=O.RegExp,af=j((function(){var t=of("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),uf=af||j((function(){return!of("a","y").sticky})),sf={BROKEN_CARET:af||j((function(){var t=of("^r","gy");return t.lastIndex=2,null!=t.exec("str")})),MISSED_STICKY:uf,UNSUPPORTED_Y:af},cf=O.RegExp,ff=j((function(){var t=cf(".","s");return!(t.dotAll&&t.exec("\\n")&&"s"===t.flags)})),lf=O.RegExp,hf=j((function(){var t=lf("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})),pf=ce.get,vf=I("native-string-replace",String.prototype.replace),df=RegExp.prototype.exec,yf=df,gf=R("".charAt),mf=R("".indexOf),xf=R("".replace),bf=R("".slice),wf=(tf=/b*/g,St(df,Jc=/a/,"a"),St(df,tf,"a"),0!==Jc.lastIndex||0!==tf.lastIndex),Ef=sf.BROKEN_CARET,Af=void 0!==/()??/.exec("")[1];(wf||Af||Ef||ff||hf)&&(yf=function(t){var e,r,n,o,i,a,u,s=this,c=pf(s),f=rf(t),l=c.raw;if(l)return l.lastIndex=s.lastIndex,e=St(yf,l,f),s.lastIndex=l.lastIndex,e;var h=c.groups,p=Ef&&s.sticky,v=St(nf,s),d=s.source,y=0,g=f;if(p&&(v=xf(v,"y",""),-1===mf(v,"g")&&(v+="g"),g=bf(f,s.lastIndex),s.lastIndex>0&&(!s.multiline||s.multiline&&"\\n"!==gf(f,s.lastIndex-1))&&(d="(?: "+d+")",g=" "+g,y++),r=new RegExp("^(?:"+d+")",v)),Af&&(r=new RegExp("^"+d+"$(?!\\\\s)",v)),wf&&(n=s.lastIndex),o=St(df,p?r:s,g),p?o?(o.input=bf(o.input,y),o[0]=bf(o[0],y),o.index=s.lastIndex,s.lastIndex+=o[0].length):s.lastIndex=0:wf&&o&&(s.lastIndex=s.global?o.index+o[0].length:n),Af&&o&&o.length>1&&St(vf,o[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o&&h)for(o.groups=a=Qi(null),i=0;i<h.length;i++)a[(u=h[i])[0]]=o[u[1]];return o});var Of=yf;ir({target:"RegExp",proto:!0,forced:/./.exec!==Of},{exec:Of});var Sf,Tf=ft("species"),kf=RegExp.prototype,If=function(t,e,r,n){var o=ft(t),i=!j((function(){var e={};return e[o]=function(){return 7},7!=""[t](e)})),a=i&&!j((function(){var e=!1,r=/a/;return"split"===t&&((r={}).constructor={},r.constructor[Tf]=function(){return r},r.flags="",r[o]=/./[o]),r.exec=function(){return e=!0,null},r[o](""),!e}));if(!i||!a||r){var u=Fr(/./[o]),s=e(o,""[t],(function(t,e,r,n,o){var a=Fr(t),s=e.exec;return s===Of||s===kf.exec?i&&!o?{done:!0,value:u(e,r,n)}:{done:!0,value:a(r,e,n)}:{done:!1}}));le(String.prototype,t,s[0]),le(kf,o,s[1])}n&&ee(kf[o],"sham",!0)},jf=R("".charAt),Pf=R("".charCodeAt),_f=R("".slice),Mf=function(t){return function(e,r){var n,o,i=rf(D(e)),a=Me(r),u=i.length;return a<0||a>=u?t?"":void 0:(n=Pf(i,a))<55296||n>56319||a+1===u||(o=Pf(i,a+1))<56320||o>57343?t?jf(i,a):n:t?_f(i,a,a+2):o-56320+(n-55296<<10)+65536}},Lf={codeAt:Mf(!1),charAt:Mf(!0)},Rf=Lf.charAt,Cf=function(t,e,r){return e+(r?Rf(t,e).length:1)},Nf=Math.floor,Df=R("".charAt),Ff=R("".replace),Wf=R("".slice),zf=/\\$([$&'\`]|\\d{1,2}|<[^>]*>)/g,Bf=/\\$([$&'\`]|\\d{1,2})/g,Uf=function(t,e,r,n,o,i){var a=r+t.length,u=n.length,s=Bf;return void 0!==o&&(o=W(o),s=zf),Ff(i,s,(function(i,s){var c;switch(Df(s,0)){case"$":return"$";case"&":return t;case"\`":return Wf(e,0,r);case"'":return Wf(e,a);case"<":c=o[Wf(s,1,-1)];break;default:var f=+s;if(0===f)return i;if(f>u){var l=Nf(f/10);return 0===l?i:l<=u?void 0===n[l-1]?Df(s,1):n[l-1]+Df(s,1):i}c=n[f-1]}return void 0===c?"":c}))},Gf=TypeError,Hf=function(t,e){var r=t.exec;if($(r)){var n=St(r,t,e);return null!==n&&At(n),n}if("RegExp"===ve(t))return St(Of,t,e);throw Gf("RegExp#exec called on incompatible receiver")},Vf=ft("replace"),qf=Math.max,Zf=Math.min,Yf=R([].concat),$f=R([].push),Kf=R("".indexOf),Qf=R("".slice),Xf="$0"==="a".replace(/./,"$0"),Jf=!!/./[Vf]&&""===/./[Vf]("a","$0");function tl(t){this.message=t}If("replace",(function(t,e,r){var n=Jf?"$":"$0";return[function(t,r){var n=D(this),o=C(t)?void 0:Lt(t,Vf);return o?St(o,t,n,r):St(e,rf(n),t,r)},function(t,o){var i=At(this),a=rf(t);if("string"==typeof o&&-1===Kf(o,n)&&-1===Kf(o,"$<")){var u=r(e,i,a,o);if(u.done)return u.value}var s=$(o);s||(o=rf(o));var c=i.global;if(c){var f=i.unicode;i.lastIndex=0}for(var l=[];;){var h=Hf(i,a);if(null===h)break;if($f(l,h),!c)break;""===rf(h[0])&&(i.lastIndex=Cf(a,De(i.lastIndex),f))}for(var p,v="",d=0,y=0;y<l.length;y++){for(var g=rf((h=l[y])[0]),m=qf(Zf(Me(h.index),a.length),0),x=[],b=1;b<h.length;b++)$f(x,void 0===(p=h[b])?p:String(p));var w=h.groups;if(s){var E=Yf([g],x,m,a);void 0!==w&&$f(E,w);var A=rf(Dr(o,void 0,E))}else A=Uf(g,a,m,x,w,o);m>=d&&(v+=Qf(a,d,m)+A,d=m+g.length)}return v+Qf(a,d)}]}),!!j((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}))||!Xf||Jf),tl.prototype=new Error,tl.prototype.name="InvalidCharacterError",ir({global:!0,forced:O.globalThis!==O},{globalThis:O}),Sf="undefined"==typeof window?{devicePixelRatio:1,navigator:{userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36",browserLanguage:"zh-CN",language:"zh-CN",platform:""},location:"",document:{documentElement:{style:{}},createEvent:function(){return!0},getElementById:function(t){return!0},createElement:function(){return{className:"",classList:{add:function(){return""}}}},createElementNS:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},querySelector:function(){return!1}},performance:{mark:function(t){return null},clearMeasures:function(t){return null},clearMarks:function(t){return null},measure:function(t,e,r){return{duration:0}},now:function(){return(new Date).getTime()}},Blob:"",dispatchEvent:function(t){return!0},Event:function(t,e){return!0},createElement:function(){return!0},createElementNS:function(){return!0},XMLHttpRequest:function(){return!0},addEventListener:function(){return!0},removeEventListener:function(){return!0},requestAnimationFrame:function(){return!0},cancelAnimationFrame:function(){return!0},clearTimeout:function(){return!0}}:window,"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM?my.getSystemInfoSync().pixelRatio:Sf.devicePixelRatio;var el=TypeError,rl=Object.getOwnPropertyDescriptor,nl=pt&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(yi(t)&&!rl(t,"length").writable)throw el("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},ol=TypeError,il=function(t){if(t>9007199254740991)throw ol("Maximum allowed index exceeded");return t},al=Pi("splice"),ul=Math.max,sl=Math.min;ir({target:"Array",proto:!0,forced:!al},{splice:function(t,e){var r,n,o,i,a,u,s=W(this),c=Fe(s),f=Ce(t,c),l=arguments.length;for(0===l?r=n=0:1===l?(r=0,n=c-f):(r=l-2,n=sl(ul(Me(e),0),c-f)),il(c+r-n),o=xi(s,n),i=0;i<n;i++)(a=f+i)in s&&Ii(o,i,s[a]);if(o.length=n,r<n){for(i=f;i<c-n;i++)u=i+r,(a=i+n)in s?s[u]=s[a]:ls(s,u);for(i=c;i>c-n+r;i--)ls(s,i-1)}else if(r>n)for(i=c-n;i>f;i--)u=i+r-1,(a=i+n-1)in s?s[u]=s[a]:ls(s,u);for(i=0;i<r;i++)s[i+f]=arguments[i+2];return nl(s,c-n+r),o}});var cl=u((function t(e,r){i(this,t),s(this,"cancelBubble",void 0),s(this,"cancelable",void 0),s(this,"target",void 0),s(this,"currentTarget",void 0),s(this,"preventDefault",void 0),s(this,"stopPropagation",void 0),s(this,"type",void 0),s(this,"timeStamp",void 0),this.cancelBubble=!1,this.cancelable=!1,this.target=null,this.currentTarget=null,this.preventDefault=function(){},this.stopPropagation=function(){},this.type=e,this.timeStamp=Date.now()})),fl=Object.assign,ll=Object.defineProperty,hl=R([].concat),pl=!fl||j((function(){if(pt&&1!==fl({b:1},fl(ll({},"a",{enumerable:!0,get:function(){ll(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach((function(t){e[t]=t})),7!=fl({},t)[r]||"abcdefghijklmnopqrst"!=Hi(fl({},e)).join("")}))?function(t,e){for(var r=W(t),n=arguments.length,o=1,i=Ze.f,a=Ee.f;n>o;)for(var u,s=Se(arguments[o++]),c=i?hl(Hi(s),i(s)):Hi(s),f=c.length,l=0;f>l;)u=c[l++],pt&&!St(a,s,u)||(r[u]=s[u]);return r}:fl;ir({target:"Object",stat:!0,arity:2,forced:Object.assign!==pl},{assign:pl});var vl=Ei.findIndex,dl=!0;"findIndex"in[]&&Array(1).findIndex((function(){dl=!1})),ir({target:"Array",proto:!0,forced:dl},{findIndex:function(t){return vl(this,t,arguments.length>1?arguments[1]:void 0)}}),oa("findIndex");var yl=Lf.charAt,gl=ce.set,ml=ce.getterFor("String Iterator");wa(String,"String",(function(t){gl(this,{type:"String Iterator",string:rf(t),index:0})}),(function(){var t,e=ml(this),r=e.string,n=e.index;return n>=r.length?Ea(void 0,!0):(t=yl(r,n),e.index+=t.length,Ea(t,!1))}));var xl=qe.f,bl="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],wl={f:function(t){return bl&&"Window"==ve(t)?function(t){try{return xl(t)}catch(t){return yu(bl)}}(t):xl(Te(t))}},El=j((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Al=Object.isExtensible,Ol=j((function(){Al(1)}))||El?function(t){return!!dt(t)&&((!El||"ArrayBuffer"!=ve(t))&&(!Al||Al(t)))}:Al,Sl=!j((function(){return Object.isExtensible(Object.preventExtensions({}))})),Tl=b((function(t){var e=Ut.f,r=!1,n=V("meta"),o=0,i=function(t){e(t,n,{value:{objectID:"O"+o++,weakData:{}}})},a=t.exports={enable:function(){a.enable=function(){},r=!0;var t=qe.f,e=R([].splice),o={};o[n]=1,t(o).length&&(qe.f=function(r){for(var o=t(r),i=0,a=o.length;i<a;i++)if(o[i]===n){e(o,i,1);break}return o},ir({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:wl.f}))},fastKey:function(t,e){if(!dt(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!B(t,n)){if(!Ol(t))return"F";if(!e)return"E";i(t)}return t[n].objectID},getWeakData:function(t,e){if(!B(t,n)){if(!Ol(t))return!0;if(!e)return!1;i(t)}return t[n].weakData},onFreeze:function(t){return Sl&&r&&Ol(t)&&!B(t,n)&&i(t),t}};oe[n]=!0})),kl=(Tl.enable,Tl.fastKey,Tl.getWeakData,Tl.onFreeze,function(t,e,r){var n=-1!==t.indexOf("Map"),o=-1!==t.indexOf("Weak"),i=n?"set":"add",a=O[t],u=a&&a.prototype,s=a,c={},f=function(t){var e=R(u[t]);le(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return o&&!dt(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!dt(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(nr(t,!$(a)||!(o||u.forEach&&!j((function(){(new a).entries().next()})))))s=r.getConstructor(e,t,n,i),Tl.enable();else if(nr(t,!0)){var l=new s,h=l[i](o?{}:-0,1)!=l,p=j((function(){l.has(1)})),v=_o((function(t){new a(t)})),d=!o&&j((function(){for(var t=new a,e=5;e--;)t[i](e,e);return!t.has(-0)}));v||((s=e((function(t,e){yr(t,u);var r=ss(new a,t,s);return C(e)||To(e,r[i],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=s),(p||d)&&(f("delete"),f("has"),n&&f("get")),(d||h)&&f(i),o&&u.clear&&delete u.clear}return c[t]=s,ir({global:!0,constructor:!0,forced:s!=a},c),hr(s,t),o||r.setStrong(s,t,n),s}),Il=Tl.getWeakData,jl=ce.set,Pl=ce.getterFor,_l=Ei.find,Ml=Ei.findIndex,Ll=R([].splice),Rl=0,Cl=function(t){return t.frozen||(t.frozen=new Nl)},Nl=function(){this.entries=[]},Dl=function(t,e){return _l(t.entries,(function(t){return t[0]===e}))};Nl.prototype={get:function(t){var e=Dl(this,t);if(e)return e[1]},has:function(t){return!!Dl(this,t)},set:function(t,e){var r=Dl(this,t);r?r[1]=e:this.entries.push([t,e])},delete:function(t){var e=Ml(this.entries,(function(e){return e[0]===t}));return~e&&Ll(this.entries,e,1),!!~e}};var Fl,Wl={getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),jl(t,{type:e,id:Rl++,frozen:void 0}),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Pl(e),u=function(t,e,r){var n=a(t),o=Il(At(e),!0);return!0===o?Cl(n).set(e,r):o[n.id]=r,t};return ru(i,{delete:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).delete(t):r&&B(r,e.id)&&delete r[e.id]},has:function(t){var e=a(this);if(!dt(t))return!1;var r=Il(t);return!0===r?Cl(e).has(t):r&&B(r,e.id)}}),ru(i,r?{get:function(t){var e=a(this);if(dt(t)){var r=Il(t);return!0===r?Cl(e).get(t):r?r[e.id]:void 0}},set:function(t,e){return u(this,t,e)}}:{add:function(t){return u(this,t,!0)}}),o}},zl=ce.enforce,Bl=!O.ActiveXObject&&"ActiveXObject"in O,Ul=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gl=kl("WeakMap",Ul,Wl);if(Jt&&Bl){Fl=Wl.getConstructor(Ul,"WeakMap",!0),Tl.enable();var Hl=Gl.prototype,Vl=R(Hl.delete),ql=R(Hl.has),Zl=R(Hl.get),Yl=R(Hl.set);ru(Hl,{delete:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),Vl(this,t)||e.frozen.delete(t)}return Vl(this,t)},has:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)||e.frozen.has(t)}return ql(this,t)},get:function(t){if(dt(t)&&!Ol(t)){var e=zl(this);return e.frozen||(e.frozen=new Fl),ql(this,t)?Zl(this,t):e.frozen.get(t)}return Zl(this,t)},set:function(t,e){if(dt(t)&&!Ol(t)){var r=zl(this);r.frozen||(r.frozen=new Fl),ql(this,t)?Yl(this,t,e):r.frozen.set(t,e)}else Yl(this,t,e);return this}})}var $l=ft("iterator"),Kl=ft("toStringTag"),Ql=Ta.values,Xl=function(t,e){if(t){if(t[$l]!==Ql)try{ee(t,$l,Ql)}catch(e){t[$l]=Ql}if(t[Kl]||ee(t,Kl,e),hi[e])for(var r in Ta)if(t[r]!==Ta[r])try{ee(t,r,Ta[r])}catch(e){t[r]=Ta[r]}}};for(var Jl in hi)Xl(O[Jl]&&O[Jl].prototype,Jl);Xl(di,"DOMTokenList");var th,eh,rh,nh,oh=new WeakMap,ih=function(){function t(){i(this,t),oh.set(this,{})}return u(t,[{key:"addEventListener",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=oh.get(this);n||(n={}),n[t]||(n[t]=[]),n[t].push(e),oh.set(this,n),r.capture,r.once,r.passive}},{key:"removeEventListener",value:function(t,e){var r=oh.get(this);if(r){var n=r[t];if(n&&n.length>0)for(var o=n.length;o--;o>0)if(n[o]===e){n.splice(o,1);break}}}},{key:"dispatchEvent",value:function(t){var e=oh.get(this)[t.type];if(e){var r,n=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=g(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(e);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(t){n.e(t)}finally{n.f()}}}}]),t}(),ah=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),t.className="",t.children=[],t}return u(r,[{key:"setAttribute",value:function(t,e){this[t]=e}},{key:"getAttribute",value:function(t){return this[t]}},{key:"setAttributeNS",value:function(t,e){this[t]=e}},{key:"getAttributeNS",value:function(t){return this[t]}}]),r}(function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"childNodes",void 0),t.childNodes=[],t}return u(r,[{key:"appendChild",value:function(t){this.childNodes.push(t)}},{key:"cloneNode",value:function(){var t=Object.create(this);return Object.assign(t,this),t}},{key:"removeChild",value:function(t){var e=this.childNodes.findIndex((function(e){return e===t}));return e>-1?this.childNodes.splice(e,1):null}}]),r}(ih));if("undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var uh=my.getSystemInfoSync();th=uh.screenWidth,eh=uh.screenHeight,rh=uh.windowWidth,nh=uh.windowHeight}else{var sh=Sf.innerWidth,ch=Sf.innerHeight;th=sh,eh=ch,rh=sh,nh=ch}var fh={width:th,height:eh,availWidth:rh,availHeight:nh,availLeft:0,availTop:0},lh=fh.availWidth,hh=fh.availHeight,ph={style:[]};function vh(t,e){var r,n;"parentNode"in t||(r=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentNode",{enumerable:!0,get:r}));"parentElement"in t||(n=0===e?function(){return null}:1===e?function(){return ph}:function(){return null},Object.defineProperty(t,"parentElement",{enumerable:!0,get:n}))}function dh(t){t.style=t.style||{},Object.assign(t.style,{top:"0px",left:"0px",width:lh+"px",height:hh+"px",margin:"0px",padding:"0px"})}function yh(t){"clientLeft"in t||(t.clientLeft=0,t.clientTop=0),"clientWidth"in t||(t.clientWidth=lh,t.clientHeight=hh),"getBoundingClientRect"in t||(t.getBoundingClientRect=function(){return{x:0,y:0,top:0,left:0,width:this.clientWidth,height:this.clientHeight,right:this.clientWidth,bottom:this.clientHeight}})}function gh(t){"offsetLeft"in t||(t.offsetLeft=0,t.offsetTop=0),"offsetWidth"in t||(t.offsetWidth=lh,t.offsetHeight=hh)}function mh(t){"scrollLeft"in t||(t.scrollLeft=0,t.scrollTop=0),"scrollWidth"in t||(t.scrollWidth=lh,t.scrollHeight=hh)}function xh(t){var e=function(){return!0};t.classList=[],t.classList.add=e,t.classList.remove=e,t.classList.contains=e,t.classList.toggle=e}function bh(){}var wh=function(t){c(r,t);var e=v(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return i(this,r),s(h(t=e.call(this)),"className",void 0),s(h(t),"children",void 0),s(h(t),"focus",void 0),s(h(t),"blur",void 0),s(h(t),"insertBefore",void 0),s(h(t),"appendChild",void 0),s(h(t),"removeChild",void 0),s(h(t),"remove",void 0),s(h(t),"innerHTML",void 0),s(h(t),"tagName",void 0),t.className="",t.children=[],t.focus=bh,t.blur=bh,t.insertBefore=bh,t.appendChild=bh,t.removeChild=bh,t.remove=bh,t.innerHTML="",t.tagName=n.toUpperCase(),vh(h(t),o),dh(h(t)),xh(h(t)),yh(h(t)),gh(h(t)),mh(h(t)),t}return u(r)}(ah),Eh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"video")}return u(r)}(function(t){c(r,t);var e=v(r);function r(t){return i(this,r),e.call(this,t)}return u(r,[{key:"addTextTrack",value:function(){}},{key:"captureStream",value:function(){}},{key:"fastSeek",value:function(){}},{key:"load",value:function(){}},{key:"pause",value:function(){}},{key:"play",value:function(){}}]),r}(wh)),Ah={};function Oh(){return Ah}var Sh=u((function t(){i(this,t);var e=Oh(),r=e.createImage&&e.createImage()||{};return"tagName"in r||(r.tagName="IMG",r.__proto__=t.prototype),vh(r),xh(r),Object.assign(r,{addEventListener:function(t,e){r["on".concat(t)]=e.bind(r)},removeEventListener:function(t){r["on".concat(t)]=null}}),r})),Th={href:"",protocol:"",host:""},kh=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"body",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e,r){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),Ih=function(t){c(r,t);var e=v(r);function r(){return i(this,r),e.call(this,"html",0)}return u(r,[{key:"addEventListener",value:function(t,e){}},{key:"removeEventListener",value:function(t,e){}},{key:"dispatchEvent",value:function(t){}}]),r}(wh),jh={},Ph={readyState:"complete",visibilityState:"visible",hidden:!1,fullscreen:!0,scripts:[],style:{},location:Th,ontouchstart:null,ontouchmove:null,ontouchend:null,onvisibilitychange:null,parentNode:null,parentElement:null,head:null,body:null,documentElement:{style:[]},createElement:function(t){return"canvas"===(t=t.toLowerCase())?my.createOffscreenCanvas(1024,128,"2d"):"img"===t?new Sh:"video"===t?new Eh:new wh(t)},createElementNS:function(t,e){return this.createElement(e)},createTextNode:function(t){return t},getElementById:function(t){return null},getElementsByTagName:function(t){return t=t.toLowerCase(),[]},getElementsByTagNameNS:function(t,e){return this.getElementsByTagName(e)},getElementsByName:function(t){return[]},querySelector:function(t){return null},querySelectorAll:function(t){return[]},addEventListener:function(t,e,r){jh[t]||(jh[t]=[]),jh[t].push(e)},removeEventListener:function(t,e){var r=jh[t];if(r&&r.length>0)for(var n=r.length;n--;n>0)if(r[n]===e){r.splice(n,1);break}},dispatchEvent:function(t){var e=t.type,r=jh[e];if(r)for(var n=0;n<r.length;n++)r[n](t);t.target&&"function"==typeof t.target["on"+e]&&t.target["on"+e](t)},createEvent:function(t){return new cl(t)}};Ph.documentElement=new Ih,Ph.head=new wh("head"),Ph.body=new kh,If("match",(function(t,e,r){return[function(e){var r=D(this),n=C(e)?void 0:Lt(e,t);return n?St(n,e,r):new RegExp(e)[t](rf(r))},function(t){var n=At(this),o=rf(t),i=r(e,n,o);if(i.done)return i.value;if(!n.global)return Hf(n,o);var a=n.unicode;n.lastIndex=0;for(var u,s=[],c=0;null!==(u=Hf(n,o));){var f=rf(u[0]);s[c]=f,""===f&&(n.lastIndex=Cf(o,De(n.lastIndex),a)),c++}return 0===c?null:s}]}));var _h,Mh,Lh=ft("isConcatSpreadable"),Rh=nt>=51||!j((function(){var t=[];return t[Lh]=!1,t.concat()[0]!==t})),Ch=Pi("concat"),Nh=function(t){if(!dt(t))return!1;var e=t[Lh];return void 0!==e?!!e:yi(t)};if(ir({target:"Array",proto:!0,arity:1,forced:!Rh||!Ch},{concat:function(t){var e,r,n,o,i,a=W(this),u=xi(a,0),s=0;for(e=-1,n=arguments.length;e<n;e++)if(Nh(i=-1===e?a:arguments[e]))for(o=Fe(i),il(s+o),r=0;r<o;r++,s++)r in i&&Ii(u,s,i[r]);else il(s+1),Ii(u,s++,i);return u.length=s,u}}),"undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM){var Dh=my.getSystemInfoSync();_h=Dh.system,Dh.platform,Dh.language}else{var Fh={versions:(Mh=Sf.navigator.userAgent,{trident:Mh.indexOf("Trident")>-1,presto:Mh.indexOf("Presto")>-1,webKit:Mh.indexOf("AppleWebKit")>-1,gecko:Mh.indexOf("Gecko")>-1&&-1===Mh.indexOf("KHTML"),mobile:!!Mh.match(/AppleWebKit.*Mobile.*/),ios:!!Mh.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/),android:Mh.indexOf("Android")>-1||Mh.indexOf("Linux")>-1,iPhone:Mh.indexOf("iPhone")>-1,iPad:Mh.indexOf("iPad")>-1,webApp:-1===Mh.indexOf("Safari"),weixin:Mh.indexOf("MicroMessenger")>-1,qq:" qq"===Mh.match(/\\sQQ/i)}),language:(Sf.navigator.browserLanguage||Sf.navigator.language).toLowerCase()};Fh.versions.android?"android":Fh.versions.trident?"IE":Fh.versions.presto?"Opera":Fh.versions.webKit?"webKit":Fh.versions.gecko?"Firefox":Fh.versions.mobile?"mobile":Fh.versions.ios?"ios":Fh.versions.iPhone?"iPhone":Fh.versions.iPad?"ipad":Fh.versions.webApp?"webApp":Fh.versions.weixin?"weixin":Fh.versions.qq&&"qq",_h=Sf.navigator.userAgent,Fh.language}_h.toLowerCase().indexOf("android");cs("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}));var Wh=Ut.f,zh=Tl.fastKey,Bh=ce.set,Uh=ce.getterFor;kl("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(t,e,r,n){var o=t((function(t,o){yr(t,i),Bh(t,{type:e,index:Qi(null),first:void 0,last:void 0,size:0}),pt||(t.size=0),C(o)||To(o,t[n],{that:t,AS_ENTRIES:r})})),i=o.prototype,a=Uh(e),u=function(t,e,r){var n,o,i=a(t),u=s(t,e);return u?u.value=r:(i.last=u={index:o=zh(e,!0),key:e,value:r,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=u),n&&(n.next=u),pt?i.size++:t.size++,"F"!==o&&(i.index[o]=u)),t},s=function(t,e){var r,n=a(t),o=zh(e);if("F"!==o)return n.index[o];for(r=n.first;r;r=r.next)if(r.key==e)return r};return ru(i,{clear:function(){for(var t=a(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,pt?t.size=0:this.size=0},delete:function(t){var e=a(this),r=s(this,t);if(r){var n=r.next,o=r.previous;delete e.index[r.index],r.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==r&&(e.first=n),e.last==r&&(e.last=o),pt?e.size--:this.size--}return!!r},forEach:function(t){for(var e,r=a(this),n=zr(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!s(this,t)}}),ru(i,r?{get:function(t){var e=s(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),pt&&Wh(i,"size",{get:function(){return a(this).size}}),o},setStrong:function(t,e,r){var n=e+" Iterator",o=Uh(e),i=Uh(n);wa(t,e,(function(t,e){Bh(this,{type:n,target:t,state:o(t),kind:e,last:void 0})}),(function(){for(var t=i(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?Ea("keys"==e?r.key:"values"==e?r.value:[r.key,r.value],!1):(t.target=void 0,Ea(void 0,!0))}),r?"entries":"values",!r,!0),vr(e)}});var Gh=R([].join),Hh=Se!=Object,Vh=Ai("join",",");ir({target:"Array",proto:!0,forced:Hh||!Vh},{join:function(t){return Gh(Te(this),void 0===t?",":t)}});var qh=j((function(){Hi(1)}));ir({target:"Object",stat:!0,forced:qh},{keys:function(t){return Hi(W(t))}});var Zh=new Map,Yh=new Map,$h=new Map,Kh=function(t){c(r,t);var e=v(r);function r(){var t;return i(this,r),s(h(t=e.call(this)),"onabort",void 0),s(h(t),"onerror",void 0),s(h(t),"onload",void 0),s(h(t),"onloadstart",void 0),s(h(t),"onprogress",void 0),s(h(t),"ontimeout",void 0),s(h(t),"onloadend",void 0),s(h(t),"onreadystatechange",void 0),s(h(t),"readyState",void 0),s(h(t),"response",void 0),s(h(t),"responseText",void 0),s(h(t),"_responseType",void 0),s(h(t),"responseXML",void 0),s(h(t),"status",void 0),s(h(t),"statusText",void 0),s(h(t),"upload",void 0),s(h(t),"withCredentials",void 0),s(h(t),"timeout",void 0),s(h(t),"_url",void 0),s(h(t),"_method",void 0),t.onabort=null,t.onerror=null,t.onload=null,t.onloadstart=null,t.onprogress=null,t.ontimeout=null,t.onloadend=null,t.onreadystatechange=null,t.readyState=0,t.response=null,t.responseText=null,t._responseType="text",t.responseXML=null,t.status=0,t.statusText="",t.upload={},t.withCredentials=!1,Zh.set("requestHeader",{"content-type":"application/x-www-form-urlencoded"}),t}return u(r,[{key:"responseType",set:function(t){this._responseType=t}},{key:"abort",value:function(){var t=$h.get("requestTask");t&&t.abort()}},{key:"getAllResponseHeaders",value:function(){var t=Yh.get("responseHeader");return Object.keys(t).map((function(e){return"".concat(e,": ").concat(t[e])})).join("\\n")}},{key:"getResponseHeader",value:function(t){return Yh.get("responseHeader")[t]}},{key:"open",value:function(t,e,r){this._method=t,this._url=e}},{key:"overrideMimeType",value:function(){}},{key:"send",value:function(){}},{key:"setRequestHeader",value:function(t,e){var r=Zh.get("requestHeader");r[t]=e,Zh.set("requestHeader",r)}},{key:"addEventListener",value:function(t,e){var r=this;"function"==typeof e&&(this["on"+t]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.target=t.target||r,e.call(r,t)})}},{key:"removeEventListener",value:function(t,e){this["on"+t]===e&&(this["on"+t]=null)}}]),r}(ih);s(Kh,"UNSEND",void 0),s(Kh,"OPENED",void 0),s(Kh,"HEADERS_RECEIVED",void 0),s(Kh,"LOADING",void 0),s(Kh,"DONE",void 0),Kh.UNSEND=0,Kh.OPENED=1,Kh.HEADERS_RECEIVED=2,Kh.LOADING=3,Kh.DONE=4;var Qh="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast&&!0!==my.isFRM,Xh="undefined"!=typeof wx&&null!==wx&&(void 0!==wx.request||void 0!==wx.miniProgram),Jh=Qh||Xh;Jh||Sf.XMLHttpRequest,Jh||Sf.location;function tp(t){return[t+1&255,t+1>>8&255,t+1>>8>>8&255]}var ep=Ei.filter,rp=Pi("filter");function np(t){var e=t.color;return e&&e.length?e:[1,1,1,1]}function op(t,e,r){return 2===r.length?[r[0],r[1],0]:[r[0],r[1],r[2]]}function ip(t){return t.filter?[1]:[0]}function ap(t,e){return[e]}ir({target:"Array",proto:!0,forced:!rp},{filter:function(t){return ep(this,t,arguments.length>1?arguments[1]:void 0)}});var up=cp,sp=cp;function cp(t,e,r){r=r||2;var n,o,i,a,u,s,c,f=e&&e.length,l=f?e[0]*r:t.length,h=fp(t,0,l,r,!0),p=[];if(!h||h.next===h.prev)return p;if(f&&(h=function(t,e,r,n){var o,i,a,u,s,c=[];for(o=0,i=e.length;o<i;o++)a=e[o]*n,u=o<i-1?e[o+1]*n:t.length,(s=fp(t,a,u,n,!1))===s.next&&(s.steiner=!0),c.push(wp(s));for(c.sort(gp),o=0;o<c.length;o++)r=mp(c[o],r);return r}(t,e,h,r)),t.length>80*r){n=i=t[0],o=a=t[1];for(var v=r;v<l;v+=r)(u=t[v])<n&&(n=u),(s=t[v+1])<o&&(o=s),u>i&&(i=u),s>a&&(a=s);c=0!==(c=Math.max(i-n,a-o))?32767/c:0}return hp(h,p,r,n,o,c,0),p}function fp(t,e,r,n,o){var i,a;if(o===Rp(t,e,r,n)>0)for(i=e;i<r;i+=n)a=_p(i,t[i],t[i+1],a);else for(i=r-n;i>=e;i-=n)a=_p(i,t[i],t[i+1],a);return a&&Sp(a,a.next)&&(Mp(a),a=a.next),a}function lp(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Sp(n,n.next)&&0!==Op(n.prev,n,n.next))n=n.next;else{if(Mp(n),(n=e=n.prev)===n.next)break;r=!0}}while(r||n!==e);return e}function hp(t,e,r,n,o,i,a){if(t){!a&&i&&function(t,e,r,n){var o=t;do{0===o.z&&(o.z=bp(o.x,o.y,e,r,n)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,r,n,o,i,a,u,s,c=1;do{for(r=t,t=null,i=null,a=0;r;){for(a++,n=r,u=0,e=0;e<c&&(u++,n=n.nextZ);e++);for(s=c;u>0||s>0&&n;)0!==u&&(0===s||!n||r.z<=n.z)?(o=r,r=r.nextZ,u--):(o=n,n=n.nextZ,s--),i?i.nextZ=o:t=o,o.prevZ=i,i=o;r=n}i.nextZ=null,c*=2}while(a>1)}(o)}(t,n,o,i);for(var u,s,c=t;t.prev!==t.next;)if(u=t.prev,s=t.next,i?vp(t,n,o,i):pp(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(s.i/r|0),Mp(t),t=s.next,c=s.next;else if((t=s)===c){a?1===a?hp(t=dp(lp(t),e,r),e,r,n,o,i,2):2===a&&yp(t,e,r,n,o,i):hp(lp(t),e,r,n,o,i,1);break}}}function pp(t){var e=t.prev,r=t,n=t.next;if(Op(e,r,n)>=0)return!1;for(var o=e.x,i=r.x,a=n.x,u=e.y,s=r.y,c=n.y,f=o<i?o<a?o:a:i<a?i:a,l=u<s?u<c?u:c:s<c?s:c,h=o>i?o>a?o:a:i>a?i:a,p=u>s?u>c?u:c:s>c?s:c,v=n.next;v!==e;){if(v.x>=f&&v.x<=h&&v.y>=l&&v.y<=p&&Ep(o,u,i,s,a,c,v.x,v.y)&&Op(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function vp(t,e,r,n){var o=t.prev,i=t,a=t.next;if(Op(o,i,a)>=0)return!1;for(var u=o.x,s=i.x,c=a.x,f=o.y,l=i.y,h=a.y,p=u<s?u<c?u:c:s<c?s:c,v=f<l?f<h?f:h:l<h?l:h,d=u>s?u>c?u:c:s>c?s:c,y=f>l?f>h?f:h:l>h?l:h,g=bp(p,v,e,r,n),m=bp(d,y,e,r,n),x=t.prevZ,b=t.nextZ;x&&x.z>=g&&b&&b.z<=m;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=d&&x.y>=v&&x.y<=y&&x!==o&&x!==a&&Ep(u,f,s,l,c,h,x.x,x.y)&&Op(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;b&&b.z<=m;){if(b.x>=p&&b.x<=d&&b.y>=v&&b.y<=y&&b!==o&&b!==a&&Ep(u,f,s,l,c,h,b.x,b.y)&&Op(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function dp(t,e,r){var n=t;do{var o=n.prev,i=n.next.next;!Sp(o,i)&&Tp(o,n,n.next,i)&&jp(o,i)&&jp(i,o)&&(e.push(o.i/r|0),e.push(n.i/r|0),e.push(i.i/r|0),Mp(n),Mp(n.next),n=t=i),n=n.next}while(n!==t);return lp(n)}function yp(t,e,r,n,o,i){var a=t;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&Ap(a,u)){var s=Pp(a,u);return a=lp(a,a.next),s=lp(s,s.next),hp(a,e,r,n,o,i,0),void hp(s,e,r,n,o,i,0)}u=u.next}a=a.next}while(a!==t)}function gp(t,e){return t.x-e.x}function mp(t,e){var r=function(t,e){var r,n=e,o=t.x,i=t.y,a=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var u=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(u<=o&&u>a&&(a=u,r=n.x<n.next.x?n:n.next,u===o))return r}n=n.next}while(n!==e);if(!r)return null;var s,c=r,f=r.x,l=r.y,h=1/0;n=r;do{o>=n.x&&n.x>=f&&o!==n.x&&Ep(i<l?o:a,i,f,l,i<l?a:o,i,n.x,n.y)&&(s=Math.abs(i-n.y)/(o-n.x),jp(n,t)&&(s<h||s===h&&(n.x>r.x||n.x===r.x&&xp(r,n)))&&(r=n,h=s)),n=n.next}while(n!==c);return r}(t,e);if(!r)return e;var n=Pp(r,t);return lp(n,n.next),lp(r,r.next)}function xp(t,e){return Op(t.prev,t,e.prev)<0&&Op(e.next,t,t.next)<0}function bp(t,e,r,n,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*o|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*o|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wp(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function Ep(t,e,r,n,o,i,a,u){return(o-a)*(e-u)>=(t-a)*(i-u)&&(t-a)*(n-u)>=(r-a)*(e-u)&&(r-a)*(i-u)>=(o-a)*(n-u)}function Ap(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Tp(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&(jp(t,e)&&jp(e,t)&&function(t,e){var r=t,n=!1,o=(t.x+e.x)/2,i=(t.y+e.y)/2;do{r.y>i!=r.next.y>i&&r.next.y!==r.y&&o<(r.next.x-r.x)*(i-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}(t,e)&&(Op(t.prev,t,e.prev)||Op(t,e.prev,e))||Sp(t,e)&&Op(t.prev,t,t.next)>0&&Op(e.prev,e,e.next)>0)}function Op(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Sp(t,e){return t.x===e.x&&t.y===e.y}function Tp(t,e,r,n){var o=Ip(Op(t,e,r)),i=Ip(Op(t,e,n)),a=Ip(Op(r,n,t)),u=Ip(Op(r,n,e));return o!==i&&a!==u||(!(0!==o||!kp(t,r,e))||(!(0!==i||!kp(t,n,e))||(!(0!==a||!kp(r,t,n))||!(0!==u||!kp(r,e,n)))))}function kp(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Ip(t){return t>0?1:t<0?-1:0}function jp(t,e){return Op(t.prev,t,t.next)<0?Op(t,e,t.next)>=0&&Op(t,t.prev,e)>=0:Op(t,e,t.prev)<0||Op(t,t.next,e)<0}function Pp(t,e){var r=new Lp(t.i,t.x,t.y),n=new Lp(e.i,e.x,e.y),o=t.next,i=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,i.next=n,n.prev=i,n}function _p(t,e,r,n){var o=new Lp(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function Mp(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Rp(t,e,r,n){for(var o=0,i=e,a=r-n;i<r;i+=n)o+=(t[a]-t[i])*(t[i+1]+t[a+1]),a=i;return o}cp.deviation=function(t,e,r,n){var o=e&&e.length,i=o?e[0]*r:t.length,a=Math.abs(Rp(t,0,i,r));if(o)for(var u=0,s=e.length;u<s;u++){var c=e[u]*r,f=u<s-1?e[u+1]*r:t.length;a-=Math.abs(Rp(t,c,f,r))}var l=0;for(u=0;u<n.length;u+=3){var h=n[u]*r,p=n[u+1]*r,v=n[u+2]*r;l+=Math.abs((t[h]-t[v])*(t[p+1]-t[h+1])-(t[h]-t[p])*(t[v+1]-t[h+1]))}return 0===a&&0===l?0:Math.abs((l-a)/a)},cp.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},n=0,o=0;o<t.length;o++){for(var i=0;i<t[o].length;i++)for(var a=0;a<e;a++)r.vertices.push(t[o][i][a]);o>0&&(n+=t[o-1].length,r.holes.push(n))}return r},up.default=sp;var Cp=R(1..valueOf),Np=R("".replace),Dp="[\\t\\n\\v\\f\\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\\u2028\\u2029\\ufeff]",Fp=RegExp("^"+Dp+Dp+"*"),Wp=RegExp(Dp+Dp+"*$"),zp=function(t){return function(e){var r=rf(D(e));return 1&t&&(r=Np(r,Fp,"")),2&t&&(r=Np(r,Wp,"")),r}},Bp={start:zp(1),end:zp(2),trim:zp(3)},Up=qe.f,Gp=Ie.f,Hp=Ut.f,Vp=Bp.trim,qp=O.Number,Zp=qp.prototype,Yp=O.TypeError,$p=R("".slice),Kp=R("".charCodeAt),Qp=function(t){var e=Dt(t,"number");return"bigint"==typeof e?e:Xp(e)},Xp=function(t){var e,r,n,o,i,a,u,s,c=Dt(t,"number");if(It(c))throw Yp("Cannot convert a Symbol value to a number");if("string"==typeof c&&c.length>2)if(c=Vp(c),43===(e=Kp(c,0))||45===e){if(88===(r=Kp(c,2))||120===r)return NaN}else if(48===e){switch(Kp(c,1)){case 66:case 98:n=2,o=49;break;case 79:case 111:n=8,o=55;break;default:return+c}for(a=(i=$p(c,2)).length,u=0;u<a;u++)if((s=Kp(i,u))<48||s>o)return NaN;return parseInt(i,n)}return+c};if(nr("Number",!qp(" 0o1")||!qp("0b1")||qp("+0x1"))){for(var Jp,tv=function(t){var e=arguments.length<1?0:qp(Qp(t)),r=this;return Tt(Zp,r)&&j((function(){Cp(r)}))?ss(Object(e),r,tv):e},ev=pt?Up(qp):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),rv=0;ev.length>rv;rv++)B(qp,Jp=ev[rv])&&!B(tv,Jp)&&Hp(tv,Jp,Gp(qp,Jp));tv.prototype=Zp,Zp.constructor=tv,le(O,"Number",tv,{constructor:!0})}var nv=RangeError,ov=RangeError,iv=String,av=Math.floor,uv=R((function(t){var e=rf(D(this)),r="",n=Me(t);if(n<0||n==1/0)throw nv("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(r+=e);return r})),sv=R("".slice),cv=R(1..toFixed),fv=function(t,e,r){return 0===e?r:e%2==1?fv(t,e-1,r*t):fv(t*t,e/2,r)},lv=function(t,e,r){for(var n=-1,o=r;++n<6;)o+=e*t[n],t[n]=o%1e7,o=av(o/1e7)},hv=function(t,e){for(var r=6,n=0;--r>=0;)n+=t[r],t[r]=av(n/e),n=n%e*1e7},pv=function(t){for(var e=6,r="";--e>=0;)if(""!==r||0===e||0!==t[e]){var n=iv(t[e]);r=""===r?n:r+uv("0",7-n.length)+n}return r},vv=j((function(){return"0.000"!==cv(8e-5,3)||"1"!==cv(.9,0)||"1.25"!==cv(1.255,2)||"1000000000000000128"!==cv(0xde0b6b3a7640080,0)}))||!j((function(){cv({})}));function dv(t){return"number"==typeof t}function yv(t){var e=Math.max(Math.min(85.0511287798,t[1]),-85.0511287798),r=Math.PI/180,n=t[0]*r,o=e*r;o=Math.log(Math.tan(Math.PI/4+o/2));return n=(256<<20)*(.5/Math.PI*n+.5),o=(256<<20)*(-.5/Math.PI*o+(r=.5)),[Math.floor(n),Math.floor(o)]}ir({target:"Number",proto:!0,forced:vv},{toFixed:function(t){var e,r,n,o,i=Cp(this),a=Me(t),u=[0,0,0,0,0,0],s="",c="0";if(a<0||a>20)throw ov("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return iv(i);if(i<0&&(s="-",i=-i),i>1e-21)if(r=(e=function(t){for(var e=0,r=t;r>=4096;)e+=12,r/=4096;for(;r>=2;)e+=1,r/=2;return e}(i*fv(2,69,1))-69)<0?i*fv(2,-e,1):i/fv(2,e,1),r*=4503599627370496,(e=52-e)>0){for(lv(u,0,r),n=a;n>=7;)lv(u,1e7,0),n-=7;for(lv(u,fv(10,n,1),0),n=e-1;n>=23;)hv(u,1<<23),n-=23;hv(u,1<<n),lv(u,1,1),hv(u,2),c=pv(u)}else lv(u,0,r),lv(u,1<<-e,0),c=pv(u)+uv("0",a);return c=a>0?s+((o=c.length)<=a?"0."+uv("0",a-o)+c:sv(c,0,o-a)+"."+sv(c,o-a)):s+c}});var gv,mv=/"/g,xv=R("".replace);ir({target:"String",proto:!0,forced:(gv="sub",j((function(){var t=""[gv]('"');return t!==t.toLowerCase()||t.split('"').length>3})))},{sub:function(){return t="sub",e="",r="",n=rf(D(this)),o="<"+t,""!==e&&(o+=" "+e+'="'+xv(rf(r),mv,"&quot;")+'"'),o+">"+n+"</"+t+">";var t,e,r,n,o}});var bv=RegExp.prototype,wv=qt.PROPER,Ev=RegExp.prototype.toString,Av=j((function(){return"/a/b"!=Ev.call({source:"a",flags:"b"})})),Ov=wv&&"toString"!=Ev.name;(Av||Ov)&&le(RegExp.prototype,"toString",(function(){var t=At(this);return"/"+rf(t.source)+"/"+rf(function(t){var e=t.flags;return void 0!==e||"flags"in bv||B(t,"flags")||!Tt(bv,t)?e:St(nf,t)}(t))}),{unsafe:!0});var Sv="undefined"!=typeof Float32Array?Float32Array:Array;function Tv(){var t=new Sv(2);return Sv!=Float32Array&&(t[0]=0,t[1]=0),t}function kv(t,e){var r=new Sv(2);return r[0]=t,r[1]=e,r}function Iv(t,e){return t[0]=e[0],t[1]=e[1],t}function jv(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Pv(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function _v(t,e){var r=e[0],n=e[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t}function Mv(t,e){return t[0]*e[0]+t[1]*e[1]}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Lv,Rv=Pv,Cv=(Lv=Tv(),Tv()),Nv=(Tv(),Tv()),Dv=Tv(),Fv=Tv();function Wv(t,e,r,n,o){return jv(t,r,n),_v(t,t),[o/Mv(e=kv(-t[1],t[0]),kv(-r[1],r[0])),e]}function zv(t,e){return function(t,e,r){return t[0]=e,t[1]=r,t}(t,-e[1],e[0])}function Bv(t,e,r){return Rv(t,e,r),_v(t,t),t}function Uv(t,e){return t[0]===e[0]&&t[1]===e[1]}var Gv=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t),s(this,"complex",void 0),s(this,"join",void 0),s(this,"cap",void 0),s(this,"miterLimit",void 0),s(this,"thickness",void 0),s(this,"normal",void 0),s(this,"lastFlip",-1),s(this,"miter",kv(0,0)),s(this,"started",!1),s(this,"dash",!1),s(this,"totalDistance",0),s(this,"currentIndex",0),this.join=e.join||"miter",this.cap=e.cap||"butt",this.miterLimit=e.miterLimit||10,this.thickness=e.thickness||1,this.dash=e.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return u(t,[{key:"extrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.segment_gaode2(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"simpleExtrude_gaode2",value:function(t,e){var r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var n=t.length,o=r.startIndex,i=1;i<n;i++){var a,u,s,c=t[i-1];c.push(null!==(a=e[i-1][2])&&void 0!==a?a:0);var f=e[i-1],l=t[i];l.push(null!==(u=e[i][2])&&void 0!==u?u:0);var h=e[i],p=i<t.length-1?[].concat(y(t[i+1]),[null!==(s=e[i+1][2])&&void 0!==s?s:0]):null,v=i<e.length-1?e[i+1]:null;o+=this.simpleSegment(r,o,c,l,p,f,h,v)}if(this.dash)for(var d=0;d<r.positions.length/6;d++)r.positions[6*d+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}},{key:"extrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.segment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"simpleExtrude",value:function(t){var e=this.complex;if(t.length<=1)return e;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var r=t.length,n=e.startIndex,o=1;o<r;o++){var i=t[o-1],a=t[o],u=o<t.length-1?t[o+1]:null;n+=this.simpleSegment(e,n,i,a,u)}if(this.dash)for(var s=0;s<e.positions.length/6;s++)e.positions[6*s+5]=this.totalDistance;return e.startIndex=e.positions.length/6,e}},{key:"segment_gaode2",value:function(t,e,r,n,o,i,a,u){var s=0,c=t.indices,f=t.positions,l=t.normals,h="square"===this.cap,p="bevel"===this.join,v=yv([a[0],a[1]]),g=yv([i[0],i[1]]);Bv(Nv,n,r);var m=0;if(this.dash&&(m=this.lineSegmentDistance(v,g),this.totalDistance+=m),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,h){var x=Tv(),b=Tv();jv(x,this.normal,Nv),jv(b,this.normal,Nv),l.push(b[0],b[1],0),l.push(x[0],x[1],0),f.push(r[0],r[1],0|r[2],this.totalDistance-m,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),f.push(r[0],r[1],0|r[2],this.totalDistance-m,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,r,this.normal,this.thickness,this.totalDistance-m);if(c.push(e+0,e+1,e+2),o){Uv(n,o)&&jv(o,n,_v(o,Pv(o,n,r))),Bv(Dv,o,n);var w=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),E=w[0],A=w[1],O=Mv(Fv,this.normal)<0?-1:1,S=p;if(!S&&"miter"===this.join)E>this.miterLimit&&(S=!0);S?(l.push(this.normal[0],this.normal[1],0),l.push(A[0],A[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,c.push.apply(c,y(this.lastFlip!==-O?[e,e+2,e+3]:[e+2,e+1,e+3])),c.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),l.push(this.normal[0],this.normal[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*O,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(f,l,n,A,E,this.totalDistance),c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),O=-1,Iv(this.normal,A),s+=2),this.lastFlip=O}else{if(zv(this.normal,Nv),h){var T=Tv(),k=Tv();Rv(k,Nv,this.normal),jv(T,Nv,this.normal),l.push(k[0],k[1],0),l.push(T[0],T[1],0),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),f.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(f,l,n,this.normal,this.thickness,this.totalDistance);c.push.apply(c,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),s+=2}return s}},{key:"simpleSegment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c=yv([n[0],n[1]]),f=yv([r[0],r[1]]);Bv(Nv,c,f);var l=0;if(this.dash&&(l=this.lineSegmentDistance(c,f),this.totalDistance+=l),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),this.started||(this.started=!0,this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-l)),a.push(e+0,e+1,e+2),o){var h=yv([o[0],o[1]]);Uv(c,h)&&jv(h,c,_v(h,Pv(h,c,f))),Bv(Dv,h,c);var p=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),v=p[0],g=p[1];Mv(Fv,this.normal);this.extrusions(u,s,n,g,v,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),-1,Iv(this.normal,g),i+=2,this.lastFlip=-1}else zv(this.normal,Nv),this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2;return i}},{key:"segment",value:function(t,e,r,n,o){var i=0,a=t.indices,u=t.positions,s=t.normals,c="square"===this.cap,f="bevel"===this.join,l=yv([n[0],n[1]]),h=yv([r[0],r[1]]);Bv(Nv,l,h);var p=0;if(this.dash&&(p=this.lineSegmentDistance(l,h),this.totalDistance+=p),this.normal||(this.normal=Tv(),zv(this.normal,Nv)),!this.started)if(this.started=!0,c){var v=Tv(),g=Tv();jv(v,this.normal,Nv),jv(g,this.normal,Nv),s.push(g[0],g[1],0),s.push(v[0],v[1],0),u.push(r[0],r[1],0|r[2],this.totalDistance-p,-this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),u.push(r[0],r[1],0|r[2],this.totalDistance-p,this.thickness,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,r,this.normal,this.thickness,this.totalDistance-p);if(a.push(e+0,e+1,e+2),o){var m=yv([o[0],o[1]]);Uv(l,m)&&jv(m,l,_v(m,Pv(m,l,h))),Bv(Dv,m,l);var x=d(Wv(Fv,Tv(),Nv,Dv,this.thickness),2),b=x[0],w=x[1],E=Mv(Fv,this.normal)<0?-1:1,A=f;if(!A&&"miter"===this.join)b>this.miterLimit&&(A=!0);A?(s.push(this.normal[0],this.normal[1],0),s.push(w[0],w[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,a.push.apply(a,y(this.lastFlip!==-E?[e,e+2,e+3]:[e+2,e+1,e+3])),a.push(e+2,e+3,e+4),zv(Cv,Dv),Iv(this.normal,Cv),s.push(this.normal[0],this.normal[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,-this.thickness*E,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++,i+=3):(this.extrusions(u,s,n,w,b,this.totalDistance),a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),E=-1,Iv(this.normal,w),i+=2),this.lastFlip=E}else{if(zv(this.normal,Nv),c){var O=Tv(),S=Tv();Rv(S,Nv,this.normal),jv(O,Nv,this.normal),s.push(S[0],S[1],0),s.push(O[0],O[1],0),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),u.push(n[0],n[1],0|n[2],this.totalDistance,this.thickness,0|n[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(u,s,n,this.normal,this.thickness,this.totalDistance);a.push.apply(a,y(1===this.lastFlip?[e,e+2,e+3]:[e+2,e+1,e+3])),i+=2}return i}},{key:"extrusions",value:function(t,e,r,n,o,i){e.push(n[0],n[1],0),e.push(n[0],n[1],0),t.push(r[0],r[1],0|r[2],i,-o,0|r[2]),this.complex.indexes.push(this.currentIndex),t.push(r[0],r[1],0|r[2],i,o,0|r[2]),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}}]),t}();function Hv(t){var e=t.coordinates,r=t.originCoordinates,n=t.version,o=new Gv({dash:!0,join:"bevel"});if("GAODE2.x"===n){var i=e;Array.isArray(i[0][0])||(i=[e]);var a=r;Array.isArray(a[0][0])||(a=[r]);for(var u=0;u<i.length;u++){var s=i[u],c=a[u];o.extrude_gaode2(s,c)}}else{var f=e;f[0]&&!Array.isArray(f[0][0])&&(f=[e]),f.forEach((function(t){o.extrude(t)}))}var l=o.complex;return{vertices:l.positions,indices:l.indices,normals:l.normals,indexes:l.indexes,size:6}}function Vv(t){var e=function(t){if(dv(t[0]))return t;if(dv(t[0][0]))throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8");if(dv(t[0][0][0])){var e=0,r=0,n=0;return t.forEach((function(t){t.forEach((function(t){e+=t[0],r+=t[1],n++}))})),[e/n,r/n,0]}throw new Error("\u5F53\u524D\u6570\u636E\u4E0D\u652F\u6301\u6807\u6CE8")}(t.coordinates);return{vertices:[].concat(y(e),y(e),y(e),y(e)),indices:[0,1,2,2,3,0],size:e.length}}function qv(t){var e=t.coordinates,r=up.flatten(e),n=r.vertices,o=r.dimensions,i=r.holes;return{indices:up(n,i,o),vertices:n,size:o}}var Zv=function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.iconMap,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_DistanceAndIndex:function(t,e,r,n,o,i){return void 0===i?[r[3],10]:[r[3],i]},a_Total_Distance:function(t,e,r){return[r[5]]},a_Size:function(t){var e=t.size,r=void 0===e?1:e;return Array.isArray(r)?[r[0],r[1]]:[r,0]},a_Normal:function(t,e,r,n,o){return o},a_Miter:function(t,e,r){return[r[4]]},a_iconMapUV:function(t){var e=t.texture,r=a[e]||{x:0,y:0};return[r.x,r.y]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Hv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size,p=r.indexes;o.forEach((function(t){f.push(t+c)})),l=h;var v=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=v;for(var d=function(r){var o=(null==a?void 0:a.slice(3*r,3*r+3))||[],s=i.slice(r*h,r*h+h),c=0;p&&void 0!==p[r]&&(c=p[r]),n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,s,r,o,c)))}))},g=0;g<v;g++)d(g)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Yv={pointFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f,l;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a=e.shape2d,u={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]},a_Shape:function(t){var e=t.shape,r=void 0===e?2:e;return[a.indexOf(r)]},a_Extrude:function(t,e,r,n){var o=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],i=n%4*3;return[o[i],o[i+1],o[i+2]]},a_Size:function(t){var e=t.size,r=void 0===e?5:e;return Array.isArray(r)?[r[0]]:[r]}},s={sizePerElement:0,elements:[]},c=0,f=[],l=3,o.forEach((function(t,e){var r=Vv(t),o=r.indices,i=r.vertices,a=r.normals,h=r.size;o.forEach((function(t){f.push(t+c)})),l=h;var p=i.length/h;s.sizePerElement=l,s.elements.push({featureIdx:e,vertices:i,normals:a,offset:c}),c+=p;for(var v=function(r){var o=[],a=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&u[n.name]&&(i=n.buffer.data).push.apply(i,y(u[n.name](t,e,a,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:s,indices:f});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),line:Zv,polygonFill:function(){var t=o(r().mark((function t(e){var n,o,i,a,u,s,c,f;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.descriptors,o=e.features,i=e.enablePicking,a={a_Color:np,a_Position:op,filter:ip,a_vertexId:ap,a_PickingColor:function(t){var e=t.id;return i?tp(e):[0,0,0]}},u={sizePerElement:0,elements:[]},s=0,c=[],f=3,o.forEach((function(t,e){var r=qv(t),o=r.indices,i=r.vertices,l=r.normals,h=r.size;o.forEach((function(t){c.push(t+s)})),f=h;var p=i.length/h;u.sizePerElement=f,u.elements.push({featureIdx:e,vertices:i,normals:l,offset:s}),s+=p;for(var v=function(r){var o=[],u=i.slice(r*h,r*h+h);n.forEach((function(n){var i;n&&a[n.name]&&(i=n.buffer.data).push.apply(i,y(a[n.name](t,e,u,r,o,0)))}))},d=0;d<p;d++)v(d)})),t.abrupt("return",{descriptors:n,featureLayout:u,indices:c});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},$v=function(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Yv);function Kv(t){return Qv.apply(this,arguments)}function Qv(){return(Qv=o(r().mark((function t(e){var n,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.workerType,o=e.data,!$v[n]){t.next=3;break}return t.abrupt("return",$v[n](o));case 3:return t.abrupt("return",Promise.reject(new Error('Worker with type "'.concat(n,'" non-existent.'))));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return fi(Kv),t.WorkerSourceMap=Yv,t.createWorker=fi,t.worker=Kv,t}({});
`,nf="l7-worker",Hp=3,Ul=!0;function kd(n){dv(nf,n)}function Ld(){var n=rf(nf);if(!n)throw new Error("get worker failed by workerName: ".concat(nf,"."));return n}function Pd(n,l){return jp.apply(this,arguments)}function jp(){return jp=(0,lt.Z)(it().mark(function n(l,a){var s,o,h,v,m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return s=Ld(),o=Kl.getWorkerFarm({maxConcurrency:Hp,reuseWorkers:Ul}),h=o.getWorkerPool({name:nf,source:s}),A.next=5,h.startJob(nf,function(F,B,V){return F.done(V)});case 5:return v=A.sent,v.postMessage("process",{input:{workerType:l,data:a}}),A.next=9,v.result;case 9:return m=A.sent,A.abrupt("return",m.result);case 11:case"end":return A.stop()}},n)})),jp.apply(this,arguments)}kd(vv);var af={BACK:1029,FRONT:1028};function ec(n){switch(n){case"GAODE1.x":return af.BACK;case"GAODE2.x":return af.BACK;case"MAPBOX":return af.FRONT;case"SIMPLE":return af.FRONT;case"GLOBEL":return af.BACK;case"DEBAULT":return af.FRONT;default:return af.FRONT}}function Wp(n){return typeof ImageBitmap!="undefined"&&n instanceof ImageBitmap}function H0(){return typeof importScripts=="function"}var Qv=H0()?function(){return self.worker&&self.worker.referrer}:function(){return(window.location.protocol==="blob:"?window.parent:window).location.href},If;(function(n){n.Realtime="realtime",n.Overlap="overlap",n.Replace="replace"})(If||(If={}));var mc;(function(n){n.Loading="Loading",n.Loaded="Loaded",n.Failure="Failure",n.Cancelled="Cancelled"})(mc||(mc={}));var j0=0,rc=1,Od=2;function Jv(n){n.forEach(function(l){l.isCurrent&&(l.isVisible=l.isLoaded)})}function of(n){n.forEach(function(l){l.properties.state=j0}),n.forEach(function(l){l.isCurrent&&!Fd(l)&&t0(l)}),n.forEach(function(l){l.isVisible=Boolean(l.properties.state&Od)})}function sf(n){n.forEach(function(a){a.properties.state=j0}),n.forEach(function(a){a.isCurrent&&Fd(a)});var l=n.slice().sort(function(a,s){return a.z-s.z});l.forEach(function(a){a.isVisible=Boolean(a.properties.state&Od),a.children.length&&(a.isVisible||a.properties.state&rc)?a.children.forEach(function(s){s.properties.state=rc}):a.isCurrent&&t0(a)})}function Fd(n){for(;n;){if(n.isLoaded)return n.properties.state|=Od,!0;n=n.parent}return!1}function t0(n){n.children.forEach(function(l){l.isLoaded?l.properties.state|=Od:t0(l)})}var nc,Rd=256,Ch=[-1/0,-1/0,1/0,1/0],Ah=.2,e0=5,r0=(nc={},(0,X.Z)(nc,If.Realtime,Jv),(0,X.Z)(nc,If.Overlap,of),(0,X.Z)(nc,If.Replace,sf),nc),lp=function(){};function Dd(n,l,a){var s=Math.floor((n+180)/360*Math.pow(2,a)),o=Math.floor((1-Math.log(Math.tan(l*Math.PI/180)+1/Math.cos(l*Math.PI/180))/Math.PI)/2*Math.pow(2,a));return[s,o]}function Ro(n,l,a){var s=n/Math.pow(2,a)*360-180,o=Math.PI-2*Math.PI*l/Math.pow(2,a),h=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[s,h]}var kf=function(l,a,s){var o=Ro(l,a,s),h=(0,ht.Z)(o,2),v=h[0],m=h[1],E=Ro(l+1,a+1,s),A=(0,ht.Z)(E,2),F=A[0],B=A[1];return[v,B,F,m]};function co(n){var l=n.zoom,a=n.latLonBounds,s=n.maxZoom,o=s===void 0?1/0:s,h=n.minZoom,v=h===void 0?0:h,m=n.zoomOffset,E=m===void 0?0:m,A=n.extent,F=A===void 0?Ch:A,B=Math.ceil(l)+E;if(Number.isFinite(v)&&B<v)return[];Number.isFinite(o)&&B>o&&(B=o);for(var V=(0,ht.Z)(a,4),j=V[0],at=V[1],ut=V[2],xt=V[3],Nt=[Math.max(j,F[0]),Math.max(at,F[1]),Math.min(ut,F[2]),Math.min(xt,F[3])],de=[],fe=Dd(Nt[0],Nt[1],B),Ne=(0,ht.Z)(fe,2),Ye=Ne[0],_r=Ne[1],Ir=Dd(Nt[2],Nt[3],B),Nr=(0,ht.Z)(Ir,2),Yr=Nr[0],yn=Nr[1],fn=Ye;fn<=Yr;fn++)for(var $n=yn;$n<=_r;$n++)de.push({x:fn,y:$n,z:B});var di=(Yr+Ye)/2,Yi=(_r+yn)/2,ho=function(Vs,hu){return Math.abs(Vs-di)+Math.abs(hu-Yi)};return de.sort(function(zo,Vs){return ho(zo.x,zo.y)-ho(Vs.x,Vs.y)}),de}var gu=function(l,a,s){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,h=Math.pow(2,s),v=h-1,m=h,E=l,A=a;return o&&(E<0?E=E+m:E>v&&(E=E%m)),{warpX:E,warpY:A}};function W0(n){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(n)}function Xp(n){var l=[],a=/\{([a-z])-([a-z])\}/.exec(n);if(a){var s=a[1].charCodeAt(0),o=a[2].charCodeAt(0),h;for(h=s;h<=o;++h)l.push(n.replace(a[0],String.fromCharCode(h)));return l}if(a=/\{(\d+)-(\d+)\}/.exec(n),a){for(var v=parseInt(a[2],10),m=parseInt(a[1],10);m<=v;m++)l.push(n.replace(a[0],m.toString()));return l}return l.push(n),l}function Bd(n,l){if(!n||!n.length)throw new Error("url is not allowed to be empty");var a=l.x,s=l.y,o=l.z,h=Xp(n),v=Math.abs(a+s)%h.length,m=h[v];return m.replace(/\{x\}/g,a.toString()).replace(/\{y\}/g,s.toString()).replace(/\{z\}/g,o.toString()).replace(/\{bbox\}/g,kf(a,s,o).join(",")).replace(/\{-y\}/g,(Math.pow(2,o)-s-1).toString())}function X0(n,l){var a=l.x,s=l.y,o=l.z,h=l.layer,v=l.version,m=v===void 0?"1.0.0":v,E=l.style,A=E===void 0?"default":E,F=l.format,B=l.service,V=B===void 0?"WMTS":B,j=l.tileMatrixset,at="".concat(n,"&SERVICE=").concat(V,"&REQUEST=GetTile&VERSION=").concat(m,"&LAYER=").concat(h,"&STYLE=").concat(A,"&TILEMATRIXSET=").concat(j,"&FORMAT=").concat(F,"&TILECOL=").concat(a,"&TILEROW=").concat(s,"&TILEMATRIX=").concat(o);return at}function Yp(n,l){l===void 0&&(l={});var a=Number(n[0]),s=Number(n[1]),o=Number(n[2]),h=Number(n[3]);if(n.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var v=[a,s],m=[a,h],E=[o,h],A=[o,s];return Hc([[v,A,E,m,v]],l.properties,{bbox:n,id:l.id})}function n0(n){var l=ic();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ic(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Th=function(n){(0,Zt.Z)(a,n);var l=n0(a);function a(s){var o;(0,ct.Z)(this,a),o=l.call(this),(0,X.Z)((0,st.Z)(o),"tileSize",256),(0,X.Z)((0,st.Z)(o),"isVisible",!1),(0,X.Z)((0,st.Z)(o),"isCurrent",!1),(0,X.Z)((0,st.Z)(o),"isVisibleChange",!1),(0,X.Z)((0,st.Z)(o),"loadedLayers",0),(0,X.Z)((0,st.Z)(o),"isLayerLoaded",!1),(0,X.Z)((0,st.Z)(o),"isLoad",!1),(0,X.Z)((0,st.Z)(o),"isChildLoad",!1),(0,X.Z)((0,st.Z)(o),"parent",null),(0,X.Z)((0,st.Z)(o),"children",[]),(0,X.Z)((0,st.Z)(o),"data",null),(0,X.Z)((0,st.Z)(o),"properties",{}),(0,X.Z)((0,st.Z)(o),"loadDataId",0);var h=s.x,v=s.y,m=s.z,E=s.tileSize,A=s.warp,F=A===void 0?!0:A;return o.x=h,o.y=v,o.z=m,o.warp=F||!0,o.tileSize=E,o}return(0,et.Z)(a,[{key:"isLoading",get:function(){return this.loadStatus===mc.Loading}},{key:"isLoaded",get:function(){return this.loadStatus===mc.Loaded}},{key:"isFailure",get:function(){return this.loadStatus===mc.Failure}},{key:"setTileLayerLoaded",value:function(){this.isLayerLoaded=!0}},{key:"isCancelled",get:function(){return this.loadStatus===mc.Cancelled}},{key:"isDone",get:function(){return[mc.Loaded,mc.Cancelled,mc.Failure].includes(this.loadStatus)}},{key:"bounds",get:function(){return kf(this.x,this.y,this.z)}},{key:"bboxPolygon",get:function(){var o=(0,ht.Z)(this.bounds,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(m-h)/2,(E-v)/2],F=Yp(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:A,meta:`
      `.concat(this.key,`
      `)}});return F}},{key:"key",get:function(){var o="".concat(this.x,"_").concat(this.y,"_").concat(this.z);return o}},{key:"layerLoad",value:function(){this.loadedLayers++,this.emit("layerLoaded")}},{key:"loadData",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m,E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne,Ye,_r,Ir;return it().wrap(function(Yr){for(;;)switch(Yr.prev=Yr.next){case 0:return m=v.getData,E=v.onLoad,A=v.onError,this.loadDataId++,F=this.loadDataId,this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=mc.Loading,B=null,Yr.prev=7,j=this.x,at=this.y,ut=this.z,xt=this.bounds,Nt=this.tileSize,de=this.warp,fe=gu(j,at,ut,de),Ne=fe.warpX,Ye=fe.warpY,_r=this.abortController.signal,Ir={x:Ne,y:Ye,z:ut,bounds:xt,tileSize:Nt,signal:_r,warp:de},Yr.next=14,m(Ir,this);case 14:B=Yr.sent,Yr.next=20;break;case 17:Yr.prev=17,Yr.t0=Yr.catch(7),V=Yr.t0;case 20:if(F===this.loadDataId){Yr.next=22;break}return Yr.abrupt("return");case 22:if(!(this.isCancelled&&!B)){Yr.next=24;break}return Yr.abrupt("return");case 24:if(!(V||!B)){Yr.next=28;break}return this.loadStatus=mc.Failure,A(V,this),Yr.abrupt("return");case 28:this.loadStatus=mc.Loaded,this.data=B,E(this);case 31:case"end":return Yr.stop()}},h,this,[[7,17]])}));function o(h){return s.apply(this,arguments)}return o}()},{key:"reloadData",value:function(o){this.isLoading&&this.abortLoad(),this.loadData(o)}},{key:"abortLoad",value:function(){this.isLoaded||this.isCancelled||(this.loadStatus=mc.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}}]),a}(Se.EventEmitter),Nu=function(l,a){var s=Su(l),o=Nl(s,a),h=360*3-180,v=85.0511287798065,m=[Math.max(o[0][0],-h),Math.max(o[0][1],-v),Math.min(o[1][0],h),Math.min(o[1][1],v)];return m},Ug=function(l,a){var s=Su(l),o=Su(a),h=wu(s,o);return h};function Jf(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=th(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function th(n,l){if(!!n){if(typeof n=="string")return Qo(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Qo(n,l)}}function Qo(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function $p(n){var l=eh();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function eh(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var uf=function(n){(0,Zt.Z)(a,n);var l=$p(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this),(0,X.Z)((0,st.Z)(o),"currentTiles",[]),(0,X.Z)((0,st.Z)(o),"cacheTiles",new Map),(0,X.Z)((0,st.Z)(o),"throttleUpdate",(0,ee.throttle)(function(h,v){o.update(h,v)},16)),(0,X.Z)((0,st.Z)(o),"onTileLoad",function(h){o.emit("tile-loaded",h),o.updateTileVisible()}),(0,X.Z)((0,st.Z)(o),"onTileError",function(h,v){o.emit("tile-error",{error:h,tile:v}),o.updateTileVisible()}),(0,X.Z)((0,st.Z)(o),"onTileUnload",function(h){o.emit("tile-unload",h)}),o.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:Ch,getTileData:lp,warp:!0,updateStrategy:If.Overlap},o.updateOptions(s),o}return(0,et.Z)(a,[{key:"isLoaded",get:function(){return this.currentTiles.every(function(o){return o.isDone})}},{key:"tiles",get:function(){var o=Array.from(this.cacheTiles.values()).sort(function(h,v){return h.z-v.z});return o}},{key:"updateOptions",value:function(o){var h=o.minZoom===void 0?this.options.minZoom:Math.ceil(o.minZoom),v=o.maxZoom===void 0?this.options.maxZoom:Math.floor(o.maxZoom);this.options=(0,q.Z)((0,q.Z)((0,q.Z)({},this.options),o),{},{minZoom:h,maxZoom:v})}},{key:"update",value:function(o,h){var v=this,m=Math.max(0,Math.ceil(o));if(!(this.lastViewStates&&this.lastViewStates.zoom===m&&Ug(this.lastViewStates.latLonBoundsBuffer,h))){var E=Nu(h,Ah);this.lastViewStates={zoom:m,latLonBounds:h,latLonBoundsBuffer:E};var A=!1,F=this.getTileIndices(m,E).filter(function(B){return v.options.warp||B.x>=0&&B.x<Math.pow(2,m)});this.currentTiles=F.map(function(B){var V=B.x,j=B.y,at=B.z,ut=v.getTile(V,j,at);if(ut){var xt,Nt,de=((xt=ut)===null||xt===void 0?void 0:xt.isFailure)||((Nt=ut)===null||Nt===void 0?void 0:Nt.isCancelled);return de&&ut.loadData({getData:v.options.getTileData,onLoad:v.onTileLoad,onError:v.onTileError}),ut}return ut=v.createTile(V,j,at),A=!0,ut}),A&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}}},{key:"reloadAll",value:function(){var o=Jf(this.cacheTiles),h;try{for(o.s();!(h=o.n()).done;){var v=(0,ht.Z)(h.value,2),m=v[0],E=v[1];this.currentTiles.includes(E)||(this.cacheTiles.delete(m),this.onTileUnload(E)),this.onTileUnload(E),E.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}catch(A){o.e(A)}finally{o.f()}}},{key:"pruneRequests",value:function(){var o=[],h=Jf(this.cacheTiles.values()),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;m.isLoading&&!m.isCurrent&&!m.isVisible&&o.push(m)}}catch(A){h.e(A)}finally{h.f()}for(;o.length>0;){var E=o.shift();E.abortLoad()}}},{key:"getTileByLngLat",value:function(o,h,v){var m=this.options.zoomOffset,E=Math.ceil(v)+m,A=Dd(o,h,E),F=this.tiles.filter(function(B){return B.key==="".concat(A[0],"_").concat(A[1],"_").concat(E)});return F[0]}},{key:"destroy",value:function(){var o=Jf(this.cacheTiles.values()),h;try{for(o.s();!(h=o.n()).done;){var v=h.value;v.isLoading&&v.abortLoad()}}catch(m){o.e(m)}finally{o.f()}this.cacheTiles.clear(),this.currentTiles=[],this.removeAllListeners()}},{key:"updateTileVisible",value:function(){var o=this.options.updateStrategy,h=new Map,v=Jf(this.cacheTiles.values()),m;try{for(v.s();!(m=v.n()).done;){var E=m.value;h.set(E.key,E.isVisible),E.isCurrent=!1,E.isVisible=!1}}catch(at){v.e(at)}finally{v.f()}var A=Jf(this.currentTiles),F;try{for(A.s();!(F=A.n()).done;){var B=F.value;B.isCurrent=!0,B.isVisible=!0}}catch(at){A.e(at)}finally{A.f()}var V=Array.from(this.cacheTiles.values());typeof o=="function"?o(V):r0[o](V);var j=!1;Array.from(this.cacheTiles.values()).forEach(function(at){at.isVisible!==h.get(at.key)?(at.isVisibleChange=!0,j=!0):at.isVisibleChange=!1}),j&&this.emit("tile-update")}},{key:"getTileIndices",value:function(o,h){var v=this.options,m=v.tileSize,E=v.extent,A=v.zoomOffset,F=Math.floor(this.options.maxZoom),B=Math.ceil(this.options.minZoom),V=co({maxZoom:F,minZoom:B,zoomOffset:A,tileSize:m,zoom:o,latLonBounds:h,extent:E});return V}},{key:"getTileId",value:function(o,h,v){var m="".concat(o,",").concat(h,",").concat(v);return m}},{key:"getTile",value:function(o,h,v){var m=this.getTileId(o,h,v),E=this.cacheTiles.get(m);return E}},{key:"createTile",value:function(o,h,v){var m=this.getTileId(o,h,v),E=new Th({x:o,y:h,z:v,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(m,E),E.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),E}},{key:"resizeCacheTiles",value:function(){var o=e0*this.currentTiles.length,h=this.cacheTiles.size>o;if(h){var v=Jf(this.cacheTiles),m;try{for(v.s();!(m=v.n()).done;){var E=(0,ht.Z)(m.value,2),A=E[0],F=E[1];if(!F.isVisible&&!this.currentTiles.includes(F)&&(this.cacheTiles.delete(A),this.onTileUnload(F)),this.cacheTiles.size<=o)break}}catch(B){v.e(B)}finally{v.f()}}this.rebuildTileTree()}},{key:"rebuildTileTree",value:function(){var o=Jf(this.cacheTiles.values()),h;try{for(o.s();!(h=o.n()).done;){var v=h.value;v.parent=null,v.children.length=0}}catch(B){o.e(B)}finally{o.f()}var m=Jf(this.cacheTiles.values()),E;try{for(m.s();!(E=m.n()).done;){var A=E.value,F=this.getNearestAncestor(A.x,A.y,A.z);A.parent=F,F!=null&&F.children&&F.children.push(A)}}catch(B){m.e(B)}finally{m.f()}}},{key:"getNearestAncestor",value:function(o,h,v){for(;v>this.options.minZoom;){o=Math.floor(o/2),h=Math.floor(h/2),v=v-1;var m=this.getTile(o,h,v);if(m)return m}return null}}]),a}(Ie()),qp;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.DEFAULT="DEFAUlTMAP",n.SIMPLE="SIMPLE",n.GLOBEL="GLOBEL"})(qp||(qp={}));function Hm(n,l,a,s,o){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,v=arguments.length>6?arguments[6]:void 0,m=a;return v&&(m=Math.round(a*(h-1))/(h-1)),s?cn(n,l,m,s,o):cn(n,l,m,.314,o)}function kt(n,l){var a=1-l;return(n[0]*a+n[1]*l)*a+(n[1]*a+n[2]*l)*l}function Ze(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function dr(n,l,a){var s=[l[0]-n[0],l[1]-n[1]],o=Ze(s,[0,0]),h=Math.atan2(s[1],s[0]),v=o/2/Math.cos(a),m=h+a,E=[v*Math.cos(m)+n[0],v*Math.sin(m)+n[1]];return E}function cn(n,l,a,s,o){if(o===Version["GAODE2.x"]){var h=amap2Project(n[0],n[1]),v=amap2Project(l[0],l[1]),m=dr(h,v,s),E=[h[0],m[0],v[0]],A=[h[1],m[1],v[1]];return[].concat(_toConsumableArray(amap2UnProject(kt(E,a),kt(A,a))),[0])}else{var F=dr(n,l,s),B=[n[0],F[0],l[0]],V=[n[1],F[1],l[1]];return[kt(B,a),kt(V,a),0]}}function On(n,l,a,s,o){var h=arguments.length>5&&arguments[5]!==void 0?arguments[5]:30,v=arguments.length>6?arguments[6]:void 0,m=a;return v&&(m=Math.round(a*29)/29),Hn(n,l,m,o)}function on(n,l){var a=[l[0]-n[0],l[1]-n[1]],s=calDistance(a,[0,0]),o=Math.atan2(a[1],a[0]),h=.314,v=s/2/Math.cos(h),m=o+h,E=[v*Math.cos(m)+n[0],v*Math.sin(m)+n[1]];return E}function En(n,l){var a=1-l;return(n[0]*a+n[1]*l)*a+(n[1]*a+n[2]*l)*l}function Dn(n,l){var a=[n[0]-l[0],n[1]-l[1]],s=[Math.sin(a[0]/2),Math.sin(a[1]/2)],o=s[1]*s[1]+Math.cos(n[1])*Math.cos(l[1])*s[0]*s[0];return 2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))}function Hn(n,l,a,s){var o=[degreesToRadians(n[0]),degreesToRadians(n[1])],h=[degreesToRadians(l[0]),degreesToRadians(l[1])];if(s==="GAODE2.x"){var v=on(o,h),m=[o[0],v[0],h[0]],E=[o[1],v[1],h[1]];return[En(m,a),En(E,a),0]}else{var A=Dn(o,h);if(Math.abs(A-Math.PI)<.001)return[(1-a)*o[0]+a*h[0],(1-a)*o[1]+a*h[1]];var F=Math.sin((1-a)*A)/Math.sin(A),B=Math.sin(a*A)/Math.sin(A),V=[Math.sin(o[0]),Math.sin(o[1])],j=[Math.cos(o[0]),Math.cos(o[1])],at=[Math.sin(h[0]),Math.sin(h[1])],ut=[Math.cos(h[0]),Math.cos(h[1])],xt=F*j[1]*j[0]+B*ut[1]*ut[0],Nt=F*j[1]*V[0]+B*ut[1]*at[0],de=F*V[1]+B*at[1];return[radiansToDegrees(Math.atan2(Nt,xt)),radiansToDegrees(Math.atan2(de,Math.sqrt(xt*xt+Nt*Nt)))]}}function Jn(n,l){for(var a=0,s=[],o=0;o<n.length-1;o++){var h=n[o],v=n[o+1],m=ui(h,v),E=a;a+=m,s.push({p1:h,p2:v,totalDistance:a,distance:m,lastTotalDistance:E})}for(var A=a*l,F,B,V=0,j=s;V<j.length;V++){var at=j[V],ut=at.totalDistance;if(ut>A){var xt=at.p1,Nt=at.p2,de=(A-at.lastTotalDistance)/at.distance,fe=ii(Nt,xt,de);F=fe[0],B=fe[1];break}}return{lng:F,lat:B,height:0}}function ii(n,l,a){return[n[0]*a+l[0]*(1-a),n[1]*a+l[1]*(1-a)]}function ui(n,l){return Math.sqrt(Math.pow(n[0]-l[0],2)+Math.pow(n[1]-l[1],2))}function yi(n,l){var a=l.featureId,s=n.data.dataArray;return typeof a=="number"&&(s=s.filter(function(o){var h=o.id;return h===a})),s.map(function(o){var h=ri(o,l);return _objectSpread(_objectSpread({},o),h)})}function qn(n,l){return new Promise(function(a){n.inited?a(yi(n,l)):n.once("update",function(){a(yi(n,l))})})}function ri(n,l){var a=l.offset,s=l.shape,o=l.thetaOffset,h=l.mapVersion,v=l.segmentNumber,m=v===void 0?30:v,E=l.autoFit,A=E===void 0?!0:E,F=n.coordinates;if(s==="line")return pathLineAtOffset(F,a);var B=F[0],V=F[1],j=typeof o=="string"?n[o]||0:o,at;switch(s){case"arc":at=arcLineAtOffset;break;case"greatcircle":at=greatCircleLineAtOffset;break;default:at=arcLineAtOffset}var ut=at(B,V,a,j,h,m,A),xt=_slicedToArray(ut,3),Nt=xt[0],de=xt[1],fe=xt[2];return{lng:Nt,lat:de,height:fe}}var Gr=ot(31745),dn=ot.n(Gr);function Xn(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vi(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vi(n,l){if(!!n){if(typeof n=="string")return Rn(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Rn(n,l)}}function Rn(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Qn=30;function Ti(n){var l=n.characterSet,a=n.getFontWidth,s=n.fontHeight,o=n.buffer,h=n.maxCanvasWidth,v=n.mapping,m=v===void 0?{}:v,E=n.xOffset,A=E===void 0?0:E,F=n.yOffset,B=F===void 0?0:F,V=0,j=A;Array.from(l).forEach(function(ut,xt){if(!m[ut]){var Nt=a(ut,xt);j+Qn>h&&(j=0,V++),m[ut]={x:j,y:B+V*Qn,width:Qn,height:Qn,advance:Nt},j+=Qn}});var at=s+o*2;return{mapping:m,xOffset:j,yOffset:B+V*at,canvasHeight:An(B+(V+1)*at)}}function aa(n,l,a){var s=0,o=0,h=0,v=[],m={},E=Xn(n),A;try{for(E.s();!(A=E.n()).done;){var F=A.value;if(!m[F.id]){var B=F.size;s+B+l>a&&(_n(m,v,o),s=0,o=h+o+l,h=0,v=[]),v.push({icon:F,xOffset:s}),s=s+B+l,h=Math.max(h,B)}}}catch(j){E.e(j)}finally{E.f()}v.length>0&&_n(m,v,o);var V=An(h+o+l);return{mapping:m,canvasHeight:V}}function _n(n,l,a){var s=Xn(l),o;try{for(s.s();!(o=s.n()).done;){var h=o.value,v=h.icon,m=h.xOffset;n[v.id]=(0,q.Z)((0,q.Z)({},v),{},{x:m,y:a,image:v.image,width:v.width,height:v.height})}}catch(E){s.e(E)}finally{s.f()}}function An(n){return Math.pow(2,Math.ceil(Math.log2(n)))}var oi,Ei;function ti(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=xi(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function xi(n,l){if(!!n){if(typeof n=="string")return Mi(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Mi(n,l)}}function Mi(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Ua(n){var l=Yn();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Yn(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ii=Tu(),Li="sans-serif",wa="normal",Da=24,oo=3,Is=.25,zs=8,io=1024,Au=1,Xo=1,Qs=3,su=null;function Tu(){for(var n=[],l=32;l<128;l++)n.push(String.fromCharCode(l));return n}function Js(n,l,a,s){n.font="".concat(s," ").concat(a,"px ").concat(l),n.fillStyle="black",n.textBaseline="middle"}function zu(n,l){for(var a=0;a<n.length;a++)l.data[4*a+3]=n[a]}var Jo=(oi=(0,It.b2)(),oi(Ei=function(n){(0,Zt.Z)(a,n);var l=Ua(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"fontAtlas",void 0),(0,X.Z)((0,st.Z)(s),"iconFontMap",void 0),(0,X.Z)((0,st.Z)(s),"iconFontGlyphs",{}),(0,X.Z)((0,st.Z)(s),"fontOptions",void 0),(0,X.Z)((0,st.Z)(s),"key",void 0),(0,X.Z)((0,st.Z)(s),"cache",new No(Qs)),s}return(0,et.Z)(a,[{key:"scale",get:function(){return Xo}},{key:"canvas",get:function(){var o=this.cache.get(this.key);return o&&o.data}},{key:"mapping",get:function(){var o=this.cache.get(this.key);return o&&o.mapping||{}}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:Li,fontWeight:wa,characterSet:Ii,fontSize:Da,buffer:oo,sdf:!0,cutoff:Is,radius:zs,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(o){var h=this;o.forEach(function(v){h.iconFontGlyphs[v.name]=v.unicode})}},{key:"addIconFont",value:function(o,h){this.iconFontMap.set(o,h)}},{key:"getIconFontKey",value:function(o){return this.iconFontMap.get(o)||o}},{key:"getGlyph",value:function(o){return this.iconFontGlyphs[o]?String.fromCharCode(parseInt(this.iconFontGlyphs[o],16)):""}},{key:"setFontOptions",value:function(o){this.fontOptions=(0,q.Z)((0,q.Z)({},this.fontOptions),o),this.key=this.getKey();var h=this.getNewChars(this.key,this.fontOptions.characterSet),v=this.cache.get(this.key);if(!(v&&h.length===0)){var m=this.generateFontAtlas(this.key,h,v);this.fontAtlas=m,this.cache.set(this.key,m)}}},{key:"addFontFace",value:function(o,h){var v=this,m=document.createElement("style");m.type="text/css",m.innerText=`
        @font-face{
            font-family: '`.concat(o,`';
            src: url('`).concat(h,`') format('woff2'),
            url('`).concat(h,`') format('woff'),
            url('`).concat(h,`') format('truetype');
        }`),m.onload=function(){if(document.fonts)try{document.fonts.load("24px ".concat(o),"L7text"),document.fonts.ready.then(function(){v.emit("fontloaded",{fontFamily:o})})}catch(E){console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 document.fonts !"),console.warn("\u5F53\u524D\u73AF\u5883\u4E0D\u652F\u6301 iconfont !"),console.warn(E)}},document.getElementsByTagName("head")[0].appendChild(m)}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(o,h,v){var m=this.fontOptions,E=m.fontFamily,A=m.fontWeight,F=m.fontSize,B=m.buffer,V=m.sdf,j=m.radius,at=m.cutoff,ut=m.iconfont,xt=v&&v.data;xt||(xt=Co.document.createElement("canvas"),xt.width=io);var Nt=xt.getContext("2d",{willReadFrequently:!0});Js(Nt,E,F,A);var de=Ti((0,q.Z)({getFontWidth:function(Gu){return Nt.measureText(Gu).width},fontHeight:F*Xo,buffer:B,characterSet:h,maxCanvasWidth:io},v&&{mapping:v.mapping,xOffset:v.xOffset,yOffset:v.yOffset})),fe=de.mapping,Ne=de.canvasHeight,Ye=de.xOffset,_r=de.yOffset,Ir=Nt.getImageData(0,0,xt.width,xt.height);if(xt.height=Ne,Nt.putImageData(Ir,0,0),Js(Nt,E,F,A),V){var Nr=new(dn())(F,B,j,at,E,A),Yr=Nt.getImageData(0,0,Nr.size,Nr.size),yn=ti(h),fn;try{for(yn.s();!(fn=yn.n()).done;){var $n=fn.value;if(ut){var di=String.fromCharCode(parseInt($n.replace("&#x","").replace(";",""),16)),Yi=Nr.draw(di);zu(Yi,Yr)}else zu(Nr.draw($n),Yr);Nt.putImageData(Yr,fe[$n].x,fe[$n].y)}}catch(hu){yn.e(hu)}finally{yn.f()}}else{var ho=ti(h),zo;try{for(ho.s();!(zo=ho.n()).done;){var Vs=zo.value;Nt.fillText(Vs,fe[Vs].x,fe[Vs].y+F*Au)}}catch(hu){ho.e(hu)}finally{ho.f()}}return{xOffset:Ye,yOffset:_r,mapping:fe,data:xt,width:xt.width,height:xt.height}}},{key:"getKey",value:function(){return"key";var o,h,v,m,E,A,F,B}},{key:"getNewChars",value:function(o,h){var v=this.cache.get(o);if(!v)return h;var m=[],E=v.mapping,A=new Set(Object.keys(E)),F=new Set(h);return F.forEach(function(B){A.has(B)||m.push(B)}),m}}]),a}(Se.EventEmitter))||Ei),La,tu;function fo(n){var l=Mu();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Mu(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ya=3,eo=1024,Eo=64,wo=(La=(0,It.b2)(),La(tu=function(n){(0,Zt.Z)(a,n);var l=fo(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"canvasHeight",128),(0,X.Z)((0,st.Z)(s),"texture",void 0),(0,X.Z)((0,st.Z)(s),"canvas",void 0),(0,X.Z)((0,st.Z)(s),"iconData",void 0),(0,X.Z)((0,st.Z)(s),"iconMap",void 0),(0,X.Z)((0,st.Z)(s),"ctx",void 0),(0,X.Z)((0,st.Z)(s),"loadingImageCount",0),s}return(0,et.Z)(a,[{key:"isLoading",value:function(){return this.loadingImageCount===0}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=Co.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(){var s=(0,lt.Z)(it().mark(function h(v,m){var E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return E=new Image,this.loadingImageCount++,this.hasImage(v)?console.warn("Image Id already exists"):this.iconData.push({id:v,size:Eo}),this.updateIconMap(),B.next=6,this.loadImage(m);case 6:E=B.sent,A=this.iconData.find(function(V){return V.id===v}),A&&(A.image=E,A.width=E.width,A.height=E.height),this.update();case 10:case"end":return B.stop()}},h,this)}));function o(h,v){return s.apply(this,arguments)}return o}()},{key:"addImageMini",value:function(o,h,v){var m=this,E=v.getSceneConfig().canvas,A=E.createImage();if(this.loadingImageCount++,this.hasImage(o))throw new Error("Image Id already exists");this.iconData.push({id:o,size:Eo}),this.updateIconMap(),this.loadImageMini(h,E).then(function(F){A=F;var B=m.iconData.find(function(V){return V.id===o});B&&(B.image=A,B.width=A.width,B.height=A.height),m.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(o){return this.iconMap.hasOwnProperty(o)}},{key:"removeImage",value:function(o){this.hasImage(o)&&(this.iconData=this.iconData.filter(function(h){return h.id!==o}),delete this.iconMap[o],this.update())}},{key:"destroy",value:function(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}},{key:"loadImage",value:function(o){return new Promise(function(h,v){if(o instanceof HTMLImageElement){h(o);return}var m=new Image;m.crossOrigin="anonymous",m.onload=function(){h(m)},m.onerror=function(){v(new Error("Could not load image at "+o))},m.src=o instanceof File?URL.createObjectURL(o):o})}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var o=this;this.canvas.width=eo,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(h){var v=o.iconMap[h],m=v.x,E=v.y,A=v.image,F=v.width,B=F===void 0?64:F,V=v.height,j=V===void 0?64:V,at=Math.max(B,j),ut=at/Eo,xt=j/ut,Nt=B/ut;A&&o.ctx.drawImage(A,m+(Eo-Nt)/2,E+(Eo-xt)/2,Nt,xt)})}},{key:"updateIconMap",value:function(){var o=aa(this.iconData,ya,eo),h=o.mapping,v=o.canvasHeight;this.iconMap=h,this.canvasHeight=v}},{key:"loadImageMini",value:function(o,h){return new Promise(function(v,m){var E=h.createImage();E.crossOrigin="anonymous",E.onload=function(){v(E)},E.onerror=function(){m(new Error("Could not load image at "+o))},E.src=o})}}]),a}(Se.EventEmitter))||tu),Po=ot(49685);function Je(){var n=new Po.WT(16);return Po.WT!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function an(n){var l=new Po.WT(16);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l[4]=n[4],l[5]=n[5],l[6]=n[6],l[7]=n[7],l[8]=n[8],l[9]=n[9],l[10]=n[10],l[11]=n[11],l[12]=n[12],l[13]=n[13],l[14]=n[14],l[15]=n[15],l}function en(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n}function Ri(n,l,a,s,o,h,v,m,E,A,F,B,V,j,at,ut){var xt=new Po.WT(16);return xt[0]=n,xt[1]=l,xt[2]=a,xt[3]=s,xt[4]=o,xt[5]=h,xt[6]=v,xt[7]=m,xt[8]=E,xt[9]=A,xt[10]=F,xt[11]=B,xt[12]=V,xt[13]=j,xt[14]=at,xt[15]=ut,xt}function so(n,l,a,s,o,h,v,m,E,A,F,B,V,j,at,ut,xt){return n[0]=l,n[1]=a,n[2]=s,n[3]=o,n[4]=h,n[5]=v,n[6]=m,n[7]=E,n[8]=A,n[9]=F,n[10]=B,n[11]=V,n[12]=j,n[13]=at,n[14]=ut,n[15]=xt,n}function qe(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Re(n,l){if(n===l){var a=l[1],s=l[2],o=l[3],h=l[6],v=l[7],m=l[11];n[1]=l[4],n[2]=l[8],n[3]=l[12],n[4]=a,n[6]=l[9],n[7]=l[13],n[8]=s,n[9]=h,n[11]=l[14],n[12]=o,n[13]=v,n[14]=m}else n[0]=l[0],n[1]=l[4],n[2]=l[8],n[3]=l[12],n[4]=l[1],n[5]=l[5],n[6]=l[9],n[7]=l[13],n[8]=l[2],n[9]=l[6],n[10]=l[10],n[11]=l[14],n[12]=l[3],n[13]=l[7],n[14]=l[11],n[15]=l[15];return n}function yr(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=l[4],m=l[5],E=l[6],A=l[7],F=l[8],B=l[9],V=l[10],j=l[11],at=l[12],ut=l[13],xt=l[14],Nt=l[15],de=a*m-s*v,fe=a*E-o*v,Ne=a*A-h*v,Ye=s*E-o*m,_r=s*A-h*m,Ir=o*A-h*E,Nr=F*ut-B*at,Yr=F*xt-V*at,yn=F*Nt-j*at,fn=B*xt-V*ut,$n=B*Nt-j*ut,di=V*Nt-j*xt,Yi=de*di-fe*$n+Ne*fn+Ye*yn-_r*Yr+Ir*Nr;return Yi?(Yi=1/Yi,n[0]=(m*di-E*$n+A*fn)*Yi,n[1]=(o*$n-s*di-h*fn)*Yi,n[2]=(ut*Ir-xt*_r+Nt*Ye)*Yi,n[3]=(V*_r-B*Ir-j*Ye)*Yi,n[4]=(E*yn-v*di-A*Yr)*Yi,n[5]=(a*di-o*yn+h*Yr)*Yi,n[6]=(xt*Ne-at*Ir-Nt*fe)*Yi,n[7]=(F*Ir-V*Ne+j*fe)*Yi,n[8]=(v*$n-m*yn+A*Nr)*Yi,n[9]=(s*yn-a*$n-h*Nr)*Yi,n[10]=(at*_r-ut*Ne+Nt*de)*Yi,n[11]=(B*Ne-F*_r-j*de)*Yi,n[12]=(m*Yr-v*fn-E*Nr)*Yi,n[13]=(a*fn-s*Yr+o*Nr)*Yi,n[14]=(ut*fe-at*Ye-xt*de)*Yi,n[15]=(F*Ye-B*fe+V*de)*Yi,n):null}function Xr(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=l[4],m=l[5],E=l[6],A=l[7],F=l[8],B=l[9],V=l[10],j=l[11],at=l[12],ut=l[13],xt=l[14],Nt=l[15];return n[0]=m*(V*Nt-j*xt)-B*(E*Nt-A*xt)+ut*(E*j-A*V),n[1]=-(s*(V*Nt-j*xt)-B*(o*Nt-h*xt)+ut*(o*j-h*V)),n[2]=s*(E*Nt-A*xt)-m*(o*Nt-h*xt)+ut*(o*A-h*E),n[3]=-(s*(E*j-A*V)-m*(o*j-h*V)+B*(o*A-h*E)),n[4]=-(v*(V*Nt-j*xt)-F*(E*Nt-A*xt)+at*(E*j-A*V)),n[5]=a*(V*Nt-j*xt)-F*(o*Nt-h*xt)+at*(o*j-h*V),n[6]=-(a*(E*Nt-A*xt)-v*(o*Nt-h*xt)+at*(o*A-h*E)),n[7]=a*(E*j-A*V)-v*(o*j-h*V)+F*(o*A-h*E),n[8]=v*(B*Nt-j*ut)-F*(m*Nt-A*ut)+at*(m*j-A*B),n[9]=-(a*(B*Nt-j*ut)-F*(s*Nt-h*ut)+at*(s*j-h*B)),n[10]=a*(m*Nt-A*ut)-v*(s*Nt-h*ut)+at*(s*A-h*m),n[11]=-(a*(m*j-A*B)-v*(s*j-h*B)+F*(s*A-h*m)),n[12]=-(v*(B*xt-V*ut)-F*(m*xt-E*ut)+at*(m*V-E*B)),n[13]=a*(B*xt-V*ut)-F*(s*xt-o*ut)+at*(s*V-o*B),n[14]=-(a*(m*xt-E*ut)-v*(s*xt-o*ut)+at*(s*E-o*m)),n[15]=a*(m*V-E*B)-v*(s*V-o*B)+F*(s*E-o*m),n}function sn(n){var l=n[0],a=n[1],s=n[2],o=n[3],h=n[4],v=n[5],m=n[6],E=n[7],A=n[8],F=n[9],B=n[10],V=n[11],j=n[12],at=n[13],ut=n[14],xt=n[15],Nt=l*v-a*h,de=l*m-s*h,fe=l*E-o*h,Ne=a*m-s*v,Ye=a*E-o*v,_r=s*E-o*m,Ir=A*at-F*j,Nr=A*ut-B*j,Yr=A*xt-V*j,yn=F*ut-B*at,fn=F*xt-V*at,$n=B*xt-V*ut;return Nt*$n-de*fn+fe*yn+Ne*Yr-Ye*Nr+_r*Ir}function mr(n,l,a){var s=l[0],o=l[1],h=l[2],v=l[3],m=l[4],E=l[5],A=l[6],F=l[7],B=l[8],V=l[9],j=l[10],at=l[11],ut=l[12],xt=l[13],Nt=l[14],de=l[15],fe=a[0],Ne=a[1],Ye=a[2],_r=a[3];return n[0]=fe*s+Ne*m+Ye*B+_r*ut,n[1]=fe*o+Ne*E+Ye*V+_r*xt,n[2]=fe*h+Ne*A+Ye*j+_r*Nt,n[3]=fe*v+Ne*F+Ye*at+_r*de,fe=a[4],Ne=a[5],Ye=a[6],_r=a[7],n[4]=fe*s+Ne*m+Ye*B+_r*ut,n[5]=fe*o+Ne*E+Ye*V+_r*xt,n[6]=fe*h+Ne*A+Ye*j+_r*Nt,n[7]=fe*v+Ne*F+Ye*at+_r*de,fe=a[8],Ne=a[9],Ye=a[10],_r=a[11],n[8]=fe*s+Ne*m+Ye*B+_r*ut,n[9]=fe*o+Ne*E+Ye*V+_r*xt,n[10]=fe*h+Ne*A+Ye*j+_r*Nt,n[11]=fe*v+Ne*F+Ye*at+_r*de,fe=a[12],Ne=a[13],Ye=a[14],_r=a[15],n[12]=fe*s+Ne*m+Ye*B+_r*ut,n[13]=fe*o+Ne*E+Ye*V+_r*xt,n[14]=fe*h+Ne*A+Ye*j+_r*Nt,n[15]=fe*v+Ne*F+Ye*at+_r*de,n}function pr(n,l,a){var s=a[0],o=a[1],h=a[2],v,m,E,A,F,B,V,j,at,ut,xt,Nt;return l===n?(n[12]=l[0]*s+l[4]*o+l[8]*h+l[12],n[13]=l[1]*s+l[5]*o+l[9]*h+l[13],n[14]=l[2]*s+l[6]*o+l[10]*h+l[14],n[15]=l[3]*s+l[7]*o+l[11]*h+l[15]):(v=l[0],m=l[1],E=l[2],A=l[3],F=l[4],B=l[5],V=l[6],j=l[7],at=l[8],ut=l[9],xt=l[10],Nt=l[11],n[0]=v,n[1]=m,n[2]=E,n[3]=A,n[4]=F,n[5]=B,n[6]=V,n[7]=j,n[8]=at,n[9]=ut,n[10]=xt,n[11]=Nt,n[12]=v*s+F*o+at*h+l[12],n[13]=m*s+B*o+ut*h+l[13],n[14]=E*s+V*o+xt*h+l[14],n[15]=A*s+j*o+Nt*h+l[15]),n}function kr(n,l,a){var s=a[0],o=a[1],h=a[2];return n[0]=l[0]*s,n[1]=l[1]*s,n[2]=l[2]*s,n[3]=l[3]*s,n[4]=l[4]*o,n[5]=l[5]*o,n[6]=l[6]*o,n[7]=l[7]*o,n[8]=l[8]*h,n[9]=l[9]*h,n[10]=l[10]*h,n[11]=l[11]*h,n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],n}function Ge(n,l,a,s){var o=s[0],h=s[1],v=s[2],m=Math.hypot(o,h,v),E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne,Ye,_r,Ir,Nr,Yr,yn,fn,$n,di,Yi,ho;return m<Po.Ib?null:(m=1/m,o*=m,h*=m,v*=m,E=Math.sin(a),A=Math.cos(a),F=1-A,B=l[0],V=l[1],j=l[2],at=l[3],ut=l[4],xt=l[5],Nt=l[6],de=l[7],fe=l[8],Ne=l[9],Ye=l[10],_r=l[11],Ir=o*o*F+A,Nr=h*o*F+v*E,Yr=v*o*F-h*E,yn=o*h*F-v*E,fn=h*h*F+A,$n=v*h*F+o*E,di=o*v*F+h*E,Yi=h*v*F-o*E,ho=v*v*F+A,n[0]=B*Ir+ut*Nr+fe*Yr,n[1]=V*Ir+xt*Nr+Ne*Yr,n[2]=j*Ir+Nt*Nr+Ye*Yr,n[3]=at*Ir+de*Nr+_r*Yr,n[4]=B*yn+ut*fn+fe*$n,n[5]=V*yn+xt*fn+Ne*$n,n[6]=j*yn+Nt*fn+Ye*$n,n[7]=at*yn+de*fn+_r*$n,n[8]=B*di+ut*Yi+fe*ho,n[9]=V*di+xt*Yi+Ne*ho,n[10]=j*di+Nt*Yi+Ye*ho,n[11]=at*di+de*Yi+_r*ho,l!==n&&(n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n)}function vr(n,l,a){var s=Math.sin(a),o=Math.cos(a),h=l[4],v=l[5],m=l[6],E=l[7],A=l[8],F=l[9],B=l[10],V=l[11];return l!==n&&(n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[4]=h*o+A*s,n[5]=v*o+F*s,n[6]=m*o+B*s,n[7]=E*o+V*s,n[8]=A*o-h*s,n[9]=F*o-v*s,n[10]=B*o-m*s,n[11]=V*o-E*s,n}function tr(n,l,a){var s=Math.sin(a),o=Math.cos(a),h=l[0],v=l[1],m=l[2],E=l[3],A=l[8],F=l[9],B=l[10],V=l[11];return l!==n&&(n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[0]=h*o-A*s,n[1]=v*o-F*s,n[2]=m*o-B*s,n[3]=E*o-V*s,n[8]=h*s+A*o,n[9]=v*s+F*o,n[10]=m*s+B*o,n[11]=E*s+V*o,n}function Hr(n,l,a){var s=Math.sin(a),o=Math.cos(a),h=l[0],v=l[1],m=l[2],E=l[3],A=l[4],F=l[5],B=l[6],V=l[7];return l!==n&&(n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15]),n[0]=h*o+A*s,n[1]=v*o+F*s,n[2]=m*o+B*s,n[3]=E*o+V*s,n[4]=A*o-h*s,n[5]=F*o-v*s,n[6]=B*o-m*s,n[7]=V*o-E*s,n}function Jr(n,l){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=l[0],n[13]=l[1],n[14]=l[2],n[15]=1,n}function Bn(n,l){return n[0]=l[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=l[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=l[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function gi(n,l,a){var s=a[0],o=a[1],h=a[2],v=Math.hypot(s,o,h),m,E,A;return v<Po.Ib?null:(v=1/v,s*=v,o*=v,h*=v,m=Math.sin(l),E=Math.cos(l),A=1-E,n[0]=s*s*A+E,n[1]=o*s*A+h*m,n[2]=h*s*A-o*m,n[3]=0,n[4]=s*o*A-h*m,n[5]=o*o*A+E,n[6]=h*o*A+s*m,n[7]=0,n[8]=s*h*A+o*m,n[9]=o*h*A-s*m,n[10]=h*h*A+E,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)}function mi(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=a,n[7]=0,n[8]=0,n[9]=-a,n[10]=s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function pi(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=s,n[1]=0,n[2]=-a,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=a,n[9]=0,n[10]=s,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function fi(n,l){var a=Math.sin(l),s=Math.cos(l);return n[0]=s,n[1]=a,n[2]=0,n[3]=0,n[4]=-a,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Xi(n,l,a){var s=l[0],o=l[1],h=l[2],v=l[3],m=s+s,E=o+o,A=h+h,F=s*m,B=s*E,V=s*A,j=o*E,at=o*A,ut=h*A,xt=v*m,Nt=v*E,de=v*A;return n[0]=1-(j+ut),n[1]=B+de,n[2]=V-Nt,n[3]=0,n[4]=B-de,n[5]=1-(F+ut),n[6]=at+xt,n[7]=0,n[8]=V+Nt,n[9]=at-xt,n[10]=1-(F+j),n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n}function Pi(n,l){var a=new Po.WT(3),s=-l[0],o=-l[1],h=-l[2],v=l[3],m=l[4],E=l[5],A=l[6],F=l[7],B=s*s+o*o+h*h+v*v;return B>0?(a[0]=(m*v+F*s+E*h-A*o)*2/B,a[1]=(E*v+F*o+A*s-m*h)*2/B,a[2]=(A*v+F*h+m*o-E*s)*2/B):(a[0]=(m*v+F*s+E*h-A*o)*2,a[1]=(E*v+F*o+A*s-m*h)*2,a[2]=(A*v+F*h+m*o-E*s)*2),Xi(n,l,a),n}function Gi(n,l){return n[0]=l[12],n[1]=l[13],n[2]=l[14],n}function kn(n,l){var a=l[0],s=l[1],o=l[2],h=l[4],v=l[5],m=l[6],E=l[8],A=l[9],F=l[10];return n[0]=Math.hypot(a,s,o),n[1]=Math.hypot(h,v,m),n[2]=Math.hypot(E,A,F),n}function Ni(n,l){var a=new Po.WT(3);kn(a,l);var s=1/a[0],o=1/a[1],h=1/a[2],v=l[0]*s,m=l[1]*o,E=l[2]*h,A=l[4]*s,F=l[5]*o,B=l[6]*h,V=l[8]*s,j=l[9]*o,at=l[10]*h,ut=v+F+at,xt=0;return ut>0?(xt=Math.sqrt(ut+1)*2,n[3]=.25*xt,n[0]=(B-j)/xt,n[1]=(V-E)/xt,n[2]=(m-A)/xt):v>F&&v>at?(xt=Math.sqrt(1+v-F-at)*2,n[3]=(B-j)/xt,n[0]=.25*xt,n[1]=(m+A)/xt,n[2]=(V+E)/xt):F>at?(xt=Math.sqrt(1+F-v-at)*2,n[3]=(V-E)/xt,n[0]=(m+A)/xt,n[1]=.25*xt,n[2]=(B+j)/xt):(xt=Math.sqrt(1+at-v-F)*2,n[3]=(m-A)/xt,n[0]=(V+E)/xt,n[1]=(B+j)/xt,n[2]=.25*xt),n}function Ea(n,l,a,s){var o=l[0],h=l[1],v=l[2],m=l[3],E=o+o,A=h+h,F=v+v,B=o*E,V=o*A,j=o*F,at=h*A,ut=h*F,xt=v*F,Nt=m*E,de=m*A,fe=m*F,Ne=s[0],Ye=s[1],_r=s[2];return n[0]=(1-(at+xt))*Ne,n[1]=(V+fe)*Ne,n[2]=(j-de)*Ne,n[3]=0,n[4]=(V-fe)*Ye,n[5]=(1-(B+xt))*Ye,n[6]=(ut+Nt)*Ye,n[7]=0,n[8]=(j+de)*_r,n[9]=(ut-Nt)*_r,n[10]=(1-(B+at))*_r,n[11]=0,n[12]=a[0],n[13]=a[1],n[14]=a[2],n[15]=1,n}function jo(n,l,a,s,o){var h=l[0],v=l[1],m=l[2],E=l[3],A=h+h,F=v+v,B=m+m,V=h*A,j=h*F,at=h*B,ut=v*F,xt=v*B,Nt=m*B,de=E*A,fe=E*F,Ne=E*B,Ye=s[0],_r=s[1],Ir=s[2],Nr=o[0],Yr=o[1],yn=o[2],fn=(1-(ut+Nt))*Ye,$n=(j+Ne)*Ye,di=(at-fe)*Ye,Yi=(j-Ne)*_r,ho=(1-(V+Nt))*_r,zo=(xt+de)*_r,Vs=(at+fe)*Ir,hu=(xt-de)*Ir,Gu=(1-(V+ut))*Ir;return n[0]=fn,n[1]=$n,n[2]=di,n[3]=0,n[4]=Yi,n[5]=ho,n[6]=zo,n[7]=0,n[8]=Vs,n[9]=hu,n[10]=Gu,n[11]=0,n[12]=a[0]+Nr-(fn*Nr+Yi*Yr+Vs*yn),n[13]=a[1]+Yr-($n*Nr+ho*Yr+hu*yn),n[14]=a[2]+yn-(di*Nr+zo*Yr+Gu*yn),n[15]=1,n}function Iu(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=a+a,m=s+s,E=o+o,A=a*v,F=s*v,B=s*m,V=o*v,j=o*m,at=o*E,ut=h*v,xt=h*m,Nt=h*E;return n[0]=1-B-at,n[1]=F+Nt,n[2]=V-xt,n[3]=0,n[4]=F-Nt,n[5]=1-A-at,n[6]=j+ut,n[7]=0,n[8]=V+xt,n[9]=j-ut,n[10]=1-A-B,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function _a(n,l,a,s,o,h,v){var m=1/(a-l),E=1/(o-s),A=1/(h-v);return n[0]=h*2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h*2*E,n[6]=0,n[7]=0,n[8]=(a+l)*m,n[9]=(o+s)*E,n[10]=(v+h)*A,n[11]=-1,n[12]=0,n[13]=0,n[14]=v*h*2*A,n[15]=0,n}function mo(n,l,a,s,o){var h=1/Math.tan(l/2),v;return n[0]=h/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,o!=null&&o!==1/0?(v=1/(s-o),n[10]=(o+s)*v,n[14]=2*o*s*v):(n[10]=-1,n[14]=-2*s),n}var Oc=mo;function Al(n,l,a,s,o){var h=1/Math.tan(l/2),v;return n[0]=h/a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,o!=null&&o!==1/0?(v=1/(s-o),n[10]=o*v,n[14]=o*s*v):(n[10]=-1,n[14]=-s),n}function lf(n,l,a,s){var o=Math.tan(l.upDegrees*Math.PI/180),h=Math.tan(l.downDegrees*Math.PI/180),v=Math.tan(l.leftDegrees*Math.PI/180),m=Math.tan(l.rightDegrees*Math.PI/180),E=2/(v+m),A=2/(o+h);return n[0]=E,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=A,n[6]=0,n[7]=0,n[8]=-((v-m)*E*.5),n[9]=(o-h)*A*.5,n[10]=s/(a-s),n[11]=-1,n[12]=0,n[13]=0,n[14]=s*a/(a-s),n[15]=0,n}function Zl(n,l,a,s,o,h,v){var m=1/(l-a),E=1/(s-o),A=1/(h-v);return n[0]=-2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*A,n[11]=0,n[12]=(l+a)*m,n[13]=(o+s)*E,n[14]=(v+h)*A,n[15]=1,n}var Y0=Zl;function Ll(n,l,a,s,o,h,v){var m=1/(l-a),E=1/(s-o),A=1/(h-v);return n[0]=-2*m,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*E,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=A,n[11]=0,n[12]=(l+a)*m,n[13]=(o+s)*E,n[14]=h*A,n[15]=1,n}function rh(n,l,a,s){var o,h,v,m,E,A,F,B,V,j,at=l[0],ut=l[1],xt=l[2],Nt=s[0],de=s[1],fe=s[2],Ne=a[0],Ye=a[1],_r=a[2];return Math.abs(at-Ne)<Po.Ib&&Math.abs(ut-Ye)<Po.Ib&&Math.abs(xt-_r)<Po.Ib?qe(n):(F=at-Ne,B=ut-Ye,V=xt-_r,j=1/Math.hypot(F,B,V),F*=j,B*=j,V*=j,o=de*V-fe*B,h=fe*F-Nt*V,v=Nt*B-de*F,j=Math.hypot(o,h,v),j?(j=1/j,o*=j,h*=j,v*=j):(o=0,h=0,v=0),m=B*v-V*h,E=V*o-F*v,A=F*h-B*o,j=Math.hypot(m,E,A),j?(j=1/j,m*=j,E*=j,A*=j):(m=0,E=0,A=0),n[0]=o,n[1]=m,n[2]=F,n[3]=0,n[4]=h,n[5]=E,n[6]=B,n[7]=0,n[8]=v,n[9]=A,n[10]=V,n[11]=0,n[12]=-(o*at+h*ut+v*xt),n[13]=-(m*at+E*ut+A*xt),n[14]=-(F*at+B*ut+V*xt),n[15]=1,n)}function cp(n,l,a,s){var o=l[0],h=l[1],v=l[2],m=s[0],E=s[1],A=s[2],F=o-a[0],B=h-a[1],V=v-a[2],j=F*F+B*B+V*V;j>0&&(j=1/Math.sqrt(j),F*=j,B*=j,V*=j);var at=E*V-A*B,ut=A*F-m*V,xt=m*B-E*F;return j=at*at+ut*ut+xt*xt,j>0&&(j=1/Math.sqrt(j),at*=j,ut*=j,xt*=j),n[0]=at,n[1]=ut,n[2]=xt,n[3]=0,n[4]=B*xt-V*ut,n[5]=V*at-F*xt,n[6]=F*ut-B*at,n[7]=0,n[8]=F,n[9]=B,n[10]=V,n[11]=0,n[12]=o,n[13]=h,n[14]=v,n[15]=1,n}function gv(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function ku(n){return Math.hypot(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}function mv(n,l,a){return n[0]=l[0]+a[0],n[1]=l[1]+a[1],n[2]=l[2]+a[2],n[3]=l[3]+a[3],n[4]=l[4]+a[4],n[5]=l[5]+a[5],n[6]=l[6]+a[6],n[7]=l[7]+a[7],n[8]=l[8]+a[8],n[9]=l[9]+a[9],n[10]=l[10]+a[10],n[11]=l[11]+a[11],n[12]=l[12]+a[12],n[13]=l[13]+a[13],n[14]=l[14]+a[14],n[15]=l[15]+a[15],n}function Mh(n,l,a){return n[0]=l[0]-a[0],n[1]=l[1]-a[1],n[2]=l[2]-a[2],n[3]=l[3]-a[3],n[4]=l[4]-a[4],n[5]=l[5]-a[5],n[6]=l[6]-a[6],n[7]=l[7]-a[7],n[8]=l[8]-a[8],n[9]=l[9]-a[9],n[10]=l[10]-a[10],n[11]=l[11]-a[11],n[12]=l[12]-a[12],n[13]=l[13]-a[13],n[14]=l[14]-a[14],n[15]=l[15]-a[15],n}function i0(n,l,a){return n[0]=l[0]*a,n[1]=l[1]*a,n[2]=l[2]*a,n[3]=l[3]*a,n[4]=l[4]*a,n[5]=l[5]*a,n[6]=l[6]*a,n[7]=l[7]*a,n[8]=l[8]*a,n[9]=l[9]*a,n[10]=l[10]*a,n[11]=l[11]*a,n[12]=l[12]*a,n[13]=l[13]*a,n[14]=l[14]*a,n[15]=l[15]*a,n}function $0(n,l,a,s){return n[0]=l[0]+a[0]*s,n[1]=l[1]+a[1]*s,n[2]=l[2]+a[2]*s,n[3]=l[3]+a[3]*s,n[4]=l[4]+a[4]*s,n[5]=l[5]+a[5]*s,n[6]=l[6]+a[6]*s,n[7]=l[7]+a[7]*s,n[8]=l[8]+a[8]*s,n[9]=l[9]+a[9]*s,n[10]=l[10]+a[10]*s,n[11]=l[11]+a[11]*s,n[12]=l[12]+a[12]*s,n[13]=l[13]+a[13]*s,n[14]=l[14]+a[14]*s,n[15]=l[15]+a[15]*s,n}function Zg(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]&&n[3]===l[3]&&n[4]===l[4]&&n[5]===l[5]&&n[6]===l[6]&&n[7]===l[7]&&n[8]===l[8]&&n[9]===l[9]&&n[10]===l[10]&&n[11]===l[11]&&n[12]===l[12]&&n[13]===l[13]&&n[14]===l[14]&&n[15]===l[15]}function Kp(n,l){var a=n[0],s=n[1],o=n[2],h=n[3],v=n[4],m=n[5],E=n[6],A=n[7],F=n[8],B=n[9],V=n[10],j=n[11],at=n[12],ut=n[13],xt=n[14],Nt=n[15],de=l[0],fe=l[1],Ne=l[2],Ye=l[3],_r=l[4],Ir=l[5],Nr=l[6],Yr=l[7],yn=l[8],fn=l[9],$n=l[10],di=l[11],Yi=l[12],ho=l[13],zo=l[14],Vs=l[15];return Math.abs(a-de)<=Po.Ib*Math.max(1,Math.abs(a),Math.abs(de))&&Math.abs(s-fe)<=Po.Ib*Math.max(1,Math.abs(s),Math.abs(fe))&&Math.abs(o-Ne)<=Po.Ib*Math.max(1,Math.abs(o),Math.abs(Ne))&&Math.abs(h-Ye)<=Po.Ib*Math.max(1,Math.abs(h),Math.abs(Ye))&&Math.abs(v-_r)<=Po.Ib*Math.max(1,Math.abs(v),Math.abs(_r))&&Math.abs(m-Ir)<=Po.Ib*Math.max(1,Math.abs(m),Math.abs(Ir))&&Math.abs(E-Nr)<=Po.Ib*Math.max(1,Math.abs(E),Math.abs(Nr))&&Math.abs(A-Yr)<=Po.Ib*Math.max(1,Math.abs(A),Math.abs(Yr))&&Math.abs(F-yn)<=Po.Ib*Math.max(1,Math.abs(F),Math.abs(yn))&&Math.abs(B-fn)<=Po.Ib*Math.max(1,Math.abs(B),Math.abs(fn))&&Math.abs(V-$n)<=Po.Ib*Math.max(1,Math.abs(V),Math.abs($n))&&Math.abs(j-di)<=Po.Ib*Math.max(1,Math.abs(j),Math.abs(di))&&Math.abs(at-Yi)<=Po.Ib*Math.max(1,Math.abs(at),Math.abs(Yi))&&Math.abs(ut-ho)<=Po.Ib*Math.max(1,Math.abs(ut),Math.abs(ho))&&Math.abs(xt-zo)<=Po.Ib*Math.max(1,Math.abs(xt),Math.abs(zo))&&Math.abs(Nt-Vs)<=Po.Ib*Math.max(1,Math.abs(Nt),Math.abs(Vs))}var Ih=mr,jm=Mh,Vg,Gg,Lu=(Vg=(0,It.b2)(),Vg(Gg=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"viewport",void 0),(0,X.Z)(this,"overridedViewProjectionMatrix",void 0),(0,X.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,X.Z)(this,"jitteredProjectionMatrix",void 0),(0,X.Z)(this,"viewMatrixInverse",void 0),(0,X.Z)(this,"cameraPosition",void 0)}return(0,et.Z)(n,[{key:"init",value:function(){}},{key:"update",value:function(a){this.viewport=a,this.viewMatrixInverse=Je(),yr(this.viewMatrixInverse,a.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var a=this.viewport.getCenter(),s=(0,ht.Z)(a,2),o=s[0],h=s[1];return[o,h]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}},{key:"setViewProjectionMatrix",value:function(a){this.overridedViewProjectionMatrix=a}},{key:"jitterProjectionMatrix",value:function(a,s){var o=Jr(Je(),[a,s,0]);this.jitteredProjectionMatrix=mr(Je(),o,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=mr(Je(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),n}())||Gg),Vl;(function(n){n.TOPRIGHT="topright",n.TOPLEFT="topleft",n.BOTTOMRIGHT="bottomright",n.BOTTOMLEFT="bottomleft",n.TOPCENTER="topcenter",n.BOTTOMCENTER="bottomcenter",n.LEFTCENTER="leftcenter",n.RIGHTCENTER="rightcenter",n.LEFTTOP="lefttop",n.RIGHTTOP="righttop",n.LEFTBOTTOM="leftbottom",n.RIGHTBOTTOM="rightbottom"})(Vl||(Vl={}));var q0,f;function d(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=y(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function y(n,l){if(!!n){if(typeof n=="string")return T(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return T(n,l)}}function T(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var O={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"},N=(q0=(0,It.b2)(),q0(f=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"container",void 0),(0,X.Z)(this,"controlCorners",void 0),(0,X.Z)(this,"controlContainer",void 0),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"controls",[]),(0,X.Z)(this,"unAddControls",[])}return(0,et.Z)(n,[{key:"init",value:function(a,s){this.container=a.container,this.scene=s,this.mapsService=s.get(Dt.IMapService),this.initControlPos()}},{key:"addControl",value:function(a,s){var o=s.get(Dt.IMapService);o.map?(a.addTo(this.scene),this.controls.push(a)):this.unAddControls.push(a)}},{key:"getControlByName",value:function(a){return this.controls.find(function(s){return s.controlOption.name===a})}},{key:"removeControl",value:function(a){var s=this.controls.indexOf(a);return s>-1&&this.controls.splice(s,1),a.remove(),this}},{key:"addControls",value:function(){var a=this;this.unAddControls.forEach(function(s){s.addTo(a.scene),a.controls.push(s)}),this.unAddControls=[]}},{key:"destroy",value:function(){var a=d(this.controls),s;try{for(a.s();!(s=a.n()).done;){var o=s.value;o.remove()}}catch(h){a.e(h)}finally{a.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var a=this.controlCorners={},s="l7-",o=this.controlContainer=bt("div",s+"control-container",this.container);function h(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],E=m.map(function(A){return s+A}).join(" ");a[m.filter(function(A){return!["row","column"].includes(A)}).join("")]=bt("div",E,o)}function v(m){var E=m.replace(/^(top|bottom|left|right|center)/,"$1-").split("-");return[].concat((0,me.Z)(E),[O[m]])}Object.values(Vl).forEach(function(m){h(v(m))})}},{key:"clearControlPos",value:function(){for(var a in this.controlCorners)this.controlCorners[a]&&nt(this.controlCorners[a]);this.controlContainer&&nt(this.controlContainer)}}]),n}())||f),Z,K,mt=(Z=(0,It.b2)(),Z(K=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"container",void 0),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"markers",[]),(0,X.Z)(this,"markerLayers",[]),(0,X.Z)(this,"unAddMarkers",[]),(0,X.Z)(this,"unAddMarkerLayers",[])}return(0,et.Z)(n,[{key:"addMarkerLayer",value:function(a){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(a),a.addTo(this.scene)):this.unAddMarkerLayers.push(a)}},{key:"removeMarkerLayer",value:function(a){a.destroy(),this.markerLayers.indexOf(a);var s=this.markerLayers.indexOf(a);s>-1&&this.markerLayers.splice(s,1)}},{key:"addMarker",value:function(a){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(a),a.addTo(this.scene)):this.unAddMarkers.push(a)}},{key:"addMarkers",value:function(){var a=this;this.unAddMarkers.forEach(function(s){s.addTo(a.scene),a.markers.push(s)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var a=this;this.unAddMarkerLayers.forEach(function(s){a.markerLayers.push(s),s.addTo(a.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(a){a.remove(),this.markers.indexOf(a);var s=this.markers.indexOf(a);s>-1&&this.markers.splice(s,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(a){this.scene=a,this.mapsService=a.get(Dt.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(a){a.remove()}),this.markers=[],this.markerLayers.forEach(function(a){a.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(a){a.destroy()}}]),n}())||K),Ot,Gt,Kt=(Ot=(0,It.b2)(),Ot(Gt=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"scene",void 0),(0,X.Z)(this,"mapsService",void 0),(0,X.Z)(this,"popups",[]),(0,X.Z)(this,"unAddPopups",[])}return(0,et.Z)(n,[{key:"isMarkerReady",get:function(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}},{key:"removePopup",value:function(a){a!=null&&a.isOpen()&&a.remove();var s=this.popups.indexOf(a);s>-1&&this.popups.splice(s,1);var o=this.unAddPopups.indexOf(a);o>-1&&this.unAddPopups.splice(o,1)}},{key:"destroy",value:function(){this.popups.forEach(function(a){return a.remove()})}},{key:"addPopup",value:function(a){var s=this;a&&a.getOptions().autoClose&&[].concat((0,me.Z)(this.popups),(0,me.Z)(this.unAddPopups)).forEach(function(o){o.getOptions().autoClose&&s.removePopup(o)}),this.isMarkerReady?(a.addTo(this.scene),this.popups.push(a)):this.unAddPopups.push(a),a.on("close",function(){s.removePopup(a)})}},{key:"initPopup",value:function(){var a=this;this.unAddPopups.length&&this.unAddPopups.forEach(function(s){a.addPopup(s),a.unAddPopups=[]})}},{key:"init",value:function(a){this.scene=a,this.mapsService=a.get(Dt.IMapService)}}]),n}())||Gt),pe={MapToken:"\u60A8\u6B63\u5728\u4F7F\u7528 Demo \u6D4B\u8BD5 Token, \u751F\u4EA7\u73AF\u5883\u52A1\u5FC5\u81EA\u884C\u6CE8\u518C Token \u786E\u4FDD\u670D\u52A1\u7A33\u5B9A",SDK:"\u8BF7\u786E\u8BA4\u5F15\u5165\u4E86mapbox-gl api\u4E14\u5728L7\u4E4B\u524D\u5F15\u5165"},Fe=pe,sr,lr,Cr={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},gr={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Ur=(sr=(0,It.b2)(),sr(lr=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"sceneConfigCache",{}),(0,X.Z)(this,"layerConfigCache",{}),(0,X.Z)(this,"layerAttributeConfigCache",{})}return(0,et.Z)(n,[{key:"getSceneConfig",value:function(a){return this.sceneConfigCache[a]}},{key:"getSceneWarninfo",value:function(a){return Fe[a]}},{key:"setSceneConfig",value:function(a,s){this.sceneConfigCache[a]=(0,q.Z)((0,q.Z)({},Cr),s)}},{key:"getLayerConfig",value:function(a){return this.layerConfigCache[a]}},{key:"setLayerConfig",value:function(a,s,o){this.layerConfigCache[s]=(0,q.Z)({},(0,ee.merge)({},this.sceneConfigCache[a],gr,o))}},{key:"getAttributeConfig",value:function(a){return this.layerAttributeConfigCache[a]}},{key:"setAttributeConfig",value:function(a,s){this.layerAttributeConfigCache[a]=(0,q.Z)((0,q.Z)({},this.layerAttributeConfigCache[a]),s)}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),n}())||lr);function Ar(n,l,a,s){!a||Object.defineProperty(n,l,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(s):void 0})}function Dr(n,l,a,s,o){var h={};return Object.keys(s).forEach(function(v){h[v]=s[v]}),h.enumerable=!!h.enumerable,h.configurable=!!h.configurable,("value"in h||h.initializer)&&(h.writable=!0),h=a.slice().reverse().reduce(function(v,m){return m(n,l,v)||v},h),o&&h.initializer!==void 0&&(h.value=h.initializer?h.initializer.call(o):void 0,h.initializer=void 0),h.initializer===void 0&&(Object.defineProperty(n,l,h),h=null),h}function mn(){var n=new Po.WT(4);return Po.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function Fn(n){var l=new glMatrix.ARRAY_TYPE(4);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l[3]=n[3],l}function ni(n,l,a,s){var o=new Po.WT(4);return o[0]=n,o[1]=l,o[2]=a,o[3]=s,o}function ki(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n}function oa(n,l,a,s,o){return n[0]=l,n[1]=a,n[2]=s,n[3]=o,n}function Di(n,l,a){return n[0]=l[0]+a[0],n[1]=l[1]+a[1],n[2]=l[2]+a[2],n[3]=l[3]+a[3],n}function ca(n,l,a){return n[0]=l[0]-a[0],n[1]=l[1]-a[1],n[2]=l[2]-a[2],n[3]=l[3]-a[3],n}function zi(n,l,a){return n[0]=l[0]*a[0],n[1]=l[1]*a[1],n[2]=l[2]*a[2],n[3]=l[3]*a[3],n}function Oa(n,l,a){return n[0]=l[0]/a[0],n[1]=l[1]/a[1],n[2]=l[2]/a[2],n[3]=l[3]/a[3],n}function xa(n,l){return n[0]=Math.ceil(l[0]),n[1]=Math.ceil(l[1]),n[2]=Math.ceil(l[2]),n[3]=Math.ceil(l[3]),n}function Qi(n,l){return n[0]=Math.floor(l[0]),n[1]=Math.floor(l[1]),n[2]=Math.floor(l[2]),n[3]=Math.floor(l[3]),n}function lo(n,l,a){return n[0]=Math.min(l[0],a[0]),n[1]=Math.min(l[1],a[1]),n[2]=Math.min(l[2],a[2]),n[3]=Math.min(l[3],a[3]),n}function Ja(n,l,a){return n[0]=Math.max(l[0],a[0]),n[1]=Math.max(l[1],a[1]),n[2]=Math.max(l[2],a[2]),n[3]=Math.max(l[3],a[3]),n}function To(n,l){return n[0]=Math.round(l[0]),n[1]=Math.round(l[1]),n[2]=Math.round(l[2]),n[3]=Math.round(l[3]),n}function ea(n,l,a){return n[0]=l[0]*a,n[1]=l[1]*a,n[2]=l[2]*a,n[3]=l[3]*a,n}function Zo(n,l,a,s){return n[0]=l[0]+a[0]*s,n[1]=l[1]+a[1]*s,n[2]=l[2]+a[2]*s,n[3]=l[3]+a[3]*s,n}function Es(n,l){var a=l[0]-n[0],s=l[1]-n[1],o=l[2]-n[2],h=l[3]-n[3];return Math.hypot(a,s,o,h)}function uu(n,l){var a=l[0]-n[0],s=l[1]-n[1],o=l[2]-n[2],h=l[3]-n[3];return a*a+s*s+o*o+h*h}function Ws(n){var l=n[0],a=n[1],s=n[2],o=n[3];return Math.hypot(l,a,s,o)}function ks(n){var l=n[0],a=n[1],s=n[2],o=n[3];return l*l+a*a+s*s+o*o}function eu(n,l){return n[0]=-l[0],n[1]=-l[1],n[2]=-l[2],n[3]=-l[3],n}function Qu(n,l){return n[0]=1/l[0],n[1]=1/l[1],n[2]=1/l[2],n[3]=1/l[3],n}function lu(n,l){var a=l[0],s=l[1],o=l[2],h=l[3],v=a*a+s*s+o*o+h*h;return v>0&&(v=1/Math.sqrt(v)),n[0]=a*v,n[1]=s*v,n[2]=o*v,n[3]=h*v,n}function Gl(n,l){return n[0]*l[0]+n[1]*l[1]+n[2]*l[2]+n[3]*l[3]}function us(n,l,a,s){var o=a[0]*s[1]-a[1]*s[0],h=a[0]*s[2]-a[2]*s[0],v=a[0]*s[3]-a[3]*s[0],m=a[1]*s[2]-a[2]*s[1],E=a[1]*s[3]-a[3]*s[1],A=a[2]*s[3]-a[3]*s[2],F=l[0],B=l[1],V=l[2],j=l[3];return n[0]=B*A-V*E+j*m,n[1]=-(F*A)+V*v-j*h,n[2]=F*E-B*v+j*o,n[3]=-(F*m)+B*h-V*o,n}function Hl(n,l,a,s){var o=l[0],h=l[1],v=l[2],m=l[3];return n[0]=o+s*(a[0]-o),n[1]=h+s*(a[1]-h),n[2]=v+s*(a[2]-v),n[3]=m+s*(a[3]-m),n}function mu(n,l){l=l||1;var a,s,o,h,v,m;do a=glMatrix.RANDOM()*2-1,s=glMatrix.RANDOM()*2-1,v=a*a+s*s;while(v>=1);do o=glMatrix.RANDOM()*2-1,h=glMatrix.RANDOM()*2-1,m=o*o+h*h;while(m>=1);var E=Math.sqrt((1-v)/m);return n[0]=l*a,n[1]=l*s,n[2]=l*o*E,n[3]=l*h*E,n}function cu(n,l,a){var s=l[0],o=l[1],h=l[2],v=l[3];return n[0]=a[0]*s+a[4]*o+a[8]*h+a[12]*v,n[1]=a[1]*s+a[5]*o+a[9]*h+a[13]*v,n[2]=a[2]*s+a[6]*o+a[10]*h+a[14]*v,n[3]=a[3]*s+a[7]*o+a[11]*h+a[15]*v,n}function ro(n,l,a){var s=l[0],o=l[1],h=l[2],v=a[0],m=a[1],E=a[2],A=a[3],F=A*s+m*h-E*o,B=A*o+E*s-v*h,V=A*h+v*o-m*s,j=-v*s-m*o-E*h;return n[0]=F*A+j*-v+B*-E-V*-m,n[1]=B*A+j*-m+V*-v-F*-E,n[2]=V*A+j*-E+F*-m-B*-v,n[3]=l[3],n}function va(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n}function ts(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"}function Do(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]&&n[3]===l[3]}function jl(n,l){var a=n[0],s=n[1],o=n[2],h=n[3],v=l[0],m=l[1],E=l[2],A=l[3];return Math.abs(a-v)<=glMatrix.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-m)<=glMatrix.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(o-E)<=glMatrix.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(h-A)<=glMatrix.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))}var Uu=null,ws=null,Pu=null,fu=null,Oo=null,cf=null,ff=null,nh=function(){var n=mn();return function(l,a,s,o,h,v){var m,E;for(a||(a=4),s||(s=0),o?E=Math.min(o*a+s,l.length):E=l.length,m=s;m<E;m+=a)n[0]=l[m],n[1]=l[m+1],n[2]=l[m+2],n[3]=l[m+3],h(n,n,v),l[m]=n[0],l[m+1]=n[1],l[m+2]=n[2],l[m+3]=n[3];return l}}(),ru=Math.PI/180,kh=512,fl=4003e4;function Qp(n){var l=n.latitude,a=l===void 0?0:l,s=n.zoom,o=s===void 0?0:s,h=n.scale,v=n.highPrecision,m=v===void 0?!1:v,E=n.flipY,A=E===void 0?!1:E;h=h!==void 0?h:Math.pow(2,o);var F={},B=kh*h,V=Math.cos(a*ru),j=B/360,at=j/V,ut=B/fl/V;if(F.pixelsPerMeter=[ut,-ut,ut],F.metersPerPixel=[1/ut,-1/ut,1/ut],F.pixelsPerDegree=[j,-at,ut],F.degreesPerPixel=[1/j,-1/at,1/ut],m){var xt=ru*Math.tan(a*ru)/V,Nt=j*xt/2,de=B/fl*xt,fe=de/at*ut;F.pixelsPerDegree2=[0,-Nt,de],F.pixelsPerMeter2=[fe,0,fe],A&&(F.pixelsPerDegree2[1]=-F.pixelsPerDegree2[1],F.pixelsPerMeter2[1]=-F.pixelsPerMeter2[1])}return A&&(F.pixelsPerMeter[1]=-F.pixelsPerMeter[1],F.metersPerPixel[1]=-F.metersPerPixel[1],F.pixelsPerDegree[1]=-F.pixelsPerDegree[1],F.degreesPerPixel[1]=-F.degreesPerPixel[1]),F}var Pl;(function(n){n[n.LNGLAT=1]="LNGLAT",n[n.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",n[n.VECTOR_TILE=3]="VECTOR_TILE",n[n.IDENTITY=4]="IDENTITY",n[n.P20=5]="P20",n[n.P20_OFFSET=6]="P20_OFFSET",n[n.METER_OFFSET=7]="METER_OFFSET",n[n.P20_2=8]="P20_2"})(Pl||(Pl={}));var Lf={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"},ih,Nd,a0,fp,yv,zd=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],_v=(ih=(0,It.b2)(),Nd=(0,It.f3)(Dt.ICameraService),ih(a0=(fp=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"needRefresh",!0),Ar(this,"cameraService",yv,this),(0,X.Z)(this,"coordinateSystem",void 0),(0,X.Z)(this,"viewportCenter",void 0),(0,X.Z)(this,"viewportCenterProjection",void 0),(0,X.Z)(this,"pixelsPerDegree",void 0),(0,X.Z)(this,"pixelsPerDegree2",void 0),(0,X.Z)(this,"pixelsPerMeter",void 0)}return(0,et.Z)(n,[{key:"refresh",value:function(a){var s=this.cameraService.getZoom(),o=this.cameraService.getZoomScale(),h=a||this.cameraService.getCenter(),v=Qp({latitude:h[1],zoom:s}),m=v.pixelsPerMeter,E=v.pixelsPerDegree;this.viewportCenter=h,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=m,this.pixelsPerDegree=E,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Pl.LNGLAT||this.coordinateSystem===Pl.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Pl.LNGLAT_OFFSET?this.calculateLnglatOffset(h,s):this.coordinateSystem===Pl.P20_OFFSET&&this.calculateLnglatOffset(h,s,o,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(a){this.coordinateSystem=a}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(a,s,o,h){var v=Qp({latitude:a[1],zoom:s,scale:o,flipY:h,highPrecision:!0}),m=v.pixelsPerMeter,E=v.pixelsPerDegree,A=v.pixelsPerDegree2,F=this.cameraService.getViewMatrix(),B=this.cameraService.getProjectionMatrix(),V=mr([],B,F),j=this.cameraService.projectFlat([Math.fround(a[0]),Math.fround(a[1])],Math.pow(2,s));this.viewportCenterProjection=cu([],[j[0],j[1],0,1],V),F=this.cameraService.getViewMatrixUncentered()||F,V=mr([],B,F),V=mr([],V,zd),this.cameraService.setViewProjectionMatrix(V),this.pixelsPerMeter=m,this.pixelsPerDegree=E,this.pixelsPerDegree2=A}}]),n}(),yv=Dr(fp.prototype,"cameraService",[Nd],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fp))||a0),yc=ot(20396),hp=ot.n(yc),Zu;(function(n){n.Hover="hover",n.Click="click",n.Select="select",n.Active="active",n.Drag="drag"})(Zu||(Zu={}));var pp,Jp,Ud,Zd,xv;function bv(n){var l=Ev();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ev(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wv={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},td=(pp=(0,It.b2)(),Jp=(0,It.f3)(Dt.IMapService),pp(Ud=(Zd=function(n){(0,Zt.Z)(a,n);var l=bv(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"indragging",!1),Ar((0,st.Z)(s),"mapService",xv,(0,st.Z)(s)),(0,X.Z)((0,st.Z)(s),"hammertime",void 0),(0,X.Z)((0,st.Z)(s),"lastClickTime",0),(0,X.Z)((0,st.Z)(s),"lastClickXY",[-1,-1]),(0,X.Z)((0,st.Z)(s),"clickTimer",void 0),(0,X.Z)((0,st.Z)(s),"$containter",void 0),(0,X.Z)((0,st.Z)(s),"onDrag",function(m){var E=s.interactionEvent(m);E.type=wv[E.type],E.type==="dragging"?s.indragging=!0:s.indragging=!1,s.emit(Zu.Drag,E)}),(0,X.Z)((0,st.Z)(s),"onHammer",function(m){m.srcEvent.stopPropagation();var E=s.interactionEvent(m);s.emit(Zu.Hover,E)}),(0,X.Z)((0,st.Z)(s),"onTouch",function(m){var E=m.touches[0];s.onHover({x:E.pageX,y:E.pageY,type:"touch"})}),(0,X.Z)((0,st.Z)(s),"onHover",function(m){var E=m.clientX,A=m.clientY,F=E,B=A,V=m.type,j=s.mapService.getMapContainer();if(j)if(_u)F=F-j.left-0,B=B-j.top-0;else{var at=j.getBoundingClientRect(),ut=at.top,xt=at.left;F=F-xt-j.clientLeft,B=B-ut-j.clientTop}var Nt=s.mapService.containerToLngLat([F,B]);if(V==="click"){if(!_u&&"ontouchstart"in document.documentElement)return;s.isDoubleTap(F,B,Nt);return}if(V==="touch"){s.isDoubleTap(F,B,Nt);return}V!=="click"&&V!=="dblclick"&&s.emit(Zu.Hover,{x:F,y:B,lngLat:Nt,type:V,target:m})}),s}return(0,et.Z)(a,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(Zu.Hover)}},{key:"triggerHover",value:function(o){var h=o.x,v=o.y;this.emit(Zu.Hover,{x:h,y:v})}},{key:"triggerSelect",value:function(o){this.emit(Zu.Select,{featureId:o})}},{key:"triggerActive",value:function(o){this.emit(Zu.Active,{featureId:o})}},{key:"handleMiniEvent",value:function(o){this.onHover({clientX:o.touches[0].pageX,clientY:o.touches[0].pageY,type:"touch"})}},{key:"addEventListenerOnMap",value:function(){var o=this.mapService.getMapContainer();if(o)if(_u)Co.document.addEventListener("touchstart",this.handleMiniEvent.bind(this));else{var h=new(hp()).Manager(o);h.add(new(hp()).Tap({event:"dblclick",taps:2})),h.add(new(hp()).Tap({event:"click"})),h.add(new(hp()).Pan({threshold:0,pointers:0})),h.add(new(hp()).Press({})),h.on("dblclick click",this.onHammer),h.on("panstart panmove panend pancancel",this.onDrag),o.addEventListener("mousemove",this.onHover),o.addEventListener("mousedown",this.onHover,!0),o.addEventListener("mouseup",this.onHover),o.addEventListener("contextmenu",this.onHover),this.hammertime=h}}},{key:"removeEventListenerOnMap",value:function(){if(_u)Co.document.removeEventListener("touchstart",this.handleMiniEvent.bind(this));else{var o=this.mapService.getMapContainer();o&&(o.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),o.removeEventListener("mousedown",this.onHover),o.removeEventListener("mouseup",this.onHover),o.removeEventListener("contextmenu",this.onHover))}}},{key:"interactionEvent",value:function(o){var h=o.type,v=o.pointerType,m,E;v==="touch"?(E=Math.floor(o.pointers[0].clientY),m=Math.floor(o.pointers[0].clientX)):(E=Math.floor(o.srcEvent.y),m=Math.floor(o.srcEvent.x));var A=this.mapService.getMapContainer();if(A){var F=A.getBoundingClientRect(),B=F.top,V=F.left;m-=V,E-=B}var j=this.mapService.containerToLngLat([m,E]);return{x:m,y:E,lngLat:j,type:h,target:o.srcEvent}}},{key:"isDoubleTap",value:function(o,h,v){var m=this,E=new Date().getTime(),A="click";E-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-o)<10&&Math.abs(this.lastClickXY[1]-h)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),A="dblclick",this.emit(Zu.Hover,{x:o,y:h,lngLat:v,type:A})):(this.lastClickTime=E,this.lastClickXY=[o,h],this.clickTimer=setTimeout(function(){A="click",m.emit(Zu.Hover,{x:o,y:h,lngLat:v,type:A})},400))}}]),a}(Ie()),xv=Dr(Zd.prototype,"mapService",[Jp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zd))||Ud),Sv=0;function o0(n){if(_u)return null;var l=n;if(typeof n=="string"&&(l=document.getElementById(n)),l){var a=document.createElement("div");return a.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,a.id="l7-scene-".concat(Sv++),a.classList.add("l7-scene"),l.appendChild(a),a}return null}function Us(n){var l,a,s=!0;return n==null||(l=n.target)===null||l===void 0||(a=l.path)===null||a===void 0||a.map(function(o){if(o!=null&&o.classList){var h;o==null||(h=o.classList)===null||h===void 0||h.forEach(function(v){(v==="l7-marker"||v==="l7-popup")&&(s=!1)})}}),s}var Jt;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.MAX_EXT=32776]="MAX_EXT",n[n.MIN_EXT=32775]="MIN_EXT",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.CULL_FACE=2884]="CULL_FACE",n[n.BLEND=3042]="BLEND",n[n.DITHER=3024]="DITHER",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.TEXTURE1=33985]="TEXTURE1",n[n.TEXTURE2=33986]="TEXTURE2",n[n.TEXTURE3=33987]="TEXTURE3",n[n.TEXTURE4=33988]="TEXTURE4",n[n.TEXTURE5=33989]="TEXTURE5",n[n.TEXTURE6=33990]="TEXTURE6",n[n.TEXTURE7=33991]="TEXTURE7",n[n.TEXTURE8=33992]="TEXTURE8",n[n.TEXTURE9=33993]="TEXTURE9",n[n.TEXTURE10=33994]="TEXTURE10",n[n.TEXTURE11=33995]="TEXTURE11",n[n.TEXTURE12=33996]="TEXTURE12",n[n.TEXTURE13=33997]="TEXTURE13",n[n.TEXTURE14=33998]="TEXTURE14",n[n.TEXTURE15=33999]="TEXTURE15",n[n.TEXTURE16=34e3]="TEXTURE16",n[n.TEXTURE17=34001]="TEXTURE17",n[n.TEXTURE18=34002]="TEXTURE18",n[n.TEXTURE19=34003]="TEXTURE19",n[n.TEXTURE20=34004]="TEXTURE20",n[n.TEXTURE21=34005]="TEXTURE21",n[n.TEXTURE22=34006]="TEXTURE22",n[n.TEXTURE23=34007]="TEXTURE23",n[n.TEXTURE24=34008]="TEXTURE24",n[n.TEXTURE25=34009]="TEXTURE25",n[n.TEXTURE26=34010]="TEXTURE26",n[n.TEXTURE27=34011]="TEXTURE27",n[n.TEXTURE28=34012]="TEXTURE28",n[n.TEXTURE29=34013]="TEXTURE29",n[n.TEXTURE30=34014]="TEXTURE30",n[n.TEXTURE31=34015]="TEXTURE31",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL"})(Jt||(Jt={}));var dp,Cv,vp,Av,gp,K0,Q0,ed,Wm,Hg,_c,hf,Va,Ju=(dp=(0,It.b2)(),Cv=(0,It.f3)(Dt.IMapService),vp=(0,It.f3)(Dt.IRendererService),Av=(0,It.f3)(Dt.IGlobalConfigService),gp=(0,It.f3)(Dt.IInteractionService),K0=(0,It.f3)(Dt.ILayerService),dp(Q0=(ed=function(){function n(){var l=this;(0,ct.Z)(this,n),(0,X.Z)(this,"pickedColors",void 0),(0,X.Z)(this,"pickedTileLayers",[]),Ar(this,"mapService",Wm,this),Ar(this,"rendererService",Hg,this),Ar(this,"configService",_c,this),Ar(this,"interactionService",hf,this),Ar(this,"layerService",Va,this),(0,X.Z)(this,"pickingFBO",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0),(0,X.Z)(this,"alreadyInPicking",!1),(0,X.Z)(this,"pickBufferScale",1),(0,X.Z)(this,"pickFromPickingFBO",function(a,s){var o=s.x,h=s.y,v=s.lngLat,m=s.type,E=s.target,A=!1,F=l.rendererService,B=F.readPixels,V=F.getContainer,j=l.getContainerSize(V()),at=j.width,ut=j.height;at*=Ca,ut*=Ca;var xt=a.getLayerConfig(),Nt=xt.enableHighlight,de=xt.enableSelect,fe=o*Ca,Ne=h*Ca;if(fe>at-1*Ca||fe<0||Ne>ut-1*Ca||Ne<0)return!1;var Ye=B({x:Math.floor(fe/l.pickBufferScale),y:Math.floor((ut-(h+1)*Ca)/l.pickBufferScale),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:l.pickingFBO});if(l.pickedColors=Ye,Ye[0]!==0||Ye[1]!==0||Ye[2]!==0){var _r=cr(Ye),Ir=a.layerPickService.getFeatureById(_r);_r!==a.getCurrentPickId()&&m==="mousemove"&&(m="mouseenter");var Nr={x:o,y:h,type:m,lngLat:v,featureId:_r,feature:Ir,target:E};Ir&&(A=!0,a.setCurrentPickId(_r),l.triggerHoverOnLayer(a,Nr))}else{var Yr={x:o,y:h,lngLat:v,type:a.getCurrentPickId()!==null&&m==="mousemove"?"mouseout":"un"+m,featureId:null,target:E,feature:null};l.triggerHoverOnLayer(a,(0,q.Z)((0,q.Z)({},Yr),{},{type:"unpick"})),l.triggerHoverOnLayer(a,Yr),a.setCurrentPickId(null)}if(Nt&&a.layerPickService.highlightPickedFeature(Ye),de&&m==="click"&&(Ye==null?void 0:Ye.toString())!==[0,0,0,0].toString()){var yn=cr(Ye);a.getCurrentSelectedId()===null||yn!==a.getCurrentSelectedId()?(a.layerPickService.selectFeature(Ye),a.setCurrentSelectedId(yn)):(a.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),a.setCurrentSelectedId(null))}return A})}return(0,et.Z)(n,[{key:"init",value:function(a){var s=this.rendererService,o=s.createTexture2D,h=s.createFramebuffer,v=s.getContainer,m=this.getContainerSize(v()),E=m.width,A=m.height;E*=Ca,A*=Ca,this.pickBufferScale=this.configService.getSceneConfig(a).pickBufferScale||1,this.pickingFBO=h({color:o({width:Math.round(E/this.pickBufferScale),height:Math.round(A/this.pickBufferScale),wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})}),this.interactionService.on(Zu.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:function(){var l=(0,lt.Z)(it().mark(function s(o,h,v){var m=this,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:E=this.rendererService,A=E.useFramebuffer,F=E.clear,this.resizePickingFBO(),A(this.pickingFBO,function(){F({framebuffer:m.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),o.hooks.beforePickingEncode.call(),o.renderModels(),o.hooks.afterPickingEncode.call();var j=m.pickBox(o,h);v(j)});case 3:case"end":return V.stop()}},s,this)}));function a(s,o,h){return l.apply(this,arguments)}return a}()},{key:"pickBox",value:function(a,s){var o=this,h=s.map(function(yn){var fn=yn<0?0:yn;return Math.floor(fn*Ca/o.pickBufferScale)}),v=(0,ht.Z)(h,4),m=v[0],E=v[1],A=v[2],F=v[3],B=this.rendererService,V=B.readPixels,j=B.getContainer,at=this.getContainerSize(j()),ut=at.width,xt=at.height;if(ut*=Ca,xt*=Ca,m>(ut-1)*Ca/this.pickBufferScale||A<0||E>(xt-1)*Ca/this.pickBufferScale||F<0)return[];for(var Nt=Math.min(ut/this.pickBufferScale,A)-m,de=Math.min(xt/this.pickBufferScale,F)-E,fe=V({x:m,y:Math.floor(xt/this.pickBufferScale-(F+1)),width:Nt,height:de,data:new Uint8Array(Nt*de*4),framebuffer:this.pickingFBO}),Ne=[],Ye={},_r=0;_r<fe.length/4;_r=_r+1){var Ir=fe.slice(_r*4,_r*4+4),Nr=cr(Ir);if(Nr!==-1&&!Ye[Nr]){var Yr=a.layerPickService.getFeatureById(Nr);Ne.push((0,q.Z)((0,q.Z)({},Yr),{},{pickedFeatureIdx:Nr})),Ye[Nr]=!0}}return Ne}},{key:"handleCursor",value:function(a,s){var o=a.getLayerConfig(),h=o.cursor,v=h===void 0?"":h,m=o.cursorEnabled;if(m){var E=this.mapService.version,A=E==="GAODE2.x"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),F=A==null?void 0:A.style.getPropertyValue("cursor");s==="unmousemove"&&F!==""?A==null||A.style.setProperty("cursor",""):s==="mousemove"&&(A==null||A.style.setProperty("cursor",v))}}},{key:"destroy",value:function(){this.pickingFBO.destroy(),this.pickingFBO=null}},{key:"getContainerSize",value:function(a){return a.getContext?{width:a.width/Ca,height:a.height/Ca}:a.getBoundingClientRect()}},{key:"pickingAllLayer",value:function(){var l=(0,lt.Z)(it().mark(function s(o){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(!this.layerService.needPick(o.type)||!this.isPickingAllLayer())){v.next=2;break}return v.abrupt("return");case 2:return this.alreadyInPicking=!0,v.next=5,this.pickingLayers(o);case 5:this.layerService.renderLayers(),this.alreadyInPicking=!1;case 7:case"end":return v.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"isPickingAllLayer",value:function(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}},{key:"resizePickingFBO",value:function(){var a=this.rendererService.getContainer,s=this.getContainerSize(a()),o=s.width,h=s.height;o*=Ca,h*=Ca,(this.width!==o||this.height!==h)&&(this.pickingFBO.resize({width:Math.round(o/this.pickBufferScale),height:Math.round(h/this.pickBufferScale)}),this.width=o,this.height=h)}},{key:"pickingLayers",value:function(){var l=(0,lt.Z)(it().mark(function s(o){var h=this,v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:v=this.rendererService,m=v.useFramebuffer,E=v.clear,this.resizePickingFBO(),m(this.pickingFBO,function(){var B=h.layerService.getRenderList();B.filter(function(V){return V.needPick(o.type)}).reverse().some(function(V){E({framebuffer:h.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),V.layerPickService.pickRender(o);var j=h.pickFromPickingFBO(V,o);return h.layerService.pickedLayerId=j?+V.id:-1,j&&!V.getLayerConfig().enablePropagation})});case 3:case"end":return F.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"triggerHoverOnLayer",value:function(a,s){Us(s)&&(this.handleCursor(a,s.type),a.emit(s.type,s))}}]),n}(),Wm=Dr(ed.prototype,"mapService",[Cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hg=Dr(ed.prototype,"rendererService",[vp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c=Dr(ed.prototype,"configService",[Av],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hf=Dr(ed.prototype,"interactionService",[gp],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Va=Dr(ed.prototype,"layerService",[K0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ed))||Q0),Y_=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;(0,ct.Z)(this,n),(0,X.Z)(this,"autoStart",void 0),(0,X.Z)(this,"startTime",0),(0,X.Z)(this,"oldTime",0),(0,X.Z)(this,"running",!1),(0,X.Z)(this,"elapsedTime",0),this.autoStart=l}return(0,et.Z)(n,[{key:"start",value:function(){this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var a=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var s=(typeof performance=="undefined"?Date:performance).now();a=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=a}return a}}]),n}(),mp,J0,jg,s0,Fc,ah,Lh;function tg(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=u0(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function u0(n,l){if(!!n){if(typeof n=="string")return eg(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return eg(n,l)}}function eg(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Xm(n){var l=l0();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function l0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Wg=(mp=(0,It.b2)(),J0=(0,It.f3)(Dt.IRendererService),jg=(0,It.f3)(Dt.IMapService),mp(s0=(Fc=function(n){(0,Zt.Z)(a,n);var l=Xm(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"pickedLayerId",-1),(0,X.Z)((0,st.Z)(s),"clock",new Y_),(0,X.Z)((0,st.Z)(s),"alreadyInRendering",!1),(0,X.Z)((0,st.Z)(s),"layers",[]),(0,X.Z)((0,st.Z)(s),"layerList",[]),(0,X.Z)((0,st.Z)(s),"layerRenderID",void 0),(0,X.Z)((0,st.Z)(s),"sceneInited",!1),(0,X.Z)((0,st.Z)(s),"animateInstanceCount",0),(0,X.Z)((0,st.Z)(s),"shaderPicking",!0),(0,X.Z)((0,st.Z)(s),"enableRender",!0),Ar((0,st.Z)(s),"renderService",ah,(0,st.Z)(s)),Ar((0,st.Z)(s),"mapService",Lh,(0,st.Z)(s)),(0,X.Z)((0,st.Z)(s),"reRender",(0,ee.throttle)(function(){s.updateLayerRenderList(),s.renderLayers()},32)),(0,X.Z)((0,st.Z)(s),"throttleRenderLayers",(0,ee.throttle)(function(){s.renderLayers()},16)),s}return(0,et.Z)(a,[{key:"needPick",value:function(o){return this.layerList.some(function(h){return h.needPick(o)})}},{key:"add",value:function(o){var h=this;this.layers.push(o),this.sceneInited&&o.init().then(function(){h.updateLayerRenderList(),h.renderLayers()})}},{key:"addMask",value:function(o){var h=this;this.sceneInited&&o.init().then(function(){h.renderLayers()})}},{key:"initLayers",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v=this;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:this.sceneInited=!0,this.layers.forEach(function(){var A=(0,lt.Z)(it().mark(function F(B){return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(B.startInit){j.next=4;break}return j.next=3,B.init();case 3:v.updateLayerRenderList();case 4:case"end":return j.stop()}},F)}));return function(F){return A.apply(this,arguments)}}());case 2:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSceneInited",value:function(){return this.sceneInited}},{key:"getRenderList",value:function(){return this.layerList}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(o){return this.layers.find(function(h){return h.id===o})}},{key:"getLayerByName",value:function(o){return this.layers.find(function(h){return h.name===o})}},{key:"remove",value:function(o,h){if(h){var v=h.layerChildren.indexOf(o);v>-1&&h.layerChildren.splice(v,1)}else{var m=this.layers.indexOf(o);m>-1&&this.layers.splice(m,1)}this.updateLayerRenderList(),o.destroy(),this.renderLayers(),this.emit("layerChange",this.layers)}},{key:"removeAllLayers",value:function(){this.destroy(),this.renderLayers()}},{key:"setEnableRender",value:function(o){this.enableRender=o}},{key:"renderLayers",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(!(this.alreadyInRendering||!this.enableRender)){F.next=2;break}return F.abrupt("return");case 2:this.alreadyInRendering=!0,this.clear(),v=tg(this.layerList),F.prev=5,v.s();case 7:if((m=v.n()).done){F.next=19;break}if(E=m.value,E.masks.filter(function(B){return B.inited}).length>0&&(this.renderService.clear({stencil:0,depth:1,framebuffer:null}),E.masks.map(function(){var B=(0,lt.Z)(it().mark(function V(j){return it().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:j.render();case 1:case"end":return ut.stop()}},V)}));return function(V){return B.apply(this,arguments)}}())),!E.getLayerConfig().enableMultiPassRenderer){F.next=15;break}return F.next=13,E.renderMultiPass();case 13:F.next=17;break;case 15:return F.next=17,E.render();case 17:F.next=7;break;case 19:F.next=24;break;case 21:F.prev=21,F.t0=F.catch(5),v.e(F.t0);case 24:return F.prev=24,v.f(),F.finish(24);case 27:this.alreadyInRendering=!1;case 28:case"end":return F.stop()}},h,this,[[5,21,24,27]])}));function o(){return s.apply(this,arguments)}return o}()},{key:"renderMask",value:function(o){o.filter(function(h){return h.inited}).map(function(h){h.render()})}},{key:"beforeRenderData",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,v.hooks.beforeRenderData.promise();case 2:m=A.sent,m&&this.renderLayers();case 4:case"end":return A.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"renderLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m=this;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(v.masks.filter(function(F){return F.inited}).length>0&&v.masks.map(function(F){m.renderService.clear({stencil:0,depth:1,framebuffer:null}),F.render()}),!v.getLayerConfig().enableMultiPassRenderer){A.next=6;break}return A.next=4,v.renderMultiPass();case 4:A.next=8;break;case 6:return A.next=8,v.render();case 8:case"end":return A.stop()}},h)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"updateLayerRenderList",value:function(){var o=this;this.layerList=[],this.layers.filter(function(h){return h.inited}).filter(function(h){return h.isVisible()}).sort(function(h,v){return h.zIndex-v.zIndex}).forEach(function(h){o.layerList.push(h)})}},{key:"destroy",value:function(){this.layers.forEach(function(o){o.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}},{key:"startAnimate",value:function(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"enableShaderPick",value:function(){this.shaderPicking=!0}},{key:"disableShaderPick",value:function(){this.shaderPicking=!1}},{key:"getShaderPickStat",value:function(){return this.shaderPicking}},{key:"clear",value:function(){var o=Le(this.mapService.bgColor);this.renderService.clear({color:o,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers(),this.layerRenderID=Co.requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){Co.cancelAnimationFrame(this.layerRenderID)}}]),a}(Se.EventEmitter),ah=Dr(Fc.prototype,"renderService",[J0],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lh=Dr(Fc.prototype,"mapService",[jg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fc))||s0),Wl=ot(91),Ym=function(){function n(l){var a=this;(0,ct.Z)(this,n),(0,X.Z)(this,"name",void 0),(0,X.Z)(this,"type",void 0),(0,X.Z)(this,"scale",void 0),(0,X.Z)(this,"descriptor",void 0),(0,X.Z)(this,"featureBufferLayout",[]),(0,X.Z)(this,"needRescale",!1),(0,X.Z)(this,"needRemapping",!1),(0,X.Z)(this,"needRegenerateVertices",!1),(0,X.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,X.Z)(this,"vertexAttribute",void 0),(0,X.Z)(this,"defaultCallback",function(s){if(s.length===0){var o;return((o=a.scale)===null||o===void 0?void 0:o.defaultValues)||[]}return s.map(function(h,v){var m,E=(m=a.scale)===null||m===void 0?void 0:m.scalers[v].func,A=E(h);return A})}),this.setProps(l)}return(0,et.Z)(n,[{key:"setProps",value:function(a){Object.assign(this,a)}},{key:"mapping",value:function(a){var s;if((s=this.scale)!==null&&s!==void 0&&s.callback){var o,h=(o=this.scale)===null||o===void 0?void 0:o.callback.apply(o,(0,me.Z)(a));if(!(0,ee.isNil)(h))return[h]}return this.defaultCallback(a)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),n}(),$m=["modelType"],qm=["buffer","update","name"],Rc=["buffer","update","name"],rg=["buffer","update","name"],yp,pf,Xg,Tv,Pf,Ph,rd=(yp={},(0,X.Z)(yp,Jt.FLOAT,4),(0,X.Z)(yp,Jt.UNSIGNED_BYTE,1),(0,X.Z)(yp,Jt.UNSIGNED_SHORT,2),yp),_p=(pf=(0,It.b2)(),Xg=(0,It.f3)(Dt.IRendererService),pf(Tv=(Pf=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"attributesAndIndices",void 0),Ar(this,"rendererService",Ph,this),(0,X.Z)(this,"attributes",[]),(0,X.Z)(this,"triangulation",void 0),(0,X.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,et.Z)(n,[{key:"registerStyleAttribute",value:function(a){var s=this.getLayerStyleAttribute(a.name||"");return s?s.setProps(a):(s=new Ym(a),this.attributes.push(s)),s}},{key:"updateStyleAttribute",value:function(a,s,o){var h=this.getLayerStyleAttribute(a);h||(h=this.registerStyleAttribute((0,q.Z)((0,q.Z)({},s),{},{name:a})));var v=s.scale;v&&h&&(h.scale=v,h.needRescale=!0,h.needRemapping=!0,h.needRegenerateVertices=!0,o&&o.featureRange&&(h.featureRange=o.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(a){return this.attributes.find(function(s){return s.name===a})}},{key:"getLayerAttributeScale",value:function(a){var s,o=this.getLayerStyleAttribute(a),h=o==null||(s=o.scale)===null||s===void 0?void 0:s.scalers;return h&&h[0]?h[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(a,s){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=arguments.length>3?arguments[3]:void 0,v=arguments.length>4?arguments[4]:void 0,m=this.attributes.find(function(Ye){return Ye.name===a});if(m&&m.descriptor){var E=m.descriptor,A=E.update,F=E.buffer,B=E.size,V=B===void 0?0:B,j=rd[F.type||Jt.FLOAT];if(A){var at=this.featureLayout,ut=at.elements,xt=at.sizePerElement,Nt=ut.slice(o,h);if(!Nt.length)return;var de=Nt[0].offset,fe=de*V*j,Ne=Nt.map(function(Ye,_r){for(var Ir=Ye.featureIdx,Nr=Ye.vertices,Yr=Ye.normals,yn=Nr.length/xt,fn=[],$n=0;$n<yn;$n++){var di=Yr?Yr.slice($n*3,$n*3+3):[];fn.push.apply(fn,(0,me.Z)(A(s[Ir],Ir,Nr.slice($n*xt,$n*xt+xt),_r,di)))}return fn}).reduce(function(Ye,_r){return Ye.push.apply(Ye,(0,me.Z)(_r)),Ye},[]);m.vertexAttribute.updateBuffer({data:Ne,offset:fe}),v==null||v.emit("legend:".concat(a),{type:a,attr:m})}}}},{key:"createAttributesAndIndicesAscy",value:function(a,s,o){var h=this;this.featureLayout={sizePerElement:0,elements:[]};var v=this.attributes.map(function(at){return at.resetDescriptor(),at.descriptor}).filter(function(at){return at}),m=o.modelType,E=(0,Wl.Z)(o,$m),A=this.rendererService,F=A.createAttribute,B=A.createBuffer,V=A.createElements,j={};return new Promise(function(at,ut){Pd(m,(0,q.Z)({descriptors:h.getDescriptorsWithOutFunc(v),features:a,segmentNumber:s},E)).then(function(xt){xt.descriptors.forEach(function(de,fe){if(de){var Ne=de.buffer,Ye=de.update,_r=de.name,Ir=(0,Wl.Z)(de,qm),Nr=F((0,q.Z)({buffer:B(Ne)},Ir));j[de.name||""]=Nr,h.attributes[fe].vertexAttribute=Nr}}),h.featureLayout=xt.featureLayout;var Nt=V({data:xt.indices,type:Jt.UNSIGNED_INT,count:xt.indices.length});h.attributesAndIndices={attributes:j,elements:Nt,count:null},at(h.attributesAndIndices)}).catch(function(xt){console.warn(xt),ut(xt)})})}},{key:"createAttributesAndIndices",value:function(a,s,o){var h=this;this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);var v=this.attributes.map(function(fe){return fe.resetDescriptor(),fe.descriptor}),m=0,E=0,A=[],F=[],B=[],V=3;a.forEach(function(fe,Ne){var Ye=h.triangulation(fe,o),_r=Ye.indices,Ir=Ye.vertices,Nr=Ye.normals,Yr=Ye.size,yn=Ye.indexes,fn=Ye.count;typeof fn=="number"&&(E+=fn),_r.forEach(function(ho){F.push(ho+m)}),V=Yr;var $n=Ir.length/Yr;h.featureLayout.sizePerElement=V,h.featureLayout.elements.push({featureIdx:Ne,vertices:Ir,normals:Nr,offset:m}),m+=$n;for(var di=function(zo){var Vs=(Nr==null?void 0:Nr.slice(zo*3,zo*3+3))||[],hu=Ir.slice(zo*Yr,zo*Yr+Yr),Gu=0;yn&&yn[zo]!==void 0&&(Gu=yn[zo]),v.forEach(function(Wh,s2){if(Wh&&Wh.update){var X_;(X_=Wh.buffer.data).push.apply(X_,(0,me.Z)(Wh.update(fe,Ne,hu,zo,Vs,Gu)))}})},Yi=0;Yi<$n;Yi++)di(Yi)});var j=this.rendererService,at=j.createAttribute,ut=j.createBuffer,xt=j.createElements,Nt={};v.forEach(function(fe,Ne){if(fe){var Ye=fe.buffer,_r=fe.update,Ir=fe.name,Nr=(0,Wl.Z)(fe,Rc),Yr=at((0,q.Z)({buffer:ut(Ye)},Nr));Nt[fe.name||""]=Yr,h.attributes[Ne].vertexAttribute=Yr}});var de=xt({data:F,type:Jt.UNSIGNED_INT,count:F.length});return this.attributesAndIndices={attributes:Nt,elements:de,count:E},this.attributesAndIndices}},{key:"createAttributes",value:function(a,s){var o=this;this.featureLayout={sizePerElement:0,elements:[]},s&&(this.triangulation=s);var h=this.attributes.map(function(j){return j.resetDescriptor(),j.descriptor}),v=0,m=[],E=3;a.forEach(function(j,at){var ut=o.triangulation(j),xt=ut.indices,Nt=ut.vertices,de=ut.normals,fe=ut.size,Ne=ut.indexes;xt.forEach(function(Nr){m.push(Nr+v)}),E=fe;var Ye=Nt.length/fe;o.featureLayout.sizePerElement=E,o.featureLayout.elements.push({featureIdx:at,vertices:Nt,normals:de,offset:v}),v+=Ye;for(var _r=function(Yr){var yn=(de==null?void 0:de.slice(Yr*3,Yr*3+3))||[],fn=Nt.slice(Yr*fe,Yr*fe+fe),$n=0;Ne&&Ne[Yr]!==void 0&&($n=Ne[Yr]),h.forEach(function(di,Yi){if(di&&di.update){var ho;(ho=di.buffer.data).push.apply(ho,(0,me.Z)(di.update(j,at,fn,Yr,yn,$n)))}})},Ir=0;Ir<Ye;Ir++)_r(Ir)});var A=this.rendererService,F=A.createAttribute,B=A.createBuffer,V={};return h.forEach(function(j,at){if(j){var ut=j.buffer,xt=j.update,Nt=j.name,de=(0,Wl.Z)(j,rg),fe=F((0,q.Z)({buffer:B(ut)},de));V[j.name||""]=fe,o.attributes[at].vertexAttribute=fe}}),{attributes:V}}},{key:"clearAllAttributes",value:function(){var a;this.attributes.forEach(function(s){s.vertexAttribute&&s.vertexAttribute.destroy()}),(a=this.attributesAndIndices)===null||a===void 0||a.elements.destroy(),this.attributes=[]}},{key:"getDescriptorsWithOutFunc",value:function(a){return a.map(function(s){return{buffer:s.buffer,name:s.name,size:s.size}})}}]),n}(),Ph=Dr(Pf.prototype,"rendererService",[Xg],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pf))||Tv),xp=ot(34155);function c0(n,l,a,s){function o(h){return h instanceof a?h:new a(function(v){v(h)})}return new(a||(a=Promise))(function(h,v){function m(F){try{A(s.next(F))}catch(B){v(B)}}function E(F){try{A(s.throw(F))}catch(B){v(B)}}function A(F){F.done?h(F.value):o(F.value).then(m,E)}A((s=s.apply(n,l||[])).next())})}function Oh(n,l){var a={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},s,o,h,v;return v={next:m(0),throw:m(1),return:m(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function m(A){return function(F){return E([A,F])}}function E(A){if(s)throw new TypeError("Generator is already executing.");for(;a;)try{if(s=1,o&&(h=A[0]&2?o.return:A[0]?o.throw||((h=o.return)&&h.call(o),0):o.next)&&!(h=h.call(o,A[1])).done)return h;switch(o=0,h&&(A=[A[0]&2,h.value]),A[0]){case 0:case 1:h=A;break;case 4:return a.label++,{value:A[1],done:!1};case 5:a.label++,o=A[1],A=[0];continue;case 7:A=a.ops.pop(),a.trys.pop();continue;default:if(h=a.trys,!(h=h.length>0&&h[h.length-1])&&(A[0]===6||A[0]===2)){a=0;continue}if(A[0]===3&&(!h||A[1]>h[0]&&A[1]<h[3])){a.label=A[1];break}if(A[0]===6&&a.label<h[1]){a.label=h[1],h=A;break}if(h&&a.label<h[2]){a.label=h[2],a.ops.push(A);break}h[2]&&a.ops.pop(),a.trys.pop();continue}A=l.call(n,a)}catch(F){A=[6,F],o=0}finally{s=h=0}if(A[0]&5)throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}function Vd(n,l){var a=typeof Symbol=="function"&&n[Symbol.iterator];if(!a)return n;var s=a.call(n),o,h=[],v;try{for(;(l===void 0||l-- >0)&&!(o=s.next()).done;)h.push(o.value)}catch(m){v={error:m}}finally{try{o&&!o.done&&(a=s.return)&&a.call(s)}finally{if(v)throw v.error}}return h}function Gd(n,l,a){if(a||arguments.length===2)for(var s=0,o=l.length,h;s<o;s++)(h||!(s in l))&&(h||(h=Array.prototype.slice.call(l,0,s)),h[s]=l[s]);return n.concat(h||Array.prototype.slice.call(l))}function Mv(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fh={exports:{}},Dc={exports:{}},Iv={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){return s&&typeof s.length=="number"&&s.length>=0&&s.length%1===0}n.exports=l.default})(Iv,Iv.exports);var Ol={},kv={exports:{}},Lv={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(a){return function(){for(var s=[],o=arguments.length;o--;)s[o]=arguments[o];var h=s.pop();return a.call(this,s,h)}},n.exports=l.default})(Lv,Lv.exports);var Rh={};Object.defineProperty(Rh,"__esModule",{value:!0}),Rh.fallback=Kg,Rh.wrap=Pv;var Yg=Rh.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,$g=Rh.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,qg=Rh.hasNextTick=typeof xp=="object"&&typeof xp.nextTick=="function";function Kg(n){setTimeout(n,0)}function Pv(n){return function(l){for(var a=[],s=arguments.length-1;s-- >0;)a[s]=arguments[s+1];return n(function(){return l.apply(void 0,a)})}}var Ov;Yg?Ov=queueMicrotask:$g?Ov=setImmediate:qg?Ov=xp.nextTick:Ov=Kg,Rh.default=Pv(Ov),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=E;var a=Lv.exports,s=m(a),o=Rh,h=m(o),v=Ol;function m(B){return B&&B.__esModule?B:{default:B}}function E(B){return(0,v.isAsync)(B)?function(){for(var V=[],j=arguments.length;j--;)V[j]=arguments[j];var at=V.pop(),ut=B.apply(this,V);return A(ut,at)}:(0,s.default)(function(V,j){var at;try{at=B.apply(this,V)}catch(ut){return j(ut)}if(at&&typeof at.then=="function")return A(at,j);j(null,at)})}function A(B,V){return B.then(function(j){F(V,null,j)},function(j){F(V,j&&j.message?j:new Error(j))})}function F(B,V,j){try{B(V,j)}catch(at){(0,h.default)(function(ut){throw ut},at)}}n.exports=l.default}(kv,kv.exports),Object.defineProperty(Ol,"__esModule",{value:!0}),Ol.isAsyncIterable=Ol.isAsyncGenerator=Ol.isAsync=void 0;var Fv=kv.exports,$_=Of(Fv);function Of(n){return n&&n.__esModule?n:{default:n}}function Km(n){return n[Symbol.toStringTag]==="AsyncFunction"}function q_(n){return n[Symbol.toStringTag]==="AsyncGenerator"}function ng(n){return typeof n[Symbol.asyncIterator]=="function"}function K_(n){if(typeof n!="function")throw new Error("expected a function");return Km(n)?(0,$_.default)(n):n}Ol.default=K_,Ol.isAsync=Km,Ol.isAsyncGenerator=q_,Ol.isAsyncIterable=ng;var Hd={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s,o){if(o===void 0&&(o=s.length),!o)throw new Error("arity is undefined");function h(){for(var v=this,m=[],E=arguments.length;E--;)m[E]=arguments[E];return typeof m[o-1]=="function"?s.apply(this,m):new Promise(function(A,F){m[o-1]=function(B){for(var V=[],j=arguments.length-1;j-- >0;)V[j]=arguments[j+1];if(B)return F(B);A(V.length>1?V:V[0])},s.apply(v,m)})}return h}n.exports=l.default})(Hd,Hd.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Iv.exports,s=E(a),o=Ol,h=E(o),v=Hd.exports,m=E(v);function E(A){return A&&A.__esModule?A:{default:A}}l.default=(0,m.default)(function(A,F,B){var V=(0,s.default)(F)?[]:{};A(F,function(j,at,ut){(0,h.default)(j)(function(xt){for(var Nt,de=[],fe=arguments.length-1;fe-- >0;)de[fe]=arguments[fe+1];de.length<2&&(Nt=de,de=Nt[0]),V[at]=de,ut(xt)})},function(j){return B(j,V)})},3),n.exports=l.default}(Dc,Dc.exports);var ig={exports:{}},ag={exports:{}},Qg={exports:{}},Ls={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){function o(){for(var h=[],v=arguments.length;v--;)h[v]=arguments[v];if(s!==null){var m=s;s=null,m.apply(this,h)}}return Object.assign(o,s),o}n.exports=l.default})(Ls,Ls.exports);var df={exports:{}},og={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(a){return a[Symbol.iterator]&&a[Symbol.iterator]()},n.exports=l.default})(og,og.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=F;var a=Iv.exports,s=v(a),o=og.exports,h=v(o);function v(B){return B&&B.__esModule?B:{default:B}}function m(B){var V=-1,j=B.length;return function(){return++V<j?{value:B[V],key:V}:null}}function E(B){var V=-1;return function(){var at=B.next();return at.done?null:(V++,{value:at.value,key:V})}}function A(B){var V=B?Object.keys(B):[],j=-1,at=V.length;return function ut(){var xt=V[++j];return xt==="__proto__"?ut():j<at?{value:B[xt],key:xt}:null}}function F(B){if((0,s.default)(B))return m(B);var V=(0,h.default)(B);return V?E(V):A(B)}n.exports=l.default}(df,df.exports);var bp={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=a;function a(s){return function(){for(var o=[],h=arguments.length;h--;)o[h]=arguments[h];if(s===null)throw new Error("Callback was already called.");var v=s;s=null,v.apply(this,o)}}n.exports=l.default})(bp,bp.exports);var sg={exports:{}},Jg={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a={};l.default=a,n.exports=l.default})(Jg,Jg.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=h;var a=Jg.exports,s=o(a);function o(v){return v&&v.__esModule?v:{default:v}}function h(v,m,E,A){var F=!1,B=!1,V=!1,j=0,at=0;function ut(){j>=m||V||F||(V=!0,v.next().then(function(de){var fe=de.value,Ne=de.done;if(!(B||F)){if(V=!1,Ne){F=!0,j<=0&&A(null);return}j++,E(fe,at,xt),at++,ut()}}).catch(Nt))}function xt(de,fe){if(j-=1,!B){if(de)return Nt(de);if(de===!1){F=!0,B=!0;return}if(fe===s.default||F&&j<=0)return F=!0,A(null);ut()}}function Nt(de){B||(V=!1,F=!0,A(de))}ut()}n.exports=l.default}(sg,sg.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Ls.exports,s=j(a),o=df.exports,h=j(o),v=bp.exports,m=j(v),E=Ol,A=sg.exports,F=j(A),B=Jg.exports,V=j(B);function j(at){return at&&at.__esModule?at:{default:at}}l.default=function(at){return function(ut,xt,Nt){if(Nt=(0,s.default)(Nt),at<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!ut)return Nt(null);if((0,E.isAsyncGenerator)(ut))return(0,F.default)(ut,at,xt,Nt);if((0,E.isAsyncIterable)(ut))return(0,F.default)(ut[Symbol.asyncIterator](),at,xt,Nt);var de=(0,h.default)(ut),fe=!1,Ne=!1,Ye=0,_r=!1;function Ir(Yr,yn){if(!Ne)if(Ye-=1,Yr)fe=!0,Nt(Yr);else if(Yr===!1)fe=!0,Ne=!0;else{if(yn===V.default||fe&&Ye<=0)return fe=!0,Nt(null);_r||Nr()}}function Nr(){for(_r=!0;Ye<at&&!fe;){var Yr=de();if(Yr===null){fe=!0,Ye<=0&&Nt(null);return}Ye+=1,xt(Yr.value,Yr.key,(0,m.default)(Ir))}_r=!1}Nr()}},n.exports=l.default}(Qg,Qg.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Qg.exports,s=E(a),o=Ol,h=E(o),v=Hd.exports,m=E(v);function E(F){return F&&F.__esModule?F:{default:F}}function A(F,B,V,j){return(0,s.default)(B)(F,(0,h.default)(V),j)}l.default=(0,m.default)(A,4),n.exports=l.default}(ag,ag.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=ag.exports,s=v(a),o=Hd.exports,h=v(o);function v(E){return E&&E.__esModule?E:{default:E}}function m(E,A,F){return(0,s.default)(E,1,A,F)}l.default=(0,h.default)(m,3),n.exports=l.default}(ig,ig.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=m;var a=Dc.exports,s=v(a),o=ig.exports,h=v(o);function v(E){return E&&E.__esModule?E:{default:E}}function m(E,A){return(0,s.default)(h.default,E,A)}n.exports=l.default}(Fh,Fh.exports);var Qm=Mv(Fh.exports),Ep=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.call=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Qm(this.tasks)},n.prototype.tap=function(l,a){var s=this;this.tasks.push(function(o){a.apply(void 0,Gd([],Vd(s.args),!1)),o(null,l)})},n}(),Q_={exports:{}},tm={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Iv.exports,s=xt(a),o=Jg.exports,h=xt(o),v=ag.exports,m=xt(v),E=Ls.exports,A=xt(E),F=bp.exports,B=xt(F),V=Ol,j=xt(V),at=Hd.exports,ut=xt(at);function xt(Ne){return Ne&&Ne.__esModule?Ne:{default:Ne}}function Nt(Ne,Ye,_r){_r=(0,A.default)(_r);var Ir=0,Nr=0,Yr=Ne.length,yn=!1;Yr===0&&_r(null);function fn($n,di){$n===!1&&(yn=!0),yn!==!0&&($n?_r($n):(++Nr===Yr||di===h.default)&&_r(null))}for(;Ir<Yr;Ir++)Ye(Ne[Ir],Ir,(0,B.default)(fn))}function de(Ne,Ye,_r){return(0,m.default)(Ne,1/0,Ye,_r)}function fe(Ne,Ye,_r){var Ir=(0,s.default)(Ne)?Nt:de;return Ir(Ne,(0,j.default)(Ye),_r)}l.default=(0,ut.default)(fe,3),n.exports=l.default})(tm,tm.exports),function(n,l){Object.defineProperty(l,"__esModule",{value:!0}),l.default=m;var a=tm.exports,s=v(a),o=Dc.exports,h=v(o);function v(E){return E&&E.__esModule?E:{default:E}}function m(E,A){return(0,h.default)(s.default,E,A)}n.exports=l.default}(Q_,Q_.exports);var hT=Mv(Q_.exports),pT=function(){function n(){this.tasks=[]}return n.prototype.promise=function(){return hT(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(o){return c0(s,void 0,void 0,function(){return Oh(this,function(h){switch(h.label){case 0:return[4,a()];case 1:return h.sent(),o(null,l),[2]}})})})},n}(),f0={exports:{}};(function(n,l){Object.defineProperty(l,"__esModule",{value:!0});var a=Ls.exports,s=F(a),o=bp.exports,h=F(o),v=Ol,m=F(v),E=Hd.exports,A=F(E);function F(V){return V&&V.__esModule?V:{default:V}}function B(V,j){if(j=(0,s.default)(j),!Array.isArray(V))return j(new Error("First argument to waterfall must be an array of functions"));if(!V.length)return j();var at=0;function ut(Nt){var de=(0,m.default)(V[at++]);de.apply(void 0,Nt.concat([(0,h.default)(xt)]))}function xt(Nt){for(var de=[],fe=arguments.length-1;fe-- >0;)de[fe]=arguments[fe+1];if(Nt!==!1){if(Nt||at===V.length)return j.apply(void 0,[Nt].concat(de));ut(de)}}ut([])}l.default=(0,A.default)(B),n.exports=l.default})(f0,f0.exports);var l2=Mv(f0.exports),lO=function(){function n(){this.tasks=[]}return n.prototype.call=function(){return l2(this.tasks)},n.prototype.tap=function(l,a){this.tasks.length===0?this.tasks.push(function(s){var o=a();s(o?null:!1,o)}):this.tasks.push(function(s,o){var h=a.apply(void 0,Gd([],Vd(s),!1));o(h?null:!1,l)})},n}(),c2=function(){function n(){this.tasks=[]}return n.prototype.call=function(){return Qm(this.tasks)},n.prototype.tap=function(l,a){this.tasks.push(function(s){var o=a();s(o,l)})},n}(),dT=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.promise=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Qm(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(o){return c0(s,void 0,void 0,function(){return Oh(this,function(h){switch(h.label){case 0:return[4,a.apply(void 0,Gd([],Vd(this.args),!1))];case 1:return h.sent(),o(null,l),[2]}})})})},n}(),Jm=function(){function n(){this.args=[],this.tasks=[]}return n.prototype.promise=function(){for(var l=arguments,a=[],s=0;s<arguments.length;s++)a[s]=l[s];return this.args=a,Qm(this.tasks)},n.prototype.tapPromise=function(l,a){var s=this;this.tasks.push(function(o){return c0(s,void 0,void 0,function(){var h;return Oh(this,function(v){switch(v.label){case 0:return[4,a.apply(void 0,Gd([],Vd(this.args),!1))];case 1:return h=v.sent(),o(h,l),[2]}})})})},n}(),f2=function(){function n(){this.tasks=[]}return n.prototype.promise=function(){return l2(this.tasks)},n.prototype.tapPromise=function(l,a){this.tasks.length===0?this.tasks.push(function(s){a().then(function(o){s(null,o)})}):this.tasks.push(function(s,o){a(s).then(function(h){o(null,h)})})},n}(),h2=ot(67709),J_=ot.n(h2),t1,p2,d2,v2,g2,m2,y2,_2,x2,b2,E2,w2,e1,r1,n1,S2,C2,xc,ty,Yo,vT,oh,i1,a1,A2,T2,ug,lg,o1,s1,M2,ey,I2;function Dh(n){var l=gT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var mT=(t1=(0,It.b2)(),p2=(0,It.f3)(Dt.SceneID),d2=(0,It.f3)(Dt.IIconService),v2=(0,It.f3)(Dt.IFontService),g2=(0,It.f3)(Dt.IControlService),m2=(0,It.f3)(Dt.IGlobalConfigService),y2=(0,It.f3)(Dt.IMapService),_2=(0,It.f3)(Dt.ICoordinateSystemService),x2=(0,It.f3)(Dt.IRendererService),b2=(0,It.f3)(Dt.ILayerService),E2=(0,It.f3)(Dt.ICameraService),w2=(0,It.f3)(Dt.IInteractionService),e1=(0,It.f3)(Dt.IPickingService),r1=(0,It.f3)(Dt.IShaderModuleService),n1=(0,It.f3)(Dt.IMarkerService),S2=(0,It.f3)(Dt.IPopupService),t1(C2=(xc=function(n){(0,Zt.Z)(a,n);var l=Dh(a);function a(){var s;return(0,ct.Z)(this,a),s=l.call(this),(0,X.Z)((0,st.Z)(s),"destroyed",!1),(0,X.Z)((0,st.Z)(s),"loaded",!1),Ar((0,st.Z)(s),"id",ty,(0,st.Z)(s)),Ar((0,st.Z)(s),"iconService",Yo,(0,st.Z)(s)),Ar((0,st.Z)(s),"fontService",vT,(0,st.Z)(s)),Ar((0,st.Z)(s),"controlService",oh,(0,st.Z)(s)),Ar((0,st.Z)(s),"configService",i1,(0,st.Z)(s)),Ar((0,st.Z)(s),"map",a1,(0,st.Z)(s)),Ar((0,st.Z)(s),"coordinateSystemService",A2,(0,st.Z)(s)),Ar((0,st.Z)(s),"rendererService",T2,(0,st.Z)(s)),Ar((0,st.Z)(s),"layerService",ug,(0,st.Z)(s)),Ar((0,st.Z)(s),"cameraService",lg,(0,st.Z)(s)),Ar((0,st.Z)(s),"interactionService",o1,(0,st.Z)(s)),Ar((0,st.Z)(s),"pickingService",s1,(0,st.Z)(s)),Ar((0,st.Z)(s),"shaderModuleService",M2,(0,st.Z)(s)),Ar((0,st.Z)(s),"markerService",ey,(0,st.Z)(s)),Ar((0,st.Z)(s),"popupService",I2,(0,st.Z)(s)),(0,X.Z)((0,st.Z)(s),"inited",!1),(0,X.Z)((0,st.Z)(s),"initPromise",void 0),(0,X.Z)((0,st.Z)(s),"rendering",!1),(0,X.Z)((0,st.Z)(s),"$container",void 0),(0,X.Z)((0,st.Z)(s),"canvas",void 0),(0,X.Z)((0,st.Z)(s),"markerContainer",void 0),(0,X.Z)((0,st.Z)(s),"hooks",void 0),(0,X.Z)((0,st.Z)(s),"handleWindowResized",function(){s.emit("resize"),s.$container&&(s.initContainer(),Pa(),s.coordinateSystemService.needRefresh=!0,s.render())}),(0,X.Z)((0,st.Z)(s),"handleMapCameraChanged",function(o){s.cameraService.update(o),s.render()}),s.hooks={init:new dT},s}return(0,et.Z)(a,[{key:"init",value:function(o){var h=this;this.configService.setSceneConfig(this.id,o),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return h.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,lt.Z)(it().mark(function v(){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(A){h.map.onCameraChanged(function(F){h.cameraService.init(),h.cameraService.update(F),A()}),h.map.init()});case 2:h.map.onCameraChanged(h.handleMapCameraChanged),h.map.addMarkerContainer(),h.markerService.addMarkers(),h.markerService.addMarkerLayers(),h.popupService.initPopup(),h.interactionService.init(),h.interactionService.on(Zu.Drag,h.addSceneEvent.bind(h));case 9:case"end":return E.stop()}},v)}))),this.hooks.init.tapPromise("initRenderer",(0,lt.Z)(it().mark(function v(){var m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(m=h.map.getOverlayContainer(),m?h.$container=m:h.$container=o0(h.configService.getSceneConfig(h.id).id||""),!h.$container){F.next=12;break}return h.canvas=bt("canvas","",h.$container),h.setCanvas(),F.next=7,h.rendererService.init(h.canvas,h.configService.getSceneConfig(h.id),o.gl);case 7:h.initContainer(),J_()(h.$container,h.handleWindowResized),Co.matchMedia&&((E=Co.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||E===void 0||E.addListener(h.handleWindowResized)),F.next=13;break;case 12:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 13:h.pickingService.init(h.id);case 14:case"end":return F.stop()}},v)}))),this.render()}},{key:"initMiniScene",value:function(o){var h=this;this.configService.setSceneConfig(this.id,o),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",function(){return h.render()}),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,lt.Z)(it().mark(function v(){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(A){h.map.onCameraChanged(function(F){h.cameraService.init(),h.cameraService.update(F),h.map.version!=="GAODE2.x"&&A()}),h.map.initMiniMap()});case 2:h.map.onCameraChanged(h.handleMapCameraChanged),h.interactionService.init(),h.interactionService.on(Zu.Drag,h.addSceneEvent.bind(h));case 5:case"end":return E.stop()}},v)}))),this.hooks.init.tapPromise("initRenderer",(0,lt.Z)(it().mark(function v(){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(m=o.canvas,h.$container=m||null,!h.$container){A.next=7;break}return A.next=5,h.rendererService.init(o.canvas,h.configService.getSceneConfig(h.id),void 0);case 5:A.next=8;break;case 7:console.error("\u5BB9\u5668 id \u4E0D\u5B58\u5728");case 8:h.pickingService.init(h.id);case 9:case"end":return A.stop()}},v)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(o){this.layerService.sceneService=this,this.layerService.add(o)}},{key:"addMask",value:function(o){this.layerService.sceneService=this,this.layerService.addMask(o)}},{key:"render",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.rendering||this.destroyed)){m.next=2;break}return m.abrupt("return");case 2:if(this.rendering=!0,this.inited){m.next=16;break}return m.next=6,this.hooks.init.promise();case 6:return this.destroyed&&this.destroy(),m.next=9,this.layerService.initLayers();case 9:this.layerService.renderLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0,m.next=20;break;case 16:return m.next=18,this.layerService.initLayers();case 18:return m.next=20,this.layerService.renderLayers();case 20:this.rendering=!1;case 21:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"addFontFace",value:function(o,h){this.fontService.addFontFace(o,h)}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(o){var h,v=(h=this.$container)===null||h===void 0?void 0:h.getElementsByTagName("canvas")[0];this.render();var m=o==="jpg"?v==null?void 0:v.toDataURL("image/jpeg"):v==null?void 0:v.toDataURL("image/png");return m}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"getPointSizeRange",value:function(){return this.rendererService.getPointSizeRange()}},{key:"addMarkerContainer",value:function(){var o=this.$container.parentElement;o!==null&&(this.markerContainer=bt("div","l7-marker-container",o))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var o=this,h,v;if(!this.inited){this.destroyed=!0;return}if((0,h2.unbind)(this.$container,this.handleWindowResized),Co.matchMedia){var m;(m=Co.matchMedia("screen and (min-resolution: 2dppx)"))===null||m===void 0||m.removeListener(this.handleWindowResized)}this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(function(){var E;(E=o.$container)===null||E===void 0||E.removeChild(o.canvas),o.canvas=null,o.rendererService.destroy()}),(h=this.$container)===null||h===void 0||(v=h.parentNode)===null||v===void 0||v.removeChild(this.$container),this.emit("destroy")}},{key:"initContainer",value:function(){var o,h,v=Ca,m=((o=this.$container)===null||o===void 0?void 0:o.clientWidth)||400,E=((h=this.$container)===null||h===void 0?void 0:h.clientHeight)||300,A=this.canvas;A&&(A.width=m*v,A.height=E*v),this.rendererService.viewport({x:0,y:0,width:v*m,height:v*E})}},{key:"setCanvas",value:function(){var o,h,v=Ca,m=((o=this.$container)===null||o===void 0?void 0:o.clientWidth)||400,E=((h=this.$container)===null||h===void 0?void 0:h.clientHeight)||300,A=this.canvas;A.width=m*v,A.height=E*v,A.style.width="100%",A.style.height="100%"}},{key:"addSceneEvent",value:function(o){this.emit(o.type,o)}}]),a}(Se.EventEmitter),ty=Dr(xc.prototype,"id",[p2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Dr(xc.prototype,"iconService",[d2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vT=Dr(xc.prototype,"fontService",[v2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oh=Dr(xc.prototype,"controlService",[g2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i1=Dr(xc.prototype,"configService",[m2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a1=Dr(xc.prototype,"map",[y2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A2=Dr(xc.prototype,"coordinateSystemService",[_2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T2=Dr(xc.prototype,"rendererService",[x2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ug=Dr(xc.prototype,"layerService",[b2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lg=Dr(xc.prototype,"cameraService",[E2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o1=Dr(xc.prototype,"interactionService",[w2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s1=Dr(xc.prototype,"pickingService",[e1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M2=Dr(xc.prototype,"shaderModuleService",[r1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ey=Dr(xc.prototype,"markerService",[n1],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I2=Dr(xc.prototype,"popupService",[S2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xc))||C2);function yT(n){var l=0;switch(n){case"vec2":case"ivec2":l=2;break;case"vec3":case"ivec3":l=3;break;case"vec4":case"ivec4":case"mat2":l=4;break;case"mat3":l=9;break;case"mat4":l=16;break;default:}return l}var _T=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function k2(n){var l={};return n=n.replace(_T,function(a,s,o){var h=o.split(":"),v=h[0].trim(),m="";switch(h.length>1&&(m=h[1].trim()),s){case"bool":m=m==="true";break;case"float":case"int":m=Number(m);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":m?m=m.replace("[","").replace("]","").split(",").reduce(function(E,A){return E.push(Number(A.trim())),E},[]):m=new Array(yT(s)).fill(0);break;default:}return l[v]=m,"uniform ".concat(s," ").concat(v,`;
`)}),{content:n,uniforms:l}}var L2,P2,O2="#define PI 3.14159265359",xT=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,bT=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,ry=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}

// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {
//   vec3 lightDir = normalize(light.position - fragPos);
//   // diffuse shading
//   float diff = max(dot(normal, lightDir), 0.0);
//   // specular shading
//   vec3 reflectDir = reflect(-lightDir, normal);
//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);
//   // attenuation
//   float distance = length(light.position - fragPos);
//   float attenuation = 1.0 / (light.constant + light.linear * distance +
//           light.quadratic * (distance * distance));

//   vec3 ambient = light.ambient * u_Ambient;
//   vec3 diffuse = light.diffuse * diff * u_Diffuse;
//   vec3 specular = light.specular * spec * u_Specular;

//   float spotEffect = dot(normalize(light.direction), -lightDir);
//   float spotCosCutoff = cos(light.angle / 180.0 * PI);
//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);
//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);
//   if (spotEffect > spotCosCutoff) {
//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);
//   } else {
//     spotEffect = 0.0;
//   }

//   return ambient + attenuation * (spotEffect * diffuse + specular);
// }

vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {
  //   if (i >= u_NumOfSpotLights) {
  //     break;
  //   }
  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);
  // }
  return weight;
}
`,F2=`varying vec4 v_PickingResult;
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_shaderPick;

uniform float u_activeMix: 0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  // float selected = v_PickingResult.a;
  bool selected = bool(v_PickingResult.a);

  // if (selected == SELECT) {
  if (selected) {
  //   // \u70B9\u51FB\u9009\u4E2D\u72B6\u6001
  //   vec4 selectColor = u_SelectColor * COLOR_SCALE;
  //   return selectColor;
  // } else if (selected == HIGHLIGHT) {
  //   // hover \u9AD8\u4EAE\u72B6\u6001
    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;

    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));

    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // \u8FC7\u6EE4\u591A\u4F59\u7684 shader \u8BA1\u7B97
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // \u6682\u65F6\u53BB\u9664 \u76F4\u63A5\u53D6\u6D88\u8BA1\u7B97\u5728\u9009\u4E2D\u65F6\u62D6\u62FD\u5730\u56FE\u4F1A\u6709\u95EE\u9898
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,ET=`attribute vec3 a_PickingColor;
varying vec4 v_PickingResult;

uniform vec3 u_PickingColor : [0, 0, 0];
uniform vec3 u_CurrentSelectedId : [0, 0, 0];
uniform vec4 u_HighlightColor : [0, 0, 0, 0];
uniform vec4 u_SelectColor : [0, 0, 0, 0];
uniform float u_PickingStage : 0.0;
uniform float u_PickingThreshold : 1.0;
uniform float u_PickingBuffer: 0.0;
uniform float u_shaderPick;
uniform float u_EnableSelect: 0.0;

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;
}

// \u5224\u65AD\u5F53\u524D\u70B9\u662F\u5426\u5DF2\u7ECF\u88AB select \u9009\u4E2D
bool isVertexSelected(vec3 vertexColor) {
  return
    abs(vertexColor.r - u_CurrentSelectedId.r) < u_PickingThreshold &&
    abs(vertexColor.g - u_CurrentSelectedId.g) < u_PickingThreshold &&
    abs(vertexColor.b - u_CurrentSelectedId.b) < u_PickingThreshold;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));

  // if (u_EnableSelect == 1.0 && u_PickingStage == PICKING_HIGHLIGHT && isVertexSelected(pickingColor)) {
  //   // \u9009\u4E2D\u6001
  //   v_PickingResult.a = SELECT;
  // } else if (u_PickingStage == PICKING_HIGHLIGHT && isVertexPicked(pickingColor)) {
  //   // \u9AD8\u4EAE\u6001
  //   v_PickingResult.a = HIGHLIGHT;
  // } else {
  //   v_PickingResult.a = NORMAL;
  // }

  // Stores the picking color so that the fragment shader can render it during picking
  v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,wT=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // \u7ECF\u7EAC\u5EA6 => \u5E73\u9762\u5750\u6807
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // \u5E73\u9762\u5750\u6807 => \u7ECF\u7EAC\u5EA6
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,ST=`#define TILE_SIZE 512.0
#define PI 3.1415926536
#define WORLD_SCALE TILE_SIZE / (PI * 2.0)

#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0

uniform mat4 u_ViewMatrix;
uniform mat4 u_ProjectionMatrix;
uniform mat4 u_ViewProjectionMatrix;
uniform float u_Zoom : 1;
uniform float u_ZoomScale : 1;

uniform float u_CoordinateSystem;
uniform vec2 u_ViewportCenter;
uniform vec4 u_ViewportCenterProjection;
uniform vec3 u_PixelsPerDegree;
uniform vec3 u_PixelsPerDegree2;
uniform vec3 u_PixelsPerMeter;

uniform vec2 u_ViewportSize;
uniform float u_DevicePixelRatio;
uniform float u_FocalDistance;
uniform vec3 u_CameraPosition;

// uniform mat4 u_Mvp;

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(
    radians(x) + PI,
    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))
  );
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}


// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1., 1.);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01
    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}
// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01
// reverse Y
vec3 reverse_offset_normal(vec3 vector) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {
    return vector * vec3(1.0, -1.0, 1.0);
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0
    return vector;
  }
  return vector;
}

vec4 project_mvt_offset_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return project_offset(vec4(0.0, 0.0, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }
  return position;
}

vec4 project_position(vec4 position) {
  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;
  float b = COORDINATE_SYSTEM_P20_OFFSET;
  float c = COORDINATE_SYSTEM_LNGLAT;
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(vec4(X, Y, position.z, position.w));
  }
  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return vec4(
      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),
      project_scale(position.z),
      position.w
    );
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // return vec4(
    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), 
    //   project_scale(position.z), 
    //   position.w);

     return vec4(
      position.xy, 
      project_scale(position.z), 
      position.w);
  }
  return position;

  // TODO: \u74E6\u7247\u5750\u6807\u7CFB & \u5E38\u89C4\u4E16\u754C\u5750\u6807\u7CFB
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

float project_pixel_allmap(float pixel) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    return pixel * pow(2.0, u_Zoom);
  }
  return pixel;
}

// \u9002\u914D\u7EB9\u7406\u8D34\u56FE\u7684\u7B49\u50CF\u7D20\u5927\u5C0F
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }

  // amap2 zoom > 12
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }

  // amap zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    return pixel * pow(0.5, u_Zoom);
  }
  
  // amap zoom < 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {
    return pixel * pow(2.0, (20.0 - u_Zoom));
  }
  return pixel * 2.0;
}

// \u5728\u4E0D\u8BBA\u4EC0\u4E48\u5E95\u56FE\u4E0B\u9700\u8981\u7EDF\u4E00\u5904\u7406\u7684\u65F6\u5019\u4F7F\u7528
float project_float_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // mapbox P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}

float project_pixel(float pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // amap P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // amap2 P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel;
}
vec2 project_pixel(vec2 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}
vec3 project_pixel(vec3 pixel) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
    // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
    return pixel * pow(2.0, (19.0 - u_Zoom));
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));
  }
  return pixel * -1.;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    // Needs to be divided with project_uCommonUnitsPerMeter
     pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}


bool isEqual( float a,  float b) {
    return  a< b + 0.001 && a > b - 0.001;
}`,CT=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,AT=`attribute float a_vertexId;

uniform mat4 u_cellTypeLayout;      // \u63CF\u8FF0\u6570\u636E\u7EB9\u7406 cell \u7ED3\u6784\u7684\u77E9\u9635
uniform sampler2D u_dataTexture;    // \u6570\u636E\u7EB9\u7406

bool hasOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 opacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeOpacity() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeOpacity \u7684\u6570\u636E
  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStrokeWidth() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 strokeWidth \u7684\u6570\u636E
  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasStroke() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 stroke \u7684\u6570\u636E
  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasOffsets() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 offsets \u7684\u6570\u636E
  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

bool hasThetaOffset() { // \u5224\u65AD cell \u4E2D\u662F\u5426\u5B58\u5728 thetaOffset \u7684\u6570\u636E
  return u_cellTypeLayout[2][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;
}

// \u6839\u636E\u5750\u6807\u4F4D\u7F6E\u5148\u662F\u8BA1\u7B97 uv \uFF0C\u7136\u540E\u6839\u636E uv \u4ECE\u6570\u636E\u7EB9\u7406\u4E2D\u53D6\u503C
float pos2value(vec2 pos, float columnWidth, float rowHeight) {
  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;
  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);
  return texture2D(u_dataTexture, vec2(u, v)).r;
}

/*
  currentRow \u5F53\u524D\u884C
  currentColumn \u5F53\u524D\u5217
  columnCount \u6709\u591A\u5C11\u5217
  nextStep \u9700\u8981\u8BA1\u7B97\u5F53\u524D cell \u540E\u7684\u7B2C\u51E0\u4E2A cell \uFF08\u5F53\u524D cell \u5219 nextStep = 0\uFF09
*/
vec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {
  float nextColumn = currentColumn;
  float nextRow = currentRow;
  if(currentColumn + nextStep <= columnCount){
    nextColumn = currentColumn + nextStep;
  } else {
    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4E0D\u4F1A\u51FA\u73B0\u8DE8\u4E24\u884C
    nextRow = currentRow + 1.0;
  }
  return vec2(nextColumn, nextRow);
}

// \u8BA1\u7B97\u5F53\u524D\u5355\u4E2A cell \u7684\u5927\u5C0F
float calCellCount() { 
  //   u_cellTypeLayout
  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51E0\u884C\u51E0\u5217
  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793A\u6709\u6570\u636E\u6620\u5C04\u30010.0 \u8868\u793A\u6CA1\u6709
  //   1.0, 1.0, 0.0, 0.0, // offsets thetaOffset
  //   0.0, 0.0, 0.0, 0.0
  
  return  u_cellTypeLayout[1][0] +        // opacity
          u_cellTypeLayout[1][1] +        // strokeOpacity
          u_cellTypeLayout[1][2] +        // strokeWidth
          u_cellTypeLayout[1][3] * 4.0 +  // stroke
          u_cellTypeLayout[2][0] * 2.0 +  // offsets
          u_cellTypeLayout[2][1];         // thetaOffset
}`,TT=`
// \u8BA1\u7B97 opacity \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasOpacity()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 opacity \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureOpacity, textureOffset + 1.0);
  }
}
`,MT=`
// \u8BA1\u7B97 strokeOpaicty \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeOpacity()) {
    return vec2(u_stroke_opacity, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeOpacity, textureOffset + 1.0);
  }
}
`,IT=`
// \u8BA1\u7B97 strokeWidth \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasStrokeWidth()) {
    return vec2(u_stroke_width, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureStrokeWidth, textureOffset + 1.0);
  }
}
`,kT=`
// \u8BA1\u7B97 thetaOffset \u548C\u6807\u793A\u5728 cell \u4E2D\u53D6\u503C\u4F4D\u7F6E\u7684\u504F\u79FB\u91CF textureOffset
vec2 calThetaOffsetAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {
  if(!hasThetaOffset()) { // \u6570\u636E\u7EB9\u7406\u4E2D\u4E0D\u5B58\u5728 thetaOffset \u7684\u65F6\u5019\u53D6\u9ED8\u8BA4\u503C\uFF08\u7528\u6237\u5728 style \u4E2D\u4F20\u5165\u7684\u662F\u5E38\u91CF\uFF09
    return vec2(u_thetaOffset, textureOffset);
  } else {
    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    float textureThetaOffset = pos2value(valuePos, columnWidth, rowHeight);
    return vec2(textureThetaOffset, textureOffset + 1.0);
  }
}
`,LT=/precision\s+(high|low|medium)p\s+float/,PT=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,cO=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,OT=(L2=(0,It.b2)(),L2(P2=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"moduleCache",{}),(0,X.Z)(this,"rawContentCache",{})}return(0,et.Z)(n,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:O2,fs:O2}),this.registerModule("decode",{vs:xT,fs:""}),this.registerModule("projection",{vs:ST,fs:""}),this.registerModule("project",{vs:wT,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:CT}),this.registerModule("lighting",{vs:ry,fs:""}),this.registerModule("light",{vs:bT,fs:""}),this.registerModule("picking",{vs:ET,fs:F2}),this.registerModule("styleMapping",{vs:AT,fs:""}),this.registerModule("styleMappingCalThetaOffset",{vs:kT,fs:""}),this.registerModule("styleMappingCalOpacity",{vs:TT,fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:MT,fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:IT,fs:""})}},{key:"registerModule",value:function(a,s){if(!this.rawContentCache[a]){var o=s.vs,h=s.fs,v=s.uniforms,m=k2(o),E=m.content,A=m.uniforms,F=k2(h),B=F.content,V=F.uniforms;this.rawContentCache[a]={fs:B,uniforms:(0,q.Z)((0,q.Z)((0,q.Z)({},A),V),v),vs:E}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(a){var s=this;if(this.moduleCache[a])return this.moduleCache[a];var o=this.rawContentCache[a].vs,h=this.rawContentCache[a].fs,v=this.processModule(o,[],"vs"),m=v.content,E=v.includeList,A=this.processModule(h,[],"fs"),F=A.content,B=A.includeList,V=F,j=(0,ee.uniq)(E.concat(B).concat(a)).reduce(function(at,ut){return(0,q.Z)((0,q.Z)({},at),s.rawContentCache[ut].uniforms)},{});return LT.test(F)||(V=PT+F),this.moduleCache[a]={fs:V.trim(),uniforms:j,vs:m.trim()},this.moduleCache[a]}},{key:"processModule",value:function(a,s,o){var h=this,v=a.replace(cO,function(m,E){var A=E.split(" "),F=A[0].replace(/"/g,"");if(s.indexOf(F)>-1)return"";var B=h.rawContentCache[F][o];s.push(F);var V=h.processModule(B,s,o),j=V.content;return j});return{content:v,includeList:s}}}]),n}())||P2);function FT(n,l){for(;!Object.prototype.hasOwnProperty.call(n,l)&&(n=(0,b.Z)(n),n!==null););return n}function $o(){return typeof Reflect!="undefined"&&Reflect.get?$o=Reflect.get.bind():$o=function(l,a,s){var o=FT(l,a);if(!!o){var h=Object.getOwnPropertyDescriptor(o,a);return h.get?h.get.call(arguments.length<3?l:s):h.value}},$o.apply(this,arguments)}var jd;(function(n){n.Normal="normal",n.PostProcessing="post-processing"})(jd||(jd={}));var R2,D2,ny=(R2=(0,It.b2)(),R2(D2=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"shaderModuleService",void 0),(0,X.Z)(this,"rendererService",void 0),(0,X.Z)(this,"cameraService",void 0),(0,X.Z)(this,"mapService",void 0),(0,X.Z)(this,"interactionService",void 0),(0,X.Z)(this,"layerService",void 0),(0,X.Z)(this,"config",void 0)}return(0,et.Z)(n,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return jd.Normal}},{key:"init",value:function(a,s){this.config=s,this.rendererService=a.getContainer().get(Dt.IRendererService),this.cameraService=a.getContainer().get(Dt.ICameraService),this.mapService=a.getContainer().get(Dt.IMapService),this.interactionService=a.getContainer().get(Dt.IInteractionService),this.layerService=a.getContainer().get(Dt.ILayerService),this.shaderModuleService=a.getContainer().get(Dt.IShaderModuleService)}},{key:"render",value:function(a){}}]),n}())||D2),B2,N2;function RT(n){var l=DT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function DT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var BT=(B2=(0,It.b2)(),B2(N2=function(n){(0,Zt.Z)(a,n);var l=RT(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),a}(ny))||N2),u1,z2,U2,l1,Z2;function NT(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=zT(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function zT(n,l){if(!!n){if(typeof n=="string")return V2(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return V2(n,l)}}function V2(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var UT=(u1=(0,It.b2)(),z2=(0,It.f3)(Dt.IPostProcessor),u1(U2=(l1=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"passes",[]),Ar(this,"postProcessor",Z2,this),(0,X.Z)(this,"layer",void 0),(0,X.Z)(this,"renderFlag",void 0),(0,X.Z)(this,"width",0),(0,X.Z)(this,"height",0)}return(0,et.Z)(n,[{key:"setLayer",value:function(a){this.layer=a}},{key:"setRenderFlag",value:function(a){this.renderFlag=a}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:function(){var l=(0,lt.Z)(it().mark(function s(){var o,h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:o=NT(this.passes),E.prev=1,o.s();case 3:if((h=o.n()).done){E.next=9;break}return v=h.value,E.next=7,v.render(this.layer);case 7:E.next=3;break;case 9:E.next=14;break;case 11:E.prev=11,E.t0=E.catch(1),o.e(E.t0);case 14:return E.prev=14,o.f(),E.finish(14);case 17:return E.next=19,this.postProcessor.render(this.layer);case 19:case"end":return E.stop()}},s,this,[[1,11,14,17]])}));function a(){return l.apply(this,arguments)}return a}()},{key:"resize",value:function(a,s){(this.width!==a||this.height!==s)&&(this.postProcessor.resize(a,s),this.width=a,this.height=s)}},{key:"add",value:function(a,s){a.getType()===jd.PostProcessing?this.postProcessor.add(a,this.layer,s):(a.init(this.layer,s),this.passes.push(a))}},{key:"insert",value:function(a,s,o){a.init(this.layer,s),this.passes.splice(o,0,a)}},{key:"destroy",value:function(){this.passes.length=0}}]),n}(),Z2=Dr(l1.prototype,"postProcessor",[z2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l1))||U2),G2,c1;function ZT(n){var l=VT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function VT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var GT=(G2=(0,It.b2)(),G2(c1=function(n){(0,Zt.Z)(a,n);var l=ZT(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"pickingFBO",void 0),(0,X.Z)((0,st.Z)(s),"layer",void 0),(0,X.Z)((0,st.Z)(s),"width",0),(0,X.Z)((0,st.Z)(s),"height",0),(0,X.Z)((0,st.Z)(s),"alreadyInRendering",!1),(0,X.Z)((0,st.Z)(s),"pickFromPickingFBO",function(m){var E=m.x,A=m.y,F=m.lngLat,B=m.type;if(!(!s.layer.isVisible()||!s.layer.needPick(B))){var V=s.rendererService,j=V.getViewportSize,at=V.readPixels,ut=V.useFramebuffer,xt=j(),Nt=xt.width,de=xt.height,fe=s.layer.getLayerConfig(),Ne=fe.enableHighlight,Ye=fe.enableSelect,_r=E*Ca,Ir=A*Ca;if(!(_r>Nt||_r<0||Ir>de||Ir<0)){var Nr;ut(s.pickingFBO,function(){var Yr;if(Nr=at({x:Math.round(_r),y:Math.round(de-(A+1)*Ca),width:1,height:1,data:new Uint8Array(1*1*4),framebuffer:s.pickingFBO}),Nr[0]!==0||Nr[1]!==0||Nr[2]!==0){var yn=cr(Nr),fn=s.layer.getSource().getFeatureById(yn),$n={x:E,y:A,type:B,lngLat:F,featureId:yn,feature:fn};fn&&(s.layer.setCurrentPickId(yn),s.triggerHoverOnLayer($n))}else{var di={x:E,y:A,lngLat:F,type:s.layer.getCurrentPickId()===null?"un"+B:"mouseout",featureId:null,feature:null};s.triggerHoverOnLayer((0,q.Z)((0,q.Z)({},di),{},{type:"unpick"})),s.triggerHoverOnLayer(di),s.layer.setCurrentPickId(null)}Ne&&s.highlightPickedFeature(Nr),Ye&&B==="click"&&((Yr=Nr)===null||Yr===void 0?void 0:Yr.toString())!==[0,0,0,0].toString()&&s.selectFeature(Nr)})}}}),s}return(0,et.Z)(a,[{key:"getType",value:function(){return jd.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h),this.layer=o;var v=this.rendererService,m=v.createTexture2D,E=v.createFramebuffer,A=v.getViewportSize,F=A(),B=F.width,V=F.height;this.pickingFBO=E({color:m({width:B,height:V,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})}),this.interactionService.on(Zu.Hover,this.pickFromPickingFBO),this.interactionService.on(Zu.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(Zu.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(o){var h=this;if(!this.alreadyInRendering){var v=this.rendererService,m=v.getViewportSize,E=v.useFramebuffer,A=v.clear,F=m(),B=F.width,V=F.height;this.alreadyInRendering=!0,(this.width!==B||this.height!==V)&&(this.pickingFBO.resize({width:B,height:V}),this.width=B,this.height=V),E(this.pickingFBO,function(){A({framebuffer:h.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var j=h.layer.multiPassRenderer.getRenderFlag();h.layer.multiPassRenderer.setRenderFlag(!1),o.hooks.beforePickingEncode.call(),o.render(),o.hooks.afterPickingEncode.call(),h.layer.multiPassRenderer.setRenderFlag(j),h.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(o){this.layer.emit(o.type,o)}},{key:"highlightPickedFeature",value:function(o){var h=(0,ht.Z)(o,3),v=h[0],m=h[1],E=h[2];this.layer.hooks.beforeHighlight.call([v,m,E]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(o){var h=(0,ht.Z)(o,3),v=h[0],m=h[1],E=h[2];this.layer.hooks.beforeSelect.call([v,m,E]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(o){var h=o.featureId,v=ar(h);this.selectFeature(new Uint8Array(v))}},{key:"highlightFeatureHandle",value:function(o){var h=o.featureId,v=ar(h);this.highlightPickedFeature(new Uint8Array(v))}}]),a}(ny))||c1),H2,j2,W2,f1,X2,HT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,Wd=(H2=(0,It.b2)(),j2=(0,It.f3)(Dt.IShaderModuleService),H2(W2=(f1=function(){function n(){(0,ct.Z)(this,n),Ar(this,"shaderModuleService",X2,this),(0,X.Z)(this,"rendererService",void 0),(0,X.Z)(this,"config",void 0),(0,X.Z)(this,"quad",HT),(0,X.Z)(this,"enabled",!0),(0,X.Z)(this,"renderToScreen",!1),(0,X.Z)(this,"model",void 0),(0,X.Z)(this,"name",void 0),(0,X.Z)(this,"optionsToUpdate",{})}return(0,et.Z)(n,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(a){this.name=a}},{key:"getType",value:function(){return jd.PostProcessing}},{key:"init",value:function(a,s){this.config=s,this.rendererService=a.getContainer().get(Dt.IRendererService),this.shaderModuleService=a.getContainer().get(Dt.IShaderModuleService);var o=this.rendererService,h=o.createAttribute,v=o.createBuffer,m=o.createModel,E=this.setupShaders(),A=E.vs,F=E.fs,B=E.uniforms;this.model=m({vs:A,fs:F,attributes:{a_Position:h({buffer:v({data:[-4,-4,4,-4,0,4],type:Jt.FLOAT}),size:2})},uniforms:(0,q.Z)((0,q.Z)({u_Texture:null},B),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}},{key:"render",value:function(a,s){var o=this,h=a.multiPassRenderer.getPostProcessor(),v=this.rendererService,m=v.useFramebuffer,E=v.getViewportSize,A=v.clear,F=E(),B=F.width,V=F.height;m(this.renderToScreen?null:h.getWriteFBO(),function(){A({framebuffer:h.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});var j=(0,q.Z)({u_BloomFinal:0,u_Texture:h.getReadFBO(),u_ViewportSize:[B,V]},o.convertOptionsToUniforms(o.optionsToUpdate));s&&(j.u_BloomFinal=1,j.u_Texture2=s),o.model.draw({uniforms:j})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(a){this.enabled=a}},{key:"setRenderToScreen",value:function(a){this.renderToScreen=a}},{key:"updateOptions",value:function(a){this.optionsToUpdate=(0,q.Z)((0,q.Z)({},this.optionsToUpdate),a)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(a){var s={};return Object.keys(a).forEach(function(o){(0,ee.isNil)(a[o])||(s["u_".concat((0,ee.upperFirst)((0,ee.camelCase)(o)))]=a[o])}),s}}]),n}(),X2=Dr(f1.prototype,"shaderModuleService",[j2],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f1))||W2),Y2,iy;function jT(n){var l=ay();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ay(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $2=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,fO=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,hO=(Y2=(0,It.b2)(),Y2(iy=function(n){(0,Zt.Z)(a,n);var l=jT(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:fO,fs:$2});var o=this.shaderModuleService.getModule("blur-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,q.Z)((0,q.Z)({},m),{},{u_ViewportSize:[A,F]})}}},{key:"convertOptionsToUniforms",value:function(o){var h={};return(0,ee.isNil)(o.bloomRadius)||(h.u_radius=o.bloomRadius),(0,ee.isNil)(o.bloomIntensity)||(h.u_intensity=o.bloomIntensity),(0,ee.isNil)(o.bloomBaseRadio)||(h.u_baseRadio=o.bloomBaseRadio),h}}]),a}(Wd))||iy),q2,K2;function pO(n){var l=dO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function dO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var WT=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,XT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,YT=(q2=(0,It.b2)(),q2(K2=function(n){(0,Zt.Z)(a,n);var l=pO(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:XT,fs:WT});var o=this.shaderModuleService.getModule("blur-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,q.Z)((0,q.Z)({},m),{},{u_ViewportSize:[A,F]})}}},{key:"convertOptionsToUniforms",value:function(o){var h={};return(0,ee.isNil)(o.blurRadius)||(h.u_BlurDir=[o.blurRadius,0]),h}}]),a}(Wd))||K2),Q2,oy;function h1(n){var l=J2();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function J2(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,$T=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,eE=(Q2=(0,It.b2)(),Q2(oy=function(n){(0,Zt.Z)(a,n);var l=h1(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:$T,fs:tE});var o=this.shaderModuleService.getModule("blur-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,q.Z)((0,q.Z)({},m),{},{u_ViewportSize:[A,F]})}}},{key:"convertOptionsToUniforms",value:function(o){var h={};return(0,ee.isNil)(o.blurRadius)||(h.u_BlurDir=[0,o.blurRadius]),h}}]),a}(Wd))||oy),cg,rE;function vO(n){var l=gO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var qT=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,KT=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,p1=(cg=(0,It.b2)(),cg(rE=function(n){(0,Zt.Z)(a,n);var l=vO(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:KT,fs:qT});var o=this.shaderModuleService.getModule("colorhalftone-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,q.Z)((0,q.Z)({},m),{},{u_ViewportSize:[A,F]})}}}]),a}(Wd))||rE),nE,iE;function QT(n){var l=JT();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function JT(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var aE=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,tM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,d1=(nE=(0,It.b2)(),nE(iE=function(n){(0,Zt.Z)(a,n);var l=QT(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:tM,fs:aE}),this.shaderModuleService.getModule("copy-pass")}}]),a}(Wd))||iE),eM,rM;function nM(n){var l=iM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function iM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var aM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,mO=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,yO=(eM=(0,It.b2)(),eM(rM=function(n){(0,Zt.Z)(a,n);var l=nM(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:mO,fs:aM});var o=this.shaderModuleService.getModule("hexagonalpixelate-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,q.Z)((0,q.Z)({},m),{},{u_ViewportSize:[A,F]})}}}]),a}(Wd))||rM),oE,sE;function _O(n){var l=xO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function xO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var oM=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,sM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,uM=(oE=(0,It.b2)(),oE(sE=function(n){(0,Zt.Z)(a,n);var l=_O(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:sM,fs:oM});var o=this.shaderModuleService.getModule("ink-pass"),h=o.vs,v=o.fs,m=o.uniforms,E=this.rendererService.getViewportSize(),A=E.width,F=E.height;return{vs:h,fs:v,uniforms:(0,q.Z)((0,q.Z)({},m),{},{u_ViewportSize:[A,F]})}}}]),a}(Wd))||sE),lM,cM;function fM(n){var l=hM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function hM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var v1=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,g1=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,pM=(lM=(0,It.b2)(),lM(cM=function(n){(0,Zt.Z)(a,n);var l=fM(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:g1,fs:v1}),this.shaderModuleService.getModule("noise-pass")}}]),a}(Wd))||cM),uE,lE;function sy(n){var l=dM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function dM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var vM=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,gM=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`,mM=(uE=(0,It.b2)(),uE(lE=function(n){(0,Zt.Z)(a,n);var l=sy(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:vM,fs:gM}),this.shaderModuleService.getModule("sepia-pass")}}]),a}(Wd))||lE),cE,fE,hE,pE,h0,m1,yM=(cE=(0,It.b2)(),fE=(0,It.f3)(Dt.IRendererService),hE=(0,It.zY)(),cE(pE=(h0=function(){function n(){(0,ct.Z)(this,n),Ar(this,"rendererService",m1,this),(0,X.Z)(this,"passes",[]),(0,X.Z)(this,"readFBO",void 0),(0,X.Z)(this,"writeFBO",void 0)}return(0,et.Z)(n,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"getCurrentFBOTex",value:function(){var a=this.rendererService,s=a.getViewportSize,o=a.createTexture2D,h=s(),v=h.width,m=h.height;return o({x:0,y:0,width:v,height:m,copy:!0})}},{key:"getReadFBOTex",value:function(){var a=this,s=this.rendererService.useFramebuffer;return new Promise(function(o){s(a.readFBO,(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:o(a.getCurrentFBOTex());case 1:case"end":return m.stop()}},h)})))})}},{key:"renderBloomPass",value:function(){var l=(0,lt.Z)(it().mark(function s(o,h){var v,m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return A.next=2,this.getReadFBOTex();case 2:v=A.sent,m=0;case 4:if(!(m<4)){A.next=11;break}return A.next=7,h.render(o,v);case 7:this.swap(),m++,A.next=4;break;case 11:case"end":return A.stop()}},s,this)}));function a(s,o){return l.apply(this,arguments)}return a}()},{key:"render",value:function(){var l=(0,lt.Z)(it().mark(function s(o){var h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:h=0;case 1:if(!(h<this.passes.length)){E.next=15;break}if(v=this.passes[h],v.setRenderToScreen(this.isLastEnabledPass(h)),v.getName()!=="bloom"){E.next=9;break}return E.next=7,this.renderBloomPass(o,v);case 7:E.next=12;break;case 9:return E.next=11,v.render(o);case 11:h!==this.passes.length-1&&this.swap();case 12:h++,E.next=1;break;case 15:case"end":return E.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"resize",value:function(a,s){this.readFBO.resize({width:a,height:s}),this.writeFBO.resize({width:a,height:s})}},{key:"add",value:function(a,s,o){a.init(s,o),this.passes.push(a)}},{key:"insert",value:function(a,s,o,h){a.init(o,h),this.passes.splice(s,0,a)}},{key:"getPostProcessingPassByName",value:function(a){return this.passes.find(function(s){return s.getName()===a})}},{key:"init",value:function(){var a=this.rendererService,s=a.createFramebuffer,o=a.createTexture2D;this.readFBO=s({color:o({width:1,height:1,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})}),this.writeFBO=s({color:o({width:1,height:1,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})})}},{key:"isLastEnabledPass",value:function(a){for(var s=a+1;s<this.passes.length;s++)if(this.passes[s].isEnabled())return!1;return!0}},{key:"swap",value:function(){var a=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=a}}]),n}(),m1=Dr(h0.prototype,"rendererService",[fE],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr(h0.prototype,"init",[hE],Object.getOwnPropertyDescriptor(h0.prototype,"init"),h0.prototype),h0))||pE),dE,y1;function _M(n){var l=xM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function xM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var bM=(dE=(0,It.b2)(),dE(y1=function(n){(0,Zt.Z)(a,n);var l=_M(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getType",value:function(){return jd.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h)}},{key:"render",value:function(o){var h=this.rendererService,v=h.useFramebuffer,m=h.clear,E=o.multiPassRenderer.getPostProcessor().getReadFBO();v(E,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:E}),o.multiPassRenderer.setRenderFlag(!1),o.models.forEach(function(A){A.draw({uniforms:o.layerModel.getUninforms()})}),o.multiPassRenderer.setRenderFlag(!0)})}}]),a}(ny))||y1),vE,em,gE,uy,mE;function EM(n){var l=yE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function yE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wM=`uniform float u_opacity : 1.0;
uniform float u_MixRatio : 0.5;

uniform sampler2D u_Diffuse1;
uniform sampler2D u_Diffuse2;

varying vec2 v_UV;

void main() {
  vec4 texel1 = texture2D(u_Diffuse1, v_UV);
  vec4 texel2 = texture2D(u_Diffuse2, v_UV);
  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);
}
`,_E=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,xE=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;function _1(n,l){for(var a=0,s=1/l,o=n;o>0;)a=a+s*(o%l),o=Math.floor(o/l),s=s/l;return a}var SM=1,CM=(vE=(0,It.b2)(),em=(0,It.f3)(Dt.IShaderModuleService),vE(gE=(uy=function(n){(0,Zt.Z)(a,n);var l=EM(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),Ar((0,st.Z)(s),"shaderModuleService",mE,(0,st.Z)(s)),(0,X.Z)((0,st.Z)(s),"haltonSequence",[]),(0,X.Z)((0,st.Z)(s),"accumulatingId",0),(0,X.Z)((0,st.Z)(s),"frame",0),(0,X.Z)((0,st.Z)(s),"timer",void 0),(0,X.Z)((0,st.Z)(s),"sampleRenderTarget",void 0),(0,X.Z)((0,st.Z)(s),"prevRenderTarget",void 0),(0,X.Z)((0,st.Z)(s),"outputRenderTarget",void 0),(0,X.Z)((0,st.Z)(s),"copyRenderTarget",void 0),(0,X.Z)((0,st.Z)(s),"blendModel",void 0),(0,X.Z)((0,st.Z)(s),"outputModel",void 0),(0,X.Z)((0,st.Z)(s),"copyModel",void 0),s}return(0,et.Z)(a,[{key:"getType",value:function(){return jd.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(o,h){$o((0,b.Z)(a.prototype),"init",this).call(this,o,h);var v=this.rendererService,m=v.createFramebuffer,E=v.createTexture2D;this.sampleRenderTarget=m({color:E({width:1,height:1,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})}),this.prevRenderTarget=m({color:E({width:1,height:1,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})}),this.outputRenderTarget=m({color:E({width:1,height:1,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})}),this.copyRenderTarget=m({color:E({width:1,height:1,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE})});for(var A=0;A<30;A++)this.haltonSequence.push([_1(A,2),_1(A,3)]);this.blendModel=this.createTriangleModel("blend-pass",wM),this.outputModel=this.createTriangleModel("copy-pass",_E,{blend:{enable:!0,func:{srcRGB:Jt.ONE,dstRGB:Jt.ONE_MINUS_SRC_ALPHA,srcAlpha:Jt.ONE,dstAlpha:Jt.ONE_MINUS_SRC_ALPHA},equation:{rgb:Jt.FUNC_ADD,alpha:Jt.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",_E)}},{key:"render",value:function(o){var h=this,v=this.rendererService,m=v.clear,E=v.getViewportSize,A=v.useFramebuffer,F=E(),B=F.width,V=F.height;this.sampleRenderTarget.resize({width:B,height:V}),this.prevRenderTarget.resize({width:B,height:V}),this.outputRenderTarget.resize({width:B,height:V}),this.copyRenderTarget.resize({width:B,height:V}),this.resetFrame(),this.stopAccumulating();var j=o.multiPassRenderer.getPostProcessor().getReadFBO();A(j,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:j}),o.multiPassRenderer.setRenderFlag(!1),o.render(),o.multiPassRenderer.setRenderFlag(!0)});var at=function ut(xt){!h.accumulatingId||xt!==h.accumulatingId||h.isFinished()||(h.doRender(o),Co.requestAnimationFrame(function(){ut(xt)}))};this.accumulatingId=SM++,this.timer=Co.setTimeout(function(){at(h.accumulatingId)},50)}},{key:"doRender",value:function(o){var h=this,v=this.rendererService,m=v.clear,E=v.getViewportSize,A=v.useFramebuffer,F=E(),B=F.width,V=F.height,j=o.getLayerConfig(),at=j.jitterScale,ut=at===void 0?1:at,xt=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((xt[0]*2-1)/B*ut,(xt[1]*2-1)/V*ut),o.multiPassRenderer.setRenderFlag(!1),o.hooks.beforeRender.call(),A(this.sampleRenderTarget,function(){m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:h.sampleRenderTarget}),o.render()}),o.hooks.afterRender.call(),o.multiPassRenderer.setRenderFlag(!0);var Nt=o.getLayerConfig();A(this.outputRenderTarget,function(){h.blendModel.draw({uniforms:{u_opacity:Nt.opacity||1,u_MixRatio:h.frame===0?1:.9,u_Diffuse1:h.sampleRenderTarget,u_Diffuse2:h.frame===0?o.multiPassRenderer.getPostProcessor().getReadFBO():h.prevRenderTarget}})}),this.frame===0&&m({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(A(this.copyRenderTarget,function(){h.outputModel.draw({uniforms:{u_Texture:h.outputRenderTarget}})}),A(o.multiPassRenderer.getPostProcessor().getReadFBO(),function(){h.copyModel.draw({uniforms:{u_Texture:h.copyRenderTarget}})}),o.multiPassRenderer.getPostProcessor().render(o));var de=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=de,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,Co.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(o,h,v){this.shaderModuleService.registerModule(o,{vs:xE,fs:h});var m=this.shaderModuleService.getModule(o),E=m.vs,A=m.fs,F=m.uniforms,B=this.rendererService,V=B.createAttribute,j=B.createBuffer,at=B.createModel;return at((0,q.Z)({vs:E,fs:A,attributes:{a_Position:V({buffer:j({data:[-4,-4,4,-4,0,4],type:Jt.FLOAT}),size:2})},uniforms:(0,q.Z)({},F),depth:{enable:!1},count:3},v))}}]),a}(ny),mE=Dr(uy.prototype,"shaderModuleService",[em],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uy))||gE),p0=new It.W2;p0.bind(Dt.IGlobalConfigService).to(Ur).inSingletonScope(),(0,It.GW)((0,It.b2)(),Se.EventEmitter),p0.bind(Dt.IEventEmitter).to(Se.EventEmitter);var bE=(0,rt.Z)(p0,!1),ly=function(l){var a=bE.lazyInject(l);return function(s,o,h){a.call(this,s,o),h&&(h.initializer=function(){return s[o]})}},bO=function(l){var a=bE.lazyMultiInject(l);return function(s,o,h){a.call(this,s,o),h&&(h.initializer=function(){return s[o]})}},sh=p0,AM=0;function TM(){var n=new It.W2;return n.parent=p0,n.bind(Dt.SceneID).toConstantValue("".concat(AM++)),n.bind(Dt.IShaderModuleService).to(OT).inSingletonScope(),n.bind(Dt.ILayerService).to(Wg).inSingletonScope(),n.bind(Dt.ISceneService).to(mT).inSingletonScope(),n.bind(Dt.ICameraService).to(Lu).inSingletonScope(),n.bind(Dt.ICoordinateSystemService).to(_v).inSingletonScope(),n.bind(Dt.IInteractionService).to(td).inSingletonScope(),n.bind(Dt.IPickingService).to(Ju).inSingletonScope(),n.bind(Dt.IControlService).to(N).inSingletonScope(),n.bind(Dt.IMarkerService).to(mt).inSingletonScope(),n.bind(Dt.IIconService).to(wo).inSingletonScope(),n.bind(Dt.IFontService).to(Jo).inSingletonScope(),n.bind(Dt.IPopupService).to(Kt).inSingletonScope(),n.bind(Dt.INormalPass).to(BT).whenTargetNamed("clear"),n.bind(Dt.INormalPass).to(GT).whenTargetNamed("pixelPicking"),n.bind(Dt.INormalPass).to(bM).whenTargetNamed("render"),n.bind(Dt.INormalPass).to(CM).whenTargetNamed("taa"),n.bind(Dt.IFactoryNormalPass).toFactory(function(l){return function(a){return l.container.getNamed(Dt.INormalPass,a)}}),n.bind(Dt.IPostProcessingPass).to(d1).whenTargetNamed("copy"),n.bind(Dt.IPostProcessingPass).to(hO).whenTargetNamed("bloom"),n.bind(Dt.IPostProcessingPass).to(YT).whenTargetNamed("blurH"),n.bind(Dt.IPostProcessingPass).to(eE).whenTargetNamed("blurV"),n.bind(Dt.IPostProcessingPass).to(pM).whenTargetNamed("noise"),n.bind(Dt.IPostProcessingPass).to(mM).whenTargetNamed("sepia"),n.bind(Dt.IPostProcessingPass).to(p1).whenTargetNamed("colorHalftone"),n.bind(Dt.IPostProcessingPass).to(yO).whenTargetNamed("hexagonalPixelate"),n.bind(Dt.IPostProcessingPass).to(uM).whenTargetNamed("ink"),n.bind(Dt.IFactoryPostProcessingPass).toFactory(function(l){return function(a){var s=l.container.getNamed(Dt.IPostProcessingPass,a);return s.setName(a),s}}),n}function cy(n){var l=new It.W2;return l.parent=n,l.bind(Dt.IStyleAttributeService).to(_p).inSingletonScope(),l.bind(Dt.IMultiPassRenderer).to(UT).inSingletonScope(),l.bind(Dt.IPostProcessor).to(yM).inSingletonScope(),l}var EE=null;function EO(n){return EE.indexOf(n)}var MM=2,wO=4,IM=64,SO=128,wE=256,fy=512,kM=8192,LM=16384,CO=32768,PM=null,x1=131072,AO=262144,OM=524288,TO=1048576,FM=2097152,MO=4194304,RM=8388608,b1=16777216,E1=null;function rm(n,l){return n=clamp(Math.floor(n),0,255),l=clamp(Math.floor(l),0,255),256*n+l}function IO(n){var l=n.color,a=n.radius,s=n.tileX,o=n.tileY,h=n.shape,v=n.opacity,m=n.stroke,E=n.strokeWidth,A=n.strokeOpacity,F=[],B=[],V=[],j=[rm(l[0],l[1]),rm(l[2],l[3])],at=[rm(m[0],m[1]),rm(m[2],m[3])];return[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(ut){var xt=_slicedToArray(ut,2),Nt=xt[0],de=xt[1];F.push([].concat(j,[(Nt+1)*RM+(de+1)*FM+getShapeIndex(h)*x1+a,(s+512)*OM+(o+512)*IM])),B.push([].concat(at,[E,A])),V.push([v,0,0,0])}),{packedBuffer:F,packedBuffer2:B,packedBuffer3:V}}function DM(n,l){if(n===0&&!l)return 0;if(n===1&&l)return 4294967295;var a=l?1:0,s=Math.floor(n*127);return s*E1+a*b1+s*x1+a*PM+s*fy+a*wE+s*MM+a}var wp;(function(n){n.normal="normal",n.additive="additive",n.subtractive="subtractive",n.min="min",n.max="max",n.none="none"})(wp||(wp={}));var Ps;(function(n){n.LINEAR="linear",n.SEQUENTIAL="sequential",n.POWER="power",n.LOG="log",n.IDENTITY="identity",n.TIME="time",n.QUANTILE="quantile",n.QUANTIZE="quantize",n.THRESHOLD="threshold",n.CAT="cat",n.DIVERGING="diverging"})(Ps||(Ps={}));var Rv;(function(n){n.CONSTANT="constant",n.VARIABLE="variable"})(Rv||(Rv={}));var Vi;(function(n){n[n.Attribute=0]="Attribute",n[n.InstancedAttribute=1]="InstancedAttribute",n[n.Uniform=2]="Uniform"})(Vi||(Vi={}));var Sp;(function(n){n.IMAGE="image",n.ARRAYBUFFER="arraybuffer",n.RGB="rgb",n.CUSTOMRGB="customRGB",n.CUSTOMARRAYBUFFER="customArrayBuffer"})(Sp||(Sp={}));var w1=["mapload","mapchange","mapAfterFrameChange"],d0={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"},hy=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];function BM(n){var l=SE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function SE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var S1=function(n){(0,Zt.Z)(a,n);var l=BM(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this),(0,X.Z)((0,st.Z)(o),"added",!1),(0,X.Z)((0,st.Z)(o),"eventHandle",function(h){o.emit(h.type,{target:h,data:o.markerOption.extData,lngLat:o.lngLat})}),o.markerOption=(0,q.Z)((0,q.Z)({},o.getDefault()),s),os(["update","onMove","onMapClick"],(0,st.Z)(o)),o.init(),o}return(0,et.Z)(a,[{key:"getMarkerLayerContainerSize",value:function(){}},{key:"getDefault",value:function(){return{element:void 0,anchor:rr.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(o){this.scene=o,this.mapsService=o.get(Dt.IMapService),this.sceneSerive=o.get(Dt.ISceneService);var h=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(h),this.registerMarkerEvent(h),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update)),this.unRegisterMarkerEvent(),this.removeAllListeners();var o=this.markerOption.element;return o&&nt(o),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(o){return this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(o){var h=this;if(!this.added)return this.once("added",function(){h.setElement(o)}),this;var v=this.markerOption.element;return v&&nt(v),this.markerOption.element=o,this.init(),this.mapsService.getMarkerContainer().appendChild(o),this.registerMarkerEvent(o),this.update(),this}},{key:"openPopup",value:function(){var o=this;if(!this.added)return this.once("added",function(){o.openPopup()}),this;var h=this.popup;return h?(h.isOpen()||h.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var o=this;this.added||this.once("added",function(){o.closePopup()});var h=this.popup;return h&&h.remove(),this}},{key:"setPopup",value:function(o){return this.popup=o,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var o=this.popup;if(o)o.isOpen()?o.remove():o.addTo(this.scene);else return this;return this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(o){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(o){this.markerOption.extData=o}},{key:"update",value:function(){if(!!this.mapsService){var o=this.markerOption,h=o.element,v=o.anchor;this.updatePosition(),$i(h,"".concat(xr[v]))}}},{key:"onMapClick",value:function(o){var h=this.markerOption.element;this.popup&&h&&this.togglePopup()}},{key:"getCurrentContainerSize",value:function(){var o=this.mapsService.getContainer();return{containerHeight:(o==null?void 0:o.scrollHeight)||0,containerWidth:(o==null?void 0:o.scrollWidth)||0,bounds:this.mapsService.getBounds()}}},{key:"updatePosition",value:function(){if(!!this.mapsService){var o=this.markerOption,h=o.element,v=o.offsets,m=this.lngLat,E=m.lng,A=m.lat,F=this.mapsService.lngLatToContainer([E,A]);if(h){h.style.display="block",h.style.whiteSpace="nowrap";var B=this.getMarkerLayerContainerSize()||this.getCurrentContainerSize(),V=B.containerHeight,j=B.containerWidth,at=B.bounds;if(!at)return;if(Math.abs(at[0][0])>180||Math.abs(at[1][0])>180){if(F.x>j){var ut=this.mapsService.lngLatToContainer([E-360,A]);F.x=ut.x}if(F.x<0){var xt=this.mapsService.lngLatToContainer([E+360,A]);F.x=xt.x}}(F.x>j||F.x<0||F.y>V||F.y<0)&&(h.style.display="none"),h.style.left=F.x+v[0]+"px",h.style.top=F.y-v[1]+"px"}}}},{key:"init",value:function(){var o=this,h=this.markerOption.element,v=this.markerOption,m=v.color,E=v.anchor;if(!h){this.defaultMarker=!0,h=bt("div"),this.markerOption.element=h;var A=document.createElementNS("http://www.w3.org/2000/svg","svg");A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height","48px"),A.setAttributeNS(null,"width","48px"),A.setAttributeNS(null,"viewBox","0 0 1024 1024");var F=document.createElementNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),F.setAttributeNS(null,"fill",m),A.appendChild(F),h.appendChild(A)}se(h,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(B){var V,j,at=((V=o.markerOption)===null||V===void 0?void 0:V.style)&&((j=o.markerOption)===null||j===void 0?void 0:j.style[B]);h&&(h.style[B]=at)}),h.addEventListener("click",function(B){o.onMapClick(B)}),h.addEventListener("click",this.eventHandle),Pr(h,E,"marker")}},{key:"registerMarkerEvent",value:function(o){o.addEventListener("mousemove",this.eventHandle),o.addEventListener("click",this.eventHandle),o.addEventListener("mousedown",this.eventHandle),o.addEventListener("mouseup",this.eventHandle),o.addEventListener("dblclick",this.eventHandle),o.addEventListener("contextmenu",this.eventHandle),o.addEventListener("mouseover",this.eventHandle),o.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var o=this.getElement();o.removeEventListener("mousemove",this.eventHandle),o.removeEventListener("click",this.eventHandle),o.removeEventListener("mousedown",this.eventHandle),o.removeEventListener("mouseup",this.eventHandle),o.removeEventListener("dblclick",this.eventHandle),o.removeEventListener("contextmenu",this.eventHandle),o.removeEventListener("mouseover",this.eventHandle),o.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(o){return null}},{key:"onUp",value:function(o){throw new Error("Method not implemented.")}}]),a}(Se.EventEmitter),CE=ot(69848),AE=ot.n(CE);function NM(n){var l=TE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function TE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var kO=function(n){(0,Zt.Z)(a,n);var l=NM(a);function a(s){var o,h;return(0,ct.Z)(this,a),h=l.call(this),(0,X.Z)((0,st.Z)(h),"markers",[]),(0,X.Z)((0,st.Z)(h),"points",[]),(0,X.Z)((0,st.Z)(h),"clusterMarkers",[]),h.markerLayerOption=(0,ee.merge)(h.getDefault(),s),os(["update"],(0,st.Z)(h)),h.zoom=((o=h.markerLayerOption.clusterOption)===null||o===void 0?void 0:o.zoom)||-99,h}return(0,et.Z)(a,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(o){return this.scene=o,this.mapsService=o.get(Dt.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.mapsService.on("camerachange",this.setContainerSize.bind(this)),this.mapsService.on("viewchange",this.setContainerSize.bind(this)),this.addMarkers(),this.inited=!0,this}},{key:"setContainerSize",value:function(){if(!!this.mapsService){var o=this.mapsService.getContainer();this.containerSize={containerWidth:(o==null?void 0:o.scrollWidth)||0,containerHeight:(o==null?void 0:o.scrollHeight)||0,bounds:this.mapsService.getBounds()}}}},{key:"getContainerSize",value:function(){return this.containerSize}},{key:"addMarker",value:function(o){var h=this.markerLayerOption.cluster;if(o.getMarkerLayerContainerSize=this.getContainerSize.bind(this),h&&(this.addPoint(o,this.markers.length),this.mapsService)){var v=this.mapsService.getZoom(),m=this.mapsService.getBounds();this.bbox=Nl(m,.5),this.zoom=Math.floor(v),this.getClusterMarker(this.bbox,this.zoom)}this.markers.push(o)}},{key:"removeMarker",value:function(o){this.markers.indexOf(o);var h=this.markers.indexOf(o);h>-1&&this.markers.splice(h,1)}},{key:"hide",value:function(){this.markers.map(function(o){o.getElement().style.opacity="0"}),this.clusterMarkers.map(function(o){o.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(o){o.getElement().style.opacity="1"}),this.clusterMarkers.map(function(o){o.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){var o=this.markerLayerOption.cluster;return o?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var o=this;this.getMarkers().forEach(function(h){h.addTo(o.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(o){o.remove()}),this.clusterMarkers.forEach(function(o){o.remove()}),this.markers=[],this.points=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners(),this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("camerachange",this.setContainerSize.bind(this)),this.mapsService.off("viewchange",this.setContainerSize.bind(this))}},{key:"addPoint",value:function(o,h){var v=o.getLnglat(),m=v.lng,E=v.lat,A={geometry:{type:"Point",coordinates:[m,E]},properties:(0,q.Z)((0,q.Z)({},o.getExtData()),{},{marker_id:h})};this.points.push(A),this.clusterIndex&&this.clusterIndex.load(this.points)}},{key:"initCluster",value:function(){if(!!this.markerLayerOption.cluster){var o=this.markerLayerOption.clusterOption,h=o.radius,v=o.minZoom,m=v===void 0?0:v,E=o.maxZoom;this.clusterIndex=new(AE())({radius:h,minZoom:m,maxZoom:E}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(o,h){var v=this,m=o[0].concat(o[1]),E=this.clusterIndex.getClusters(m,h);this.clusterMarkers.forEach(function(A){A.remove()}),this.clusterMarkers=[],E.forEach(function(A){var F,B=v.markerLayerOption.clusterOption,V=B.field,j=B.method;if((F=A.properties)!==null&&F!==void 0&&F.cluster_id){var at,ut=v.getLeaves((at=A.properties)===null||at===void 0?void 0:at.cluster_id);if(A.properties.clusterData=ut,V&&j){var xt=ut==null?void 0:ut.map(function(Ye){var _r=(0,X.Z)({},V,Ye.properties[V]);return _r}),Nt=_i(xt,V),de=qi(j,Nt),fe="point_"+j;A.properties[fe]=de.toFixed(2)}}var Ne=v.clusterMarker(A);v.clusterMarkers.push(Ne),Ne.addTo(v.scene)})}},{key:"getLeaves",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return o?this.clusterIndex.getLeaves(o,h,v):null}},{key:"clusterMarker",value:function(o){var h=this.markerLayerOption.clusterOption,v=h,m=v.element,E=m===void 0?this.generateElement.bind(this):m,A=new S1({element:E(o)}).setLnglat({lng:o.geometry.coordinates[0],lat:o.geometry.coordinates[1]});return A}},{key:"normalMarker",value:function(o){var h=o.properties.marker_id;return this.markers[h]}},{key:"update",value:function(){if(!!this.mapsService&&this.markers.length!==0){var o=this.mapsService.getZoom(),h=this.mapsService.getBounds();(!this.bbox||Math.abs(o-this.zoom)>=1||!wu(this.bbox,h))&&(this.bbox=Nl(h,.5),this.zoom=Math.floor(o),this.getClusterMarker(this.bbox,this.zoom))}}},{key:"generateElement",value:function(o){var h=bt("div","l7-marker-cluster"),v=bt("div","",h),m=bt("span","",v),E=this.markerLayerOption.clusterOption,A=E.field,F=E.method;o.properties.point_count=o.properties.point_count||1;var B=A&&F?o.properties["point_"+F]||o.properties[A]:o.properties.point_count;return m.textContent=B,h}}]),a}(Se.EventEmitter),zM=ot(4157);function UM(n){var l=C1();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function C1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var v0=function(n){(0,Zt.Z)(a,n);var l=UM(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this),a.controlCount++,o.controlOption=(0,q.Z)((0,q.Z)({},o.getDefault(s)),s||{}),o}return(0,et.Z)(a,[{key:"getOptions",value:function(){return this.controlOption}},{key:"setOptions",value:function(o){var h=this.getDefault(o);Object.entries(o).forEach(function(v){var m=(0,ht.Z)(v,2),E=m[0],A=m[1];A===void 0&&(o[E]=h[E])}),"position"in o&&this.setPosition(o.position),"className"in o&&this.setClassName(o.className),"style"in o&&this.setStyle(o.style),this.controlOption=(0,q.Z)((0,q.Z)({},this.controlOption),o)}},{key:"addTo",value:function(o){this.mapsService=o.get(Dt.IMapService),this.renderService=o.get(Dt.IRendererService),this.layerService=o.get(Dt.ILayerService),this.controlService=o.get(Dt.IControlService),this.configService=o.get(Dt.IGlobalConfigService),this.scene=o.get(Dt.ISceneService),this.sceneContainer=o,this.isShow=!0,this.container=this.onAdd(),se(this.container,"l7-control");var h=this.controlOption,v=h.className,m=h.style;return v&&this.setClassName(v),m&&this.setStyle(m),this.insertContainer(),this.emit("add",this),this}},{key:"remove",value:function(){if(!this.mapsService)return this;nt(this.container),this.onRemove(),this.emit("remove",this)}},{key:"onAdd",value:function(){return bt("div")}},{key:"onRemove",value:function(){}},{key:"show",value:function(){var o=this.container;Ve(o,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}},{key:"hide",value:function(){var o=this.container;se(o,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}},{key:"getDefault",value:function(o){return{position:Vl.TOPRIGHT,name:"".concat(a.controlCount)}}},{key:"getContainer",value:function(){return this.container}},{key:"getIsShow",value:function(){return this.isShow}},{key:"_refocusOnMap",value:function(o){if(this.mapsService&&o&&o.screenX>0&&o.screenY>0){var h=this.mapsService.getContainer();h!==null&&h.focus()}}},{key:"setPosition",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vl.TOPLEFT,h=this.controlService;return h&&h.removeControl(this),this.controlOption.position=o,h&&h.addControl(this,this.sceneContainer),this}},{key:"setClassName",value:function(o){var h=this.container,v=this.controlOption.className;v&&Ve(h,v),o&&se(h,o)}},{key:"setStyle",value:function(o){var h=this.container;o?h.setAttribute("style",o):h.removeAttribute("style")}},{key:"insertContainer",value:function(){var o=this.controlOption.position,h=this.container;if(o instanceof Element)o.appendChild(h);else{var v=this.controlService.controlCorners[o];o.indexOf("bottom")!==-1?v.insertBefore(h,v.firstChild):v.appendChild(h)}}},{key:"checkUpdateOption",value:function(o,h){return h.some(function(v){return v in o})}}]),a}(Ie());(0,X.Z)(v0,"controlCount",0);function py(n){var l=ZM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ZM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dy=function(n){(0,Zt.Z)(a,n);var l=py(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"isDisable",!1),s}return(0,et.Z)(a,[{key:"setIsDisable",value:function(o){if(this.isDisable=o,o){var h;(h=this.button)===null||h===void 0||h.setAttribute("disabled","true")}else{var v;(v=this.button)===null||v===void 0||v.removeAttribute("disabled")}}},{key:"createButton",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return bt("button","l7-button-control ".concat(o))}},{key:"onAdd",value:function(){this.button=this.createButton(),this.isDisable=!1;var o=this.controlOption,h=o.title,v=o.btnText,m=o.btnIcon;return this.setBtnTitle(h),this.setBtnText(v),this.setBtnIcon(m),this.button}},{key:"onRemove",value:function(){this.button=this.buttonIcon=this.buttonText=void 0,this.isDisable=!1}},{key:"setOptions",value:function(o){var h=o.title,v=o.btnText,m=o.btnIcon;this.checkUpdateOption(o,["title"])&&this.setBtnTitle(h),this.checkUpdateOption(o,["btnIcon"])&&this.setBtnIcon(m),this.checkUpdateOption(o,["btnText"])&&this.setBtnText(v),$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o)}},{key:"setBtnTitle",value:function(o){var h;(h=this.button)===null||h===void 0||h.setAttribute("title",o!=null?o:"")}},{key:"setBtnIcon",value:function(o){if(this.buttonIcon&&nt(this.buttonIcon),o){var h,v=(h=this.button)===null||h===void 0?void 0:h.firstChild;if(v){var m;(m=this.button)===null||m===void 0||m.insertBefore(o,v)}else{var E;(E=this.button)===null||E===void 0||E.appendChild(o)}this.buttonIcon=o}}},{key:"setBtnText",value:function(o){if(!!this.button)if(Ve(this.button,"l7-button-control--row"),Ve(this.button,"l7-button-control--column"),o){var h=this.buttonText;if(!h){var v;h=bt("div","l7-button-control__text"),(v=this.button)===null||v===void 0||v.appendChild(h),this.buttonText=h}h.innerText=o,se(this.button,this.controlOption.vertical?"l7-button-control--column":"l7-button-control--row")}else!o&&this.buttonText&&(nt(this.buttonText),this.buttonText=void 0)}}]),a}(v0);function VM(n){var l=GM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function GM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ME=function(n){(0,Zt.Z)(a,n);var l=VM(a);function a(s,o){var h;return(0,ct.Z)(this,a),h=l.call(this),(0,X.Z)((0,st.Z)(h),"isShow",!1),(0,X.Z)((0,st.Z)(h),"timeout",null),(0,X.Z)((0,st.Z)(h),"show",function(){return h.isShow||!h.contentDOM.innerHTML||(h.resetPopperPosition(),Ve(h.popperDOM,"l7-popper-hide"),h.isShow=!0,h.option.unique&&a.conflictPopperList.forEach(function(v){v!==(0,st.Z)(h)&&v.isShow&&v.hide()}),h.emit("show")),(0,st.Z)(h)}),(0,X.Z)((0,st.Z)(h),"hide",function(){return h.isShow&&(se(h.popperDOM,"l7-popper-hide"),h.isShow=!1,h.emit("hide")),(0,st.Z)(h)}),(0,X.Z)((0,st.Z)(h),"setHideTimeout",function(){h.timeout||(h.timeout=window.setTimeout(function(){!h.isShow||(h.hide(),h.timeout=null)},300))}),(0,X.Z)((0,st.Z)(h),"clearHideTimeout",function(){h.timeout&&(window.clearTimeout(h.timeout),h.timeout=null)}),(0,X.Z)((0,st.Z)(h),"onBtnClick",function(){h.isShow?h.hide():h.show()}),(0,X.Z)((0,st.Z)(h),"onBtnMouseLeave",function(){h.setHideTimeout()}),(0,X.Z)((0,st.Z)(h),"onBtnMouseMove",function(){h.clearHideTimeout(),!h.isShow&&h.show()}),h.button=s,h.option=o,h.init(),o.unique&&a.conflictPopperList.push((0,st.Z)(h)),h}return(0,et.Z)(a,[{key:"buttonRect",get:function(){return this.button.getBoundingClientRect()}},{key:"getPopperDOM",value:function(){return this.popperDOM}},{key:"getIsShow",value:function(){return this.isShow}},{key:"getContent",value:function(){return this.content}},{key:"setContent",value:function(o){typeof o=="string"?this.contentDOM.innerHTML=o:o instanceof HTMLElement&&(iu(this.contentDOM),this.contentDOM.appendChild(o)),this.content=o}},{key:"init",value:function(){var o=this.option.trigger;this.popperDOM=this.createPopper(),o==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}},{key:"destroy",value:function(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),nt(this.popperDOM)}},{key:"resetPopperPosition",value:function(){var o={},h=this.option,v=h.container,m=h.offset,E=m===void 0?[0,0]:m,A=h.placement,F=(0,ht.Z)(E,2),B=F[0],V=F[1],j=this.button.getBoundingClientRect(),at=v.getBoundingClientRect(),ut=il(j,at),xt=ut.left,Nt=ut.right,de=ut.top,fe=ut.bottom,Ne=!1,Ye=!1;/^(left|right)/.test(A)?(A.includes("left")?o.right="".concat(j.width+Nt,"px"):A.includes("right")&&(o.left="".concat(j.width+xt,"px")),A.includes("start")?o.top="".concat(de,"px"):A.includes("end")?o.bottom="".concat(fe,"px"):(o.top="".concat(de+j.height/2,"px"),Ye=!0,o.transform="translate(".concat(B,"px, calc(").concat(V,"px - 50%))"))):/^(top|bottom)/.test(A)&&(A.includes("top")?o.bottom="".concat(j.height+fe,"px"):A.includes("bottom")&&(o.top="".concat(j.height+de,"px")),A.includes("start")?o.left="".concat(xt,"px"):A.includes("end")?o.right="".concat(Nt,"px"):(o.left="".concat(xt+j.width/2,"px"),Ne=!0,o.transform="translate(calc(".concat(B,"px - 50%), ").concat(V,"px)"))),o.transform="translate(calc(".concat(B,"px - ").concat(Ne?"50%":"0%","), calc(").concat(V,"px - ").concat(Ye?"50%":"0%",")");var _r=A.split("-");_r.length&&se(this.popperDOM,_r.map(function(Ir){return"l7-popper-".concat(Ir)}).join(" ")),Ao(this.popperDOM,xu(o))}},{key:"createPopper",value:function(){var o=this.option,h=o.container,v=o.className,m=v===void 0?"":v,E=o.content,A=bt("div","l7-popper l7-popper-hide ".concat(m)),F=bt("div","l7-popper-content"),B=bt("div","l7-popper-arrow");return A.appendChild(F),A.appendChild(B),h.appendChild(A),this.popperDOM=A,this.contentDOM=F,E&&this.setContent(E),A}}]),a}(Se.EventEmitter);(0,X.Z)(ME,"conflictPopperList",[]);function A1(n){var l=HM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function HM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var jM={topleft:"right-start",topcenter:"bottom",topright:"left-start",bottomleft:"right-end",bottomcenter:"top",bottomright:"left-end",lefttop:"bottom-start",leftcenter:"right",leftbottom:"top-start",righttop:"bottom-end",rightcenter:"left",rightbottom:"top-end"},WM=function(n){(0,Zt.Z)(a,n);var l=A1(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getPopper",value:function(){return this.popper}},{key:"hide",value:function(){this.popper.hide(),$o((0,b.Z)(a.prototype),"hide",this).call(this)}},{key:"getDefault",value:function(o){var h,v=$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o),m=(h=o==null?void 0:o.position)!==null&&h!==void 0?h:v.position;return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{popperPlacement:m instanceof Element?"bottom":jM[m],popperTrigger:"click"})}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return this.initPopper(),o}},{key:"onRemove",value:function(){this.popper.destroy()}},{key:"initPopper",value:function(){var o=this,h=this.controlOption,v=h.popperClassName,m=h.popperPlacement,E=h.popperTrigger,A=this.mapsService.getMapContainer();return this.popper=new ME(this.button,{className:v,placement:m,trigger:E,container:A,unique:!0}),this.popper.on("show",function(){o.emit("popperShow",o)}).on("hide",function(){o.emit("popperHide",o)}),this.popper}},{key:"setOptions",value:function(o){if($o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["popperPlacement","popperTrigger","popperClassName"])){var h=this.popper.getContent();this.popper.destroy(),this.initPopper(),this.popper.setContent(h)}}}]),a}(dy);function XM(n){var l=YM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function YM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Xd;(function(n){n.ActiveOptionClassName="l7-select-control-item-active",n.OptionValueAttrKey="data-option-value",n.OptionIndexAttrKey="data-option-index"})(Xd||(Xd={}));var IE=function(n){(0,Zt.Z)(a,n);var l=XM(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"selectValue",[]),(0,X.Z)((0,st.Z)(s),"createNormalOption",function(m){var E=s.selectValue.includes(m.value),A=bt("div","l7-select-control-item ".concat(E?Xd.ActiveOptionClassName:""));s.getIsMultiple()&&A.appendChild(s.createCheckbox(E)),m.icon&&A.appendChild(m.icon);var F=bt("span");return F.innerText=m.text,A.appendChild(F),A}),(0,X.Z)((0,st.Z)(s),"onItemClick",function(m){if(s.getIsMultiple()){var E=s.selectValue.findIndex(function(A){return A===m.value});E>-1?s.selectValue.splice(E,1):s.selectValue=[].concat((0,me.Z)(s.selectValue),[m.value])}else s.selectValue=[m.value];s.setSelectValue(s.selectValue)}),s}return(0,et.Z)(a,[{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o);var h=o.options;h&&this.popper.setContent(this.getPopperContent(h))}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this),h=this.controlOption.defaultValue;return h&&(this.selectValue=this.transSelectValue(h)),this.popper.setContent(this.getPopperContent(this.controlOption.options)),o}},{key:"getSelectValue",value:function(){return this.getIsMultiple()?this.selectValue:this.selectValue[0]}},{key:"setSelectValue",value:function(o){var h=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,m=this.transSelectValue(o);this.optionDOMList.forEach(function(E){var A=E.getAttribute(Xd.OptionValueAttrKey),F=h.getIsMultiple()?E.querySelector("input[type=checkbox]"):void 0;m.includes(A)?(se(E,Xd.ActiveOptionClassName),F&&bu(F,!0)):(Ve(E,Xd.ActiveOptionClassName),F&&bu(F,!1))}),this.selectValue=m,v&&this.emit("selectChange",this.getIsMultiple()?m:m[0])}},{key:"getIsMultiple",value:function(){return!1}},{key:"getPopperContent",value:function(o){var h=this,v=this.isImageOptions(),m=bt("div",v?"l7-select-control--image":"l7-select-control--normal");this.getIsMultiple()&&se(m,"l7-select-control--multiple");var E=o.map(function(A,F){var B=v?h.createImageOption(A):h.createNormalOption(A);return B.setAttribute(Xd.OptionValueAttrKey,A.value),B.setAttribute(Xd.OptionIndexAttrKey,window.String(F)),B.addEventListener("click",h.onItemClick.bind(h,A)),B});return m.append.apply(m,(0,me.Z)(E)),this.optionDOMList=E,m}},{key:"createImageOption",value:function(o){var h=this.selectValue.includes(o.value),v=bt("div","l7-select-control-item ".concat(h?Xd.ActiveOptionClassName:"")),m=bt("img");m.setAttribute("src",o.img),Vc(m),v.appendChild(m);var E=bt("div","l7-select-control-item-row");this.getIsMultiple()&&v.appendChild(this.createCheckbox(h));var A=bt("span");return A.innerText=o.text,E.appendChild(A),v.appendChild(E),v}},{key:"createCheckbox",value:function(o){var h=bt("input");return h.setAttribute("type","checkbox"),o&&bu(h,!0),h}},{key:"isImageOptions",value:function(){return!!this.controlOption.options.find(function(o){return o.img})}},{key:"transSelectValue",value:function(o){return Array.isArray(o)?o:[o]}}]),a}(WM);function kE(n){var l=LE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function LE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PE=function(n){(0,Zt.Z)(a,n);var l=kE(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getDefault",value:function(){return{position:Vl.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}},{key:"onAdd",value:function(){var o=bt("div","l7-control-logo");return this.setLogoContent(o),o}},{key:"onRemove",value:function(){return null}},{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["img","href"])&&(iu(this.container),this.setLogoContent(this.container))}},{key:"setLogoContent",value:function(o){var h=this.controlOption,v=h.href,m=h.img,E=bt("img");if(E.setAttribute("src",m),E.setAttribute("aria-label","AntV logo"),Vc(E),v){var A=bt("a","l7-control-logo-link");A.target="_blank",A.href=v,A.rel="noopener nofollow",A.setAttribute("rel","noopener nofollow"),A.appendChild(E),o.appendChild(A)}else o.appendChild(E)}}]),a}(v0),Yd=function(l){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.classList.add("l7-iconfont"),a.setAttribute("aria-hidden","true");var s=document.createElementNS("http://www.w3.org/2000/svg","use");return s.setAttributeNS("http://www.w3.org/1999/xlink","href","#".concat(l)),a.appendChild(s),a};function OE(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=T1(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function T1(n,l){if(!!n){if(typeof n=="string")return FE(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return FE(n,l)}}function FE(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var RE=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],bc=function(){if(typeof document=="undefined")return!1;var n=RE[0],l={},a=OE(RE),s;try{for(a.s();!(s=a.n()).done;){var o=s.value,h=o==null?void 0:o[1];if(h in document){var v=OE(o.entries()),m;try{for(v.s();!(m=v.n()).done;){var E=(0,ht.Z)(m.value,2),A=E[0],F=E[1];l[n[A]]=F}}catch(B){v.e(B)}finally{v.f()}return l}}}catch(B){a.e(B)}finally{a.f()}return!1}(),vy={change:bc.fullscreenchange,error:bc.fullscreenerror},uh={request:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.documentElement,a=arguments.length>1?arguments[1]:void 0;return new Promise(function(s,o){var h=function m(){uh.off("change",m),s()};uh.on("change",h);var v=l[bc.requestFullscreen](a);v instanceof Promise&&v.then(h).catch(o)})},exit:function(){return new Promise(function(l,a){if(!uh.isFullscreen){l();return}var s=function h(){uh.off("change",h),l()};uh.on("change",s);var o=document[bc.exitFullscreen]();o instanceof Promise&&o.then(s).catch(a)})},toggle:function(l,a){return uh.isFullscreen?uh.exit():uh.request(l,a)},onchange:function(l){uh.on("change",l)},onerror:function(l){uh.on("error",l)},on:function(l,a){var s=vy[l];s&&document.addEventListener(s,a,!1)},off:function(l,a){var s=vy[l];s&&document.removeEventListener(s,a,!1)},raw:bc};Object.defineProperties(uh,{isFullscreen:{get:function(){return Boolean(document[bc.fullscreenElement])}},element:{enumerable:!0,get:function(){var l;return(l=document[bc.fullscreenElement])!==null&&l!==void 0?l:void 0}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[bc.fullscreenEnabled])}}}),bc||(uh={isEnabled:!1});var M1=uh;function $M(n){var l=qM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function qM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var LO=function(n){(0,Zt.Z)(a,n);var l=$M(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this,s),(0,X.Z)((0,st.Z)(o),"isFullscreen",!1),(0,X.Z)((0,st.Z)(o),"toggleFullscreen",(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!M1.isEnabled){m.next=3;break}return m.next=3,M1.toggle(o.mapContainer);case 3:case"end":return m.stop()}},h)}))),(0,X.Z)((0,st.Z)(o),"onClick",function(){o.toggleFullscreen()}),(0,X.Z)((0,st.Z)(o),"onFullscreenChange",function(){o.isFullscreen=!!document.fullscreenElement;var h=o.controlOption,v=h.btnText,m=h.btnIcon,E=h.title,A=h.exitBtnText,F=h.exitBtnIcon,B=h.exitTitle;o.isFullscreen?(o.setBtnTitle(B),o.setBtnText(A),o.setBtnIcon(F)):(o.setBtnTitle(E),o.setBtnText(v),o.setBtnIcon(m)),o.emit("fullscreenChange",o.isFullscreen)}),M1.isEnabled||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u5BF9\u5730\u56FE\u5168\u5C4F\u5316"),o}return(0,et.Z)(a,[{key:"setOptions",value:function(o){var h=o.exitBtnText,v=o.exitBtnIcon,m=o.exitTitle;this.isFullscreen&&(this.checkUpdateOption(o,["exitBtnIcon"])&&this.setBtnIcon(v),this.checkUpdateOption(o,["exitBtnText"])&&this.setBtnText(h),this.checkUpdateOption(o,["exitTitle"])&&this.setBtnTitle(m)),$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o)}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return o.addEventListener("click",this.onClick),this.mapContainer=nl(this.scene.getSceneConfig().id),this.mapContainer.addEventListener("fullscreenchange",this.onFullscreenChange),o}},{key:"onRemove",value:function(){$o((0,b.Z)(a.prototype),"onRemove",this).call(this),this.mapContainer.removeEventListener("fullscreenchange",this.onFullscreenChange)}},{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5168\u5C4F",btnIcon:Yd("l7-icon-fullscreen"),exitTitle:"\u9000\u51FA\u5168\u5C4F",exitBtnIcon:Yd("l7-icon-exit-fullscreen")})}}]),a}(dy);function KM(n){var l=QM();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function QM(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var PO=function(n){(0,Zt.Z)(a,n);var l=KM(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"onClick",(0,lt.Z)(it().mark(function m(){var E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(E=s.controlOption.onExport,E!=null){F.next=5;break}F.next=10;break;case 5:return F.t0=E,F.next=8,s.getImage();case 8:F.t1=F.sent,(0,F.t0)(F.t1);case 10:case"end":return F.stop()}},m)}))),(0,X.Z)((0,st.Z)(s),"mergeImage",(0,lt.Z)(it().mark(function m(){var E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne,Ye,_r=arguments;return it().wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:for(F=s.controlOption.imageType,B=(E=(A=s.mapsService.getContainer())===null||A===void 0?void 0:A.getBoundingClientRect())!==null&&E!==void 0?E:{},V=B.width,j=V===void 0?0:V,at=B.height,ut=at===void 0?0:at,xt=document.createElement("canvas"),xt.width=j,xt.height=ut,Nt=xt.getContext("2d"),de=_r.length,fe=new Array(de),Ne=0;Ne<de;Ne++)fe[Ne]=_r[Ne];return Nr.next=9,Promise.all(fe.map(function(Yr){return new Promise(function(yn){var fn=new Image;fn.onload=function(){yn(fn)},fn.src=Yr})}));case 9:return Ye=Nr.sent,Ye.forEach(function(Yr){Nt==null||Nt.drawImage(Yr,0,0,j,ut)}),Nr.abrupt("return",xt.toDataURL("image/".concat(F)));case 12:case"end":return Nr.stop()}},m)}))),s}return(0,et.Z)(a,[{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return o.addEventListener("click",this.onClick),o}},{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5BFC\u51FA\u56FE\u7247",btnIcon:Yd("l7-icon-export-picture"),imageType:"png"})}},{key:"getImage",value:function(){var o=this.mapsService.exportMap("png"),h=this.scene.exportPng("png");return this.mergeImage(o,h)}}]),a}(dy);function JM(n){var l=t3();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function t3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var OO=function(n){(0,Zt.Z)(a,n);var l=JM(a);function a(s){var o;return(0,ct.Z)(this,a),o=l.call(this,s),(0,X.Z)((0,st.Z)(o),"getGeoLocation",function(){return new Promise(function(h,v){window.navigator.geolocation.getCurrentPosition(function(m){var E=m.coords,A=E!=null?E:{},F=A.longitude,B=A.latitude;!(0,ee.isNaN)(F)&&!(0,ee.isNaN)(B)?h([F,B]):v()},function(m){v(m)})})}),(0,X.Z)((0,st.Z)(o),"onClick",(0,lt.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(window.navigator.geolocation){F.next=2;break}return F.abrupt("return");case 2:return v=o.controlOption.transform,F.next=5,o.getGeoLocation();case 5:if(m=F.sent,E=o.mapsService.getZoom(),F.t0=o.mapsService,F.t1=E>15?E:15,!v){F.next=15;break}return F.next=12,v(m);case 12:F.t2=F.sent,F.next=16;break;case 15:F.t2=m;case 16:F.t3=F.t2,F.t0.setZoomAndCenter.call(F.t0,F.t1,F.t3);case 18:case"end":return F.stop()}},h)}))),window.navigator.geolocation||console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u73AF\u5883\u4E0D\u652F\u6301\u83B7\u53D6\u5730\u7406\u5B9A\u4F4D"),o}return(0,et.Z)(a,[{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5B9A\u4F4D",btnIcon:Yd("l7-icon-reposition")})}},{key:"onAdd",value:function(){var o=$o((0,b.Z)(a.prototype),"onAdd",this).call(this);return o.addEventListener("click",this.onClick),o}}]),a}(dy),e3={normal:{text:"\u6807\u51C6",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-nqiT6Vu948AAAAAAAAAAAAAARQnAQ"},light:{text:"\u6708\u5149\u94F6",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*J_wYQL_PaUEAAAAAAAAAAAAAARQnAQ"},dark:{text:"\u5E7B\u5F71\u9ED1",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*U7M9QI1yat4AAAAAAAAAAAAAARQnAQ"},fresh:{text:"\u8349\u8272\u9752",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*T-oBT4hB5ucAAAAAAAAAAAAAARQnAQ"},grey:{text:"\u96C5\u58EB\u7070",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*OREXQ4vgQRIAAAAAAAAAAAAAARQnAQ"},graffiti:{text:"\u6D82\u9E26",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*4UApTKmeiy4AAAAAAAAAAAAAARQnAQ"},macaron:{text:"\u9A6C\u5361\u9F99",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*0GrCQLtDjNcAAAAAAAAAAAAAARQnAQ"},darkblue:{text:"\u6781\u591C\u84DD",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*uWxqSZQlPkkAAAAAAAAAAAAAARQnAQ"},wine:{text:"\u9171\u7C7D",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*OFPrTbg3an0AAAAAAAAAAAAAARQnAQ"}},DE={normal:{text:"\u6807\u51C6",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*AnfJTbIBJOkAAAAAAAAAAAAAARQnAQ"},light:{text:"\u4EAE",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*gnuiQIok9qIAAAAAAAAAAAAAARQnAQ"},dark:{text:"\u6697",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*NwG-TbOlBH0AAAAAAAAAAAAAARQnAQ"},satellite:{text:"\u536B\u661F",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*2X5EQLKul3IAAAAAAAAAAAAAARQnAQ"},outdoors:{text:"\u6237\u5916",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*gXFLRIaBUI0AAAAAAAAAAAAAARQnAQ"}};function r3(n){var l=gy();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gy(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var I1=function(n){(0,Zt.Z)(a,n);var l=r3(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"onMapThemeChange",function(){s.mapsService.setMapStyle(s.selectValue[0])}),s}return(0,et.Z)(a,[{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u5730\u56FE\u6837\u5F0F",btnIcon:Yd("l7-icon-color"),options:[]})}},{key:"getStyleOptions",value:function(){var o=this.mapsService.getType()==="mapbox"?DE:e3;return Object.entries(this.mapsService.getMapStyleConfig()).filter(function(h){var v=(0,ht.Z)(h,2),m=v[0],E=v[1];return typeof E=="string"&&m!=="blank"}).map(function(h){var v,m=(0,ht.Z)(h,2),E=m[0],A=m[1],F=(v=o[E])!==null&&v!==void 0?v:{},B=F.text,V=F.img;return{text:B!=null?B:E,value:A,img:V,key:E}})}},{key:"getMapStyle",value:function(){return this.mapsService.getMapStyle()}},{key:"onAdd",value:function(){var o,h=this;if((o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getStyleOptions()),this.controlOption.defaultValue){var v,m,E=this.controlOption.defaultValue;this.controlOption.defaultValue=(v=(m=this.controlOption.options.find(function(F){return F.key===E}))===null||m===void 0?void 0:m.value)!==null&&v!==void 0?v:E}else{var A=this.getMapStyle();A?this.controlOption.defaultValue=A:this.mapsService.map.once("styledata",function(){var F=h.mapsService.getMapStyle();h.controlOption.defaultValue=F,h.setSelectValue(F,!1)})}return this.on("selectChange",this.onMapThemeChange),$o((0,b.Z)(a.prototype),"onAdd",this).call(this)}},{key:"getIsMultiple",value:function(){return!1}}]),a}(IE);function n3(n){var l=i3();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function i3(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var a3=function(n){(0,Zt.Z)(a,n);var l=n3(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"onLayerChange",function(){var m;(m=s.controlOption.layers)!==null&&m!==void 0&&m.length||(s.selectValue=s.getLayerVisible(),s.setOptions({options:s.getLayerOptions()}))}),(0,X.Z)((0,st.Z)(s),"onLayerVisibleChane",function(){s.setSelectValue(s.getLayerVisible())}),(0,X.Z)((0,st.Z)(s),"onSelectChange",function(){s.layers.forEach(function(m){var E=s.selectValue.includes(m.name),A=m.isVisible();E&&!A&&m.show(),!E&&A&&m.hide()})}),s}return(0,et.Z)(a,[{key:"layers",get:function(){var o=this.layerService,h=this.controlOption.layers;if(Array.isArray(h)&&h.length){var v=[];return h.forEach(function(m){if(m instanceof Object&&v.push(m),typeof m=="string"){var E=o.getLayer(m)||o.getLayerByName(m);E&&v.push(E)}}),v}return o.getLayers()||[]}},{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{title:"\u56FE\u5C42\u63A7\u5236",btnIcon:Yd("l7-icon-layer"),options:[]})}},{key:"getLayerVisible",value:function(){return this.layers.filter(function(o){return o.isVisible()}).map(function(o){return o.name})}},{key:"getLayerOptions",value:function(){return this.layers.map(function(o){return{text:o.name,value:o.name}})}},{key:"setOptions",value:function(o){var h=this.checkUpdateOption(o,["layers"]);$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),h&&(this.selectValue=this.getLayerVisible(),this.controlOption.options=this.getLayerOptions(),this.popper.setContent(this.getPopperContent(this.controlOption.options)))}},{key:"onAdd",value:function(){var o;return(o=this.controlOption.options)!==null&&o!==void 0&&o.length||(this.controlOption.options=this.getLayerOptions()),this.controlOption.defaultValue||(this.controlOption.defaultValue=this.getLayerVisible()),this.on("selectChange",this.onSelectChange),this.layerService.on("layerChange",this.onLayerChange),$o((0,b.Z)(a.prototype),"onAdd",this).call(this)}},{key:"onRemove",value:function(){this.off("selectChange",this.onSelectChange),this.layerService.off("layerChange",this.onLayerChange)}},{key:"getIsMultiple",value:function(){return!0}}]),a}(IE);function yy(n){var l=k1();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function k1(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var o3=function(n){(0,Zt.Z)(a,n);var l=yy(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"location",[0,0]),(0,X.Z)((0,st.Z)(s),"onMouseMove",function(m){var E=s.location,A=m.lngLat||m.lnglat,F=s.controlOption.transform;A&&(E=[A.lng,A.lat]),s.location=E,F&&(E=F(E)),s.insertLocation2HTML(E),s.emit("locationChange",E)}),s}return(0,et.Z)(a,[{key:"getLocation",value:function(){return this.location}},{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{position:Vl.BOTTOMLEFT,transform:function(v){var m=(0,ht.Z)(v,2),E=m[0],A=m[1];return[+(+E).toFixed(6),+(+A).toFixed(6)]}})}},{key:"onAdd",value:function(){var o=bt("div","l7-control-mouse-location");return o.innerHTML="&nbsp;",this.mapsService.on("mousemove",this.onMouseMove),o}},{key:"onRemove",value:function(){this.mapsService.off("mousemove",this.onMouseMove)}},{key:"insertLocation2HTML",value:function(o){this.container.innerText=o.join(", ")}}]),a}(v0);function Dv(n){var l=BE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function BE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var s3=function(n){(0,Zt.Z)(a,n);var l=Dv(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"zoomIn",function(){!s.disabled&&s.mapsService.getZoom()<s.mapsService.getMaxZoom()&&s.mapsService.zoomIn()}),(0,X.Z)((0,st.Z)(s),"zoomOut",function(){!s.disabled&&s.mapsService.getZoom()>s.mapsService.getMinZoom()&&s.mapsService.zoomOut()}),(0,X.Z)((0,st.Z)(s),"updateDisabled",function(){var m=s.mapsService;s.zoomInButton.removeAttribute("disabled"),s.zoomOutButton.removeAttribute("disabled"),(s.disabled||m.getZoom()<=m.getMinZoom())&&s.zoomOutButton.setAttribute("disabled","true"),(s.disabled||m.getZoom()>=m.getMaxZoom())&&s.zoomInButton.setAttribute("disabled","true")}),s}return(0,et.Z)(a,[{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{position:Vl.BOTTOMRIGHT,name:"zoom",zoomInText:Yd("l7-icon-enlarge"),zoomInTitle:"Zoom in",zoomOutText:Yd("l7-icon-narrow"),zoomOutTitle:"Zoom out"})}},{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["zoomInText","zoomInTitle","zoomOutText","zoomOutTitle"])&&this.resetButtonGroup(this.container)}},{key:"onAdd",value:function(){var o=bt("div","l7-control-zoom");return this.resetButtonGroup(o),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),o}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"resetButtonGroup",value:function(o){iu(o),this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,"l7-button-control",o,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,"l7-button-control",o,this.zoomOut),this.updateDisabled()}},{key:"createButton",value:function(o,h,v,m,E){var A=bt("button",v,m);return typeof o=="string"?A.innerHTML=o:A.append(o),A.title=h,A.addEventListener("click",E),A}}]),a}(v0);function u3(n){var l=Bv();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Bv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var l3=function(n){(0,Zt.Z)(a,n);var l=u3(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"update",function(){var m=s.mapsService,E=s.controlOption.maxWidth,A=m.getSize()[1]/2,F=m.containerToLngLat([0,A]),B=m.containerToLngLat([E,A]),V=Ts([F.lng,F.lat],[B.lng,B.lat]);s.updateScales(V)}),s}return(0,et.Z)(a,[{key:"getDefault",value:function(o){return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{name:"scale",position:Vl.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,lockWidth:!0})}},{key:"onAdd",value:function(){var o="l7-control-scale",h=bt("div",o);this.resetScaleLines(h);var v=this.controlOption.updateWhenIdle;return this.mapsService.on(v?"moveend":"mapmove",this.update),this.mapsService.on(v?"zoomend":"zoomchange",this.update),h}},{key:"onRemove",value:function(){var o=this.controlOption.updateWhenIdle;this.mapsService.off(o?"zoomend":"zoomchange",this.update),this.mapsService.off(o?"moveend":"mapmove",this.update)}},{key:"setOptions",value:function(o){$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.checkUpdateOption(o,["lockWidth","maxWidth","metric","updateWhenIdle","imperial"])&&this.resetScaleLines(this.container)}},{key:"updateScales",value:function(o){var h=this.controlOption,v=h.metric,m=h.imperial;v&&o&&this.updateMetric(o),m&&o&&this.updateImperial(o)}},{key:"resetScaleLines",value:function(o){iu(o);var h=this.controlOption,v=h.metric,m=h.imperial,E=h.maxWidth,A=h.lockWidth;A&&Ao(o,"width: ".concat(E,"px")),v&&(this.mScale=bt("div","l7-control-scale-line",o)),m&&(this.iScale=bt("div","l7-control-scale-line",o)),this.update()}},{key:"updateScale",value:function(o,h,v){var m=this.controlOption.maxWidth;o.style.width=Math.round(m*v)+"px",o.innerHTML=h}},{key:"getRoundNum",value:function(o){var h=Math.pow(10,(Math.floor(o)+"").length-1),v=o/h;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,h*v}},{key:"updateMetric",value:function(o){var h=this.getRoundNum(o),v=h<1e3?h+" m":h/1e3+" km";this.updateScale(this.mScale,v,h/o)}},{key:"updateImperial",value:function(o){var h=o*3.2808399,v,m,E;h>5280?(v=h/5280,m=this.getRoundNum(v),this.updateScale(this.iScale,m+" mi",m/v)):(E=this.getRoundNum(h),this.updateScale(this.iScale,E+" ft",E/h))}}]),a}(v0);function NE(n){var l=zE();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function zE(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var c3=function(n){(0,Zt.Z)(a,n);var l=NE(a);function a(s){var o;(0,ct.Z)(this,a),o=l.call(this),(0,X.Z)((0,st.Z)(o),"isShow",!0),(0,X.Z)((0,st.Z)(o),"onMouseMove",function(v){var m,E=o.mapsService.getMapContainer(),A=(m=E==null?void 0:E.getBoundingClientRect())!==null&&m!==void 0?m:{},F=A.left,B=F===void 0?0:F,V=A.top,j=V===void 0?0:V;o.setPopupPosition(v.clientX-B,v.clientY-j)}),(0,X.Z)((0,st.Z)(o),"updateLngLatPosition",function(){if(!(!o.mapsService||o.popupOption.followCursor)){var v=o.lngLat,m=v.lng,E=v.lat,A=o.mapsService.lngLatToContainer([m,E]),F=A.x,B=A.y;o.setPopupPosition(F,B)}}),(0,X.Z)((0,st.Z)(o),"onKeyDown",function(v){v.keyCode===27&&o.remove()}),(0,X.Z)((0,st.Z)(o),"onCloseButtonClick",function(v){v.stopPropagation&&v.stopPropagation(),o.hide()}),(0,X.Z)((0,st.Z)(o),"update",function(){var v=!!o.lngLat,m=o.popupOption,E=m.className,A=m.style,F=m.maxWidth,B=m.anchor,V=m.stopPropagation;if(!(!o.mapsService||!v||!o.content)){var j=o.mapsService.getMarkerContainer();if(!o.container&&j&&(o.container=bt("div","l7-popup ".concat(E!=null?E:""," ").concat(o.isShow?"":"l7-popup-hide"),j),A&&o.container.setAttribute("style",A),o.tip=bt("div","l7-popup-tip",o.container),o.container.appendChild(o.content),V&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(xt){o.container.addEventListener(xt,function(Nt){Nt.stopPropagation()})}),o.container.style.whiteSpace="nowrap"),o.updateLngLatPosition(),$i(o.container,"".concat(xr[B])),Pr(o.container,B,"popup"),F){var at=o.container.getBoundingClientRect(),ut=at.width;ut>parseFloat(F)&&(o.container.style.width=F)}else o.container.style.removeProperty("width")}}),o.popupOption=(0,q.Z)((0,q.Z)({},o.getDefault(s!=null?s:{})),s);var h=o.popupOption.lngLat;return h&&(o.lngLat=h),o}return(0,et.Z)(a,[{key:"lngLat",get:function(){var o;return(o=this.popupOption.lngLat)!==null&&o!==void 0?o:{lng:0,lat:0}},set:function(o){this.popupOption.lngLat=o}},{key:"getIsShow",value:function(){return this.isShow}},{key:"addTo",value:function(o){this.mapsService=o.get(Dt.IMapService),this.sceneService=o.get(Dt.ISceneService),this.layerService=o.get(Dt.ILayerService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=o,this.update(),this.updateCloseOnClick(),this.updateCloseOnEsc(),this.updateFollowCursor();var h=this.popupOption,v=h.html,m=h.text,E=h.title;return v?this.setHTML(v):m&&this.setText(m),E&&this.setTitle(E),this.emit("open"),this}},{key:"remove",value:function(){if(!!(this!==null&&this!==void 0&&this.isOpen()))return this.content&&nt(this.content),this.container&&(nt(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.updateCloseOnClick(!0),this.updateCloseOnEsc(!0),this.updateFollowCursor(!0),delete this.mapsService),this.emit("close"),this}},{key:"getOptions",value:function(){return this.popupOption}},{key:"setOptions",value:function(o){return this.show(),this.popupOption=(0,q.Z)((0,q.Z)({},this.popupOption),o),this.checkUpdateOption(o,["html","text","title","closeButton","closeButtonOffsets","maxWidth","anchor","stopPropagation","className","style","lngLat","offsets"])&&(this.container&&(nt(this.container),this.container=void 0),this.popupOption.html?this.setHTML(this.popupOption.html):this.popupOption.text&&this.setText(this.popupOption.text),this.popupOption.title&&this.setTitle(this.popupOption.title)),this.checkUpdateOption(o,["closeOnEsc"])&&this.updateCloseOnEsc(),this.checkUpdateOption(o,["closeOnClick"])&&this.updateCloseOnClick(),this.checkUpdateOption(o,["followCursor"])&&this.updateFollowCursor(),this.checkUpdateOption(o,["html"])&&o.html?this.setHTML(o.html):this.checkUpdateOption(o,["text"])&&o.text&&this.setText(o.text),this.checkUpdateOption(o,["lngLat"])&&o.lngLat&&this.setLnglat(o.lngLat),this}},{key:"open",value:function(){return this.addTo(this.scene),this}},{key:"close",value:function(){return this.remove(),this}},{key:"show",value:function(){if(!this.isShow)return this.container&&Ve(this.container,"l7-popup-hide"),this.isShow=!0,this.emit("show"),this}},{key:"hide",value:function(){if(!!this.isShow)return this.container&&se(this.container,"l7-popup-hide"),this.isShow=!1,this.emit("hide"),this}},{key:"setHTML",value:function(o){return this.popupOption.html=o,this.setDOMContent(o)}},{key:"setText",value:function(o){return this.popupOption.text=o,this.setDOMContent(window.document.createTextNode(o))}},{key:"setTitle",value:function(o){this.show(),this.popupOption.title=o,o?(this.contentTitle||(this.contentTitle=bt("div","l7-popup-content__title"),this.content.firstChild?this.content.insertBefore(this.contentTitle,this.content.firstChild):this.content.append(this.contentTitle)),iu(this.contentTitle),$s(this.contentTitle,o)):this.contentTitle&&(nt(this.contentTitle),this.contentTitle=void 0)}},{key:"panToPopup",value:function(){var o=this.lngLat,h=o.lng,v=o.lat;return this.popupOption.autoPan&&this.mapsService.panTo([h,v]),this}},{key:"setLngLat",value:function(o){return this.setLnglat(o)}},{key:"setLnglat",value:function(o){var h=this;return this.show(),this.lngLat=o,Array.isArray(o)&&(this.lngLat={lng:o[0],lat:o[1]}),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this.popupOption.autoPan&&setTimeout(function(){h.panToPopup()},0),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setMaxWidth",value:function(o){return this.popupOption.maxWidth=o,this.update(),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"getDefault",value:function(o){return{closeButton:!0,closeOnClick:!1,maxWidth:"240px",offsets:[0,0],anchor:rr.BOTTOM,stopPropagation:!0,autoPan:!1,autoClose:!0,closeOnEsc:!1,followCursor:!1}}},{key:"setDOMContent",value:function(o){return this.show(),this.createContent(),$s(this.contentPanel,o),this.update(),this}},{key:"updateCloseOnClick",value:function(o){var h=this,v=this.mapsService;v&&(v==null||v.off("click",this.onCloseButtonClick),this.popupOption.closeOnClick&&!o&&requestAnimationFrame(function(){v==null||v.on("click",h.onCloseButtonClick)}))}},{key:"updateCloseOnEsc",value:function(o){window.removeEventListener("keydown",this.onKeyDown),this.popupOption.closeOnEsc&&!o&&window.addEventListener("keydown",this.onKeyDown)}},{key:"updateFollowCursor",value:function(o){var h,v=(h=this.mapsService)===null||h===void 0?void 0:h.getContainer();v&&(v==null||v.removeEventListener("mousemove",this.onMouseMove),this.popupOption.followCursor&&!o&&(v==null||v.addEventListener("mousemove",this.onMouseMove)))}},{key:"createContent",value:function(){var o=this;if(this.content&&nt(this.content),this.contentTitle=void 0,this.content=bt("div","l7-popup-content",this.container),this.setTitle(this.popupOption.title),this.popupOption.closeButton){var h=Yd("l7-icon-guanbi");se(h,"l7-popup-close-button"),this.content.appendChild(h),this.popupOption.closeButtonOffsets&&(h.style.right=this.popupOption.closeButtonOffsets[0]+"px",h.style.top=this.popupOption.closeButtonOffsets[1]+"px"),h.setAttribute("aria-label","Close popup"),h.addEventListener("click",function(){o.hide()}),this.closeButton=h}else this.closeButton=void 0;this.contentPanel=bt("div","l7-popup-content__panel",this.content)}},{key:"setPopupPosition",value:function(o,h){if(this.container){var v=this.popupOption.offsets;this.container.style.left=o+v[0]+"px",this.container.style.top=h-v[1]+"px"}}},{key:"checkUpdateOption",value:function(o,h){return h.some(function(v){return v in o})}}]),a}(Se.EventEmitter);function f3(n){var l=FO();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function FO(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var h3=function(n){(0,Zt.Z)(a,n);var l=f3(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"layerConfigMap",new WeakMap),s}return(0,et.Z)(a,[{key:"layerConfigItems",get:function(){var o,h=this.popupOption,v=h.config,m=h.items;return(o=v!=null?v:m)!==null&&o!==void 0?o:[]}},{key:"addTo",value:function(o){return $o((0,b.Z)(a.prototype),"addTo",this).call(this,o),this.bindLayerEvent(),this.hide(),this}},{key:"remove",value:function(){return $o((0,b.Z)(a.prototype),"remove",this).call(this),this.unbindLayerEvent(),this}},{key:"setOptions",value:function(o){return this.unbindLayerEvent(),$o((0,b.Z)(a.prototype),"setOptions",this).call(this,o),this.bindLayerEvent(),this}},{key:"getDefault",value:function(o){var h=o.trigger==="click";return(0,q.Z)((0,q.Z)({},$o((0,b.Z)(a.prototype),"getDefault",this).call(this,o)),{},{trigger:"hover",followCursor:!h,lngLat:{lng:0,lat:0},offsets:[0,10],closeButton:!1,closeOnClick:!1,autoClose:!1,closeOnEsc:!1})}},{key:"bindLayerEvent",value:function(){var o=this,h=this.popupOption.trigger;this.layerConfigItems.forEach(function(v){var m,E=o.getLayerByConfig(v);if(!!E){var A=(0,q.Z)({},v);if(h==="hover"){var F=o.onLayerMouseMove.bind(o,E),B=o.onLayerMouseOut.bind(o,E);A.onMouseMove=F,A.onMouseOut=B,E==null||E.on("mousemove",F),E==null||E.on("mouseout",B)}else{var V=o.onLayerClick.bind(o,E);A.onClick=V,E==null||E.on("click",V)}var j=E==null||(m=E.getSource)===null||m===void 0?void 0:m.call(E),at=o.onSourceUpdate.bind(o,E);j==null||j.on("update",at),A.onSourceUpdate=at,o.layerConfigMap.set(E,A)}})}},{key:"unbindLayerEvent",value:function(){var o=this;this.layerConfigItems.forEach(function(h){var v=o.getLayerByConfig(h),m=v&&o.layerConfigMap.get(v);if(!!m){var E=m.onMouseMove,A=m.onMouseOut,F=m.onClick,B=m.onSourceUpdate;if(E&&v.off("mousemove",E),A&&v.off("mouseout",A),F&&v.off("click",F),B){var V;v==null||(V=v.getSource())===null||V===void 0||V.off("update",B)}}})}},{key:"onLayerMouseMove",value:function(o,h){if(!this.isSameFeature(o,h.featureId)){var v=this.getLayerInfoFrag(o,h),m=v.title,E=v.content;this.setDOMContent(E),this.setTitle(m),this.displayFeatureInfo={layer:o,featureId:h.featureId},this.show()}}},{key:"onLayerMouseOut",value:function(o,h){this.displayFeatureInfo=void 0,this.isShow&&this.hide()}},{key:"onLayerClick",value:function(o,h){if(this.isShow&&this.isSameFeature(o,h.featureId))this.hide();else{var v=this.getLayerInfoFrag(o,h),m=v.title,E=v.content;this.setDOMContent(E),this.setLnglat(h.lngLat),this.setTitle(m),this.displayFeatureInfo={layer:o,featureId:h.featureId},this.show()}}},{key:"onSourceUpdate",value:function(o){var h;((h=this.displayFeatureInfo)===null||h===void 0?void 0:h.layer)===o&&(this.hide(),this.displayFeatureInfo=void 0)}},{key:"getLayerInfoFrag",value:function(o,h){var v=this.layerConfigMap.get(o),m,E=document.createDocumentFragment();if(v){var A=h.feature;A.type==="Feature"&&"properties"in A&&"geometry"in A&&(A=A.properties);var F=v.title,B=v.fields,V=v.customContent;if(F){m=document.createDocumentFragment();var j=F instanceof Function?F(A):F;$s(m,j)}if(V){var at=V instanceof Function?V(A):V;$s(E,at)}else B!=null&&B.length&&(B==null||B.forEach(function(ut){var xt,Nt,de=typeof ut=="string"?{field:ut}:ut,fe=de.field,Ne=de.formatField,Ye=de.formatValue,_r=de.getValue,Ir=bt("div","l7-layer-popup__row"),Nr=_r?_r(h.feature):(0,ee.get)(A,fe),Yr=(xt=Ne instanceof Function?Ne(fe,A):Ne)!==null&&xt!==void 0?xt:fe,yn=(Nt=Ye instanceof Function?Ye(Nr,A):Ye)!==null&&Nt!==void 0?Nt:Nr,fn=bt("span","l7-layer-popup__key",Ir);$s(fn,Yr),$s(fn,document.createTextNode("\uFF1A"));var $n=bt("span","l7-layer-popup__value",Ir);$s($n,yn),E.appendChild(Ir)}))}return{title:m,content:E}}},{key:"getLayerByConfig",value:function(o){var h=o.layer;if(h instanceof Object)return h;if(typeof h=="string")return this.layerService.getLayer(h)||this.layerService.getLayerByName(h)}},{key:"isSameFeature",value:function(o,h){var v=this.displayFeatureInfo;return v&&o===v.layer&&h===v.featureId}}]),a}(c3);function _y(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}_y(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  -webkit-box-shadow: none;
          box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 1000;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
}
.l7-control-container {
  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 800;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  position: absolute;
  z-index: 1000;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-control-container .l7-column {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  -webkit-transition: all 0.2s;
  transition: all 0.2s;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 6px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-popper.l7-popper-end {
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  height: 24px;
  line-height: 24px;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  padding: 0 16px;
  font-size: 12px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  height: 14px;
  width: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  padding: 12px 12px 0 12px;
  width: 474px;
  height: 320px;
  overflow: auto;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -ms-flex-wrap: wrap;
      flex-wrap: wrap;
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  -webkit-box-align: start;
      -ms-flex-align: start;
          align-items: flex-start;
}
.l7-select-control--image .l7-select-control-item {
  margin-right: 12px;
  border-radius: 2px;
  overflow: hidden;
  border: 1px solid #fff;
  -webkit-box-sizing: content-box;
          box-sizing: content-box;
  width: calc((100% - 36px) / 3);
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  margin-bottom: 12px;
  position: relative;
  font-size: 12px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 142px;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  right: 0;
  top: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: center;
      -ms-flex-pack: center;
          justify-content: center;
  -webkit-box-align: center;
      -ms-flex-align: center;
          align-items: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control--image .l7-select-control-item:nth-child(3n) {
  margin-right: 0;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  -webkit-box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
          box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  border-radius: 2px;
  overflow: hidden;
}
.l7-control-zoom .l7-button-control {
  -webkit-box-shadow: 0 0 0;
          box-shadow: 0 0 0;
  border-radius: 0;
  font-size: 16px;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:first-child {
  border-bottom: 1px solid #f0f0f0;
}
.l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  -webkit-box-sizing: border-box;
          box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  -webkit-transition: width 0.1s;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-align: end;
      -ms-flex-align: end;
          align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: reverse;
      -ms-flex-direction: column-reverse;
          flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  -webkit-box-orient: vertical;
  -webkit-box-direction: normal;
      -ms-flex-direction: column;
          flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: normal;
      -ms-flex-direction: row;
          flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  -webkit-box-orient: horizontal;
  -webkit-box-direction: reverse;
      -ms-flex-direction: row-reverse;
          flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  -webkit-align-self: flex-start;
  -ms-flex-item-align: start;
      align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  -webkit-align-self: flex-end;
  -ms-flex-item-align: end;
      align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  -webkit-align-self: center;
  -ms-flex-item-align: center;
      align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
`);var UE={},ZE={},VE=function(l){return ZE[l]},nd=function(l,a){ZE[l]=a},xy=function(l){return UE[l]},g0=function(l,a){UE[l]=a},GE={},L1={},P1=34,nm=10,O1=13;function HE(n){return new Function("d","return {"+n.map(function(l,a){return JSON.stringify(l)+": d["+a+'] || ""'}).join(",")+"}")}function p3(n,l){var a=HE(n);return function(s,o){return l(a(s),o,n)}}function jE(n){var l=Object.create(null),a=[];return n.forEach(function(s){for(var o in s)o in l||a.push(l[o]=o)}),a}function Ff(n,l){var a=n+"",s=a.length;return s<l?new Array(l-s+1).join(0)+a:a}function WE(n){return n<0?"-"+Ff(-n,6):n>9999?"+"+Ff(n,6):Ff(n,4)}function v3(n){var l=n.getUTCHours(),a=n.getUTCMinutes(),s=n.getUTCSeconds(),o=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":WE(n.getUTCFullYear(),4)+"-"+Ff(n.getUTCMonth()+1,2)+"-"+Ff(n.getUTCDate(),2)+(o?"T"+Ff(l,2)+":"+Ff(a,2)+":"+Ff(s,2)+"."+Ff(o,3)+"Z":s?"T"+Ff(l,2)+":"+Ff(a,2)+":"+Ff(s,2)+"Z":a||l?"T"+Ff(l,2)+":"+Ff(a,2)+"Z":"")}function g3(n){var l=new RegExp('["'+n+`
\r]`),a=n.charCodeAt(0);function s(B,V){var j,at,ut=o(B,function(xt,Nt){if(j)return j(xt,Nt-1);at=xt,j=V?p3(xt,V):HE(xt)});return ut.columns=at||[],ut}function o(B,V){var j=[],at=B.length,ut=0,xt=0,Nt,de=at<=0,fe=!1;B.charCodeAt(at-1)===nm&&--at,B.charCodeAt(at-1)===O1&&--at;function Ne(){if(de)return L1;if(fe)return fe=!1,GE;var _r,Ir=ut,Nr;if(B.charCodeAt(Ir)===P1){for(;ut++<at&&B.charCodeAt(ut)!==P1||B.charCodeAt(++ut)===P1;);return(_r=ut)>=at?de=!0:(Nr=B.charCodeAt(ut++))===nm?fe=!0:Nr===O1&&(fe=!0,B.charCodeAt(ut)===nm&&++ut),B.slice(Ir+1,_r-1).replace(/""/g,'"')}for(;ut<at;){if((Nr=B.charCodeAt(_r=ut++))===nm)fe=!0;else if(Nr===O1)fe=!0,B.charCodeAt(ut)===nm&&++ut;else if(Nr!==a)continue;return B.slice(Ir,_r)}return de=!0,B.slice(Ir,at)}for(;(Nt=Ne())!==L1;){for(var Ye=[];Nt!==GE&&Nt!==L1;)Ye.push(Nt),Nt=Ne();V&&(Ye=V(Ye,xt++))==null||j.push(Ye)}return j}function h(B,V){return B.map(function(j){return V.map(function(at){return F(j[at])}).join(n)})}function v(B,V){return V==null&&(V=jE(B)),[V.map(F).join(n)].concat(h(B,V)).join(`
`)}function m(B,V){return V==null&&(V=jE(B)),h(B,V).join(`
`)}function E(B){return B.map(A).join(`
`)}function A(B){return B.map(F).join(n)}function F(B){return B==null?"":B instanceof Date?v3(B):l.test(B+="")?'"'+B.replace(/"/g,'""')+'"':B}return{parse:s,parseRows:o,format:v,formatBody:m,formatRows:E,formatRow:A,formatValue:F}}var m0=g3(","),m3=m0.parse,RO=m0.parseRows,XE=m0.format,y3=m0.formatBody,DO=m0.formatRows,YE=m0.formatRow,BO=m0.formatValue,_3=ot(38163),F1=ot.n(_3);function NO(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function $E(n){if(Array.isArray(n))return n;if(n.type==="Feature"){if(n.geometry!==null)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function R1(n){if(n.length>1&&isNumber(n[0])&&isNumber(n[1]))return!0;if(Array.isArray(n[0])&&n[0].length)return R1(n[0]);throw new Error("coordinates must only contain numbers")}function zO(n,l,a){if(!l||!a)throw new Error("type and name required");if(!n||n.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+n.type)}function UO(n,l,a){if(!n)throw new Error("No feature passed");if(!a)throw new Error(".featureOf() requires a name");if(!n||n.type!=="Feature"||!n.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!n.geometry||n.geometry.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+n.geometry.type)}function ZO(n,l,a){if(!n)throw new Error("No featureCollection passed");if(!a)throw new Error(".collectionOf() requires a name");if(!n||n.type!=="FeatureCollection")throw new Error("Invalid input to "+a+", FeatureCollection required");for(var s=0,o=n.features;s<o.length;s++){var h=o[s];if(!h||h.type!=="Feature"||!h.geometry)throw new Error("Invalid input to "+a+", Feature with geometry required");if(!h.geometry||h.geometry.type!==l)throw new Error("Invalid input to "+a+": must be a "+l+", given "+h.geometry.type)}}function by(n){return n.type==="Feature"?n.geometry:n}function VO(n,l){return n.type==="FeatureCollection"?"FeatureCollection":n.type==="GeometryCollection"?"GeometryCollection":n.type==="Feature"&&n.geometry!==null?n.geometry.type:n.type}function qE(n,l){var a=l.x,s=l.y,o=l.x1,h=l.y1,v=l.coordinates,m=l.geometry,E=[];if(!Array.isArray(n))return{dataArray:[]};if(m)return n.filter(function(Nt){return Nt[m]&&Nt[m].type&&Nt[m].coordinates&&Nt[m].coordinates.length>0}).forEach(function(Nt,de){var fe=F1()((0,q.Z)({},Nt[m]),!0);as(fe,function(Ne){var Ye=$E(Ne),_r=(0,q.Z)((0,q.Z)({},Nt),{},{_id:de,coordinates:Ye});E.push(_r)})}),{dataArray:E};for(var A=0;A<n.length;A++){var F=n[A],B=[];if(v){var V="Polygon";Array.isArray(v[0])||(V="Point"),Array.isArray(v[0])&&!Array.isArray(v[0][0])&&(V="LineString");var j=F1()({type:V,coordinates:(0,me.Z)(F[v])},!0);B=j.coordinates}else if(a&&s&&o&&h){var at=[parseFloat(F[a]),parseFloat(F[s])],ut=[parseFloat(F[o]),parseFloat(F[h])];B=[at,ut]}else a&&s&&(B=[parseFloat(F[a]),parseFloat(F[s])]);var xt=(0,q.Z)((0,q.Z)({},F),{},{_id:A,coordinates:B});E.push(xt)}return{dataArray:E}}function im(n,l){var a=m3(n);return qE(a,l)}function am(n){for(var l=n.toString(),a=5381,s=l.length;s;)a=a*33^l.charCodeAt(--s);return a>>>0}function D1(n,l){return l===void 0?null:n.properties[l]?n.properties[l]:n.properties&&n.properties[l]?am(n.properties[l]+"")%1000019:null}function KE(n,l){var a=[],s={};return n.features?(n.features=n.features.filter(function(o){var h=o.geometry;return o!=null&&h&&h.type&&h.coordinates&&h.coordinates.length>0}),F1()(n,!0),n.features.length===0?{dataArray:[],featureKeys:s}:(as(n,function(o,h){var v=D1(o,l==null?void 0:l.featureId);v===null&&(v=h);var m=v,E=$E(o),A=(0,q.Z)((0,q.Z)({},o.properties),{},{coordinates:E,_id:m});a.push(A)}),{dataArray:a,featureKeys:s})):(n.features=[],{dataArray:[]})}function Nv(n,l){var a=l.extent,s=a===void 0?[121.168,30.2828,121.384,30.4219]:a,o=new Promise(function(v){n instanceof HTMLImageElement||Wp(n)?v([n]):$d(n,function(m){v(m)})}),h={originData:n,images:o,_id:1,dataArray:[{_id:0,coordinates:[[s[0],s[1]],[s[2],s[3]]]}]};return h}function $d(n,l){var a=n,s=[];if(typeof a=="string")vl({url:a},function(v,m){m&&(s.push(m),l(s))});else{var o=a.length,h=0;a.forEach(function(v){vl({url:v},function(m,E){h++,E&&s.push(E),h===o&&l(s)})})}return Nv}var x3=ot(38929),B1=ot(3614),b3=ot.n(B1),E3=function(){function n(l,a,s,o){(0,ct.Z)(this,n),(0,X.Z)(this,"vectorLayerCache",{}),this.x=a,this.y=s,this.z=o,this.vectorTile=new x3.VectorTile(new(b3())(l))}return(0,et.Z)(n,[{key:"getTileData",value:function(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];var s=this.vectorTile.layers[a];if(Array.isArray(s.features))return this.vectorLayerCache[a]=s.features,s.features;for(var o=[],h=0;h<s.length;h++){var v=s.feature(h),m=v.toGeoJSON(this.x,this.y,this.z);o.push((0,q.Z)((0,q.Z)({},m),{},{properties:(0,q.Z)({id:m.id},m.properties)}))}return this.vectorLayerCache[a]=o,o}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),n}(),w3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},S3=function(){var n=(0,lt.Z)(it().mark(function l(a,s,o,h){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=Bd(a,s),E.abrupt("return",new Promise(function(A){var F=Gc((0,q.Z)((0,q.Z)({},h),{},{url:v}),function(B,V){if(B||!V)A(void 0);else{var j=new E3(V,o.x,o.y,o.z);A(j)}});o.xhrCancel=function(){return F.abort()}}));case 2:case"end":return E.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}();function id(n,l){var a=Array.isArray(n)?n[0]:n,s=function(v,m){return S3(a,v,m,l==null?void 0:l.requestParameters)},o=(0,q.Z)((0,q.Z)((0,q.Z)({},w3),l),{},{getTileData:s});return{data:a,dataArray:[],tilesetOptions:o,isTile:!0}}function N1(n,l,a,s){for(var o=s,h=a-l>>1,v=a-l,m,E=n[l],A=n[l+1],F=n[a],B=n[a+1],V=l+3;V<a;V+=3){var j=QE(n[V],n[V+1],E,A,F,B);if(j>o)m=V,o=j;else if(j===o){var at=Math.abs(V-h);at<v&&(m=V,v=at)}}o>s&&(m-l>3&&N1(n,l,m,s),n[m+2]=o,a-m>3&&N1(n,m,a,s))}function QE(n,l,a,s,o,h){var v=o-a,m=h-s;if(v!==0||m!==0){var E=((n-a)*v+(l-s)*m)/(v*v+m*m);E>1?(a=o,s=h):E>0&&(a+=v*E,s+=m*E)}return v=n-a,m=l-s,v*v+m*m}function om(n,l,a,s){var o={id:typeof n=="undefined"?null:n,type:l,geometry:a,tags:s,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return C3(o),o}function C3(n){var l=n.geometry,a=n.type;if(a==="Point"||a==="MultiPoint"||a==="LineString")z1(n,l);else if(a==="Polygon"||a==="MultiLineString")for(var s=0;s<l.length;s++)z1(n,l[s]);else if(a==="MultiPolygon")for(s=0;s<l.length;s++)for(var o=0;o<l[s].length;o++)z1(n,l[s][o])}function z1(n,l){for(var a=0;a<l.length;a+=3)n.minX=Math.min(n.minX,l[a]),n.minY=Math.min(n.minY,l[a+1]),n.maxX=Math.max(n.maxX,l[a]),n.maxY=Math.max(n.maxY,l[a+1])}function A3(n,l){var a=[];if(n.type==="FeatureCollection")for(var s=0;s<n.features.length;s++)Ey(a,n.features[s],l,s);else n.type==="Feature"?Ey(a,n,l):Ey(a,{geometry:n},l);return a}function Ey(n,l,a,s){if(!!l.geometry){var o=l.geometry.coordinates,h=l.geometry.type,v=Math.pow(a.tolerance/((1<<a.maxZoom)*a.extent),2),m=[],E=l.id;if(a.promoteId?E=l.properties[a.promoteId]:a.generateId&&(E=s||0),h==="Point")JE(o,m);else if(h==="MultiPoint")for(var A=0;A<o.length;A++)JE(o[A],m);else if(h==="LineString")U1(o,m,v,!1);else if(h==="MultiLineString")if(a.lineMetrics){for(A=0;A<o.length;A++)m=[],U1(o[A],m,v,!1),n.push(om(E,"LineString",m,l.properties));return}else Z1(o,m,v,!1);else if(h==="Polygon")Z1(o,m,v,!0);else if(h==="MultiPolygon")for(A=0;A<o.length;A++){var F=[];Z1(o[A],F,v,!0),m.push(F)}else if(h==="GeometryCollection"){for(A=0;A<l.geometry.geometries.length;A++)Ey(n,{id:E,geometry:l.geometry.geometries[A],properties:l.properties},a,s);return}else throw new Error("Input data is not a valid GeoJSON object.");n.push(om(E,h,m,l.properties))}}function JE(n,l){l.push(tw(n[0])),l.push(zv(n[1])),l.push(0)}function U1(n,l,a,s){for(var o,h,v=0,m=0;m<n.length;m++){var E=tw(n[m][0]),A=zv(n[m][1]);l.push(E),l.push(A),l.push(0),m>0&&(s?v+=(o*A-E*h)/2:v+=Math.sqrt(Math.pow(E-o,2)+Math.pow(A-h,2))),o=E,h=A}var F=l.length-3;l[2]=1,N1(l,0,F,a),l[F+2]=1,l.size=Math.abs(v),l.start=0,l.end=l.size}function Z1(n,l,a,s){for(var o=0;o<n.length;o++){var h=[];U1(n[o],h,a,s),l.push(h)}}function tw(n){return n/360+.5}function zv(n){var l=Math.sin(n*Math.PI/180),a=.5-.25*Math.log((1+l)/(1-l))/Math.PI;return a<0?0:a>1?1:a}function qd(n,l,a,s,o,h,v,m){if(a/=l,s/=l,h>=a&&v<s)return n;if(v<a||h>=s)return null;for(var E=[],A=0;A<n.length;A++){var F=n[A],B=F.geometry,V=F.type,j=o===0?F.minX:F.minY,at=o===0?F.maxX:F.maxY;if(j>=a&&at<s){E.push(F);continue}else if(at<a||j>=s)continue;var ut=[];if(V==="Point"||V==="MultiPoint")T3(B,ut,a,s,o);else if(V==="LineString")V1(B,ut,a,s,o,!1,m.lineMetrics);else if(V==="MultiLineString")H1(B,ut,a,s,o,!1);else if(V==="Polygon")H1(B,ut,a,s,o,!0);else if(V==="MultiPolygon")for(var xt=0;xt<B.length;xt++){var Nt=[];H1(B[xt],Nt,a,s,o,!0),Nt.length&&ut.push(Nt)}if(ut.length){if(m.lineMetrics&&V==="LineString"){for(xt=0;xt<ut.length;xt++)E.push(om(F.id,V,ut[xt],F.tags));continue}(V==="LineString"||V==="MultiLineString")&&(ut.length===1?(V="LineString",ut=ut[0]):V="MultiLineString"),(V==="Point"||V==="MultiPoint")&&(V=ut.length===3?"Point":"MultiPoint"),E.push(om(F.id,V,ut,F.tags))}}return E.length?E:null}function T3(n,l,a,s,o){for(var h=0;h<n.length;h+=3){var v=n[h+o];v>=a&&v<=s&&(l.push(n[h]),l.push(n[h+1]),l.push(n[h+2]))}}function V1(n,l,a,s,o,h,v){for(var m=G1(n),E=o===0?_0:M3,A=n.start,F,B,V=0;V<n.length-3;V+=3){var j=n[V],at=n[V+1],ut=n[V+2],xt=n[V+3],Nt=n[V+4],de=o===0?j:at,fe=o===0?xt:Nt,Ne=!1;v&&(F=Math.sqrt(Math.pow(j-xt,2)+Math.pow(at-Nt,2))),de<a?fe>a&&(B=E(m,j,at,xt,Nt,a),v&&(m.start=A+F*B)):de>s?fe<s&&(B=E(m,j,at,xt,Nt,s),v&&(m.start=A+F*B)):y0(m,j,at,ut),fe<a&&de>=a&&(B=E(m,j,at,xt,Nt,a),Ne=!0),fe>s&&de<=s&&(B=E(m,j,at,xt,Nt,s),Ne=!0),!h&&Ne&&(v&&(m.end=A+F*B),l.push(m),m=G1(n)),v&&(A+=F)}var Ye=n.length-3;j=n[Ye],at=n[Ye+1],ut=n[Ye+2],de=o===0?j:at,de>=a&&de<=s&&y0(m,j,at,ut),Ye=m.length-3,h&&Ye>=3&&(m[Ye]!==m[0]||m[Ye+1]!==m[1])&&y0(m,m[0],m[1],m[2]),m.length&&l.push(m)}function G1(n){var l=[];return l.size=n.size,l.start=n.start,l.end=n.end,l}function H1(n,l,a,s,o,h){for(var v=0;v<n.length;v++)V1(n[v],l,a,s,o,h,!1)}function y0(n,l,a,s){n.push(l),n.push(a),n.push(s)}function _0(n,l,a,s,o,h){var v=(h-l)/(s-l);return n.push(h),n.push(a+(o-a)*v),n.push(1),v}function M3(n,l,a,s,o,h){var v=(h-a)/(o-a);return n.push(l+(s-l)*v),n.push(h),n.push(1),v}function j1(n,l){var a=l.buffer/l.extent,s=n,o=qd(n,1,-1-a,a,0,-1,2,l),h=qd(n,1,1-a,2+a,0,-1,2,l);return(o||h)&&(s=qd(n,1,-a,1+a,0,-1,2,l)||[],o&&(s=ew(o,1).concat(s)),h&&(s=s.concat(ew(h,-1)))),s}function ew(n,l){for(var a=[],s=0;s<n.length;s++){var o=n[s],h=o.type,v;if(h==="Point"||h==="MultiPoint"||h==="LineString")v=W1(o.geometry,l);else if(h==="MultiLineString"||h==="Polygon"){v=[];for(var m=0;m<o.geometry.length;m++)v.push(W1(o.geometry[m],l))}else if(h==="MultiPolygon")for(v=[],m=0;m<o.geometry.length;m++){for(var E=[],A=0;A<o.geometry[m].length;A++)E.push(W1(o.geometry[m][A],l));v.push(E)}a.push(om(o.id,h,v,o.tags))}return a}function W1(n,l){var a=[];a.size=n.size,n.start!==void 0&&(a.start=n.start,a.end=n.end);for(var s=0;s<n.length;s+=3)a.push(n[s]+l,n[s+1],n[s+2]);return a}function rw(n,l){if(n.transformed)return n;var a=1<<n.z,s=n.x,o=n.y,h,v,m;for(h=0;h<n.features.length;h++){var E=n.features[h],A=E.geometry,F=E.type;if(E.geometry=[],F===1)for(v=0;v<A.length;v+=2)E.geometry.push(nw(A[v],A[v+1],l,a,s,o));else for(v=0;v<A.length;v++){var B=[];for(m=0;m<A[v].length;m+=2)B.push(nw(A[v][m],A[v][m+1],l,a,s,o));E.geometry.push(B)}}return n.transformed=!0,n}function nw(n,l,a,s,o,h){return[Math.round(a*(n*s-o)),Math.round(a*(l*s-h))]}function fg(n,l,a,s,o){for(var h=l===o.maxZoom?0:o.tolerance/((1<<l)*o.extent),v={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:a,y:s,z:l,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},m=0;m<n.length;m++){v.numFeatures++,wy(v,n[m],h,o);var E=n[m].minX,A=n[m].minY,F=n[m].maxX,B=n[m].maxY;E<v.minX&&(v.minX=E),A<v.minY&&(v.minY=A),F>v.maxX&&(v.maxX=F),B>v.maxY&&(v.maxY=B)}return v}function wy(n,l,a,s){var o=l.geometry,h=l.type,v=[];if(h==="Point"||h==="MultiPoint")for(var m=0;m<o.length;m+=3)v.push(o[m]),v.push(o[m+1]),n.numPoints++,n.numSimplified++;else if(h==="LineString")X1(v,o,n,a,!1,!1);else if(h==="MultiLineString"||h==="Polygon")for(m=0;m<o.length;m++)X1(v,o[m],n,a,h==="Polygon",m===0);else if(h==="MultiPolygon")for(var E=0;E<o.length;E++){var A=o[E];for(m=0;m<A.length;m++)X1(v,A[m],n,a,!0,m===0)}if(v.length){var F=l.tags||null;if(h==="LineString"&&s.lineMetrics){F={};for(var B in l.tags)F[B]=l.tags[B];F.mapbox_clip_start=o.start/o.size,F.mapbox_clip_end=o.end/o.size}var V={geometry:v,type:h==="Polygon"||h==="MultiPolygon"?3:h==="LineString"||h==="MultiLineString"?2:1,tags:F};l.id!==null&&(V.id=l.id),n.features.push(V)}}function X1(n,l,a,s,o,h){var v=s*s;if(s>0&&l.size<(o?v:s)){a.numPoints+=l.length/3;return}for(var m=[],E=0;E<l.length;E+=3)(s===0||l[E+2]>v)&&(a.numSimplified++,m.push(l[E]),m.push(l[E+1])),a.numPoints++;o&&I3(m,h),n.push(m)}function I3(n,l){for(var a=0,s=0,o=n.length,h=o-2;s<o;h=s,s+=2)a+=(n[s]-n[h])*(n[s+1]+n[h+1]);if(a>0===l)for(s=0,o=n.length;s<o/2;s+=2){var v=n[s],m=n[s+1];n[s]=n[o-2-s],n[s+1]=n[o-1-s],n[o-2-s]=v,n[o-1-s]=m}}function hg(n,l){return new Sy(n,l)}function Sy(n,l){l=this.options=iw(Object.create(this.options),l);var a=l.debug;if(a&&console.time("preprocess data"),l.maxZoom<0||l.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(l.promoteId&&l.generateId)throw new Error("promoteId and generateId cannot be used together.");var s=A3(n,l);this.tiles={},this.tileCoords=[],a&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",l.indexMaxZoom,l.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),s=j1(s,l),s.length&&this.splitTile(s,0,0,0),a&&(s.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Sy.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Sy.prototype.splitTile=function(n,l,a,s,o,h,v){for(var m=[n,l,a,s],E=this.options,A=E.debug;m.length;){s=m.pop(),a=m.pop(),l=m.pop(),n=m.pop();var F=1<<l,B=Y1(l,a,s),V=this.tiles[B];if(!V&&(A>1&&console.time("creation"),V=this.tiles[B]=fg(n,l,a,s,E),this.tileCoords.push({z:l,x:a,y:s}),A)){A>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",l,a,s,V.numFeatures,V.numPoints,V.numSimplified),console.timeEnd("creation"));var j="z"+l;this.stats[j]=(this.stats[j]||0)+1,this.total++}if(V.source=n,o){if(l===E.maxZoom||l===o)continue;var at=1<<o-l;if(a!==Math.floor(h/at)||s!==Math.floor(v/at))continue}else if(l===E.indexMaxZoom||V.numPoints<=E.indexMaxPoints)continue;if(V.source=null,n.length!==0){A>1&&console.time("clipping");var ut=.5*E.buffer/E.extent,xt=.5-ut,Nt=.5+ut,de=1+ut,fe,Ne,Ye,_r,Ir,Nr;fe=Ne=Ye=_r=null,Ir=qd(n,F,a-ut,a+Nt,0,V.minX,V.maxX,E),Nr=qd(n,F,a+xt,a+de,0,V.minX,V.maxX,E),n=null,Ir&&(fe=qd(Ir,F,s-ut,s+Nt,1,V.minY,V.maxY,E),Ne=qd(Ir,F,s+xt,s+de,1,V.minY,V.maxY,E),Ir=null),Nr&&(Ye=qd(Nr,F,s-ut,s+Nt,1,V.minY,V.maxY,E),_r=qd(Nr,F,s+xt,s+de,1,V.minY,V.maxY,E),Nr=null),A>1&&console.timeEnd("clipping"),m.push(fe||[],l+1,a*2,s*2),m.push(Ne||[],l+1,a*2,s*2+1),m.push(Ye||[],l+1,a*2+1,s*2),m.push(_r||[],l+1,a*2+1,s*2+1)}}},Sy.prototype.getTile=function(n,l,a){var s=this.options,o=s.extent,h=s.debug;if(n<0||n>24)return null;var v=1<<n;l=(l%v+v)%v;var m=Y1(n,l,a);if(this.tiles[m])return rw(this.tiles[m],o);h>1&&console.log("drilling down to z%d-%d-%d",n,l,a);for(var E=n,A=l,F=a,B;!B&&E>0;)E--,A=Math.floor(A/2),F=Math.floor(F/2),B=this.tiles[Y1(E,A,F)];return!B||!B.source?null:(h>1&&console.log("found parent tile z%d-%d-%d",E,A,F),h>1&&console.time("drilling down"),this.splitTile(B.source,E,A,F,n,l,a),h>1&&console.timeEnd("drilling down"),this.tiles[m]?rw(this.tiles[m],o):null)};function Y1(n,l,a){return((1<<n)*a+l)*32+n}function iw(n,l){for(var a in l)n[a]=l[a];return n}var $1=function(){function n(l,a,s,o){(0,ct.Z)(this,n),(0,X.Z)(this,"vectorLayerCache",{}),this.x=a,this.y=s,this.z=o,this.vectorTile=l}return(0,et.Z)(n,[{key:"getTileData",value:function(a){if(!a||!this.vectorTile.layers[a])return[];if(this.vectorLayerCache[a])return this.vectorLayerCache[a];var s=this.vectorTile.layers[a];return s.features}},{key:"getFeatureById",value:function(){throw new Error("Method not implemented.")}}]),n}(),k3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function L3(n){for(var l=0,a=0,s=n.length,o=s-1,h,v;a<s;o=a++)h=n[a],v=n[o],l+=(v.x-h.x)*(h.y+v.y);return l}function P3(n){var l=n.length;if(l<=1)return[n];for(var a=[],s,o,h=0;h<l;h++){var v=L3(n[h]);v!==0&&(o===void 0&&(o=v<0),o===v<0?(s&&a.push(s),s=[n[h]]):s.push(n[h]))}return s&&a.push(s),a}var q1=["Unknown","Point","LineString","Polygon"];function O3(n,l,a,s,o){var h=o.geometry,v=o.type,m=o.tags,E=o.id,A=n*Math.pow(2,s),F=n*l,B=n*a,V=q1[v],j,at;function ut(de){for(var fe=0;fe<de.length;fe++){var Ne=de[fe];if(Ne[3])break;var Ye=180-(Ne[1]+B)*360/A,_r=(Ne[0]+F)*360/A-180,Ir=360/Math.PI*Math.atan(Math.exp(Ye*Math.PI/180))-90;de[fe]=[_r,Ir,0,1]}}switch(v){case 1:var xt=[];for(j=0;j<h.length;j++)xt[j]=h[j][0];h=xt,ut(h);break;case 2:for(j=0;j<h.length;j++)ut(h[j]);break;case 3:for(h=P3(h),j=0;j<h.length;j++)for(at=0;at<h[j].length;at++)ut(h[j][at]);break}h.length===1?h=h[0]:V="Multi"+V;var Nt={type:"Feature",geometry:{type:V,coordinates:h},properties:m,id:E,tileOrigin:[0,0],coord:""};return Nt}var F3=function(){var n=(0,lt.Z)(it().mark(function l(a,s,o,h){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(E){var A=s.getTile(a.z,a.x,a.y),F=A?A.features.map(function(j){return O3(h,o.x,o.y,o.z,j)}):[],B={layers:{defaultLayer:{features:F}}},V=new $1(B,a.x,a.y,a.z);E(V)}));case 1:case"end":return m.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}();function R3(n){var l={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return n===void 0||typeof n.geojsonvtOptions=="undefined"?l:(0,q.Z)((0,q.Z)({},l),n.geojsonvtOptions)}function aw(n,l){var a=R3(l),s=a.extent||4096,o=hg(n,a),h=function(E,A){return F3(A,o,E,s)},v=(0,q.Z)((0,q.Z)((0,q.Z)({},k3),l),{},{getTileData:h});return{data:n,dataArray:[],tilesetOptions:v,isTile:!0}}function ow(n,l,a){switch(n){case"+":return l+a;case"-":return l-a;case"*":return l*a;case"/":return l/a;case"%":return l%a;case"^":return Math.pow(l,a);case"abs":return Math.abs(l);case"floor":return Math.floor(l);case"round":return Math.round(l);case"ceil":return Math.ceil(l);case"sin":return Math.sin(l);case"cos":return Math.cos(l);case"atan":return a===-1?Math.atan(l):Math.atan2(l,a);default:return console.warn("Calculate symbol err! Return default 0"),0}}function sm(n,l){for(var a=l[0],s=a.width,o=a.height,h=l.map(function(j){return j.rasterData}),v=s*o,m=[],E=JSON.stringify(n),A=0;A<v;A++){var F=JSON.parse(E),B=K1(F,h,A);if(typeof B=="number")m.push(B);else{var V=Cy(F);m.push(V)}}return m}function K1(n,l,a){if(n.length===2&&n[0]==="band"&&typeof n[1]=="number")try{return l[n[1]][a]}catch(s){return console.warn("Raster Data err!"),0}n.map(function(s,o){if(Array.isArray(s)&&s.length>0)switch(s[0]){case"band":try{n[o]=l[s[1]][a]}catch(h){console.warn("Raster Data err!"),n[o]=0}break;default:K1(s,l,a)}})}function D3(n){var l=(0,ht.Z)(n,3),a=l[0],s=l[1],o=s===void 0?-1:s,h=l[2],v=h===void 0?-1:h;if(a===void 0)return console.warn("Express err!"),["+",0,0];var m=a.replace(/\s+/g,"");return[m,o,v]}function Cy(n){var l=D3(n),a=l[0],s=l[1],o=l[2];return Array.isArray(s)&&(s=Cy(n[1])),Array.isArray(o)&&(o=Cy(n[2])),ow(a,s,o)}var B3={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:N3}};function N3(n,l){for(var a=n[0].rasterData,s=n[1].rasterData,o=n[2].rasterData,h=[],v=(l==null?void 0:l.countCut)||[2,98],m=(0,ht.Z)(v,2),E=m[0],A=m[1],F=(l==null?void 0:l.RMinMax)||Q1(a,E,A),B=(l==null?void 0:l.GMinMax)||Q1(s,E,A),V=(l==null?void 0:l.BMinMax)||Q1(o,E,A),j=0;j<a.length;j++)h.push(Math.max(0,a[j]-F[0])),h.push(Math.max(0,s[j]-B[0])),h.push(Math.max(0,o[j]-V[0]));return{rasterData:h,rMinMax:F,gMinMax:B,bMinMax:V}}function Q1(n,l,a){var s=n.slice().sort(function(m,E){return m-E}),o=s.length,h=s[Math.ceil(o*l/100)],v=s[Math.ceil(o*a/100)];return[h,v]}function J1(n,l,a){return tx.apply(this,arguments)}function tx(){return tx=(0,lt.Z)(it().mark(function n(l,a,s){var o,h,v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(l.length!==0){B.next=2;break}return B.abrupt("return",{rasterData:[0],width:1,heigh:1});case 2:return B.next=4,Promise.all(l.map(function(V){var j=V.data,at=V.bands,ut=at===void 0?[0]:at;return a(j,ut)}));case 4:o=B.sent,h=[],o.forEach(function(V){Array.isArray(V)?h.push.apply(h,(0,me.Z)(V)):h.push(V)}),v=h[0],m=v.width,E=v.height,B.t0=(0,Mn.Z)(s),B.next=B.t0==="function"?11:B.t0==="object"?13:15;break;case 11:return A=s(h),B.abrupt("break",16);case 13:return Array.isArray(s)?A={rasterData:sm(s,h)}:A=z3(s,h),B.abrupt("break",16);case 15:A={rasterData:h[0].rasterData};case 16:return B.abrupt("return",(0,q.Z)((0,q.Z)({},A),{},{width:m,height:E}));case 17:case"end":return B.stop()}},n)})),tx.apply(this,arguments)}function z3(n,l){var a=B3[n.type];if(a.type==="function")return a.method(l,n==null?void 0:n.options);if(a.type==="operation")return n.type==="rgb"?sw(a.expression,l):{rasterData:sm(a.expression,l)}}function sw(n,l){n.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),n.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),n.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");var a=sm(n.r||["band",0],l),s=sm(n.g||["band",0],l),o=sm(n.b||["band",0],l);return[a,s,o]}function Bc(n,l,a,s){return ex.apply(this,arguments)}function ex(){return ex=(0,lt.Z)(it().mark(function n(l,a,s,o){var h;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,J1(l,a,s);case 2:h=m.sent,o(null,{data:h});case 4:case"end":return m.stop()}},n)})),ex.apply(this,arguments)}function Ay(n,l){return n.map(function(a){return a[l]*1})}function U3(n){return n===void 0?!1:!Array.isArray(n)&&n.data!==void 0}function uw(n){return Array.isArray(n)?n.length===0?!1:!!U3(n[0]):!1}function lw(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":!1}function Z3(n,l){var a=l.extent,s=l.width,o=l.height,h=l.min,v=l.max,m=l.format,E=l.operation,A,F,B;if(m===void 0||lw(n))A=Array.from(n),F=s,B=o;else{var V=Array.isArray(n)?n:[n];A=J1(V,m,E)}var j={_id:1,dataArray:[{_id:1,data:A,width:F,height:B,min:h,max:v,coordinates:[[a[0],a[1]],[a[2],a[3]]]}]};return j}var V3=["extent","min","max","width","height","format","operation"];function cw(n,l){var a=l.extent,s=l.min,o=l.max,h=l.width,v=l.height,m=l.format,E=l.operation,A=(0,Wl.Z)(l,V3),F;if(m===void 0||lw(n))F=Array.from(n);else{var B=Array.isArray(n)?n:[n];F=J1(B,m,E)}var V={_id:1,dataArray:[(0,q.Z)((0,q.Z)({_id:1,data:F,width:h,height:v},A),{},{min:s,max:o,coordinates:[[a[0],a[1]],[a[2],a[3]]]})]};return V}var G3=function(){var n=(0,lt.Z)(it().mark(function l(a,s,o,h){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",new Promise(function(E,A){s({x:a.x,y:a.y,z:a.z},function(F,B){if(F||B.length===0){A(F);return}B&&Bc([{data:B,bands:[0]}],o,h,function(V,j){V?A(V):j&&E(j)})})}));case 1:case"end":return m.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}();function H3(n,l){return Array.isArray(n)?typeof n[0]=="string"?n.map(function(a){return Bd(a,l)}):n.map(function(a){return{url:Bd(a.url,l),bands:a.bands||[0]}}):Bd(n,l)}function j3(n){return typeof n=="string"?[{url:n,bands:[0]}]:typeof n[0]=="string"?n.map(function(l){return{url:l,bands:[0]}}):n}function fw(n,l){n.xhrCancel=function(){l.map(function(a){a.abort()})}}var W3=function(){var n=(0,lt.Z)(it().mark(function l(a,s,o,h,v){var m,E,A,F,B,V;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:if(m=j3(s.url),!(m.length>1)){at.next=15;break}return at.next=4,X3(m,s);case 4:if(E=at.sent,A=E.rasterFiles,F=E.xhrList,B=E.errList,fw(a,F),!(B.length>0)){at.next=12;break}return o(B,null),at.abrupt("return");case 12:Bc(A,h,v,o),at.next=17;break;case 15:V=Gc(s,function(ut,xt){if(ut)o(ut);else if(xt){var Nt=[{data:xt,bands:m[0].bands}];Bc(Nt,h,v,o)}}),fw(a,[V]);case 17:case"end":return at.stop()}},l)}));return function(a,s,o,h,v){return n.apply(this,arguments)}}();function X3(n,l){return rx.apply(this,arguments)}function rx(){return rx=(0,lt.Z)(it().mark(function n(l,a){var s,o,h,v,m,E,A,F,B,V,j;return it().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:s=[],o=[],h=[],v=0;case 4:if(!(v<l.length)){ut.next=20;break}return m=l[v],E=(0,q.Z)((0,q.Z)({},a),{},{url:m.url}),A=m.bands,ut.next=10,sv((0,q.Z)((0,q.Z)({},E),{},{type:"arrayBuffer"}));case 10:F=ut.sent,B=F.err,V=F.data,j=F.xhr,B&&h.push(B),o.push(j),s.push({data:V,bands:A});case 17:v++,ut.next=4;break;case 20:return ut.abrupt("return",{rasterFiles:s,xhrList:o,errList:h});case 21:case"end":return ut.stop()}},n)})),rx.apply(this,arguments)}var Y3=function(){var n=(0,lt.Z)(it().mark(function l(a,s,o,h,v){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m={url:H3(a,s)},A.abrupt("return",new Promise(function(F,B){W3(o,m,function(V,j){V?B(V):j&&F(j)},h,v)}));case 2:case"end":return A.stop()}},l)}));return function(a,s,o,h,v){return n.apply(this,arguments)}}(),hw=function(){var n=(0,lt.Z)(it().mark(function l(a,s,o,h){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return m=Array.isArray(a)?a[0]:a,h.wmtsOptions?(E=(h==null?void 0:h.getURLFromTemplate)||X0,v=E(m,(0,q.Z)((0,q.Z)({},s),h.wmtsOptions))):(A=(h==null?void 0:h.getURLFromTemplate)||Bd,v=A(m,s)),B.abrupt("return",new Promise(function(V,j){var at,ut=vl({url:v,type:(h==null||(at=h.requestParameters)===null||at===void 0?void 0:at.type)||"arrayBuffer"},function(xt,Nt){xt?j(xt):Nt&&V(Nt)},h.transformResponse);o.xhrCancel=function(){return ut.abort()}}));case 3:case"end":return B.stop()}},l)}));return function(a,s,o,h){return n.apply(this,arguments)}}(),pw=function(){return{rasterData:new Uint8Array([0]),width:1,height:1}},dw={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},$3=[Sp.ARRAYBUFFER,Sp.RGB];function q3(n){return!!(Array.isArray(n)&&n.length===0||!Array.isArray(n)&&typeof n!="string")}function vw(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(q3(n))throw new Error("tile server url is error");var a=(l==null?void 0:l.dataType)||Sp.IMAGE;a===Sp.RGB&&(a=Sp.ARRAYBUFFER);var s=function(v,m){switch(a){case Sp.IMAGE:return hw(n,v,m,l);case Sp.ARRAYBUFFER:return Y3(n,v,m,(l==null?void 0:l.format)||pw,l==null?void 0:l.operation);case Sp.CUSTOMARRAYBUFFER:case Sp.CUSTOMRGB:return G3(m,l==null?void 0:l.getCustomData,(l==null?void 0:l.format)||pw,l==null?void 0:l.operation);default:return hw(n,v,m,l)}},o=(0,q.Z)((0,q.Z)((0,q.Z)({},dw),l),{},{getTileData:s});return{data:n,dataArray:[],tilesetOptions:o,isTile:!0}}var K3={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},Q3=function(){var n=(0,lt.Z)(it().mark(function l(a){return it().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",new Promise(function(h){var v=(0,ht.Z)(a.bounds,4),m=v[0],E=v[1],A=v[2],F=v[3],B={layers:{testTile:{features:[{type:"Feature",properties:{key:a.x+"/"+a.y+"/"+a.z,textLng:(m+A)/2,textLat:(E+F)/2},geometry:{type:"LineString",coordinates:[[A,F],[A,E],[m,E],[m,E]]}}]}}};h(B)}));case 1:case"end":return o.stop()}},l)}));return function(a){return n.apply(this,arguments)}}();function J3(n,l){var a=function(h){return Q3(h)},s=(0,q.Z)((0,q.Z)((0,q.Z)({},K3),l),{},{getTileData:a});return{data:n,dataArray:[],tilesetOptions:s,isTile:!0}}function gw(n,l){var a=l.radius,s=a===void 0?40:a,o=l.maxZoom,h=o===void 0?18:o,v=l.minZoom,m=v===void 0?0:v,E=l.zoom,A=E===void 0?2:E;if(n.pointIndex){var F=n.pointIndex.getClusters(n.extent,Math.floor(A));return n.dataArray=t5(F),n}var B=new(AE())({radius:s,minZoom:m,maxZoom:h}),V={type:"FeatureCollection",features:[]};return V.features=n.dataArray.map(function(j){return{type:"Feature",geometry:{type:"Point",coordinates:j.coordinates},properties:(0,q.Z)({},j)}}),B.load(V.features),B}function t5(n){return n.map(function(l,a){return(0,q.Z)({coordinates:l.geometry.coordinates,_id:a+1},l.properties)})}function e5(n){if(n.length===0)throw new Error("max requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]>l&&(l=n[a]);return l}function r5(n){if(n.length===0)throw new Error("min requires at least one data point");for(var l=n[0],a=1;a<n.length;a++)n[a]<l&&(l=n[a]);return l}function mw(n){if(n.length===0)return 0;for(var l=n[0],a=0,s,o=1;o<n.length;o++)s=l+n[o]*1,Math.abs(l)>=Math.abs(n[o])?a+=l-s+n[o]:a+=n[o]-s+l,l=s;return l+a*1}function n5(n){if(n.length===0)throw new Error("mean requires at least one data point");return mw(n)/n.length}var i5={min:r5,max:e5,mean:n5,sum:mw};function a5(n){var l=Uv();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Uv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function yw(n,l){if(Array.isArray(l))return l}var Rf=function(n){(0,Zt.Z)(a,n);var l=a5(a);function a(s,o){var h;return(0,ct.Z)(this,a),h=l.call(this),(0,X.Z)((0,st.Z)(h),"type","source"),(0,X.Z)((0,st.Z)(h),"isTile",!1),(0,X.Z)((0,st.Z)(h),"inited",!1),(0,X.Z)((0,st.Z)(h),"hooks",{init:new Ep}),(0,X.Z)((0,st.Z)(h),"parser",{type:"geojson"}),(0,X.Z)((0,st.Z)(h),"transforms",[]),(0,X.Z)((0,st.Z)(h),"cluster",!1),(0,X.Z)((0,st.Z)(h),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,X.Z)((0,st.Z)(h),"invalidExtent",!1),(0,X.Z)((0,st.Z)(h),"dataArrayChanged",!1),(0,X.Z)((0,st.Z)(h),"cfg",{autoRender:!0}),h.originData=s,h.initCfg(o),h.init().then(function(){h.inited=!0,h.emit("update",{type:"inited"})}),h}return(0,et.Z)(a,[{key:"getSourceCfg",value:function(){return this.cfg}},{key:"getClusters",value:function(o){return this.clusterIndex.getClusters(this.caculClusterExtent(2),o)}},{key:"getClustersLeaves",value:function(o){return this.clusterIndex.getLeaves(o,1/0)}},{key:"getParserType",value:function(){return this.parser.type}},{key:"updateClusterData",value:function(o){var h=this,v=this.clusterOptions,m=v.method,E=m===void 0?"sum":m,A=v.field,F=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(o));this.clusterOptions.zoom=o,F.forEach(function(B){B.id||(B.properties.point_count=1)}),(A||(0,ee.isFunction)(E))&&(F=F.map(function(B){var V=B.id;if(V){var j=h.clusterIndex.getLeaves(V,1/0),at=j.map(function(Nt){return Nt.properties}),ut;if((0,ee.isString)(E)&&A){var xt=Ay(at,A);ut=i5[E](xt)}(0,ee.isFunction)(E)&&(ut=E(at)),B.properties.stat=ut}else B.properties.point_count=1;return B})),this.data=VE("geojson")({type:"FeatureCollection",features:F}),this.executeTrans()}},{key:"getFeatureById",value:function(o){var h=this.parser,v=h.type,m=v===void 0?"geojson":v,E=h.geometry;if(m==="geojson"&&!this.cluster){var A=o<this.originData.features.length?this.originData.features[o]:"null",F=(0,ee.cloneDeep)(A);if(F!=null&&F.properties&&(this.transforms.length!==0||this.dataArrayChanged)){var B=this.data.dataArray.find(function(V){return V._id===o});F.properties=B}return F}else return m==="json"&&E?this.data.dataArray.find(function(V){return V._id===o}):o<this.data.dataArray.length?this.data.dataArray[o]:"null"}},{key:"updateFeaturePropertiesById",value:function(o,h){this.data.dataArray=this.data.dataArray.map(function(v){return v._id===o?(0,q.Z)((0,q.Z)({},v),h):v}),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}},{key:"getFeatureId",value:function(o,h){var v=this.data.dataArray.find(function(m){return m[o]===h});return v==null?void 0:v._id}},{key:"setData",value:function(o,h){var v=this;this.originData=o,this.dataArrayChanged=!1,this.initCfg(h),this.init().then(function(){v.emit("update",{type:"update"})})}},{key:"destroy",value:function(){var o;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(o=this.tileset)===null||o===void 0||o.destroy()}},{key:"processData",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v=this;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,new Promise(function(A,F){try{v.excuteParser(),v.initCluster(),v.executeTrans(),A({})}catch(B){F(B)}});case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},h)}));function o(){return s.apply(this,arguments)}return o}()},{key:"initCfg",value:function(o){this.cfg=(0,ee.mergeWith)(this.cfg,o,yw);var h=this.cfg;h&&(h.parser&&(this.parser=h.parser),h.transforms&&(this.transforms=h.transforms),this.cluster=h.cluster||!1,h.clusterOptions&&(this.cluster=!0,this.clusterOptions=(0,q.Z)((0,q.Z)({},this.clusterOptions),h.clusterOptions)))}},{key:"init",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.inited=!1,m.next=3,this.processData();case 3:this.inited=!0;case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"excuteParser",value:function(){var o=this.parser,h=o.type||"geojson",v=VE(h);this.data=v(this.originData,o),this.tileset=this.initTileset(),!o.cancelExtent&&(this.extent=jf(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}},{key:"setCenter",value:function(o){this.center=[(o[0]+o[2])/2,(o[1]+o[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}},{key:"initTileset",value:function(){var o=this.data.tilesetOptions;if(!!o){if(this.isTile=!0,this.tileset)return this.tileset.updateOptions(o),this.tileset;var h=new uf((0,q.Z)({},o));return h}}},{key:"executeTrans",value:function(){var o=this,h=this.transforms;h.forEach(function(v){var m=v.type,E=xy(m)(o.data,v);Object.assign(o.data,E)})}},{key:"initCluster",value:function(){if(!!this.cluster){var o=this.clusterOptions||{};this.clusterIndex=gw(this.data,o)}}},{key:"caculClusterExtent",value:function(o){var h=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(h=Nl(Su(this.extent),o)),h[0].concat(h[1])}}]),a}(Se.EventEmitter);function Cp(n,l){var a=l.callback;return a&&(n.dataArray=n.dataArray.filter(a)),n}function nx(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=_w(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function _w(n,l){if(!!n){if(typeof n=="string")return o5(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o5(n,l)}}function o5(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Ap=6378e3;function fs(n,l){var a=n.dataArray,s=l.size,o=s===void 0?10:s,h=o/(2*Math.PI*Ap)*(256<<20)/2,v=ix(a,o),m=v.gridHash,E=v.gridOffset,A=u5(m,E,l);return{yOffset:h,xOffset:h,radius:h,type:"grid",dataArray:A}}function ix(n,l){var a=1/0,s=-1/0,o,h=nx(n),v;try{for(h.s();!(v=h.n()).done;){var m=v.value;o=m.coordinates[1],Number.isFinite(o)&&(a=o<a?o:a,s=o>s?o:s)}}catch(fe){h.e(fe)}finally{h.f()}var E=(a+s)/2,A=xw(l,E);if(A.xOffset<=0||A.yOffset<=0)return{gridHash:{},gridOffset:A};var F={},B=nx(n),V;try{for(B.s();!(V=B.n()).done;){var j=V.value,at=j.coordinates[1],ut=j.coordinates[0];if(Number.isFinite(at)&&Number.isFinite(ut)){var xt=Math.floor((at+90)/A.yOffset),Nt=Math.floor((ut+180)/A.xOffset),de="".concat(xt,"-").concat(Nt);F[de]=F[de]||{count:0,points:[]},F[de].count+=1,F[de].points.push(j)}}}catch(fe){B.e(fe)}finally{B.f()}return{gridHash:F,gridOffset:A}}function xw(n,l){var a=pg(n),s=s5(l,n);return{yOffset:a,xOffset:s}}function pg(n){return n/Ap*(180/Math.PI)}function s5(n,l){return l/Ap*(180/Math.PI)/Math.cos(n*Math.PI/180)}function u5(n,l,a){return Object.keys(n).reduce(function(s,o,h){var v=o.split("-"),m=parseInt(v[0],10),E=parseInt(v[1],10),A={};if(a.field&&a.method){var F=_i(n[o].points,a.field);A[a.method]=xn[a.method](F)}return Object.assign(A,{_id:h,coordinates:Ko([-180+l.xOffset*(E+.5),-90+l.yOffset*(m+.5)]),rawData:n[o].points,count:n[o].count}),s.push(A),s},[])}var x0=Math.PI/3,l5=[0,x0,2*x0,3*x0,4*x0,5*x0];function c5(n){return n[0]}function bw(n){return n[1]}function Ew(){var n=0,l=0,a=1,s=1,o=c5,h=bw,v,m,E;function A(B){var V={},j=[],at,ut=B.length;for(at=0;at<ut;++at)if(!(isNaN(Nt=+o.call(null,xt=B[at],at,B))||isNaN(de=+h.call(null,xt,at,B)))){var xt,Nt,de,fe=Math.round(de=de/E),Ne=Math.round(Nt=Nt/m-(fe&1)/2),Ye=de-fe;if(Math.abs(Ye)*3>1){var _r=Nt-Ne,Ir=Ne+(Nt<Ne?-1:1)/2,Nr=fe+(de<fe?-1:1),Yr=Nt-Ir,yn=de-Nr;_r*_r+Ye*Ye>Yr*Yr+yn*yn&&(Ne=Ir+(fe&1?1:-1)/2,fe=Nr)}var fn=Ne+"-"+fe,$n=V[fn];$n?$n.push(xt):(j.push($n=V[fn]=[xt]),$n.x=(Ne+(fe&1)/2)*m,$n.y=fe*E)}return j}function F(B){var V=0,j=0;return l5.map(function(at){var ut=Math.sin(at)*B,xt=-Math.cos(at)*B,Nt=ut-V,de=xt-j;return V=ut,j=xt,[Nt,de]})}return A.hexagon=function(B){return"m"+F(B==null?v:+B).join("l")+"z"},A.centers=function(){for(var B=[],V=Math.round(l/E),j=Math.round(n/m),at=V*E;at<s+v;at+=E,++V)for(var ut=j*m+(V&1)*m/2;ut<a+m/2;ut+=m)B.push([ut,at]);return B},A.mesh=function(){var B=F(v).slice(0,4).join("l");return A.centers().map(function(V){return"M"+V+"m"+B}).join("")},A.x=function(B){return arguments.length?(o=B,A):o},A.y=function(B){return arguments.length?(h=B,A):h},A.radius=function(B){return arguments.length?(v=+B,m=v*2*Math.sin(x0),E=v*1.5,A):v},A.size=function(B){return arguments.length?(n=l=0,a=+B[0],s=+B[1],A):[a-n,s-l]},A.extent=function(B){return arguments.length?(n=+B[0][0],l=+B[0][1],a=+B[1][0],s=+B[1][1],A):[[n,l],[a,s]]},A.radius(1)}var hn=6378e3;function ax(n,l){var a=n.dataArray,s=l.size,o=s===void 0?10:s,h=l.method,v=h===void 0?"sum":h,m=o/(2*Math.PI*hn)*(256<<20)/2,E=a.map(function(V){var j=Ko(V.coordinates),at=(0,ht.Z)(j,2),ut=at[0],xt=at[1];return(0,q.Z)((0,q.Z)({},V),{},{coordinates:[ut,xt]})}),A=Ew().radius(m).x(function(V){return V.coordinates[0]}).y(function(V){return V.coordinates[1]}),F=A(E),B={dataArray:F.map(function(V,j){var at;if(l.field&&v){var ut=_i(V,l.field);V[v]=xn[v](ut)}return at={},(0,X.Z)(at,l.method,V[v]),(0,X.Z)(at,"count",V.length),(0,X.Z)(at,"rawData",V),(0,X.Z)(at,"coordinates",[V.x,V.y]),(0,X.Z)(at,"_id",j),at}),radius:m,xOffset:m,yOffset:m,type:"hexagon"};return B}function Ga(n,l){var a=l.sourceField,s=l.targetField,o=l.data,h={};return o.forEach(function(v){h[v[a]]=v}),n.dataArray=n.dataArray.map(function(v){var m=v[s];return(0,q.Z)((0,q.Z)({},v),h[m])}),n}function Ec(n,l){var a=l.callback;return a&&(n.dataArray=n.dataArray.map(a)),n}nd("rasterTile",vw),nd("mvt",id),nd("geojsonvt",aw),nd("testTile",J3),nd("geojson",KE),nd("image",Nv),nd("csv",im),nd("json",qE),nd("raster",Z3),nd("rasterRgb",cw),g0("cluster",gw),g0("filter",Cp),g0("join",Ga),g0("map",Ec),g0("grid",fs),g0("hexagon",ax);var Zv=Rf,Bh,ox=(Bh={},(0,X.Z)(Bh,wp.additive,{enable:!0,func:{srcRGB:Jt.ONE,dstRGB:Jt.ONE,srcAlpha:1,dstAlpha:1}}),(0,X.Z)(Bh,wp.none,{enable:!1}),(0,X.Z)(Bh,wp.normal,{enable:!0,func:{srcRGB:Jt.SRC_ALPHA,dstRGB:Jt.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,X.Z)(Bh,wp.subtractive,{enable:!0,func:{srcRGB:Jt.ONE,dstRGB:Jt.ONE,srcAlpha:Jt.ZERO,dstAlpha:Jt.ONE_MINUS_SRC_COLOR},equation:{rgb:Jt.FUNC_SUBTRACT,alpha:Jt.FUNC_SUBTRACT}}),(0,X.Z)(Bh,wp.max,{enable:!0,func:{srcRGB:Jt.ONE,dstRGB:Jt.ONE},equation:{rgb:Jt.MAX_EXT}}),(0,X.Z)(Bh,wp.min,{enable:!0,func:{srcRGB:Jt.ONE,dstRGB:Jt.ONE},equation:{rgb:Jt.MIN_EXT}}),Bh);function Os(n,l,a,s,o){l.updateStyleAttribute(n,a,s,o)}function sx(n,l){l.tileLayer||l.isTileLayer||(n.opacity&&Ty("opacity",l,n.opacity),n.strokeWidth&&Ty("strokeWidth",l,n.strokeWidth),n.strokeOpacity&&Ty("strokeOpacity",l,n.strokeOpacity),n.stroke&&b0("stroke",l,n.stroke),n.offsets&&f5("offsets",l,n.offsets),n.textOffset&&f5("textOffset",l,n.textOffset),n.thetaOffset&&Ty("thetaOffset",l,n.thetaOffset))}function Ty(n,l,a){(0,ee.isString)(a)?Os(n,l,a,function(s){return s}):(0,ee.isNumber)(a)||(Array.isArray(a)&&a.length===2?(0,ee.isString)(a[0])&&(0,ee.isFunction)(a[1])||(0,ee.isString)(a[0])&&Array.isArray(a[1])&&(0,ee.isNumber)(a[1][0])&&(0,ee.isNumber)(a[1][1])?Os(n,l,a[0],a[1]):Os(n,l,[1],void 0):Os(n,l,[1],void 0))}function f5(n,l,a){(0,ee.isString)(a)?Os(n,l,a,function(s){return s}):Array.isArray(a)&&a.length===2&&(0,ee.isString)(a[0])&&(0,ee.isFunction)(a[1])?Os(n,l,a[0],a[1]):Array.isArray(a)&&a.length===2&&(0,ee.isNumber)(a[0])&&(0,ee.isNumber)(a[1])?Os(n,l,a,void 0):Os(n,l,[0,0],void 0)}function b0(n,l,a){(0,ee.isString)(a)||(Array.isArray(a)&&a.length===2&&((0,ee.isString)(a[0])&&(0,ee.isFunction)(a[1])||(0,ee.isString)(a[0])&&Array.isArray(a[1])&&a[1].length>0)?Os(n,l,a[0],a[1]):Os(n,l,"#fff",void 0))}var yu;(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.DEFUALT="DEFUALTMAP",n.SIMPLE="SIMPLE",n.GLOBEL="GLOBEL"})(yu||(yu={}));function Vv(n,l){var a=[l[0]-n[0],l[1]-n[1]],s=Il(a),o=[n[0]+s[0]*1e-4,n[1]+s[1]*1e-4];return o}function My(n,l,a){if(n.length>0&&l.version===yu["GAODE2.x"]){var s=a.coordCenter;typeof n[0].coordinates[0]=="number"?n.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=yu["GAODE2.x"],o.originCoordinates=(0,ee.cloneDeep)(o.coordinates),o.coordinates=l.lngLatToCoordByLayer(o.coordinates,s)}):n.filter(function(o){return!o.originCoordinates}).map(function(o){o.version=yu["GAODE2.x"],o.originCoordinates=(0,ee.cloneDeep)(o.coordinates),o.coordinates=l.lngLatToCoordsByLayer(o.coordinates,s)})}}function ux(n,l){n.length>0&&l.version===yu.SIMPLE&&n.map(function(a){a.simpleCoordinate||(a.coordinates=h5(a.coordinates,l),a.simpleCoordinate=!0)})}function h5(n,l){if(typeof n[0]=="number")return l.simpleMapCoord.unproject(n);if(n[0]&&n[0][0]instanceof Array){var a=[];return n.map(function(o){var h=[];o.map(function(v){h.push(l.simpleMapCoord.unproject(v))}),a.push(h)}),a}else{var s=[];return n.map(function(o){s.push(l.simpleMapCoord.unproject(o))}),s}}function p5(n,l){var a;if(!n.scale)return[];var s=(n==null||(a=n.scale)===null||a===void 0?void 0:a.scalers)||[],o=[];s.forEach(function(v){var m,E=v.field;(l.hasOwnProperty(E)||((m=n.scale)===null||m===void 0?void 0:m.type)==="variable")&&o.push(l[E])});var h=n.mapping?n.mapping(o):[];return h}function d5(n,l,a,s,o){var h=o==null?void 0:o.getLayerConfig(),v=h.arrow,m=v===void 0?{enable:!1}:v,E=l.map(function(A){var F={id:A._id,coordinates:A.coordinates};if(n.filter(function(j){return j.scale!==void 0}).forEach(function(j){var at=p5(j,A);j.needRemapping=!1,j.name==="color"&&(at=at.map(function(ut){return Le(ut)})),F[j.name]=Array.isArray(at)&&at.length===1?at[0]:at,j.name==="shape"&&(F.shape=a.getIconFontKey(F[j.name]))}),F.shape==="line"&&m.enable){var B=F.coordinates,V=Vv(B[0],B[1]);F.coordinates.splice(1,0,V,V)}return F});return My(E,s,o),ux(E,s),E}function v5(n,l,a,s,o,h){var v=new Zv(o,h),m=s.getLayerStyleAttributes()||[],E=v.data.dataArray,A=E,F=d5(m,A,l,a,n);return v.destroy(),F}function lx(n){return n.map(function(l){return typeof l=="string"&&(l=[l,{}]),l})}function cx(n,l,a,s){var o=n.multiPassRenderer,h=n.getLayerConfig(),v=h.enableTAA;return v?o.add(s("taa")):o.add(s("render")),lx(l).forEach(function(m){var E=(0,ht.Z)(m,2),A=E[0],F=E[1];o.add(a(A),F)}),o.add(a("copy")),o}var ww=[["circle","cylinder"],["square","cylinder"],["triangle","cylinder"],["pentagon","cylinder"],["hexagon","cylinder"],["octogon","cylinder"],["hexagram","cylinder"],["rhombus","cylinder"],["vesica","cylinder"]];function Iy(n,l,a){if(typeof l=="string"&&typeof a=="string"&&l!==a){if(n.type==="PointLayer"){n.dataState.dataSourceNeedUpdate=!0;return}ww.map(function(s){if(s.includes(l)&&s.includes(a)){n.dataState.dataSourceNeedUpdate=!0;return}})}}var g5=function(){function n(l){(0,ct.Z)(this,n),this.layer=l}return(0,et.Z)(n,[{key:"pickRender",value:function(a){var s=this.layer;if(s.tileLayer)return s.tileLayer.pickRender(a);s.hooks.beforePickingEncode.call(),s.masks.length>0&&s.masks.filter(function(o){return o.inited}).forEach(function(){var o=(0,lt.Z)(it().mark(function h(v){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:v.render();case 1:case"end":return E.stop()}},h)}));return function(h){return o.apply(this,arguments)}}()),s.renderModels(!0),s.hooks.afterPickingEncode.call()}},{key:"pick",value:function(a,s){var o=this.layer.getContainer(),h=o.get(Dt.IPickingService);return a.type==="RasterLayer"?this.pickRasterLayer(a,s):(this.pickRender(s),h.pickFromPickingFBO(a,s))}},{key:"pickRasterLayer",value:function(a,s,o){var h=this.layer.getContainer(),v=h.get(Dt.IPickingService),m=h.get(Dt.IMapService),E=this.layer.getSource().extent,A=yl(s.lngLat,E),F={x:s.x,y:s.y,type:s.type,lngLat:s.lngLat,target:s,rasterValue:null},B=o||a;if(A){var V=this.readRasterValue(a,E,m,s.x,s.y);return F.rasterValue=V,v.triggerHoverOnLayer(B,F),!0}else return F.type=s.type==="mousemove"?"mouseout":"un"+s.type,v.triggerHoverOnLayer(B,(0,q.Z)((0,q.Z)({},F),{},{type:"unpick"})),v.triggerHoverOnLayer(B,F),!1}},{key:"readRasterValue",value:function(a,s,o,h,v){var m=a.getSource().data.dataArray[0],E=(0,ht.Z)(s,4),A=E[0],F=A===void 0?0:A,B=E[1],V=B===void 0?0:B,j=E[2],at=j===void 0?10:j,ut=E[3],xt=ut===void 0?-10:ut,Nt=o.lngLatToContainer([F,V]),de=o.lngLatToContainer([at,xt]),fe=de.x-Nt.x,Ne=Nt.y-de.y,Ye=[(h-Nt.x)/fe,(v-de.y)/Ne],_r=m.width||1,Ir=m.height||1,Nr=Math.floor(Ye[0]*_r),Yr=Math.floor(Ye[1]*Ir),yn=Math.max(0,Yr-1)*_r+Nr,fn=m.data[yn];return fn}},{key:"selectFeature",value:function(a){var s=this.layer,o=(0,ht.Z)(a,3),h=o[0],v=o[1],m=o[2];s.hooks.beforeSelect.call([h,v,m])}},{key:"highlightPickedFeature",value:function(a){var s=(0,ht.Z)(a,3),o=s[0],h=s[1],v=s[2];this.layer.hooks.beforeHighlight.call([o,h,v])}},{key:"getFeatureById",value:function(a){return this.layer.getSource().getFeatureById(a)}}]),n}(),Sw=function(){function n(l){(0,ct.Z)(this,n),this.layer=l;var a=this.layer.getContainer();this.rendererService=a.get(Dt.IRendererService)}return(0,et.Z)(n,[{key:"getColorTexture",value:function(a){var s=this.getTextureKey(a);return this.key===s?this.colorTexture:(this.createColorTexture(a),this.key=s,this.colorTexture)}},{key:"createColorTexture",value:function(a){var s=this.rendererService.createTexture2D,o=br(a),h=s({data:o.data,width:o.width,height:o.height,flipY:!1});return this.colorTexture=h,h}},{key:"setColorTexture",value:function(a,s){this.key=this.getTextureKey(s),this.colorTexture=a}},{key:"destroy",value:function(){var a;(a=this.colorTexture)===null||a===void 0||a.destroy()}},{key:"getTextureKey",value:function(a){return"".concat(a.colors.join("_"),"_").concat(a.positions.join("_"))}}]),n}(),yo=["passes"],um=["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber","workerEnabled","workerOptions"],fx,E0,lm;function hx(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=px(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function px(n,l){if(!!n){if(typeof n=="string")return dx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return dx(n,l)}}function dx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Cw(n){var l=vx();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function vx(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Aw=0,dg=(fx=ly(Dt.IGlobalConfigService),E0=function(n){(0,Zt.Z)(a,n);var l=Cw(a);function a(){var s,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return(0,ct.Z)(this,a),s=l.call(this),(0,X.Z)((0,st.Z)(s),"id","".concat(Aw++)),(0,X.Z)((0,st.Z)(s),"name","".concat(Aw)),(0,X.Z)((0,st.Z)(s),"visible",!0),(0,X.Z)((0,st.Z)(s),"zIndex",0),(0,X.Z)((0,st.Z)(s),"inited",!1),(0,X.Z)((0,st.Z)(s),"layerModelNeedUpdate",!1),(0,X.Z)((0,st.Z)(s),"pickedFeatureID",null),(0,X.Z)((0,st.Z)(s),"selectedFeatureID",null),(0,X.Z)((0,st.Z)(s),"styleNeedUpdate",!1),(0,X.Z)((0,st.Z)(s),"forceRender",!1),(0,X.Z)((0,st.Z)(s),"clusterZoom",0),(0,X.Z)((0,st.Z)(s),"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),(0,X.Z)((0,st.Z)(s),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,X.Z)((0,st.Z)(s),"hooks",{init:new Jm,afterInit:new c2,beforeRender:new c2,beforeRenderData:new f2,afterRender:new Ep,beforePickingEncode:new Ep,afterPickingEncode:new Ep,beforeHighlight:new Ep(["pickedColor"]),afterHighlight:new Ep,beforeSelect:new Ep(["pickedColor"]),afterSelect:new Ep,beforeDestroy:new Ep,afterDestroy:new Ep}),(0,X.Z)((0,st.Z)(s),"models",[]),(0,X.Z)((0,st.Z)(s),"startInit",!1),(0,X.Z)((0,st.Z)(s),"layerChildren",[]),(0,X.Z)((0,st.Z)(s),"masks",[]),Ar((0,st.Z)(s),"configService",lm,(0,st.Z)(s)),(0,X.Z)((0,st.Z)(s),"animateOptions",{enable:!1}),(0,X.Z)((0,st.Z)(s),"currentPickId",null),(0,X.Z)((0,st.Z)(s),"pendingStyleAttributes",[]),(0,X.Z)((0,st.Z)(s),"scaleOptions",{}),(0,X.Z)((0,st.Z)(s),"animateStatus",!1),(0,X.Z)((0,st.Z)(s),"isDestroyed",!1),(0,X.Z)((0,st.Z)(s),"encodeDataLength",0),(0,X.Z)((0,st.Z)(s),"sourceEvent",function(){s.dataState.dataSourceNeedUpdate=!0;var h=s.getLayerConfig();h&&h.autoFit&&s.fitBounds(h.fitBoundsOptions);var v=s.layerSource.getSourceCfg().autoRender;v&&s.reRender()}),s.name=o.name||s.id,s.zIndex=o.zIndex||0,s.rawConfig=o,s}return(0,et.Z)(a,[{key:"addMaskLayer",value:function(o){this.masks.push(o)}},{key:"removeMaskLayer",value:function(o){var h=this.masks.indexOf(o);h>-1&&this.masks.splice(h,1),o.destroy()}},{key:"getAttribute",value:function(o){return this.styleAttributeService.getLayerStyleAttribute(o)}},{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(o){var h=this;if(Object.keys(o).map(function(m){m in h.rawConfig&&(h.rawConfig[m]=o[m])}),!this.startInit)this.needUpdateConfig=(0,q.Z)((0,q.Z)({},this.needUpdateConfig),o);else{var v=this.container.get(Dt.SceneID);sx(o,this),this.configService.setLayerConfig(v,this.id,(0,q.Z)((0,q.Z)((0,q.Z)({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),o)),this.needUpdateConfig={}}}},{key:"setContainer",value:function(o,h){this.container=o,this.sceneContainer=h}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(o){return this.plugins.push(o),this}},{key:"init",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v=this,m,E,A,F,B,V,j;return it().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:m=this.container.get(Dt.SceneID),this.startInit=!0,this.configService.setLayerConfig(m,this.id,this.rawConfig),this.layerType=this.rawConfig.layerType,this.iconService=this.container.get(Dt.IIconService),this.fontService=this.container.get(Dt.IFontService),this.rendererService=this.container.get(Dt.IRendererService),this.layerService=this.container.get(Dt.ILayerService),this.interactionService=this.container.get(Dt.IInteractionService),this.pickingService=this.container.get(Dt.IPickingService),this.mapService=this.container.get(Dt.IMapService),E=this.getLayerConfig(),A=E.enableMultiPassRenderer,F=E.passes,A&&F!==null&&F!==void 0&&F.length&&F.length>0&&this.mapService.on("mapAfterFrameChange",function(){v.renderLayers()}),this.cameraService=this.container.get(Dt.ICameraService),this.coordinateService=this.container.get(Dt.ICoordinateSystemService),this.shaderModuleService=this.container.get(Dt.IShaderModuleService),this.postProcessingPassFactory=this.container.get(Dt.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Dt.IFactoryNormalPass),this.styleAttributeService=this.container.get(Dt.IStyleAttributeService),A&&(this.multiPassRenderer=this.container.get(Dt.IMultiPassRenderer),this.multiPassRenderer.setLayer(this)),this.pendingStyleAttributes.forEach(function(xt){var Nt=xt.attributeName,de=xt.attributeField,fe=xt.attributeValues,Ne=xt.updateOptions;v.styleAttributeService.updateStyleAttribute(Nt,{scale:(0,q.Z)({field:de},v.splitValuesAndCallbackInAttribute(fe,v.getLayerConfig()[Nt]))},Ne)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Dt.ILayerPlugin),B=hx(this.plugins);try{for(B.s();!(V=B.n()).done;)j=V.value,j.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(xt){B.e(xt)}finally{B.f()}return this.layerPickService=new g5(this),this.textureService=new Sw(this),ut.next=29,this.hooks.init.promise();case 29:this.inited=!0,this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this.hooks.afterInit.call();case 33:case"end":return ut.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"updateModelData",value:function(o){o.attributes&&o.elements?this.models.map(function(h){h.updateAttributesAndElements(o.attributes,o.elements)}):console.warn("data error")}},{key:"createModelData",value:function(o,h){var v;if((v=this.layerModel)!==null&&v!==void 0&&v.createModelData)return this.layerModel.createModelData(h);var m=this.calculateEncodeData(o,h),E=this.triangulation;return m&&E?this.styleAttributeService.createAttributesAndIndices(m,E):{attributes:void 0,elements:void 0}}},{key:"setLayerPickService",value:function(o){this.layerPickService=o}},{key:"calculateEncodeData",value:function(o,h){return this.inited?v5(this,this.fontService,this.mapService,this.styleAttributeService,o,h):(console.warn("layer not inited!"),null)}},{key:"prepareBuildModel",value:function(){this.updateLayerConfig((0,q.Z)((0,q.Z)((0,q.Z)({},this.getDefaultConfig()),this.rawConfig),this.needUpdateConfig));var o=this.getLayerConfig(),h=o.animateOption;h!=null&&h.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}},{key:"color",value:function(o,h,v){return this.updateStyleAttribute("color",o,h,v),this}},{key:"texture",value:function(o,h,v){return this.updateStyleAttribute("texture",o,h,v),this}},{key:"rotate",value:function(o,h,v){return this.updateStyleAttribute("rotate",o,h,v),this}},{key:"size",value:function(o,h,v){return this.updateStyleAttribute("size",o,h,v),this}},{key:"filter",value:function(o,h,v){return this.updateStyleAttribute("filter",o,h,v),this}},{key:"shape",value:function(o,h,v){var m,E,A,F=(m=this.styleAttributeService)===null||m===void 0||(E=m.getLayerStyleAttribute("shape"))===null||E===void 0||(A=E.scale)===null||A===void 0?void 0:A.field,B=o;return this.shapeOption={field:o,values:h},this.updateStyleAttribute("shape",o,h,v),this.tileLayer||Iy(this,F,B),this}},{key:"label",value:function(o,h,v){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:o,attributeValues:h,updateOptions:v}),this}},{key:"animate",value:function(o){var h={};return(0,ee.isObject)(o)?(h.enable=!0,h=(0,q.Z)((0,q.Z)({},h),o)):h.enable=o,this.updateLayerConfig({animateOption:h}),this}},{key:"source",value:function(o,h){return(o==null?void 0:o.type)==="source"?(this.setSource(o),this):(this.sourceOption={data:o,options:h},this.clusterZoom=0,this)}},{key:"setData",value:function(o,h){var v=this;return this.inited?this.layerSource.setData(o,h):this.on("inited",function(){var m=v.getSource();m?v.layerSource.setData(o,h):v.source(new Zv(o,h))}),this}},{key:"style",value:function(o){var h=this,v=o.passes,m=(0,Wl.Z)(o,yo);return v&&lx(v).forEach(function(E){var A=h.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(E[0]);A&&A.updateOptions(E[1])}),this.rawConfig=(0,q.Z)((0,q.Z)({},this.rawConfig),m),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(o,h){return(0,ee.isObject)(o)?this.scaleOptions=(0,q.Z)((0,q.Z)({},this.scaleOptions),o):this.scaleOptions[o]=h,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(),this))}},{key:"renderMultiPass",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.encodeDataLength<=0&&!this.forceRender)){m.next=2;break}return m.abrupt("return");case 2:if(!(this.multiPassRenderer&&this.multiPassRenderer.getRenderFlag())){m.next=7;break}return m.next=5,this.multiPassRenderer.render();case 5:m.next=8;break;case 7:this.multiPassRenderer?this.renderModels():this.renderModels();case 8:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"active",value:function(o){var h={};return h.enableHighlight=(0,ee.isObject)(o)?!0:o,(0,ee.isObject)(o)?(h.enableHighlight=!0,o.color&&(h.highlightColor=o.color),o.mix&&(h.activeMix=o.mix)):h.enableHighlight=!!o,this.updateLayerConfig(h),this}},{key:"setActive",value:function(o,h){var v=this;if((0,ee.isObject)(o)){var m=o.x,E=m===void 0?0:m,A=o.y,F=A===void 0?0:A;this.updateLayerConfig({highlightColor:(0,ee.isObject)(h)?h.color:this.getLayerConfig().highlightColor,activeMix:(0,ee.isObject)(h)?h.mix:this.getLayerConfig().activeMix}),this.pick({x:E,y:F})}else this.updateLayerConfig({pickedFeatureID:o,highlightColor:(0,ee.isObject)(h)?h.color:this.getLayerConfig().highlightColor,activeMix:(0,ee.isObject)(h)?h.mix:this.getLayerConfig().activeMix}),this.hooks.beforeSelect.call(ar(o)).then(function(){setTimeout(function(){v.reRender()},1)})}},{key:"select",value:function(o){var h={};return h.enableSelect=(0,ee.isObject)(o)?!0:o,(0,ee.isObject)(o)?(h.enableSelect=!0,o.color&&(h.selectColor=o.color),o.mix&&(h.selectMix=o.mix)):h.enableSelect=!!o,this.updateLayerConfig(h),this}},{key:"setSelect",value:function(o,h){var v=this;if((0,ee.isObject)(o)){var m=o.x,E=m===void 0?0:m,A=o.y,F=A===void 0?0:A;this.updateLayerConfig({selectColor:(0,ee.isObject)(h)?h.color:this.getLayerConfig().selectColor,selectMix:(0,ee.isObject)(h)?h.mix:this.getLayerConfig().selectMix}),this.pick({x:E,y:F})}else this.updateLayerConfig({pickedFeatureID:o,selectColor:(0,ee.isObject)(h)?h.color:this.getLayerConfig().selectColor,selectMix:(0,ee.isObject)(h)?h.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(ar(o)).then(function(){setTimeout(function(){v.reRender()},1)})}},{key:"setBlend",value:function(o){return this.updateLayerConfig({blend:o}),this.layerModelNeedUpdate=!0,this.reRender(),this}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}},{key:"setIndex",value:function(o){return this.zIndex=o,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}},{key:"setCurrentPickId",value:function(o){this.currentPickId=o}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(o){this.selectedFeatureID=o}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var o=this.mapService.getZoom(),h=this.getLayerConfig(),v=h.visible,m=h.minZoom,E=m===void 0?-1/0:m,A=h.maxZoom,F=A===void 0?1/0:A;return!!v&&o>=E&&o<F}},{key:"setMultiPass",value:function(o,h){if(this.updateLayerConfig({enableMultiPassRenderer:o}),h&&this.updateLayerConfig({passes:h}),o){var v=this.getLayerConfig(),m=v.passes,E=m===void 0?[]:m;this.multiPassRenderer=cx(this,E,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);var A=this.rendererService.getViewportSize(),F=A.width,B=A.height;this.multiPassRenderer.resize(F,B)}return this}},{key:"setMinZoom",value:function(o){return this.updateLayerConfig({minZoom:o}),this}},{key:"getMinZoom",value:function(){var o=this.getLayerConfig(),h=o.minZoom;return h}},{key:"getMaxZoom",value:function(){var o=this.getLayerConfig(),h=o.maxZoom;return h}},{key:"get",value:function(o){var h=this.getLayerConfig();return h[o]}},{key:"setMaxZoom",value:function(o){return this.updateLayerConfig({maxZoom:o}),this}},{key:"setAutoFit",value:function(o){return this.updateLayerConfig({autoFit:o}),this}},{key:"fitBounds",value:function(o){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var h=this.getSource(),v=h.extent,m=v.some(function(E){return Math.abs(E)===1/0});return m?this:(this.mapService.fitBounds([[v[0],v[1]],[v[2],v[3]]],o),this)}},{key:"destroy",value:function(){var o,h,v,m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isDestroyed||(this.layerChildren.map(function(E){return E.destroy(!1)}),this.layerChildren=[],this.masks.map(function(E){return E.destroy(!1)}),this.masks=[],this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(o=this.multiPassRenderer)===null||o===void 0||o.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(h=this.layerModel)===null||h===void 0||h.clearModels(m),(v=this.tileLayer)===null||v===void 0||v.destroy(),this.models=[],this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0)}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){var o;this.models.forEach(function(h){return h.destroy()}),(o=this.layerModel)===null||o===void 0||o.clearModels(),this.models=[]}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(o){return o.needRescale||o.needRemapping||o.needRegenerateVertices}).length}},{key:"setSource",value:function(o){var h=this;if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=o,this.clusterZoom=0,this.inited&&this.layerSource.cluster){var v=this.mapService.getZoom();this.layerSource.updateClusterData(v)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",function(m){var E=m.type;if(h.coordCenter===void 0){var A,F=h.layerSource.center;h.coordCenter=F,(A=h.mapService)!==null&&A!==void 0&&A.setCoordCenter&&h.mapService.setCoordCenter(F)}E==="update"&&h.sourceEvent()})}},{key:"initSource",value:function(o){this.layerSource=o,this.clusterZoom=0,this.addSourceEvent()}},{key:"getSource",value:function(){return this.layerSource}},{key:"addSourceEvent",value:function(){var o=this;this.layerSource.on("update",function(){if(o.coordCenter===void 0){var h,v=o.layerSource.center;o.coordCenter=v,(h=o.mapService)!==null&&h!==void 0&&h.setCoordCenter&&o.mapService.setCoordCenter(v)}o.sourceEvent()})}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(o){this.encodedData=o,this.encodeDataLength=o.length}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getScale",value:function(o){return this.styleAttributeService.getLayerAttributeScale(o)}},{key:"getLegend",value:function(o){var h,v,m,E=this.styleAttributeService.getLayerStyleAttribute(o),A=(E==null||(h=E.scale)===null||h===void 0?void 0:h.scalers)||[];return{type:(v=A[0].option)===null||v===void 0?void 0:v.type,field:E==null||(m=E.scale)===null||m===void 0?void 0:m.field,items:this.getLegendItems(o)}}},{key:"getLegendItems",value:function(o){var h=this.styleAttributeService.getLayerAttributeScale(o);if(!h)return[];if(h.invertExtent){var v=h.range().map(function(A){return(0,X.Z)({value:h.invertExtent(A)},o,A)});return v}else if(h.ticks){var m=h.ticks().map(function(A){return(0,X.Z)({value:A},o,h(A))});return m}else if(h!=null&&h.domain){var E=h.domain().filter(function(A){return!(0,ee.isUndefined)(A)}).map(function(A){return(0,X.Z)({value:A},o,h(A))});return E}return[]}},{key:"pick",value:function(o){var h=o.x,v=o.y;this.interactionService.triggerHover({x:h,y:v})}},{key:"boxSelect",value:function(o,h){this.pickingService.boxPickLayer(this,o,h)}},{key:"buildLayerModel",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m=this,E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne,Ye;return it().wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:return E=v.moduleName,A=v.vertexShader,F=v.fragmentShader,B=v.triangulation,V=v.segmentNumber,j=v.workerEnabled,at=j===void 0?!1:j,ut=v.workerOptions,xt=(0,Wl.Z)(v,um),this.shaderModuleService.registerModule(E,{vs:A,fs:F}),Nt=this.shaderModuleService.getModule(E),de=Nt.vs,fe=Nt.fs,Ne=Nt.uniforms,Ye=this.rendererService.createModel,Ir.abrupt("return",new Promise(function(Nr,Yr){if(ut&&ut.modelType in Kf&&at)m.styleAttributeService.createAttributesAndIndicesAscy(m.encodedData,V,ut).then(function(zo){var Vs=zo.attributes,hu=zo.elements,Gu=Ye((0,q.Z)({attributes:Vs,uniforms:Ne,fs:fe,vs:de,elements:hu,blend:ox[wp.normal]},xt));Nr(Gu)}).catch(function(zo){return Yr(zo)});else{var yn=m.styleAttributeService.createAttributesAndIndices(m.encodedData,B,V),fn=yn.attributes,$n=yn.elements,di=yn.count,Yi=(0,q.Z)({attributes:fn,uniforms:Ne,fs:fe,vs:de,elements:$n,blend:ox[wp.normal]},xt);di&&(Yi.count=di);var ho=Ye(Yi);Nr(ho)}}));case 5:case"end":return Ir.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"createAttributes",value:function(o){var h=o.triangulation,v=this.styleAttributeService.createAttributes(this.encodedData,h),m=v.attributes;return m}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(o){var h=this.getLayerConfig(),v=h.enableHighlight,m=v===void 0?!0:v,E=h.enableSelect,A=E===void 0?!0:E,F=this.eventNames().indexOf(o)!==-1||this.eventNames().indexOf("un"+o)!==-1;return(o==="click"||o==="dblclick")&&A&&(F=!0),o==="mousemove"&&(m||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(F=!0),this.isVisible()&&F}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return m.stop()}},h)}));function o(){return s.apply(this,arguments)}return o}()},{key:"rebuildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"renderMulPass",value:function(){var s=(0,lt.Z)(it().mark(function h(v){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,v.render();case 2:case"end":return E.stop()}},h)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"renderModels",value:function(o){var h=this;return this.encodeDataLength<=0&&!this.forceRender?this:(this.hooks.beforeRender.call(),this.models.forEach(function(v){v.draw({uniforms:h.layerModel.getUninforms()},o)}),this.hooks.afterRender.call(),this)}},{key:"updateStyleAttribute",value:function(o,h,v,m){["color","size","texture","rotate","filter","label","shape"].indexOf(o)!==-1&&this.configService.setAttributeConfig(this.id,(0,X.Z)({},o,{field:h,values:v})),this.startInit?this.styleAttributeService.updateStyleAttribute(o,{scale:(0,q.Z)({field:h},this.splitValuesAndCallbackInAttribute(v,this.getLayerConfig()[h]))},m):this.pendingStyleAttributes.push({attributeName:o,attributeField:h,attributeValues:v,updateOptions:m})}},{key:"getLayerAttributeConfig",value:function(){return this.configService.getAttributeConfig(this.id)}},{key:"getShaderPickStat",value:function(){return this.layerService.getShaderPickStat()}},{key:"setEarthTime",value:function(o){console.warn("empty fn")}},{key:"processData",value:function(o){return o}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"initLayerModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.models.forEach(function(E){return E.destroy()}),this.models=[],m.next=4,this.layerModel.initModels();case 4:this.models=m.sent;case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"reRender",value:function(){this.inited&&this.layerService.reRender()}},{key:"splitValuesAndCallbackInAttribute",value:function(o,h){return{values:(0,ee.isFunction)(o)?void 0:o||h,callback:(0,ee.isFunction)(o)?o:void 0}}}]),a}(Se.EventEmitter),lm=Dr(E0.prototype,"configService",[fx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E0),Tw,gx,Mw;function m5(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=y5(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function y5(n,l){if(!!n){if(typeof n=="string")return Iw(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Iw(n,l)}}function Iw(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var Ss=(Tw=ly(Dt.IGlobalConfigService),gx=function(){function n(l){(0,ct.Z)(this,n),Ar(this,"configService",Mw,this),this.layer=l,this.rendererService=l.getContainer().get(Dt.IRendererService),this.pickingService=l.getContainer().get(Dt.IPickingService),this.shaderModuleService=l.getContainer().get(Dt.IShaderModuleService),this.styleAttributeService=l.getContainer().get(Dt.IStyleAttributeService),this.mapService=l.getContainer().get(Dt.IMapService),this.iconService=l.getContainer().get(Dt.IIconService),this.fontService=l.getContainer().get(Dt.IFontService),this.cameraService=l.getContainer().get(Dt.ICameraService),this.layerService=l.getContainer().get(Dt.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate();var a=this.rendererService.createTexture2D;this.createTexture2D=a,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={thetaOffset:void 0,opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new Uint8Array(4),mag:Jt.NEAREST,min:Jt.NEAREST,width:1,height:1}))}return(0,et.Z)(n,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertiesExist={hasThetaOffset:0,hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertiesExist.hasOpacity,this.stylePropertiesExist.hasStrokeOpacity,this.stylePropertiesExist.hasStrokeWidth,this.stylePropertiesExist.hasStroke,this.stylePropertiesExist.hasOffsets,this.stylePropertiesExist.hasThetaOffset,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(a){var s=!1;return(0,ee.isEqual)(a.thetaOffset,this.cacheStyleProperties.thetaOffset)||(s=!0,this.cacheStyleProperties.thetaOffset=a.thetaOffset),(0,ee.isEqual)(a.opacity,this.cacheStyleProperties.opacity)||(s=!0,this.cacheStyleProperties.opacity=a.opacity),(0,ee.isEqual)(a.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(s=!0,this.cacheStyleProperties.strokeOpacity=a.strokeOpacity),(0,ee.isEqual)(a.strokeWidth,this.cacheStyleProperties.strokeWidth)||(s=!0,this.cacheStyleProperties.strokeWidth=a.strokeWidth),(0,ee.isEqual)(a.stroke,this.cacheStyleProperties.stroke)||(s=!0,this.cacheStyleProperties.stroke=a.stroke),(0,ee.isEqual)(a.offsets,this.cacheStyleProperties.offsets)||(s=!0,this.cacheStyleProperties.offsets=a.offsets),this.dataTexture===void 0&&(s=!0),s}},{key:"judgeStyleAttributes",value:function(a){this.clearLastCalRes(),a.opacity!==void 0&&!(0,ee.isNumber)(a.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertiesExist.hasOpacity=1,this.cellLength+=1),a.strokeOpacity!==void 0&&!(0,ee.isNumber)(a.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertiesExist.hasStrokeOpacity=1,this.cellLength+=1),a.strokeWidth!==void 0&&!(0,ee.isNumber)(a.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertiesExist.hasStrokeWidth=1,this.cellLength+=1),a.stroke!==void 0&&!this.isStaticColor(a.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertiesExist.hasStroke=1,this.cellLength+=4),a.offsets!==void 0&&!this.isOffsetStatic(a.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertiesExist.hasOffsets=1,this.cellLength+=2),a.thetaOffset!==void 0&&!(0,ee.isNumber)(a.thetaOffset)&&(this.cellProperties.push({attr:"thetaOffset",count:1}),this.stylePropertiesExist.hasThetaOffset=1,this.cellLength+=1)}},{key:"isStaticColor",value:function(a){return(0,ee.isString)(a)?!!pc(a):!1}},{key:"getStrokeColor",value:function(a){if(this.isStaticColor(a)){var s=Le(a);return s[0]=s[0]?s[0]:0,s[1]=s[1]?s[1]:0,s[2]=s[2]?s[2]:0,s[3]=s[3]?s[3]:0,s}else return[0,0,0,0]}},{key:"isOffsetStatic",value:function(a){return!!(Array.isArray(a)&&a.length===2&&(0,ee.isNumber)(a[0])&&(0,ee.isNumber)(a[1]))}},{key:"patchMod",value:function(a,s){for(var o=0;o<s;o++)a.push(-1)}},{key:"patchData",value:function(a,s,o){var h=m5(o),v;try{for(h.s();!(v=h.n()).done;){var m=v.value,E=m.attr,A=m.count,F=s[E];F!==void 0?E==="stroke"?a.push.apply(a,(0,me.Z)(Le(F))):E==="offsets"?this.isOffsetStatic(F)?a.push(-F[0],F[1]):a.push(0,0):a.push((0,ee.isNumber)(F)?F:1):this.patchMod(a,A)}}catch(B){h.e(B)}finally{h.f()}}},{key:"calDataFrame",value:function(a,s,o){for(var h=s.length,v=Math.ceil(h*a/this.DATA_TEXTURE_WIDTH),m=v*this.DATA_TEXTURE_WIDTH,E=[],A=0;A<h;A++){var F=s[A];this.patchData(E,F,o)}for(var B=E.length;B<m;B++)E.push(-1);return{data:E,width:this.DATA_TEXTURE_WIDTH,height:v}}},{key:"getBlend",value:function(){var a=this.layer.getLayerConfig(),s=a.blend,o=s===void 0?"normal":s;return ox[wp[o]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){var l=(0,lt.Z)(it().mark(function s(){return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",!1);case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"buildModels",value:function(){var l=(0,lt.Z)(it().mark(function s(){return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"initModels",value:function(){var l=(0,lt.Z)(it().mark(function s(){return it().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:throw new Error("Method not implemented.");case 1:case"end":return h.stop()}},s)}));function a(){return l.apply(this,arguments)}return a}()},{key:"clearModels",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(a){return[a.enable?0:1,a.duration||4,a.interval||.2,a.trailLength||.1]}},{key:"startModelAnimate",value:function(){var a=this.layer.getLayerConfig(),s=a.animateOption;s.enable&&this.layer.setAnimateStartTime()}}]),n}(),Mw=Dr(gx.prototype,"configService",[Tw],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gx),mx=100,Nh=36,vg=40;function hl(n){return n/180*Math.acos(-1)}function Xs(n){var l=hl(n[0])+Math.PI/2,a=hl(n[1]),s=mx+Math.random()*.4,o=s*Math.cos(a)*Math.cos(l),h=s*Math.cos(a)*Math.sin(l),v=s*Math.sin(a);return[h,v,o]}function ms(n,l){var a=mat4.create(),s=mat4.create(),o=vec3.fromValues(0,1,0),h=vec3.fromValues(0,0,0);l=l||{},n=typeof n!="undefined"?n:1;for(var v=typeof l.segments!="undefined"?l.segments:32,m=2+v,E=2*m,A=[],F=[],B=[],V=[],j=[],at=[],ut=0;ut<=m;ut++){for(var xt=ut/m,Nt=xt*Math.PI,de=0;de<=E;de++){var fe=de/E,Ne=fe*Math.PI*2;mat4.identity(s),mat4.rotateZ(s,s,-Nt),mat4.identity(a),mat4.rotateY(a,a,Ne),vec3.transformMat4(h,o,s),vec3.transformMat4(h,h,a),vec3.scale(h,h,-n),B.push(h.slice()),V.push.apply(V,_toConsumableArray(h.slice())),vec3.normalize(h,h),j.push.apply(j,_toConsumableArray(h.slice())),at.push([fe,1-xt]),V.push(fe,1-xt)}if(ut>0)for(var Ye=B.length,_r=Ye-2*(E+1);_r+E+2<Ye;_r++)A.push([_r,_r+1,_r+E+1]),F.push(_r,_r+1,_r+E+1),A.push([_r+E+1,_r+1,_r+E+2]),F.push(_r+E+1,_r+1,_r+E+2)}return{cells:A,positions:B,uvs:at,positionsArr:V,indicesArr:F,normalArr:j}}var Bo=ei.Ue(),w0=ei.Ue(),Vu=ei.Ue(),ad=ei.Ue(),Zs=ei.Ue();function Ys(n,l,a,s,o){ei.IH(n,a,s),ei.Fv(n,n),l=ei.al(-n[1],n[0]);var h=ei.al(-a[1],a[0]);return[o/ei.AK(l,h),l]}function Df(n,l){return ei.t8(n,-l[1],l[0])}function S0(n,l,a){return ei.lu(n,l,a),ei.Fv(n,n),n}function ky(n,l){return n[0]===l[0]&&n[1]===l[1]}function FR(n){for(var l=new Map,a=0;a<n.length;a++){var s=n[0].toString()+"-"+n[1].toString();l.get(s)?(n.splice(a,1),a++):l.set(s,s)}return n}var Ly=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(0,ct.Z)(this,n),(0,X.Z)(this,"lastFlip",-1),(0,X.Z)(this,"miter",ei.al(0,0)),(0,X.Z)(this,"started",!1),(0,X.Z)(this,"dash",!1),(0,X.Z)(this,"totalDistance",0),(0,X.Z)(this,"currentIndex",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}return(0,et.Z)(n,[{key:"simpleExtrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.simpleSegment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleExtrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var at=s[m],ut=m<a.length-1?[].concat((0,me.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,xt=m<s.length-1?s[m+1]:null,Nt=this.simpleSegment(o,v,B,j,ut,V,at,xt);v+=Nt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"extrude_gaode2",value:function(a,s){var o=this.complex;if(a.length<=1)return o;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=a.length,v=o.startIndex,m=1;m<h;m++){var E,A,F,B=a[m-1];B.push((E=s[m-1][2])!==null&&E!==void 0?E:0);var V=s[m-1],j=a[m];j.push((A=s[m][2])!==null&&A!==void 0?A:0);var at=s[m],ut=m<a.length-1?[].concat((0,me.Z)(a[m+1]),[(F=s[m+1][2])!==null&&F!==void 0?F:0]):null,xt=m<s.length-1?s[m+1]:null,Nt=this.segment_gaode2(o,v,B,j,ut,V,at,xt);v+=Nt}if(this.dash)for(var de=0;de<o.positions.length/6;de++)o.positions[de*6+5]=this.totalDistance;return o.startIndex=o.positions.length/6,o}},{key:"extrude",value:function(a){var s=this.complex;if(a.length<=1)return s;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var o=a.length,h=s.startIndex,v=1;v<o;v++){var m=a[v-1],E=a[v],A=v<a.length-1?a[v+1]:null,F=this.segment(s,h,m,E,A);h+=F}if(this.dash)for(var B=0;B<s.positions.length/6;B++)s.positions[B*6+5]=this.totalDistance;return s.startIndex=s.positions.length/6,s}},{key:"simpleSegment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=Ko([h[0],h[1]]),V=Ko([o[0],o[1]]);S0(Vu,B,V);var j=0;if(this.dash&&(j=this.lineSegmentDistance(B,V),this.totalDistance+=j),this.normal||(this.normal=ei.Ue(),Df(this.normal,Vu)),this.started||(this.started=!0,this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-j)),E.push(s+0,s+1,s+2),!v)Df(this.normal,Vu),this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance),E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2;else{var at=Ko([v[0],v[1]]);ky(B,at)&&ei.IH(at,B,ei.Fv(at,ei.$X(at,B,V))),S0(ad,at,B);var ut=Ys(Zs,ei.Ue(),Vu,ad,this.thickness),xt=(0,ht.Z)(ut,2),Nt=xt[0],de=xt[1],fe=ei.AK(Zs,this.normal)<0?-1:1;this.extrusions(A,F,h,de,Nt,this.totalDistance),E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fe=-1,ei.JG(this.normal,de),m+=2,this.lastFlip=fe}return m}},{key:"segment_gaode2",value:function(a,s,o,h,v,m,E,A){var F=0,B=a.indices,V=a.positions,j=a.normals,at=this.cap==="square",ut=this.join==="bevel",xt=Ko([E[0],E[1]]),Nt=Ko([m[0],m[1]]);S0(Vu,h,o);var de=0;if(this.dash&&(de=this.lineSegmentDistance(xt,Nt),this.totalDistance+=de),this.normal||(this.normal=ei.Ue(),Df(this.normal,Vu)),!this.started)if(this.started=!0,at){var fe=ei.Ue(),Ne=ei.Ue();ei.IH(fe,this.normal,Vu),ei.IH(Ne,this.normal,Vu),j.push(Ne[0],Ne[1],0),j.push(fe[0],fe[1],0),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),V.push(o[0],o[1],o[2]|0,this.totalDistance-de,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,o,this.normal,this.thickness,this.totalDistance-de);if(B.push(s+0,s+1,s+2),v){ky(h,v)&&ei.IH(v,h,ei.Fv(v,ei.$X(v,h,o))),S0(ad,v,h);var Ir=Ys(Zs,ei.Ue(),Vu,ad,this.thickness),Nr=(0,ht.Z)(Ir,2),Yr=Nr[0],yn=Nr[1],fn=ei.AK(Zs,this.normal)<0?-1:1,$n=ut;if(!$n&&this.join==="miter"){var di=Yr;di>this.miterLimit&&($n=!0)}$n?(j.push(this.normal[0],this.normal[1],0),j.push(yn[0],yn[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,B.push.apply(B,(0,me.Z)(this.lastFlip!==-fn?[s,s+2,s+3]:[s+2,s+1,s+3])),B.push(s+2,s+3,s+4),Df(Bo,ad),ei.JG(this.normal,Bo),j.push(this.normal[0],this.normal[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*fn,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,F+=3):(this.extrusions(V,j,h,yn,Yr,this.totalDistance),B.push.apply(B,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),fn=-1,ei.JG(this.normal,yn),F+=2),this.lastFlip=fn}else{if(Df(this.normal,Vu),at){var Ye=ei.Ue(),_r=ei.Ue();ei.lu(_r,Vu,this.normal),ei.IH(Ye,Vu,this.normal),j.push(_r[0],_r[1],0),j.push(Ye[0],Ye[1],0),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),V.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(V,j,h,this.normal,this.thickness,this.totalDistance);B.push.apply(B,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),F+=2}return F}},{key:"segment",value:function(a,s,o,h,v){var m=0,E=a.indices,A=a.positions,F=a.normals,B=this.cap==="square",V=this.join==="bevel",j=Ko([h[0],h[1]]),at=Ko([o[0],o[1]]);S0(Vu,j,at);var ut=0;if(this.dash&&(ut=this.lineSegmentDistance(j,at),this.totalDistance+=ut),this.normal||(this.normal=ei.Ue(),Df(this.normal,Vu)),!this.started)if(this.started=!0,B){var xt=ei.Ue(),Nt=ei.Ue();ei.IH(xt,this.normal,Vu),ei.IH(Nt,this.normal,Vu),F.push(Nt[0],Nt[1],0),F.push(xt[0],xt[1],0),A.push(o[0],o[1],o[2]|0,this.totalDistance-ut,-this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),A.push(o[0],o[1],o[2]|0,this.totalDistance-ut,this.thickness,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,o,this.normal,this.thickness,this.totalDistance-ut);if(E.push(s+0,s+1,s+2),v){var Ne=Ko([v[0],v[1]]);ky(j,Ne)&&ei.IH(Ne,j,ei.Fv(Ne,ei.$X(Ne,j,at))),S0(ad,Ne,j);var Ye=Ys(Zs,ei.Ue(),Vu,ad,this.thickness),_r=(0,ht.Z)(Ye,2),Ir=_r[0],Nr=_r[1],Yr=ei.AK(Zs,this.normal)<0?-1:1,yn=V;if(!yn&&this.join==="miter"){var fn=Ir;fn>this.miterLimit&&(yn=!0)}yn?(F.push(this.normal[0],this.normal[1],0),F.push(Nr[0],Nr[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,E.push.apply(E,(0,me.Z)(this.lastFlip!==-Yr?[s,s+2,s+3]:[s+2,s+1,s+3])),E.push(s+2,s+3,s+4),Df(Bo,ad),ei.JG(this.normal,Bo),F.push(this.normal[0],this.normal[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,-this.thickness*Yr,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,m+=3):(this.extrusions(A,F,h,Nr,Ir,this.totalDistance),E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),Yr=-1,ei.JG(this.normal,Nr),m+=2),this.lastFlip=Yr}else{if(Df(this.normal,Vu),B){var de=ei.Ue(),fe=ei.Ue();ei.lu(fe,Vu,this.normal),ei.IH(de,Vu,this.normal),F.push(fe[0],fe[1],0),F.push(de[0],de[1],0),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),A.push(h[0],h[1],h[2]|0,this.totalDistance,this.thickness,h[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(A,F,h,this.normal,this.thickness,this.totalDistance);E.push.apply(E,(0,me.Z)(this.lastFlip===1?[s,s+2,s+3]:[s+2,s+1,s+3])),m+=2}return m}},{key:"extrusions",value:function(a,s,o,h,v,m){s.push(h[0],h[1],0),s.push(h[0],h[1],0),a.push(o[0],o[1],o[2]|0,m,-v,o[2]|0),this.complex.indexes.push(this.currentIndex),a.push(o[0],o[1],o[2]|0,m,v,o[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}},{key:"lineSegmentDistance",value:function(a,s){var o=s[0]-a[0],h=s[1]-a[1];return Math.sqrt(o*o+h*h)}}]),n}(),So=ot(77160);function yx(n){var l=n[0][0],a=n[0][n[0].length-1];l[0]===a[0]&&l[1]===a[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var s=n[0].length,o=earcut.flatten(n),h=o.vertices,v=o.dimensions,m=[],E=[],A=0;A<h.length/v;A++)v===2?m.push(h[A*2],h[A*2+1],1):m.push(h[A*3],h[A*3+1],1);var F=earcut(o.vertices,o.holes,o.dimensions);E.push.apply(E,_toConsumableArray(F));for(var B=function(at){var ut=o.vertices.slice(at*v,(at+1)*v),xt=o.vertices.slice((at+1)*v,(at+2)*v);xt.length===0&&(xt=o.vertices.slice(0,v));var Nt=m.length/3;m.push(ut[0],ut[1],1,xt[0],xt[1],1,ut[0],ut[1],0,xt[0],xt[1],0),E.push.apply(E,_toConsumableArray([0,2,1,2,3,1].map(function(de){return de+Nt})))},V=0;V<s;V++)B(V);return{positions:m,index:E}}function GO(n){var l=earcut.flatten(n),a=earcut(l.vertices,l.holes,l.dimensions);return{positions:l.vertices,index:a}}function kw(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=n[0][0],s=n[0][n[0].length-1];a[0]===s[0]&&a[1]===s[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var o=n[0].length,h=Sl().flatten(n),v=h.vertices,m=h.dimensions,E=[],A=[],F=[],B=0;B<v.length/m;B++)m===2?E.push(v[B*2],v[B*2+1],1,-1,-1):E.push(v[B*3],v[B*3+1],1,-1,-1),F.push(0,0,1);var V=Sl()(h.vertices,h.holes,h.dimensions);A.push.apply(A,(0,me.Z)(V));for(var j=function(xt){var Nt=h.vertices.slice(xt*m,(xt+1)*m),de=h.vertices.slice((xt+1)*m,(xt+2)*m);de.length===0&&(de=h.vertices.slice(0,m));var fe=E.length/5;E.push(Nt[0],Nt[1],1,0,0,de[0],de[1],1,.1,0,Nt[0],Nt[1],0,0,.8,de[0],de[1],0,.1,.8);var Ne=zh([de[0],de[1],1],[Nt[0],Nt[1],0],[Nt[0],Nt[1],1],l);F.push.apply(F,(0,me.Z)(Ne).concat((0,me.Z)(Ne),(0,me.Z)(Ne),(0,me.Z)(Ne))),A.push.apply(A,(0,me.Z)([1,2,0,3,2,1].map(function(Ye){return Ye+fe})))},at=0;at<o;at++)j(at);return{positions:E,index:A,normals:F}}function zh(n,l,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=So.create(),h=So.create(),v=So.create();s&&(n=Bp(n),l=Bp(l),a=Bp(a));var m=So.fromValues.apply(So,(0,me.Z)(n)),E=So.fromValues.apply(So,(0,me.Z)(l)),A=So.fromValues.apply(So,(0,me.Z)(a));So.sub(o,A,E),So.sub(h,m,E),So.cross(v,o,h);var F=So.create();return So.normalize(F,v),F}var vf,Uh;(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"})(Uh||(Uh={}));var Fl;(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"})(Fl||(Fl={}));function Gv(n){for(var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Math.PI*2/n,s=[],o=0;o<n;o++)s.push(a*o+l*Math.PI/12);var h=s.map(function(v){var m=Math.sin(v+Math.PI/4),E=Math.cos(v+Math.PI/4);return[m,E,0]});return h}function _x(){return Gv(30)}function Lw(){return Gv(4)}function ac(){return Gv(3)}function C0(){return Gv(6,1)}function Bf(){return Gv(5)}var gg=(vf={},(0,X.Z)(vf,Fl.CIRCLE,_x),(0,X.Z)(vf,Fl.HEXAGON,C0),(0,X.Z)(vf,Fl.TRIANGLE,ac),(0,X.Z)(vf,Fl.SQUARE,Lw),(0,X.Z)(vf,Fl.PENTAGON,Bf),(0,X.Z)(vf,Uh.CYLINDER,_x),(0,X.Z)(vf,Uh.HEXAGONCOLUMN,C0),(0,X.Z)(vf,Uh.TRIANGLECOLUMN,ac),(0,X.Z)(vf,Uh.SQUARECOLUMN,Lw),(0,X.Z)(vf,Uh.PENTAGONCOLUMN,Bf),vf),mg={};function A0(n){var l=bs(n.coordinates);return{vertices:[].concat((0,me.Z)(l),(0,me.Z)(l),(0,me.Z)(l),(0,me.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function Pw(n){var l=bs(n.coordinates),a=Xs(l);return{vertices:[].concat((0,me.Z)(a),(0,me.Z)(a),(0,me.Z)(a),(0,me.Z)(a)),indices:[0,1,2,2,3,0],size:a.length}}function xx(n){var l=n.shape,a=Dw(l,!1),s=a.positions,o=a.index,h=a.normals;return{vertices:s,indices:o,normals:h,size:5}}function Ow(n){var l=bs(n.coordinates);return{vertices:(0,me.Z)(l),indices:[0],size:l.length}}function Ha(n){var l=n.coordinates,a=n.originCoordinates,s=n.version,o=new Ly({dash:!0,join:"bevel"});if(s==="GAODE2.x"){var h=l;Array.isArray(h[0][0])||(h=[l]);var v=a;Array.isArray(v[0][0])||(v=[a]);for(var m=0;m<h.length;m++){var E=h[m],A=v[m];o.extrude_gaode2(E,A)}}else{var F=l;F[0]&&!Array.isArray(F[0][0])&&(F=[l]),F.forEach(function(V){o.extrude(V)})}var B=o.complex;return{vertices:B.positions,indices:B.indices,normals:B.normals,indexes:B.indexes,size:6}}function Fw(n){var l=n.coordinates,a=[];if(!Array.isArray(l[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};var s=Py(l),o=s.results,h=s.totalDistance;return o.map(function(v){a.push(v[0],v[1],v[2],v[3],0,h)}),{vertices:a,indices:[],normals:[],size:6,count:o.length}}function HO(n){var l=n.coordinates,a=[];if(!Array.isArray(l[0]))return{vertices:[],indices:[],size:4,count:0};var s=_5(l),o=s.results;return o.map(function(h){a.push(h[0],h[1],h[2],h[3])}),{vertices:a,indices:[],size:4,count:o.length}}function yg(n,l){var a=l[0]-n[0],s=l[1]-n[1];return Math.sqrt(a*a+s*s)}function _g(n,l){return n.length<3&&n.push(0),l!==void 0&&n.push(l),n}function Py(n){var l=n;Array.isArray(l)&&Array.isArray(l[0])&&Array.isArray(l[0][0])&&(l=n.flat());var a=0;if(l.length<2)return{results:l,totalDistance:0};var s=[],o=_g(l[0],a);s.push(o);for(var h=1;h<l.length-1;h++){var v=yg(l[h-1],l[h]);a+=v;var m=_g(l[h],a);s.push(m),s.push(m)}var E=yg(l[l.length-2],l[l.length-1]);return a+=E,s.push(_g(l[l.length-1],a)),{results:s,totalDistance:a}}function _5(n){if(n.length<2)return{results:n};var l=[],a=_g(n[0]);l.push(a);for(var s=1;s<n.length-1;s++){var o=_g(n[s]);l.push(o),l.push(o)}return l.push(_g(n[n.length-1])),{results:l}}function xg(n){var l=n.coordinates,a=Sl().flatten(l),s=a.vertices,o=a.dimensions,h=a.holes;return{indices:Sl()(s,h,o),vertices:s,size:o}}function Rw(n){var l=n.coordinates,a=Sl().flatten(l),s=a.vertices,o=a.dimensions,h=a.holes;return{indices:Sl()(s,h,o),vertices:x5(s),size:o+4}}function x5(n){for(var l=[],a=Ac(n),s=a.center,o=a.radius,h=0;h<n.length;h+=2){var v=n[h],m=n[h+1];l.push.apply(l,[v,m,0].concat((0,me.Z)(s),[o]))}return l}function b5(n){var l=n.coordinates,a=kw(l,!0),s=a.positions,o=a.index,h=a.normals;return{vertices:s,indices:o,normals:h,size:5}}function E5(n){var l=n.shape,a=S5(l),s=a.positions,o=a.index;return{vertices:s,indices:o,size:3}}function Oy(n){var l=n.coordinates,a=[].concat((0,me.Z)(l[0]),[0,0,1,l[1][0],l[0][1],0,1,1],(0,me.Z)(l[1]),[0,1,0],(0,me.Z)(l[0]),[0,0,1],(0,me.Z)(l[1]),[0,1,0,l[0][0],l[1][1],0,0,0]),s=[0,1,2,3,4,5];return{vertices:a,indices:s,size:5}}function Fy(n,l){for(var a=l||30,s=n.coordinates,o=[],h=[],v=function(A){o.push(A,1,A,s[0][0],s[0][1],s[1][0],s[1][1],A,-1,A,s[0][0],s[0][1],s[1][0],s[1][1]),A!==a-1&&h.push.apply(h,(0,me.Z)([0,1,2,1,3,2].map(function(F){return A*2+F})))},m=0;m<a;m++)v(m);return{vertices:o,indices:h,size:7}}function jO(n){var l=n.coordinates;l.length===2&&l.push(0);var a=Ry(-1,1),s=Ry(1,1),o=Ry(-1,-1),h=Ry(1,-1),v=[].concat(_toConsumableArray(l),_toConsumableArray(a),_toConsumableArray(l),_toConsumableArray(o),_toConsumableArray(l),_toConsumableArray(h),_toConsumableArray(l),_toConsumableArray(s)),m=[0,1,2,3,0,2];return{vertices:v,indices:m,size:5}}function Dw(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(mg&&mg[n])return mg[n];var a=gg[n]?gg[n]():gg.cylinder(),s=kw([a],l);return mg[n]=s,s}function WO(n,l){for(var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:3,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=new Float32Array(n.length/a*3),h,v,m,E=vec3.create(),A=vec3.create(),F=vec3.create(),B=0,V=l.length;B<V;B+=3){h=l[B+0]*3,v=l[B+1]*3,m=l[B+2]*3;var j=[n[h],n[h+1]],at=[n[v],n[v+1]],ut=[n[m],n[m+1]];s&&(j=lngLatToMeters(j),at=lngLatToMeters(at),ut=lngLatToMeters(ut));var xt=j,Nt=_slicedToArray(xt,2),de=Nt[0],fe=Nt[1],Ne=vec3.fromValues(de,fe,n[h+2]),Ye=at,_r=_slicedToArray(Ye,2),Ir=_r[0],Nr=_r[1],Yr=vec3.fromValues(Ir,Nr,n[v+2]),yn=ut,fn=_slicedToArray(yn,2),$n=fn[0],di=fn[1],Yi=vec3.fromValues($n,di,n[m+2]);vec3.sub(E,Yi,Yr),vec3.sub(A,Ne,Yr),vec3.cross(F,E,A),o[h]+=E[0],o[h+1]+=E[1],o[h+2]+=E[2],o[v]+=E[0],o[v+1]+=E[1],o[v+2]+=E[2],o[m]+=E[0],o[m+1]+=E[1],o[m+2]+=E[2]}return w5(o),o}function w5(n){for(var l=0,a=n.length;l<a;l+=3){var s=vec3.fromValues(n[l],n[l+1],n[l+2]),o=vec3.create();vec3.normalize(o,s),n.set(o,l)}}function XO(n){var l=n[0][0],a=n[0][n[0].length-1];return l[0]===a[0]&&l[1]===a[1]}function S5(n){var l=["cylinder","triangleColumn","hexagonColumn","squareColumn"],a=geometryShape[n]?geometryShape[n]():geometryShape.circle(),s=l.indexOf(n)===-1?fillPolygon([a]):extrudePolygon([a]);return s}function Ry(n,l){var a=(n+1)/2,s=(l+1)/2;return[a,s]}function YO(){var n=primitiveSphere(EARTH_RADIUS,{segments:EARTH_SEGMENTS}),l=n.positionsArr,a=n.indicesArr,s=n.normalArr;return{vertices:l,indices:a,size:5,normals:s}}function Hv(){var n=primitiveSphere(EARTH_RADIUS+EARTH_RADIUS_OUTER,{segments:EARTH_SEGMENTS}),l=n.positionsArr,a=n.indicesArr,s=n.normalArr;return{vertices:l,indices:a,size:5,normals:s}}function T0(n){var l=Bw();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Bw(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Nw=`
uniform float u_opacity;

varying vec4 v_dash_array;
varying vec4 v_color;

uniform float segmentNumber;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;

  float flag = 0.;
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    flag = 1.;
  };
  gl_FragColor.a *=flag;
  
  gl_FragColor = filterColor(gl_FragColor);
}`,M0=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;


uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_lineDir: 1.0;
varying vec4 v_dash_array;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);

  vec2 s = source;
  vec2 t = target;
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    s = unProjCustomCoord(source);
    t = unProjCustomCoord(target);
  }
  float total_Distance = pixelDistance(s, t) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;

  styleMappingMat[3].b = segmentIndex / segmentNumber;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  gl_PointSize = 5.0;
  setPickingColor(a_PickingColor);
}
`,bx=`
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  float d_distance_ratio = styleMappingMat[3].b; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u6BD4\u4F8B

  gl_FragColor = v_color;
  
  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;
  }

  // \u5F53\u5B58\u5728\u8D34\u56FE\u65F6\u5728\u5E95\u8272\u4E0A\u8D34\u4E0A\u8D34\u56FE
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = styleMappingMat[3].g; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = styleMappingMat[3].a; // \u6A2A\u5411 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
    
  } else {
     gl_FragColor = filterColor(gl_FragColor);
  }
}`,C5=`#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    // dash: index / (segmentNumber - 1.);
    // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
    //  return index / (segmentNumber - 1.);
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;
  
  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  float arcThetaOffset = styleMappingMat[0][1];
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, arcThetaOffset), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, arcThetaOffset), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F

    float arcDistrance = length(source - target); // \u8D77\u59CB\u70B9\u548C\u7EC8\u70B9\u7684\u8DDD\u79BB
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      arcDistrance *= 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      // arcDistrance *= 8.0;
      arcDistrance = project_pixel_allmap(arcDistrance);
    }
    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // \u8D34\u56FE\u6CBF\u5F27\u7EBF\u65B9\u5411\u7684\u957F\u5EA6 - \u968F\u5730\u56FE\u7F29\u653E\u6539\u53D8
    float texCount = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
     styleMappingMat[3].g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size); // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB
     styleMappingMat[3].a = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,zw=`#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

uniform float segmentNumber;
varying vec2 v_iconMapUV;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float d_segmentIndex = styleMappingMat[3].r;   // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}`,A5=`
attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
varying vec4 v_color;

uniform float u_lineDir: 1.0;

uniform float u_thetaOffset: 0.314;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalThetaOffset"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  if(u_lineDir == 1.0) { // \u6B63\u5411
    return mid;
  } else { // \u9006\u5411
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
    return smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
}
vec2 interpolate (vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x ,t), bezier3(y,t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

void main() {
  v_color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke -> thetaOffset... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 thetaOffsetAndOffset = calThetaOffsetAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = thetaOffsetAndOffset.r;
  textureOffset = thetaOffsetAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  vec2 source = a_Instance.rg;  // \u8D77\u59CB\u70B9
  vec2 target =  a_Instance.ba; // \u7EC8\u70B9
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

   styleMappingMat[3].b = d_distance_ratio;

  // styleMappingMat[0][1] - arcThetaOffset
  vec4 curr = project_position(vec4(interpolate(source, target, segmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  vec4 next = project_position(vec4(interpolate(source, target, nextSegmentRatio, styleMappingMat[0][1]), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  //unProjCustomCoord
  
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));


  float d_segmentIndex = a_Position.x + 1.0; // \u5F53\u524D\u9876\u70B9\u5728\u5F27\u7EBF\u4E2D\u6240\u5904\u7684\u5206\u6BB5\u4F4D\u7F6E
  styleMappingMat[3].r = d_segmentIndex;

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
    gl_Position = u_Mvp * (vec4(curr.xy + offset, 0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  }
  setPickingColor(a_PickingColor);
}
`,Dy={solid:0,dash:1},T5=function(n){(0,Zt.Z)(a,n);var l=T0(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,at=j===void 0?[10,5]:j,ut=o.forward,xt=ut===void 0?!0:ut,Nt=o.lineTexture,de=Nt===void 0?!1:Nt,fe=o.iconStep,Ne=fe===void 0?100:fe,Ye=o.segmentNumber,_r=Ye===void 0?30:Ye,Ir=o.thetaOffset,Nr=Ir===void 0?.314:Ir;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,thetaOffset:Nr})){this.judgeStyleAttributes({opacity:v,thetaOffset:Nr});var Yr=this.layer.getEncodedData(),yn=this.calDataFrame(this.cellLength,Yr,this.cellProperties),fn=yn.data,$n=yn.width,di=yn.height;this.rowCount=di,this.dataTexture=this.cellLength>0&&fn.length>0?this.createTexture2D({flipY:!0,data:fn,format:Jt.LUMINANCE,type:Jt.FLOAT,width:$n,height:di}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}at.length===2&&at.push(0,0);var Yi=0,ho=[0,0,0,0],zo=[0,0,0,0];return m&&E&&(ho=Le(m),zo=Le(E),Yi=1),this.rendererService.getDirty()&&this.texture.bind(),{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_thetaOffset:(0,ee.isNumber)(Nr)?Nr:0,u_opacity:(0,ee.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:_r,u_line_type:Dy[V||"solid"],u_dash_array:at,u_blur:.9,u_lineDir:xt?1:-1,u_texture:this.texture,u_line_texture:de?1:0,u_icon_step:Ne,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Yi,u_sourceColor:ho,u_targetColor:zo}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor,m=o.lineType;return m==="dash"?{frag:Nw,vert:M0,type:"Dash"}:h&&v?{frag:zw,vert:A5,type:"Linear"}:{frag:bx,vert:C5,type:""}}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt;return it().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,E=m===void 0?30:m,A=v.mask,F=A===void 0?!1:A,B=v.maskInside,V=B===void 0?!0:B,j=this.getShaders(),at=j.frag,ut=j.vert,xt=j.type,fe.next=4,this.layer.buildLayerModel({moduleName:"lineArc2d"+xt,vertexShader:ut,fragmentShader:at,triangulation:Fy,depth:{enable:!1},blend:this.getBlend(),segmentNumber:E,stencil:Rr(F,V)});case 4:return Nt=fe.sent,fe.abrupt("return",[Nt]);case 6:case"end":return fe.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss);function M5(n){var l=I5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function I5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var k5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,L5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,P5=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,Ex=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,O5={solid:0,dash:1},F5=function(n){(0,Zt.Z)(a,n);var l=M5(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,at=j===void 0?[10,5]:j,ut=o.lineTexture,xt=ut===void 0?!1:ut,Nt=o.iconStep,de=Nt===void 0?100:Nt,fe=o.segmentNumber,Ne=fe===void 0?30:fe,Ye=o.globalArcHeight,_r=Ye===void 0?10:Ye;at.length===2&&at.push(0,0);var Ir=0,Nr=[0,0,0,0],Yr=[0,0,0,0];if(m&&E&&(Nr=Le(m),Yr=Le(E),Ir=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var yn=this.layer.getEncodedData(),fn=this.calDataFrame(this.cellLength,yn,this.cellProperties),$n=fn.data,di=fn.width,Yi=fn.height;this.rowCount=Yi,this.dataTexture=this.cellLength>0&&$n.length>0?this.createTexture2D({flipY:!0,data:$n,format:Jt.LUMINANCE,type:Jt.FLOAT,width:di,height:Yi}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:mx,u_global_height:_r,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:Ne,u_line_type:O5[V]||0,u_dash_array:at,u_texture:this.texture,u_line_texture:xt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ir,u_sourceColor:Nr,u_targetColor:Yr}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor;return h&&v?{frag:P5,vert:Ex,type:"Linear"}:{frag:k5,vert:L5,type:""}}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt;return it().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,E=m===void 0?30:m,A=v.mask,F=A===void 0?!1:A,B=v.maskInside,V=B===void 0?!0:B,j=this.getShaders(),at=j.frag,ut=j.vert,xt=j.type,fe.next=4,this.layer.buildLayerModel({moduleName:"lineArc3d"+xt,vertexShader:ut,fragmentShader:at,triangulation:Fy,blend:this.getBlend(),segmentNumber:E,stencil:Rr(F,V)});case 4:return Nt=fe.sent,fe.abrupt("return",[Nt]);case 6:case"end":return fe.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss);function R5(n){var l=D5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function D5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var By=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying vec4 v_color;

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
varying float v_segmentIndex;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;

  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    gl_FragColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          gl_FragColor = filterColor(pattern);
        }
    }

  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,B5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
varying float v_segmentIndex;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,N5=`
#define Animate 0.0

uniform float u_opacity;
uniform float u_blur : 0.9;
varying float v_segmentIndex;
uniform float segmentNumber;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].g; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = mix(u_sourceColor, u_targetColor, v_segmentIndex/segmentNumber);

  gl_FragColor.a *= opacity;

  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      gl_FragColor.a *= alpha;

      // u_animate 
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,z5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute vec4 a_Color;
attribute float a_Size;
attribute vec2 a_iconMapUV;

uniform float u_globel;
uniform float u_globel_radius;
uniform float u_global_height: 10;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;
uniform float u_opacity: 1.0;

varying vec4 v_dash_array;
varying vec4 v_color;
varying float v_segmentIndex;
varying vec2 v_iconMapUV;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143


#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 \u662F\u4E3A\u4E86\u5BF9\u9F50\u5750\u6807
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // \u624B\u52A8\u589E\u52A0\u4E00\u4E9B\u504F\u79FB\uFF0C\u51CF\u8F7B\u9762\u7684\u51B2\u7A81
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0)).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0)).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    // float total_Distance = pixelDistance(a_Instance.rg, a_Instance.ba) / 2.0 * PI;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  styleMappingMat[3].g = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    styleMappingMat[3].b = floor(arcDistrance/pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }
  

  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z, 1.0));
  }

  // \u5730\u7403\u6A21\u5F0F
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // \u7EBF\u7684\u504F\u79FB
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // \u8BA1\u7B97\u8D77\u59CB\u70B9\u548C\u7EC8\u6B62\u70B9\u7684\u8DDD\u79BB
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // \u8BA1\u7B97\u98DE\u7EBF\u5404\u4E2A\u8282\u70B9\u76F8\u5E94\u7684\u9AD8\u5EA6
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // \u5730\u7403\u70B9\u4F4D
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;
    
    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }
 

  setPickingColor(a_PickingColor);
}
`,U5={solid:0,dash:1},Z5=function(n){(0,Zt.Z)(a,n);var l=R5(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,at=j===void 0?[10,5]:j,ut=o.lineTexture,xt=ut===void 0?!1:ut,Nt=o.iconStep,de=Nt===void 0?100:Nt,fe=o.segmentNumber,Ne=fe===void 0?30:fe,Ye=o.globalArcHeight,_r=Ye===void 0?10:Ye;at.length===2&&at.push(0,0);var Ir=0,Nr=[0,0,0,0],Yr=[0,0,0,0];if(m&&E&&(Nr=Le(m),Yr=Le(E),Ir=1),this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var yn=this.layer.getEncodedData(),fn=this.calDataFrame(this.cellLength,yn,this.cellProperties),$n=fn.data,di=fn.width,Yi=fn.height;this.rowCount=Yi,this.dataTexture=this.cellLength>0&&$n.length>0?this.createTexture2D({flipY:!0,data:$n,format:Jt.LUMINANCE,type:Jt.FLOAT,width:di,height:Yi}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_globel:1,u_globel_radius:mx,u_global_height:_r,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:Ne,u_line_type:U5[V]||0,u_dash_array:at,u_texture:this.texture,u_line_texture:xt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ir,u_sourceColor:Nr,u_targetColor:Yr}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor;return h&&v?{frag:N5,vert:z5,type:"Linear"}:{frag:By,vert:B5,type:""}}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt;return it().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return v=this.layer.getLayerConfig(),m=v.segmentNumber,E=m===void 0?30:m,A=v.mask,F=A===void 0?!1:A,B=v.maskInside,V=B===void 0?!0:B,j=this.getShaders(),at=j.frag,ut=j.vert,xt=j.type,fe.next=4,this.layer.buildLayerModel({moduleName:"lineEarthArc3d"+xt,vertexShader:ut,fragmentShader:at,triangulation:Fy,depth:{enable:!0},blend:this.getBlend(),segmentNumber:E,stencil:Rr(F,V)});case 4:return Nt=fe.sent,fe.abrupt("return",[Nt]);case 6:case"end":return fe.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss);function Uw(n){var l=V5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function V5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Zw=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform float u_opacity;
uniform float u_textureBlend;
uniform float u_blur : 0.9;
uniform float u_line_type: 0.0;
// varying vec2 v_normal;
varying vec4 v_dash_array;
varying float v_distance_ratio;
varying vec4 v_color;

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

uniform float u_line_texture: 0.0;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float segmentNumber;

varying vec2 v_iconMapUV;

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;

#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0;
  float d_segmentIndex = styleMappingMat[3].g;
  
  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  gl_FragColor.a *= opacity;
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // \u5B9E\u7EBF\u90E8\u5206
    } else {
      // \u865A\u7EBF\u90E8\u5206
      discard;
    };
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u52A8\u753B\u6A21\u5F0F
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  // \u8BBE\u7F6E\u5F27\u7EBF\u7684\u8D34\u56FE
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { 
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = styleMappingMat[3].b; // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = gl_FragColor.a/opacity;
    }

    float v = styleMappingMat[3].a; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);
    
    // \u8BBE\u7F6E\u8D34\u56FE\u548C\u5E95\u8272\u7684\u53E0\u52A0\u6A21\u5F0F
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}`,G5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec4 a_Instance;
attribute float a_Size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float segmentNumber;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
varying vec4 v_color;

varying float v_distance_ratio;
uniform float u_line_type: 0.0;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];
varying vec4 v_dash_array;

uniform float u_icon_step: 100;
uniform float u_line_texture: 0.0;

attribute vec2 a_iconMapUV;
varying vec2 v_iconMapUV;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
    return index / (segmentNumber - 1.);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
    vec2 x = mix(source, target, ratio);
    vec2 center = mix(source, target, 0.5);
    float dSourceCenter = distance(source, center);
    float dXCenter = distance(x, center);
    return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
     float vertex_height = paraboloid(source, target, segmentRatio);

    return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
    );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size)/ 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return reverse_offset_normal(vec3(dir_screenspace,1.0)).xy * sign(offset_direction);
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) *
    sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2*cos(theta2) + source.x, r2*sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1. - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate (vec2 source, vec2 target, float angularDist, float t) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    vec2 mid = midPoint(source, target);
    vec3 x = vec3(source.x, mid.x, target.x);
    vec3 y = vec3(source.y, mid.y, target.y);
    return vec2(bezier3(x ,t), bezier3(y,t));
  }else {
    if(abs(angularDist - PI) < 0.001) {
      return (1.0 - t) * source + t * target;
    }
    float a = sin((1.0 - t) * angularDist) / sin(angularDist);
    float b = sin(t * angularDist) / sin(angularDist);
    vec2 sin_source = sin(source);
    vec2 cos_source = cos(source);
    vec2 sin_target = sin(target);
    vec2 cos_target = cos(target);
    float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
    float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
    float z = a * sin_source.y + b * sin_target.y;
    return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));
  }
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // dataset \u6570\u636E\u96C6
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if(u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    vec2 s = source;
    vec2 t = target;
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      s = unProjCustomCoord(source);
      t = unProjCustomCoord(target);
    }
    float total_Distance = pixelDistance(s, t) / 2.0 * PI;
    total_Distance = total_Distance*16.0; // total_Distance*16.0 \u8C03\u6574\u9ED8\u8BA4\u7684\u6548\u679C
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if(u_animate.x == Animate) {
      v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;
  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0));
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0));
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  styleMappingMat[3].g = a_Position.x; // \u8BE5\u9876\u70B9\u5728\u5F27\u7EBF\u4E0A\u7684\u5206\u6BB5\u6392\u5E8F
  if(LineTexture == u_line_texture) { // \u5F00\u542F\u8D34\u56FE\u6A21\u5F0F  
    // float mapZoomScale = u_CoordinateSystem !== COORDINATE_SYSTEM_P20_2?10000000.0:1.0;
    float d_arcDistrance = length(source - target);
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20) { // amap
      d_arcDistrance = d_arcDistrance * 1000000.0;
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) { // mapbox
      d_arcDistrance = project_pixel_allmap(d_arcDistrance);
    }
    float d_pixelLen = project_pixel(u_icon_step)/8.0;
    styleMappingMat[3].b = floor(d_arcDistrance/d_pixelLen); // \u8D34\u56FE\u5728\u5F27\u7EBF\u4E0A\u91CD\u590D\u7684\u6570\u91CF

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB
    float linePixelSize = project_pixel(a_Size);  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB
    styleMappingMat[3].a = lineOffsetWidth/linePixelSize;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    v_iconMapUV = a_iconMapUV;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(curr.xy + offset, curr.z, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));
  }
  setPickingColor(a_PickingColor);
}

`,Vw={solid:0,dash:1},Sx=function(n){(0,Zt.Z)(a,n);var l=Uw(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,at=j===void 0?[10,5]:j,ut=o.lineTexture,xt=ut===void 0?!1:ut,Nt=o.iconStep,de=Nt===void 0?100:Nt,fe=o.segmentNumber,Ne=fe===void 0?30:fe;at.length===2&&at.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var Ye=0,_r=[0,0,0,0],Ir=[0,0,0,0];if(m&&E&&(_r=Le(m),Ir=Le(E),Ye=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Nr=this.layer.getEncodedData(),Yr=this.calDataFrame(this.cellLength,Nr,this.cellProperties),yn=Yr.data,fn=Yr.width,$n=Yr.height;this.rowCount=$n,this.dataTexture=this.cellLength>0&&yn.length>0?this.createTexture2D({flipY:!0,data:yn,format:Jt.LUMINANCE,type:Jt.FLOAT,width:fn,height:$n}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,segmentNumber:Ne,u_line_type:Vw[V]||0,u_dash_array:at,u_texture:this.texture,u_line_texture:xt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:Ye,u_sourceColor:_r,u_targetColor:Ir}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:G5,fragmentShader:Zw,triangulation:Fy,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Vi.Attribute,descriptor:{name:"a_Instance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:4,update:function(v,m,E){return[E[3],E[4],E[5],E[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss);function jv(n){var l=Wv();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Wv(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Kd=`#define COORDINATE_SYSTEM_LNGLAT 1.0        // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0 // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE 3.0
#define COORDINATE_SYSTEM_IDENTITY 4.0
#define COORDINATE_SYSTEM_P20 5.0           // amap
#define COORDINATE_SYSTEM_P20_OFFSET 6.0    // amap offset
#define COORDINATE_SYSTEM_METER_OFFSET 7.0

#define COORDINATE_SYSTEM_P20_2 8.0         // amap2.0
uniform float u_CoordinateSystem;
varying vec4 v_color;
uniform float u_arrow: 0.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"

varying mat4 styleMappingMat;
void main() {
  float distanceAndIndex = styleMappingMat[0][3];
  float miter = styleMappingMat[0][2];

  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B


  if(u_arrow > 0.0 && distanceAndIndex < 2.0) { // arrow
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) { 
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z < 0.0) { // amap
        discard;
      }
    } else { // amap2 mapbox map
      if(cross(vec3(styleMappingMat[1].rg, 0.0), vec3(styleMappingMat[1].ba, 0.0)).z > 0.0) { 
        discard;
      }
    }
  } else { // line body
    if(miter < 0.0) {
      discard;
    }
  }


  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Cx=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute vec4 a_dirPoints;
attribute vec3 a_DistanceAndIndex;

uniform vec4 u_lineDir;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - a_Miter - a_DistanceAndIndex
    0.0, 0.0, 0.0, 0.0, // originX - originY - vectorX - vectorY
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );
  styleMappingMat[0][3] = a_DistanceAndIndex.y;
  styleMappingMat[0][2] = a_Miter;

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97


  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  // styleMappingMat[1].rg = a_Position.xy + offset;

  vec2 copyOffset = vec2(offset.x, offset.y);

  float lineDistance = a_DistanceAndIndex.x;
  float total_Distance = a_DistanceAndIndex.z;
  float currentLinePointRatio = lineDistance / total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z); // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }
  
  if(u_arrow > 0.0 && a_DistanceAndIndex.y < 2.0) {
    vec2 startPoint = a_dirPoints.rg;
    vec2 endPoint = a_dirPoints.ba;
    vec4 t1 = project_position(vec4(startPoint, 0, 1.0));
    vec4 t2 = project_position(vec4(endPoint, 0, 1.0));
    // TODO\uFF1A \u540E\u7EED\u4F18\u5316\u53EF\u4EE5\u628A\u4F4D\u7F6E\u8BA1\u7B97\u653E\u5728 cpu \u4E2D\u5B8C\u6210
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      vec2 p1 = (u_Mvp * vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = (u_Mvp * vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    } else {
      vec2 p1 = project_common_position_to_clipspace(vec4(t1.xy, 0.0, 1.0)).xy;
      vec2 p2 = project_common_position_to_clipspace(vec4(t2.xy, 0.0, 1.0)).xy;
      styleMappingMat[1].rg = normalize(p1 - p2);
      styleMappingMat[1].ba = normalize(gl_Position.xy - p2);
    }
  }

  setPickingColor(a_PickingColor);
}
`,cm=function(n){(0,Zt.Z)(a,n);var l=jv(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.arrow,F=A===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:A,B=0,V=[0,0,0,0],j=[0,0,0,0];if(m&&E&&(V=Le(m),j=Le(E),B=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var at=this.layer.getEncodedData(),ut=this.calDataFrame(this.cellLength,at,this.cellProperties),xt=ut.data,Nt=ut.width,de=ut.height;this.rowCount=de,this.dataTexture=this.cellLength>0&&xt.length>0?this.createTexture2D({flipY:!0,data:xt,format:Jt.LUMINANCE,type:Jt.FLOAT,width:Nt,height:de}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_linearColor:B,u_sourceColor:V,u_targetColor:j,u_arrow:Number(F.enable),u_arrowHeight:F.arrowHeight||3,u_arrowWidth:F.arrowWidth||2,u_tailWidth:F.tailWidth===void 0?1:F.tailWidth}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt;return it().wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,j=this.getShaders(),at=j.frag,ut=j.vert,this.layer.triangulation=Ha,de.next=5,this.layer.buildLayerModel({moduleName:"lineHalf",vertexShader:ut,fragmentShader:at,triangulation:Ha,depth:{enable:V},blend:this.getBlend(),stencil:Rr(E,F)});case 5:return xt=de.sent,de.abrupt("return",[xt]);case 7:case"end":return de.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(){return{frag:Kd,vert:Cx,type:"normal"}}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Vi.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h,v,m,E,A,F){return F===void 0?[m[3],10,m[5]]:[m[3],F,m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"dirPoints",type:Vi.Attribute,descriptor:{name:"a_dirPoints",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:4,update:function(h){var v=h.coordinates[0]||[0,0],m=h.coordinates[3]||[0,0];return[v[0],v[1],m[0],m[1]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h,v,m){return[m[4]]}}})}}]),a}(Ss),bg;(function(n){n[n.solid=0]="solid",n[n.dash=1]="dash"})(bg||(bg={}));var Eg;(function(n){n.VERTICAL="vertical",n.HORIZONTAL="horizontal"})(Eg||(Eg={}));var Ny;(function(n){n.NORMAL="normal",n.REPLACE="replace"})(Ny||(Ny={}));var zy;(function(n){n.ALWAYS="always",n.DRAGEND="dragend"})(zy||(zy={}));function Ax(n){var l=H5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function H5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var j5=`#define LineTypeSolid 0.0
uniform float u_opacity : 1.0;

varying vec4 v_color;

// dash
varying vec4 v_dash_array;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
 
  float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
  if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
    // \u5B9E\u7EBF\u90E8\u5206
  } else {
    // \u865A\u7EBF\u90E8\u5206
    discard;
  };

  gl_FragColor = filterColor(gl_FragColor);
}
`,W5=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_dash_array: [10.0, 5., 0, 0];

uniform float u_vertexScale: 1.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;
varying vec4 v_dash_array;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  vec2 offset = project_pixel(size.xy);

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = a_DistanceAndIndex.x / a_Total_Distance; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = a_DistanceAndIndex.x;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, project_pixel(a_Size.y), 1.0));
  } else {
    float lineHeight = a_Size.y;
 
    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Gw=`#define Animate 0.0
#define LineTexture 1.0
uniform float u_opacity : 1.0;
uniform float u_textureBlend;

uniform float u_borderWidth: 0.0;

uniform vec3 u_blur;
uniform vec4 u_borderColor;
varying vec4 v_color;

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying vec2 v_iconMapUV;

#pragma include "picking"

uniform float u_time;
uniform vec4 u_animate: [ 1, 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying mat4 styleMappingMat;
// [animate, duration, interval, trailLength],
void main() {
  float opacity = styleMappingMat[0][0];
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = v_color;
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = styleMappingMat[3].g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = styleMappingMat[3].b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = styleMappingMat[3].a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));
    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));
     vec4 pattern = texture2D(u_texture, uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor += pattern;
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = pattern;
    }
  } 

  float v = styleMappingMat[3].a;
  float borderWidth = min(0.5, u_borderWidth);
  // \u7ED8\u5236 border
  if(borderWidth > 0.01) {
    float borderOuterWidth = borderWidth/2.0;

    if(v >= 1.0 - borderWidth || v <= borderWidth) {
      if(v > borderWidth) {
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - borderWidth))/borderWidth);
        gl_FragColor.rgb = mix(gl_FragColor.rgb, u_borderColor.rgb, linear);
      } else if(v <= borderWidth) {
        float linear = smoothstep(0.0, 1.0, v/borderWidth);
        gl_FragColor.rgb = mix(u_borderColor.rgb, gl_FragColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      gl_FragColor.a = mix(0.0, gl_FragColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = styleMappingMat[3][3];
  if(blurV < 0.5) {
    gl_FragColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    gl_FragColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  gl_FragColor = filterColor(gl_FragColor);
}
`,Tx=`
#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

attribute vec2 a_iconMapUV;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;


uniform float u_linearColor: 0;
uniform float u_arrow: 0.0;
uniform float u_arrowHeight: 3.0;
uniform float u_arrowWidth: 2.0;
uniform float u_tailWidth: 1.0;

uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

vec2 calculateArrow(vec2 offset) {
  /*
  * \u5728\u652F\u6301\u7BAD\u5934\u7684\u65F6\u5019\uFF0C\u7B2C\u4E8C\u3001\u7B2C\u4E09\u7EC4\u9876\u70B9\u662F\u989D\u5916\u63D2\u5165\u7528\u4E8E\u6784\u5EFA\u9876\u70B9\u7684
  */
  float arrowFlag = -1.0;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    // \u9AD8\u5FB7 2.0 \u7684\u65CB\u8F6C\u89D2\u5EA6\u4E0D\u540C
    arrowFlag = 1.0;
  }
  float pi = arrowFlag * 3.1415926/2.;
  if(a_Miter < 0.) {
    // \u6839\u636E\u7EBF\u7684\u4E24\u4FA7\u504F\u79FB\u4E0D\u540C\u3001\u65CB\u8F6C\u7684\u65B9\u5411\u76F8\u53CD
    pi = -pi;
  }
  highp float angle_sin = sin(pi);
  highp float angle_cos = cos(pi);
  // \u8BA1\u7B97\u5782\u76F4\u4E0E\u7EBF\u65B9\u5411\u7684\u65CB\u8F6C\u77E9\u9635
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  float arrowWidth = u_arrowWidth;
  float arrowHeight = u_arrowHeight;

  vec2 arrowOffset = vec2(0.0);
  /*
  * a_DistanceAndIndex.y \u7528\u4E8E\u6807\u8BB0\u5F53\u524D\u9876\u70B9\u5C5E\u4E8E\u54EA\u4E00\u7EC4\uFF08\u4E24\u4E2A\u9876\u70B9\u4E00\u7EC4\uFF0C\u6784\u6210\u7EBF\u7684\u5176\u5B9E\u662F\u77E9\u5F62\uFF0C\u6700\u7B80\u9700\u8981\u56DB\u4E2A\u9876\u70B9\u3001\u4E24\u7EC4\u9876\u70B9\u6784\u6210\uFF09
  */
  if(a_DistanceAndIndex.y == 0.0) {
    // \u7BAD\u5934\u5C16\u90E8
    offset = vec2(0.0);
  } else if(a_DistanceAndIndex.y == 1.0) {
    // \u7BAD\u5934\u4E24\u4FA7
    arrowOffset = rotation_matrix*(offset * arrowHeight);
    offset += arrowOffset; // \u6CBF\u7EBF\u504F\u79FB
    offset = offset * arrowWidth; // \u5782\u76F4\u7EBF\u5411\u5916\u504F\u79FB\uFF08\u662F\u6784\u5EFA\u7BAD\u5934\u4E24\u4FA7\u7684\u9876\u70B9\uFF09
  } else if(a_DistanceAndIndex.y == 2.0 || a_DistanceAndIndex.y == 3.0 || a_DistanceAndIndex.y == 4.0) {
    // \u504F\u79FB\u5176\u4F59\u7684\u70B9\u4F4D\uFF08\u5C06\u957F\u5EA6\u8BA9\u4F4D\u7ED9\u7BAD\u5934\uFF09
    arrowOffset = rotation_matrix*(offset * arrowHeight) * arrowWidth;
    offset += arrowOffset;// \u6CBF\u7EBF\u504F\u79FB
  }

  return offset;
}

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 
  if(u_arrow > 0.0) {
      //  \u8BA1\u7B97\u7BAD\u5934
    offset = calculateArrow(offset);

    if(a_DistanceAndIndex.y > 4.0) {
      offset *= mix(1.0, u_tailWidth, currentLinePointRatio);
    }
  }

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][1] = lineDistance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  styleMappingMat[3][2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,X5=`varying vec4 v_color;
uniform float u_linearDir: 1.0;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

#pragma include "picking"


varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3][0]; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, linearRadio);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Y5={solid:0,dash:1},Mx=function(n){(0,Zt.Z)(a,n);var l=Ax(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"texture",s.createTexture2D({data:[0,0,0,0],mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1,height:1})),(0,X.Z)((0,st.Z)(s),"dataTexture",s.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.lineType,V=B===void 0?"solid":B,j=o.dashArray,at=j===void 0?[10,5,0,0]:j,ut=o.lineTexture,xt=ut===void 0?!1:ut,Nt=o.iconStep,de=Nt===void 0?100:Nt,fe=o.vertexHeightScale,Ne=fe===void 0?20:fe,Ye=o.borderWidth,_r=Ye===void 0?0:Ye,Ir=o.borderColor,Nr=Ir===void 0?"#ccc":Ir,Yr=o.raisingHeight,yn=Yr===void 0?0:Yr,fn=o.heightfixed,$n=fn===void 0?!1:fn,di=o.linearDir,Yi=di===void 0?Eg.VERTICAL:di,ho=o.blur,zo=ho===void 0?[1,1,1]:ho,Vs=o.arrow,hu=Vs===void 0?{enable:!1,arrowWidth:2,arrowHeight:3,tailWidth:1}:Vs;at.length===2&&at.push(0,0),this.rendererService.getDirty()&&this.texture&&this.texture.bind();var Gu=0,Wh=[0,0,0,0],s2=[0,0,0,0];if(m&&E&&(Wh=Le(m),s2=Le(E),Gu=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var X_=this.layer.getEncodedData(),u2=this.calDataFrame(this.cellLength,X_,this.cellProperties),cT=u2.data,uO=u2.width,fT=u2.height;this.rowCount=fT,this.dataTexture=this.cellLength>0&&cT.length>0?this.createTexture2D({flipY:!0,data:cT,format:Jt.LUMINANCE,type:Jt.FLOAT,width:uO,height:fT}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_textureBlend:F===Ny.NORMAL?0:1,u_line_type:Y5[V],u_dash_array:at,u_blur:zo,u_texture:this.texture,u_line_texture:xt?1:0,u_icon_step:de,u_textSize:[1024,this.iconService.canvasHeight||128],u_borderWidth:_r,u_borderColor:Le(Nr),u_linearDir:Yi===Eg.VERTICAL?1:0,u_linearColor:Gu,u_sourceColor:Wh,u_targetColor:s2,u_heightfixed:Number($n),u_vertexScale:Ne,u_raisingHeight:Number(yn),u_arrow:Number(hu.enable),u_arrowHeight:hu.arrowHeight||3,u_arrowWidth:hu.arrowWidth||2,u_tailWidth:hu.tailWidth===void 0?1:hu.tailWidth}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne;return it().wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,j=v.workerEnabled,at=j===void 0?!1:j,ut=v.enablePicking,xt=this.getShaders(),Nt=xt.frag,de=xt.vert,fe=xt.type,this.layer.triangulation=Ns,_r.next=5,this.layer.buildLayerModel({moduleName:"line"+fe,vertexShader:de,fragmentShader:Nt,triangulation:Ns,depth:{enable:V},blend:this.getBlend(),stencil:Rr(E,F),workerEnabled:at,workerOptions:{modelType:"line"+fe,enablePicking:ut,iconMap:this.iconService.getIconMap()}});case 5:return Ne=_r.sent,_r.abrupt("return",[Ne]);case 7:case"end":return _r.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor,m=o.lineType;return m==="dash"?{frag:j5,vert:W5,type:"Dash"}:h&&v?{frag:X5,vert:Tx,type:"Linear"}:{frag:Gw,vert:Tx,type:""}}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Vi.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v,m,E,A,F,B){return B===void 0?[E[3],10]:[E[3],B]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v,m,E){return[E[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0],E[1]]:[E,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A,F){return F}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v,m,E){return[E[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss);function $5(n){var l=q5();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function q5(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var K5=`uniform float u_opacity : 1.0;
uniform sampler2D u_texture;
uniform float u_linearDir: 1.0;

#pragma include "picking"

varying mat4 styleMappingMat;

void main() {
  float opacity = styleMappingMat[0][0];
  float linearRadio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  if(u_linearDir < 1.0) {
    linearRadio = styleMappingMat[3][3];
  }

  gl_FragColor = texture2D(u_texture, vec2(linearRadio, 0.5));

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  gl_FragColor = filterColor(gl_FragColor);
}
`,Q5=`
attribute float a_Miter;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// dash line
attribute float a_Total_Distance;
attribute vec2 a_DistanceAndIndex;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_heightfixed: 0.0;
uniform float u_vertexScale: 1.0;
uniform float u_raisingHeight: 0.0;

uniform float u_opacity: 1.0;

#pragma include "projection"
#pragma include "picking"

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;
 

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7EBF\u6A2A\u5411\u504F\u79FB\u7684\u8DDD\u79BB\uFF08\u5411\u4E24\u4FA7\u504F\u79FB\u7684\u548C\uFF09
  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5B9A\u70B9\u4F4D\u7F6E\u504F\u79FB\uFF0C\u6309\u5730\u56FE\u7B49\u7EA7\u7F29\u653E\u540E\u7684\u8DDD\u79BB \u5355\u4FA7 * 2
  float texV = lineOffsetWidth/linePixelSize; // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  styleMappingMat[3][0] = currentLinePointRatio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  styleMappingMat[3][3] = texV;             // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5 vertex height
  float lineHeight = a_Size.y; // size \u7B2C\u4E8C\u4E2A\u53C2\u6570\u4EE3\u8868\u7684\u9AD8\u5EA6 [linewidth, lineheight]

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    lineHeight *= 0.2; // \u4FDD\u6301\u548C amap/mapbox \u4E00\u81F4\u7684\u6548\u679C
    h *= 0.2;
    if(u_heightfixed < 1.0) {
      lineHeight = project_pixel(a_Size.y);
    }
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, lineHeight + h + u_raisingHeight, 1.0));
  } else {
    // mapbox -  amap
    
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // mapbox
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      h *= mapboxZoomScale;
      h += u_raisingHeight * mapboxZoomScale;
      if(u_heightfixed > 0.0) {
        lineHeight *= mapboxZoomScale;
      }
      
    } else {
      // amap
      h += u_raisingHeight;
      // lineHeight \u9876\u70B9\u504F\u79FB\u9AD8\u5EA6
      if(u_heightfixed < 1.0) {
        lineHeight *= pow(2.0, 20.0 - u_Zoom);
      }
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight + h, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,J5=function(n){(0,Zt.Z)(a,n);var l=$5(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;s.colorTexture&&s.colorTexture.destroy();var E=s.layer.getLayerConfig(),A=E.rampColors,F=br(A);s.colorTexture=m({data:new Uint8Array(F.data),width:F.width,height:F.height,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE,min:Jt.NEAREST,mag:Jt.NEAREST,flipY:!1})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.vertexHeightScale,E=m===void 0?20:m,A=o.raisingHeight,F=A===void 0?0:A,B=o.heightfixed,V=B===void 0?!1:B,j=o.linearDir,at=j===void 0?Eg.VERTICAL:j;if(this.rendererService.getDirty()&&this.colorTexture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var ut=this.layer.getEncodedData(),xt=this.calDataFrame(this.cellLength,ut,this.cellProperties),Nt=xt.data,de=xt.width,fe=xt.height;this.rowCount=fe,this.dataTexture=this.cellLength>0&&Nt.length>0?this.createTexture2D({flipY:!0,data:Nt,format:Jt.LUMINANCE,type:Jt.FLOAT,width:de,height:fe}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_linearDir:at===Eg.VERTICAL?1:0,u_opacity:(0,ee.isNumber)(v)?v:1,u_texture:this.colorTexture,u_heightfixed:Number(V),u_vertexScale:E,u_raisingHeight:Number(F)}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.colorTexture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j;return it().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,this.layer.triangulation=Ha,ut.next=4,this.layer.buildLayerModel({moduleName:"lineRampColors",vertexShader:Q5,fragmentShader:K5,triangulation:Ha,depth:{enable:V},blend:this.getBlend(),stencil:Rr(E,F)});case 4:return j=ut.sent,ut.abrupt("return",[j]);case 6:case"end":return ut.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Vi.Attribute,descriptor:{name:"a_DistanceAndIndex",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m,E,A,F){return F===void 0?[m[3],10]:[m[3],F]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h,v,m){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h,v,m){return[m[4]]}}})}}]),a}(Ss);function tI(n){var l=eI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function eI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var rI=`
varying vec4 v_color;
varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];
  float d_distance_ratio = styleMappingMat[3].r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B

  gl_FragColor = v_color;
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,nI=`uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

varying mat4 styleMappingMat;
void main() {
  float opacity = styleMappingMat[0][0];

  // styleMappingMat[3][0] \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  gl_FragColor = mix(u_sourceColor, u_targetColor, styleMappingMat[3][0]);
  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
}
`,Hw=`attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Position;

attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_vertexScale: 1.0;

#pragma include "projection"

varying vec4 v_color;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // distance_ratio/distance/pixelLen/texV
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  
  v_color = a_Color; 
  styleMappingMat[3][0] = a_Distance / a_Total_Distance;

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // \u7EBF\u9876\u70B9\u7684\u9AD8\u5EA6 - \u517C\u5BB9\u4E0D\u5B58\u5728\u7B2C\u4E09\u4E2A\u6570\u503C\u7684\u60C5\u51B5

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, project_pixel(a_Size.y) + h * 0.2, 1.0));
  } else {
    float lineHeight = a_Size.y;
    // \u517C\u5BB9 mapbox \u5728\u7EBF\u9AD8\u5EA6\u4E0A\u7684\u6548\u679C\u8868\u73B0\u57FA\u672C\u4E00\u81F4
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      h *= 2.0/pow(2.0, 20.0 - u_Zoom);
    }

    // #define COORDINATE_SYSTEM_P20 5.0
    // #define COORDINATE_SYSTEM_P20_OFFSET 6.0
    // amap1.x
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // \u4FDD\u6301\u9AD8\u5EA6\u76F8\u5BF9\u4E0D\u53D8
      lineHeight *= pow(2.0, 20.0 - u_Zoom);
    }

    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
    gl_PointSize = 10.0;
  }
}
`,iI=function(n){(0,Zt.Z)(a,n);var l=tI(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.vertexHeightScale,F=A===void 0?20:A,B=0,V=[0,0,0,0],j=[0,0,0,0];if(m&&E&&(V=Le(m),j=Le(E),B=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var at=this.layer.getEncodedData(),ut=this.calDataFrame(this.cellLength,at,this.cellProperties),xt=ut.data,Nt=ut.width,de=ut.height;this.rowCount=de,this.dataTexture=this.cellLength>0&&xt.length>0?this.createTexture2D({flipY:!0,data:xt,format:Jt.LUMINANCE,type:Jt.FLOAT,width:Nt,height:de}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_linearColor:B,u_sourceColor:V,u_targetColor:j,u_vertexScale:F}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.sourceColor,v=o.targetColor;return h&&v?{frag:nI,vert:Hw,type:"lineSimpleLinear"}:{frag:rI,vert:Hw,type:"lineSimpleNormal"}}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut;return it().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.getShaders(),V=B.frag,j=B.vert,at=B.type,Nt.next=4,this.layer.buildLayerModel({moduleName:at,vertexShader:j,fragmentShader:V,triangulation:Fw,primitive:Jt.LINES,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),pick:!1});case 4:return ut=Nt.sent,Nt.abrupt("return",[ut]);case 6:case"end":return Nt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"distance",type:Vi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h,v,m){return[m[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h,v,m){return[m[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0],m[1]]:[m,0]}}})}}]),a}(Ss);function jw(n){var l=Ix();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ix(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ww=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,aI=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;


#pragma include "projection"
#pragma include "picking"

varying vec4 v_color;

void main() {
  v_color = a_Color;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  // if(u_coord > 0.0) { // \u4F7F\u7528\u7ECF\u7EAC\u5EA6\u5750\u6807
      if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
    }
  // } else { // \u4F7F\u7528\u504F\u79FB\u5750\u6807
  //   vec2 pointPos = a_Position.xy;
  //   vec4 tileWorld = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   tileWorld.xy += pointOffset;

  //   tileWorld.xy += offset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     tileWorld.w *= u_PixelsPerMeter.z;
  //   }
  //   gl_Position = u_ViewProjectionMatrix * tileWorld + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}
`,oI=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,sI=`attribute float a_Miter;
attribute vec4 a_Color;
attribute vec3 a_Normal;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_size;

#pragma include "projection"

void main() {

  vec3 size = a_Miter * u_size * reverse_offset_normal(a_Normal);
  
  vec2 offset = project_pixel(size.xy);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, 0.0, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
}
`,uI=function(n){(0,Zt.Z)(a,n);var l=jw(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.usage,E=o.color,A=E===void 0?"#fff":E,F=o.size,B=F===void 0?1:F;return{u_opacity:Number(v),u_color:m==="basemap"?Le(A):[0,0,0,0],u_size:m==="basemap"?B:1}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at;return it().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.depth,V=B===void 0?!1:B,j=v.usage,this.layer.triangulation=Ha,xt.next=4,this.layer.buildLayerModel({moduleName:"lineTile_"+j,vertexShader:j==="basemap"?sI:aI,fragmentShader:j==="basemap"?oI:Ww,triangulation:Ha,blend:this.getBlend(),depth:{enable:V},stencil:Rr(E,F),pick:j!=="basemap"});case 4:return at=xt.sent,xt.abrupt("return",[at]);case 6:case"end":return xt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig(),h=o.usage;h!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(m){var E=m.size,A=E===void 0?1:E;return Array.isArray(A)?[A[0],A[1]]:[A,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(m,E,A,F,B){return B}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(m,E,A){return[A[4]]}}})}}]),a}(Ss);function lI(n){var l=cI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function cI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Xw=`#define Animate 0.0
#define LineTexture 1.0

// line texture
uniform float u_line_texture;
uniform sampler2D u_texture;
uniform vec2 u_textSize;
uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_opacity : 1.0;
uniform float u_textureBlend;
uniform float u_iconStepCount;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ]; // \u63A7\u5236\u8FD0\u52A8

varying vec2 v_iconMapUV;
varying float v_blur;
varying float v_radio;
varying vec4 v_color;
varying vec4 v_dataset;

#pragma include "picking"

void main() {
  float opacity = u_opacity;
  float animateSpeed = 0.0; // \u8FD0\u52A8\u901F\u5EA6
  float d_distance_ratio = v_dataset.r; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, v);
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity; // \u5168\u5C40\u900F\u660E\u5EA6
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      gl_FragColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
    float d_texPixelLen = v_dataset.b;  // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C

    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // \u8BA1\u7B97\u7EB9\u7406\u95F4\u9694 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture2D(u_texture, uv);

    // Tip: \u5224\u65AD\u7EB9\u7406\u95F4\u9694
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      gl_FragColor = filterColor(gl_FragColor + pattern);
    } else { // replace
        pattern.a *= opacity;
        if(gl_FragColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        gl_FragColor = filterColor(pattern);
    }
  }
  

  // blur - AA
  if(v < v_blur) {
    gl_FragColor.a = mix(0.0, gl_FragColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    gl_FragColor.a = mix(gl_FragColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  gl_FragColor = filterColor(gl_FragColor);
}
`,fI=`#define Animate 0.0

attribute float a_Miter;
attribute vec4 a_Color;
attribute vec2 a_Size;
attribute vec3 a_Normal;
attribute vec3 a_Position;
attribute vec2 a_iconMapUV;
attribute float a_Total_Distance;
attribute float a_Distance;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
uniform float u_icon_step: 100;
uniform float u_heightfixed;
uniform float u_linearColor: 0;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

// texV \u7EBF\u56FE\u5C42 - \u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\uFF08\u7EBF\u7684\u5BBD\u5EA6\u65B9\u5411\uFF09
varying vec2 v_iconMapUV;
varying vec4 v_color;
varying float v_blur;
varying float v_radio;
varying vec4 v_dataset;

void main() {


  float d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  float d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E

  v_iconMapUV = a_iconMapUV;
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
    d_texPixelLen *= 10.0;
  }

  if(u_animate.x == Animate || u_linearColor == 1.0) {
      d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0)/2.0;
  // \u8BBE\u7F6E\u6570\u636E\u96C6\u7684\u53C2\u6570
  v_dataset[0] = d_distance_ratio; // \u5F53\u524D\u70B9\u4F4D\u8DDD\u79BB\u5360\u7EBF\u603B\u957F\u7684\u6BD4\u4F8B
  v_dataset[1] = a_Distance;       // \u5F53\u524D\u9876\u70B9\u7684\u8DDD\u79BB
  v_dataset[2] = d_texPixelLen;    // \u8D34\u56FE\u7684\u50CF\u7D20\u957F\u5EA6\uFF0C\u6839\u636E\u5730\u56FE\u5C42\u7EA7\u7F29\u653E
  v_dataset[3] = miter;          // \u7EBF\u56FE\u5C42\u8D34\u56FE\u90E8\u5206\u7684 v \u5750\u6807\u503C 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));

  float originSize = a_Size.x;  // \u56FA\u5B9A\u9AD8\u5EA6
  if(u_heightfixed < 1.0) {     // \u9AD8\u5EA6\u968F zoom \u8C03\u6574
    originSize = project_float_pixel(a_Size.x);
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xy, wallHeight, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,Uy=function(n){(0,Zt.Z)(a,n);var l=lI(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas()}),s.layer.render();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.NEAREST,min:Jt.NEAREST,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.sourceColor,E=o.targetColor,A=o.textureBlend,F=A===void 0?"normal":A,B=o.heightfixed,V=B===void 0?!1:B,j=o.lineTexture,at=j===void 0?!1:j,ut=o.iconStep,xt=ut===void 0?100:ut,Nt=o.iconStepCount,de=Nt===void 0?1:Nt;this.rendererService.getDirty()&&this.texture.bind();var fe=0,Ne=[0,0,0,0],Ye=[0,0,0,0];return m&&E&&(Ne=Le(m),Ye=Le(E),fe=1),{u_heightfixed:Number(V),u_opacity:(0,ee.isNumber)(v)?v:1,u_textureBlend:F==="normal"?0:1,u_texture:this.texture,u_line_texture:at?1:0,u_iconStepCount:de,u_icon_step:xt,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:fe,u_sourceColor:Ne,u_targetColor:Ye}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption;return{u_animate:this.animateOption2Array(h),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.layer.buildLayerModel({moduleName:"lineWall",vertexShader:fI,fragmentShader:Xw,triangulation:Ha,depth:{enable:!1},blend:this.getBlend()});case 2:return v=E.sent,E.abrupt("return",[v]);case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"distance",type:Vi.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v,m,E){return[E[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Vi.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v,m,E){return[E[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=v.size,E=m===void 0?1:m;return Array.isArray(E)?[E[0],E[1]]:[E,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A,F){return F}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Vi.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v,m,E){return[E[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.texture,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss),kx={arc:T5,arc3d:F5,greatcircle:Sx,wall:Uy,line:Mx,halfLine:cm,simple:iI,linearline:J5,tileLine:uI,earthArc3d:Z5},Yw=kx;function Qd(n){var l=hI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function hI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wg=function(n){(0,Zt.Z)(a,n);var l=Qd(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"type","LineLayer"),(0,X.Z)((0,st.Z)(s),"arrowInsertCount",0),(0,X.Z)((0,st.Z)(s),"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}}),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new Yw[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},halfLine:{},earthArc3d:{}};return h[o]}},{key:"getModelType",value:function(){var o;if(this.layerType)return this.layerType;var h=this.styleAttributeService.getLayerStyleAttribute("shape"),v=h==null||(o=h.scale)===null||o===void 0?void 0:o.field;return v||"line"}},{key:"processData",value:function(o){if(this.getModelType()!=="simple")return o;var h=[];return o.map(function(v){if(Array.isArray(v.coordinates)&&Array.isArray(v.coordinates[0])&&Array.isArray(v.coordinates[0][0])){var m=(0,q.Z)({},v);v.coordinates.map(function(E){h.push((0,q.Z)((0,q.Z)({},m),{},{coordinates:E}))})}else h.push(v)}),h}}]),a}(dg);function $w(n){var l=pI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function pI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dI=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,qw=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_globel;
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  
  // \u5728\u5730\u7403\u6A21\u5F0F\u4E0B\uFF0C\u5C06\u539F\u672C\u5782\u76F4\u4E8E xy \u5E73\u9762\u7684\u5706\u67F1\u8C03\u6574\u59FF\u6001\u5230\u9002\u5E94\u5706\u7684\u89D2\u5EA6
  //\u65CB\u8F6C\u77E9\u9635mx\uFF0C\u521B\u5EFA\u7ED5x\u8F74\u65CB\u8F6C\u77E9\u9635
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float xsin = sin(xRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 mx = mat4(
    1,0,0,0,  
    0,xcos,-xsin,0,  
    0,xsin,xcos,0,  
    0,0,0,1);

  //\u65CB\u8F6C\u77E9\u9635my\uFF0C\u521B\u5EFA\u7ED5y\u8F74\u65CB\u8F6C\u77E9\u9635
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u4F59\u5F26\u503C
  float ysin = sin(yRadian);//\u6C42\u89E3\u65CB\u8F6C\u89D2\u5EA6\u6B63\u5F26\u503C
  mat4 my = mat4(
    ycos,0,-ysin,0,  
    0,1,0,0,  
    ysin,0,ycos,0,  
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);
  

  setPickingColor(a_PickingColor);
}
`,Kw=function(n){(0,Zt.Z)(a,n);var l=$w(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"raiseCount",0),(0,X.Z)((0,st.Z)(s),"raiseRepeat",0),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1,speed:.01,repeat:!1}:h,m=o.opacity,E=m===void 0?1:m,A=o.sourceColor,F=o.targetColor,B=o.pickLight,V=B===void 0?!1:B,j=o.heightfixed,at=j===void 0?!1:j,ut=o.opacityLinear,xt=ut===void 0?{enable:!1,dir:"up"}:ut,Nt=o.lightEnable,de=Nt===void 0?!0:Nt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:E})){this.judgeStyleAttributes({opacity:E});var fe=this.layer.getEncodedData(),Ne=this.calDataFrame(this.cellLength,fe,this.cellProperties),Ye=Ne.data,_r=Ne.width,Ir=Ne.height;this.rowCount=Ir,this.dataTexture=this.cellLength>0&&Ye.length>0?this.createTexture2D({flipY:!0,data:Ye,format:Jt.LUMINANCE,type:Jt.FLOAT,width:_r,height:Ir}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}var Nr=0,Yr=[0,0,0,0],yn=[0,0,0,0];if(A&&F&&(Yr=Le(A),yn=Le(F),Nr=1),this.raiseCount<1&&this.raiseRepeat>0&&v.enable){var fn=v.speed,$n=fn===void 0?.01:fn;this.raiseCount+=$n,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(V),u_heightfixed:Number(at),u_r:v.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(E)?E:1,u_linearColor:Nr,u_sourceColor:Yr,u_targetColor:yn,u_opacitylinear:Number(xt.enable),u_opacitylinear_dir:xt.dir==="up"?1:0,u_lightEnable:Number(de)}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.layer.getLayerConfig(),m=v.animateOption.repeat,E=m===void 0?1:m,this.raiseRepeat=E,B.next=4,this.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:qw,fragmentShader:dI,triangulation:xx,depth:{enable:!0},cull:{enable:!0,face:ec(this.mapService.version)},blend:this.getBlend()});case 4:return A=B.sent,B.abrupt("return",[A]);case 6:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h){var v=h.size;if(v){var m=[];return Array.isArray(v)&&(m=v.length===2?[v[0],v[0],v[1]]:v),Array.isArray(v)||(m=[v,v,v]),m}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Vi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h){var v=bs(h.coordinates);return Xs([v[0],v[1]])}}})}}]),a}(Ss);function vI(n){var l=gI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Qw=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,mI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);

  setPickingColor(a_PickingColor);
}
`,yI=function(n){(0,Zt.Z)(a,n);var l=vI(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.strokeOpacity,E=m===void 0?1:m,A=o.strokeWidth,F=A===void 0?0:A,B=o.stroke,V=B===void 0?"rgba(0,0,0,0)":B,j=o.offsets,at=j===void 0?[0,0]:j,ut=o.blend,xt=o.blur,Nt=xt===void 0?0:xt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:at})){this.judgeStyleAttributes({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:at});var de=this.layer.getEncodedData(),fe=this.calDataFrame(this.cellLength,de,this.cellProperties),Ne=fe.data,Ye=fe.width,_r=fe.height;this.rowCount=_r,this.dataTexture=this.cellLength>0&&Ne.length>0?this.createTexture2D({flipY:!0,data:Ne,format:Jt.LUMINANCE,type:Jt.FLOAT,width:Ye,height:_r}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_blur:Nt,u_additive:ut==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_stroke_opacity:(0,ee.isNumber)(E)?E:1,u_stroke_width:(0,ee.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(V),u_offsets:this.isOffsetStatic(at)?at:[0,0]}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return this.layer.triangulation=Pw,E.next=3,this.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:mI,fragmentShader:Qw,triangulation:Pw,depth:{enable:!0},blend:this.getBlend()});case 3:return v=E.sent,E.abrupt("return",[v]);case 5:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"animateOption2Array",value:function(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A){var F=(0,ht.Z)(E,3),B=F[0],V=F[1],j=F[2],at=So.fromValues(0,0,1),ut=So.fromValues(B,0,j),xt=B>=0?So.angle(at,ut):Math.PI*2-So.angle(at,ut),Nt=Math.PI*2-Math.asin(V/100),de=Je();tr(de,de,xt),vr(de,de,Nt);var fe=So.fromValues(1,1,0);So.transformMat4(fe,fe,de),So.normalize(fe,fe);var Ne=So.fromValues(-1,1,0);So.transformMat4(Ne,Ne,de),So.normalize(Ne,Ne);var Ye=So.fromValues(-1,-1,0);So.transformMat4(Ye,Ye,de),So.normalize(Ye,Ye);var _r=So.fromValues(1,-1,0);So.transformMat4(_r,_r,de),So.normalize(_r,_r);var Ir=[].concat((0,me.Z)(fe),(0,me.Z)(Ne),(0,me.Z)(Ye),(0,me.Z)(_r)),Nr=A%4*3;return[Ir[Nr],Ir[Nr+1],Ir[Nr+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Vi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.shape,E=m===void 0?2:m,A=o.layer.getLayerConfig().shape2d,F=A.indexOf(E);return[F]}}})}}]),a}(Ss);function Jw(n){var l=_I();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function _I(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tS=`varying vec4 v_color;
uniform float u_opacity: 1.0;

uniform float u_pickLight: 0.0;

#pragma include "picking"

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

uniform float u_linearColor: 0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;

uniform float u_opacitylinear: 0.0;
uniform float u_opacitylinear_dir: 1.0;

void main() {
  float opacity = styleMappingMat[0][0];
  float lightWeight = styleMappingMat[1][3];
  float barLinearZ = styleMappingMat[2][3];

  // \u8BBE\u7F6E\u5706\u67F1\u7684\u5E95\u8272
  if(u_linearColor == 1.0) { // \u4F7F\u7528\u6E10\u53D8\u989C\u8272
    gl_FragColor = mix(u_sourceColor, u_targetColor, barLinearZ);
    gl_FragColor.rgb *= lightWeight;
  } else { // \u4F7F\u7528 color \u65B9\u6CD5\u4F20\u5165\u7684\u989C\u8272
     gl_FragColor = v_color;
  }

  // \u5E94\u7528\u900F\u660E\u5EA6
  gl_FragColor.a *= opacity;

  // \u5F00\u542F\u900F\u660E\u5EA6\u6E10\u53D8
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - barLinearZ): barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
  } else {
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,xI=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec3 a_Position;
attribute vec3 a_Pos;
attribute vec4 a_Color;
attribute vec3 a_Size;
attribute vec3 a_Normal;

uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_r;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform float u_lightEnable: 1;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) + 
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA - lightWeight
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - linearZ(\u5782\u76F4\u65B9\u5411 0 - 1 \u7684\u503C)
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec3 size = a_Size * a_Position;

  // a_Position.z \u662F\u5728\u6784\u5EFA\u7F51\u683C\u7684\u65F6\u5019\u4F20\u5165\u7684\u6807\u51C6\u503C 0 - 1\uFF0C\u5728\u63D2\u503C\u5668\u63D2\u503C\u53EF\u4EE5\u83B7\u53D6 0\uFF5E1 \u7EBF\u6027\u6E10\u53D8\u7684\u503C
  styleMappingMat[2][3] =  a_Position.z;

  vec3 offset = size; // \u63A7\u5236\u5706\u67F1\u4F53\u7684\u5927\u5C0F - \u4ECE\u6807\u51C6\u5355\u4F4D\u5706\u67F1\u4F53\u8FDB\u884C\u504F\u79FB
  if(u_heightfixed < 1.0) { // \u5706\u67F1\u4F53\u4E0D\u56FA\u5B9A\u9AD8\u5EA6
    
    if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {
      // P20 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF1
      offset = offset * pow(2.0, (19.0 - u_Zoom));
    }
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {
      // P20_2 \u5750\u6807\u7CFB\u4E0B\uFF0C\u4E3A\u4E86\u548C Web \u58A8\u5361\u6258\u5750\u6807\u7CFB\u7EDF\u4E00\uFF0Czoom \u9ED8\u8BA4\u51CF3
      offset = offset * pow(2.0, (19.0 - 3.0 - u_Zoom));
    }
  } else {// \u5706\u67F1\u4F53\u56FA\u5B9A\u9AD8\u5EA6 \uFF08 \u5904\u7406 mapbox \uFF09
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r \u63A7\u5236\u5706\u67F1\u7684\u751F\u957F
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // \u5706\u67F1\u5149\u7167\u6548\u679C
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // \u53D6\u6D88\u4E09\u5143\u8868\u8FBE\u5F0F\uFF0C\u589E\u5F3A\u5065\u58EE\u6027
    lightWeight = calc_lighting(pos);
  }
  styleMappingMat[1][3] = lightWeight;

  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);

  // gl_Position = project_common_position_to_clipspace(pos);

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * pos;
  } else {
    gl_Position = project_common_position_to_clipspace(pos);
  }

  setPickingColor(a_PickingColor);
}
`,Lx=function(n){(0,Zt.Z)(a,n);var l=Jw(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"raiseCount",0),(0,X.Z)((0,st.Z)(s),"raiseRepeat",0),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1,speed:.01,repeat:!1}:h,m=o.opacity,E=m===void 0?1:m,A=o.sourceColor,F=o.targetColor,B=o.pickLight,V=B===void 0?!1:B,j=o.heightfixed,at=j===void 0?!1:j,ut=o.opacityLinear,xt=ut===void 0?{enable:!1,dir:"up"}:ut,Nt=o.lightEnable,de=Nt===void 0?!0:Nt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:E})){this.judgeStyleAttributes({opacity:E});var fe=this.layer.getEncodedData(),Ne=this.calDataFrame(this.cellLength,fe,this.cellProperties),Ye=Ne.data,_r=Ne.width,Ir=Ne.height;this.rowCount=Ir,this.dataTexture=this.cellLength>0&&Ye.length>0?this.createTexture2D({flipY:!0,data:Ye,format:Jt.LUMINANCE,type:Jt.FLOAT,width:_r,height:Ir}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}var Nr=0,Yr=[0,0,0,0],yn=[0,0,0,0];if(A&&F&&(Yr=Le(A),yn=Le(F),Nr=1),this.raiseCount<1&&this.raiseRepeat>0&&v.enable){var fn=v.speed,$n=fn===void 0?.01:fn;this.raiseCount+=$n,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}return{u_pickLight:Number(V),u_heightfixed:Number(at),u_r:v.enable&&this.raiseRepeat>0?this.raiseCount:1,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(E)?E:1,u_linearColor:Nr,u_sourceColor:Yr,u_targetColor:yn,u_opacitylinear:Number(xt.enable),u_opacitylinear_dir:xt.dir==="up"?1:0,u_lightEnable:Number(de)}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.depth,E=m===void 0?!0:m,A=v.animateOption.repeat,F=A===void 0?1:A,this.raiseRepeat=F,j.next=4,this.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:xI,fragmentShader:tS,triangulation:xx,blend:this.getBlend(),cull:{enable:!0,face:ec(this.mapService.version)},depth:{enable:E}});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h){var v=h.size;if(v){var m=[];return Array.isArray(v)&&(m=v.length===2?[v[0],v[0],v[1]]:v),Array.isArray(v)||(m=[v,v,v]),m}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h,v,m,E,A){return A}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Vi.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(h){var v=bs(h.coordinates);return[v[0],v[1],0]}}})}}]),a}(Ss);function Zy(n){var l=fm();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function fm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var eS=`
uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
uniform float u_time;
uniform vec4 u_animate: [ 1., 2., 1.0, 0.2 ];

#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  
  outer_df = sdCircle(v_data.xy, 1.0);
  inner_df = sdCircle(v_data.xy, r);


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );
  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

 gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);

  float d = length(v_data.xy);
  if(d > 0.5) {
    discard;
  }
  float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  
  // \u6839\u636E\u53E0\u52A0\u6A21\u5F0F\u9009\u62E9\u6548\u679C
  if(u_additive > 0.0) {
    gl_FragColor *= intensity;
    // \u4F18\u5316\u6C34\u6CE2\u70B9 blend additive \u6A21\u5F0F\u4E0B\u6709\u7684\u62FE\u53D6\u6548\u679C 
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor = vec4(gl_FragColor.xyz, gl_FragColor.a * intensity);
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,bI=`uniform float u_additive;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"


void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  float opacity = styleMappingMat[0][0];
  float stroke_opacity = styleMappingMat[0][1];
  float strokeWidth = styleMappingMat[0][2];
  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + strokeWidth);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(strokeWidth < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,Px=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_meter2coord;
uniform float u_meteryScale;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
uniform vec2 u_offsets;

uniform float u_blur : 0.0;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize \u8BBE\u7F6E\u62FE\u53D6\u5927\u5C0F
  *  u_meter2coord \u5728\u7B49\u9762\u79EF\u5927\u5C0F\u7684\u65F6\u5019\u8BBE\u7F6E\u5355\u4F4D
  */
  float newSize = setPickingSize(a_Size) * u_meter2coord;
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][1] = strokeOpacityAndOffset.r;
  textureOffset = strokeOpacityAndOffset.g;

  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    if(newSize * pow(2.0, u_Zoom) < 48.0) {
      antialiasblur = max(antialiasblur, -0.05);
    } else if(newSize * pow(2.0, u_Zoom) < 128.0) {
      antialiasblur = max(antialiasblur, -0.6/pow(u_Zoom, 2.0));
    } else {
      antialiasblur = max(antialiasblur, -0.8/pow(u_Zoom, 2.0));
    }
    
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.x += offset.x / u_meteryScale;
      aPosition.y += offset.y;
      offset = vec2(0.0);
    }
  }

  // TODP: /abs(extrude.x) \u662F\u4E3A\u4E86\u517C\u5BB9\u5730\u7403\u6A21\u5F0F
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);


  // vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));
  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_raisingHeight;

  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }
 

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,rS=function(n){(0,Zt.Z)(a,n);var l=Zy(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"meter2coord",1),(0,X.Z)((0,st.Z)(s),"meterYScale",1),(0,X.Z)((0,st.Z)(s),"isMeter",!1),(0,X.Z)((0,st.Z)(s),"unit","l7size"),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.strokeOpacity,E=m===void 0?1:m,A=o.strokeWidth,F=A===void 0?0:A,B=o.stroke,V=B===void 0?"rgba(0,0,0,0)":B,j=o.offsets,at=j===void 0?[0,0]:j,ut=o.blend,xt=o.blur,Nt=xt===void 0?0:xt,de=o.raisingHeight,fe=de===void 0?0:de,Ne=o.heightfixed,Ye=Ne===void 0?!1:Ne,_r=o.unit,Ir=_r===void 0?"l7size":_r;if(this.updateUnit(Ir),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:at})){this.judgeStyleAttributes({opacity:v,strokeOpacity:E,strokeWidth:F,stroke:V,offsets:at});var Nr=this.layer.getEncodedData(),Yr=this.calDataFrame(this.cellLength,Nr,this.cellProperties),yn=Yr.data,fn=Yr.width,$n=Yr.height;this.rowCount=$n,this.dataTexture=this.cellLength>0&&yn.length>0?this.createTexture2D({flipY:!0,data:yn,format:Jt.LUMINANCE,type:Jt.FLOAT,width:fn,height:$n}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(fe),u_heightfixed:Number(Ye),u_meter2coord:this.meter2coord,u_meteryScale:this.meterYScale,u_isMeter:Number(this.isMeter),u_blur:Nt,u_additive:ut==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_stroke_opacity:(0,ee.isNumber)(E)?E:1,u_stroke_width:(0,ee.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(V),u_offsets:this.isOffsetStatic(at)?at:[0,0]}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),qf)}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.updateUnit("l7size"),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"calMeter2Coord",value:function(){var o=(0,ht.Z)(this.layer.getSource().extent,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(h+m)/2,(v+E)/2],F=this.mapService.version,B=Co==null?void 0:Co.mapboxgl;if(F===yu.MAPBOX&&B!==null&&B!==void 0&&B.MercatorCoordinate){var V=B.MercatorCoordinate.fromLngLat({lng:A[0],lat:A[1]},0),j=V.meterInMercatorCoordinateUnits(),at=new B.MercatorCoordinate(V.x-j,V.y,V.z),ut=at.toLngLat(),xt=new B.MercatorCoordinate(V.x,V.y-j,V.z),Nt=xt.toLngLat();this.meter2coord=A[0]-ut.lng,this.meterYScale=(Nt.lat-A[1])/this.meter2coord;return}var de=this.mapService.meterToCoord(A,[h,v]),fe=this.mapService.meterToCoord(A,[m===h?m+.1:m,E===v?v+.1:E]);this.meter2coord=(de+fe)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne,Ye;return it().wrap(function(Ir){for(;;)switch(Ir.prev=Ir.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.animateOption,V=B===void 0?{enable:!1}:B,j=v.workerEnabled,at=j===void 0?!1:j,ut=v.enablePicking,xt=v.shape2d,Nt=this.getShaders(V),de=Nt.frag,fe=Nt.vert,Ne=Nt.type,this.layer.triangulation=qf,Ir.next=5,this.layer.buildLayerModel({moduleName:Ne,vertexShader:fe,fragmentShader:de,triangulation:qf,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),workerEnabled:at,workerOptions:{modelType:Ne,enablePicking:ut,shape2d:xt}});case 5:return Ye=Ir.sent,Ir.abrupt("return",[Ye]);case 7:case"end":return Ir.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(o){if(o.enable)switch(o.type){case"wave":return{frag:eS,vert:Px,type:"pointWave"};default:return{frag:eS,vert:Px,type:"pointWave"}}else return{frag:bI,vert:Px,type:"pointFill"}}},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"animateOption2Array",value:function(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig().shape2d;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Vi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.shape,E=m===void 0?2:m,A=o.indexOf(E);return[A]}}})}},{key:"updateUnit",value:function(o){var h=this.mapService.version;this.unit!==o&&(this.unit!=="meter"&&o==="meter"&&h!==yu.DEFUALT&&h!==yu.GLOBEL?(this.isMeter=!0,this.calMeter2Coord()):this.unit==="meter"&&o!=="meter"&&(this.isMeter=!1,this.meter2coord=1),this.unit=o)}}]),a}(Ss);function EI(n){var l=nS();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function nS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var wI=`uniform sampler2D u_texture;
uniform vec2 u_textSize;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "sdf_2d"
#pragma include "picking"
varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv;

void main() {

  float opacity = styleMappingMat[0][0];

  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  gl_FragColor = texture2D(u_texture, pos);
  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
}
`,SI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute vec2 a_Uv;
attribute float a_Rotate;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform mat2 u_RotateMatrix;
uniform float u_isMeter;

varying vec2 v_uv; // \u672C\u8EAB\u7684 uv \u5750\u6807
varying vec2 v_Iconuv; // icon \u8D34\u56FE\u7684 uv \u5750\u6807

uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;
uniform float u_opacity : 1;
uniform vec2 u_offsets;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;

  v_uv = (a_Extrude.xy + 1.0)/2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // empty - empty - empty - empty
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = (rotation_matrix * u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));
  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // height fixed
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }
 
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`,CI=function(n){(0,Zt.Z)(a,n);var l=EI(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"meter2coord",1),(0,X.Z)((0,st.Z)(s),"isMeter",!1),(0,X.Z)((0,st.Z)(s),"radian",0),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),s.layerService.throttleRenderLayers();return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.LINEAR,min:Jt.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128,mipmap:!0})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.offsets,E=m===void 0?[0,0]:m,A=o.rotation,F=o.raisingHeight,B=F===void 0?0:F,V=o.heightfixed,j=V===void 0?!1:V;this.rendererService.getDirty()&&this.texture.bind();var at=1;if((this.mapService.version==="GAODE2.x"||this.mapService.version==="GAODE1.x")&&(at=-1),this.radian=A!==void 0?at*Math.PI*A/180:at*Math.PI*(this.mapService.getRotation()%360)/180,this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:E})){this.judgeStyleAttributes({opacity:v,offsets:E});var ut=this.layer.getEncodedData(),xt=this.calDataFrame(this.cellLength,ut,this.cellProperties),Nt=xt.data,de=xt.width,fe=xt.height;this.rowCount=fe,this.dataTexture=this.cellLength>0&&Nt.length>0?this.createTexture2D({flipY:!0,data:Nt,format:Jt.LUMINANCE,type:Jt.FLOAT,width:de,height:fe}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(B),u_heightfixed:Number(j),u_isMeter:Number(this.isMeter),u_RotateMatrix:new Float32Array([Math.cos(this.radian),Math.sin(this.radian),-Math.sin(this.radian),Math.cos(this.radian)]),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,ee.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(E)?E:[0,0]}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),A0)}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),v=this.layer.getLayerConfig(),m=v.unit,E=m===void 0?"l7size":m,A=this.mapService.version,E==="meter"&&A!==yu.DEFUALT&&A!==yu.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),B.next=7,this.buildModels();case 7:return B.abrupt("return",B.sent);case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"calMeter2Coord",value:function(){var o=(0,ht.Z)(this.layer.getSource().extent,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(h+m)/2,(v+E)/2],F=this.mapService.version;if(F===yu.MAPBOX&&window.mapboxgl.MercatorCoordinate){var B=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:A[0],lat:A[1]},0),V=1,j=V*B.meterInMercatorCoordinateUnits(),at=new window.mapboxgl.MercatorCoordinate(B.x-j,B.y,B.z),ut=at.toLngLat();this.meter2coord=A[0]-ut.lng;return}var xt=this.mapService.meterToCoord(A,[h,v]),Nt=this.mapService.meterToCoord(A,[m===h?m+.1:m,E===v?v+.1:E]);this.meter2coord=(xt+Nt)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:SI,fragmentShader:wI,triangulation:A0,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),cull:{enable:!0,face:ec(this.mapService.version)}});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;this.iconService.off("imageUpdate",this.updateTexture),(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Vi.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.rotate,E=m===void 0?0:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.shape,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]*o.meter2coord]:[E*o.meter2coord]}}})}}]),a}(Ss);function AI(n){var l=iS();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function iS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var TI=`
uniform sampler2D u_texture;
varying vec4 v_color;
varying vec2 v_uv;
uniform vec2 u_textSize;
uniform float u_opacity : 1;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main(){
      float opacity = styleMappingMat[0][0];
      float size = styleMappingMat[1][0];
      vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
      vec4 textureColor;

      // Y = 0.299R + 0.587G + 0.114B // \u4EAE\u5EA6\u63D0\u53D6
     
      textureColor = texture2D(u_texture, pos);

      // Tip: \u53BB\u9664\u8FB9\u7F18\u90E8\u5206 mipmap \u5BFC\u81F4\u7684\u6DF7\u5408\u53D8\u6697
      float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
      if(fragmengTocenter >= 0.5) {
            float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
            textureColor.a *= luma;
      }
      
      

      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
            gl_FragColor= textureColor;
      }else {
            gl_FragColor= step(0.01, textureColor.z) * v_color;
      }

      gl_FragColor.a = gl_FragColor.a * opacity;
      gl_FragColor = filterColor(gl_FragColor);
}
`,Ox=`precision highp float;
attribute vec3 a_Position;
attribute vec4 a_Color;
attribute vec2 a_Uv;
attribute float a_Size;
varying vec4 v_color;
varying vec2 v_uv;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform vec2 u_offsets;

uniform float u_opacity : 1;
uniform float u_raisingHeight: 0.0;
uniform float u_heightfixed: 0.0;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  styleMappingMat[1][0] = a_Size;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  v_color = a_Color;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
   
  vec2 offset = project_pixel(textrueOffsets);

  float raisingHeight = u_raisingHeight;
  if(u_heightfixed < 1.0) { // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, raisingHeight, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`,aS=function(n){(0,Zt.Z)(a,n);var l=AI(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"updateTexture",function(){var m=s.rendererService.createTexture2D;if(s.texture){s.texture.update({data:s.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(function(){s.layerService.throttleRenderLayers()});return}s.texture=m({data:s.iconService.getCanvas(),mag:Jt.LINEAR,min:Jt.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:s.iconService.canvasHeight||128,mipmap:!0})}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.offsets,E=m===void 0?[0,0]:m,A=o.raisingHeight,F=A===void 0?0:A,B=o.heightfixed,V=B===void 0?!1:B;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:E})){this.judgeStyleAttributes({opacity:v,offsets:E});var j=this.layer.getEncodedData(),at=this.calDataFrame(this.cellLength,j,this.cellProperties),ut=at.data,xt=at.width,Nt=at.height;this.rowCount=Nt,this.dataTexture=this.cellLength>0&&ut.length>0?this.createTexture2D({flipY:!0,data:ut,format:Jt.LUMINANCE,type:Jt.FLOAT,width:xt,height:Nt}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_raisingHeight:Number(F),u_heightfixed:Number(V),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:(0,ee.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(E)?E:[0,0]}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.iconService.on("imageUpdate",this.updateTexture),this.updateTexture(),m.next=4,this.buildModels();case 4:return m.abrupt("return",m.sent);case 5:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:Ox,fragmentShader:TI,triangulation:Ow,depth:{enable:!1},primitive:Jt.POINTS,blend:this.getBlend(),stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(v){var m=o.iconService.getIconMap(),E=v.shape,A=m[E]||{x:0,y:0},F=A.x,B=A.y;return[F,B]}}})}}]),a}(Ss);function MI(n){var l=II();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function II(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var oS=`uniform float u_opacity : 1;
varying vec4 v_color;
void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
}
`,kI=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;

varying vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = a_Color;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy, a_Position.z, 1.0);
  } else {
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
}
`;function sS(n){var l=n.coordinates;return{vertices:(0,me.Z)(l),indices:[0],size:l.length}}var hm=function(n){(0,Zt.Z)(a,n);var l=MI(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h;return{u_opacity:(0,ee.isNumber)(v)?v:1}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,this.layer.triangulation=sS,j.next=4,this.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:kI,fragmentShader:oS,triangulation:sS,depth:{enable:!1},primitive:Jt.POINTS,blend:this.getBlend(),stencil:Rr(E,F),pick:!1});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(Ss);function LI(n){var l=PI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function PI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var OI=`
uniform float u_additive;
uniform float u_opacity: 1.0;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;
#pragma include "sdf_2d"
#pragma include "picking"

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
  } else {
    gl_FragColor.a *= opacity_t;
  }

  if(gl_FragColor.a > 0.0) {
    gl_FragColor = filterColor(gl_FragColor);
  }

  vec2 extrude =  v_exteude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  // full circle
  // float rades = dot(dir, baseDir);
  // float flag = sign(dir.y);
  // float radar_v = (flag - 1.0) * -0.5 + flag * acos(rades)/pi/2.0;
  
  // half circle
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  gl_FragColor.a *= radar_v;
}
`,FI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
uniform float u_speed: 1.0;
uniform float u_time;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_isMeter;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;
varying vec2 v_exteude;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2( 
    cos(time), sin(time), 
    -sin(time), cos(time)
  );
  v_exteude = rotateMatrix * a_Extrude.xy;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  vec2 offset = (extrude.xy * (newSize));
  vec3 aPosition = a_Position;
  if(u_isMeter < 1.0) {
    // \u4E0D\u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    offset = project_pixel(offset);
  } else {
    // \u4EE5\u7C73\u4E3A\u5B9E\u9645\u5355\u4F4D
    antialiasblur *= pow(19.0 - u_Zoom, 2.0);
    antialiasblur = max(antialiasblur, -0.01);
    // offset *= 0.5;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      aPosition.xy += offset;
      offset.x = 0.0;
      offset.y = 0.0;
    }
  }

  v_data = vec4(extrude.x, extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(aPosition.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));
  }

  setPickingColor(a_PickingColor);
}
`,uS=function(n){(0,Zt.Z)(a,n);var l=LI(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"meter2coord",1),(0,X.Z)((0,st.Z)(s),"isMeter",!1),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.blend,E=o.speed,A=E===void 0?1:E;return{u_isMeter:Number(this.isMeter),u_speed:A,u_additive:m==="additive"?1:0,u_opacity:(0,ee.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){var o=this.layer.getLayerConfig(),h=o.animateOption,v=h===void 0?{enable:!1}:h;return{u_animate:this.animateOption2Array(v),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),A0)}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.layer.getLayerConfig(),m=v.unit,E=m===void 0?"l7size":m,A=this.mapService.version,E==="meter"&&A!==yu.DEFUALT&&A!==yu.GLOBEL&&(this.isMeter=!0,this.calMeter2Coord()),B.next=5,this.buildModels();case 5:return B.abrupt("return",B.sent);case 6:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"calMeter2Coord",value:function(){var o=(0,ht.Z)(this.layer.getSource().extent,4),h=o[0],v=o[1],m=o[2],E=o[3],A=[(h+m)/2,(v+E)/2],F=this.mapService.version;if(F===yu.MAPBOX&&window.mapboxgl.MercatorCoordinate){var B=window.mapboxgl.MercatorCoordinate.fromLngLat({lng:A[0],lat:A[1]},0),V=1,j=V*B.meterInMercatorCoordinateUnits(),at=new window.mapboxgl.MercatorCoordinate(B.x-j,B.y,B.z),ut=at.toLngLat();this.meter2coord=A[0]-ut.lng;return}var xt=this.mapService.meterToCoord(A,[h,v]),Nt=this.mapService.meterToCoord(A,[m===h?m+.1:m,E===v?v+.1:E]);this.meter2coord=(xt+Nt)/2,this.meter2coord||(this.meter2coord=7.70681090738883)}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:FI,fragmentShader:OI,triangulation:A0,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"animateOption2Array",value:function(o){return[o.enable?0:1,o.speed||1,o.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]*o.meter2coord]:[E*o.meter2coord]}}})}}]),a}(Ss);function lS(n){var l=RI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function RI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var DI=`
uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_additive;

uniform float u_stroke_opacity : 1;

uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
varying float v_blur;
varying float v_innerRadius;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  float opacity = styleMappingMat[0][0];
  // Tip: \u7247\u5143\u5230\u4E2D\u5FC3\u70B9\u7684\u8DDD\u79BB 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: \u7247\u5143\u7684\u526A\u5207\u6210\u5706\u5F62
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // \u5F53\u5B58\u5728 stroke \u4E14 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      gl_FragColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      gl_FragColor = mix(v_color, stroke, mixR);
    } else {
      gl_FragColor = v_color;
    }
  } else {
    // \u5F53\u4E0D\u5B58\u5728 stroke \u6216 stroke <= 0.01
    gl_FragColor = v_color;
  }

  gl_FragColor.a *= opacity;

  gl_FragColor = filterColor(gl_FragColor);
  
  if(u_additive > 0.0) {
    gl_FragColor *= circleClipOpacity;
  } else {
    gl_FragColor.a *= circleClipOpacity;
  }

}
`,cS=`
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute float a_Size;
attribute vec4 a_Color;
varying vec4 v_color;

uniform float u_opacity : 1;
uniform vec2 u_offsets;
uniform float u_stroke_width;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143
varying float v_blur;
varying float v_innerRadius;

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = a_Color;
  v_blur = 1.0 - max(2.0/a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

  vec2 textrueOffsets = vec2(0.0, 0.0);
  if(hasOffsets()) {
    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;

    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x
    textureOffset += 1.0;
  } else {
    textrueOffsets = u_offsets;
  }

  // cal style mapping
  
  vec2 offset = project_pixel(textrueOffsets);
  
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);
  } else { // else
    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);
    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));
  }

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function Fx(n){var l=n.coordinates;return{vertices:(0,me.Z)(l),indices:[0],size:l.length}}var fS=function(n){(0,Zt.Z)(a,n);var l=lS(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.offsets,E=m===void 0?[0,0]:m,A=o.blend,F=o.strokeOpacity,B=F===void 0?1:F,V=o.strokeWidth,j=V===void 0?0:V,at=o.stroke,ut=at===void 0?"#fff":at;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:E})){this.judgeStyleAttributes({opacity:v,offsets:E});var xt=this.layer.getEncodedData(),Nt=this.calDataFrame(this.cellLength,xt,this.cellProperties),de=Nt.data,fe=Nt.width,Ne=Nt.height;this.rowCount=Ne,this.dataTexture=this.cellLength>0&&de.length>0?this.createTexture2D({flipY:!0,data:de,format:Jt.LUMINANCE,type:Jt.FLOAT,width:fe,height:Ne}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_additive:A==="additive"?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:(0,ee.isNumber)(v)?v:1,u_offsets:this.isOffsetStatic(E)?E:[0,0],u_stroke_opacity:(0,ee.isNumber)(B)?B:1,u_stroke_width:(0,ee.isNumber)(j)?j:1,u_stroke_color:this.getStrokeColor(ut)}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,this.layer.triangulation=Fx,j.next=4,this.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:cS,fragmentShader:DI,triangulation:Fx,depth:{enable:!1},primitive:Jt.POINTS,blend:this.getBlend(),stencil:Rr(E,F)});case 4:return B=j.sent,j.abrupt("return",[B]);case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?1:v;return Array.isArray(m)?[m[0]]:[m]}}})}}]),a}(Ss);function BI(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=Rx(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function Rx(n,l){if(!!n){if(typeof n=="string")return Dx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Dx(n,l)}}function Dx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}var NI=function(){function n(l,a,s){(0,ct.Z)(this,n),(0,X.Z)(this,"boxCells",[]);var o=this.boxCells;this.xCellCount=Math.ceil(l/s),this.yCellCount=Math.ceil(a/s);for(var h=0;h<this.xCellCount*this.yCellCount;h++)o.push([]);this.boxKeys=[],this.bboxes=[],this.width=l,this.height=a,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/a,this.boxUid=0}return(0,et.Z)(n,[{key:"insert",value:function(a,s,o,h,v){this.forEachCell(s,o,h,v,this.insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(v)}},{key:"query",value:function(a,s,o,h,v){return this.queryHitTest(a,s,o,h,!1,v)}},{key:"hitTest",value:function(a,s,o,h,v){return this.queryHitTest(a,s,o,h,!0,v)}},{key:"insertBoxCell",value:function(a,s,o,h,v,m){this.boxCells[v].push(m)}},{key:"queryHitTest",value:function(a,s,o,h,v,m){if(o<0||a>this.width||h<0||s>this.height)return v?!1:[];var E=[];if(a<=0&&s<=0&&this.width<=o&&this.height<=h){if(v)return!0;for(var A=0;A<this.boxKeys.length;A++)E.push({key:this.boxKeys[A],x1:this.bboxes[A*4],y1:this.bboxes[A*4+1],x2:this.bboxes[A*4+2],y2:this.bboxes[A*4+3]});return m?E.filter(m):E}var F={hitTest:v,seenUids:{box:{},circle:{}}};return this.forEachCell(a,s,o,h,this.queryCell,E,F,m),v?E.length>0:E}},{key:"queryCell",value:function(a,s,o,h,v,m,E,A){var F=E.seenUids,B=this.boxCells[v];if(B!==null){var V=this.bboxes,j=BI(B),at;try{for(j.s();!(at=j.n()).done;){var ut=at.value;if(!F.box[ut]){F.box[ut]=!0;var xt=ut*4;if(a<=V[xt+2]&&s<=V[xt+3]&&o>=V[xt+0]&&h>=V[xt+1]&&(!A||A(this.boxKeys[ut]))){if(E.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[ut],x1:V[xt],y1:V[xt+1],x2:V[xt+2],y2:V[xt+3]})}}}}catch(Nt){j.e(Nt)}finally{j.f()}}return!1}},{key:"forEachCell",value:function(a,s,o,h,v,m,E,A){for(var F=this.convertToXCellCoord(a),B=this.convertToYCellCoord(s),V=this.convertToXCellCoord(o),j=this.convertToYCellCoord(h),at=F;at<=V;at++)for(var ut=B;ut<=j;ut++){var xt=this.xCellCount*ut+at;if(v.call(this,a,s,o,h,xt,m,E,A))return}}},{key:"convertToXCellCoord",value:function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}},{key:"convertToYCellCoord",value:function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}}]),n}(),hS=NI,pS=function(){function n(l,a){(0,ct.Z)(this,n),(0,X.Z)(this,"viewportPadding",100),this.width=l,this.height=a,this.viewportPadding=Math.max(l,a),this.grid=new hS(l+this.viewportPadding,a+this.viewportPadding,25),this.screenRightBoundary=l+this.viewportPadding,this.screenBottomBoundary=a+this.viewportPadding,this.gridRightBoundary=l+2*this.viewportPadding,this.gridBottomBoundary=a+2*this.viewportPadding}return(0,et.Z)(n,[{key:"placeCollisionBox",value:function(a){var s=a.x1+a.anchorPointX+this.viewportPadding,o=a.y1+a.anchorPointY+this.viewportPadding,h=a.x2+a.anchorPointX+this.viewportPadding,v=a.y2+a.anchorPointY+this.viewportPadding;return!this.isInsideGrid(s,o,h,v)||this.grid.hitTest(s,o,h,v)?{box:[]}:{box:[s,o,h,v]}}},{key:"insertCollisionBox",value:function(a,s){var o={featureIndex:s};this.grid.insert(o,a[0],a[1],a[2],a[3])}},{key:"project",value:function(a,s,o){var h=ni(s,o,0,1),v=mn(),m=Ri.apply(Lt,(0,me.Z)(a));return cu(v,h,m),{x:(v[0]/v[3]+1)/2*this.width+this.viewportPadding,y:(-v[1]/v[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(a,s,o,h){return o>=0&&a<this.gridRightBoundary&&h>=0&&s<this.gridBottomBoundary}}]),n}();function dS(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vS(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vS(n,l){if(!!n){if(typeof n=="string")return Bx(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Bx(n,l)}}function Bx(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function gS(n){var l=.5,a=.5;switch(n){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0;break;default:l=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0;break;default:a=.5}return{horizontalAlign:l,verticalAlign:a}}function mS(n,l,a,s,o){if(!!o){var h=n[s],v=h.glyph;if(v)for(var m=l[v].advance*h.scale,E=(n[s].x+m)*o,A=a;A<=s;A++)n[A].x-=E}}function Xv(n,l,a,s,o,h,v){var m=(l-a)*o,E=(-s*v+.5)*h,A=dS(n),F;try{for(A.s();!(F=A.n()).done;){var B=F.value;B.x+=m,B.y+=E}}catch(V){A.e(V)}finally{A.f()}}function zI(n,l,a,s,o,h,v){var m=-8,E=0,A=m,F=0,B=n.positionedGlyphs,V=h==="right"?1:h==="left"?0:.5,j=B.length;a.forEach(function(de){if(de.split("").forEach(function(Ne){var Ye=l[Ne],_r=0;Ye&&(B.push({glyph:Ne,x:E,y:A+_r,vertical:!1,scale:1,metrics:Ye}),E+=Ye.advance+v)}),B.length!==j){var fe=E-v;F=Math.max(fe,F),mS(B,l,j,B.length-1,V)}E=0,A-=s+5});var at=gS(o),ut=at.horizontalAlign,xt=at.verticalAlign;Xv(B,V,ut,xt,F,s,a.length);var Nt=A-m;n.top+=-xt*Nt,n.bottom=n.top-Nt,n.left+=-ut*F,n.right=n.left+F}function UI(n,l,a,s,o,h,v){var m=-8,E=0,A=m,F=0,B=n.positionedGlyphs,V=h==="right"?1:h==="left"?0:.5,j=B.length;a.forEach(function(de){var fe=l[de],Ne=0;if(fe&&(B.push({glyph:de,x:fe.advance/2,y:A+Ne,vertical:!1,scale:1,metrics:fe}),E+=fe.advance+v),B.length!==j){var Ye=E-v;F=Math.max(Ye,F),mS(B,l,j,B.length-1,V)}E=0,A-=s+5});var at=gS(o),ut=at.horizontalAlign,xt=at.verticalAlign;Xv(B,V,ut,xt,F,s,a.length);var Nt=A-m;n.top+=-xt*Nt,n.bottom=n.top-Nt,n.left+=-ut*F,n.right=n.left+F}function yS(n,l,a,s,o,h){var v=arguments.length>6&&arguments[6]!==void 0?arguments[6]:[0,0],m=arguments.length>7?arguments[7]:void 0,E=n.split(`
`),A=[],F={positionedGlyphs:A,top:v[1],bottom:v[1],left:v[0],right:v[0],lineCount:E.length,text:n};return m?UI(F,l,E,a,s,o,h):zI(F,l,E,a,s,o,h),A.length?F:!1}function _S(n){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0],a=arguments.length>2?arguments[2]:void 0,s=n.positionedGlyphs,o=s===void 0?[]:s,h=[],v=dS(o),m;try{for(v.s();!(m=v.n()).done;){var E=m.value,A=E.metrics,F=4,B=A.advance*E.scale/2,V=a?[E.x+B,E.y]:[0,0],j=a?[0,0]:[E.x+B+l[0],E.y+l[1]],at=(0-F)*E.scale-B+j[0],ut=(0-F)*E.scale+j[1],xt=at+A.width*E.scale,Nt=ut+A.height*E.scale,de={x:at,y:ut},fe={x:xt,y:ut},Ne={x:at,y:Nt},Ye={x:xt,y:Nt};h.push({tl:de,tr:fe,bl:Ne,br:Ye,tex:A,glyphOffset:V})}}catch(_r){v.e(_r)}finally{v.f()}return h}function ZI(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=xS(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function xS(n,l){if(!!n){if(typeof n=="string")return bS(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bS(n,l)}}function bS(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function Vy(n){var l=VI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function VI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ES=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
void main() {
  // get style data mapping
  float opacity = styleMappingMat[0][0];
  float strokeWidth = styleMappingMat[0][2];
  vec4 textrueStroke = vec4(
    styleMappingMat[1][0],
    styleMappingMat[1][1],
    styleMappingMat[1][2],
    styleMappingMat[1][3]
  );

  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  // float fontScale = u_font_size / FONT_SIZE;

  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,wS=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;
attribute float a_Rotate;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_raisingHeight: 0.0;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"
#pragma include "styleMappingCalStrokeWidth"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
   styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;

   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][2] = strokeWidthAndOffset.r;
  textureOffset = strokeWidthAndOffset.g;

  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);
  if(hasStroke()) {
    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R
    textureOffset += 1.0;

    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G
    textureOffset += 1.0;

    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B
    textureOffset += 1.0;

    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);
    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A
    textureOffset += 1.0;
  } else {
    if(u_stroke_color == vec4(0.0)) {
      styleMappingMat[1][0] = v_color.r;
      styleMappingMat[1][1] = v_color.g;
      styleMappingMat[1][2] = v_color.b;
      styleMappingMat[1][3] = v_color.a;
    } else {
      styleMappingMat[1][0] = u_stroke_color.r;
      styleMappingMat[1][1] = u_stroke_color.g;
      styleMappingMat[1][2] = u_stroke_color.b;
      styleMappingMat[1][3] = u_stroke_color.a;
    }
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  highp float angle_sin = sin(a_Rotate);
  highp float angle_cos = cos(a_Rotate);
  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);
  
  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`;function SS(n){var l=this,a=n.id,s=[],o=[];if(!l.glyphInfoMap||!l.glyphInfoMap[a])return{vertices:[],indices:[],size:7};var h=l.glyphInfoMap[a].centroid,v=h.length===2?[h[0],h[1],0]:h;return l.glyphInfoMap[a].glyphQuads.forEach(function(m,E){s.push.apply(s,(0,me.Z)(v).concat([m.tex.x,m.tex.y+m.tex.height,m.tl.x,m.tl.y],(0,me.Z)(v),[m.tex.x+m.tex.width,m.tex.y+m.tex.height,m.tr.x,m.tr.y],(0,me.Z)(v),[m.tex.x+m.tex.width,m.tex.y,m.br.x,m.br.y],(0,me.Z)(v),[m.tex.x,m.tex.y,m.bl.x,m.bl.y])),o.push(0+E*4,1+E*4,2+E*4,2+E*4,3+E*4,0+E*4)}),{vertices:s,indices:o,size:7}}var CS=function(n){(0,Zt.Z)(a,n);var l=Vy(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"glyphInfoMap",{}),(0,X.Z)((0,st.Z)(s),"currentZoom",-1),(0,X.Z)((0,st.Z)(s),"textureHeight",0),(0,X.Z)((0,st.Z)(s),"textCount",0),(0,X.Z)((0,st.Z)(s),"preTextStyle",{}),(0,X.Z)((0,st.Z)(s),"mapping",(0,lt.Z)(it().mark(function m(){return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return s.initGlyph(),s.updateTexture(),A.next=4,s.reBuildModel();case 4:case"end":return A.stop()}},m)}))),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.stroke,E=m===void 0?"#fff":m,A=o.strokeWidth,F=A===void 0?0:A,B=o.textAnchor,V=B===void 0?"center":B,j=o.textOffset,at=o.textAllowOverlap,ut=at===void 0?!1:at,xt=o.halo,Nt=xt===void 0?.5:xt,de=o.gamma,fe=de===void 0?2:de,Ne=o.raisingHeight,Ye=Ne===void 0?0:Ne,_r=this.fontService,Ir=_r.canvas,Nr=_r.mapping;if(Nr&&Object.keys(Nr).length!==this.textCount&&Ir&&(this.updateTexture(),this.textCount=Object.keys(Nr).length),this.preTextStyle={textAnchor:V,textAllowOverlap:ut,textOffset:j},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,strokeWidth:F,stroke:E})){this.judgeStyleAttributes({opacity:v,strokeWidth:F,stroke:E});var Yr=this.layer.getEncodedData(),yn=this.calDataFrame(this.cellLength,Yr,this.cellProperties),fn=yn.data,$n=yn.width,di=yn.height;this.rowCount=di,this.dataTexture=this.cellLength>0&&fn.length>0?this.createTexture2D({flipY:!0,data:fn,format:Jt.LUMINANCE,type:Jt.FLOAT,width:$n,height:di}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(Ye),u_opacity:(0,ee.isNumber)(v)?v:1,u_stroke_width:(0,ee.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(E),u_sdf_map:this.texture,u_halo_blur:Nt,u_gamma_scale:fe,u_sdf_map_size:[(Ir==null?void 0:Ir.width)||1,(Ir==null?void 0:Ir.height)||1]}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return this.bindEvent(),this.extent=this.textExtent(),v=this.layer.getLayerConfig(),m=v.textAnchor,E=m===void 0?"center":m,A=v.textAllowOverlap,F=A===void 0?!0:A,B=v.textOffset,this.preTextStyle={textAnchor:E,textAllowOverlap:F,textOffset:B},j.next=6,this.buildModels();case 6:return j.abrupt("return",j.sent);case 7:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j;return it().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.textAllowOverlap,V=B===void 0?!1:B,this.initGlyph(),this.updateTexture(),V||this.filterGlyphs(),ut.next=6,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:wS,fragmentShader:ES,triangulation:SS.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 6:return j=ut.sent,ut.abrupt("return",[j]);case 8:case"end":return ut.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"needUpdate",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut;return it().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:if(v=this.layer.getLayerConfig(),m=v.textAllowOverlap,E=m===void 0?!1:m,A=v.textAnchor,F=A===void 0?"center":A,B=v.textOffset,V=this.layer.getEncodedData(),!(JSON.stringify(B)!==JSON.stringify(this.preTextStyle.textOffset)||F!==this.preTextStyle.textAnchor)){Nt.next=6;break}return Nt.next=5,this.mapping();case 5:return Nt.abrupt("return",!0);case 6:if(!(V.length<5||E)){Nt.next=8;break}return Nt.abrupt("return",!1);case 8:if(j=this.mapService.getZoom(),at=this.mapService.getBounds(),ut=wu(this.extent,at),!(Math.abs(this.currentZoom-j)>1||!ut||E!==this.preTextStyle.textAllowOverlap)){Nt.next=15;break}return Nt.next=14,this.reBuildModel();case 14:return Nt.abrupt("return",!0);case 15:return Nt.abrupt("return",!1);case 16:case"end":return Nt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.dataTexture)===null||h===void 0||h.destroy(),this.layer.off("remapping",this.mapping)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Vi.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h){var v=h.rotate,m=v===void 0?0:v;return Array.isArray(m)?[m[0]]:[m]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Vi.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m){return[m[5],m[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(h){var v=h.size,m=v===void 0?12:v;return Array.isArray(m)?[m[0]]:[m]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Vi.Attribute,descriptor:{name:"a_tex",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}},{key:"bindEvent",value:function(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}},{key:"textExtent",value:function(){var o=this.mapService.getBounds();return Nl(o,.5)}},{key:"initTextFont",value:function(){var o=this.layer.getLayerConfig(),h=o.fontWeight,v=h===void 0?"400":h,m=o.fontFamily,E=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),F=[];A.forEach(function(B){var V=B.shape,j=V===void 0?"":V;j=j.toString();var at=ZI(j),ut;try{for(at.s();!(ut=at.n()).done;){var xt=ut.value;F.indexOf(xt)===-1&&F.push(xt)}}catch(Nt){at.e(Nt)}finally{at.f()}}),this.fontService.setFontOptions({characterSet:F,fontWeight:v,fontFamily:E,iconfont:!1})}},{key:"initIconFontTex",value:function(){var o=this.layer.getLayerConfig(),h=o.fontWeight,v=h===void 0?"400":h,m=o.fontFamily,E=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),F=[];A.forEach(function(B){var V=B.shape,j=V===void 0?"":V;j="".concat(j),F.indexOf(j)===-1&&F.push(j)}),this.fontService.setFontOptions({characterSet:F,fontWeight:v,fontFamily:E,iconfont:!0})}},{key:"generateGlyphLayout",value:function(o){var h=this,v=this.fontService.mapping,m=this.layer.getLayerConfig(),E=m.spacing,A=E===void 0?2:E,F=m.textAnchor,B=F===void 0?"center":F,V=m.textOffset,j=this.layer.getEncodedData();this.glyphInfo=j.map(function(at){var ut=at.shape,xt=ut===void 0?"":ut,Nt=at.id,de=at.size,fe=de===void 0?1:de,Ne=yS(xt.toString(),v,fe,B,"left",A,V||at.textOffset||[0,0],o),Ye=_S(Ne,V,!1);return at.shaping=Ne,at.glyphQuads=Ye,at.centroid=bs(at.coordinates),at.originCentroid=at.version==="GAODE2.x"?bs(at.originCoordinates):at.originCentroid=at.centroid,h.glyphInfoMap[Nt]={shaping:Ne,glyphQuads:Ye,centroid:bs(at.coordinates)},at})}},{key:"filterGlyphs",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.padding,m=v===void 0?[0,0]:v,E=h.textAllowOverlap,A=E===void 0?!1:E;if(!A){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var F=this.rendererService.getViewportSize(),B=F.width,V=F.height,j=new pS(B,V),at=this.glyphInfo.filter(function(ut){var xt=ut.shaping,Nt=ut.id,de=Nt===void 0?0:Nt,fe=ut.version==="GAODE2.x"?ut.originCentroid:ut.centroid,Ne=ut.size,Ye=Ne/16,_r=o.mapService.lngLatToContainer(fe),Ir=j.placeCollisionBox({x1:xt.left*Ye-m[0],x2:xt.right*Ye+m[0],y1:xt.top*Ye-m[1],y2:xt.bottom*Ye+m[1],anchorPointX:_r.x,anchorPointY:_r.y}),Nr=Ir.box;return Nr&&Nr.length?(j.insertCollisionBox(Nr,de),!0):!1});at.forEach(function(ut){o.glyphInfoMap[ut.id]=ut})}}},{key:"initGlyph",value:function(){var o=this.layer.getLayerConfig(),h=o.iconfont,v=h===void 0?!1:h;v?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(v)}},{key:"updateTexture",value:function(){var o=this.rendererService.createTexture2D,h=this.fontService.canvas;this.textureHeight=h.height,this.texture&&this.texture.destroy(),this.texture=o({data:h,mag:Jt.LINEAR,min:Jt.LINEAR,width:h.width,height:h.height})}},{key:"reBuildModel",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,this.filterGlyphs(),j.next=4,this.layer.buildLayerModel({moduleName:"pointText",vertexShader:wS,fragmentShader:ES,triangulation:SS.bind(this),depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 4:B=j.sent,this.layer.models=[B];case 6:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()}]),a}(Ss);function GI(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=AS(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function AS(n,l){if(!!n){if(typeof n=="string")return TS(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return TS(n,l)}}function TS(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function HI(n){var l=pm();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function pm(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dm=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;
// uniform float u_font_size : 24.0;
uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec4 v_color;
varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "picking"
void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Nx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;
attribute vec4 a_Color;
attribute float a_Size;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;
varying float v_gamma_scale;
varying vec4 v_color;
varying float v_fontScale;

uniform float u_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,zx=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0
uniform sampler2D u_sdf_map;
uniform float u_gamma_scale : 0.5;

uniform float u_opacity : 1.0;
uniform vec4 u_stroke_color : [0, 0, 0, 1];
uniform float u_stroke_width : 2.0;
uniform float u_halo_blur : 0.5;
uniform float u_DevicePixelRatio;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;
uniform vec4 u_color;

void main() {
  // get sdf from atlas
  float dist = texture2D(u_sdf_map, v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);
  
  gl_FragColor = mix(vec4(u_color.rgb, u_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));
  gl_FragColor.a= gl_FragColor.a * alpha;
}
`,MS=`#define FONT_SIZE 24.0
attribute vec3 a_Position;
attribute vec2 a_tex;
attribute vec2 a_textOffsets;

uniform vec2 u_sdf_map_size;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_size;

varying vec2 v_uv;
varying float v_gamma_scale;
varying float v_fontScale;

#pragma include "projection"

void main() {
  v_uv = a_tex / u_sdf_map_size;

  // \u6587\u672C\u7F29\u653E\u6BD4\u4F8B
  float fontScale = u_size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  vec4 projected_position;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));
  } else { // else
   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  gl_Position = vec4(
    projected_position.xy / projected_position.w + a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;

}
`;function IS(n){var l=this,a=n.id,s=[],o=[];if(!l.glyphInfoMap||!l.glyphInfoMap[a])return{vertices:[],indices:[],size:7};var h=l.glyphInfoMap[a].centroid,v=h.length===2?[h[0],h[1],0]:h;return l.glyphInfoMap[a].glyphQuads.forEach(function(m,E){s.push.apply(s,(0,me.Z)(v).concat([m.tex.x,m.tex.y+m.tex.height,m.tl.x,m.tl.y],(0,me.Z)(v),[m.tex.x+m.tex.width,m.tex.y+m.tex.height,m.tr.x,m.tr.y],(0,me.Z)(v),[m.tex.x+m.tex.width,m.tex.y,m.br.x,m.br.y],(0,me.Z)(v),[m.tex.x,m.tex.y,m.bl.x,m.bl.y])),o.push(0+E*4,1+E*4,2+E*4,2+E*4,3+E*4,0+E*4)}),{vertices:s,indices:o,size:7}}var kS=function(n){(0,Zt.Z)(a,n);var l=HI(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"glyphInfoMap",{}),(0,X.Z)((0,st.Z)(s),"currentZoom",-1),(0,X.Z)((0,st.Z)(s),"textureHeight",0),(0,X.Z)((0,st.Z)(s),"textCount",0),(0,X.Z)((0,st.Z)(s),"preTextStyle",{}),(0,X.Z)((0,st.Z)(s),"mapping",function(){s.initGlyph(),s.updateTexture(),s.filterGlyphs(),s.reBuildModel()}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.stroke,E=m===void 0?"#fff":m,A=o.strokeWidth,F=A===void 0?0:A,B=o.textAnchor,V=B===void 0?"center":B,j=o.textAllowOverlap,at=j===void 0?!1:j,ut=o.halo,xt=ut===void 0?.5:ut,Nt=o.gamma,de=Nt===void 0?2:Nt,fe=o.usage,Ne=o.color,Ye=Ne===void 0?"#fff":Ne,_r=o.size,Ir=_r===void 0?1:_r,Nr=this.fontService,Yr=Nr.canvas,yn=Nr.mapping;return Object.keys(yn).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(yn).length),this.preTextStyle={textAnchor:V,textAllowOverlap:at},{u_opacity:(0,ee.isNumber)(v)?v:1,u_stroke_width:(0,ee.isNumber)(F)?F:1,u_stroke_color:this.getStrokeColor(E),u_sdf_map:this.texture,u_halo_blur:xt,u_gamma_scale:de,u_sdf_map_size:[Yr.width,Yr.height],u_color:fe==="basemap"?Le(Ye):[0,0,0,0],u_size:fe==="basemap"?Ir:1}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this.extent=this.textExtent(),v=this.layer.getLayerConfig(),m=v.textAnchor,E=m===void 0?"center":m,A=v.textAllowOverlap,F=A===void 0?!0:A,this.preTextStyle={textAnchor:E,textAllowOverlap:F},V.next=5,this.buildModels();case 5:return V.abrupt("return",V.sent);case 6:case"end":return V.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return this.mapping(),v=this.layer.getLayerConfig(),m=v.usage,F.next=4,this.layer.buildLayerModel({moduleName:"pointTileText_"+m,vertexShader:m==="basemap"?MS:Nx,fragmentShader:m==="basemap"?zx:dm,triangulation:IS.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:m!=="basemap"});case 4:return E=F.sent,F.abrupt("return",[E]);case 6:case"end":return F.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig(),h=o.usage;this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Vi.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(m,E,A){return[A[5],A[6]]}}}),h!=="basemap"&&this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(m){var E=m.size,A=E===void 0?12:E;return Array.isArray(A)?[A[0]]:[A]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Vi.Attribute,descriptor:{name:"a_tex",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(m,E,A){return[A[3],A[4]]}}})}},{key:"textExtent",value:function(){var o=this.mapService.getBounds();return Nl(o,.5)}},{key:"initTextFont",value:function(){var o=this.layer.getLayerConfig(),h=o.fontWeight,v=h===void 0?"400":h,m=o.fontFamily,E=m===void 0?"sans-serif":m,A=this.layer.getEncodedData(),F=[];A.forEach(function(B){var V=B.shape,j=V===void 0?"":V;j=j.toString();var at=GI(j),ut;try{for(at.s();!(ut=at.n()).done;){var xt=ut.value;F.indexOf(xt)===-1&&F.push(xt)}}catch(Nt){at.e(Nt)}finally{at.f()}}),this.fontService.setFontOptions({characterSet:F,fontWeight:v,fontFamily:E,iconfont:!1})}},{key:"generateGlyphLayout",value:function(){var o=this,h=this.fontService.mapping,v=this.layer.getLayerConfig(),m=v.spacing,E=m===void 0?2:m,A=v.textAnchor,F=A===void 0?"center":A,B=this.layer.getEncodedData();this.glyphInfo=B.map(function(V){var j=V.shape,at=j===void 0?"":j,ut=V.id,xt=V.size,Nt=xt===void 0?1:xt,de=V.textOffset,fe=de===void 0?[0,0]:de,Ne=yS(at.toString(),h,Nt,F,"left",E,fe,!1),Ye=_S(Ne,fe,!1);return V.shaping=Ne,V.glyphQuads=Ye,V.centroid=bs(V.coordinates),V.originCentroid=V.version==="GAODE2.x"?bs(V.originCoordinates):V.originCentroid=V.centroid,o.glyphInfoMap[ut]={shaping:Ne,glyphQuads:Ye,centroid:bs(V.coordinates)},V})}},{key:"filterGlyphs",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.padding,m=v===void 0?[4,4]:v,E=h.textAllowOverlap,A=E===void 0?!1:E;if(!A){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var F=this.rendererService.getViewportSize(),B=F.width,V=F.height,j=new pS(B,V),at=this.glyphInfo.filter(function(ut){var xt=ut.shaping,Nt=ut.id,de=Nt===void 0?0:Nt,fe=ut.version==="GAODE2.x"?ut.originCentroid:ut.centroid,Ne=ut.size,Ye=Ne/24,_r=o.mapService.lngLatToContainer(fe),Ir=j.placeCollisionBox({x1:xt.left*Ye-m[0],x2:xt.right*Ye+m[0],y1:xt.top*Ye-m[1],y2:xt.bottom*Ye+m[1],anchorPointX:_r.x,anchorPointY:_r.y}),Nr=Ir.box;return Nr&&Nr.length?(j.insertCollisionBox(Nr,de),!0):!1});at.forEach(function(ut){o.glyphInfoMap[ut.id]=ut})}}},{key:"initGlyph",value:function(){this.initTextFont(),this.generateGlyphLayout()}},{key:"updateTexture",value:function(){var o=this.rendererService.createTexture2D,h=this.fontService.canvas;this.textureHeight=h.height,this.texture&&this.texture.destroy(),this.texture=o({data:h,mag:Jt.LINEAR,min:Jt.LINEAR,width:h.width,height:h.height})}},{key:"reBuildModel",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return v=this.layer.getLayerConfig(),m=v.usage,this.filterGlyphs(),F.next=4,this.layer.buildLayerModel({moduleName:"pointTileText_"+m,vertexShader:m==="basemap"?MS:Nx,fragmentShader:m==="basemap"?zx:dm,triangulation:IS.bind(this),depth:{enable:!1},blend:this.getBlend(),pick:m!=="basemap"});case 4:return E=F.sent,F.abrupt("return",[E]);case 6:case"end":return F.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()}]),a}(Ss);function jI(n){var l=WI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function WI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var XI=`uniform float u_additive;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  int shape = int(floor(v_data.w + 0.5));


  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }


  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    gl_FragColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), u_stroke_color * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    gl_FragColor *= opacity_t;
    gl_FragColor = filterColorAlpha(gl_FragColor, gl_FragColor.a);
  } else {
    gl_FragColor.a *= opacity_t;
    gl_FragColor = filterColor(gl_FragColor);
  }
}
`,YI=`attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Extrude;
attribute float a_Size;
attribute float a_Shape;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_data;
varying vec4 v_color;
varying float v_radius;

uniform float u_opacity : 1;
uniform float u_stroke_opacity : 1;
uniform float u_stroke_width : 2;
uniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];

#pragma include "projection"
#pragma include "picking"

void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  float newSize = setPickingSize(a_Size);

  // cal style mapping

  v_color = a_Color;
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, 0.0);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width));
  offset = project_pixel(offset);

  v_data = vec4(extrude.x, extrude.y, antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
  }

// if(u_coord > 0.0) {
  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));
  }
// } else {

  // vec2 pointPos = a_Position.xy;
  // vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  // vec2 pointOffset =  pointPos *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
  
  // world.xy += offset;
  // world.xy += pointOffset;

  // if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //   // Needs to be divided with project_uCommonUnitsPerMeter
  //   world.w *= u_PixelsPerMeter.z;
  // }

  // gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
// }

 
  setPickingColor(a_PickingColor);


}
`,$I=function(n){(0,Zt.Z)(a,n);var l=jI(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.strokeOpacity,E=m===void 0?1:m,A=o.strokeWidth,F=A===void 0?0:A,B=o.stroke,V=B===void 0?"rgba(0,0,0,0)":B,j=o.blend;return{u_additive:j==="additive"?1:0,u_opacity:Number(v),u_stroke_opacity:Number(E),u_stroke_width:Number(F),u_stroke_color:this.getStrokeColor(V)}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),A0)}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return v=this.layer.getLayerConfig(),m=v.workerEnabled,E=m===void 0?!1:m,A=v.usage,this.layer.triangulation=A0,V.next=4,this.layer.buildLayerModel({moduleName:"pointTile_"+A,vertexShader:YI,fragmentShader:XI,triangulation:A0,depth:{enable:!1},cull:{enable:!0,face:ec(this.mapService.version)},blend:this.getBlend(),workerEnabled:E,workerOptions:{modelType:"pointTile"},pick:A!=="basemap"});case 4:return F=V.sent,V.abrupt("return",[F]);case 6:case"end":return V.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){var o=this;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Vi.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(v,m,E,A){var F=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],B=A%4*3;return[F[B],F[B+1],F[B+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.size,E=m===void 0?5:m;return Array.isArray(E)?[E[0]]:[E]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Vi.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(v){var m=v.shape,E=m===void 0?2:m,A=o.layer.getLayerConfig().shape2d,F=A.indexOf(E);return[F]}}})}}]),a}(Ss),LS={fillImage:CI,fill:rS,radar:uS,image:aS,normal:hm,simplePoint:fS,extrude:Lx,text:CS,tile:$I,tileText:kS,earthFill:yI,earthExtrude:Kw},qI=LS;function I0(n,l){var a=typeof Symbol!="undefined"&&n[Symbol.iterator]||n["@@iterator"];if(!a){if(Array.isArray(n)||(a=vm(n))||l&&n&&typeof n.length=="number"){a&&(n=a);var s=0,o=function(){};return{s:o,n:function(){return s>=n.length?{done:!0}:{done:!1,value:n[s++]}},e:function(A){throw A},f:o}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var h=!0,v=!1,m;return{s:function(){a=a.call(n)},n:function(){var A=a.next();return h=A.done,A},e:function(A){v=!0,m=A},f:function(){try{!h&&a.return!=null&&a.return()}finally{if(v)throw m}}}}function vm(n,l){if(!!n){if(typeof n=="string")return k0(n,l);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k0(n,l)}}function k0(n,l){(l==null||l>n.length)&&(l=n.length);for(var a=0,s=new Array(l);a<l;a++)s[a]=n[a];return s}function PS(n){var l=KI();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function KI(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Gy=function(n){(0,Zt.Z)(a,n);var l=PS(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"type","PointLayer"),(0,X.Z)((0,st.Z)(s),"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}}),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel&&this.layerModel.clearModels(),this.layerModel=new qI[v](this),E.next=5,this.initLayerModels();case 5:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"rebuildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getModelTypeWillEmptyData",value:function(){if(this.shapeOption){var o=this.shapeOption,h=o.field,v=o.values,m=this.getLayerConfig(),E=m.shape2d,A=this.iconService.getIconMap();if(h&&(E==null?void 0:E.indexOf(h))!==-1)return"fill";if(v==="text")return"text";if(v&&v instanceof Array){var F=I0(v),B;try{for(F.s();!(B=F.n()).done;){var V=B.value;if(typeof V=="string"&&A.hasOwnProperty(V))return"image"}}catch(j){F.e(j)}finally{F.f()}}}return"normal"}},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}};return h[o]}},{key:"getModelType",value:function(){var o=this.getEncodedData(),h=this.getLayerConfig(),v=h.shape2d,m=h.shape3d,E=this.iconService.getIconMap(),A=o.find(function(B){return B.hasOwnProperty("shape")});if(A){var F=A.shape;return F==="dot"?"normal":F==="simple"?"simplePoint":F==="radar"?"radar":this.layerType==="fillImage"?"fillImage":(v==null?void 0:v.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":(m==null?void 0:m.indexOf(F))!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":E.hasOwnProperty(F)?"image":"text"}else return this.getModelTypeWillEmptyData()}}]),a}(dg);function Sg(n){var l=OS();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function OS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var QI=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];  
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }

  } else {
     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,JI=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,tk=`uniform sampler2D u_texture;
uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float lightWeight = styleMappingMat[3][1];
  float topU = styleMappingMat[2][2];
  float topV = styleMappingMat[2][3];

  float sidey = styleMappingMat[3][0];
  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }

    if(u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      gl_FragColor = v_Color;
    }
  } else {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    gl_FragColor = texture2D(u_texture, vec2(topU, topV));
  }
  

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,FS=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_Color = a_Color;

  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - a_Position.z(judge side by a_Position.z)
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1] - u - v
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[2][2] = a_uvs[0];
  styleMappingMat[2][3] = 1.0 - a_uvs[1];
  styleMappingMat[3][0] = a_uvs[2];


  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // project_pos.z += 500000.0; // amap1

  // project_pos.z += (500000.0 * 4.0)/pow(2.0, 21.0 - u_Zoom); // mapbox
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,ek=`uniform float u_opacity: 1.0;
uniform vec4 u_sourceColor;
uniform vec4 u_targetColor;
uniform float u_linearColor: 0;

uniform float u_topsurface: 1.0;
uniform float u_sidesurface: 1.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E
#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  float isSide = styleMappingMat[0][3];
  float sidey = styleMappingMat[3][0];
  float lightWeight = styleMappingMat[3][1];

  // Tip: \u90E8\u5206\u673A\u578B GPU \u8BA1\u7B97\u7CBE\u5EA6\u517C\u5BB9
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      gl_FragColor = linearColor;
    } else {
      // side notuse linear
       gl_FragColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    gl_FragColor = v_Color;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColorAlpha(gl_FragColor, lightWeight);
}
`,rk=`precision highp float;

#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

attribute vec4 a_Color;
attribute vec3 a_Position;
attribute vec3 a_Normal;
attribute float a_Size;
attribute vec3 a_uvs;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
uniform float u_heightfixed: 0.0; // \u9ED8\u8BA4\u4E0D\u56FA\u5B9A
uniform float u_raisingHeight: 0.0;
uniform float u_opacity: 1.0;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - isSide
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0  // sidey
  );
  styleMappingMat[0][3] = a_Position.z;
  styleMappingMat[3][0] = a_uvs[2];

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos);

  if(u_heightfixed > 0.0) { // \u5224\u65AD\u51E0\u4F55\u4F53\u662F\u5426\u56FA\u5B9A\u9AD8\u5EA6
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  float lightWeight = calc_lighting(pos);
  // v_Color = a_Color;
  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);

  styleMappingMat[3][1] = lightWeight;

  setPickingColor(a_PickingColor);
}
`,nk=function(n){(0,Zt.Z)(a,n);var l=Sg(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.heightfixed,E=m===void 0?!1:m,A=o.raisingHeight,F=A===void 0?0:A,B=o.topsurface,V=B===void 0?!0:B,j=o.sidesurface,at=j===void 0?!0:j,ut=o.sourceColor,xt=o.targetColor;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Nt=this.layer.getEncodedData(),de=this.calDataFrame(this.cellLength,Nt,this.cellProperties),fe=de.data,Ne=de.width,Ye=de.height;this.rowCount=Ye,this.dataTexture=this.cellLength>0&&fe.length>0?this.createTexture2D({flipY:!0,data:fe,format:Jt.LUMINANCE,type:Jt.FLOAT,width:Ne,height:Ye}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}var _r=0,Ir=[1,1,1,1],Nr=[1,1,1,1];return ut&&xt&&(Ir=Le(ut),Nr=Le(xt),_r=1),{u_topsurface:Number(V),u_sidesurface:Number(at),u_heightfixed:Number(E),u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(F),u_opacity:(0,ee.isNumber)(v)?v:1,u_linearColor:_r,u_sourceColor:Ir,u_targetColor:Nr,u_texture:this.texture}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut;return it().wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.getShaders(),V=B.frag,j=B.vert,at=B.type,Nt.next=4,this.layer.buildLayerModel({moduleName:at,vertexShader:j,fragmentShader:V,triangulation:b5,stencil:Rr(E,F)});case 4:return ut=Nt.sent,Nt.abrupt("return",[ut]);case 6:case"end":return Nt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getShaders",value:function(){var o=this.layer.getLayerConfig(),h=o.pickLight,v=o.mapTexture;return v?{frag:tk,vert:FS,type:"polygonExtrudeTexture"}:h?{frag:ek,vert:rk,type:"polygonExtrudePickLight"}:{frag:QI,vert:JI,type:"polygonExtrude"}}},{key:"clearModels",value:function(){var o,h;(o=this.dataTexture)===null||o===void 0||o.destroy(),(h=this.texture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getSource().extent,h=(0,ht.Z)(o,4),v=h[0],m=h[1],E=h[2],A=h[3],F=E-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Vi.Attribute,descriptor:{name:"a_uvs",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(j,at,ut){var xt=ut[0],Nt=ut[1];return[(xt-v)/F,(Nt-m)/B,ut[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Vi.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(j,at,ut,xt,Nt){return Nt}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Vi.Attribute,descriptor:{name:"a_Size",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(j){var at=j.size,ut=at===void 0?10:at;return Array.isArray(ut)?[ut[0]]:[ut]}}})}},{key:"loadTexture",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.mapTexture,m=this.rendererService.createTexture2D;if(this.texture=m({height:0,width:0}),v){var E=new Image;E.crossOrigin="",E.src=v,E.onload=function(){o.texture=m({data:E,width:E.width,height:E.height,wrapS:Jt.CLAMP_TO_EDGE,wrapT:Jt.CLAMP_TO_EDGE,min:Jt.LINEAR,mag:Jt.LINEAR}),o.layerService.reRender()}}}}]),a}(Ss);function ik(n){var l=RS();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function RS(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var ak=`uniform float u_opacity: 1.0;
varying vec4 v_color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"

void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_color;
  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,ok=`uniform float u_opacity: 1.0;
varying vec4 v_Color;
varying mat4 styleMappingMat; // \u4F20\u9012\u4ECE\u7247\u5143\u4E2D\u4F20\u9012\u7684\u6620\u5C04\u6570\u636E

#pragma include "picking"
uniform float u_opacitylinear: 0.0;
uniform float u_dir: 1.0;
varying vec3 v_linear;
varying vec2 v_pos;


void main() {
  float opacity = styleMappingMat[0][0];
  gl_FragColor = v_Color;
  
  if(u_opacitylinear > 0.0) {
    gl_FragColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }

  gl_FragColor.a *= opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,sk=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_Color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

uniform float u_opacitylinear: 0.0;

attribute vec3 a_linear;
varying vec3 v_linear;
varying vec2 v_pos;

void main() {
  if(u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}`,uk=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

uniform float u_opacity: 1.0;
uniform float u_raisingHeight: 0.0;

varying vec4 v_color;
varying mat4 styleMappingMat; // \u7528\u4E8E\u5C06\u5728\u9876\u70B9\u7740\u8272\u5668\u4E2D\u8BA1\u7B97\u597D\u7684\u6837\u5F0F\u503C\u4F20\u9012\u7ED9\u7247\u5143

#pragma include "styleMapping"
#pragma include "styleMappingCalOpacity"

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97
styleMappingMat = mat4(
    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty
    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA
    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]
    0.0, 0.0, 0.0, 0.0
  );

  float rowCount = u_cellTypeLayout[0][0];    // \u5F53\u524D\u7684\u6570\u636E\u7EB9\u7406\u6709\u51E0\u884C
  float columnCount = u_cellTypeLayout[0][1]; // \u5F53\u770B\u5230\u6570\u636E\u7EB9\u7406\u6709\u51E0\u5217
  float columnWidth = 1.0/columnCount;  // \u5217\u5BBD
  float rowHeight = 1.0/rowCount;       // \u884C\u9AD8
  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets
  float id = a_vertexId; // \u7B2Cn\u4E2A\u9876\u70B9
  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u884C
  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8D77\u59CB\u70B9\u5728\u7B2C\u51E0\u5217
  
  // cell \u56FA\u5B9A\u987A\u5E8F opacity -> strokeOpacity -> strokeWidth -> stroke ... 
  // \u6309\u987A\u5E8F\u4ECE cell \u4E2D\u53D6\u503C\u3001\u82E5\u6CA1\u6709\u5219\u81EA\u52A8\u5F80\u4E0B\u53D6\u503C
  float textureOffset = 0.0; // \u5728 cell \u4E2D\u53D6\u503C\u7684\u504F\u79FB\u91CF

  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);
  styleMappingMat[0][0] = opacityAndOffset.r;
  textureOffset = opacityAndOffset.g;
  // cal style mapping - \u6570\u636E\u7EB9\u7406\u6620\u5C04\u90E8\u5206\u7684\u8BA1\u7B97

  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  project_pos.z += u_raisingHeight;

  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }

  setPickingColor(a_PickingColor);
}

`,Ux=function(n){(0,Zt.Z)(a,n);var l=ik(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.raisingHeight,v=h===void 0?0:h,m=o.opacity,E=m===void 0?1:m,A=o.opacityLinear,F=A===void 0?{enable:!1,dir:"in"}:A;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:E})){this.judgeStyleAttributes({opacity:E});var B=this.layer.getEncodedData(),V=this.calDataFrame(this.cellLength,B,this.cellProperties),j=V.data,at=V.width,ut=V.height;this.rowCount=ut,this.dataTexture=this.cellLength>0&&j.length>0?this.createTexture2D({flipY:!0,data:j,format:Jt.LUMINANCE,type:Jt.FLOAT,width:at,height:ut}):this.createTexture2D({flipY:!0,data:[1],format:Jt.LUMINANCE,type:Jt.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_raisingHeight:Number(v),u_opacity:(0,ee.isNumber)(E)?E:1,u_opacitylinear:Number(F.enable),u_dir:F.dir==="in"?1:0}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt,de,fe;return it().wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return v=this.getModelParams(),m=v.frag,E=v.vert,A=v.triangulation,F=v.type,B=this.layer.getLayerConfig(),V=B.mask,j=V===void 0?!1:V,at=B.maskInside,ut=at===void 0?!0:at,xt=B.workerEnabled,Nt=xt===void 0?!1:xt,de=B.enablePicking,this.layer.triangulation=A,Ye.next=5,this.layer.buildLayerModel({moduleName:F,vertexShader:E,fragmentShader:m,triangulation:A,primitive:Jt.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(j,ut),workerEnabled:Nt,workerOptions:{modelType:F,enablePicking:de}});case 5:return fe=Ye.sent,Ye.abrupt("return",[fe]);case 7:case"end":return Ye.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.dataTexture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getLayerConfig(),h=o.opacityLinear,v=h===void 0?{enable:!1,dir:"in"}:h;v.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Vi.Attribute,descriptor:{name:"a_linear",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:3,update:function(E,A,F){return[F[3],F[4],F[5]]}}})}},{key:"getModelParams",value:function(){var o=this.layer.getLayerConfig(),h=o.opacityLinear,v=h===void 0?{enable:!1}:h;return v.enable?{frag:ok,vert:sk,type:"polygonLinear",triangulation:Rw}:{frag:ak,vert:uk,type:"polygonFill",triangulation:Ad}}}]),a}(Ss);function lk(n){var l=ck();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ck(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var fk=`
uniform float u_time: 0.0;
uniform float u_opacity: 1.0;

varying vec2 v_uv;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;
// vec3 watercolor             = vec3(0.43, 0.60, 0.66); // 'transparent' low-water color (RGB)
// vec3 watercolor2            = vec3(0.06, 0.07, 0.11); // deep-water color (RGB, should be darker than the low-water color)
uniform vec4 u_watercolor;
uniform vec4 u_watercolor2;
vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture2D(u_texture2,p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture2D(u_texture1,fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture2D(u_texture3, fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    

  float opacity = u_opacity;
  gl_FragColor = vec4(col, opacity);  
}
`,hk=`attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;

  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,pk=function(n){(0,Zt.Z)(a,n);var l=lk(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.watercolor,E=m===void 0?"#6D99A8":m,A=o.watercolor2,F=A===void 0?"#0F121C":A;return{u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3,u_watercolor:Le(E),u_watercolor2:Le(F),u_opacity:(0,ee.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:hk,fragmentShader:fk,triangulation:xg,primitive:Jt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h,v;(o=this.texture1)===null||o===void 0||o.destroy(),(h=this.texture2)===null||h===void 0||h.destroy(),(v=this.texture3)===null||v===void 0||v.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getSource().extent,h=(0,ht.Z)(o,4),v=h[0],m=h[1],E=h[2],A=h[3],F=E-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Vi.Attribute,descriptor:{name:"a_uv",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(j,at,ut,xt){var Nt=j.version===yu["GAODE2.x"]?j.originCoordinates[0][xt]:ut,de=(0,ht.Z)(Nt,2),fe=de[0],Ne=de[1];return[(fe-v)/F,(Ne-m)/B]}}})}},{key:"loadTexture",value:function(){var o=this,h=this.rendererService.createTexture2D,v={height:0,width:0};this.texture1=h(v),this.texture2=h(v),this.texture3=h(v),m(function(A){o.texture1=E(A[0]),o.texture2=E(A[1]),o.texture3=E(A[2]),o.layerService.reRender()});function m(A){var F=0,B=[],V=["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"];V.map(function(j){var at=new Image;at.crossOrigin="",at.src=j,B.push(at),at.onload=function(){F++,F===3&&A(B)}})}function E(A){return h({data:A,width:A.width,height:A.height,wrapS:Jt.MIRRORED_REPEAT,wrapT:Jt.MIRRORED_REPEAT,min:Jt.LINEAR,mag:Jt.LINEAR})}}}]),a}(Ss);function dk(n){var l=vk();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function vk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var gk=`uniform float u_opacity : 1.0;
varying vec4 v_color;

#pragma include "picking"

void main() {
  gl_FragColor = v_color;
  gl_FragColor.a *= u_opacity;
  gl_FragColor = filterColor(gl_FragColor);
}
`,Cg=`attribute vec4 a_Color;
attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

// uniform vec2 u_tileOrigin;
// uniform float u_coord;

varying vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  v_color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  // if(u_coord > 0.0) {
    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
    } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
    }
  // } else {
  //   vec4 world = vec4(project_mvt_offset_position(vec4(u_tileOrigin, 0.0, 1.0)).xyz, 1.0); // \u74E6\u7247\u8D77\u59CB\u70B9\u7684\u4E16\u754C\u5750\u6807

  //   vec2 pointOffset = a_Position.xy *  pow(2.0, u_Zoom); // \u74E6\u7247\u5185\u7684\u70B9\u7684\u504F\u79FB\u5750\u6807
    
  //   world.xy += pointOffset;

  //   if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
  //     // Needs to be divided with project_uCommonUnitsPerMeter
  //     world.w *= u_PixelsPerMeter.z;
  //   }

  //   gl_Position = u_ViewProjectionMatrix * world + u_ViewportCenterProjection;
  // }

  setPickingColor(a_PickingColor);
}

`,mk=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,$O=`attribute vec3 a_Position;

uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}`,od=function(n){(0,Zt.Z)(a,n);var l=dk(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.usage,E=o.color,A=E===void 0?"#fff":E;return{u_opacity:v,u_color:m==="basemap"?Le(A):[0,0,0,0]}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V;return it().wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=v.usage,this.layer.triangulation=xg,at.next=4,this.layer.buildLayerModel({moduleName:"polygonTile_"+B,vertexShader:B==="basemap"?$O:Cg,fragmentShader:B==="basemap"?mk:gk,triangulation:xg,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F),pick:B!=="basemap"});case 4:return V=at.sent,at.abrupt("return",[V]);case 6:case"end":return at.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){}},{key:"registerBuiltinAttributes",value:function(){}}]),a}(Ss);function sd(n){var l=L0();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function L0(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var DS=`uniform sampler2D u_texture;
uniform float u_time: 0.0;
uniform float u_speed: 1.0;
uniform float u_opacity: 1.0;

varying vec4 v_Color;
varying vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture2D(u_texture, p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture2D(u_texture, p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {
  float opacity = u_opacity;
  gl_FragColor = v_Color;
  gl_FragColor.a *= opacity;

  float spc = calSpc();
  gl_FragColor += spc * 0.4;
}
`,Jd=`attribute vec4 a_Color;
attribute vec2 a_uv;
attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

varying vec4 v_Color;
varying vec2 v_uv;
uniform float u_opacity: 1.0;


#pragma include "projection"

void main() {
  v_uv = a_uv;

  v_Color = a_Color;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,yk=function(n){(0,Zt.Z)(a,n);var l=sd(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.speed,E=m===void 0?.5:m;return{u_texture:this.texture,u_speed:E,u_opacity:(0,ee.isNumber)(v)?v:1}}},{key:"getAnimateUniforms",value:function(){return{u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.loadTexture(),m.next=3,this.buildModels();case 3:return m.abrupt("return",m.sent);case 4:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,j.next=3,this.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:Jd,fragmentShader:DS,triangulation:xg,primitive:Jt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 3:return B=j.sent,j.abrupt("return",[B]);case 5:case"end":return j.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){var o=this.layer.getSource().extent,h=(0,ht.Z)(o,4),v=h[0],m=h[1],E=h[2],A=h[3],F=E-v,B=A-m;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Vi.Attribute,descriptor:{name:"a_uv",buffer:{usage:Jt.STATIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(j,at,ut,xt){var Nt=j.version===yu["GAODE2.x"]?j.originCoordinates[0][xt]:ut,de=(0,ht.Z)(Nt,2),fe=de[0],Ne=de[1];return[(fe-v)/F,(Ne-m)/B]}}})}},{key:"loadTexture",value:function(){var o=this,h=this.layer.getLayerConfig(),v=h.waterTexture,m=this.rendererService.createTexture2D;this.texture=m({height:0,width:0});var E=new Image;E.crossOrigin="",v?(console.warn("L7 recommend\uFF1Ahttps://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),E.src=v):E.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",E.onload=function(){o.texture=m({data:E,width:E.width,height:E.height,wrapS:Jt.MIRRORED_REPEAT,wrapT:Jt.MIRRORED_REPEAT,min:Jt.LINEAR,mag:Jt.LINEAR}),o.layerService.reRender()}}}]),a}(Ss),_k={fill:Ux,line:Mx,extrude:nk,text:CS,point_fill:rS,point_image:aS,point_normal:hm,point_extrude:Lx,water:yk,ocean:pk,tile:od},xk=_k;function bk(n){var l=Ek();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Ek(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Zx=function(n){(0,Zt.Z)(a,n);var l=bk(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"type","PolygonLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new xk[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getModelType",value:function(){var o,h=this.styleAttributeService.getLayerStyleAttribute("shape"),v=h==null||(o=h.scale)===null||o===void 0?void 0:o.field;return v==="fill"?"fill":v==="extrude"?"extrude":v==="water"?"water":v==="ocean"?"ocean":v==="line"?"line":v==="tile"?"tile":this.getPointModelType()}},{key:"getPointModelType",value:function(){var o=this.getEncodedData(),h=this.getLayerConfig(),v=h.shape2d,m=h.shape3d,E=this.iconService.getIconMap(),A=o.find(function(B){return B.hasOwnProperty("shape")});if(A){var F=A.shape;return F==="dot"?"point_normal":(v==null?void 0:v.indexOf(F))!==-1?"point_fill":(m==null?void 0:m.indexOf(F))!==-1?"point_extrude":E.hasOwnProperty(F)?"point_image":"text"}else return"fill"}}]),a}(dg);function wk(n){var l=Sk();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Sk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ck=`uniform float u_opacity : 1.0;
uniform vec4 u_color;

void main() {
  gl_FragColor = u_color;
  gl_FragColor.a *= u_opacity;
}
`,Ak=`attribute vec3 a_Position;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));
  } else {
    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  }
}

`,qO=function(n){(0,Zt.Z)(a,n);var l=wk(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?0:h,m=o.color,E=m===void 0?"#000":m;return{u_opacity:(0,ee.isNumber)(v)?v:0,u_color:Le(E)}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.buildModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.layer.buildLayerModel({moduleName:"mask",vertexShader:Ak,fragmentShader:Ck,triangulation:xg,depth:{enable:!1},blend:this.getBlend(),stencil:{enable:!0,mask:255,func:{cmp:Jt.ALWAYS,ref:1,mask:255},opFront:{fail:Jt.REPLACE,zfail:Jt.REPLACE,zpass:Jt.REPLACE}},pick:!1});case 2:return v=E.sent,E.abrupt("return",[v]);case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;o&&this.layerService.clear()}},{key:"registerBuiltinAttributes",value:function(){return""}}]),a}(Ss),Vx={fill:qO},Ag=Vx;function Tk(n){var l=Mk();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Mk(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Hy=function(n){(0,Zt.Z)(a,n);var l=Tk(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"type","MaskLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new Ag[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getModelType",value:function(){return"fill"}}]),a}(dg),BS,Gx,NS,zS,jy,US,ZS,Ik=(BS=(0,It.b2)(),Gx=(0,It.f3)(Dt.IMapService),NS=(0,It.f3)(Dt.IFontService),BS(zS=(jy=function(){function n(){(0,ct.Z)(this,n),Ar(this,"mapService",US,this),Ar(this,"fontService",ZS,this)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("DataMappingPlugin",(0,lt.Z)(it().mark(function v(){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:o.generateMaping(a,{styleAttributeService:h});case 1:case"end":return E.stop()}},v)}))),a.hooks.beforeRenderData.tapPromise("DataMappingPlugin",function(){var v=(0,lt.Z)(it().mark(function m(E){return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(E){F.next=2;break}return F.abrupt("return",E);case 2:return a.dataState.dataMappingNeedUpdate=!1,o.generateMaping(a,{styleAttributeService:h}),F.abrupt("return",!0);case 5:case"end":return F.stop()}},m)}));return function(m){return v.apply(this,arguments)}}()),a.hooks.beforeRender.tap("DataMappingPlugin",function(){var v=a.getSource();if(!(a.layerModelNeedUpdate||!v||!v.inited)){var m=h.getLayerStyleAttributes()||[],E=h.getLayerStyleAttribute("filter"),A=v.data.dataArray;if(!(Array.isArray(A)&&A.length===0)){var F=m.filter(function(at){return at.needRemapping}),B=A;if(E!=null&&E.needRemapping&&E!==null&&E!==void 0&&E.scale&&(B=A.filter(function(at){return o.applyAttributeMapping(E,at)[0]})),F.length)if(E!=null&&E.needRemapping){var V=o.mapping(a,m,B,void 0);a.setEncodedData(V),E.needRemapping=!1}else{var j=o.mapping(a,F,B,a.getEncodedData());a.setEncodedData(j)}}}})}},{key:"generateMaping",value:function(a,s){var o=this,h=s.styleAttributeService,v=h.getLayerStyleAttributes()||[],m=h.getLayerStyleAttribute("filter"),E=a.getSource().data.dataArray,A=E;m!=null&&m.scale&&(A=E.filter(function(B){return o.applyAttributeMapping(m,B)[0]})),A=a.processData(A);var F=this.mapping(a,v,A,void 0);a.setEncodedData(F),a.emit("dataUpdate",null)}},{key:"mapping",value:function(a,s,o,h){var v=this,m=a.getLayerConfig(),E=m.arrow,A=E===void 0?{enable:!1}:E,F=s.filter(function(V){return V.scale!==void 0}),B=o.map(function(V,j){var at=h?h[j]:{},ut=(0,q.Z)({id:V._id,coordinates:V.coordinates},at);if(F.forEach(function(de){var fe=v.applyAttributeMapping(de,V);de.needRemapping=!1,de.name==="color"&&(fe=fe.map(function(Ne){return Le(Ne)})),ut[de.name]=Array.isArray(fe)&&fe.length===1?fe[0]:fe,de.name==="shape"&&(ut.shape=v.fontService.getIconFontKey(ut[de.name]))}),A.enable&&(ut.shape==="line"||ut.shape==="halfLine")){var xt=ut.coordinates;if(a.arrowInsertCount<a.encodeDataLength){var Nt=v.getArrowPoints(xt[0],xt[1]);ut.coordinates.splice(1,0,Nt,Nt),a.arrowInsertCount++}}return ut});return this.adjustData2Amap2Coordinates(B,a),this.adjustData2SimpleCoordinates(B),B}},{key:"adjustData2Amap2Coordinates",value:function(a,s){var o=this;if(a.length>0&&this.mapService.version===yu["GAODE2.x"]){var h=s.coordCenter||s.getSource().center;typeof a[0].coordinates[0]=="number"?a.filter(function(v){return!v.originCoordinates}).map(function(v){v.version=yu["GAODE2.x"],v.originCoordinates=(0,ee.cloneDeep)(v.coordinates),v.coordinates=o.mapService.lngLatToCoordByLayer(v.coordinates,h)}):a.filter(function(v){return!v.originCoordinates}).map(function(v){v.version=yu["GAODE2.x"],v.originCoordinates=(0,ee.cloneDeep)(v.coordinates),v.coordinates=o.mapService.lngLatToCoordsByLayer(v.coordinates,h)})}}},{key:"adjustData2SimpleCoordinates",value:function(a){var s=this;a.length>0&&this.mapService.version===yu.SIMPLE&&a.map(function(o){o.simpleCoordinate||(o.coordinates=s.unProjectCoordinates(o.coordinates),o.simpleCoordinate=!0)})}},{key:"unProjectCoordinates",value:function(a){var s=this;if(typeof a[0]=="number")return this.mapService.simpleMapCoord.unproject(a);if(a[0]&&a[0][0]instanceof Array){var o=[];return a.map(function(v){var m=[];v.map(function(E){m.push(s.mapService.simpleMapCoord.unproject(E))}),o.push(m)}),o}else{var h=[];return a.map(function(v){h.push(s.mapService.simpleMapCoord.unproject(v))}),h}}},{key:"applyAttributeMapping",value:function(a,s){var o;if(!a.scale)return[];var h=(a==null||(o=a.scale)===null||o===void 0?void 0:o.scalers)||[],v=[];h.forEach(function(E){var A,F=E.field;(s.hasOwnProperty(F)||((A=a.scale)===null||A===void 0?void 0:A.type)==="variable")&&v.push(s[F])});var m=a.mapping?a.mapping(v):[];return m}},{key:"getArrowPoints",value:function(a,s){var o=[s[0]-a[0],s[1]-a[1]],h=Il(o),v=[a[0]+h[0]*1e-4,a[1]+h[1]*1e-4];return v}}]),n}(),US=Dr(jy.prototype,"mapService",[Gx],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZS=Dr(jy.prototype,"fontService",[NS],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jy))||zS),kk,Hx,VS=(kk=(0,It.b2)(),kk(Hx=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){var s=this;this.mapService=a.getContainer().get(Dt.IMapService),a.hooks.init.tapPromise("DataSourcePlugin",(0,lt.Z)(it().mark(function o(){var h,v,m,E;return it().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:if(h=a.getSource(),h||(v=a.sourceOption||a.defaultSourceConfig,m=v.data,E=v.options,h=new Zv(m,E),a.setSource(h)),!h.inited){F.next=6;break}s.updateClusterData(a),F.next=8;break;case 6:return F.next=8,new Promise(function(B){h.on("update",function(V){V.type==="inited"&&s.updateClusterData(a),B(null)})});case 8:case"end":return F.stop()}},o)}))),a.hooks.beforeRenderData.tapPromise("DataSourcePlugin",(0,lt.Z)(it().mark(function o(){var h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return h=s.updateClusterData(a),v=a.dataState.dataSourceNeedUpdate,a.dataState.dataSourceNeedUpdate=!1,E.abrupt("return",h||v);case 4:case"end":return E.stop()}},o)})))}},{key:"updateClusterData",value:function(a){if(a.isTileLayer||a.tileLayer||!a.getSource())return!1;var s=a.getSource(),o=s.cluster,h=s.clusterOptions.zoom,v=h===void 0?0:h,m=this.mapService.getZoom()-1,E=a.dataState.dataSourceNeedUpdate;return o&&E&&s.updateClusterData(Math.floor(m)),o&&Math.abs(a.clusterZoom-m)>=1?(v!==Math.floor(m)&&s.updateClusterData(Math.floor(m)),a.clusterZoom=m,!0):!1}}]),n}())||Hx);function jx(n,l){return n<l?-1:n>l?1:n>=l?0:NaN}function Wx(n){return n.length===1&&(n=Lk(n)),{left:function(l,a,s,o){for(s==null&&(s=0),o==null&&(o=l.length);s<o;){var h=s+o>>>1;n(l[h],a)<0?s=h+1:o=h}return s},right:function(l,a,s,o){for(s==null&&(s=0),o==null&&(o=l.length);s<o;){var h=s+o>>>1;n(l[h],a)>0?o=h:s=h+1}return s}}}function Lk(n){return function(l,a){return jx(n(l),a)}}var GS=Wx(jx),Pk=GS.right,KO=GS.left,Wy=Pk;function Ok(n,l){var a=n.length,s=-1,o,h,v;if(l==null){for(;++s<a;)if((o=n[s])!=null&&o>=o)for(h=v=o;++s<a;)(o=n[s])!=null&&(h>o&&(h=o),v<o&&(v=o))}else for(;++s<a;)if((o=l(n[s],s,n))!=null&&o>=o)for(h=v=o;++s<a;)(o=l(n[s],s,n))!=null&&(h>o&&(h=o),v<o&&(v=o));return[h,v]}var HS=Array.prototype,QO=HS.slice,JO=HS.map,Xx=Math.sqrt(50),Yx=Math.sqrt(10),$x=Math.sqrt(2);function jS(n,l,a){var s,o=-1,h,v,m;if(l=+l,n=+n,a=+a,n===l&&a>0)return[n];if((s=l<n)&&(h=n,n=l,l=h),(m=gm(n,l,a))===0||!isFinite(m))return[];if(m>0)for(n=Math.ceil(n/m),l=Math.floor(l/m),v=new Array(h=Math.ceil(l-n+1));++o<h;)v[o]=(n+o)*m;else for(n=Math.floor(n*m),l=Math.ceil(l*m),v=new Array(h=Math.ceil(n-l+1));++o<h;)v[o]=(n-o)/m;return s&&v.reverse(),v}function gm(n,l,a){var s=(l-n)/Math.max(0,a),o=Math.floor(Math.log(s)/Math.LN10),h=s/Math.pow(10,o);return o>=0?(h>=Xx?10:h>=Yx?5:h>=$x?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(h>=Xx?10:h>=Yx?5:h>=$x?2:1)}function Xy(n,l,a){var s=Math.abs(l-n)/Math.max(0,a),o=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),h=s/o;return h>=Xx?o*=10:h>=Yx?o*=5:h>=$x&&(o*=2),l<n?-o:o}function Fk(){var n=identity,l=extent,a=sturges;function s(o){var h,v=o.length,m,E=new Array(v);for(h=0;h<v;++h)E[h]=n(o[h],h,o);var A=l(E),F=A[0],B=A[1],V=a(E,F,B);Array.isArray(V)||(V=tickStep(F,B,V),V=range(Math.ceil(F/V)*V,B,V));for(var j=V.length;V[0]<=F;)V.shift(),--j;for(;V[j-1]>B;)V.pop(),--j;var at=new Array(j+1),ut;for(h=0;h<=j;++h)ut=at[h]=[],ut.x0=h>0?V[h-1]:F,ut.x1=h<j?V[h]:B;for(h=0;h<v;++h)m=E[h],F<=m&&m<=B&&at[bisect(V,m,0,j)].push(o[h]);return at}return s.value=function(o){return arguments.length?(n=typeof o=="function"?o:constant(o),s):n},s.domain=function(o){return arguments.length?(l=typeof o=="function"?o:constant([o[0],o[1]]),s):l},s.thresholds=function(o){return arguments.length?(a=typeof o=="function"?o:Array.isArray(o)?constant(slice.call(o)):constant(o),s):a},s}function Rk(n,l,a){return n=map.call(n,number).sort(ascending),Math.ceil((a-l)/(2*(quantile(n,.75)-quantile(n,.25))*Math.pow(n.length,-1/3)))}function Dk(n){return n===null?NaN:+n}function Bk(n,l,a){if(a==null&&(a=Dk),!!(s=n.length)){if((l=+l)<=0||s<2)return+a(n[0],0,n);if(l>=1)return+a(n[s-1],s-1,n);var s,o=(s-1)*l,h=Math.floor(o),v=+a(n[h],h,n),m=+a(n[h+1],h+1,n);return v+(m-v)*(o-h)}}function WS(n,l,a,s,o){var h=n*n,v=h*n;return((1-3*n+3*h-v)*l+(4-6*h+3*v)*a+(1+3*n+3*h-3*v)*s+v*o)/6}function Nk(n){var l=n.length-1;return function(a){var s=a<=0?a=0:a>=1?(a=1,l-1):Math.floor(a*l),o=n[s],h=n[s+1],v=s>0?n[s-1]:2*o-h,m=s<l-1?n[s+2]:2*h-o;return WS((a-s/l)*l,v,o,h,m)}}function zk(n){var l=n.length;return function(a){var s=Math.floor(((a%=1)<0?++a:a)*l),o=n[(s+l-1)%l],h=n[s%l],v=n[(s+1)%l],m=n[(s+2)%l];return WS((a-s/l)*l,o,h,v,m)}}function qx(n){return function(){return n}}function XS(n,l){return function(a){return n+a*l}}function Uk(n,l,a){return n=Math.pow(n,a),l=Math.pow(l,a)-n,a=1/a,function(s){return Math.pow(n+s*l,a)}}function tF(n,l){var a=l-n;return a?XS(n,a>180||a<-180?a-360*Math.round(a/360):a):constant(isNaN(n)?l:n)}function Zk(n){return(n=+n)==1?YS:function(l,a){return a-l?Uk(l,a,n):qx(isNaN(l)?a:l)}}function YS(n,l){var a=l-n;return a?XS(n,a):qx(isNaN(n)?l:n)}var Vk=function n(l){var a=Zk(l);function s(o,h){var v=a((o=C(o)).r,(h=C(h)).r),m=a(o.g,h.g),E=a(o.b,h.b),A=YS(o.opacity,h.opacity);return function(F){return o.r=v(F),o.g=m(F),o.b=E(F),o.opacity=A(F),o+""}}return s.gamma=n,s}(1);function $S(n){return function(l){var a=l.length,s=new Array(a),o=new Array(a),h=new Array(a),v,m;for(v=0;v<a;++v)m=C(l[v]),s[v]=m.r||0,o[v]=m.g||0,h[v]=m.b||0;return s=n(s),o=n(o),h=n(h),m.opacity=1,function(E){return m.r=s(E),m.g=o(E),m.b=h(E),m+""}}}var Gk=$S(Nk),Hk=$S(zk),Zh="$";function mm(){}mm.prototype=Kx.prototype={constructor:mm,has:function(n){return Zh+n in this},get:function(n){return this[Zh+n]},set:function(n,l){return this[Zh+n]=l,this},remove:function(n){var l=Zh+n;return l in this&&delete this[l]},clear:function(){for(var n in this)n[0]===Zh&&delete this[n]},keys:function(){var n=[];for(var l in this)l[0]===Zh&&n.push(l.slice(1));return n},values:function(){var n=[];for(var l in this)l[0]===Zh&&n.push(this[l]);return n},entries:function(){var n=[];for(var l in this)l[0]===Zh&&n.push({key:l.slice(1),value:this[l]});return n},size:function(){var n=0;for(var l in this)l[0]===Zh&&++n;return n},empty:function(){for(var n in this)if(n[0]===Zh)return!1;return!0},each:function(n){for(var l in this)l[0]===Zh&&n(this[l],l.slice(1),this)}};function Kx(n,l){var a=new mm;if(n instanceof mm)n.each(function(m,E){a.set(E,m)});else if(Array.isArray(n)){var s=-1,o=n.length,h;if(l==null)for(;++s<o;)a.set(s,n[s]);else for(;++s<o;)a.set(l(h=n[s],s,n),h)}else if(n)for(var v in n)a.set(v,n[v]);return a}var Qx=Kx;function Yy(){var n=[],l=[],a,s,o;function h(m,E,A,F){if(E>=n.length)return a!=null&&m.sort(a),s!=null?s(m):m;for(var B=-1,V=m.length,j=n[E++],at,ut,xt=map(),Nt,de=A();++B<V;)(Nt=xt.get(at=j(ut=m[B])+""))?Nt.push(ut):xt.set(at,[ut]);return xt.each(function(fe,Ne){F(de,Ne,h(fe,E,A,F))}),de}function v(m,E){if(++E>n.length)return m;var A,F=l[E-1];return s!=null&&E>=n.length?A=m.entries():(A=[],m.each(function(B,V){A.push({key:V,values:v(B,E)})})),F!=null?A.sort(function(B,V){return F(B.key,V.key)}):A}return o={object:function(m){return h(m,0,jk,Wk)},map:function(m){return h(m,0,qS,Jx)},entries:function(m){return v(h(m,0,qS,Jx),0)},key:function(m){return n.push(m),o},sortKeys:function(m){return l[n.length-1]=m,o},sortValues:function(m){return a=m,o},rollup:function(m){return s=m,o}}}function jk(){return{}}function Wk(n,l,a){n[l]=a}function qS(){return map()}function Jx(n,l,a){n.set(l,a)}function $y(){}var ud=Qx.prototype;$y.prototype=KS.prototype={constructor:$y,has:ud.has,add:function(n){return n+="",this[Zh+n]=n,this},remove:ud.remove,clear:ud.clear,values:ud.keys,size:ud.size,empty:ud.empty,each:ud.each};function KS(n,l){var a=new $y;if(n instanceof $y)n.each(function(h){a.add(h)});else if(n){var s=-1,o=n.length;if(l==null)for(;++s<o;)a.add(n[s]);else for(;++s<o;)a.add(l(n[s],s,n))}return a}var QS=null,JS=Array.prototype,tC=JS.map,Tp=JS.slice;function tv(n,l){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(l).domain(n);break}return this}function tb(n,l){switch(arguments.length){case 0:break;case 1:this.interpolator(n);break;default:this.interpolator(l).domain(n);break}return this}var eb={name:"implicit"};function ym(){var n=Qx(),l=[],a=[],s=eb;function o(h){var v=h+"",m=n.get(v);if(!m){if(s!==eb)return s;n.set(v,m=l.push(h))}return a[(m-1)%a.length]}return o.domain=function(h){if(!arguments.length)return l.slice();l=[],n=Qx();for(var v=-1,m=h.length,E,A;++v<m;)n.has(A=(E=h[v])+"")||n.set(A,l.push(E));return o},o.range=function(h){return arguments.length?(a=Tp.call(h),o):a.slice()},o.unknown=function(h){return arguments.length?(s=h,o):s},o.copy=function(){return ym(l,a).unknown(s)},tv.apply(o,arguments),o}function _m(){var n=ordinal().unknown(void 0),l=n.domain,a=n.range,s=[0,1],o,h,v=!1,m=0,E=0,A=.5;delete n.unknown;function F(){var B=l().length,V=s[1]<s[0],j=s[V-0],at=s[1-V];o=(at-j)/Math.max(1,B-m+E*2),v&&(o=Math.floor(o)),j+=(at-j-o*(B-m))*A,h=o*(1-m),v&&(j=Math.round(j),h=Math.round(h));var ut=sequence(B).map(function(xt){return j+o*xt});return a(V?ut.reverse():ut)}return n.domain=function(B){return arguments.length?(l(B),F()):l()},n.range=function(B){return arguments.length?(s=[+B[0],+B[1]],F()):s.slice()},n.rangeRound=function(B){return s=[+B[0],+B[1]],v=!0,F()},n.bandwidth=function(){return h},n.step=function(){return o},n.round=function(B){return arguments.length?(v=!!B,F()):v},n.padding=function(B){return arguments.length?(m=Math.min(1,E=+B),F()):m},n.paddingInner=function(B){return arguments.length?(m=Math.min(1,B),F()):m},n.paddingOuter=function(B){return arguments.length?(E=+B,F()):E},n.align=function(B){return arguments.length?(A=Math.max(0,Math.min(1,B)),F()):A},n.copy=function(){return _m(l(),s).round(v).paddingInner(m).paddingOuter(E).align(A)},initRange.apply(F(),arguments)}function rb(n){var l=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return rb(l())},n}function eF(){return rb(_m.apply(null,arguments).paddingInner(1))}function rF(n,l){return(isNumberArray(l)?numberArray:xm)(n,l)}function xm(n,l){var a=l?l.length:0,s=n?Math.min(a,n.length):0,o=new Array(s),h=new Array(a),v;for(v=0;v<s;++v)o[v]=ib(n[v],l[v]);for(;v<a;++v)h[v]=l[v];return function(m){for(v=0;v<s;++v)h[v]=o[v](m);return h}}function P0(n,l){var a=new Date;return n=+n,l=+l,function(s){return a.setTime(n*(1-s)+l*s),a}}function ev(n,l){return n=+n,l=+l,function(a){return n*(1-a)+l*a}}function Xk(n,l){var a={},s={},o;(n===null||typeof n!="object")&&(n={}),(l===null||typeof l!="object")&&(l={});for(o in l)o in n?a[o]=ib(n[o],l[o]):s[o]=l[o];return function(h){for(o in a)s[o]=a[o](h);return s}}var qy=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ky=new RegExp(qy.source,"g");function nb(n){return function(){return n}}function eC(n){return function(l){return n(l)+""}}function Yk(n,l){var a=qy.lastIndex=Ky.lastIndex=0,s,o,h,v=-1,m=[],E=[];for(n=n+"",l=l+"";(s=qy.exec(n))&&(o=Ky.exec(l));)(h=o.index)>a&&(h=l.slice(a,h),m[v]?m[v]+=h:m[++v]=h),(s=s[0])===(o=o[0])?m[v]?m[v]+=o:m[++v]=o:(m[++v]=null,E.push({i:v,x:ev(s,o)})),a=Ky.lastIndex;return a<l.length&&(h=l.slice(a),m[v]?m[v]+=h:m[++v]=h),m.length<2?E[0]?eC(E[0].x):nb(l):(l=E.length,function(A){for(var F=0,B;F<l;++F)m[(B=E[F]).i]=B.x(A);return m.join("")})}function $k(n,l){l||(l=[]);var a=n?Math.min(l.length,n.length):0,s=l.slice(),o;return function(h){for(o=0;o<a;++o)s[o]=n[o]*(1-h)+l[o]*h;return s}}function qk(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ib(n,l){var a=typeof l,s;return l==null||a==="boolean"?qx(l):(a==="number"?ev:a==="string"?(s=pc(l))?(l=s,Vk):Yk:l instanceof pc?Vk:l instanceof Date?P0:qk(l)?$k:Array.isArray(l)?xm:typeof l.valueOf!="function"&&typeof l.toString!="function"||isNaN(l)?Xk:ev)(n,l)}function Kk(n,l){return n=+n,l=+l,function(a){return Math.round(n*(1-a)+l*a)}}function rC(n){return function(){return n}}function Qk(n){return+n}var nC=[0,1];function Nc(n){return n}function ab(n,l){return(l-=n=+n)?function(a){return(a-n)/l}:rC(isNaN(l)?NaN:.5)}function iC(n){var l=n[0],a=n[n.length-1],s;return l>a&&(s=l,l=a,a=s),function(o){return Math.max(l,Math.min(a,o))}}function Jk(n,l,a){var s=n[0],o=n[1],h=l[0],v=l[1];return o<s?(s=ab(o,s),h=a(v,h)):(s=ab(s,o),h=a(h,v)),function(m){return h(s(m))}}function t4(n,l,a){var s=Math.min(n.length,l.length)-1,o=new Array(s),h=new Array(s),v=-1;for(n[s]<n[0]&&(n=n.slice().reverse(),l=l.slice().reverse());++v<s;)o[v]=ab(n[v],n[v+1]),h[v]=a(l[v],l[v+1]);return function(m){var E=Wy(n,m,1,s)-1;return h[E](o[E](m))}}function Qy(n,l){return l.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function ob(){var n=nC,l=nC,a=ib,s,o,h,v=Nc,m,E,A;function F(){return m=Math.min(n.length,l.length)>2?t4:Jk,E=A=null,B}function B(V){return isNaN(V=+V)?h:(E||(E=m(n.map(s),l,a)))(s(v(V)))}return B.invert=function(V){return v(o((A||(A=m(l,n.map(s),ev)))(V)))},B.domain=function(V){return arguments.length?(n=tC.call(V,Qk),v===Nc||(v=iC(n)),F()):n.slice()},B.range=function(V){return arguments.length?(l=Tp.call(V),F()):l.slice()},B.rangeRound=function(V){return l=Tp.call(V),a=Kk,F()},B.clamp=function(V){return arguments.length?(v=V?iC(n):Nc,B):v!==Nc},B.interpolate=function(V){return arguments.length?(a=V,F()):a},B.unknown=function(V){return arguments.length?(h=V,B):h},function(V,j){return s=V,o=j,F()}}function aC(n,l){return ob()(n,l)}var e4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Jy(n){if(!(l=e4.exec(n)))throw new Error("invalid format: "+n);var l;return new sb({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}Jy.prototype=sb.prototype;function sb(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}sb.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oC(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function t_(n,l){if((a=(n=l?n.toExponential(l-1):n.toExponential()).indexOf("e"))<0)return null;var a,s=n.slice(0,a);return[s.length>1?s[0]+s.slice(2):s,+n.slice(a+1)]}function O0(n){return n=t_(Math.abs(n)),n?n[1]:NaN}function Tg(n,l){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(O0(l)/3)))*3-O0(Math.abs(n)))}function r4(n,l){return function(a,s){for(var o=a.length,h=[],v=0,m=n[0],E=0;o>0&&m>0&&(E+m+1>s&&(m=Math.max(1,s-E)),h.push(a.substring(o-=m,o+m)),!((E+=m+1)>s));)m=n[v=(v+1)%n.length];return h.reverse().join(l)}}function n4(n){return function(l){return l.replace(/[0-9]/g,function(a){return n[+a]})}}function i4(n){t:for(var l=n.length,a=1,s=-1,o;a<l;++a)switch(n[a]){case".":s=o=a;break;case"0":s===0&&(s=a),o=a;break;default:if(!+n[a])break t;s>0&&(s=0);break}return s>0?n.slice(0,s)+n.slice(o+1):n}var sC;function uC(n,l){var a=t_(n,l);if(!a)return n+"";var s=a[0],o=a[1],h=o-(sC=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,v=s.length;return h===v?s:h>v?s+new Array(h-v+1).join("0"):h>0?s.slice(0,h)+"."+s.slice(h):"0."+new Array(1-h).join("0")+t_(n,Math.max(0,l+h-1))[0]}function F0(n,l){var a=t_(n,l);if(!a)return n+"";var s=a[0],o=a[1];return o<0?"0."+new Array(-o).join("0")+s:s.length>o+1?s.slice(0,o+1)+"."+s.slice(o+1):s+new Array(o-s.length+2).join("0")}var ub={"%":function(n,l){return(n*100).toFixed(l)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:oC,e:function(n,l){return n.toExponential(l)},f:function(n,l){return n.toFixed(l)},g:function(n,l){return n.toPrecision(l)},o:function(n){return Math.round(n).toString(8)},p:function(n,l){return F0(n*100,l)},r:F0,s:uC,X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function lb(n){return n}var e_=Array.prototype.map,r_=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function cb(n){var l=n.grouping===void 0||n.thousands===void 0?lb:r4(e_.call(n.grouping,Number),n.thousands+""),a=n.currency===void 0?"":n.currency[0]+"",s=n.currency===void 0?"":n.currency[1]+"",o=n.decimal===void 0?".":n.decimal+"",h=n.numerals===void 0?lb:n4(e_.call(n.numerals,String)),v=n.percent===void 0?"%":n.percent+"",m=n.minus===void 0?"-":n.minus+"",E=n.nan===void 0?"NaN":n.nan+"";function A(B){B=Jy(B);var V=B.fill,j=B.align,at=B.sign,ut=B.symbol,xt=B.zero,Nt=B.width,de=B.comma,fe=B.precision,Ne=B.trim,Ye=B.type;Ye==="n"?(de=!0,Ye="g"):ub[Ye]||(fe===void 0&&(fe=12),Ne=!0,Ye="g"),(xt||V==="0"&&j==="=")&&(xt=!0,V="0",j="=");var _r=ut==="$"?a:ut==="#"&&/[boxX]/.test(Ye)?"0"+Ye.toLowerCase():"",Ir=ut==="$"?s:/[%p]/.test(Ye)?v:"",Nr=ub[Ye],Yr=/[defgprs%]/.test(Ye);fe=fe===void 0?6:/[gprs]/.test(Ye)?Math.max(1,Math.min(21,fe)):Math.max(0,Math.min(20,fe));function yn(fn){var $n=_r,di=Ir,Yi,ho,zo;if(Ye==="c")di=Nr(fn)+di,fn="";else{fn=+fn;var Vs=fn<0||1/fn<0;if(fn=isNaN(fn)?E:Nr(Math.abs(fn),fe),Ne&&(fn=i4(fn)),Vs&&+fn==0&&at!=="+"&&(Vs=!1),$n=(Vs?at==="("?at:m:at==="-"||at==="("?"":at)+$n,di=(Ye==="s"?r_[8+sC/3]:"")+di+(Vs&&at==="("?")":""),Yr){for(Yi=-1,ho=fn.length;++Yi<ho;)if(zo=fn.charCodeAt(Yi),48>zo||zo>57){di=(zo===46?o+fn.slice(Yi+1):fn.slice(Yi))+di,fn=fn.slice(0,Yi);break}}}de&&!xt&&(fn=l(fn,1/0));var hu=$n.length+fn.length+di.length,Gu=hu<Nt?new Array(Nt-hu+1).join(V):"";switch(de&&xt&&(fn=l(Gu+fn,Gu.length?Nt-di.length:1/0),Gu=""),j){case"<":fn=$n+fn+di+Gu;break;case"=":fn=$n+Gu+fn+di;break;case"^":fn=Gu.slice(0,hu=Gu.length>>1)+$n+fn+di+Gu.slice(hu);break;default:fn=Gu+$n+fn+di;break}return h(fn)}return yn.toString=function(){return B+""},yn}function F(B,V){var j=A((B=Jy(B),B.type="f",B)),at=Math.max(-8,Math.min(8,Math.floor(O0(V)/3)))*3,ut=Math.pow(10,-at),xt=r_[8+at/3];return function(Nt){return j(ut*Nt)+xt}}return{format:A,formatPrefix:F}}var Mg,fb,lC;cC({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function cC(n){return Mg=cb(n),fb=Mg.format,lC=Mg.formatPrefix,Mg}function fC(n,l){return n=Math.abs(n),l=Math.abs(l)-n,Math.max(0,O0(l)-O0(n))+1}function a4(n){return Math.max(0,-O0(Math.abs(n)))}function o4(n,l,a,s){var o=Xy(n,l,a),h;switch(s=Jy(s==null?",f":s),s.type){case"s":{var v=Math.max(Math.abs(n),Math.abs(l));return s.precision==null&&!isNaN(h=Tg(o,v))&&(s.precision=h),lC(s,v)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(h=fC(o,Math.max(Math.abs(n),Math.abs(l))))&&(s.precision=h-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(h=a4(o))&&(s.precision=h-(s.type==="%")*2);break}}return fb(s)}function bm(n){var l=n.domain;return n.ticks=function(a){var s=l();return jS(s[0],s[s.length-1],a==null?10:a)},n.tickFormat=function(a,s){var o=l();return o4(o[0],o[o.length-1],a==null?10:a,s)},n.nice=function(a){a==null&&(a=10);var s=l(),o=0,h=s.length-1,v=s[o],m=s[h],E;return m<v&&(E=v,v=m,m=E,E=o,o=h,h=E),E=gm(v,m,a),E>0?(v=Math.floor(v/E)*E,m=Math.ceil(m/E)*E,E=gm(v,m,a)):E<0&&(v=Math.ceil(v*E)/E,m=Math.floor(m*E)/E,E=gm(v,m,a)),E>0?(s[o]=Math.floor(v/E)*E,s[h]=Math.ceil(m/E)*E,l(s)):E<0&&(s[o]=Math.ceil(v*E)/E,s[h]=Math.floor(m*E)/E,l(s)),n},n}function hC(){var n=aC(Nc,Nc);return n.copy=function(){return Qy(n,hC())},tv.apply(n,arguments),bm(n)}function s4(n){var l;function a(s){return isNaN(s=+s)?l:s}return a.invert=a,a.domain=a.range=function(s){return arguments.length?(n=map.call(s,number),a):n.slice()},a.unknown=function(s){return arguments.length?(l=s,a):l},a.copy=function(){return s4(n).unknown(l)},n=arguments.length?map.call(n,number):[0,1],linearish(a)}function pC(n,l){n=n.slice();var a=0,s=n.length-1,o=n[a],h=n[s],v;return h<o&&(v=a,a=s,s=v,v=o,o=h,h=v),n[a]=l.floor(o),n[s]=l.ceil(h),n}function dC(n){return Math.log(n)}function vC(n){return Math.exp(n)}function u4(n){return-Math.log(-n)}function gC(n){return-Math.exp(-n)}function mC(n){return isFinite(n)?+("1e"+n):n<0?0:n}function nF(n){return n===10?mC:n===Math.E?Math.exp:function(l){return Math.pow(n,l)}}function lh(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),function(l){return Math.log(l)/n})}function Nf(n){return function(l){return-n(-l)}}function yC(n){var l=n(dC,vC),a=l.domain,s=10,o,h;function v(){return o=lh(s),h=nF(s),a()[0]<0?(o=Nf(o),h=Nf(h),n(u4,gC)):n(dC,vC),l}return l.base=function(m){return arguments.length?(s=+m,v()):s},l.domain=function(m){return arguments.length?(a(m),v()):a()},l.ticks=function(m){var E=a(),A=E[0],F=E[E.length-1],B;(B=F<A)&&(V=A,A=F,F=V);var V=o(A),j=o(F),at,ut,xt,Nt=m==null?10:+m,de=[];if(!(s%1)&&j-V<Nt){if(V=Math.round(V)-1,j=Math.round(j)+1,A>0){for(;V<j;++V)for(ut=1,at=h(V);ut<s;++ut)if(xt=at*ut,!(xt<A)){if(xt>F)break;de.push(xt)}}else for(;V<j;++V)for(ut=s-1,at=h(V);ut>=1;--ut)if(xt=at*ut,!(xt<A)){if(xt>F)break;de.push(xt)}}else de=jS(V,j,Math.min(j-V,Nt)).map(h);return B?de.reverse():de},l.tickFormat=function(m,E){if(E==null&&(E=s===10?".0e":","),typeof E!="function"&&(E=fb(E)),m===1/0)return E;m==null&&(m=10);var A=Math.max(1,s*m/l.ticks().length);return function(F){var B=F/h(Math.round(o(F)));return B*s<s-.5&&(B*=s),B<=A?E(F):""}},l.nice=function(){return a(pC(a(),{floor:function(m){return h(Math.floor(o(m)))},ceil:function(m){return h(Math.ceil(o(m)))}}))},l}function _C(){var n=yC(ob()).domain([1,10]);return n.copy=function(){return Qy(n,_C()).base(n.base())},tv.apply(n,arguments),n}function xC(n){return function(l){return Math.sign(l)*Math.log1p(Math.abs(l/n))}}function R0(n){return function(l){return Math.sign(l)*Math.expm1(Math.abs(l))*n}}function D0(n){var l=1,a=n(xC(l),R0(l));return a.constant=function(s){return arguments.length?n(xC(l=+s),R0(l)):l},linearish(a)}function hb(){var n=D0(transformer());return n.copy=function(){return copy(n,hb()).constant(n.constant())},initRange.apply(n,arguments)}function n_(n){return function(l){return l<0?-Math.pow(-l,n):Math.pow(l,n)}}function bC(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function EC(n){return n<0?-n*n:n*n}function wC(n){var l=n(Nc,Nc),a=1;function s(){return a===1?n(Nc,Nc):a===.5?n(bC,EC):n(n_(a),n_(1/a))}return l.exponent=function(o){return arguments.length?(a=+o,s()):a},bm(l)}function pb(){var n=wC(ob());return n.copy=function(){return Qy(n,pb()).exponent(n.exponent())},tv.apply(n,arguments),n}function l4(){return pb.apply(null,arguments).exponent(.5)}function db(){var n=[],l=[],a=[],s;function o(){var v=0,m=Math.max(1,l.length);for(a=new Array(m-1);++v<m;)a[v-1]=Bk(n,v/m);return h}function h(v){return isNaN(v=+v)?s:l[Wy(a,v)]}return h.invertExtent=function(v){var m=l.indexOf(v);return m<0?[NaN,NaN]:[m>0?a[m-1]:n[0],m<a.length?a[m]:n[n.length-1]]},h.domain=function(v){if(!arguments.length)return n.slice();n=[];for(var m=0,E=v.length,A;m<E;++m)A=v[m],A!=null&&!isNaN(A=+A)&&n.push(A);return n.sort(jx),o()},h.range=function(v){return arguments.length?(l=Tp.call(v),o()):l.slice()},h.unknown=function(v){return arguments.length?(s=v,h):s},h.quantiles=function(){return a.slice()},h.copy=function(){return db().domain(n).range(l).unknown(s)},tv.apply(h,arguments)}function SC(){var n=0,l=1,a=1,s=[.5],o=[0,1],h;function v(E){return E<=E?o[Wy(s,E,0,a)]:h}function m(){var E=-1;for(s=new Array(a);++E<a;)s[E]=((E+1)*l-(E-a)*n)/(a+1);return v}return v.domain=function(E){return arguments.length?(n=+E[0],l=+E[1],m()):[n,l]},v.range=function(E){return arguments.length?(a=(o=Tp.call(E)).length-1,m()):o.slice()},v.invertExtent=function(E){var A=o.indexOf(E);return A<0?[NaN,NaN]:A<1?[n,s[0]]:A>=a?[s[a-1],l]:[s[A-1],s[A]]},v.unknown=function(E){return arguments.length&&(h=E),v},v.thresholds=function(){return s.slice()},v.copy=function(){return SC().domain([n,l]).range(o).unknown(h)},tv.apply(bm(v),arguments)}function CC(){var n=[.5],l=[0,1],a,s=1;function o(h){return h<=h?l[Wy(n,h,0,s)]:a}return o.domain=function(h){return arguments.length?(n=Tp.call(h),s=Math.min(n.length,l.length-1),o):n.slice()},o.range=function(h){return arguments.length?(l=Tp.call(h),s=Math.min(n.length,l.length-1),o):l.slice()},o.invertExtent=function(h){var v=l.indexOf(h);return[n[v-1],n[v]]},o.unknown=function(h){return arguments.length?(a=h,o):a},o.copy=function(){return CC().domain(n).range(l).unknown(a)},tv.apply(o,arguments)}var vb=new Date,gb=new Date;function gf(n,l,a,s){function o(h){return n(h=arguments.length===0?new Date:new Date(+h)),h}return o.floor=function(h){return n(h=new Date(+h)),h},o.ceil=function(h){return n(h=new Date(h-1)),l(h,1),n(h),h},o.round=function(h){var v=o(h),m=o.ceil(h);return h-v<m-h?v:m},o.offset=function(h,v){return l(h=new Date(+h),v==null?1:Math.floor(v)),h},o.range=function(h,v,m){var E=[],A;if(h=o.ceil(h),m=m==null?1:Math.floor(m),!(h<v)||!(m>0))return E;do E.push(A=new Date(+h)),l(h,m),n(h);while(A<h&&h<v);return E},o.filter=function(h){return gf(function(v){if(v>=v)for(;n(v),!h(v);)v.setTime(v-1)},function(v,m){if(v>=v)if(m<0)for(;++m<=0;)for(;l(v,-1),!h(v););else for(;--m>=0;)for(;l(v,1),!h(v););})},a&&(o.count=function(h,v){return vb.setTime(+h),gb.setTime(+v),n(vb),n(gb),Math.floor(a(vb,gb))},o.every=function(h){return h=Math.floor(h),!isFinite(h)||!(h>0)?null:h>1?o.filter(s?function(v){return s(v)%h===0}:function(v){return o.count(0,v)%h===0}):o}),o}var mb=gf(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,l){n.setFullYear(n.getFullYear()+l)},function(n,l){return l.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});mb.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:gf(function(l){l.setFullYear(Math.floor(l.getFullYear()/n)*n),l.setMonth(0,1),l.setHours(0,0,0,0)},function(l,a){l.setFullYear(l.getFullYear()+a*n)})};var Ig=mb,iF=mb.range,AC=gf(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,l){n.setMonth(n.getMonth()+l)},function(n,l){return l.getMonth()-n.getMonth()+(l.getFullYear()-n.getFullYear())*12},function(n){return n.getMonth()}),c4=AC,aF=AC.range,i_=1e3,Em=6e4,TC=36e5,MC=864e5,f4=6048e5;function B0(n){return gf(function(l){l.setDate(l.getDate()-(l.getDay()+7-n)%7),l.setHours(0,0,0,0)},function(l,a){l.setDate(l.getDate()+a*7)},function(l,a){return(a-l-(a.getTimezoneOffset()-l.getTimezoneOffset())*Em)/f4})}var yb=B0(0),a_=B0(1),h4=B0(2),p4=B0(3),wm=B0(4),d4=B0(5),v4=B0(6),oF=yb.range,sF=a_.range,uF=h4.range,lF=p4.range,cF=wm.range,fF=d4.range,RR=v4.range,IC=gf(function(n){n.setHours(0,0,0,0)},function(n,l){n.setDate(n.getDate()+l)},function(n,l){return(l-n-(l.getTimezoneOffset()-n.getTimezoneOffset())*Em)/MC},function(n){return n.getDate()-1}),o_=IC,hF=IC.range,_b=gf(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*i_-n.getMinutes()*Em)},function(n,l){n.setTime(+n+l*TC)},function(n,l){return(l-n)/TC},function(n){return n.getHours()}),g4=_b,pF=_b.range,xb=gf(function(n){n.setTime(n-n.getMilliseconds()-n.getSeconds()*i_)},function(n,l){n.setTime(+n+l*Em)},function(n,l){return(l-n)/Em},function(n){return n.getMinutes()}),kC=xb,dF=xb.range,LC=gf(function(n){n.setTime(n-n.getMilliseconds())},function(n,l){n.setTime(+n+l*i_)},function(n,l){return(l-n)/i_},function(n){return n.getUTCSeconds()}),m4=LC,vF=LC.range,s_=gf(function(){},function(n,l){n.setTime(+n+l)},function(n,l){return l-n});s_.every=function(n){return n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?gf(function(l){l.setTime(Math.floor(l/n)*n)},function(l,a){l.setTime(+l+a*n)},function(l,a){return(a-l)/n}):s_};var y4=s_,gF=s_.range;function N0(n){return gf(function(l){l.setUTCDate(l.getUTCDate()-(l.getUTCDay()+7-n)%7),l.setUTCHours(0,0,0,0)},function(l,a){l.setUTCDate(l.getUTCDate()+a*7)},function(l,a){return(a-l)/f4})}var PC=N0(0),u_=N0(1),OC=N0(2),mF=N0(3),kg=N0(4),_4=N0(5),x4=N0(6),yF=PC.range,_F=u_.range,xF=OC.range,bF=mF.range,EF=kg.range,DR=_4.range,wF=x4.range,FC=gf(function(n){n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCDate(n.getUTCDate()+l)},function(n,l){return(l-n)/MC},function(n){return n.getUTCDate()-1}),RC=FC,b4=FC.range,bb=gf(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCFullYear(n.getUTCFullYear()+l)},function(n,l){return l.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});bb.every=function(n){return!isFinite(n=Math.floor(n))||!(n>0)?null:gf(function(l){l.setUTCFullYear(Math.floor(l.getUTCFullYear()/n)*n),l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0)},function(l,a){l.setUTCFullYear(l.getUTCFullYear()+a*n)})};var Sm=bb,SF=bb.range;function Eb(n){if(0<=n.y&&n.y<100){var l=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return l.setFullYear(n.y),l}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function wb(n){if(0<=n.y&&n.y<100){var l=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return l.setUTCFullYear(n.y),l}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function l_(n,l,a){return{y:n,m:l,d:a,H:0,M:0,S:0,L:0}}function E4(n){var l=n.dateTime,a=n.date,s=n.time,o=n.periods,h=n.days,v=n.shortDays,m=n.months,E=n.shortMonths,A=Cm(o),F=c_(o),B=Cm(h),V=c_(h),j=Cm(v),at=c_(v),ut=Cm(m),xt=c_(m),Nt=Cm(E),de=c_(E),fe={a:Vs,A:hu,b:Gu,B:Wh,c:null,d:v_,e:v_,f:WC,g:Z4,G:G4,H:k4,I:L4,j:P4,L:Tb,m:O4,M:F4,p:s2,q:X_,Q:JC,s:tA,S:R4,u:D4,U:B4,V:N4,w:z4,W:U4,x:null,X:null,y:YC,Y:V4,Z:H4,"%":QC},Ne={a:u2,A:cT,b:uO,B:fT,c:null,d:$C,e:$C,f:qC,g:J4,G:eL,H:j4,I:W4,j:CF,L:g_,m:Am,M:X4,p:k8,q:L8,Q:JC,s:tA,S:Y4,u:KC,U:Tm,V:$4,w:q4,W:K4,x:null,X:null,y:Q4,Y:tL,Z:rL,"%":QC},Ye={a:yn,A:fn,b:$n,B:di,c:Yi,d:VC,e:VC,f:I4,g:ZC,G:UC,H:GC,I:GC,j:Sb,L:Ab,m:M4,M:p_,p:Yr,q:T4,Q:jC,s:d_,S:Cb,u:NC,U:zC,V:f_,w:BC,W:h_,x:ho,X:zo,y:ZC,Y:UC,Z:A4,"%":HC};fe.x=_r(a,fe),fe.X=_r(s,fe),fe.c=_r(l,fe),Ne.x=_r(a,Ne),Ne.X=_r(s,Ne),Ne.c=_r(l,Ne);function _r(Za,ps){return function(Gs){var Hi=[],Xh=-1,Hu=0,kp=Za.length,Lp,Vm,OR;for(Gs instanceof Date||(Gs=new Date(+Gs));++Xh<kp;)Za.charCodeAt(Xh)===37&&(Hi.push(Za.slice(Hu,Xh)),(Vm=DC[Lp=Za.charAt(++Xh)])!=null?Lp=Za.charAt(++Xh):Vm=Lp==="e"?" ":"0",(OR=ps[Lp])&&(Lp=OR(Gs,Vm)),Hi.push(Lp),Hu=Xh+1);return Hi.push(Za.slice(Hu,Xh)),Hi.join("")}}function Ir(Za,ps){return function(Gs){var Hi=l_(1900,void 0,1),Xh=Nr(Hi,Za,Gs+="",0),Hu,kp;if(Xh!=Gs.length)return null;if("Q"in Hi)return new Date(Hi.Q);if("s"in Hi)return new Date(Hi.s*1e3+("L"in Hi?Hi.L:0));if(ps&&!("Z"in Hi)&&(Hi.Z=0),"p"in Hi&&(Hi.H=Hi.H%12+Hi.p*12),Hi.m===void 0&&(Hi.m="q"in Hi?Hi.q:0),"V"in Hi){if(Hi.V<1||Hi.V>53)return null;"w"in Hi||(Hi.w=1),"Z"in Hi?(Hu=wb(l_(Hi.y,0,1)),kp=Hu.getUTCDay(),Hu=kp>4||kp===0?u_.ceil(Hu):u_(Hu),Hu=RC.offset(Hu,(Hi.V-1)*7),Hi.y=Hu.getUTCFullYear(),Hi.m=Hu.getUTCMonth(),Hi.d=Hu.getUTCDate()+(Hi.w+6)%7):(Hu=Eb(l_(Hi.y,0,1)),kp=Hu.getDay(),Hu=kp>4||kp===0?a_.ceil(Hu):a_(Hu),Hu=o_.offset(Hu,(Hi.V-1)*7),Hi.y=Hu.getFullYear(),Hi.m=Hu.getMonth(),Hi.d=Hu.getDate()+(Hi.w+6)%7)}else("W"in Hi||"U"in Hi)&&("w"in Hi||(Hi.w="u"in Hi?Hi.u%7:"W"in Hi?1:0),kp="Z"in Hi?wb(l_(Hi.y,0,1)).getUTCDay():Eb(l_(Hi.y,0,1)).getDay(),Hi.m=0,Hi.d="W"in Hi?(Hi.w+6)%7+Hi.W*7-(kp+5)%7:Hi.w+Hi.U*7-(kp+6)%7);return"Z"in Hi?(Hi.H+=Hi.Z/100|0,Hi.M+=Hi.Z%100,wb(Hi)):Eb(Hi)}}function Nr(Za,ps,Gs,Hi){for(var Xh=0,Hu=ps.length,kp=Gs.length,Lp,Vm;Xh<Hu;){if(Hi>=kp)return-1;if(Lp=ps.charCodeAt(Xh++),Lp===37){if(Lp=ps.charAt(Xh++),Vm=Ye[Lp in DC?ps.charAt(Xh++):Lp],!Vm||(Hi=Vm(Za,Gs,Hi))<0)return-1}else if(Lp!=Gs.charCodeAt(Hi++))return-1}return Hi}function Yr(Za,ps,Gs){var Hi=A.exec(ps.slice(Gs));return Hi?(Za.p=F[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function yn(Za,ps,Gs){var Hi=j.exec(ps.slice(Gs));return Hi?(Za.w=at[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function fn(Za,ps,Gs){var Hi=B.exec(ps.slice(Gs));return Hi?(Za.w=V[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function $n(Za,ps,Gs){var Hi=Nt.exec(ps.slice(Gs));return Hi?(Za.m=de[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function di(Za,ps,Gs){var Hi=ut.exec(ps.slice(Gs));return Hi?(Za.m=xt[Hi[0].toLowerCase()],Gs+Hi[0].length):-1}function Yi(Za,ps,Gs){return Nr(Za,l,ps,Gs)}function ho(Za,ps,Gs){return Nr(Za,a,ps,Gs)}function zo(Za,ps,Gs){return Nr(Za,s,ps,Gs)}function Vs(Za){return v[Za.getDay()]}function hu(Za){return h[Za.getDay()]}function Gu(Za){return E[Za.getMonth()]}function Wh(Za){return m[Za.getMonth()]}function s2(Za){return o[+(Za.getHours()>=12)]}function X_(Za){return 1+~~(Za.getMonth()/3)}function u2(Za){return v[Za.getUTCDay()]}function cT(Za){return h[Za.getUTCDay()]}function uO(Za){return E[Za.getUTCMonth()]}function fT(Za){return m[Za.getUTCMonth()]}function k8(Za){return o[+(Za.getUTCHours()>=12)]}function L8(Za){return 1+~~(Za.getUTCMonth()/3)}return{format:function(Za){var ps=_r(Za+="",fe);return ps.toString=function(){return Za},ps},parse:function(Za){var ps=Ir(Za+="",!1);return ps.toString=function(){return Za},ps},utcFormat:function(Za){var ps=_r(Za+="",Ne);return ps.toString=function(){return Za},ps},utcParse:function(Za){var ps=Ir(Za+="",!0);return ps.toString=function(){return Za},ps}}}var DC={"-":"",_:" ",0:"0"},oc=/^\s*\d+/,w4=/^%/,S4=/[\\^$*+?|[\]().{}]/g;function Cs(n,l,a){var s=n<0?"-":"",o=(s?-n:n)+"",h=o.length;return s+(h<a?new Array(a-h+1).join(l)+o:o)}function C4(n){return n.replace(S4,"\\$&")}function Cm(n){return new RegExp("^(?:"+n.map(C4).join("|")+")","i")}function c_(n){for(var l={},a=-1,s=n.length;++a<s;)l[n[a].toLowerCase()]=a;return l}function BC(n,l,a){var s=oc.exec(l.slice(a,a+1));return s?(n.w=+s[0],a+s[0].length):-1}function NC(n,l,a){var s=oc.exec(l.slice(a,a+1));return s?(n.u=+s[0],a+s[0].length):-1}function zC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.U=+s[0],a+s[0].length):-1}function f_(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.V=+s[0],a+s[0].length):-1}function h_(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.W=+s[0],a+s[0].length):-1}function UC(n,l,a){var s=oc.exec(l.slice(a,a+4));return s?(n.y=+s[0],a+s[0].length):-1}function ZC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.y=+s[0]+(+s[0]>68?1900:2e3),a+s[0].length):-1}function A4(n,l,a){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(l.slice(a,a+6));return s?(n.Z=s[1]?0:-(s[2]+(s[3]||"00")),a+s[0].length):-1}function T4(n,l,a){var s=oc.exec(l.slice(a,a+1));return s?(n.q=s[0]*3-3,a+s[0].length):-1}function M4(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.m=s[0]-1,a+s[0].length):-1}function VC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.d=+s[0],a+s[0].length):-1}function Sb(n,l,a){var s=oc.exec(l.slice(a,a+3));return s?(n.m=0,n.d=+s[0],a+s[0].length):-1}function GC(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.H=+s[0],a+s[0].length):-1}function p_(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.M=+s[0],a+s[0].length):-1}function Cb(n,l,a){var s=oc.exec(l.slice(a,a+2));return s?(n.S=+s[0],a+s[0].length):-1}function Ab(n,l,a){var s=oc.exec(l.slice(a,a+3));return s?(n.L=+s[0],a+s[0].length):-1}function I4(n,l,a){var s=oc.exec(l.slice(a,a+6));return s?(n.L=Math.floor(s[0]/1e3),a+s[0].length):-1}function HC(n,l,a){var s=w4.exec(l.slice(a,a+1));return s?a+s[0].length:-1}function jC(n,l,a){var s=oc.exec(l.slice(a));return s?(n.Q=+s[0],a+s[0].length):-1}function d_(n,l,a){var s=oc.exec(l.slice(a));return s?(n.s=+s[0],a+s[0].length):-1}function v_(n,l){return Cs(n.getDate(),l,2)}function k4(n,l){return Cs(n.getHours(),l,2)}function L4(n,l){return Cs(n.getHours()%12||12,l,2)}function P4(n,l){return Cs(1+o_.count(Ig(n),n),l,3)}function Tb(n,l){return Cs(n.getMilliseconds(),l,3)}function WC(n,l){return Tb(n,l)+"000"}function O4(n,l){return Cs(n.getMonth()+1,l,2)}function F4(n,l){return Cs(n.getMinutes(),l,2)}function R4(n,l){return Cs(n.getSeconds(),l,2)}function D4(n){var l=n.getDay();return l===0?7:l}function B4(n,l){return Cs(yb.count(Ig(n)-1,n),l,2)}function XC(n){var l=n.getDay();return l>=4||l===0?wm(n):wm.ceil(n)}function N4(n,l){return n=XC(n),Cs(wm.count(Ig(n),n)+(Ig(n).getDay()===4),l,2)}function z4(n){return n.getDay()}function U4(n,l){return Cs(a_.count(Ig(n)-1,n),l,2)}function YC(n,l){return Cs(n.getFullYear()%100,l,2)}function Z4(n,l){return n=XC(n),Cs(n.getFullYear()%100,l,2)}function V4(n,l){return Cs(n.getFullYear()%1e4,l,4)}function G4(n,l){var a=n.getDay();return n=a>=4||a===0?wm(n):wm.ceil(n),Cs(n.getFullYear()%1e4,l,4)}function H4(n){var l=n.getTimezoneOffset();return(l>0?"-":(l*=-1,"+"))+Cs(l/60|0,"0",2)+Cs(l%60,"0",2)}function $C(n,l){return Cs(n.getUTCDate(),l,2)}function j4(n,l){return Cs(n.getUTCHours(),l,2)}function W4(n,l){return Cs(n.getUTCHours()%12||12,l,2)}function CF(n,l){return Cs(1+RC.count(Sm(n),n),l,3)}function g_(n,l){return Cs(n.getUTCMilliseconds(),l,3)}function qC(n,l){return g_(n,l)+"000"}function Am(n,l){return Cs(n.getUTCMonth()+1,l,2)}function X4(n,l){return Cs(n.getUTCMinutes(),l,2)}function Y4(n,l){return Cs(n.getUTCSeconds(),l,2)}function KC(n){var l=n.getUTCDay();return l===0?7:l}function Tm(n,l){return Cs(PC.count(Sm(n)-1,n),l,2)}function Mb(n){var l=n.getUTCDay();return l>=4||l===0?kg(n):kg.ceil(n)}function $4(n,l){return n=Mb(n),Cs(kg.count(Sm(n),n)+(Sm(n).getUTCDay()===4),l,2)}function q4(n){return n.getUTCDay()}function K4(n,l){return Cs(u_.count(Sm(n)-1,n),l,2)}function Q4(n,l){return Cs(n.getUTCFullYear()%100,l,2)}function J4(n,l){return n=Mb(n),Cs(n.getUTCFullYear()%100,l,2)}function tL(n,l){return Cs(n.getUTCFullYear()%1e4,l,4)}function eL(n,l){var a=n.getUTCDay();return n=a>=4||a===0?kg(n):kg.ceil(n),Cs(n.getUTCFullYear()%1e4,l,4)}function rL(){return"+0000"}function QC(){return"%"}function JC(n){return+n}function tA(n){return Math.floor(+n/1e3)}var z0,eA,nL,iL,aL;Ib({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ib(n){return z0=E4(n),eA=z0.format,nL=z0.parse,iL=z0.utcFormat,aL=z0.utcParse,z0}var U0=1e3,Mm=U0*60,Im=Mm*60,km=Im*24,m_=km*7,rA=km*30,kb=km*365;function y_(n){return new Date(n)}function nA(n){return n instanceof Date?+n:+new Date(+n)}function Lb(n,l,a,s,o,h,v,m,E){var A=aC(Nc,Nc),F=A.invert,B=A.domain,V=E(".%L"),j=E(":%S"),at=E("%I:%M"),ut=E("%I %p"),xt=E("%a %d"),Nt=E("%b %d"),de=E("%B"),fe=E("%Y"),Ne=[[v,1,U0],[v,5,5*U0],[v,15,15*U0],[v,30,30*U0],[h,1,Mm],[h,5,5*Mm],[h,15,15*Mm],[h,30,30*Mm],[o,1,Im],[o,3,3*Im],[o,6,6*Im],[o,12,12*Im],[s,1,km],[s,2,2*km],[a,1,m_],[l,1,rA],[l,3,3*rA],[n,1,kb]];function Ye(Ir){return(v(Ir)<Ir?V:h(Ir)<Ir?j:o(Ir)<Ir?at:s(Ir)<Ir?ut:l(Ir)<Ir?a(Ir)<Ir?xt:Nt:n(Ir)<Ir?de:fe)(Ir)}function _r(Ir,Nr,Yr,yn){if(Ir==null&&(Ir=10),typeof Ir=="number"){var fn=Math.abs(Yr-Nr)/Ir,$n=Wx(function(di){return di[2]}).right(Ne,fn);$n===Ne.length?(yn=Xy(Nr/kb,Yr/kb,Ir),Ir=n):$n?($n=Ne[fn/Ne[$n-1][2]<Ne[$n][2]/fn?$n-1:$n],yn=$n[1],Ir=$n[0]):(yn=Math.max(Xy(Nr,Yr,Ir),1),Ir=m)}return yn==null?Ir:Ir.every(yn)}return A.invert=function(Ir){return new Date(F(Ir))},A.domain=function(Ir){return arguments.length?B(tC.call(Ir,nA)):B().map(y_)},A.ticks=function(Ir,Nr){var Yr=B(),yn=Yr[0],fn=Yr[Yr.length-1],$n=fn<yn,di;return $n&&(di=yn,yn=fn,fn=di),di=_r(Ir,yn,fn,Nr),di=di?di.range(yn,fn+1):[],$n?di.reverse():di},A.tickFormat=function(Ir,Nr){return Nr==null?Ye:E(Nr)},A.nice=function(Ir,Nr){var Yr=B();return(Ir=_r(Ir,Yr[0],Yr[Yr.length-1],Nr))?B(pC(Yr,Ir)):A},A.copy=function(){return Qy(A,Lb(n,l,a,s,o,h,v,m,E))},A}function iA(){return tv.apply(Lb(Ig,c4,yb,o_,g4,kC,m4,y4,eA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oL(){return initRange.apply(calendar(utcYear,utcMonth,utcWeek,utcDay,utcHour,utcMinute,utcSecond,utcMillisecond,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function __(){var n=0,l=1,a,s,o,h,v=Nc,m=!1,E;function A(F){return isNaN(F=+F)?E:v(o===0?.5:(F=(h(F)-a)*o,m?Math.max(0,Math.min(1,F)):F))}return A.domain=function(F){return arguments.length?(a=h(n=+F[0]),s=h(l=+F[1]),o=a===s?0:1/(s-a),A):[n,l]},A.clamp=function(F){return arguments.length?(m=!!F,A):m},A.interpolator=function(F){return arguments.length?(v=F,A):v},A.unknown=function(F){return arguments.length?(E=F,A):E},function(F){return h=F,a=F(n),s=F(l),o=a===s?0:1/(s-a),A}}function Lm(n,l){return l.domain(n.domain()).interpolator(n.interpolator()).clamp(n.clamp()).unknown(n.unknown())}function aA(){var n=bm(__()(Nc));return n.copy=function(){return Lm(n,aA())},tb.apply(n,arguments)}function sL(){var n=loggish(__()).domain([1,10]);return n.copy=function(){return Lm(n,sL()).base(n.base())},initInterpolator.apply(n,arguments)}function uL(){var n=symlogish(__());return n.copy=function(){return Lm(n,uL()).constant(n.constant())},initInterpolator.apply(n,arguments)}function Pb(){var n=powish(__());return n.copy=function(){return Lm(n,Pb()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function lL(){return Pb.apply(null,arguments).exponent(.5)}function cL(){var n=[],l=identity;function a(s){if(!isNaN(s=+s))return l((bisect(n,s)-1)/(n.length-1))}return a.domain=function(s){if(!arguments.length)return n.slice();n=[];for(var o=0,h=s.length,v;o<h;++o)v=s[o],v!=null&&!isNaN(v=+v)&&n.push(v);return n.sort(ascending),a},a.interpolator=function(s){return arguments.length?(l=s,a):l},a.copy=function(){return cL(l).domain(n)},initInterpolator.apply(a,arguments)}function x_(){var n=0,l=.5,a=1,s,o,h,v,m,E=Nc,A,F=!1,B;function V(j){return isNaN(j=+j)?B:(j=.5+((j=+A(j))-o)*(j<o?v:m),E(F?Math.max(0,Math.min(1,j)):j))}return V.domain=function(j){return arguments.length?(s=A(n=+j[0]),o=A(l=+j[1]),h=A(a=+j[2]),v=s===o?0:.5/(o-s),m=o===h?0:.5/(h-o),V):[n,l,a]},V.clamp=function(j){return arguments.length?(F=!!j,V):F},V.interpolator=function(j){return arguments.length?(E=j,V):E},V.unknown=function(j){return arguments.length?(B=j,V):B},function(j){return A=j,s=j(n),o=j(l),h=j(a),v=s===o?0:.5/(o-s),m=o===h?0:.5/(h-o),V}}function oA(){var n=bm(x_()(Nc));return n.copy=function(){return Lm(n,oA())},tb.apply(n,arguments)}function fL(){var n=loggish(x_()).domain([.1,1,10]);return n.copy=function(){return copy(n,fL()).base(n.base())},initInterpolator.apply(n,arguments)}function hL(){var n=symlogish(x_());return n.copy=function(){return copy(n,hL()).constant(n.constant())},initInterpolator.apply(n,arguments)}function sA(){var n=powish(x_());return n.copy=function(){return copy(n,sA()).exponent(n.exponent())},initInterpolator.apply(n,arguments)}function AF(){return sA.apply(null,arguments).exponent(.5)}function uA(n){var l,a=[];function s(o){return o==null?l:o}return s.invert=s,s.domain=s.range=function(o){return o?(a=o,o):a},s.unknown=function(o){return o?(l=o,o):l},s.copy=function(){return uA(n).unknown(l)},s}var ch,pL,Ob,lA=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,Fb=(ch={},(0,X.Z)(ch,Ps.LINEAR,hC),(0,X.Z)(ch,Ps.POWER,pb),(0,X.Z)(ch,Ps.LOG,_C),(0,X.Z)(ch,Ps.IDENTITY,uA),(0,X.Z)(ch,Ps.SEQUENTIAL,aA),(0,X.Z)(ch,Ps.TIME,iA),(0,X.Z)(ch,Ps.QUANTILE,db),(0,X.Z)(ch,Ps.QUANTIZE,SC),(0,X.Z)(ch,Ps.THRESHOLD,CC),(0,X.Z)(ch,Ps.CAT,ym),(0,X.Z)(ch,Ps.DIVERGING,oA),ch),dL=(pL=(0,It.b2)(),pL(Ob=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"scaleOptions",{})}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("FeatureScalePlugin",(0,lt.Z)(it().mark(function v(){var m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:if(o.scaleOptions=a.getScaleOptions(),E=h.getLayerStyleAttributes(),A=(m=a.getSource())===null||m===void 0?void 0:m.data.dataArray,!(Array.isArray(A)&&A.length===0)){B.next=7;break}return B.abrupt("return");case 7:o.caculateScalesForAttributes(E||[],A);case 8:case"end":return B.stop()}},v)}))),a.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",function(){var v=(0,lt.Z)(it().mark(function m(E){var A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(E){V.next=2;break}return V.abrupt("return",E);case 2:if(o.scaleOptions=a.getScaleOptions(),A=h.getLayerStyleAttributes(),F=a.getSource().data.dataArray,!(Array.isArray(F)&&F.length===0)){V.next=7;break}return V.abrupt("return",!0);case 7:return o.caculateScalesForAttributes(A||[],F),a.layerModelNeedUpdate=!0,V.abrupt("return",!0);case 10:case"end":return V.stop()}},m)}));return function(m){return v.apply(this,arguments)}}()),a.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!a.layerModelNeedUpdate){o.scaleOptions=a.getScaleOptions();var v=h.getLayerStyleAttributes(),m=a.getSource().data.dataArray;if(!(Array.isArray(m)&&m.length===0)&&v){var E=v.filter(function(A){return A.needRescale});E.length&&o.caculateScalesForAttributes(E,m)}}})}},{key:"isNumber",value:function(a){return!isNaN(parseFloat(a))&&isFinite(a)}},{key:"caculateScalesForAttributes",value:function(a,s){var o=this;a.forEach(function(h){if(h.scale){var v=h.scale;v.names=o.parseFields(h.scale.field||[]);var m=[];v.names.forEach(function(E){var A;m.push(o.createScale(E,h.name,(A=h.scale)===null||A===void 0?void 0:A.values,s))}),m.some(function(E){return E.type===Rv.VARIABLE})?(v.type=Rv.VARIABLE,m.forEach(function(E){var A;if(!v.callback&&v.values!=="text")switch((A=E.option)===null||A===void 0?void 0:A.type){case Ps.LOG:case Ps.LINEAR:case Ps.POWER:if(v.values&&v.values.length>2){var F=E.scale.ticks(v.values.length);E.scale.domain(F)}v.values?E.scale.range(v.values):E.scale.range(E.option.domain);break;case Ps.QUANTILE:case Ps.QUANTIZE:case Ps.THRESHOLD:E.scale.range(v.values);break;case Ps.IDENTITY:break;case Ps.CAT:v.values?E.scale.range(v.values):E.scale.range(E.option.domain);break;case Ps.DIVERGING:case Ps.SEQUENTIAL:E.scale.interpolator(Gk(v.values));break}if(v.values==="text"){var B;E.scale.range((B=E.option)===null||B===void 0?void 0:B.domain)}})):(v.type=Rv.CONSTANT,v.defaultValues=m.map(function(E,A){return E.scale(v.names[A])})),v.scalers=m.map(function(E){return{field:E.field,func:E.scale,option:E.option}}),h.needRescale=!1}})}},{key:"parseFields",value:function(a){return Array.isArray(a)?a:(0,ee.isString)(a)?a.split("*"):[a]}},{key:"createScale",value:function(a,s,o,h){var v,m,E=this.scaleOptions[s]&&((v=this.scaleOptions[s])===null||v===void 0?void 0:v.field)===a?this.scaleOptions[s]:this.scaleOptions[a],A={field:a,scale:void 0,type:Rv.VARIABLE,option:E};if(!h||!h.length)return E&&E.type?A.scale=this.createDefaultScale(E):(A.scale=ym([a]),A.type=Rv.CONSTANT),A;var F=(m=h.find(function(j){return!(0,ee.isNil)(j[a])}))===null||m===void 0?void 0:m[a];if(this.isNumber(a)||(0,ee.isNil)(F)&&!E)A.scale=ym([a]),A.type=Rv.CONSTANT;else{var B=E&&E.type||this.getDefaultType(F);o==="text"&&(B=Ps.CAT);var V=this.createScaleConfig(B,a,E,h);A.scale=this.createDefaultScale(V),A.option=V}return A}},{key:"getDefaultType",value:function(a){var s=Ps.LINEAR;return typeof a=="string"&&(s=lA.test(a)?Ps.TIME:Ps.CAT),s}},{key:"createScaleConfig",value:function(a,s,o,h){var v={type:a},m=(h==null?void 0:h.map(function(F){return F[s]}))||[];if(o!=null&&o.domain)v.domain=o==null?void 0:o.domain;else if(a===Ps.CAT||a===Ps.IDENTITY)v.domain=(0,ee.uniq)(m);else if(a===Ps.QUANTILE)v.domain=m;else if(a===Ps.DIVERGING){var E=Ok(m),A=(o==null?void 0:o.neutral)!==void 0?o==null?void 0:o.neutral:(E[0]+E[1])/2;v.domain=[E[0],A,E[1]]}else v.domain=Ok(m);return(0,q.Z)((0,q.Z)({},v),o)}},{key:"createDefaultScale",value:function(a){var s=a.type,o=a.domain,h=a.unknown,v=a.clamp,m=a.nice,E=Fb[s]();return o&&E.domain&&E.domain(o),h&&E.unknown(h),v!==void 0&&E.clamp&&E.clamp(v),m!==void 0&&E.nice&&E.nice(m),E}}]),n}())||Ob),b_,cA,vL=(b_=(0,It.b2)(),b_(cA=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){var s=a.animateStatus;s&&a.models.forEach(function(o){o.addUniforms((0,q.Z)({},a.layerModel.getAnimateUniforms()))})})}}]),n}())||cA),gL=function(){function n(l){var a=l.rendererService,s=l.layerService,o=l.parent;(0,ct.Z)(this,n),(0,X.Z)(this,"tileResource",new Map),(0,X.Z)(this,"_tiles",[]),this.rendererService=a,this.layerService=s,this.parent=o}return(0,et.Z)(n,[{key:"tiles",get:function(){return this._tiles}},{key:"hasTile",value:function(a){return this._tiles.some(function(s){return s.key===a})}},{key:"addTile",value:function(a){this._tiles.push(a)}},{key:"getTile",value:function(a){return this._tiles.find(function(s){return s.key===a})}},{key:"getVisibleTileBylngLat",value:function(a){return this._tiles.find(function(s){return s.isLoaded&&s.visible&&s.lnglatInBounds(a)})}},{key:"removeTile",value:function(a){var s=this._tiles.findIndex(function(h){return h.key===a}),o=this._tiles.splice(s,1);o[0]&&o[0].destroy()}},{key:"updateTileVisible",value:function(a){var s=this.getTile(a.key);s==null||s.updateVisible(a.isVisible)}},{key:"isParentLoaded",value:function(a){var s=a.parent;if(!s)return!0;var o=this.getTile(s==null?void 0:s.key);return!!(o!=null&&o.isLoaded)}},{key:"isChildrenLoaded",value:function(a){var s=this,o=a==null?void 0:a.children;return o.length===0?!0:o.some(function(h){var v=s.getTile(h==null?void 0:h.key);return(v==null?void 0:v.isLoaded)===!1})}},{key:"render",value:function(){var l=(0,lt.Z)(it().mark(function s(){var o=this,h;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:h=this.getRenderLayers(),h.map(function(){var E=(0,lt.Z)(it().mark(function A(F){return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,o.layerService.renderLayer(F);case 2:case"end":return V.stop()}},A)}));return function(A){return E.apply(this,arguments)}}());case 2:case"end":return m.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"getRenderLayers",value:function(){var a=this._tiles.filter(function(o){return o.visible&&o.isLoaded}),s=[];return a.map(function(o){return s.push.apply(s,(0,me.Z)(o.getLayers()))}),s}},{key:"getLayers",value:function(){var a=this._tiles.filter(function(o){return o.isLoaded}),s=[];return a.map(function(o){return s.push.apply(s,(0,me.Z)(o.getLayers()))}),s}},{key:"getTiles",value:function(){return this._tiles}},{key:"destroy",value:function(){this._tiles.forEach(function(a){return a.destroy()}),this.tileResource.clear()}}]),n}(),mL=ot(32676);function yL(n,l,a){a===void 0&&(a={});var s=by(n),o=by(l),h=mL.union(s.coordinates,o.coordinates);return h.length===0?null:h.length===1?Hc(h[0],a.properties):md(h,a.properties)}var _L=yL,xL=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"getCombineFeature",value:function(a){var s=null,o=a[0];return a.map(function(h){var v=Hc(h.coordinates);s===null?s=v:s=_L(s,v)}),o&&(s.properties=(0,q.Z)({},o)),s}}]),n}(),E_="select",fh="active",Rb=function(){function n(l){var a=l.layerService,s=l.tileLayerService,o=l.parent;(0,ct.Z)(this,n),(0,X.Z)(this,"tilePickID",new Map),this.layerService=a,this.tileLayerService=s,this.parent=o,this.tileSourceService=new xL}return(0,et.Z)(n,[{key:"pickRender",value:function(a){var s=this.tileLayerService.getVisibleTileBylngLat(a.lngLat);if(s){var o=s.getMainLayer();o==null||o.layerPickService.pickRender(a)}}},{key:"pick",value:function(a,s){var o=this.parent.getContainer(),h=o.get(Dt.IPickingService);if(a.type==="RasterLayer"){var v=this.tileLayerService.getVisibleTileBylngLat(s.lngLat);if(v&&v.getMainLayer()!==void 0){var m=v.getMainLayer();return m.layerPickService.pickRasterLayer(m,s,this.parent)}return!1}return this.pickRender(s),h.pickFromPickingFBO(a,s)}},{key:"selectFeature",value:function(a){var s=(0,ht.Z)(a,3),o=s[0],h=s[1],v=s[2],m=this.color2PickId(o,h,v);this.tilePickID.set(E_,m),this.updateHighLight(o,h,v,E_)}},{key:"highlightPickedFeature",value:function(a){var s=(0,ht.Z)(a,3),o=s[0],h=s[1],v=s[2],m=this.color2PickId(o,h,v);this.tilePickID.set(fh,m),this.updateHighLight(o,h,v,fh)}},{key:"updateHighLight",value:function(a,s,o,h){this.tileLayerService.tiles.map(function(v){var m=v.getMainLayer();switch(h){case E_:m==null||m.hooks.beforeSelect.call([a,s,o]);break;case fh:m==null||m.hooks.beforeHighlight.call([a,s,o]);break}})}},{key:"setPickState",value:function(){var a=this.tilePickID.get(E_),s=this.tilePickID.get(fh);if(a){var o=this.pickId2Color(a),h=(0,ht.Z)(o,3),v=h[0],m=h[1],E=h[2];this.updateHighLight(v,m,E,E_);return}if(s){var A=this.pickId2Color(s),F=(0,ht.Z)(A,3),B=F[0],V=F[1],j=F[2];this.updateHighLight(B,V,j,fh);return}}},{key:"color2PickId",value:function(a,s,o){return cr(new Uint8Array([a,s,o]))}},{key:"pickId2Color",value:function(a){return ar(a)}},{key:"getFeatureById",value:function(a){var s=this.tileLayerService.getTiles().filter(function(h){return h.visible}),o=[];return s.map(function(h){o.push.apply(o,(0,me.Z)(h.getFeatureById(a)))}),o.length<=0?null:[]}},{key:"pickRasterLayer",value:function(a,s,o){return!1}}]),n}();function bL(n){return n==="PolygonLayer"?Zx:n==="LineLayer"?wg:Gy}function w_(n){return["PolygonLayer","LineLayer"].indexOf(n)!==-1}var Z0=function(){function n(l,a){(0,ct.Z)(this,n),(0,X.Z)(this,"visible",!0),(0,X.Z)(this,"layers",[]),(0,X.Z)(this,"isLoaded",!1),this.parent=a,this.sourceTile=l,this.x=l.x,this.y=l.y,this.z=l.z,this.key="".concat(this.x,"_").concat(this.y,"_").concat(this.z)}return(0,et.Z)(n,[{key:"getLayers",value:function(){return this.layers}},{key:"styleUpdate",value:function(){}},{key:"lnglatInBounds",value:function(a){var s=(0,ht.Z)(this.sourceTile.bounds,4),o=s[0],h=s[1],v=s[2],m=s[3],E=a.lng,A=a.lat;return E>=o&&E<=v&&A>=h&&A<=m}},{key:"getLayerOptions",value:function(){var a=this.parent.getLayerConfig();return(0,q.Z)((0,q.Z)({},a),{},{autoFit:!1,mask:w_(this.parent.type)||a.mask})}},{key:"addMask",value:function(){var l=(0,lt.Z)(it().mark(function s(o,h){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=cy(this.parent.sceneContainer),h.setContainer(v,this.parent.sceneContainer),E.next=4,h.init();case 4:o.addMaskLayer(h);case 5:case"end":return E.stop()}},s,this)}));function a(s,o){return l.apply(this,arguments)}return a}()},{key:"addLayer",value:function(){var l=(0,lt.Z)(it().mark(function s(o){var h;return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return o.isTileLayer=!0,h=cy(this.parent.sceneContainer),o.setContainer(h,this.parent.sceneContainer),this.layers.push(o),m.next=6,o.init();case 6:case"end":return m.stop()}},s,this)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"updateVisible",value:function(a){this.visible=a,this.updateOptions("visible",a)}},{key:"updateOptions",value:function(a,s){this.layers.forEach(function(o){o.updateLayerConfig((0,X.Z)({},a,s))})}},{key:"getMainLayer",value:function(){return this.layers[0]}},{key:"getFeatures",value:function(a){return[]}},{key:"getFeatureById",value:function(a){return[]}},{key:"destroy",value:function(){this.layers.forEach(function(a){return a.destroy()})}}]),n}();function EL(n){var l=wL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function wL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var S_=function(n){(0,Zt.Z)(a,n);var l=EL(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=bL(this.parent.type),A=this.getSourceOption(),A){V.next=7;break}return this.isLoaded=!0,V.abrupt("return");case 7:if(F=new E((0,q.Z)({},m)).source(A.data,A.options),Object.keys(v).forEach(function(j){var at,ut,xt=j;F[xt]((at=v[xt])===null||at===void 0?void 0:at.field,(ut=v[xt])===null||ut===void 0?void 0:ut.values)}),!m.mask){V.next=12;break}return V.next=12,this.addTileMask(F);case 12:return V.next=14,this.addLayer(F);case 14:this.setLayerMinMaxZoom(F),this.isLoaded=!0;case 16:case"end":return V.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"addTileMask",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return m=new Hy({layerType:"MaskLayer"}).source({type:"FeatureCollection",features:[this.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}),A.next=3,this.addMask(v,m);case 3:case"end":return A.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.parent.getLayerConfig(),v=h.sourceLayer,m=v===void 0?"defaultLayer":v,E=h.featureId,A=E===void 0?"id":E,F=this.getFeatures(m);return{data:{type:"FeatureCollection",features:F},options:{parser:{type:"geojson",featureId:A},transforms:o.transforms}}}},{key:"setLayerMinMaxZoom",value:function(o){o.getModelType()==="text"&&o.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}},{key:"getFeatures",value:function(o){var h=this.sourceTile.data;return h.getTileData(o)}},{key:"getFeatureById",value:function(o){var h=this.getMainLayer();return h?h.getSource().data.dataArray.filter(function(v){return v._id===o}):[]}}]),a}(Z0);function SL(n){var l=CL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function CL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var AL=function(n){(0,Zt.Z)(a,n);var l=SL(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.getSourceOption(),m=v.data.features[0].properties,E=new wg().source(v.data,v.options).size(1).shape("line").color("red"),A=new Gy({minZoom:this.z-1,maxZoom:this.z+1}).source([m],{parser:{type:"json",x:"textLng",y:"textLat"}}).size(20).color("red").shape(this.key).style({stroke:"#fff",strokeWidth:2}),B.next=6,this.addLayer(E);case 6:return B.next=8,this.addLayer(A);case 8:this.isLoaded=!0;case 9:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.sourceTile.data.layers.testTile.features;return{data:{type:"FeatureCollection",features:h},options:{parser:{type:"geojson"},transforms:o.transforms}}}}]),a}(Z0);function TL(n){var l=ML();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ML(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var IL=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
varying vec2 v_texCoord;
void main() {
  vec4 color = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y));
  gl_FragColor = color;
  gl_FragColor.a *= u_opacity;
}
`,kL=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,fA=function(n){(0,Zt.Z)(a,n);var l=TL(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity;return{u_opacity:h||1,u_texture:this.texture}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v=this,m,E,A,F,B,V,j,at,ut,xt,Nt;return it().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:if(m=this.layer.getLayerConfig(),E=m.mask,A=E===void 0?!1:E,F=m.maskInside,B=F===void 0?!0:F,V=this.layer.getSource(),j=this.rendererService.createTexture2D,this.texture=j({height:0,width:0}),!_u){fe.next=12;break}at=this.layerService.sceneService.getSceneConfig().canvas,ut=at.createImage(),ut.crossOrigin="anonymous",ut.src=V.data.originData,ut.onload=function(){v.texture=j({data:ut,width:ut.width,height:ut.height}),v.layerService.reRender()},fe.next=16;break;case 12:return fe.next=14,V.data.images;case 14:xt=fe.sent,this.texture=j({data:xt[0],width:xt[0].width,height:xt[0].height,mag:Jt.LINEAR,min:Jt.LINEAR});case 16:return fe.next=18,this.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:kL,fragmentShader:IL,triangulation:Oy,primitive:Jt.TRIANGLES,blend:{enable:!0},depth:{enable:!1},stencil:Rr(A,B)});case 18:return Nt=fe.sent,fe.abrupt("return",[Nt]);case 20:case"end":return fe.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Ss),LL={image:fA},PL=LL;function C_(n){var l=ld();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function ld(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var hA=function(n){(0,Zt.Z)(a,n);var l=C_(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"type","ImageLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new PL[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={image:{}};return h[o]}},{key:"getModelType",value:function(){return"image"}}]),a}(dg);function Db(n){var l=OL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function OL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var FL=function(n){(0,Zt.Z)(a,n);var l=Db(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new hA((0,q.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,at,ut=V;A[ut]((j=v[ut])===null||j===void 0?void 0:j.field,(at=v[ut])===null||at===void 0?void 0:at.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}]),a}(Z0);function Bb(n){var l=Mp();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Mp(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var pA=`precision mediump float;
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;
uniform float u_min;
uniform float u_max;
uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;
varying vec2 v_texCoord;
bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }


void main() {

  float value = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value))
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1]))
    gl_FragColor = vec4(0, 0, 0, 0);
  else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] -u_domain[0]);
    vec4 color = texture2D(u_colorTexture,vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,dA=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,Nb=function(n){(0,Zt.Z)(a,n);var l=Bb(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.clampLow,E=m===void 0?!0:m,A=o.clampHigh,F=A===void 0?!0:A,B=o.noDataValue,V=B===void 0?-9999999:B,j=o.domain,at=j===void 0?[0,1]:j,ut=o.rampColors;return this.colorTexture=this.layer.textureService.getColorTexture(ut),{u_opacity:v||1,u_texture:this.texture,u_domain:at,u_clampLow:E,u_clampHigh:typeof F!="undefined"?F:E,u_noDataValue:V,u_colorTexture:this.colorTexture}}},{key:"getRasterData",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m,E,A,F;return it().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!Array.isArray(v.data)){V.next=4;break}return V.abrupt("return",{data:v.data,width:v.width,height:v.height});case 4:return V.next=6,v.data;case 6:return m=V.sent,E=m.rasterData,A=m.width,F=m.height,V.abrupt("return",{data:Array.from(E),width:A,height:F});case 11:case"end":return V.stop()}},h)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt,de;return it().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.layer.getSource(),V=this.rendererService.createTexture2D,j=B.data.dataArray[0],Ne.next=6,this.getRasterData(j);case 6:return at=Ne.sent,ut=at.data,xt=at.width,Nt=at.height,this.texture=V({data:ut,width:xt,height:Nt,format:Jt.LUMINANCE,type:Jt.FLOAT}),Ne.next=13,this.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:dA,fragmentShader:pA,triangulation:Oy,primitive:Jt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 13:return de=Ne.sent,Ne.abrupt("return",[de]);case 15:case"end":return Ne.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o,h;(o=this.texture)===null||o===void 0||o.destroy(),(h=this.colorTexture)===null||h===void 0||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}},{key:"updateColorTexture",value:function(){var o=this.rendererService.createTexture2D,h=this.layer.getLayerConfig(),v=h.rampColors,m=br(v);this.colorTexture=o({data:m.data,width:m.width,height:m.height,flipY:!1})}}]),a}(Ss),zb=["data"],vA=["rasterData"];function RL(n){var l=DL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function DL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var BL=`precision mediump float;
uniform vec2 u_rminmax: vec2(0,255); 
uniform vec2 u_gminmax: vec2(0,255);
uniform vec2 u_bminmax: vec2(0,255);
uniform float u_opacity: 1.0;
uniform sampler2D u_texture;
uniform float u_noDataValue : 0.0;
varying vec2 v_texCoord;

void main() {
  vec3 rgb = texture2D(u_texture,vec2(v_texCoord.x,v_texCoord.y)).rgb;
  if(rgb == vec3(u_noDataValue)) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    gl_FragColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }
 
}`,TF=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));

   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,NL=function(n){(0,Zt.Z)(a,n);var l=RL(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"dataOption",{}),s}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=h===void 0?1:h,m=o.noDataValue,E=m===void 0?0:m,A=this.dataOption,F=A.rMinMax,B=A.gMinMax,V=A.bMinMax;return{u_opacity:v||1,u_texture:this.texture,u_noDataValue:E,u_rminmax:F,u_gminmax:B,u_bminmax:V}}},{key:"getRasterData",value:function(){var s=(0,lt.Z)(it().mark(function h(v){var m,E,A,F,B;return it().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!Array.isArray(v.data)){j.next=4;break}return m=v.data,E=(0,Wl.Z)(v,zb),this.dataOption=E,j.abrupt("return",(0,q.Z)({data:m},E));case 4:return j.next=6,v.data;case 6:if(A=j.sent,F=A.rasterData,B=(0,Wl.Z)(A,vA),this.dataOption=B,!Array.isArray(F)){j.next=14;break}return j.abrupt("return",(0,q.Z)({data:F},B));case 14:return j.abrupt("return",(0,q.Z)({data:Array.from(F)},B));case 15:case"end":return j.stop()}},h,this)}));function o(h){return s.apply(this,arguments)}return o}()},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt,de;return it().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.layer.getSource(),V=this.rendererService.createTexture2D,j=B.data.dataArray[0],Ne.next=6,this.getRasterData(j);case 6:return at=Ne.sent,ut=at.data,xt=at.width,Nt=at.height,this.texture=V({data:ut,width:xt,height:Nt,format:Jt.RGB,type:Jt.FLOAT}),Ne.next=13,this.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:TF,fragmentShader:BL,triangulation:Oy,primitive:Jt.TRIANGLES,depth:{enable:!1},stencil:Rr(E,F)});case 13:return de=Ne.sent,Ne.abrupt("return",[de]);case 15:case"end":return Ne.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Ss);function zL(n){var l=gA();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function gA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Ub=`precision mediump float;
uniform float u_opacity: 1.0;

uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

varying vec2 v_texCoord;

uniform vec2 u_domain;
uniform float u_noDataValue;
uniform bool u_clampLow: true;
uniform bool u_clampHigh: true;

void main() {
  vec4 baseColor = texture2D(u_texture, vec2(v_texCoord.x, v_texCoord.y)) * 256.0;
  float r = baseColor.r * 256.0 * 256.0;
  float g = baseColor.g * 256.0;
  float b = baseColor.b;
  float value =  (r + g + b) * 0.1 - 10000.0;
  
  if (value == u_noDataValue) {
    gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else if ((!u_clampLow && value < u_domain[0]) || (!u_clampHigh && value > u_domain[1])) {
     gl_FragColor = vec4(0.0, 0, 0, 0.0);
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture2D(u_colorTexture, vec2(normalisedValue, 0));
    gl_FragColor = color;
    gl_FragColor.a =  gl_FragColor.a * u_opacity ;
  }
}
`,UL=`precision highp float;
uniform mat4 u_ModelMatrix;
uniform mat4 u_Mvp;
attribute vec3 a_Position;
attribute vec2 a_Uv;
varying vec2 v_texCoord;
#pragma include "projection"
void main() {
   v_texCoord = a_Uv;
   vec4 project_pos = project_position(vec4(a_Position, 1.0));
   // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x
      gl_Position = u_Mvp * (vec4(project_pos.xy,0., 1.0));
   } else {
      gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy,0., 1.0));
   }
}
`,ZL=function(n){(0,Zt.Z)(a,n);var l=zL(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getUninforms",value:function(){var o=this.layer.getLayerConfig(),h=o.opacity,v=o.clampLow,m=v===void 0?!0:v,E=o.clampHigh,A=E===void 0?!0:E,F=o.noDataValue,B=F===void 0?-9999999:F,V=o.domain,j=V===void 0?[0,1]:V,at=o.rampColors,ut=o.colorTexture,xt=ut;return ut?this.layer.textureService.setColorTexture(ut,at):xt=this.layer.textureService.getColorTexture(at),{u_opacity:h||1,u_texture:this.texture,u_domain:j,u_clampLow:m,u_clampHigh:typeof A!="undefined"?A:m,u_noDataValue:B,u_colorTexture:xt}}},{key:"initModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at;return it().wrap(function(xt){for(;;)switch(xt.prev=xt.next){case 0:return v=this.layer.getLayerConfig(),m=v.mask,E=m===void 0?!1:m,A=v.maskInside,F=A===void 0?!0:A,B=this.layer.getSource(),V=this.rendererService.createTexture2D,xt.next=5,B.data.images;case 5:return j=xt.sent,this.texture=V({data:j[0],width:j[0].width,height:j[0].height}),xt.next=9,this.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:UL,fragmentShader:Ub,triangulation:Oy,primitive:Jt.TRIANGLES,depth:{enable:!1},blend:this.getBlend(),stencil:Rr(E,F)});case 9:return at=xt.sent,xt.abrupt("return",[at]);case 11:case"end":return xt.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"clearModels",value:function(){var o;(o=this.texture)===null||o===void 0||o.destroy()}},{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.initModels();case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"uv",type:Vi.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:2,update:function(h,v,m){return[m[3],m[4]]}}})}}]),a}(Ss),VL={raster:Nb,rasterRgb:NL,raster3d:Nb,rasterTerrainRgb:ZL},GL=VL;function HL(n){var l=jL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function jL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var Pm=function(n){(0,Zt.Z)(a,n);var l=HL(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"type","RasterLayer"),s}return(0,et.Z)(a,[{key:"buildModels",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return v=this.getModelType(),this.layerModel=new GL[v](this),E.next=4,this.initLayerModels();case 4:case"end":return E.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getDefaultConfig",value:function(){var o=this.getModelType(),h={raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}};return h[o]}},{key:"getModelType",value:function(){var o=this.layerSource.getParserType();switch(o){case"raster":return"raster";case"rasterRgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}}]),a}(dg),WL=["rasterData"];function XL(n){var l=Zb();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function Zb(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var MF={positions:[0,1],colors:["#000","#fff"]},YL=function(n){(0,Zt.Z)(a,n);var l=XL(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),this.colorTexture=this.parent.textureService.getColorTexture(m.rampColors),A=new Pm((0,q.Z)((0,q.Z)({},m),{},{colorTexture:this.colorTexture})).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,at,ut=V;A[ut]((j=v[ut])===null||j===void 0?void 0:j.field,(at=v[ut])===null||at===void 0?void 0:at.values)}),B.next=8,this.addLayer(A);case 8:this.isLoaded=!0;case 9:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.sourceTile.data.data,v=h.rasterData,m=(0,Wl.Z)(h,WL);return{data:v,options:{parser:(0,q.Z)({type:"raster",extent:this.sourceTile.bounds},m),transforms:o.transforms}}}},{key:"styleUpdate",value:function(){for(var o=this,h=arguments.length,v=new Array(h),m=0;m<h;m++)v[m]=arguments[m];var E=v.rampColors,A=E===void 0?MF:E;this.colorTexture=this.parent.textureService.getColorTexture(A),this.layers.forEach(function(F){return F.style({colorTexture:o.colorTexture})})}},{key:"destroy",value:function(){this.layers.forEach(function(o){return o.destroy()})}}]),a}(Z0),$L=["rasterData"];function qL(n){var l=KL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function KL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var QL=function(n){(0,Zt.Z)(a,n);var l=qL(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new Pm((0,q.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,at,ut=V;A[ut]((j=v[ut])===null||j===void 0?void 0:j.field,(at=v[ut])===null||at===void 0?void 0:at.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.sourceTile.data.data,v=h.rasterData,m=(0,Wl.Z)(h,$L);return{data:v,options:{parser:(0,q.Z)({type:"rasterRgb",extent:this.sourceTile.bounds},m),transforms:o.transforms}}}}]),a}(Z0);function mA(n){var l=JL();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function JL(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var tP=function(n){(0,Zt.Z)(a,n);var l=mA(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new Pm((0,q.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,at,ut=V;A[ut]((j=v[ut])===null||j===void 0?void 0:j.field,(at=v[ut])===null||at===void 0?void 0:at.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getSourceOption",value:function(){var o=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:o.transforms}}}}]),a}(Z0);function eP(n){var l=rP();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function rP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var nP=function(n){(0,Zt.Z)(a,n);var l=eP(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"initTileLayer",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A;return it().wrap(function(B){for(;;)switch(B.prev=B.next){case 0:return v=this.parent.getLayerAttributeConfig(),m=this.getLayerOptions(),E=this.getSourceOption(),A=new Hy((0,q.Z)({},m)).source(E.data,E.options),v&&Object.keys(v).forEach(function(V){var j,at,ut=V;A[ut]((j=v[ut])===null||j===void 0?void 0:j.field,(at=v[ut])===null||at===void 0?void 0:at.values)}),B.next=7,this.addLayer(A);case 7:this.isLoaded=!0;case 8:case"end":return B.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getFeatures",value:function(o){if(!o)return[];var h=this.sourceTile.data;return h.getTileData(o)}},{key:"getSourceOption",value:function(){var o=this.parent.getSource(),h=this.parent.getLayerConfig(),v=h.sourceLayer,m=h.featureId,E=this.getFeatures(v);return{data:{type:"FeatureCollection",features:E},options:{parser:{type:"geojson",featureId:m},transforms:o.transforms}}}}]),a}(Z0);function iP(n){var l=n.type;switch(l){case"PolygonLayer":return S_;case"LineLayer":return S_;case"PointLayer":return S_;case"TileDebugLayer":return AL;case"MaskLayer":return nP;case"RasterLayer":var a=n.getSource().parser.dataType;switch(a){case"rgb":case"customRGB":return QL;case"arraybuffer":case"customArrayBuffer":return YL;case"terrainRGB":return tP;default:return FL}default:return S_}}var aP=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive"],yA=function(){function n(l){(0,ct.Z)(this,n),(0,X.Z)(this,"initedTileset",!1),(0,X.Z)(this,"viewchange",(0,ee.debounce)(this.mapchange,24)),this.parent=l;var a=this.parent.getContainer();this.rendererService=a.get(Dt.IRendererService),this.layerService=a.get(Dt.ILayerService),this.mapService=a.get(Dt.IMapService),this.pickingService=a.get(Dt.IPickingService),this.tileLayerService=new gL({rendererService:this.rendererService,layerService:this.layerService,parent:l}),this.tilePickService=new Rb({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:l}),this.parent.setLayerPickService(this.tilePickService),this.proxy(l),this.initTileSetManager()}return(0,et.Z)(n,[{key:"initTileSetManager",value:function(){var a,s=this.parent.getSource();this.tilesetManager=s.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0);var o=this.getCurrentView(),h=o.latLonBounds,v=o.zoom;(a=this.tilesetManager)===null||a===void 0||a.update(v,h)}},{key:"mapchange",value:function(){var a,s=this.getCurrentView(),o=s.latLonBounds,h=s.zoom;if(this.mapService.version==="GAODE1.x"){var v=this.parent.getLayerConfig(),m=v.visible;h<2&&m?(this.parent.updateLayerConfig({visible:!1}),this.layerService.reRender()):h>=2&&!m&&(this.parent.updateLayerConfig({visible:!0}),this.layerService.reRender())}this.lastViewStates&&this.lastViewStates.zoom===h&&this.lastViewStates.latLonBounds.toString()===o.toString()||(this.lastViewStates={zoom:h,latLonBounds:o},(a=this.tilesetManager)===null||a===void 0||a.throttleUpdate(h,o))}},{key:"getCurrentView",value:function(){var a=this.mapService.getBounds(),s=[a[0][0],a[0][1],a[1][0],a[1][1]],o=this.mapService.getZoom();return{latLonBounds:s,zoom:o}}},{key:"bindTilesetEvent",value:function(){var a=this;this.tilesetManager.on("tile-loaded",function(s){}),this.tilesetManager.on("tile-unload",function(s){a.tileUnLoad(s)}),this.tilesetManager.on("tile-error",function(s,o){a.tileError(s)}),this.tilesetManager.on("tile-update",function(){a.tileUpdate()}),this.mapService.on("zoomend",function(){return a.mapchange()}),this.mapService.on("moveend",function(){return a.viewchange()})}},{key:"render",value:function(){this.tileLayerService.render()}},{key:"getLayers",value:function(){return this.tileLayerService.getLayers()}},{key:"getTiles",value:function(){return this.tileLayerService.getTiles()}},{key:"tileLoaded",value:function(a){}},{key:"tileError",value:function(a){console.warn("error:",a)}},{key:"destroy",value:function(){var a;(a=this.tilesetManager)===null||a===void 0||a.destroy(),this.tileLayerService.destroy()}},{key:"tileUnLoad",value:function(a){this.tileLayerService.removeTile(a.key)}},{key:"tileUpdate",value:function(){var l=(0,lt.Z)(it().mark(function s(){var o=this,h,v;return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(this.tilesetManager){E.next=2;break}return E.abrupt("return");case 2:return h=this.parent.getMinZoom(),v=this.parent.getMaxZoom(),E.next=6,Promise.all(this.tilesetManager.tiles.filter(function(A){return A.isLoaded}).filter(function(A){return A.isVisibleChange}).filter(function(A){return A.data}).filter(function(A){return A.z>=h&&A.z<v}).map(function(){var A=(0,lt.Z)(it().mark(function F(B){var V,j;return it().wrap(function(ut){for(;;)switch(ut.prev=ut.next){case 0:if(o.tileLayerService.hasTile(B.key)){ut.next=9;break}return V=iP(o.parent),j=new V(B,o.parent),ut.next=5,j.initTileLayer();case 5:o.tilePickService.setPickState(),j.getLayers().length!==0&&(o.tileLayerService.addTile(j),o.tileLayerService.updateTileVisible(B),o.layerService.reRender()),ut.next=12;break;case 9:o.tileLayerService.updateTileVisible(B),o.tilePickService.setPickState(),o.layerService.reRender();case 12:case"end":return ut.stop()}},F)}));return function(F){return A.apply(this,arguments)}}()));case 6:this.tilesetManager.isLoaded&&this.parent.emit("tiles-loaded",this.tilesetManager.currentTiles);case 7:case"end":return E.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"setPickState",value:function(a){}},{key:"pickRender",value:function(a){this.tilePickService.pickRender(a)}},{key:"selectFeature",value:function(a){this.tilePickService.selectFeature(a)}},{key:"highlightPickedFeature",value:function(a){this.tilePickService.highlightPickedFeature(a)}},{key:"proxy",value:function(a){var s=this;aP.forEach(function(o){var h=a[o].bind(a);a[o]=function(){for(var v=arguments.length,m=new Array(v),E=0;E<v;E++)m[E]=arguments[E];return h.apply(void 0,m),s.getLayers().map(function(A){A[o].apply(A,m)}),o==="style"&&s.getTiles().forEach(function(A){return A.styleUpdate.apply(A,m)}),a}})}}]),n}(),_A,oP,Vh=(_A=(0,It.b2)(),_A(oP=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"initLayerModel",value:function(){var l=(0,lt.Z)(it().mark(function s(o){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o.prepareBuildModel(),v.next=3,o.buildModels();case 3:o.styleNeedUpdate=!1;case 4:case"end":return v.stop()}},s)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"prepareLayerModel",value:function(){var l=(0,lt.Z)(it().mark(function s(o){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return o.prepareBuildModel(),v.next=3,o.buildModels();case 3:case"end":return v.stop()}},s)}));function a(s){return l.apply(this,arguments)}return a}()},{key:"apply",value:function(a){var s=this;a.hooks.init.tapPromise("LayerModelPlugin",(0,lt.Z)(it().mark(function o(){return it().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!a.getSource().isTile){v.next=4;break}return a.prepareBuildModel(),a.tileLayer=new yA(a),v.abrupt("return");case 4:return v.next=6,s.initLayerModel(a);case 6:case"end":return v.stop()}},o)}))),a.hooks.beforeRenderData.tapPromise("LayerModelPlugin",function(){var o=(0,lt.Z)(it().mark(function h(v){return it().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(v){E.next=2;break}return E.abrupt("return",!1);case 2:if(!a.getSource().isTile){E.next=5;break}return a.tileLayer=new yA(a),E.abrupt("return",!1);case 5:return E.next=7,s.prepareLayerModel(a);case 7:return E.abrupt("return",!0);case 8:case"end":return E.stop()}},h)}));return function(h){return o.apply(this,arguments)}}())}}]),n}())||oP),Yv,xA,bA=(Yv=(0,It.b2)(),Yv(xA=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.afterInit.tap("LayerStylePlugin",function(){var s=a.getLayerConfig(),o=s.autoFit,h=s.fitBoundsOptions;o&&a.fitBounds(h)})}}]),n}())||xA),Vb,Gb,Hb=["type"],EA={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},sP={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},uP={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},lP={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function cP(n){var l={u_DirectionalLights:new Array(3).fill((0,q.Z)({},uP)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill((0,q.Z)({},lP)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[sP]),n.forEach(function(a){var s=a.type,o=s===void 0?"directional":s,h=(0,Wl.Z)(a,Hb),v=EA[o].lights,m=EA[o].num,E=l[m];l[v][E]=(0,q.Z)((0,q.Z)({},l[v][E]),h),l[m]++}),l}var fP=(Vb=(0,It.b2)(),Vb(Gb=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("LightingPlugin",function(){var s=a.getLayerConfig(),o=s.enableLighting;o&&a.models.forEach(function(h){return h.addUniforms((0,q.Z)({},cP()))})})}}]),n}())||Gb),jb,Lg,A_=(jb=(0,It.b2)(),jb(Lg=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.rendererService,v=s.postProcessingPassFactory,m=s.normalPassFactory;a.hooks.init.tapPromise("MultiPassRendererPlugin",function(){var E=a.getLayerConfig(),A=E.enableMultiPassRenderer,F=E.passes,B=F===void 0?[]:F;o.enabled=!!A&&a.getLayerConfig().enableMultiPassRenderer!==!1,o.enabled&&(a.multiPassRenderer=cx(a,B,v,m),a.multiPassRenderer.setRenderFlag(!0))}),a.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){if(o.enabled){var E=h.getViewportSize(),A=E.width,F=E.height;a.multiPassRenderer.resize(A,F)}})}}]),n}())||Lg),Pg,Wb,T_={NONE:0,ENCODE:1,HIGHLIGHT:2},hP=(Pg=(0,It.b2)(),Pg(Wb=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var o=s.styleAttributeService;a.hooks.init.tapPromise("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;o.registerStyleAttribute({name:"pickingColor",type:Vi.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:Jt.FLOAT},size:3,update:function(E){var A=E.id;return v?ar(A):[0,0,0]}}})}),a.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;v&&a.isVisible()&&a.models.forEach(function(m){return m.addUniforms({u_PickingStage:T_.ENCODE})})}),a.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){var h=a.getLayerConfig(),v=h.enablePicking;v&&a.isVisible()&&a.models.forEach(function(m){return m.addUniforms({u_PickingStage:T_.HIGHLIGHT})})}),a.hooks.beforeHighlight.tap("PixelPickingPlugin",function(h){var v=a.getLayerConfig(),m=v.highlightColor,E=v.activeMix,A=E===void 0?0:E,F=typeof m=="string"?Le(m):m||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:cr(new Uint8Array(h))}),a.models.forEach(function(B){return B.addUniforms({u_PickingStage:T_.HIGHLIGHT,u_PickingColor:h,u_HighlightColor:F.map(function(V){return V*255}),u_activeMix:A})})}),a.hooks.beforeSelect.tap("PixelPickingPlugin",function(h){var v=a.getLayerConfig(),m=v.selectColor,E=v.selectMix,A=E===void 0?0:E,F=typeof m=="string"?Le(m):m||[1,0,0,1];a.updateLayerConfig({pickedFeatureID:cr(new Uint8Array(h))}),a.models.forEach(function(B){return B.addUniforms({u_PickingStage:T_.HIGHLIGHT,u_PickingColor:h,u_HighlightColor:F.map(function(V){return V*255}),u_activeMix:A,u_CurrentSelectedId:h,u_SelectColor:F.map(function(V){return V*255}),u_EnableSelect:1})})})}}]),n}())||Wb),wA=["mvt","geojsonvt","testTile"];function SA(n){var l=n.getSource();return wA.includes(l.parser.type)}function pP(n){return n.getContext?{width:n.width/DOM.DPR,height:n.height/DOM.DPR}:n.getBoundingClientRect()}var Xb,Om,M_=(Xb=(0,It.b2)(),Xb(Om=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("RegisterStyleAttributePlugin",function(){SA(a)||o.registerBuiltinAttributes(h,a)})}},{key:"registerBuiltinAttributes",value:function(a,s){if(s.type==="MaskLayer"){this.registerPositionAttribute(a);return}this.registerPositionAttribute(a),this.registerFilterAttribute(a),this.registerColorAttribute(a),this.registerVertexIdAttribute(a)}},{key:"registerPositionAttribute",value:function(a){a.registerStyleAttribute({name:"position",type:Vi.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:Jt.FLOAT},size:3,update:function(o,h,v){return v.length===2?[v[0],v[1],0]:[v[0],v[1],v[2]]}}})}},{key:"registerFilterAttribute",value:function(a){a.registerStyleAttribute({name:"filter",type:Vi.Attribute,descriptor:{name:"filter",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(o){var h=o.filter;return h?[1]:[0]}}})}},{key:"registerColorAttribute",value:function(a){a.registerStyleAttribute({name:"color",type:Vi.Attribute,descriptor:{name:"a_Color",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:4,update:function(o){var h=o.color;return!h||!h.length?[1,1,1,1]:h}}})}},{key:"registerVertexIdAttribute",value:function(a){a.registerStyleAttribute({name:"vertexId",type:Vi.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:Jt.DYNAMIC_DRAW,data:[],type:Jt.FLOAT},size:1,update:function(o,h){return[h]}}})}}]),n}())||Om),CA,AA,TA,MA,IA,kA,Og,LA,PA,dP,hh,I_=(CA=(0,It.b2)(),AA=(0,It.f3)(Dt.ICameraService),TA=(0,It.f3)(Dt.ICoordinateSystemService),MA=(0,It.f3)(Dt.IRendererService),IA=(0,It.f3)(Dt.IMapService),CA(kA=(Og=function(){function n(){(0,ct.Z)(this,n),Ar(this,"cameraService",LA,this),Ar(this,"coordinateSystemService",PA,this),Ar(this,"rendererService",dP,this),Ar(this,"mapService",hh,this)}return(0,et.Z)(n,[{key:"apply",value:function(a){var s=this,o=this.mapService.version,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],v=[0,0];a.hooks.beforeRender.tap("ShaderUniformPlugin",function(){var m=a.getLayerConfig().tileOrigin;s.coordinateSystemService.refresh(m),o==="GAODE2.x"&&(s.setLayerCenter(a),h=s.mapService.map.customCoords.getMVPMatrix(),v=s.mapService.getCustomCoordCenter());var E=s.rendererService.getViewportSize(),A=E.width,F=E.height;a.models.forEach(function(B){var V;B.addUniforms((V={},(0,X.Z)(V,d0.ProjectionMatrix,s.cameraService.getProjectionMatrix()),(0,X.Z)(V,d0.ViewMatrix,s.cameraService.getViewMatrix()),(0,X.Z)(V,d0.ViewProjectionMatrix,s.cameraService.getViewProjectionMatrix()),(0,X.Z)(V,d0.Zoom,s.cameraService.getZoom()),(0,X.Z)(V,d0.ZoomScale,s.cameraService.getZoomScale()),(0,X.Z)(V,d0.FocalDistance,s.cameraService.getFocalDistance()),(0,X.Z)(V,d0.CameraPosition,s.cameraService.getCameraPosition()),(0,X.Z)(V,Lf.CoordinateSystem,s.coordinateSystemService.getCoordinateSystem()),(0,X.Z)(V,Lf.ViewportCenter,s.coordinateSystemService.getViewportCenter()),(0,X.Z)(V,Lf.ViewportCenterProjection,s.coordinateSystemService.getViewportCenterProjection()),(0,X.Z)(V,Lf.PixelsPerDegree,s.coordinateSystemService.getPixelsPerDegree()),(0,X.Z)(V,Lf.PixelsPerDegree2,s.coordinateSystemService.getPixelsPerDegree2()),(0,X.Z)(V,Lf.PixelsPerMeter,s.coordinateSystemService.getPixelsPerMeter()),(0,X.Z)(V,Lf.Mvp,h),(0,X.Z)(V,"u_SceneCenterMKT",v),(0,X.Z)(V,"u_ViewportSize",[A,F]),(0,X.Z)(V,"u_ModelMatrix",s.cameraService.getModelMatrix()),(0,X.Z)(V,"u_DevicePixelRatio",Co.devicePixelRatio),(0,X.Z)(V,"u_PickingBuffer",a.getLayerConfig().pickingBuffer||0),(0,X.Z)(V,"u_shaderPick",Number(a.getShaderPickStat())),V))})})}},{key:"setLayerCenter",value:function(a){a.coordCenter===void 0&&(a.coordCenter=a.getSource().center),this.mapService.setCoordCenter&&this.mapService.setCoordCenter(a.coordCenter)}}]),n}(),LA=Dr(Og.prototype,"cameraService",[AA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PA=Dr(Og.prototype,"coordinateSystemService",[TA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dP=Dr(Og.prototype,"rendererService",[MA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hh=Dr(Og.prototype,"mapService",[IA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Og))||kA),k_,L_,vP=(k_=(0,It.b2)(),k_(L_=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a){a.hooks.beforeRender.tap("UpdateModelPlugin",function(){a.layerModel&&a.layerModel.needUpdate().then(function(s){s&&a.renderLayers()})}),a.hooks.afterRender.tap("UpdateModelPlugin",function(){a.layerModelNeedUpdate=!1})}}]),n}())||L_),OA,FA,gP=(OA=(0,It.b2)(),OA(FA=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"apply",value:function(a,s){var o=this,h=s.styleAttributeService;a.hooks.init.tapPromise("UpdateStyleAttributePlugin",function(){o.initStyleAttribute(a,{styleAttributeService:h})}),a.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){a.layerModelNeedUpdate||a.inited&&o.updateStyleAttribute(a,{styleAttributeService:h})})}},{key:"updateStyleAttribute",value:function(a,s){var o=s.styleAttributeService,h=o.getLayerStyleAttributes()||[],v=o.getLayerStyleAttribute("filter");if(v&&v.needRegenerateVertices){a.layerModelNeedUpdate=!0,h.forEach(function(m){return m.needRegenerateVertices=!1});return}h.filter(function(m){return m.needRegenerateVertices}).forEach(function(m){o.updateAttributeByFeatureRange(m.name,a.getEncodedData(),m.featureRange.startIndex,m.featureRange.endIndex,a),m.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(a,s){var o=s.styleAttributeService,h=o.getLayerStyleAttributes()||[];h.filter(function(v){return v.needRegenerateVertices}).forEach(function(v){o.updateAttributeByFeatureRange(v.name,a.getEncodedData(),v.featureRange.startIndex,v.featureRange.endIndex),v.needRegenerateVertices=!1})}}]),n}())||FA);sh.bind(Dt.ILayerPlugin).to(VS).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(M_).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(dL).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(Ik).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(bA).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(gP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(vP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(A_).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(I_).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(vL).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(fP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(hP).inRequestScope(),sh.bind(Dt.ILayerPlugin).to(Vh).inRequestScope();var RA=ot(88307),mP=ot.n(RA),yP=function(){function n(l,a){(0,ct.Z)(this,n);var s=a.buffer,o=a.offset,h=a.stride,v=a.normalized,m=a.size,E=a.divisor;this.buffer=s,this.attribute={buffer:s.get(),offset:o||0,stride:h||0,normalized:v||!1,divisor:E||0},m&&(this.attribute.size=m)}return(0,et.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(a){this.buffer.subData(a)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),rv,Fm,nv,Gh,Rm,$v,P_,Fg,cd,V0,wc,fd,Hh,qv,O_=(rv={},(0,X.Z)(rv,Jt.POINTS,"points"),(0,X.Z)(rv,Jt.LINES,"lines"),(0,X.Z)(rv,Jt.LINE_LOOP,"line loop"),(0,X.Z)(rv,Jt.LINE_STRIP,"line strip"),(0,X.Z)(rv,Jt.TRIANGLES,"triangles"),(0,X.Z)(rv,Jt.TRIANGLE_FAN,"triangle fan"),(0,X.Z)(rv,Jt.TRIANGLE_STRIP,"triangle strip"),rv),DA=(Fm={},(0,X.Z)(Fm,Jt.STATIC_DRAW,"static"),(0,X.Z)(Fm,Jt.DYNAMIC_DRAW,"dynamic"),(0,X.Z)(Fm,Jt.STREAM_DRAW,"stream"),Fm),Yb=(nv={},(0,X.Z)(nv,Jt.BYTE,"int8"),(0,X.Z)(nv,Jt.UNSIGNED_INT,"int16"),(0,X.Z)(nv,Jt.INT,"int32"),(0,X.Z)(nv,Jt.UNSIGNED_BYTE,"uint8"),(0,X.Z)(nv,Jt.UNSIGNED_SHORT,"uint16"),(0,X.Z)(nv,Jt.UNSIGNED_INT,"uint32"),(0,X.Z)(nv,Jt.FLOAT,"float"),nv),BA=(Gh={},(0,X.Z)(Gh,Jt.ALPHA,"alpha"),(0,X.Z)(Gh,Jt.LUMINANCE,"luminance"),(0,X.Z)(Gh,Jt.LUMINANCE_ALPHA,"luminance alpha"),(0,X.Z)(Gh,Jt.RGB,"rgb"),(0,X.Z)(Gh,Jt.RGBA,"rgba"),(0,X.Z)(Gh,Jt.RGBA4,"rgba4"),(0,X.Z)(Gh,Jt.RGB5_A1,"rgb5 a1"),(0,X.Z)(Gh,Jt.RGB565,"rgb565"),(0,X.Z)(Gh,Jt.DEPTH_COMPONENT,"depth"),(0,X.Z)(Gh,Jt.DEPTH_STENCIL,"depth stencil"),Gh),_P=(Rm={},(0,X.Z)(Rm,Jt.DONT_CARE,"dont care"),(0,X.Z)(Rm,Jt.NICEST,"nice"),(0,X.Z)(Rm,Jt.FASTEST,"fast"),Rm),NA=($v={},(0,X.Z)($v,Jt.NEAREST,"nearest"),(0,X.Z)($v,Jt.LINEAR,"linear"),(0,X.Z)($v,Jt.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,X.Z)($v,Jt.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,X.Z)($v,Jt.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,X.Z)($v,Jt.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),$v),zA=(P_={},(0,X.Z)(P_,Jt.REPEAT,"repeat"),(0,X.Z)(P_,Jt.CLAMP_TO_EDGE,"clamp"),(0,X.Z)(P_,Jt.MIRRORED_REPEAT,"mirror"),P_),xP=(Fg={},(0,X.Z)(Fg,Jt.NONE,"none"),(0,X.Z)(Fg,Jt.BROWSER_DEFAULT_WEBGL,"browser"),Fg),bP=(cd={},(0,X.Z)(cd,Jt.NEVER,"never"),(0,X.Z)(cd,Jt.ALWAYS,"always"),(0,X.Z)(cd,Jt.LESS,"less"),(0,X.Z)(cd,Jt.LEQUAL,"lequal"),(0,X.Z)(cd,Jt.GREATER,"greater"),(0,X.Z)(cd,Jt.GEQUAL,"gequal"),(0,X.Z)(cd,Jt.EQUAL,"equal"),(0,X.Z)(cd,Jt.NOTEQUAL,"notequal"),cd),UA=(V0={},(0,X.Z)(V0,Jt.FUNC_ADD,"add"),(0,X.Z)(V0,Jt.MIN_EXT,"min"),(0,X.Z)(V0,Jt.MAX_EXT,"max"),(0,X.Z)(V0,Jt.FUNC_SUBTRACT,"subtract"),(0,X.Z)(V0,Jt.FUNC_REVERSE_SUBTRACT,"reverse subtract"),V0),F_=(wc={},(0,X.Z)(wc,Jt.ZERO,"zero"),(0,X.Z)(wc,Jt.ONE,"one"),(0,X.Z)(wc,Jt.SRC_COLOR,"src color"),(0,X.Z)(wc,Jt.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,X.Z)(wc,Jt.SRC_ALPHA,"src alpha"),(0,X.Z)(wc,Jt.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,X.Z)(wc,Jt.DST_COLOR,"dst color"),(0,X.Z)(wc,Jt.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,X.Z)(wc,Jt.DST_ALPHA,"dst alpha"),(0,X.Z)(wc,Jt.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,X.Z)(wc,Jt.CONSTANT_COLOR,"constant color"),(0,X.Z)(wc,Jt.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,X.Z)(wc,Jt.CONSTANT_ALPHA,"constant alpha"),(0,X.Z)(wc,Jt.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,X.Z)(wc,Jt.SRC_ALPHA_SATURATE,"src alpha saturate"),wc),ZA=(fd={},(0,X.Z)(fd,Jt.NEVER,"never"),(0,X.Z)(fd,Jt.ALWAYS,"always"),(0,X.Z)(fd,Jt.LESS,"less"),(0,X.Z)(fd,Jt.LEQUAL,"lequal"),(0,X.Z)(fd,Jt.GREATER,"greater"),(0,X.Z)(fd,Jt.GEQUAL,"gequal"),(0,X.Z)(fd,Jt.EQUAL,"equal"),(0,X.Z)(fd,Jt.NOTEQUAL,"notequal"),fd),Rg=(Hh={},(0,X.Z)(Hh,Jt.ZERO,"zero"),(0,X.Z)(Hh,Jt.KEEP,"keep"),(0,X.Z)(Hh,Jt.REPLACE,"replace"),(0,X.Z)(Hh,Jt.INVERT,"invert"),(0,X.Z)(Hh,Jt.INCR,"increment"),(0,X.Z)(Hh,Jt.DECR,"decrement"),(0,X.Z)(Hh,Jt.INCR_WRAP,"increment wrap"),(0,X.Z)(Hh,Jt.DECR_WRAP,"decrement wrap"),Hh),VA=(qv={},(0,X.Z)(qv,Jt.FRONT,"front"),(0,X.Z)(qv,Jt.BACK,"back"),qv),EP=function(){function n(l,a){(0,ct.Z)(this,n);var s=a.data,o=a.usage,h=a.type;this.buffer=l.buffer({data:s,usage:DA[o||Jt.STATIC_DRAW],type:Yb[h||Jt.UNSIGNED_BYTE]})}return(0,et.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(a){var s=a.data,o=a.offset;this.buffer.subdata(s,o)}}]),n}(),hd=function(){function n(l,a){(0,ct.Z)(this,n);var s=a.data,o=a.usage,h=a.type,v=a.count;this.elements=l.elements({data:s,usage:DA[o||Jt.STATIC_DRAW],type:Yb[h||Jt.UNSIGNED_BYTE],count:v})}return(0,et.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(a){var s=a.data;this.elements.subdata(s)}},{key:"destroy",value:function(){}}]),n}(),wP=function(){function n(l,a){(0,ct.Z)(this,n);var s=a.width,o=a.height,h=a.color,v=a.colors,m={width:s,height:o};Array.isArray(v)&&(m.colors=v.map(function(E){return E.get()})),h&&typeof h!="boolean"&&(m.color=h.get()),this.framebuffer=l.framebuffer(m)}return(0,et.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(a){var s=a.width,o=a.height;this.framebuffer.resize(s,o)}}]),n}(),SP=function(){function n(l,a){(0,ct.Z)(this,n),(0,X.Z)(this,"destroyed",!1),(0,X.Z)(this,"uniforms",{}),this.reGl=l;var s=a.pick,o=s===void 0?!0:s,h=a.vs,v=a.fs,m=a.attributes,E=a.uniforms,A=a.primitive,F=a.count,B=a.elements,V=a.depth,j=a.blend,at=a.stencil,ut=a.cull,xt=a.instances,Nt={};this.options=a,E&&(this.uniforms=this.extractUniforms(E),Object.keys(E).forEach(function(Ye){Nt[Ye]=l.prop(Ye)}));var de={};Object.keys(m).forEach(function(Ye){de[Ye]=m[Ye].get()});var fe={attributes:de,frag:v,uniforms:Nt,vert:h,blend:{},primitive:O_[A===void 0?Jt.TRIANGLES:A]};if(xt&&(fe.instances=xt),F?fe.count=F:B&&(fe.elements=B.get()),this.initDepthDrawParams({depth:V},fe),this.initBlendDrawParams({blend:j},fe),this.initStencilDrawParams({stencil:at},fe),this.initCullDrawParams({cull:ut},fe),this.drawCommand=l(fe),o){var Ne=(0,ee.cloneDeep)(fe);Ne.blend=(0,q.Z)((0,q.Z)({},Ne.blend),{},{enable:!1}),this.drawPickCommand=l(Ne)}this.drawParams=fe}return(0,et.Z)(n,[{key:"updateAttributesAndElements",value:function(a,s){var o={};if(Object.keys(a).forEach(function(v){o[v]=a[v].get()}),this.drawParams.attributes=o,this.drawParams.elements=s.get(),this.drawCommand=this.reGl(this.drawParams),this.options.pick){var h=(0,ee.cloneDeep)(this.drawParams);h.blend=(0,q.Z)((0,q.Z)({},h.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(h)}}},{key:"updateAttributes",value:function(a){var s={};if(Object.keys(a).forEach(function(h){s[h]=a[h].get()}),this.drawParams.attributes=s,this.drawCommand=this.reGl(this.drawParams),this.options.pick){var o=(0,ee.cloneDeep)(this.drawParams);o.blend=(0,q.Z)((0,q.Z)({},o.blend),{},{enable:!1}),this.drawPickCommand=this.reGl(o)}}},{key:"addUniforms",value:function(a){this.uniforms=(0,q.Z)((0,q.Z)({},this.uniforms),this.extractUniforms(a))}},{key:"draw",value:function(a,s){if(!(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)){var o=(0,q.Z)((0,q.Z)({},this.uniforms),this.extractUniforms(a.uniforms||{})),h={};Object.keys(o).forEach(function(v){var m=(0,Mn.Z)(o[v]);m==="boolean"||m==="number"||Array.isArray(o[v])||o[v].BYTES_PER_ELEMENT?h[v]=o[v]:h[v]=o[v].get()}),s?this.drawPickCommand&&this.drawPickCommand(h):this.drawCommand(h)}}},{key:"destroy",value:function(){var a,s;(a=this.drawParams)===null||a===void 0||(s=a.elements)===null||s===void 0||s.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(o){o==null||o.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(a,s){var o=a.depth;o&&(s.depth={enable:o.enable===void 0?!0:!!o.enable,mask:o.mask===void 0?!0:!!o.mask,func:bP[o.func||Jt.LESS],range:o.range||[0,1]})}},{key:"initBlendDrawParams",value:function(a,s){var o=a.blend;if(o){var h=o.enable,v=o.func,m=o.equation,E=o.color,A=E===void 0?[0,0,0,0]:E;s.blend={enable:!!h,func:{srcRGB:F_[v&&v.srcRGB||Jt.SRC_ALPHA],srcAlpha:F_[v&&v.srcAlpha||Jt.SRC_ALPHA],dstRGB:F_[v&&v.dstRGB||Jt.ONE_MINUS_SRC_ALPHA],dstAlpha:F_[v&&v.dstAlpha||Jt.ONE_MINUS_SRC_ALPHA]},equation:{rgb:UA[m&&m.rgb||Jt.FUNC_ADD],alpha:UA[m&&m.alpha||Jt.FUNC_ADD]},color:A}}}},{key:"initStencilDrawParams",value:function(a,s){var o=a.stencil;if(o){var h=o.enable,v=o.mask,m=v===void 0?-1:v,E=o.func,A=E===void 0?{cmp:Jt.ALWAYS,ref:0,mask:-1}:E,F=o.opFront,B=F===void 0?{fail:Jt.KEEP,zfail:Jt.KEEP,zpass:Jt.KEEP}:F,V=o.opBack,j=V===void 0?{fail:Jt.KEEP,zfail:Jt.KEEP,zpass:Jt.KEEP}:V;s.stencil={enable:!!h,mask:m,func:(0,q.Z)((0,q.Z)({},A),{},{cmp:ZA[A.cmp]}),opFront:{fail:Rg[B.fail],zfail:Rg[B.zfail],zpass:Rg[B.zpass]},opBack:{fail:Rg[j.fail],zfail:Rg[j.zfail],zpass:Rg[j.zpass]}}}}},{key:"initCullDrawParams",value:function(a,s){var o=a.cull;if(o){var h=o.enable,v=o.face,m=v===void 0?Jt.BACK:v;s.cull={enable:!!h,face:VA[m]}}}},{key:"extractUniforms",value:function(a){var s=this,o={};return Object.keys(a).forEach(function(h){s.extractUniformsRecursively(h,a[h],o,"")}),o}},{key:"extractUniformsRecursively",value:function(a,s,o,h){var v=this;if(s===null||typeof s=="number"||typeof s=="boolean"||Array.isArray(s)&&typeof s[0]=="number"||(0,ee.isTypedArray)(s)||s===""||"resize"in s){o["".concat(h&&h+".").concat(a)]=s;return}(0,ee.isPlainObject)(s)&&Object.keys(s).forEach(function(m){v.extractUniformsRecursively(m,s[m],o,"".concat(h&&h+".").concat(a))}),Array.isArray(s)&&s.forEach(function(m,E){Object.keys(m).forEach(function(A){v.extractUniformsRecursively(A,m[A],o,"".concat(h&&h+".").concat(a,"[").concat(E,"]"))})})}}]),n}(),GA=function(){function n(l,a){(0,ct.Z)(this,n),(0,X.Z)(this,"isDestroy",!1);var s=a.data,o=a.type,h=o===void 0?Jt.UNSIGNED_BYTE:o,v=a.width,m=a.height,E=a.flipY,A=E===void 0?!1:E,F=a.format,B=F===void 0?Jt.RGBA:F,V=a.mipmap,j=V===void 0?!1:V,at=a.wrapS,ut=at===void 0?Jt.CLAMP_TO_EDGE:at,xt=a.wrapT,Nt=xt===void 0?Jt.CLAMP_TO_EDGE:xt,de=a.aniso,fe=de===void 0?0:de,Ne=a.alignment,Ye=Ne===void 0?1:Ne,_r=a.premultiplyAlpha,Ir=_r===void 0?!1:_r,Nr=a.mag,Yr=Nr===void 0?Jt.NEAREST:Nr,yn=a.min,fn=yn===void 0?Jt.NEAREST:yn,$n=a.colorSpace,di=$n===void 0?Jt.BROWSER_DEFAULT_WEBGL:$n,Yi=a.x,ho=Yi===void 0?0:Yi,zo=a.y,Vs=zo===void 0?0:zo,hu=a.copy,Gu=hu===void 0?!1:hu;this.width=v,this.height=m;var Wh={width:v,height:m,type:Yb[h],format:BA[B],wrapS:zA[ut],wrapT:zA[Nt],mag:NA[Yr],min:NA[fn],alignment:Ye,flipY:A,colorSpace:xP[di],premultiplyAlpha:Ir,aniso:fe,x:ho,y:Vs,copy:Gu};s&&(Wh.data=s),typeof j=="number"?Wh.mipmap=_P[j]:typeof j=="boolean"&&(Wh.mipmap=j),this.texture=l.texture(Wh)}return(0,et.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.texture(a)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(a){var s=a.width,o=a.height;this.texture.resize(s,o),this.width=s,this.height=o}},{key:"destroy",value:function(){if(!this.isDestroy){var a;(a=this.texture)===null||a===void 0||a.destroy()}this.isDestroy=!0}}]),n}(),HA,jA,CP=(HA=(0,It.b2)(),HA(jA=function(){function n(){var l=this;(0,ct.Z)(this,n),(0,X.Z)(this,"createModel",function(a){return new SP(l.gl,a)}),(0,X.Z)(this,"createAttribute",function(a){return new yP(l.gl,a)}),(0,X.Z)(this,"createBuffer",function(a){return new EP(l.gl,a)}),(0,X.Z)(this,"createElements",function(a){return new hd(l.gl,a)}),(0,X.Z)(this,"createTexture2D",function(a){return new GA(l.gl,a)}),(0,X.Z)(this,"createFramebuffer",function(a){return new wP(l.gl,a)}),(0,X.Z)(this,"useFramebuffer",function(a,s){l.gl({framebuffer:a?a.get():null})(s)}),(0,X.Z)(this,"clear",function(a){var s,o=a.color,h=a.depth,v=a.stencil,m=a.framebuffer,E=m===void 0?null:m,A={color:o,depth:h,stencil:v};A.framebuffer=E===null?E:E.get(),(s=l.gl)===null||s===void 0||s.clear(A)}),(0,X.Z)(this,"viewport",function(a){var s=a.x,o=a.y,h=a.width,v=a.height;l.gl._gl.viewport(s,o,h,v),l.width=h,l.height=v,l.gl._refresh()}),(0,X.Z)(this,"readPixels",function(a){var s=a.framebuffer,o=a.x,h=a.y,v=a.width,m=a.height,E={x:o,y:h,width:v,height:m};return s&&(E.framebuffer=s.get()),l.gl.read(E)}),(0,X.Z)(this,"getViewportSize",function(){return{width:l.gl._gl.drawingBufferWidth,height:l.gl._gl.drawingBufferHeight}}),(0,X.Z)(this,"getContainer",function(){if(_u)return l.canvas;var a;return(a=l.canvas)===null||a===void 0?void 0:a.parentElement}),(0,X.Z)(this,"getCanvas",function(){return l.canvas}),(0,X.Z)(this,"getGLContext",function(){return l.gl._gl}),(0,X.Z)(this,"destroy",function(){var a,s,o;l.canvas=null,(a=l.gl)===null||a===void 0||(s=a._gl)===null||s===void 0||(o=s.getExtension("WEBGL_lose_context"))===null||o===void 0||o.loseContext(),l.gl.destroy(),l.gl=null})}return(0,et.Z)(n,[{key:"init",value:function(){var l=(0,lt.Z)(it().mark(function s(o,h,v){var m=this;return it().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:if(this.canvas=o,!v){A.next=5;break}this.gl=v,A.next=8;break;case 5:return A.next=7,new Promise(function(F,B){mP()({canvas:m.canvas,attributes:{alpha:!0,antialias:h.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:h.preserveDrawingBuffer,stencil:h.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(j,at){(j||!at)&&B(j),F(at)}})});case 7:this.gl=A.sent;case 8:this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 9:case"end":return A.stop()}},s,this)}));function a(s,o,h){return l.apply(this,arguments)}return a}()},{key:"getPointSizeRange",value:function(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}},{key:"testExtension",value:function(a){return!!this.getGLContext().getExtension(a)}},{key:"setState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var a=this.getGLContext();a.disable(a.CULL_FACE)}},{key:"setDirty",value:function(a){this.isDirty=a}},{key:"getDirty",value:function(){return this.isDirty}}]),n}())||jA);function AP(n){var l=TP();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function TP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var $b=["selectstart","selecting","selectend"],MP=function(n){(0,Zt.Z)(a,n);var l=AP(a);function a(s){var o,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,ct.Z)(this,a),o=l.call(this),(0,X.Z)((0,st.Z)(o),"isEnable",!1),(0,X.Z)((0,st.Z)(o),"onDragStart",function(v){o.box.style.display="block",o.startEvent=o.endEvent=v,o.syncBoxBound(),o.emit("selectstart",o.getLngLatBox(),o.startEvent,o.endEvent)}),(0,X.Z)((0,st.Z)(o),"onDragging",function(v){o.endEvent=v,o.syncBoxBound(),o.emit("selecting",o.getLngLatBox(),o.startEvent,o.endEvent)}),(0,X.Z)((0,st.Z)(o),"onDragEnd",function(v){o.endEvent=v,o.box.style.display="none",o.emit("selectend",o.getLngLatBox(),o.startEvent,o.endEvent)}),o.scene=s,o.options=h,o}return(0,et.Z)(a,[{key:"container",get:function(){return this.scene.getMapService().getMarkerContainer()}},{key:"enable",value:function(){if(!this.isEnable){var o=this.options.className;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){var h=bt("div",void 0,this.container);h.classList.add("l7-select-box"),o&&h.classList.add(o),h.style.display="none",this.box=h}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}}},{key:"disable",value:function(){!this.isEnable||(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}},{key:"syncBoxBound",value:function(){var o=this.startEvent,h=o.x,v=o.y,m=this.endEvent,E=m.x,A=m.y,F=Math.min(h,E),B=Math.min(v,A),V=Math.abs(h-E),j=Math.abs(v-A);this.box.style.top="".concat(B,"px"),this.box.style.left="".concat(F,"px"),this.box.style.width="".concat(V,"px"),this.box.style.height="".concat(j,"px")}},{key:"getLngLatBox",value:function(){var o=this.startEvent.lngLat,h=o.lng,v=o.lat,m=this.endEvent.lngLat,E=m.lng,A=m.lat;return Tc([[h,v],[E,A]])}}]),a}(Se.EventEmitter),IP=function(){function n(l){(0,ct.Z)(this,n);var a=l.id,s=l.map,o=l.canvas,h=l.hasBaseMap,v=TM();this.container=v,s.setContainer(v,a,o,h),v.bind(Dt.IRendererService).to(CP).inSingletonScope(),this.sceneService=v.get(Dt.ISceneService),this.mapService=v.get(Dt.IMapService),this.iconService=v.get(Dt.IIconService),this.fontService=v.get(Dt.IFontService),this.controlService=v.get(Dt.IControlService),this.layerService=v.get(Dt.ILayerService),this.markerService=v.get(Dt.IMarkerService),this.interactionService=v.get(Dt.IInteractionService),this.popupService=v.get(Dt.IPopupService),this.boxSelect=new MP(this,{}),_u?this.sceneService.initMiniScene(l):(this.initComponent(a),this.sceneService.init(l),this.initControl())}return(0,et.Z)(n,[{key:"map",get:function(){return this.mapService.map}},{key:"loaded",get:function(){return this.sceneService.loaded}},{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(a){return this.sceneService.exportPng(a)}},{key:"exportMap",value:function(a){return this.sceneService.exportPng(a)}},{key:"registerRenderService",value:function(a){var s=this;if(this.sceneService.loaded){var o=new a(this);o.init()}else this.on("loaded",function(){var h=new a(s);h.init()})}},{key:"setBgColor",value:function(a){this.mapService.setBgColor(a)}},{key:"addLayer",value:function(a){var s=this,o=cy(this.container);if(a.setContainer(o,this.container),this.sceneService.addLayer(a),a.inited){var h=this.initMask(a);this.addMask(h,a.id)}else a.on("inited",function(){var v=s.initMask(a);s.addMask(v,a.id)})}},{key:"initMask",value:function(a){var s=a.getLayerConfig(),o=s.mask,h=s.maskfence,v=s.maskColor,m=v===void 0?"#000":v,E=s.maskOpacity,A=E===void 0?0:E;if(!(!o||!h)){var F=new Hy().source(h).shape("fill").style({color:m,opacity:A});return F}}},{key:"addMask",value:function(a,s){if(!!a){var o=this.getLayer(s);if(o){var h=cy(this.container);a.setContainer(h,this.container),o.addMaskLayer(a),this.sceneService.addMask(a)}else console.warn("parent layer not find!")}}},{key:"getPickedLayer",value:function(){return this.layerService.pickedLayerId}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(a){return this.layerService.getLayer(a)}},{key:"getLayerByName",value:function(a){return this.layerService.getLayerByName(a)}},{key:"removeLayer",value:function(a,s){this.layerService.remove(a,s)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"setEnableRender",value:function(a){this.layerService.setEnableRender(a)}},{key:"addIconFont",value:function(a,s){this.fontService.addIconFont(a,s)}},{key:"addIconFonts",value:function(a){var s=this;a.forEach(function(o){var h=(0,ht.Z)(o,2),v=h[0],m=h[1];s.fontService.addIconFont(v,m)})}},{key:"addFontFace",value:function(a,s){var o=this;this.fontService.once("fontloaded",function(h){o.emit("fontloaded",h)}),this.fontService.addFontFace(a,s)}},{key:"addImage",value:function(){var l=(0,lt.Z)(it().mark(function s(o,h){return it().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(_u){m.next=5;break}return m.next=3,this.iconService.addImage(o,h);case 3:m.next=6;break;case 5:this.iconService.addImageMini(o,h,this.sceneService);case 6:case"end":return m.stop()}},s,this)}));function a(s,o){return l.apply(this,arguments)}return a}()},{key:"hasImage",value:function(a){return this.iconService.hasImage(a)}},{key:"removeImage",value:function(a){this.iconService.removeImage(a)}},{key:"addIconFontGlyphs",value:function(a,s){this.fontService.addIconGlyphs(s)}},{key:"addControl",value:function(a){this.controlService.addControl(a,this.container)}},{key:"removeControl",value:function(a){this.controlService.removeControl(a)}},{key:"getControlByName",value:function(a){return this.controlService.getControlByName(a)}},{key:"addMarker",value:function(a){this.markerService.addMarker(a)}},{key:"addMarkerLayer",value:function(a){this.markerService.addMarkerLayer(a)}},{key:"removeMarkerLayer",value:function(a){this.markerService.removeMarkerLayer(a)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(a){this.popupService.addPopup(a)}},{key:"removePopup",value:function(a){this.popupService.removePopup(a)}},{key:"on",value:function(a,s){if($b.includes(a)){var o;(o=this.boxSelect)===null||o===void 0||o.on(a,s)}else hy.includes(a)?this.sceneService.on(a,s):this.mapService.on(a,s)}},{key:"once",value:function(a,s){if($b.includes(a)){var o;(o=this.boxSelect)===null||o===void 0||o.once(a,s)}else hy.includes(a)?this.sceneService.once(a,s):this.mapService.once(a,s)}},{key:"emit",value:function(a,s){hy.indexOf(a)===-1?this.mapService.on(a,s):this.sceneService.emit(a,s)}},{key:"off",value:function(a,s){if($b.includes(a)){var o;(o=this.boxSelect)===null||o===void 0||o.off(a,s)}else hy.includes(a)?this.sceneService.off(a,s):this.mapService.off(a,s)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(a){return this.mapService.getCenter(a)}},{key:"setCenter",value:function(a,s){return this.mapService.setCenter(a,s)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(a){return this.mapService.setPitch(a)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(a){this.mapService.setRotation(a)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(a){this.mapService.panTo(a)}},{key:"panBy",value:function(a,s){this.mapService.panBy(a,s)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(a){this.mapService.setZoom(a)}},{key:"fitBounds",value:function(a,s){var o=this.sceneService.getSceneConfig(),h=o.fitBoundsOptions,v=o.animate;this.mapService.fitBounds(a,s||(0,q.Z)((0,q.Z)({},h),{},{animate:v}))}},{key:"setZoomAndCenter",value:function(a,s){this.mapService.setZoomAndCenter(a,s)}},{key:"setMapStyle",value:function(a){this.mapService.setMapStyle(a)}},{key:"setMapStatus",value:function(a){this.mapService.setMapStatus(a)}},{key:"pixelToLngLat",value:function(a){return this.mapService.pixelToLngLat(a)}},{key:"lngLatToPixel",value:function(a){return this.mapService.lngLatToPixel(a)}},{key:"containerToLngLat",value:function(a){return this.mapService.containerToLngLat(a)}},{key:"lngLatToContainer",value:function(a){return this.mapService.lngLatToContainer(a)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(a,s){this.container.bind(Dt.IPostProcessingPass).to(a).whenTargetNamed(s)}},{key:"enableShaderPick",value:function(){this.layerService.enableShaderPick()}},{key:"diasbleShaderPick",value:function(){this.layerService.disableShaderPick()}},{key:"enableBoxSelect",value:function(){var a=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.boxSelect.enable(),s&&this.boxSelect.once("selectend",function(){a.disableBoxSelect()})}},{key:"disableBoxSelect",value:function(){this.boxSelect.disable()}},{key:"getPointSizeRange",value:function(){return this.sceneService.getPointSizeRange()}},{key:"initComponent",value:function(a){this.controlService.init({container:nl(a)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var a=this.sceneService.getSceneConfig(),s=a.logoVisible,o=a.logoPosition;s&&this.addControl(new PE({position:o}))}}]),n}(),WA,qb,XA,YA=(WA=ly(Dt.IGlobalConfigService),qb=function(){function n(l){(0,ct.Z)(this,n),Ar(this,"configService",XA,this),this.config=l}return(0,et.Z)(n,[{key:"setContainer",value:function(a,s,o,h){a.bind(Dt.MapConfig).toConstantValue((0,q.Z)((0,q.Z)({},this.config),{},{id:s,canvas:o,hasBaseMap:h})),a.bind(Dt.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),XA=Dr(qb.prototype,"configService",[WA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qb),kP=ot(81618),$A=ot.n(kP),LP=function(){function n(l){(0,ct.Z)(this,n),(0,X.Z)(this,"size",1e4),this.size=l||1e4}return(0,et.Z)(n,[{key:"setSize",value:function(a){this.size=a}},{key:"getSize",value:function(){return[this.size,this.size]}},{key:"mercatorXfromLng",value:function(a){return(180+a)/360*this.size}},{key:"mercatorYfromLat",value:function(a){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360)*this.size}},{key:"lngFromMercatorX",value:function(a){return a/this.size*360-180}},{key:"latFromMercatorY",value:function(a){var s=180-(1-a/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(s*Math.PI/180))-90}},{key:"project",value:function(a){var s=this.mercatorXfromLng(a[0]),o=this.mercatorYfromLat(a[1]);return[s,o]}},{key:"unproject",value:function(a){var s=this.lngFromMercatorX(a[0]),o=this.latFromMercatorY(a[1]);return[s,o]}}]),n}();function PP(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l={top:0,right:0,bottom:0,left:0};if(typeof n=="number")return{top:n,right:n,bottom:n,left:n};if(Array.isArray(n)){if(n.length===4)return{top:n[0],right:n[1],bottom:n[2],left:n[3]};if(n.length===2)return{top:n[0],right:n[1],bottom:n[0],left:n[1]}}return(0,q.Z)((0,q.Z)({},l),n)}function R_(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Kb(n,l){var a=cu([],l,n);return ea(a,a,1/a[3]),a}function r(n,l){var a=n%l;return a<0?l+a:a}function e(n,l,a){return a*l+(1-a)*n}function t(n,l){if(!n)throw new Error(l||"viewport-mercator-project: assertion failed.")}var i=Math.PI,u=i/4,c=i/180,p=180/i,g=512,_=4003e4,S=1.5;function k(n){return Math.pow(2,n)}function L(n){return Math.log2(n)}function R(n,l){var a=(0,ht.Z)(n,2),s=a[0],o=a[1];t(Number.isFinite(s)&&Number.isFinite(l)),t(Number.isFinite(o)&&o>=-90&&o<=90,"invalid latitude"),l*=g;var h=s*c,v=o*c,m=l*(h+i)/(2*i),E=l*(i-Math.log(Math.tan(u+v*.5)))/(2*i);return[m,E]}function U(n,l){var a=(0,ht.Z)(n,2),s=a[0],o=a[1];l*=g;var h=s/l*(2*i)-i,v=2*(Math.atan(Math.exp(i-o/l*(2*i)))-u);return[h*p,v*p]}function G(n){var l=n.latitude;assert(Number.isFinite(l));var a=Math.cos(l*c);return L(_*a)-9}function Q(n){var l=n.latitude,a=n.longitude,s=n.zoom,o=n.scale,h=n.highPrecision,v=h===void 0?!1:h;o=o!==void 0?o:k(s),t(Number.isFinite(l)&&Number.isFinite(a)&&Number.isFinite(o));var m={},E=g*o,A=Math.cos(l*c),F=E/360,B=F/A,V=E/_/A;if(m.pixelsPerMeter=[V,-V,V],m.metersPerPixel=[1/V,-1/V,1/V],m.pixelsPerDegree=[F,-B,V],m.degreesPerPixel=[1/F,-1/B,1/V],v){var j=c*Math.tan(l*c)/A,at=F*j/2,ut=E/_*j,xt=ut/B*V;m.pixelsPerDegree2=[0,-at,ut],m.pixelsPerMeter2=[xt,0,xt]}return m}function pt(n,l){var a=_slicedToArray(n,3),s=a[0],o=a[1],h=a[2],v=_slicedToArray(l,3),m=v[0],E=v[1],A=v[2],F=1,B=Q({longitude:s,latitude:o,scale:F,highPrecision:!0}),V=B.pixelsPerMeter,j=B.pixelsPerMeter2,at=R(n,F);at[0]+=m*(V[0]+j[0]*E),at[1]+=E*(V[1]+j[1]*E);var ut=U(at,F),xt=(h||0)+(A||0);return Number.isFinite(h)||Number.isFinite(A)?[ut[0],ut[1],xt]:ut}function yt(n){var l=n.height,a=n.pitch,s=n.bearing,o=n.altitude,h=n.center,v=h===void 0?null:h,m=n.flipY,E=m===void 0?!1:m,A=R_();return pr(A,A,[0,0,-o]),kr(A,A,[1,1,1/l]),vr(A,A,-a*c),Hr(A,A,s*c),E&&kr(A,A,[1,-1,1]),v&&pr(A,A,So.negate([],v)),A}function Ht(n){var l=n.width,a=n.height,s=n.altitude,o=s===void 0?S:s,h=n.pitch,v=h===void 0?0:h,m=n.nearZMultiplier,E=m===void 0?1:m,A=n.farZMultiplier,F=A===void 0?1:A,B=v*c,V=Math.atan(.5/o),j=Math.sin(V)*o/Math.sin(Math.PI/2-B-V),at=Math.cos(Math.PI/2-B)*j+o;return{fov:2*Math.atan(a/2/o),aspect:l/a,focalDistance:o,near:E,far:at*F}}function ce(n){var l=n.width,a=n.height,s=n.pitch,o=n.altitude,h=n.nearZMultiplier,v=n.farZMultiplier,m=Ht({width:l,height:a,altitude:o,pitch:s,nearZMultiplier:h,farZMultiplier:v}),E=m.fov,A=m.aspect,F=m.near,B=m.far,V=Oc([],E,A,F,B);return V}function he(n,l){var a=(0,ht.Z)(n,3),s=a[0],o=a[1],h=a[2],v=h===void 0?0:h;return t(Number.isFinite(s)&&Number.isFinite(o)&&Number.isFinite(v)),Kb(l,[s,o,v,1])}function ze(n,l){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=(0,ht.Z)(n,3),o=s[0],h=s[1],v=s[2];if(t(Number.isFinite(o)&&Number.isFinite(h),"invalid pixel coordinate"),Number.isFinite(v)){var m=Kb(l,[o,h,v,1]);return m}var E=Kb(l,[o,h,0,1]),A=Kb(l,[o,h,1,1]),F=E[2],B=A[2],V=F===B?0:((a||0)-F)/(B-F);return ei.t7([],E,A,V)}var Er=R_(),Fr=function(){function n(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=l.width,s=l.height,o=l.viewMatrix,h=o===void 0?Er:o,v=l.projectionMatrix,m=v===void 0?Er:v;(0,ct.Z)(this,n),this.width=a||1,this.height=s||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=h,this.projectionMatrix=m;var E=R_();mr(E,E,this.projectionMatrix),mr(E,E,this.viewMatrix),this.viewProjectionMatrix=E;var A=R_();kr(A,A,[this.width/2,-this.height/2,1]),pr(A,A,[1,-1,0]),mr(A,A,this.viewProjectionMatrix);var F=yr(R_(),A);if(!F)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=A,this.pixelUnprojectionMatrix=F,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,et.Z)(n,[{key:"equals",value:function(a){return a instanceof n?a.width===this.width&&a.height===this.height&&Kp(a.projectionMatrix,this.projectionMatrix)&&Kp(a.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.topLeft,h=o===void 0?!0:o,v=this.projectPosition(a),m=he(v,this.pixelProjectionMatrix),E=(0,ht.Z)(m,2),A=E[0],F=E[1],B=h?F:this.height-F;return a.length===2?[A,B]:[A,B,m[2]]}},{key:"unproject",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=s.topLeft,h=o===void 0?!0:o,v=s.targetZ,m=(0,ht.Z)(a,3),E=m[0],A=m[1],F=m[2],B=h?A:this.height-A,V=v&&v*this.pixelsPerMeter,j=ze([E,B,F],this.pixelUnprojectionMatrix,V),at=this.unprojectPosition(j),ut=(0,ht.Z)(at,3),xt=ut[0],Nt=ut[1],de=ut[2];return Number.isFinite(F)?[xt,Nt,de]:Number.isFinite(v)?[xt,Nt,v]:[xt,Nt]}},{key:"projectPosition",value:function(a){var s=this.projectFlat(a),o=(0,ht.Z)(s,2),h=o[0],v=o[1],m=(a[2]||0)*this.pixelsPerMeter;return[h,v,m]}},{key:"unprojectPosition",value:function(a){var s=this.unprojectFlat(a),o=(0,ht.Z)(s,2),h=o[0],v=o[1],m=(a[2]||0)/this.pixelsPerMeter;return[h,v,m]}},{key:"projectFlat",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}},{key:"unprojectFlat",value:function(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return a}}]),n}();function zr(n){var l=n.width,a=n.height,s=n.bounds,o=n.minExtent,h=o===void 0?0:o,v=n.maxZoom,m=v===void 0?24:v,E=n.padding,A=E===void 0?0:E,F=n.offset,B=F===void 0?[0,0]:F,V=(0,ht.Z)(s,2),j=(0,ht.Z)(V[0],2),at=j[0],ut=j[1],xt=(0,ht.Z)(V[1],2),Nt=xt[0],de=xt[1];if(Number.isFinite(A)){var fe=A;A={top:fe,bottom:fe,left:fe,right:fe}}else t(Number.isFinite(A.top)&&Number.isFinite(A.bottom)&&Number.isFinite(A.left)&&Number.isFinite(A.right));var Ne=new pn({width:l,height:a,longitude:0,latitude:0,zoom:0}),Ye=Ne.project([at,de]),_r=Ne.project([Nt,ut]),Ir=[Math.max(Math.abs(_r[0]-Ye[0]),h),Math.max(Math.abs(_r[1]-Ye[1]),h)],Nr=[l-A.left-A.right-Math.abs(B[0])*2,a-A.top-A.bottom-Math.abs(B[1])*2];t(Nr[0]>0&&Nr[1]>0);var Yr=Nr[0]/Ir[0],yn=Nr[1]/Ir[1],fn=(A.right-A.left)/2/Yr,$n=(A.bottom-A.top)/2/yn,di=[(_r[0]+Ye[0])/2+fn,(_r[1]+Ye[1])/2+$n],Yi=Ne.unproject(di),ho=Ne.zoom+Math.log2(Math.abs(Math.min(Yr,yn)));return{longitude:Yi[0],latitude:Yi[1],zoom:Math.min(ho,m)}}var pn=function(n){(0,Zt.Z)(l,n);function l(){var a,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=s.width,h=s.height,v=s.latitude,m=v===void 0?0:v,E=s.longitude,A=E===void 0?0:E,F=s.zoom,B=F===void 0?0:F,V=s.pitch,j=V===void 0?0:V,at=s.bearing,ut=at===void 0?0:at,xt=s.altitude,Nt=xt===void 0?1.5:xt,de=s.nearZMultiplier,fe=s.farZMultiplier;(0,ct.Z)(this,l),o=o||1,h=h||1;var Ne=k(B);Nt=Math.max(.75,Nt);var Ye=R([A,m],Ne);Ye[2]=0;var _r=ce({width:o,height:h,pitch:j,bearing:ut,altitude:Nt,nearZMultiplier:de||1/h,farZMultiplier:fe||1.01}),Ir=yt({height:h,center:Ye,pitch:j,bearing:ut,altitude:Nt,flipY:!0});return a=(0,P.Z)(this,(0,b.Z)(l).call(this,{width:o,height:h,viewMatrix:Ir,projectionMatrix:_r})),a.latitude=m,a.longitude=A,a.zoom=B,a.pitch=j,a.bearing=ut,a.altitude=Nt,a.scale=Ne,a.center=Ye,a.pixelsPerMeter=Q((0,st.Z)((0,st.Z)(a))).pixelsPerMeter[2],Object.freeze((0,st.Z)((0,st.Z)(a))),a}return(0,et.Z)(l,[{key:"projectFlat",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return R(s,o)}},{key:"unprojectFlat",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return U(s,o)}},{key:"getMapCenterByLngLatPosition",value:function(s){var o=s.lngLat,h=s.pos,v=ze(h,this.pixelUnprojectionMatrix),m=R(o,this.scale),E=ei.IH([],m,ei.tk([],v)),A=ei.IH([],this.center,E);return U(A,this.scale)}},{key:"getLocationAtPoint",value:function(s){var o=s.lngLat,h=s.pos;return this.getMapCenterByLngLatPosition({lngLat:o,pos:h})}},{key:"fitBounds",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=this.width,v=this.height,m=zr(Object.assign({width:h,height:v,bounds:s},o)),E=m.longitude,A=m.latitude,F=m.zoom;return new l({width:h,height:v,longitude:E,latitude:A,zoom:F})}}]),l}(Fr),nn=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.center,o=a.zoom,h=a.pitch,v=a.bearing,m=a.viewportHeight,E=a.viewportWidth,A=this.viewport?{width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing}:{};this.viewport=new pn((0,q.Z)((0,q.Z)({},A),{},{width:E,height:m,longitude:s&&s[0],latitude:s&&s[1],zoom:o,pitch:h,bearing:v}))}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}}]),n}(),Pn={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},wi=["id","style","minZoom","maxZoom","token","mapInstance","plugin"],ha,Sa,_o,Vn,Bi,fa,Ui,Ji,Fa,xo,Mo;function ao(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}ao(`.amap-logo{
 display: none !important;
}
`);var Io={contextmenu:"rightclick"},hs=0;window.forceWebGL=!0;var tl="15cd8a57710d40c9b7c0e3cc120f1200",pl="1.4.15",pd="amap-script",iv=!1,jh=[],Dg=12,Bg=(ha=(0,It.b2)(),Sa=(0,It.f3)(Dt.IGlobalConfigService),_o=(0,It.f3)(Dt.MapConfig),Vn=(0,It.f3)(Dt.ICoordinateSystemService),Bi=(0,It.f3)(Dt.IEventEmitter),ha(fa=(Ui=function(){function n(){var l=this;(0,ct.Z)(this,n),(0,X.Z)(this,"version",yu["GAODE1.x"]),(0,X.Z)(this,"simpleMapCoord",new LP),(0,X.Z)(this,"bgColor","rgba(0, 0, 0, 0)"),Ar(this,"configService",Ji,this),Ar(this,"config",Fa,this),Ar(this,"coordinateSystemService",xo,this),Ar(this,"eventEmitter",Mo,this),(0,X.Z)(this,"handleCameraChanged",function(a){var s=a.camera,o=s.fov,h=s.near,v=s.far,m=s.height,E=s.pitch,A=s.rotation,F=s.aspect,B=s.position,V=l.getCenter(),j=V.lng,at=V.lat;if(l.emit("mapchange"),l.cameraChangedCallback){l.viewport.syncWithMapCamera({aspect:F,bearing:360-A,far:v,fov:o,cameraHeight:m,near:h,pitch:E,zoom:l.map.getZoom()-1,center:[j,at],offsetOrigin:[B.x,B.y]});var ut=l.config.offsetZoom,xt=ut===void 0?Dg:ut;l.viewport.getZoom()>xt?l.coordinateSystemService.setCoordinateSystem(Pl.P20_OFFSET):l.coordinateSystemService.setCoordinateSystem(Pl.P20),l.cameraChangedCallback(l.viewport)}})}return(0,et.Z)(n,[{key:"setBgColor",value:function(a){this.bgColor=a}},{key:"addMarkerContainer",value:function(){var a=this.map.getContainer();if(a!==null){var s=a.getElementsByClassName("amap-maps")[0];this.markerContainer=bt("div","l7-marker-container",s)}}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(a,s){w1.indexOf(a)!==-1?this.eventEmitter.on(a,s):this.map.on(Io[a]||a,s)}},{key:"off",value:function(a,s){w1.indexOf(a)!==-1?this.eventEmitter.off(a,s):this.map.off(Io[a]||a,s)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){var a;return(a=this.map.getContainer())===null||a===void 0?void 0:a.getElementsByClassName("amap-maps")[0]}},{key:"getSize",value:function(){var a=this.map.getSize();return[a.getWidth(),a.getHeight()]}},{key:"getType",value:function(){return"amap"}},{key:"getZoom",value:function(){return this.map.getZoom()-1}},{key:"setZoom",value:function(a){return this.map.setZoom(a+1)}},{key:"getCenter",value:function(a){if(a!=null&&a.padding){var s=this.getCenter(),o=PP(a.padding),h=this.lngLatToPixel([s.lng,s.lat]),v=[(o.right-o.left)/2,(o.bottom-o.top)/2],m=this.pixelToLngLat([h.x-v[0],h.y-v[1]]);return m}var E=this.map.getCenter();return{lng:E.getLng(),lat:E.getLat()}}},{key:"setCenter",value:function(a,s){if(s!=null&&s.padding){var o=PP(s.padding),h=this.lngLatToPixel(a),v=[(o.right-o.left)/2,(o.bottom-o.top)/2],m=this.pixelToLngLat([h.x+v[0],h.y+v[1]]);this.map.setCenter([m.lng,m.lat])}else this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return 360-this.map.getRotation()}},{key:"getBounds",value:function(){var a=this.map.getBounds().toBounds(),s=a.getNorthEast(),o=a.getSouthWest(),h=this.getCenter(),v=h.lng>s.getLng()||h.lng<o.getLng()?180-s.getLng():s.getLng(),m=h.lng<o.getLng()?o.getLng()-180:o.getLng();return[[m,o.getLat()],[v,s.getLat()]]}},{key:"getMinZoom",value:function(){var a=this.map.get("zooms");return a[0]-1}},{key:"getMaxZoom",value:function(){var a=this.map.get("zooms");return a[1]-1}},{key:"setRotation",value:function(a){return this.map.setRotation(a)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"zoomIn",value:function(){this.map.zoomIn()}},{key:"zoomOut",value:function(){this.map.zoomOut()}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.map.panBy(a,s)}},{key:"fitBounds",value:function(a){this.map.setBounds(new AMap.Bounds([a[0][0],a[0][1],a[1][0],a[1][1]]))}},{key:"setZoomAndCenter",value:function(a,s){this.map.setZoomAndCenter(a+1,s)}},{key:"setMapStyle",value:function(a){this.map.setMapStyle(this.getMapStyleValue(a))}},{key:"setMapStatus",value:function(a){this.map.setStatus(a)}},{key:"getMapStyleConfig",value:function(){return Pn}},{key:"getMapStyleValue",value:function(a){return this.getMapStyleConfig()[a]||a}},{key:"getMapStyle",value:function(){return this.map.getMapStyle()}},{key:"pixelToLngLat",value:function(a){var s=this.map.pixelToLngLat(new AMap.Pixel(a[0],a[1]));return{lng:s.getLng(),lat:s.getLat()}}},{key:"lngLatToPixel",value:function(a){var s=this.map.lnglatToPixel(new AMap.LngLat(a[0],a[1]));return{x:s.getX(),y:s.getY()}}},{key:"containerToLngLat",value:function(a){var s=new AMap.Pixel(a[0],a[1]),o=this.map.containerToLngLat(s);return{lng:o==null?void 0:o.getLng(),lat:o==null?void 0:o.getLat()}}},{key:"lngLatToContainer",value:function(a){var s=new AMap.LngLat(a[0],a[1]),o=this.map.lngLatToContainer(s);return{x:o.getX(),y:o.getY()}}},{key:"lngLatToCoord",value:function(a){var s=this.map.lngLatToGeodeticCoord(a),o=s.x,h=s.y;return[o,-h]}},{key:"lngLatToMercator",value:function(a,s){return{x:0,y:0,z:0}}},{key:"getModelMatrix",value:function(a,s,o){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],v=this.viewport.projectFlat(a),m=Je();return pr(m,m,So.fromValues(v[0],v[1],s)),kr(m,m,So.fromValues(h[0],h[1],h[2])),vr(m,m,o[0]),tr(m,m,o[1]),Hr(m,m,o[2]),m}},{key:"init",value:function(){var l=(0,lt.Z)(it().mark(function s(){var o=this,h,v,m,E,A,F,B,V,j,at,ut,xt,Nt,de;return it().wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:return h=this.config,v=h.id,m=h.style,E=m===void 0?"light":m,A=h.minZoom,F=A===void 0?0:A,B=h.maxZoom,V=B===void 0?18:B,j=h.token,at=j===void 0?tl:j,ut=h.mapInstance,xt=h.plugin,Nt=xt===void 0?[]:xt,de=(0,Wl.Z)(h,wi),Ne.next=3,new Promise(function(Ye){var _r=function(){if(ut)o.map=ut,o.$mapContainer=o.map.getContainer(),setTimeout(function(){o.map.on("camerachange",o.handleCameraChanged),Ye()},30);else{o.$mapContainer=o.creatMapContainer(v);var Nr=(0,q.Z)({mapStyle:o.getMapStyleValue(E),zooms:[F,V],viewMode:"3D"},de);Nr.zoom&&(Nr.zoom+=1);var Yr=new AMap.Map(o.$mapContainer,Nr);Yr.on("camerachange",o.handleCameraChanged),Yr.on("camerachange",function(){setTimeout(function(){return o.handleAfterMapChange()})}),o.map=Yr,setTimeout(function(){Ye()},10)}};!iv&&!ut?(at===tl&&console.warn("%c".concat(o.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),iv=!0,Nt.push("Map3D"),$A().load({key:at,version:pl,plugins:Nt}).then(function(){_r(),jh.length&&(jh.forEach(function(Ir){return Ir()}),jh=[])}).catch(function(Ir){throw new Error(Ir)})):iv&&window.AMap||ut?_r():jh.push(_r)});case 3:this.viewport=new nn;case 4:case"end":return Ne.stop()}},s,this)}));function a(){return l.apply(this,arguments)}return a}()},{key:"meterToCoord",value:function(a,s){var o=AMap.GeometryUtil.distance($a(AMap.LngLat,(0,me.Z)(a)),$a(AMap.LngLat,(0,me.Z)(s))),h=this.lngLatToCoord(a),v=(0,ht.Z)(h,2),m=v[0],E=v[1],A=this.lngLatToCoord(s),F=(0,ht.Z)(A,2),B=F[0],V=F[1],j=Math.sqrt(Math.pow(m-B,2)+Math.pow(E-V,2));return j/o}},{key:"updateView",value:function(a){}},{key:"getOverlayContainer",value:function(){}},{key:"exportMap",value:function(a){var s,o=(s=this.getContainer())===null||s===void 0?void 0:s.getElementsByClassName("amap-layer")[0],h=a==="jpg"?o==null?void 0:o.toDataURL("image/jpeg"):o==null?void 0:o.toDataURL("image/png");return h}},{key:"emit",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).emit.apply(s,[a].concat(h))}},{key:"once",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).once.apply(s,[a].concat(h))}},{key:"destroy",value:function(){var a,s;(a=this.$mapContainer)===null||a===void 0||(s=a.parentNode)===null||s===void 0||s.removeChild(this.$mapContainer),delete window.initAMap;var o=document.getElementById(pd);o&&document.head.removeChild(o),this.map.destroy()}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"handleAfterMapChange",value:function(){this.emit("mapAfterFrameChange")}},{key:"creatMapContainer",value:function(a){var s=a;typeof a=="string"&&(s=document.getElementById(a));var o=document.createElement("div");return o.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,o.id="l7_amap_div"+hs++,s.appendChild(o),o}}]),n}(),Ji=Dr(Ui.prototype,"configService",[Sa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fa=Dr(Ui.prototype,"config",[_o],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xo=Dr(Ui.prototype,"coordinateSystemService",[Vn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=Dr(Ui.prototype,"eventEmitter",[Bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui))||fa),qA=function(){function n(){(0,ct.Z)(this,n),(0,X.Z)(this,"projectionMatrix",Je()),(0,X.Z)(this,"viewMatrix",Je()),(0,X.Z)(this,"viewProjectionMatrix",Je()),(0,X.Z)(this,"ViewProjectionMatrixUncentered",Je()),(0,X.Z)(this,"viewUncenteredMatrix",Je())}return(0,et.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.zoom,o=s===void 0?1:s,h=a.center,v=h===void 0?[0,0]:h,m=a.offsetOrigin,E=m===void 0?[0,0]:m,A=a.cameraPosition,F=A===void 0?[0,0,0]:A,B=a.up,V=B===void 0?[0,1,0]:B,j=a.lookAt,at=j===void 0?[0,0,0]:j,ut=a.aspect,xt=ut===void 0?1:ut,Nt=a.near,de=Nt===void 0?.1:Nt,fe=a.far,Ne=fe===void 0?1e3:fe,Ye=a.fov,_r=Ye===void 0?45:Ye;this.zoom=o,this.center=v,Oc(this.projectionMatrix,_r/180*Math.PI,xt,de,Ne);var Ir=So.fromValues.apply(So,(0,me.Z)(F)),Nr=So.fromValues.apply(So,(0,me.Z)(at)),Yr=So.fromValues.apply(So,(0,me.Z)(V));rh(this.viewMatrix,Ir,Nr,Yr),this.viewUncenteredMatrix=an(this.viewMatrix),pr(this.viewMatrix,this.viewMatrix,So.fromValues(-E[0],E[1],0)),mr(this.viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),mr(this.ViewProjectionMatrixUncentered,this.projectionMatrix,this.viewMatrix)}},{key:"getZoom",value:function(){return this.zoom}},{key:"getZoomScale",value:function(){return 1048576}},{key:"getCenter",value:function(){var a=(0,ht.Z)(this.center,2),s=a[0],o=a[1];return[s,o]}},{key:"getProjectionMatrix",value:function(){return this.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewUncenteredMatrix}},{key:"getViewProjectionMatrix",value:function(){return this.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.ViewProjectionMatrixUncentered}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a){var s=85.0511287798,o=Math.max(Math.min(s,a[1]),-s),h=256<<20,v=Math.PI/180,m=a[0]*v,E=o*v;E=Math.log(Math.tan(Math.PI/4+E/2));var A=.5/Math.PI,F=.5,B=-.5/Math.PI;return v=.5,m=h*(A*m+F)-215440491,E=-(h*(B*E+v)-106744817),[m,E]}}]),n}(),OP=["id","style","minZoom","maxZoom","token","mapInstance","plugin","version"],KA,Qb;function Jb(n){var l=QA();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function QA(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function FP(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}FP(`.amap-logo{
 display: none !important;
}
`);var D_=[108.92361,34.54083];window.forceWebGL=!0;var JA="ff533602d57df6f8ab3b0fea226ae52f",B_="2.0",tT=!1,BR=null,RP=(KA=(0,It.b2)(),KA(Qb=function(n){(0,Zt.Z)(a,n);var l=Jb(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"version",yu["GAODE2.x"]),(0,X.Z)((0,st.Z)(s),"handleViewChanged",function(m){var E=s.map.customCoords.getCameraParams(),A=E.fov,F=E.near,B=E.far,V=E.aspect,j=E.position,at=E.lookAt,ut=E.up;s.emit("mapchange");var xt=s.map.customCoords.getCenter();s.cameraChangedCallback&&(s.viewport.syncWithMapCamera({aspect:V,far:B,fov:A,cameraPosition:j,lookAt:at,up:ut,near:F,zoom:s.map.getZoom()-1,center:xt,offsetOrigin:[j[0],j[1]]}),s.coordinateSystemService.setCoordinateSystem(Pl.P20_2),s.cameraChangedCallback(s.viewport))}),s}return(0,et.Z)(a,[{key:"setCustomCoordCenter",value:function(o){this.sceneCenter=o,this.sceneCenterMKT=xl.apply(void 0,(0,me.Z)(o))}},{key:"getCustomCoordCenter",value:function(){return this.sceneCenterMKT}},{key:"lngLatToCoordByLayer",value:function(o,h){var v=h||this.sceneCenter,m=xl.apply(void 0,(0,me.Z)(v)),E=this._sub(xl(o[0],o[1]),m);return o[2]&&E.push(o[2]),E}},{key:"lngLatToCoordsByLayer",value:function(o,h){var v=this;return o.map(function(m){return typeof m[0]=="number"?v.lngLatToCoordByLayer(m,h):m.map(function(E){return v.lngLatToCoordByLayer(E,h)})})}},{key:"setCoordCenter",value:function(o){this.map.customCoords.setCenter(o||D_),this.setCustomCoordCenter(o||D_)}},{key:"lngLatToCoord",value:function(o){return this.sceneCenter||(this.map.customCoords.setCenter(o),this.setCustomCoordCenter(o)),this._sub(xl(o[0],o[1]),this.sceneCenterMKT)}},{key:"lngLatToCoords",value:function(o){var h=this;return o.map(function(v){return typeof v[0]=="number"?h.lngLatToCoord(v):v.map(function(m){return h.lngLatToCoord(m)})})}},{key:"addMarkerContainer",value:function(){if(!!this.map){var o=this.map.getContainer();if(o!==null){var h=o.getElementsByClassName("amap-maps")[0];h.style.zIndex="auto",this.markerContainer=bt("div","l7-marker-container2",h)}}}},{key:"updateView",value:function(o){}},{key:"getOverlayContainer",value:function(){}},{key:"getType",value:function(){return"amap2"}},{key:"getBounds",value:function(){var o=this.map.getBounds(),h=o.getNorthEast(),v=o.getSouthWest(),m=this.getCenter(),E=m.lng>h.getLng()||m.lng<v.getLng()?180-h.getLng():h.getLng(),A=m.lng<v.getLng()?v.getLng()-180:v.getLng();return[[A,v.getLat()],[E,h.getLat()]]}},{key:"getMinZoom",value:function(){var o=this.map.getZooms();return o[0]-1}},{key:"getMaxZoom",value:function(){var o=this.map.getZooms();return o[1]-1}},{key:"lngLatToContainer",value:function(o){var h=this.map.lngLatToContainer(o);return{x:h.getX(),y:h.getY()}}},{key:"getModelMatrix",value:function(o,h,v){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],E=this.map.customCoords.lngLatToCoord(o),A=Je();return pr(A,A,So.fromValues(E[0],E[1],h)),kr(A,A,So.fromValues(m[0],m[1],m[2])),vr(A,A,v[0]),tr(A,A,v[1]),Hr(A,A,v[2]),A}},{key:"init",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v,m,E,A,F,B,V,j,at,ut,xt,Nt,de,fe,Ne,Ye,_r,Ir,Nr,Yr,yn,fn;return it().wrap(function(di){for(;;)switch(di.prev=di.next){case 0:if(v=this.config,m=v.id,E=v.style,A=E===void 0?"light":E,F=v.minZoom,B=F===void 0?0:F,V=v.maxZoom,j=V===void 0?18:V,at=v.token,ut=at===void 0?JA:at,xt=v.mapInstance,Nt=v.plugin,de=Nt===void 0?[]:Nt,fe=v.version,Ne=fe===void 0?B_:fe,Ye=(0,Wl.Z)(v,OP),this.viewport=new qA,window.AMap||xt){di.next=6;break}return de.push("Map3D"),di.next=6,$A().load({key:ut,version:B_,plugins:de});case 6:xt?(this.map=xt,this.$mapContainer=this.map.getContainer(),Ir=this.map.getCenter(),(_r=this.map.customCoords)===null||_r===void 0||_r.setCenter([Ir.lng,Ir.lat]),this.setCustomCoordCenter([Ir.lng,Ir.lat]),this.map.on("viewchange",this.handleViewChanged)):(this.$mapContainer=this.creatMapContainer(m),Yr=(0,q.Z)({mapStyle:this.getMapStyleValue(A),zooms:[B,j],viewMode:"3D"},Ye),Yr.zoom&&(Yr.zoom+=1),ut===JA&&console.warn("%c".concat(this.configService.getSceneWarninfo("MapToken"),"!"),"color: #873bf4;font-weigh:900;font-size: 16px;"),yn=new AMap.Map(this.$mapContainer,Yr),this.map=yn,fn=yn.getCenter(),(Nr=this.map.customCoords)===null||Nr===void 0||Nr.setCenter([fn.lng,fn.lat]),this.setCustomCoordCenter([fn.lng,fn.lat]),yn.on("viewchange",this.handleViewChanged)),this.initViewPort();case 8:case"end":return di.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"onCameraChanged",value:function(o){this.cameraChangedCallback=o}},{key:"initViewPort",value:function(){var o,h=(o=this.map.customCoords)===null||o===void 0?void 0:o.getCameraParams(),v=h.fov,m=h.near,E=h.far,A=h.aspect,F=h.position,B=h.lookAt,V=h.up;this.emit("mapchange");var j=this.map.customCoords.getCenter(),at=this.map.getZoom();this.cameraChangedCallback&&(this.viewport.syncWithMapCamera({aspect:A,far:E,fov:v,cameraPosition:F,lookAt:B,near:m,up:V,zoom:at-1,center:j,offsetOrigin:[F[0],F[1]]}),this.coordinateSystemService.setCoordinateSystem(Pl.P20_2),this.cameraChangedCallback(this.viewport))}},{key:"_sub",value:function(o,h){var v=[0,0];return v[0]=o[0]-h[0],v[1]=o[1]-h[1],v}}]),a}(Bg))||Qb);function Kv(n){var l=DP();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function DP(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}var dd=function(n){(0,Zt.Z)(a,n);var l=Kv(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getServiceConstructor",value:function(){return RP}}]),a}(YA),Dm=ot(6158),t2=ot.n(Dm),NR={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}},IF,kF,LF,PF,OF,FF,N_,RF,DF,BF,NF,zF={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},zR=12,UR=(IF=(0,It.b2)(),kF=(0,It.f3)(Dt.MapConfig),LF=(0,It.f3)(Dt.IGlobalConfigService),PF=(0,It.f3)(Dt.ICoordinateSystemService),OF=(0,It.f3)(Dt.IEventEmitter),IF(FF=(N_=function(){function n(){var l=this;(0,ct.Z)(this,n),(0,X.Z)(this,"version",yu.DEFUALT),(0,X.Z)(this,"simpleMapCoord",new LP),(0,X.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),Ar(this,"config",RF,this),Ar(this,"configService",DF,this),Ar(this,"coordinateSystemService",BF,this),Ar(this,"eventEmitter",NF,this),(0,X.Z)(this,"handleCameraChanged",function(a){var s=l.map.getCenter(),o=s.lat,h=s.lng;l.emit("mapchange"),l.viewport.syncWithMapCamera({bearing:l.map.getBearing(),center:[h,o],viewportHeight:l.map.transform.height,pitch:l.map.getPitch(),viewportWidth:l.map.transform.width,zoom:l.map.getZoom(),cameraHeight:0}),l.updateCoordinateSystemService(),l.cameraChangedCallback(l.viewport)})}return(0,et.Z)(n,[{key:"setBgColor",value:function(a){this.bgColor=a}},{key:"addMarkerContainer",value:function(){var a=this.map.getCanvasContainer();this.markerContainer=bt("div","l7-marker-container",a),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"getOverlayContainer",value:function(){}},{key:"on",value:function(a,s){w1.indexOf(a)!==-1?this.eventEmitter.on(a,s):this.map.on(zF[a]||a,s)}},{key:"off",value:function(a,s){this.map.off(zF[a]||a,s),this.eventEmitter.off(a,s)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){if(this.version===yu.SIMPLE)return this.simpleMapCoord.getSize();var a=this.map.transform;return[a.width,a.height]}},{key:"getType",value:function(){return"default"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(a){return this.map.setZoom(a)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(a){this.map.setCenter(a)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(a){this.map.setBearing(a)}},{key:"zoomIn",value:function(a,s){this.map.zoomIn(a,s)}},{key:"zoomOut",value:function(a,s){this.map.zoomOut(a,s)}},{key:"setPitch",value:function(a){return this.map.setPitch(a)}},{key:"panTo",value:function(a){this.map.panTo(a)}},{key:"panBy",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.panTo([a,s])}},{key:"fitBounds",value:function(a,s){this.map.fitBounds(a,s)}},{key:"setMaxZoom",value:function(a){this.map.setMaxZoom(a)}},{key:"setMinZoom",value:function(a){this.map.setMinZoom(a)}},{key:"setMapStatus",value:function(a){a.doubleClickZoom===!0&&this.map.doubleClickZoom.enable(),a.doubleClickZoom===!1&&this.map.doubleClickZoom.disable(),a.dragEnable===!1&&this.map.dragPan.disable(),a.dragEnable===!0&&this.map.dragPan.enable(),a.rotateEnable===!1&&this.map.dragRotate.disable(),a.dragEnable===!0&&this.map.dragRotate.enable(),a.keyboardEnable===!1&&this.map.keyboard.disable(),a.keyboardEnable===!0&&this.map.keyboard.enable(),a.zoomEnable===!1&&this.map.scrollZoom.disable(),a.zoomEnable===!0&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(a,s){this.map.flyTo({zoom:a,center:s})}},{key:"setMapStyle",value:function(a){this.map.setStyle(this.getMapStyleValue(a))}},{key:"meterToCoord",value:function(a,s){return 1}},{key:"pixelToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToPixel",value:function(a){return this.map.project(a)}},{key:"containerToLngLat",value:function(a){return this.map.unproject(a)}},{key:"lngLatToContainer",value:function(a){return this.map.project(a)}},{key:"getMapStyle",value:function(){try{var a,s=(a=this.map.getStyle().sprite)!==null&&a!==void 0?a:"";return/^mapbox:\/\/sprites\/zcxduo\/\w+\/\w+$/.test(s)?s==null?void 0:s.replace(/\/\w+$/,"").replace(/sprites/,"styles"):s}catch(o){return""}}},{key:"getMapStyleConfig",value:function(){return NR}},{key:"getMapStyleValue",value:function(a){var s;return(s=this.getMapStyleConfig()[a])!==null&&s!==void 0?s:a}},{key:"destroy",value:function(){this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).emit.apply(s,[a].concat(h))}},{key:"once",value:function(a){for(var s,o=arguments.length,h=new Array(o>1?o-1:0),v=1;v<o;v++)h[v-1]=arguments[v];(s=this.eventEmitter).once.apply(s,[a].concat(h))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(a){var s=this.map.getCanvas(),o=a==="jpg"?s==null?void 0:s.toDataURL("image/jpeg"):s==null?void 0:s.toDataURL("image/png");return o}},{key:"onCameraChanged",value:function(a){this.cameraChangedCallback=a}},{key:"creatMapContainer",value:function(a){var s=a;return typeof a=="string"&&(s=document.getElementById(a)),s}},{key:"updateView",value:function(a){this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:a.bearing,center:a.center,viewportHeight:a.viewportHeight,pitch:a.pitch,viewportWidth:a.viewportWidth,zoom:a.zoom,cameraHeight:0}),this.updateCoordinateSystemService(),this.cameraChangedCallback(this.viewport)}},{key:"updateCoordinateSystemService",value:function(){var a=this.config.offsetCoordinate,s=a===void 0?!0:a;this.viewport.getZoom()>zR&&s?this.coordinateSystemService.setCoordinateSystem(Pl.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(Pl.LNGLAT)}}]),n}(),RF=Dr(N_.prototype,"config",[kF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DF=Dr(N_.prototype,"configService",[LF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BF=Dr(N_.prototype,"coordinateSystemService",[PF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NF=Dr(N_.prototype,"eventEmitter",[OF],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N_))||FF),ZR=function(){function n(){(0,ct.Z)(this,n)}return(0,et.Z)(n,[{key:"syncWithMapCamera",value:function(a){var s=a.center,o=a.zoom,h=a.pitch,v=a.bearing,m=a.viewportHeight,E=a.viewportWidth;this.viewport=new pn({width:E,height:m,longitude:s&&s[0],latitude:s&&s[1],zoom:o,pitch:h,bearing:v})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(a,s){return this.viewport.projectFlat(a,s)}}]),n}(),VR=["id","attributionControl","style","token","rotation","mapInstance"],UF,ZF;function GR(n){var l=HR();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function HR(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function jR(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}jR(`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:"";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`),window.mapboxgl=t2();var WR=0,VF="101MlGsZ2AmmA&access_token=pk.eyJ1IjoiZXhhbXBsZXMiLCJhIjoiY2p0MG01MXRqMW45cjQzb2R6b2ptc3J4MSJ9.zA2W0IkI0c6KaAhJfk9bWg",XR=(UF=(0,It.b2)(),UF(ZF=function(n){(0,Zt.Z)(a,n);var l=GR(a);function a(){var s;(0,ct.Z)(this,a);for(var o=arguments.length,h=new Array(o),v=0;v<o;v++)h[v]=arguments[v];return s=l.call.apply(l,[this].concat(h)),(0,X.Z)((0,st.Z)(s),"version",yu.MAPBOX),s}return(0,et.Z)(a,[{key:"getType",value:function(){return"mapbox"}},{key:"lngLatToCoord",value:function(o){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:0,y:0,z:0},v=this.lngLatToMercator(o,0),m=v.x,E=v.y;return[m-h.x,E-h.y]}},{key:"lngLatToMercator",value:function(o,h){var v=window.mapboxgl.MercatorCoordinate.fromLngLat(o,h),m=v.x,E=m===void 0?0:m,A=v.y,F=A===void 0?0:A,B=v.z,V=B===void 0?0:B;return{x:E,y:F,z:V}}},{key:"getModelMatrix",value:function(o,h,v){var m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[1,1,1],E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{x:0,y:0,z:0},A=window.mapboxgl.MercatorCoordinate.fromLngLat(o,h),F=A.meterInMercatorCoordinateUnits(),B=Je();return pr(B,B,So.fromValues(A.x-E.x,A.y-E.y,A.z||0-E.z)),kr(B,B,So.fromValues(F*m[0],-F*m[1],F*m[2])),vr(B,B,v[0]),tr(B,B,v[1]),Hr(B,B,v[2]),B}},{key:"init",value:function(){var s=(0,lt.Z)(it().mark(function h(){var v=this,m,E,A,F,B,V,j,at,ut,xt,Nt,de,fe;return it().wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:m=this.config,E=m.id,A=E===void 0?"map":E,F=m.attributionControl,B=F===void 0?!1:F,V=m.style,j=V===void 0?"light":V,at=m.token,ut=at===void 0?VF:at,xt=m.rotation,Nt=xt===void 0?0:xt,de=m.mapInstance,fe=(0,Wl.Z)(m,VR),this.viewport=new ZR,!de&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),ut===VF&&j!=="blank"&&!window.mapboxgl.accessToken&&!de&&console.warn(this.configService.getSceneWarninfo("MapToken")),!de&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=ut),de?(this.map=de,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatMapContainer(A),this.map=new window.mapboxgl.Map((0,q.Z)({container:this.$mapContainer,style:this.getMapStyleValue(j),attributionControl:B,bearing:Nt},fe))),this.map.on("load",function(){v.handleCameraChanged()}),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return Ye.stop()}},h,this)}));function o(){return s.apply(this,arguments)}return o}()},{key:"destroy",value:function(){var o,h;(o=this.$mapContainer)===null||o===void 0||(h=o.parentNode)===null||h===void 0||h.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(o){for(var h,v=arguments.length,m=new Array(v>1?v-1:0),E=1;E<v;E++)m[E-1]=arguments[E];(h=this.eventEmitter).emit.apply(h,[o].concat(m))}},{key:"once",value:function(o){for(var h,v=arguments.length,m=new Array(v>1?v-1:0),E=1;E<v;E++)m[E-1]=arguments[E];(h=this.eventEmitter).once.apply(h,[o].concat(m))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"meterToCoord",value:function(o,h){var v=new(t2()).LngLat(o[0],o[1]),m=new(t2()).LngLat(h[0],h[1]),E=v.distanceTo(m),A=t2().MercatorCoordinate.fromLngLat({lng:o[0],lat:o[1]}),F=t2().MercatorCoordinate.fromLngLat({lng:h[0],lat:h[1]}),B=A.x,V=A.y,j=F.x,at=F.y,ut=Math.sqrt(Math.pow(B-j,2)+Math.pow(V-at,2))*4194304*2;return ut/E}},{key:"exportMap",value:function(o){var h=this.map.getCanvas(),v=o==="jpg"?h==null?void 0:h.toDataURL("image/jpeg"):h==null?void 0:h.toDataURL("image/png");return v}},{key:"creatMapContainer",value:function(o){var h=o;typeof o=="string"&&(h=document.getElementById(o));var v=document.createElement("div");return v.style.cssText+=`
      position: absolute;
      top: 0;
      height: 100%;
      width: 100%;
    `,v.id="l7_mapbox_div"+WR++,h.appendChild(v),v}}]),a}(UR))||ZF);function YR(n){var l=$R();return function(){var s=(0,b.Z)(n),o;if(l){var h=(0,b.Z)(this).constructor;o=Reflect.construct(s,arguments,h)}else o=s.apply(this,arguments);return(0,P.Z)(this,o)}}function $R(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}function qR(n,l){var a=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,s=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined");if(!(a||s)&&(l||(l=document),!!l)){var o=l.head||l.getElementsByTagName("head")[0];if(!o){o=l.createElement("head");var h=l.body||l.getElementsByTagName("body")[0];h?h.parentNode.insertBefore(o,h):l.documentElement.appendChild(o)}var v=l.createElement("style");return v.type="text/css",v.styleSheet?v.styleSheet.cssText=n:v.appendChild(l.createTextNode(n)),o.appendChild(v),v}}qR(`.mapboxgl-ctrl-logo {
 display: none !important;
}
`);var KR=function(n){(0,Zt.Z)(a,n);var l=YR(a);function a(){return(0,ct.Z)(this,a),l.apply(this,arguments)}return(0,et.Z)(a,[{key:"getServiceConstructor",value:function(){return XR}}]),a}(YA),eT=ot(90494),ph=ot(45442),BP={fontFamily:`
  "-apple-system", BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`},NP="l7plot-tooltip",zP="l7plot-tooltip__title",UP="l7plot-tooltip__list",GF="l7plot-tooltip__list-item",HF="l7plot-tooltip__name",jF="l7plot-tooltip__value",QR='<div class="'.concat(NP,`">
  <div class="`).concat(zP,`"></div>
  <ul class="`).concat(UP,`"></ul>
</div>`),WF='<li class="'.concat(GF,`" data-index={index}>
  <span class="`).concat(HF,`">{name}</span>
  <span class="`).concat(jF,`">{value}</span>
</li>`),Ng,JR=(Ng={},Ng[NP]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:BP.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},Ng[zP]={marginBottom:"4px"},Ng[UP]={margin:"0px",listStyleType:"none",padding:"0px"},Ng[GF]={listStyleType:"none",marginBottom:"4px",whiteSpace:"nowrap",display:"flex",justifyContent:"space-between"},Ng[HF]={},Ng[jF]={marginLeft:"30px"},Ng),t6=ot(6056);function e6(n,l){return!!n.className.match(new RegExp("(\\s|^)".concat(l,"(\\s|$)")))}function ZP(n){for(var l=n.childNodes,a=l.length,s=a-1;s>=0;s--)n.removeChild(l[s])}var VP=function(){function n(l){this.destroyed=!1,this.options=(0,Et.b$)({},this.getDefaultOptions(),l),this.container=this.initContainer(),this.initDom(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible(),this.render()}return n.prototype.getDefaultOptions=function(){return{name:"",containerTpl:"<div></div>",visible:!0,capture:!0,domStyles:{}}},n.prototype.getContainer=function(){return this.container},n.prototype.getParentContainer=function(){var l=this.options.parent,a;if(!l)return a;if((0,Et.HD)(l)){var s=document.getElementById(l);if(s)a=s;else throw new Error("No parent id ".concat(l))}else a=l;return a},n.prototype.initContainer=function(){var l=this.createDom(this.options.containerTpl),a=this.getParentContainer();return a&&a.appendChild(l),l},n.prototype.initVisible=function(){this.options.visible?this.show():this.hide()},n.prototype.initCapture=function(){this.setCapture(this.options.capture)},n.prototype.update=function(l){this.options=(0,Et.b$)({},this.options,l),this.updateInner(l),this.afterUpdate(l)},n.prototype.updateInner=function(l){l.domStyles&&this.applyStyles()},n.prototype.afterUpdate=function(l){l.capture&&this.setCapture(l.capture)},n.prototype.setCapture=function(l){var a=this.container,s=l?"auto":"none";a.style.pointerEvents=s},n.prototype.applyStyles=function(){var l=this.options.domStyles;if(!!l){var a=this.container;this.applyChildrenStyles(a,l);var s=this.options.className;if(s&&e6(a,s)){var o=l[s];(0,ph.Z)(a,o)}}},n.prototype.applyChildrenStyles=function(l,a){(0,Et.S6)(a,function(s,o){var h=l.getElementsByClassName(o);(0,Et.S6)(h,function(v){(0,ph.Z)(v,s)})})},n.prototype.applyStyle=function(l,a){var s=this.options.domStyles;s&&(0,ph.Z)(a,s[l])},n.prototype.createDom=function(l){return l===void 0&&(l="<div></div>"),(0,t6.Z)(l)},n.prototype.removeDom=function(){var l=this.container;l&&l.parentNode&&l.parentNode.removeChild(l)},n.prototype.destroy=function(){this.removeEvent(),this.removeDom(),this.destroyed=!0},n}(),r6=function(n){(0,I.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,Et.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-tooltip",name:"l7plot-tooltip",title:"",showTitle:!0,items:[],containerTpl:QR,itemTpl:WF,domStyles:JR,className:NP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),o=this.getParentContainer();return o&&o.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(zP)[0],o=a.getElementsByClassName(UP)[0];this.titleDom=s,this.listDom=o},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.items&&this.renderItems()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,o=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(o,h),this.container=o,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,o=a(this.options.title||"",this.options.items);return(0,Et.HD)(o)?s=this.createDom(o):s=o,s},l.prototype.resetTitle=function(){var a=this.options.title,s=this.options.showTitle;s&&a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderItems=function(){var a=this;this.clearItemDoms();var s=this.options.items,o=this.options.itemTpl||WF,h=this.listDom;h&&(s.forEach(function(v){var m=(0,I.pi)({},v),E=(0,Et.ng)(o,m),A=a.createDom(E);h.appendChild(A)}),this.applyChildrenStyles(h,this.options.domStyles))},l.prototype.clearItemDoms=function(){this.listDom&&ZP(this.listDom)},l.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},l}(VP),n6=Array.isArray,GP=n6,i6=typeof global=="object"&&global&&global.Object===Object&&global,a6=i6,o6=typeof self=="object"&&self&&self.Object===Object&&self,s6=a6||o6||Function("return this")(),rT=s6,u6=rT.Symbol,z_=u6,XF=Object.prototype,l6=XF.hasOwnProperty,c6=XF.toString,e2=z_?z_.toStringTag:void 0;function f6(n){var l=l6.call(n,e2),a=n[e2];try{n[e2]=void 0;var s=!0}catch(h){}var o=c6.call(n);return s&&(l?n[e2]=a:delete n[e2]),o}var h6=f6,p6=Object.prototype,d6=p6.toString;function v6(n){return d6.call(n)}var g6=v6,m6="[object Null]",y6="[object Undefined]",YF=z_?z_.toStringTag:void 0;function _6(n){return n==null?n===void 0?y6:m6:YF&&YF in Object(n)?h6(n):g6(n)}var $F=_6;function x6(n){return n!=null&&typeof n=="object"}var b6=x6,E6="[object Symbol]";function w6(n){return typeof n=="symbol"||b6(n)&&$F(n)==E6}var nT=w6,S6=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,C6=/^\w*$/;function A6(n,l){if(GP(n))return!1;var a=typeof n;return a=="number"||a=="symbol"||a=="boolean"||n==null||nT(n)?!0:C6.test(n)||!S6.test(n)||l!=null&&n in Object(l)}var T6=A6;function M6(n){var l=typeof n;return n!=null&&(l=="object"||l=="function")}var iT=M6,I6="[object AsyncFunction]",k6="[object Function]",L6="[object GeneratorFunction]",P6="[object Proxy]";function O6(n){if(!iT(n))return!1;var l=$F(n);return l==k6||l==L6||l==I6||l==P6}var F6=O6,R6=rT["__core-js_shared__"],HP=R6,qF=function(){var n=/[^.]+$/.exec(HP&&HP.keys&&HP.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function D6(n){return!!qF&&qF in n}var B6=D6,N6=Function.prototype,z6=N6.toString;function U6(n){if(n!=null){try{return z6.call(n)}catch(l){}try{return n+""}catch(l){}}return""}var Z6=U6,V6=/[\\^$.*+?()[\]{}|]/g,G6=/^\[object .+?Constructor\]$/,H6=Function.prototype,j6=Object.prototype,W6=H6.toString,X6=j6.hasOwnProperty,Y6=RegExp("^"+W6.call(X6).replace(V6,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $6(n){if(!iT(n)||B6(n))return!1;var l=F6(n)?Y6:G6;return l.test(Z6(n))}var q6=$6;function K6(n,l){return n==null?void 0:n[l]}var Q6=K6;function J6(n,l){var a=Q6(n,l);return q6(a)?a:void 0}var KF=J6,tD=KF(Object,"create"),r2=tD;function eD(){this.__data__=r2?r2(null):{},this.size=0}var rD=eD;function nD(n){var l=this.has(n)&&delete this.__data__[n];return this.size-=l?1:0,l}var iD=nD,aD="__lodash_hash_undefined__",oD=Object.prototype,sD=oD.hasOwnProperty;function uD(n){var l=this.__data__;if(r2){var a=l[n];return a===aD?void 0:a}return sD.call(l,n)?l[n]:void 0}var lD=uD,cD=Object.prototype,fD=cD.hasOwnProperty;function hD(n){var l=this.__data__;return r2?l[n]!==void 0:fD.call(l,n)}var pD=hD,dD="__lodash_hash_undefined__";function vD(n,l){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=r2&&l===void 0?dD:l,this}var gD=vD;function U_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}U_.prototype.clear=rD,U_.prototype.delete=iD,U_.prototype.get=lD,U_.prototype.has=pD,U_.prototype.set=gD;var QF=U_;function mD(){this.__data__=[],this.size=0}var yD=mD;function _D(n,l){return n===l||n!==n&&l!==l}var xD=_D;function bD(n,l){for(var a=n.length;a--;)if(xD(n[a][0],l))return a;return-1}var aT=bD,ED=Array.prototype,wD=ED.splice;function SD(n){var l=this.__data__,a=aT(l,n);if(a<0)return!1;var s=l.length-1;return a==s?l.pop():wD.call(l,a,1),--this.size,!0}var CD=SD;function AD(n){var l=this.__data__,a=aT(l,n);return a<0?void 0:l[a][1]}var TD=AD;function MD(n){return aT(this.__data__,n)>-1}var ID=MD;function kD(n,l){var a=this.__data__,s=aT(a,n);return s<0?(++this.size,a.push([n,l])):a[s][1]=l,this}var LD=kD;function Z_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}Z_.prototype.clear=yD,Z_.prototype.delete=CD,Z_.prototype.get=TD,Z_.prototype.has=ID,Z_.prototype.set=LD;var PD=Z_,OD=KF(rT,"Map"),FD=OD;function RD(){this.size=0,this.__data__={hash:new QF,map:new(FD||PD),string:new QF}}var DD=RD;function BD(n){var l=typeof n;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?n!=="__proto__":n===null}var ND=BD;function zD(n,l){var a=n.__data__;return ND(l)?a[typeof l=="string"?"string":"hash"]:a.map}var oT=zD;function UD(n){var l=oT(this,n).delete(n);return this.size-=l?1:0,l}var ZD=UD;function VD(n){return oT(this,n).get(n)}var GD=VD;function HD(n){return oT(this,n).has(n)}var jD=HD;function WD(n,l){var a=oT(this,n),s=a.size;return a.set(n,l),this.size+=a.size==s?0:1,this}var XD=WD;function V_(n){var l=-1,a=n==null?0:n.length;for(this.clear();++l<a;){var s=n[l];this.set(s[0],s[1])}}V_.prototype.clear=DD,V_.prototype.delete=ZD,V_.prototype.get=GD,V_.prototype.has=jD,V_.prototype.set=XD;var JF=V_,YD="Expected a function";function jP(n,l){if(typeof n!="function"||l!=null&&typeof l!="function")throw new TypeError(YD);var a=function(){var s=arguments,o=l?l.apply(this,s):s[0],h=a.cache;if(h.has(o))return h.get(o);var v=n.apply(this,s);return a.cache=h.set(o,v)||h,v};return a.cache=new(jP.Cache||JF),a}jP.Cache=JF;var $D=jP,qD=500;function KD(n){var l=$D(n,function(s){return a.size===qD&&a.clear(),s}),a=l.cache;return l}var QD=KD,JD=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t7=/\\(\\)?/g,e7=QD(function(n){var l=[];return n.charCodeAt(0)===46&&l.push(""),n.replace(JD,function(a,s,o,h){l.push(o?h.replace(t7,"$1"):s||a)}),l}),r7=e7;function n7(n,l){for(var a=-1,s=n==null?0:n.length,o=Array(s);++a<s;)o[a]=l(n[a],a,n);return o}var i7=n7,a7=1/0,tR=z_?z_.prototype:void 0,eR=tR?tR.toString:void 0;function rR(n){if(typeof n=="string")return n;if(GP(n))return i7(n,rR)+"";if(nT(n))return eR?eR.call(n):"";var l=n+"";return l=="0"&&1/n==-a7?"-0":l}var o7=rR;function s7(n){return n==null?"":o7(n)}var WP=s7;function u7(n,l){return GP(n)?n:T6(n,l)?[n]:r7(WP(n))}var l7=u7,c7=1/0;function f7(n){if(typeof n=="string"||nT(n))return n;var l=n+"";return l=="0"&&1/n==-c7?"-0":l}var h7=f7;function p7(n,l){l=l7(l,n);for(var a=0,s=l.length;n!=null&&a<s;)n=n[h7(l[a++])];return a&&a==s?n:void 0}var d7=p7;function v7(n,l,a){var s=n==null?void 0:d7(n,l);return s===void 0?a:s}var nR=v7,g7=5,m7=new Object().toString,iR=function(n,l){return m7.call(n)==="[object "+l+"]"},y7=function(n){return iR(n,"Array")},_7=function(n){return typeof n=="object"&&n!==null},aR=function(n){if(!_7(n)||!iR(n,"Object"))return!1;for(var l=n;Object.getPrototypeOf(l)!==null;)l=Object.getPrototypeOf(l);return Object.getPrototypeOf(n)===l},oR=function(n,l,a,s){a=a||0,s=s||g7;for(var o in l)if(Object.prototype.hasOwnProperty.call(l,o)){var h=l[o];h?aR(h)?(aR(n[o])||(n[o]={}),a<s?oR(n[o],h,a+1,s):n[o]=l[o]):y7(h)?(n[o]=[],n[o]=n[o].concat(h)):n[o]=h:n[o]=h}},Ip=function(n){for(var l=[],a=1;a<arguments.length;a++)l[a-1]=arguments[a];for(var s=0;s<l.length;s+=1)oR(n,l[s]);return n},x7=["mousemove","click"],b7=function(n){(0,I.ZT)(l,n);function l(a,s,o){var h=n.call(this)||this;h.currentVisible=!1,h.interactionTriggerHander=function(at){var ut=at.feature,xt=at.featureId,Nt=h.options,de=Nt.title,fe=Nt.customTitle,Ne=Nt.items,Ye=Nt.customItems,_r=ut.type==="Feature"&&ut.geometry&&ut.properties,Ir=_r?ut.properties:ut,Nr=[];if(Ye){var Yr=Ye(ut);if(Array.isArray(Yr))Nr=Yr;else throw new Error("customItems return array")}else Ne&&Ne.forEach(function(fn){if((0,Et.HD)(fn)){var $n=fn.split(".").pop()||fn,di=nR(Ir,fn);di!==void 0&&Nr.push({name:$n,value:di})}else{var Yi=fn.field,ho=fn.alias,zo=fn.customValue,Vs=ho||Yi.split(".").pop()||Yi,di=nR(Ir,Yi);di!==void 0&&Nr.push({name:Vs,value:zo?zo(di,Ir,xt):di})}});var yn={title:fe?fe(Ir):de,items:Nr};h.updateTooltip(at,yn)},h.interactionUntriggerHander=function(){h.hideTooltip()},h.scene=a,h.interactionLayers=s,h.options=Ip({},h.getDefaultOptions(),o);var v=h.options,m=v.offsets,E=v.title,A=v.showTitle,F=v.customContent,B=v.domStyles,V=v.anchor,j=v.className;return h.marker=new S1({offsets:m,anchor:V,draggable:!1}),h.tooltipComponent=new r6({title:E,showTitle:A,items:[],customContent:F,domStyles:B,className:j}),h.setComponent(),h.initInteractionEvent(),h}return l.prototype.getDefaultOptions=function(){return{showTitle:!0,showComponent:!0,items:[],offsets:[15,0],trigger:"mousemove",anchor:rr["TOP-LEFT"]}},l.prototype.update=function(a){this.marker.remove(),this.currentVisible=!1,this.options=Ip({},this.options,a);var s=this.options,o=s.offsets,h=s.showTitle,v=s.customContent,m=s.domStyles,E=s.anchor,A=s.className;this.marker=new S1({offsets:o,anchor:E,draggable:!1}),this.tooltipComponent.update({showTitle:h,customContent:v,domStyles:m,className:A}),this.setComponent()},l.prototype.initInteractionEvent=function(){var a=this,s=this.options.trigger||"mousemove";if(!x7.includes(s))throw new Error("trigger is mousemove or click");this.interactionLayers.forEach(function(o){var h=o.layer;h.on(s,a.interactionTriggerHander),h.on("un".concat(s),a.interactionUntriggerHander)})},l.prototype.unBindInteractionEvent=function(){var a=this,s=this.options.trigger||"mousemove";this.interactionLayers.forEach(function(o){var h=o.layer;h.off(s,a.interactionTriggerHander),h.off("un".concat(s),a.interactionUntriggerHander)})},l.prototype.updateTooltip=function(a,s){var o=a.lngLat,h=a.x,v=a.y;if(this.options.showComponent&&(this.updateComponent(s),this.setPostion(o)),this.currentVisible){var m={type:"tooltip:change",data:s,lngLat:o,x:h,y:v};this.emit("tooltip:change",m)}else{this.showTooltip();var E={type:"tooltip:show",data:s,lngLat:o,x:h,y:v};this.emit("tooltip:show",E)}},l.prototype.showTooltip=function(){this.currentVisible||(this.options.showComponent&&this.scene.addMarker(this.marker),this.currentVisible=!0)},l.prototype.hideTooltip=function(){if(!!this.currentVisible){this.options.showComponent&&this.marker.remove(),this.currentVisible=!1;var a={type:"tooltip:hide"};this.emit("tooltip:hide",a)}},l.prototype.updateComponent=function(a){(0,Et.Xy)(this.lastComponentOptions,a)||(this.tooltipComponent.update(a),this.lastComponentOptions=a)},l.prototype.setComponent=function(){var a=this.tooltipComponent.getContainer(),s=window.document.createElement("div");s.style.cursor="auto",s.style.userSelect="text",s.className="l7plot-tooltip-container",["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(o){s.addEventListener(o,function(h){return h.stopPropagation()})}),s.appendChild(a),this.marker.setElement(s)},l.prototype.setPostion=function(a){this.marker.setLnglat(a)},l.prototype.destroy=function(){this.unBindInteractionEvent(),this.off(),this.marker.remove(),this.tooltipComponent.destroy()},l}(eT.Z),XP="l7plot-legend l7plot-legend__category",YP="l7plot-legend__title",$P="l7plot-legend__category-list",sR="l7plot-legend__list-item",uR="l7plot-legend__category-marker",lR="l7plot-legend__category-value",E7='<div class="'.concat(XP,`">
  <div class="`).concat(YP,`"></div>
  <ul class="`).concat($P,`"></ul>
</div>`),cR='<li class="'.concat(sR,`" data-index={index}>
  <span class="`).concat(uR,`" style="background:{color}"></span>
  <span class="`).concat(lR,`">{value}</span>
</li>`),zg,w7=(zg={},zg[XP]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:BP.fontFamily,padding:"10px 10px 6px 10px",lineHeight:1,fontSize:"12px"},zg[YP]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},zg[$P]={margin:"0px",listStyleType:"none",padding:"0px"},zg[sR]={listStyleType:"none",display:"flex",alignItems:"center",marginBottom:"2px"},zg[uR]={width:"10px",height:"10px"},zg[lR]={paddingLeft:"8px"},zg),S7=function(n){(0,I.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,Et.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-category-legend",name:"l7plot-category-legend",title:"",items:[],containerTpl:E7,itemTpl:cR,domStyles:w7,className:XP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),o=this.getParentContainer();return o&&o.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(YP)[0],o=a.getElementsByClassName($P)[0];this.titleDom=s,this.listDom=o},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderItems())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.items&&this.renderItems()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,o=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(o,h),this.container=o,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,o=a(this.options.title||"",this.options.items);return(0,Et.HD)(o)?s=this.createDom(o):s=o,s},l.prototype.resetTitle=function(){var a=this.options.title;a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderItems=function(){var a=this;this.clearItemDoms();var s=this.options.items.length>30?this.options.items.slice(0,30):this.options.items,o=this.options.itemTpl||cR,h=this.listDom;h&&(s.forEach(function(v){var m=v.value==="",E=m?"\u2014":Array.isArray(v.value)?v.value.join(" - "):v.value,A=(0,I.pi)((0,I.pi)({},v),{value:E}),F=(0,Et.ng)(o,A),B=a.createDom(F);h.appendChild(B)}),this.applyChildrenStyles(h,this.options.domStyles))},l.prototype.clearItemDoms=function(){this.listDom&&ZP(this.listDom)},l.prototype.clear=function(){this.setTitle(""),this.clearItemDoms()},l}(VP),qP="l7plot-legend l7plot-legend__continue",KP="l7plot-legend__title",fR="l7plot-legend__ribbon-container",hR="l7plot-legend__ribbon",pR="l7plot-legend__gradient-bar",QP="l7plot-legend__value-range",C7='<div class="'.concat(qP,`">
  <div class="`).concat(KP,`"></div>
  <div class="`).concat(fR,`"></div>
</div>`),dR='<div class="'.concat(hR,`">
  <span class="`).concat(QP,`">{min}</span>
  <div class="`).concat(pR,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(QP,`">{max}</span>
</div>`),Bm,A7=(Bm={},Bm[qP]={visibility:"visible",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",borderRadius:"2px",color:"rgb(87, 87, 87)",fontFamily:BP.fontFamily,padding:"10px",lineHeight:1,fontSize:"12px"},Bm[KP]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},Bm[hR]={display:"flex",alignItems:"center"},Bm[pR]={width:"140px",height:"14px",margin:"0px 5px"},Bm[QP]={padding:"0px"},Bm),T7=function(n){(0,I.ZT)(l,n);function l(){return n!==null&&n.apply(this,arguments)||this}return l.prototype.getDefaultOptions=function(){return(0,Et.b$)({},n.prototype.getDefaultOptions.call(this),{id:"l7plot-continue-legend",name:"l7plot-continue-legend",title:"",containerTpl:C7,ribbonTpl:dR,domStyles:A7,className:qP})},l.prototype.initContainer=function(){var a=this.options.customContent;if(a){var s=this.getHtmlContentNode(a),o=this.getParentContainer();return o&&o.appendChild(s),s}else return n.prototype.initContainer.call(this)},l.prototype.initDom=function(){this.cacheDoms()},l.prototype.initEvent=function(){},l.prototype.removeEvent=function(){},l.prototype.cacheDoms=function(){var a=this.container,s=a.getElementsByClassName(KP)[0],o=a.getElementsByClassName(fR)[0];this.titleDom=s,this.ribbonContainerDom=o},l.prototype.render=function(){this.options.customContent?this.renderCustomContent(this.options.customContent):(this.resetTitle(),this.renderRibbon())},l.prototype.show=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"visible"})},l.prototype.hide=function(){var a=this.container;!a||this.destroyed||(0,ph.Z)(a,{visibility:"hidden"})},l.prototype.updateInner=function(a){this.options.customContent?this.renderCustomContent(this.options.customContent):(a.title&&this.resetTitle(),a.colors&&this.renderRibbon()),n.prototype.updateInner.call(this,a)},l.prototype.renderCustomContent=function(a){var s=this.container.parentNode,o=this.getHtmlContentNode(a),h=this.container;s&&s.replaceChild(o,h),this.container=o,this.applyStyles()},l.prototype.getHtmlContentNode=function(a){var s,o=a(this.options.title||"",this.options.min,this.options.max,this.options.colors);return(0,Et.HD)(o)?s=this.createDom(o):s=o,s},l.prototype.resetTitle=function(){var a=this.options.title;a?(this.showTitle(),this.setTitle(a)):this.hideTitle()},l.prototype.showTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"block"})},l.prototype.hideTitle=function(){var a=this.titleDom;a&&(0,ph.Z)(a,{display:"none"})},l.prototype.setTitle=function(a){var s=this.titleDom;s&&(s.innerHTML=a)},l.prototype.renderRibbon=function(){this.clearRibbonContainerDoms();var a=this.options,s=a.min,o=a.max,h=a.colors,v=a.ribbonTpl,m=v===void 0?dR:v,E=this.ribbonContainerDom;if(E){var A="linear-gradient(to right, ".concat(h.join(", "),")"),F={min:s,max:o,backgroundImage:A},B=(0,Et.ng)(m,F),V=this.createDom(B);E.appendChild(V),this.applyChildrenStyles(E,this.options.domStyles)}},l.prototype.clearRibbonContainerDoms=function(){this.ribbonContainerDom&&ZP(this.ribbonContainerDom)},l.prototype.clear=function(){this.setTitle(""),this.clearRibbonContainerDoms()},l}(VP),M7=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this,a)||this;return s.legendComponents=[],s.options=a,s.legendComponents=s.initLegendComponents(a.items),s}return l.prototype.initLegendComponents=function(a){for(var s=[],o=0;o<a.length;o++){var h=a[o];if(h.type==="category"){var v=new S7({title:h.options.title,items:h.options.items,className:h.options.className,customContent:h.options.customContent,domStyles:h.options.domStyles});s.push(v)}else if(h.type==="continue"){var v=new T7({title:h.options.title,min:h.options.min,max:h.options.max,colors:h.options.colors,className:h.options.className,customContent:h.options.customContent,domStyles:h.options.domStyles});s.push(v)}}return s},l.prototype.getDefaultOptions=function(){return{position:"bottomleft"}},l.prototype.onAdd=function(){var a=window.document.createElement("div");return a.className="l7plot-legend-container",this.legendComponents.forEach(function(s){var o=s.getContainer();a.appendChild(o)}),a},l.prototype.onRemove=function(){this.legendComponents.forEach(function(a){a.destroy()})},l}(v0),G_;(function(n){n.Amap="amap",n.Mapbox="mapbox"})(G_||(G_={}));var vR=function(n){(0,I.ZT)(l,n);function l(a,s){a===void 0&&(a=[]),s===void 0&&(s={});var o=n.call(this)||this;return o.name=s.name?s.name:(0,Et.EL)("layerGroup"),o.layers=a,o}return l.prototype.addTo=function(a){var s=this;this.scene=a;var o=0,h=this.layers.length;this.layers.forEach(function(v){v.once("inited",function(m){o++,s.emit("inited",m),o===h&&s.emit("inited-all")}),v.addTo(a)})},l.prototype.hasLayer=function(a){return this.layers.some(function(s){return s===a})},l.prototype.addLayer=function(a){var s=this;this.layers.push(a),this.scene&&(a.once("inited",function(o){return s.emit("inited",o)}),a.addTo(this.scene))},l.prototype.removeLayer=function(a){var s=this.layers.findIndex(function(o){return o===a});return s===-1?!1:(this.layers.splice(s,1),this.scene&&a.remove(this.scene),!0)},l.prototype.getLayers=function(){return this.layers},l.prototype.getInteractionLayers=function(){return this.layers.filter(function(a){var s=a.interaction;return s})},l.prototype.getLayer=function(a){return this.layers.find(function(s){var o=s.layer;return o.id===a})},l.prototype.getLayerByName=function(a){return this.layers.find(function(s){return s.name===a})},l.prototype.removeAllLayer=function(){var a=this;this.layers.forEach(function(s){a.scene&&s.remove(a.scene)}),this.layers=[]},l.prototype.isEmpty=function(){return this.layers.length===0},l}(eT.Z),I7=[{original:"loaded",adaptation:"scene-loaded"},{original:"resize",adaptation:"resize"},{original:"destroy",adaptation:"destroy"},{original:"resize",adaptation:"resize"}],k7=["mapmove","movestart","moveend","zoomchange","zoomstart","zoomend","click","dblclick","contextmenu","mousemove","mousewheel","mouseover","mouseout","mouseup","mousedown","dragstart","dragging","dragend"],sT=["inited","add","remove","dataUpdate","click","unclick","contextmenu","uncontextmenu","mouseenter","mousemove","unmousemove","mouseout","mouseup","unmouseup","mousedown","uncontextmenu","unpick"],Nm=new Map;function P8(n,l){Nm.set(n,l)}function O8(n){n.forEach(function(l){Nm.set(l.id,l.image)})}function F8(n){return Nm.get(n)}function R8(n){return Nm.has(n)}function D8(n){return Nm.delete(n)}var uT=new Map;function B8(n,l){uT.set(n,l)}function N8(n){return uT.delete(n)}var n2=new Map;function z8(n,l){n2.set(n,l)}function U8(n){n.forEach(function(l){n2.set(l.name,l.fontUnicode)})}function Z8(n){return n2.delete(n)}var H_=ot(77972),j_=ot(3876),i2=ot(56992);function gR(n){var l,a,s,o={point:{default:{fill:n.pointFillColor,size:n.pointSize,stroke:n.pointBorderColor,lineWidth:n.pointBorder,fillOpacity:n.pointFillOpacity},active:{fill:n.pointActiveFillColor},selected:{fill:n.pointSelectedFillColor}}};return{mapStyle:n.mapStyle,defaultColor:n.brandColor,subColor:n.subColor,semanticRed:n.paletteSemanticRed,semanticGreen:n.paletteSemanticGreen,fontFamily:n.fontFamily,colors10:n.paletteQualitative10,colors20:n.paletteQualitative20,sequenceColors:n.paletteSequence,shapes:{point:["circle","square"],line:["line"]},sizes:[1,10],geometries:{point:{circle:{default:{style:o.point.default},active:{style:o.point.active},selected:{style:o.point.selected}}},line:{},polygon:{}},components:{legend:{category:{domStyles:(l={},l[j_.rC]={visibility:"visible",zIndex:1,backgroundColor:n.legendContainerFillColor,boxShadow:n.legendContainerShadow,borderRadius:"".concat(n.legendContainerBorderRadius,"px"),color:n.legendTextFillColor,fontFamily:n.fontFamily,padding:"10px",lineHeight:"1",fontSize:"".concat(n.legendTextFontSize,"px")},l[j_.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},l[j_.fL]={margin:"0px",padding:"0px"},l[j_.jp]={marginBottom:"2px"},l[j_.Bc]={width:"10px",height:"10px"},l[j_.Tf]={paddingLeft:"8px"},l)},continue:{domStyles:(a={},a[i2.rC]={visibility:"visible",zIndex:1,backgroundColor:n.legendContainerFillColor,boxShadow:n.legendContainerShadow,borderRadius:"".concat(n.legendContainerBorderRadius,"px"),color:n.legendTextFillColor,fontFamily:n.fontFamily,padding:"10px",lineHeight:1,fontSize:"".concat(n.legendTextFontSize,"px")},a[i2.O6]={fontSize:"13px",lineHeight:"19px",marginBottom:"8px"},a[i2.el]={display:"flex",alignItems:"center"},a[i2.bl]={width:"140px",height:"14px",margin:"0px 5px"},a[i2.VI]={padding:"0px"},a)}},tooltip:{domStyles:(s={},s[H_.rC]={visibility:"visible",zIndex:999,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:n.tooltipContainerFillColor,boxShadow:n.tooltipContainerShadow,borderRadius:"".concat(n.tooltipContainerBorderRadius,"px"),color:n.tooltipTextFillColor,fontSize:"".concat(n.tooltipTextFontSize,"px"),fontFamily:n.fontFamily,lineHeight:n.tooltipTextLineHeight},s[H_.O6]={marginBottom:"4px"},s[H_.fL]={margin:"0px",padding:"0px"},s[H_.jp]={marginBottom:"4px"},s[H_.bX]={color:n.tooltipItemNameFillColor},s[H_.Tf]={color:n.tooltipItemValueFillColor,marginLeft:"30px"},s)},label:{style:{textAnchor:"center",textOffset:[0,0],fill:n.labelFillColor,fontSize:n.labelFontSize,fontFamily:n.fontFamily,fillColorDark:n.labelFillColorDark,fillColorLight:n.labelFillColorLight}}}}}var zm={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},L7={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},P7=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],O7=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],F7=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],mR=function(n){n===void 0&&(n={});var l=n.mapStyle,a=l===void 0?"light":l,s=n.subColor,o=s===void 0?"rgba(0,0,0,0.05)":s,h=n.paletteQualitative10,v=h===void 0?P7:h,m=n.paletteQualitative20,E=m===void 0?O7:m,A=n.paletteSemanticRed,F=A===void 0?"#F4664A":A,B=n.paletteSemanticGreen,V=B===void 0?"#30BF78":B,j=n.paletteSemanticYellow,at=j===void 0?"#FAAD14":j,ut=n.paletteSequence,xt=ut===void 0?F7:ut,Nt=n.fontFamily,de=Nt===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Nt,fe=n.brandColor,Ne=fe===void 0?v[0]:fe;return{mapStyle:a,brandColor:Ne,subColor:o,paletteQualitative10:v,paletteQualitative20:E,paletteSemanticRed:F,paletteSemanticGreen:V,paletteSemanticYellow:at,paletteSequence:xt,fontFamily:de,legendContainerFillColor:"rgba(255, 255, 255, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:zm[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(255, 255, 255, 0.9)",tooltipContainerShadow:"rgb(0 0 0 / 16%) 0px 6px 12px 0px",tooltipContainerBorderRadius:2,tooltipTextFillColor:zm[65],tooltipItemNameFillColor:zm[65],tooltipItemValueFillColor:zm[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:zm[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:Ne,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:L7[100],pointActiveBorderColor:zm[100],pointSelectedBorderColor:zm[100]}},V8=mR(),R7={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Um={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},yR=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],D7=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],B7=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],_R=function(n){n===void 0&&(n={});var l=n.mapStyle,a=l===void 0?"dark":l,s=n.subColor,o=s===void 0?"rgba(255,255,255,0.05)":s,h=n.paletteQualitative10,v=h===void 0?yR:h,m=n.paletteQualitative20,E=m===void 0?D7:m,A=n.paletteSemanticRed,F=A===void 0?"#F4664A":A,B=n.paletteSemanticGreen,V=B===void 0?"#30BF78":B,j=n.paletteSemanticYellow,at=j===void 0?"#FAAD14":j,ut=n.paletteSequence,xt=ut===void 0?B7:ut,Nt=n.fontFamily,de=Nt===void 0?`"-apple-system", "Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`:Nt,fe=n.brandColor,Ne=fe===void 0?v[0]:fe;return{mapStyle:a,brandColor:Ne,subColor:o,paletteQualitative10:v,paletteQualitative20:E,paletteSemanticRed:F,paletteSemanticGreen:V,paletteSemanticYellow:at,paletteSequence:xt,fontFamily:de,legendContainerFillColor:"rgba(31, 31, 31, 0.85)",legendContainerShadow:"0 2px 8px 0 rgba(166, 166, 166, 0.20)",legendContainerBorderRadius:2,legendTextFillColor:Um[65],legendTextFontSize:12,tooltipContainerFillColor:"rgba(31, 31, 31, 0.9)",tooltipContainerShadow:"0px 2px 4px rgba(0, 0, 0, 0.5)",tooltipContainerBorderRadius:2,tooltipTextFillColor:Um[65],tooltipItemNameFillColor:Um[65],tooltipItemValueFillColor:Um[65],tooltipTextFontSize:12,tooltipTextLineHeight:"20px",labelFillColor:Um[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,pointFillColor:yR[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:R7[100],pointActiveBorderColor:Um[100],pointSelectedBorderColor:Um[100]}},G8=_R();function xR(n){var l=n.styleSheet,a=l===void 0?{}:l,s=(0,I._T)(n,["styleSheet"]),o=mR(a);return(0,Et.b$)({},gR(o),s)}function N7(n){var l=n.styleSheet,a=l===void 0?{}:l,s=(0,I._T)(n,["styleSheet"]),o=_R(a);return(0,Et.b$)({},gR(o),s)}var bR=xR({}),z7=N7({}),JP={default:bR,light:bR,dark:z7};function tO(n){return n===void 0&&(n="default"),(0,Et.U2)(JP,(0,Et.vl)(n),JP.default)}function H8(n,l,a){a===void 0&&(a="light"),JP[lowerCase(n)]=a==="light"?createTheme(l):createDarkTheme(l)}var ER={map:{type:G_.Amap},logo:!0},U7=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this)||this;return s.inited=!1,s.sceneLoaded=!1,s.layersLoaded=!1,s.loaded=!1,s.layerGroup=new vR,s.options=Ip({},s.getDefaultOptions(),a),s.lastOptions=s.options,s}return l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createContainer=function(a){var s=this.options,o=s.width,h=s.height,v=typeof a=="string"?document.getElementById(a):a;return v.style.position||(v.style.position="relative"),o&&(v.style.width||(v.style.width="".concat(o,"px"))),h&&(v.style.height||(v.style.height="".concat(h,"px"))),v},l.prototype.createTheme=function(){var a=(0,Et.Kn)(this.options.theme)?Ip({},tO("default"),xR(this.options.theme)):tO(this.options.theme);return a},l.prototype.createMap=function(){var a=this.options.map?this.options.map:ER.map,s=a.type,o=(0,I._T)(a,["type"]),h=Object.assign({style:this.theme.mapStyle},o);return s===G_.Amap?new dd(h):new KR(h)},l.prototype.createScene=function(){var a=this.options,s=a.logo,o=a.antialias,h=a.preserveDrawingBuffer,v=(0,Et.jn)(s)?{logoVisible:s}:{logoVisible:s==null?void 0:s.visible,logoPosition:s==null?void 0:s.position},m=Object.assign({antialias:o,preserveDrawingBuffer:h},v),E=this.createMap(),A=new IP((0,I.pi)({id:this.container,map:E},m));return A},l.prototype.registerResources=function(){var a=this;Nm.size&&Nm.forEach(function(s,o){!a.scene.hasImage(o)&&a.scene.addImage(o,s)}),uT.size&&uT.forEach(function(s,o){a.scene.addFontFace(o,s)}),n2.size&&n2.forEach(function(s,o){a.scene.addIconFont(o,s)})},l.prototype.update=function(a){this.updateOption(a),a.map&&!(0,Et.Xy)(this.lastOptions.map,this.options.map)&&this.updateMap(a.map),this.render(),this.emit("update")},l.prototype.updateOption=function(a){this.lastOptions=this.options,this.options=Ip({},this.options,a)},l.prototype.updateMap=function(a){var s;if(!!this.scene){var o=a.style,h=a.center,v=a.zoom,m=a.rotation,E=a.pitch;(0,Et.o8)(E)||this.scene.setPitch(E),(0,Et.o8)(m)||this.scene.setRotation(m),o&&o!==((s=this.lastOptions.map)===null||s===void 0?void 0:s.style)&&this.scene.setMapStyle(o),v&&h&&this.scene.setZoomAndCenter(v,h)}},l.prototype.changeSize=function(a,s){this.options.width===a&&this.options.height===s||(this.container.style.width="".concat(a,"px"),this.container.style.height="".concat(s,"px"),this.options=Object.assign(this.options,{width:a,height:s}))},l.prototype.on=function(a,s,o){return this.proxyEventHander("on",a,s,o),this},l.prototype.once=function(a,s){return this.proxyEventHander("once",a,s),this},l.prototype.off=function(a,s){return this.proxyEventHander("off",a,s),this},l.prototype.proxyEventHander=function(a,s,o,h){var v=I7.find(function(B){return B.adaptation===s});if(v)this.scene[a](v.original,o);else if(k7.indexOf(s)!==-1)this.scene[a](s,o);else if(s.includes("Layer:")){var m=(0,I.CR)(s.split(":"),2),E=m[0],A=m[1],F=this[E]&&this[E][a];if(F&&sT.indexOf(A)!==-1)this[E][a](A,o);else throw new Error('No event name "'.concat(s,'"'))}else n.prototype[a].call(this,s,o,h)},l.prototype.getScene=function(){return this.scene},l.prototype.getMap=function(){var a,s;return((a=this.options.map)===null||a===void 0?void 0:a.type)===G_.Amap?this.scene.map:((s=this.options.map)===null||s===void 0?void 0:s.type)===G_.Mapbox?this.scene.map:this.scene.map},l.prototype.addLayer=function(a){this.layerGroup.addLayer(a)},l.prototype.getLayes=function(){return console.warn("Replace to use getLayers()"),this.getLayers()},l.prototype.getLayers=function(){return this.layerGroup.getLayers()},l.prototype.getLayerByName=function(a){return this.layerGroup.getLayerByName(a)},l.prototype.removeLayer=function(a){return this.layerGroup.removeLayer(a)},l.prototype.removeAllLayer=function(){this.layerGroup.removeAllLayer()},l.prototype.zoomIn=function(){this.scene.zoomIn()},l.prototype.zoomOut=function(){this.scene.zoomOut()},l.prototype.setPitch=function(a){this.scene.setPitch(a)},l.prototype.fitBounds=function(a){this.scene.fitBounds(a)},l.prototype.setMapStatus=function(a){this.scene.setMapStatus(a)},l.prototype.setBgColor=function(a){this.scene.setBgColor(a)},l.prototype.initComponents=function(){this.initControls(),this.initTooltip()},l.prototype.updateComponents=function(){this.updateControls(),this.initTooltip()},l.prototype.initControls=function(){var a=this,s=this.options,o=s.zoom,h=s.scale,v=s.layerMenu,m=s.legend;h&&this.addScaleControl(h),o&&this.addZoomControl(o),v&&this.addLayerMenuControl(v),m&&setTimeout(function(){a.addLegendControl(m),a.emit("add-legend")},1e3)},l.prototype.updateControls=function(){var a=this.options,s=a.zoom,o=a.scale,h=a.layerMenu,v=a.legend;(0,Et.Xy)(this.lastOptions.zoom,s)||(s?this.updateZoomControl(s):this.removeZoomControl()),(0,Et.Xy)(this.lastOptions.scale,o)||(o?this.updateScaleControl(o):this.removeScaleControl()),(0,Et.Xy)(this.lastOptions.layerMenu,h)||(h?this.updateLayerMenuControl(h):this.removeLayerMenuControl()),(0,Et.Xy)(this.lastOptions.legend,v)||(v?this.updateLegendControl(v):this.removeLegendControl())},l.prototype.addZoomControl=function(a){this.zoomControl||(this.zoomControl=new s3(a),this.scene.addControl(this.zoomControl))},l.prototype.updateZoomControl=function(a){if(!this.zoomControl){this.addZoomControl(a);return}this.removeZoomControl(),this.addZoomControl(a)},l.prototype.removeZoomControl=function(){this.zoomControl&&(this.zoomControl.remove(),this.zoomControl=void 0)},l.prototype.addScaleControl=function(a){this.scaleControl||(this.scaleControl=new l3(a),this.scene.addControl(this.scaleControl))},l.prototype.updateScaleControl=function(a){if(!this.scaleControl){this.addScaleControl(a);return}this.removeScaleControl(),this.addScaleControl(a)},l.prototype.removeScaleControl=function(){this.scaleControl&&(this.scaleControl.remove(),this.scaleControl=void 0)},l.prototype.addLayerMenuControl=function(a){var s={},o={};this.layerGroup.getLayers().forEach(function(h){var v=h.name,m=h.layer;o[v]=m})},l.prototype.updateLayerMenuControl=function(a){this.removeLayerMenuControl(),this.addLayerMenuControl(a)},l.prototype.removeLayerMenuControl=function(){},l.prototype.getLegendOptions=function(){return{}},l.prototype.addLegendControl=function(a){if(!this.legendControl){var s=this.theme.components.legend,o=Ip({},this.getLegendOptions(),a),h=o.type,v=o.position,m=(0,I._T)(o,["type","position"]),E=[];if(h==="category"){var A=Ip({},{domStyles:s.category.domStyles},m);E.push({type:h,options:A})}else if(h==="continue"){var F=Ip({},{domStyles:s.continue.domStyles},m);E.push({type:h,options:F})}E.length&&(this.legendControl=new M7({position:v,items:E}),this.scene.addControl(this.legendControl))}},l.prototype.updateLegendControl=function(a){if(!this.legendControl){this.addLegendControl(a);return}this.removeLegendControl(),this.addLegendControl(a)},l.prototype.removeLegendControl=function(){this.legendControl&&(this.legendControl.remove(),this.legendControl=void 0)},l.prototype.initTooltip=function(){var a=this;this.tooltip&&this.tooltip.destroy();var s=this.options.tooltip;if(s){var o=Ip({},{domStyles:this.theme.components.tooltip.domStyles},s),h=this.layerGroup.getInteractionLayers();this.tooltip=new b7(this.scene,h,o),this.tooltip.on("*",function(v){return a.emit(v.type,v)})}},l.prototype.exportPng=function(a){return this.scene.exportPng(a)},l.prototype.destroy=function(){var a;n.prototype.off.call(this,"*"),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(a=this.tooltip)===null||a===void 0||a.destroy(),this.scene.destroy()},l.DefaultOptions=ER,l}(eT.Z),wR;(function(n){n[n.solid=0]="solid",n[n.dash=1]="dash"})(wR||(wR={}));var eO;(function(n){n.TextLayer="textLayer",n.DotLayer="dotLayer",n.IconLayer="iconLayer",n.DotDensity="dotDensityLayer",n.ColumnLayer="columnLayer",n.HeatmapLayer="heatmapLayer",n.GridLayer="gridLayer",n.HexbinLayer="hexbinLayer",n.LinesLayer="linesLayer",n.PathLayer="pathLayer",n.ArcLayer="arcLayer",n.AreaLayer="areaLayer",n.PrismLayer="prismLayer"})(eO||(eO={}));var rO=function(){function n(){}return n.aggregation=function(l,a){var s=a.type,o=s===void 0?"grid":s,h=a.radius,v=a.method,m=a.field,E={type:o,size:h,method:v,field:m};l.transforms?(l.transforms=l.transforms.filter(function(A){return A.type!==E.type}),l.transforms.push(E)):l.transforms=[E]},n}(),SR=["name","zIndex","visible","minZoom","maxZoom","pickingBuffer","autoFit","blend"],W_=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this)||this;return s.options=Ip({},s.getDefaultOptions(),a),s.lastOptions=s.options,s}return l.prototype.getDefaultOptions=function(){return{}},l.prototype.pickLayerConfig=function(a){var s=(0,Et.ei)(a,SR);return s},l.prototype.addTo=function(a){a.addLayer(this.layer)},l.prototype.remove=function(a){a.removeLayer(this.layer)},l.prototype.update=function(a){this.updateOption(a),this.updateConfig(a)},l.prototype.updateOption=function(a){this.lastOptions=this.options,this.options=Ip({},this.options,a)},l.prototype.updateConfig=function(a){!(0,Et.o8)(a.zIndex)&&!(0,Et.Xy)(this.lastOptions.zIndex,this.options.zIndex)&&this.setIndex(a.zIndex),!(0,Et.o8)(a.blend)&&!(0,Et.Xy)(this.lastOptions.blend,this.options.blend)&&this.setBlend(a.blend),!(0,Et.o8)(a.minZoom)&&!(0,Et.Xy)(this.lastOptions.minZoom,this.options.minZoom)&&this.setMinZoom(a.minZoom),!(0,Et.o8)(a.maxZoom)&&!(0,Et.Xy)(this.lastOptions.maxZoom,this.options.maxZoom)&&this.setMinZoom(a.maxZoom),!(0,Et.o8)(a.visible)&&!(0,Et.Xy)(this.lastOptions.visible,this.options.visible)&&(a.visible?this.show():this.hide())},l.prototype.render=function(){this.layer.renderLayers()},l.prototype.setSource=function(a){if(a instanceof Zv)this.layer.setSource(a);else{var s=a.data,o=a.aggregation,h=(0,I._T)(a,["data","aggregation"]);o&&rO.aggregation(h,o);var v=this.layer.getSource();v?this.layer.setData(s,h):this.layer.source(s,h)}},l.prototype.changeData=function(a){this.setSource(a)},l.prototype.setIndex=function(a){this.layer.setIndex(a)},l.prototype.setBlend=function(a){this.layer.setBlend(a)},l.prototype.setMinZoom=function(a){this.layer.setMinZoom(a)},l.prototype.setMaxZoom=function(a){this.layer.setMaxZoom(a)},l.prototype.show=function(){this.layer.inited&&this.layer.show()},l.prototype.hide=function(){this.layer.inited&&this.layer.hide()},l.prototype.toggleVisible=function(){this.isVisible()?this.hide():this.show()},l.prototype.isVisible=function(){return this.layer.inited?this.layer.isVisible():this.options.visible},l.prototype.fitBounds=function(a){this.layer.fitBounds(a)},l.prototype.on=function(a,s){return sT.indexOf(a)!==-1?this.layer.on(a,s):n.prototype.on.call(this,a,s),this},l.prototype.once=function(a,s){return sT.indexOf(a)!==-1?this.layer.once(a,s):n.prototype.once.call(this,a,s),this},l.prototype.off=function(a,s){return sT.indexOf(a)!==-1?this.layer.off(a,s):n.prototype.off.call(this,a,s),this},l.LayerType=eO,l.LayerConfigkeys=SR,l}(eT.Z);function Zm(n,l){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var o={};return n.forEach(function(h,v){o[h]=a[v]}),delete o.undefined,l(o)}}var el=function(){function n(){}return n.shape=function(l,a){if((0,Et.HD)(a))l.shape(a);else if((0,Et.mf)(a)){var s=[];l.shape(s.join("*"),Zm(s,a))}else if((0,Et.Kn)(a)){var o=a.field?a.field:"";if((0,Et.mf)(a.value)){var s=(0,Et.kJ)(o)?o:o.split("*");l.shape(o,Zm(s,a.value))}else l.shape(o,a.value);(0,Et.HD)(o)&&a.scale&&n.scale(l,o,a.scale)}},n.size=function(l,a){if((0,Et.hj)(a))l.size(a);else if((0,Et.kJ)(a))l.size(a);else if((0,Et.mf)(a)){var s=[];l.size(s.join("*"),Zm(s,a))}else if((0,Et.Kn)(a)){var o=a.field?a.field:"";if((0,Et.mf)(a.value)){var s=(0,Et.kJ)(o)?o:o.split("*");l.size(o,Zm(s,a.value))}else l.size(o,a.value);(0,Et.HD)(o)&&a.scale&&n.scale(l,o,a.scale)}},n.color=function(l,a){if((0,Et.HD)(a))l.color(a);else if((0,Et.mf)(a)){var s=[];l.color(s.join("*"),Zm(s,a))}else if((0,Et.Kn)(a)){var o=a.field?a.field:"";if((0,Et.mf)(a.value)){var s=(0,Et.kJ)(o)?o:o.split("*");l.color(o,Zm(s,a.value))}else l.color(o,a.value);(0,Et.HD)(o)&&a.scale&&n.scale(l,o,a.scale)}},n.style=function(l,a){a&&l.style(a)},n.state=function(l,a){var s=a.active,o=a.select;s&&l.active(s),o&&l.select(o)},n.rotate=function(l,a){(0,Et.HD)(a)||(0,Et.mf)(a)||(0,Et.Kn)(a)},n.texture=function(l,a){(0,Et.HD)(a)&&l.texture(a)},n.animate=function(l,a){((0,Et.jn)(a)||(0,Et.Kn)(a))&&l.animate(a)},n.scale=function(l,a,s){l.scale(a,s)},n.filter=function(l,a){var s=a.field?a.field:"",o=(0,Et.kJ)(s)?s:s.split("*");l.filter(o.join("*"),Zm(o,a.value))},n}();function Z7(n,l){var a=l.field,s=l.content,o=l.style,h=o===void 0?{}:o,v=l.state,m=h.fontSize,E=h.fill,A=a||s||"",F={field:A,value:"text"};el.shape(n,F),m&&el.size(n,m),E&&el.color(n,E),h&&el.style(n,h),v&&el.state(n,v)}var CR={style:{fontSize:12}},V7=[],G7=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this,a)||this;s.type=W_.LayerType.TextLayer,s.interaction=!1;var o=s.options,h=o.name,v=o.source,m=s.pickLayerConfig(s.options);return s.name=h||(0,Et.EL)(s.type),s.layer=new Gy((0,I.pi)((0,I.pi)({},m),{name:s.name})),s.mappingLayer(s.layer,s.options),s.setSource(v),s}return l.prototype.getDefaultOptions=function(){return CR},l.prototype.mappingLayer=function(a,s){Z7(a,s)},l.prototype.update=function(a){n.prototype.update.call(this,a),this.mappingLayer(this.layer,this.options)},l.DefaultOptions=CR,l.LayerOptionsKeys=W_.LayerConfigkeys.concat(V7),l}(W_),nO;(function(n){n.Dot="dot",n.DotDensity="dotDensity",n.Heatmap="heatmap",n.Grid="grid",n.Hexbin="hexbin",n.Path="path",n.Flow="flow",n.Area="area",n.Choropleth="choropleth"})(nO||(nO={}));var H7={autoFit:!1},iO=function(n){(0,I.ZT)(l,n);function l(a,s){var o=this;if(typeof a=="string"||a instanceof Element){if(s===void 0)throw new Error("options is undefined");o=n.call(this,s)||this,o.container=o.createContainer(a),o.theme=o.createTheme(),o.scene=o.createScene(),o.registerResources(),o.initSource()}else o=n.call(this,a)||this;return o}return l.prototype.initSource=function(){this.source=this.createSource(),this.render(),this.inited=!0},l.prototype.initLayersEvent=function(){},l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createSource=function(){var a=this.options.source,s=a.data,o=a.aggregation,h=(0,I._T)(a,["data","aggregation"]);o&&rO.aggregation(h,o);var v=new Zv(s,h);return v},l.prototype.createLabelLayer=function(a,s,o){var h=o||{},v=h.visible,m=h.minZoom,E=h.maxZoom,A=h.zIndex,F=A===void 0?0:A,B=new G7((0,I.pi)({name:"labelLayer",visible:v,minZoom:m,maxZoom:E,zIndex:F+.1,source:a},s));return B},l.prototype.updateLabelLayer=function(a,s,o,h){s?h?h.update((0,I.pi)({},s)):(h=this.createLabelLayer(a,s,o),this.layerGroup.addLayer(h)):s===!1&&h&&this.layerGroup.removeLayer(h)},l.prototype.render=function(){var a=this,s=this.createLayers(this.source);this.inited?(this.layerGroup.removeAllLayer(),s.addTo(this.scene),this.layerGroup=s):(this.layerGroup=s,this.scene.sceneService.loaded?this.onSceneLoaded():this.scene.once("loaded",function(){a.onSceneLoaded()})),this.initLayersEvent()},l.prototype.onSceneLoaded=function(){var a=this;this.sceneLoaded=!0,this.layerGroup.isEmpty()?this.onLayersLoaded():this.layerGroup.once("inited-all",function(){a.onLayersLoaded()}),this.layerGroup.addTo(this.scene)},l.prototype.onLayersLoaded=function(){this.layersLoaded=!0,this.initComponents(),this.loaded=!0,this.emit("loaded")},l.prototype.attachToScene=function(a,s){this.scene=a,this.theme=s||tO("default"),this.registerResources(),this.initSource()},l.prototype.unattachFromScene=function(){var a;this.removeAllLayer(),(a=this.tooltip)===null||a===void 0||a.destroy()},l.prototype.addToScene=function(a){this.attachToScene(a)},l.prototype.removeFromScene=function(){var a;this.removeAllLayer(),this.removeScaleControl(),this.removeZoomControl(),this.removeLayerMenuControl(),this.removeLegendControl(),(a=this.tooltip)===null||a===void 0||a.destroy()},l.prototype.update=function(a){if(this.updateOption(a),a.map&&!(0,Et.Xy)(this.lastOptions.map,this.options.map)&&this.updateMap(a.map),this.scene.setEnableRender(!1),a.source&&!(0,Et.Xy)(this.lastOptions.source,this.options.source)){var s=a.source,o=s.data,h=(0,I._T)(s,["data"]);this.changeData(o,h)}this.scene.setEnableRender(!0),this.render(),this.updateComponents(),this.emit("update")},l.prototype.changeData=function(a,s){var o=this;this.options.source=Ip({},this.options.source,(0,I.pi)({data:a},s));var h=this.options.source,v=h.aggregation,m=(0,I._T)(h,["aggregation"]);v&&rO.aggregation(m,v),this.source.setData(this.options.source.data,m);var E=this.options.legend;E&&setTimeout(function(){o.updateLegendControl(E)}),this.emit("change-data")},l.DefaultOptions=H7,l.PlotType=nO,l}(U7),j7=Ip({},iO.DefaultOptions,{source:{data:{type:"FeatureCollection",features:[]},parser:{type:"geojson"}}}),AR="#2f54eb",zc={active:{fill:!1,stroke:AR,lineWidth:1.5,lineOpacity:.8},select:{fill:!1,stroke:AR,lineWidth:1.5,lineOpacity:.8}},a2=function(n){return(0,Et.o8)(n)||(n.active===!1?zc.active=Object.assign(zc.active,{fill:!1,stroke:!1}):typeof n.active=="object"&&(n.active.fill===!1?zc.active.fill=!1:typeof n.active.fill=="string"&&(zc.active.fill=n.active.fill),n.active.stroke===!1?zc.active.stroke=!1:typeof n.active.stroke=="string"&&(zc.active.stroke=n.active.stroke),typeof n.active.lineWidth=="number"&&(zc.active.lineWidth=n.active.lineWidth),typeof n.active.lineOpacity=="number"&&(zc.active.lineOpacity=n.active.lineOpacity)),n.select===!1?zc.select=Object.assign(zc.select,{fill:!1,stroke:!1}):typeof n.select=="object"&&(n.select.fill===!1?zc.select.fill=!1:typeof n.select.fill=="string"&&(zc.select.fill=n.select.fill),n.select.stroke===!1?zc.select.stroke=!1:typeof n.select.stroke=="string"&&(zc.select.stroke=n.select.stroke),typeof n.select.lineWidth=="number"&&(zc.select.lineWidth=n.select.lineWidth),typeof n.select.lineOpacity=="number"&&(zc.select.lineOpacity=n.select.lineOpacity))),zc};function W7(n,l,a,s,o,h){var v=h.color,m=h.style,E=h.state,A=a2(E),F={active:A.active.fill===!1?!1:{color:A.active.fill},select:!1},B={opacity:m==null?void 0:m.opacity},V=m==null?void 0:m.fillBottomColor,j=m==null?void 0:m.lineWidth,at=m==null?void 0:m.stroke,ut={opacity:m==null?void 0:m.lineOpacity,dashArray:m==null?void 0:m.lineDash,lineType:m==null?void 0:m.lineType};if(el.shape(n,"fill"),v&&el.color(n,v),B&&el.style(n,B),F&&el.state(n,F),V&&n.setBottomColor(V),el.shape(l,"line"),j&&el.size(l,j),at&&el.color(l,at),ut&&el.style(l,ut),A.active.stroke){var xt=A.active.stroke,Nt=A.active.lineWidth||j,de={opacity:A.active.lineOpacity};el.shape(a,"line"),Nt&&el.size(a,Nt),xt&&el.color(a,xt),de&&el.style(a,de)}if(A.select.fill){var fe=A.select.fill;el.shape(s,"fill"),fe&&el.color(s,fe),B&&el.style(s,B),el.state(s,{select:!1,active:!1})}if(A.select.stroke){var Ne=A.select.stroke,Nt=A.select.lineWidth||j,Ye={opacity:A.select.lineOpacity};el.shape(o,"line"),Nt&&el.size(o,Nt),Ne&&el.color(o,Ne),Ye&&el.style(o,Ye)}}var X7=/\s/;function Y7(n){for(var l=n.length;l--&&X7.test(n.charAt(l)););return l}var $7=Y7,q7=/^\s+/;function K7(n){return n&&n.slice(0,$7(n)+1).replace(q7,"")}var Q7=K7,TR=0/0,J7=/^[-+]0x[0-9a-f]+$/i,t8=/^0b[01]+$/i,e8=/^0o[0-7]+$/i,r8=parseInt;function n8(n){if(typeof n=="number")return n;if(nT(n))return TR;if(iT(n)){var l=typeof n.valueOf=="function"?n.valueOf():n;n=iT(l)?l+"":l}if(typeof n!="string")return n===0?n:+n;n=Q7(n);var a=t8.test(n);return a||e8.test(n)?r8(n.slice(2),a?2:8):J7.test(n)?TR:+n}var MR=n8,IR=1/0,i8=17976931348623157e292;function a8(n){if(!n)return n===0?n:0;if(n=MR(n),n===IR||n===-IR){var l=n<0?-1:1;return l*i8}return n===n?n:0}var o8=a8;function s8(n){var l=o8(n),a=l%1;return l===l?a?l-a:l:0}var u8=s8,l8=rT.isFinite,c8=Math.min;function f8(n){var l=Math[n];return function(a,s){if(a=MR(a),s=s==null?0:c8(u8(s),292),s&&l8(a)){var o=(WP(a)+"e").split("e"),h=l(o[0]+"e"+(+o[1]+s));return o=(WP(h)+"e").split("e"),+(o[0]+"e"+(+o[1]-s))}return l(a)}}var h8=f8,p8=h8("round"),kR=p8,d8=function(n){return!Array.isArray(n[0].value)},v8=function(n){if(d8(n))return n;var l=n.map(function(a){return(0,I.pi)((0,I.pi)({},a),{value:[kR(a.value[0],2),kR(a.value[1],2)]})});return l},LR={visible:!0,state:{active:!1,select:!1},enabledMultiSelect:!1},g8=["color","style","state","enabledMultiSelect"],aO=function(n){(0,I.ZT)(l,n);function l(a){var s=n.call(this,a)||this;s.selectData=[],s.type=W_.LayerType.AreaLayer,s.interaction=!0,s.onHighlighHandle=function(at){var ut=at.feature,xt=at.featureId;s.setHighlightLayerSource(ut,xt)},s.onUnhighlighHandle=function(){s.setHighlightLayerSource()},s.onSelectHandle=function(at){var ut=s.options.enabledMultiSelect,xt=at.feature,Nt=at.featureId,de=(0,Et.d9)(s.selectData),fe=de.findIndex(function(Ye){return Ye.featureId===Nt});if(fe===-1)ut?de.push({feature:xt,featureId:Nt}):de=[{feature:xt,featureId:Nt}],s.emit("select",xt,(0,Et.d9)(de));else{var Ne=de[fe];ut?de.splice(fe,1):de=[],s.emit("unselect",Ne,(0,Et.d9)(de))}s.setSelectLayerSource(de)};var o=s.options,h=o.name,v=o.source,m=o.visible,E=o.minZoom,A=o.maxZoom,F=o.zIndex,B=F===void 0?0:F,V=s.pickLayerConfig(s.options),j=a2(s.options.state);return s.name=h||(0,Et.EL)(s.type),s.layer=new Zx((0,I.pi)((0,I.pi)({},V),{name:s.name})),s.strokeLayer=new wg({name:"strokeLayer",visible:m,zIndex:B,minZoom:E,maxZoom:A}),s.highlightLayer=new wg({name:"highlightLayer",visible:m&&Boolean(j.active.stroke),zIndex:B+.1,minZoom:E,maxZoom:A}),s.selectFillLayer=new Zx({name:"selectFillLayer",visible:m&&Boolean(j.select.fill),zIndex:B+.1,minZoom:E,maxZoom:A}),s.selectStrokeLayer=new wg({name:"selectStrokeLayer",visible:m&&Boolean(j.select.stroke),zIndex:B+.1,minZoom:E,maxZoom:A}),s.mappingLayer(s.options),s.setSource(v),s.initEvent(),s}return l.prototype.getDefaultOptions=function(){return LR},l.prototype.mappingLayer=function(a){W7(this.layer,this.strokeLayer,this.highlightLayer,this.selectFillLayer,this.selectStrokeLayer,a)},l.prototype.setSource=function(a){n.prototype.setSource.call(this,a),this.setStrokeLayerSource(),this.setHighlightLayerSource(),this.selectFillLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}}),this.selectStrokeLayer.source({type:"FeatureCollection",features:[]},{parser:{type:"geojson"}})},l.prototype.setStrokeLayerSource=function(){var a=this.layer.getSource();if(a)this.strokeLayer.setSource(a);else{var s=this.layer.sourceOption,o=s.data,h=s.options;this.strokeLayer.source(o,h)}},l.prototype.setHighlightLayerSource=function(a,s){if(s===void 0&&(s=-999),this.highlightLayerData!==s){var o=a?[a]:[];this.highlightLayer.setData({type:"FeatureCollection",features:o},{parser:{type:"geojson"}}),this.highlightLayerData=s}},l.prototype.setSelectLayerSource=function(a){if(a===void 0&&(a=[]),!(this.selectData.length===a.length&&(0,Et.Xy)(this.selectData.map(function(o){var h=o.featureId;return h}),a.map(function(o){var h=o.featureId;return h})))){var s=a.map(function(o){var h=o.feature;return h});this.selectFillLayer.setData({type:"FeatureCollection",features:s},{parser:{type:"geojson"}}),this.selectStrokeLayer.setData({type:"FeatureCollection",features:s},{parser:{type:"geojson"}}),this.selectData=a}},l.prototype.initEvent=function(){this.layer.off("mousemove",this.onHighlighHandle),this.layer.off("unmousemove",this.onHighlighHandle),this.layer.off("click",this.onSelectHandle),this.selectData=[],this.highlightLayerData=null,this.options.state&&(this.options.state.active&&(this.layer.on("mousemove",this.onHighlighHandle),this.layer.on("unmousemove",this.onUnhighlighHandle)),this.options.state.select&&this.layer.on("click",this.onSelectHandle))},l.prototype.addTo=function(a){a.addLayer(this.layer),a.addLayer(this.strokeLayer),a.addLayer(this.highlightLayer),a.addLayer(this.selectFillLayer),a.addLayer(this.selectStrokeLayer)},l.prototype.remove=function(a){a.removeLayer(this.layer),a.removeLayer(this.strokeLayer),a.removeLayer(this.highlightLayer),a.removeLayer(this.selectFillLayer),a.removeLayer(this.selectStrokeLayer)},l.prototype.update=function(a){if(n.prototype.update.call(this,a),this.mappingLayer(this.options),this.options.visible){!(0,Et.o8)(a.state)&&!(0,Et.Xy)(this.lastOptions.state,this.options.state)&&this.updateHighlightLayer();var s=a2(this.options.state);s.active.stroke&&this.setHighlightLayerSource(),(s.select.fill||s.select.stroke)&&this.setSelectLayerSource()}this.initEvent()},l.prototype.updateHighlightLayer=function(){var a=a2(this.options.state),s=a2(this.lastOptions.state);s.active.stroke!==a.active.stroke&&(a.active.stroke?this.highlightLayer.show():this.highlightLayer.hide()),s.select.fill!==a.select.fill&&(a.select.fill?this.selectFillLayer.show():this.selectFillLayer.hide()),s.select.stroke!==a.select.stroke&&(a.select.stroke?this.selectStrokeLayer.show():this.selectStrokeLayer.hide())},l.prototype.setIndex=function(a){this.layer.setIndex(a),this.strokeLayer.setIndex(a),this.highlightLayer.setIndex(a+.1),this.selectFillLayer.setIndex(a+.1),this.selectStrokeLayer.setIndex(a+.1)},l.prototype.setMinZoom=function(a){this.layer.setMinZoom(a),this.strokeLayer.setMinZoom(a),this.highlightLayer.setMinZoom(a),this.selectFillLayer.setMinZoom(a),this.selectStrokeLayer.setMinZoom(a)},l.prototype.setMaxZoom=function(a){this.layer.setMaxZoom(a),this.strokeLayer.setMaxZoom(a),this.highlightLayer.setMaxZoom(a),this.selectFillLayer.setMaxZoom(a),this.selectStrokeLayer.setMaxZoom(a)},l.prototype.show=function(){!this.layer.inited||(this.layer.show(),this.strokeLayer.show(),this.selectFillLayer.show(),this.selectStrokeLayer.show())},l.prototype.hide=function(){!this.layer.inited||(this.layer.hide(),this.strokeLayer.hide(),this.selectFillLayer.hide(),this.selectStrokeLayer.hide())},l.prototype.getColorLegendItems=function(){var a=this.layer.getLegendItems("color");if(Array.isArray(a)&&a.length!==0){var s=v8(a);return s}return[]},l.prototype.setActive=function(a){},l.prototype.setSelect=function(a){},l.DefaultOptions=LR,l.LayerOptionsKeys=W_.LayerConfigkeys.concat(g8),l}(W_),m8=function(n){(0,I.ZT)(l,n);function l(){var a=n!==null&&n.apply(this,arguments)||this;return a.type=iO.PlotType.Area,a}return l.prototype.getDefaultOptions=function(){return l.DefaultOptions},l.prototype.createLayers=function(a){this.areaLayer=new aO((0,I.pi)({source:a},(0,Et.ei)(this.options,aO.LayerOptionsKeys)));var s=new vR([this.areaLayer]);return this.options.label&&(this.labelLayer=this.createLabelLayer(a,this.options.label,this.options),s.addLayer(this.labelLayer)),s},l.prototype.updateLayers=function(a){var s=(0,Et.ei)(a,aO.LayerOptionsKeys);this.areaLayer.update(s),this.updateLabelLayer(this.source,a.label,this.options,this.labelLayer)},l.prototype.initLayersEvent=function(){},l.prototype.getLegendOptions=function(){var a=this.areaLayer.getColorLegendItems();return a.length!==0?{type:"category",items:a}:{}},l.DefaultOptions=j7,l}(iO),j8=function(n,l){var a={}.toString;return a.call(n)==="[object ".concat(l,"]")},W8=function(n){return Object.prototype.toString.call(n).slice(8,-1)},oO=function(n){if(!n||typeof n!="object")return n;var l;return Array.isArray(n)?l=n.map(function(a){return oO(a)}):(l={},Object.keys(n).forEach(function(a){return l[a]=oO(n[a])})),l},X8=function(n){if(!n)return n;var l={};for(var a in n)l[a]=n[a];return l},o2=function(){return o2=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},o2.apply(this,arguments)},y8=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)l.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(a[s[o]]=n[s[o]]);return a},PR=function(n){var l=n.source,a=y8(n,["source"]),s=o2(o2({},oO(a)),{source:o2({},l)});return s},sO=function(){return sO=Object.assign||function(n){for(var l,a=1,s=arguments.length;a<s;a++){l=arguments[a];for(var o in l)Object.prototype.hasOwnProperty.call(l,o)&&(n[o]=l[o])}return n},sO.apply(this,arguments)},lT=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)l.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(a[s[o]]=n[s[o]]);return a};function _8(n,l){var a=(0,wt.useRef)(),s=(0,wt.useRef)(),o=(0,wt.useRef)(null),h=l.onReady;return(0,wt.useEffect)(function(){if(!(!a.current||!s.current||(0,Et.Xy)(s.current,l))){var v=!1,m=!1,E=!1,A=s.current,F=A.onReady,B=A.map,V=A.source,j=V.data,at=lT(V,["data"]),ut=lT(A,["onReady","map","source"]),xt=l.onReady,Nt=l.map,de=l.source,fe=de.data,Ne=lT(de,["data"]),Ye=lT(l,["onReady","map","source"]);if(m=!(0,Et.Xy)(B,Nt),v=!(0,Et.Xy)(at,Ne)||j!==fe,E=!(0,Et.Xy)(ut,Ye),s.current=PR(l),m){var _r=(0,Et.ei)(Nt,["center","pitch","rotation","zoom","style"]);a.current.updateMap(_r)}v&&(a.current.loaded?a.current.changeData(fe,Ne):a.current.once("loaded",function(){var Ir;(Ir=a.current)===null||Ir===void 0||Ir.changeData(fe,Ne)})),E&&(a.current.loaded?a.current.update(Ye):a.current.once("loaded",function(){var Ir;(Ir=a.current)===null||Ir===void 0||Ir.update(Ye)}))}},[l]),(0,wt.useEffect)(function(){return o.current?(s.current||(s.current=PR(l)),a.current=new n(o.current,sO({},l)),h&&a.current.once("loaded",function(){h(a.current)}),function(){a.current&&(a.current.destroy(),a.current=void 0)}):function(){return null}},[]),{plotRef:a,containerRef:o}}var x8=function(n,l){!n||((0,Et.mf)(n)?n(l):n.current=l)},b8=function(){var n=function(l,a){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,o){s.__proto__=o}||function(s,o){for(var h in o)Object.prototype.hasOwnProperty.call(o,h)&&(s[h]=o[h])},n(l,a)};return function(l,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");n(l,a);function s(){this.constructor=l}l.prototype=a===null?Object.create(a):(s.prototype=a.prototype,new s)}}(),E8=function(n){b8(l,n);function l(){var a=n!==null&&n.apply(this,arguments)||this;return a.state={hasError:!1},a.renderError=function(s){var o=a.props.errorTemplate;switch(s){default:return typeof o=="function"?o(s):o||wt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",s.message)}},a}return l.getDerivedStateFromError=function(a){return{hasError:!0,error:a}},l.getDerivedStateFromProps=function(a,s){return s.children!==a.children?{children:a.children,hasError:!1,error:void 0}:null},l.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):wt.createElement(wt.Fragment,null,this.props.children)},l}(wt.Component),w8=E8,S8=ot(24561),C8=function(n){var l=n.loadingTemplate,a=function(){return l||wt.createElement(S8.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1},wt.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),wt.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),wt.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),wt.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),wt.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),wt.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),wt.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),wt.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),wt.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),wt.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return wt.createElement("div",{style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:"#fff"}},a())},A8=C8,T8=function(n,l){var a={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&l.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(n);o<s.length;o++)l.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(n,s[o])&&(a[s[o]]=n[s[o]]);return a},M8=(0,wt.forwardRef)(function(n,l){var a=n.chartRef,s=n.containerStyle,o=s===void 0?{height:"inherit"}:s,h=n.className,v=n.loading,m=n.loadingTemplate,E=n.errorTemplate,A=T8(n,["chartRef","containerStyle","className","loading","loadingTemplate","errorTemplate"]),F=_8(m8,A),B=F.plotRef,V=F.containerRef;return(0,wt.useEffect)(function(){x8(a,B.current)},[B.current]),(0,wt.useImperativeHandle)(l,function(){return{getChart:function(){return B.current}}}),wt.createElement(w8,{errorTemplate:E},v&&wt.createElement(A8,{loadingTemplate:m}),wt.createElement("div",{className:h,style:o,ref:V}))}),I8=M8},79611:function(vn,Ft,ot){"use strict";var Lt=ot(67294),wt=ot(3083),I=ot(59658),Et=ot(4322),q=ot(24770),lt=ot(26119),ht=function(et,Ee){var it={};for(var st in et)Object.prototype.hasOwnProperty.call(et,st)&&Ee.indexOf(st)<0&&(it[st]=et[st]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Zt=0,st=Object.getOwnPropertySymbols(et);Zt<st.length;Zt++)Ee.indexOf(st[Zt])<0&&Object.prototype.propertyIsEnumerable.call(et,st[Zt])&&(it[st[Zt]]=et[st[Zt]]);return it},ct=(0,Lt.forwardRef)(function(et,Ee){var it=et.chartRef,st=et.style,Zt=st===void 0?{height:"inherit"}:st,P=et.className,b=et.loading,X=et.loadingTemplate,le=et.errorTemplate,Se=ht(et,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),Ie=(0,I.Z)(wt.Bar,Se),It=Ie.chart,rt=Ie.container;return(0,Lt.useEffect)(function(){(0,Et.J)(it,It.current)},[It.current]),(0,Lt.useImperativeHandle)(Ee,function(){return{getChart:function(){return It.current}}}),Lt.createElement(q.Z,{errorTemplate:le},b&&Lt.createElement(lt.Z,{loadingTemplate:X,theme:et.theme}),Lt.createElement("div",{className:P,style:Zt,ref:rt}))});Ft.Z=ct},78677:function(vn,Ft,ot){"use strict";var Lt=ot(67294),wt=ot(3083),I=ot(59658),Et=ot(4322),q=ot(24770),lt=ot(26119),ht=function(et,Ee){var it={};for(var st in et)Object.prototype.hasOwnProperty.call(et,st)&&Ee.indexOf(st)<0&&(it[st]=et[st]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Zt=0,st=Object.getOwnPropertySymbols(et);Zt<st.length;Zt++)Ee.indexOf(st[Zt])<0&&Object.prototype.propertyIsEnumerable.call(et,st[Zt])&&(it[st[Zt]]=et[st[Zt]]);return it},ct=(0,Lt.forwardRef)(function(et,Ee){var it=et.chartRef,st=et.style,Zt=st===void 0?{height:"inherit"}:st,P=et.className,b=et.loading,X=et.loadingTemplate,le=et.errorTemplate,Se=ht(et,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),Ie=(0,I.Z)(wt.Column,Se),It=Ie.chart,rt=Ie.container;return(0,Lt.useEffect)(function(){(0,Et.J)(it,It.current)},[It.current]),(0,Lt.useImperativeHandle)(Ee,function(){return{getChart:function(){return It.current}}}),Lt.createElement(q.Z,{errorTemplate:le},b&&Lt.createElement(lt.Z,{loadingTemplate:X,theme:et.theme}),Lt.createElement("div",{className:P,style:Zt,ref:rt}))});Ft.Z=ct},63430:function(vn,Ft,ot){"use strict";var Lt=ot(67294),wt=ot(3083),I=ot(59658),Et=ot(4322),q=ot(24770),lt=ot(26119),ht=function(et,Ee){var it={};for(var st in et)Object.prototype.hasOwnProperty.call(et,st)&&Ee.indexOf(st)<0&&(it[st]=et[st]);if(et!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Zt=0,st=Object.getOwnPropertySymbols(et);Zt<st.length;Zt++)Ee.indexOf(st[Zt])<0&&Object.prototype.propertyIsEnumerable.call(et,st[Zt])&&(it[st[Zt]]=et[st[Zt]]);return it},ct=(0,Lt.forwardRef)(function(et,Ee){var it=et.chartRef,st=et.style,Zt=st===void 0?{height:"inherit"}:st,P=et.className,b=et.loading,X=et.loadingTemplate,le=et.errorTemplate,Se=ht(et,["chartRef","style","className","loading","loadingTemplate","errorTemplate"]),Ie=(0,I.Z)(wt.Pie,Se),It=Ie.chart,rt=Ie.container;return(0,Lt.useEffect)(function(){(0,Et.J)(it,It.current)},[It.current]),(0,Lt.useImperativeHandle)(Ee,function(){return{getChart:function(){return It.current}}}),Lt.createElement(q.Z,{errorTemplate:le},b&&Lt.createElement(lt.Z,{loadingTemplate:X,theme:et.theme}),Lt.createElement("div",{className:P,style:Zt,ref:rt}))});Ft.Z=ct},24770:function(vn,Ft,ot){"use strict";var Lt=ot(67294),wt=function(){var Et=function(q,lt){return Et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ht,ct){ht.__proto__=ct}||function(ht,ct){for(var et in ct)Object.prototype.hasOwnProperty.call(ct,et)&&(ht[et]=ct[et])},Et(q,lt)};return function(q,lt){if(typeof lt!="function"&&lt!==null)throw new TypeError("Class extends value "+String(lt)+" is not a constructor or null");Et(q,lt);function ht(){this.constructor=q}q.prototype=lt===null?Object.create(lt):(ht.prototype=lt.prototype,new ht)}}(),I=function(Et){wt(q,Et);function q(){var lt=Et!==null&&Et.apply(this,arguments)||this;return lt.state={hasError:!1},lt.renderError=function(ht){var ct=lt.props.errorTemplate;switch(ht){default:return ct&&typeof ct=="function"?ct(ht):Lt.createElement("h5",null,"\u7EC4\u4EF6\u51FA\u9519\u4E86\uFF0C\u8BF7\u6838\u67E5\u540E\u91CD\u8BD5\uFF1A ",ht.message)}},lt}return q.getDerivedStateFromError=function(lt){return{hasError:!0,error:lt}},q.getDerivedStateFromProps=function(lt,ht){return ht.children!==lt.children?{children:lt.children,hasError:!1,error:void 0}:null},q.prototype.render=function(){return this.state.hasError?this.renderError(this.state.error):Lt.createElement(Lt.Fragment,null,this.props.children)},q}(Lt.Component);Ft.Z=I},59658:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return dt}});var Lt=ot(67294),wt=ot(45098),I=ot(73935),Et=ot.t(I,2),q=function(){return q=Object.assign||function(Vt){for(var ne,ge=1,$e=arguments.length;ge<$e;ge++){ne=arguments[ge];for(var jt in ne)Object.prototype.hasOwnProperty.call(ne,jt)&&(Vt[jt]=ne[jt])}return Vt},q.apply(this,arguments)},lt=function(Vt,ne,ge,$e){function jt(Qt){return Qt instanceof ge?Qt:new ge(function(Te){Te(Qt)})}return new(ge||(ge=Promise))(function(Qt,Te){function ae(ie){try{or($e.next(ie))}catch(te){Te(te)}}function Ke(ie){try{or($e.throw(ie))}catch(te){Te(te)}}function or(ie){ie.done?Qt(ie.value):jt(ie.value).then(ae,Ke)}or(($e=$e.apply(Vt,ne||[])).next())})},ht=function(Vt,ne){var ge={label:0,sent:function(){if(Qt[0]&1)throw Qt[1];return Qt[1]},trys:[],ops:[]},$e,jt,Qt,Te;return Te={next:ae(0),throw:ae(1),return:ae(2)},typeof Symbol=="function"&&(Te[Symbol.iterator]=function(){return this}),Te;function ae(or){return function(ie){return Ke([or,ie])}}function Ke(or){if($e)throw new TypeError("Generator is already executing.");for(;ge;)try{if($e=1,jt&&(Qt=or[0]&2?jt.return:or[0]?jt.throw||((Qt=jt.return)&&Qt.call(jt),0):jt.next)&&!(Qt=Qt.call(jt,or[1])).done)return Qt;switch(jt=0,Qt&&(or=[or[0]&2,Qt.value]),or[0]){case 0:case 1:Qt=or;break;case 4:return ge.label++,{value:or[1],done:!1};case 5:ge.label++,jt=or[1],or=[0];continue;case 7:or=ge.ops.pop(),ge.trys.pop();continue;default:if(Qt=ge.trys,!(Qt=Qt.length>0&&Qt[Qt.length-1])&&(or[0]===6||or[0]===2)){ge=0;continue}if(or[0]===3&&(!Qt||or[1]>Qt[0]&&or[1]<Qt[3])){ge.label=or[1];break}if(or[0]===6&&ge.label<Qt[1]){ge.label=Qt[1],Qt=or;break}if(Qt&&ge.label<Qt[2]){ge.label=Qt[2],ge.ops.push(or);break}Qt[2]&&ge.ops.pop(),ge.trys.pop();continue}or=ne.call(Vt,ge)}catch(ie){or=[6,ie],jt=0}finally{$e=Qt=0}if(or[0]&5)throw or[1];return{value:or[0]?or[1]:void 0,done:!0}}},ct=q({},Et),et=ct.version,Ee=ct.render,it=ct.unmountComponentAtNode,st;try{var Zt=Number((et||"").split(".")[0]);Zt>=18&&(st=ct.createRoot)}catch(Vt){}function P(Vt){var ne=ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;ne&&typeof ne=="object"&&(ne.usingClientEntryPoint=Vt)}var b="__rc_react_root__";function X(Vt,ne){P(!0);var ge=ne[b]||st(ne);P(!1),ge.render(Vt),ne[b]=ge}function le(Vt,ne){Ee(Vt,ne)}function Se(Vt,ne){}function Ie(Vt,ne){if(st){X(Vt,ne);return}le(Vt,ne)}function It(Vt){return lt(this,void 0,void 0,function(){return ht(this,function(ne){return[2,Promise.resolve().then(function(){var ge;(ge=Vt[b])===null||ge===void 0||ge.unmount(),delete Vt[b]})]})})}function rt(Vt){it(Vt)}function Dt(Vt){}function Ae(Vt){return lt(this,void 0,void 0,function(){return ht(this,function(ne){return st!==void 0?[2,It(Vt)]:(rt(Vt),[2])})})}var be=function(Vt,ne){var ge=document.createElement("div");return ne==="tooltip"&&(ge.className="g2-tooltip"),Ie(Vt,ge),ge},me=be,ee=function(Vt,ne){var ge={}.toString;return ge.call(Vt)==="[object ".concat(ne,"]")},we=function(Vt){if(!Vt)return Vt;var ne={};for(var ge in Vt)ne[ge]=Vt[ge];return ne},_e=function(Vt){return Object.prototype.toString.call(Vt).slice(8,-1)},gt=function(Vt){if(!Vt||typeof Vt!="object")return Vt;var ne;return Array.isArray(Vt)?ne=Vt.map(function(ge){return gt(ge)}):(ne={},Object.keys(Vt).forEach(function(ge){return ne[ge]=gt(Vt[ge])})),ne},Pt=function(Vt,ne){for(var ge=Vt,$e=0;$e<ne.length;$e+=1)if(ge!=null&&ge[ne[$e]])ge=ge[ne[$e]];else{ge=void 0;break}return ge},J=function(Vt,ne,ge){if(!Vt)return Vt;var $e=Vt;return ne.forEach(function(jt,Qt){Qt<ne.length-1?$e=$e[jt]:$e[jt]=ge}),Vt},vt=function(){return vt=Object.assign||function(Vt){for(var ne,ge=1,$e=arguments.length;ge<$e;ge++){ne=arguments[ge];for(var jt in ne)Object.prototype.hasOwnProperty.call(ne,jt)&&(Vt[jt]=ne[jt])}return Vt},vt.apply(this,arguments)},W=function(Vt,ne){var ge={};for(var $e in Vt)Object.prototype.hasOwnProperty.call(Vt,$e)&&ne.indexOf($e)<0&&(ge[$e]=Vt[$e]);if(Vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var jt=0,$e=Object.getOwnPropertySymbols(Vt);jt<$e.length;jt++)ne.indexOf($e[jt])<0&&Object.prototype.propertyIsEnumerable.call(Vt,$e[jt])&&(ge[$e[jt]]=Vt[$e[jt]]);return ge};function dt(Vt,ne){var ge=(0,Lt.useRef)(),$e=(0,Lt.useRef)(),jt=(0,Lt.useRef)(null),Qt=ne.onReady,Te=ne.onEvent,ae=function(te,St){var qt;return te===void 0&&(te="image/png"),(qt=ge.current)===null||qt===void 0?void 0:qt.chart.canvas.cfg.el.toDataURL(te,St)},Ke=function(te,St,qt){var $t;te===void 0&&(te="download"),St===void 0&&(St="image/png");var Ct=te;te.indexOf(".")===-1&&(Ct="".concat(te,".").concat(St.split("/")[1]));var Tt=($t=ge.current)===null||$t===void 0?void 0:$t.chart.canvas.cfg.el.toDataURL(St,qt),ue=document.createElement("a");return ue.href=Tt,ue.download=Ct,document.body.appendChild(ue),ue.click(),document.body.removeChild(ue),ue=null,Ct},or=function(te,St,qt){var $t=Pt(te,St);J(te,St,function(){for(var Ct=[],Tt=0;Tt<arguments.length;Tt++)Ct[Tt]=arguments[Tt];var ue=ee($t,"Function")?$t.apply(void 0,Ct):$t;return ee(ue,"String")||ee(ue,"Number")||ee(ue,"HTMLDivElement")?ue:me(ue,qt)})},ie=function(){Pt(ne,["statistic","content","customHtml"])&&or(ne,["statistic","content","customHtml"]),Pt(ne,["statistic","title","customHtml"])&&or(ne,["statistic","title","customHtml"]),typeof ne.tooltip=="object"&&(Pt(ne,["tooltip","container"])&&or(ne,["tooltip","container"],"tooltip"),Pt(ne,["tooltip","customContent"])&&or(ne,["tooltip","customContent"],"tooltip"))};return(0,Lt.useEffect)(function(){if(ge.current&&!(0,wt.Xy)($e.current,ne)){var te=!1;if($e.current){var St=$e.current,qt=St.data,$t=St.value,Ct=St.percent,Tt=W(St,["data","value","percent"]),ue=ne.data,Oe=ne.value,We=ne.percent,zt=W(ne,["data","value","percent"]);te=(0,wt.Xy)(Tt,zt)}if($e.current=gt(ne),te&&(0,wt.U2)(ne,"chartType")!=="Mix"){var At="data",Mt=["percent"],Rt=Object.keys(ne);Mt.forEach(function(tt){Rt.includes(tt)&&(At=tt)}),ge.current.changeData((ne==null?void 0:ne[At])||[])}else ie(),ge.current.update(ne)}},[ne]),(0,Lt.useEffect)(function(){if(!jt.current)return function(){return null};$e.current||($e.current=gt(ne)),ie();var te=new Vt(jt.current,vt({},ne));te.toDataURL=function(qt,$t){return ae(qt,$t)},te.downloadImage=function(qt,$t,Ct){return Ke(qt,$t,Ct)},te.render(),ge.current=we(te),Qt&&Qt(te);var St=function(qt){Te&&Te(te,qt)};return te.on("*",St),function(){ge.current&&(ge.current.destroy(),ge.current.off("*",St),ge.current=void 0)}},[]),{chart:ge,container:jt}}},26119:function(vn,Ft,ot){"use strict";var Lt=ot(67294),wt=ot(24561),I=function(Et){var q=Et.loadingTemplate,lt=Et.theme,ht=lt===void 0?"light":lt,ct=function(){return q||Lt.createElement(wt.ZP,{viewBox:"0 0 400 180",width:200,height:90,speed:1,backgroundColor:ht==="dark"?"#262626":"#D9D9D9"},Lt.createElement("rect",{x:"20",y:"5",rx:"0",ry:"0",width:"1",height:"170"}),Lt.createElement("rect",{x:"20",y:"175",rx:"0",ry:"0",width:"360",height:"1"}),Lt.createElement("rect",{x:"40",y:"75",rx:"0",ry:"0",width:"35",height:"100"}),Lt.createElement("rect",{x:"80",y:"125",rx:"0",ry:"0",width:"35",height:"50"}),Lt.createElement("rect",{x:"120",y:"105",rx:"0",ry:"0",width:"35",height:"70"}),Lt.createElement("rect",{x:"160",y:"35",rx:"0",ry:"0",width:"35",height:"140"}),Lt.createElement("rect",{x:"200",y:"55",rx:"0",ry:"0",width:"35",height:"120"}),Lt.createElement("rect",{x:"240",y:"15",rx:"0",ry:"0",width:"35",height:"160"}),Lt.createElement("rect",{x:"280",y:"135",rx:"0",ry:"0",width:"35",height:"40"}),Lt.createElement("rect",{x:"320",y:"85",rx:"0",ry:"0",width:"35",height:"90"}))};return Lt.createElement("div",{className:"charts-loading-container",style:{position:"absolute",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",left:0,top:0,zIndex:99,backgroundColor:ht==="dark"?"rgb(20, 20, 20)":"rgb(255, 255, 255)"}},ct())};Ft.Z=I},4322:function(vn,Ft,ot){"use strict";ot.d(Ft,{J:function(){return wt}});var Lt=ot(45098),wt=function(I,Et){!I||((0,Lt.mf)(I)?I(Et):I.current=Et)}},74273:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return Oe}});var Lt=ot(4942),wt=ot(1413),I=ot(91),Et=ot(85893),q=ot(46986),lt=ot(94184),ht=ot.n(lt),ct=ot(67294),et=ot(4270),Ee=ot(44962),it=ot(14855),st=function(zt){return(0,Lt.Z)({},zt.componentCls,{display:"flex",flexDirection:"column",justifyContent:"flex-end",marginBlock:zt.marginLG,marginInline:0,color:zt.colorText,fontWeight:"500",fontSize:"20px",lineHeight:"38px"})};function Zt(We){return(0,it.Xj)("ProCardOperation",function(zt){var At=(0,wt.Z)((0,wt.Z)({},zt),{},{componentCls:".".concat(We)});return[st(At)]})}var P=function(zt){var At=zt.className,Mt=zt.style,Rt=Mt===void 0?{}:Mt,tt=zt.children,_t=(0,ct.useContext)(q.ZP.ConfigContext),Xt=_t.getPrefixCls,ve=Xt("pro-card-operation"),Wt=Zt(ve),Me=Wt.wrapSSR,je=Wt.hashId,Qe=ht()(ve,At,je);return Me((0,Et.jsx)("div",{className:Qe,style:Rt,children:tt}))},b=P,X=ot(25035),le=ot(83062),Se=ot(76521),Ie=ot(87462),It=ot(57838),rt=ot(96159),Dt=ot(97685),Ae=ot(53124),be=ot(21687),me=function(zt){var At=zt.value,Mt=zt.formatter,Rt=zt.precision,tt=zt.decimalSeparator,_t=zt.groupSeparator,Xt=_t===void 0?"":_t,ve=zt.prefixCls,Wt;if(typeof Mt=="function")Wt=Mt(At);else{var Me=String(At),je=Me.match(/^(-?)(\d*)(\.(\d+))?$/);if(!je||Me==="-")Wt=Me;else{var Qe=je[1],hr=je[2]||"0",er=je[4]||"";hr=hr.replace(/\B(?=(\d{3})+(?!\d))/g,Xt),typeof Rt=="number"&&(er=er.padEnd(Rt,"0").slice(0,Rt>0?Rt:0)),er&&(er=""+tt+er),Wt=[ct.createElement("span",{key:"int",className:ve+"-content-value-int"},Qe,hr),er&&ct.createElement("span",{key:"decimal",className:ve+"-content-value-decimal"},er)]}}return ct.createElement("span",{className:ve+"-content-value"},Wt)},ee=me,we=ot(67968),_e=ot(45503),gt=ot(14747),Pt=function(zt){var At,Mt,Rt=zt.componentCls,tt=zt.marginXXS,_t=zt.padding,Xt=zt.colorTextDescription,ve=zt.statisticTitleFontSize,Wt=zt.colorTextHeading,Me=zt.statisticContentFontSize,je=zt.statisticFontFamily;return(0,Lt.Z)({},""+Rt,(0,Ie.Z)((0,Ie.Z)({},(0,gt.Wf)(zt)),(Mt={},(0,Lt.Z)(Mt,Rt+"-title",{marginBottom:tt,color:Xt,fontSize:ve}),(0,Lt.Z)(Mt,Rt+"-skeleton",{paddingTop:_t}),(0,Lt.Z)(Mt,Rt+"-content",(At={color:Wt,fontSize:Me,fontFamily:je},(0,Lt.Z)(At,Rt+"-content-value",{display:"inline-block",direction:"ltr"}),(0,Lt.Z)(At,Rt+"-content-prefix, "+Rt+"-content-suffix",{display:"inline-block"}),(0,Lt.Z)(At,Rt+"-content-prefix",{marginInlineEnd:tt}),(0,Lt.Z)(At,Rt+"-content-suffix",{marginInlineStart:tt}),At)),Mt)))},J=(0,we.Z)("Statistic",function(We){var zt=We.fontSizeHeading3,At=We.fontSize,Mt=We.fontFamily,Rt=(0,_e.TS)(We,{statisticTitleFontSize:At,statisticContentFontSize:zt,statisticFontFamily:Mt});return[Pt(Rt)]}),vt=function(zt){var At=zt.prefixCls,Mt=zt.className,Rt=zt.style,tt=zt.valueStyle,_t=zt.value,Xt=_t===void 0?0:_t,ve=zt.title,Wt=zt.valueRender,Me=zt.prefix,je=zt.suffix,Qe=zt.loading,hr=Qe===void 0?!1:Qe,er=zt.direction,Br=zt.onMouseEnter,Lr=zt.onMouseLeave,Zr=zt.decimalSeparator,Tn=Zr===void 0?".":Zr,rn=zt.groupSeparator,Nn=rn===void 0?",":rn,zn=ct.createElement(ee,(0,Ie.Z)({decimalSeparator:Tn,groupSeparator:Nn},zt,{value:Xt})),jn=J(String(At)),wn=(0,Dt.Z)(jn,2),Wn=wn[0],Bt=wn[1],Yt=ht()(At,(0,Lt.Z)({},At+"-rtl",er==="rtl"),Mt,Bt);return Wn(ct.createElement("div",{className:Yt,style:Rt,onMouseEnter:Br,onMouseLeave:Lr},ve&&ct.createElement("div",{className:At+"-title"},ve),ct.createElement(be.Z,{paragraph:!1,loading:hr,className:At+"-skeleton"},ct.createElement("div",{style:tt,className:At+"-content"},Me&&ct.createElement("span",{className:At+"-content-prefix"},Me),Wt?Wt(zn):zn,je&&ct.createElement("span",{className:At+"-content-suffix"},je)))))},W=(0,Ae.PG)({prefixCls:"statistic"})(vt),dt=W,Vt=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function ne(We,zt){var At=We,Mt=/\[[^\]]*]/g,Rt=(zt.match(Mt)||[]).map(function(ve){return ve.slice(1,-1)}),tt=zt.replace(Mt,"[]"),_t=Vt.reduce(function(ve,Wt){var Me=(0,Dt.Z)(Wt,2),je=Me[0],Qe=Me[1];if(ve.includes(je)){var hr=Math.floor(At/Qe);return At-=hr*Qe,ve.replace(new RegExp(je+"+","g"),function(er){var Br=er.length;return hr.toString().padStart(Br,"0")})}return ve},tt),Xt=0;return _t.replace(Mt,function(){var ve=Rt[Xt];return Xt+=1,ve})}function ge(We,zt){var At=zt.format,Mt=At===void 0?"":At,Rt=new Date(We).getTime(),tt=Date.now(),_t=Math.max(Rt-tt,0);return ne(_t,Mt)}var $e=1e3/30;function jt(We){return new Date(We).getTime()}var Qt=function(zt){var At=zt.value,Mt=zt.format,Rt=Mt===void 0?"HH:mm:ss":Mt,tt=zt.onChange,_t=zt.onFinish,Xt=(0,It.Z)(),ve=ct.useRef(null),Wt=function(){_t==null||_t(),ve.current&&(clearInterval(ve.current),ve.current=null)},Me=function(){var er=jt(At);er>=Date.now()&&(ve.current=setInterval(function(){Xt(),tt==null||tt(er-Date.now()),er<Date.now()&&Wt()},$e))};ct.useEffect(function(){return Me(),function(){ve.current&&(clearInterval(ve.current),ve.current=null)}},[At]);var je=function(er,Br){return ge(er,(0,Ie.Z)((0,Ie.Z)({},Br),{format:Rt}))},Qe=function(er){return(0,rt.Tm)(er,{title:void 0})};return ct.createElement(dt,(0,Ie.Z)({},zt,{valueRender:Qe,formatter:je}))},Te=ct.memo(Qt);dt.Countdown=Te;var ae=dt,Ke=function(zt){var At,Mt,Rt;return(0,Lt.Z)({},zt.componentCls,(Rt={display:"flex",fontSize:zt.fontSize,"& + &":{marginBlockStart:4},"&-tip":{marginInlineStart:4},"&-wrapper":(0,Lt.Z)({display:"flex",width:"100%"},"".concat(zt.componentCls,"-status"),{width:"14px"}),"&-icon":{marginInlineEnd:16},"&-trend-icon":{width:0,height:0,borderInlineEnd:"3.5px solid transparent",borderBlockEnd:"9px solid #000",borderInlineStart:"3.5px solid transparent","&-up":{transform:"rotate(0deg)"},"&-down":{transform:"rotate(180deg)"}},"&-content":{width:"100%"},"&-description":{width:"100%"}},(0,Lt.Z)(Rt,"".concat(zt.antCls,"-statistic-title"),{color:zt.colorText}),(0,Lt.Z)(Rt,"&-trend-up",(0,Lt.Z)({},"".concat(zt.antCls,"-statistic-content"),(0,Lt.Z)({color:"#f5222d"},"".concat(zt.componentCls,"-trend-icon"),{borderBlockEndColor:"#f5222d"}))),(0,Lt.Z)(Rt,"&-trend-down",(0,Lt.Z)({},"".concat(zt.antCls,"-statistic-content"),(0,Lt.Z)({color:"#389e0d"},"".concat(zt.componentCls,"-trend-icon"),{borderBlockEndColor:"#52c41a"}))),(0,Lt.Z)(Rt,"& &-layout-horizontal",(At={display:"flex",justifyContent:"space-between"},(0,Lt.Z)(At,"".concat(zt.antCls,"-statistic-title"),{marginBlockEnd:0}),(0,Lt.Z)(At,"".concat(zt.antCls,"-statistic-content-value"),{fontWeight:500}),(0,Lt.Z)(At,"".concat(zt.antCls,"-statistic-title,").concat(zt.antCls,"-statistic-content,").concat(zt.antCls,"-statistic-content-suffix,").concat(zt.antCls,"-statistic-content-prefix,").concat(zt.antCls,"-statistic-content-value-decimal"),{fontSize:zt.fontSize}),At)),(0,Lt.Z)(Rt,"& &-layout-inline",(Mt={display:"inline-flex",color:zt.colorTextSecondary},(0,Lt.Z)(Mt,"".concat(zt.antCls,"-statistic-title"),{marginInlineEnd:"6px",marginBlockEnd:0}),(0,Lt.Z)(Mt,"".concat(zt.antCls,"-statistic-content"),{color:zt.colorTextSecondary}),(0,Lt.Z)(Mt,"".concat(zt.antCls,"-statistic-title,").concat(zt.antCls,"-statistic-content,").concat(zt.antCls,"-statistic-content-suffix,").concat(zt.antCls,"-statistic-content-prefix,").concat(zt.antCls,"-statistic-content-value-decimal"),{fontSize:zt.fontSizeSM}),Mt)),Rt))};function or(We){return(0,it.Xj)("Statistic",function(zt){var At=(0,wt.Z)((0,wt.Z)({},zt),{},{componentCls:".".concat(We)});return[Ke(At)]})}var ie=["className","layout","style","description","children","title","tip","status","trend","prefix","icon"],te=function(zt){var At,Mt=zt.className,Rt=zt.layout,tt=Rt===void 0?"inline":Rt,_t=zt.style,Xt=_t===void 0?{}:_t,ve=zt.description,Wt=zt.children,Me=zt.title,je=zt.tip,Qe=zt.status,hr=zt.trend,er=zt.prefix,Br=zt.icon,Lr=(0,I.Z)(zt,ie),Zr=(0,ct.useContext)(q.ZP.ConfigContext),Tn=Zr.getPrefixCls,rn=Tn("pro-card-statistic"),Nn=or(rn),zn=Nn.wrapSSR,jn=Nn.hashId,wn=ht()(rn,Mt,jn),Wn=ht()("".concat(rn,"-status"),jn),Bt=ht()("".concat(rn,"-icon"),jn),Yt=ht()("".concat(rn,"-wrapper"),jn),oe=ht()("".concat(rn,"-content"),jn),Ce=ht()(jn,(At={},(0,Lt.Z)(At,"".concat(rn,"-layout-").concat(tt),tt),(0,Lt.Z)(At,"".concat(rn,"-trend-").concat(hr),hr),At)),Ue=je&&(0,Et.jsx)(le.Z,{title:je,children:(0,Et.jsx)(X.Z,{className:"".concat(rn,"-tip ").concat(jn)})}),fr=ht()("".concat(rn,"-trend-icon"),jn,(0,Lt.Z)({},"".concat(rn,"-trend-icon-").concat(hr),hr)),Sr=hr&&(0,Et.jsx)("div",{className:fr}),Pe=Qe&&(0,Et.jsx)("div",{className:Wn,children:(0,Et.jsx)(Se.Z,{status:Qe,text:null})}),ur=Br&&(0,Et.jsx)("div",{className:Bt,children:Br});return zn((0,Et.jsxs)("div",{className:wn,style:Xt,children:[ur,(0,Et.jsxs)("div",{className:Yt,children:[Pe,(0,Et.jsxs)("div",{className:oe,children:[(0,Et.jsx)(ae,(0,wt.Z)({title:(Me||Ue)&&(0,Et.jsxs)(Et.Fragment,{children:[Me,Ue]}),prefix:(Sr||er)&&(0,Et.jsxs)(Et.Fragment,{children:[Sr,er]}),className:Ce},Lr)),ve&&(0,Et.jsx)("div",{className:"".concat(rn,"-description ").concat(jn),children:ve})]})]})]}))},St=te,qt=function(zt){return(0,Lt.Z)({},zt.componentCls,{"&-chart":{display:"flex",flexDirection:"column",marginBlockStart:8,marginBlockEnd:8,"&-left":{marginBlockStart:0,marginInlineEnd:"16px"},"&-right":{marginBlockStart:0,marginInlineStart:"16px"}},"&-content":{display:"flex",flexDirection:"column","&-horizontal":(0,Lt.Z)({flexDirection:"row"},"".concat(zt.componentCls,"-chart"),{alignItems:"center",alignSelf:"flex-start"})},"&-footer":{marginBlockStart:8,paddingBlockStart:"16px",borderBlockStart:"rgba(0, 0, 0, 0.08) solid ".concat(zt.colorBorder)}})};function $t(We){return(0,it.Xj)("StatisticCard",function(zt){var At=(0,wt.Z)((0,wt.Z)({},zt),{},{componentCls:".".concat(We)});return[qt(At)]})}var Ct=["children","statistic","className","chart","chartPlacement","footer"],Tt=function(zt){var At,Mt=zt.children,Rt=zt.statistic,tt=zt.className,_t=zt.chart,Xt=zt.chartPlacement,ve=zt.footer,Wt=(0,I.Z)(zt,Ct),Me=(0,ct.useContext)(q.ZP.ConfigContext),je=Me.getPrefixCls,Qe=je("pro-statistic-card"),hr=$t(Qe),er=hr.wrapSSR,Br=hr.hashId,Lr=ht()(Qe,tt,Br),Zr=Rt&&(0,Et.jsx)(St,(0,wt.Z)({layout:"vertical"},Rt)),Tn=ht()("".concat(Qe,"-chart"),Br,(At={},(0,Lt.Z)(At,"".concat(Qe,"-chart-left"),Xt==="left"&&_t&&Rt),(0,Lt.Z)(At,"".concat(Qe,"-chart-right"),Xt==="right"&&_t&&Rt),At)),rn=_t&&(0,Et.jsx)("div",{className:Tn,children:_t}),Nn=ht()("".concat(Qe,"-content "),Br,(0,Lt.Z)({},"".concat(Qe,"-content-horizontal"),Xt==="left"||Xt==="right")),zn=(rn||Zr)&&(Xt==="left"?(0,Et.jsxs)("div",{className:Nn,children:[rn,Zr]}):(0,Et.jsxs)("div",{className:Nn,children:[Zr,rn]})),jn=ve&&(0,Et.jsx)("div",{className:"".concat(Qe,"-footer ").concat(Br),children:ve});return er((0,Et.jsxs)(et.Z,(0,wt.Z)((0,wt.Z)({className:Lr},Wt),{},{children:[zn,Mt,jn]})))},ue=function(zt){return(0,Et.jsx)(Tt,(0,wt.Z)({bodyStyle:{padding:0}},zt))};Tt.Statistic=St,Tt.Divider=Ee.Z,Tt.Operation=b,Tt.isProCard=!0,Tt.Group=ue;var Oe=Tt},6056:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return lt}});var Lt,wt,I,Et;function q(){Lt=document.createElement("table"),wt=document.createElement("tr"),I=/^\s*<(\w+|!)[^>]*>/,Et={tr:document.createElement("tbody"),tbody:Lt,thead:Lt,tfoot:Lt,td:wt,th:wt,"*":document.createElement("div")}}function lt(ht){Lt||q();var ct=I.test(ht)&&RegExp.$1;(!ct||!(ct in Et))&&(ct="*");var et=Et[ct];ht=typeof ht=="string"?ht.replace(/(^\s*)|(\s*$)/g,""):ht,et.innerHTML=""+ht;var Ee=et.childNodes[0];return Ee&&et.contains(Ee)&&et.removeChild(Ee),Ee}},45442:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return Lt}});function Lt(wt,I){if(wt)for(var Et in I)I.hasOwnProperty(Et)&&(wt.style[Et]=I[Et]);return wt}},90494:function(vn,Ft){"use strict";var ot="*",Lt=function(){function wt(){this._events={}}return wt.prototype.on=function(I,Et,q){return this._events[I]||(this._events[I]=[]),this._events[I].push({callback:Et,once:!!q}),this},wt.prototype.once=function(I,Et){return this.on(I,Et,!0)},wt.prototype.emit=function(I){for(var Et=this,q=[],lt=1;lt<arguments.length;lt++)q[lt-1]=arguments[lt];var ht=this._events[I]||[],ct=this._events[ot]||[],et=function(Ee){for(var it=Ee.length,st=0;st<it;st++)if(!!Ee[st]){var Zt=Ee[st],P=Zt.callback,b=Zt.once;b&&(Ee.splice(st,1),Ee.length===0&&delete Et._events[I],it--,st--),P.apply(Et,q)}};et(ht),et(ct)},wt.prototype.off=function(I,Et){if(!I)this._events={};else if(!Et)delete this._events[I];else{for(var q=this._events[I]||[],lt=q.length,ht=0;ht<lt;ht++)q[ht].callback===Et&&(q.splice(ht,1),lt--,ht--);q.length===0&&delete this._events[I]}return this},wt.prototype.getEvents=function(){return this._events},wt}();Ft.Z=Lt},2667:function(vn,Ft,ot){"use strict";var Lt=ot(70655),wt=ot(90494),I=ot(77341),Et=function(q){(0,Lt.ZT)(lt,q);function lt(ht){var ct=q.call(this)||this;ct.destroyed=!1;var et=ct.getDefaultCfg();return ct.cfg=(0,I.CD)(et,ht),ct}return lt.prototype.getDefaultCfg=function(){return{}},lt.prototype.get=function(ht){return this.cfg[ht]},lt.prototype.set=function(ht,ct){this.cfg[ht]=ct},lt.prototype.destroy=function(){this.cfg={destroyed:!0},this.off(),this.destroyed=!0},lt}(wt.Z);Ft.Z=Et},2840:function(vn,Ft,ot){"use strict";ot.d(Ft,{Z:function(){return bo}});var Lt=ot(70655),wt=ot(43631),I=ot(37153),Et=ot(77341),q=ot(45098),lt=0,ht=0,ct=0,et=1e3,Ee,it,st=0,Zt=0,P=0,b=typeof performance=="object"&&performance.now?performance:Date,X=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(nr){setTimeout(nr,17)};function le(){return Zt||(X(Se),Zt=b.now()+P)}function Se(){Zt=0}function Ie(){this._call=this._time=this._next=null}Ie.prototype=It.prototype={constructor:Ie,restart:function(nr,xe,He){if(typeof nr!="function")throw new TypeError("callback is not a function");He=(He==null?le():+He)+(xe==null?0:+xe),!this._next&&it!==this&&(it?it._next=this:Ee=this,it=this),this._call=nr,this._time=He,me()},stop:function(){this._call&&(this._call=null,this._time=1/0,me())}};function It(nr,xe,He){var Mr=new Ie;return Mr.restart(nr,xe,He),Mr}function rt(){le(),++lt;for(var nr=Ee,xe;nr;)(xe=Zt-nr._time)>=0&&nr._call.call(null,xe),nr=nr._next;--lt}function Dt(){Zt=(st=b.now())+P,lt=ht=0;try{rt()}finally{lt=0,be(),Zt=0}}function Ae(){var nr=b.now(),xe=nr-st;xe>et&&(P-=xe,st=nr)}function be(){for(var nr,xe=Ee,He,Mr=1/0;xe;)xe._call?(Mr>xe._time&&(Mr=xe._time),nr=xe,xe=xe._next):(He=xe._next,xe._next=null,xe=nr?nr._next=He:Ee=He);it=nr,me(Mr)}function me(nr){if(!lt){ht&&(ht=clearTimeout(ht));var xe=nr-Zt;xe>24?(nr<1/0&&(ht=setTimeout(Dt,nr-b.now()-P)),ct&&(ct=clearInterval(ct))):(ct||(st=b.now(),ct=setInterval(Ae,et)),lt=1,X(Dt))}}var ee=ot(77190);function we(nr,xe,He){nr.prototype=xe.prototype=He,He.constructor=nr}function _e(nr,xe){var He=Object.create(nr.prototype);for(var Mr in xe)He[Mr]=xe[Mr];return He}function gt(){}var Pt=.7,J=1/Pt,vt="\\s*([+-]?\\d+)\\s*",W="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",dt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Vt=/^#([0-9a-f]{3,8})$/,ne=new RegExp("^rgb\\(".concat(vt,",").concat(vt,",").concat(vt,"\\)$")),ge=new RegExp("^rgb\\(".concat(dt,",").concat(dt,",").concat(dt,"\\)$")),$e=new RegExp("^rgba\\(".concat(vt,",").concat(vt,",").concat(vt,",").concat(W,"\\)$")),jt=new RegExp("^rgba\\(".concat(dt,",").concat(dt,",").concat(dt,",").concat(W,"\\)$")),Qt=new RegExp("^hsl\\(".concat(W,",").concat(dt,",").concat(dt,"\\)$")),Te=new RegExp("^hsla\\(".concat(W,",").concat(dt,",").concat(dt,",").concat(W,"\\)$")),ae={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};we(gt,St,{copy:function(xe){return Object.assign(new this.constructor,this,xe)},displayable:function(){return this.rgb().displayable()},hex:Ke,formatHex:Ke,formatHex8:or,formatHsl:ie,formatRgb:te,toString:te});function Ke(){return this.rgb().formatHex()}function or(){return this.rgb().formatHex8()}function ie(){return _t(this).formatHsl()}function te(){return this.rgb().formatRgb()}function St(nr){var xe,He;return nr=(nr+"").trim().toLowerCase(),(xe=Vt.exec(nr))?(He=xe[1].length,xe=parseInt(xe[1],16),He===6?qt(xe):He===3?new ue(xe>>8&15|xe>>4&240,xe>>4&15|xe&240,(xe&15)<<4|xe&15,1):He===8?$t(xe>>24&255,xe>>16&255,xe>>8&255,(xe&255)/255):He===4?$t(xe>>12&15|xe>>8&240,xe>>8&15|xe>>4&240,xe>>4&15|xe&240,((xe&15)<<4|xe&15)/255):null):(xe=ne.exec(nr))?new ue(xe[1],xe[2],xe[3],1):(xe=ge.exec(nr))?new ue(xe[1]*255/100,xe[2]*255/100,xe[3]*255/100,1):(xe=$e.exec(nr))?$t(xe[1],xe[2],xe[3],xe[4]):(xe=jt.exec(nr))?$t(xe[1]*255/100,xe[2]*255/100,xe[3]*255/100,xe[4]):(xe=Qt.exec(nr))?tt(xe[1],xe[2]/100,xe[3]/100,1):(xe=Te.exec(nr))?tt(xe[1],xe[2]/100,xe[3]/100,xe[4]):ae.hasOwnProperty(nr)?qt(ae[nr]):nr==="transparent"?new ue(NaN,NaN,NaN,0):null}function qt(nr){return new ue(nr>>16&255,nr>>8&255,nr&255,1)}function $t(nr,xe,He,Mr){return Mr<=0&&(nr=xe=He=NaN),new ue(nr,xe,He,Mr)}function Ct(nr){return nr instanceof gt||(nr=St(nr)),nr?(nr=nr.rgb(),new ue(nr.r,nr.g,nr.b,nr.opacity)):new ue}function Tt(nr,xe,He,Mr){return arguments.length===1?Ct(nr):new ue(nr,xe,He,Mr==null?1:Mr)}function ue(nr,xe,He,Mr){this.r=+nr,this.g=+xe,this.b=+He,this.opacity=+Mr}we(ue,Tt,_e(gt,{brighter:function(xe){return xe=xe==null?J:Math.pow(J,xe),new ue(this.r*xe,this.g*xe,this.b*xe,this.opacity)},darker:function(xe){return xe=xe==null?Pt:Math.pow(Pt,xe),new ue(this.r*xe,this.g*xe,this.b*xe,this.opacity)},rgb:function(){return this},clamp:function(){return new ue(Mt(this.r),Mt(this.g),Mt(this.b),At(this.opacity))},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Oe,formatHex:Oe,formatHex8:We,formatRgb:zt,toString:zt}));function Oe(){return"#".concat(Rt(this.r)).concat(Rt(this.g)).concat(Rt(this.b))}function We(){return"#".concat(Rt(this.r)).concat(Rt(this.g)).concat(Rt(this.b)).concat(Rt((isNaN(this.opacity)?1:this.opacity)*255))}function zt(){var nr=At(this.opacity);return"".concat(nr===1?"rgb(":"rgba(").concat(Mt(this.r),", ").concat(Mt(this.g),", ").concat(Mt(this.b)).concat(nr===1?")":", ".concat(nr,")"))}function At(nr){return isNaN(nr)?1:Math.max(0,Math.min(1,nr))}function Mt(nr){return Math.max(0,Math.min(255,Math.round(nr)||0))}function Rt(nr){return nr=Mt(nr),(nr<16?"0":"")+nr.toString(16)}function tt(nr,xe,He,Mr){return Mr<=0?nr=xe=He=NaN:He<=0||He>=1?nr=xe=NaN:xe<=0&&(nr=NaN),new ve(nr,xe,He,Mr)}function _t(nr){if(nr instanceof ve)return new ve(nr.h,nr.s,nr.l,nr.opacity);if(nr instanceof gt||(nr=St(nr)),!nr)return new ve;if(nr instanceof ve)return nr;nr=nr.rgb();var xe=nr.r/255,He=nr.g/255,Mr=nr.b/255,tn=Math.min(xe,He,Mr),In=Math.max(xe,He,Mr),Un=NaN,Cn=In-tn,ta=(In+tn)/2;return Cn?(xe===In?Un=(He-Mr)/Cn+(He<Mr)*6:He===In?Un=(Mr-xe)/Cn+2:Un=(xe-He)/Cn+4,Cn/=ta<.5?In+tn:2-In-tn,Un*=60):Cn=ta>0&&ta<1?0:Un,new ve(Un,Cn,ta,nr.opacity)}function Xt(nr,xe,He,Mr){return arguments.length===1?_t(nr):new ve(nr,xe,He,Mr==null?1:Mr)}function ve(nr,xe,He,Mr){this.h=+nr,this.s=+xe,this.l=+He,this.opacity=+Mr}we(ve,Xt,_e(gt,{brighter:function(xe){return xe=xe==null?J:Math.pow(J,xe),new ve(this.h,this.s,this.l*xe,this.opacity)},darker:function(xe){return xe=xe==null?Pt:Math.pow(Pt,xe),new ve(this.h,this.s,this.l*xe,this.opacity)},rgb:function(){var xe=this.h%360+(this.h<0)*360,He=isNaN(xe)||isNaN(this.s)?0:this.s,Mr=this.l,tn=Mr+(Mr<.5?Mr:1-Mr)*He,In=2*Mr-tn;return new ue(je(xe>=240?xe-240:xe+120,In,tn),je(xe,In,tn),je(xe<120?xe+240:xe-120,In,tn),this.opacity)},clamp:function(){return new ve(Wt(this.h),Me(this.s),Me(this.l),At(this.opacity))},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var xe=At(this.opacity);return"".concat(xe===1?"hsl(":"hsla(").concat(Wt(this.h),", ").concat(Me(this.s)*100,"%, ").concat(Me(this.l)*100,"%").concat(xe===1?")":", ".concat(xe,")"))}}));function Wt(nr){return nr=(nr||0)%360,nr<0?nr+360:nr}function Me(nr){return Math.max(0,Math.min(1,nr||0))}function je(nr,xe,He){return(nr<60?xe+(He-xe)*nr/60:nr<180?He:nr<240?xe+(He-xe)*(240-nr)/60:xe)*255}function Qe(nr,xe,He,Mr,tn){var In=nr*nr,Un=In*nr;return((1-3*nr+3*In-Un)*xe+(4-6*In+3*Un)*He+(1+3*nr+3*In-3*Un)*Mr+Un*tn)/6}function hr(nr){var xe=nr.length-1;return function(He){var Mr=He<=0?He=0:He>=1?(He=1,xe-1):Math.floor(He*xe),tn=nr[Mr],In=nr[Mr+1],Un=Mr>0?nr[Mr-1]:2*tn-In,Cn=Mr<xe-1?nr[Mr+2]:2*In-tn;return Qe((He-Mr/xe)*xe,Un,tn,In,Cn)}}function er(nr){var xe=nr.length;return function(He){var Mr=Math.floor(((He%=1)<0?++He:He)*xe),tn=nr[(Mr+xe-1)%xe],In=nr[Mr%xe],Un=nr[(Mr+1)%xe],Cn=nr[(Mr+2)%xe];return Qe((He-Mr/xe)*xe,tn,In,Un,Cn)}}var Br=function(nr){return function(){return nr}};function Lr(nr,xe){return function(He){return nr+He*xe}}function Zr(nr,xe,He){return nr=Math.pow(nr,He),xe=Math.pow(xe,He)-nr,He=1/He,function(Mr){return Math.pow(nr+Mr*xe,He)}}function Tn(nr,xe){var He=xe-nr;return He?Lr(nr,He>180||He<-180?He-360*Math.round(He/360):He):constant(isNaN(nr)?xe:nr)}function rn(nr){return(nr=+nr)==1?Nn:function(xe,He){return He-xe?Zr(xe,He,nr):Br(isNaN(xe)?He:xe)}}function Nn(nr,xe){var He=xe-nr;return He?Lr(nr,He):Br(isNaN(nr)?xe:nr)}var zn=function nr(xe){var He=rn(xe);function Mr(tn,In){var Un=He((tn=Tt(tn)).r,(In=Tt(In)).r),Cn=He(tn.g,In.g),ta=He(tn.b,In.b),Wa=Nn(tn.opacity,In.opacity);return function(es){return tn.r=Un(es),tn.g=Cn(es),tn.b=ta(es),tn.opacity=Wa(es),tn+""}}return Mr.gamma=nr,Mr}(1);function jn(nr){return function(xe){var He=xe.length,Mr=new Array(He),tn=new Array(He),In=new Array(He),Un,Cn;for(Un=0;Un<He;++Un)Cn=Tt(xe[Un]),Mr[Un]=Cn.r||0,tn[Un]=Cn.g||0,In[Un]=Cn.b||0;return Mr=nr(Mr),tn=nr(tn),In=nr(In),Cn.opacity=1,function(ta){return Cn.r=Mr(ta),Cn.g=tn(ta),Cn.b=In(ta),Cn+""}}}var wn=jn(hr),Wn=jn(er);function Bt(nr,xe){xe||(xe=[]);var He=nr?Math.min(xe.length,nr.length):0,Mr=xe.slice(),tn;return function(In){for(tn=0;tn<He;++tn)Mr[tn]=nr[tn]*(1-In)+xe[tn]*In;return Mr}}function Yt(nr){return ArrayBuffer.isView(nr)&&!(nr instanceof DataView)}function oe(nr,xe){return(Yt(xe)?Bt:Ce)(nr,xe)}function Ce(nr,xe){var He=xe?xe.length:0,Mr=nr?Math.min(He,nr.length):0,tn=new Array(Mr),In=new Array(He),Un;for(Un=0;Un<Mr;++Un)tn[Un]=Qr(nr[Un],xe[Un]);for(;Un<He;++Un)In[Un]=xe[Un];return function(Cn){for(Un=0;Un<Mr;++Un)In[Un]=tn[Un](Cn);return In}}function Ue(nr,xe){var He=new Date;return nr=+nr,xe=+xe,function(Mr){return He.setTime(nr*(1-Mr)+xe*Mr),He}}function fr(nr,xe){return nr=+nr,xe=+xe,function(He){return nr*(1-He)+xe*He}}function Sr(nr,xe){var He={},Mr={},tn;(nr===null||ee(nr)!=="object")&&(nr={}),(xe===null||ee(xe)!=="object")&&(xe={});for(tn in xe)tn in nr?He[tn]=Qr(nr[tn],xe[tn]):Mr[tn]=xe[tn];return function(In){for(tn in He)Mr[tn]=He[tn](In);return Mr}}var Pe=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ur=new RegExp(Pe.source,"g");function Wr(nr){return function(){return nr}}function Sn(nr){return function(xe){return nr(xe)+""}}function qr(nr,xe){var He=Pe.lastIndex=ur.lastIndex=0,Mr,tn,In,Un=-1,Cn=[],ta=[];for(nr=nr+"",xe=xe+"";(Mr=Pe.exec(nr))&&(tn=ur.exec(xe));)(In=tn.index)>He&&(In=xe.slice(He,In),Cn[Un]?Cn[Un]+=In:Cn[++Un]=In),(Mr=Mr[0])===(tn=tn[0])?Cn[Un]?Cn[Un]+=tn:Cn[++Un]=tn:(Cn[++Un]=null,ta.push({i:Un,x:fr(Mr,tn)})),He=ur.lastIndex;return He<xe.length&&(In=xe.slice(He),Cn[Un]?Cn[Un]+=In:Cn[++Un]=In),Cn.length<2?ta[0]?Sn(ta[0].x):Wr(xe):(xe=ta.length,function(Wa){for(var es=0,ko;es<xe;++es)Cn[(ko=ta[es]).i]=ko.x(Wa);return Cn.join("")})}function Qr(nr,xe){var He=ee(xe),Mr;return xe==null||He==="boolean"?Br(xe):(He==="number"?fr:He==="string"?(Mr=St(xe))?(xe=Mr,zn):qr:xe instanceof St?zn:xe instanceof Date?Ue:Yt(xe)?Bt:Array.isArray(xe)?Ce:typeof xe.valueOf!="function"&&typeof xe.toString!="function"||isNaN(xe)?Sr:fr)(nr,xe)}var Mn=ot(93924),bi=ot(47575),Si=function(nr){return["fill","stroke","fillStyle","strokeStyle"].includes(nr)},Kr=function(nr){return/^[r,R,L,l]{1}[\s]*\(/.test(nr)},ai=[1,0,0,0,1,0,0,0,1];function li(nr,xe,He){var Mr={},tn=xe.fromAttrs,In=xe.toAttrs;if(!nr.destroyed){var Un;for(var Cn in In)if(!(0,q.Xy)(tn[Cn],In[Cn]))if(Cn==="path"){var ta=In[Cn],Wa=tn[Cn];ta.length>Wa.length?(ta=bi.parsePathString(In[Cn]),Wa=bi.parsePathString(tn[Cn]),Wa=bi.fillPathByDiff(Wa,ta),Wa=bi.formatPath(Wa,ta),xe.fromAttrs.path=Wa,xe.toAttrs.path=ta):xe.pathFormatted||(ta=bi.parsePathString(In[Cn]),Wa=bi.parsePathString(tn[Cn]),Wa=bi.formatPath(Wa,ta),xe.fromAttrs.path=Wa,xe.toAttrs.path=ta,xe.pathFormatted=!0),Mr[Cn]=[];for(var es=0;es<ta.length;es++){for(var ko=ta[es],ns=Wa[es],Ya=[],Go=0;Go<ko.length;Go++)(0,q.hj)(ko[Go])&&ns&&(0,q.hj)(ns[Go])?(Un=Qr(ns[Go],ko[Go]),Ya.push(Un(He))):Ya.push(ko[Go]);Mr[Cn].push(Ya)}}else if(Cn==="matrix"){var pu=oe(tn[Cn]||ai,In[Cn]||ai),ys=pu(He);Mr[Cn]=ys}else Si(Cn)&&Kr(In[Cn])?Mr[Cn]=In[Cn]:(0,q.mf)(In[Cn])||(Un=Qr(tn[Cn],In[Cn]),Mr[Cn]=Un(He));nr.attr(Mr)}}function hi(nr,xe,He){var Mr=xe.startTime,tn=xe.delay;if(He<Mr+tn||xe._paused)return!1;var In,Un=xe.duration,Cn=xe.easing,ta=(0,Mn._)(Cn);if(He=He-Mr-xe.delay,xe.repeat)In=He%Un/Un,In=ta(In);else if(In=He/Un,In<1)In=ta(In);else return xe.onFrame?nr.attr(xe.onFrame(1)):nr.attr(xe.toAttrs),!0;if(xe.onFrame){var Wa=xe.onFrame(In);nr.attr(Wa)}else li(nr,xe,In);return!1}var ra=function(){function nr(xe){this.animators=[],this.current=0,this.timer=null,this.canvas=xe}return nr.prototype.initTimer=function(){var xe=this,He=!1,Mr,tn,In;this.timer=It(function(Un){if(xe.current=Un,xe.animators.length>0){for(var Cn=xe.animators.length-1;Cn>=0;Cn--){if(Mr=xe.animators[Cn],Mr.destroyed){xe.removeAnimator(Cn);continue}if(!Mr.isAnimatePaused()){tn=Mr.get("animations");for(var ta=tn.length-1;ta>=0;ta--)In=tn[ta],He=hi(Mr,In,Un),He&&(tn.splice(ta,1),He=!1,In.callback&&In.callback())}tn.length===0&&xe.removeAnimator(Cn)}var Wa=xe.canvas.get("autoDraw");Wa||xe.canvas.draw()}})},nr.prototype.addAnimator=function(xe){this.animators.push(xe)},nr.prototype.removeAnimator=function(xe){this.animators.splice(xe,1)},nr.prototype.isAnimating=function(){return!!this.animators.length},nr.prototype.stop=function(){this.timer&&this.timer.stop()},nr.prototype.stopAllAnimations=function(xe){xe===void 0&&(xe=!0),this.animators.forEach(function(He){He.stopAnimate(xe)}),this.animators=[],this.canvas.draw()},nr.prototype.getTime=function(){return this.current},nr}(),Ci=ra,Ba=ot(89473),po=40,za=0,Xa=":",Ta=["mousedown","mouseup","dblclick","mouseout","mouseover","mousemove","mouseleave","mouseenter","touchstart","touchmove","touchend","dragenter","dragover","dragleave","drop","contextmenu","mousewheel"];function ga(nr,xe){for(var He in nr)if(nr.hasOwnProperty(He)&&He.indexOf(Xa+xe)>=0)return!0;return!1}function no(nr,xe,He){He.name=xe,He.target=nr,He.currentTarget=nr,He.delegateTarget=nr,nr.emit(xe,He)}function Vo(nr,xe,He){if(He.bubbles){var Mr=void 0,tn=!1;if(xe==="mouseenter"?(Mr=He.fromShape,tn=!0):xe==="mouseleave"&&(tn=!0,Mr=He.toShape),nr.isCanvas()&&tn)return;if(Mr&&(0,Et.UY)(nr,Mr)){He.bubbles=!1;return}He.name=xe,He.currentTarget=nr,He.delegateTarget=nr,nr.emit(xe,He)}}var vo=function(){function nr(xe){var He=this;this.draggingShape=null,this.dragging=!1,this.currentShape=null,this.mousedownShape=null,this.mousedownPoint=null,this._eventCallback=function(Mr){var tn=Mr.type;He._triggerEvent(tn,Mr)},this._onDocumentMove=function(Mr){var tn=He.canvas,In=tn.get("el");if(In!==Mr.target&&(He.dragging||He.currentShape)){var Un=He._getPointInfo(Mr);He.dragging&&He._emitEvent("drag",Mr,Un,He.draggingShape)}},this._onDocumentMouseUp=function(Mr){var tn=He.canvas,In=tn.get("el");if(In!==Mr.target&&He.dragging){var Un=He._getPointInfo(Mr);He.draggingShape&&He._emitEvent("drop",Mr,Un,null),He._emitEvent("dragend",Mr,Un,He.draggingShape),He._afterDrag(He.draggingShape,Un,Mr)}},this.canvas=xe.canvas}return nr.prototype.init=function(){this._bindEvents()},nr.prototype._bindEvents=function(){var xe=this,He=this.canvas.get("el");(0,Et.S6)(Ta,function(Mr){He.addEventListener(Mr,xe._eventCallback)}),document&&(document.addEventListener("mousemove",this._onDocumentMove),document.addEventListener("mouseup",this._onDocumentMouseUp))},nr.prototype._clearEvents=function(){var xe=this,He=this.canvas.get("el");(0,Et.S6)(Ta,function(Mr){He.removeEventListener(Mr,xe._eventCallback)}),document&&(document.removeEventListener("mousemove",this._onDocumentMove),document.removeEventListener("mouseup",this._onDocumentMouseUp))},nr.prototype._getEventObj=function(xe,He,Mr,tn,In,Un){var Cn=new Ba.Z(xe,He);return Cn.fromShape=In,Cn.toShape=Un,Cn.x=Mr.x,Cn.y=Mr.y,Cn.clientX=Mr.clientX,Cn.clientY=Mr.clientY,Cn.propagationPath.push(tn),Cn},nr.prototype._getShape=function(xe,He){return this.canvas.getShape(xe.x,xe.y,He)},nr.prototype._getPointInfo=function(xe){var He=this.canvas,Mr=He.getClientByEvent(xe),tn=He.getPointByEvent(xe);return{x:tn.x,y:tn.y,clientX:Mr.x,clientY:Mr.y}},nr.prototype._triggerEvent=function(xe,He){var Mr=this._getPointInfo(He),tn=this._getShape(Mr,He),In=this["_on"+xe],Un=!1;if(In)In.call(this,Mr,tn,He);else{var Cn=this.currentShape;xe==="mouseenter"||xe==="dragenter"||xe==="mouseover"?(this._emitEvent(xe,He,Mr,null,null,tn),tn&&this._emitEvent(xe,He,Mr,tn,null,tn),xe==="mouseenter"&&this.draggingShape&&this._emitEvent("dragenter",He,Mr,null)):xe==="mouseleave"||xe==="dragleave"||xe==="mouseout"?(Un=!0,Cn&&this._emitEvent(xe,He,Mr,Cn,Cn,null),this._emitEvent(xe,He,Mr,null,Cn,null),xe==="mouseleave"&&this.draggingShape&&this._emitEvent("dragleave",He,Mr,null)):this._emitEvent(xe,He,Mr,tn,null,null)}if(Un||(this.currentShape=tn),tn&&!tn.get("destroyed")){var ta=this.canvas,Wa=ta.get("el");Wa.style.cursor=tn.attr("cursor")||ta.get("cursor")}},nr.prototype._onmousedown=function(xe,He,Mr){Mr.button===za&&(this.mousedownShape=He,this.mousedownPoint=xe,this.mousedownTimeStamp=Mr.timeStamp),this._emitEvent("mousedown",Mr,xe,He,null,null)},nr.prototype._emitMouseoverEvents=function(xe,He,Mr,tn){var In=this.canvas.get("el");Mr!==tn&&(Mr&&(this._emitEvent("mouseout",xe,He,Mr,Mr,tn),this._emitEvent("mouseleave",xe,He,Mr,Mr,tn),(!tn||tn.get("destroyed"))&&(In.style.cursor=this.canvas.get("cursor"))),tn&&(this._emitEvent("mouseover",xe,He,tn,Mr,tn),this._emitEvent("mouseenter",xe,He,tn,Mr,tn)))},nr.prototype._emitDragoverEvents=function(xe,He,Mr,tn,In){tn?(tn!==Mr&&(Mr&&this._emitEvent("dragleave",xe,He,Mr,Mr,tn),this._emitEvent("dragenter",xe,He,tn,Mr,tn)),In||this._emitEvent("dragover",xe,He,tn)):Mr&&this._emitEvent("dragleave",xe,He,Mr,Mr,tn),In&&this._emitEvent("dragover",xe,He,tn)},nr.prototype._afterDrag=function(xe,He,Mr){xe&&(xe.set("capture",!0),this.draggingShape=null),this.dragging=!1;var tn=this._getShape(He,Mr);tn!==xe&&this._emitMouseoverEvents(Mr,He,xe,tn),this.currentShape=tn},nr.prototype._onmouseup=function(xe,He,Mr){if(Mr.button===za){var tn=this.draggingShape;this.dragging?(tn&&this._emitEvent("drop",Mr,xe,He),this._emitEvent("dragend",Mr,xe,tn),this._afterDrag(tn,xe,Mr)):(this._emitEvent("mouseup",Mr,xe,He),He===this.mousedownShape&&this._emitEvent("click",Mr,xe,He),this.mousedownShape=null,this.mousedownPoint=null)}},nr.prototype._ondragover=function(xe,He,Mr){Mr.preventDefault();var tn=this.currentShape;this._emitDragoverEvents(Mr,xe,tn,He,!0)},nr.prototype._onmousemove=function(xe,He,Mr){var tn=this.canvas,In=this.currentShape,Un=this.draggingShape;if(this.dragging)Un&&this._emitDragoverEvents(Mr,xe,In,He,!1),this._emitEvent("drag",Mr,xe,Un);else{var Cn=this.mousedownPoint;if(Cn){var ta=this.mousedownShape,Wa=Mr.timeStamp,es=Wa-this.mousedownTimeStamp,ko=Cn.clientX-xe.clientX,ns=Cn.clientY-xe.clientY,Ya=ko*ko+ns*ns;es>120||Ya>po?ta&&ta.get("draggable")?(Un=this.mousedownShape,Un.set("capture",!1),this.draggingShape=Un,this.dragging=!0,this._emitEvent("dragstart",Mr,xe,Un),this.mousedownShape=null,this.mousedownPoint=null):!ta&&tn.get("draggable")?(this.dragging=!0,this._emitEvent("dragstart",Mr,xe,null),this.mousedownShape=null,this.mousedownPoint=null):(this._emitMouseoverEvents(Mr,xe,In,He),this._emitEvent("mousemove",Mr,xe,He)):(this._emitMouseoverEvents(Mr,xe,In,He),this._emitEvent("mousemove",Mr,xe,He))}else this._emitMouseoverEvents(Mr,xe,In,He),this._emitEvent("mousemove",Mr,xe,He)}},nr.prototype._emitEvent=function(xe,He,Mr,tn,In,Un){var Cn=this._getEventObj(xe,He,Mr,tn,In,Un);if(tn){Cn.shape=tn,no(tn,xe,Cn);for(var ta=tn.getParent();ta;)ta.emitDelegation(xe,Cn),Cn.propagationStopped||Vo(ta,xe,Cn),Cn.propagationPath.push(ta),ta=ta.getParent()}else{var Wa=this.canvas;no(Wa,xe,Cn)}},nr.prototype.destroy=function(){this._clearEvents(),this.canvas=null,this.currentShape=null,this.draggingShape=null,this.mousedownPoint=null,this.mousedownShape=null,this.mousedownTimeStamp=null},nr}(),ja=vo,to="px",Uo=(0,wt.qY)(),ju=Uo&&Uo.name==="firefox",Wo=function(nr){(0,Lt.ZT)(xe,nr);function xe(He){var Mr=nr.call(this,He)||this;return Mr.initContainer(),Mr.initDom(),Mr.initEvents(),Mr.initTimeline(),Mr}return xe.prototype.getDefaultCfg=function(){var He=nr.prototype.getDefaultCfg.call(this);return He.cursor="default",He.supportCSSTransform=!1,He},xe.prototype.initContainer=function(){var He=this.get("container");(0,Et.HD)(He)&&(He=document.getElementById(He),this.set("container",He))},xe.prototype.initDom=function(){var He=this.createDom();this.set("el",He);var Mr=this.get("container");Mr.appendChild(He),this.setDOMSize(this.get("width"),this.get("height"))},xe.prototype.initEvents=function(){var He=new ja({canvas:this});He.init(),this.set("eventController",He)},xe.prototype.initTimeline=function(){var He=new Ci(this);this.set("timeline",He)},xe.prototype.setDOMSize=function(He,Mr){var tn=this.get("el");Et.jU&&(tn.style.width=He+to,tn.style.height=Mr+to)},xe.prototype.changeSize=function(He,Mr){this.setDOMSize(He,Mr),this.set("width",He),this.set("height",Mr),this.onCanvasChange("changeSize")},xe.prototype.getRenderer=function(){return this.get("renderer")},xe.prototype.getCursor=function(){return this.get("cursor")},xe.prototype.setCursor=function(He){this.set("cursor",He);var Mr=this.get("el");Et.jU&&Mr&&(Mr.style.cursor=He)},xe.prototype.getPointByEvent=function(He){var Mr=this.get("supportCSSTransform");if(Mr){if(ju&&!(0,Et.kK)(He.layerX)&&He.layerX!==He.offsetX)return{x:He.layerX,y:He.layerY};if(!(0,Et.kK)(He.offsetX))return{x:He.offsetX,y:He.offsetY}}var tn=this.getClientByEvent(He),In=tn.x,Un=tn.y;return this.getPointByClient(In,Un)},xe.prototype.getClientByEvent=function(He){var Mr=He;return He.touches&&(He.type==="touchend"?Mr=He.changedTouches[0]:Mr=He.touches[0]),{x:Mr.clientX,y:Mr.clientY}},xe.prototype.getPointByClient=function(He,Mr){var tn=this.get("el"),In=tn.getBoundingClientRect();return{x:He-In.left,y:Mr-In.top}},xe.prototype.getClientByPoint=function(He,Mr){var tn=this.get("el"),In=tn.getBoundingClientRect();return{x:He+In.left,y:Mr+In.top}},xe.prototype.draw=function(){},xe.prototype.removeDom=function(){var He=this.get("el");He.parentNode.removeChild(He)},xe.prototype.clearEvents=function(){var He=this.get("eventController");He.destroy()},xe.prototype.isCanvas=function(){return!0},xe.prototype.getParent=function(){return null},xe.prototype.destroy=function(){var He=this.get("timeline");this.get("destroyed")||(this.clear(),He&&He.stop(),this.clearEvents(),this.removeDom(),nr.prototype.destroy.call(this))},xe}(I.Z),bo=Wo},37153:function(vn,Ft,ot){"use strict";var Lt=ot(70655),wt=ot(45098),I=ot(29881),Et=ot(77341),q={},lt="_INDEX";function ht(Zt,P){if(Zt.set("canvas",P),Zt.isGroup()){var b=Zt.get("children");b.length&&b.forEach(function(X){ht(X,P)})}}function ct(Zt,P){if(Zt.set("timeline",P),Zt.isGroup()){var b=Zt.get("children");b.length&&b.forEach(function(X){ct(X,P)})}}function et(Zt,P){var b=Zt.getChildren();return b.indexOf(P)>=0}function Ee(Zt,P,b){b===void 0&&(b=!0),b?P.destroy():(P.set("parent",null),P.set("canvas",null)),(0,Et.As)(Zt.getChildren(),P)}function it(Zt){return function(P,b){var X=Zt(P,b);return X===0?P[lt]-b[lt]:X}}var st=function(Zt){(0,Lt.ZT)(P,Zt);function P(){return Zt!==null&&Zt.apply(this,arguments)||this}return P.prototype.isCanvas=function(){return!1},P.prototype.getBBox=function(){var b=1/0,X=-1/0,le=1/0,Se=-1/0,Ie=[],It=[],rt=this.getChildren().filter(function(Ae){return Ae.get("visible")&&(!Ae.isGroup()||Ae.isGroup()&&Ae.getChildren().length>0)});rt.length>0?((0,Et.S6)(rt,function(Ae){var be=Ae.getBBox();Ie.push(be.minX,be.maxX),It.push(be.minY,be.maxY)}),b=(0,wt.VV)(Ie),X=(0,wt.Fp)(Ie),le=(0,wt.VV)(It),Se=(0,wt.Fp)(It)):(b=0,X=0,le=0,Se=0);var Dt={x:b,y:le,minX:b,minY:le,maxX:X,maxY:Se,width:X-b,height:Se-le};return Dt},P.prototype.getCanvasBBox=function(){var b=1/0,X=-1/0,le=1/0,Se=-1/0,Ie=[],It=[],rt=this.getChildren().filter(function(Ae){return Ae.get("visible")&&(!Ae.isGroup()||Ae.isGroup()&&Ae.getChildren().length>0)});rt.length>0?((0,Et.S6)(rt,function(Ae){var be=Ae.getCanvasBBox();Ie.push(be.minX,be.maxX),It.push(be.minY,be.maxY)}),b=(0,wt.VV)(Ie),X=(0,wt.Fp)(Ie),le=(0,wt.VV)(It),Se=(0,wt.Fp)(It)):(b=0,X=0,le=0,Se=0);var Dt={x:b,y:le,minX:b,minY:le,maxX:X,maxY:Se,width:X-b,height:Se-le};return Dt},P.prototype.getDefaultCfg=function(){var b=Zt.prototype.getDefaultCfg.call(this);return b.children=[],b},P.prototype.onAttrChange=function(b,X,le){if(Zt.prototype.onAttrChange.call(this,b,X,le),b==="matrix"){var Se=this.getTotalMatrix();this._applyChildrenMarix(Se)}},P.prototype.applyMatrix=function(b){var X=this.getTotalMatrix();Zt.prototype.applyMatrix.call(this,b);var le=this.getTotalMatrix();le!==X&&this._applyChildrenMarix(le)},P.prototype._applyChildrenMarix=function(b){var X=this.getChildren();(0,Et.S6)(X,function(le){le.applyMatrix(b)})},P.prototype.addShape=function(){for(var b=[],X=0;X<arguments.length;X++)b[X]=arguments[X];var le=b[0],Se=b[1];(0,Et.Kn)(le)?Se=le:Se.type=le;var Ie=q[Se.type];Ie||(Ie=(0,Et.jC)(Se.type),q[Se.type]=Ie);var It=this.getShapeBase(),rt=new It[Ie](Se);return this.add(rt),rt},P.prototype.addGroup=function(){for(var b=[],X=0;X<arguments.length;X++)b[X]=arguments[X];var le=b[0],Se=b[1],Ie;if((0,Et.mf)(le))Se?Ie=new le(Se):Ie=new le({parent:this});else{var It=le||{},rt=this.getGroupBase();Ie=new rt(It)}return this.add(Ie),Ie},P.prototype.getCanvas=function(){var b;return this.isCanvas()?b=this:b=this.get("canvas"),b},P.prototype.getShape=function(b,X,le){if(!(0,Et.pP)(this))return null;var Se=this.getChildren(),Ie;if(this.isCanvas())Ie=this._findShape(Se,b,X,le);else{var It=[b,X,1];It=this.invertFromMatrix(It),this.isClipped(It[0],It[1])||(Ie=this._findShape(Se,It[0],It[1],le))}return Ie},P.prototype._findShape=function(b,X,le,Se){for(var Ie=null,It=b.length-1;It>=0;It--){var rt=b[It];if((0,Et.pP)(rt)&&(rt.isGroup()?Ie=rt.getShape(X,le,Se):rt.isHit(X,le)&&(Ie=rt)),Ie)break}return Ie},P.prototype.add=function(b){var X=this.getCanvas(),le=this.getChildren(),Se=this.get("timeline"),Ie=b.getParent();Ie&&Ee(Ie,b,!1),b.set("parent",this),X&&ht(b,X),Se&&ct(b,Se),le.push(b),b.onCanvasChange("add"),this._applyElementMatrix(b)},P.prototype._applyElementMatrix=function(b){var X=this.getTotalMatrix();X&&b.applyMatrix(X)},P.prototype.getChildren=function(){return this.get("children")},P.prototype.sort=function(){var b=this.getChildren();(0,Et.S6)(b,function(X,le){return X[lt]=le,X}),b.sort(it(function(X,le){return X.get("zIndex")-le.get("zIndex")})),this.onCanvasChange("sort")},P.prototype.clear=function(){if(this.set("clearing",!0),!this.destroyed){for(var b=this.getChildren(),X=b.length-1;X>=0;X--)b[X].destroy();this.set("children",[]),this.onCanvasChange("clear"),this.set("clearing",!1)}},P.prototype.destroy=function(){this.get("destroyed")||(this.clear(),Zt.prototype.destroy.call(this))},P.prototype.getFirst=function(){return this.getChildByIndex(0)},P.prototype.getLast=function(){var b=this.getChildren();return this.getChildByIndex(b.length-1)},P.prototype.getChildByIndex=function(b){var X=this.getChildren();return X[b]},P.prototype.getCount=function(){var b=this.getChildren();return b.length},P.prototype.contain=function(b){var X=this.getChildren();return X.indexOf(b)>-1},P.prototype.removeChild=function(b,X){X===void 0&&(X=!0),this.contain(b)&&b.remove(X)},P.prototype.findAll=function(b){var X=[],le=this.getChildren();return(0,Et.S6)(le,function(Se){b(Se)&&X.push(Se),Se.isGroup()&&(X=X.concat(Se.findAll(b)))}),X},P.prototype.find=function(b){var X=null,le=this.getChildren();return(0,Et.S6)(le,function(Se){if(b(Se)?X=Se:Se.isGroup()&&(X=Se.find(b)),X)return!1}),X},P.prototype.findById=function(b){return this.find(function(X){return X.get("id")===b})},P.prototype.findByClassName=function(b){return this.find(function(X){return X.get("className")===b})},P.prototype.findAllByName=function(b){return this.findAll(function(X){return X.get("name")===b})},P}(I.Z);Ft.Z=st},29881:function(vn,Ft,ot){"use strict";var Lt=ot(70655),wt=ot(45098),I=ot(31506),Et=ot(77341),q=ot(41482),lt=ot(2667),ht=I.vs,ct="matrix",et=["zIndex","capture","visible","type"],Ee=["repeat"],it=":",st="*";function Zt(Se){for(var Ie=[],It=0;It<Se.length;It++)(0,wt.kJ)(Se[It])?Ie.push([].concat(Se[It])):Ie.push(Se[It]);return Ie}function P(Se,Ie){var It={},rt=Ie.attrs;for(var Dt in Se)It[Dt]=rt[Dt];return It}function b(Se,Ie){var It={},rt=Ie.attr();return(0,wt.S6)(Se,function(Dt,Ae){Ee.indexOf(Ae)===-1&&!(0,wt.Xy)(rt[Ae],Dt)&&(It[Ae]=Dt)}),It}function X(Se,Ie){if(Ie.onFrame)return Se;var It=Ie.startTime,rt=Ie.delay,Dt=Ie.duration,Ae=Object.prototype.hasOwnProperty;return(0,wt.S6)(Se,function(be){It+rt<be.startTime+be.delay+be.duration&&Dt>be.delay&&(0,wt.S6)(Ie.toAttrs,function(me,ee){Ae.call(be.toAttrs,ee)&&(delete be.toAttrs[ee],delete be.fromAttrs[ee])})}),Se}var le=function(Se){(0,Lt.ZT)(Ie,Se);function Ie(It){var rt=Se.call(this,It)||this;rt.attrs={};var Dt=rt.getDefaultAttrs();return(0,wt.CD)(Dt,It.attrs),rt.attrs=Dt,rt.initAttrs(Dt),rt.initAnimate(),rt}return Ie.prototype.getDefaultCfg=function(){return{visible:!0,capture:!0,zIndex:0}},Ie.prototype.getDefaultAttrs=function(){return{matrix:this.getDefaultMatrix(),opacity:1}},Ie.prototype.onCanvasChange=function(It){},Ie.prototype.initAttrs=function(It){},Ie.prototype.initAnimate=function(){this.set("animable",!0),this.set("animating",!1)},Ie.prototype.isGroup=function(){return!1},Ie.prototype.getParent=function(){return this.get("parent")},Ie.prototype.getCanvas=function(){return this.get("canvas")},Ie.prototype.attr=function(){for(var It,rt=[],Dt=0;Dt<arguments.length;Dt++)rt[Dt]=arguments[Dt];var Ae=rt[0],be=rt[1];if(!Ae)return this.attrs;if((0,wt.Kn)(Ae)){for(var me in Ae)this.setAttr(me,Ae[me]);return this.afterAttrsChange(Ae),this}return rt.length===2?(this.setAttr(Ae,be),this.afterAttrsChange((It={},It[Ae]=be,It)),this):this.attrs[Ae]},Ie.prototype.isClipped=function(It,rt){var Dt=this.getClip();return Dt&&!Dt.isHit(It,rt)},Ie.prototype.setAttr=function(It,rt){var Dt=this.attrs[It];Dt!==rt&&(this.attrs[It]=rt,this.onAttrChange(It,rt,Dt))},Ie.prototype.onAttrChange=function(It,rt,Dt){It==="matrix"&&this.set("totalMatrix",null)},Ie.prototype.afterAttrsChange=function(It){if(this.cfg.isClipShape){var rt=this.cfg.applyTo;rt&&rt.onCanvasChange("clip")}else this.onCanvasChange("attr")},Ie.prototype.show=function(){return this.set("visible",!0),this.onCanvasChange("show"),this},Ie.prototype.hide=function(){return this.set("visible",!1),this.onCanvasChange("hide"),this},Ie.prototype.setZIndex=function(It){this.set("zIndex",It);var rt=this.getParent();return rt&&rt.sort(),this},Ie.prototype.toFront=function(){var It=this.getParent();if(!!It){var rt=It.getChildren(),Dt=this.get("el"),Ae=rt.indexOf(this);rt.splice(Ae,1),rt.push(this),this.onCanvasChange("zIndex")}},Ie.prototype.toBack=function(){var It=this.getParent();if(!!It){var rt=It.getChildren(),Dt=this.get("el"),Ae=rt.indexOf(this);rt.splice(Ae,1),rt.unshift(this),this.onCanvasChange("zIndex")}},Ie.prototype.remove=function(It){It===void 0&&(It=!0);var rt=this.getParent();rt?((0,Et.As)(rt.getChildren(),this),rt.get("clearing")||this.onCanvasChange("remove")):this.onCanvasChange("remove"),It&&this.destroy()},Ie.prototype.resetMatrix=function(){this.attr(ct,this.getDefaultMatrix()),this.onCanvasChange("matrix")},Ie.prototype.getMatrix=function(){return this.attr(ct)},Ie.prototype.setMatrix=function(It){this.attr(ct,It),this.onCanvasChange("matrix")},Ie.prototype.getTotalMatrix=function(){var It=this.cfg.totalMatrix;if(!It){var rt=this.attr("matrix"),Dt=this.cfg.parentMatrix;Dt&&rt?It=(0,q.xq)(Dt,rt):It=rt||Dt,this.set("totalMatrix",It)}return It},Ie.prototype.applyMatrix=function(It){var rt=this.attr("matrix"),Dt=null;It&&rt?Dt=(0,q.xq)(It,rt):Dt=rt||It,this.set("totalMatrix",Dt),this.set("parentMatrix",It)},Ie.prototype.getDefaultMatrix=function(){return null},Ie.prototype.applyToMatrix=function(It){var rt=this.attr("matrix");return rt?(0,q.rG)(rt,It):It},Ie.prototype.invertFromMatrix=function(It){var rt=this.attr("matrix");if(rt){var Dt=(0,q.U_)(rt);if(Dt)return(0,q.rG)(Dt,It)}return It},Ie.prototype.setClip=function(It){var rt=this.getCanvas(),Dt=null;if(It){var Ae=this.getShapeBase(),be=(0,wt.jC)(It.type),me=Ae[be];me&&(Dt=new me({type:It.type,isClipShape:!0,applyTo:this,attrs:It.attrs,canvas:rt}))}return this.set("clipShape",Dt),this.onCanvasChange("clip"),Dt},Ie.prototype.getClip=function(){var It=this.cfg.clipShape;return It||null},Ie.prototype.clone=function(){var It=this,rt=this.attrs,Dt={};(0,wt.S6)(rt,function(me,ee){(0,wt.kJ)(rt[ee])?Dt[ee]=Zt(rt[ee]):Dt[ee]=rt[ee]});var Ae=this.constructor,be=new Ae({attrs:Dt});return(0,wt.S6)(et,function(me){be.set(me,It.get(me))}),be},Ie.prototype.destroy=function(){var It=this.destroyed;It||(this.attrs={},Se.prototype.destroy.call(this))},Ie.prototype.isAnimatePaused=function(){return this.get("_pause").isPaused},Ie.prototype.animate=function(){for(var It=[],rt=0;rt<arguments.length;rt++)It[rt]=arguments[rt];if(!(!this.get("timeline")&&!this.get("canvas"))){this.set("animating",!0);var Dt=this.get("timeline");Dt||(Dt=this.get("canvas").get("timeline"),this.set("timeline",Dt));var Ae=this.get("animations")||[];Dt.timer||Dt.initTimer();var be=It[0],me=It[1],ee=It[2],we=ee===void 0?"easeLinear":ee,_e=It[3],gt=_e===void 0?wt.ZT:_e,Pt=It[4],J=Pt===void 0?0:Pt,vt,W,dt,Vt,ne;(0,wt.mf)(be)?(vt=be,be={}):(0,wt.Kn)(be)&&be.onFrame&&(vt=be.onFrame,W=be.repeat),(0,wt.Kn)(me)?(ne=me,me=ne.duration,we=ne.easing||"easeLinear",J=ne.delay||0,W=ne.repeat||W||!1,gt=ne.callback||wt.ZT,dt=ne.pauseCallback||wt.ZT,Vt=ne.resumeCallback||wt.ZT):((0,wt.hj)(gt)&&(J=gt,gt=null),(0,wt.mf)(we)?(gt=we,we="easeLinear"):we=we||"easeLinear");var ge=b(be,this),$e={fromAttrs:P(ge,this),toAttrs:ge,duration:me,easing:we,repeat:W,callback:gt,pauseCallback:dt,resumeCallback:Vt,delay:J,startTime:Dt.getTime(),id:(0,wt.EL)(),onFrame:vt,pathFormatted:!1};Ae.length>0?Ae=X(Ae,$e):Dt.addAnimator(this),Ae.push($e),this.set("animations",Ae),this.set("_pause",{isPaused:!1})}},Ie.prototype.stopAnimate=function(It){var rt=this;It===void 0&&(It=!0);var Dt=this.get("animations");(0,wt.S6)(Dt,function(Ae){It&&(Ae.onFrame?rt.attr(Ae.onFrame(1)):rt.attr(Ae.toAttrs)),Ae.callback&&Ae.callback()}),this.set("animating",!1),this.set("animations",[])},Ie.prototype.pauseAnimate=function(){var It=this.get("timeline"),rt=this.get("animations"),Dt=It.getTime();return(0,wt.S6)(rt,function(Ae){Ae._paused=!0,Ae._pauseTime=Dt,Ae.pauseCallback&&Ae.pauseCallback()}),this.set("_pause",{isPaused:!0,pauseTime:Dt}),this},Ie.prototype.resumeAnimate=function(){var It=this.get("timeline"),rt=It.getTime(),Dt=this.get("animations"),Ae=this.get("_pause").pauseTime;return(0,wt.S6)(Dt,function(be){be.startTime=be.startTime+(rt-Ae),be._paused=!1,be._pauseTime=null,be.resumeCallback&&be.resumeCallback()}),this.set("_pause",{isPaused:!1}),this.set("animations",Dt),this},Ie.prototype.emitDelegation=function(It,rt){var Dt=this,Ae=rt.propagationPath,be=this.getEvents(),me;It==="mouseenter"?me=rt.fromShape:It==="mouseleave"&&(me=rt.toShape);for(var ee=function(Pt){var J=Ae[Pt],vt=J.get("name");if(vt){if((J.isGroup()||J.isCanvas&&J.isCanvas())&&me&&(0,Et.UY)(J,me))return"break";(0,wt.kJ)(vt)?(0,wt.S6)(vt,function(W){Dt.emitDelegateEvent(J,W,rt)}):we.emitDelegateEvent(J,vt,rt)}},we=this,_e=0;_e<Ae.length;_e++){var gt=ee(_e);if(gt==="break")break}},Ie.prototype.emitDelegateEvent=function(It,rt,Dt){var Ae=this.getEvents(),be=rt+it+Dt.type;(Ae[be]||Ae[st])&&(Dt.name=be,Dt.currentTarget=It,Dt.delegateTarget=this,Dt.delegateObject=It.get("delegateObject"),this.emit(be,Dt))},Ie.prototype.translate=function(It,rt){It===void 0&&(It=0),rt===void 0&&(rt=0);var Dt=this.getMatrix(),Ae=ht(Dt,[["t",It,rt]]);return this.setMatrix(Ae),this},Ie.prototype.move=function(It,rt){var Dt=this.attr("x")||0,Ae=this.attr("y")||0;return this.translate(It-Dt,rt-Ae),this},Ie.prototype.moveTo=function(It,rt){return this.move(It,rt)},Ie.prototype.scale=function(It,rt){var Dt=this.getMatrix(),Ae=ht(Dt,[["s",It,rt||It]]);return this.setMatrix(Ae),this},Ie.prototype.rotate=function(It){var rt=this.getMatrix(),Dt=ht(rt,[["r",It]]);return this.setMatrix(Dt),this},Ie.prototype.rotateAtStart=function(It){var rt=this.attr(),Dt=rt.x,Ae=rt.y,be=this.getMatrix(),me=ht(be,[["t",-Dt,-Ae],["r",It],["t",Dt,Ae]]);return this.setMatrix(me),this},Ie.prototype.rotateAtPoint=function(It,rt,Dt){var Ae=this.getMatrix(),be=ht(Ae,[["t",-It,-rt],["r",Dt],["t",It,rt]]);return this.setMatrix(be),this},Ie}(lt.Z);Ft.Z=le},31841:function(vn,Ft,ot){"use strict";var Lt=ot(70655),wt=ot(37153),I=function(Et){(0,Lt.ZT)(q,Et);function q(){return Et!==null&&Et.apply(this,arguments)||this}return q.prototype.isGroup=function(){return!0},q.prototype.isEntityGroup=function(){return!1},q.prototype.clone=function(){for(var lt=Et.prototype.clone.call(this),ht=this.getChildren(),ct=0;ct<ht.length;ct++){var et=ht[ct];lt.add(et.clone())}return lt},q}(wt.Z);Ft.Z=I},15032:function(vn,Ft,ot){"use strict";var Lt=ot(70655),wt=ot(29881),I=ot(41482),Et=function(q){(0,Lt.ZT)(lt,q);function lt(ht){return q.call(this,ht)||this}return lt.prototype._isInBBox=function(ht,ct){var et=this.getBBox();return et.minX<=ht&&et.maxX>=ht&&et.minY<=ct&&et.maxY>=ct},lt.prototype.afterAttrsChange=function(ht){q.prototype.afterAttrsChange.call(this,ht),this.clearCacheBBox()},lt.prototype.getBBox=function(){var ht=this.cfg.bbox;return ht||(ht=this.calculateBBox(),this.set("bbox",ht)),ht},lt.prototype.getCanvasBBox=function(){var ht=this.cfg.canvasBBox;return ht||(ht=this.calculateCanvasBBox(),this.set("canvasBBox",ht)),ht},lt.prototype.applyMatrix=function(ht){q.prototype.applyMatrix.call(this,ht),this.set("canvasBBox",null)},lt.prototype.calculateCanvasBBox=function(){var ht=this.getBBox(),ct=this.getTotalMatrix(),et=ht.minX,Ee=ht.minY,it=ht.maxX,st=ht.maxY;if(ct){var Zt=(0,I.rG)(ct,[ht.minX,ht.minY]),P=(0,I.rG)(ct,[ht.maxX,ht.minY]),b=(0,I.rG)(ct,[ht.minX,ht.maxY]),X=(0,I.rG)(ct,[ht.maxX,ht.maxY]);et=Math.min(Zt[0],P[0],b[0],X[0]),it=Math.max(Zt[0],P[0],b[0],X[0]),Ee=Math.min(Zt[1],P[1],b[1],X[1]),st=Math.max(Zt[1],P[1],b[1],X[1])}var le=this.attrs;if(le.shadowColor){var Se=le.shadowBlur,Ie=Se===void 0?0:Se,It=le.shadowOffsetX,rt=It===void 0?0:It,Dt=le.shadowOffsetY,Ae=Dt===void 0?0:Dt,be=et-Ie+rt,me=it+Ie+rt,ee=Ee-Ie+Ae,we=st+Ie+Ae;et=Math.min(et,be),it=Math.max(it,me),Ee=Math.min(Ee,ee),st=Math.max(st,we)}return{x:et,y:Ee,minX:et,minY:Ee,maxX:it,maxY:st,width:it-et,height:st-Ee}},lt.prototype.clearCacheBBox=function(){this.set("bbox",null),this.set("canvasBBox",null)},lt.prototype.isClipShape=function(){return this.get("isClipShape")},lt.prototype.isInShape=function(ht,ct){return!1},lt.prototype.isOnlyHitBox=function(){return!1},lt.prototype.isHit=function(ht,ct){var et=this.get("startArrowShape"),Ee=this.get("endArrowShape"),it=[ht,ct,1];it=this.invertFromMatrix(it);var st=it[0],Zt=it[1],P=this._isInBBox(st,Zt);return this.isOnlyHitBox()?P:!!(P&&!this.isClipped(st,Zt)&&(this.isInShape(st,Zt)||et&&et.isHit(st,Zt)||Ee&&Ee.isHit(st,Zt)))},lt}(wt.Z);Ft.Z=Et},93924:function(vn,Ft,ot){"use strict";ot.d(Ft,{_:function(){return $t},C:function(){return Ct}});var Lt={};ot.r(Lt),ot.d(Lt,{easeBack:function(){return Te},easeBackIn:function(){return jt},easeBackInOut:function(){return Te},easeBackOut:function(){return Qt},easeBounce:function(){return ne},easeBounceIn:function(){return Vt},easeBounceInOut:function(){return ge},easeBounceOut:function(){return ne},easeCircle:function(){return be},easeCircleIn:function(){return Dt},easeCircleInOut:function(){return be},easeCircleOut:function(){return Ae},easeCubic:function(){return ct},easeCubicIn:function(){return lt},easeCubicInOut:function(){return ct},easeCubicOut:function(){return ht},easeElastic:function(){return te},easeElasticIn:function(){return ie},easeElasticInOut:function(){return St},easeElasticOut:function(){return te},easeExp:function(){return rt},easeExpIn:function(){return Ie},easeExpInOut:function(){return rt},easeExpOut:function(){return It},easeLinear:function(){return wt},easePoly:function(){return st},easePolyIn:function(){return Ee},easePolyInOut:function(){return st},easePolyOut:function(){return it},easeQuad:function(){return q},easeQuadIn:function(){return I},easeQuadInOut:function(){return q},easeQuadOut:function(){return Et},easeSin:function(){return le},easeSinIn:function(){return b},easeSinInOut:function(){return le},easeSinOut:function(){return X}});function wt(Tt){return+Tt}function I(Tt){return Tt*Tt}function Et(Tt){return Tt*(2-Tt)}function q(Tt){return((Tt*=2)<=1?Tt*Tt:--Tt*(2-Tt)+1)/2}function lt(Tt){return Tt*Tt*Tt}function ht(Tt){return--Tt*Tt*Tt+1}function ct(Tt){return((Tt*=2)<=1?Tt*Tt*Tt:(Tt-=2)*Tt*Tt+2)/2}var et=3,Ee=function Tt(ue){ue=+ue;function Oe(We){return Math.pow(We,ue)}return Oe.exponent=Tt,Oe}(et),it=function Tt(ue){ue=+ue;function Oe(We){return 1-Math.pow(1-We,ue)}return Oe.exponent=Tt,Oe}(et),st=function Tt(ue){ue=+ue;function Oe(We){return((We*=2)<=1?Math.pow(We,ue):2-Math.pow(2-We,ue))/2}return Oe.exponent=Tt,Oe}(et),Zt=Math.PI,P=Zt/2;function b(Tt){return+Tt==1?1:1-Math.cos(Tt*P)}function X(Tt){return Math.sin(Tt*P)}function le(Tt){return(1-Math.cos(Zt*Tt))/2}function Se(Tt){return(Math.pow(2,-10*Tt)-.0009765625)*1.0009775171065494}function Ie(Tt){return Se(1-+Tt)}function It(Tt){return 1-Se(Tt)}function rt(Tt){return((Tt*=2)<=1?Se(1-Tt):2-Se(Tt-1))/2}function Dt(Tt){return 1-Math.sqrt(1-Tt*Tt)}function Ae(Tt){return Math.sqrt(1- --Tt*Tt)}function be(Tt){return((Tt*=2)<=1?1-Math.sqrt(1-Tt*Tt):Math.sqrt(1-(Tt-=2)*Tt)+1)/2}var me=4/11,ee=6/11,we=8/11,_e=3/4,gt=9/11,Pt=10/11,J=15/16,vt=21/22,W=63/64,dt=1/me/me;function Vt(Tt){return 1-ne(1-Tt)}function ne(Tt){return(Tt=+Tt)<me?dt*Tt*Tt:Tt<we?dt*(Tt-=ee)*Tt+_e:Tt<Pt?dt*(Tt-=gt)*Tt+J:dt*(Tt-=vt)*Tt+W}function ge(Tt){return((Tt*=2)<=1?1-ne(1-Tt):ne(Tt-1)+1)/2}var $e=1.70158,jt=function Tt(ue){ue=+ue;function Oe(We){return(We=+We)*We*(ue*(We-1)+We)}return Oe.overshoot=Tt,Oe}($e),Qt=function Tt(ue){ue=+ue;function Oe(We){return--We*We*((We+1)*ue+We)+1}return Oe.overshoot=Tt,Oe}($e),Te=function Tt(ue){ue=+ue;function Oe(We){return((We*=2)<1?We*We*((ue+1)*We-ue):(We-=2)*We*((ue+1)*We+ue)+2)/2}return Oe.overshoot=Tt,Oe}($e),ae=2*Math.PI,Ke=1,or=.3,ie=function Tt(ue,Oe){var We=Math.asin(1/(ue=Math.max(1,ue)))*(Oe/=ae);function zt(At){return ue*Se(- --At)*Math.sin((We-At)/Oe)}return zt.amplitude=function(At){return Tt(At,Oe*ae)},zt.period=function(At){return Tt(ue,At)},zt}(Ke,or),te=function Tt(ue,Oe){var We=Math.asin(1/(ue=Math.max(1,ue)))*(Oe/=ae);function zt(At){return 1-ue*Se(At=+At)*Math.sin((At+We)/Oe)}return zt.amplitude=function(At){return Tt(At,Oe*ae)},zt.period=function(At){return Tt(ue,At)},zt}(Ke,or),St=function Tt(ue,Oe){var We=Math.asin(1/(ue=Math.max(1,ue)))*(Oe/=ae);function zt(At){return((At=At*2-1)<0?ue*Se(-At)*Math.sin((We-At)/Oe):2-ue*Se(At)*Math.sin((We+At)/Oe))/2}return zt.amplitude=function(At){return Tt(At,Oe*ae)},zt.period=function(At){return Tt(ue,At)},zt}(Ke,or),qt={};function $t(Tt){return qt[Tt.toLowerCase()]||Lt[Tt]}function Ct(Tt,ue){qt[Tt.toLowerCase()]=ue}},46556:function(vn,Ft,ot){"use strict";ot.d(Ft,{b:function(){return I},W:function(){return wt}});var Lt=new Map;function wt(It,rt){Lt.set(It,rt)}function I(It){return Lt.get(It)}function Et(It){var rt=It.attr(),Dt=rt.x,Ae=rt.y,be=rt.width,me=rt.height;return{x:Dt,y:Ae,width:be,height:me}}function q(It){var rt=It.attr(),Dt=rt.x,Ae=rt.y,be=rt.r;return{x:Dt-be,y:Ae-be,width:be*2,height:be*2}}var lt=ot(32793);function ht(It,rt){return!It||!rt?It||rt:{minX:Math.min(It.minX,rt.minX),minY:Math.min(It.minY,rt.minY),maxX:Math.max(It.maxX,rt.maxX),maxY:Math.max(It.maxY,rt.maxY)}}function ct(It,rt){var Dt=It.get("startArrowShape"),Ae=It.get("endArrowShape"),be=null,me=null;return Dt&&(be=Dt.getCanvasBBox(),rt=ht(rt,be)),Ae&&(me=Ae.getCanvasBBox(),rt=ht(rt,me)),rt}function et(It){for(var rt=It.attr(),Dt=rt.points,Ae=[],be=[],me=0;me<Dt.length;me++){var ee=Dt[me];Ae.push(ee[0]),be.push(ee[1])}var we=lt.Zr.getBBoxByArray(Ae,be),_e=we.x,gt=we.y,Pt=we.width,J=we.height,vt={minX:_e,minY:gt,maxX:_e+Pt,maxY:gt+J};return vt=ct(It,vt),{x:vt.minX,y:vt.minY,width:vt.maxX-vt.minX,height:vt.maxY-vt.minY}}function Ee(It){for(var rt=It.attr(),Dt=rt.points,Ae=[],be=[],me=0;me<Dt.length;me++){var ee=Dt[me];Ae.push(ee[0]),be.push(ee[1])}return lt.Zr.getBBoxByArray(Ae,be)}var it=ot(8723);function st(It){var rt=It.attr(),Dt=rt.x,Ae=rt.y,be=rt.text,me=rt.fontSize,ee=rt.lineHeight,we=rt.font;we||(we=(0,it.$O)(rt));var _e=(0,it.mY)(be,we),gt;if(!_e)gt={x:Dt,y:Ae,width:0,height:0};else{var Pt=rt.textAlign,J=rt.textBaseline,vt=(0,it.FE)(be,me,ee),W={x:Dt,y:Ae-vt};Pt&&(Pt==="end"||Pt==="right"?W.x-=_e:Pt==="center"&&(W.x-=_e/2)),J&&(J==="top"?W.y+=vt:J==="middle"&&(W.y+=vt/2)),gt={x:W.x,y:W.y,width:_e,height:vt}}return gt}var Zt=ot(39499),P=ot(45098);function b(It,rt){for(var Dt=[],Ae=[],be=[],me=0;me<It.length;me++){var ee=It[me],we=ee.currentPoint,_e=ee.params,gt=ee.prePoint,Pt=void 0;switch(ee.command){case"Q":Pt=lt.lD.box(gt[0],gt[1],_e[1],_e[2],_e[3],_e[4]);break;case"C":Pt=lt.Ll.box(gt[0],gt[1],_e[1],_e[2],_e[3],_e[4],_e[5],_e[6]);break;case"A":var J=ee.arcParams;Pt=lt.wN.box(J.cx,J.cy,J.rx,J.ry,J.xRotation,J.startAngle,J.endAngle);break;default:Dt.push(we[0]),Ae.push(we[1]);break}Pt&&(ee.box=Pt,Dt.push(Pt.x,Pt.x+Pt.width),Ae.push(Pt.y,Pt.y+Pt.height)),rt&&(ee.command==="L"||ee.command==="M")&&ee.prePoint&&ee.nextPoint&&be.push(ee)}Dt=Dt.filter(function(ge){return!Number.isNaN(ge)&&ge!==1/0&&ge!==-1/0}),Ae=Ae.filter(function(ge){return!Number.isNaN(ge)&&ge!==1/0&&ge!==-1/0});var vt=(0,P.VV)(Dt),W=(0,P.VV)(Ae),dt=(0,P.Fp)(Dt),Vt=(0,P.Fp)(Ae);if(be.length===0)return{x:vt,y:W,width:dt-vt,height:Vt-W};for(var me=0;me<be.length;me++){var ee=be[me],we=ee.currentPoint,ne=void 0;we[0]===vt?(ne=X(ee,rt),vt=vt-ne.xExtra):we[0]===dt&&(ne=X(ee,rt),dt=dt+ne.xExtra),we[1]===W?(ne=X(ee,rt),W=W-ne.yExtra):we[1]===Vt&&(ne=X(ee,rt),Vt=Vt+ne.yExtra)}return{x:vt,y:W,width:dt-vt,height:Vt-W}}function X(It,rt){var Dt=It.prePoint,Ae=It.currentPoint,be=It.nextPoint,me=Math.pow(Ae[0]-Dt[0],2)+Math.pow(Ae[1]-Dt[1],2),ee=Math.pow(Ae[0]-be[0],2)+Math.pow(Ae[1]-be[1],2),we=Math.pow(Dt[0]-be[0],2)+Math.pow(Dt[1]-be[1],2),_e=Math.acos((me+ee-we)/(2*Math.sqrt(me)*Math.sqrt(ee)));if(!_e||Math.sin(_e)===0||(0,P.vQ)(_e,0))return{xExtra:0,yExtra:0};var gt=Math.abs(Math.atan2(be[1]-Ae[1],be[0]-Ae[0])),Pt=Math.abs(Math.atan2(be[0]-Ae[0],be[1]-Ae[1]));gt=gt>Math.PI/2?Math.PI-gt:gt,Pt=Pt>Math.PI/2?Math.PI-Pt:Pt;var J={xExtra:Math.cos(_e/2-gt)*(rt/2*(1/Math.sin(_e/2)))-rt/2||0,yExtra:Math.cos(Pt-_e/2)*(rt/2*(1/Math.sin(_e/2)))-rt/2||0};return J}function le(It){var rt=It.attr(),Dt=rt.path,Ae=rt.stroke,be=Ae?rt.lineWidth:0,me=It.get("segments")||(0,Zt.zx)(Dt),ee=b(me,be),we=ee.x,_e=ee.y,gt=ee.width,Pt=ee.height,J={minX:we,minY:_e,maxX:we+gt,maxY:_e+Pt};return J=ct(It,J),{x:J.minX,y:J.minY,width:J.maxX-J.minX,height:J.maxY-J.minY}}function Se(It){var rt=It.attr(),Dt=rt.x1,Ae=rt.y1,be=rt.x2,me=rt.y2,ee=Math.min(Dt,be),we=Math.max(Dt,be),_e=Math.min(Ae,me),gt=Math.max(Ae,me),Pt={minX:ee,maxX:we,minY:_e,maxY:gt};return Pt=ct(It,Pt),{x:Pt.minX,y:Pt.minY,width:Pt.maxX-Pt.minX,height:Pt.maxY-Pt.minY}}function Ie(It){var rt=It.attr(),Dt=rt.x,Ae=rt.y,be=rt.rx,me=rt.ry;return{x:Dt-be,y:Ae-me,width:be*2,height:me*2}}wt("rect",Et),wt("image",Et),wt("circle",q),wt("marker",q),wt("polyline",et),wt("polygon",Ee),wt("text",st),wt("path",le),wt("line",Se),wt("ellipse",Ie)},89473:function(vn,Ft){"use strict";var ot=function(){function Lt(wt,I){this.bubbles=!0,this.target=null,this.currentTarget=null,this.delegateTarget=null,this.delegateObject=null,this.defaultPrevented=!1,this.propagationStopped=!1,this.shape=null,this.fromShape=null,this.toShape=null,this.propagationPath=[],this.type=wt,this.name=wt,this.originalEvent=I,this.timeStamp=I.timeStamp}return Lt.prototype.preventDefault=function(){this.defaultPrevented=!0,this.originalEvent.preventDefault&&this.originalEvent.preventDefault()},Lt.prototype.stopPropagation=function(){this.propagationStopped=!0},Lt.prototype.toString=function(){var wt=this.type;return"[Event (type="+wt+")]"},Lt.prototype.save=function(){},Lt.prototype.restore=function(){},Lt}();Ft.Z=ot},98190:function(vn,Ft,ot){"use strict";ot.r(Ft),ot.d(Ft,{AbstractCanvas:function(){return Ee.Z},AbstractGroup:function(){return it.Z},AbstractShape:function(){return st.Z},Base:function(){return et.Z},Event:function(){return ct.Z},PathUtil:function(){return Lt},assembleFont:function(){return P.$O},getBBoxMethod:function(){return Zt.b},getOffScreenContext:function(){return le.L},getTextHeight:function(){return P.FE},invert:function(){return X.U_},isAllowCapture:function(){return b.pP},multiplyVec2:function(){return X.rG},registerBBox:function(){return Zt.W},registerEasing:function(){return Se.C},version:function(){return Ie}});var Lt=ot(47575),wt=ot(52),I=ot.n(wt),ht={};for(var Et in wt)["default","Event","Base","AbstractCanvas","AbstractGroup","AbstractShape","PathUtil","getBBoxMethod","registerBBox","getTextHeight","assembleFont","isAllowCapture","multiplyVec2","invert","getOffScreenContext","registerEasing","version"].indexOf(Et)<0&&(ht[Et]=function(It){return wt[It]}.bind(0,Et));ot.d(Ft,ht);var q=ot(15294),lt=ot.n(q),ht={};for(var Et in q)["default","Event","Base","AbstractCanvas","AbstractGroup","AbstractShape","PathUtil","getBBoxMethod","registerBBox","getTextHeight","assembleFont","isAllowCapture","multiplyVec2","invert","getOffScreenContext","registerEasing","version"].indexOf(Et)<0&&(ht[Et]=function(rt){return q[rt]}.bind(0,Et));ot.d(Ft,ht);var ct=ot(89473),et=ot(2667),Ee=ot(2840),it=ot(31841),st=ot(15032),Zt=ot(46556),P=ot(8723),b=ot(77341),X=ot(41482),le=ot(67052),Se=ot(93924),Ie="0.5.11"},15294:function(){},52:function(){},41482:function(vn,Ft,ot){"use strict";ot.d(Ft,{U_:function(){return I},rG:function(){return wt},xq:function(){return Lt}});function Lt(Et,q){var lt=[],ht=Et[0],ct=Et[1],et=Et[2],Ee=Et[3],it=Et[4],st=Et[5],Zt=Et[6],P=Et[7],b=Et[8],X=q[0],le=q[1],Se=q[2],Ie=q[3],It=q[4],rt=q[5],Dt=q[6],Ae=q[7],be=q[8];return lt[0]=X*ht+le*Ee+Se*Zt,lt[1]=X*ct+le*it+Se*P,lt[2]=X*et+le*st+Se*b,lt[3]=Ie*ht+It*Ee+rt*Zt,lt[4]=Ie*ct+It*it+rt*P,lt[5]=Ie*et+It*st+rt*b,lt[6]=Dt*ht+Ae*Ee+be*Zt,lt[7]=Dt*ct+Ae*it+be*P,lt[8]=Dt*et+Ae*st+be*b,lt}function wt(Et,q){var lt=[],ht=q[0],ct=q[1];return lt[0]=Et[0]*ht+Et[3]*ct+Et[6],lt[1]=Et[1]*ht+Et[4]*ct+Et[7],lt}function I(Et){var q=[],lt=Et[0],ht=Et[1],ct=Et[2],et=Et[3],Ee=Et[4],it=Et[5],st=Et[6],Zt=Et[7],P=Et[8],b=P*Ee-it*Zt,X=-P*et+it*st,le=Zt*et-Ee*st,Se=lt*b+ht*X+ct*le;return Se?(Se=1/Se,q[0]=b*Se,q[1]=(-P*ht+ct*Zt)*Se,q[2]=(it*ht-ct*Ee)*Se,q[3]=X*Se,q[4]=(P*lt-ct*st)*Se,q[5]=(-it*lt+ct*et)*Se,q[6]=le*Se,q[7]=(-Zt*lt+ht*st)*Se,q[8]=(Ee*lt-ht*et)*Se,q):null}},67052:function(vn,Ft,ot){"use strict";ot.d(Ft,{L:function(){return wt}});var Lt=null;function wt(){if(!Lt){var I=document.createElement("canvas");I.width=1,I.height=1,Lt=I.getContext("2d")}return Lt}},47575:function(vn,Ft,ot){"use strict";ot.r(Ft),ot.d(Ft,{catmullRomToBezier:function(){return lt},fillPath:function(){return J},fillPathByDiff:function(){return Vt},formatPath:function(){return $e},intersection:function(){return we},parsePathArray:function(){return P},parsePathString:function(){return q},pathToAbsolute:function(){return ct},pathToCurve:function(){return st},rectPath:function(){return It}});var Lt=ot(45098),wt=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,I=new RegExp("([a-z])["+wt+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+wt+"]*,?["+wt+"]*)+)","ig"),Et=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+wt+"]*,?["+wt+"]*","ig"),q=function(jt){if(!jt)return null;if((0,Lt.kJ)(jt))return jt;var Qt={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},Te=[];return String(jt).replace(I,function(ae,Ke,or){var ie=[],te=Ke.toLowerCase();if(or.replace(Et,function(St,qt){qt&&ie.push(+qt)}),te==="m"&&ie.length>2&&(Te.push([Ke].concat(ie.splice(0,2))),te="l",Ke=Ke==="m"?"l":"L"),te==="o"&&ie.length===1&&Te.push([Ke,ie[0]]),te==="r")Te.push([Ke].concat(ie));else for(;ie.length>=Qt[te]&&(Te.push([Ke].concat(ie.splice(0,Qt[te]))),!!Qt[te]););return jt}),Te},lt=function(jt,Qt){for(var Te=[],ae=0,Ke=jt.length;Ke-2*!Qt>ae;ae+=2){var or=[{x:+jt[ae-2],y:+jt[ae-1]},{x:+jt[ae],y:+jt[ae+1]},{x:+jt[ae+2],y:+jt[ae+3]},{x:+jt[ae+4],y:+jt[ae+5]}];Qt?ae?Ke-4===ae?or[3]={x:+jt[0],y:+jt[1]}:Ke-2===ae&&(or[2]={x:+jt[0],y:+jt[1]},or[3]={x:+jt[2],y:+jt[3]}):or[0]={x:+jt[Ke-2],y:+jt[Ke-1]}:Ke-4===ae?or[3]=or[2]:ae||(or[0]={x:+jt[ae],y:+jt[ae+1]}),Te.push(["C",(-or[0].x+6*or[1].x+or[2].x)/6,(-or[0].y+6*or[1].y+or[2].y)/6,(or[1].x+6*or[2].x-or[3].x)/6,(or[1].y+6*or[2].y-or[3].y)/6,or[2].x,or[2].y])}return Te},ht=function(jt,Qt,Te,ae,Ke){var or=[];if(Ke===null&&ae===null&&(ae=Te),jt=+jt,Qt=+Qt,Te=+Te,ae=+ae,Ke!==null){var ie=Math.PI/180,te=jt+Te*Math.cos(-ae*ie),St=jt+Te*Math.cos(-Ke*ie),qt=Qt+Te*Math.sin(-ae*ie),$t=Qt+Te*Math.sin(-Ke*ie);or=[["M",te,qt],["A",Te,Te,0,+(Ke-ae>180),0,St,$t]]}else or=[["M",jt,Qt],["m",0,-ae],["a",Te,ae,0,1,1,0,2*ae],["a",Te,ae,0,1,1,0,-2*ae],["z"]];return or},ct=function(jt){if(jt=q(jt),!jt||!jt.length)return[["M",0,0]];var Qt=[],Te=0,ae=0,Ke=0,or=0,ie=0,te,St;jt[0][0]==="M"&&(Te=+jt[0][1],ae=+jt[0][2],Ke=Te,or=ae,ie++,Qt[0]=["M",Te,ae]);for(var qt=jt.length===3&&jt[0][0]==="M"&&jt[1][0].toUpperCase()==="R"&&jt[2][0].toUpperCase()==="Z",$t=void 0,Ct=void 0,Tt=ie,ue=jt.length;Tt<ue;Tt++){if(Qt.push($t=[]),Ct=jt[Tt],te=Ct[0],te!==te.toUpperCase())switch($t[0]=te.toUpperCase(),$t[0]){case"A":$t[1]=Ct[1],$t[2]=Ct[2],$t[3]=Ct[3],$t[4]=Ct[4],$t[5]=Ct[5],$t[6]=+Ct[6]+Te,$t[7]=+Ct[7]+ae;break;case"V":$t[1]=+Ct[1]+ae;break;case"H":$t[1]=+Ct[1]+Te;break;case"R":St=[Te,ae].concat(Ct.slice(1));for(var Oe=2,We=St.length;Oe<We;Oe++)St[Oe]=+St[Oe]+Te,St[++Oe]=+St[Oe]+ae;Qt.pop(),Qt=Qt.concat(lt(St,qt));break;case"O":Qt.pop(),St=ht(Te,ae,Ct[1],Ct[2]),St.push(St[0]),Qt=Qt.concat(St);break;case"U":Qt.pop(),Qt=Qt.concat(ht(Te,ae,Ct[1],Ct[2],Ct[3])),$t=["U"].concat(Qt[Qt.length-1].slice(-2));break;case"M":Ke=+Ct[1]+Te,or=+Ct[2]+ae;break;default:for(var Oe=1,We=Ct.length;Oe<We;Oe++)$t[Oe]=+Ct[Oe]+(Oe%2?Te:ae)}else if(te==="R")St=[Te,ae].concat(Ct.slice(1)),Qt.pop(),Qt=Qt.concat(lt(St,qt)),$t=["R"].concat(Ct.slice(-2));else if(te==="O")Qt.pop(),St=ht(Te,ae,Ct[1],Ct[2]),St.push(St[0]),Qt=Qt.concat(St);else if(te==="U")Qt.pop(),Qt=Qt.concat(ht(Te,ae,Ct[1],Ct[2],Ct[3])),$t=["U"].concat(Qt[Qt.length-1].slice(-2));else for(var zt=0,At=Ct.length;zt<At;zt++)$t[zt]=Ct[zt];if(te=te.toUpperCase(),te!=="O")switch($t[0]){case"Z":Te=+Ke,ae=+or;break;case"H":Te=$t[1];break;case"V":ae=$t[1];break;case"M":Ke=$t[$t.length-2],or=$t[$t.length-1];break;default:Te=$t[$t.length-2],ae=$t[$t.length-1]}}return Qt},et=function(jt,Qt,Te,ae){return[jt,Qt,Te,ae,Te,ae]},Ee=function(jt,Qt,Te,ae,Ke,or){var ie=.3333333333333333,te=2/3;return[ie*jt+te*Te,ie*Qt+te*ae,ie*Ke+te*Te,ie*or+te*ae,Ke,or]},it=function(jt,Qt,Te,ae,Ke,or,ie,te,St,qt){Te===ae&&(Te+=1);var $t=Math.PI*120/180,Ct=Math.PI/180*(+Ke||0),Tt=[],ue,Oe,We,zt,At,Mt=function(Ce,Ue,fr){var Sr=Ce*Math.cos(fr)-Ue*Math.sin(fr),Pe=Ce*Math.sin(fr)+Ue*Math.cos(fr);return{x:Sr,y:Pe}};if(qt)Oe=qt[0],We=qt[1],zt=qt[2],At=qt[3];else{ue=Mt(jt,Qt,-Ct),jt=ue.x,Qt=ue.y,ue=Mt(te,St,-Ct),te=ue.x,St=ue.y,jt===te&&Qt===St&&(te+=1,St+=1);var Rt=(jt-te)/2,tt=(Qt-St)/2,_t=Rt*Rt/(Te*Te)+tt*tt/(ae*ae);_t>1&&(_t=Math.sqrt(_t),Te=_t*Te,ae=_t*ae);var Xt=Te*Te,ve=ae*ae,Wt=(or===ie?-1:1)*Math.sqrt(Math.abs((Xt*ve-Xt*tt*tt-ve*Rt*Rt)/(Xt*tt*tt+ve*Rt*Rt)));zt=Wt*Te*tt/ae+(jt+te)/2,At=Wt*-ae*Rt/Te+(Qt+St)/2,Oe=Math.asin(((Qt-At)/ae).toFixed(9)),We=Math.asin(((St-At)/ae).toFixed(9)),Oe=jt<zt?Math.PI-Oe:Oe,We=te<zt?Math.PI-We:We,Oe<0&&(Oe=Math.PI*2+Oe),We<0&&(We=Math.PI*2+We),ie&&Oe>We&&(Oe=Oe-Math.PI*2),!ie&&We>Oe&&(We=We-Math.PI*2)}var Me=We-Oe;if(Math.abs(Me)>$t){var je=We,Qe=te,hr=St;We=Oe+$t*(ie&&We>Oe?1:-1),te=zt+Te*Math.cos(We),St=At+ae*Math.sin(We),Tt=it(te,St,Te,ae,Ke,0,ie,Qe,hr,[We,je,zt,At])}Me=We-Oe;var er=Math.cos(Oe),Br=Math.sin(Oe),Lr=Math.cos(We),Zr=Math.sin(We),Tn=Math.tan(Me/4),rn=4/3*Te*Tn,Nn=4/3*ae*Tn,zn=[jt,Qt],jn=[jt+rn*Br,Qt-Nn*er],wn=[te+rn*Zr,St-Nn*Lr],Wn=[te,St];if(jn[0]=2*zn[0]-jn[0],jn[1]=2*zn[1]-jn[1],qt)return[jn,wn,Wn].concat(Tt);Tt=[jn,wn,Wn].concat(Tt).join().split(",");for(var Bt=[],Yt=0,oe=Tt.length;Yt<oe;Yt++)Bt[Yt]=Yt%2?Mt(Tt[Yt-1],Tt[Yt],Ct).y:Mt(Tt[Yt],Tt[Yt+1],Ct).x;return Bt},st=function(jt,Qt){var Te=ct(jt),ae=Qt&&ct(Qt),Ke={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},or={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},ie=[],te=[],St="",qt="",$t,Ct=function(Rt,tt,_t){var Xt,ve;if(!Rt)return["C",tt.x,tt.y,tt.x,tt.y,tt.x,tt.y];switch(!(Rt[0]in{T:1,Q:1})&&(tt.qx=tt.qy=null),Rt[0]){case"M":tt.X=Rt[1],tt.Y=Rt[2];break;case"A":Rt=["C"].concat(it.apply(0,[tt.x,tt.y].concat(Rt.slice(1))));break;case"S":_t==="C"||_t==="S"?(Xt=tt.x*2-tt.bx,ve=tt.y*2-tt.by):(Xt=tt.x,ve=tt.y),Rt=["C",Xt,ve].concat(Rt.slice(1));break;case"T":_t==="Q"||_t==="T"?(tt.qx=tt.x*2-tt.qx,tt.qy=tt.y*2-tt.qy):(tt.qx=tt.x,tt.qy=tt.y),Rt=["C"].concat(Ee(tt.x,tt.y,tt.qx,tt.qy,Rt[1],Rt[2]));break;case"Q":tt.qx=Rt[1],tt.qy=Rt[2],Rt=["C"].concat(Ee(tt.x,tt.y,Rt[1],Rt[2],Rt[3],Rt[4]));break;case"L":Rt=["C"].concat(et(tt.x,tt.y,Rt[1],Rt[2]));break;case"H":Rt=["C"].concat(et(tt.x,tt.y,Rt[1],tt.y));break;case"V":Rt=["C"].concat(et(tt.x,tt.y,tt.x,Rt[1]));break;case"Z":Rt=["C"].concat(et(tt.x,tt.y,tt.X,tt.Y));break;default:break}return Rt},Tt=function(Rt,tt){if(Rt[tt].length>7){Rt[tt].shift();for(var _t=Rt[tt];_t.length;)ie[tt]="A",ae&&(te[tt]="A"),Rt.splice(tt++,0,["C"].concat(_t.splice(0,6)));Rt.splice(tt,1),$t=Math.max(Te.length,ae&&ae.length||0)}},ue=function(Rt,tt,_t,Xt,ve){Rt&&tt&&Rt[ve][0]==="M"&&tt[ve][0]!=="M"&&(tt.splice(ve,0,["M",Xt.x,Xt.y]),_t.bx=0,_t.by=0,_t.x=Rt[ve][1],_t.y=Rt[ve][2],$t=Math.max(Te.length,ae&&ae.length||0))};$t=Math.max(Te.length,ae&&ae.length||0);for(var Oe=0;Oe<$t;Oe++){Te[Oe]&&(St=Te[Oe][0]),St!=="C"&&(ie[Oe]=St,Oe&&(qt=ie[Oe-1])),Te[Oe]=Ct(Te[Oe],Ke,qt),ie[Oe]!=="A"&&St==="C"&&(ie[Oe]="C"),Tt(Te,Oe),ae&&(ae[Oe]&&(St=ae[Oe][0]),St!=="C"&&(te[Oe]=St,Oe&&(qt=te[Oe-1])),ae[Oe]=Ct(ae[Oe],or,qt),te[Oe]!=="A"&&St==="C"&&(te[Oe]="C"),Tt(ae,Oe)),ue(Te,ae,Ke,or,Oe),ue(ae,Te,or,Ke,Oe);var We=Te[Oe],zt=ae&&ae[Oe],At=We.length,Mt=ae&&zt.length;Ke.x=We[At-2],Ke.y=We[At-1],Ke.bx=parseFloat(We[At-4])||Ke.x,Ke.by=parseFloat(We[At-3])||Ke.y,or.bx=ae&&(parseFloat(zt[Mt-4])||or.x),or.by=ae&&(parseFloat(zt[Mt-3])||or.y),or.x=ae&&zt[Mt-2],or.y=ae&&zt[Mt-1]}return ae?[Te,ae]:Te},Zt=/,?([a-z]),?/gi,P=function(jt){return jt.join(",").replace(Zt,"$1")},b=function(jt,Qt,Te,ae,Ke){var or=-3*Qt+9*Te-9*ae+3*Ke,ie=jt*or+6*Qt-12*Te+6*ae;return jt*ie-3*Qt+3*Te},X=function(jt,Qt,Te,ae,Ke,or,ie,te,St){St===null&&(St=1),St=St>1?1:St<0?0:St;for(var qt=St/2,$t=12,Ct=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],Tt=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],ue=0,Oe=0;Oe<$t;Oe++){var We=qt*Ct[Oe]+qt,zt=b(We,jt,Te,Ke,ie),At=b(We,Qt,ae,or,te),Mt=zt*zt+At*At;ue+=Tt[Oe]*Math.sqrt(Mt)}return qt*ue},le=function(jt,Qt,Te,ae,Ke,or,ie,te){for(var St=[],qt=[[],[]],$t,Ct,Tt,ue,Oe=0;Oe<2;++Oe){if(Oe===0?(Ct=6*jt-12*Te+6*Ke,$t=-3*jt+9*Te-9*Ke+3*ie,Tt=3*Te-3*jt):(Ct=6*Qt-12*ae+6*or,$t=-3*Qt+9*ae-9*or+3*te,Tt=3*ae-3*Qt),Math.abs($t)<1e-12){if(Math.abs(Ct)<1e-12)continue;ue=-Tt/Ct,ue>0&&ue<1&&St.push(ue);continue}var We=Ct*Ct-4*Tt*$t,zt=Math.sqrt(We);if(!(We<0)){var At=(-Ct+zt)/(2*$t);At>0&&At<1&&St.push(At);var Mt=(-Ct-zt)/(2*$t);Mt>0&&Mt<1&&St.push(Mt)}}for(var Rt=St.length,tt=Rt,_t;Rt--;)ue=St[Rt],_t=1-ue,qt[0][Rt]=_t*_t*_t*jt+3*_t*_t*ue*Te+3*_t*ue*ue*Ke+ue*ue*ue*ie,qt[1][Rt]=_t*_t*_t*Qt+3*_t*_t*ue*ae+3*_t*ue*ue*or+ue*ue*ue*te;return qt[0][tt]=jt,qt[1][tt]=Qt,qt[0][tt+1]=ie,qt[1][tt+1]=te,qt[0].length=qt[1].length=tt+2,{min:{x:Math.min.apply(0,qt[0]),y:Math.min.apply(0,qt[1])},max:{x:Math.max.apply(0,qt[0]),y:Math.max.apply(0,qt[1])}}},Se=function(jt,Qt,Te,ae,Ke,or,ie,te){if(!(Math.max(jt,Te)<Math.min(Ke,ie)||Math.min(jt,Te)>Math.max(Ke,ie)||Math.max(Qt,ae)<Math.min(or,te)||Math.min(Qt,ae)>Math.max(or,te))){var St=(jt*ae-Qt*Te)*(Ke-ie)-(jt-Te)*(Ke*te-or*ie),qt=(jt*ae-Qt*Te)*(or-te)-(Qt-ae)*(Ke*te-or*ie),$t=(jt-Te)*(or-te)-(Qt-ae)*(Ke-ie);if(!!$t){var Ct=St/$t,Tt=qt/$t,ue=+Ct.toFixed(2),Oe=+Tt.toFixed(2);if(!(ue<+Math.min(jt,Te).toFixed(2)||ue>+Math.max(jt,Te).toFixed(2)||ue<+Math.min(Ke,ie).toFixed(2)||ue>+Math.max(Ke,ie).toFixed(2)||Oe<+Math.min(Qt,ae).toFixed(2)||Oe>+Math.max(Qt,ae).toFixed(2)||Oe<+Math.min(or,te).toFixed(2)||Oe>+Math.max(or,te).toFixed(2)))return{x:Ct,y:Tt}}}},Ie=function(jt,Qt,Te){return Qt>=jt.x&&Qt<=jt.x+jt.width&&Te>=jt.y&&Te<=jt.y+jt.height},It=function(jt,Qt,Te,ae,Ke){if(Ke)return[["M",+jt+ +Ke,Qt],["l",Te-Ke*2,0],["a",Ke,Ke,0,0,1,Ke,Ke],["l",0,ae-Ke*2],["a",Ke,Ke,0,0,1,-Ke,Ke],["l",Ke*2-Te,0],["a",Ke,Ke,0,0,1,-Ke,-Ke],["l",0,Ke*2-ae],["a",Ke,Ke,0,0,1,Ke,-Ke],["z"]];var or=[["M",jt,Qt],["l",Te,0],["l",0,ae],["l",-Te,0],["z"]];return or.parsePathArray=P,or},rt=function(jt,Qt,Te,ae){return jt===null&&(jt=Qt=Te=ae=0),Qt===null&&(Qt=jt.y,Te=jt.width,ae=jt.height,jt=jt.x),{x:jt,y:Qt,width:Te,w:Te,height:ae,h:ae,x2:jt+Te,y2:Qt+ae,cx:jt+Te/2,cy:Qt+ae/2,r1:Math.min(Te,ae)/2,r2:Math.max(Te,ae)/2,r0:Math.sqrt(Te*Te+ae*ae)/2,path:It(jt,Qt,Te,ae),vb:[jt,Qt,Te,ae].join(" ")}},Dt=function(jt,Qt){return jt=rt(jt),Qt=rt(Qt),Ie(Qt,jt.x,jt.y)||Ie(Qt,jt.x2,jt.y)||Ie(Qt,jt.x,jt.y2)||Ie(Qt,jt.x2,jt.y2)||Ie(jt,Qt.x,Qt.y)||Ie(jt,Qt.x2,Qt.y)||Ie(jt,Qt.x,Qt.y2)||Ie(jt,Qt.x2,Qt.y2)||(jt.x<Qt.x2&&jt.x>Qt.x||Qt.x<jt.x2&&Qt.x>jt.x)&&(jt.y<Qt.y2&&jt.y>Qt.y||Qt.y<jt.y2&&Qt.y>jt.y)},Ae=function(jt,Qt,Te,ae,Ke,or,ie,te){(0,Lt.kJ)(jt)||(jt=[jt,Qt,Te,ae,Ke,or,ie,te]);var St=le.apply(null,jt);return rt(St.min.x,St.min.y,St.max.x-St.min.x,St.max.y-St.min.y)},be=function(jt,Qt,Te,ae,Ke,or,ie,te,St){var qt=1-St,$t=Math.pow(qt,3),Ct=Math.pow(qt,2),Tt=St*St,ue=Tt*St,Oe=$t*jt+Ct*3*St*Te+qt*3*St*St*Ke+ue*ie,We=$t*Qt+Ct*3*St*ae+qt*3*St*St*or+ue*te,zt=jt+2*St*(Te-jt)+Tt*(Ke-2*Te+jt),At=Qt+2*St*(ae-Qt)+Tt*(or-2*ae+Qt),Mt=Te+2*St*(Ke-Te)+Tt*(ie-2*Ke+Te),Rt=ae+2*St*(or-ae)+Tt*(te-2*or+ae),tt=qt*jt+St*Te,_t=qt*Qt+St*ae,Xt=qt*Ke+St*ie,ve=qt*or+St*te,Wt=90-Math.atan2(zt-Mt,At-Rt)*180/Math.PI;return{x:Oe,y:We,m:{x:zt,y:At},n:{x:Mt,y:Rt},start:{x:tt,y:_t},end:{x:Xt,y:ve},alpha:Wt}},me=function(jt,Qt,Te){var ae=Ae(jt),Ke=Ae(Qt);if(!Dt(ae,Ke))return Te?0:[];for(var or=X.apply(0,jt),ie=X.apply(0,Qt),te=~~(or/8),St=~~(ie/8),qt=[],$t=[],Ct={},Tt=Te?0:[],ue=0;ue<te+1;ue++){var Oe=be.apply(0,jt.concat(ue/te));qt.push({x:Oe.x,y:Oe.y,t:ue/te})}for(var ue=0;ue<St+1;ue++){var Oe=be.apply(0,Qt.concat(ue/St));$t.push({x:Oe.x,y:Oe.y,t:ue/St})}for(var ue=0;ue<te;ue++)for(var We=0;We<St;We++){var zt=qt[ue],At=qt[ue+1],Mt=$t[We],Rt=$t[We+1],tt=Math.abs(At.x-zt.x)<.001?"y":"x",_t=Math.abs(Rt.x-Mt.x)<.001?"y":"x",Xt=Se(zt.x,zt.y,At.x,At.y,Mt.x,Mt.y,Rt.x,Rt.y);if(Xt){if(Ct[Xt.x.toFixed(4)]===Xt.y.toFixed(4))continue;Ct[Xt.x.toFixed(4)]=Xt.y.toFixed(4);var ve=zt.t+Math.abs((Xt[tt]-zt[tt])/(At[tt]-zt[tt]))*(At.t-zt.t),Wt=Mt.t+Math.abs((Xt[_t]-Mt[_t])/(Rt[_t]-Mt[_t]))*(Rt.t-Mt.t);ve>=0&&ve<=1&&Wt>=0&&Wt<=1&&(Te?Tt+=1:Tt.push({x:Xt.x,y:Xt.y,t1:ve,t2:Wt}))}}return Tt},ee=function(jt,Qt,Te){jt=st(jt),Qt=st(Qt);for(var ae,Ke,or,ie,te,St,qt,$t,Ct,Tt,ue=Te?0:[],Oe=0,We=jt.length;Oe<We;Oe++){var zt=jt[Oe];if(zt[0]==="M")ae=te=zt[1],Ke=St=zt[2];else{zt[0]==="C"?(Ct=[ae,Ke].concat(zt.slice(1)),ae=Ct[6],Ke=Ct[7]):(Ct=[ae,Ke,ae,Ke,te,St,te,St],ae=te,Ke=St);for(var At=0,Mt=Qt.length;At<Mt;At++){var Rt=Qt[At];if(Rt[0]==="M")or=qt=Rt[1],ie=$t=Rt[2];else{Rt[0]==="C"?(Tt=[or,ie].concat(Rt.slice(1)),or=Tt[6],ie=Tt[7]):(Tt=[or,ie,or,ie,qt,$t,qt,$t],or=qt,ie=$t);var tt=me(Ct,Tt,Te);if(Te)ue+=tt;else{for(var _t=0,Xt=tt.length;_t<Xt;_t++)tt[_t].segment1=Oe,tt[_t].segment2=At,tt[_t].bez1=Ct,tt[_t].bez2=Tt;ue=ue.concat(tt)}}}}}return ue},we=function(jt,Qt){return ee(jt,Qt)};function _e(jt,Qt){var Te=[],ae=[];function Ke(or,ie){if(or.length===1)Te.push(or[0]),ae.push(or[0]);else{for(var te=[],St=0;St<or.length-1;St++)St===0&&Te.push(or[0]),St===or.length-2&&ae.push(or[St+1]),te[St]=[(1-ie)*or[St][0]+ie*or[St+1][0],(1-ie)*or[St][1]+ie*or[St+1][1]];Ke(te,ie)}}return jt.length&&Ke(jt,Qt),{left:Te,right:ae.reverse()}}function gt(jt,Qt,Te){var ae=[[jt[1],jt[2]]];Te=Te||2;var Ke=[];Qt[0]==="A"?(ae.push(Qt[6]),ae.push(Qt[7])):Qt[0]==="C"?(ae.push([Qt[1],Qt[2]]),ae.push([Qt[3],Qt[4]]),ae.push([Qt[5],Qt[6]])):Qt[0]==="S"||Qt[0]==="Q"?(ae.push([Qt[1],Qt[2]]),ae.push([Qt[3],Qt[4]])):ae.push([Qt[1],Qt[2]]);for(var or=ae,ie=1/Te,te=0;te<Te-1;te++){var St=ie/(1-ie*te),qt=_e(or,St);Ke.push(qt.left),or=qt.right}Ke.push(or);var $t=Ke.map(function(Ct){var Tt=[];return Ct.length===4&&(Tt.push("C"),Tt=Tt.concat(Ct[2])),Ct.length>=3&&(Ct.length===3&&Tt.push("Q"),Tt=Tt.concat(Ct[1])),Ct.length===2&&Tt.push("L"),Tt=Tt.concat(Ct[Ct.length-1]),Tt});return $t}var Pt=function(jt,Qt,Te){if(Te===1)return[[].concat(jt)];var ae=[];if(Qt[0]==="L"||Qt[0]==="C"||Qt[0]==="Q")ae=ae.concat(gt(jt,Qt,Te));else{var Ke=[].concat(jt);Ke[0]==="M"&&(Ke[0]="L");for(var or=0;or<=Te-1;or++)ae.push(Ke)}return ae},J=function(jt,Qt){if(jt.length===1)return jt;var Te=jt.length-1,ae=Qt.length-1,Ke=Te/ae,or=[];if(jt.length===1&&jt[0][0]==="M"){for(var ie=0;ie<ae-Te;ie++)jt.push(jt[0]);return jt}for(var ie=0;ie<ae;ie++){var te=Math.floor(Ke*ie);or[te]=(or[te]||0)+1}var St=or.reduce(function(qt,$t,Ct){return Ct===Te?qt.concat(jt[Te]):qt.concat(Pt(jt[Ct],jt[Ct+1],$t))},[]);return St.unshift(jt[0]),(Qt[ae]==="Z"||Qt[ae]==="z")&&St.push("Z"),St},vt=function(jt,Qt){if(jt.length!==Qt.length)return!1;var Te=!0;return(0,Lt.S6)(jt,function(ae,Ke){if(ae!==Qt[Ke])return Te=!1,!1}),Te};function W(jt,Qt,Te){var ae=null,Ke=Te;return Qt<Ke&&(Ke=Qt,ae="add"),jt<Ke&&(Ke=jt,ae="del"),{type:ae,min:Ke}}var dt=function(jt,Qt){var Te=jt.length,ae=Qt.length,Ke,or,ie=0;if(Te===0||ae===0)return null;for(var te=[],St=0;St<=Te;St++)te[St]=[],te[St][0]={min:St};for(var qt=0;qt<=ae;qt++)te[0][qt]={min:qt};for(var St=1;St<=Te;St++){Ke=jt[St-1];for(var qt=1;qt<=ae;qt++){or=Qt[qt-1],vt(Ke,or)?ie=0:ie=1;var $t=te[St-1][qt].min+1,Ct=te[St][qt-1].min+1,Tt=te[St-1][qt-1].min+ie;te[St][qt]=W($t,Ct,Tt)}}return te},Vt=function(jt,Qt){var Te=dt(jt,Qt),ae=jt.length,Ke=Qt.length,or=[],ie=1,te=1;if(Te[ae][Ke].min!==ae){for(var St=1;St<=ae;St++){var qt=Te[St][St].min;te=St;for(var $t=ie;$t<=Ke;$t++)Te[St][$t].min<qt&&(qt=Te[St][$t].min,te=$t);ie=te,Te[St][ie].type&&or.push({index:St-1,type:Te[St][ie].type})}for(var St=or.length-1;St>=0;St--)ie=or[St].index,or[St].type==="add"?jt.splice(ie,0,[].concat(jt[ie])):jt.splice(ie,1)}ae=jt.length;var Ct=Ke-ae;if(ae<Ke)for(var St=0;St<Ct;St++)jt[ae-1][0]==="z"||jt[ae-1][0]==="Z"?jt.splice(ae-2,0,jt[ae-2]):jt.push(jt[ae-1]),ae+=1;return jt};function ne(jt,Qt,Te){for(var ae=[].concat(jt),Ke,or=1/(Te+1),ie=ge(Qt)[0],te=1;te<=Te;te++)or*=te,Ke=Math.floor(jt.length*or),Ke===0?ae.unshift([ie[0]*or+jt[Ke][0]*(1-or),ie[1]*or+jt[Ke][1]*(1-or)]):ae.splice(Ke,0,[ie[0]*or+jt[Ke][0]*(1-or),ie[1]*or+jt[Ke][1]*(1-or)]);return ae}function ge(jt){var Qt=[];switch(jt[0]){case"M":Qt.push([jt[1],jt[2]]);break;case"L":Qt.push([jt[1],jt[2]]);break;case"A":Qt.push([jt[6],jt[7]]);break;case"Q":Qt.push([jt[3],jt[4]]),Qt.push([jt[1],jt[2]]);break;case"T":Qt.push([jt[1],jt[2]]);break;case"C":Qt.push([jt[5],jt[6]]),Qt.push([jt[1],jt[2]]),Qt.push([jt[3],jt[4]]);break;case"S":Qt.push([jt[3],jt[4]]),Qt.push([jt[1],jt[2]]);break;case"H":Qt.push([jt[1],jt[1]]);break;case"V":Qt.push([jt[1],jt[1]]);break;default:}return Qt}var $e=function(jt,Qt){if(jt.length<=1)return jt;for(var Te,ae=0;ae<Qt.length;ae++)if(jt[ae][0]!==Qt[ae][0])switch(Te=ge(jt[ae]),Qt[ae][0]){case"M":jt[ae]=["M"].concat(Te[0]);break;case"L":jt[ae]=["L"].concat(Te[0]);break;case"A":jt[ae]=[].concat(Qt[ae]),jt[ae][6]=Te[0][0],jt[ae][7]=Te[0][1];break;case"Q":if(Te.length<2)if(ae>0)Te=ne(Te,jt[ae-1],1);else{jt[ae]=Qt[ae];break}jt[ae]=["Q"].concat(Te.reduce(function(Ke,or){return Ke.concat(or)},[]));break;case"T":jt[ae]=["T"].concat(Te[0]);break;case"C":if(Te.length<3)if(ae>0)Te=ne(Te,jt[ae-1],2);else{jt[ae]=Qt[ae];break}jt[ae]=["C"].concat(Te.reduce(function(Ke,or){return Ke.concat(or)},[]));break;case"S":if(Te.length<2)if(ae>0)Te=ne(Te,jt[ae-1],1);else{jt[ae]=Qt[ae];break}jt[ae]=["S"].concat(Te.reduce(function(Ke,or){return Ke.concat(or)},[]));break;default:jt[ae]=Qt[ae]}return jt}},8723:function(vn,Ft,ot){"use strict";ot.d(Ft,{$O:function(){return lt},FE:function(){return I},mY:function(){return q}});var Lt=ot(77341),wt=ot(67052);function I(ht,ct,et){var Ee=1;if((0,Lt.HD)(ht)&&(Ee=ht.split(`
`).length),Ee>1){var it=Et(ct,et);return ct*Ee+it*(Ee-1)}return ct}function Et(ht,ct){return ct?ct-ht:ht*.14}function q(ht,ct){var et=(0,wt.L)(),Ee=0;if((0,Lt.kK)(ht)||ht==="")return Ee;if(et.save(),et.font=ct,(0,Lt.HD)(ht)&&ht.includes(`
`)){var it=ht.split(`
`);(0,Lt.S6)(it,function(st){var Zt=et.measureText(st).width;Ee<Zt&&(Ee=Zt)})}else Ee=et.measureText(ht).width;return et.restore(),Ee}function lt(ht){var ct=ht.fontSize,et=ht.fontFamily,Ee=ht.fontWeight,it=ht.fontStyle,st=ht.fontVariant;return[it,st,Ee,ct+"px",et].join(" ").trim()}},77341:function(vn,Ft,ot){"use strict";ot.d(Ft,{As:function(){return wt},CD:function(){return Lt.CD},HD:function(){return Lt.HD},Kn:function(){return Lt.Kn},S6:function(){return Lt.S6},UY:function(){return Et},jC:function(){return Lt.jC},jU:function(){return I},kK:function(){return Lt.UM},mf:function(){return Lt.mf},pP:function(){return q}});var Lt=ot(45098);function wt(lt,ht){var ct=lt.indexOf(ht);ct!==-1&&lt.splice(ct,1)}var I=typeof window!="undefined"&&typeof window.document!="undefined";function Et(lt,ht){if(lt.isCanvas())return!0;for(var ct=ht.getParent(),et=!1;ct;){if(ct===lt){et=!0;break}ct=ct.getParent()}return et}function q(lt){return lt.cfg.visible&&lt.cfg.capture}},32793:function(vn,Ft,ot){"use strict";ot.d(Ft,{wN:function(){return ne},Ll:function(){return be},x1:function(){return et},aH:function(){return ae},lD:function(){return Se},Zr:function(){return Lt}});var Lt={};ot.r(Lt),ot.d(Lt,{distance:function(){return I},getBBoxByArray:function(){return q},getBBoxRange:function(){return lt},isNumberEqual:function(){return Et},piMod:function(){return ht}});var wt=ot(45098);function I(ie,te,St,qt){var $t=ie-St,Ct=te-qt;return Math.sqrt($t*$t+Ct*Ct)}function Et(ie,te){return Math.abs(ie-te)<.001}function q(ie,te){var St=(0,wt.VV)(ie),qt=(0,wt.VV)(te),$t=(0,wt.Fp)(ie),Ct=(0,wt.Fp)(te);return{x:St,y:qt,width:$t-St,height:Ct-qt}}function lt(ie,te,St,qt){return{minX:(0,wt.VV)([ie,St]),maxX:(0,wt.Fp)([ie,St]),minY:(0,wt.VV)([te,qt]),maxY:(0,wt.Fp)([te,qt])}}function ht(ie){return(ie+Math.PI*2)%(Math.PI*2)}var ct=ot(31437),et={box:function(ie,te,St,qt){return q([ie,St],[te,qt])},length:function(ie,te,St,qt){return I(ie,te,St,qt)},pointAt:function(ie,te,St,qt,$t){return{x:(1-$t)*ie+$t*St,y:(1-$t)*te+$t*qt}},pointDistance:function(ie,te,St,qt,$t,Ct){var Tt=(St-ie)*($t-ie)+(qt-te)*(Ct-te);if(Tt<0)return I(ie,te,$t,Ct);var ue=(St-ie)*(St-ie)+(qt-te)*(qt-te);return Tt>ue?I(St,qt,$t,Ct):this.pointToLine(ie,te,St,qt,$t,Ct)},pointToLine:function(ie,te,St,qt,$t,Ct){var Tt=[St-ie,qt-te];if(ct.I6(Tt,[0,0]))return Math.sqrt(($t-ie)*($t-ie)+(Ct-te)*(Ct-te));var ue=[-Tt[1],Tt[0]];ct.Fv(ue,ue);var Oe=[$t-ie,Ct-te];return Math.abs(ct.AK(Oe,ue))},tangentAngle:function(ie,te,St,qt){return Math.atan2(qt-te,St-ie)}},Ee=1e-4;function it(ie,te,St,qt,$t,Ct){var Tt,ue=1/0,Oe=[St,qt],We=20;Ct&&Ct>200&&(We=Ct/10);for(var zt=1/We,At=zt/10,Mt=0;Mt<=We;Mt++){var Rt=Mt*zt,tt=[$t.apply(null,ie.concat([Rt])),$t.apply(null,te.concat([Rt]))],_t=I(Oe[0],Oe[1],tt[0],tt[1]);_t<ue&&(Tt=Rt,ue=_t)}if(Tt===0)return{x:ie[0],y:te[0]};if(Tt===1){var Xt=ie.length;return{x:ie[Xt-1],y:te[Xt-1]}}ue=1/0;for(var Mt=0;Mt<32&&!(At<Ee);Mt++){var ve=Tt-At,Wt=Tt+At,tt=[$t.apply(null,ie.concat([ve])),$t.apply(null,te.concat([ve]))],_t=I(Oe[0],Oe[1],tt[0],tt[1]);if(ve>=0&&_t<ue)Tt=ve,ue=_t;else{var Me=[$t.apply(null,ie.concat([Wt])),$t.apply(null,te.concat([Wt]))],je=I(Oe[0],Oe[1],Me[0],Me[1]);Wt<=1&&je<ue?(Tt=Wt,ue=je):At*=.5}}return{x:$t.apply(null,ie.concat([Tt])),y:$t.apply(null,te.concat([Tt]))}}function st(ie,te){for(var St=0,qt=ie.length,$t=0;$t<qt;$t++){var Ct=ie[$t],Tt=te[$t],ue=ie[($t+1)%qt],Oe=te[($t+1)%qt];St+=I(Ct,Tt,ue,Oe)}return St/2}function Zt(ie,te,St,qt){var $t=1-qt;return $t*$t*ie+2*qt*$t*te+qt*qt*St}function P(ie,te,St){var qt=ie+St-2*te;if(Et(qt,0))return[.5];var $t=(ie-te)/qt;return $t<=1&&$t>=0?[$t]:[]}function b(ie,te,St,qt){return 2*(1-qt)*(te-ie)+2*qt*(St-te)}function X(ie,te,St,qt,$t,Ct,Tt){var ue=Zt(ie,St,$t,Tt),Oe=Zt(te,qt,Ct,Tt),We=et.pointAt(ie,te,St,qt,Tt),zt=et.pointAt(St,qt,$t,Ct,Tt);return[[ie,te,We.x,We.y,ue,Oe],[ue,Oe,zt.x,zt.y,$t,Ct]]}function le(ie,te,St,qt,$t,Ct,Tt){if(Tt===0)return(I(ie,te,St,qt)+I(St,qt,$t,Ct)+I(ie,te,$t,Ct))/2;var ue=X(ie,te,St,qt,$t,Ct,.5),Oe=ue[0],We=ue[1];return Oe.push(Tt-1),We.push(Tt-1),le.apply(null,Oe)+le.apply(null,We)}var Se={box:function(ie,te,St,qt,$t,Ct){var Tt=P(ie,St,$t)[0],ue=P(te,qt,Ct)[0],Oe=[ie,$t],We=[te,Ct];return Tt!==void 0&&Oe.push(Zt(ie,St,$t,Tt)),ue!==void 0&&We.push(Zt(te,qt,Ct,ue)),q(Oe,We)},length:function(ie,te,St,qt,$t,Ct){return le(ie,te,St,qt,$t,Ct,3)},nearestPoint:function(ie,te,St,qt,$t,Ct,Tt,ue){return it([ie,St,$t],[te,qt,Ct],Tt,ue,Zt)},pointDistance:function(ie,te,St,qt,$t,Ct,Tt,ue){var Oe=this.nearestPoint(ie,te,St,qt,$t,Ct,Tt,ue);return I(Oe.x,Oe.y,Tt,ue)},interpolationAt:Zt,pointAt:function(ie,te,St,qt,$t,Ct,Tt){return{x:Zt(ie,St,$t,Tt),y:Zt(te,qt,Ct,Tt)}},divide:function(ie,te,St,qt,$t,Ct,Tt){return X(ie,te,St,qt,$t,Ct,Tt)},tangentAngle:function(ie,te,St,qt,$t,Ct,Tt){var ue=b(ie,St,$t,Tt),Oe=b(te,qt,Ct,Tt),We=Math.atan2(Oe,ue);return ht(We)}};function Ie(ie,te,St,qt,$t){var Ct=1-$t;return Ct*Ct*Ct*ie+3*te*$t*Ct*Ct+3*St*$t*$t*Ct+qt*$t*$t*$t}function It(ie,te,St,qt,$t){var Ct=1-$t;return 3*(Ct*Ct*(te-ie)+2*Ct*$t*(St-te)+$t*$t*(qt-St))}function rt(ie,te,St,qt){var $t=-3*ie+9*te-9*St+3*qt,Ct=6*ie-12*te+6*St,Tt=3*te-3*ie,ue=[],Oe,We,zt;if(Et($t,0))Et(Ct,0)||(Oe=-Tt/Ct,Oe>=0&&Oe<=1&&ue.push(Oe));else{var At=Ct*Ct-4*$t*Tt;Et(At,0)?ue.push(-Ct/(2*$t)):At>0&&(zt=Math.sqrt(At),Oe=(-Ct+zt)/(2*$t),We=(-Ct-zt)/(2*$t),Oe>=0&&Oe<=1&&ue.push(Oe),We>=0&&We<=1&&ue.push(We))}return ue}function Dt(ie,te,St,qt,$t,Ct,Tt,ue,Oe){var We=Ie(ie,St,$t,Tt,Oe),zt=Ie(te,qt,Ct,ue,Oe),At=et.pointAt(ie,te,St,qt,Oe),Mt=et.pointAt(St,qt,$t,Ct,Oe),Rt=et.pointAt($t,Ct,Tt,ue,Oe),tt=et.pointAt(At.x,At.y,Mt.x,Mt.y,Oe),_t=et.pointAt(Mt.x,Mt.y,Rt.x,Rt.y,Oe);return[[ie,te,At.x,At.y,tt.x,tt.y,We,zt],[We,zt,_t.x,_t.y,Rt.x,Rt.y,Tt,ue]]}function Ae(ie,te,St,qt,$t,Ct,Tt,ue,Oe){if(Oe===0)return st([ie,St,$t,Tt],[te,qt,Ct,ue]);var We=Dt(ie,te,St,qt,$t,Ct,Tt,ue,.5),zt=We[0],At=We[1];return zt.push(Oe-1),At.push(Oe-1),Ae.apply(null,zt)+Ae.apply(null,At)}var be={extrema:rt,box:function(ie,te,St,qt,$t,Ct,Tt,ue){for(var Oe=[ie,Tt],We=[te,ue],zt=rt(ie,St,$t,Tt),At=rt(te,qt,Ct,ue),Mt=0;Mt<zt.length;Mt++)Oe.push(Ie(ie,St,$t,Tt,zt[Mt]));for(var Mt=0;Mt<At.length;Mt++)We.push(Ie(te,qt,Ct,ue,At[Mt]));return q(Oe,We)},length:function(ie,te,St,qt,$t,Ct,Tt,ue){return Ae(ie,te,St,qt,$t,Ct,Tt,ue,3)},nearestPoint:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe,We,zt){return it([ie,St,$t,Tt],[te,qt,Ct,ue],Oe,We,Ie,zt)},pointDistance:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe,We,zt){var At=this.nearestPoint(ie,te,St,qt,$t,Ct,Tt,ue,Oe,We,zt);return I(At.x,At.y,Oe,We)},interpolationAt:Ie,pointAt:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe){return{x:Ie(ie,St,$t,Tt,Oe),y:Ie(te,qt,Ct,ue,Oe)}},divide:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe){return Dt(ie,te,St,qt,$t,Ct,Tt,ue,Oe)},tangentAngle:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe){var We=It(ie,St,$t,Tt,Oe),zt=It(te,qt,Ct,ue,Oe);return ht(Math.atan2(zt,We))}};function me(ie,te){var St=Math.abs(ie);return te>0?St:St*-1}var ee={box:function(ie,te,St,qt){return{x:ie-St,y:te-qt,width:St*2,height:qt*2}},length:function(ie,te,St,qt){return Math.PI*(3*(St+qt)-Math.sqrt((3*St+qt)*(St+3*qt)))},nearestPoint:function(ie,te,St,qt,$t,Ct){var Tt=St,ue=qt;if(Tt===0||ue===0)return{x:ie,y:te};for(var Oe=$t-ie,We=Ct-te,zt=Math.abs(Oe),At=Math.abs(We),Mt=Tt*Tt,Rt=ue*ue,tt=Math.PI/4,_t,Xt,ve=0;ve<4;ve++){_t=Tt*Math.cos(tt),Xt=ue*Math.sin(tt);var Wt=(Mt-Rt)*Math.pow(Math.cos(tt),3)/Tt,Me=(Rt-Mt)*Math.pow(Math.sin(tt),3)/ue,je=_t-Wt,Qe=Xt-Me,hr=zt-Wt,er=At-Me,Br=Math.hypot(Qe,je),Lr=Math.hypot(er,hr),Zr=Br*Math.asin((je*er-Qe*hr)/(Br*Lr)),Tn=Zr/Math.sqrt(Mt+Rt-_t*_t-Xt*Xt);tt+=Tn,tt=Math.min(Math.PI/2,Math.max(0,tt))}return{x:ie+me(_t,Oe),y:te+me(Xt,We)}},pointDistance:function(ie,te,St,qt,$t,Ct){var Tt=this.nearestPoint(ie,te,St,qt,$t,Ct);return I(Tt.x,Tt.y,$t,Ct)},pointAt:function(ie,te,St,qt,$t){var Ct=2*Math.PI*$t;return{x:ie+St*Math.cos(Ct),y:te+qt*Math.sin(Ct)}},tangentAngle:function(ie,te,St,qt,$t){var Ct=2*Math.PI*$t,Tt=Math.atan2(qt*Math.cos(Ct),-St*Math.sin(Ct));return ht(Tt)}};function we(ie,te,St,qt,$t,Ct,Tt,ue){return-1*St*Math.cos($t)*Math.sin(ue)-qt*Math.sin($t)*Math.cos(ue)}function _e(ie,te,St,qt,$t,Ct,Tt,ue){return-1*St*Math.sin($t)*Math.sin(ue)+qt*Math.cos($t)*Math.cos(ue)}function gt(ie,te,St){return Math.atan(-te/ie*Math.tan(St))}function Pt(ie,te,St){return Math.atan(te/(ie*Math.tan(St)))}function J(ie,te,St,qt,$t,Ct){return St*Math.cos($t)*Math.cos(Ct)-qt*Math.sin($t)*Math.sin(Ct)+ie}function vt(ie,te,St,qt,$t,Ct){return St*Math.sin($t)*Math.cos(Ct)+qt*Math.cos($t)*Math.sin(Ct)+te}function W(ie,te,St,qt){var $t=Math.atan2(qt*ie,St*te);return($t+Math.PI*2)%(Math.PI*2)}function dt(ie,te,St){return{x:ie*Math.cos(St),y:te*Math.sin(St)}}function Vt(ie,te,St){var qt=Math.cos(St),$t=Math.sin(St);return[ie*qt-te*$t,ie*$t+te*qt]}var ne={box:function(ie,te,St,qt,$t,Ct,Tt){for(var ue=gt(St,qt,$t),Oe=1/0,We=-1/0,zt=[Ct,Tt],At=-Math.PI*2;At<=Math.PI*2;At+=Math.PI){var Mt=ue+At;Ct<Tt?Ct<Mt&&Mt<Tt&&zt.push(Mt):Tt<Mt&&Mt<Ct&&zt.push(Mt)}for(var At=0;At<zt.length;At++){var Rt=J(ie,te,St,qt,$t,zt[At]);Rt<Oe&&(Oe=Rt),Rt>We&&(We=Rt)}for(var tt=Pt(St,qt,$t),_t=1/0,Xt=-1/0,ve=[Ct,Tt],At=-Math.PI*2;At<=Math.PI*2;At+=Math.PI){var Wt=tt+At;Ct<Tt?Ct<Wt&&Wt<Tt&&ve.push(Wt):Tt<Wt&&Wt<Ct&&ve.push(Wt)}for(var At=0;At<ve.length;At++){var Me=vt(ie,te,St,qt,$t,ve[At]);Me<_t&&(_t=Me),Me>Xt&&(Xt=Me)}return{x:Oe,y:_t,width:We-Oe,height:Xt-_t}},length:function(ie,te,St,qt,$t,Ct,Tt){},nearestPoint:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe){var We=Vt(ue-ie,Oe-te,-$t),zt=We[0],At=We[1],Mt=ee.nearestPoint(0,0,St,qt,zt,At),Rt=W(St,qt,Mt.x,Mt.y);Rt<Ct?Mt=dt(St,qt,Ct):Rt>Tt&&(Mt=dt(St,qt,Tt));var tt=Vt(Mt.x,Mt.y,$t);return{x:tt[0]+ie,y:tt[1]+te}},pointDistance:function(ie,te,St,qt,$t,Ct,Tt,ue,Oe){var We=this.nearestPoint(ie,te,St,qt,ue,Oe);return I(We.x,We.y,ue,Oe)},pointAt:function(ie,te,St,qt,$t,Ct,Tt,ue){var Oe=(Tt-Ct)*ue+Ct;return{x:J(ie,te,St,qt,$t,Oe),y:vt(ie,te,St,qt,$t,Oe)}},tangentAngle:function(ie,te,St,qt,$t,Ct,Tt,ue){var Oe=(Tt-Ct)*ue+Ct,We=we(ie,te,St,qt,$t,Ct,Tt,Oe),zt=_e(ie,te,St,qt,$t,Ct,Tt,Oe);return ht(Math.atan2(zt,We))}};function ge(ie){for(var te=0,St=[],qt=0;qt<ie.length-1;qt++){var $t=ie[qt],Ct=ie[qt+1],Tt=I($t[0],$t[1],Ct[0],Ct[1]),ue={from:$t,to:Ct,length:Tt};St.push(ue),te+=Tt}return{segments:St,totalLength:te}}function $e(ie){if(ie.length<2)return 0;for(var te=0,St=0;St<ie.length-1;St++){var qt=ie[St],$t=ie[St+1];te+=I(qt[0],qt[1],$t[0],$t[1])}return te}function jt(ie,te){if(te>1||te<0||ie.length<2)return null;var St=ge(ie),qt=St.segments,$t=St.totalLength;if($t===0)return{x:ie[0][0],y:ie[0][1]};for(var Ct=0,Tt=null,ue=0;ue<qt.length;ue++){var Oe=qt[ue],We=Oe.from,zt=Oe.to,At=Oe.length/$t;if(te>=Ct&&te<=Ct+At){var Mt=(te-Ct)/At;Tt=et.pointAt(We[0],We[1],zt[0],zt[1],Mt);break}Ct+=At}return Tt}function Qt(ie,te){if(te>1||te<0||ie.length<2)return 0;for(var St=ge(ie),qt=St.segments,$t=St.totalLength,Ct=0,Tt=0,ue=0;ue<qt.length;ue++){var Oe=qt[ue],We=Oe.from,zt=Oe.to,At=Oe.length/$t;if(te>=Ct&&te<=Ct+At){Tt=Math.atan2(zt[1]-We[1],zt[0]-We[0]);break}Ct+=At}return Tt}function Te(ie,te,St){for(var qt=1/0,$t=0;$t<ie.length-1;$t++){var Ct=ie[$t],Tt=ie[$t+1],ue=et.pointDistance(Ct[0],Ct[1],Tt[0],Tt[1],te,St);ue<qt&&(qt=ue)}return qt}var ae={box:function(ie){for(var te=[],St=[],qt=0;qt<ie.length;qt++){var $t=ie[qt];te.push($t[0]),St.push($t[1])}return q(te,St)},length:function(ie){return $e(ie)},pointAt:function(ie,te){return jt(ie,te)},pointDistance:function(ie,te,St){return Te(ie,te,St)},tangentAngle:function(ie,te){return Qt(ie,te)}};function Ke(ie){var te=ie.slice(0);return ie.length&&te.push(ie[0]),te}var or={box:function(ie){return ae.box(ie)},length:function(ie){return $e(Ke(ie))},pointAt:function(ie,te){return jt(Ke(ie),te)},pointDistance:function(ie,te,St){return Te(Ke(ie),te,St)},tangentAngle:function(ie,te){return Qt(Ke(ie),te)}}},3083:function(vn,Ft,ot){"use strict";ot.d(Ft,{Bar:function(){return Zw},Column:function(){return Vw},Pie:function(){return Fx}});var Lt={};ot.r(Lt),ot.d(Lt,{assign:function(){return rs},default:function(){return ba},defaultI18n:function(){return sc},format:function(){return Gn},parse:function(){return $i},setGlobalDateI18n:function(){return nl},setGlobalDateMasks:function(){return Ln}});var wt={};ot.r(wt),ot.d(wt,{Arc:function(){return Be},DataMarker:function(){return xr},DataRegion:function(){return Rr},Html:function(){return Ra},Image:function(){return br},Line:function(){return ft},Region:function(){return cr},RegionFilter:function(){return ln},Shape:function(){return Zn},Text:function(){return re}});var I={};ot.r(I),ot.d(I,{ellipsisHead:function(){return da},ellipsisMiddle:function(){return ss},ellipsisTail:function(){return Ds},getDefault:function(){return pa}});var Et={};ot.r(Et),ot.d(Et,{equidistance:function(){return cl},equidistanceWithReverseBoth:function(){return yh},getDefault:function(){return Du},reserveBoth:function(){return Kl},reserveFirst:function(){return kc},reserveLast:function(){return qu}});var q={};ot.r(q),ot.d(q,{fixedAngle:function(){return Yf},getDefault:function(){return _h},unfixedAngle:function(){return dc}});var lt={};ot.r(lt),ot.d(lt,{autoEllipsis:function(){return I},autoHide:function(){return Et},autoRotate:function(){return q}});var ht={};ot.r(ht),ot.d(ht,{Base:function(){return vc},Circle:function(){return qc},Html:function(){return Jc},Line:function(){return wl}});var ct={};ot.r(ct),ot.d(ct,{CONTAINER_CLASS:function(){return ef},CROSSHAIR_X:function(){return qf},CROSSHAIR_Y:function(){return Ad},LIST_CLASS:function(){return Pc},LIST_ITEM_CLASS:function(){return Vp},MARKER_CLASS:function(){return Sh},NAME_CLASS:function(){return Ns},TITLE_CLASS:function(){return Cl},VALUE_CLASS:function(){return fv}});var et={};ot.r(et),ot.d(et,{Base:function(){return Of},Circle:function(){return q_},Ellipse:function(){return Hd},Image:function(){return Qg},Line:function(){return bp},Marker:function(){return Qm},Path:function(){return J_},Polygon:function(){return d2},Polyline:function(){return g2},Rect:function(){return x2},Text:function(){return E2}});var Ee={};ot.r(Ee),ot.d(Ee,{Canvas:function(){return C2},Group:function(){return Fv},Shape:function(){return et},getArcParams:function(){return Tv},version:function(){return xc}});var it={};ot.r(it),ot.d(it,{Base:function(){return Dh},Circle:function(){return mT},Dom:function(){return _T},Ellipse:function(){return L2},Image:function(){return O2},Line:function(){return bT},Marker:function(){return wT},Path:function(){return CT},Polygon:function(){return TT},Polyline:function(){return IT},Rect:function(){return FT},Text:function(){return N2}});var st={};ot.r(st),ot.d(st,{Canvas:function(){return HT},Group:function(){return ey},Shape:function(){return it},version:function(){return Wd}});var Zt={};ot.r(Zt),ot.d(Zt,{cluster:function(){return JC},hierarchy:function(){return Tg},pack:function(){return qy},packEnclose:function(){return Jx},packSiblings:function(){return eF},partition:function(){return Mb},stratify:function(){return iL},tree:function(){return kb},treemap:function(){return oL},treemapBinary:function(){return __},treemapDice:function(){return Tm},treemapResquarify:function(){return aA},treemapSlice:function(){return y_},treemapSliceDice:function(){return Lm},treemapSquarify:function(){return iA}});var P=ot(70655),b=ot(45098),X;(function(r){r.FORE="fore",r.MID="mid",r.BG="bg"})(X||(X={}));var le;(function(r){r.TOP="top",r.TOP_LEFT="top-left",r.TOP_RIGHT="top-right",r.RIGHT="right",r.RIGHT_TOP="right-top",r.RIGHT_BOTTOM="right-bottom",r.LEFT="left",r.LEFT_TOP="left-top",r.LEFT_BOTTOM="left-bottom",r.BOTTOM="bottom",r.BOTTOM_LEFT="bottom-left",r.BOTTOM_RIGHT="bottom-right",r.RADIUS="radius",r.CIRCLE="circle",r.NONE="none"})(le||(le={}));var Se;(function(r){r.AXIS="axis",r.GRID="grid",r.LEGEND="legend",r.TOOLTIP="tooltip",r.ANNOTATION="annotation",r.SLIDER="slider",r.SCROLLBAR="scrollbar",r.OTHER="other"})(Se||(Se={}));var Ie={FORE:3,MID:2,BG:1},It;(function(r){r.BEFORE_RENDER="beforerender",r.AFTER_RENDER="afterrender",r.BEFORE_PAINT="beforepaint",r.AFTER_PAINT="afterpaint",r.BEFORE_CHANGE_DATA="beforechangedata",r.AFTER_CHANGE_DATA="afterchangedata",r.BEFORE_CLEAR="beforeclear",r.AFTER_CLEAR="afterclear",r.BEFORE_DESTROY="beforedestroy",r.BEFORE_CHANGE_SIZE="beforechangesize",r.AFTER_CHANGE_SIZE="afterchangesize"})(It||(It={}));var rt;(function(r){r.BEFORE_DRAW_ANIMATE="beforeanimate",r.AFTER_DRAW_ANIMATE="afteranimate",r.BEFORE_RENDER_LABEL="beforerenderlabel",r.AFTER_RENDER_LABEL="afterrenderlabel"})(rt||(rt={}));var Dt;(function(r){r.MOUSE_ENTER="plot:mouseenter",r.MOUSE_DOWN="plot:mousedown",r.MOUSE_MOVE="plot:mousemove",r.MOUSE_UP="plot:mouseup",r.MOUSE_LEAVE="plot:mouseleave",r.TOUCH_START="plot:touchstart",r.TOUCH_MOVE="plot:touchmove",r.TOUCH_END="plot:touchend",r.TOUCH_CANCEL="plot:touchcancel",r.CLICK="plot:click",r.DBLCLICK="plot:dblclick",r.CONTEXTMENU="plot:contextmenu",r.LEAVE="plot:leave",r.ENTER="plot:enter"})(Dt||(Dt={}));var Ae;(function(r){r.ACTIVE="active",r.INACTIVE="inactive",r.SELECTED="selected",r.DEFAULT="default"})(Ae||(Ae={}));var be=["color","shape","size"],me="_origin",ee=1,we=1,_e=.25,gt={};function Pt(r){var e=gt[r];if(!e)throw new Error("G engine '".concat(r,"' is not exist, please register it at first."));return e}function J(r,e){gt[r]=e}var vt=ot(6056),W=ot(45442);function dt(r){var e=getComputedStyle(r);return{width:(r.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10),height:(r.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)}}function Vt(r){return typeof r=="number"&&!isNaN(r)}function ne(r,e,t,i){var u=t,c=i;if(e){var p=dt(r);u=p.width?p.width:u,c=p.height?p.height:c}return{width:Math.max(Vt(u)?u:ee,ee),height:Math.max(Vt(c)?c:we,we)}}function ge(r){var e=r.parentNode;e&&e.removeChild(r)}var $e=ot(90494),jt=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this)||this;i.destroyed=!1;var u=t.visible,c=u===void 0?!0:u;return i.visible=c,i}return e.prototype.show=function(){var t=this.visible;t||this.changeVisible(!0)},e.prototype.hide=function(){var t=this.visible;t&&this.changeVisible(!1)},e.prototype.destroy=function(){this.off(),this.destroyed=!0},e.prototype.changeVisible=function(t){this.visible!==t&&(this.visible=t)},e}($e.Z),Qt=jt,Te=ot(98190),ae=0,Ke=1/2,or=1/2,ie=.05,te=function(){function r(e){var t=e.xField,i=e.yField,u=e.adjustNames,c=u===void 0?["x","y"]:u,p=e.dimValuesMap;this.adjustNames=c,this.xField=t,this.yField=i,this.dimValuesMap=p}return r.prototype.isAdjust=function(e){return this.adjustNames.indexOf(e)>=0},r.prototype.getAdjustRange=function(e,t,i){var u=this.yField,c=i.indexOf(t),p=i.length,g,_;return!u&&this.isAdjust("y")?(g=0,_=1):p>1?(g=i[c===0?0:c-1],_=i[c===p-1?p-1:c+1],c!==0?g+=(t-g)/2:g-=(_-t)/2,c!==p-1?_-=(_-t)/2:_+=(t-i[p-2])/2):(g=t===0?0:t-.5,_=t===0?1:t+.5),{pre:g,next:_}},r.prototype.adjustData=function(e,t){var i=this,u=this.getDimValues(t);b.S6(e,function(c,p){b.S6(u,function(g,_){i.adjustDim(_,g,c,p)})})},r.prototype.groupData=function(e,t){return b.S6(e,function(i){i[t]===void 0&&(i[t]=ae)}),b.vM(e,t)},r.prototype.adjustDim=function(e,t,i,u){},r.prototype.getDimValues=function(e){var t=this,i=t.xField,u=t.yField,c=b.f0({},this.dimValuesMap),p=[];if(i&&this.isAdjust("x")&&p.push(i),u&&this.isAdjust("y")&&p.push(u),p.forEach(function(_){c&&c[_]||(c[_]=b.I(e,_).sort(function(S,k){return S-k}))}),!u&&this.isAdjust("y")){var g="y";c[g]=[ae,1]}return c},r}(),St=te,qt={},$t=function(r){return qt[r.toLowerCase()]},Ct=function(r,e){if($t(r))throw new Error("Adjust type '"+r+"' existed.");qt[r.toLowerCase()]=e},Tt=ot(77190),ue=ot.n(Tt);var Oe=function(e,t){return Oe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,u){i.__proto__=u}||function(i,u){for(var c in u)u.hasOwnProperty(c)&&(i[c]=u[c])},Oe(e,t)};function We(r,e){Oe(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var zt=function(){return zt=Object.assign||function(t){for(var i,u=1,c=arguments.length;u<c;u++){i=arguments[u];for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&(t[p]=i[p])}return t},zt.apply(this,arguments)};function At(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,i=Object.getOwnPropertySymbols(r);u<i.length;u++)e.indexOf(i[u])<0&&Object.prototype.propertyIsEnumerable.call(r,i[u])&&(t[i[u]]=r[i[u]]);return t}function Mt(r,e,t,i){var u=arguments.length,c=u<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,p;if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,i);else for(var g=r.length-1;g>=0;g--)(p=r[g])&&(c=(u<3?p(c):u>3?p(e,t,c):p(e,t))||c);return u>3&&c&&Object.defineProperty(e,t,c),c}function Rt(r,e){return function(t,i){e(t,i,r)}}function tt(r,e){if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function _t(r,e,t,i){function u(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function g(k){try{S(i.next(k))}catch(L){p(L)}}function _(k){try{S(i.throw(k))}catch(L){p(L)}}function S(k){k.done?c(k.value):u(k.value).then(g,_)}S((i=i.apply(r,e||[])).next())})}function Xt(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,u,c,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(S){return function(k){return _([S,k])}}function _(S){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,u&&(c=S[0]&2?u.return:S[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,S[1])).done)return c;switch(u=0,c&&(S=[S[0]&2,c.value]),S[0]){case 0:case 1:c=S;break;case 4:return t.label++,{value:S[1],done:!1};case 5:t.label++,u=S[1],S=[0];continue;case 7:S=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(S[0]===6||S[0]===2)){t=0;continue}if(S[0]===3&&(!c||S[1]>c[0]&&S[1]<c[3])){t.label=S[1];break}if(S[0]===6&&t.label<c[1]){t.label=c[1],c=S;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(S);break}c[2]&&t.ops.pop(),t.trys.pop();continue}S=e.call(r,t)}catch(k){S=[6,k],u=0}finally{i=c=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}}function ve(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function Wt(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Me(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function je(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),u,c=[],p;try{for(;(e===void 0||e-- >0)&&!(u=i.next()).done;)c.push(u.value)}catch(g){p={error:g}}finally{try{u&&!u.done&&(t=i.return)&&t.call(i)}finally{if(p)throw p.error}}return c}function Qe(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(je(arguments[e]));return r}function hr(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),u=0,e=0;e<t;e++)for(var c=arguments[e],p=0,g=c.length;p<g;p++,u++)i[u]=c[p];return i}function er(r){return this instanceof er?(this.v=r,this):new er(r)}function Br(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),u,c=[];return u={},p("next"),p("throw"),p("return"),u[Symbol.asyncIterator]=function(){return this},u;function p(R){i[R]&&(u[R]=function(U){return new Promise(function(G,Q){c.push([R,U,G,Q])>1||g(R,U)})})}function g(R,U){try{_(i[R](U))}catch(G){L(c[0][3],G)}}function _(R){R.value instanceof er?Promise.resolve(R.value.v).then(S,k):L(c[0][2],R)}function S(R){g("next",R)}function k(R){g("throw",R)}function L(R,U){R(U),c.shift(),c.length&&g(c[0][0],c[0][1])}}function Lr(r){var e,t;return e={},i("next"),i("throw",function(u){throw u}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(u,c){e[u]=r[u]?function(p){return(t=!t)?{value:er(r[u](p)),done:u==="return"}:c?c(p):p}:c}}function Zr(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Me=="function"?Me(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=r[c]&&function(p){return new Promise(function(g,_){p=r[c](p),u(g,_,p.done,p.value)})}}function u(c,p,g,_){Promise.resolve(_).then(function(S){c({value:S,done:g})},p)}}function Tn(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function rn(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function Nn(r){return r&&r.__esModule?r:{default:r}}function zn(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function jn(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var wn=function(r){We(e,r);function e(t){var i=r.call(this,t)||this;i.cacheMap={},i.adjustDataArray=[],i.mergeData=[];var u=t.marginRatio,c=u===void 0?Ke:u,p=t.dodgeRatio,g=p===void 0?or:p,_=t.dodgeBy,S=t.intervalPadding,k=t.dodgePadding,L=t.xDimensionLength,R=t.groupNum,U=t.defaultSize,G=t.maxColumnWidth,Q=t.minColumnWidth,pt=t.columnWidthRatio,yt=t.customOffset;return i.marginRatio=c,i.dodgeRatio=g,i.dodgeBy=_,i.intervalPadding=S,i.dodgePadding=k,i.xDimensionLegenth=L,i.groupNum=R,i.defaultSize=U,i.maxColumnWidth=G,i.minColumnWidth=Q,i.columnWidthRatio=pt,i.customOffset=yt,i}return e.prototype.process=function(t){var i=b.d9(t),u=b.xH(i),c=this.dodgeBy,p=c?b.ru(u,c):i;return this.cacheMap={},this.adjustDataArray=p,this.mergeData=u,this.adjustData(p,u),this.adjustDataArray=[],this.mergeData=[],i},e.prototype.adjustDim=function(t,i,u,c){var p=this,g=this.customOffset,_=this.getDistribution(t),S=this.groupData(u,t);return b.S6(S,function(k,L){var R;i.length===1?R={pre:i[0]-1,next:i[0]+1}:R=p.getAdjustRange(t,parseFloat(L),i),b.S6(k,function(U){var G=U[t],Q=_[G],pt=Q.indexOf(c);if(b.UM(g))U[t]=p.getDodgeOffset(R,pt,Q.length);else{var yt=R.pre,Ht=R.next;U[t]=b.mf(g)?g(U,R):(yt+Ht)/2+g}})}),[]},e.prototype.getDodgeOffset=function(t,i,u){var c=this,p=c.dodgeRatio,g=c.marginRatio,_=c.intervalPadding,S=c.dodgePadding,k=t.pre,L=t.next,R=L-k,U;if(!b.UM(_)&&b.UM(S)&&_>=0){var G=this.getIntervalOnlyOffset(u,i);U=k+G}else if(!b.UM(S)&&b.UM(_)&&S>=0){var G=this.getDodgeOnlyOffset(u,i);U=k+G}else if(!b.UM(_)&&!b.UM(S)&&_>=0&&S>=0){var G=this.getIntervalAndDodgeOffset(u,i);U=k+G}else{var Q=R*p/u,pt=g*Q,G=1/2*(R-u*Q-(u-1)*pt)+((i+1)*Q+i*pt)-1/2*Q-1/2*R;U=(k+L)/2+G}return U},e.prototype.getIntervalOnlyOffset=function(t,i){var u=this,c=u.defaultSize,p=u.intervalPadding,g=u.xDimensionLegenth,_=u.groupNum,S=u.dodgeRatio,k=u.maxColumnWidth,L=u.minColumnWidth,R=u.columnWidthRatio,U=p/g,G=(1-(_-1)*U)/_*S/(t-1),Q=((1-U*(_-1))/_-G*(t-1))/t;if(Q=b.UM(R)?Q:1/_/t*R,!b.UM(k)){var pt=k/g;Q=Math.min(Q,pt)}if(!b.UM(L)){var yt=L/g;Q=Math.max(Q,yt)}Q=c?c/g:Q,G=((1-(_-1)*U)/_-t*Q)/(t-1);var Ht=((1/2+i)*Q+i*G+1/2*U)*_-U/2;return Ht},e.prototype.getDodgeOnlyOffset=function(t,i){var u=this,c=u.defaultSize,p=u.dodgePadding,g=u.xDimensionLegenth,_=u.groupNum,S=u.marginRatio,k=u.maxColumnWidth,L=u.minColumnWidth,R=u.columnWidthRatio,U=p/g,G=1*S/(_-1),Q=((1-G*(_-1))/_-U*(t-1))/t;if(Q=R?1/_/t*R:Q,!b.UM(k)){var pt=k/g;Q=Math.min(Q,pt)}if(!b.UM(L)){var yt=L/g;Q=Math.max(Q,yt)}Q=c?c/g:Q,G=(1-(Q*t+U*(t-1))*_)/(_-1);var Ht=((1/2+i)*Q+i*U+1/2*G)*_-G/2;return Ht},e.prototype.getIntervalAndDodgeOffset=function(t,i){var u=this,c=u.intervalPadding,p=u.dodgePadding,g=u.xDimensionLegenth,_=u.groupNum,S=c/g,k=p/g,L=((1-S*(_-1))/_-k*(t-1))/t,R=((1/2+i)*L+i*k+1/2*S)*_-S/2;return R},e.prototype.getDistribution=function(t){var i=this.adjustDataArray,u=this.cacheMap,c=u[t];return c||(c={},b.S6(i,function(p,g){var _=b.I(p,t);_.length||_.push(0),b.S6(_,function(S){c[S]||(c[S]=[]),c[S].push(g)})}),u[t]=c),c},e}(St),Wn=wn;function Bt(r,e){return(e-r)*Math.random()+r}var Yt=function(r){We(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.process=function(t){var i=b.d9(t),u=b.xH(i);return this.adjustData(i,u),i},e.prototype.adjustDim=function(t,i,u){var c=this,p=this.groupData(u,t);return b.S6(p,function(g,_){return c.adjustGroup(g,t,parseFloat(_),i)})},e.prototype.getAdjustOffset=function(t){var i=t.pre,u=t.next,c=(u-i)*ie;return Bt(i+c,u-c)},e.prototype.adjustGroup=function(t,i,u,c){var p=this,g=this.getAdjustRange(i,u,c);return b.S6(t,function(_){_[i]=p.getAdjustOffset(g)}),t},e}(St),oe=Yt,Ce=b.Ct,Ue=function(r){We(e,r);function e(t){var i=r.call(this,t)||this,u=t.adjustNames,c=u===void 0?["y"]:u,p=t.height,g=p===void 0?NaN:p,_=t.size,S=_===void 0?10:_,k=t.reverseOrder,L=k===void 0?!1:k;return i.adjustNames=c,i.height=g,i.size=S,i.reverseOrder=L,i}return e.prototype.process=function(t){var i=this,u=i.yField,c=i.reverseOrder,p=u?this.processStack(t):this.processOneDimStack(t);return c?this.reverse(p):p},e.prototype.reverse=function(t){return t.slice(0).reverse()},e.prototype.processStack=function(t){var i=this,u=i.xField,c=i.yField,p=i.reverseOrder,g=p?this.reverse(t):t,_=new Ce,S=new Ce;return g.map(function(k){return k.map(function(L){var R,U=b.U2(L,u,0),G=b.U2(L,[c]),Q=U.toString();if(G=b.kJ(G)?G[1]:G,!b.UM(G)){var pt=G>=0?_:S;pt.has(Q)||pt.set(Q,0);var yt=pt.get(Q),Ht=G+yt;return pt.set(Q,Ht),zt(zt({},L),(R={},R[c]=[yt,Ht],R))}return L})})},e.prototype.processOneDimStack=function(t){var i=this,u=this,c=u.xField,p=u.height,g=u.reverseOrder,_="y",S=g?this.reverse(t):t,k=new Ce;return S.map(function(L){return L.map(function(R){var U,G=i.size,Q=R[c],pt=G*2/p;k.has(Q)||k.set(Q,pt/2);var yt=k.get(Q);return k.set(Q,yt+pt),zt(zt({},R),(U={},U[_]=yt,U))})})},e}(St),fr=Ue,Sr=function(r){We(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.process=function(t){var i=b.xH(t),u=this,c=u.xField,p=u.yField,g=this.getXValuesMaxMap(i),_=Math.max.apply(Math,Object.keys(g).map(function(S){return g[S]}));return b.UI(t,function(S){return b.UI(S,function(k){var L,R,U=k[p],G=k[c];if(b.kJ(U)){var Q=(_-g[G])/2;return zt(zt({},k),(L={},L[p]=b.UI(U,function(yt){return Q+yt}),L))}var pt=(_-U)/2;return zt(zt({},k),(R={},R[p]=[pt,U+pt],R))})})},e.prototype.getXValuesMaxMap=function(t){var i=this,u=this,c=u.xField,p=u.yField,g=b.vM(t,function(_){return _[c]});return b.Q8(g,function(_){return i.getDimMaxValue(_,p)})},e.prototype.getDimMaxValue=function(t,i){var u=b.UI(t,function(p){return b.U2(p,i,[])}),c=b.xH(u);return Math.max.apply(Math,c)},e}(St),Pe=Sr;Ct("Dodge",Wn),Ct("Jitter",oe),Ct("Stack",fr),Ct("Symmetric",Pe);var ur=function(r,e){return(0,b.HD)(e)?e:r.invert(r.scale(e))},Wr=function(){function r(e){this.names=[],this.scales=[],this.linear=!1,this.values=[],this.callback=function(){return[]},this._parseCfg(e)}return r.prototype.mapping=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var u=t.map(function(c,p){return e._toOriginParam(c,e.scales[p])});return this.callback.apply(this,u)},r.prototype.getLinearValue=function(e){var t=this.values.length-1,i=Math.floor(t*e),u=t*e-i,c=this.values[i],p=i===t?c:this.values[i+1];return c+(p-c)*u},r.prototype.getNames=function(){for(var e=this.scales,t=this.names,i=Math.min(e.length,t.length),u=[],c=0;c<i;c+=1)u.push(t[c]);return u},r.prototype.getFields=function(){return this.scales.map(function(e){return e.field})},r.prototype.getScale=function(e){return this.scales[this.names.indexOf(e)]},r.prototype.defaultCallback=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.length===0?this.values:t.map(function(u,c){var p=e.scales[c];return p.type==="identity"?p.values[0]:e._getAttributeValue(p,u)})},r.prototype._parseCfg=function(e){var t=this,i=e.type,u=i===void 0?"base":i,c=e.names,p=c===void 0?[]:c,g=e.scales,_=g===void 0?[]:g,S=e.values,k=S===void 0?[]:S,L=e.callback;this.type=u,this.scales=_,this.values=k,this.names=p,this.callback=function(){for(var R=[],U=0;U<arguments.length;U++)R[U]=arguments[U];if(L){var G=L.apply(void 0,R);if(!(0,b.UM)(G))return[G]}return t.defaultCallback.apply(t,R)}},r.prototype._getAttributeValue=function(e,t){if(e.isCategory&&!this.linear){var i=e.translate(t);return this.values[i%this.values.length]}var u=e.scale(t);return this.getLinearValue(u)},r.prototype._toOriginParam=function(e,t){return t.isLinear?e:(0,b.kJ)(e)?e.map(function(i){return ur(t,i)}):ur(t,e)},r}(),Sn=Wr;var qr=function(e,t){return qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,u){i.__proto__=u}||function(i,u){for(var c in u)u.hasOwnProperty(c)&&(i[c]=u[c])},qr(e,t)};function Qr(r,e){qr(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Mn=function(){return Mn=Object.assign||function(t){for(var i,u=1,c=arguments.length;u<c;u++){i=arguments[u];for(var p in i)Object.prototype.hasOwnProperty.call(i,p)&&(t[p]=i[p])}return t},Mn.apply(this,arguments)};function bi(r,e){var t={};for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,i=Object.getOwnPropertySymbols(r);u<i.length;u++)e.indexOf(i[u])<0&&Object.prototype.propertyIsEnumerable.call(r,i[u])&&(t[i[u]]=r[i[u]]);return t}function Si(r,e,t,i){var u=arguments.length,c=u<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,p;if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(r,e,t,i);else for(var g=r.length-1;g>=0;g--)(p=r[g])&&(c=(u<3?p(c):u>3?p(e,t,c):p(e,t))||c);return u>3&&c&&Object.defineProperty(e,t,c),c}function Kr(r,e){return function(t,i){e(t,i,r)}}function ai(r,e){if((typeof Reflect=="undefined"?"undefined":_typeof(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function li(r,e,t,i){function u(c){return c instanceof t?c:new t(function(p){p(c)})}return new(t||(t=Promise))(function(c,p){function g(k){try{S(i.next(k))}catch(L){p(L)}}function _(k){try{S(i.throw(k))}catch(L){p(L)}}function S(k){k.done?c(k.value):u(k.value).then(g,_)}S((i=i.apply(r,e||[])).next())})}function hi(r,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},i,u,c,p;return p={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function g(S){return function(k){return _([S,k])}}function _(S){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,u&&(c=S[0]&2?u.return:S[0]?u.throw||((c=u.return)&&c.call(u),0):u.next)&&!(c=c.call(u,S[1])).done)return c;switch(u=0,c&&(S=[S[0]&2,c.value]),S[0]){case 0:case 1:c=S;break;case 4:return t.label++,{value:S[1],done:!1};case 5:t.label++,u=S[1],S=[0];continue;case 7:S=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(S[0]===6||S[0]===2)){t=0;continue}if(S[0]===3&&(!c||S[1]>c[0]&&S[1]<c[3])){t.label=S[1];break}if(S[0]===6&&t.label<c[1]){t.label=c[1],c=S;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(S);break}c[2]&&t.ops.pop(),t.trys.pop();continue}S=e.call(r,t)}catch(k){S=[6,k],u=0}finally{i=c=0}if(S[0]&5)throw S[1];return{value:S[0]?S[1]:void 0,done:!0}}}function ra(r,e,t,i){i===void 0&&(i=t),r[i]=e[t]}function Ci(r,e){for(var t in r)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=r[t])}function Ba(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],i=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&i>=r.length&&(r=void 0),{value:r&&r[i++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function po(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var i=t.call(r),u,c=[],p;try{for(;(e===void 0||e-- >0)&&!(u=i.next()).done;)c.push(u.value)}catch(g){p={error:g}}finally{try{u&&!u.done&&(t=i.return)&&t.call(i)}finally{if(p)throw p.error}}return c}function za(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(po(arguments[e]));return r}function Xa(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var i=Array(r),u=0,e=0;e<t;e++)for(var c=arguments[e],p=0,g=c.length;p<g;p++,u++)i[u]=c[p];return i}function Ta(r){return this instanceof Ta?(this.v=r,this):new Ta(r)}function ga(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(r,e||[]),u,c=[];return u={},p("next"),p("throw"),p("return"),u[Symbol.asyncIterator]=function(){return this},u;function p(R){i[R]&&(u[R]=function(U){return new Promise(function(G,Q){c.push([R,U,G,Q])>1||g(R,U)})})}function g(R,U){try{_(i[R](U))}catch(G){L(c[0][3],G)}}function _(R){R.value instanceof Ta?Promise.resolve(R.value.v).then(S,k):L(c[0][2],R)}function S(R){g("next",R)}function k(R){g("throw",R)}function L(R,U){R(U),c.shift(),c.length&&g(c[0][0],c[0][1])}}function no(r){var e,t;return e={},i("next"),i("throw",function(u){throw u}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(u,c){e[u]=r[u]?function(p){return(t=!t)?{value:Ta(r[u](p)),done:u==="return"}:c?c(p):p}:c}}function Vo(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Ba=="function"?Ba(r):r[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(c){t[c]=r[c]&&function(p){return new Promise(function(g,_){p=r[c](p),u(g,_,p.done,p.value)})}}function u(c,p,g,_){Promise.resolve(_).then(function(S){c({value:S,done:g})},p)}}function vo(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}function ja(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function to(r){return r&&r.__esModule?r:{default:r}}function Uo(r,e){if(!e.has(r))throw new TypeError("attempted to get private field on non-instance");return e.get(r)}function ju(r,e,t){if(!e.has(r))throw new TypeError("attempted to set private field on non-instance");return e.set(r,t),t}var Wo=/rgba?\(([\s.,0-9]+)\)/,bo=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,nr=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,xe=/[\d.]+:(#[^\s]+|[^\)]+\))/gi,He=function(r){return/^[r,R,L,l]{1}[\s]*\(/.test(r)},Mr=function(){var r=document.createElement("i");return r.title="Web Colour Picker",r.style.display="none",document.body.appendChild(r),r},tn=function(r,e,t,i){return r[i]+(e[i]-r[i])*t};function In(r){return"#"+Cn(r[0])+Cn(r[1])+Cn(r[2])}var Un=function(r){return[parseInt(r.substr(1,2),16),parseInt(r.substr(3,2),16),parseInt(r.substr(5,2),16)]},Cn=function(r){var e=Math.round(r).toString(16);return e.length===1?"0"+e:e},ta=function(r,e){var t=isNaN(Number(e))||e<0?0:e>1?1:Number(e),i=r.length-1,u=Math.floor(i*t),c=i*t-u,p=r[u],g=u===i?p:r[u+1];return In([tn(p,g,c,0),tn(p,g,c,1),tn(p,g,c,2)])},Wa,es=function(r){if(r[0]==="#"&&r.length===7)return r;Wa||(Wa=Mr()),Wa.style.color=r;var e=document.defaultView.getComputedStyle(Wa,"").getPropertyValue("color"),t=Wo.exec(e),i=t[1].split(/\s*,\s*/).map(function(u){return Number(u)});return e=In(i),e},ko=function(r){var e=(0,b.HD)(r)?r.split("-"):r,t=(0,b.UI)(e,function(i){return Un(i.indexOf("#")===-1?es(i):i)});return function(i){return ta(t,i)}},ns=function(r){if(He(r)){var e,t=void 0;if(r[0]==="l"){var i=bo.exec(r),u=+i[1]+90;t=i[2],e="linear-gradient("+u+"deg, "}else if(r[0]==="r"){e="radial-gradient(";var i=nr.exec(r);t=i[4]}var c=t.match(xe);return(0,b.S6)(c,function(p,g){var _=p.split(":");e+=_[1]+" "+_[0]*100+"%",g!==c.length-1&&(e+=", ")}),e+=")",e}return r},Ya={rgb2arr:Un,gradient:ko,toRGB:(0,b.HP)(es),toCSSGradient:ns},Go=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="color",i.names=["color"],(0,b.HD)(i.values)&&(i.linear=!0),i.gradient=Ya.gradient(i.values),i}return e.prototype.getLinearValue=function(t){return this.gradient(t)},e}(Sn),pu=Go,ys=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="opacity",i.names=["opacity"],i}return e}(Sn),Rl=ys,mf=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.names=["x","y"],i.type="position",i}return e.prototype.mapping=function(t,i){var u=this.scales,c=u[0],p=u[1];return(0,b.UM)(t)||(0,b.UM)(i)?[]:[(0,b.kJ)(t)?t.map(function(g){return c.scale(g)}):c.scale(t),(0,b.kJ)(i)?i.map(function(g){return p.scale(g)}):p.scale(i)]},e}(Sn),Wu=mf,ke=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="shape",i.names=["shape"],i}return e.prototype.getLinearValue=function(t){var i=Math.round((this.values.length-1)*t);return this.values[i]},e}(Sn),Xe=ke,Tr=function(r){Qr(e,r);function e(t){var i=r.call(this,t)||this;return i.type="size",i.names=["size"],i}return e}(Sn),un=Tr,si={};function ji(r){return si[r]}function Ma(r,e){si[r]=e}var ds=function(){function r(e){this.type="base",this.isCategory=!1,this.isLinear=!1,this.isContinuous=!1,this.isIdentity=!1,this.values=[],this.range=[0,1],this.ticks=[],this.__cfg__=e,this.initCfg(),this.init()}return r.prototype.translate=function(e){return e},r.prototype.change=function(e){(0,b.f0)(this.__cfg__,e),this.init()},r.prototype.clone=function(){return this.constructor(this.__cfg__)},r.prototype.getTicks=function(){var e=this;return(0,b.UI)(this.ticks,function(t,i){return(0,b.Kn)(t)?t:{text:e.getText(t,i),tickValue:t,value:e.scale(t)}})},r.prototype.getText=function(e,t){var i=this.formatter,u=i?i(e,t):e;return(0,b.UM)(u)||!(0,b.mf)(u.toString)?"":u.toString()},r.prototype.getConfig=function(e){return this.__cfg__[e]},r.prototype.init=function(){(0,b.f0)(this,this.__cfg__),this.setDomain(),(0,b.xb)(this.getConfig("ticks"))&&(this.ticks=this.calculateTicks())},r.prototype.initCfg=function(){},r.prototype.setDomain=function(){},r.prototype.calculateTicks=function(){var e=this.tickMethod,t=[];if((0,b.HD)(e)){var i=ji(e);if(!i)throw new Error("There is no method to to calculate ticks!");t=i(this)}else(0,b.mf)(e)&&(t=e(this));return t},r.prototype.rangeMin=function(){return this.range[0]},r.prototype.rangeMax=function(){return this.range[1]},r.prototype.calcPercent=function(e,t,i){return(0,b.hj)(e)?(e-t)/(i-t):NaN},r.prototype.calcValue=function(e,t,i){return t+e*(i-t)},r}(),Ho=ds,qo=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="cat",t.isCategory=!0,t}return e.prototype.buildIndexMap=function(){if(!this.translateIndexMap){this.translateIndexMap=new Map;for(var t=0;t<this.values.length;t++)this.translateIndexMap.set(this.values[t],t)}},e.prototype.translate=function(t){this.buildIndexMap();var i=this.translateIndexMap.get(t);return i===void 0&&(i=(0,b.hj)(t)?t:NaN),i},e.prototype.scale=function(t){var i=this.translate(t),u=this.calcPercent(i,this.min,this.max);return this.calcValue(u,this.rangeMin(),this.rangeMax())},e.prototype.invert=function(t){var i=this.max-this.min,u=this.calcPercent(t,this.rangeMin(),this.rangeMax()),c=Math.round(i*u)+this.min;return c<this.min||c>this.max?NaN:this.values[c]},e.prototype.getText=function(t){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var c=t;return(0,b.hj)(t)&&!this.values.includes(t)&&(c=this.values[c]),r.prototype.getText.apply(this,(0,P.pr)([c],i))},e.prototype.initCfg=function(){this.tickMethod="cat"},e.prototype.setDomain=function(){if((0,b.UM)(this.getConfig("min"))&&(this.min=0),(0,b.UM)(this.getConfig("max"))){var t=this.values.length;this.max=t>1?t-1:t}this.translateIndexMap&&(this.translateIndexMap=void 0)},e}(Ho),Hs=qo,Xu=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|Z|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,_s="\\d\\d?",vs="\\d\\d",Ou="\\d{3}",rl="\\d{4}",nu="[^\\s]+",dl=/\[([^]*?)\]/gm;function Fu(r,e){for(var t=[],i=0,u=r.length;i<u;i++)t.push(r[i].substr(0,e));return t}var Fo=function(r){return function(e,t){var i=t[r].map(function(c){return c.toLowerCase()}),u=i.indexOf(e.toLowerCase());return u>-1?u:null}};function rs(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var i=0,u=e;i<u.length;i++){var c=u[i];for(var p in c)r[p]=c[p]}return r}var Uc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],_u=["January","February","March","April","May","June","July","August","September","October","November","December"],Zc=Fu(_u,3),Co=Fu(Uc,3),sc={dayNamesShort:Co,dayNames:Uc,monthNamesShort:Zc,monthNames:_u,amPm:["am","pm"],DoFn:function(r){return r+["th","st","nd","rd"][r%10>3?0:(r-r%10!==10?1:0)*r%10]}},Xl=rs({},sc),nl=function(r){return Xl=rs(Xl,r)},uc=function(r){return r.replace(/[|\\{()[^$+*?.-]/g,"\\$&")},D=function(r,e){for(e===void 0&&(e=2),r=String(r);r.length<e;)r="0"+r;return r},Y={D:function(r){return String(r.getDate())},DD:function(r){return D(r.getDate())},Do:function(r,e){return e.DoFn(r.getDate())},d:function(r){return String(r.getDay())},dd:function(r){return D(r.getDay())},ddd:function(r,e){return e.dayNamesShort[r.getDay()]},dddd:function(r,e){return e.dayNames[r.getDay()]},M:function(r){return String(r.getMonth()+1)},MM:function(r){return D(r.getMonth()+1)},MMM:function(r,e){return e.monthNamesShort[r.getMonth()]},MMMM:function(r,e){return e.monthNames[r.getMonth()]},YY:function(r){return D(String(r.getFullYear()),4).substr(2)},YYYY:function(r){return D(r.getFullYear(),4)},h:function(r){return String(r.getHours()%12||12)},hh:function(r){return D(r.getHours()%12||12)},H:function(r){return String(r.getHours())},HH:function(r){return D(r.getHours())},m:function(r){return String(r.getMinutes())},mm:function(r){return D(r.getMinutes())},s:function(r){return String(r.getSeconds())},ss:function(r){return D(r.getSeconds())},S:function(r){return String(Math.round(r.getMilliseconds()/100))},SS:function(r){return D(Math.round(r.getMilliseconds()/10),2)},SSS:function(r){return D(r.getMilliseconds(),3)},a:function(r,e){return r.getHours()<12?e.amPm[0]:e.amPm[1]},A:function(r,e){return r.getHours()<12?e.amPm[0].toUpperCase():e.amPm[1].toUpperCase()},ZZ:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+D(Math.floor(Math.abs(e)/60)*100+Math.abs(e)%60,4)},Z:function(r){var e=r.getTimezoneOffset();return(e>0?"-":"+")+D(Math.floor(Math.abs(e)/60),2)+":"+D(Math.abs(e)%60,2)}},bt=function(r){return+r-1},nt=[null,_s],se=[null,nu],Ve=["isPm",nu,function(r,e){var t=r.toLowerCase();return t===e.amPm[0]?0:t===e.amPm[1]?1:null}],wr=["timezoneOffset","[^\\s]*?[\\+\\-]\\d\\d:?\\d\\d|[^\\s]*?Z?",function(r){var e=(r+"").match(/([+-]|\d\d)/gi);if(e){var t=+e[1]*60+parseInt(e[2],10);return e[0]==="+"?t:-t}return 0}],jr={D:["day",_s],DD:["day",vs],Do:["day",_s+nu,function(r){return parseInt(r,10)}],M:["month",_s,bt],MM:["month",vs,bt],YY:["year",vs,function(r){var e=new Date,t=+(""+e.getFullYear()).substr(0,2);return+(""+(+r>68?t-1:t)+r)}],h:["hour",_s,void 0,"isPm"],hh:["hour",vs,void 0,"isPm"],H:["hour",_s],HH:["hour",vs],m:["minute",_s],mm:["minute",vs],s:["second",_s],ss:["second",vs],YYYY:["year",rl],S:["millisecond","\\d",function(r){return+r*100}],SS:["millisecond",vs,function(r){return+r*10}],SSS:["millisecond",Ou],d:nt,dd:nt,ddd:se,dddd:se,MMM:["month",nu,Fo("monthNamesShort")],MMMM:["month",nu,Fo("monthNames")],a:Ve,A:Ve,ZZ:wr,Z:wr},Vr={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",isoDate:"YYYY-MM-DD",isoDateTime:"YYYY-MM-DDTHH:mm:ssZ",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},Ln=function(r){return rs(Vr,r)},Gn=function(r,e,t){if(e===void 0&&(e=Vr.default),t===void 0&&(t={}),typeof r=="number"&&(r=new Date(r)),Object.prototype.toString.call(r)!=="[object Date]"||isNaN(r.getTime()))throw new Error("Invalid Date pass to format");e=Vr[e]||e;var i=[];e=e.replace(dl,function(c,p){return i.push(p),"@@@"});var u=rs(rs({},Xl),t);return e=e.replace(Xu,function(c){return Y[c](r,u)}),e.replace(/@@@/g,function(){return i.shift()})};function $i(r,e,t){if(t===void 0&&(t={}),typeof e!="string")throw new Error("Invalid format in fecha parse");if(e=Vr[e]||e,r.length>1e3)return null;var i=new Date,u={year:i.getFullYear(),month:0,day:1,hour:0,minute:0,second:0,millisecond:0,isPm:null,timezoneOffset:null},c=[],p=[],g=e.replace(dl,function(he,ze){return p.push(uc(ze)),"@@@"}),_={},S={};g=uc(g).replace(Xu,function(he){var ze=jr[he],Er=ze[0],Fr=ze[1],zr=ze[3];if(_[Er])throw new Error("Invalid format. "+Er+" specified twice in format");return _[Er]=!0,zr&&(S[zr]=!0),c.push(ze),"("+Fr+")"}),Object.keys(S).forEach(function(he){if(!_[he])throw new Error("Invalid format. "+he+" is required in specified format")}),g=g.replace(/@@@/g,function(){return p.shift()});var k=r.match(new RegExp(g,"i"));if(!k)return null;for(var L=rs(rs({},Xl),t),R=1;R<k.length;R++){var U=c[R-1],G=U[0],Q=U[2],pt=Q?Q(k[R],L):+k[R];if(pt==null)return null;u[G]=pt}u.isPm===1&&u.hour!=null&&+u.hour!=12?u.hour=+u.hour+12:u.isPm===0&&+u.hour==12&&(u.hour=0);var yt;if(u.timezoneOffset==null){yt=new Date(u.year,u.month,u.day,u.hour,u.minute,u.second,u.millisecond);for(var Ht=[["month","getMonth"],["day","getDate"],["hour","getHours"],["minute","getMinutes"],["second","getSeconds"]],R=0,ce=Ht.length;R<ce;R++)if(_[Ht[R][0]]&&u[Ht[R][0]]!==yt[Ht[R][1]]())return null}else if(yt=new Date(Date.UTC(u.year,u.month,u.day,u.hour,u.minute-u.timezoneOffset,u.second,u.millisecond)),u.month>11||u.month<0||u.day>31||u.day<1||u.hour>23||u.hour<0||u.minute>59||u.minute<0||u.second>59||u.second<0)return null;return yt}var Pa={format:Gn,parse:$i,defaultI18n:sc,setGlobalDateI18n:nl,setGlobalDateMasks:Ln},ba=Pa;function uo(r){return function(e,t,i,u){for(var c=(0,b.UM)(i)?0:i,p=(0,b.UM)(u)?e.length:u;c<p;){var g=c+p>>>1;r(e[g])>t?p=g:c=g+1}return c}}var Ca="format";function Ao(r,e){var t=Lt[Ca]||ba[Ca];return t(r,e)}function qa(r){return(0,b.HD)(r)&&(r.indexOf("T")>0?r=new Date(r).getTime():r=new Date(r.replace(/-/gi,"/")).getTime()),(0,b.J_)(r)&&(r=r.getTime()),r}var gs=1e3,xu=60*gs,il=60*xu,bu=24*il,iu=bu*31,Vc=bu*365,$s=[["HH:mm:ss",gs],["HH:mm:ss",gs*10],["HH:mm:ss",gs*30],["HH:mm",xu],["HH:mm",xu*10],["HH:mm",xu*30],["HH",il],["HH",il*6],["HH",il*12],["YYYY-MM-DD",bu],["YYYY-MM-DD",bu*4],["YYYY-WW",bu*7],["YYYY-MM",iu],["YYYY-MM",iu*4],["YYYY-MM",iu*6],["YYYY",bu*380]];function Yl(r,e,t){var i=(e-r)/t,u=uo(function(p){return p[1]})($s,i)-1,c=$s[u];return u<0?c=$s[0]:u>=$s.length&&(c=(0,b.Z$)($s)),c}var ye=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="timeCat",t}return e.prototype.translate=function(t){t=qa(t);var i=this.values.indexOf(t);return i===-1&&((0,b.hj)(t)&&t<this.values.length?i=t:i=NaN),i},e.prototype.getText=function(t,i){var u=this.translate(t);if(u>-1){var c=this.values[u],p=this.formatter;return c=p?p(c,i):Ao(c,this.mask),c}return t},e.prototype.initCfg=function(){this.tickMethod="time-cat",this.mask="YYYY-MM-DD",this.tickCount=7},e.prototype.setDomain=function(){var t=this.values;(0,b.S6)(t,function(i,u){t[u]=qa(i)}),t.sort(function(i,u){return i-u}),r.prototype.setDomain.call(this)},e}(Hs),ir=ye,Or=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isContinuous=!0,t}return e.prototype.scale=function(t){if((0,b.UM)(t))return NaN;var i=this.rangeMin(),u=this.rangeMax(),c=this.max,p=this.min;if(c===p)return i;var g=this.getScalePercent(t);return i+g*(u-i)},e.prototype.init=function(){r.prototype.init.call(this);var t=this.ticks,i=(0,b.YM)(t),u=(0,b.Z$)(t);i<this.min&&(this.min=i),u>this.max&&(this.max=u),(0,b.UM)(this.minLimit)||(this.min=i),(0,b.UM)(this.maxLimit)||(this.max=u)},e.prototype.setDomain=function(){var t=(0,b.rx)(this.values),i=t.min,u=t.max;(0,b.UM)(this.min)&&(this.min=i),(0,b.UM)(this.max)&&(this.max=u),this.min>this.max&&(this.min=i,this.max=u)},e.prototype.calculateTicks=function(){var t=this,i=r.prototype.calculateTicks.call(this);return this.nice||(i=(0,b.hX)(i,function(u){return u>=t.min&&u<=t.max})),i},e.prototype.getScalePercent=function(t){var i=this.max,u=this.min;return(t-u)/(i-u)},e.prototype.getInvertPercent=function(t){return(t-this.rangeMin())/(this.rangeMax()-this.rangeMin())},e}(Ho),$r=Or,xn=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="linear",t.isLinear=!0,t}return e.prototype.invert=function(t){var i=this.getInvertPercent(t);return this.min+i*(this.max-this.min)},e.prototype.initCfg=function(){this.tickMethod="wilkinson-extended",this.nice=!1},e}($r),_i=xn;function qi(r,e){var t=Math.E,i;return e>=0?i=Math.pow(t,Math.log(e)/r):i=Math.pow(t,Math.log(-e)/r)*-1,i}function Ia(r,e){return r===1?1:Math.log(e)/Math.log(r)}function du(r,e,t){(0,b.UM)(t)&&(t=Math.max.apply(null,r));var i=t;return(0,b.S6)(r,function(u){u>0&&u<i&&(i=u)}),i===t&&(i=t/e),i>1&&(i=1),i}function qs(r){var e=r.toString().split(/[eE]/),t=(e[0].split(".")[1]||"").length-+(e[1]||0);return t>0?t:0}function $a(r,e){var t=qs(r),i=qs(e),u=Math.pow(10,Math.max(t,i));return(r*u+e*u)/u}var Dl=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="log",t}return e.prototype.invert=function(t){var i=this.base,u=Ia(i,this.max),c=this.rangeMin(),p=this.rangeMax()-c,g,_=this.positiveMin;if(_){if(t===0)return 0;g=Ia(i,_/i);var S=1/(u-g)*p;if(t<S)return t/S*_}else g=Ia(i,this.min);var k=(t-c)/p,L=k*(u-g)+g;return Math.pow(i,L)},e.prototype.initCfg=function(){this.tickMethod="log",this.base=10,this.tickCount=6,this.nice=!0},e.prototype.setDomain=function(){r.prototype.setDomain.call(this);var t=this.min;if(t<0)throw new Error("When you use log scale, the minimum value must be greater than zero!");t===0&&(this.positiveMin=du(this.values,this.base,this.max))},e.prototype.getScalePercent=function(t){var i=this.max,u=this.min;if(i===u||t<=0)return 0;var c=this.base,p=this.positiveMin;p&&(u=p*1/c);var g;return t<p?g=t/p/(Ia(c,i)-Ia(c,u)):g=(Ia(c,t)-Ia(c,u))/(Ia(c,i)-Ia(c,u)),g},e}($r),av=Dl,yf=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pow",t}return e.prototype.invert=function(t){var i=this.getInvertPercent(t),u=this.exponent,c=qi(u,this.max),p=qi(u,this.min),g=i*(c-p)+p,_=g>=0?1:-1;return Math.pow(g,u)*_},e.prototype.initCfg=function(){this.tickMethod="pow",this.exponent=2,this.tickCount=5,this.nice=!0},e.prototype.getScalePercent=function(t){var i=this.max,u=this.min;if(i===u)return 0;var c=this.exponent,p=(qi(c,t)-qi(c,u))/(qi(c,i)-qi(c,u));return p},e}($r),vd=yf,ov=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="time",t}return e.prototype.getText=function(t,i){var u=this.translate(t),c=this.formatter;return c?c(u,i):Ao(u,this.mask)},e.prototype.scale=function(t){var i=t;return((0,b.HD)(i)||(0,b.J_)(i))&&(i=this.translate(i)),r.prototype.scale.call(this,i)},e.prototype.translate=function(t){return qa(t)},e.prototype.initCfg=function(){this.tickMethod="time-pretty",this.mask="YYYY-MM-DD",this.tickCount=7,this.nice=!1},e.prototype.setDomain=function(){var t=this.values,i=this.getConfig("min"),u=this.getConfig("max");if((!(0,b.UM)(i)||!(0,b.hj)(i))&&(this.min=this.translate(this.min)),(!(0,b.UM)(u)||!(0,b.hj)(u))&&(this.max=this.translate(this.max)),t&&t.length){var c=[],p=1/0,g=p,_=0;(0,b.S6)(t,function(S){var k=qa(S);if(isNaN(k))throw new TypeError("Invalid Time: "+S+" in time scale!");p>k?(g=p,p=k):g>k&&(g=k),_<k&&(_=k),c.push(k)}),t.length>1&&(this.minTickInterval=g-p),(0,b.UM)(i)&&(this.min=p),(0,b.UM)(u)&&(this.max=_)}},e}(_i),sv=ov,dh=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantize",t}return e.prototype.invert=function(t){var i=this.ticks,u=i.length,c=this.getInvertPercent(t),p=Math.floor(c*(u-1));if(p>=u-1)return(0,b.Z$)(i);if(p<0)return(0,b.YM)(i);var g=i[p],_=i[p+1],S=p/(u-1),k=(p+1)/(u-1);return g+(c-S)/(k-S)*(_-g)},e.prototype.initCfg=function(){this.tickMethod="r-pretty",this.tickCount=5,this.nice=!0},e.prototype.calculateTicks=function(){var t=r.prototype.calculateTicks.call(this);return this.nice||((0,b.Z$)(t)!==this.max&&t.push(this.max),(0,b.YM)(t)!==this.min&&t.unshift(this.min)),t},e.prototype.getScalePercent=function(t){var i=this.ticks;if(t<(0,b.YM)(i))return 0;if(t>(0,b.Z$)(i))return 1;var u=0;return(0,b.S6)(i,function(c,p){if(t>=c)u=p;else return!1}),u/(i.length-1)},e}($r),zf=dh,Gc=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="quantile",t}return e.prototype.initCfg=function(){this.tickMethod="quantile",this.tickCount=5,this.nice=!0},e}(zf),vh=Gc,Uf={};function lc(r){return Uf[r]}function al(r,e){if(lc(r))throw new Error("type '"+r+"' existed.");Uf[r]=e}var _f=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="identity",t.isIdentity=!0,t}return e.prototype.calculateTicks=function(){return this.values},e.prototype.scale=function(t){return this.values[0]!==t&&(0,b.hj)(t)?t:this.range[0]},e.prototype.invert=function(t){var i=this.range;return t<i[0]||t>i[1]?NaN:this.values[0]},e}(Ho),vl=_f;function Eu(r){var e=r.values,t=r.tickInterval,i=r.tickCount,u=r.showLast;if((0,b.hj)(t)){var c=(0,b.hX)(e,function(G,Q){return Q%t===0}),p=(0,b.Z$)(e);return u&&(0,b.Z$)(c)!==p&&c.push(p),c}var g=e.length,_=r.min,S=r.max;if((0,b.UM)(_)&&(_=0),(0,b.UM)(S)&&(S=e.length-1),!(0,b.hj)(i)||i>=g)return e.slice(_,S+1);if(i<=0||S<=0)return[];for(var k=i===1?g:Math.floor(g/(i-1)),L=[],R=_,U=0;U<i&&!(R>=S);U++)R=Math.min(_+U*k,S),U===i-1&&u?L.push(e[S]):L.push(e[R]);return L}function Yh(r){var e=r.min,t=r.max,i=r.nice,u=r.tickCount,c=new qh;return c.domain([e,t]),i&&c.nice(u),c.ticks(u)}var Pp=5,Sc=Math.sqrt(50),gl=Math.sqrt(10),$h=Math.sqrt(2),qh=function(){function r(){this._domain=[0,1]}return r.prototype.domain=function(e){return e?(this._domain=Array.from(e,Number),this):this._domain.slice()},r.prototype.nice=function(e){var t,i;e===void 0&&(e=Pp);var u=this._domain.slice(),c=0,p=this._domain.length-1,g=this._domain[c],_=this._domain[p],S;return _<g&&(t=[_,g],g=t[0],_=t[1],i=[p,c],c=i[0],p=i[1]),S=Hc(g,_,e),S>0?(g=Math.floor(g/S)*S,_=Math.ceil(_/S)*S,S=Hc(g,_,e)):S<0&&(g=Math.ceil(g*S)/S,_=Math.floor(_*S)/S,S=Hc(g,_,e)),S>0?(u[c]=Math.floor(g/S)*S,u[p]=Math.ceil(_/S)*S,this.domain(u)):S<0&&(u[c]=Math.ceil(g*S)/S,u[p]=Math.floor(_*S)/S,this.domain(u)),this},r.prototype.ticks=function(e){return e===void 0&&(e=Pp),Op(this._domain[0],this._domain[this._domain.length-1],e||Pp)},r}();function Op(r,e,t){var i,u=-1,c,p,g;if(e=+e,r=+r,t=+t,r===e&&t>0)return[r];if((i=e<r)&&(c=r,r=e,e=c),(g=Hc(r,e,t))===0||!isFinite(g))return[];if(g>0)for(r=Math.ceil(r/g),e=Math.floor(e/g),p=new Array(c=Math.ceil(e-r+1));++u<c;)p[u]=(r+u)*g;else for(r=Math.floor(r*g),e=Math.ceil(e*g),p=new Array(c=Math.ceil(r-e+1));++u<c;)p[u]=(r-u)/g;return i&&p.reverse(),p}function Hc(r,e,t){var i=(e-r)/Math.max(0,t),u=Math.floor(Math.log(i)/Math.LN10),c=i/Math.pow(10,u);return u>=0?(c>=Sc?10:c>=gl?5:c>=$h?2:1)*Math.pow(10,u):-Math.pow(10,-u)/(c>=Sc?10:c>=gl?5:c>=$h?2:1)}function Kh(r,e,t){var i;return t==="ceil"?i=Math.ceil(r/e):t==="floor"?i=Math.floor(r/e):i=Math.round(r/e),i*e}function $l(r,e,t){var i=Kh(r,t,"floor"),u=Kh(e,t,"ceil");i=(0,b.ri)(i,t),u=(0,b.ri)(u,t);for(var c=[],p=Math.max((u-i)/(Math.pow(2,12)-1),t),g=i;g<=u;g=g+p){var _=(0,b.ri)(g,p);c.push(_)}return{min:i,max:u,ticks:c}}function Qh(r,e,t){var i,u=r.minLimit,c=r.maxLimit,p=r.min,g=r.max,_=r.tickCount,S=_===void 0?5:_,k=(0,b.UM)(u)?(0,b.UM)(e)?p:e:u,L=(0,b.UM)(c)?(0,b.UM)(t)?g:t:c;if(k>L&&(i=[k,L],L=i[0],k=i[1]),S<=2)return[k,L];for(var R=(L-k)/(S-1),U=[],G=0;G<S;G++)U.push(k+R*G);return U}function Zf(r){var e=r.min,t=r.max,i=r.tickInterval,u=r.minLimit,c=r.maxLimit,p=Yh(r);return!(0,b.UM)(u)||!(0,b.UM)(c)?Qh(r,(0,b.YM)(p),(0,b.Z$)(p)):i?$l(e,t,i).ticks:p}function Tl(r){return Math.abs(r)<1e-15?r:parseFloat(r.toFixed(15))}var gd=[1,5,2,2.5,4,3],md=null,yd=Number.EPSILON*100;function gh(r,e){return(r%e+e)%e}function _d(r){return Math.round(r*1e12)/1e12}function xf(r,e,t,i,u,c){var p=(0,b.dp)(e),g=(0,b.cq)(e,r),_=0,S=gh(i,c);return(S<yd||c-S<yd)&&i<=0&&u>=0&&(_=1),1-g/(p-1)-t+_}function xs(r,e,t){var i=(0,b.dp)(e),u=(0,b.cq)(e,r),c=1;return 1-u/(i-1)-t+c}function Jh(r,e,t,i,u,c){var p=(r-1)/(c-u),g=(e-1)/(Math.max(c,i)-Math.min(t,u));return 2-Math.max(p/g,g/p)}function Vf(r,e){return r>=e?2-(r-1)/(e-1):1}function Bl(r,e,t,i){var u=e-r;return 1-.5*(Math.pow(e-i,2)+Math.pow(r-t,2))/Math.pow(.1*u,2)}function go(r,e,t){var i=e-r;if(t>i){var u=(t-i)/2;return 1-Math.pow(u,2)/Math.pow(.1*i,2)}return 1}function is(){return 1}function Yu(r,e,t,i,u,c){t===void 0&&(t=5),i===void 0&&(i=!0),u===void 0&&(u=gd),c===void 0&&(c=[.25,.2,.5,.05]);var p=t<0?0:Math.round(t);if(Number.isNaN(r)||Number.isNaN(e)||typeof r!="number"||typeof e!="number"||!p)return{min:0,max:0,ticks:[]};if(e-r<1e-15||p===1)return{min:r,max:e,ticks:[r]};if(e-r>1e148){var g=t||5,_=(e-r)/g;return{min:r,max:e,ticks:Array(g).fill(null).map(function(Fa,xo){return Tl(r+_*xo)})}}for(var S={score:-2,lmin:0,lmax:0,lstep:0},k=1;k<1/0;){for(var L=0;L<u.length;L+=1){var R=u[L],U=xs(R,u,k);if(c[0]*U+c[1]+c[2]+c[3]<S.score){k=1/0;break}for(var G=2;G<1/0;){var Q=Vf(G,p);if(c[0]*U+c[1]+c[2]*Q+c[3]<S.score)break;for(var pt=(e-r)/(G+1)/k/R,yt=Math.ceil(Math.log10(pt));yt<1/0;){var Ht=k*R*Math.pow(10,yt),ce=go(r,e,Ht*(G-1));if(c[0]*U+c[1]*ce+c[2]*Q+c[3]<S.score)break;var he=Math.floor(e/Ht)*k-(G-1)*k,ze=Math.ceil(r/Ht)*k;if(he<=ze)for(var g=ze-he,Er=0;Er<=g;Er+=1){var Fr=he+Er,zr=Fr*(Ht/k),pn=zr+Ht*(G-1),nn=Ht,Pn=xf(R,u,k,zr,pn,nn),wi=Bl(r,e,zr,pn),ha=Jh(G,p,r,e,zr,pn),Sa=is(),_o=c[0]*Pn+c[1]*wi+c[2]*ha+c[3]*Sa;_o>S.score&&(!i||zr<=r&&pn>=e)&&(S.lmin=zr,S.lmax=pn,S.lstep=nn,S.score=_o)}yt+=1}G+=1}}k+=1}var Vn=Tl(S.lmax),Bi=Tl(S.lmin),fa=Tl(S.lstep),Ui=Math.floor(_d((Vn-Bi)/fa))+1,Ji=new Array(Ui);Ji[0]=Tl(Bi);for(var L=1;L<Ui;L++)Ji[L]=Tl(Ji[L-1]+fa);return{min:Math.min(r,(0,b.YM)(Ji)),max:Math.max(e,(0,b.Z$)(Ji)),ticks:Ji}}function Fp(r){var e=r.min,t=r.max,i=r.tickCount,u=r.nice,c=r.tickInterval,p=r.minLimit,g=r.maxLimit,_=Yu(e,t,i,u).ticks;return!(0,b.UM)(p)||!(0,b.UM)(g)?Qh(r,(0,b.YM)(_),(0,b.Z$)(_)):c?$l(e,t,c).ticks:_}function bf(r){var e=r.base,t=r.tickCount,i=r.min,u=r.max,c=r.values,p,g=Ia(e,u);if(i>0)p=Math.floor(Ia(e,i));else{var _=du(c,e,u);p=Math.floor(Ia(e,_))}for(var S=g-p,k=Math.ceil(S/t),L=[],R=p;R<g+k;R=R+k)L.push(Math.pow(e,R));return i<=0&&L.unshift(0),L}function tp(r,e,t){if(t===void 0&&(t=5),r===e)return{max:e,min:r,ticks:[r]};var i=t<0?0:Math.round(t);if(i===0)return{max:e,min:r,ticks:[]};var u=1.5,c=.5+1.5*u,p=e-r,g=p/i,_=Math.pow(10,Math.floor(Math.log10(g))),S=_;2*_-g<u*(g-S)&&(S=2*_,5*_-g<c*(g-S)&&(S=5*_,10*_-g<u*(g-S)&&(S=10*_)));for(var k=Math.ceil(e/S),L=Math.floor(r/S),R=Math.max(k*S,e),U=Math.min(L*S,r),G=Math.floor((R-U)/S)+1,Q=new Array(G),pt=0;pt<G;pt++)Q[pt]=Tl(U+pt*S);return{min:U,max:R,ticks:Q}}function xd(r){var e=r.exponent,t=r.tickCount,i=Math.ceil(qi(e,r.max)),u=Math.floor(qi(e,r.min)),c=tp(u,i,t).ticks;return c.map(function(p){var g=p>=0?1:-1;return Math.pow(p,e)*g})}function ep(r,e){var t=r.length*e;return e===1?r[r.length-1]:e===0?r[0]:t%1!==0?r[Math.ceil(t)-1]:r.length%2===0?(r[t-1]+r[t])/2:r[t]}function Rp(r){var e=r.tickCount,t=r.values;if(!t||!t.length)return[];for(var i=t.slice().sort(function(g,_){return g-_}),u=[],c=0;c<e;c++){var p=c/(e-1);u.push(ep(i,p))}return u}function rp(r){var e=r.min,t=r.max,i=r.tickCount,u=r.tickInterval,c=r.minLimit,p=r.maxLimit,g=tp(e,t,i).ticks;return!(0,b.UM)(c)||!(0,b.UM)(p)?Qh(r,(0,b.YM)(g),(0,b.Z$)(g)):u?$l(e,t,u).ticks:g}function Ef(r){var e=r.min,t=r.max,i=r.minTickInterval,u=r.tickInterval,c=r.tickCount;if(u)c=Math.ceil((t-e)/u);else{u=Yl(e,t,c)[1];var p=(t-e)/u,g=p/c;g>1&&(u=u*Math.ceil(g)),i&&u<i&&(u=i)}u=Math.max(Math.floor((t-e)/(Math.pow(2,12)-1)),u);for(var _=[],S=e;S<t+u;S+=u)_.push(S);return _}function au(r){var e=Eu((0,P.pi)({showLast:!0},r));return e}function wf(r){return new Date(r).getFullYear()}function np(r){return new Date(r,0,1).getTime()}function As(r){return new Date(r).getMonth()}function Zi(r,e){var t=wf(r),i=wf(e),u=As(r),c=As(e);return(i-t)*12+(c-u)%12}function as(r,e){return new Date(r,e,1).getTime()}function Sf(r,e){return Math.ceil((e-r)/bu)}function Gf(r,e){return Math.ceil((e-r)/il)}function cc(r,e){return Math.ceil((e-r)/(60*1e3))}function ml(r){var e=r.min,t=r.max,i=r.minTickInterval,u=r.tickCount,c=r.tickInterval,p=[];c||(c=(t-e)/u,i&&c<i&&(c=i)),c=Math.max(Math.floor((t-e)/(Math.pow(2,12)-1)),c);var g=wf(e);if(c>Vc)for(var _=wf(t),S=Math.ceil(c/Vc),k=g;k<=_+S;k=k+S)p.push(np(k));else if(c>iu)for(var L=Math.ceil(c/iu),R=As(e),U=Zi(e,t),k=0;k<=U+L;k=k+L)p.push(as(g,k+R));else if(c>bu)for(var G=new Date(e),Q=G.getFullYear(),pt=G.getMonth(),yt=G.getDate(),Ht=Math.ceil(c/bu),ce=Sf(e,t),k=0;k<ce+Ht;k=k+Ht)p.push(new Date(Q,pt,yt+k).getTime());else if(c>il)for(var G=new Date(e),Q=G.getFullYear(),pt=G.getMonth(),Ht=G.getDate(),he=G.getHours(),ze=Math.ceil(c/il),Er=Gf(e,t),k=0;k<=Er+ze;k=k+ze)p.push(new Date(Q,pt,Ht,he+k).getTime());else if(c>xu)for(var Fr=cc(e,t),zr=Math.ceil(c/xu),k=0;k<=Fr+zr;k=k+zr)p.push(e+k*xu);else{var pn=c;pn<gs&&(pn=gs);for(var nn=Math.floor(e/gs)*gs,Pn=Math.ceil((t-e)/gs),wi=Math.ceil(pn/gs),k=0;k<Pn+wi;k=k+wi)p.push(nn+k*gs)}return p.length>=512&&console.warn("Notice: current ticks length("+p.length+') >= 512, may cause performance issues, even out of memory. Because of the configure "tickInterval"(in milliseconds, current is '+c+") is too small, increase the value to solve the problem!"),p}Ma("cat",Eu),Ma("time-cat",au),Ma("wilkinson-extended",Fp),Ma("r-pretty",rp),Ma("time",Ef),Ma("time-pretty",ml),Ma("log",bf),Ma("pow",xd),Ma("quantile",Rp),Ma("d3-linear",Zf),al("cat",Hs),al("category",Hs),al("identity",vl),al("linear",_i),al("log",av),al("pow",vd),al("time",sv),al("timeCat",ir),al("quantize",zf),al("quantile",vh);var Dp={},Ai=function(r){return Dp[r.toLowerCase()]},Hf=function(r,e){if(Ai(r))throw new Error("Attribute type '"+r+"' existed.");Dp[r.toLowerCase()]=e};Hf("Color",pu),Hf("Opacity",Rl),Hf("Position",Wu),Hf("Shape",Xe),Hf("Size",un);var Cc=ot(77160),Cf=ot(35600),ma=ot(31506),yl=function(){function r(e){this.type="coordinate",this.isRect=!1,this.isHelix=!1,this.isPolar=!1,this.isReflectX=!1,this.isReflectY=!1;var t=e.start,i=e.end,u=e.matrix,c=u===void 0?[1,0,0,0,1,0,0,0,1]:u,p=e.isTransposed,g=p===void 0?!1:p;this.start=t,this.end=i,this.matrix=c,this.originalMatrix=(0,P.ev)([],c),this.isTransposed=g}return r.prototype.initial=function(){this.center={x:(this.start.x+this.end.x)/2,y:(this.start.y+this.end.y)/2},this.width=Math.abs(this.end.x-this.start.x),this.height=Math.abs(this.end.y-this.start.y)},r.prototype.update=function(e){(0,b.f0)(this,e),this.initial()},r.prototype.convertDim=function(e,t){var i,u=this[t],c=u.start,p=u.end;return this.isReflect(t)&&(i=[p,c],c=i[0],p=i[1]),c+e*(p-c)},r.prototype.invertDim=function(e,t){var i,u=this[t],c=u.start,p=u.end;return this.isReflect(t)&&(i=[p,c],c=i[0],p=i[1]),(e-c)/(p-c)},r.prototype.applyMatrix=function(e,t,i){i===void 0&&(i=0);var u=this.matrix,c=[e,t,i];return Cc.transformMat3(c,c,u),c},r.prototype.invertMatrix=function(e,t,i){i===void 0&&(i=0);var u=this.matrix,c=Cf.U_([0,0,0,0,0,0,0,0,0],u),p=[e,t,i];return c&&Cc.transformMat3(p,p,c),p},r.prototype.convert=function(e){var t=this.convertPoint(e),i=t.x,u=t.y,c=this.applyMatrix(i,u,1);return{x:c[0],y:c[1]}},r.prototype.invert=function(e){var t=this.invertMatrix(e.x,e.y,1);return this.invertPoint({x:t[0],y:t[1]})},r.prototype.rotate=function(e){var t=this.matrix,i=this.center;return ma.m$(t,t,[-i.x,-i.y]),ma.zu(t,t,e),ma.m$(t,t,[i.x,i.y]),this},r.prototype.reflect=function(e){return e==="x"?this.isReflectX=!this.isReflectX:this.isReflectY=!this.isReflectY,this},r.prototype.scale=function(e,t){var i=this.matrix,u=this.center;return ma.m$(i,i,[-u.x,-u.y]),ma.lh(i,i,[e,t]),ma.m$(i,i,[u.x,u.y]),this},r.prototype.translate=function(e,t){var i=this.matrix;return ma.m$(i,i,[e,t]),this},r.prototype.transpose=function(){return this.isTransposed=!this.isTransposed,this},r.prototype.getCenter=function(){return this.center},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRadius=function(){return this.radius},r.prototype.isReflect=function(e){return e==="x"?this.isReflectX:this.isReflectY},r.prototype.resetMatrix=function(e){this.matrix=e||(0,P.ev)([],this.originalMatrix)},r}(),jf=yl,fc=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.isRect=!0,i.type="cartesian",i.initial(),i}return e.prototype.initial=function(){r.prototype.initial.call(this);var t=this.start,i=this.end;this.x={start:t.x,end:i.x},this.y={start:t.y,end:i.y}},e.prototype.convertPoint=function(t){var i,u=t.x,c=t.y;return this.isTransposed&&(i=[c,u],u=i[0],c=i[1]),{x:this.convertDim(u,"x"),y:this.convertDim(c,"y")}},e.prototype.invertPoint=function(t){var i,u=this.invertDim(t.x,"x"),c=this.invertDim(t.y,"y");return this.isTransposed&&(i=[c,u],u=i[0],c=i[1]),{x:u,y:c}},e}(jf),_l=fc,sa=ot(31437),Bp=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.isHelix=!0,i.type="helix";var u=t.startAngle,c=u===void 0?1.25*Math.PI:u,p=t.endAngle,g=p===void 0?7.25*Math.PI:p,_=t.innerRadius,S=_===void 0?0:_,k=t.radius;return i.startAngle=c,i.endAngle=g,i.innerRadius=S,i.radius=k,i.initial(),i}return e.prototype.initial=function(){r.prototype.initial.call(this);var t=(this.endAngle-this.startAngle)/(2*Math.PI)+1,i=Math.min(this.width,this.height)/2;this.radius&&this.radius>=0&&this.radius<=1&&(i=i*this.radius),this.d=Math.floor(i*(1-this.innerRadius)/t),this.a=this.d/(Math.PI*2),this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*i,end:this.innerRadius*i+this.d*.99}},e.prototype.convertPoint=function(t){var i,u=t.x,c=t.y;this.isTransposed&&(i=[c,u],u=i[0],c=i[1]);var p=this.convertDim(u,"x"),g=this.a*p,_=this.convertDim(c,"y");return{x:this.center.x+Math.cos(p)*(g+_),y:this.center.y+Math.sin(p)*(g+_)}},e.prototype.invertPoint=function(t){var i,u=this.d+this.y.start,c=sa.$X([0,0],[t.x,t.y],[this.center.x,this.center.y]),p=ma.Dg(c,[1,0],!0),g=p*this.a;sa.kE(c)<g&&(g=sa.kE(c));var _=Math.floor((sa.kE(c)-g)/u);p=2*_*Math.PI+p;var S=this.a*p,k=sa.kE(c)-S;k=(0,b.vQ)(k,0)?0:k;var L=this.invertDim(p,"x"),R=this.invertDim(k,"y");return L=(0,b.vQ)(L,0)?0:L,R=(0,b.vQ)(R,0)?0:R,this.isTransposed&&(i=[R,L],L=i[0],R=i[1]),{x:L,y:R}},e}(jf),Np=Bp,bd=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.isPolar=!0,i.type="polar";var u=t.startAngle,c=u===void 0?-Math.PI/2:u,p=t.endAngle,g=p===void 0?Math.PI*3/2:p,_=t.innerRadius,S=_===void 0?0:_,k=t.radius;return i.startAngle=c,i.endAngle=g,i.innerRadius=S,i.radius=k,i.initial(),i}return e.prototype.initial=function(){for(r.prototype.initial.call(this);this.endAngle<this.startAngle;)this.endAngle+=Math.PI*2;var t=this.getOneBox(),i=t.maxX-t.minX,u=t.maxY-t.minY,c=Math.abs(t.minX)/i,p=Math.abs(t.minY)/u,g;this.height/u>this.width/i?(g=this.width/i,this.circleCenter={x:this.center.x-(.5-c)*this.width,y:this.center.y-(.5-p)*g*u}):(g=this.height/u,this.circleCenter={x:this.center.x-(.5-c)*g*i,y:this.center.y-(.5-p)*this.height}),this.polarRadius=this.radius,this.radius?this.radius>0&&this.radius<=1?this.polarRadius=g*this.radius:(this.radius<=0||this.radius>g)&&(this.polarRadius=g):this.polarRadius=g,this.x={start:this.startAngle,end:this.endAngle},this.y={start:this.innerRadius*this.polarRadius,end:this.polarRadius}},e.prototype.getRadius=function(){return this.polarRadius},e.prototype.convertPoint=function(t){var i,u=this.getCenter(),c=t.x,p=t.y;return this.isTransposed&&(i=[p,c],c=i[0],p=i[1]),c=this.convertDim(c,"x"),p=this.convertDim(p,"y"),{x:u.x+Math.cos(c)*p,y:u.y+Math.sin(c)*p}},e.prototype.invertPoint=function(t){var i,u=this.getCenter(),c=[t.x-u.x,t.y-u.y],p=this,g=p.startAngle,_=p.endAngle;this.isReflect("x")&&(i=[_,g],g=i[0],_=i[1]);var S=[1,0,0,0,1,0,0,0,1];ma.zu(S,S,g);var k=[1,0,0];Cc.transformMat3(k,k,S);var L=[k[0],k[1]],R=ma.Dg(L,c,_<g);(0,b.vQ)(R,Math.PI*2)&&(R=0);var U=sa.kE(c),G=R/(_-g);G=_-g>0?G:-G;var Q=this.invertDim(U,"y"),pt={x:0,y:0};return pt.x=this.isTransposed?Q:G,pt.y=this.isTransposed?G:Q,pt},e.prototype.getCenter=function(){return this.circleCenter},e.prototype.getOneBox=function(){var t=this.startAngle,i=this.endAngle;if(Math.abs(i-t)>=Math.PI*2)return{minX:-1,maxX:1,minY:-1,maxY:1};for(var u=[0,Math.cos(t),Math.cos(i)],c=[0,Math.sin(t),Math.sin(i)],p=Math.min(t,i);p<Math.max(t,i);p+=Math.PI/18)u.push(Math.cos(p)),c.push(Math.sin(p));return{minX:Math.min.apply(Math,u),maxX:Math.max.apply(Math,u),minY:Math.min.apply(Math,c),maxY:Math.max.apply(Math,c)}},e}(jf),Ed=bd,Ml={},Ko=function(r){return Ml[r.toLowerCase()]},Ka=function(r,e){Ml[r.toLowerCase()]=e};Ka("rect",_l),Ka("cartesian",_l),Ka("polar",Ed),Ka("helix",Np);function xl(r,e,t){var i=new Te.Event(e,t);i.target=r,i.propagationPath.push(r),r.emitDelegation(e,i);for(var u=r.getParent();u;)u.emitDelegation(e,i),i.propagationPath.push(u),u=u.getParent()}var ql=[1,0,0,0,1,0,0,0,1];function Ts(r,e,t){if(t===void 0&&(t=ql),!e)return null;var i=ma.vs(t,[["t",-r.x,-r.y],["r",e],["t",r.x,r.y]]);return i}function jc(r,e){return!r.x&&!r.y?null:ma.vs(e||ql,[["t",r.x,r.y]])}function Nl(r){var e=[1,0,0],t=[0,0,0];return Cc.transformMat3(t,e,r),Math.atan2(t[1],t[0])}function wu(r,e){var t=[0,0];return sa.kK(t,e,r),t}function Su(r,e){var t=wu(r,[e.minX,e.minY]),i=wu(r,[e.maxX,e.minY]),u=wu(r,[e.minX,e.maxY]),c=wu(r,[e.maxX,e.maxY]),p=Math.min(t[0],i[0],u[0],c[0]),g=Math.max(t[0],i[0],u[0],c[0]),_=Math.min(t[1],i[1],u[1],c[1]),S=Math.max(t[1],i[1],u[1],c[1]);return{x:p,y:_,minX:p,minY:_,maxX:g,maxY:S,width:g-p,height:S-_}}function Il(r,e,t,i){if(e){var u=Ts({x:t,y:i},e,r.getMatrix());r.setMatrix(u)}}function Ki(r,e,t){var i=jc({x:e,y:t});r.attr("matrix",i)}function Wi(r){var e=0,t=0,i=0,u=0;return(0,b.hj)(r)?e=t=i=u=r:(0,b.kJ)(r)&&(e=r[0],i=(0,b.UM)(r[1])?r[0]:r[1],u=(0,b.UM)(r[2])?r[0]:r[2],t=(0,b.UM)(r[3])?i:r[3]),[e,i,u,t]}function Af(r){for(var e=r.childNodes,t=e.length,i=t-1;i>=0;i--)r.removeChild(e[i])}function ol(r,e){return!!r.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function sl(r){var e=r.start,t=r.end,i=Math.min(e.x,t.x),u=Math.min(e.y,t.y),c=Math.max(e.x,t.x),p=Math.max(e.y,t.y);return{x:i,y:u,minX:i,minY:u,maxX:c,maxY:p,width:c-i,height:p-u}}function Ru(r){var e=r.map(function(g){return g.x}),t=r.map(function(g){return g.y}),i=Math.min.apply(Math,e),u=Math.min.apply(Math,t),c=Math.max.apply(Math,e),p=Math.max.apply(Math,t);return{x:i,y:u,minX:i,minY:u,maxX:c,maxY:p,width:c-i,height:p-u}}function bs(r,e,t,i){var u=r+t,c=e+i;return{x:r,y:e,width:t,height:i,minX:r,minY:e,maxX:isNaN(u)?0:u,maxY:isNaN(c)?0:c}}function Ac(r,e,t){return(1-t)*r+e*t}function Tc(r,e,t){return{x:r.x+Math.cos(t)*e,y:r.y+Math.sin(t)*e}}function No(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}var os=function(r){return new Promise(function(e){setTimeout(e,r)})},ip=function(r,e,t){return t===void 0&&(t=Math.pow(Number.EPSILON,.5)),[r,e].includes(1/0)?Math.abs(r)===Math.abs(e):Math.abs(r-e)<t};function Wc(r,e){var t=Math.max(r.minX,e.minX),i=Math.max(r.minY,e.minY),u=Math.min(r.maxX,e.maxX),c=Math.min(r.maxY,e.maxY);return bs(t,i,u-t,c-i)}function hc(r,e){var t=Math.min(r.minX,e.minX),i=Math.min(r.minY,e.minY),u=Math.max(r.maxX,e.maxX),c=Math.max(r.maxY,e.maxY);return bs(t,i,u-t,c-i)}function ul(r){var e=r.getClip(),t=e&&e.getBBox(),i;if(!r.isGroup())i=r.getBBox();else{var u=1/0,c=-1/0,p=1/0,g=-1/0,_=r.getChildren();_.length>0?(0,b.S6)(_,function(S){if(S.get("visible")){if(S.isGroup()&&S.get("children").length===0)return!0;var k=ul(S),L=S.applyToMatrix([k.minX,k.minY,1]),R=S.applyToMatrix([k.minX,k.maxY,1]),U=S.applyToMatrix([k.maxX,k.minY,1]),G=S.applyToMatrix([k.maxX,k.maxY,1]),Q=Math.min(L[0],R[0],U[0],G[0]),pt=Math.max(L[0],R[0],U[0],G[0]),yt=Math.min(L[1],R[1],U[1],G[1]),Ht=Math.max(L[1],R[1],U[1],G[1]);Q<u&&(u=Q),pt>c&&(c=pt),yt<p&&(p=yt),Ht>g&&(g=Ht)}}):(u=0,c=0,p=0,g=0),i=bs(u,p,c-u,g-p)}return t?Wc(i,t):i}function Fs(r,e){if(!(!r.getClip()&&!e.getClip())){var t=e.getClip();if(!t){r.setClip(null);return}var i={type:t.get("type"),attrs:t.attr()};r.setClip(i)}}function Ms(r){return r+"px"}function $u(r,e,t,i){var u=No(r,e),c=i/u,p=0;return t==="start"?p=0-c:t==="end"&&(p=1+c),{x:Ac(r.x,e.x,p),y:Ac(r.y,e.y,p)}}var Xc={none:[],point:["x","y"],region:["start","end"],points:["points"],circle:["center","radius","startAngle","endAngle"]},ll=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.initCfg(),i}return e.prototype.getDefaultCfg=function(){return{id:"",name:"",type:"",locationType:"none",offsetX:0,offsetY:0,animate:!1,capture:!0,updateAutoRender:!1,animateOption:{appear:null,update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},events:null,defaultCfg:{},visible:!0}},e.prototype.clear=function(){},e.prototype.update=function(t){var i=this,u=this.get("defaultCfg")||{};(0,b.S6)(t,function(c,p){var g=i.get(p),_=c;g!==c&&((0,b.Kn)(c)&&u[p]&&(_=(0,b.b$)({},u[p],c)),i.set(p,_))}),this.updateInner(t),this.afterUpdate(t)},e.prototype.updateInner=function(t){},e.prototype.afterUpdate=function(t){(0,b.wH)(t,"visible")&&(t.visible?this.show():this.hide()),(0,b.wH)(t,"capture")&&this.setCapture(t.capture)},e.prototype.getLayoutBBox=function(){return this.getBBox()},e.prototype.getLocationType=function(){return this.get("locationType")},e.prototype.getOffset=function(){return{offsetX:this.get("offsetX"),offsetY:this.get("offsetY")}},e.prototype.setOffset=function(t,i){this.update({offsetX:t,offsetY:i})},e.prototype.setLocation=function(t){var i=(0,P.pi)({},t);this.update(i)},e.prototype.getLocation=function(){var t=this,i={},u=this.get("locationType"),c=Xc[u];return(0,b.S6)(c,function(p){i[p]=t.get(p)}),i},e.prototype.isList=function(){return!1},e.prototype.isSlider=function(){return!1},e.prototype.init=function(){},e.prototype.initCfg=function(){var t=this,i=this.get("defaultCfg");(0,b.S6)(i,function(u,c){var p=t.get(c);if((0,b.Kn)(p)){var g=(0,b.b$)({},u,p);t.set(c,g)}})},e}(Te.Base),Wf=ll,Mc="update_status",mh=["visible","tip","delegateObject"],Xf=["container","group","shapesMap","isRegister","isUpdating","destroyed"],wd=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{container:null,shapesMap:{},group:null,capture:!0,isRegister:!1,isUpdating:!1,isInit:!0})},e.prototype.remove=function(){this.clear();var t=this.get("group");t.remove()},e.prototype.clear=function(){var t=this.get("group");t.clear(),this.set("shapesMap",{}),this.clearOffScreenCache(),this.set("isInit",!0)},e.prototype.getChildComponentById=function(t){var i=this.getElementById(t),u=i&&i.get("component");return u},e.prototype.getElementById=function(t){return this.get("shapesMap")[t]},e.prototype.getElementByLocalId=function(t){var i=this.getElementId(t);return this.getElementById(i)},e.prototype.getElementsByName=function(t){var i=[];return(0,b.S6)(this.get("shapesMap"),function(u){u.get("name")===t&&i.push(u)}),i},e.prototype.getContainer=function(){return this.get("container")},e.prototype.updateInner=function(t){this.offScreenRender(),this.get("updateAutoRender")&&this.render()},e.prototype.render=function(){var t=this.get("offScreenGroup");t||(t=this.offScreenRender());var i=this.get("group");this.updateElements(t,i),this.deleteElements(),this.applyOffset(),this.get("eventInitted")||(this.initEvent(),this.set("eventInitted",!0)),this.set("isInit",!1)},e.prototype.show=function(){var t=this.get("group");t.show(),this.set("visible",!0)},e.prototype.hide=function(){var t=this.get("group");t.hide(),this.set("visible",!1)},e.prototype.setCapture=function(t){var i=this.get("group");i.set("capture",t),this.set("capture",t)},e.prototype.destroy=function(){this.removeEvent(),this.remove(),r.prototype.destroy.call(this)},e.prototype.getBBox=function(){return this.get("group").getCanvasBBox()},e.prototype.getLayoutBBox=function(){var t=this.get("group"),i=this.getInnerLayoutBBox(),u=t.getTotalMatrix();return u&&(i=Su(u,i)),i},e.prototype.on=function(t,i,u){var c=this.get("group");return c.on(t,i,u),this},e.prototype.off=function(t,i){var u=this.get("group");return u&&u.off(t,i),this},e.prototype.emit=function(t,i){var u=this.get("group");u.emit(t,i)},e.prototype.init=function(){r.prototype.init.call(this),this.get("group")||this.initGroup(),this.offScreenRender()},e.prototype.getInnerLayoutBBox=function(){return this.get("offScreenBBox")||this.get("group").getBBox()},e.prototype.delegateEmit=function(t,i){var u=this.get("group");i.target=u,u.emit(t,i),xl(u,t,i)},e.prototype.createOffScreenGroup=function(){var t=this.get("group"),i=t.getGroupBase(),u=new i({delegateObject:this.getDelegateObject()});return u},e.prototype.applyOffset=function(){var t=this.get("offsetX"),i=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t,y:i})},e.prototype.initGroup=function(){var t=this.get("container");this.set("group",t.addGroup({id:this.get("id"),name:this.get("name"),capture:this.get("capture"),visible:this.get("visible"),isComponent:!0,component:this,delegateObject:this.getDelegateObject()}))},e.prototype.offScreenRender=function(){this.clearOffScreenCache();var t=this.createOffScreenGroup();return this.renderInner(t),this.set("offScreenGroup",t),this.set("offScreenBBox",ul(t)),t},e.prototype.addGroup=function(t,i){this.appendDelegateObject(t,i);var u=t.addGroup(i);return this.get("isRegister")&&this.registerElement(u),u},e.prototype.addShape=function(t,i){this.appendDelegateObject(t,i);var u=t.addShape(i);return this.get("isRegister")&&this.registerElement(u),u},e.prototype.addComponent=function(t,i){var u=i.id,c=i.component,p=(0,P._T)(i,["id","component"]),g=new c((0,P.pi)((0,P.pi)({},p),{id:u,container:t,updateAutoRender:this.get("updateAutoRender")}));return g.init(),g.render(),this.get("isRegister")&&this.registerElement(g.get("group")),g},e.prototype.initEvent=function(){},e.prototype.removeEvent=function(){var t=this.get("group");t.off()},e.prototype.getElementId=function(t){var i=this.get("id"),u=this.get("name");return i+"-"+u+"-"+t},e.prototype.registerElement=function(t){var i=t.get("id");this.get("shapesMap")[i]=t},e.prototype.unregisterElement=function(t){var i=t.get("id");delete this.get("shapesMap")[i]},e.prototype.moveElementTo=function(t,i){var u=jc(i);t.attr("matrix",u)},e.prototype.addAnimation=function(t,i,u){var c=i.attr("opacity");(0,b.UM)(c)&&(c=1),i.attr("opacity",0),i.animate({opacity:c},u)},e.prototype.removeAnimation=function(t,i,u){i.animate({opacity:0},u)},e.prototype.updateAnimation=function(t,i,u,c){i.animate(u,c)},e.prototype.updateElements=function(t,i){var u=this,c=this.get("animate"),p=this.get("animateOption"),g=t.getChildren().slice(0),_;(0,b.S6)(g,function(S){var k=S.get("id"),L=u.getElementById(k),R=S.get("name");if(L)if(S.get("isComponent")){var U=S.get("component"),G=L.get("component"),Q=(0,b.ei)(U.cfg,(0,b.e5)((0,b.XP)(U.cfg),Xf));G.update(Q),L.set(Mc,"update")}else{var pt=u.getReplaceAttrs(L,S);c&&p.update?u.updateAnimation(R,L,pt,p.update):L.attr(pt),S.isGroup()&&u.updateElements(S,L),(0,b.S6)(mh,function(he){L.set(he,S.get(he))}),Fs(L,S),_=L,L.set(Mc,"update")}else{i.add(S);var yt=i.getChildren();if(yt.splice(yt.length-1,1),_){var Ht=yt.indexOf(_);yt.splice(Ht+1,0,S)}else yt.unshift(S);if(u.registerElement(S),S.set(Mc,"add"),S.get("isComponent")){var U=S.get("component");U.set("container",i)}else S.isGroup()&&u.registerNewGroup(S);if(_=S,c){var ce=u.get("isInit")?p.appear:p.enter;ce&&u.addAnimation(R,S,ce)}}})},e.prototype.clearUpdateStatus=function(t){var i=t.getChildren();(0,b.S6)(i,function(u){u.set(Mc,null)})},e.prototype.clearOffScreenCache=function(){var t=this.get("offScreenGroup");t&&t.destroy(),this.set("offScreenGroup",null),this.set("offScreenBBox",null)},e.prototype.getDelegateObject=function(){var t,i=this.get("name"),u=(t={},t[i]=this,t.component=this,t);return u},e.prototype.appendDelegateObject=function(t,i){var u=t.get("delegateObject");i.delegateObject||(i.delegateObject={}),(0,b.CD)(i.delegateObject,u)},e.prototype.getReplaceAttrs=function(t,i){var u=t.attr(),c=i.attr();return(0,b.S6)(u,function(p,g){c[g]===void 0&&(c[g]=void 0)}),c},e.prototype.registerNewGroup=function(t){var i=this,u=t.getChildren();(0,b.S6)(u,function(c){i.registerElement(c),c.set(Mc,"add"),c.isGroup()&&i.registerNewGroup(c)})},e.prototype.deleteElements=function(){var t=this,i=this.get("shapesMap"),u=[];(0,b.S6)(i,function(g,_){!g.get(Mc)||g.destroyed?u.push([_,g]):g.set(Mc,null)});var c=this.get("animate"),p=this.get("animateOption");(0,b.S6)(u,function(g){var _=g[0],S=g[1];if(!S.destroyed){var k=S.get("name");if(c&&p.leave){var L=(0,b.CD)({callback:function(){t.removeElement(S)}},p.leave);t.removeAnimation(k,S,L)}else t.removeElement(S)}delete i[_]})},e.prototype.removeElement=function(t){if(t.get("isGroup")){var i=t.get("component");i&&i.destroy()}t.remove()},e}(Wf),Rs=wd,Ic="\u2026";function ap(r){for(var e=0,t=0;t<r.length;t++)e+=bl(r,t);return e}function bl(r,e){return r.charCodeAt(e)>0&&r.charCodeAt(e)<128?1:2}function zl(r,e,t){t===void 0&&(t="tail");var i=r.length,u="";if(t==="tail"){for(var c=0,p=0;c<e;){var g=bl(r,p);if(c+g<=e)u+=r[p],c+=bl(r,p),p++;else break}u+=Ic}else if(t==="head"){for(var c=0,p=i-1;c<e;){var g=bl(r,p);if(c+g<=e)u+=r[p],c+=bl(r,p),p--;else break}u=Ic+u}else{for(var _="",S="",c=0,k=0,L=i-1;c<e;){var R=bl(r,k),U=!1;R+c<=e&&(_+=r[k],k++,c+=R,U=!0);var G=bl(r,L);if(G+c<=e&&(S=r[L]+S,c+=G,L--,U=!0),!U)break}u=_+Ic+S}return u}var op="\u2026",pc=2,zp=400;function Yc(r){for(var e=r.map(function(_){var S=_.attr("text");return(0,b.UM)(S)?"":""+S}),t=0,i=0,u=0;u<e.length;u+=1){for(var c=0,p=0;p<=e[u].length;p+=1){var g=e[u].charCodeAt(p);g>=19968&&g<=40869?c+=2:c+=1}c>t&&(t=c,i=u)}return r[i].getBBox().width}function x(r){if(r.length>zp)return Yc(r);var e=0;return(0,b.S6)(r,function(t){var i=t.getBBox(),u=i.width;e<u&&(e=u)}),e}function C(r,e){var t=e.getCanvasBBox();return r?t.width:t.height}function w(r,e){return r.getBBox().width<e}function M(r,e,t,i){var u;i===void 0&&(i="tail");var c=(u=e.attr("text"))!==null&&u!==void 0?u:"";if(i==="tail"){var p=(0,b.ei)(e.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),g=(0,b.Lo)(c,t,p,"\u2026");return c!==g?(e.attr("text",g),e.set("tip",c),!0):(e.set("tip",null),!1)}var _=C(r,e),S=ap(c),k=!1;if(t<_){var L=Math.floor(t/_*S)-pc,R=void 0;L>=0?R=zl(c,L,i):R=op,R&&(e.attr("text",R),k=!0)}return k?e.set("tip",c):e.set("tip",null),k}function z(r,e){var t=e.x,i=e.y,u=e.content,c=e.style,p=e.id,g=e.name,_=e.rotate,S=e.maxLength,k=e.autoEllipsis,L=e.isVertical,R=e.ellipsisPosition,U=e.background,G=r.addGroup({id:p+"-group",name:g+"-group",attrs:{x:t,y:i}}),Q=G.addShape({type:"text",id:p,name:g,attrs:(0,P.pi)({x:0,y:0,text:u},c)}),pt=Wi((0,b.U2)(U,"padding",0));if(S&&k){var yt=S-(pt[1]+pt[3]);M(!L,Q,yt,R)}if(U){var Ht=(0,b.U2)(U,"style",{}),ce=Q.getCanvasBBox(),he=ce.minX,ze=ce.minY,Er=ce.width,Fr=ce.height,zr=G.addShape("rect",{id:p+"-bg",name:p+"-bg",attrs:(0,P.pi)({x:he-pt[3],y:ze-pt[0],width:Er+pt[1]+pt[3],height:Fr+pt[0]+pt[2]},Ht)});zr.toBack()}Ki(G,t,i),Il(G,_,t,i)}var H={fontFamily:`
  BlinkMacSystemFont, "Segoe UI", Roboto,"Helvetica Neue",
  Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei",
  SimSun, "sans-serif"`,textColor:"#2C3542",activeTextColor:"#333333",uncheckedColor:"#D8D8D8",lineColor:"#416180",regionColor:"#CCD7EB",verticalAxisRotate:-Math.PI/4,horizontalAxisRotate:Math.PI/4,descriptionIconStroke:"#fff",descriptionIconFill:"rgba(58, 73, 101, .25)"},$=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"line",locationType:"region",start:null,end:null,style:{},text:null,defaultCfg:{style:{fill:H.textColor,fontSize:12,textAlign:"center",textBaseline:"bottom",fontFamily:H.fontFamily},text:{position:"center",autoRotate:!0,content:null,offsetX:0,offsetY:0,style:{stroke:H.lineColor,lineWidth:1}}}})},e.prototype.renderInner=function(t){this.renderLine(t),this.get("text")&&this.renderLabel(t)},e.prototype.renderLine=function(t){var i=this.get("start"),u=this.get("end"),c=this.get("style");this.addShape(t,{type:"line",id:this.getElementId("line"),name:"annotation-line",attrs:(0,P.pi)({x1:i.x,y1:i.y,x2:u.x,y2:u.y},c)})},e.prototype.getLabelPoint=function(t,i,u){var c;return u==="start"?c=0:u==="center"?c=.5:(0,b.HD)(u)&&u.indexOf("%")!==-1?c=parseInt(u,10)/100:(0,b.hj)(u)?c=u:c=1,(c>1||c<0)&&(c=1),{x:Ac(t.x,i.x,c),y:Ac(t.y,i.y,c)}},e.prototype.renderLabel=function(t){var i=this.get("text"),u=this.get("start"),c=this.get("end"),p=i.position,g=i.content,_=i.style,S=i.offsetX,k=i.offsetY,L=i.autoRotate,R=i.maxLength,U=i.autoEllipsis,G=i.ellipsisPosition,Q=i.background,pt=i.isVertical,yt=pt===void 0?!1:pt,Ht=this.getLabelPoint(u,c,p),ce=Ht.x+S,he=Ht.y+k,ze={id:this.getElementId("line-text"),name:"annotation-line-text",x:ce,y:he,content:g,style:_,maxLength:R,autoEllipsis:U,ellipsisPosition:G,background:Q,isVertical:yt};if(L){var Er=[c.x-u.x,c.y-u.y];ze.rotate=Math.atan2(Er[1],Er[0])}z(t,ze)},e}(Rs),ft=$,Ut=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"text",locationType:"point",x:0,y:0,content:"",rotate:null,style:{},background:null,maxLength:null,autoEllipsis:!0,isVertical:!1,ellipsisPosition:"tail",defaultCfg:{style:{fill:H.textColor,fontSize:12,textAlign:"center",textBaseline:"middle",fontFamily:H.fontFamily}}})},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},e.prototype.renderInner=function(t){var i=this.getLocation(),u=i.x,c=i.y,p=this.get("content"),g=this.get("style"),_=this.getElementId("text"),S=this.get("name")+"-text",k=this.get("maxLength"),L=this.get("autoEllipsis"),R=this.get("isVertical"),U=this.get("ellipsisPosition"),G=this.get("background"),Q=this.get("rotate"),pt={id:_,name:S,x:u,y:c,content:p,style:g,maxLength:k,autoEllipsis:L,isVertical:R,ellipsisPosition:U,background:G,rotate:Q};z(t,pt)},e.prototype.resetLocation=function(){var t=this.getElementByLocalId("text-group");if(t){var i=this.getLocation(),u=i.x,c=i.y,p=this.get("rotate");Ki(t,u,c),Il(t,p,u,c)}},e}(Rs),re=Ut,De=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"arc",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2,style:{stroke:"#999",lineWidth:1}})},e.prototype.renderInner=function(t){this.renderArc(t)},e.prototype.getArcPath=function(){var t=this.getLocation(),i=t.center,u=t.radius,c=t.startAngle,p=t.endAngle,g=Tc(i,u,c),_=Tc(i,u,p),S=p-c>Math.PI?1:0,k=[["M",g.x,g.y]];if(p-c===Math.PI*2){var L=Tc(i,u,c+Math.PI);k.push(["A",u,u,0,S,1,L.x,L.y]),k.push(["A",u,u,0,S,1,_.x,_.y])}else k.push(["A",u,u,0,S,1,_.x,_.y]);return k},e.prototype.renderArc=function(t){var i=this.getArcPath(),u=this.get("style");this.addShape(t,{type:"path",id:this.getElementId("arc"),name:"annotation-arc",attrs:(0,P.pi)({path:i},u)})},e}(Rs),Be=De,Le=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"region",locationType:"region",start:null,end:null,style:{},defaultCfg:{style:{lineWidth:0,fill:H.regionColor,opacity:.4}}})},e.prototype.renderInner=function(t){this.renderRegion(t)},e.prototype.renderRegion=function(t){var i=this.get("start"),u=this.get("end"),c=this.get("style"),p=sl({start:i,end:u});this.addShape(t,{type:"rect",id:this.getElementId("region"),name:"annotation-region",attrs:(0,P.pi)({x:p.x,y:p.y,width:p.width,height:p.height},c)})},e}(Rs),cr=Le,ar=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"image",locationType:"region",start:null,end:null,src:null,style:{}})},e.prototype.renderInner=function(t){this.renderImage(t)},e.prototype.getImageAttrs=function(){var t=this.get("start"),i=this.get("end"),u=this.get("style"),c=sl({start:t,end:i}),p=this.get("src");return(0,P.pi)({x:c.x,y:c.y,img:p,width:c.width,height:c.height},u)},e.prototype.renderImage=function(t){this.addShape(t,{type:"image",id:this.getElementId("image"),name:"annotation-image",attrs:this.getImageAttrs()})},e}(Rs),br=ar,rr=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"dataMarker",locationType:"point",x:0,y:0,point:{},line:{},text:{},direction:"upward",autoAdjust:!0,coordinateBBox:null,defaultCfg:{point:{display:!0,style:{r:3,fill:"#FFFFFF",stroke:"#1890FF",lineWidth:2}},line:{display:!0,length:20,style:{stroke:H.lineColor,lineWidth:1}},text:{content:"",display:!0,style:{fill:H.textColor,opacity:.65,fontSize:12,textAlign:"start",fontFamily:H.fontFamily}}}})},e.prototype.renderInner=function(t){(0,b.U2)(this.get("line"),"display")&&this.renderLine(t),(0,b.U2)(this.get("text"),"display")&&this.renderText(t),(0,b.U2)(this.get("point"),"display")&&this.renderPoint(t),this.get("autoAdjust")&&this.autoAdjust(t)},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x")+this.get("offsetX"),y:this.get("y")+this.get("offsetY")})},e.prototype.renderPoint=function(t){var i=this.getShapeAttrs().point;this.addShape(t,{type:"circle",id:this.getElementId("point"),name:"annotation-point",attrs:i})},e.prototype.renderLine=function(t){var i=this.getShapeAttrs().line;this.addShape(t,{type:"path",id:this.getElementId("line"),name:"annotation-line",attrs:i})},e.prototype.renderText=function(t){var i=this.getShapeAttrs().text,u=i.x,c=i.y,p=i.text,g=(0,P._T)(i,["x","y","text"]),_=this.get("text"),S=_.background,k=_.maxLength,L=_.autoEllipsis,R=_.isVertival,U=_.ellipsisPosition,G={x:u,y:c,id:this.getElementId("text"),name:"annotation-text",content:p,style:g,background:S,maxLength:k,autoEllipsis:L,isVertival:R,ellipsisPosition:U};z(t,G)},e.prototype.autoAdjust=function(t){var i=this.get("direction"),u=this.get("x"),c=this.get("y"),p=(0,b.U2)(this.get("line"),"length",0),g=this.get("coordinateBBox"),_=t.getBBox(),S=_.minX,k=_.maxX,L=_.minY,R=_.maxY,U=t.findById(this.getElementId("text-group")),G=t.findById(this.getElementId("text")),Q=t.findById(this.getElementId("line"));if(!!g){if(U){if(u+S<=g.minX){var pt=g.minX-(u+S);Ki(U,U.attr("x")+pt,U.attr("y"))}if(u+k>=g.maxX){var pt=u+k-g.maxX;Ki(U,U.attr("x")-pt,U.attr("y"))}}if(i==="upward"&&c+L<=g.minY||i!=="upward"&&c+R>=g.maxY){var yt=void 0,Ht=void 0;i==="upward"&&c+L<=g.minY?(yt="top",Ht=1):(yt="bottom",Ht=-1),G.attr("textBaseline",yt),Q&&Q.attr("path",[["M",0,0],["L",0,p*Ht]]),Ki(U,U.attr("x"),(p+2)*Ht)}}},e.prototype.getShapeAttrs=function(){var t=(0,b.U2)(this.get("line"),"display"),i=(0,b.U2)(this.get("point"),"style",{}),u=(0,b.U2)(this.get("line"),"style",{}),c=(0,b.U2)(this.get("text"),"style",{}),p=this.get("direction"),g=t?(0,b.U2)(this.get("line"),"length",0):0,_=p==="upward"?-1:1;return{point:(0,P.pi)({x:0,y:0},i),line:(0,P.pi)({path:[["M",0,0],["L",0,g*_]]},u),text:(0,P.pi)({x:0,y:(g+2)*_,text:(0,b.U2)(this.get("text"),"content",""),textBaseline:p==="upward"?"bottom":"top"},c)}},e}(Rs),xr=rr,Pr=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"dataRegion",locationType:"points",points:[],lineLength:0,region:{},text:{},defaultCfg:{region:{style:{lineWidth:0,fill:H.regionColor,opacity:.4}},text:{content:"",style:{textAlign:"center",textBaseline:"bottom",fontSize:12,fill:H.textColor,fontFamily:H.fontFamily}}}})},e.prototype.renderInner=function(t){var i=(0,b.U2)(this.get("region"),"style",{}),u=(0,b.U2)(this.get("text"),"style",{}),c=this.get("lineLength")||0,p=this.get("points");if(!!p.length){var g=Ru(p),_=[];_.push(["M",p[0].x,g.minY-c]),p.forEach(function(k){_.push(["L",k.x,k.y])}),_.push(["L",p[p.length-1].x,p[p.length-1].y-c]),this.addShape(t,{type:"path",id:this.getElementId("region"),name:"annotation-region",attrs:(0,P.pi)({path:_},i)});var S=(0,P.pi)({id:this.getElementId("text"),name:"annotation-text",x:(g.minX+g.maxX)/2,y:g.minY-c},this.get("text"));z(t,S)}},e}(Rs),Rr=Pr,gn=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"regionFilter",locationType:"region",start:null,end:null,color:null,shape:[]})},e.prototype.renderInner=function(t){var i=this,u=this.get("start"),c=this.get("end"),p=this.addGroup(t,{id:this.getElementId("region-filter"),capture:!1});(0,b.S6)(this.get("shapes"),function(_,S){var k=_.get("type"),L=(0,b.d9)(_.attr());i.adjustShapeAttrs(L),i.addShape(p,{id:i.getElementId("shape-"+k+"-"+S),capture:!1,type:k,attrs:L})});var g=sl({start:u,end:c});p.setClip({type:"rect",attrs:{x:g.minX,y:g.minY,width:g.width,height:g.height}})},e.prototype.adjustShapeAttrs=function(t){var i=this.get("color");t.fill&&(t.fill=t.fillStyle=i),t.stroke=t.strokeStyle=i},e}(Rs),ln=gn,bn=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"shape",draw:b.ZT})},e.prototype.renderInner=function(t){var i=this.get("render");(0,b.mf)(i)&&i(t)},e}(Rs),Zn=bn;function Kn(r,e,t){var i;try{i=window.getComputedStyle?window.getComputedStyle(r,null)[e]:r.style[e]}catch(u){}finally{i=i===void 0?t:i}return i}function ci(r,e){var t=Kn(r,"width",e);return t==="auto"&&(t=r.offsetWidth),parseFloat(t)}function Oi(r,e){var t=ci(r,e),i=parseFloat(Kn(r,"borderLeftWidth"))||0,u=parseFloat(Kn(r,"paddingLeft"))||0,c=parseFloat(Kn(r,"paddingRight"))||0,p=parseFloat(Kn(r,"borderRightWidth"))||0,g=parseFloat(Kn(r,"marginRight"))||0,_=parseFloat(Kn(r,"marginLeft"))||0;return t+i+p+u+c+_+g}function na(r,e){var t=Kn(r,"height",e);return t==="auto"&&(t=r.offsetHeight),parseFloat(t)}function ia(r,e){var t=na(r,e),i=parseFloat(Kn(r,"borderTopWidth"))||0,u=parseFloat(Kn(r,"paddingTop"))||0,c=parseFloat(Kn(r,"paddingBottom"))||0,p=parseFloat(Kn(r,"borderBottomWidth"))||0,g=parseFloat(Kn(r,"marginTop"))||0,_=parseFloat(Kn(r,"marginBottom"))||0;return t+i+p+u+c+g+_}var ua=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{container:null,containerTpl:"<div></div>",updateAutoRender:!0,containerClassName:"",parent:null})},e.prototype.getContainer=function(){return this.get("container")},e.prototype.show=function(){var t=this.get("container");t.style.display="",this.set("visible",!0)},e.prototype.hide=function(){var t=this.get("container");t.style.display="none",this.set("visible",!1)},e.prototype.setCapture=function(t){var i=this.getContainer(),u=t?"auto":"none";i.style.pointerEvents=u,this.set("capture",t)},e.prototype.getBBox=function(){var t=this.getContainer(),i=parseFloat(t.style.left)||0,u=parseFloat(t.style.top)||0;return bs(i,u,t.clientWidth,t.clientHeight)},e.prototype.clear=function(){var t=this.get("container");Af(t)},e.prototype.destroy=function(){this.removeEvent(),this.removeDom(),r.prototype.destroy.call(this)},e.prototype.init=function(){r.prototype.init.call(this),this.initContainer(),this.initDom(),this.resetStyles(),this.applyStyles(),this.initEvent(),this.initCapture(),this.initVisible()},e.prototype.initCapture=function(){this.setCapture(this.get("capture"))},e.prototype.initVisible=function(){this.get("visible")?this.show():this.hide()},e.prototype.initDom=function(){},e.prototype.initContainer=function(){var t=this.get("container");if((0,b.UM)(t)){t=this.createDom();var i=this.get("parent");(0,b.HD)(i)&&(i=document.getElementById(i),this.set("parent",i)),i.appendChild(t),this.get("containerId")&&t.setAttribute("id",this.get("containerId")),this.set("container",t)}else(0,b.HD)(t)&&(t=document.getElementById(t),this.set("container",t));this.get("parent")||this.set("parent",t.parentNode)},e.prototype.resetStyles=function(){var t=this.get("domStyles"),i=this.get("defaultStyles");t?t=(0,b.b$)({},i,t):t=i,this.set("domStyles",t)},e.prototype.applyStyles=function(){var t=this.get("domStyles");if(!!t){var i=this.getContainer();this.applyChildrenStyles(i,t);var u=this.get("containerClassName");if(u&&ol(i,u)){var c=t[u];(0,W.Z)(i,c)}}},e.prototype.applyChildrenStyles=function(t,i){(0,b.S6)(i,function(u,c){var p=t.getElementsByClassName(c);(0,b.S6)(p,function(g){(0,W.Z)(g,u)})})},e.prototype.applyStyle=function(t,i){var u=this.get("domStyles");(0,W.Z)(i,u[t])},e.prototype.createDom=function(){var t=this.get("containerTpl");return(0,vt.Z)(t)},e.prototype.initEvent=function(){},e.prototype.removeDom=function(){var t=this.get("container");t&&t.parentNode&&t.parentNode.removeChild(t)},e.prototype.removeEvent=function(){},e.prototype.updateInner=function(t){(0,b.wH)(t,"domStyles")&&(this.resetStyles(),this.applyStyles()),this.resetPosition()},e.prototype.resetPosition=function(){},e}(Wf),Qa=ua,Fi=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"annotation",type:"html",locationType:"point",x:0,y:0,containerTpl:'<div class="g2-html-annotation" style="position:absolute"></div>',alignX:"left",alignY:"top",html:"",zIndex:7})},e.prototype.render=function(){var t=this.getContainer(),i=this.get("html");Af(t);var u=(0,b.mf)(i)?i(t):i;if((0,b.kK)(u))t.appendChild(u);else if((0,b.HD)(u)||(0,b.hj)(u)){var c=(0,vt.Z)(""+u);c&&t.appendChild(c)}this.resetPosition()},e.prototype.resetPosition=function(){var t=this.getContainer(),i=this.getLocation(),u=i.x,c=i.y,p=this.get("alignX"),g=this.get("alignY"),_=this.get("offsetX"),S=this.get("offsetY"),k=Oi(t),L=ia(t),R={x:u,y:c};p==="middle"?R.x-=Math.round(k/2):p==="right"&&(R.x-=Math.round(k)),g==="middle"?R.y-=Math.round(L/2):g==="bottom"&&(R.y-=Math.round(L)),_&&(R.x+=_),S&&(R.y+=S),(0,W.Z)(t,{position:"absolute",left:R.x+"px",top:R.y+"px",zIndex:this.get("zIndex")})},e}(Qa),Ra=Fi;function Aa(r,e,t){var i=e+"Style",u=null;return(0,b.S6)(t,function(c,p){r[p]&&c[i]&&(u||(u={}),(0,b.CD)(u,c[i]))}),u}var ka=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"axis",ticks:[],line:{},tickLine:{},subTickLine:null,title:null,label:{},verticalFactor:1,verticalLimitLength:null,overlapOrder:["autoRotate","autoEllipsis","autoHide"],tickStates:{},optimize:{},defaultCfg:{line:{style:{lineWidth:1,stroke:H.lineColor}},tickLine:{style:{lineWidth:1,stroke:H.lineColor},alignTick:!0,length:5,displayWithLabel:!0},subTickLine:{style:{lineWidth:1,stroke:H.lineColor},count:4,length:2},label:{autoRotate:!0,autoHide:!1,autoEllipsis:!1,style:{fontSize:12,fill:H.textColor,fontFamily:H.fontFamily,fontWeight:"normal"},offset:10,offsetX:0,offsetY:0},title:{autoRotate:!0,spacing:5,position:"center",style:{fontSize:12,fill:H.textColor,textBaseline:"middle",fontFamily:H.fontFamily,textAlign:"center"},iconStyle:{fill:H.descriptionIconFill,stroke:H.descriptionIconStroke},description:""},tickStates:{active:{labelStyle:{fontWeight:500},tickLineStyle:{lineWidth:2}},inactive:{labelStyle:{fill:H.uncheckedColor}}},optimize:{enable:!0,threshold:400}},theme:{}})},e.prototype.renderInner=function(t){this.get("line")&&this.drawLine(t),this.drawTicks(t),this.get("title")&&this.drawTitle(t)},e.prototype.isList=function(){return!0},e.prototype.getItems=function(){return this.get("ticks")},e.prototype.setItems=function(t){this.update({ticks:t})},e.prototype.updateItem=function(t,i){(0,b.CD)(t,i),this.clear(),this.render()},e.prototype.clearItems=function(){var t=this.getElementByLocalId("label-group");t&&t.clear()},e.prototype.setItemState=function(t,i,u){t[i]=u,this.updateTickStates(t)},e.prototype.hasState=function(t,i){return!!t[i]},e.prototype.getItemStates=function(t){var i=this.get("tickStates"),u=[];return(0,b.S6)(i,function(c,p){t[p]&&u.push(p)}),u},e.prototype.clearItemsState=function(t){var i=this,u=this.getItemsByState(t);(0,b.S6)(u,function(c){i.setItemState(c,t,!1)})},e.prototype.getItemsByState=function(t){var i=this,u=this.getItems();return(0,b.hX)(u,function(c){return i.hasState(c,t)})},e.prototype.getSidePoint=function(t,i){var u=this,c=u.getSideVector(i,t);return{x:t.x+c[0],y:t.y+c[1]}},e.prototype.getTextAnchor=function(t){var i;return(0,b.vQ)(t[0],0)?i="center":t[0]>0?i="start":t[0]<0&&(i="end"),i},e.prototype.getTextBaseline=function(t){var i;return(0,b.vQ)(t[1],0)?i="middle":t[1]>0?i="top":t[1]<0&&(i="bottom"),i},e.prototype.processOverlap=function(t){},e.prototype.drawLine=function(t){var i=this.getLinePath(),u=this.get("line");this.addShape(t,{type:"path",id:this.getElementId("line"),name:"axis-line",attrs:(0,b.CD)({path:i},u.style)})},e.prototype.getTickLineItems=function(t){var i=this,u=[],c=this.get("tickLine"),p=c.alignTick,g=c.length,_=1,S=t.length;return S>=2&&(_=t[1].value-t[0].value),(0,b.S6)(t,function(k){var L=k.point;p||(L=i.getTickPoint(k.value-_/2));var R=i.getSidePoint(L,g);u.push({startPoint:L,tickValue:k.value,endPoint:R,tickId:k.id,id:"tickline-"+k.id})}),u},e.prototype.getSubTickLineItems=function(t){var i=[],u=this.get("subTickLine"),c=u.count,p=t.length;if(p>=2)for(var g=0;g<p-1;g++)for(var _=t[g],S=t[g+1],k=0;k<c;k++){var L=(k+1)/(c+1),R=(1-L)*_.tickValue+L*S.tickValue,U=this.getTickPoint(R),G=this.getSidePoint(U,u.length);i.push({startPoint:U,endPoint:G,tickValue:R,id:"sub-"+_.id+"-"+k})}return i},e.prototype.getTickLineAttrs=function(t,i,u,c){var p=this.get(i).style,g={points:[t.startPoint,t.endPoint]},_=(0,b.U2)(this.get("theme"),["tickLine","style"],{});p=(0,b.mf)(p)?(0,b.CD)({},_,p(g,u,c)):p;var S=t.startPoint,k=t.endPoint;return(0,P.pi)({x1:S.x,y1:S.y,x2:k.x,y2:k.y},p)},e.prototype.drawTick=function(t,i,u,c,p){this.addShape(i,{type:"line",id:this.getElementId(t.id),name:"axis-"+u,attrs:this.getTickLineAttrs(t,u,c,p)})},e.prototype.drawTickLines=function(t){var i=this,u=this.get("ticks"),c=this.get("subTickLine"),p=this.getTickLineItems(u),g=this.addGroup(t,{name:"axis-tickline-group",id:this.getElementId("tickline-group")}),_=this.get("tickLine");if((0,b.S6)(p,function(k,L){if(_.displayWithLabel){var R=i.getElementId("label-"+k.tickId);t.findById(R)&&i.drawTick(k,g,"tickLine",L,p)}else i.drawTick(k,g,"tickLine",L,p)}),c){var S=this.getSubTickLineItems(p);(0,b.S6)(S,function(k,L){i.drawTick(k,g,"subTickLine",L,S)})}},e.prototype.processTicks=function(){var t=this,i=this.get("ticks");(0,b.S6)(i,function(u){u.point=t.getTickPoint(u.value),(0,b.UM)(u.id)&&(u.id=u.name)})},e.prototype.drawTicks=function(t){var i=this;this.optimizeTicks(),this.processTicks(),this.get("label")&&this.drawLabels(t),this.get("tickLine")&&this.drawTickLines(t);var u=this.get("ticks");(0,b.S6)(u,function(c){i.applyTickStates(c,t)})},e.prototype.optimizeTicks=function(){var t=this.get("optimize"),i=this.get("ticks");if(t&&t.enable&&t.threshold>0){var u=(0,b.dp)(i);if(u>t.threshold){var c=Math.ceil(u/t.threshold),p=i.filter(function(g,_){return _%c===0});this.set("ticks",p),this.set("originalTicks",i)}}},e.prototype.getLabelAttrs=function(t,i,u){var c=this.get("label"),p=c.offset,g=c.offsetX,_=c.offsetY,S=c.rotate,k=c.formatter,L=this.getSidePoint(t.point,p),R=this.getSideVector(p,L),U=k?k(t.name,t,i):t.name,G=c.style;G=(0,b.mf)(G)?(0,b.U2)(this.get("theme"),["label","style"],{}):G;var Q=(0,b.CD)({x:L.x+g,y:L.y+_,text:U,textAlign:this.getTextAnchor(R),textBaseline:this.getTextBaseline(R)},G);return S&&(Q.matrix=Ts(L,S)),Q},e.prototype.drawLabels=function(t){var i=this,u=this.get("ticks"),c=this.addGroup(t,{name:"axis-label-group",id:this.getElementId("label-group")});(0,b.S6)(u,function(R,U){i.addShape(c,{type:"text",name:"axis-label",id:i.getElementId("label-"+R.id),attrs:i.getLabelAttrs(R,U,u),delegateObject:{tick:R,item:R,index:U}})}),this.processOverlap(c);var p=c.getChildren(),g=(0,b.U2)(this.get("theme"),["label","style"],{}),_=this.get("label"),S=_.style,k=_.formatter;if((0,b.mf)(S)){var L=p.map(function(R){return(0,b.U2)(R.get("delegateObject"),"tick")});(0,b.S6)(p,function(R,U){var G=R.get("delegateObject").tick,Q=k?k(G.name,G,U):G.name,pt=(0,b.CD)({},g,S(Q,U,L));R.attr(pt)})}},e.prototype.getTitleAttrs=function(){var t=this.get("title"),i=t.style,u=t.position,c=t.offset,p=t.spacing,g=p===void 0?0:p,_=t.autoRotate,S=i.fontSize,k=.5;u==="start"?k=0:u==="end"&&(k=1);var L=this.getTickPoint(k),R=this.getSidePoint(L,c||g+S/2),U=(0,b.CD)({x:R.x,y:R.y,text:t.text},i),G=t.rotate,Q=G;if((0,b.UM)(G)&&_){var pt=this.getAxisVector(L),yt=[1,0];Q=ma.Dg(pt,yt,!0)}if(Q){var Ht=Ts(R,Q);U.matrix=Ht}return U},e.prototype.drawTitle=function(t){var i,u=this.getTitleAttrs(),c=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"axis-title",attrs:u});!((i=this.get("title"))===null||i===void 0)&&i.description&&this.drawDescriptionIcon(t,c,u.matrix)},e.prototype.drawDescriptionIcon=function(t,i,u){var c=this.addGroup(t,{name:"axis-description",id:this.getElementById("description")}),p=i.getBBox(),g=p.maxX,_=p.maxY,S=p.height,k=this.get("title").iconStyle,L=4,R=S/2,U=R/6,G=g+L,Q=_-S/2,pt=[G+R,Q-R],yt=pt[0],Ht=pt[1],ce=[yt+R,Ht+R],he=ce[0],ze=ce[1],Er=[yt,ze+R],Fr=Er[0],zr=Er[1],pn=[G,Ht+R],nn=pn[0],Pn=pn[1],wi=[G+R,Q-S/4],ha=wi[0],Sa=wi[1],_o=[ha,Sa+U],Vn=_o[0],Bi=_o[1],fa=[Vn,Bi+U],Ui=fa[0],Ji=fa[1],Fa=[Ui,Ji+R*3/4],xo=Fa[0],Mo=Fa[1];this.addShape(c,{type:"path",id:this.getElementId("title-description-icon"),name:"axis-title-description-icon",attrs:(0,P.pi)({path:[["M",yt,Ht],["A",R,R,0,0,1,he,ze],["A",R,R,0,0,1,Fr,zr],["A",R,R,0,0,1,nn,Pn],["A",R,R,0,0,1,yt,Ht],["M",ha,Sa],["L",Vn,Bi],["M",Ui,Ji],["L",xo,Mo]],lineWidth:U,matrix:u},k)}),this.addShape(c,{type:"rect",id:this.getElementId("title-description-rect"),name:"axis-title-description-rect",attrs:{x:G,y:Q-S/2,width:S,height:S,stroke:"#000",fill:"#000",opacity:0,matrix:u,cursor:"pointer"}})},e.prototype.applyTickStates=function(t,i){var u=this.getItemStates(t);if(u.length){var c=this.get("tickStates"),p=this.getElementId("label-"+t.id),g=i.findById(p);if(g){var _=Aa(t,"label",c);_&&g.attr(_)}var S=this.getElementId("tickline-"+t.id),k=i.findById(S);if(k){var L=Aa(t,"tickLine",c);L&&k.attr(L)}}},e.prototype.updateTickStates=function(t){var i=this.getItemStates(t),u=this.get("tickStates"),c=this.get("label"),p=this.getElementByLocalId("label-"+t.id),g=this.get("tickLine"),_=this.getElementByLocalId("tickline-"+t.id);if(i.length){if(p){var S=Aa(t,"label",u);S&&p.attr(S)}if(_){var k=Aa(t,"tickLine",u);k&&_.attr(k)}}else p&&p.attr(c.style),_&&_.attr(g.style)},e}(Rs),la=ka;function Na(r,e,t,i){var u=e.getChildren(),c=!1;return(0,b.S6)(u,function(p){var g=M(r,p,t,i);c=c||g}),c}function pa(){return Ds}function da(r,e,t){return Na(r,e,t,"head")}function Ds(r,e,t){return Na(r,e,t,"tail")}function ss(r,e,t){return Na(r,e,t,"middle")}function ou(r){var e=r.attr("matrix");return e&&e[0]!==1}function Ks(r){var e=ou(r)?Nl(r.attr("matrix")):0;return e%360}function ls(r,e,t,i){var u=!1,c=Ks(e),p=Math.abs(r?t.attr("y")-e.attr("y"):t.attr("x")-e.attr("x")),g=(r?t.attr("y")>e.attr("y"):t.attr("x")>e.attr("x"))?e.getBBox():t.getBBox();if(r){var _=Math.abs(Math.cos(c));ip(_,0,Math.PI/180)?u=g.width+i>p:u=g.height/_+i>p}else{var _=Math.abs(Math.sin(c));ip(_,0,Math.PI/180)?u=g.width+i>p:u=g.height/_+i>p}return u}function cs(r,e,t,i){var u=(i==null?void 0:i.minGap)||0,c=e.getChildren().slice().filter(function(G){return G.get("visible")});if(!c.length)return!1;var p=!1;t&&c.reverse();for(var g=c.length,_=c[0],S=_,k=1;k<g;k++){var L=c[k],R=L.getBBox(),U=ls(r,S,L,u);U?(L.hide(),p=!0):S=L}return p}function vu(r,e,t){var i=(t==null?void 0:t.minGap)||0,u=e.getChildren().slice();if(u.length<2)return!1;var c=!1,p=u[0],g=p.getBBox(),_=u[1],S=u.length,k=Ks(p),L=Math.abs(r?_.attr("y")-p.attr("y"):_.attr("x")-p.attr("x")),R=0;if(r){var U=Math.abs(Math.cos(k));if(ip(U,0,Math.PI/180)){var G=x(u);R=(G+i)/L}else R=(g.height/U+i)/L}else{var U=Math.abs(Math.sin(k));if(ip(U,0,Math.PI/180)){var G=x(u);R=(G+i)/L}else R=(g.height/U+i)/L}if(R>1){R=Math.ceil(R);for(var Q=0;Q<S;Q++)Q%R!==0&&(u[Q].hide(),c=!0)}return c}function Du(){return cl}function kc(r,e,t,i){return cs(r,e,!1,i)}function qu(r,e,t,i){return cs(r,e,!0,i)}function Kl(r,e,t,i){var u=(i==null?void 0:i.minGap)||0,c=e.getChildren().slice();if(c.length<=2)return!1;for(var p=!1,g=c.length,_=c[0],S=c[g-1],k=_,L=1;L<g-1;L++){var R=c[L],U=R.getBBox(),G=ls(r,k,R,u);G?(R.hide(),p=!0):k=R}var Q=ls(r,k,S,u);return Q&&(k.hide(),p=!0),p}function cl(r,e,t,i){var u=vu(r,e,i);return cs(r,e,!1)&&(u=!0),u}function yh(r,e,t,i){var u=e.getChildren().slice(),c=vu(r,e,i);if(u.length>2){var p=u[0],g=u[u.length-1];p.get("visible")||(p.show(),cs(r,e,!1,i)&&(c=!0)),g.get("visible")||(g.show(),cs(r,e,!0,i)&&(c=!0))}return c}function El(r,e){(0,b.S6)(r,function(t){var i=t.attr("x"),u=t.attr("y"),c=Ts({x:i,y:u},e);t.attr("matrix",c)})}function Ql(r,e,t,i){var u=e.getChildren();if(!u.length||!r&&u.length<2)return!1;var c=x(u),p=!1;if(r)p=!!t&&c>t;else{var g=Math.abs(u[1].attr("x")-u[0].attr("x"));p=c>g}if(p){var _=i(t,c);El(u,_)}return p}function _h(){return Yf}function Yf(r,e,t,i){return Ql(r,e,t,function(){return(0,b.hj)(i)?i:r?H.verticalAxisRotate:H.horizontalAxisRotate})}function dc(r,e,t){return Ql(r,e,t,function(i,u){if(!i)return r?H.verticalAxisRotate:H.horizontalAxisRotate;if(r)return-Math.acos(i/u);var c=0;return i>u?c=Math.PI/4:(c=Math.asin(i/u),c>Math.PI/4&&(c=Math.PI/4)),c})}var xh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line",locationType:"region",start:null,end:null})},e.prototype.getLinePath=function(){var t=this.get("start"),i=this.get("end"),u=[];return u.push(["M",t.x,t.y]),u.push(["L",i.x,i.y]),u},e.prototype.getInnerLayoutBBox=function(){var t=this.get("start"),i=this.get("end"),u=r.prototype.getInnerLayoutBBox.call(this),c=Math.min(t.x,i.x,u.x),p=Math.min(t.y,i.y,u.y),g=Math.max(t.x,i.x,u.maxX),_=Math.max(t.y,i.y,u.maxY);return{x:c,y:p,minX:c,minY:p,maxX:g,maxY:_,width:g-c,height:_-p}},e.prototype.isVertical=function(){var t=this.get("start"),i=this.get("end");return(0,b.vQ)(t.x,i.x)},e.prototype.isHorizontal=function(){var t=this.get("start"),i=this.get("end");return(0,b.vQ)(t.y,i.y)},e.prototype.getTickPoint=function(t){var i=this,u=i.get("start"),c=i.get("end"),p=c.x-u.x,g=c.y-u.y;return{x:u.x+p*t,y:u.y+g*t}},e.prototype.getSideVector=function(t){var i=this.getAxisVector(),u=sa.Fv([0,0],i),c=this.get("verticalFactor"),p=[u[1],u[0]*-1];return sa.bA([0,0],p,t*c)},e.prototype.getAxisVector=function(){var t=this.get("start"),i=this.get("end");return[i.x-t.x,i.y-t.y]},e.prototype.processOverlap=function(t){var i=this,u=this.isVertical(),c=this.isHorizontal();if(!(!u&&!c)){var p=this.get("label"),g=this.get("title"),_=this.get("verticalLimitLength"),S=p.offset,k=_,L=0,R=0;g&&(L=g.style.fontSize,R=g.spacing),k&&(k=k-S-R-L);var U=this.get("overlapOrder");if((0,b.S6)(U,function(pt){p[pt]&&i.canProcessOverlap(pt)&&i.autoProcessOverlap(pt,p[pt],t,k)}),g&&(0,b.UM)(g.offset)){var G=t.getCanvasBBox(),Q=u?G.width:G.height;g.offset=S+Q+R+L/2}}},e.prototype.canProcessOverlap=function(t){var i=this.get("label");return t==="autoRotate"?(0,b.UM)(i.rotate):!0},e.prototype.autoProcessOverlap=function(t,i,u,c){var p=this,g=this.isVertical(),_=!1,S=lt[t];if(i===!0){var k=this.get("label");_=S.getDefault()(g,u,c)}else if((0,b.mf)(i))_=i(g,u,c);else if((0,b.Kn)(i)){var L=i;S[L.type]&&(_=S[L.type](g,u,c,L.cfg))}else S[i]&&(_=S[i](g,u,c));if(t==="autoRotate"){if(_){var R=u.getChildren(),U=this.get("verticalFactor");(0,b.S6)(R,function(Q){var pt=Q.attr("textAlign");if(pt==="center"){var yt=U>0?"end":"start";Q.attr("textAlign",yt)}})}}else if(t==="autoHide"){var G=u.getChildren().slice(0);(0,b.S6)(G,function(Q){Q.get("visible")||(p.get("isRegister")&&p.unregisterElement(Q),Q.remove())})}},e}(la),Jl=xh,js=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",locationType:"circle",center:null,radius:null,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},e.prototype.getLinePath=function(){var t=this.get("center"),i=t.x,u=t.y,c=this.get("radius"),p=c,g=this.get("startAngle"),_=this.get("endAngle"),S=[];if(Math.abs(_-g)===Math.PI*2)S=[["M",i,u-p],["A",c,p,0,1,1,i,u+p],["A",c,p,0,1,1,i,u-p],["Z"]];else{var k=this.getCirclePoint(g),L=this.getCirclePoint(_),R=Math.abs(_-g)>Math.PI?1:0,U=g>_?0:1;S=[["M",i,u],["L",k.x,k.y],["A",c,p,0,R,U,L.x,L.y],["L",i,u]]}return S},e.prototype.getTickPoint=function(t){var i=this.get("startAngle"),u=this.get("endAngle"),c=i+(u-i)*t;return this.getCirclePoint(c)},e.prototype.getSideVector=function(t,i){var u=this.get("center"),c=[i.x-u.x,i.y-u.y],p=this.get("verticalFactor"),g=sa.kE(c);return sa.bA(c,c,p*t/g),c},e.prototype.getAxisVector=function(t){var i=this.get("center"),u=[t.x-i.x,t.y-i.y];return[u[1],-1*u[0]]},e.prototype.getCirclePoint=function(t,i){var u=this.get("center");return i=i||this.get("radius"),{x:u.x+Math.cos(t)*i,y:u.y+Math.sin(t)*i}},e.prototype.canProcessOverlap=function(t){var i=this.get("label");return t==="autoRotate"?(0,b.UM)(i.rotate):!0},e.prototype.processOverlap=function(t){var i=this,u=this.get("label"),c=this.get("title"),p=this.get("verticalLimitLength"),g=u.offset,_=p,S=0,k=0;c&&(S=c.style.fontSize,k=c.spacing),_&&(_=_-g-k-S);var L=this.get("overlapOrder");if((0,b.S6)(L,function(U){u[U]&&i.canProcessOverlap(U)&&i.autoProcessOverlap(U,u[U],t,_)}),c&&(0,b.UM)(c.offset)){var R=t.getCanvasBBox().height;c.offset=g+R+k+S/2}},e.prototype.autoProcessOverlap=function(t,i,u,c){var p=this,g=!1,_=lt[t];if(c>0)if(i===!0)g=_.getDefault()(!1,u,c);else if((0,b.mf)(i))g=i(!1,u,c);else if((0,b.Kn)(i)){var S=i;_[S.type]&&(g=_[S.type](!1,u,c,S.cfg))}else _[i]&&(g=_[i](!1,u,c));if(t==="autoRotate"){if(g){var k=u.getChildren(),L=this.get("verticalFactor");(0,b.S6)(k,function(U){var G=U.attr("textAlign");if(G==="center"){var Q=L>0?"end":"start";U.attr("textAlign",Q)}})}}else if(t==="autoHide"){var R=u.getChildren().slice(0);(0,b.S6)(R,function(U){U.get("visible")||(p.get("isRegister")&&p.unregisterElement(U),U.remove())})}},e}(la),$c=js,Tf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"crosshair",type:"base",line:{},text:null,textBackground:{},capture:!1,defaultCfg:{line:{style:{lineWidth:1,stroke:H.lineColor}},text:{position:"start",offset:10,autoRotate:!1,content:null,style:{fill:H.textColor,textAlign:"center",textBaseline:"middle",fontFamily:H.fontFamily}},textBackground:{padding:5,style:{stroke:H.lineColor}}}})},e.prototype.renderInner=function(t){this.get("line")&&this.renderLine(t),this.get("text")&&(this.renderText(t),this.renderBackground(t))},e.prototype.renderText=function(t){var i=this.get("text"),u=i.style,c=i.autoRotate,p=i.content;if(!(0,b.UM)(p)){var g=this.getTextPoint(),_=null;if(c){var S=this.getRotateAngle();_=Ts(g,S)}this.addShape(t,{type:"text",name:"crosshair-text",id:this.getElementId("text"),attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{text:p,matrix:_}),u)})}},e.prototype.renderLine=function(t){var i=this.getLinePath(),u=this.get("line"),c=u.style;this.addShape(t,{type:"path",name:"crosshair-line",id:this.getElementId("line"),attrs:(0,P.pi)({path:i},c)})},e.prototype.renderBackground=function(t){var i=this.getElementId("text"),u=t.findById(i),c=this.get("textBackground");if(c&&u){var p=u.getBBox(),g=Wi(c.padding),_=c.style,S=this.addShape(t,{type:"rect",name:"crosshair-text-background",id:this.getElementId("text-background"),attrs:(0,P.pi)({x:p.x-g[3],y:p.y-g[0],width:p.width+g[1]+g[3],height:p.height+g[0]+g[2],matrix:u.attr("matrix")},_)});S.toBack()}},e}(Rs),vc=Tf,Lo=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line",locationType:"region",start:null,end:null})},e.prototype.getRotateAngle=function(){var t=this.getLocation(),i=t.start,u=t.end,c=this.get("text").position,p=Math.atan2(u.y-i.y,u.x-i.x),g=c==="start"?p-Math.PI/2:p+Math.PI/2;return g},e.prototype.getTextPoint=function(){var t=this.getLocation(),i=t.start,u=t.end,c=this.get("text"),p=c.position,g=c.offset;return $u(i,u,p,g)},e.prototype.getLinePath=function(){var t=this.getLocation(),i=t.start,u=t.end;return[["M",i.x,i.y],["L",u.x,u.y]]},e}(vc),wl=Lo,Ku=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",locationType:"circle",center:null,radius:100,startAngle:-Math.PI/2,endAngle:Math.PI*3/2})},e.prototype.getRotateAngle=function(){var t=this.getLocation(),i=t.startAngle,u=t.endAngle,c=this.get("text").position,p=c==="start"?i+Math.PI/2:u-Math.PI/2;return p},e.prototype.getTextPoint=function(){var t=this.get("text"),i=t.position,u=t.offset,c=this.getLocation(),p=c.center,g=c.radius,_=c.startAngle,S=c.endAngle,k=i==="start"?_:S,L=this.getRotateAngle()-Math.PI,R=Tc(p,g,k),U=Math.cos(L)*u,G=Math.sin(L)*u;return{x:R.x+U,y:R.y+G}},e.prototype.getLinePath=function(){var t=this.getLocation(),i=t.center,u=t.radius,c=t.startAngle,p=t.endAngle,g=null;if(p-c===Math.PI*2){var _=i.x,S=i.y;g=[["M",_,S-u],["A",u,u,0,1,1,_,S+u],["A",u,u,0,1,1,_,S-u],["Z"]]}else{var k=Tc(i,u,c),L=Tc(i,u,p),R=Math.abs(p-c)>Math.PI?1:0,U=c>p?0:1;g=[["M",k.x,k.y],["A",u,u,0,R,U,L.x,L.y]]}return g},e}(vc),qc=Ku,Kc="g2-crosshair",$f=Kc+"-line",Qc=Kc+"-text",Bu,bh=(Bu={},Bu[""+Kc]={position:"relative"},Bu[""+$f]={position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.25)"},Bu[""+Qc]={position:"absolute",color:H.textColor,fontFamily:H.fontFamily},Bu),tc=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"crosshair",type:"html",locationType:"region",start:{x:0,y:0},end:{x:0,y:0},capture:!1,text:null,containerTpl:'<div class="'+Kc+'"></div>',crosshairTpl:'<div class="'+$f+'"></div>',textTpl:'<span class="'+Qc+'">{content}</span>',domStyles:null,containerClassName:Kc,defaultStyles:bh,defaultCfg:{text:{position:"start",content:null,align:"center",offset:10}}})},e.prototype.render=function(){this.resetText(),this.resetPosition()},e.prototype.initCrossHair=function(){var t=this.getContainer(),i=this.get("crosshairTpl"),u=(0,vt.Z)(i);t.appendChild(u),this.applyStyle($f,u),this.set("crosshairEl",u)},e.prototype.getTextPoint=function(){var t=this.getLocation(),i=t.start,u=t.end,c=this.get("text"),p=c.position,g=c.offset;return $u(i,u,p,g)},e.prototype.resetText=function(){var t=this.get("text"),i=this.get("textEl");if(t){var u=t.content;if(!i){var c=this.getContainer(),p=(0,b.ng)(this.get("textTpl"),t);i=(0,vt.Z)(p),c.appendChild(i),this.applyStyle(Qc,i),this.set("textEl",i)}i.innerHTML=u}else i&&i.remove()},e.prototype.isVertical=function(t,i){return t.x===i.x},e.prototype.resetPosition=function(){var t=this.get("crosshairEl");t||(this.initCrossHair(),t=this.get("crosshairEl"));var i=this.get("start"),u=this.get("end"),c=Math.min(i.x,u.x),p=Math.min(i.y,u.y);this.isVertical(i,u)?(0,W.Z)(t,{width:"1px",height:Ms(Math.abs(u.y-i.y))}):(0,W.Z)(t,{height:"1px",width:Ms(Math.abs(u.x-i.x))}),(0,W.Z)(t,{top:Ms(p),left:Ms(c)}),this.alignText()},e.prototype.alignText=function(){var t=this.get("textEl");if(t){var i=this.get("text").align,u=t.clientWidth,c=this.getTextPoint();switch(i){case"center":c.x=c.x-u/2;break;case"right":c.x=c.x-u;case"left":break}(0,W.Z)(t,{top:Ms(c.y),left:Ms(c.x)})}},e.prototype.updateInner=function(t){(0,b.wH)(t,"text")&&this.resetText(),r.prototype.updateInner.call(this,t)},e}(Qa),Jc=tc,Eh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"grid",line:{},alternateColor:null,capture:!1,items:[],closed:!1,defaultCfg:{line:{type:"line",style:{lineWidth:1,stroke:H.lineColor}}}})},e.prototype.getLineType=function(){var t=this.get("line")||this.get("defaultCfg").line;return t.type},e.prototype.renderInner=function(t){this.drawGrid(t)},e.prototype.getAlternatePath=function(t,i){var u=this.getGridPath(t),c=i.slice(0).reverse(),p=this.getGridPath(c,!0),g=this.get("closed");return g?u=u.concat(p):(p[0][0]="L",u=u.concat(p),u.push(["Z"])),u},e.prototype.getPathStyle=function(){return this.get("line").style},e.prototype.drawGrid=function(t){var i=this,u=this.get("line"),c=this.get("items"),p=this.get("alternateColor"),g=null;(0,b.S6)(c,function(_,S){var k=_.id||S;if(u){var L=i.getPathStyle();L=(0,b.mf)(L)?L(_,S,c):L;var R=i.getElementId("line-"+k),U=i.getGridPath(_.points);i.addShape(t,{type:"path",name:"grid-line",id:R,attrs:(0,b.CD)({path:U},L)})}if(p&&S>0){var G=i.getElementId("region-"+k),Q=S%2===0;if((0,b.HD)(p))Q&&i.drawAlternateRegion(G,t,g.points,_.points,p);else{var pt=Q?p[1]:p[0];i.drawAlternateRegion(G,t,g.points,_.points,pt)}}g=_})},e.prototype.drawAlternateRegion=function(t,i,u,c,p){var g=this.getAlternatePath(u,c);this.addShape(i,{type:"path",id:t,name:"grid-region",attrs:{path:g,fill:p}})},e}(Rs),kl=Eh;function Cu(r,e,t,i){var u=t-r,c=i-e;return Math.sqrt(u*u+c*c)}var sp=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"circle",center:null,closed:!0})},e.prototype.getGridPath=function(t,i){var u=this.getLineType(),c=this.get("closed"),p=[];if(t.length)if(u==="circle"){var g=this.get("center"),_=t[0],S=Cu(g.x,g.y,_.x,_.y),k=i?0:1;c?(p.push(["M",g.x,g.y-S]),p.push(["A",S,S,0,0,k,g.x,g.y+S]),p.push(["A",S,S,0,0,k,g.x,g.y-S]),p.push(["Z"])):(0,b.S6)(t,function(L,R){R===0?p.push(["M",L.x,L.y]):p.push(["A",S,S,0,0,k,L.x,L.y])})}else(0,b.S6)(t,function(L,R){R===0?p.push(["M",L.x,L.y]):p.push(["L",L.x,L.y])}),c&&p.push(["Z"]);return p},e}(kl),Sd=sp,uv=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"line"})},e.prototype.getGridPath=function(t){var i=[];return(0,b.S6)(t,function(u,c){c===0?i.push(["M",u.x,u.y]):i.push(["L",u.x,u.y])}),i},e}(kl),lv=uv,G0=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"legend",layout:"horizontal",locationType:"point",x:0,y:0,offsetX:0,offsetY:0,title:null,background:null})},e.prototype.getLayoutBBox=function(){var t=r.prototype.getLayoutBBox.call(this),i=this.get("maxWidth"),u=this.get("maxHeight"),c=t.width,p=t.height;return i&&(c=Math.min(c,i)),u&&(p=Math.min(p,u)),bs(t.minX,t.minY,c,p)},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetLocation()},e.prototype.resetLocation=function(){var t=this.get("x"),i=this.get("y"),u=this.get("offsetX"),c=this.get("offsetY");this.moveElementTo(this.get("group"),{x:t+u,y:i+c})},e.prototype.applyOffset=function(){this.resetLocation()},e.prototype.getDrawPoint=function(){return this.get("currentPoint")},e.prototype.setDrawPoint=function(t){return this.set("currentPoint",t)},e.prototype.renderInner=function(t){this.resetDraw(),this.get("title")&&this.drawTitle(t),this.drawLegendContent(t),this.get("background")&&this.drawBackground(t)},e.prototype.drawBackground=function(t){var i=this.get("background"),u=t.getBBox(),c=Wi(i.padding),p=(0,P.pi)({x:0,y:0,width:u.width+c[1]+c[3],height:u.height+c[0]+c[2]},i.style),g=this.addShape(t,{type:"rect",id:this.getElementId("background"),name:"legend-background",attrs:p});g.toBack()},e.prototype.drawTitle=function(t){var i=this.get("currentPoint"),u=this.get("title"),c=u.spacing,p=u.style,g=u.text,_=this.addShape(t,{type:"text",id:this.getElementId("title"),name:"legend-title",attrs:(0,P.pi)({text:g,x:i.x,y:i.y},p)}),S=_.getBBox();this.set("currentPoint",{x:i.x,y:S.maxY+c})},e.prototype.resetDraw=function(){var t=this.get("background"),i={x:0,y:0};if(t){var u=Wi(t.padding);i.x=u[3],i.y=u[0]}this.set("currentPoint",i)},e}(Rs),Up=G0,Lc={marker:{style:{inactiveFill:"#000",inactiveOpacity:.45,fill:"#000",opacity:1,size:12}},text:{style:{fill:"#ccc",fontSize:12}}},tf={fill:H.textColor,fontSize:12,textAlign:"start",textBaseline:"middle",fontFamily:H.fontFamily,fontWeight:"normal",lineHeight:12},wh="navigation-arrow-right",cv="navigation-arrow-left",Sl={right:90*Math.PI/180,left:(360-90)*Math.PI/180,up:0,down:180*Math.PI/180},ei=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.currentPageIndex=1,t.totalPagesCnt=1,t.pageWidth=0,t.pageHeight=0,t.startX=0,t.startY=0,t.onNavigationBack=function(){var i=t.getElementByLocalId("item-group");if(t.currentPageIndex>1){t.currentPageIndex-=1,t.updateNavigation();var u=t.getCurrentNavigationMatrix();t.get("animate")?i.animate({matrix:u},100):i.attr({matrix:u})}},t.onNavigationAfter=function(){var i=t.getElementByLocalId("item-group");if(t.currentPageIndex<t.totalPagesCnt){t.currentPageIndex+=1,t.updateNavigation();var u=t.getCurrentNavigationMatrix();t.get("animate")?i.animate({matrix:u},100):i.attr({matrix:u})}},t}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"legend",type:"category",itemSpacing:24,itemMarginBottom:8,maxItemWidth:null,itemWidth:null,itemHeight:null,itemName:{},itemValue:null,maxWidth:null,maxHeight:null,marker:{},radio:null,items:[],itemStates:{},itemBackground:{},pageNavigator:{},defaultCfg:{title:{spacing:5,style:{fill:H.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}},background:{padding:5,style:{stroke:H.lineColor}},itemBackground:{style:{opacity:0,fill:"#fff"}},pageNavigator:Lc,itemName:{spacing:16,style:tf},marker:{spacing:8,style:{r:6,symbol:"circle"}},itemValue:{alignRight:!1,formatter:null,style:tf,spacing:6},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:H.uncheckedColor},markerStyle:{fill:H.uncheckedColor,stroke:H.uncheckedColor}},inactive:{nameStyle:{fill:H.uncheckedColor},markerStyle:{opacity:.2}}}}})},e.prototype.isList=function(){return!0},e.prototype.getItems=function(){return this.get("items")},e.prototype.setItems=function(t){this.update({items:t})},e.prototype.updateItem=function(t,i){(0,b.CD)(t,i),this.clear(),this.render()},e.prototype.clearItems=function(){var t=this.getElementByLocalId("item-group");t&&t.clear()},e.prototype.setItemState=function(t,i,u){t[i]=u;var c=this.getElementByLocalId("item-"+t.id);if(c){var p=this.getItems(),g=p.indexOf(t),_=this.createOffScreenGroup(),S=this.drawItem(t,g,this.getItemHeight(),_);this.updateElements(S,c),this.clearUpdateStatus(c)}},e.prototype.hasState=function(t,i){return!!t[i]},e.prototype.getItemStates=function(t){var i=this.get("itemStates"),u=[];return(0,b.S6)(i,function(c,p){t[p]&&u.push(p)}),u},e.prototype.clearItemsState=function(t){var i=this,u=this.getItemsByState(t);(0,b.S6)(u,function(c){i.setItemState(c,t,!1)})},e.prototype.getItemsByState=function(t){var i=this,u=this.getItems();return(0,b.hX)(u,function(c){return i.hasState(c,t)})},e.prototype.drawLegendContent=function(t){this.processItems(),this.drawItems(t)},e.prototype.processItems=function(){var t=this.get("items");(0,b.S6)(t,function(i){i.id||(i.id=i.name)})},e.prototype.drawItems=function(t){var i=this,u=this.addGroup(t,{id:this.getElementId("item-container-group"),name:"legend-item-container-group"}),c=this.addGroup(u,{id:this.getElementId("item-group"),name:"legend-item-group"}),p=this.getItemHeight(),g=this.get("itemWidth"),_=this.get("itemSpacing"),S=this.get("itemMarginBottom"),k=this.get("currentPoint"),L=k.x,R=k.y,U=this.get("layout"),G=this.get("items"),Q=!1,pt=0,yt=this.get("maxWidth"),Ht=this.get("maxHeight");(0,b.S6)(G,function(ce,he){var ze=i.drawItem(ce,he,p,c),Er=ze.getBBox(),Fr=g||Er.width;Fr>pt&&(pt=Fr),U==="horizontal"?(yt&&yt<k.x+Fr-L&&(Q=!0,k.x=L,k.y+=p+S),i.moveElementTo(ze,k),k.x+=Fr+_):(Ht&&Ht<k.y+p+S-R&&(Q=!0,k.x+=pt+_,k.y=R,pt=0),i.moveElementTo(ze,k),k.y+=p+S)}),Q&&this.get("flipPage")&&(this.pageHeight=0,this.pageWidth=0,this.totalPagesCnt=1,this.startX=L,this.startY=R,this.adjustNavigation(t,c))},e.prototype.getItemHeight=function(){var t=this.get("itemHeight");if(!t){var i=(this.get("itemName")||{}).style;if((0,b.mf)(i)){var u=this.getItems();u.forEach(function(c,p){var g=(0,P.pi)((0,P.pi)({},tf),i(c,p,u)).fontSize;t<g&&(t=g)})}else i&&(t=i.fontSize)}return t},e.prototype.drawMarker=function(t,i,u,c){var p=(0,P.pi)((0,P.pi)((0,P.pi)({x:0,y:c/2},i.style),{symbol:(0,b.U2)(u.marker,"symbol","circle")}),(0,b.U2)(u.marker,"style",{})),g=this.addShape(t,{type:"marker",id:this.getElementId("item-"+u.id+"-marker"),name:"legend-item-marker",attrs:p}),_=g.getBBox();g.attr("x",_.width/2);var S=g.attr(),k=S.stroke,L=S.fill;return k&&g.set("isStroke",!0),L&&g.set("isFill",!0),g},e.prototype.drawItemText=function(t,i,u,c,p,g,_){var S=u.formatter,k=u.style,L=(0,P.pi)((0,P.pi)({x:g,y:p/2,text:S?S(c[i],c,_):c[i]},tf),(0,b.mf)(k)?k(c,_,this.getItems()):k);return this.addShape(t,{type:"text",id:this.getElementId("item-"+c.id+"-"+i),name:"legend-item-"+i,attrs:L})},e.prototype.drawRadio=function(t,i,u,c,p){var g,_,S=i.style||{},k=(g=S.r)!==null&&g!==void 0?g:c/2,L=k*3.6/8,R=[p+k,c/2-k],U=R[0],G=R[1],Q=[U+k,G+k],pt=Q[0],yt=Q[1],Ht=[U,yt+k],ce=Ht[0],he=Ht[1],ze=[p,G+k],Er=ze[0],Fr=ze[1],zr=u.showRadio,pn=(0,P.pi)((0,P.pi)({path:[["M",U,G],["A",k,k,0,0,1,pt,yt],["L",pt-L,yt],["L",pt,yt],["A",k,k,0,0,1,ce,he],["L",ce,he-L],["L",ce,he],["A",k,k,0,0,1,Er,Fr],["L",Er+L,Fr],["L",Er,Fr],["A",k,k,0,0,1,U,G],["L",U,G+L]],stroke:"#000000",fill:"#ffffff"},S),{opacity:zr?(_=S==null?void 0:S.opacity)!==null&&_!==void 0?_:.45:0}),nn=this.addShape(t,{type:"path",id:this.getElementId("item-"+u.id+"-radio"),name:"legend-item-radio",attrs:pn});return nn.set("tip",i.tip),nn},e.prototype.drawItem=function(t,i,u,c){var p="item-"+t.id,g=this.addGroup(c,{name:"legend-item-container",id:this.getElementId("item-container-"+p),delegateObject:{item:t,index:i}}),_=this.addGroup(g,{name:"legend-item",id:this.getElementId(p),delegateObject:{item:t,index:i}}),S=this.get("marker"),k=this.get("itemName"),L=this.get("itemValue"),R=this.get("itemBackground"),U=this.get("radio"),G=this.getLimitItemWidth(),Q=0;if(S){var pt=this.drawMarker(_,S,t,u),yt=S.spacing,Ht=(0,b.U2)(t,["marker","spacing"]);(0,b.hj)(Ht)&&(yt=Ht),Q=pt.getBBox().maxX+yt}if(k){var ce=this.drawItemText(_,"name",k,t,u,Q,i);G&&M(!0,ce,(0,b.uZ)(G-Q,0,G)),Q=ce.getBBox().maxX+k.spacing}if(L){var he=this.drawItemText(_,"value",L,t,u,Q,i);G&&(L.alignRight?(he.attr({textAlign:"right",x:G}),M(!0,he,(0,b.uZ)(G-Q,0,G),"head")):M(!0,he,(0,b.uZ)(G-Q,0,G))),Q=he.getBBox().maxX+L.spacing}if(U&&this.drawRadio(_,U,t,u,Q),R){var ze=_.getBBox(),Er=this.addShape(_,{type:"rect",name:"legend-item-background",id:this.getElementId(p+"-background"),attrs:(0,P.pi)({x:0,y:0,width:ze.width,height:u},R.style)});Er.toBack()}return this.applyItemStates(t,_),_},e.prototype.adjustNavigation=function(t,i){var u=this,c=this.startX,p=this.startY,g=this.get("layout"),_=i.findAll(function(nn){return nn.get("name")==="legend-item"}),S=this.get("maxWidth"),k=this.get("maxHeight"),L=this.get("itemWidth"),R=this.get("itemSpacing"),U=this.getItemHeight(),G=(0,b.b$)({},Lc,this.get("pageNavigator")),Q=this.drawNavigation(t,g,"00/00",G),pt=Q.getBBox(),yt={x:c,y:p},Ht=1,ce=0,he=0,ze=0,Er=this.get("itemMarginBottom");if(g==="horizontal"){var Fr=this.get("maxRow")||1,zr=U+(Fr===1?0:Er);this.pageHeight=zr*Fr,(0,b.S6)(_,function(nn){var Pn=nn.getBBox(),wi=L||Pn.width;(ce&&ce<yt.x+wi+R||S<yt.x+wi+R+pt.width)&&(Ht===1&&(ce=yt.x+R,u.pageWidth=ce,u.moveElementTo(Q,{x:S-R-pt.width-pt.minX,y:yt.y+U/2-pt.height/2-pt.minY})),Ht+=1,yt.x=c,yt.y+=zr),u.moveElementTo(nn,yt),nn.getParent().setClip({type:"rect",attrs:{x:yt.x,y:yt.y,width:wi+R,height:U}}),yt.x+=wi+R})}else{(0,b.S6)(_,function(nn){var Pn=nn.getBBox();Pn.width>he&&(he=Pn.width)}),ze=he,he+=R,S&&(he=Math.min(S,he),ze=Math.min(S,ze)),this.pageWidth=he,this.pageHeight=k-Math.max(pt.height,U+Er);var pn=Math.floor(this.pageHeight/(U+Er));(0,b.S6)(_,function(nn,Pn){Pn!==0&&Pn%pn===0&&(Ht+=1,yt.x+=he,yt.y=p),u.moveElementTo(nn,yt),nn.getParent().setClip({type:"rect",attrs:{x:yt.x,y:yt.y,width:he,height:U}}),yt.y+=U+Er}),this.totalPagesCnt=Ht,this.moveElementTo(Q,{x:c+ze/2-pt.width/2-pt.minX,y:k-pt.height-pt.minY})}this.pageHeight&&this.pageWidth&&i.getParent().setClip({type:"rect",attrs:{x:this.startX,y:this.startY,width:this.pageWidth,height:this.pageHeight}}),g==="horizontal"&&this.get("maxRow")?this.totalPagesCnt=Math.ceil(Ht/this.get("maxRow")):this.totalPagesCnt=Ht,this.currentPageIndex>this.totalPagesCnt&&(this.currentPageIndex=1),this.updateNavigation(Q),i.attr("matrix",this.getCurrentNavigationMatrix())},e.prototype.drawNavigation=function(t,i,u,c){var p={x:0,y:0},g=this.addGroup(t,{id:this.getElementId("navigation-group"),name:"legend-navigation"}),_=(0,b.U2)(c.marker,"style",{}),S=_.size,k=S===void 0?12:S,L=(0,P._T)(_,["size"]),R=this.drawArrow(g,p,cv,i==="horizontal"?"up":"left",k,L);R.on("click",this.onNavigationBack);var U=R.getBBox();p.x+=U.width+2;var G=this.addShape(g,{type:"text",id:this.getElementId("navigation-text"),name:"navigation-text",attrs:(0,P.pi)({x:p.x,y:p.y+k/2,text:u,textBaseline:"middle"},(0,b.U2)(c.text,"style"))}),Q=G.getBBox();p.x+=Q.width+2;var pt=this.drawArrow(g,p,wh,i==="horizontal"?"down":"right",k,L);return pt.on("click",this.onNavigationAfter),g},e.prototype.updateNavigation=function(t){var i=(0,b.b$)({},Lc,this.get("pageNavigator")),u=i.marker.style,c=u.fill,p=u.opacity,g=u.inactiveFill,_=u.inactiveOpacity,S=this.currentPageIndex+"/"+this.totalPagesCnt,k=t?t.getChildren()[1]:this.getElementByLocalId("navigation-text"),L=t?t.findById(this.getElementId(cv)):this.getElementByLocalId(cv),R=t?t.findById(this.getElementId(wh)):this.getElementByLocalId(wh);k.attr("text",S),L.attr("opacity",this.currentPageIndex===1?_:p),L.attr("fill",this.currentPageIndex===1?g:c),L.attr("cursor",this.currentPageIndex===1?"not-allowed":"pointer"),R.attr("opacity",this.currentPageIndex===this.totalPagesCnt?_:p),R.attr("fill",this.currentPageIndex===this.totalPagesCnt?g:c),R.attr("cursor",this.currentPageIndex===this.totalPagesCnt?"not-allowed":"pointer");var U=L.getBBox().maxX+2;k.attr("x",U),U+=k.getBBox().width+2,this.updateArrowPath(R,{x:U,y:0})},e.prototype.drawArrow=function(t,i,u,c,p,g){var _=i.x,S=i.y,k=this.addShape(t,{type:"path",id:this.getElementId(u),name:u,attrs:(0,P.pi)({size:p,direction:c,path:[["M",_+p/2,S],["L",_,S+p],["L",_+p,S+p],["Z"]],cursor:"pointer"},g)});return k.attr("matrix",Ts({x:_+p/2,y:S+p/2},Sl[c])),k},e.prototype.updateArrowPath=function(t,i){var u=i.x,c=i.y,p=t.attr(),g=p.size,_=p.direction,S=Ts({x:u+g/2,y:c+g/2},Sl[_]);t.attr("path",[["M",u+g/2,c],["L",u,c+g],["L",u+g,c+g],["Z"]]),t.attr("matrix",S)},e.prototype.getCurrentNavigationMatrix=function(){var t=this,i=t.currentPageIndex,u=t.pageWidth,c=t.pageHeight,p=this.get("layout"),g=p==="horizontal"?{x:0,y:c*(1-i)}:{x:u*(1-i),y:0};return jc(g)},e.prototype.applyItemStates=function(t,i){var u=this.getItemStates(t),c=u.length>0;if(c){var p=i.getChildren(),g=this.get("itemStates");(0,b.S6)(p,function(_){var S=_.get("name"),k=S.split("-")[2],L=Aa(t,k,g);L&&(_.attr(L),k==="marker"&&!(_.get("isStroke")&&_.get("isFill"))&&(_.get("isStroke")&&_.attr("fill",null),_.get("isFill")&&_.attr("stroke",null)))})}},e.prototype.getLimitItemWidth=function(){var t=this.get("itemWidth"),i=this.get("maxItemWidth");return i?t&&(i=t<=i?t:i):t&&(i=t),i},e}(Up),Cd=ei,Gm=1.4,Bs=.4,Mf=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{type:"continue",min:0,max:100,value:null,colors:[],track:{},rail:{},label:{},handler:{},slidable:!0,tip:null,step:null,maxWidth:null,maxHeight:null,defaultCfg:{label:{align:"rail",spacing:5,formatter:null,style:{fontSize:12,fill:H.textColor,textBaseline:"middle",fontFamily:H.fontFamily}},handler:{size:10,style:{fill:"#fff",stroke:"#333"}},track:{},rail:{type:"color",size:20,defaultLength:100,style:{fill:"#DCDEE2"}},title:{spacing:5,style:{fill:H.textColor,fontSize:12,textAlign:"start",textBaseline:"top"}}}})},e.prototype.isSlider=function(){return!0},e.prototype.getValue=function(){return this.getCurrentValue()},e.prototype.getRange=function(){return{min:this.get("min"),max:this.get("max")}},e.prototype.setRange=function(t,i){this.update({min:t,max:i})},e.prototype.setValue=function(t){var i=this.getValue();this.set("value",t);var u=this.get("group");this.resetTrackClip(),this.get("slidable")&&this.resetHandlers(u),this.delegateEmit("valuechanged",{originValue:i,value:t})},e.prototype.initEvent=function(){var t=this.get("group");this.bindSliderEvent(t),this.bindRailEvent(t),this.bindTrackEvent(t)},e.prototype.drawLegendContent=function(t){this.drawRail(t),this.drawLabels(t),this.fixedElements(t),this.resetTrack(t),this.resetTrackClip(t),this.get("slidable")&&this.resetHandlers(t)},e.prototype.bindSliderEvent=function(t){this.bindHandlersEvent(t)},e.prototype.bindHandlersEvent=function(t){var i=this;t.on("legend-handler-min:drag",function(u){var c=i.getValueByCanvasPoint(u.x,u.y),p=i.getCurrentValue(),g=p[1];g<c&&(g=c),i.setValue([c,g])}),t.on("legend-handler-max:drag",function(u){var c=i.getValueByCanvasPoint(u.x,u.y),p=i.getCurrentValue(),g=p[0];g>c&&(g=c),i.setValue([g,c])})},e.prototype.bindRailEvent=function(t){},e.prototype.bindTrackEvent=function(t){var i=this,u=null;t.on("legend-track:dragstart",function(c){u={x:c.x,y:c.y}}),t.on("legend-track:drag",function(c){if(!!u){var p=i.getValueByCanvasPoint(u.x,u.y),g=i.getValueByCanvasPoint(c.x,c.y),_=i.getCurrentValue(),S=_[1]-_[0],k=i.getRange(),L=g-p;L<0?_[0]+L>k.min?i.setValue([_[0]+L,_[1]+L]):i.setValue([k.min,k.min+S]):L>0&&(L>0&&_[1]+L<k.max?i.setValue([_[0]+L,_[1]+L]):i.setValue([k.max-S,k.max])),u={x:c.x,y:c.y}}}),t.on("legend-track:dragend",function(c){u=null})},e.prototype.drawLabels=function(t){this.drawLabel("min",t),this.drawLabel("max",t)},e.prototype.drawLabel=function(t,i){var u=this.get("label"),c=u.style,p=u.align,g=u.formatter,_=this.get(t),S=this.getLabelAlignAttrs(t,p),k="label-"+t;this.addShape(i,{type:"text",id:this.getElementId(k),name:"legend-label-"+t,attrs:(0,P.pi)((0,P.pi)({x:0,y:0,text:(0,b.mf)(g)?g(_):_},c),S)})},e.prototype.getLabelAlignAttrs=function(t,i){var u=this.isVertical(),c="center",p="middle";return u?(c="start",i!=="rail"?t==="min"?p="top":p="bottom":p="top"):i!=="rail"?(p="top",t==="min"?c="start":c="end"):(c="start",p="middle"),{textAlign:c,textBaseline:p}},e.prototype.getRailPath=function(t,i,u,c){var p=this.get("rail"),g=p.size,_=p.defaultLength,S=p.type,k=this.isVertical(),L=_,R=u,U=c;R||(R=k?g:L),U||(U=k?L:g);var G=[];return S==="color"?(G.push(["M",t,i]),G.push(["L",t+R,i]),G.push(["L",t+R,i+U]),G.push(["L",t,i+U]),G.push(["Z"])):(G.push(["M",t+R,i]),G.push(["L",t+R,i+U]),G.push(["L",t,i+U]),G.push(["Z"])),G},e.prototype.drawRail=function(t){var i=this.get("rail"),u=i.style;this.addShape(t,{type:"path",id:this.getElementId("rail"),name:"legend-rail",attrs:(0,P.pi)({path:this.getRailPath(0,0)},u)})},e.prototype.getTrackColor=function(t){var i=t.length;if(!i)return null;if(i===1)return t[0];var u;this.isVertical()?u="l(90)":u="l(0)";for(var c=0;c<i;c++){var p=c/(i-1);u+=" "+p+":"+t[c]}return u},e.prototype.getTrackPath=function(t){var i=this.getRailShape(t),u=i.attr("path");return(0,b.d9)(u)},e.prototype.getClipTrackAttrs=function(t){var i=this.getCurrentValue(),u=i[0],c=i[1],p=this.getRailBBox(t),g=this.getPointByValue(u,t),_=this.getPointByValue(c,t),S=this.isVertical(),k,L,R,U;return S?(k=p.minX,L=g.y,R=p.width,U=_.y-g.y):(k=g.x,L=p.minY,R=_.x-g.x,U=p.height),{x:k,y:L,width:R,height:U}},e.prototype.getTrackAttrs=function(t){var i=this.get("track"),u=this.get("colors"),c=this.getTrackPath(t);return(0,b.CD)({path:c,fill:this.getTrackColor(u)},i.style)},e.prototype.resetTrackClip=function(t){var i=t||this.get("group"),u=this.getElementId("track"),c=i.findById(u),p=c.getClip(),g=this.getClipTrackAttrs(t);p?p.attr(g):c.setClip({type:"rect",attrs:g})},e.prototype.resetTrack=function(t){var i=this.getElementId("track"),u=t.findById(i),c=this.getTrackAttrs(t);u?u.attr(c):this.addShape(t,{type:"path",id:i,draggable:this.get("slidable"),name:"legend-track",attrs:c})},e.prototype.getPointByValue=function(t,i){var u=this.getRange(),c=u.min,p=u.max,g=(t-c)/(p-c),_=this.getRailBBox(i),S=this.isVertical(),k={x:0,y:0};return S?(k.x=_.minX+_.width/2,k.y=Ac(_.minY,_.maxY,g)):(k.x=Ac(_.minX,_.maxX,g),k.y=_.minY+_.height/2),k},e.prototype.getRailShape=function(t){var i=t||this.get("group");return i.findById(this.getElementId("rail"))},e.prototype.getRailBBox=function(t){var i=this.getRailShape(t),u=i.getBBox();return u},e.prototype.getRailCanvasBBox=function(){var t=this.get("group"),i=t.findById(this.getElementId("rail")),u=i.getCanvasBBox();return u},e.prototype.isVertical=function(){return this.get("layout")==="vertical"},e.prototype.getValueByCanvasPoint=function(t,i){var u=this.getRange(),c=u.min,p=u.max,g=this.getRailCanvasBBox(),_=this.isVertical(),S=this.get("step"),k;_?k=(i-g.minY)/g.height:k=(t-g.minX)/g.width;var L=Ac(c,p,k);if(S){var R=Math.round((L-c)/S);L=c+R*S}return L>p&&(L=p),L<c&&(L=c),L},e.prototype.getCurrentValue=function(){var t=this.get("value");if(!t){var i=this.get("values");return i?[Math.max(Math.min.apply(Math,(0,P.pr)(i,[this.get("max")])),this.get("min")),Math.min(Math.max.apply(Math,(0,P.pr)(i,[this.get("min")])),this.get("max"))]:[this.get("min"),this.get("max")]}return t},e.prototype.resetHandlers=function(t){var i=this.getCurrentValue(),u=i[0],c=i[1];this.resetHandler(t,"min",u),this.resetHandler(t,"max",c)},e.prototype.getHandlerPath=function(t,i){var u=this.isVertical(),c=[],p=t.size,g=i.x,_=i.y,S=p*Gm,k=p/2,L=p/6;if(u){var R=g+S*Bs;c.push(["M",g,_]),c.push(["L",R,_+k]),c.push(["L",g+S,_+k]),c.push(["L",g+S,_-k]),c.push(["L",R,_-k]),c.push(["Z"]),c.push(["M",R,_+L]),c.push(["L",g+S-2,_+L]),c.push(["M",R,_-L]),c.push(["L",g+S-2,_-L])}else{var U=_+S*Bs;c.push(["M",g,_]),c.push(["L",g-k,U]),c.push(["L",g-k,_+S]),c.push(["L",g+k,_+S]),c.push(["L",g+k,U]),c.push(["Z"]),c.push(["M",g-L,U]),c.push(["L",g-L,_+S-2]),c.push(["M",g+L,U]),c.push(["L",g+L,_+S-2])}return c},e.prototype.resetHandler=function(t,i,u){var c=this.getPointByValue(u,t),p=this.get("handler"),g=this.getHandlerPath(p,c),_=this.getElementId("handler-"+i),S=t.findById(_),k=this.isVertical();S?S.attr("path",g):this.addShape(t,{type:"path",name:"legend-handler-"+i,draggable:!0,id:_,attrs:(0,P.pi)((0,P.pi)({path:g},p.style),{cursor:k?"ns-resize":"ew-resize"})})},e.prototype.fixedElements=function(t){var i=t.findById(this.getElementId("rail")),u=t.findById(this.getElementId("label-min")),c=t.findById(this.getElementId("label-max")),p=this.getDrawPoint();this.isVertical()?this.fixedVertail(u,c,i,p):this.fixedHorizontal(u,c,i,p)},e.prototype.fitRailLength=function(t,i,u,c){var p=this.isVertical(),g=p?"height":"width",_=this.get("label"),S=_.align,k=_.spacing,L=this.get("max"+(0,b.jC)(g));if(L){var R=S==="rail"?u[g]+t[g]+i[g]+k*2:u[g],U=R-L;U>0&&this.changeRailLength(c,g,u[g]-U)}},e.prototype.changeRailLength=function(t,i,u){var c=t.getBBox(),p;i==="height"?p=this.getRailPath(c.x,c.y,c.width,u):p=this.getRailPath(c.x,c.y,u,c.height),t.attr("path",p)},e.prototype.changeRailPosition=function(t,i,u){var c=t.getBBox(),p=this.getRailPath(i,u,c.width,c.height);t.attr("path",p)},e.prototype.fixedHorizontal=function(t,i,u,c){var p=this.get("label"),g=p.align,_=p.spacing,S=u.getBBox(),k=t.getBBox(),L=i.getBBox(),R=S.height;this.fitRailLength(k,L,S,u),S=u.getBBox(),g==="rail"?(t.attr({x:c.x,y:c.y+R/2}),this.changeRailPosition(u,c.x+k.width+_,c.y),i.attr({x:c.x+k.width+S.width+_*2,y:c.y+R/2})):g==="top"?(t.attr({x:c.x,y:c.y}),i.attr({x:c.x+S.width,y:c.y}),this.changeRailPosition(u,c.x,c.y+k.height+_)):(this.changeRailPosition(u,c.x,c.y),t.attr({x:c.x,y:c.y+S.height+_}),i.attr({x:c.x+S.width,y:c.y+S.height+_}))},e.prototype.fixedVertail=function(t,i,u,c){var p=this.get("label"),g=p.align,_=p.spacing,S=u.getBBox(),k=t.getBBox(),L=i.getBBox();if(this.fitRailLength(k,L,S,u),S=u.getBBox(),g==="rail")t.attr({x:c.x,y:c.y}),this.changeRailPosition(u,c.x,c.y+k.height+_),i.attr({x:c.x,y:c.y+k.height+S.height+_*2});else if(g==="right")t.attr({x:c.x+S.width+_,y:c.y}),this.changeRailPosition(u,c.x,c.y),i.attr({x:c.x+S.width+_,y:c.y+S.height});else{var R=Math.max(k.width,L.width);t.attr({x:c.x,y:c.y}),this.changeRailPosition(u,c.x+R+_,c.y),i.attr({x:c.x,y:c.y+S.height})}},e}(Up),Zp=Mf,ef="g2-tooltip",Cl="g2-tooltip-title",Pc="g2-tooltip-list",Vp="g2-tooltip-list-item",Sh="g2-tooltip-marker",fv="g2-tooltip-value",Ns="g2-tooltip-name",qf="g2-tooltip-crosshair-x",Ad="g2-tooltip-crosshair-y",gc,hv=(gc={},gc[""+ef]={position:"absolute",visibility:"visible",zIndex:8,transition:"visibility 0.2s cubic-bezier(0.23, 1, 0.32, 1), left 0.4s cubic-bezier(0.23, 1, 0.32, 1), top 0.4s cubic-bezier(0.23, 1, 0.32, 1)",backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0px 0px 10px #aeaeae",borderRadius:"3px",color:"rgb(87, 87, 87)",fontSize:"12px",fontFamily:H.fontFamily,lineHeight:"20px",padding:"10px 10px 6px 10px"},gc[""+Cl]={marginBottom:"4px"},gc[""+Pc]={margin:"0px",listStyleType:"none",padding:"0px"},gc[""+Vp]={listStyleType:"none",marginBottom:"4px"},gc[""+Sh]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},gc[""+fv]={display:"inline-block",float:"right",marginLeft:"30px"},gc[""+qf]={position:"absolute",width:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},gc[""+Ad]={position:"absolute",height:"1px",backgroundColor:"rgba(0, 0, 0, 0.25)"},gc);function Td(r,e,t,i,u){var c={left:r<u.x,right:r+t>u.x+u.width,top:e<u.y,bottom:e+i>u.y+u.height};return c}function pv(r,e,t,i,u,c){var p=r,g=e;switch(c){case"left":p=r-i-t,g=e-u/2;break;case"right":p=r+t,g=e-u/2;break;case"top":p=r-i/2,g=e-u-t;break;case"bottom":p=r-i/2,g=e+t;break;default:p=r+t,g=e-u-t;break}return{x:p,y:g}}function Md(r,e,t,i,u,c,p){var g=pv(r,e,t,i,u,c);if(p){var _=Td(g.x,g.y,i,u,p);c==="auto"?(_.right&&(g.x=Math.max(0,r-i-t)),_.top&&(g.y=Math.max(0,e-u-t))):c==="top"||c==="bottom"?(_.left&&(g.x=p.x),_.right&&(g.x=p.x+p.width-i),c==="top"&&_.top&&(g.y=e+t),c==="bottom"&&_.bottom&&(g.y=e-u-t)):(_.top&&(g.y=p.y),_.bottom&&(g.y=p.y+p.height-u),c==="left"&&_.left&&(g.x=r+t),c==="right"&&_.right&&(g.x=r-i-t))}return g}function Kf(r,e){var t=!1;return(0,b.S6)(e,function(i){if((0,b.wH)(r,i))return t=!0,!1}),t}var up=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"tooltip",type:"html",x:0,y:0,items:[],customContent:null,containerTpl:'<div class="'+ef+'"><div class="'+Cl+'"></div><ul class="'+Pc+'"></ul></div>',itemTpl:'<li class="'+Vp+`" data-index={index}>
          <span class="`+Sh+`" style="background:{color}"></span>
          <span class="`+Ns+`">{name}</span>:
          <span class="`+fv+`">{value}</span>
        </li>`,xCrosshairTpl:'<div class="'+qf+'"></div>',yCrosshairTpl:'<div class="'+Ad+'"></div>',title:null,showTitle:!0,region:null,crosshairsRegion:null,containerClassName:ef,crosshairs:null,offset:10,position:"right",domStyles:null,defaultStyles:hv})},e.prototype.render=function(){this.get("customContent")?this.renderCustomContent():(this.resetTitle(),this.renderItems()),this.resetPosition()},e.prototype.clear=function(){this.clearCrosshairs(),this.setTitle(""),this.clearItemDoms()},e.prototype.show=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!0),(0,W.Z)(t,{visibility:"visible"}),this.setCrossHairsVisible(!0))},e.prototype.hide=function(){var t=this.getContainer();!t||this.destroyed||(this.set("visible",!1),(0,W.Z)(t,{visibility:"hidden"}),this.setCrossHairsVisible(!1))},e.prototype.getLocation=function(){return{x:this.get("x"),y:this.get("y")}},e.prototype.setLocation=function(t){this.set("x",t.x),this.set("y",t.y),this.resetPosition()},e.prototype.setCrossHairsVisible=function(t){var i=t?"":"none",u=this.get("xCrosshairDom"),c=this.get("yCrosshairDom");u&&(0,W.Z)(u,{display:i}),c&&(0,W.Z)(c,{display:i})},e.prototype.initContainer=function(){if(r.prototype.initContainer.call(this),this.get("customContent")){this.get("container")&&this.get("container").remove();var t=this.getHtmlContentNode();this.get("parent").appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()}},e.prototype.updateInner=function(t){this.get("customContent")?this.renderCustomContent():(Kf(t,["title","showTitle"])&&this.resetTitle(),(0,b.wH)(t,"items")&&this.renderItems()),r.prototype.updateInner.call(this,t)},e.prototype.initDom=function(){this.cacheDoms()},e.prototype.removeDom=function(){r.prototype.removeDom.call(this),this.clearCrosshairs()},e.prototype.resetPosition=function(){var t=this.get("x"),i=this.get("y"),u=this.get("offset"),c=this.getOffset(),p=c.offsetX,g=c.offsetY,_=this.get("position"),S=this.get("region"),k=this.getContainer(),L=this.getBBox(),R=L.width,U=L.height,G;S&&(G=sl(S));var Q=Md(t,i,u,R,U,_,G);(0,W.Z)(k,{left:Ms(Q.x+p),top:Ms(Q.y+g)}),this.resetCrosshairs()},e.prototype.renderCustomContent=function(){var t=this.getHtmlContentNode(),i=this.get("parent"),u=this.get("container");u&&u.parentNode===i?i.replaceChild(t,u):i.appendChild(t),this.set("container",t),this.resetStyles(),this.applyStyles()},e.prototype.getHtmlContentNode=function(){var t,i=this.get("customContent");if(i){var u=i(this.get("title"),this.get("items"));(0,b.kK)(u)?t=u:t=(0,vt.Z)(u)}return t},e.prototype.cacheDoms=function(){var t=this.getContainer(),i=t.getElementsByClassName(Cl)[0],u=t.getElementsByClassName(Pc)[0];this.set("titleDom",i),this.set("listDom",u)},e.prototype.resetTitle=function(){var t=this.get("title"),i=this.get("showTitle");i&&t?this.setTitle(t):this.setTitle("")},e.prototype.setTitle=function(t){var i=this.get("titleDom");i&&(i.innerText=t)},e.prototype.resetCrosshairs=function(){var t=this.get("crosshairsRegion"),i=this.get("crosshairs");if(!t||!i)this.clearCrosshairs();else{var u=sl(t),c=this.get("xCrosshairDom"),p=this.get("yCrosshairDom");i==="x"?(this.resetCrosshair("x",u),p&&(p.remove(),this.set("yCrosshairDom",null))):i==="y"?(this.resetCrosshair("y",u),c&&(c.remove(),this.set("xCrosshairDom",null))):(this.resetCrosshair("x",u),this.resetCrosshair("y",u)),this.setCrossHairsVisible(this.get("visible"))}},e.prototype.resetCrosshair=function(t,i){var u=this.checkCrosshair(t),c=this.get(t);t==="x"?(0,W.Z)(u,{left:Ms(c),top:Ms(i.y),height:Ms(i.height)}):(0,W.Z)(u,{top:Ms(c),left:Ms(i.x),width:Ms(i.width)})},e.prototype.checkCrosshair=function(t){var i=t+"CrosshairDom",u=t+"CrosshairTpl",c="CROSSHAIR_"+t.toUpperCase(),p=ct[c],g=this.get(i),_=this.get("parent");return g||(g=(0,vt.Z)(this.get(u)),this.applyStyle(p,g),_.appendChild(g),this.set(i,g)),g},e.prototype.renderItems=function(){this.clearItemDoms();var t=this.get("items"),i=this.get("itemTpl"),u=this.get("listDom");u&&((0,b.S6)(t,function(c){var p=Ya.toCSSGradient(c.color),g=(0,P.pi)((0,P.pi)({},c),{color:p}),_=(0,b.ng)(i,g),S=(0,vt.Z)(_);u.appendChild(S)}),this.applyChildrenStyles(u,this.get("domStyles")))},e.prototype.clearItemDoms=function(){this.get("listDom")&&Af(this.get("listDom"))},e.prototype.clearCrosshairs=function(){var t=this.get("xCrosshairDom"),i=this.get("yCrosshairDom");t&&t.remove(),i&&i.remove(),this.set("xCrosshairDom",null),this.set("yCrosshairDom",null)},e}(Qa),Id=up,Gp={opacity:0},Qf={stroke:"#C5C5C5",strokeOpacity:.85},dv={fill:"#CACED4",opacity:.85},rf=ot(39499);function vv(r){return(0,b.UI)(r,function(e,t){var i=t===0?"M":"L",u=e[0],c=e[1];return[i,u,c]})}function nf(r){return vv(r)}function Hp(r){if(r.length<=2)return nf(r);var e=[];(0,b.S6)(r,function(p){(0,b.Xy)(p,e.slice(e.length-2))||e.push(p[0],p[1])});var t=(0,rf.e9)(e,!1),i=(0,b.YM)(r),u=i[0],c=i[1];return t.unshift(["M",u,c]),t}function Ul(r,e,t,i){i===void 0&&(i=!0);var u=new _i({values:r}),c=new Hs({values:(0,b.UI)(r,function(g,_){return _})}),p=(0,b.UI)(r,function(g,_){return[c.scale(_)*e,t-u.scale(g)*t]});return i?Hp(p):nf(p)}function kd(r,e){var t=new _i({values:r}),i=t.max<0?t.max:Math.max(0,t.min);return e-t.scale(i)*e}function Ld(r,e,t,i){var u=(0,P.pr)(r),c=kd(i,t);return u.push(["L",e,c]),u.push(["L",0,c]),u.push(["Z"]),u}var Pd=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"trend",x:0,y:0,width:200,height:16,smooth:!0,isArea:!1,data:[],backgroundStyle:Gp,lineStyle:Qf,areaStyle:dv})},e.prototype.renderInner=function(t){var i=this.cfg,u=i.width,c=i.height,p=i.data,g=i.smooth,_=i.isArea,S=i.backgroundStyle,k=i.lineStyle,L=i.areaStyle;this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:(0,P.pi)({x:0,y:0,width:u,height:c},S)});var R=Ul(p,u,c,g);if(this.addShape(t,{id:this.getElementId("line"),type:"path",attrs:(0,P.pi)({path:R},k)}),_){var U=Ld(R,u,c,p);this.addShape(t,{id:this.getElementId("area"),type:"path",attrs:(0,P.pi)({path:U},L)})}},e.prototype.applyOffset=function(){var t=this.cfg,i=t.x,u=t.y;this.moveElementTo(this.get("group"),{x:i,y:u})},e}(Rs),jp=null,af={fill:"#F7F7F7",stroke:"#BFBFBF",radius:2,opacity:1,cursor:"ew-resize",highLightFill:"#FFF"},ec=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"handler",x:0,y:0,width:10,height:24,style:af})},e.prototype.renderInner=function(t){var i=this.cfg,u=i.width,c=i.height,p=i.style,g=p.fill,_=p.stroke,S=p.radius,k=p.opacity,L=p.cursor;this.addShape(t,{type:"rect",id:this.getElementId("background"),attrs:{x:0,y:0,width:u,height:c,fill:g,stroke:_,radius:S,opacity:k,cursor:L}});var R=1/3*u,U=2/3*u,G=1/4*c,Q=3/4*c;this.addShape(t,{id:this.getElementId("line-left"),type:"line",attrs:{x1:R,y1:G,x2:R,y2:Q,stroke:_,cursor:L}}),this.addShape(t,{id:this.getElementId("line-right"),type:"line",attrs:{x1:U,y1:G,x2:U,y2:Q,stroke:_,cursor:L}})},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.bindEvents=function(){var t=this;this.get("group").on("mouseenter",function(){var i=t.get("style").highLightFill;t.getElementByLocalId("background").attr("fill",i),t.draw()}),this.get("group").on("mouseleave",function(){var i=t.get("style").fill;t.getElementByLocalId("background").attr("fill",i),t.draw()})},e.prototype.draw=function(){var t=this.get("container").get("canvas");t&&t.draw()},e}(Rs),Wp=null,H0={fill:"#416180",opacity:.05},Qv={fill:"#5B8FF9",opacity:.15,cursor:"move"},If=10,mc={width:If,height:24},j0={textBaseline:"middle",fill:"#000",opacity:.45},rc="sliderchange",Od=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.onMouseDown=function(i){return function(u){t.currentTarget=i;var c=u.originalEvent;c.stopPropagation(),c.preventDefault(),t.prevX=(0,b.U2)(c,"touches.0.pageX",c.pageX),t.prevY=(0,b.U2)(c,"touches.0.pageY",c.pageY);var p=t.getContainerDOM();p.addEventListener("mousemove",t.onMouseMove),p.addEventListener("mouseup",t.onMouseUp),p.addEventListener("mouseleave",t.onMouseUp),p.addEventListener("touchmove",t.onMouseMove),p.addEventListener("touchend",t.onMouseUp),p.addEventListener("touchcancel",t.onMouseUp)}},t.onMouseMove=function(i){var u=t.cfg.width,c=[t.get("start"),t.get("end")];i.stopPropagation(),i.preventDefault();var p=(0,b.U2)(i,"touches.0.pageX",i.pageX),g=(0,b.U2)(i,"touches.0.pageY",i.pageY),_=p-t.prevX,S=t.adjustOffsetRange(_/u);t.updateStartEnd(S),t.updateUI(t.getElementByLocalId("foreground"),t.getElementByLocalId("minText"),t.getElementByLocalId("maxText")),t.prevX=p,t.prevY=g,t.draw(),t.emit(rc,[t.get("start"),t.get("end")].sort()),t.delegateEmit("valuechanged",{originValue:c,value:[t.get("start"),t.get("end")]})},t.onMouseUp=function(){t.currentTarget&&(t.currentTarget=void 0);var i=t.getContainerDOM();i&&(i.removeEventListener("mousemove",t.onMouseMove),i.removeEventListener("mouseup",t.onMouseUp),i.removeEventListener("mouseleave",t.onMouseUp),i.removeEventListener("touchmove",t.onMouseMove),i.removeEventListener("touchend",t.onMouseUp),i.removeEventListener("touchcancel",t.onMouseUp))},t}return e.prototype.setRange=function(t,i){this.set("minLimit",t),this.set("maxLimit",i);var u=this.get("start"),c=this.get("end"),p=(0,b.uZ)(u,t,i),g=(0,b.uZ)(c,t,i);!this.get("isInit")&&(u!==p||c!==g)&&this.setValue([p,g])},e.prototype.getRange=function(){return{min:this.get("minLimit")||0,max:this.get("maxLimit")||1}},e.prototype.setValue=function(t){var i=this.getRange();if((0,b.kJ)(t)&&t.length===2){var u=[this.get("start"),this.get("end")];this.update({start:(0,b.uZ)(t[0],i.min,i.max),end:(0,b.uZ)(t[1],i.min,i.max)}),this.get("updateAutoRender")||this.render(),this.delegateEmit("valuechanged",{originValue:u,value:t})}},e.prototype.getValue=function(){return[this.get("start"),this.get("end")]},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"slider",x:0,y:0,width:100,height:16,backgroundStyle:{},foregroundStyle:{},handlerStyle:{},textStyle:{},defaultCfg:{backgroundStyle:H0,foregroundStyle:Qv,handlerStyle:mc,textStyle:j0}})},e.prototype.update=function(t){var i=t.start,u=t.end,c=(0,P.pi)({},t);(0,b.UM)(i)||(c.start=(0,b.uZ)(i,0,1)),(0,b.UM)(u)||(c.end=(0,b.uZ)(u,0,1)),r.prototype.update.call(this,c),this.minHandler=this.getChildComponentById(this.getElementId("minHandler")),this.maxHandler=this.getChildComponentById(this.getElementId("maxHandler")),this.trend=this.getChildComponentById(this.getElementId("trend"))},e.prototype.init=function(){this.set("start",(0,b.uZ)(this.get("start"),0,1)),this.set("end",(0,b.uZ)(this.get("end"),0,1)),r.prototype.init.call(this)},e.prototype.render=function(){r.prototype.render.call(this),this.updateUI(this.getElementByLocalId("foreground"),this.getElementByLocalId("minText"),this.getElementByLocalId("maxText"))},e.prototype.renderInner=function(t){var i=this.cfg,u=i.start,c=i.end,p=i.width,g=i.height,_=i.trendCfg,S=_===void 0?{}:_,k=i.minText,L=i.maxText,R=i.backgroundStyle,U=R===void 0?{}:R,G=i.foregroundStyle,Q=G===void 0?{}:G,pt=i.textStyle,yt=pt===void 0?{}:pt,Ht=(0,b.b$)({},af,this.cfg.handlerStyle),ce=u*p,he=c*p;(0,b.dp)((0,b.U2)(S,"data"))&&(this.trend=this.addComponent(t,(0,P.pi)({component:Pd,id:this.getElementId("trend"),x:0,y:0,width:p,height:g},S))),this.addShape(t,{id:this.getElementId("background"),type:"rect",attrs:(0,P.pi)({x:0,y:0,width:p,height:g},U)});var ze=this.addShape(t,{id:this.getElementId("minText"),type:"text",attrs:(0,P.pi)({y:g/2,textAlign:"right",text:k,silent:!1},yt)}),Er=this.addShape(t,{id:this.getElementId("maxText"),type:"text",attrs:(0,P.pi)({y:g/2,textAlign:"left",text:L,silent:!1},yt)}),Fr=this.addShape(t,{id:this.getElementId("foreground"),name:"foreground",type:"rect",attrs:(0,P.pi)({y:0,height:g},Q)}),zr=(0,b.U2)(Ht,"width",If),pn=(0,b.U2)(Ht,"height",24);this.minHandler=this.addComponent(t,{component:ec,id:this.getElementId("minHandler"),name:"handler-min",x:0,y:(g-pn)/2,width:zr,height:pn,cursor:"ew-resize",style:Ht}),this.maxHandler=this.addComponent(t,{component:ec,id:this.getElementId("maxHandler"),name:"handler-max",x:0,y:(g-pn)/2,width:zr,height:pn,cursor:"ew-resize",style:Ht})},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.updateUI=function(t,i,u){var c=this.cfg,p=c.start,g=c.end,_=c.width,S=c.minText,k=c.maxText,L=c.handlerStyle,R=c.height,U=p*_,G=g*_;this.trend&&(this.trend.update({width:_,height:R}),this.get("updateAutoRender")||this.trend.render()),t.attr("x",U),t.attr("width",G-U);var Q=(0,b.U2)(L,"width",If);i.attr("text",S),u.attr("text",k);var pt=this._dodgeText([U,G],i,u),yt=pt[0],Ht=pt[1];this.minHandler&&(this.minHandler.update({x:U-Q/2}),this.get("updateAutoRender")||this.minHandler.render()),(0,b.S6)(yt,function(ce,he){return i.attr(he,ce)}),this.maxHandler&&(this.maxHandler.update({x:G-Q/2}),this.get("updateAutoRender")||this.maxHandler.render()),(0,b.S6)(Ht,function(ce,he){return u.attr(he,ce)})},e.prototype.bindEvents=function(){var t=this.get("group");t.on("handler-min:mousedown",this.onMouseDown("minHandler")),t.on("handler-min:touchstart",this.onMouseDown("minHandler")),t.on("handler-max:mousedown",this.onMouseDown("maxHandler")),t.on("handler-max:touchstart",this.onMouseDown("maxHandler"));var i=t.findById(this.getElementId("foreground"));i.on("mousedown",this.onMouseDown("foreground")),i.on("touchstart",this.onMouseDown("foreground"))},e.prototype.adjustOffsetRange=function(t){var i=this.cfg,u=i.start,c=i.end;switch(this.currentTarget){case"minHandler":{var p=0-u,g=1-u;return Math.min(g,Math.max(p,t))}case"maxHandler":{var p=0-c,g=1-c;return Math.min(g,Math.max(p,t))}case"foreground":{var p=0-u,g=1-c;return Math.min(g,Math.max(p,t))}}},e.prototype.updateStartEnd=function(t){var i=this.cfg,u=i.start,c=i.end;switch(this.currentTarget){case"minHandler":u+=t;break;case"maxHandler":c+=t;break;case"foreground":u+=t,c+=t;break}this.set("start",u),this.set("end",c)},e.prototype._dodgeText=function(t,i,u){var c,p,g=this.cfg,_=g.handlerStyle,S=g.width,k=2,L=(0,b.U2)(_,"width",If),R=t[0],U=t[1],G=!1;R>U&&(c=[U,R],R=c[0],U=c[1],p=[u,i],i=p[0],u=p[1],G=!0);var Q=i.getBBox(),pt=u.getBBox(),yt=Q.width>R-k?{x:R+L/2+k,textAlign:"left"}:{x:R-L/2-k,textAlign:"right"},Ht=pt.width>S-U-k?{x:U-L/2-k,textAlign:"right"}:{x:U+L/2+k,textAlign:"left"};return G?[Ht,yt]:[yt,Ht]},e.prototype.draw=function(){var t=this.get("container"),i=t&&t.get("canvas");i&&i.draw()},e.prototype.getContainerDOM=function(){var t=this.get("container"),i=t&&t.get("canvas");return i&&i.get("container")},e}(Rs),Jv=null;function of(r,e,t){if(r){if(typeof r.addEventListener=="function")return r.addEventListener(e,t,!1),{remove:function(){r.removeEventListener(e,t,!1)}};if(typeof r.attachEvent=="function")return r.attachEvent("on"+e,t),{remove:function(){r.detachEvent("on"+e,t)}}}}var sf={trackColor:"rgba(0,0,0,0)",thumbColor:"rgba(0,0,0,0.15)",size:8,lineCap:"round"},Fd={default:sf,hover:{thumbColor:"rgba(0,0,0,0.2)"}},t0=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.clearEvents=b.ZT,t.onStartEvent=function(i){return function(u){t.isMobile=i,u.originalEvent.preventDefault();var c=i?(0,b.U2)(u.originalEvent,"touches.0.clientX"):u.clientX,p=i?(0,b.U2)(u.originalEvent,"touches.0.clientY"):u.clientY;t.startPos=t.cfg.isHorizontal?c:p,t.bindLaterEvent()}},t.bindLaterEvent=function(){var i=t.getContainerDOM(),u=[];t.isMobile?u=[of(i,"touchmove",t.onMouseMove),of(i,"touchend",t.onMouseUp),of(i,"touchcancel",t.onMouseUp)]:u=[of(i,"mousemove",t.onMouseMove),of(i,"mouseup",t.onMouseUp),of(i,"mouseleave",t.onMouseUp)],t.clearEvents=function(){u.forEach(function(c){c.remove()})}},t.onMouseMove=function(i){var u=t.cfg,c=u.isHorizontal,p=u.thumbOffset;i.preventDefault();var g=t.isMobile?(0,b.U2)(i,"touches.0.clientX"):i.clientX,_=t.isMobile?(0,b.U2)(i,"touches.0.clientY"):i.clientY,S=c?g:_,k=S-t.startPos;t.startPos=S,t.updateThumbOffset(p+k)},t.onMouseUp=function(i){i.preventDefault(),t.clearEvents()},t.onTrackClick=function(i){var u=t.cfg,c=u.isHorizontal,p=u.x,g=u.y,_=u.thumbLen,S=t.getContainerDOM(),k=S.getBoundingClientRect(),L=i.clientX,R=i.clientY,U=c?L-k.left-p-_/2:R-k.top-g-_/2,G=t.validateRange(U);t.updateThumbOffset(G)},t.onThumbMouseOver=function(){var i=t.cfg.theme.hover.thumbColor;t.getElementByLocalId("thumb").attr("stroke",i),t.draw()},t.onThumbMouseOut=function(){var i=t.cfg.theme.default.thumbColor;t.getElementByLocalId("thumb").attr("stroke",i),t.draw()},t}return e.prototype.setRange=function(t,i){this.set("minLimit",t),this.set("maxLimit",i);var u=this.getValue(),c=(0,b.uZ)(u,t,i);u!==c&&!this.get("isInit")&&this.setValue(c)},e.prototype.getRange=function(){var t=this.get("minLimit")||0,i=this.get("maxLimit")||1;return{min:t,max:i}},e.prototype.setValue=function(t){var i=this.getRange(),u=this.getValue();this.update({thumbOffset:(this.get("trackLen")-this.get("thumbLen"))*(0,b.uZ)(t,i.min,i.max)}),this.delegateEmit("valuechange",{originalValue:u,value:this.getValue()})},e.prototype.getValue=function(){return(0,b.uZ)(this.get("thumbOffset")/(this.get("trackLen")-this.get("thumbLen")),0,1)},e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return(0,P.pi)((0,P.pi)({},t),{name:"scrollbar",isHorizontal:!0,minThumbLen:20,thumbOffset:0,theme:Fd})},e.prototype.renderInner=function(t){this.renderTrackShape(t),this.renderThumbShape(t)},e.prototype.applyOffset=function(){this.moveElementTo(this.get("group"),{x:this.get("x"),y:this.get("y")})},e.prototype.initEvent=function(){this.bindEvents()},e.prototype.renderTrackShape=function(t){var i=this.cfg,u=i.trackLen,c=i.theme,p=c===void 0?{default:{}}:c,g=(0,b.b$)({},Fd,p).default,_=g.lineCap,S=g.trackColor,k=g.size,L=(0,b.U2)(this.cfg,"size",k),R=this.get("isHorizontal")?{x1:0+L/2,y1:L/2,x2:u-L/2,y2:L/2,lineWidth:L,stroke:S,lineCap:_}:{x1:L/2,y1:0+L/2,x2:L/2,y2:u-L/2,lineWidth:L,stroke:S,lineCap:_};return this.addShape(t,{id:this.getElementId("track"),name:"track",type:"line",attrs:R})},e.prototype.renderThumbShape=function(t){var i=this.cfg,u=i.thumbOffset,c=i.thumbLen,p=i.theme,g=(0,b.b$)({},Fd,p).default,_=g.size,S=g.lineCap,k=g.thumbColor,L=(0,b.U2)(this.cfg,"size",_),R=this.get("isHorizontal")?{x1:u+L/2,y1:L/2,x2:u+c-L/2,y2:L/2,lineWidth:L,stroke:k,lineCap:S,cursor:"default"}:{x1:L/2,y1:u+L/2,x2:L/2,y2:u+c-L/2,lineWidth:L,stroke:k,lineCap:S,cursor:"default"};return this.addShape(t,{id:this.getElementId("thumb"),name:"thumb",type:"line",attrs:R})},e.prototype.bindEvents=function(){var t=this.get("group");t.on("mousedown",this.onStartEvent(!1)),t.on("mouseup",this.onMouseUp),t.on("touchstart",this.onStartEvent(!0)),t.on("touchend",this.onMouseUp);var i=t.findById(this.getElementId("track"));i.on("click",this.onTrackClick);var u=t.findById(this.getElementId("thumb"));u.on("mouseover",this.onThumbMouseOver),u.on("mouseout",this.onThumbMouseOut)},e.prototype.getContainerDOM=function(){var t=this.get("container"),i=t&&t.get("canvas");return i&&i.get("container")},e.prototype.validateRange=function(t){var i=this.cfg,u=i.thumbLen,c=i.trackLen,p=t;return t+u>c?p=c-u:t+u<u&&(p=0),p},e.prototype.draw=function(){var t=this.get("container"),i=t&&t.get("canvas");i&&i.draw()},e.prototype.updateThumbOffset=function(t){var i=this.cfg,u=i.thumbOffset,c=i.isHorizontal,p=i.thumbLen,g=i.size,_=this.validateRange(t);if(_!==u){var S=this.getElementByLocalId("thumb");c?S.attr({x1:_+g/2,x2:_+p-g/2}):S.attr({y1:_+g/2,y2:_+p-g/2}),this.emitOffsetChange(_)}},e.prototype.emitOffsetChange=function(t){var i=this.cfg,u=i.thumbOffset,c=i.trackLen,p=i.thumbLen;this.cfg.thumbOffset=t,this.emit("scrollchange",{thumbOffset:t,ratio:(0,b.uZ)(t/(c-p),0,1)}),this.delegateEmit("valuechange",{originalValue:u,value:t})},e}(Rs),nc=Jl,Rd=$c,Ch=lv,Ah=Sd,e0=Cd,r0=Zp,lp=Id;function Dd(r){if((0,b.xb)(r))return null;var e=r[0].x,t=r[0].x,i=r[0].y,u=r[0].y;return(0,b.S6)(r,function(c){e=e>c.x?c.x:e,t=t<c.x?c.x:t,i=i>c.y?c.y:i,u=u<c.y?c.y:u}),{minX:e,maxX:t,minY:i,maxY:u,centerX:(e+t)/2,centerY:(i+u)/2}}function Ro(r){return Array.from(new Set(r)).length===1}function kf(r){return((0,b.VV)(r)+(0,b.Fp)(r))/2}function co(r,e,t,i){return{x:r+t*Math.cos(i),y:e+t*Math.sin(i)}}function gu(r,e,t,i,u,c){c===void 0&&(c=0);var p=co(r,e,t,i),g=co(r,e,t,u),_=co(r,e,c,i),S=co(r,e,c,u);if(u-i===Math.PI*2){var k=co(r,e,t,i+Math.PI),L=co(r,e,c,i+Math.PI),R=[["M",p.x,p.y],["A",t,t,0,1,1,k.x,k.y],["A",t,t,0,1,1,g.x,g.y],["M",_.x,_.y]];return c&&(R.push(["A",c,c,0,1,0,L.x,L.y]),R.push(["A",c,c,0,1,0,S.x,S.y])),R.push(["M",p.x,p.y]),R.push(["Z"]),R}var U=u-i<=Math.PI?0:1,G=[["M",p.x,p.y],["A",t,t,0,U,1,g.x,g.y],["L",S.x,S.y]];return c&&G.push(["A",c,c,0,U,0,_.x,_.y]),G.push(["L",p.x,p.y]),G.push(["Z"]),G}function W0(r,e,t,i,u){var c=co(r,e,t,i),p=co(r,e,t,u);if((0,b.vQ)(u-i,Math.PI*2)){var g=co(r,e,t,i+Math.PI);return[["M",c.x,c.y],["A",t,t,0,1,1,g.x,g.y],["A",t,t,0,1,1,c.x,c.y],["A",t,t,0,1,0,g.x,g.y],["A",t,t,0,1,0,c.x,c.y],["Z"]]}var _=u-i<=Math.PI?0:1;return[["M",c.x,c.y],["A",t,t,0,_,1,p.x,p.y]]}function Xp(r,e){var t=r.points,i=Dd(t),u,c,p=e.startAngle,g=e.endAngle,_=g-p;return e.isTransposed?(u=i.maxY*_,c=i.minY*_):(u=i.maxX*_,c=i.minX*_),u+=p,c+=p,{startAngle:c,endAngle:u}}function Bd(r,e){if((0,b.hj)(r)&&(0,b.hj)(e))return[r,e];if(r=r,e=e,Ro(r)||Ro(e))return[kf(r),kf(e)];for(var t=-1,i=0,u=0,c,p=r.length-1,g,_=0;++t<r.length;)c=p,p=t,_+=g=r[c]*e[p]-r[p]*e[c],i+=(r[c]+r[p])*g,u+=(e[c]+e[p])*g;return _*=3,[i/_,u/_]}function X0(r,e){var t=r.attr(),i=e.attr();return(0,b.S6)(t,function(u,c){i[c]===void 0&&(i[c]=void 0)}),i}function Yp(r,e,t){var i=Math.min(e,t),u=Math.max(e,t);return r>=i&&r<=u}function n0(r,e,t){if((0,b.HD)(r))return r.padEnd(e,t);if((0,b.kJ)(r)){var i=r.length;if(i<e)for(var u=e-i,c=0;c<u;c++)r.push(t)}return r}function ic(r,e){return typeof r=="object"&&e.forEach(function(t){delete r[t]}),r}function Th(r,e,t){var i,u;e===void 0&&(e=[]),t===void 0&&(t=new Map);try{for(var c=(0,P.XA)(r),p=c.next();!p.done;p=c.next()){var g=p.value;t.has(g)||(e.push(g),t.set(g,!0))}}catch(_){i={error:_}}finally{try{p&&!p.done&&(u=c.return)&&u.call(c)}finally{if(i)throw i.error}}return e}var Nu=function(){function r(e,t,i,u){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),u===void 0&&(u=0),this.x=e,this.y=t,this.height=u,this.width=i}return r.fromRange=function(e,t,i,u){return new r(e,t,i-e,u-t)},r.fromObject=function(e){return new r(e.minX,e.minY,e.width,e.height)},Object.defineProperty(r.prototype,"minX",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxX",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minY",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxY",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tl",{get:function(){return{x:this.x,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tr",{get:function(){return{x:this.maxX,y:this.y}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bl",{get:function(){return{x:this.x,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"br",{get:function(){return{x:this.maxX,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return{x:this.x+this.width/2,y:this.minY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return{x:this.maxX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return{x:this.x+this.width/2,y:this.maxY}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"left",{get:function(){return{x:this.minX,y:this.y+this.height/2}},enumerable:!1,configurable:!0}),r.prototype.isEqual=function(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},r.prototype.contains=function(e){return e.minX>=this.minX&&e.maxX<=this.maxX&&e.minY>=this.minY&&e.maxY<=this.maxY},r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.add=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.clone();return(0,b.S6)(e,function(u){i.x=Math.min(u.x,i.x),i.y=Math.min(u.y,i.y),i.width=Math.max(u.maxX,i.maxX)-i.x,i.height=Math.max(u.maxY,i.maxY)-i.y}),i},r.prototype.merge=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this.clone();return(0,b.S6)(e,function(u){i.x=Math.max(u.x,i.x),i.y=Math.max(u.y,i.y),i.width=Math.min(u.maxX,i.maxX)-i.x,i.height=Math.min(u.maxY,i.maxY)-i.y}),i},r.prototype.cut=function(e,t){var i=e.width,u=e.height;switch(t){case le.TOP:case le.TOP_LEFT:case le.TOP_RIGHT:return r.fromRange(this.minX,this.minY+u,this.maxX,this.maxY);case le.RIGHT:case le.RIGHT_TOP:case le.RIGHT_BOTTOM:return r.fromRange(this.minX,this.minY,this.maxX-i,this.maxY);case le.BOTTOM:case le.BOTTOM_LEFT:case le.BOTTOM_RIGHT:return r.fromRange(this.minX,this.minY,this.maxX,this.maxY-u);case le.LEFT:case le.LEFT_TOP:case le.LEFT_BOTTOM:return r.fromRange(this.minX+i,this.minY,this.maxX,this.maxY);default:return this}},r.prototype.shrink=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return new r(this.x+p,this.y+i,this.width-p-u,this.height-i-c)},r.prototype.expand=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return new r(this.x-p,this.y-i,this.width+p+u,this.height+i+c)},r.prototype.exceed=function(e){return[Math.max(-this.minY+e.minY,0),Math.max(this.maxX-e.maxX,0),Math.max(this.maxY-e.maxY,0),Math.max(-this.minX+e.minX,0)]},r.prototype.collide=function(e){return this.minX<e.maxX&&this.maxX>e.minX&&this.minY<e.maxY&&this.maxY>e.minY},r.prototype.size=function(){return this.width*this.height},r.prototype.isPointIn=function(e){return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY},r}(),Ug=function(r,e){var t=e.start,i=e.end;return new Nu(r.x+r.width*t.x,r.y+r.height*t.y,r.width*Math.abs(i.x-t.x),r.height*Math.abs(i.y-t.y))};function Jf(r){return[[r.minX,r.minY],[r.maxX,r.minY],[r.maxX,r.maxY],[r.minX,r.maxY]]}function th(r){if(r.isPolar&&!r.isTransposed)return(r.endAngle-r.startAngle)*r.getRadius();var e=r.convert({x:0,y:0}),t=r.convert({x:1,y:0});return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Qo(r){if(r.isPolar){var e=r.startAngle,t=r.endAngle;return t-e===Math.PI*2}return!1}function $p(r,e){var t=r.getCenter();return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function eh(r,e){var t=!1;if(r)if(r.type==="theta"){var i=r.start,u=r.end;t=Yp(e.x,i.x,u.x)&&Yp(e.y,i.y,u.y)}else{var c=r.invert(e);t=Yp(c.x,0,1)&&Yp(c.y,0,1)}return t}function uf(r,e){var t=r.getCenter();return Math.atan2(e.y-t.y,e.x-t.x)}function qp(r,e){e===void 0&&(e=0);var t=r.start,i=r.end,u=r.getWidth(),c=r.getHeight();if(r.isPolar){var p=r.startAngle,g=r.endAngle,_=r.getCenter(),S=r.getRadius();return{type:"path",startState:{path:gu(_.x,_.y,S+e,p,p)},endState:function(L){var R=(g-p)*L+p,U=gu(_.x,_.y,S+e,p,R);return{path:U}},attrs:{path:gu(_.x,_.y,S+e,p,g)}}}var k;return r.isTransposed?k={height:c+e*2}:k={width:u+e*2},{type:"rect",startState:{x:t.x-e,y:i.y-e,width:r.isTransposed?u+e*2:0,height:r.isTransposed?0:c+e*2},endState:k,attrs:{x:t.x-e,y:i.y-e,width:u+e*2,height:c+e*2}}}function Hm(r,e){e===void 0&&(e=0);var t=r.start,i=r.end,u=r.getWidth(),c=r.getHeight(),p=Math.min(t.x,i.x),g=Math.min(t.y,i.y);return Nu.fromRange(p-e,g-e,p+u+e,g+c+e)}var kt=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]+)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/;function Ze(r){var e="linear";return kt.test(r)?e="timeCat":(0,b.HD)(r)&&(e="cat"),e}function dr(r,e,t,i){return e===void 0&&(e={}),e.type?e.type:r.type!=="identity"&&be.includes(t)&&["interval"].includes(i)||r.isCategory?"cat":r.type}function cn(r,e,t){var i=e||[];if((0,b.hj)(r)||(0,b.UM)((0,b.Wx)(i,r))&&(0,b.xb)(t)){var u=lc("identity");return new u({field:r.toString(),values:[r]})}var c=(0,b.I)(i,r),p=(0,b.U2)(t,"type",Ze(c[0])),g=lc(p);return new g((0,P.pi)({field:r,values:c},t))}function On(r,e){if(r.type!=="identity"&&e.type!=="identity"){var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);r.change(t)}}function on(r){return r.alias||r.field}function En(r,e,t){var i=r.values,u=i.length,c;if(u===1)c=[.5,1];else{var p=1,g=0;Qo(e)?e.isTransposed?(p=(0,b.U2)(t,"widthRatio.multiplePie",1/1.3),g=1/u*p,c=[g/2,1-g/2]):c=[0,1-1/u]:(g=1/u/2,c=[g,1-g])}return c}function Dn(r){var e=r.values.filter(function(t){return!(0,b.UM)(t)&&!isNaN(t)});return Math.max.apply(Math,(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),[(0,b.UM)(r.max)?-1/0:r.max],!1))}function Hn(r){var e,t;switch(r){case le.TOP:e={x:0,y:1},t={x:1,y:1};break;case le.RIGHT:e={x:1,y:0},t={x:1,y:1};break;case le.BOTTOM:e={x:0,y:0},t={x:1,y:0};break;case le.LEFT:e={x:0,y:0},t={x:0,y:1};break;default:e=t={x:0,y:0}}return{start:e,end:t}}function Jn(r){var e,t;return r.isTransposed?(e={x:0,y:0},t={x:1,y:0}):(e={x:0,y:0},t={x:0,y:1}),{start:e,end:t}}function ii(r,e){var t={start:{x:0,y:0},end:{x:0,y:0}};r.isRect?t=Hn(e):r.isPolar&&(t=Jn(r));var i=t.start,u=t.end;return{start:r.convert(i),end:r.convert(u)}}function ui(r,e){if(r.isRect)return r.isTransposed?[DIRECTION.RIGHT,DIRECTION.BOTTOM].includes(e)?1:-1:[DIRECTION.BOTTOM,DIRECTION.RIGHT].includes(e)?-1:1;if(r.isPolar){var t=r.x.start;return t<0?-1:1}return 1}function yi(r){var e=r.start,t=r.end;return e.x===t.x}function qn(r,e){var t=r.start,i=r.end,u=yi(r);return u?(t.y-i.y)*(e.x-t.x)>0?1:-1:(i.x-t.x)*(t.y-e.y)>0?-1:1}function ri(r,e){var t=(0,b.U2)(r,["components","axis"],{});return(0,b.b$)({},(0,b.U2)(t,["common"],{}),(0,b.b$)({},(0,b.U2)(t,[e],{})))}function Gr(r,e,t){var i=(0,b.U2)(r,["components","axis"],{});return(0,b.b$)({},(0,b.U2)(i,["common","title"],{}),(0,b.b$)({},(0,b.U2)(i,[e,"title"],{})),t)}function dn(r){var e=r.x,t=r.y,i=r.circleCenter,u=t.start>t.end,c=r.isTransposed?r.convert({x:u?0:1,y:0}):r.convert({x:0,y:u?0:1}),p=[c.x-i.x,c.y-i.y],g=[1,0],_=c.y>i.y?sa.EU(p,g):sa.EU(p,g)*-1,S=_+(e.end-e.start),k=Math.sqrt(Math.pow(c.x-i.x,2)+Math.pow(c.y-i.y,2));return{center:i,radius:k,startAngle:_,endAngle:S}}function Xn(r,e){return(0,b.jn)(r)?r===!1?!1:{}:(0,b.U2)(r,[e])}function vi(r,e){return(0,b.U2)(r,"position",e)}function Rn(r,e){return(0,b.U2)(e,["title","text"],on(r))}var Qn=function(){function r(e,t){this.destroyed=!1,this.facets=[],this.view=e,this.cfg=(0,b.b$)({},this.getDefaultCfg(),t)}return r.prototype.init=function(){this.container||(this.container=this.createContainer());var e=this.view.getData();this.facets=this.generateFacets(e)},r.prototype.render=function(){this.renderViews()},r.prototype.update=function(){},r.prototype.clear=function(){this.clearFacetViews()},r.prototype.destroy=function(){this.clear(),this.container&&(this.container.remove(!0),this.container=void 0),this.destroyed=!0,this.view=void 0,this.facets=[]},r.prototype.facetToView=function(e){var t=e.region,i=e.data,u=e.padding,c=u===void 0?this.cfg.padding:u,p=this.view.createView({region:t,padding:c});p.data(i||[]),e.view=p,this.beforeEachView(p,e);var g=this.cfg.eachView;return g&&g(p,e),this.afterEachView(p,e),p},r.prototype.createContainer=function(){var e=this.view.getLayer(X.FORE);return e.addGroup()},r.prototype.renderViews=function(){this.createFacetViews()},r.prototype.createFacetViews=function(){var e=this;return this.facets.map(function(t){return e.facetToView(t)})},r.prototype.clearFacetViews=function(){var e=this;(0,b.S6)(this.facets,function(t){t.view&&(e.view.removeView(t.view),t.view=void 0)})},r.prototype.parseSpacing=function(){var e=this.view.viewBBox,t=e.width,i=e.height,u=this.cfg.spacing;return u.map(function(c,p){return(0,b.hj)(c)?c/(p===0?t:i):parseFloat(c)/100})},r.prototype.getFieldValues=function(e,t){var i=[],u={};return(0,b.S6)(e,function(c){var p=c[t];!(0,b.UM)(p)&&!u[p]&&(i.push(p),u[p]=!0)}),i},r.prototype.getRegion=function(e,t,i,u){var c=(0,P.CR)(this.parseSpacing(),2),p=c[0],g=c[1],_=(1+p)/(t===0?1:t)-p,S=(1+g)/(e===0?1:e)-g,k={x:(_+p)*i,y:(S+g)*u},L={x:k.x+_,y:k.y+S};return{start:k,end:L}},r.prototype.getDefaultCfg=function(){return{eachView:void 0,showTitle:!0,spacing:[0,0],padding:10,fields:[]}},r.prototype.getDefaultTitleCfg=function(){var e=this.view.getTheme().fontFamily;return{style:{fontSize:14,fill:"#666",fontFamily:e}}},r.prototype.processAxis=function(e,t){var i=e.getOptions(),u=i.coordinate,c=e.geometries,p=(0,b.U2)(u,"type","rect");if(p==="rect"&&c.length){(0,b.UM)(i.axes)&&(i.axes={});var g=i.axes,_=(0,P.CR)(c[0].getXYFields(),2),S=_[0],k=_[1],L=Xn(g,S),R=Xn(g,k);L!==!1&&(i.axes[S]=this.getXAxisOption(S,g,L,t)),R!==!1&&(i.axes[k]=this.getYAxisOption(k,g,R,t))}},r.prototype.getFacetDataFilter=function(e){return function(t){return(0,b.yW)(e,function(i){var u=i.field,c=i.value;return!(0,b.UM)(c)&&u?t[u]===c:!0})}},r}(),Ti={},aa=function(r){return Ti[(0,b.vl)(r)]},_n=function(r,e){Ti[(0,b.vl)(r)]=e},An=function(){function r(e,t){this.context=e,this.cfg=t,e.addAction(this)}return r.prototype.applyCfg=function(e){(0,b.f0)(this,e)},r.prototype.init=function(){this.applyCfg(this.cfg)},r.prototype.destroy=function(){this.context.removeAction(this),this.context=null},r}(),oi=An,Ei=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.execute=function(){this.callback&&this.callback(this.context)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.callback=null},e}(oi),ti=Ei,xi={};function Mi(r,e){var t=xi[r],i=null;if(t){var u=t.ActionClass,c=t.cfg;i=new u(e,c),i.name=r,i.init()}return i}function Ua(r){var e=xi[r];return(0,b.U2)(e,"ActionClass")}function Yn(r,e,t){xi[r]={ActionClass:e,cfg:t}}function Ii(r){delete xi[r]}function Li(r,e){var t=new ti(e);return t.callback=r,t.name="callback",t}function wa(r,e){var t=[];if(r.length){t.push(["M",r[0].x,r[0].y]);for(var i=1,u=r.length;i<u;i+=1){var c=r[i];t.push(["L",c.x,c.y])}e&&t.push(["Z"])}return t}function Da(r,e){for(var t=[r[0]],i=1,u=r.length;i<u;i=i+2){var c=e.convert({x:r[i],y:r[i+1]});t.push(c.x,c.y)}return t}function oo(r,e){var t=e.isTransposed,i=r[1],u=r[6],c=r[7],p=e.convert({x:u,y:c}),g=t?0:1;return["A",i,i,0,0,g,p.x,p.y]}function Is(r,e,t){var i=t.isTransposed,u=t.startAngle,c=t.endAngle,p=r[0].toLowerCase()==="a"?{x:r[6],y:r[7]}:{x:r[1],y:r[2]},g={x:e[1],y:e[2]},_=[],S=i?"y":"x",k=Math.abs(g[S]-p[S])*(c-u),L=g[S]>=p[S]?1:0,R=k>Math.PI?1:0,U=t.convert(g),G=$p(t,U);if(G>=.5)if(k===Math.PI*2){var Q={x:(g.x+p.x)/2,y:(g.y+p.y)/2},pt=t.convert(Q);_.push(["A",G,G,0,R,L,pt.x,pt.y]),_.push(["A",G,G,0,R,L,U.x,U.y])}else _.push(["A",G,G,0,R,L,U.x,U.y]);return _}function zs(r){(0,b.S6)(r,function(e,t){var i=e;if(i[0].toLowerCase()==="a"){var u=r[t-1],c=r[t+1];c&&c[0].toLowerCase()==="a"?u&&u[0].toLowerCase()==="l"&&(u[0]="M"):u&&u[0].toLowerCase()==="a"&&c&&c[0].toLowerCase()==="l"&&(c[0]="M")}})}var io=function(r,e,t,i){var u,c=[],p=!!i,g,_,S,k,L,R,U;if(p){u=(0,P.CR)(i,2),S=u[0],k=u[1];for(var G=0,Q=r.length;G<Q;G++){var pt=r[G];S=sa.VV([0,0],S,pt),k=sa.Fp([0,0],k,pt)}}for(var G=0,yt=r.length;G<yt;G++){var pt=r[G];if(G===0&&!t)U=pt;else if(G===yt-1&&!t)R=pt,c.push(U),c.push(R);else{g=r[t?G?G-1:yt-1:G-1],_=r[t?(G+1)%yt:G+1];var Ht=[0,0];Ht=sa.lu(Ht,_,g),Ht=sa.bA(Ht,Ht,e);var ce=sa.TE(pt,g),he=sa.TE(pt,_),ze=ce+he;ze!==0&&(ce/=ze,he/=ze);var Er=sa.bA([0,0],Ht,-ce),Fr=sa.bA([0,0],Ht,he);R=sa.IH([0,0],pt,Er),L=sa.IH([0,0],pt,Fr),L=sa.VV([0,0],L,sa.Fp([0,0],_,pt)),L=sa.Fp([0,0],L,sa.VV([0,0],_,pt)),Er=sa.lu([0,0],L,pt),Er=sa.bA([0,0],Er,-ce/he),R=sa.IH([0,0],pt,Er),R=sa.VV([0,0],R,sa.Fp([0,0],g,pt)),R=sa.Fp([0,0],R,sa.VV([0,0],g,pt)),Fr=sa.lu([0,0],pt,R),Fr=sa.bA([0,0],Fr,he/ce),L=sa.IH([0,0],pt,Fr),p&&(R=sa.Fp([0,0],R,S),R=sa.VV([0,0],R,k),L=sa.Fp([0,0],L,S),L=sa.VV([0,0],L,k)),c.push(U),c.push(R),U=L}}return t&&c.push(c.shift()),c};function Au(r,e,t){for(var i=!!e,u=[],c=0,p=r.length;c<p;c+=2)u.push([r[c],r[c+1]]);for(var g=io(u,.4,i,t),_=u.length,S=[],k,L,R,c=0;c<_-1;c++)k=g[c*2],L=g[c*2+1],R=u[c+1],S.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]]);return i&&(k=g[_],L=g[_+1],R=u[0],S.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]])),S}function Xo(r,e){return wa(r,e)}function Qs(r,e,t){var i=[],u=r[0],c=null;if(r.length<=2)return Xo(r,e);for(var p=0,g=r.length;p<g;p++){var _=r[p];(!c||!(c.x===_.x&&c.y===_.y))&&(i.push(_.x),i.push(_.y),c=_)}var S=t||[[0,0],[1,1]],k=Au(i,e,S);return k.unshift(["M",u.x,u.y]),k}function su(r,e){var t=[];return(0,b.S6)(e,function(i){var u=i[0];switch(u.toLowerCase()){case"m":case"l":case"c":t.push(Da(i,r));break;case"a":t.push(oo(i,r));break;case"z":default:t.push(i);break}}),t}function Tu(r,e){var t=[],i,u,c,p;return(0,b.S6)(e,function(g,_){var S=g[0];switch(S.toLowerCase()){case"m":case"c":case"q":t.push(Da(g,r));break;case"l":i=e[_-1],u=g,c=r.isTransposed,p=c?i[i.length-2]===u[1]:i[i.length-1]===u[2],p?t=t.concat(Is(i,u,r)):t.push(Da(g,r));break;case"a":t.push(oo(g,r));break;case"z":default:t.push(g);break}}),zs(t),t}function Js(r,e){var t=r.event,i=t.target,u=i.getCanvasBBox();return u.width>=e||u.height>=e?u:null}function zu(r,e){var t=r.event,i=t.target,u=i.getCanvasBBox();return u.width>=e||u.height>=e?i.attr("path"):null}function Jo(r){var e=r.event,t,i=e.target;return i&&(t=i.get("element")),t}function La(r){var e=r.event,t=e.target,i;return t&&(i=t.get("delegateObject")),i}function tu(r){var e=r.event.gEvent;return!(e&&e.fromShape&&e.toShape&&e.fromShape.get("element")===e.toShape.get("element"))}function fo(r){return r&&r.component&&r.component.isList()}function Mu(r){return r&&r.component&&r.component.isSlider()}function ya(r){var e=r.event,t=e.target;return t&&t.get("name")==="mask"}function eo(r,e){var t=r.event.target;if(t.get("type")==="path"){var i=zu(r,e);return i?qe(r.view,i):void 0}var u=Js(r,e);return u?Ri(r.view,u):null}function Eo(r,e,t){var i=Js(r,t);if(!i)return null;var u=r.view,c=kr(u,e,{x:i.x,y:i.y}),p=kr(u,e,{x:i.maxX,y:i.maxY}),g={minX:c.x,minY:c.y,maxX:p.x,maxY:p.y};return Ri(e,g)}function wo(r){var e=r.geometries,t=[];return(0,b.S6)(e,function(i){var u=i.elements;t=t.concat(u)}),r.views&&r.views.length&&(0,b.S6)(r.views,function(i){t=t.concat(wo(i))}),t}function Po(r,e,t){var i=wo(r);return i.filter(function(u){return an(u,e)===t})}function Je(r,e){var t=r.geometries,i=[];return(0,b.S6)(t,function(u){var c=u.getElementsBy(function(p){return p.hasState(e)});i=i.concat(c)}),i}function an(r,e){var t=r.getModel(),i=t.data,u;return(0,b.kJ)(i)?u=i[0][e]:u=i[e],u}function en(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function Ri(r,e){var t=wo(r),i=[];return(0,b.S6)(t,function(u){var c=u.shape,p=c.getCanvasBBox();en(e,p)&&i.push(u)}),i}function so(r){var e=[];return(0,b.S6)(r,function(t){var i=t[0];if(i!=="A")for(var u=1;u<t.length;u=u+2)e.push([t[u],t[u+1]]);else{var c=t.length;e.push([t[c-2],t[c-1]])}}),e}function qe(r,e){var t=wo(r),i=so(e),u=t.filter(function(c){var p=c.shape,g;if(p.get("type")==="path")g=so(p.attr("path"));else{var _=p.getCanvasBBox();g=Jf(_)}return(0,rf.Wq)(i,g)});return u}function Re(r){return r.getComponents().map(function(e){return e.component})}function yr(r,e){var t=e.x-r.x,i=e.y-r.y;return Math.sqrt(t*t+i*i)}function Xr(r,e){if(r.length<=2)return Xo(r,!1);var t=r[0],i=[];(0,b.S6)(r,function(c){i.push(c.x),i.push(c.y)});var u=Au(i,e,null);return u.unshift(["M",t.x,t.y]),u}function sn(r,e){return r.x<=e.x&&r.maxX>=e.x&&r.y<=e.y&&r.maxY>e.y}function mr(r){var e=r.parent,t=null;return e&&(t=e.views.filter(function(i){return i!==r})),t}function pr(r,e){var t=r.getCoordinate();return t.invert(e)}function kr(r,e,t){var i=pr(r,t);return e.getCoordinate().convert(i)}function Ge(r,e,t,i){var u=!1;return(0,b.S6)(r,function(c){if(c[t]===e[t]&&c[i]===e[i])return u=!0,!1}),u}function vr(r,e){var t=r.getScaleByField(e);return!t&&r.views&&(0,b.S6)(r.views,function(i){if(t=vr(i,e),t)return!1}),t}var tr=function(){function r(e){this.actions=[],this.event=null,this.cacheMap={},this.view=e}return r.prototype.cache=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e.length===1)return this.cacheMap[e[0]];e.length===2&&(this.cacheMap[e[0]]=e[1])},r.prototype.getAction=function(e){return this.actions.find(function(t){return t.name===e})},r.prototype.addAction=function(e){this.actions.push(e)},r.prototype.removeAction=function(e){var t=this.actions,i=this.actions.indexOf(e);i>=0&&t.splice(i,1)},r.prototype.getCurrentPoint=function(){var e=this.event;if(e)if(e.target instanceof HTMLElement){var t=this.view.getCanvas(),i=t.getPointByClient(e.clientX,e.clientY);return i}else return{x:e.x,y:e.y};return null},r.prototype.getCurrentShape=function(){return(0,b.U2)(this.event,["gEvent","shape"])},r.prototype.isInPlot=function(){var e=this.getCurrentPoint();return e?this.view.isPointInPlot(e):!1},r.prototype.isInShape=function(e){var t=this.getCurrentShape();return t?t.get("name")===e:!1},r.prototype.isInComponent=function(e){var t=Re(this.view),i=this.getCurrentPoint();return i?!!t.find(function(u){var c=u.getBBox();return e?u.get("name")===e&&sn(c,i):sn(c,i)}):!1},r.prototype.destroy=function(){(0,b.S6)(this.actions.slice(),function(e){e.destroy()}),this.view=null,this.event=null,this.actions=null,this.cacheMap=null},r}(),Hr=tr,Jr=function(){function r(e,t){this.view=e,this.cfg=t}return r.prototype.init=function(){this.initEvents()},r.prototype.initEvents=function(){},r.prototype.clearEvents=function(){},r.prototype.destroy=function(){this.clearEvents()},r}(),Bn=Jr;function gi(r,e,t){var i=r.split(":"),u=i[0],c=e.getAction(u)||Mi(u,e);if(!c)throw new Error("There is no action named ".concat(u));var p=i[1];return{action:c,methodName:p,arg:t}}function mi(r){var e=r.action,t=r.methodName,i=r.arg;if(e[t])e[t](i);else throw new Error("Action(".concat(e.name,") doesn't have a method called ").concat(t))}var pi={START:"start",SHOW_ENABLE:"showEnable",END:"end",ROLLBACK:"rollback",PROCESSING:"processing"},fi=function(r){(0,P.ZT)(e,r);function e(t,i){var u=r.call(this,t,i)||this;return u.callbackCaches={},u.emitCaches={},u.steps=i,u}return e.prototype.init=function(){this.initContext(),r.prototype.init.call(this)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.steps=null,this.context&&(this.context.destroy(),this.context=null),this.callbackCaches=null,this.view=null},e.prototype.initEvents=function(){var t=this;(0,b.S6)(this.steps,function(i,u){(0,b.S6)(i,function(c){var p=t.getActionCallback(u,c);p&&t.bindEvent(c.trigger,p)})})},e.prototype.clearEvents=function(){var t=this;(0,b.S6)(this.steps,function(i,u){(0,b.S6)(i,function(c){var p=t.getActionCallback(u,c);p&&t.offEvent(c.trigger,p)})})},e.prototype.initContext=function(){var t=this.view,i=new Hr(t);this.context=i;var u=this.steps;(0,b.S6)(u,function(c){(0,b.S6)(c,function(p){if((0,b.mf)(p.action))p.actionObject={action:Li(p.action,i),methodName:"execute"};else if((0,b.HD)(p.action))p.actionObject=gi(p.action,i,p.arg);else if((0,b.kJ)(p.action)){var g=p.action,_=(0,b.kJ)(p.arg)?p.arg:[p.arg];p.actionObject=[],(0,b.S6)(g,function(S,k){p.actionObject.push(gi(S,i,_[k]))})}})})},e.prototype.isAllowStep=function(t){var i=this.currentStepName,u=this.steps;if(i===t||t===pi.SHOW_ENABLE)return!0;if(t===pi.PROCESSING)return i===pi.START;if(t===pi.START)return i!==pi.PROCESSING;if(t===pi.END)return i===pi.PROCESSING||i===pi.START;if(t===pi.ROLLBACK){if(u[pi.END])return i===pi.END;if(i===pi.START)return!0}return!1},e.prototype.isAllowExecute=function(t,i){if(this.isAllowStep(t)){var u=this.getKey(t,i);return i.once&&this.emitCaches[u]?!1:i.isEnable?i.isEnable(this.context):!0}return!1},e.prototype.enterStep=function(t){this.currentStepName=t,this.emitCaches={}},e.prototype.afterExecute=function(t,i){t!==pi.SHOW_ENABLE&&this.currentStepName!==t&&this.enterStep(t);var u=this.getKey(t,i);this.emitCaches[u]=!0},e.prototype.getKey=function(t,i){return t+i.trigger+i.action},e.prototype.getActionCallback=function(t,i){var u=this,c=this.context,p=this.callbackCaches,g=i.actionObject;if(i.action&&g){var _=this.getKey(t,i);if(!p[_]){var S=function(k){c.event=k,u.isAllowExecute(t,i)?((0,b.kJ)(g)?(0,b.S6)(g,function(L){c.event=k,mi(L)}):(c.event=k,mi(g)),u.afterExecute(t,i),i.callback&&(c.event=k,i.callback(c))):c.event=null};i.debounce?p[_]=(0,b.Ds)(S,i.debounce.wait,i.debounce.immediate):i.throttle?p[_]=(0,b.P2)(S,i.throttle.wait,{leading:i.throttle.leading,trailing:i.throttle.trailing}):p[_]=S}return p[_]}return null},e.prototype.bindEvent=function(t,i){var u=t.split(":");u[0]==="window"?window.addEventListener(u[1],i):u[0]==="document"?document.addEventListener(u[1],i):this.view.on(t,i)},e.prototype.offEvent=function(t,i){var u=t.split(":");u[0]==="window"?window.removeEventListener(u[1],i):u[0]==="document"?document.removeEventListener(u[1],i):this.view.off(t,i)},e}(Bn),Xi=fi,Pi={};function Gi(r){return Pi[(0,b.vl)(r)]}function kn(r,e){Pi[(0,b.vl)(r)]=e}function Ni(r,e,t){var i=Gi(r);if(!i)return null;if((0,b.PO)(i)){var u=(0,b.CD)((0,b.d9)(i),t);return new Xi(e,u)}else{var c=i;return new c(e,t)}}function Ea(r){return{title:{autoRotate:!0,position:"center",spacing:r.axisTitleSpacing,style:{fill:r.axisTitleTextFillColor,fontSize:r.axisTitleTextFontSize,lineHeight:r.axisTitleTextLineHeight,textBaseline:"middle",fontFamily:r.fontFamily},iconStyle:{fill:r.axisDescriptionIconFillColor}},label:{autoRotate:!1,autoEllipsis:!1,autoHide:{type:"equidistance",cfg:{minGap:6}},offset:r.axisLabelOffset,style:{fill:r.axisLabelFillColor,fontSize:r.axisLabelFontSize,lineHeight:r.axisLabelLineHeight,fontFamily:r.fontFamily}},line:{style:{lineWidth:r.axisLineBorder,stroke:r.axisLineBorderColor}},grid:{line:{type:"line",style:{stroke:r.axisGridBorderColor,lineWidth:r.axisGridBorder,lineDash:r.axisGridLineDash}},alignTick:!0,animate:!0},tickLine:{style:{lineWidth:r.axisTickLineBorder,stroke:r.axisTickLineBorderColor},alignTick:!0,length:r.axisTickLineLength},subTickLine:null,animate:!0}}function jo(r){return{title:null,marker:{symbol:"circle",spacing:r.legendMarkerSpacing,style:{r:r.legendCircleMarkerSize,fill:r.legendMarkerColor}},itemName:{spacing:5,style:{fill:r.legendItemNameFillColor,fontFamily:r.fontFamily,fontSize:r.legendItemNameFontSize,lineHeight:r.legendItemNameLineHeight,fontWeight:r.legendItemNameFontWeight,textAlign:"start",textBaseline:"middle"}},itemStates:{active:{nameStyle:{opacity:.8}},unchecked:{nameStyle:{fill:"#D8D8D8"},markerStyle:{fill:"#D8D8D8",stroke:"#D8D8D8"}},inactive:{nameStyle:{fill:"#D8D8D8"},markerStyle:{opacity:.2}}},flipPage:!0,pageNavigator:{marker:{style:{size:r.legendPageNavigatorMarkerSize,inactiveFill:r.legendPageNavigatorMarkerInactiveFillColor,inactiveOpacity:r.legendPageNavigatorMarkerInactiveFillOpacity,fill:r.legendPageNavigatorMarkerFillColor,opacity:r.legendPageNavigatorMarkerFillOpacity}},text:{style:{fill:r.legendPageNavigatorTextFillColor,fontSize:r.legendPageNavigatorTextFontSize}}},animate:!1,maxItemWidth:200,itemSpacing:r.legendItemSpacing,itemMarginBottom:r.legendItemMarginBottom,padding:r.legendPadding}}function Iu(r){var e,t={point:{default:{fill:r.pointFillColor,r:r.pointSize,stroke:r.pointBorderColor,lineWidth:r.pointBorder,fillOpacity:r.pointFillOpacity},active:{stroke:r.pointActiveBorderColor,lineWidth:r.pointActiveBorder},selected:{stroke:r.pointSelectedBorderColor,lineWidth:r.pointSelectedBorder},inactive:{fillOpacity:r.pointInactiveFillOpacity,strokeOpacity:r.pointInactiveBorderOpacity}},hollowPoint:{default:{fill:r.hollowPointFillColor,lineWidth:r.hollowPointBorder,stroke:r.hollowPointBorderColor,strokeOpacity:r.hollowPointBorderOpacity,r:r.hollowPointSize},active:{stroke:r.hollowPointActiveBorderColor,strokeOpacity:r.hollowPointActiveBorderOpacity},selected:{lineWidth:r.hollowPointSelectedBorder,stroke:r.hollowPointSelectedBorderColor,strokeOpacity:r.hollowPointSelectedBorderOpacity},inactive:{strokeOpacity:r.hollowPointInactiveBorderOpacity}},area:{default:{fill:r.areaFillColor,fillOpacity:r.areaFillOpacity,stroke:null},active:{fillOpacity:r.areaActiveFillOpacity},selected:{fillOpacity:r.areaSelectedFillOpacity},inactive:{fillOpacity:r.areaInactiveFillOpacity}},hollowArea:{default:{fill:null,stroke:r.hollowAreaBorderColor,lineWidth:r.hollowAreaBorder,strokeOpacity:r.hollowAreaBorderOpacity},active:{fill:null,lineWidth:r.hollowAreaActiveBorder},selected:{fill:null,lineWidth:r.hollowAreaSelectedBorder},inactive:{strokeOpacity:r.hollowAreaInactiveBorderOpacity}},interval:{default:{fill:r.intervalFillColor,fillOpacity:r.intervalFillOpacity},active:{stroke:r.intervalActiveBorderColor,lineWidth:r.intervalActiveBorder},selected:{stroke:r.intervalSelectedBorderColor,lineWidth:r.intervalSelectedBorder},inactive:{fillOpacity:r.intervalInactiveFillOpacity,strokeOpacity:r.intervalInactiveBorderOpacity}},hollowInterval:{default:{fill:r.hollowIntervalFillColor,stroke:r.hollowIntervalBorderColor,lineWidth:r.hollowIntervalBorder,strokeOpacity:r.hollowIntervalBorderOpacity},active:{stroke:r.hollowIntervalActiveBorderColor,lineWidth:r.hollowIntervalActiveBorder,strokeOpacity:r.hollowIntervalActiveBorderOpacity},selected:{stroke:r.hollowIntervalSelectedBorderColor,lineWidth:r.hollowIntervalSelectedBorder,strokeOpacity:r.hollowIntervalSelectedBorderOpacity},inactive:{stroke:r.hollowIntervalInactiveBorderColor,lineWidth:r.hollowIntervalInactiveBorder,strokeOpacity:r.hollowIntervalInactiveBorderOpacity}},line:{default:{stroke:r.lineBorderColor,lineWidth:r.lineBorder,strokeOpacity:r.lineBorderOpacity,fill:null,lineAppendWidth:10,lineCap:"round",lineJoin:"round"},active:{lineWidth:r.lineActiveBorder},selected:{lineWidth:r.lineSelectedBorder},inactive:{strokeOpacity:r.lineInactiveBorderOpacity}}},i=Ea(r),u=jo(r);return{background:r.backgroundColor,defaultColor:r.brandColor,subColor:r.subColor,semanticRed:r.paletteSemanticRed,semanticGreen:r.paletteSemanticGreen,padding:"auto",fontFamily:r.fontFamily,columnWidthRatio:1/2,maxColumnWidth:null,minColumnWidth:null,roseWidthRatio:.9999999,multiplePieWidthRatio:1/1.3,colors10:r.paletteQualitative10,colors20:r.paletteQualitative20,sequenceColors:r.paletteSequence,shapes:{point:["hollow-circle","hollow-square","hollow-bowtie","hollow-diamond","hollow-hexagon","hollow-triangle","hollow-triangle-down","circle","square","bowtie","diamond","hexagon","triangle","triangle-down","cross","tick","plus","hyphen","line"],line:["line","dash","dot","smooth"],area:["area","smooth","line","smooth-line"],interval:["rect","hollow-rect","line","tick"]},sizes:[1,10],geometries:{interval:{rect:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:function(c){var p=c.geometry.coordinate;if(p.isPolar&&p.isTransposed){var g=Xp(c.getModel(),p),_=g.startAngle,S=g.endAngle,k=(_+S)/2,L=7.5,R=L*Math.cos(k),U=L*Math.sin(k);return{matrix:ma.vs(null,[["t",R,U]])}}return t.interval.selected}}},"hollow-rect":{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},line:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},tick:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},funnel:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}},pyramid:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},line:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},dot:{default:{style:(0,P.pi)((0,P.pi)({},t.line.default),{lineCap:null,lineDash:[1,1]})},active:{style:(0,P.pi)((0,P.pi)({},t.line.active),{lineCap:null,lineDash:[1,1]})},inactive:{style:(0,P.pi)((0,P.pi)({},t.line.inactive),{lineCap:null,lineDash:[1,1]})},selected:{style:(0,P.pi)((0,P.pi)({},t.line.selected),{lineCap:null,lineDash:[1,1]})}},dash:{default:{style:(0,P.pi)((0,P.pi)({},t.line.default),{lineCap:null,lineDash:[5.5,1]})},active:{style:(0,P.pi)((0,P.pi)({},t.line.active),{lineCap:null,lineDash:[5.5,1]})},inactive:{style:(0,P.pi)((0,P.pi)({},t.line.inactive),{lineCap:null,lineDash:[5.5,1]})},selected:{style:(0,P.pi)((0,P.pi)({},t.line.selected),{lineCap:null,lineDash:[5.5,1]})}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hvh:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},polygon:{polygon:{default:{style:t.interval.default},active:{style:t.interval.active},inactive:{style:t.interval.inactive},selected:{style:t.interval.selected}}},point:{circle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},square:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},bowtie:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},diamond:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},hexagon:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},triangle:{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"triangle-down":{default:{style:t.point.default},active:{style:t.point.active},inactive:{style:t.point.inactive},selected:{style:t.point.selected}},"hollow-circle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-square":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-bowtie":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-diamond":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-hexagon":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},"hollow-triangle-down":{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},cross:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},tick:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},plus:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},hyphen:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}},line:{default:{style:t.hollowPoint.default},active:{style:t.hollowPoint.active},inactive:{style:t.hollowPoint.inactive},selected:{style:t.hollowPoint.selected}}},area:{area:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},smooth:{default:{style:t.area.default},active:{style:t.area.active},inactive:{style:t.area.inactive},selected:{style:t.area.selected}},line:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"smooth-line":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}},schema:{candle:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}},box:{default:{style:t.hollowInterval.default},active:{style:t.hollowInterval.active},inactive:{style:t.hollowInterval.inactive},selected:{style:t.hollowInterval.selected}}},edge:{line:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},vhv:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},arc:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}}},violin:{violin:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},smooth:{default:{style:t.line.default},active:{style:t.line.active},inactive:{style:t.line.inactive},selected:{style:t.line.selected}},hollow:{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}},"hollow-smooth":{default:{style:t.hollowArea.default},active:{style:t.hollowArea.active},inactive:{style:t.hollowArea.inactive},selected:{style:t.hollowArea.selected}}}},components:{axis:{common:i,top:{position:"top",grid:null,title:null,verticalLimitLength:1/2},bottom:{position:"bottom",grid:null,title:null,verticalLimitLength:1/2},left:{position:"left",title:null,line:null,tickLine:null,verticalLimitLength:1/3},right:{position:"right",title:null,line:null,tickLine:null,verticalLimitLength:1/3},circle:{title:null,grid:(0,b.b$)({},i.grid,{line:{type:"line"}})},radius:{title:null,grid:(0,b.b$)({},i.grid,{line:{type:"circle"}})}},legend:{common:u,right:{layout:"vertical",padding:r.legendVerticalPadding},left:{layout:"vertical",padding:r.legendVerticalPadding},top:{layout:"horizontal",padding:r.legendHorizontalPadding},bottom:{layout:"horizontal",padding:r.legendHorizontalPadding},continuous:{title:null,background:null,track:{},rail:{type:"color",size:r.sliderRailHeight,defaultLength:r.sliderRailWidth,style:{fill:r.sliderRailFillColor,stroke:r.sliderRailBorderColor,lineWidth:r.sliderRailBorder}},label:{align:"rail",spacing:4,formatter:null,style:{fill:r.sliderLabelTextFillColor,fontSize:r.sliderLabelTextFontSize,lineHeight:r.sliderLabelTextLineHeight,textBaseline:"middle",fontFamily:r.fontFamily}},handler:{size:r.sliderHandlerWidth,style:{fill:r.sliderHandlerFillColor,stroke:r.sliderHandlerBorderColor}},slidable:!0,padding:u.padding}},tooltip:{showContent:!0,follow:!0,showCrosshairs:!1,showMarkers:!0,shared:!1,enterable:!1,position:"auto",marker:{symbol:"circle",stroke:"#fff",shadowBlur:10,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0,0,0,0.09)",lineWidth:2,r:4},crosshairs:{line:{style:{stroke:r.tooltipCrosshairsBorderColor,lineWidth:r.tooltipCrosshairsBorder}},text:null,textBackground:{padding:2,style:{fill:"rgba(0, 0, 0, 0.25)",lineWidth:0,stroke:null}},follow:!1},domStyles:(e={},e["".concat(ef)]={position:"absolute",visibility:"hidden",zIndex:8,transition:"left 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s, top 0.4s cubic-bezier(0.23, 1, 0.32, 1) 0s",backgroundColor:r.tooltipContainerFillColor,opacity:r.tooltipContainerFillOpacity,boxShadow:r.tooltipContainerShadow,borderRadius:"".concat(r.tooltipContainerBorderRadius,"px"),color:r.tooltipTextFillColor,fontSize:"".concat(r.tooltipTextFontSize,"px"),fontFamily:r.fontFamily,lineHeight:"".concat(r.tooltipTextLineHeight,"px"),padding:"0 12px 0 12px"},e["".concat(Cl)]={marginBottom:"12px",marginTop:"12px"},e["".concat(Pc)]={margin:0,listStyleType:"none",padding:0},e["".concat(Vp)]={listStyleType:"none",padding:0,marginBottom:"12px",marginTop:"12px",marginLeft:0,marginRight:0},e["".concat(Sh)]={width:"8px",height:"8px",borderRadius:"50%",display:"inline-block",marginRight:"8px"},e["".concat(fv)]={display:"inline-block",float:"right",marginLeft:"30px"},e)},annotation:{arc:{style:{stroke:r.annotationArcBorderColor,lineWidth:r.annotationArcBorder},animate:!0},line:{style:{stroke:r.annotationLineBorderColor,lineDash:r.annotationLineDash,lineWidth:r.annotationLineBorder},text:{position:"start",autoRotate:!0,style:{fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,textAlign:"start",fontFamily:r.fontFamily,textBaseline:"bottom"}},animate:!0},text:{style:{fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,textBaseline:"middle",textAlign:"start",fontFamily:r.fontFamily},animate:!0},region:{top:!1,style:{lineWidth:r.annotationRegionBorder,stroke:r.annotationRegionBorderColor,fill:r.annotationRegionFillColor,fillOpacity:r.annotationRegionFillOpacity},animate:!0},image:{top:!1,animate:!0},dataMarker:{top:!0,point:{style:{r:3,stroke:r.brandColor,lineWidth:2}},line:{style:{stroke:r.annotationLineBorderColor,lineWidth:r.annotationLineBorder},length:r.annotationDataMarkerLineLength},text:{style:{textAlign:"start",fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,fontFamily:r.fontFamily}},direction:"upward",autoAdjust:!0,animate:!0},dataRegion:{style:{region:{fill:r.annotationRegionFillColor,fillOpacity:r.annotationRegionFillOpacity},text:{textAlign:"center",textBaseline:"bottom",fill:r.annotationTextFillColor,stroke:r.annotationTextBorderColor,lineWidth:r.annotationTextBorder,fontSize:r.annotationTextFontSize,fontFamily:r.fontFamily}},animate:!0}},slider:{common:{padding:[8,8,8,8],backgroundStyle:{fill:r.cSliderBackgroundFillColor,opacity:r.cSliderBackgroundFillOpacity},foregroundStyle:{fill:r.cSliderForegroundFillColor,opacity:r.cSliderForegroundFillOpacity},handlerStyle:{width:r.cSliderHandlerWidth,height:r.cSliderHandlerHeight,fill:r.cSliderHandlerFillColor,opacity:r.cSliderHandlerFillOpacity,stroke:r.cSliderHandlerBorderColor,lineWidth:r.cSliderHandlerBorder,radius:r.cSliderHandlerBorderRadius,highLightFill:r.cSliderHandlerHighlightFillColor},textStyle:{fill:r.cSliderTextFillColor,opacity:r.cSliderTextFillOpacity,fontSize:r.cSliderTextFontSize,lineHeight:r.cSliderTextLineHeight,fontWeight:r.cSliderTextFontWeight,stroke:r.cSliderTextBorderColor,lineWidth:r.cSliderTextBorder}}},scrollbar:{common:{padding:[8,8,8,8]},default:{style:{trackColor:r.scrollbarTrackFillColor,thumbColor:r.scrollbarThumbFillColor}},hover:{style:{thumbColor:r.scrollbarThumbHighlightFillColor}}}},labels:{offset:12,style:{fill:r.labelFillColor,fontSize:r.labelFontSize,fontFamily:r.fontFamily,stroke:r.labelBorderColor,lineWidth:r.labelBorder},fillColorDark:r.labelFillColorDark,fillColorLight:r.labelFillColorLight,autoRotate:!0},innerLabels:{style:{fill:r.innerLabelFillColor,fontSize:r.innerLabelFontSize,fontFamily:r.fontFamily,stroke:r.innerLabelBorderColor,lineWidth:r.innerLabelBorder},autoRotate:!0},overflowLabels:{style:{fill:r.overflowLabelFillColor,fontSize:r.overflowLabelFontSize,fontFamily:r.fontFamily,stroke:r.overflowLabelBorderColor,lineWidth:r.overflowLabelBorder}},pieLabels:{labelHeight:14,offset:10,labelLine:{style:{lineWidth:r.labelLineBorder}},autoRotate:!0}}}var _a={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},mo={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Oc=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#6F5EF9","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],Al=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#6F5EF9","#D3CEFD","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],lf=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],Zl=function(r){r===void 0&&(r={});var e=r.paletteQualitative10,t=e===void 0?Oc:e,i=r.paletteQualitative20,u=i===void 0?Al:i,c=r.brandColor,p=c===void 0?t[0]:c,g={backgroundColor:"transparent",brandColor:p,subColor:"rgba(0,0,0,0.05)",paletteQualitative10:t,paletteQualitative20:u,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:lf,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:_a[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:_a[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:mo[85],axisTickLineBorderColor:_a[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:_a[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:_a[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:_a[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:_a[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:p,legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:_a[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:_a[100],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:_a[100],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:_a[45],legendPageNavigatorTextFontSize:12,sliderRailFillColor:_a[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:_a[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:_a[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:_a[25],annotationArcBorderColor:_a[15],annotationArcBorder:1,annotationLineBorderColor:_a[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:_a[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:_a[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:_a[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"rgb(255, 255, 255)",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 0px 10px #aeaeae",tooltipContainerBorderRadius:3,tooltipTextFillColor:_a[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:_a[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:mo[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:_a[65],overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:mo[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:_a[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#000",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(0,0,0,0)",scrollbarThumbFillColor:"rgba(0,0,0,0.15)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.2)",pointFillColor:p,pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:mo[100],pointBorderOpacity:1,pointActiveBorderColor:_a[100],pointSelectedBorder:2,pointSelectedBorderColor:_a[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:p,hollowPointBorderOpacity:.95,hollowPointFillColor:mo[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:_a[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:_a[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:p,lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:p,areaFillOpacity:.25,areaActiveFillColor:p,areaActiveFillOpacity:.5,areaSelectedFillColor:p,areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:p,hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:_a[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:_a[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:p,intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:_a[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:_a[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:p,hollowIntervalBorderOpacity:1,hollowIntervalFillColor:mo[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:_a[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:_a[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return(0,P.pi)((0,P.pi)({},g),r)},Y0=Zl();function Ll(r){var e=r.styleSheet,t=e===void 0?{}:e,i=(0,P._T)(r,["styleSheet"]),u=Zl(t);return(0,b.b$)({},Iu(u),i)}var rh=Ll({}),cp={default:rh};function gv(r){return(0,b.U2)(cp,(0,b.vl)(r),cp.default)}function ku(r,e){cp[(0,b.vl)(r)]=Ll(e)}function mv(r,e,t){var i=t.translate(r),u=t.translate(e);return(0,b.vQ)(i,u)}function Mh(r,e){var t=e.coordinate,i=e.getXScale(),u=i.range,c=u[u.length-1],p=u[0],g=t.invert(r),_=g.x;return t.isPolar&&_>(1+c)/2&&(_=p),i.translate(i.invert(_))}function i0(r,e,t){var i=t.coordinate,u=t.getYScale(),c=u.field,p=i.invert(e),g=u.invert(p.y),_=(0,b.sE)(r,function(S){var k=S[me];return k[c][0]<=g&&k[c][1]>=g});return _||r[r.length-1]}var $0=(0,b.HP)(function(r){if(r.isCategory)return 1;for(var e=r.values,t=e.length,i=r.translate(e[0]),u=i,c=0;c<t;c++){var p=e[c],g=r.translate(p);g<i&&(i=g),g>u&&(u=g)}return(u-i)/(t-1)});function Zg(r,e,t){var i=e.getAttribute("position"),u=i.getFields(),c=e.scales,p=(0,b.mf)(t)||!t?u[0]:t,g=c[p],_=g?g.getText(r[p]):r[p]||p;return(0,b.mf)(t)?t(_,r):_}function Kp(r){var e=(0,b.VO)(r.attributes);return(0,b.hX)(e,function(t){return(0,b.FX)(be,t.type)})}function Ih(r){var e,t,i=Kp(r),u;try{for(var c=(0,P.XA)(i),p=c.next();!p.done;p=c.next()){var g=p.value,_=g.getScale(g.type);if(_&&_.isLinear){var S=(0,b.U2)(r.scaleDefs,_.field),k=dr(_,S,g.type,r.type);if(k!=="cat"){u=_;break}}}}catch(U){e={error:U}}finally{try{p&&!p.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}var L=r.getXScale(),R=r.getYScale();return u||R||L}function jm(r,e){var t=e.field,i=r[t];if((0,b.kJ)(i)){var u=i.map(function(c){return e.getText(c)});return u.join("-")}return e.getText(i)}function Vg(r,e){var t,i=e.getGroupScales();if(i.length&&(t=i[0]),t){var u=t.field;return t.getText(r[u])}var c=Ih(e);return on(c)}function Gg(r,e,t){if(e.length===0)return null;var i=t.type,u=t.getXScale(),c=t.getYScale(),p=u.field,g=c.field,_=null;if(i==="heatmap"||i==="point"){for(var S=t.coordinate,k=S.invert(r),L=u.invert(k.x),R=c.invert(k.y),U=1/0,G=0;G<e.length;G++){var Q=e[G],pt=Q[me],yt=Math.pow(pt[p]-L,2)+Math.pow(pt[g]-R,2);yt<U&&(U=yt,_=Q)}return _}var Ht=e[0],ce=e[e.length-1],he=Mh(r,t),ze=Ht[me][p],Er=Ht[me][g],Fr=ce[me][p],zr=c.isLinear&&(0,b.kJ)(Er);if((0,b.kJ)(ze)){for(var G=0;G<e.length;G++){var pn=e[G],pt=pn[me];if(u.translate(pt[p][0])<=he&&u.translate(pt[p][1])>=he)if(zr)(0,b.kJ)(_)||(_=[]),_.push(pn);else{_=pn;break}}(0,b.kJ)(_)&&(_=i0(_,r,t))}else{var nn=void 0;if(!u.isLinear&&u.type!=="timeCat"){for(var G=0;G<e.length;G++){var pn=e[G],pt=pn[me];if(mv(pt[p],he,u))if(zr)(0,b.kJ)(_)||(_=[]),_.push(pn);else{_=pn;break}else u.translate(pt[p])<=he&&(ce=pn,nn=e[G+1])}(0,b.kJ)(_)&&(_=i0(_,r,t))}else{if((he>u.translate(Fr)||he<u.translate(ze))&&(he>u.max||he<u.min))return null;for(var Pn=0,wi=e.length-1,ha=void 0;Pn<=wi;){ha=Math.floor((Pn+wi)/2);var Sa=e[ha][me][p];if(mv(Sa,he,u))return e[ha];u.translate(Sa)<=u.translate(he)?(Pn=ha+1,ce=e[ha],nn=e[ha+1]):(wi===0&&(ce=e[0]),wi=ha-1)}}ce&&nn&&Math.abs(u.translate(ce[me][p])-he)>Math.abs(u.translate(nn[me][p])-he)&&(ce=nn)}var _o=$0(t.getXScale());return!_&&Math.abs(u.translate(ce[me][p])-he)<=_o/2&&(_=ce),_}function Lu(r,e,t,i){var u,c;t===void 0&&(t=""),i===void 0&&(i=!1);var p=r[me],g=Zg(p,e,t),_=e.tooltipOption,S=e.theme.defaultColor,k=[],L,R;function U(pn,nn){if(i||!(0,b.UM)(nn)&&nn!==""){var Pn={title:g,data:p,mappingData:r,name:pn,value:nn,color:r.color||S,marker:!0};k.push(Pn)}}if((0,b.Kn)(_)){var G=_.fields,Q=_.callback;if(Q){var pt=G.map(function(pn){return r[me][pn]}),yt=Q.apply(void 0,(0,P.ev)([],(0,P.CR)(pt),!1)),Ht=(0,P.pi)({data:r[me],mappingData:r,title:g,color:r.color||S,marker:!0},yt);k.push(Ht)}else{var ce=e.scales;try{for(var he=(0,P.XA)(G),ze=he.next();!ze.done;ze=he.next()){var Er=ze.value;if(!(0,b.UM)(p[Er])){var Fr=ce[Er];L=on(Fr),R=Fr.getText(p[Er]),U(L,R)}}}catch(pn){u={error:pn}}finally{try{ze&&!ze.done&&(c=he.return)&&c.call(he)}finally{if(u)throw u.error}}}}else{var zr=Ih(e);R=jm(p,zr),L=Vg(p,e),U(L,R)}return k}function Vl(r,e,t,i){var u,c,p=i.showNil,g=[],_=r.dataArray;if(!(0,b.xb)(_)){r.sort(_);try{for(var S=(0,P.XA)(_),k=S.next();!k.done;k=S.next()){var L=k.value,R=Gg(e,L,r);if(R){var U=r.getElementId(R),G=r.elementsMap[U];if(r.type==="heatmap"||G.visible){var Q=Lu(R,r,t,p);Q.length&&g.push(Q)}}}}catch(pt){u={error:pt}}finally{try{k&&!k.done&&(c=S.return)&&c.call(S)}finally{if(u)throw u.error}}}return g}function q0(r,e,t,i){var u=i.showNil,c=[],p=r.container,g=p.getShape(e.x,e.y);if(g&&g.get("visible")&&g.get("origin")){var _=g.get("origin").mappingData,S=Lu(_,r,t,u);S.length&&c.push(S)}return c}function f(r,e,t){var i,u,c=[],p=r.geometries,g=t.shared,_=t.title,S=t.reversed;try{for(var k=(0,P.XA)(p),L=k.next();!L.done;L=k.next()){var R=L.value;if(R.visible&&R.tooltipOption!==!1){var U=R.type,G=void 0;["point","edge","polygon"].includes(U)?G=q0(R,e,_,t):["area","line","path","heatmap"].includes(U)||g!==!1?G=Vl(R,e,_,t):G=q0(R,e,_,t),G.length&&(S&&G.reverse(),c.push(G))}}}catch(Q){i={error:Q}}finally{try{L&&!L.done&&(u=k.return)&&u.call(k)}finally{if(i)throw i.error}}return c}function d(r,e,t){var i,u,c=f(r,e,t);try{for(var p=(0,P.XA)(r.views),g=p.next();!g.done;g=p.next()){var _=g.value;c=c.concat(f(_,e,t))}}catch(S){i={error:S}}finally{try{g&&!g.done&&(u=p.return)&&u.call(p)}finally{if(i)throw i.error}}return c}function y(r){return!(0,b.hj)(r)&&!(0,b.kJ)(r)}function T(r){r===void 0&&(r=0);var e=(0,b.kJ)(r)?r:[r];switch(e.length){case 0:e=[0,0,0,0];break;case 1:e=new Array(4).fill(e[0]);break;case 2:e=(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),(0,P.CR)(e),!1);break;case 3:e=(0,P.ev)((0,P.ev)([],(0,P.CR)(e),!1),[e[1]],!1);break;default:e=e.slice(0,4);break}return e}var O={};function N(r,e){O[r]=e}function Z(r){delete O[r]}function K(){return Object.keys(O)}function mt(r){return O[r]}var Ot=function(){function r(e){this.option=this.wrapperOption(e)}return r.prototype.update=function(e){return this.option=this.wrapperOption(e),this},r.prototype.hasAction=function(e){var t=this.option.actions;return(0,b.G)(t,function(i){return i[0]===e})},r.prototype.create=function(e,t){var i=this.option,u=i.type,c=i.cfg,p=u==="theta",g=(0,P.pi)({start:e,end:t},c),_=Ko(p?"polar":u);return this.coordinate=new _(g),this.coordinate.type=u,p&&(this.hasAction("transpose")||this.transpose()),this.execActions(),this.coordinate},r.prototype.adjust=function(e,t){return this.coordinate.update({start:e,end:t}),this.coordinate.resetMatrix(),this.execActions(["scale","rotate","translate"]),this.coordinate},r.prototype.rotate=function(e){return this.option.actions.push(["rotate",e]),this},r.prototype.reflect=function(e){return this.option.actions.push(["reflect",e]),this},r.prototype.scale=function(e,t){return this.option.actions.push(["scale",e,t]),this},r.prototype.transpose=function(){return this.option.actions.push(["transpose"]),this},r.prototype.getOption=function(){return this.option},r.prototype.getCoordinate=function(){return this.coordinate},r.prototype.wrapperOption=function(e){return(0,P.pi)({type:"rect",actions:[],cfg:{}},e)},r.prototype.execActions=function(e){var t=this,i=this.option.actions;(0,b.S6)(i,function(u){var c,p=(0,P.CR)(u),g=p[0],_=p.slice(1),S=(0,b.UM)(e)?!0:e.includes(g);S&&(c=t.coordinate)[g].apply(c,(0,P.ev)([],(0,P.CR)(_),!1))})},r}(),Gt=Ot,Kt=function(){function r(e,t,i){this.view=e,this.gEvent=t,this.data=i,this.type=t.type}return r.fromData=function(e,t,i){return new r(e,new Te.Event(t,{}),i)},Object.defineProperty(r.prototype,"target",{get:function(){return this.gEvent.target},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"event",{get:function(){return this.gEvent.originalEvent},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"x",{get:function(){return this.gEvent.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this.gEvent.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientX",{get:function(){return this.gEvent.clientX},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientY",{get:function(){return this.gEvent.clientY},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[Event (type=".concat(this.type,")]")},r.prototype.clone=function(){return new r(this.view,this.gEvent,this.data)},r}(),pe=Kt;function Fe(r){var e=r.getController("axis"),t=r.getController("legend"),i=r.getController("annotation"),u=r.getController("slider"),c=r.getController("scrollbar");[e,u,c,t,i].forEach(function(p){p&&p.layout()})}var sr=function(){function r(){this.scales=new Map,this.syncScales=new Map}return r.prototype.createScale=function(e,t,i,u){var c=i,p=this.getScaleMeta(u);if(t.length===0&&p){var g=p.scale,_={type:g.type};g.isCategory&&(_.values=g.values),c=(0,b.b$)(_,p.scaleDef,i)}var S=cn(e,t,c);return this.cacheScale(S,i,u),S},r.prototype.sync=function(e,t){var i=this;this.syncScales.forEach(function(u,c){var p=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER,_=[];(0,b.S6)(u,function(S){var k=i.getScale(S);g=(0,b.hj)(k.max)?Math.max(g,k.max):g,p=(0,b.hj)(k.min)?Math.min(p,k.min):p,(0,b.S6)(k.values,function(L){_.includes(L)||_.push(L)})}),(0,b.S6)(u,function(S){var k=i.getScale(S);if(k.isContinuous)k.change({min:p,max:g,values:_});else if(k.isCategory){var L=k.range,R=i.getScaleMeta(S);_&&!(0,b.U2)(R,["scaleDef","range"])&&(L=En((0,b.b$)({},k,{values:_}),e,t)),k.change({values:_,range:L})}})})},r.prototype.cacheScale=function(e,t,i){var u=this.getScaleMeta(i);u&&u.scale.type===e.type?(On(u.scale,e),u.scaleDef=t):(u={key:i,scale:e,scaleDef:t},this.scales.set(i,u));var c=this.getSyncKey(u);if(u.syncKey=c,this.removeFromSyncScales(i),c){var p=this.syncScales.get(c);p||(p=[],this.syncScales.set(c,p)),p.push(i)}},r.prototype.getScale=function(e){var t=this.getScaleMeta(e);if(!t){var i=(0,b.Z$)(e.split("-")),u=this.syncScales.get(i);u&&u.length&&(t=this.getScaleMeta(u[0]))}return t&&t.scale},r.prototype.deleteScale=function(e){var t=this.getScaleMeta(e);if(t){var i=t.syncKey,u=this.syncScales.get(i);if(u&&u.length){var c=u.indexOf(e);c!==-1&&u.splice(c,1)}}this.scales.delete(e)},r.prototype.clear=function(){this.scales.clear(),this.syncScales.clear()},r.prototype.removeFromSyncScales=function(e){var t=this;this.syncScales.forEach(function(i,u){var c=i.indexOf(e);if(c!==-1)return i.splice(c,1),i.length===0&&t.syncScales.delete(u),!1})},r.prototype.getSyncKey=function(e){var t=e.scale,i=e.scaleDef,u=t.field,c=(0,b.U2)(i,["sync"]);return c===!0?u:c===!1?void 0:c},r.prototype.getScaleMeta=function(e){return this.scales.get(e)},r}(),lr=function(){function r(e,t,i,u){e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),u===void 0&&(u=0),this.top=e,this.right=t,this.bottom=i,this.left=u}return r.instance=function(e,t,i,u){return e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=0),u===void 0&&(u=0),new r(e,t,i,u)},r.prototype.max=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return this.top=Math.max(this.top,i),this.right=Math.max(this.right,u),this.bottom=Math.max(this.bottom,c),this.left=Math.max(this.left,p),this},r.prototype.shrink=function(e){var t=(0,P.CR)(e,4),i=t[0],u=t[1],c=t[2],p=t[3];return this.top+=i,this.right+=u,this.bottom+=c,this.left+=p,this},r.prototype.inc=function(e,t){var i=e.width,u=e.height;switch(t){case le.TOP:case le.TOP_LEFT:case le.TOP_RIGHT:this.top+=u;break;case le.RIGHT:case le.RIGHT_TOP:case le.RIGHT_BOTTOM:this.right+=i;break;case le.BOTTOM:case le.BOTTOM_LEFT:case le.BOTTOM_RIGHT:this.bottom+=u;break;case le.LEFT:case le.LEFT_TOP:case le.LEFT_BOTTOM:this.left+=i;break;default:break}return this},r.prototype.getPadding=function(){return[this.top,this.right,this.bottom,this.left]},r.prototype.clone=function(){return new(r.bind.apply(r,(0,P.ev)([void 0],(0,P.CR)(this.getPadding()),!1)))},r}();function Cr(r){var e=r.padding;if(!y(e))return new(lr.bind.apply(lr,(0,P.ev)([void 0],(0,P.CR)(T(e)),!1)));var t=r.viewBBox,i=new lr,u=[],c=[],p=[];return(0,b.S6)(r.getComponents(),function(g){var _=g.type;_===Se.AXIS?u.push(g):[Se.LEGEND,Se.SLIDER,Se.SCROLLBAR].includes(_)?c.push(g):_!==Se.GRID&&_!==Se.TOOLTIP&&p.push(g)}),(0,b.S6)(u,function(g){var _=g.component,S=_.getLayoutBBox(),k=new Nu(S.x,S.y,S.width,S.height),L=k.exceed(t);i.max(L)}),(0,b.S6)(c,function(g){var _=g.component,S=g.direction,k=_.getLayoutBBox(),L=_.get("padding"),R=new Nu(k.x,k.y,k.width,k.height).expand(L);i.inc(R,S)}),(0,b.S6)(p,function(g){var _=g.component,S=g.direction,k=_.getLayoutBBox(),L=new Nu(k.x,k.y,k.width,k.height);i.inc(L,S)}),i}function gr(r,e,t){var i=t.instance();e.forEach(function(u){u.autoPadding=i.max(u.autoPadding.getPadding())})}var Ur=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,{visible:t.visible})||this;i.views=[],i.geometries=[],i.controllers=[],i.interactions={},i.limitInPlot=!1,i.options={data:[],animate:!0},i.usedControllers=K(),i.scalePool=new sr,i.layoutFunc=Fe,i.isPreMouseInPlot=!1,i.isDataChanged=!1,i.isCoordinateChanged=!1,i.createdScaleKeys=new Map,i.onCanvasEvent=function(ce){var he=ce.name;if(!he.includes(":")){var ze=i.createViewEvent(ce);i.doPlotEvent(ze),i.emit(he,ze)}},i.onDelegateEvents=function(ce){var he=ce.name;if(!!he.includes(":")){var ze=i.createViewEvent(ce);i.emit(he,ze)}};var u=t.id,c=u===void 0?(0,b.EL)("view"):u,p=t.parent,g=t.canvas,_=t.backgroundGroup,S=t.middleGroup,k=t.foregroundGroup,L=t.region,R=L===void 0?{start:{x:0,y:0},end:{x:1,y:1}}:L,U=t.padding,G=t.appendPadding,Q=t.theme,pt=t.options,yt=t.limitInPlot,Ht=t.syncViewPadding;return i.parent=p,i.canvas=g,i.backgroundGroup=_,i.middleGroup=S,i.foregroundGroup=k,i.region=R,i.padding=U,i.appendPadding=G,i.options=(0,P.pi)((0,P.pi)({},i.options),pt),i.limitInPlot=yt,i.id=c,i.syncViewPadding=Ht,i.themeObject=(0,b.Kn)(Q)?(0,b.b$)({},gv("default"),Ll(Q)):gv(Q),i.init(),i}return e.prototype.setLayout=function(t){this.layoutFunc=t},e.prototype.init=function(){this.calculateViewBBox(),this.initEvents(),this.initComponentController(),this.initOptions()},e.prototype.render=function(t,i){t===void 0&&(t=!1),this.emit(It.BEFORE_RENDER,pe.fromData(this,It.BEFORE_RENDER,i)),this.paint(t),this.emit(It.AFTER_RENDER,pe.fromData(this,It.AFTER_RENDER,i)),this.visible===!1&&this.changeVisible(!1)},e.prototype.clear=function(){var t=this;this.emit(It.BEFORE_CLEAR),this.filteredData=[],this.coordinateInstance=void 0,this.isDataChanged=!1,this.isCoordinateChanged=!1;for(var i=this.geometries,u=0;u<i.length;u++)i[u].clear(),i[u].container.remove(!0),i[u].labelsContainer.remove(!0);this.geometries=[];for(var c=this.controllers,u=0;u<c.length;u++)c[u].name==="annotation"?c[u].clear(!0):c[u].clear();this.createdScaleKeys.forEach(function(g,_){t.getRootView().scalePool.deleteScale(_)}),this.createdScaleKeys.clear();for(var p=this.views,u=0;u<p.length;u++)p[u].clear();this.emit(It.AFTER_CLEAR)},e.prototype.destroy=function(){this.emit(It.BEFORE_DESTROY);var t=this.interactions;(0,b.S6)(t,function(g){g&&g.destroy()}),this.clear();for(var i=this.controllers,u=0,c=i.length;u<c;u++){var p=i[u];p.destroy()}this.backgroundGroup.remove(!0),this.middleGroup.remove(!0),this.foregroundGroup.remove(!0),r.prototype.destroy.call(this)},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t);for(var i=this.geometries,u=0,c=i.length;u<c;u++){var p=i[u];p.changeVisible(t)}for(var g=this.controllers,u=0,c=g.length;u<c;u++){var _=g[u];_.changeVisible(t)}return this.foregroundGroup.set("visible",t),this.middleGroup.set("visible",t),this.backgroundGroup.set("visible",t),this.getCanvas().draw(),this},e.prototype.data=function(t){return(0,b.t8)(this.options,"data",t),this.isDataChanged=!0,this},e.prototype.source=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.data() instead."),this.data(t)},e.prototype.filter=function(t,i){return(0,b.mf)(i)?((0,b.t8)(this.options,["filters",t],i),this):(!i&&(0,b.U2)(this.options,["filters",t])&&delete this.options.filters[t],this)},e.prototype.axis=function(t,i){return(0,b.jn)(t)?(0,b.t8)(this.options,["axes"],t):(0,b.t8)(this.options,["axes",t],i),this},e.prototype.legend=function(t,i){return(0,b.jn)(t)?(0,b.t8)(this.options,["legends"],t):(0,b.HD)(t)?((0,b.t8)(this.options,["legends",t],i),(0,b.PO)(i)&&(i==null?void 0:i.selected)&&(0,b.t8)(this.options,["filters",t],function(u){var c;return(c=i==null?void 0:i.selected[u])!==null&&c!==void 0?c:!0})):(0,b.t8)(this.options,["legends"],t),this},e.prototype.scale=function(t,i){var u=this;return(0,b.HD)(t)?(0,b.t8)(this.options,["scales",t],i):(0,b.Kn)(t)&&(0,b.S6)(t,function(c,p){(0,b.t8)(u.options,["scales",p],c)}),this},e.prototype.tooltip=function(t){return(0,b.t8)(this.options,"tooltip",t),this},e.prototype.annotation=function(){return this.getController("annotation")},e.prototype.guide=function(){return console.warn("This method will be removed at G2 V4.1. Please use chart.annotation() instead."),this.annotation()},e.prototype.coordinate=function(t,i){return(0,b.HD)(t)?(0,b.t8)(this.options,"coordinate",{type:t,cfg:i}):(0,b.t8)(this.options,"coordinate",t),this.coordinateController.update(this.options.coordinate),this.coordinateController},e.prototype.coord=function(t,i){return console.warn("This method will be removed at G2 V4.1. Please use chart.coordinate() instead."),this.coordinate(t,i)},e.prototype.facet=function(t,i){this.facetInstance&&this.facetInstance.destroy();var u=aa(t);if(!u)throw new Error("facet '".concat(t,"' is not exist!"));return this.facetInstance=new u(this,(0,P.pi)((0,P.pi)({},i),{type:t})),this},e.prototype.animate=function(t){return(0,b.t8)(this.options,"animate",t),this},e.prototype.updateOptions=function(t){return this.clear(),(0,b.CD)(this.options,t),this.views.forEach(function(i){return i.destroy()}),this.views=[],this.initOptions(),this.coordinateBBox=this.viewBBox,this},e.prototype.option=function(t,i){if(e.prototype[t])throw new Error(`Can't use built in variable name "`.concat(t,'", please change another one.'));return(0,b.t8)(this.options,t,i),this},e.prototype.theme=function(t){return this.themeObject=(0,b.Kn)(t)?(0,b.b$)({},this.themeObject,Ll(t)):gv(t),this},e.prototype.interaction=function(t,i){var u=this.interactions[t];u&&u.destroy();var c=Ni(t,this,i);return c&&(c.init(),this.interactions[t]=c),this},e.prototype.removeInteraction=function(t){var i=this.interactions[t];i&&(i.destroy(),this.interactions[t]=void 0)},e.prototype.changeData=function(t){this.isDataChanged=!0,this.emit(It.BEFORE_CHANGE_DATA,pe.fromData(this,It.BEFORE_CHANGE_DATA,null)),this.data(t),this.paint(!0);for(var i=this.views,u=0,c=i.length;u<c;u++){var p=i[u];p.changeData(t)}this.emit(It.AFTER_CHANGE_DATA,pe.fromData(this,It.AFTER_CHANGE_DATA,null))},e.prototype.createView=function(t){this.parent&&this.parent.parent&&console.warn("The view nesting recursive feature will be removed at G2 V4.1. Please avoid to use it.");var i={data:this.options.data,scales:(0,b.d9)(this.options.scales),axes:(0,b.d9)(this.options.axes),coordinate:(0,b.d9)(this.coordinateController.getOption()),tooltip:(0,b.d9)(this.options.tooltip),legends:(0,b.d9)(this.options.legends),animate:this.options.animate,visible:this.visible},u=new e((0,P.pi)((0,P.pi)({parent:this,canvas:this.canvas,backgroundGroup:this.backgroundGroup.addGroup({zIndex:Ie.BG}),middleGroup:this.middleGroup.addGroup({zIndex:Ie.MID}),foregroundGroup:this.foregroundGroup.addGroup({zIndex:Ie.FORE}),theme:this.themeObject,padding:this.padding},t),{options:(0,P.pi)((0,P.pi)({},i),(0,b.U2)(t,"options",{}))}));return this.views.push(u),u},e.prototype.view=function(t){return console.warn("This method will be removed at G2 V4.1. Please use chart.createView() instead."),this.createView(t)},e.prototype.removeView=function(t){var i=(0,b.Od)(this.views,function(u){return u===t})[0];return i&&i.destroy(),i},e.prototype.getCoordinate=function(){return this.coordinateInstance},e.prototype.getTheme=function(){return this.themeObject},e.prototype.getXScale=function(){var t=this.geometries[0];return t?t.getXScale():null},e.prototype.getYScales=function(){var t={},i=[];return this.geometries.forEach(function(u){var c=u.getYScale(),p=c.field;t[p]||(t[p]=!0,i.push(c))}),i},e.prototype.getScalesByDim=function(t){for(var i=this.geometries,u={},c=0,p=i.length;c<p;c++){var g=i[c],_=t==="x"?g.getXScale():g.getYScale();_&&!u[_.field]&&(u[_.field]=_)}return u},e.prototype.getScale=function(t,i){var u=i||this.getScaleKey(t);return this.getRootView().scalePool.getScale(u)},e.prototype.getScaleByField=function(t,i){return this.getScale(t,i)},e.prototype.getOptions=function(){return this.options},e.prototype.getData=function(){return this.filteredData},e.prototype.getOriginalData=function(){return this.options.data},e.prototype.getPadding=function(){return this.autoPadding.getPadding()},e.prototype.getGeometries=function(){return this.geometries},e.prototype.getElements=function(){return(0,b.u4)(this.geometries,function(t,i){return t.concat(i.getElements())},[])},e.prototype.getElementsBy=function(t){return this.getElements().filter(function(i){return t(i)})},e.prototype.getLayer=function(t){return t===X.BG?this.backgroundGroup:t===X.MID?this.middleGroup:t===X.FORE?this.foregroundGroup:this.foregroundGroup},e.prototype.isPointInPlot=function(t){return eh(this.getCoordinate(),t)},e.prototype.getLegendAttributes=function(){return(0,b.xH)(this.geometries.map(function(t){return t.getGroupAttributes()}))},e.prototype.getGroupScales=function(){var t=this.geometries.map(function(i){return i.getGroupScales()});return Th((0,b.xH)(t))},e.prototype.getCanvas=function(){return this.getRootView().canvas},e.prototype.getRootView=function(){for(var t=this;;){if(t.parent){t=t.parent;continue}break}return t},e.prototype.getXY=function(t){var i=this.getCoordinate(),u=this.getScalesByDim("x"),c=this.getScalesByDim("y"),p,g;if((0,b.S6)(t,function(_,S){u[S]&&(p=u[S].scale(_)),c[S]&&(g=c[S].scale(_))}),!(0,b.UM)(p)&&!(0,b.UM)(g))return i.convert({x:p,y:g})},e.prototype.getController=function(t){return(0,b.sE)(this.controllers,function(i){return i.name===t})},e.prototype.showTooltip=function(t){var i=this.getController("tooltip");return i&&i.showTooltip(t),this},e.prototype.hideTooltip=function(){var t=this.getController("tooltip");return t&&t.hideTooltip(),this},e.prototype.lockTooltip=function(){var t=this.getController("tooltip");return t&&t.lockTooltip(),this},e.prototype.unlockTooltip=function(){var t=this.getController("tooltip");return t&&t.unlockTooltip(),this},e.prototype.isTooltipLocked=function(){var t=this.getController("tooltip");return t&&t.isTooltipLocked()},e.prototype.getTooltipItems=function(t){var i=this.getController("tooltip");return i?i.getTooltipItems(t):[]},e.prototype.getSnapRecords=function(t){for(var i=this.geometries,u=[],c=0,p=i.length;c<p;c++){var g=i[c],_=g.dataArray;g.sort(_);for(var S=void 0,k=0,L=_.length;k<L;k++){var R=_[k];S=Gg(t,R,g),S&&u.push(S)}}for(var U=this.views,c=0,p=U.length;c<p;c++){var G=U[c],Q=G.getSnapRecords(t);u=u.concat(Q)}return u},e.prototype.getComponents=function(){for(var t=[],i=this.controllers,u=0,c=i.length;u<c;u++){var p=i[u];t=t.concat(p.getComponents())}return t},e.prototype.filterData=function(t){var i=this.options.filters;return(0,b.dp)(i)===0?t:(0,b.hX)(t,function(u,c){var p=Object.keys(i);return p.every(function(g){var _=i[g];return _(u[g],u,c)})})},e.prototype.filterFieldData=function(t,i){var u=this.options.filters,c=(0,b.U2)(u,t);return(0,b.o8)(c)?i:i.filter(function(p,g){return c(p[t],p,g)})},e.prototype.adjustCoordinate=function(){var t=this.getCoordinate(),i=t.start,u=t.end,c=this.coordinateBBox.bl,p=this.coordinateBBox.tr;if((0,b.Xy)(i,c)&&(0,b.Xy)(u,p)){this.isCoordinateChanged=!1;return}this.isCoordinateChanged=!0,this.coordinateInstance=this.coordinateController.adjust(c,p)},e.prototype.paint=function(t){this.renderDataRecursive(t),this.syncScale(),this.emit(It.BEFORE_PAINT),this.renderPaddingRecursive(t),this.renderLayoutRecursive(t),this.renderBackgroundStyleShape(),this.renderPaintRecursive(t),this.emit(It.AFTER_PAINT),this.isDataChanged=!1},e.prototype.renderBackgroundStyleShape=function(){if(!this.parent){var t=(0,b.U2)(this.themeObject,"background");if(t){this.backgroundStyleRectShape||(this.backgroundStyleRectShape=this.backgroundGroup.addShape("rect",{attrs:{},zIndex:-1,capture:!1}),this.backgroundStyleRectShape.toBack());var i=this.viewBBox,u=i.x,c=i.y,p=i.width,g=i.height;this.backgroundStyleRectShape.attr({fill:t,x:u,y:c,width:p,height:g})}else this.backgroundStyleRectShape&&(this.backgroundStyleRectShape.remove(!0),this.backgroundStyleRectShape=void 0)}},e.prototype.renderPaddingRecursive=function(t){this.calculateViewBBox(),this.adjustCoordinate(),this.initComponents(t),this.autoPadding=Cr(this).shrink(T(this.appendPadding)),this.coordinateBBox=this.viewBBox.shrink(this.autoPadding.getPadding()),this.adjustCoordinate();var i=this.controllers.find(function(_){return _.name==="tooltip"});i.update();for(var u=this.views,c=0,p=u.length;c<p;c++){var g=u[c];g.renderPaddingRecursive(t)}},e.prototype.renderLayoutRecursive=function(t){var i=this.syncViewPadding===!0?gr:(0,b.mf)(this.syncViewPadding)?this.syncViewPadding:void 0;i&&(i(this,this.views,lr),this.views.forEach(function(_){_.coordinateBBox=_.viewBBox.shrink(_.autoPadding.getPadding()),_.adjustCoordinate()})),this.doLayout();for(var u=this.views,c=0,p=u.length;c<p;c++){var g=u[c];g.renderLayoutRecursive(t)}},e.prototype.renderPaintRecursive=function(t){var i=this.middleGroup;if(this.limitInPlot){var u=qp(this.coordinateInstance),c=u.type,p=u.attrs;i.setClip({type:c,attrs:p})}else i.setClip(void 0);this.paintGeometries(t),this.renderComponents(t);for(var g=this.views,_=0,S=g.length;_<S;_++){var k=g[_];k.renderPaintRecursive(t)}},e.prototype.createScale=function(t,i,u,c){var p=(0,b.U2)(this.options.scales,[t]),g=(0,P.pi)((0,P.pi)({},p),u);return this.parent?this.parent.createScale(t,i,g,c):this.scalePool.createScale(t,i,g,c)},e.prototype.renderDataRecursive=function(t){this.doFilterData(),this.createCoordinate(),this.initGeometries(t),this.renderFacet(t);for(var i=this.views,u=0,c=i.length;u<c;u++){var p=i[u];p.renderDataRecursive(t)}},e.prototype.calculateViewBBox=function(){var t,i,u,c;if(this.parent){var p=this.parent.coordinateBBox;t=p.x,i=p.y,u=p.width,c=p.height}else t=0,i=0,u=this.canvas.get("width"),c=this.canvas.get("height");var g=this.region,_=g.start,S=g.end,k=new Nu(t+u*_.x,i+c*_.y,u*(S.x-_.x),c*(S.y-_.y));(!this.viewBBox||!this.viewBBox.isEqual(k))&&(this.viewBBox=new Nu(t+u*_.x,i+c*_.y,u*(S.x-_.x),c*(S.y-_.y))),this.coordinateBBox=this.viewBBox},e.prototype.initEvents=function(){this.foregroundGroup.on("*",this.onDelegateEvents),this.middleGroup.on("*",this.onDelegateEvents),this.backgroundGroup.on("*",this.onDelegateEvents),this.canvas.on("*",this.onCanvasEvent)},e.prototype.initComponentController=function(){for(var t=this.usedControllers,i=0,u=t.length;i<u;i++){var c=t[i],p=mt(c);p&&this.controllers.push(new p(this))}},e.prototype.createViewEvent=function(t){var i=t.shape,u=t.name,c=i?i.get("origin"):null,p=new pe(this,t,c);return p.type=u,p},e.prototype.doPlotEvent=function(t){var i=t.type,u=t.x,c=t.y,p={x:u,y:c},g=["mousedown","mouseup","mousemove","mouseleave","mousewheel","touchstart","touchmove","touchend","touchcancel","click","dblclick","contextmenu"];if(g.includes(i)){var _=this.isPointInPlot(p),S=t.clone();if(_){var k="plot:".concat(i);S.type=k,this.emit(k,S),(i==="mouseleave"||i==="touchend")&&(this.isPreMouseInPlot=!1)}i==="mousemove"||i==="touchmove"?(this.isPreMouseInPlot&&!_?(i==="mousemove"&&(S.type=Dt.MOUSE_LEAVE,this.emit(Dt.MOUSE_LEAVE,S)),S.type=Dt.LEAVE,this.emit(Dt.LEAVE,S)):!this.isPreMouseInPlot&&_&&(i==="mousemove"&&(S.type=Dt.MOUSE_ENTER,this.emit(Dt.MOUSE_ENTER,S)),S.type=Dt.ENTER,this.emit(Dt.ENTER,S)),this.isPreMouseInPlot=_):(i==="mouseleave"||i==="touchend")&&this.isPreMouseInPlot&&(i==="mouseleave"&&(S.type=Dt.MOUSE_LEAVE,this.emit(Dt.MOUSE_LEAVE,S)),S.type=Dt.LEAVE,this.emit(Dt.LEAVE,S),this.isPreMouseInPlot=!1)}},e.prototype.doFilterData=function(){var t=this.options.data;this.filteredData=this.filterData(t)},e.prototype.initGeometries=function(t){this.createOrUpdateScales();for(var i=this.getCoordinate(),u=(0,b.U2)(this.options,"scales",{}),c=this.geometries,p=0,g=c.length;p<g;p++){var _=c[p];_.scales=this.getGeometryScales();var S={coordinate:i,scaleDefs:u,data:this.filteredData,theme:this.themeObject,isDataChanged:this.isDataChanged,isCoordinateChanged:this.isCoordinateChanged};t?_.update(S):_.init(S)}this.adjustScales()},e.prototype.createOrUpdateScales=function(){for(var t=this.getScaleFields(),i=this.getGroupedFields(),u=this.getOptions(),c=u.data,p=u.scales,g=p===void 0?{}:p,_=this.filteredData,S=0,k=t.length;S<k;S++){var L=t[S],R=g[L],U=this.getScaleKey(L);this.createScale(L,i.includes(L)?c:_,R,U),this.createdScaleKeys.set(U,!0)}},e.prototype.syncScale=function(){this.getRootView().scalePool.sync(this.getCoordinate(),this.theme)},e.prototype.getGeometryScales=function(){for(var t=this.getScaleFields(),i={},u=0;u<t.length;u++){var c=t[u];i[c]=this.getScaleByField(c)}return i},e.prototype.getScaleFields=function(){for(var t=[],i=new Map,u=this.geometries,c=0;c<u.length;c++){var p=u[c],g=p.getScaleFields();Th(g,t,i)}return t},e.prototype.getGroupedFields=function(){for(var t=[],i=new Map,u=this.geometries,c=0;c<u.length;c++){var p=u[c],g=p.getGroupFields();Th(g,t,i)}return t},e.prototype.adjustScales=function(){this.adjustCategoryScaleRange()},e.prototype.adjustCategoryScaleRange=function(){var t=this,i=(0,P.ev)([this.getXScale()],(0,P.CR)(this.getYScales()),!1).filter(function(p){return!!p}),u=this.getCoordinate(),c=this.options.scales;(0,b.S6)(i,function(p){var g=p.field,_=p.values,S=p.isCategory,k=p.isIdentity;(S||k)&&_&&!(0,b.U2)(c,[g,"range"])&&(p.range=En(p,u,t.theme))})},e.prototype.initComponents=function(t){for(var i=this.controllers,u=0;u<i.length;u++){var c=i[u];t?c.update():(c.clear(),c.render())}},e.prototype.doLayout=function(){this.layoutFunc(this)},e.prototype.createCoordinate=function(){var t=this.coordinateBBox.bl,i=this.coordinateBBox.tr;this.coordinateInstance=this.coordinateController.create(t,i)},e.prototype.paintGeometries=function(t){for(var i=this.options.animate,u=this.getCoordinate(),c={x:this.viewBBox.x,y:this.viewBBox.y,minX:this.viewBBox.minX,minY:this.viewBBox.minY,maxX:this.viewBBox.maxX,maxY:this.viewBBox.maxY,width:this.viewBBox.width,height:this.viewBBox.height},p=this.geometries,g=0;g<p.length;g++){var _=p[g];_.coordinate=u,_.canvasRegion=c,i||_.animate(!1),_.paint(t)}},e.prototype.renderComponents=function(t){for(var i=this.getComponents(),u=0;u<i.length;u++){var c=i[u];c.component.render()}},e.prototype.renderFacet=function(t){this.facetInstance&&(t?this.facetInstance.update():(this.facetInstance.clear(),this.facetInstance.init(),this.facetInstance.render()))},e.prototype.initOptions=function(){var t=this,i=this.options,u=i.geometries,c=u===void 0?[]:u,p=i.interactions,g=p===void 0?[]:p,_=i.views,S=_===void 0?[]:_,k=i.annotations,L=k===void 0?[]:k,R=i.coordinate,U=i.events,G=i.facets;this.coordinateController?R&&this.coordinateController.update(R):this.coordinateController=new Gt(R);for(var Q=0;Q<c.length;Q++){var pt=c[Q];this.createGeometry(pt)}for(var yt=0;yt<g.length;yt++){var Ht=g[yt],ce=Ht.type,he=Ht.cfg;this.interaction(ce,he)}for(var ze=0;ze<S.length;ze++){var Er=S[ze];this.createView(Er)}for(var Fr=this.getController("annotation"),zr=0;zr<L.length;zr++){var pn=L[zr];Fr.annotation(pn)}U&&(0,b.S6)(U,function(nn,Pn){t.on(Pn,nn)}),G&&(0,b.S6)(G,function(nn){var Pn=nn.type,wi=(0,P._T)(nn,["type"]);t.facet(Pn,wi)})},e.prototype.createGeometry=function(t){var i=t.type,u=t.cfg,c=u===void 0?{}:u;if(this[i]){var p=this[i](c);(0,b.S6)(t,function(g,_){(0,b.mf)(p[_])&&p[_](g)})}},e.prototype.getScaleKey=function(t){return"".concat(this.id,"-").concat(t)},e}(Qt);function Ar(r,e){Ur.prototype[r.toLowerCase()]=function(t){t===void 0&&(t={});var i=(0,P.pi)({container:this.middleGroup.addGroup(),labelsContainer:this.foregroundGroup.addGroup()},t),u=new e(i);return this.geometries.push(u),u}}var Dr=Ur,mn=function(r){(0,P.ZT)(e,r);function e(t){var i=this,u=t.container,c=t.width,p=t.height,g=t.autoFit,_=g===void 0?!1:g,S=t.padding,k=t.appendPadding,L=t.renderer,R=L===void 0?"canvas":L,U=t.pixelRatio,G=t.localRefresh,Q=G===void 0?!0:G,pt=t.visible,yt=pt===void 0?!0:pt,Ht=t.supportCSSTransform,ce=Ht===void 0?!1:Ht,he=t.defaultInteractions,ze=he===void 0?["tooltip","legend-filter","legend-active","continuous-filter","ellipsis-text","axis-description"]:he,Er=t.options,Fr=t.limitInPlot,zr=t.theme,pn=t.syncViewPadding,nn=(0,b.HD)(u)?document.getElementById(u):u,Pn=(0,vt.Z)('<div style="position:relative;"></div>');nn.appendChild(Pn);var wi=ne(nn,_,c,p),ha=Pt(R),Sa=new ha.Canvas((0,P.pi)({container:Pn,pixelRatio:U,localRefresh:Q,supportCSSTransform:ce},wi));return i=r.call(this,{parent:null,canvas:Sa,backgroundGroup:Sa.addGroup({zIndex:Ie.BG}),middleGroup:Sa.addGroup({zIndex:Ie.MID}),foregroundGroup:Sa.addGroup({zIndex:Ie.FORE}),padding:S,appendPadding:k,visible:yt,options:Er,limitInPlot:Fr,theme:zr,syncViewPadding:pn})||this,i.onResize=(0,b.Ds)(function(){i.forceFit()},300),i.ele=nn,i.canvas=Sa,i.width=wi.width,i.height=wi.height,i.autoFit=_,i.localRefresh=Q,i.renderer=R,i.wrapperElement=Pn,i.updateCanvasStyle(),i.bindAutoFit(),i.initDefaultInteractions(ze),i}return e.prototype.initDefaultInteractions=function(t){var i=this;(0,b.S6)(t,function(u){i.interaction(u)})},e.prototype.aria=function(t){var i="aria-label";t===!1?this.ele.removeAttribute(i):this.ele.setAttribute(i,t.label)},e.prototype.changeSize=function(t,i){return this.width===t&&this.height===i?this:(this.emit(It.BEFORE_CHANGE_SIZE),this.width=t,this.height=i,this.canvas.changeSize(t,i),this.render(!0),this.emit(It.AFTER_CHANGE_SIZE),this)},e.prototype.clear=function(){r.prototype.clear.call(this),this.aria(!1)},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.unbindAutoFit(),this.canvas.destroy(),ge(this.wrapperElement),this.wrapperElement=null},e.prototype.changeVisible=function(t){return r.prototype.changeVisible.call(this,t),this.wrapperElement.style.display=t?"":"none",this},e.prototype.forceFit=function(){if(!this.destroyed){var t=ne(this.ele,!0,this.width,this.height),i=t.width,u=t.height;this.changeSize(i,u)}},e.prototype.updateCanvasStyle=function(){(0,W.Z)(this.canvas.get("el"),{display:"inline-block",verticalAlign:"middle"})},e.prototype.bindAutoFit=function(){this.autoFit&&window.addEventListener("resize",this.onResize)},e.prototype.unbindAutoFit=function(){this.autoFit&&window.removeEventListener("resize",this.onResize)},e}(Dr),Fn=mn,ni=function(){function r(e){this.visible=!0,this.components=[],this.view=e}return r.prototype.clear=function(e){(0,b.S6)(this.components,function(t){t.component.destroy()}),this.components=[]},r.prototype.destroy=function(){this.clear()},r.prototype.getComponents=function(){return this.components},r.prototype.changeVisible=function(e){this.visible!==e&&(this.components.forEach(function(t){e?t.component.show():t.component.hide()}),this.visible=e)},r}();function ki(r){for(var e=[],t=function(u){var c=r[u],p=(0,b.sE)(e,function(g){return g.color===c.color&&g.name===c.name&&g.value===c.value&&g.title===c.title});p||e.push(c)},i=0;i<r.length;i++)t(i);return e}var oa=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isLocked=!1,t}return Object.defineProperty(e.prototype,"name",{get:function(){return"tooltip"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.isVisible=function(){var t=this.view.getOptions().tooltip;return t!==!1},e.prototype.render=function(){},e.prototype.showTooltip=function(t){if(this.point=t,!!this.isVisible()){var i=this.view,u=this.getTooltipItems(t);if(!u.length){this.hideTooltip();return}var c=this.getTitle(u),p={x:u[0].x,y:u[0].y};i.emit("tooltip:show",pe.fromData(i,"tooltip:show",(0,P.pi)({items:u,title:c},t)));var g=this.getTooltipCfg(),_=g.follow,S=g.showMarkers,k=g.showCrosshairs,L=g.showContent,R=g.marker,U=this.items,G=this.title;if(!(0,b.Xy)(G,c)||!(0,b.Xy)(U,u)?(i.emit("tooltip:change",pe.fromData(i,"tooltip:change",(0,P.pi)({items:u,title:c},t))),((0,b.mf)(L)?L(u):L)&&(this.tooltip||this.renderTooltip(),this.tooltip.update((0,b.CD)({},g,{items:this.getItemsAfterProcess(u),title:c},_?t:{})),this.tooltip.show()),S&&this.renderTooltipMarkers(u,R)):(this.tooltip&&_&&(this.tooltip.update(t),this.tooltip.show()),this.tooltipMarkersGroup&&this.tooltipMarkersGroup.show()),this.items=u,this.title=c,k){var Q=(0,b.U2)(g,["crosshairs","follow"],!1);this.renderCrosshairs(Q?t:p,g)}}},e.prototype.hideTooltip=function(){var t=this.getTooltipCfg().follow;if(!t){this.point=null;return}var i=this.tooltipMarkersGroup;i&&i.hide();var u=this.xCrosshair,c=this.yCrosshair;u&&u.hide(),c&&c.hide();var p=this.tooltip;p&&p.hide(),this.view.emit("tooltip:hide",pe.fromData(this.view,"tooltip:hide",{})),this.point=null},e.prototype.lockTooltip=function(){this.isLocked=!0,this.tooltip&&this.tooltip.setCapture(!0)},e.prototype.unlockTooltip=function(){this.isLocked=!1;var t=this.getTooltipCfg();this.tooltip&&this.tooltip.setCapture(t.capture)},e.prototype.isTooltipLocked=function(){return this.isLocked},e.prototype.clear=function(){var t=this,i=t.tooltip,u=t.xCrosshair,c=t.yCrosshair,p=t.tooltipMarkersGroup;i&&(i.hide(),i.clear()),u&&u.clear(),c&&c.clear(),p&&p.clear(),i!=null&&i.get("customContent")&&(this.tooltip.destroy(),this.tooltip=null),this.title=null,this.items=null},e.prototype.destroy=function(){this.tooltip&&this.tooltip.destroy(),this.xCrosshair&&this.xCrosshair.destroy(),this.yCrosshair&&this.yCrosshair.destroy(),this.guideGroup&&this.guideGroup.remove(!0),this.reset()},e.prototype.reset=function(){this.items=null,this.title=null,this.tooltipMarkersGroup=null,this.tooltipCrosshairsGroup=null,this.xCrosshair=null,this.yCrosshair=null,this.tooltip=null,this.guideGroup=null,this.isLocked=!1,this.point=null},e.prototype.changeVisible=function(t){if(this.visible!==t){var i=this,u=i.tooltip,c=i.tooltipMarkersGroup,p=i.xCrosshair,g=i.yCrosshair;t?(u&&u.show(),c&&c.show(),p&&p.show(),g&&g.show()):(u&&u.hide(),c&&c.hide(),p&&p.hide(),g&&g.hide()),this.visible=t}},e.prototype.getTooltipItems=function(t){var i,u,c,p,g,_,S=this.findItemsFromView(this.view,t);if(S.length){S=(0,b.xH)(S);try{for(var k=(0,P.XA)(S),L=k.next();!L.done;L=k.next()){var R=L.value;try{for(var U=(c=void 0,(0,P.XA)(R)),G=U.next();!G.done;G=U.next()){var Q=G.value,pt=Q.mappingData,yt=pt.x,Ht=pt.y;Q.x=(0,b.kJ)(yt)?yt[yt.length-1]:yt,Q.y=(0,b.kJ)(Ht)?Ht[Ht.length-1]:Ht}}catch(nn){c={error:nn}}finally{try{G&&!G.done&&(p=U.return)&&p.call(U)}finally{if(c)throw c.error}}}}catch(nn){i={error:nn}}finally{try{L&&!L.done&&(u=k.return)&&u.call(k)}finally{if(i)throw i.error}}var ce=this.getTooltipCfg().shared;if(ce===!1&&S.length>1){var he=S[0],ze=Math.abs(t.y-he[0].y);try{for(var Er=(0,P.XA)(S),Fr=Er.next();!Fr.done;Fr=Er.next()){var zr=Fr.value,pn=Math.abs(t.y-zr[0].y);pn<=ze&&(he=zr,ze=pn)}}catch(nn){g={error:nn}}finally{try{Fr&&!Fr.done&&(_=Er.return)&&_.call(Er)}finally{if(g)throw g.error}}S=[he]}return ki((0,b.xH)(S))}return[]},e.prototype.layout=function(){},e.prototype.update=function(){if(this.point&&this.showTooltip(this.point),this.tooltip){var t=this.view.getCanvas();this.tooltip.set("region",{start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}})}},e.prototype.isCursorEntered=function(t){if(this.tooltip){var i=this.tooltip.getContainer(),u=this.tooltip.get("capture");if(i&&u){var c=i.getBoundingClientRect(),p=c.x,g=c.y,_=c.width,S=c.height;return new Nu(p,g,_,S).isPointIn(t)}}return!1},e.prototype.getTooltipCfg=function(){var t=this.view,i=t.getOptions().tooltip,u=this.processCustomContent(i),c=t.getTheme(),p=(0,b.U2)(c,["components","tooltip"],{}),g=(0,b.U2)(u,"enterable",p.enterable);return(0,b.b$)({},p,u,{capture:!!(g||this.isLocked)})},e.prototype.processCustomContent=function(t){if((0,b.jn)(t)||!(0,b.U2)(t,"customContent"))return t;var i=t.customContent,u=function(c,p){var g=i(c,p)||"";return(0,b.HD)(g)?'<div class="g2-tooltip">'+g+"</div>":g};return(0,P.pi)((0,P.pi)({},t),{customContent:u})},e.prototype.getTitle=function(t){var i=t[0].title||t[0].name;return this.title=i,i},e.prototype.renderTooltip=function(){var t=this.view.getCanvas(),i={start:{x:0,y:0},end:{x:t.get("width"),y:t.get("height")}},u=this.getTooltipCfg(),c=new lp((0,P.pi)((0,P.pi)({parent:t.get("el").parentNode,region:i},u),{visible:!1,crosshairs:null}));c.init(),this.tooltip=c},e.prototype.renderTooltipMarkers=function(t,i){var u,c,p=this.getTooltipMarkersGroup(),g=this.view.getRootView(),_=g.limitInPlot;try{for(var S=(0,P.XA)(t),k=S.next();!k.done;k=S.next()){var L=k.value,R=L.x,U=L.y;if(_||(p==null?void 0:p.getClip())){var G=qp(g.getCoordinate()),Q=G.type,pt=G.attrs;p==null||p.setClip({type:Q,attrs:pt})}else p==null||p.setClip(void 0);var yt=this.view.getTheme(),Ht=(0,b.U2)(yt,["components","tooltip","marker"],{}),ce=(0,P.pi)((0,P.pi)({fill:L.color,symbol:"circle",shadowColor:L.color},(0,b.mf)(i)?(0,P.pi)((0,P.pi)({},Ht),i(L)):i),{x:R,y:U});p.addShape("marker",{attrs:ce})}}catch(he){u={error:he}}finally{try{k&&!k.done&&(c=S.return)&&c.call(S)}finally{if(u)throw u.error}}},e.prototype.renderCrosshairs=function(t,i){var u=(0,b.U2)(i,["crosshairs","type"],"x");u==="x"?(this.yCrosshair&&this.yCrosshair.hide(),this.renderXCrosshairs(t,i)):u==="y"?(this.xCrosshair&&this.xCrosshair.hide(),this.renderYCrosshairs(t,i)):u==="xy"&&(this.renderXCrosshairs(t,i),this.renderYCrosshairs(t,i))},e.prototype.renderXCrosshairs=function(t,i){var u=this.getViewWithGeometry(this.view).getCoordinate(),c,p;if(u.isRect)u.isTransposed?(c={x:u.start.x,y:t.y},p={x:u.end.x,y:t.y}):(c={x:t.x,y:u.end.y},p={x:t.x,y:u.start.y});else{var g=uf(u,t),_=u.getCenter(),S=u.getRadius();p=co(_.x,_.y,S,g),c=_}var k=(0,b.b$)({start:c,end:p,container:this.getTooltipCrosshairsGroup()},(0,b.U2)(i,"crosshairs",{}),this.getCrosshairsText("x",t,i));delete k.type;var L=this.xCrosshair;L?L.update(k):(L=new wl(k),L.init()),L.render(),L.show(),this.xCrosshair=L},e.prototype.renderYCrosshairs=function(t,i){var u=this.getViewWithGeometry(this.view).getCoordinate(),c,p;if(u.isRect){var g=void 0,_=void 0;u.isTransposed?(g={x:t.x,y:u.end.y},_={x:t.x,y:u.start.y}):(g={x:u.start.x,y:t.y},_={x:u.end.x,y:t.y}),c={start:g,end:_},p="Line"}else c={center:u.getCenter(),radius:$p(u,t),startAngle:u.startAngle,endAngle:u.endAngle},p="Circle";c=(0,b.b$)({container:this.getTooltipCrosshairsGroup()},c,(0,b.U2)(i,"crosshairs",{}),this.getCrosshairsText("y",t,i)),delete c.type;var S=this.yCrosshair;S?u.isRect&&S.get("type")==="circle"||!u.isRect&&S.get("type")==="line"?(S=new ht[p](c),S.init()):S.update(c):(S=new ht[p](c),S.init()),S.render(),S.show(),this.yCrosshair=S},e.prototype.getCrosshairsText=function(t,i,u){var c=(0,b.U2)(u,["crosshairs","text"]),p=(0,b.U2)(u,["crosshairs","follow"]),g=this.items;if(c){var _=this.getViewWithGeometry(this.view),S=g[0],k=_.getXScale(),L=_.getYScales()[0],R=void 0,U=void 0;if(p){var G=this.view.getCoordinate().invert(i);R=k.invert(G.x),U=L.invert(G.y)}else R=S.data[k.field],U=S.data[L.field];var Q=t==="x"?R:U;return(0,b.mf)(c)?c=c(t,Q,g,i):c.content=Q,{text:c}}},e.prototype.getGuideGroup=function(){if(!this.guideGroup){var t=this.view.foregroundGroup;this.guideGroup=t.addGroup({name:"tooltipGuide",capture:!1})}return this.guideGroup},e.prototype.getTooltipMarkersGroup=function(){var t=this.tooltipMarkersGroup;return t&&!t.destroyed?(t.clear(),t.show()):(t=this.getGuideGroup().addGroup({name:"tooltipMarkersGroup"}),t.toFront(),this.tooltipMarkersGroup=t),t},e.prototype.getTooltipCrosshairsGroup=function(){var t=this.tooltipCrosshairsGroup;return t||(t=this.getGuideGroup().addGroup({name:"tooltipCrosshairsGroup",capture:!1}),t.toBack(),this.tooltipCrosshairsGroup=t),t},e.prototype.findItemsFromView=function(t,i){var u,c;if(t.getOptions().tooltip===!1)return[];var p=this.getTooltipCfg(),g=f(t,i,p);try{for(var _=(0,P.XA)(t.views),S=_.next();!S.done;S=_.next()){var k=S.value;g=g.concat(this.findItemsFromView(k,i))}}catch(L){u={error:L}}finally{try{S&&!S.done&&(c=_.return)&&c.call(_)}finally{if(u)throw u.error}}return g},e.prototype.getViewWithGeometry=function(t){var i=this;return t.geometries.length?t:(0,b.sE)(t.views,function(u){return i.getViewWithGeometry(u)})},e.prototype.getItemsAfterProcess=function(t){var i=this.getTooltipCfg().customItems,u=i||function(c){return c};return u(t)},e}(ni),Di=oa,ca={};function zi(r){return ca[r.toLowerCase()]}function Oa(r,e){ca[r.toLowerCase()]=e}var xa={appear:{duration:450,easing:"easeQuadOut"},update:{duration:400,easing:"easeQuadInOut"},enter:{duration:400,easing:"easeQuadInOut"},leave:{duration:350,easing:"easeQuadIn"}},Qi={interval:function(r){return{enter:{animation:r.isRect?r.isTransposed?"scale-in-x":"scale-in-y":"fade-in"},update:{animation:r.isPolar&&r.isTransposed?"sector-path-update":null},leave:{animation:"fade-out"}}},line:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},path:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},point:{appear:{animation:"zoom-in"},enter:{animation:"zoom-in"},leave:{animation:"zoom-out"}},area:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},polygon:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},schema:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},edge:{enter:{animation:"fade-in"},leave:{animation:"fade-out"}},label:{appear:{animation:"fade-in",delay:450},enter:{animation:"fade-in"},update:{animation:"position-update"},leave:{animation:"fade-out"}}},lo={line:function(){return{animation:"wave-in"}},area:function(){return{animation:"wave-in"}},path:function(){return{animation:"fade-in"}},interval:function(r){var e;return r.isRect?e=r.isTransposed?"grow-in-x":"grow-in-y":(e="grow-in-xy",r.isPolar&&r.isTransposed&&(e="wave-in")),{animation:e}},schema:function(r){var e;return r.isRect?e=r.isTransposed?"grow-in-x":"grow-in-y":e="grow-in-xy",{animation:e}},polygon:function(){return{animation:"fade-in",duration:500}},edge:function(){return{animation:"fade-in"}}};function Ja(r,e){return{delay:(0,b.mf)(r.delay)?r.delay(e):r.delay,easing:(0,b.mf)(r.easing)?r.easing(e):r.easing,duration:(0,b.mf)(r.duration)?r.duration(e):r.duration,callback:r.callback,repeat:r.repeat}}function To(r,e,t){var i=Qi[r];return i&&((0,b.mf)(i)&&(i=i(e)),i=(0,b.b$)({},xa,i),t)?i[t]:i}function ea(r,e,t){var i=(0,b.U2)(r.get("origin"),"data",me),u=e.animation,c=Ja(e,i);if(u){var p=zi(u);p&&p(r,c,t)}else r.animate(t.toAttrs,c)}function Zo(r,e,t,i,u){if(lo[t]){var c=lo[t](i),p=zi((0,b.U2)(c,"animation",""));if(p){var g=(0,P.pi)((0,P.pi)((0,P.pi)({},xa.appear),c),e);r.stopAnimate(),p(r,g,{coordinate:i,minYPoint:u,toAttrs:null})}}}var Es="element-background",uu=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.labelShape=[],i.states=[];var u=t.shapeFactory,c=t.container,p=t.offscreenGroup,g=t.elementIndex,_=t.visible,S=_===void 0?!0:_;return i.shapeFactory=u,i.container=c,i.offscreenGroup=p,i.visible=S,i.elementIndex=g,i}return e.prototype.draw=function(t,i){i===void 0&&(i=!1),this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.drawShape(t,i),this.visible===!1&&this.changeVisible(!1)},e.prototype.update=function(t){var i=this,u=i.shapeFactory,c=i.shape;if(!!c){this.model=t,this.data=t.data,this.shapeType=this.getShapeType(t),this.setShapeInfo(c,t);var p=this.getOffscreenGroup(),g=u.drawShape(this.shapeType,t,p);g.cfg.data=this.data,g.cfg.origin=t,g.cfg.element=this,this.syncShapeStyle(c,g,this.getStates(),this.getAnimateCfg("update"))}},e.prototype.destroy=function(){var t=this,i=t.shapeFactory,u=t.shape;if(u){var c=this.getAnimateCfg("leave");c?ea(u,c,{coordinate:i.coordinate,toAttrs:(0,P.pi)({},u.attr())}):u.remove(!0)}this.states=[],this.shapeFactory=void 0,this.container=void 0,this.shape=void 0,this.animate=void 0,this.geometry=void 0,this.labelShape=[],this.model=void 0,this.data=void 0,this.offscreenGroup=void 0,this.statesStyle=void 0,r.prototype.destroy.call(this)},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t),t?(this.shape&&this.shape.show(),this.labelShape&&this.labelShape.forEach(function(i){i.show()})):(this.shape&&this.shape.hide(),this.labelShape&&this.labelShape.forEach(function(i){i.hide()}))},e.prototype.setState=function(t,i){var u=this,c=u.states,p=u.shapeFactory,g=u.model,_=u.shape,S=u.shapeType,k=c.indexOf(t);if(i){if(k>-1)return;c.push(t),(t==="active"||t==="selected")&&(_==null||_.toFront())}else{if(k===-1)return;if(c.splice(k,1),t==="active"||t==="selected"){var L=this.geometry,R=L.sortZIndex,U=L.zIndexReversed,G=U?this.geometry.elements.length-this.elementIndex:this.elementIndex;R?_.setZIndex(G):_.set("zIndex",G)}}var Q=p.drawShape(S,g,this.getOffscreenGroup());c.length?this.syncShapeStyle(_,Q,c,null):this.syncShapeStyle(_,Q,["reset"],null),Q.remove(!0);var pt={state:t,stateStatus:i,element:this,target:this.container};this.container.emit("statechange",pt),xl(this.shape,"statechange",pt)},e.prototype.clearStates=function(){var t=this,i=this.states;(0,b.S6)(i,function(u){t.setState(u,!1)}),this.states=[]},e.prototype.hasState=function(t){return this.states.includes(t)},e.prototype.getStates=function(){return this.states},e.prototype.getData=function(){return this.data},e.prototype.getModel=function(){return this.model},e.prototype.getBBox=function(){var t=this,i=t.shape,u=t.labelShape,c={x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0};return i&&(c=i.getCanvasBBox()),u&&u.forEach(function(p){var g=p.getCanvasBBox();c.x=Math.min(g.x,c.x),c.y=Math.min(g.y,c.y),c.minX=Math.min(g.minX,c.minX),c.minY=Math.min(g.minY,c.minY),c.maxX=Math.max(g.maxX,c.maxX),c.maxY=Math.max(g.maxY,c.maxY)}),c.width=c.maxX-c.minX,c.height=c.maxY-c.minY,c},e.prototype.getStatesStyle=function(){if(!this.statesStyle){var t=this,i=t.shapeType,u=t.geometry,c=t.shapeFactory,p=u.stateOption,g=c.defaultShapeType,_=c.theme[i]||c.theme[g];this.statesStyle=(0,b.b$)({},_,p)}return this.statesStyle},e.prototype.getStateStyle=function(t,i){var u=this.getStatesStyle(),c=(0,b.U2)(u,[t,"style"],{}),p=c[i]||c;return(0,b.mf)(p)?p(this):p},e.prototype.getAnimateCfg=function(t){var i=this,u=this.animate;if(u){var c=u[t];return c&&(0,P.pi)((0,P.pi)({},c),{callback:function(){var p;(0,b.mf)(c.callback)&&c.callback(),(p=i.geometry)===null||p===void 0||p.emit(rt.AFTER_DRAW_ANIMATE)}})}return null},e.prototype.drawShape=function(t,i){var u;i===void 0&&(i=!1);var c=this,p=c.shapeFactory,g=c.container,_=c.shapeType;if(this.shape=p.drawShape(_,t,g),this.shape){this.setShapeInfo(this.shape,t);var S=this.shape.cfg.name;S?(0,b.HD)(S)&&(this.shape.cfg.name=["element",S]):this.shape.cfg.name=["element",this.shapeFactory.geometryType];var k=i?"enter":"appear",L=this.getAnimateCfg(k);L&&((u=this.geometry)===null||u===void 0||u.emit(rt.BEFORE_DRAW_ANIMATE),ea(this.shape,L,{coordinate:p.coordinate,toAttrs:(0,P.pi)({},this.shape.attr())}))}},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.setShapeInfo=function(t,i){var u=this;if(t.cfg.origin=i,t.cfg.element=this,t.isGroup()){var c=t.get("children");c.forEach(function(p){u.setShapeInfo(p,i)})}},e.prototype.syncShapeStyle=function(t,i,u,c,p){var g=this,_;if(u===void 0&&(u=[]),p===void 0&&(p=0),!(!t||!i)){var S=t.get("clipShape"),k=i.get("clipShape");if(this.syncShapeStyle(S,k,u,c),t.isGroup())for(var L=t.get("children"),R=i.get("children"),U=0;U<L.length;U++)this.syncShapeStyle(L[U],R[U],u,c,p+U);else{if(!(0,b.xb)(u)&&!(0,b.Xy)(u,["reset"])){var G=t.get("name");(0,b.kJ)(G)&&(G=G[1]),(0,b.S6)(u,function(pt){if(i.get("name")!==Es){var yt=g.getStateStyle(pt,G||p);i.attr(yt)}})}var Q=X0(t,i);this.animate?c?((_=this.geometry)===null||_===void 0||_.emit(rt.BEFORE_DRAW_ANIMATE),ea(t,c,{coordinate:this.shapeFactory.coordinate,toAttrs:Q,shapeModel:this.model})):(0,b.xb)(u)?t.attr(Q):(t.stopAnimate(),t.animate(Q,{duration:300})):t.attr(Q)}}},e.prototype.getShapeType=function(t){var i=(0,b.U2)(t,"shape");return(0,b.kJ)(i)?i[0]:i},e}(Qt),Ws=uu,ks={},eu={};function Qu(r){return ks[r.toLowerCase()]}function lu(r,e){ks[r.toLowerCase()]=e}function Gl(r){return eu[r.toLowerCase()]}function us(r,e){eu[r.toLowerCase()]=e}var Hl={coordinate:null,defaultShapeType:null,theme:null,getShapePoints:function(r,e){var t=this.getShape(r);return t.getPoints?t.getPoints(e):this.getDefaultPoints(e)},getShape:function(r){var e=this[r]||this[this.defaultShapeType];return e.coordinate=this.coordinate,e},getDefaultPoints:function(){return[]},getDefaultStyle:function(r){return(0,b.U2)(r,[this.defaultShapeType,"default","style"],{})},getMarker:function(r,e){var t=this.getShape(r);if(!t.getMarker){var i=this.defaultShapeType;t=this.getShape(i)}var u=this.theme,c=(0,b.U2)(u,[r,"default"],{}),p=t.getMarker(e);return(0,b.b$)({},c,p)},drawShape:function(r,e,t){var i=this.getShape(r);return i.draw(e,t)}},mu={coordinate:null,parsePath:function(r){var e=this.coordinate,t=(0,rf.tr)(r);return e.isPolar?t=Tu(e,t):t=su(e,t),t},parsePoint:function(r){var e=this.coordinate;return e.convert(r)},parsePoints:function(r){var e=this.coordinate;return r.map(function(t){return e.convert(t)})},draw:function(r,e){}},cu={};function ro(r,e){var t=(0,b.jC)(r),i=(0,P.pi)((0,P.pi)((0,P.pi)({},Hl),e),{geometryType:r});return cu[t]=i,i}function va(r,e,t){var i=(0,b.jC)(r),u=cu[i],c=(0,P.pi)((0,P.pi)({},mu),t);return u[e]=c,c}function ts(r){var e=(0,b.jC)(r);return cu[e]}function Do(r,e,t){var i,u;if(t===void 0&&(t={}),!e)return[r];var c=(0,b.Ms)(r,e),p=[];if(e.length===1&&t[e[0]]){var g=t[e[0]];try{for(var _=(0,P.XA)(g),S=_.next();!S.done;S=_.next()){var k=S.value,L=c["_".concat(k)];L&&p.push(L)}}catch(G){i={error:G}}finally{try{S&&!S.done&&(u=_.return)&&u.call(_)}finally{if(i)throw i.error}}}else for(var R in c)if(c.hasOwnProperty(R)){var U=c[R];p.push(U)}return p}function jl(r,e){return(0,b.G)(["color","shape","size","x","y","isInCircle","data","style","defaultStyle","points","mappingData"],function(t){return!(0,b.Xy)(r[t],e[t])})}function Uu(r){return(0,b.kJ)(r)?r:r.split("*")}function ws(r,e){for(var t=[],i=[],u=[],c=new Map,p=0;p<e.length;p++){var g=e[p];r[g]?i.push(g):t.push(g),c.set(g,!0)}return Object.keys(r).forEach(function(_){c.has(_)||u.push(_)}),{added:t,updated:i,removed:u}}var Pu=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="base",i.attributes={},i.elements=[],i.elementsMap={},i.animateOption=!0,i.attributeOption={},i.lastElementsMap={},i.generatePoints=!1,i.beforeMappingData=null,i.adjusts={},i.idFields=[],i.hasSorted=!1,i.isCoordinateChanged=!1;var u=t.container,c=t.labelsContainer,p=t.coordinate,g=t.data,_=t.sortable,S=_===void 0?!1:_,k=t.visible,L=k===void 0?!0:k,R=t.theme,U=t.scales,G=U===void 0?{}:U,Q=t.scaleDefs,pt=Q===void 0?{}:Q,yt=t.intervalPadding,Ht=t.dodgePadding,ce=t.maxColumnWidth,he=t.minColumnWidth,ze=t.columnWidthRatio,Er=t.roseWidthRatio,Fr=t.multiplePieWidthRatio,zr=t.zIndexReversed,pn=t.sortZIndex,nn=t.useDeferredLabel;return i.container=u,i.labelsContainer=c,i.coordinate=p,i.data=g,i.sortable=S,i.visible=L,i.userTheme=R,i.scales=G,i.scaleDefs=pt,i.intervalPadding=yt,i.dodgePadding=Ht,i.maxColumnWidth=ce,i.minColumnWidth=he,i.columnWidthRatio=ze,i.roseWidthRatio=Er,i.multiplePieWidthRatio=Fr,i.zIndexReversed=zr,i.sortZIndex=pn,i.useDeferredLabel=nn?typeof nn=="number"?nn:1/0:null,i}return e.prototype.position=function(t){var i=t;(0,b.PO)(t)||(i={fields:Uu(t)});var u=(0,b.U2)(i,"fields");return u.length===1&&(u.unshift("1"),(0,b.t8)(i,"fields",u)),(0,b.t8)(this.attributeOption,"position",i),this},e.prototype.color=function(t,i){return this.createAttrOption("color",t,i),this},e.prototype.shape=function(t,i){return this.createAttrOption("shape",t,i),this},e.prototype.size=function(t,i){return this.createAttrOption("size",t,i),this},e.prototype.adjust=function(t){var i=t;return((0,b.HD)(t)||(0,b.PO)(t))&&(i=[t]),(0,b.S6)(i,function(u,c){(0,b.Kn)(u)||(i[c]={type:u})}),this.adjustOption=i,this},e.prototype.style=function(t,i){if((0,b.HD)(t)){var u=Uu(t);this.styleOption={fields:u,callback:i}}else{var c=t,u=c.fields,p=c.callback,g=c.cfg;u||p||g?this.styleOption=t:this.styleOption={cfg:t}}return this},e.prototype.tooltip=function(t,i){if((0,b.HD)(t)){var u=Uu(t);this.tooltipOption={fields:u,callback:i}}else this.tooltipOption=t;return this},e.prototype.animate=function(t){return this.animateOption=t,this},e.prototype.label=function(t,i,u){if((0,b.HD)(t)){var c={},p=Uu(t);c.fields=p,(0,b.mf)(i)?c.callback=i:(0,b.PO)(i)&&(c.cfg=i),u&&(c.cfg=u),this.labelOption=c}else this.labelOption=t;return this},e.prototype.state=function(t){return this.stateOption=t,this},e.prototype.customInfo=function(t){return this.customOption=t,this},e.prototype.init=function(t){t===void 0&&(t={}),this.setCfg(t),this.initAttributes(),this.processData(this.data),this.adjustScale()},e.prototype.update=function(t){t===void 0&&(t={});var i=t.data,u=t.isDataChanged,c=t.isCoordinateChanged,p=this,g=p.attributeOption,_=p.lastAttributeOption;(0,b.Xy)(g,_)?i&&(u||!(0,b.Xy)(i,this.data))?(this.setCfg(t),this.initAttributes(),this.processData(i)):this.setCfg(t):this.init(t),this.adjustScale(),this.isCoordinateChanged=c},e.prototype.paint=function(t){var i=this;t===void 0&&(t=!1),this.animateOption&&(this.animateOption=(0,b.b$)({},To(this.type,this.coordinate),this.animateOption)),this.defaultSize=void 0,this.elementsMap={},this.elements=[];var u=this.getOffscreenGroup();u.clear();var c=this.beforeMappingData,p=this.beforeMapping(c);this.dataArray=new Array(p.length);for(var g=0;g<p.length;g++){var _=p[g];this.dataArray[g]=this.mapping(_)}if(this.updateElements(this.dataArray,t),this.lastElementsMap=this.elementsMap,this.canDoGroupAnimation(t)){var S=this.container,k=this.type,L=this.coordinate,R=(0,b.U2)(this.animateOption,"appear"),U=this.getYScale(),G=L.convert({x:0,y:U.scale(this.getYMinValue())});Zo(S,R,k,L,G)}if(this.labelOption){var Q=this.useDeferredLabel,pt=function(){return i.renderLabels((0,b.xH)(i.dataArray),t)}.bind(this);if(typeof Q=="number"){var yt=typeof Q=="number"&&Q!==1/0?Q:0;if(!window.requestIdleCallback)setTimeout(pt,yt);else{var Ht=yt&&yt!==1/0?{timeout:yt}:void 0;window.requestIdleCallback(pt,Ht)}}else pt()}this.lastAttributeOption=(0,P.pi)({},this.attributeOption),this.visible===!1&&this.changeVisible(!1)},e.prototype.clear=function(){var t=this,i=t.container,u=t.geometryLabel,c=t.offscreenGroup;i&&i.clear(),u&&u.clear(),c&&c.clear(),this.scaleDefs=void 0,this.attributes={},this.scales={},this.elementsMap={},this.lastElementsMap={},this.elements=[],this.adjusts={},this.dataArray=null,this.beforeMappingData=null,this.lastAttributeOption=void 0,this.defaultSize=void 0,this.idFields=[],this.groupScales=void 0,this.hasSorted=!1,this.isCoordinateChanged=!1},e.prototype.destroy=function(){this.clear();var t=this.container;t.remove(!0),this.offscreenGroup&&(this.offscreenGroup.remove(!0),this.offscreenGroup=null),this.geometryLabel&&(this.geometryLabel.destroy(),this.geometryLabel=null),this.theme=void 0,this.shapeFactory=void 0,r.prototype.destroy.call(this)},e.prototype.getGroupScales=function(){return this.groupScales},e.prototype.getAttribute=function(t){return this.attributes[t]},e.prototype.getXScale=function(){return this.getAttribute("position").scales[0]},e.prototype.getYScale=function(){return this.getAttribute("position").scales[1]},e.prototype.getGroupAttributes=function(){var t=[];return(0,b.S6)(this.attributes,function(i){be.includes(i.type)&&t.push(i)}),t},e.prototype.getDefaultValue=function(t){var i,u=this.getAttribute(t);return u&&(0,b.xb)(u.scales)&&(i=u.values[0]),i},e.prototype.getAttributeValues=function(t,i){for(var u=[],c=t.scales,p=0,g=c.length;p<g;p++){var _=c[p],S=_.field;_.isIdentity?u.push(_.values):u.push(i[S])}return t.mapping.apply(t,(0,P.ev)([],(0,P.CR)(u),!1))},e.prototype.getAdjust=function(t){return this.adjusts[t]},e.prototype.getCoordinate=function(){return this.coordinate},e.prototype.getData=function(){return this.data},e.prototype.getShapeMarker=function(t,i){var u=this.getShapeFactory();return u.getMarker(t,i)},e.prototype.getElementsBy=function(t){return this.elements.filter(function(i){return t(i)})},e.prototype.getElements=function(){return this.elements},e.prototype.getElementId=function(t){t=(0,b.kJ)(t)?t[0]:t;var i=t[me];if(this.idFields.length){for(var u=i[this.idFields[0]],c=1;c<this.idFields.length;c++)u+="-"+i[this.idFields[c]];return u}var p=this.type,g=this.getXScale(),_=this.getYScale(),S=g.field||"x",k=_.field||"y",L=i[k],R;g.type==="identity"?R=g.values[0]:R=i[S];var U;p==="interval"||p==="schema"?U="".concat(R):p==="line"||p==="area"||p==="path"?U=p:U="".concat(R,"-").concat(L);for(var G=this.groupScales,c=0,Q=G.length;c<Q;c++){var pt=G[c],yt=pt.field;U="".concat(U,"-").concat(i[yt])}var Ht=this.getAdjust("dodge");if(Ht){var ce=Ht.dodgeBy;ce&&(U="".concat(U,"-").concat(i[ce]))}return this.getAdjust("jitter")&&(U="".concat(U,"-").concat(t.x,"-").concat(t.y)),U},e.prototype.getScaleFields=function(){var t=[],i=new Map,u=this,c=u.attributeOption,p=u.labelOption,g=u.tooltipOption;for(var _ in c)if(c.hasOwnProperty(_)){var S=c[_];S.fields?Th(S.fields,t,i):S.values&&Th(S.values,t,i)}return p&&p.fields&&Th(p.fields,t,i),(0,b.Kn)(g)&&g.fields&&Th(g.fields,t,i),t},e.prototype.changeVisible=function(t){r.prototype.changeVisible.call(this,t);for(var i=this.elements,u=0,c=i.length;u<c;u++){var p=i[u];p.changeVisible(t)}t?(this.container&&this.container.show(),this.labelsContainer&&this.labelsContainer.show()):(this.container&&this.container.hide(),this.labelsContainer&&this.labelsContainer.hide())},e.prototype.getFields=function(){var t=new Map,i=[];return Object.values(this.attributeOption).forEach(function(u){var c=(u==null?void 0:u.fields)||[];c.forEach(function(p){t.has(p)||i.push(p),t.set(p,!0)})},[]),i},e.prototype.getGroupFields=function(){for(var t=[],i=new Map,u=0,c=be.length;u<c;u++){var p=be[u],g=this.attributeOption[p];g&&g.fields&&Th(g.fields,t,i)}return t},e.prototype.getXYFields=function(){var t=(0,P.CR)(this.attributeOption.position.fields,2),i=t[0],u=t[1];return[i,u]},e.prototype.getXField=function(){return(0,b.U2)(this.getXYFields(),[0])},e.prototype.getYField=function(){return(0,b.U2)(this.getXYFields(),[1])},e.prototype.getShapes=function(){return this.elements.map(function(t){return t.shape})},e.prototype.getOffscreenGroup=function(){if(!this.offscreenGroup){var t=this.container.getGroupBase();this.offscreenGroup=new t({})}return this.offscreenGroup},e.prototype.sort=function(t){if(!this.hasSorted)for(var i=this.getXScale(),u=i.field,c=0;c<t.length;c++){var p=t[c];p.sort(function(g,_){return i.translate(g[me][u])-i.translate(_[me][u])})}this.hasSorted=!0},e.prototype.adjustScale=function(){var t=this.getYScale();t&&this.getAdjust("stack")&&this.updateStackRange(t,this.beforeMappingData)},e.prototype.getShapeFactory=function(){var t=this.shapeType;if(!!ts(t))return this.shapeFactory||(this.shapeFactory=(0,b.d9)(ts(t))),this.shapeFactory.coordinate=this.coordinate,this.shapeFactory.theme=this.theme.geometries[t]||{},this.shapeFactory},e.prototype.createShapePointsCfg=function(t){var i=this.getXScale(),u=this.getYScale(),c=this.normalizeValues(t[i.field],i),p;return u?p=this.normalizeValues(t[u.field],u):p=t.y?t.y:.1,{x:c,y:p,y0:u?u.scale(this.getYMinValue()):void 0}},e.prototype.createElement=function(t,i,u){u===void 0&&(u=!1);var c=this.container,p=this.getDrawCfg(t),g=this.getShapeFactory(),_=new Ws({shapeFactory:g,container:c,offscreenGroup:this.getOffscreenGroup(),elementIndex:i});return _.animate=this.animateOption,_.geometry=this,_.draw(p,u),_},e.prototype.getDrawCfg=function(t){var i=t[me],u={mappingData:t,data:i,x:t.x,y:t.y,color:t.color,size:t.size,isInCircle:this.coordinate.isPolar,customInfo:this.customOption},c=t.shape;!c&&this.getShapeFactory()&&(c=this.getShapeFactory().defaultShapeType),u.shape=c;var p=this.theme.geometries[this.shapeType];u.defaultStyle=(0,b.U2)(p,[c,"default"],{}).style,!u.defaultStyle&&this.getShapeFactory()&&(u.defaultStyle=this.getShapeFactory().getDefaultStyle(p));var g=this.styleOption;return g&&(u.style=this.getStyleCfg(g,i)),this.generatePoints&&(u.points=t.points,u.nextPoints=t.nextPoints),u},e.prototype.updateElements=function(t,i){var u,c,p,g,_,S;i===void 0&&(i=!1);for(var k=new Map,L=[],R=new Map,U=0,G=0;G<t.length;G++)for(var Q=t[G],pt=0;pt<Q.length;pt++){var yt=Q[pt],Ht=this.getElementId(yt),ce=k.has(Ht)?"".concat(Ht,"-").concat(G,"-").concat(pt):Ht;L.push(ce),k.set(ce,yt),R.set(ce,U),U++}this.elements=new Array(U);var he=ws(this.lastElementsMap,L),ze=he.added,Er=he.updated,Fr=he.removed;try{for(var zr=(0,P.XA)(ze),pn=zr.next();!pn.done;pn=zr.next()){var Ht=pn.value,yt=k.get(Ht),G=R.get(Ht),nn=this.createElement(yt,G,i);this.elements[G]=nn,this.elementsMap[Ht]=nn,nn.shape&&nn.shape.set("zIndex",this.zIndexReversed?this.elements.length-G:G)}}catch(Bi){u={error:Bi}}finally{try{pn&&!pn.done&&(c=zr.return)&&c.call(zr)}finally{if(u)throw u.error}}try{for(var Pn=(0,P.XA)(Er),wi=Pn.next();!wi.done;wi=Pn.next()){var Ht=wi.value,nn=this.lastElementsMap[Ht],yt=k.get(Ht),ha=this.getDrawCfg(yt),Sa=nn.getModel(),G=R.get(Ht);(this.isCoordinateChanged||jl(ha,Sa))&&(nn.animate=this.animateOption,nn.update(ha)),this.elements[G]=nn,this.elementsMap[Ht]=nn,nn.shape&&nn.shape.set("zIndex",this.zIndexReversed?this.elements.length-G:G)}}catch(Bi){p={error:Bi}}finally{try{wi&&!wi.done&&(g=Pn.return)&&g.call(Pn)}finally{if(p)throw p.error}}this.container&&this.container.sort();try{for(var _o=(0,P.XA)(Fr),Vn=_o.next();!Vn.done;Vn=_o.next()){var Ht=Vn.value,nn=this.lastElementsMap[Ht];nn.animate=this.animateOption,nn.destroy()}}catch(Bi){_={error:Bi}}finally{try{Vn&&!Vn.done&&(S=_o.return)&&S.call(_o)}finally{if(_)throw _.error}}},e.prototype.getLabelType=function(){var t=this,i=t.labelOption,u=t.coordinate,c=t.type,p=u.type,g=u.isTransposed,_=(0,b.U2)(i,["cfg","type"]);return _||(p==="polar"?_=g?"pie":"polar":p==="theta"?_="pie":c==="interval"||c==="polygon"?_="interval":_="base"),_},e.prototype.getYMinValue=function(){var t=this.getYScale(),i=t.min,u=t.max,c;return i>=0?c=i:u<=0?c=u:c=0,c},e.prototype.createAttrOption=function(t,i,u){if((0,b.UM)(i)||(0,b.Kn)(i))(0,b.Kn)(i)&&(0,b.Xy)(Object.keys(i),["values"])?(0,b.t8)(this.attributeOption,t,{fields:i.values}):(0,b.t8)(this.attributeOption,t,i);else{var c={};(0,b.hj)(i)?c.values=[i]:c.fields=Uu(i),u&&((0,b.mf)(u)?c.callback=u:c.values=u),(0,b.t8)(this.attributeOption,t,c)}},e.prototype.initAttributes=function(){var t=this,i=this,u=i.attributes,c=i.attributeOption,p=i.theme,g=i.shapeType;this.groupScales=[];var _={},S=function(R){if(c.hasOwnProperty(R)){var U=c[R];if(!U)return{value:void 0};var G=(0,P.pi)({},U),Q=G.callback,pt=G.values,yt=G.fields,Ht=yt===void 0?[]:yt,ce=Ht.map(function(ze){var Er=t.scales[ze];if(!_[ze]&&be.includes(R)){var Fr=dr(Er,(0,b.U2)(t.scaleDefs,ze),R,t.type);Fr==="cat"&&(t.groupScales.push(Er),_[ze]=!0)}return Er});G.scales=ce,R!=="position"&&ce.length===1&&ce[0].type==="identity"?G.values=ce[0].values:!Q&&!pt&&(R==="size"?G.values=p.sizes:R==="shape"?G.values=p.shapes[g]||[]:R==="color"&&(ce.length?G.values=ce[0].values.length<=10?p.colors10:p.colors20:G.values=p.colors10));var he=Ai(R);u[R]=new he(G)}};for(var k in c){var L=S(k);if(typeof L=="object")return L.value}},e.prototype.processData=function(t){var i,u;this.hasSorted=!1;for(var c=this.getAttribute("position").scales,p=c.filter(function(Fr){return Fr.isCategory}),g=this.groupData(t),_=[],S=0,k=g.length;S<k;S++){for(var L=g[S],R=[],U=0,G=L.length;U<G;U++){var Q=L[U],pt={};for(var yt in Q)pt[yt]=Q[yt];pt[me]=Q;try{for(var Ht=(i=void 0,(0,P.XA)(p)),ce=Ht.next();!ce.done;ce=Ht.next()){var he=ce.value,ze=he.field;pt[ze]=he.translate(pt[ze])}}catch(Fr){i={error:Fr}}finally{try{ce&&!ce.done&&(u=Ht.return)&&u.call(Ht)}finally{if(i)throw i.error}}R.push(pt)}_.push(R)}var Er=this.adjustData(_);return this.beforeMappingData=Er,Er},e.prototype.adjustData=function(t){var i=this.adjustOption,u=this,c=u.intervalPadding,p=u.dodgePadding,g=u.theme,_=this.maxColumnWidth||g.maxColumnWidth,S=this.minColumnWidth||g.minColumnWidth,k=this.columnWidthRatio||g.columnWidthRatio,L=t;if(i){var R=this.getXScale(),U=this.getYScale(),G=R.field,Q=U?U.field:null,pt=th(this.coordinate),yt=R.values.length,Ht=this.getAttribute("size"),ce=void 0;Ht&&(ce=Ht.values[0]);for(var he=0,ze=i.length;he<ze;he++){var Er=i[he],Fr=(0,P.pi)({xField:G,yField:Q,intervalPadding:c,dodgePadding:p,xDimensionLength:pt,groupNum:yt,defaultSize:ce,maxColumnWidth:_,minColumnWidth:S,columnWidthRatio:k},Er),zr=Er.type;if(zr==="dodge"){var pn=[];if(R.isCategory||R.type==="identity")pn.push("x");else if(!U)pn.push("y");else throw new Error("dodge is not support linear attribute, please use category attribute!");Fr.adjustNames=pn,Fr.dodgeRatio=k}else if(zr==="stack"){var nn=this.coordinate;if(!U){Fr.height=nn.getHeight();var Pn=this.getDefaultValue("size")||3;Fr.size=Pn}!nn.isTransposed&&(0,b.UM)(Fr.reverseOrder)&&(Fr.reverseOrder=!0)}var wi=$t(zr);Fr.dimValuesMap={},R&&R.values&&(Fr.dimValuesMap[R.field]=R.values.map(function(Sa){return R.translate(Sa)}));var ha=new wi(Fr);L=ha.process(L),this.adjusts[zr]=ha}}return L},e.prototype.groupData=function(t){for(var i=this.getGroupScales(),u=this.scaleDefs,c={},p=[],g=0;g<i.length;g++){var _=i[g],S=_.field;p.push(S),(0,b.U2)(u,[S,"values"])&&(c[S]=u[S].values)}return Do(t,p,c)},e.prototype.updateStackRange=function(t,i){for(var u=(0,b.xH)(i),c=t.field,p=t.min,g=t.max,_=0;_<u.length;_++){var S=u[_],k=Math.min.apply(null,S[c]),L=Math.max.apply(null,S[c]);k<p&&(p=k),L>g&&(g=L)}var R=this.scaleDefs,U={};p<t.min&&!(0,b.U2)(R,[c,"min"])&&(U.min=p),g>t.max&&!(0,b.U2)(R,[c,"max"])&&(U.max=g),t.change(U)},e.prototype.beforeMapping=function(t){var i=t;if(this.sortable&&this.sort(i),this.generatePoints)for(var u=0,c=i.length;u<c;u++){var p=i[u];this.generateShapePoints(p);var g=i[u+1];g&&(this.generateShapePoints(g),p[0].nextPoints=g[0].points)}return i},e.prototype.generateShapePoints=function(t){for(var i=this.getShapeFactory(),u=this.getAttribute("shape"),c=0;c<t.length;c++){var p=t[c],g=this.createShapePointsCfg(p),_=u?this.getAttributeValues(u,p):null,S=i.getShapePoints(_,g);p.points=S}},e.prototype.normalizeValues=function(t,i){var u=[];if((0,b.kJ)(t))for(var c=0;c<t.length;c++){var p=t[c];u.push(i.scale(p))}else u=i.scale(t);return u},e.prototype.mapping=function(t){for(var i=this.attributes,u=[],c=0;c<t.length;c++){var p=t[c],g={_origin:p[me],points:p.points,nextPoints:p.nextPoints};for(var _ in i)if(i.hasOwnProperty(_)){var S=i[_],k=S.names,L=this.getAttributeValues(S,p);if(k.length>1)for(var R=0;R<L.length;R+=1){var U=L[R],G=k[R];g[G]=(0,b.kJ)(U)&&U.length===1?U[0]:U}else g[k[0]]=L.length===1?L[0]:L}this.convertPoint(g),u.push(g)}return u},e.prototype.convertPoint=function(t){var i=t.x,u=t.y,c,p,g,_=this.coordinate;if((0,b.kJ)(i)&&(0,b.kJ)(u)){c=[],p=[];for(var S=0,k=0,L=i.length,R=u.length;S<L&&k<R;S+=1,k+=1)g=_.convert({x:i[S],y:u[k]}),c.push(g.x),p.push(g.y)}else if((0,b.kJ)(u)){p=[];for(var U=0;U<u.length;U++){var G=u[U];g=_.convert({x:i,y:G}),c&&c!==g.x?((0,b.kJ)(c)||(c=[c]),c.push(g.x)):c=g.x,p.push(g.y)}}else if((0,b.kJ)(i)){c=[];for(var U=0;U<i.length;U++){var Q=i[U];g=_.convert({x:Q,y:u}),p&&p!==g.y?((0,b.kJ)(p)||(p=[p]),p.push(g.y)):p=g.y,c.push(g.x)}}else{var pt=_.convert({x:i,y:u});c=pt.x,p=pt.y}t.x=c,t.y=p},e.prototype.getStyleCfg=function(t,i){var u=t.fields,c=u===void 0?[]:u,p=t.callback,g=t.cfg;if(g)return g;var _=c.map(function(S){return i[S]});return p.apply(void 0,(0,P.ev)([],(0,P.CR)(_),!1))},e.prototype.setCfg=function(t){var i=this,u=t.coordinate,c=t.data,p=t.theme,g=t.scaleDefs;u&&(this.coordinate=u),c&&(this.data=c),g&&(this.scaleDefs=g,this.idFields=[],(0,b.S6)(g,function(_,S){_&&_.key&&i.idFields.push(S)})),p&&(this.theme=this.userTheme?(0,b.b$)({},p,this.userTheme):p)},e.prototype.renderLabels=function(t,i){return i===void 0&&(i=!1),(0,P.mG)(this,void 0,void 0,function(){var u,c,p,g,_,S,k,L,R,U,G,Q,pt=this;return(0,P.Jh)(this,function(yt){switch(yt.label){case 0:return u=this.geometryLabel,this.emit(rt.BEFORE_RENDER_LABEL),u||(c=this.getLabelType(),p=Qu(c),u=new p(this),this.geometryLabel=u),[4,u.render(t,i)];case 1:yt.sent(),g=u.labelsRenderer.shapesMap,_=new Map,(0,b.S6)(g,function(Ht,ce){for(var he=Ht.getChildren()||[],ze=0;ze<he.length;ze++){var Er=he[ze],Fr=pt.elementsMap[Er.get("elementId")||ce.split(" ")[0]];if(Fr){Er.cfg.name=["element","label"],Er.cfg.element=Fr;var zr=_.get(Fr)||new Set;zr.add(Ht),_.set(Fr,zr)}}});try{for(S=(0,P.XA)(_.entries()),k=S.next();!k.done;k=S.next())L=(0,P.CR)(k.value,2),R=L[0],U=L[1],R.labelShape=(0,P.ev)([],(0,P.CR)(U),!1)}catch(Ht){G={error:Ht}}finally{try{k&&!k.done&&(Q=S.return)&&Q.call(S)}finally{if(G)throw G.error}}return this.emit(rt.AFTER_RENDER_LABEL),[2]}})})},e.prototype.canDoGroupAnimation=function(t){return!t&&this.animateOption&&((0,b.U2)(this.animateOption,"appear")===void 0||(0,b.U2)(this.animateOption,"appear")&&(0,b.U2)(this.animateOption,["appear","animation"])===void 0)},e}(Qt),fu=Pu,Oo=ma.vs;function cf(r,e,t){var i=Oo(r.getMatrix(),[["t",e,t]]);r.setMatrix(i)}function ff(r,e){var t=r.attr(),i=t.x,u=t.y,c=Oo(r.getMatrix(),[["t",-i,-u],["r",e],["t",i,u]]);return c}function nh(r,e){var t=ff(r,e);r.setMatrix(t)}function ru(){return[1,0,0,0,1,0,0,0,1]}function kh(r,e){var t=r.getBBox(),i=(t.minX+t.maxX)/2,u=(t.minY+t.maxY)/2;r.applyToMatrix([i,u,1]);var c=Oo(r.getMatrix(),[["t",-i,-u],["s",e,e],["t",i,u]]);r.setMatrix(c)}function fl(r){return r.find(function(e){return e.get("type")==="text"})}function Qp(r,e,t){t===void 0&&(t=[0,0,0,0]);var i=r&&r.getChildren()[0];if(i){var u=i.clone();e!=null&&e.rotate&&nh(u,-e.rotate);var c=u.getCanvasBBox(),p=c.x,g=c.y,_=c.width,S=c.height;u.destroy();var k=t;return(0,b.UM)(k)?k=[2,2,2,2]:(0,b.hj)(k)&&(k=new Array(4).fill(k)),{x:p-k[3],y:g-k[0],width:_+k[1]+k[3],height:S+k[0]+k[2],rotation:(e==null?void 0:e.rotate)||0}}return{x:0,y:0,width:0,height:0,rotation:0}}function Pl(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),u=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*u}function Lf(r,e){var t=r.getBBox();return(0,b.G)(e,function(i){var u=i.getBBox();return Pl(t,u,2)>0})}function ih(r,e,t){var i=t.data,u=t.origin,c=t.animateCfg,p=t.coordinate,g=(0,b.U2)(c,"update");r.set("data",i),r.set("origin",u),r.set("animateCfg",c),r.set("coordinate",p),r.set("visible",e.get("visible")),(r.getChildren()||[]).forEach(function(_,S){var k=e.getChildByIndex(S);if(!k)r.removeChild(_),_.remove(!0);else{_.set("data",i),_.set("origin",u),_.set("animateCfg",c),_.set("coordinate",p);var L=X0(_,k);g?ea(_,g,{toAttrs:L,coordinate:p}):_.attr(L),k.isGroup()&&ih(_,k,t)}}),(0,b.S6)(e.getChildren(),function(_,S){S>=r.getCount()&&(_.destroyed||r.add(_))})}var Nd=function(){function r(e){this.shapesMap={};var t=e.layout,i=e.container;this.layout=t,this.container=i}return r.prototype.render=function(e,t,i){return i===void 0&&(i=!1),(0,P.mG)(this,void 0,void 0,function(){var u,c,p,g,_,S,k,L,R=this;return(0,P.Jh)(this,function(U){switch(U.label){case 0:if(u={},c=this.createOffscreenGroup(),!e.length)return[3,2];try{for(p=(0,P.XA)(e),g=p.next();!g.done;g=p.next())_=g.value,_&&(u[_.id]=this.renderLabel(_,c))}catch(G){k={error:G}}finally{try{g&&!g.done&&(L=p.return)&&L.call(p)}finally{if(k)throw k.error}}return[4,this.doLayout(e,t,u)];case 1:U.sent(),this.renderLabelLine(e,u),this.renderLabelBackground(e,u),this.adjustLabel(e,u),U.label=2;case 2:return S=this.shapesMap,(0,b.S6)(u,function(G,Q){if(G.destroyed)delete u[Q];else{if(S[Q]){var pt=G.get("data"),yt=G.get("origin"),Ht=G.get("coordinate"),ce=G.get("animateCfg"),he=S[Q];ih(he,u[Q],{data:pt,origin:yt,animateCfg:ce,coordinate:Ht}),u[Q]=he}else{if(R.container.destroyed)return;R.container.add(G);var ze=(0,b.U2)(G.get("animateCfg"),i?"enter":"appear");ze&&ea(G,ze,{toAttrs:(0,P.pi)({},G.attr()),coordinate:G.get("coordinate")})}delete S[Q]}}),(0,b.S6)(S,function(G){var Q=(0,b.U2)(G.get("animateCfg"),"leave");Q?ea(G,Q,{toAttrs:null,coordinate:G.get("coordinate")}):G.remove(!0)}),this.shapesMap=u,c.destroy(),[2]}})})},r.prototype.clear=function(){this.container.clear(),this.shapesMap={}},r.prototype.destroy=function(){this.container.destroy(),this.shapesMap=null},r.prototype.renderLabel=function(e,t){var i=e.id,u=e.elementId,c=e.data,p=e.mappingData,g=e.coordinate,_=e.animate,S=e.content,k=e.capture,L={id:i,elementId:u,capture:k,data:c,origin:(0,P.pi)((0,P.pi)({},p),{data:p[me]}),coordinate:g},R=t.addGroup((0,P.pi)({name:"label",animateCfg:this.animate===!1||_===null||_===!1?!1:(0,b.b$)({},this.animate,_)},L)),U;if(S.isGroup&&S.isGroup()||S.isShape&&S.isShape()){var G=S.getCanvasBBox(),Q=G.width,pt=G.height,yt=(0,b.U2)(e,"textAlign","left"),Ht=e.x,ce=e.y-pt/2;yt==="center"?Ht=Ht-Q/2:(yt==="right"||yt==="end")&&(Ht=Ht-Q),cf(S,Ht,ce),U=S,R.add(S)}else{var he=(0,b.U2)(e,["style","fill"]);U=R.addShape("text",(0,P.pi)({attrs:(0,P.pi)((0,P.pi)({x:e.x,y:e.y,textAlign:e.textAlign,textBaseline:(0,b.U2)(e,"textBaseline","middle"),text:e.content},e.style),{fill:(0,b.Ft)(he)?e.color:he})},L))}return e.rotate&&nh(U,e.rotate),R},r.prototype.doLayout=function(e,t,i){return(0,P.mG)(this,void 0,void 0,function(){var u,c=this;return(0,P.Jh)(this,function(p){switch(p.label){case 0:return this.layout?(u=(0,b.kJ)(this.layout)?this.layout:[this.layout],[4,Promise.all(u.map(function(g){var _=Gl((0,b.U2)(g,"type",""));if(!!_){var S=[],k=[];return(0,b.S6)(i,function(L,R){S.push(L),k.push(t[L.get("elementId")])}),_(e,S,k,c.region,g.cfg)}}))]):[3,2];case 1:p.sent(),p.label=2;case 2:return[2]}})})},r.prototype.renderLabelLine=function(e,t){(0,b.S6)(e,function(i){var u=(0,b.U2)(i,"coordinate");if(!(!i||!u)){var c=u.getCenter(),p=u.getRadius();if(!!i.labelLine){var g=(0,b.U2)(i,"labelLine",{}),_=i.id,S=g.path;if(!S){var k=co(c.x,c.y,p,i.angle);S=[["M",k.x,k.y],["L",i.x,i.y]]}var L=t[_];L.destroyed||L.addShape("path",{capture:!1,attrs:(0,P.pi)({path:S,stroke:i.color?i.color:(0,b.U2)(i,["style","fill"],"#000"),fill:null},g.style),id:_,origin:i.mappingData,data:i.data,coordinate:i.coordinate})}}})},r.prototype.renderLabelBackground=function(e,t){(0,b.S6)(e,function(i){var u=(0,b.U2)(i,"coordinate"),c=(0,b.U2)(i,"background");if(!(!c||!u)){var p=i.id,g=t[p];if(!g.destroyed){var _=g.getChildren()[0];if(_){var S=Qp(g,i,c.padding),k=S.rotation,L=(0,P._T)(S,["rotation"]),R=g.addShape("rect",{attrs:(0,P.pi)((0,P.pi)({},L),c.style||{}),id:p,origin:i.mappingData,data:i.data,coordinate:i.coordinate});if(R.setZIndex(-1),k){var U=_.getMatrix();R.setMatrix(U)}}}}})},r.prototype.createOffscreenGroup=function(){var e=this.container,t=e.getGroupBase(),i=new t({});return i},r.prototype.adjustLabel=function(e,t){(0,b.S6)(e,function(i){if(i){var u=i.id,c=t[u];if(!c.destroyed){var p=c.findAll(function(g){return g.get("type")!=="path"});(0,b.S6)(p,function(g){g&&(i.offsetX&&g.attr("x",g.attr("x")+i.offsetX),i.offsetY&&g.attr("y",g.attr("y")+i.offsetY))})}}})},r}(),a0=Nd;function fp(r){var e=0;return(0,b.S6)(r,function(t){e+=t}),e/r.length}var yv=function(){function r(e){this.geometry=e}return r.prototype.getLabelItems=function(e){var t=this,i=[],u=this.getLabelCfgs(e);return(0,b.S6)(e,function(c,p){var g=u[p];if(!g||(0,b.UM)(c.x)||(0,b.UM)(c.y)){i.push(null);return}var _=(0,b.kJ)(g.content)?g.content:[g.content];g.content=_;var S=_.length;(0,b.S6)(_,function(k,L){if((0,b.UM)(k)||k===""){i.push(null);return}var R=(0,P.pi)((0,P.pi)({},g),t.getLabelPoint(g,c,L));R.textAlign||(R.textAlign=t.getLabelAlign(R,L,S)),R.offset<=0&&(R.labelLine=null),i.push(R)})}),i},r.prototype.render=function(e,t){return t===void 0&&(t=!1),(0,P.mG)(this,void 0,void 0,function(){var i,u,c;return(0,P.Jh)(this,function(p){switch(p.label){case 0:return i=this.getLabelItems(e),u=this.getLabelsRenderer(),c=this.getGeometryShapes(),[4,u.render(i,c,t)];case 1:return p.sent(),[2]}})})},r.prototype.clear=function(){var e=this.labelsRenderer;e&&e.clear()},r.prototype.destroy=function(){var e=this.labelsRenderer;e&&e.destroy(),this.labelsRenderer=null},r.prototype.getCoordinate=function(){return this.geometry.coordinate},r.prototype.getDefaultLabelCfg=function(e,t){var i=this.geometry,u=i.type,c=i.theme;return u==="polygon"||u==="interval"&&t==="middle"||e<0&&!["line","point","path"].includes(u)?(0,b.U2)(c,"innerLabels",{}):(0,b.U2)(c,"labels",{})},r.prototype.getThemedLabelCfg=function(e){var t=this.geometry,i=this.getDefaultLabelCfg(),u=t.type,c=t.theme,p;return u==="polygon"||e.offset<0&&!["line","point","path"].includes(u)?p=(0,b.b$)({},i,c.innerLabels,e):p=(0,b.b$)({},i,c.labels,e),p},r.prototype.setLabelPosition=function(e,t,i,u){},r.prototype.getLabelOffset=function(e){var t=this.getCoordinate(),i=this.getOffsetVector(e);return t.isTransposed?i[0]:i[1]},r.prototype.getLabelOffsetPoint=function(e,t,i){var u=e.offset,c=this.getCoordinate(),p=c.isTransposed,g=p?"x":"y",_=p?1:-1,S={x:0,y:0};return t>0||i===1?S[g]=u*_:S[g]=u*_*-1,S},r.prototype.getLabelPoint=function(e,t,i){var u=this.getCoordinate(),c=e.content.length;function p(pt,yt,Ht){Ht===void 0&&(Ht=!1);var ce=pt;return(0,b.kJ)(ce)&&(e.content.length===1?Ht?ce=fp(ce):ce.length<=2?ce=ce[pt.length-1]:ce=fp(ce):ce=ce[yt]),ce}var g={content:e.content[i],x:0,y:0,start:{x:0,y:0},color:"#fff"},_=(0,b.kJ)(t.shape)?t.shape[0]:t.shape,S=_==="funnel"||_==="pyramid";if(this.geometry.type==="polygon"){var k=Bd(t.x,t.y);g.x=k[0],g.y=k[1]}else this.geometry.type==="interval"&&!S?(g.x=p(t.x,i,!0),g.y=p(t.y,i)):(g.x=p(t.x,i),g.y=p(t.y,i));if(S){var L=(0,b.U2)(t,"nextPoints"),R=(0,b.U2)(t,"points");if(L){var U=u.convert(R[1]),G=u.convert(L[1]);g.x=(U.x+G.x)/2,g.y=(U.y+G.y)/2}else if(_==="pyramid"){var U=u.convert(R[1]),G=u.convert(R[2]);g.x=(U.x+G.x)/2,g.y=(U.y+G.y)/2}}e.position&&this.setLabelPosition(g,t,i,e.position);var Q=this.getLabelOffsetPoint(e,i,c);return g.start={x:g.x,y:g.y},g.x+=Q.x,g.y+=Q.y,g.color=t.color,g},r.prototype.getLabelAlign=function(e,t,i){var u="center",c=this.getCoordinate();if(c.isTransposed){var p=e.offset;p<0?u="right":p===0?u="center":u="left",i>1&&t===0&&(u==="right"?u="left":u==="left"&&(u="right"))}return u},r.prototype.getLabelId=function(e){var t=this.geometry,i=t.type,u=t.getXScale(),c=t.getYScale(),p=e[me],g=t.getElementId(e);return i==="line"||i==="area"?g+=" ".concat(p[u.field]):i==="path"&&(g+=" ".concat(p[u.field],"-").concat(p[c.field])),g},r.prototype.getLabelsRenderer=function(){var e=this.geometry,t=e.labelsContainer,i=e.labelOption,u=e.canvasRegion,c=e.animateOption,p=this.geometry.coordinate,g=this.labelsRenderer;return g||(g=new a0({container:t,layout:(0,b.U2)(i,["cfg","layout"],{type:this.defaultLayout})}),this.labelsRenderer=g),g.region=u,g.animate=c?To("label",p):!1,g},r.prototype.getLabelCfgs=function(e){var t=this,i=this.geometry,u=i.labelOption,c=i.scales,p=i.coordinate,g=u,_=g.fields,S=g.callback,k=g.cfg,L=_.map(function(U){return c[U]}),R=[];return(0,b.S6)(e,function(U,G){var Q=U[me],pt=t.getLabelText(Q,L),yt;if(S){var Ht=_.map(function(Fr){return Q[Fr]});if(yt=S.apply(void 0,(0,P.ev)([],(0,P.CR)(Ht),!1)),(0,b.UM)(yt)){R.push(null);return}}var ce=(0,P.pi)((0,P.pi)({id:t.getLabelId(U),elementId:t.geometry.getElementId(U),data:Q,mappingData:U,coordinate:p},k),yt);(0,b.mf)(ce.position)&&(ce.position=ce.position(Q,U,G));var he=t.getLabelOffset(ce.offset||0),ze=t.getDefaultLabelCfg(he,ce.position);ce=(0,b.b$)({},ze,ce),ce.offset=t.getLabelOffset(ce.offset||0);var Er=ce.content;(0,b.mf)(Er)?ce.content=Er(Q,U,G):(0,b.o8)(Er)&&(ce.content=pt[0]),R.push(ce)}),R},r.prototype.getLabelText=function(e,t){var i=[];return(0,b.S6)(t,function(u){var c=e[u.field];(0,b.kJ)(c)?c=c.map(function(p){return u.getText(p)}):c=u.getText(c),(0,b.UM)(c)||c===""?i.push(null):i.push(c)}),i},r.prototype.getOffsetVector=function(e){e===void 0&&(e=0);var t=this.getCoordinate(),i=0;return(0,b.hj)(e)&&(i=e),t.isTransposed?t.applyMatrix(i,0):t.applyMatrix(0,i)},r.prototype.getGeometryShapes=function(){var e=this.geometry,t={};return(0,b.S6)(e.elementsMap,function(i,u){t[u]=i.shape}),(0,b.S6)(e.getOffscreenGroup().getChildren(),function(i){var u=e.getElementId(i.get("origin").mappingData);t[u]=i}),t},r}(),zd=yv;function _v(r,e,t){if(!r)return t;var i;if(r.callback&&r.callback.length>1){var u=Array(r.callback.length-1).fill("");i=r.mapping.apply(r,(0,P.ev)([e],(0,P.CR)(u),!1)).join("")}else i=r.mapping(e).join("");return i||t}var yc={hexagon:function(r,e,t){var i=t/2*Math.sqrt(3);return[["M",r,e-t],["L",r+i,e-t/2],["L",r+i,e+t/2],["L",r,e+t],["L",r-i,e+t/2],["L",r-i,e-t/2],["Z"]]},bowtie:function(r,e,t){var i=t-1.5;return[["M",r-t,e-i],["L",r+t,e+i],["L",r+t,e-i],["L",r-t,e+i],["Z"]]},cross:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e+t],["M",r+t,e-t],["L",r-t,e+t]]},tick:function(r,e,t){return[["M",r-t/2,e-t],["L",r+t/2,e-t],["M",r,e-t],["L",r,e+t],["M",r-t/2,e+t],["L",r+t/2,e+t]]},plus:function(r,e,t){return[["M",r-t,e],["L",r+t,e],["M",r,e-t],["L",r,e+t]]},hyphen:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},line:function(r,e,t){return[["M",r,e-t],["L",r,e+t]]}},hp=["line","cross","tick","plus","hyphen"];function Zu(r,e){return(0,b.mf)(e)?e(r):(0,b.b$)({},r,e)}function pp(r,e){var t=r.symbol;if((0,b.HD)(t)&&hp.indexOf(t)!==-1){var i=(0,b.U2)(r,"style",{}),u=(0,b.U2)(i,"lineWidth",1),c=i.stroke||i.fill||e;r.style=(0,b.b$)({},r.style,{lineWidth:u,stroke:c,fill:null})}}function Jp(r){var e=r.symbol;(0,b.HD)(e)&&yc[e]&&(r.symbol=yc[e])}function Ud(r){return r.startsWith(le.LEFT)||r.startsWith(le.RIGHT)?"vertical":"horizontal"}function Zd(r,e,t,i,u){var c=t.getScale(t.type);if(c.isCategory){var p=c.field,g=e.getAttribute("color"),_=e.getAttribute("shape"),S=r.getTheme().defaultColor,k=e.coordinate.isPolar;return c.getTicks().map(function(L,R){var U,G=L.text,Q=L.value,pt=G,yt=c.invert(Q),Ht=r.filterFieldData(p,[(U={},U[p]=yt,U)]).length===0;(0,b.S6)(r.views,function(Fr){var zr;Fr.filterFieldData(p,[(zr={},zr[p]=yt,zr)]).length||(Ht=!0)});var ce=_v(g,yt,S),he=_v(_,yt,"point"),ze=e.getShapeMarker(he,{color:ce,isInPolar:k}),Er=u;return(0,b.mf)(Er)&&(Er=Er(pt,R,(0,P.pi)({name:pt,value:yt},(0,b.b$)({},i,ze)))),ze=(0,b.b$)({},i,ze,ic((0,P.pi)({},Er),["style"])),pp(ze,ce),Er&&Er.style&&(ze.style=Zu(ze.style,Er.style)),Jp(ze),{id:yt,name:pt,value:yt,marker:ze,unchecked:Ht}})}return[]}function xv(r,e,t){return t.map(function(i,u){var c=e;(0,b.mf)(c)&&(c=c(i.name,u,(0,b.b$)({},r,i)));var p=(0,b.mf)(i.marker)?i.marker(i.name,u,(0,b.b$)({},r,i)):i.marker,g=(0,b.b$)({},r,c,p);return Jp(g),i.marker=g,i})}function bv(r,e){var t=(0,b.U2)(r,["components","legend"],{});return(0,b.b$)({},(0,b.U2)(t,["common"],{}),(0,b.b$)({},(0,b.U2)(t,[e],{})))}function Ev(r){return r?!1:r==null||isNaN(r)}function wv(r){if((0,b.kJ)(r))return Ev(r[1].y);var e=r.y;return(0,b.kJ)(e)?Ev(e[0]):Ev(e)}function td(r,e,t){if(e===void 0&&(e=!1),t===void 0&&(t=!0),!r.length||r.length===1&&!t)return[];if(e){for(var i=[],u=0,c=r.length;u<c;u++){var p=r[u];wv(p)||i.push(p)}return[i]}for(var g=[],_=[],u=0,c=r.length;u<c;u++){var p=r[u];wv(p)?_.length&&(_.length===1&&!t||g.push(_),_=[]):_.push(p)}return _.length&&g.push(_),g}function Sv(r){for(var e=[],t=0;t<r.length;t++){var i=r[t];if(i){var u=t===0?"M":"L";e.push([u,i.x,i.y])}}var c=r[0];return c&&(e.push(["L",c.x,c.y]),e.push(["z"])),e}function o0(r){for(var e=r.length/2,t=[],i=[],u=0;u<r.length;u++)u<e?t.push(r[u]):i.push(r[u]);var c=Qs(t,!1),p=Qs(i,!1);i.length&&c.push(["L",i[0].x,i[0].y]),p.shift();var g=c.concat(p);return t.length&&g.push(["L",t[0].x,t[0].y]),g.push(["z"]),g}function Us(r,e,t,i){i===void 0&&(i="");var u=r.style,c=u===void 0?{}:u,p=r.defaultStyle,g=r.color,_=r.size,S=(0,P.pi)((0,P.pi)({},p),c);return g&&(e&&(c.stroke||(S.stroke=g)),t&&(c.fill||(S.fill=g))),i&&(0,b.UM)(c[i])&&!(0,b.UM)(_)&&(S[i]=_),S}function Jt(r){return(0,b.b$)({},{fill:"#CCD6EC",fillOpacity:.3},(0,b.U2)(r,["background","style"]))}function dp(r){var e=r.x,t=(0,b.kJ)(r.y)?r.y:[r.y];return t.map(function(i,u){return{x:(0,b.kJ)(e)?e[u]:e,y:i}})}var Cv={line:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},dot:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},dash:function(r,e,t){return[["M",r-t,e],["L",r+t,e]]},smooth:function(r,e,t){return[["M",r-t,e],["A",t/2,t/2,0,1,1,r,e],["A",t/2,t/2,0,1,0,r+t,e]]},hv:function(r,e,t){return[["M",r-t-1,e-2.5],["L",r,e-2.5],["L",r,e+2.5],["L",r+t+1,e+2.5]]},vh:function(r,e,t){return[["M",r-t-1,e+2.5],["L",r,e+2.5],["L",r,e-2.5],["L",r+t+1,e-2.5]]},hvh:function(r,e,t){return[["M",r-(t+1),e+2.5],["L",r-t/2,e+2.5],["L",r-t/2,e-2.5],["L",r+t/2,e-2.5],["L",r+t/2,e+2.5],["L",r+t+1,e+2.5]]},vhv:function(r,e){return[["M",r-5,e+2.5],["L",r-5,e],["L",r,e],["L",r,e-3],["L",r,e+3],["L",r+6.5,e+3]]}};function vp(r,e){var t=r.color;return{symbol:Cv[e],style:{lineWidth:2,r:6,stroke:t}}}function Av(r,e,t){for(var i=r.isStack,u=r.connectNulls,c=r.isInCircle,p=r.showSinglePoint,g=Us(r,!0,!1,"lineWidth"),_=td(r.points,u,p),S=[],k=0,L=_.length;k<L;k++){var R=_[k];S=S.concat(Q0(R,c,i,e,t,g))}return g.path=S,g}function gp(r,e,t,i,u){if(r.length===1)return[["M",r[0].x,r[0].y-u.lineWidth/2],["L",r[0].x,r[0].y],["L",r[0].x,r[0].y+u.lineWidth/2]];var c;return t?(e&&r.length&&r.push({x:r[0].x,y:r[0].y}),c=Qs(r,!1,i)):(c=Xo(r,!1),e&&c.push(["Z"])),c}function K0(r,e,t,i,u,c){var p=[],g=[];(0,b.S6)(r,function(k){var L=dp(k);p.push(L[1]),g.push(L[0])});var _=gp(p,e,i,u,c),S=gp(g,e,i,u,c);return t?_:_.concat(S)}function Q0(r,e,t,i,u,c){if(r.length){var p=r[0];return(0,b.kJ)(p.y)?K0(r,e,t,i,u,c):gp(r,e,i,u,c)}return[]}var ed=ro("line",{defaultShapeType:"line"});(0,b.S6)(["line","dot","dash","smooth"],function(r){va("line",r,{draw:function(e,t){var i=r==="smooth",u;if(i){var c=this.coordinate,p=c.start,g=c.end;u=[[p.x,g.y],[g.x,p.y]]}var _=Av(e,i,u),S=t.addShape({type:"path",attrs:_,name:"line",capture:!i});return S},getMarker:function(e){return vp(e,r)}})});var Wm=null,Hg="4.2.8",_c={getLegendItems:Zd,translate:cf,rotate:nh,zoom:kh,transform:Oo,getAngle:Xp,getSectorPath:gu,polarToCartesian:co,getDelegationObject:La,getTooltipItems:Lu,getMappingValue:_v,getPath:Q0,getPathPoints:td},hf={100:"#000",95:"#0D0D0D",85:"#262626",65:"#595959",45:"#8C8C8C",25:"#BFBFBF",15:"#D9D9D9",6:"#F0F0F0"},Va={100:"#FFFFFF",95:"#F2F2F2",85:"#D9D9D9",65:"#A6A6A6",45:"#737373",25:"#404040",15:"#262626",6:"#0F0F0F"},Ju=["#5B8FF9","#5AD8A6","#5D7092","#F6BD16","#E86452","#6DC8EC","#945FB9","#FF9845","#1E9493","#FF99C3"],Y_=["#5B8FF9","#CDDDFD","#5AD8A6","#CDF3E4","#5D7092","#CED4DE","#F6BD16","#FCEBB9","#E86452","#F8D0CB","#6DC8EC","#D3EEF9","#945FB9","#DECFEA","#FF9845","#FFE0C7","#1E9493","#BBDEDE","#FF99C3","#FFE0ED"],mp=["#B8E1FF","#9AC5FF","#7DAAFF","#5B8FF9","#3D76DD","#085EC0","#0047A5","#00318A","#001D70"],J0=function(r){r===void 0&&(r={});var e=r.paletteQualitative10,t=e===void 0?Ju:e,i=r.paletteQualitative20,u=i===void 0?Y_:i,c=r.brandColor,p=c===void 0?t[0]:c,g={backgroundColor:"#141414",brandColor:p,subColor:"rgba(255,255,255,0.05)",paletteQualitative10:t,paletteQualitative20:u,paletteSemanticRed:"#F4664A",paletteSemanticGreen:"#30BF78",paletteSemanticYellow:"#FAAD14",paletteSequence:mp,fontFamily:`"Segoe UI", Roboto, "Helvetica Neue", Arial,
    "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji"`,axisLineBorderColor:Va[25],axisLineBorder:1,axisLineDash:null,axisTitleTextFillColor:Va[65],axisTitleTextFontSize:12,axisTitleTextLineHeight:12,axisTitleTextFontWeight:"normal",axisTitleSpacing:12,axisDescriptionIconFillColor:hf[85],axisTickLineBorderColor:Va[25],axisTickLineLength:4,axisTickLineBorder:1,axisSubTickLineBorderColor:Va[15],axisSubTickLineLength:2,axisSubTickLineBorder:1,axisLabelFillColor:Va[45],axisLabelFontSize:12,axisLabelLineHeight:12,axisLabelFontWeight:"normal",axisLabelOffset:8,axisGridBorderColor:Va[15],axisGridBorder:1,axisGridLineDash:null,legendTitleTextFillColor:Va[45],legendTitleTextFontSize:12,legendTitleTextLineHeight:21,legendTitleTextFontWeight:"normal",legendMarkerColor:Ju[0],legendMarkerSpacing:8,legendMarkerSize:4,legendCircleMarkerSize:4,legendSquareMarkerSize:4,legendLineMarkerSize:5,legendItemNameFillColor:Va[65],legendItemNameFontSize:12,legendItemNameLineHeight:12,legendItemNameFontWeight:"normal",legendItemSpacing:24,legendItemMarginBottom:12,legendSpacing:16,legendPadding:[8,8,8,8],legendHorizontalPadding:[8,0,8,0],legendVerticalPadding:[0,8,0,8],legendPageNavigatorMarkerSize:12,legendPageNavigatorMarkerInactiveFillColor:Va[45],legendPageNavigatorMarkerInactiveFillOpacity:.45,legendPageNavigatorMarkerFillColor:Va[45],legendPageNavigatorMarkerFillOpacity:1,legendPageNavigatorTextFillColor:Va[65],legendPageNavigatorTextFontSize:12,sliderRailFillColor:Va[15],sliderRailBorder:0,sliderRailBorderColor:null,sliderRailWidth:100,sliderRailHeight:12,sliderLabelTextFillColor:Va[45],sliderLabelTextFontSize:12,sliderLabelTextLineHeight:12,sliderLabelTextFontWeight:"normal",sliderHandlerFillColor:hf[6],sliderHandlerWidth:10,sliderHandlerHeight:14,sliderHandlerBorder:1,sliderHandlerBorderColor:hf[25],annotationArcBorderColor:Va[15],annotationArcBorder:1,annotationLineBorderColor:Va[25],annotationLineBorder:1,annotationLineDash:null,annotationTextFillColor:Va[65],annotationTextFontSize:12,annotationTextLineHeight:12,annotationTextFontWeight:"normal",annotationTextBorderColor:null,annotationTextBorder:0,annotationRegionFillColor:Va[100],annotationRegionFillOpacity:.06,annotationRegionBorder:0,annotationRegionBorderColor:null,annotationDataMarkerLineLength:16,tooltipCrosshairsBorderColor:Va[25],tooltipCrosshairsBorder:1,tooltipCrosshairsLineDash:null,tooltipContainerFillColor:"#1f1f1f",tooltipContainerFillOpacity:.95,tooltipContainerShadow:"0px 2px 4px rgba(0,0,0,.5)",tooltipContainerBorderRadius:3,tooltipTextFillColor:Va[65],tooltipTextFontSize:12,tooltipTextLineHeight:12,tooltipTextFontWeight:"bold",labelFillColor:Va[65],labelFillColorDark:"#2c3542",labelFillColorLight:"#ffffff",labelFontSize:12,labelLineHeight:12,labelFontWeight:"normal",labelBorderColor:null,labelBorder:0,innerLabelFillColor:hf[100],innerLabelFontSize:12,innerLabelLineHeight:12,innerLabelFontWeight:"normal",innerLabelBorderColor:null,innerLabelBorder:0,overflowLabelFillColor:Va[65],overflowLabelFillColorDark:"#2c3542",overflowLabelFillColorLight:"#ffffff",overflowLabelFontSize:12,overflowLabelLineHeight:12,overflowLabelFontWeight:"normal",overflowLabelBorderColor:hf[100],overflowLabelBorder:1,labelLineBorder:1,labelLineBorderColor:Va[25],cSliderRailHieght:16,cSliderBackgroundFillColor:"#416180",cSliderBackgroundFillOpacity:.05,cSliderForegroundFillColor:"#5B8FF9",cSliderForegroundFillOpacity:.15,cSliderHandlerHeight:24,cSliderHandlerWidth:10,cSliderHandlerFillColor:"#F7F7F7",cSliderHandlerFillOpacity:1,cSliderHandlerHighlightFillColor:"#FFF",cSliderHandlerBorderColor:"#BFBFBF",cSliderHandlerBorder:1,cSliderHandlerBorderRadius:2,cSliderTextFillColor:"#fff",cSliderTextFillOpacity:.45,cSliderTextFontSize:12,cSliderTextLineHeight:12,cSliderTextFontWeight:"normal",cSliderTextBorderColor:null,cSliderTextBorder:0,scrollbarTrackFillColor:"rgba(255,255,255,0.65)",scrollbarThumbFillColor:"rgba(0,0,0,0.35)",scrollbarThumbHighlightFillColor:"rgba(0,0,0,0.45)",pointFillColor:Ju[0],pointFillOpacity:.95,pointSize:4,pointBorder:1,pointBorderColor:hf[100],pointBorderOpacity:1,pointActiveBorderColor:Va[100],pointSelectedBorder:2,pointSelectedBorderColor:Va[100],pointInactiveFillOpacity:.3,pointInactiveBorderOpacity:.3,hollowPointSize:4,hollowPointBorder:1,hollowPointBorderColor:Ju[0],hollowPointBorderOpacity:.95,hollowPointFillColor:hf[100],hollowPointActiveBorder:1,hollowPointActiveBorderColor:Va[100],hollowPointActiveBorderOpacity:1,hollowPointSelectedBorder:2,hollowPointSelectedBorderColor:Va[100],hollowPointSelectedBorderOpacity:1,hollowPointInactiveBorderOpacity:.3,lineBorder:2,lineBorderColor:Ju[0],lineBorderOpacity:1,lineActiveBorder:3,lineSelectedBorder:3,lineInactiveBorderOpacity:.3,areaFillColor:Ju[0],areaFillOpacity:.25,areaActiveFillColor:Ju[0],areaActiveFillOpacity:.5,areaSelectedFillColor:Ju[0],areaSelectedFillOpacity:.5,areaInactiveFillOpacity:.3,hollowAreaBorderColor:Ju[0],hollowAreaBorder:2,hollowAreaBorderOpacity:1,hollowAreaActiveBorder:3,hollowAreaActiveBorderColor:Va[100],hollowAreaSelectedBorder:3,hollowAreaSelectedBorderColor:Va[100],hollowAreaInactiveBorderOpacity:.3,intervalFillColor:Ju[0],intervalFillOpacity:.95,intervalActiveBorder:1,intervalActiveBorderColor:Va[100],intervalActiveBorderOpacity:1,intervalSelectedBorder:2,intervalSelectedBorderColor:Va[100],intervalSelectedBorderOpacity:1,intervalInactiveBorderOpacity:.3,intervalInactiveFillOpacity:.3,hollowIntervalBorder:2,hollowIntervalBorderColor:Ju[0],hollowIntervalBorderOpacity:1,hollowIntervalFillColor:hf[100],hollowIntervalActiveBorder:2,hollowIntervalActiveBorderColor:Va[100],hollowIntervalSelectedBorder:3,hollowIntervalSelectedBorderColor:Va[100],hollowIntervalSelectedBorderOpacity:1,hollowIntervalInactiveBorderOpacity:.3};return(0,P.pi)((0,P.pi)({},g),r)},jg=J0();function s0(){return window?window.devicePixelRatio:1}function Fc(r,e,t,i){var u=r-t,c=e-i;return Math.sqrt(u*u+c*c)}function ah(r,e,t,i,u,c){return u>=r&&u<=r+t&&c>=e&&c<=e+i}function Lh(r,e){return!(e.minX>r.maxX||e.maxX<r.minX||e.minY>r.maxY||e.maxY<r.minY)}function tg(r,e){return!r||!e?r||e:{minX:Math.min(r.minX,e.minX),minY:Math.min(r.minY,e.minY),maxX:Math.max(r.maxX,e.maxX),maxY:Math.max(r.maxY,e.maxY)}}function u0(r,e){return r[0]===e[0]&&r[1]===e[1]}var eg=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,Xm=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,l0=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,Wg=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function Wl(r,e){var t=r.match(Wg);(0,b.S6)(t,function(i){var u=i.split(":");e.addColorStop(u[0],u[1])})}function Ym(r,e,t){var i=eg.exec(t),u=parseFloat(i[1])%360*(Math.PI/180),c=i[2],p=e.getBBox(),g,_;u>=0&&u<1/2*Math.PI?(g={x:p.minX,y:p.minY},_={x:p.maxX,y:p.maxY}):1/2*Math.PI<=u&&u<Math.PI?(g={x:p.maxX,y:p.minY},_={x:p.minX,y:p.maxY}):Math.PI<=u&&u<3/2*Math.PI?(g={x:p.maxX,y:p.maxY},_={x:p.minX,y:p.minY}):(g={x:p.minX,y:p.maxY},_={x:p.maxX,y:p.minY});var S=Math.tan(u),k=S*S,L=(_.x-g.x+S*(_.y-g.y))/(k+1)+g.x,R=S*(_.x-g.x+S*(_.y-g.y))/(k+1)+g.y,U=r.createLinearGradient(g.x,g.y,L,R);return Wl(c,U),U}function $m(r,e,t){var i=Xm.exec(t),u=parseFloat(i[1]),c=parseFloat(i[2]),p=parseFloat(i[3]),g=i[4];if(p===0){var _=g.match(Wg);return _[_.length-1].split(":")[1]}var S=e.getBBox(),k=S.maxX-S.minX,L=S.maxY-S.minY,R=Math.sqrt(k*k+L*L)/2,U=r.createRadialGradient(S.minX+k*u,S.minY+L*c,0,S.minX+k/2,S.minY+L/2,p*R);return Wl(g,U),U}function qm(r,e,t){if(e.get("patternSource")&&e.get("patternSource")===t)return e.get("pattern");var i,u,c=l0.exec(t),p=c[1],g=c[2];function _(){i=r.createPattern(u,p),e.set("pattern",i),e.set("patternSource",t)}switch(p){case"a":p="repeat";break;case"x":p="repeat-x";break;case"y":p="repeat-y";break;case"n":p="no-repeat";break;default:p="no-repeat"}return u=new Image,g.match(/^data:/i)||(u.crossOrigin="Anonymous"),u.src=g,u.complete?_():(u.onload=_,u.src=u.src),i}function Rc(r,e,t){var i=e.getBBox();if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height))return t;if((0,b.HD)(t)){if(t[1]==="("||t[2]==="("){if(t[0]==="l")return Ym(r,e,t);if(t[0]==="r")return $m(r,e,t);if(t[0]==="p")return qm(r,e,t)}return t}if(t instanceof CanvasPattern)return t}function rg(r){var e=0,t=0,i=0,u=0;return(0,b.kJ)(r)?r.length===1?e=t=i=u=r[0]:r.length===2?(e=i=r[0],t=u=r[1]):r.length===3?(e=r[0],t=u=r[1],i=r[2]):(e=r[0],t=r[1],i=r[2],u=r[3]):e=t=i=u=r,[e,t,i,u]}function yp(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function pf(r,e){return yp(r)*yp(e)?(r[0]*e[0]+r[1]*e[1])/(yp(r)*yp(e)):1}function Xg(r,e){return(r[0]*e[1]<r[1]*e[0]?-1:1)*Math.acos(pf(r,e))}function Tv(r,e){var t=e[1],i=e[2],u=(0,b.wQ)((0,b.c$)(e[3]),Math.PI*2),c=e[4],p=e[5],g=r[0],_=r[1],S=e[6],k=e[7],L=Math.cos(u)*(g-S)/2+Math.sin(u)*(_-k)/2,R=-1*Math.sin(u)*(g-S)/2+Math.cos(u)*(_-k)/2,U=L*L/(t*t)+R*R/(i*i);U>1&&(t*=Math.sqrt(U),i*=Math.sqrt(U));var G=t*t*(R*R)+i*i*(L*L),Q=G?Math.sqrt((t*t*(i*i)-G)/G):1;c===p&&(Q*=-1),isNaN(Q)&&(Q=0);var pt=i?Q*t*R/i:0,yt=t?Q*-i*L/t:0,Ht=(g+S)/2+Math.cos(u)*pt-Math.sin(u)*yt,ce=(_+k)/2+Math.sin(u)*pt+Math.cos(u)*yt,he=[(L-pt)/t,(R-yt)/i],ze=[(-1*L-pt)/t,(-1*R-yt)/i],Er=Xg([1,0],he),Fr=Xg(he,ze);return pf(he,ze)<=-1&&(Fr=Math.PI),pf(he,ze)>=1&&(Fr=0),p===0&&Fr>0&&(Fr=Fr-2*Math.PI),p===1&&Fr<0&&(Fr=Fr+2*Math.PI),{cx:Ht,cy:ce,rx:u0(r,[S,k])?0:t,ry:u0(r,[S,k])?0:i,startAngle:Er,endAngle:Er+Fr,xRotation:u,arcFlag:c,sweepFlag:p}}var Pf=Math.sin,Ph=Math.cos,rd=Math.atan2,_p=Math.PI;function xp(r,e,t,i,u,c,p){var g=e.stroke,_=e.lineWidth,S=t-u,k=i-c,L=rd(k,S),R=new J_({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:{path:"M"+10*Ph(_p/6)+","+10*Pf(_p/6)+" L0,0 L"+10*Ph(_p/6)+",-"+10*Pf(_p/6),stroke:g,lineWidth:_}});R.translate(u,c),R.rotateAtPoint(u,c,L),r.set(p?"startArrowShape":"endArrowShape",R)}function c0(r,e,t,i,u,c,p){var g=e.startArrow,_=e.endArrow,S=e.stroke,k=e.lineWidth,L=p?g:_,R=L.d,U=L.fill,G=L.stroke,Q=L.lineWidth,pt=(0,P._T)(L,["d","fill","stroke","lineWidth"]),yt=t-u,Ht=i-c,ce=rd(Ht,yt);R&&(u=u-Ph(ce)*R,c=c-Pf(ce)*R);var he=new J_({type:"path",canvas:r.get("canvas"),isArrowShape:!0,attrs:(0,P.pi)((0,P.pi)({},pt),{stroke:G||S,lineWidth:Q||k,fill:U})});he.translate(u,c),he.rotateAtPoint(u,c,ce),r.set(p?"startArrowShape":"endArrowShape",he)}function Oh(r,e,t,i,u){var c=rd(i-e,t-r);return{dx:Ph(c)*u,dy:Pf(c)*u}}function Vd(r,e,t,i,u,c){typeof e.startArrow=="object"?c0(r,e,t,i,u,c,!0):e.startArrow?xp(r,e,t,i,u,c,!0):r.set("startArrowShape",null)}function Gd(r,e,t,i,u,c){typeof e.endArrow=="object"?c0(r,e,t,i,u,c,!1):e.endArrow?xp(r,e,t,i,u,c,!1):r.set("startArrowShape",null)}var Mv={fill:"fillStyle",stroke:"strokeStyle",opacity:"globalAlpha"};function Fh(r,e){var t=e.attr();for(var i in t){var u=t[i],c=Mv[i]?Mv[i]:i;c==="matrix"&&u?r.transform(u[0],u[1],u[3],u[4],u[6],u[7]):c==="lineDash"&&r.setLineDash?(0,b.kJ)(u)&&r.setLineDash(u):(c==="strokeStyle"||c==="fillStyle"?u=Rc(r,e,u):c==="globalAlpha"&&(u=u*r.globalAlpha),r[c]=u)}}function Dc(r,e,t){for(var i=0;i<e.length;i++){var u=e[i];u.cfg.visible?u.draw(r,t):u.skipDraw()}}function Iv(r,e,t){var i=r.get("refreshElements");(0,b.S6)(i,function(u){if(u!==r)for(var c=u.cfg.parent;c&&c!==r&&!c.cfg.refresh;)c.cfg.refresh=!0,c=c.cfg.parent}),i[0]===r?Lv(e,t):Ol(e,t)}function Ol(r,e){for(var t=0;t<r.length;t++){var i=r[t];if(i.cfg.visible)if(i.cfg.hasChanged)i.cfg.refresh=!0,i.isGroup()&&Lv(i.cfg.children,e);else if(i.cfg.refresh)i.isGroup()&&Ol(i.cfg.children,e);else{var u=Rh(i,e);i.cfg.refresh=u,u&&i.isGroup()&&Ol(i.cfg.children,e)}}}function kv(r){for(var e=0;e<r.length;e++){var t=r[e];t.cfg.hasChanged=!1,t.isGroup()&&!t.destroyed&&kv(t.cfg.children)}}function Lv(r,e){for(var t=0;t<r.length;t++){var i=r[t];i.cfg.refresh=!0,i.isGroup()&&Lv(i.get("children"),e)}}function Rh(r,e){var t=r.cfg.cacheCanvasBBox,i=r.cfg.isInView&&t&&Lh(t,e);return i}function Yg(r,e,t,i){var u=t.path,c=t.startArrow,p=t.endArrow;if(!!u){var g=[0,0],_=[0,0],S={dx:0,dy:0};e.beginPath();for(var k=0;k<u.length;k++){var L=u[k],R=L[0];if(k===0&&c&&c.d){var U=r.getStartTangent();S=Oh(U[0][0],U[0][1],U[1][0],U[1][1],c.d)}else if(k===u.length-2&&u[k+1][0]==="Z"&&p&&p.d){var G=u[k+1];if(G[0]==="Z"){var U=r.getEndTangent();S=Oh(U[0][0],U[0][1],U[1][0],U[1][1],p.d)}}else if(k===u.length-1&&p&&p.d&&u[0]!=="Z"){var U=r.getEndTangent();S=Oh(U[0][0],U[0][1],U[1][0],U[1][1],p.d)}var Q=S.dx,pt=S.dy;switch(R){case"M":e.moveTo(L[1]-Q,L[2]-pt),_=[L[1],L[2]];break;case"L":e.lineTo(L[1]-Q,L[2]-pt);break;case"Q":e.quadraticCurveTo(L[1],L[2],L[3]-Q,L[4]-pt);break;case"C":e.bezierCurveTo(L[1],L[2],L[3],L[4],L[5]-Q,L[6]-pt);break;case"A":{var yt=void 0;i?(yt=i[k],yt||(yt=Tv(g,L),i[k]=yt)):yt=Tv(g,L);var Ht=yt.cx,ce=yt.cy,he=yt.rx,ze=yt.ry,Er=yt.startAngle,Fr=yt.endAngle,zr=yt.xRotation,pn=yt.sweepFlag;if(e.ellipse)e.ellipse(Ht,ce,he,ze,zr,Er,Fr,1-pn);else{var nn=he>ze?he:ze,Pn=he>ze?1:he/ze,wi=he>ze?ze/he:1;e.translate(Ht,ce),e.rotate(zr),e.scale(Pn,wi),e.arc(0,0,nn,Er,Fr,1-pn),e.scale(1/Pn,1/wi),e.rotate(-zr),e.translate(-Ht,-ce)}break}case"Z":e.closePath();break;default:break}if(R==="Z")g=_;else{var ha=L.length;g=[L[ha-2],L[ha-1]]}}}}function $g(r,e){var t=r.get("canvas");t&&(e==="remove"&&(r._cacheCanvasBBox=r.get("cacheCanvasBBox")),r.get("hasChanged")||(r.set("hasChanged",!0),r.cfg.parent&&r.cfg.parent.get("hasChanged")||(t.refreshElement(r,e,t),t.get("autoDraw")&&t.draw())))}function qg(r){var e;if(r.destroyed)e=r._cacheCanvasBBox;else{var t=r.get("cacheCanvasBBox"),i=t&&!!(t.width&&t.height),u=r.getCanvasBBox(),c=u&&!!(u.width&&u.height);i&&c?e=tg(t,u):i?e=t:c&&(e=u)}return e}function Kg(r){if(!r.length)return null;var e=[],t=[],i=[],u=[];return(0,b.S6)(r,function(c){var p=qg(c);p&&(e.push(p.minX),t.push(p.minY),i.push(p.maxX),u.push(p.maxY))}),{minX:(0,b.VV)(e),minY:(0,b.VV)(t),maxX:(0,b.Fp)(i),maxY:(0,b.Fp)(u)}}function Pv(r,e){return!r||!e||!Lh(r,e)?null:{minX:Math.max(r.minX,e.minX),minY:Math.max(r.minY,e.minY),maxX:Math.min(r.maxX,e.maxX),maxY:Math.min(r.maxY,e.maxY)}}var Ov=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.onCanvasChange=function(t){$g(this,t)},e.prototype.getShapeBase=function(){return et},e.prototype.getGroupBase=function(){return e},e.prototype._applyClip=function(t,i){i&&(t.save(),Fh(t,i),i.createPath(t),t.restore(),t.clip(),i._afterDraw())},e.prototype.cacheCanvasBBox=function(){var t=this.cfg.children,i=[],u=[];(0,b.S6)(t,function(R){var U=R.cfg.cacheCanvasBBox;U&&R.cfg.isInView&&(i.push(U.minX,U.maxX),u.push(U.minY,U.maxY))});var c=null;if(i.length){var p=(0,b.VV)(i),g=(0,b.Fp)(i),_=(0,b.VV)(u),S=(0,b.Fp)(u);c={minX:p,minY:_,x:p,y:_,maxX:g,maxY:S,width:g-p,height:S-_};var k=this.cfg.canvas;if(k){var L=k.getViewRange();this.set("isInView",Lh(c,L))}}else this.set("isInView",!1);this.set("cacheCanvasBBox",c)},e.prototype.draw=function(t,i){var u=this.cfg.children,c=i?this.cfg.refresh:!0;u.length&&c&&(t.save(),Fh(t,this),this._applyClip(t,this.getClip()),Dc(t,u,i),t.restore(),this.cacheCanvasBBox()),this.cfg.refresh=null,this.set("hasChanged",!1)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("hasChanged",!1)},e}(Te.AbstractGroup),Fv=Ov,$_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.getShapeBase=function(){return et},e.prototype.getGroupBase=function(){return Fv},e.prototype.onCanvasChange=function(t){$g(this,t)},e.prototype.calculateBBox=function(){var t=this.get("type"),i=this.getHitLineWidth(),u=(0,Te.getBBoxMethod)(t),c=u(this),p=i/2,g=c.x-p,_=c.y-p,S=c.x+c.width+p,k=c.y+c.height+p;return{x:g,minX:g,y:_,minY:_,width:c.width+i,height:c.height+i,maxX:S,maxY:k}},e.prototype.isFill=function(){return!!this.attrs.fill||this.isClipShape()},e.prototype.isStroke=function(){return!!this.attrs.stroke},e.prototype._applyClip=function(t,i){i&&(t.save(),Fh(t,i),i.createPath(t),t.restore(),t.clip(),i._afterDraw())},e.prototype.draw=function(t,i){var u=this.cfg.clipShape;if(i){if(this.cfg.refresh===!1){this.set("hasChanged",!1);return}var c=this.getCanvasBBox();if(!Lh(i,c)){this.set("hasChanged",!1),this.cfg.isInView&&this._afterDraw();return}}t.save(),Fh(t,this),this._applyClip(t,u),this.drawPath(t),t.restore(),this._afterDraw()},e.prototype.getCanvasViewBox=function(){var t=this.cfg.canvas;return t?t.getViewRange():null},e.prototype.cacheCanvasBBox=function(){var t=this.getCanvasViewBox();if(t){var i=this.getCanvasBBox(),u=Lh(i,t);this.set("isInView",u),u?this.set("cacheCanvasBBox",i):this.set("cacheCanvasBBox",null)}},e.prototype._afterDraw=function(){this.cacheCanvasBBox(),this.set("hasChanged",!1),this.set("refresh",null)},e.prototype.skipDraw=function(){this.set("cacheCanvasBBox",null),this.set("isInView",null),this.set("hasChanged",!1)},e.prototype.drawPath=function(t){this.createPath(t),this.strokeAndFill(t),this.afterDrawPath(t)},e.prototype.fill=function(t){t.fill()},e.prototype.stroke=function(t){t.stroke()},e.prototype.strokeAndFill=function(t){var i=this.attrs,u=i.lineWidth,c=i.opacity,p=i.strokeOpacity,g=i.fillOpacity;this.isFill()&&(!(0,b.UM)(g)&&g!==1?(t.globalAlpha=g,this.fill(t),t.globalAlpha=c):this.fill(t)),this.isStroke()&&u>0&&(!(0,b.UM)(p)&&p!==1&&(t.globalAlpha=p),this.stroke(t)),this.afterDrawPath(t)},e.prototype.createPath=function(t){},e.prototype.afterDrawPath=function(t){},e.prototype.isInShape=function(t,i){var u=this.isStroke(),c=this.isFill(),p=this.getHitLineWidth();return this.isInStrokeOrPath(t,i,u,c,p)},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){return!1},e.prototype.getHitLineWidth=function(){if(!this.isStroke())return 0;var t=this.attrs;return t.lineWidth+t.lineAppendWidth},e}(Te.AbstractShape),Of=$_,Km=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,r:0})},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr(),_=g.x,S=g.y,k=g.r,L=p/2,R=Fc(_,S,t,i);return c&&u?R<=k+L:c?R<=k:u?R>=k-L&&R<=k+L:!1},e.prototype.createPath=function(t){var i=this.attr(),u=i.x,c=i.y,p=i.r;t.beginPath(),t.arc(u,c,p,0,Math.PI*2,!1),t.closePath()},e}(Of),q_=Km;function ng(r,e,t,i){return r/(t*t)+e/(i*i)}var K_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr(),_=p/2,S=g.x,k=g.y,L=g.rx,R=g.ry,U=(t-S)*(t-S),G=(i-k)*(i-k);return c&&u?ng(U,G,L+_,R+_)<=1:c?ng(U,G,L,R)<=1:u?ng(U,G,L-_,R-_)>=1&&ng(U,G,L+_,R+_)<=1:!1},e.prototype.createPath=function(t){var i=this.attr(),u=i.x,c=i.y,p=i.rx,g=i.ry;if(t.beginPath(),t.ellipse)t.ellipse(u,c,p,g,0,0,Math.PI*2,!1);else{var _=p>g?p:g,S=p>g?1:p/g,k=p>g?g/p:1;t.save(),t.translate(u,c),t.scale(S,k),t.arc(0,0,_,0,Math.PI*2),t.restore(),t.closePath()}},e}(Of),Hd=K_;function ig(r){return r instanceof HTMLElement&&(0,b.HD)(r.nodeName)&&r.nodeName.toUpperCase()==="CANVAS"}var ag=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0})},e.prototype.initAttrs=function(t){this._setImage(t.img)},e.prototype.isStroke=function(){return!1},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._afterLoading=function(){if(this.get("toDraw")===!0){var t=this.get("canvas");t?t.draw():this.createPath(this.get("context"))}},e.prototype._setImage=function(t){var i=this,u=this.attrs;if((0,b.HD)(t)){var c=new Image;c.onload=function(){if(i.destroyed)return!1;i.attr("img",c),i.set("loading",!1),i._afterLoading();var p=i.get("callback");p&&p.call(i)},c.crossOrigin="Anonymous",c.src=t,this.set("loading",!0)}else t instanceof Image?(u.width||(u.width=t.width),u.height||(u.height=t.height)):ig(t)&&(u.width||(u.width=Number(t.getAttribute("width"))),u.height||(u.height,Number(t.getAttribute("height"))))},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),t==="img"&&this._setImage(i)},e.prototype.createPath=function(t){if(this.get("loading")){this.set("toDraw",!0),this.set("context",t);return}var i=this.attr(),u=i.x,c=i.y,p=i.width,g=i.height,_=i.sx,S=i.sy,k=i.swidth,L=i.sheight,R=i.img;(R instanceof Image||ig(R))&&(!(0,b.UM)(_)&&!(0,b.UM)(S)&&!(0,b.UM)(k)&&!(0,b.UM)(L)?t.drawImage(R,_,S,k,L,u,c,p,g):t.drawImage(R,u,c,p,g))},e}(Of),Qg=ag,Ls=ot(32793);function df(r,e,t,i,u,c,p){var g=Math.min(r,t),_=Math.max(r,t),S=Math.min(e,i),k=Math.max(e,i),L=u/2;return c>=g-L&&c<=_+L&&p>=S-L&&p<=k+L?Ls.x1.pointToLine(r,e,t,i,c,p)<=u/2:!1}var og=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),this.setArrow()},e.prototype.setArrow=function(){var t=this.attr(),i=t.x1,u=t.y1,c=t.x2,p=t.y2,g=t.startArrow,_=t.endArrow;g&&Vd(this,t,c,p,i,u),_&&Gd(this,t,i,u,c,p)},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){if(!u||!p)return!1;var g=this.attr(),_=g.x1,S=g.y1,k=g.x2,L=g.y2;return df(_,S,k,L,p,t,i)},e.prototype.createPath=function(t){var i=this.attr(),u=i.x1,c=i.y1,p=i.x2,g=i.y2,_=i.startArrow,S=i.endArrow,k={dx:0,dy:0},L={dx:0,dy:0};_&&_.d&&(k=Oh(u,c,p,g,i.startArrow.d)),S&&S.d&&(L=Oh(u,c,p,g,i.endArrow.d)),t.beginPath(),t.moveTo(u+k.dx,c+k.dy),t.lineTo(p-L.dx,g-L.dy)},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),u=this.get("endArrowShape");i&&i.draw(t),u&&u.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr(),i=t.x1,u=t.y1,c=t.x2,p=t.y2;return Ls.x1.length(i,u,c,p)},e.prototype.getPoint=function(t){var i=this.attr(),u=i.x1,c=i.y1,p=i.x2,g=i.y2;return Ls.x1.pointAt(u,c,p,g,t)},e}(Of),bp=og,sg={circle:function(r,e,t){return[["M",r-t,e],["A",t,t,0,1,0,r+t,e],["A",t,t,0,1,0,r-t,e]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+i],["L",r,e-i],["L",r+t,e+i],["Z"]]},"triangle-down":function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-i],["L",r+t,e-i],["L",r,e+i],["Z"]]}},Jg=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.initAttrs=function(t){this._resetParamsCache()},e.prototype._resetParamsCache=function(){this.set("paramsCache",{})},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),["symbol","x","y","r","radius"].indexOf(t)!==-1&&this._resetParamsCache()},e.prototype.isOnlyHitBox=function(){return!0},e.prototype._getR=function(t){return(0,b.UM)(t.r)?t.radius:t.r},e.prototype._getPath=function(){var t=this.attr(),i=t.x,u=t.y,c=t.symbol||"circle",p=this._getR(t),g,_;if((0,b.mf)(c))g=c,_=g(i,u,p),_=(0,rf.wb)(_);else{if(g=e.Symbols[c],!g)return console.warn(c+" marker is not supported."),null;_=g(i,u,p)}return _},e.prototype.createPath=function(t){var i=this._getPath(),u=this.get("paramsCache");Yg(this,t,{path:i},u)},e.Symbols=sg,e}(Of),Qm=Jg;function Ep(r,e,t){var i=(0,Te.getOffScreenContext)();return r.createPath(i),i.isPointInPath(e,t)}var Q_=1e-6;function tm(r){return Math.abs(r)<Q_?0:r<0?-1:1}function hT(r,e,t){return(t[0]-r[0])*(e[1]-r[1])===(e[0]-r[0])*(t[1]-r[1])&&Math.min(r[0],e[0])<=t[0]&&t[0]<=Math.max(r[0],e[0])&&Math.min(r[1],e[1])<=t[1]&&t[1]<=Math.max(r[1],e[1])}function pT(r,e,t){var i=!1,u=r.length;if(u<=2)return!1;for(var c=0;c<u;c++){var p=r[c],g=r[(c+1)%u];if(hT(p,g,[e,t]))return!0;tm(p[1]-t)>0!=tm(g[1]-t)>0&&tm(e-(t-p[1])*(p[0]-g[0])/(p[1]-g[1])-p[0])<0&&(i=!i)}return i}function f0(r,e,t,i,u,c,p,g){var _=(Math.atan2(g-e,p-r)+Math.PI*2)%(Math.PI*2);if(_<i||_>u)return!1;var S={x:r+t*Math.cos(_),y:e+t*Math.sin(_)};return Fc(S.x,S.y,p,g)<=c/2}var l2=ma.vs;function lO(r){for(var e=!1,t=r.length,i=0;i<t;i++){var u=r[i],c=u[0];if(c==="C"||c==="A"||c==="Q"){e=!0;break}}return e}function c2(r,e,t,i,u){for(var c=!1,p=e/2,g=0;g<r.length;g++){var _=r[g],S=_.currentPoint,k=_.params,L=_.prePoint,R=_.box;if(!(R&&!ah(R.x-p,R.y-p,R.width+e,R.height+e,t,i))){switch(_.command){case"L":case"Z":c=df(L[0],L[1],S[0],S[1],e,t,i);break;case"Q":var U=Ls.lD.pointDistance(L[0],L[1],k[1],k[2],k[3],k[4],t,i);c=U<=e/2;break;case"C":var G=Ls.Ll.pointDistance(L[0],L[1],k[1],k[2],k[3],k[4],k[5],k[6],t,i,u);c=G<=e/2;break;case"A":var Q=_.arcParams,pt=Q.cx,yt=Q.cy,Ht=Q.rx,ce=Q.ry,he=Q.startAngle,ze=Q.endAngle,Er=Q.xRotation,Fr=[t,i,1],zr=Ht>ce?Ht:ce,pn=Ht>ce?1:Ht/ce,nn=Ht>ce?ce/Ht:1,Pn=l2(null,[["t",-pt,-yt],["r",-Er],["s",1/pn,1/nn]]);Cc.transformMat3(Fr,Fr,Pn),c=f0(0,0,zr,he,ze,e,Fr[0],Fr[1]);break;default:break}if(c)break}}return c}function dT(r){for(var e=r.length,t=[],i=[],u=[],c=0;c<e;c++){var p=r[c],g=p[0];g==="M"?(u.length&&(i.push(u),u=[]),u.push([p[1],p[2]])):g==="Z"?u.length&&(t.push(u),u=[]):u.push([p[1],p[2]])}return u.length>0&&i.push(u),{polygons:t,polylines:i}}var Jm=(0,P.pi)({hasArc:lO,extractPolygons:dT,isPointInStroke:c2},Te.PathUtil);function f2(r,e,t){for(var i=!1,u=0;u<r.length;u++){var c=r[u];if(i=pT(c,e,t),i)break}return i}var h2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this._setPathArr(t.path),this.setArrow()},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),t==="path"&&this._setPathArr(i),this.setArrow()},e.prototype._setPathArr=function(t){this.attrs.path=(0,rf.wb)(t);var i=Jm.hasArc(t);this.set("hasArc",i),this.set("paramsCache",{}),this.set("segments",null),this.set("curve",null),this.set("tCache",null),this.set("totalLength",null)},e.prototype.getSegments=function(){var t=this.get("segements");return t||(t=(0,rf.zx)(this.attr("path")),this.set("segments",t)),t},e.prototype.setArrow=function(){var t=this.attr(),i=t.startArrow,u=t.endArrow;if(i){var c=this.getStartTangent();Vd(this,t,c[0][0],c[0][1],c[1][0],c[1][1])}if(u){var c=this.getEndTangent();Gd(this,t,c[0][0],c[0][1],c[1][0],c[1][1])}},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.getSegments(),_=this.get("hasArc"),S=!1;if(u){var k=this.getTotalLength();S=Jm.isPointInStroke(g,p,t,i,k)}if(!S&&c)if(_)S=Ep(this,t,i);else{var L=this.attr("path"),R=Jm.extractPolygons(L);S=f2(R.polygons,t,i)||f2(R.polylines,t,i)}return S},e.prototype.createPath=function(t){var i=this.attr(),u=this.get("paramsCache");Yg(this,t,i,u)},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),u=this.get("endArrowShape");i&&i.draw(t),u&&u.draw(t)},e.prototype.getTotalLength=function(){var t=this.get("totalLength");return(0,b.UM)(t)?(this._calculateCurve(),this._setTcache(),this.get("totalLength")):t},e.prototype.getPoint=function(t){var i=this.get("tCache");i||(this._calculateCurve(),this._setTcache(),i=this.get("tCache"));var u,c,p=this.get("curve");if(!i||i.length===0)return p?{x:p[0][1],y:p[0][2]}:null;(0,b.S6)(i,function(k,L){t>=k[0]&&t<=k[1]&&(u=(t-k[0])/(k[1]-k[0]),c=L)});var g=p[c];if((0,b.UM)(g)||(0,b.UM)(c))return null;var _=g.length,S=p[c+1];return Ls.Ll.pointAt(g[_-2],g[_-1],S[1],S[2],S[3],S[4],S[5],S[6],u)},e.prototype._calculateCurve=function(){var t=this.attr().path;this.set("curve",Jm.pathToCurve(t))},e.prototype._setTcache=function(){var t=0,i=0,u=[],c,p,g,_,S=this.get("curve");if(!!S){if((0,b.S6)(S,function(k,L){g=S[L+1],_=k.length,g&&(t+=Ls.Ll.length(k[_-2],k[_-1],g[1],g[2],g[3],g[4],g[5],g[6])||0)}),this.set("totalLength",t),t===0){this.set("tCache",[]);return}(0,b.S6)(S,function(k,L){g=S[L+1],_=k.length,g&&(c=[],c[0]=i/t,p=Ls.Ll.length(k[_-2],k[_-1],g[1],g[2],g[3],g[4],g[5],g[6]),i+=p||0,c[1]=i/t,u.push(c))}),this.set("tCache",u)}},e.prototype.getStartTangent=function(){var t=this.getSegments(),i;if(t.length>1){var u=t[0].currentPoint,c=t[1].currentPoint,p=t[1].startTangent;i=[],p?(i.push([u[0]-p[0],u[1]-p[1]]),i.push([u[0],u[1]])):(i.push([c[0],c[1]]),i.push([u[0],u[1]]))}return i},e.prototype.getEndTangent=function(){var t=this.getSegments(),i=t.length,u;if(i>1){var c=t[i-2].currentPoint,p=t[i-1].currentPoint,g=t[i-1].endTangent;u=[],g?(u.push([p[0]-g[0],p[1]-g[1]]),u.push([p[0],p[1]])):(u.push([c[0],c[1]]),u.push([p[0],p[1]]))}return u},e}(Of),J_=h2;function t1(r,e,t,i,u){var c=r.length;if(c<2)return!1;for(var p=0;p<c-1;p++){var g=r[p][0],_=r[p][1],S=r[p+1][0],k=r[p+1][1];if(df(g,_,S,k,e,t,i))return!0}if(u){var L=r[0],R=r[c-1];if(df(L[0],L[1],R[0],R[1],e,t,i))return!0}return!1}var p2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr().points,_=!1;return u&&(_=t1(g,p,t,i,!0)),!_&&c&&(_=pT(g,t,i)),_},e.prototype.createPath=function(t){var i=this.attr(),u=i.points;if(!(u.length<2)){t.beginPath();for(var c=0;c<u.length;c++){var p=u[c];c===0?t.moveTo(p[0],p[1]):t.lineTo(p[0],p[1])}t.closePath()}},e}(Of),d2=p2,v2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.initAttrs=function(t){this.setArrow()},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),this.setArrow(),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.setArrow=function(){var t=this.attr(),i=this.attrs,u=i.points,c=i.startArrow,p=i.endArrow,g=u.length,_=u[0][0],S=u[0][1],k=u[g-1][0],L=u[g-1][1];c&&Vd(this,t,u[1][0],u[1][1],_,S),p&&Gd(this,t,u[g-2][0],u[g-2][1],k,L)},e.prototype.isFill=function(){return!1},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){if(!u||!p)return!1;var g=this.attr().points;return t1(g,p,t,i,!1)},e.prototype.isStroke=function(){return!0},e.prototype.createPath=function(t){var i=this.attr(),u=i.points,c=i.startArrow,p=i.endArrow,g=u.length;if(!(u.length<2)){var _=u[0][0],S=u[0][1],k=u[g-1][0],L=u[g-1][1];if(c&&c.d){var R=Oh(_,S,u[1][0],u[1][1],c.d);_+=R.dx,S+=R.dy}if(p&&p.d){var R=Oh(u[g-2][0],u[g-2][1],k,L,p.d);k-=R.dx,L-=R.dy}t.beginPath(),t.moveTo(_,S);for(var U=0;U<g-1;U++){var G=u[U];t.lineTo(G[0],G[1])}t.lineTo(k,L)}},e.prototype.afterDrawPath=function(t){var i=this.get("startArrowShape"),u=this.get("endArrowShape");i&&i.draw(t),u&&u.draw(t)},e.prototype.getTotalLength=function(){var t=this.attr().points,i=this.get("totalLength");return(0,b.UM)(i)?(this.set("totalLength",Ls.aH.length(t)),this.get("totalLength")):i},e.prototype.getPoint=function(t){var i=this.attr().points,u=this.get("tCache");u||(this._setTcache(),u=this.get("tCache"));var c,p;return(0,b.S6)(u,function(g,_){t>=g[0]&&t<=g[1]&&(c=(t-g[0])/(g[1]-g[0]),p=_)}),Ls.x1.pointAt(i[p][0],i[p][1],i[p+1][0],i[p+1][1],c)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var i=this.getTotalLength();if(!(i<=0)){var u=0,c=[],p,g;(0,b.S6)(t,function(_,S){t[S+1]&&(p=[],p[0]=u/i,g=Ls.x1.length(_[0],_[1],t[S+1][0],t[S+1][1]),u+=g,p[1]=u/i,c.push(p))}),this.set("tCache",c)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,i=[];return i.push([t[1][0],t[1][1]]),i.push([t[0][0],t[0][1]]),i},e.prototype.getEndTangent=function(){var t=this.attr().points,i=t.length-1,u=[];return u.push([t[i-1][0],t[i-1][1]]),u.push([t[i][0],t[i][1]]),u},e}(Of),g2=v2;function m2(r,e,t,i,u,c,p){var g=u/2;return ah(r-g,e-g,t,u,c,p)||ah(r+t-g,e-g,u,i,c,p)||ah(r+g,e+i-g,t,u,c,p)||ah(r-g,e+g,u,i,c,p)}function y2(r,e,t,i,u,c,p,g){var _=c/2;return df(r+u,e,r+t-u,e,c,p,g)||df(r+t,e+u,r+t,e+i-u,c,p,g)||df(r+t-u,e+i,r+u,e+i,c,p,g)||df(r,e+i-u,r,e+u,c,p,g)||f0(r+t-u,e+u,u,1.5*Math.PI,2*Math.PI,c,p,g)||f0(r+t-u,e+i-u,u,0,.5*Math.PI,c,p,g)||f0(r+u,e+i-u,u,.5*Math.PI,Math.PI,c,p,g)||f0(r+u,e+u,u,Math.PI,1.5*Math.PI,c,p,g)}var _2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.isInStrokeOrPath=function(t,i,u,c,p){var g=this.attr(),_=g.x,S=g.y,k=g.width,L=g.height,R=g.radius;if(R){var G=!1;return u&&(G=y2(_,S,k,L,R,p,t,i)),!G&&c&&(G=Ep(this,t,i)),G}else{var U=p/2;if(c&&u)return ah(_-U,S-U,k+U,L+U,t,i);if(c)return ah(_,S,k,L,t,i);if(u)return m2(_,S,k,L,p,t,i)}},e.prototype.createPath=function(t){var i=this.attr(),u=i.x,c=i.y,p=i.width,g=i.height,_=i.radius;if(t.beginPath(),_===0)t.rect(u,c,p,g);else{var S=rg(_),k=S[0],L=S[1],R=S[2],U=S[3];t.moveTo(u+k,c),t.lineTo(u+p-L,c),L!==0&&t.arc(u+p-L,c+L,L,-Math.PI/2,0),t.lineTo(u+p,c+g-R),R!==0&&t.arc(u+p-R,c+g-R,R,0,Math.PI/2),t.lineTo(u+U,c+g),U!==0&&t.arc(u+U,c+g-U,U,Math.PI/2,Math.PI),t.lineTo(u,c+k),k!==0&&t.arc(u+k,c+k,k,Math.PI,Math.PI*1.5),t.closePath()}},e}(Of),x2=_2,b2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.isOnlyHitBox=function(){return!0},e.prototype.initAttrs=function(t){this._assembleFont(),t.text&&this._setText(t.text)},e.prototype._assembleFont=function(){var t=this.attrs;t.font=(0,Te.assembleFont)(t)},e.prototype._setText=function(t){var i=null;(0,b.HD)(t)&&t.indexOf(`
`)!==-1&&(i=t.split(`
`)),this.set("textArr",i)},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),t.startsWith("font")&&this._assembleFont(),t==="text"&&this._setText(i)},e.prototype._getSpaceingY=function(){var t=this.attrs,i=t.lineHeight,u=t.fontSize*1;return i?i-u:u*.14},e.prototype._drawTextArr=function(t,i,u){var c=this.attrs,p=c.textBaseline,g=c.x,_=c.y,S=c.fontSize*1,k=this._getSpaceingY(),L=(0,Te.getTextHeight)(c.text,c.fontSize,c.lineHeight),R;(0,b.S6)(i,function(U,G){R=_+G*(k+S)-L+S,p==="middle"&&(R+=L-S-(L-S)/2),p==="top"&&(R+=L-S),(0,b.UM)(U)||(u?t.fillText(U,g,R):t.strokeText(U,g,R))})},e.prototype._drawText=function(t,i){var u=this.attr(),c=u.x,p=u.y,g=this.get("textArr");if(g)this._drawTextArr(t,g,i);else{var _=u.text;(0,b.UM)(_)||(i?t.fillText(_,c,p):t.strokeText(_,c,p))}},e.prototype.strokeAndFill=function(t){var i=this.attrs,u=i.lineWidth,c=i.opacity,p=i.strokeOpacity,g=i.fillOpacity;this.isStroke()&&u>0&&(!(0,b.UM)(p)&&p!==1&&(t.globalAlpha=c),this.stroke(t)),this.isFill()&&(!(0,b.UM)(g)&&g!==1?(t.globalAlpha=g,this.fill(t),t.globalAlpha=c):this.fill(t)),this.afterDrawPath(t)},e.prototype.fill=function(t){this._drawText(t,!0)},e.prototype.stroke=function(t){this._drawText(t,!1)},e}(Of),E2=b2;function w2(r,e){if(e){var t=(0,Te.invert)(e);return(0,Te.multiplyVec2)(t,r)}return r}function e1(r,e,t){var i=r.getTotalMatrix();if(i){var u=w2([e,t,1],i),c=u[0],p=u[1];return[c,p]}return[e,t]}function r1(r,e,t){if(r.isCanvas&&r.isCanvas())return!0;if(!(0,Te.isAllowCapture)(r)||r.cfg.isInView===!1)return!1;if(r.cfg.clipShape){var i=e1(r,e,t),u=i[0],c=i[1];if(r.isClipped(u,c))return!1}var p=r.cfg.cacheCanvasBBox||r.getCanvasBBox();return e>=p.minX&&e<=p.maxX&&t>=p.minY&&t<=p.maxY}function n1(r,e,t){if(!r1(r,e,t))return null;for(var i=null,u=r.getChildren(),c=u.length,p=c-1;p>=0;p--){var g=u[p];if(g.isGroup())i=n1(g,e,t);else if(r1(g,e,t)){var _=g,S=e1(g,e,t),k=S[0],L=S[1];_.isInShape(k,L)&&(i=g)}if(i)break}return i}var S2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){var t=r.prototype.getDefaultCfg.call(this);return t.renderer="canvas",t.autoDraw=!0,t.localRefresh=!0,t.refreshElements=[],t.clipView=!0,t.quickHit=!1,t},e.prototype.onCanvasChange=function(t){(t==="attr"||t==="sort"||t==="changeSize")&&(this.set("refreshElements",[this]),this.draw())},e.prototype.getShapeBase=function(){return et},e.prototype.getGroupBase=function(){return Fv},e.prototype.getPixelRatio=function(){var t=this.get("pixelRatio")||s0();return t>=1?Math.ceil(t):1},e.prototype.getViewRange=function(){return{minX:0,minY:0,maxX:this.cfg.width,maxY:this.cfg.height}},e.prototype.createDom=function(){var t=document.createElement("canvas"),i=t.getContext("2d");return this.set("context",i),t},e.prototype.setDOMSize=function(t,i){r.prototype.setDOMSize.call(this,t,i);var u=this.get("context"),c=this.get("el"),p=this.getPixelRatio();c.width=p*t,c.height=p*i,p>1&&u.scale(p,p)},e.prototype.clear=function(){r.prototype.clear.call(this),this._clearFrame();var t=this.get("context"),i=this.get("el");t.clearRect(0,0,i.width,i.height)},e.prototype.getShape=function(t,i){var u;return this.get("quickHit")?u=n1(this,t,i):u=r.prototype.getShape.call(this,t,i,null),u},e.prototype._getRefreshRegion=function(){var t=this.get("refreshElements"),i=this.getViewRange(),u;if(t.length&&t[0]===this)u=i;else if(u=Kg(t),u){u.minX=Math.floor(u.minX),u.minY=Math.floor(u.minY),u.maxX=Math.ceil(u.maxX),u.maxY=Math.ceil(u.maxY),u.maxY+=1;var c=this.get("clipView");c&&(u=Pv(u,i))}return u},e.prototype.refreshElement=function(t){var i=this.get("refreshElements");i.push(t)},e.prototype._clearFrame=function(){var t=this.get("drawFrame");t&&((0,b.VS)(t),this.set("drawFrame",null),this.set("refreshElements",[]))},e.prototype.draw=function(){var t=this.get("drawFrame");this.get("autoDraw")&&t||this._startDraw()},e.prototype._drawAll=function(){var t=this.get("context"),i=this.get("el"),u=this.getChildren();t.clearRect(0,0,i.width,i.height),Fh(t,this),Dc(t,u),this.set("refreshElements",[])},e.prototype._drawRegion=function(){var t=this.get("context"),i=this.get("refreshElements"),u=this.getChildren(),c=this._getRefreshRegion();c?(t.clearRect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),t.save(),t.beginPath(),t.rect(c.minX,c.minY,c.maxX-c.minX,c.maxY-c.minY),t.clip(),Fh(t,this),Iv(this,u,c),Dc(t,u,c),t.restore()):i.length&&kv(i),(0,b.S6)(i,function(p){p.get("hasChanged")&&p.set("hasChanged",!1)}),this.set("refreshElements",[])},e.prototype._startDraw=function(){var t=this,i=this.get("drawFrame");i||(i=(0,b.U7)(function(){t.get("localRefresh")?t._drawRegion():t._drawAll(),t.set("drawFrame",null)}),this.set("drawFrame",i))},e.prototype.skipDraw=function(){},e.prototype.removeDom=function(){var t=this.get("el");t.width=0,t.height=0,t.parentNode.removeChild(t)},e}(Te.AbstractCanvas),C2=S2,xc="0.5.12",ty={rect:"path",circle:"circle",line:"line",path:"path",marker:"path",text:"text",polyline:"polyline",polygon:"polygon",image:"image",ellipse:"ellipse",dom:"foreignObject"},Yo={opacity:"opacity",fillStyle:"fill",fill:"fill",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",x:"x",y:"y",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",x1:"x1",x2:"x2",y1:"y1",y2:"y2",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",startArrow:"marker-start",endArrow:"marker-end",path:"d",class:"class",id:"id",style:"style",preserveAspectRatio:"preserveAspectRatio"},vT=null;function oh(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function i1(r){var e=ty[r.type],t=r.getParent();if(!e)throw new Error("the type "+r.type+" is not supported by svg");var i=oh(e);if(r.get("id")&&(i.id=r.get("id")),r.set("el",i),r.set("attrs",{}),t){var u=t.get("el");u||(u=t.createDom(),t.set("el",u)),u.appendChild(i)}return i}function a1(r,e){var t=r.get("el"),i=(0,b.qo)(t.children).sort(e),u=document.createDocumentFragment();i.forEach(function(c){u.appendChild(c)}),t.appendChild(u)}function A2(r,e){var t=r.parentNode,i=Array.from(t.childNodes).filter(function(g){return g.nodeType===1&&g.nodeName.toLowerCase()!=="defs"}),u=i[e],c=i.indexOf(r);if(u){if(c>e)t.insertBefore(r,u);else if(c<e){var p=i[e+1];p?t.insertBefore(r,p):t.appendChild(r)}}else t.appendChild(r)}function T2(r,e){var t=r.cfg.el,i=r.attr(),u={dx:i.shadowOffsetX,dy:i.shadowOffsetY,blur:i.shadowBlur,color:i.shadowColor};if(!u.dx&&!u.dy&&!u.blur&&!u.color)t.removeAttribute("filter");else{var c=e.find("filter",u);c||(c=e.addShadow(u)),t.setAttribute("filter","url(#"+c+")")}}function ug(r){var e=r.attr().matrix;if(e){for(var t=r.cfg.el,i=[],u=0;u<9;u+=3)i.push(e[u]+","+e[u+1]);i=i.join(","),i.indexOf("NaN")===-1?t.setAttribute("transform","matrix("+i+")"):console.warn("invalid matrix:",e)}}function lg(r,e){var t=r.getClip(),i=r.get("el");if(!t)i.removeAttribute("clip-path");else if(t&&!i.hasAttribute("clip-path")){i1(t),t.createPath(e);var u=e.addClip(t);i.setAttribute("clip-path","url(#"+u+")")}}function o1(r,e){e.forEach(function(t){t.draw(r)})}function s1(r,e){var t=r.get("canvas");if(t&&t.get("autoDraw")){var i=t.get("context"),u=r.getParent(),c=u?u.getChildren():[t],p=r.get("el");if(e==="remove"){var g=r.get("isClipShape");if(g){var _=p&&p.parentNode,S=_&&_.parentNode;_&&S&&S.removeChild(_)}else p&&p.parentNode&&p.parentNode.removeChild(p)}else if(e==="show")p.setAttribute("visibility","visible");else if(e==="hide")p.setAttribute("visibility","hidden");else if(e==="zIndex")A2(p,c.indexOf(r));else if(e==="sort"){var k=r.get("children");k&&k.length&&a1(r,function(L,R){return k.indexOf(L)-k.indexOf(R)?1:0})}else e==="clear"?p&&(p.innerHTML=""):e==="matrix"?ug(r):e==="clip"?lg(r,i):e==="attr"||e==="add"&&r.draw(i)}}var M2=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.isEntityGroup=function(){return!0},e.prototype.createDom=function(){var t=oh("g");this.set("el",t);var i=this.getParent();if(i){var u=i.get("el");u||(u=i.createDom(),i.set("el",u)),u.appendChild(t)}return t},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var i=this.get("canvas");if(i&&i.get("autoDraw")){var u=i.get("context");this.createPath(u,t)}},e.prototype.onCanvasChange=function(t){s1(this,t)},e.prototype.getShapeBase=function(){return it},e.prototype.getGroupBase=function(){return e},e.prototype.draw=function(t){var i=this.getChildren(),u=this.get("el");this.get("destroyed")?u&&u.parentNode.removeChild(u):(u||this.createDom(),lg(this,t),this.createPath(t),i.length&&o1(t,i))},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){Yo[g]&&c.setAttribute(Yo[g],p)}),ug(this)},e}(Te.AbstractGroup),ey=M2,I2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="svg",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{lineWidth:1,lineAppendWidth:0,strokeOpacity:1,fillOpacity:1})},e.prototype.afterAttrsChange=function(t){r.prototype.afterAttrsChange.call(this,t);var i=this.get("canvas");if(i&&i.get("autoDraw")){var u=i.get("context");this.draw(u,t)}},e.prototype.getShapeBase=function(){return it},e.prototype.getGroupBase=function(){return ey},e.prototype.onCanvasChange=function(t){s1(this,t)},e.prototype.calculateBBox=function(){var t=this.get("el"),i=null;if(t)i=t.getBBox();else{var u=(0,Te.getBBoxMethod)(this.get("type"));u&&(i=u(this))}if(i){var c=i.x,p=i.y,g=i.width,_=i.height,S=this.getHitLineWidth(),k=S/2,L=c-k,R=p-k,U=c+g+k,G=p+_+k;return{x:L,y:R,minX:L,minY:R,maxX:U,maxY:G,width:g+S,height:_+S}}return{x:0,y:0,minX:0,minY:0,maxX:0,maxY:0,width:0,height:0}},e.prototype.isFill=function(){var t=this.attr(),i=t.fill,u=t.fillStyle;return(i||u||this.isClipShape())&&this.canFill},e.prototype.isStroke=function(){var t=this.attr(),i=t.stroke,u=t.strokeStyle;return(i||u)&&this.canStroke},e.prototype.draw=function(t,i){var u=this.get("el");this.get("destroyed")?u&&u.parentNode.removeChild(u):(u||i1(this),lg(this,t),this.createPath(t,i),this.shadow(t,i),this.strokeAndFill(t,i),this.transform(i))},e.prototype.createPath=function(t,i){},e.prototype.strokeAndFill=function(t,i){var u=i||this.attr(),c=u.fill,p=u.fillStyle,g=u.stroke,_=u.strokeStyle,S=u.fillOpacity,k=u.strokeOpacity,L=u.lineWidth,R=this.get("el");this.canFill&&(i?"fill"in u?this._setColor(t,"fill",c):"fillStyle"in u&&this._setColor(t,"fill",p):this._setColor(t,"fill",c||p),S&&R.setAttribute(Yo.fillOpacity,S)),this.canStroke&&L>0&&(i?"stroke"in u?this._setColor(t,"stroke",g):"strokeStyle"in u&&this._setColor(t,"stroke",_):this._setColor(t,"stroke",g||_),k&&R.setAttribute(Yo.strokeOpacity,k),L&&R.setAttribute(Yo.lineWidth,L))},e.prototype._setColor=function(t,i,u){var c=this.get("el");if(!u){c.setAttribute(Yo[i],"none");return}if(u=u.trim(),/^[r,R,L,l]{1}[\s]*\(/.test(u)){var p=t.find("gradient",u);p||(p=t.addGradient(u)),c.setAttribute(Yo[i],"url(#"+p+")")}else if(/^[p,P]{1}[\s]*\(/.test(u)){var p=t.find("pattern",u);p||(p=t.addPattern(u)),c.setAttribute(Yo[i],"url(#"+p+")")}else c.setAttribute(Yo[i],u)},e.prototype.shadow=function(t,i){var u=this.attr(),c=i||u,p=c.shadowOffsetX,g=c.shadowOffsetY,_=c.shadowBlur,S=c.shadowColor;(p||g||_||S)&&T2(this,t)},e.prototype.transform=function(t){var i=this.attr(),u=(t||i).matrix;u&&ug(this)},e.prototype.isInShape=function(t,i){return this.isPointInPath(t,i)},e.prototype.isPointInPath=function(t,i){var u=this.get("el"),c=this.get("canvas"),p=c.get("el").getBoundingClientRect(),g=t+p.left,_=i+p.top,S=document.elementFromPoint(g,_);return!!(S&&S.isEqualNode(u))},e.prototype.getHitLineWidth=function(){var t=this.attrs,i=t.lineWidth,u=t.lineAppendWidth;return this.isStroke()?i+u:0},e}(Te.AbstractShape),Dh=I2,gT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,r:0})},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="x"||g==="y"?c.setAttribute("c"+g,p):Yo[g]&&c.setAttribute(Yo[g],p)})},e}(Dh),mT=gT,yT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dom",t.canFill=!1,t.canStroke=!1,t}return e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");if((0,b.S6)(i||u,function(S,k){Yo[k]&&c.setAttribute(Yo[k],S)}),typeof u.html=="function"){var p=u.html.call(this,u);if(p instanceof Element||p instanceof HTMLDocument){for(var g=c.childNodes,_=g.length-1;_>=0;_--)c.removeChild(g[_]);c.appendChild(p)}else c.innerHTML=p}else c.innerHTML=u.html},e}(Dh),_T=yT,k2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ellipse",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,rx:0,ry:0})},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="x"||g==="y"?c.setAttribute("c"+g,p):Yo[g]&&c.setAttribute(Yo[g],p)})},e}(Dh),L2=k2,P2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="image",t.canFill=!1,t.canStroke=!1,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el");(0,b.S6)(i||c,function(g,_){_==="img"?u._setImage(c.img):Yo[_]&&p.setAttribute(Yo[_],g)})},e.prototype.setAttr=function(t,i){this.attrs[t]=i,t==="img"&&this._setImage(i)},e.prototype._setImage=function(t){var i=this.attr(),u=this.get("el");if((0,b.HD)(t))u.setAttribute("href",t);else if(t instanceof window.Image)i.width||(u.setAttribute("width",t.width),this.attr("width",t.width)),i.height||(u.setAttribute("height",t.height),this.attr("height",t.height)),u.setAttribute("href",t.src);else if(t instanceof HTMLElement&&(0,b.HD)(t.nodeName)&&t.nodeName.toUpperCase()==="CANVAS")u.setAttribute("href",t.toDataURL());else if(t instanceof ImageData){var c=document.createElement("canvas");c.setAttribute("width",""+t.width),c.setAttribute("height",""+t.height),c.getContext("2d").putImageData(t,0,0),i.width||(u.setAttribute("width",""+t.width),this.attr("width",t.width)),i.height||(u.setAttribute("height",""+t.height),this.attr("height",t.height)),u.setAttribute("href",c.toDataURL())}},e}(Dh),O2=P2,xT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t.canFill=!1,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x1:0,y1:0,x2:0,y2:0,startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){if(g==="startArrow"||g==="endArrow")if(p){var _=(0,b.Kn)(p)?t.addArrow(u,Yo[g]):t.getDefaultArrow(u,Yo[g]);c.setAttribute(Yo[g],"url(#"+_+")")}else c.removeAttribute(Yo[g]);else Yo[g]&&c.setAttribute(Yo[g],p)})},e.prototype.getTotalLength=function(){var t=this.attr(),i=t.x1,u=t.y1,c=t.x2,p=t.y2;return Ls.x1.length(i,u,c,p)},e.prototype.getPoint=function(t){var i=this.attr(),u=i.x1,c=i.y1,p=i.x2,g=i.y2;return Ls.x1.pointAt(u,c,p,g,t)},e}(Dh),bT=xT,ry={circle:function(r,e,t){return[["M",r,e],["m",-t,0],["a",t,t,0,1,0,t*2,0],["a",t,t,0,1,0,-t*2,0]]},square:function(r,e,t){return[["M",r-t,e-t],["L",r+t,e-t],["L",r+t,e+t],["L",r-t,e+t],["Z"]]},diamond:function(r,e,t){return[["M",r-t,e],["L",r,e-t],["L",r+t,e],["L",r,e+t],["Z"]]},triangle:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e+i],["L",r,e-i],["L",r+t,e+i],["z"]]},triangleDown:function(r,e,t){var i=t*Math.sin(.3333333333333333*Math.PI);return[["M",r-t,e-i],["L",r+t,e-i],["L",r,e+i],["Z"]]}},F2={get:function(r){return ry[r]},register:function(r,e){ry[r]=e},remove:function(r){delete ry[r]},getAll:function(){return ry}},ET=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="marker",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t){var i=this.get("el");i.setAttribute("d",this._assembleMarker())},e.prototype._assembleMarker=function(){var t=this._getPath();return(0,b.kJ)(t)?t.map(function(i){return i.join(" ")}).join(""):t},e.prototype._getPath=function(){var t=this.attr(),i=t.x,u=t.y,c=t.r||t.radius,p=t.symbol||"circle",g;return(0,b.mf)(p)?g=p:g=F2.get(p),g?g(i,u,c):(console.warn(g+" symbol is not exist."),null)},e.symbolsFactory=F2,e}(Dh),wT=ET,ST=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="path",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el");(0,b.S6)(i||c,function(g,_){if(_==="path"&&(0,b.kJ)(g))p.setAttribute("d",u._formatPath(g));else if(_==="startArrow"||_==="endArrow")if(g){var S=(0,b.Kn)(g)?t.addArrow(c,Yo[_]):t.getDefaultArrow(c,Yo[_]);p.setAttribute(Yo[_],"url(#"+S+")")}else p.removeAttribute(Yo[_]);else Yo[_]&&p.setAttribute(Yo[_],g)})},e.prototype._formatPath=function(t){var i=t.map(function(u){return u.join(" ")}).join("");return~i.indexOf("NaN")?"":i},e.prototype.getTotalLength=function(){var t=this.get("el");return t?t.getTotalLength():null},e.prototype.getPoint=function(t){var i=this.get("el"),u=this.getTotalLength();if(u===0)return null;var c=i?i.getPointAtLength(t*u):null;return c?{x:c.x,y:c.y}:null},e}(Dh),CT=ST,AT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.canFill=!0,t.canStroke=!0,t}return e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="points"&&(0,b.kJ)(p)&&p.length>=2?c.setAttribute("points",p.map(function(_){return _[0]+","+_[1]}).join(" ")):Yo[g]&&c.setAttribute(Yo[g],p)})},e}(Dh),TT=AT,MT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polyline",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{startArrow:!1,endArrow:!1})},e.prototype.onAttrChange=function(t,i,u){r.prototype.onAttrChange.call(this,t,i,u),["points"].indexOf(t)!==-1&&this._resetCache()},e.prototype._resetCache=function(){this.set("totalLength",null),this.set("tCache",null)},e.prototype.createPath=function(t,i){var u=this.attr(),c=this.get("el");(0,b.S6)(i||u,function(p,g){g==="points"&&(0,b.kJ)(p)&&p.length>=2?c.setAttribute("points",p.map(function(_){return _[0]+","+_[1]}).join(" ")):Yo[g]&&c.setAttribute(Yo[g],p)})},e.prototype.getTotalLength=function(){var t=this.attr().points,i=this.get("totalLength");return(0,b.UM)(i)?(this.set("totalLength",Ls.aH.length(t)),this.get("totalLength")):i},e.prototype.getPoint=function(t){var i=this.attr().points,u=this.get("tCache");u||(this._setTcache(),u=this.get("tCache"));var c,p;return(0,b.S6)(u,function(g,_){t>=g[0]&&t<=g[1]&&(c=(t-g[0])/(g[1]-g[0]),p=_)}),Ls.x1.pointAt(i[p][0],i[p][1],i[p+1][0],i[p+1][1],c)},e.prototype._setTcache=function(){var t=this.attr().points;if(!(!t||t.length===0)){var i=this.getTotalLength();if(!(i<=0)){var u=0,c=[],p,g;(0,b.S6)(t,function(_,S){t[S+1]&&(p=[],p[0]=u/i,g=Ls.x1.length(_[0],_[1],t[S+1][0],t[S+1][1]),u+=g,p[1]=u/i,c.push(p))}),this.set("tCache",c)}}},e.prototype.getStartTangent=function(){var t=this.attr().points,i=[];return i.push([t[1][0],t[1][1]]),i.push([t[0][0],t[0][1]]),i},e.prototype.getEndTangent=function(){var t=this.attr().points,i=t.length-1,u=[];return u.push([t[i-1][0],t[i-1][1]]),u.push([t[i][0],t[i][1]]),u},e}(Dh),IT=MT,kT=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/gi,LT=/[^\s,]+/gi;function PT(r){var e=0,t=0,i=0,u=0;return(0,b.kJ)(r)?r.length===1?e=t=i=u=r[0]:r.length===2?(e=i=r[0],t=u=r[1]):r.length===3?(e=r[0],t=u=r[1],i=r[2]):(e=r[0],t=r[1],i=r[2],u=r[3]):e=t=i=u=r,{r1:e,r2:t,r3:i,r4:u}}function cO(r){if(r=r||[],isArray(r))return r;if(isString(r))return r=r.match(kT),each(r,function(e,t){if(e=e.match(LT),e[0].length>1){var i=e[0].charAt(0);e.splice(1,0,e[0].substr(1)),e[0]=i}each(e,function(u,c){isNaN(u)||(e[c]=+u)}),r[t]=e}),r}var OT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rect",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,width:0,height:0,radius:0})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el"),g=!1,_=["x","y","width","height","radius"];(0,b.S6)(i||c,function(S,k){_.indexOf(k)!==-1&&!g?(p.setAttribute("d",u._assembleRect(c)),g=!0):_.indexOf(k)===-1&&Yo[k]&&p.setAttribute(Yo[k],S)})},e.prototype._assembleRect=function(t){var i=t.x,u=t.y,c=t.width,p=t.height,g=t.radius;if(!g)return"M "+i+","+u+" l "+c+",0 l 0,"+p+" l"+-c+" 0 z";var _=PT(g);(0,b.kJ)(g)?g.length===1?_.r1=_.r2=_.r3=_.r4=g[0]:g.length===2?(_.r1=_.r3=g[0],_.r2=_.r4=g[1]):g.length===3?(_.r1=g[0],_.r2=_.r4=g[1],_.r3=g[2]):(_.r1=g[0],_.r2=g[1],_.r3=g[2],_.r4=g[3]):_.r1=_.r2=_.r3=_.r4=g;var S=[["M "+(i+_.r1)+","+u],["l "+(c-_.r1-_.r2)+",0"],["a "+_.r2+","+_.r2+",0,0,1,"+_.r2+","+_.r2],["l 0,"+(p-_.r2-_.r3)],["a "+_.r3+","+_.r3+",0,0,1,"+-_.r3+","+_.r3],["l "+(_.r3+_.r4-c)+",0"],["a "+_.r4+","+_.r4+",0,0,1,"+-_.r4+","+-_.r4],["l 0,"+(_.r4+_.r1-p)],["a "+_.r1+","+_.r1+",0,0,1,"+_.r1+","+-_.r1],["z"]];return S.join(" ")},e}(Dh),FT=OT,$o=ot(43631),jd=.3,R2={top:"before-edge",middle:"central",bottom:"after-edge",alphabetic:"baseline",hanging:"hanging"},D2={top:"text-before-edge",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",hanging:"hanging"},ny={left:"left",start:"left",center:"middle",right:"end",end:"end"},B2=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="text",t.canFill=!0,t.canStroke=!0,t}return e.prototype.getDefaultAttrs=function(){var t=r.prototype.getDefaultAttrs.call(this);return(0,P.pi)((0,P.pi)({},t),{x:0,y:0,text:null,fontSize:12,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",textAlign:"start",textBaseline:"bottom"})},e.prototype.createPath=function(t,i){var u=this,c=this.attr(),p=this.get("el");this._setFont(),(0,b.S6)(i||c,function(g,_){_==="text"?u._setText(""+g):_==="matrix"&&g?ug(u):Yo[_]&&p.setAttribute(Yo[_],g)}),p.setAttribute("paint-order","stroke"),p.setAttribute("style","stroke-linecap:butt; stroke-linejoin:miter;")},e.prototype._setFont=function(){var t=this.get("el"),i=this.attr(),u=i.textBaseline,c=i.textAlign,p=(0,$o.qY)();p&&p.name==="firefox"?t.setAttribute("dominant-baseline",D2[u]||"alphabetic"):t.setAttribute("alignment-baseline",R2[u]||"baseline"),t.setAttribute("text-anchor",ny[c]||"left")},e.prototype._setText=function(t){var i=this.get("el"),u=this.attr(),c=u.x,p=u.textBaseline,g=p===void 0?"bottom":p;if(!t)i.innerHTML="";else if(~t.indexOf(`
`)){var _=t.split(`
`),S=_.length-1,k="";(0,b.S6)(_,function(L,R){R===0?g==="alphabetic"?k+='<tspan x="'+c+'" dy="'+-S+'em">'+L+"</tspan>":g==="top"?k+='<tspan x="'+c+'" dy="0.9em">'+L+"</tspan>":g==="middle"?k+='<tspan x="'+c+'" dy="'+-(S-1)/2+'em">'+L+"</tspan>":g==="bottom"?k+='<tspan x="'+c+'" dy="-'+(S+jd)+'em">'+L+"</tspan>":g==="hanging"&&(k+='<tspan x="'+c+'" dy="'+(-(S-1)-jd)+'em">'+L+"</tspan>"):k+='<tspan x="'+c+'" dy="1em">'+L+"</tspan>"}),i.innerHTML=k}else i.innerHTML=t},e}(Dh),N2=B2,RT=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,DT=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,BT=/[\d.]+:(#[^\s]+|[^)]+\))/gi;function u1(r){var e=r.match(BT);if(!e)return"";var t="";return e.sort(function(i,u){return i=i.split(":"),u=u.split(":"),Number(i[0])-Number(u[0])}),(0,b.S6)(e,function(i){i=i.split(":"),t+='<stop offset="'+i[0]+'" stop-color="'+i[1]+'"></stop>'}),t}function z2(r,e){var t=RT.exec(r),i=(0,b.wQ)((0,b.c$)(parseFloat(t[1])),Math.PI*2),u=t[2],c,p;i>=0&&i<.5*Math.PI?(c={x:0,y:0},p={x:1,y:1}):.5*Math.PI<=i&&i<Math.PI?(c={x:1,y:0},p={x:0,y:1}):Math.PI<=i&&i<1.5*Math.PI?(c={x:1,y:1},p={x:0,y:0}):(c={x:0,y:1},p={x:1,y:0});var g=Math.tan(i),_=g*g,S=(p.x-c.x+g*(p.y-c.y))/(_+1)+c.x,k=g*(p.x-c.x+g*(p.y-c.y))/(_+1)+c.y;e.setAttribute("x1",c.x),e.setAttribute("y1",c.y),e.setAttribute("x2",S),e.setAttribute("y2",k),e.innerHTML=u1(u)}function U2(r,e){var t=DT.exec(r),i=parseFloat(t[1]),u=parseFloat(t[2]),c=parseFloat(t[3]),p=t[4];e.setAttribute("cx",i),e.setAttribute("cy",u),e.setAttribute("r",c),e.innerHTML=u1(p)}var l1=function(){function r(e){this.cfg={};var t=null,i=(0,b.EL)("gradient_");return e.toLowerCase()[0]==="l"?(t=oh("linearGradient"),z2(e,t)):(t=oh("radialGradient"),U2(e,t)),t.setAttribute("id",i),this.el=t,this.id=i,this.cfg=e,this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),Z2=l1,NT={shadowColor:"color",shadowOpacity:"opacity",shadowBlur:"blur",shadowOffsetX:"dx",shadowOffsetY:"dy"},zT={x:"-40%",y:"-40%",width:"200%",height:"200%"},V2=function(){function r(e){this.type="filter",this.cfg={},this.type="filter";var t=oh("filter");return(0,b.S6)(zT,function(i,u){t.setAttribute(u,i)}),this.el=t,this.id=(0,b.EL)("filter_"),this.el.id=this.id,this.cfg=e,this._parseShadow(e,t),this}return r.prototype.match=function(e,t){if(this.type!==e)return!1;var i=!0,u=this.cfg;return(0,b.S6)(Object.keys(u),function(c){if(u[c]!==t[c])return i=!1,!1}),i},r.prototype.update=function(e,t){var i=this.cfg;return i[NT[e]]=t,this._parseShadow(i,this.el),this},r.prototype._parseShadow=function(e,t){var i=`<feDropShadow
      dx="`+(e.dx||0)+`"
      dy="`+(e.dy||0)+`"
      stdDeviation="`+(e.blur?e.blur/10:0)+`"
      flood-color="`+(e.color?e.color:"#000")+`"
      flood-opacity="`+(e.opacity?e.opacity:1)+`"
      />`;t.innerHTML=i},r}(),UT=V2,G2=function(){function r(e,t){this.cfg={};var i=oh("marker"),u=(0,b.EL)("marker_");i.setAttribute("id",u);var c=oh("path");c.setAttribute("stroke",e.stroke||"none"),c.setAttribute("fill",e.fill||"none"),i.appendChild(c),i.setAttribute("overflow","visible"),i.setAttribute("orient","auto-start-reverse"),this.el=i,this.child=c,this.id=u;var p=e[t==="marker-start"?"startArrow":"endArrow"];return this.stroke=e.stroke||"#000",p===!0?this._setDefaultPath(t,c):(this.cfg=p,this._setMarker(e.lineWidth,c)),this}return r.prototype.match=function(){return!1},r.prototype._setDefaultPath=function(e,t){var i=this.el;t.setAttribute("d","M0,0 L"+10*Math.cos(Math.PI/6)+",5 L0,10"),i.setAttribute("refX",""+10*Math.cos(Math.PI/6)),i.setAttribute("refY",""+5)},r.prototype._setMarker=function(e,t){var i=this.el,u=this.cfg.path,c=this.cfg.d;(0,b.kJ)(u)&&(u=u.map(function(p){return p.join(" ")}).join("")),t.setAttribute("d",u),i.appendChild(t),c&&i.setAttribute("refX",""+c/e)},r.prototype.update=function(e){var t=this.child;t.attr?t.attr("fill",e):t.setAttribute("fill",e)},r}(),c1=G2,ZT=function(){function r(e){this.type="clip",this.cfg={};var t=oh("clipPath");this.el=t,this.id=(0,b.EL)("clip_"),t.id=this.id;var i=e.cfg.el;return t.appendChild(i),this.cfg=e,this}return r.prototype.match=function(){return!1},r.prototype.remove=function(){var e=this.el;e.parentNode.removeChild(e)},r}(),VT=ZT,GT=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,H2=function(){function r(e){this.cfg={};var t=oh("pattern");t.setAttribute("patternUnits","userSpaceOnUse");var i=oh("image");t.appendChild(i);var u=(0,b.EL)("pattern_");t.id=u,this.el=t,this.id=u,this.cfg=e;var c=GT.exec(e),p=c[2];i.setAttribute("href",p);var g=new Image;p.match(/^data:/i)||(g.crossOrigin="Anonymous"),g.src=p;function _(){t.setAttribute("width",""+g.width),t.setAttribute("height",""+g.height)}return g.complete?_():(g.onload=_,g.src=g.src),this}return r.prototype.match=function(e,t){return this.cfg===t},r}(),j2=H2,W2=function(){function r(e){var t=oh("defs"),i=(0,b.EL)("defs_");t.id=i,e.appendChild(t),this.children=[],this.defaultArrow={},this.el=t,this.canvas=e}return r.prototype.find=function(e,t){for(var i=this.children,u=null,c=0;c<i.length;c++)if(i[c].match(e,t)){u=i[c].id;break}return u},r.prototype.findById=function(e){for(var t=this.children,i=null,u=0;u<t.length;u++)if(t[u].id===e){i=t[u];break}return i},r.prototype.add=function(e){this.children.push(e),e.canvas=this.canvas,e.parent=this},r.prototype.getDefaultArrow=function(e,t){var i=e.stroke||e.strokeStyle;if(this.defaultArrow[i])return this.defaultArrow[i].id;var u=new c1(e,t);return this.defaultArrow[i]=u,this.el.appendChild(u.el),this.add(u),u.id},r.prototype.addGradient=function(e){var t=new Z2(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addArrow=function(e,t){var i=new c1(e,t);return this.el.appendChild(i.el),this.add(i),i.id},r.prototype.addShadow=function(e){var t=new UT(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addPattern=function(e){var t=new j2(e);return this.el.appendChild(t.el),this.add(t),t.id},r.prototype.addClip=function(e){var t=new VT(e);return this.el.appendChild(t.el),this.add(t),t.id},r}(),f1=W2,X2=function(r){(0,P.ZT)(e,r);function e(t){return r.call(this,(0,P.pi)((0,P.pi)({},t),{autoDraw:!0,renderer:"svg"}))||this}return e.prototype.getShapeBase=function(){return it},e.prototype.getGroupBase=function(){return ey},e.prototype.getShape=function(t,i,u){var c=u.target||u.srcElement;if(!ty[c.tagName]){for(var p=c.parentNode;p&&!ty[p.tagName];)p=p.parentNode;c=p}return this.find(function(g){return g.get("el")===c})},e.prototype.createDom=function(){var t=oh("svg"),i=new f1(t);return t.setAttribute("width",""+this.get("width")),t.setAttribute("height",""+this.get("height")),this.set("context",i),t},e.prototype.onCanvasChange=function(t){var i=this.get("context"),u=this.get("el");if(t==="sort"){var c=this.get("children");c&&c.length&&a1(this,function(g,_){return c.indexOf(g)-c.indexOf(_)?1:0})}else if(t==="clear"){if(u){u.innerHTML="";var p=i.el;p.innerHTML="",u.appendChild(p)}}else t==="matrix"?ug(this):t==="clip"?lg(this,i):t==="changeSize"&&(u.setAttribute("width",""+this.get("width")),u.setAttribute("height",""+this.get("height")))},e.prototype.draw=function(){var t=this.get("context"),i=this.getChildren();lg(this,t),i.length&&o1(t,i)},e}(Te.AbstractCanvas),HT=X2,Wd="0.5.6",Y2=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="path",i.shapeType="line";var u=t.connectNulls,c=u===void 0?!1:u,p=t.showSinglePoint,g=p===void 0?!0:p;return i.connectNulls=c,i.showSinglePoint=g,i}return e.prototype.updateElements=function(t,i){var u,c,p,g,_,S;i===void 0&&(i=!1);for(var k=new Map,L=new Map,R=[],U=0,G=0;G<t.length;G++){var Q=t[G],pt=this.getElementId(Q);R.push(pt),k.set(pt,Q),L.set(pt,U),U++}this.elements=new Array(U);var yt=ws(this.lastElementsMap,R),Ht=yt.added,ce=yt.updated,he=yt.removed;try{for(var ze=(0,P.XA)(Ht),Er=ze.next();!Er.done;Er=ze.next()){var pt=Er.value,Q=k.get(pt),Fr=this.getShapeFactory(),zr=this.getShapeInfo(Q),G=L.get(pt),pn=new Ws({shapeFactory:Fr,container:this.container,offscreenGroup:this.getOffscreenGroup(),elementIndex:G});pn.geometry=this,pn.animate=this.animateOption,pn.draw(zr,i),this.elementsMap[pt]=pn,this.elements[G]=pn}}catch(_o){u={error:_o}}finally{try{Er&&!Er.done&&(c=ze.return)&&c.call(ze)}finally{if(u)throw u.error}}try{for(var nn=(0,P.XA)(ce),Pn=nn.next();!Pn.done;Pn=nn.next()){var pt=Pn.value,Q=k.get(pt),pn=this.lastElementsMap[pt],G=L.get(pt),zr=this.getShapeInfo(Q),wi=pn.getModel();(this.isCoordinateChanged||jl(wi,zr))&&(pn.animate=this.animateOption,pn.update(zr)),this.elementsMap[pt]=pn,this.elements[G]=pn}}catch(_o){p={error:_o}}finally{try{Pn&&!Pn.done&&(g=nn.return)&&g.call(nn)}finally{if(p)throw p.error}}try{for(var ha=(0,P.XA)(he),Sa=ha.next();!Sa.done;Sa=ha.next()){var pt=Sa.value,pn=this.lastElementsMap[pt];pn.animate=this.animateOption,pn.destroy()}}catch(_o){_={error:_o}}finally{try{Sa&&!Sa.done&&(S=ha.return)&&S.call(ha)}finally{if(_)throw _.error}}},e.prototype.getPointsAndData=function(t){for(var i=[],u=[],c=0,p=t.length;c<p;c++){var g=t[c];i.push({x:g.x,y:g.y}),u.push(g[me])}return{points:i,data:u}},e.prototype.getShapeInfo=function(t){var i=this.getDrawCfg(t[0]),u=this.getPointsAndData(t),c=u.points,p=u.data;return i.mappingData=t,i.data=p,i.isStack=!!this.getAdjust("stack"),i.points=c,i.connectNulls=this.connectNulls,i.showSinglePoint=this.showSinglePoint,i},e}(fu),iy=Y2;function jT(r,e,t,i,u){var c=[];if(r.length){for(var p=[],g=[],_=0,S=r.length;_<S;_++){var k=r[_];p.push(k[1]),g.push(k[0])}g=g.reverse(),(0,b.S6)([p,g],function(L,R){var U=[],G=i.parsePoints(L),Q=G[0];p.length===1&&g.length===1?U=R===0?[["M",Q.x-.5,Q.y],["L",Q.x+.5,Q.y]]:[["L",Q.x+.5,Q.y],["L",Q.x-.5,Q.y]]:(e&&G.push({x:Q.x,y:Q.y}),t?U=Qs(G,!1,u):U=Xo(G,!1),R>0&&(U[0][0]="L")),c=c.concat(U)}),c.push(["Z"])}return c}function ay(r,e,t,i,u){for(var c=Us(r,e,!e,"lineWidth"),p=r.connectNulls,g=r.isInCircle,_=r.points,S=r.showSinglePoint,k=td(_,p,S),L=[],R=0,U=k.length;R<U;R++){var G=k[R];L=L.concat(jT(G,g,t,i,u))}return c.path=L,c}function $2(r){var e=r.start,t=r.end;return[[e.x,t.y],[t.x,e.y]]}var fO=ro("area",{defaultShapeType:"area",getDefaultPoints:function(r){var e=r.x,t=r.y0,i=(0,b.kJ)(r.y)?r.y:[t,r.y];return i.map(function(u){return{x:e,y:u}})}});va("area","area",{draw:function(r,e){var t=ay(r,!1,!1,this),i=e.addShape({type:"path",attrs:t,name:"area"});return i},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,fill:e,fillOpacity:1}}}});var hO=null,q2=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="area",i.shapeType="area",i.generatePoints=!0,i.startOnZero=!0;var u=t.startOnZero,c=u===void 0?!0:u,p=t.sortable,g=p===void 0?!1:p,_=t.showSinglePoint,S=_===void 0?!1:_;return i.startOnZero=c,i.sortable=g,i.showSinglePoint=S,i}return e.prototype.getPointsAndData=function(t){for(var i=[],u=[],c=0,p=t.length;c<p;c++){var g=t[c];i.push(g.points),u.push(g[me])}return{points:i,data:u}},e.prototype.getYMinValue=function(){if(this.startOnZero)return r.prototype.getYMinValue.call(this);var t=this.getYScale();return t.min},e}(iy),K2=q2,pO=ro("edge",{defaultShapeType:"line",getDefaultPoints:function(r){return dp(r)}});va("edge","line",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=Xo(this.parsePoints(r.points),this.coordinate.isPolar);return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});var dO=null,WT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="edge",t.shapeType="edge",t.generatePoints=!0,t}return e}(fu),XT=WT,YT=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="heatmap",t.paletteCache={},t}return e.prototype.updateElements=function(t,i){i===void 0&&(i=!1);for(var u=0;u<t.length;u++){var c=t[u],p=this.prepareRange(c),g=this.prepareSize(),_=(0,b.U2)(this.styleOption,["cfg","shadowBlur"]);(0,b.hj)(_)||(_=g/2),this.prepareGreyScaleBlurredCircle(g,_),this.drawWithRange(c,p,g,_)}},e.prototype.color=function(t,i){return this.createAttrOption("color",t,typeof i!="function"?i:""),this},e.prototype.clear=function(){r.prototype.clear.call(this),this.clearShadowCanvasCtx(),this.paletteCache={}},e.prototype.prepareRange=function(t){var i=this.getAttribute("color"),u=i.getFields()[0],c=1/0,p=-1/0;return t.forEach(function(g){var _=g[me][u];_>p&&(p=_),_<c&&(c=_)}),c===p&&(c=p-1),[c,p]},e.prototype.prepareSize=function(){var t=this.getDefaultValue("size");return(0,b.hj)(t)||(t=this.getDefaultSize()),t},e.prototype.prepareGreyScaleBlurredCircle=function(t,i){var u=this.getGrayScaleBlurredCanvas(),c=t+i,p=u.getContext("2d");u.width=u.height=c*2,p.clearRect(0,0,u.width,u.height),p.shadowOffsetX=p.shadowOffsetY=c*2,p.shadowBlur=i,p.shadowColor="black",p.beginPath(),p.arc(-c,-c,t,0,Math.PI*2,!0),p.closePath(),p.fill()},e.prototype.drawWithRange=function(t,i,u,c){var p,g,_=this.coordinate,S=_.start,k=_.end,L=this.coordinate.getWidth(),R=this.coordinate.getHeight(),U=this.getAttribute("color"),G=U.getFields()[0];this.clearShadowCanvasCtx();var Q=this.getShadowCanvasCtx();i&&(t=t.filter(function(nn){return nn[me][G]<=i[1]&&nn[me][G]>=i[0]}));var pt=this.scales[G];try{for(var yt=(0,P.XA)(t),Ht=yt.next();!Ht.done;Ht=yt.next()){var ce=Ht.value,he=this.getDrawCfg(ce),ze=he.x,Er=he.y,Fr=pt.scale(ce[me][G]);this.drawGrayScaleBlurredCircle(ze-S.x,Er-k.y,u+c,Fr,Q)}}catch(nn){p={error:nn}}finally{try{Ht&&!Ht.done&&(g=yt.return)&&g.call(yt)}finally{if(p)throw p.error}}var zr=Q.getImageData(0,0,L,R);this.clearShadowCanvasCtx(),this.colorize(zr),Q.putImageData(zr,0,0);var pn=this.getImageShape();pn.attr("x",S.x),pn.attr("y",k.y),pn.attr("width",L),pn.attr("height",R),pn.attr("img",Q.canvas),pn.set("origin",this.getShapeInfo(t))},e.prototype.getDefaultSize=function(){var t=this.getAttribute("position"),i=this.coordinate;return Math.min(i.getWidth()/(t.scales[0].ticks.length*4),i.getHeight()/(t.scales[1].ticks.length*4))},e.prototype.clearShadowCanvasCtx=function(){var t=this.getShadowCanvasCtx();t.clearRect(0,0,t.canvas.width,t.canvas.height)},e.prototype.getShadowCanvasCtx=function(){var t=this.shadowCanvas;return t||(t=document.createElement("canvas"),this.shadowCanvas=t),t.width=this.coordinate.getWidth(),t.height=this.coordinate.getHeight(),t.getContext("2d")},e.prototype.getGrayScaleBlurredCanvas=function(){return this.grayScaleBlurredCanvas||(this.grayScaleBlurredCanvas=document.createElement("canvas")),this.grayScaleBlurredCanvas},e.prototype.drawGrayScaleBlurredCircle=function(t,i,u,c,p){var g=this.getGrayScaleBlurredCanvas();p.globalAlpha=c,p.drawImage(g,t-u,i-u)},e.prototype.colorize=function(t){for(var i=this.getAttribute("color"),u=t.data,c=this.paletteCache,p=3;p<u.length;p+=4){var g=u[p];if((0,b.hj)(g)){var _=c[g]?c[g]:Ya.rgb2arr(i.gradient(g/256));u[p-3]=_[0],u[p-2]=_[1],u[p-1]=_[2],u[p]=g}}},e.prototype.getImageShape=function(){var t=this.imageShape;if(t)return t;var i=this.container;return t=i.addShape({type:"image",attrs:{}}),this.imageShape=t,t},e.prototype.getShapeInfo=function(t){var i=this.getDrawCfg(t[0]),u=t.map(function(c){return c[me]});return(0,P.pi)((0,P.pi)({},i),{mappingData:t,data:u})},e}(fu),Q2=YT;function oy(r){var e,t,i=r.x,u=r.y,c=r.y0,p=r.size,g,_;(0,b.kJ)(u)?(e=(0,P.CR)(u,2),g=e[0],_=e[1]):(g=c,_=u);var S,k;(0,b.kJ)(i)?(t=(0,P.CR)(i,2),S=t[0],k=t[1]):(S=i-p/2,k=i+p/2);var L=[{x:S,y:g},{x:S,y:_}];return L.push({x:k,y:_},{x:k,y:g}),L}function h1(r,e){e===void 0&&(e=!0);var t=[],i=r[0];t.push(["M",i.x,i.y]);for(var u=1,c=r.length;u<c;u++)t.push(["L",r[u].x,r[u].y]);return e&&(t.push(["L",i.x,i.y]),t.push(["z"])),t}function J2(r,e){var t=0,i=0,u=0,c=0;return(0,b.kJ)(r)?r.length===1?t=i=u=c=r[0]:r.length===2?(t=u=r[0],i=c=r[1]):r.length===3?(t=r[0],i=c=r[1],u=r[2]):(t=r[0],i=r[1],u=r[2],c=r[3]):t=i=u=c=r,t+i>e&&(t=t?e/(1+i/t):0,i=e-t),u+c>e&&(u=u?e/(1+c/u):0,c=e-u),[t||0,i||0,u||0,c||0]}function tE(r,e,t){var i=[];if(t.isRect){var u=t.isTransposed?{x:t.start.x,y:e[0].y}:{x:e[0].x,y:t.start.y},c=t.isTransposed?{x:t.end.x,y:e[2].y}:{x:e[3].x,y:t.end.y},p=(0,b.U2)(r,["background","style","radius"]);if(p){var g=t.isTransposed?Math.abs(e[0].y-e[2].y):e[2].x-e[1].x,_=t.isTransposed?t.getWidth():t.getHeight(),S=(0,P.CR)(J2(p,Math.min(g,_)),4),k=S[0],L=S[1],R=S[2],U=S[3],G=t.isTransposed&&t.isReflect("y"),Q=G?0:1,pt=function(Er){return G?-Er:Er};i.push(["M",u.x,c.y+pt(k)]),k!==0&&i.push(["A",k,k,0,0,Q,u.x+k,c.y]),i.push(["L",c.x-L,c.y]),L!==0&&i.push(["A",L,L,0,0,Q,c.x,c.y+pt(L)]),i.push(["L",c.x,u.y-pt(R)]),R!==0&&i.push(["A",R,R,0,0,Q,c.x-R,u.y]),i.push(["L",u.x+U,u.y]),U!==0&&i.push(["A",U,U,0,0,Q,u.x,u.y-pt(U)])}else i.push(["M",u.x,u.y]),i.push(["L",c.x,u.y]),i.push(["L",c.x,c.y]),i.push(["L",u.x,c.y]),i.push(["L",u.x,u.y]);i.push(["z"])}if(t.isPolar){var yt=t.getCenter(),Ht=Xp(r,t),ce=Ht.startAngle,he=Ht.endAngle;if(t.type!=="theta"&&!t.isTransposed)i=gu(yt.x,yt.y,t.getRadius(),ce,he);else{var ze=function(zr){return Math.pow(zr,2)},k=Math.sqrt(ze(yt.x-e[0].x)+ze(yt.y-e[0].y)),L=Math.sqrt(ze(yt.x-e[2].x)+ze(yt.y-e[2].y));i=gu(yt.x,yt.y,k,t.startAngle,t.endAngle,L)}}return i}function $T(r,e,t){var i=t.getWidth(),u=t.getHeight(),c=t.type==="rect",p=[],g=(r[2].x-r[1].x)/2,_=t.isTransposed?g*u/i:g*i/u;return e==="round"?(c?(p.push(["M",r[0].x,r[0].y+_]),p.push(["L",r[1].x,r[1].y-_]),p.push(["A",g,g,0,0,1,r[2].x,r[2].y-_]),p.push(["L",r[3].x,r[3].y+_]),p.push(["A",g,g,0,0,1,r[0].x,r[0].y+_])):(p.push(["M",r[0].x,r[0].y]),p.push(["L",r[1].x,r[1].y]),p.push(["A",g,g,0,0,1,r[2].x,r[2].y]),p.push(["L",r[3].x,r[3].y]),p.push(["A",g,g,0,0,1,r[0].x,r[0].y])),p.push(["z"])):p=h1(r),p}function eE(r,e,t){var i=[];return(0,b.UM)(e)?t?i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",(r[2].x+r[3].x)/2,(r[2].y+r[3].y)/2],["Z"]):i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",r[2].x,r[2].y],["L",r[3].x,r[3].y],["Z"]):i.push(["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["L",e[1].x,e[1].y],["L",e[0].x,e[0].y],["Z"]),i}function cg(r,e){return[e,r]}function rE(r,e,t){var i,u,c,p,g,_,S,k=(0,P.CR)((0,P.ev)([],(0,P.CR)(r),!1),4),L=k[0],R=k[1],U=k[2],G=k[3],Q=(0,P.CR)(typeof t=="number"?Array(4).fill(t):t,4),pt=Q[0],yt=Q[1],Ht=Q[2],ce=Q[3];e.isTransposed&&(i=(0,P.CR)(cg(R,G),2),R=i[0],G=i[1]),e.isReflect("y")&&(u=(0,P.CR)(cg(L,R),2),L=u[0],R=u[1],c=(0,P.CR)(cg(U,G),2),U=c[0],G=c[1]),e.isReflect("x")&&(p=(0,P.CR)(cg(L,G),2),L=p[0],G=p[1],g=(0,P.CR)(cg(R,U),2),R=g[0],U=g[1]);var he=[],ze=function(Er){return Math.abs(Er)};return _=(0,P.CR)(J2([pt,yt,Ht,ce],Math.min(ze(G.x-L.x),ze(R.y-L.y))).map(function(Er){return ze(Er)}),4),pt=_[0],yt=_[1],Ht=_[2],ce=_[3],e.isTransposed&&(S=(0,P.CR)([ce,pt,yt,Ht],4),pt=S[0],yt=S[1],Ht=S[2],ce=S[3]),L.y<R.y?(he.push(["M",G.x,G.y+Ht]),Ht!==0&&he.push(["A",Ht,Ht,0,0,0,G.x-Ht,G.y]),he.push(["L",L.x+ce,L.y]),ce!==0&&he.push(["A",ce,ce,0,0,0,L.x,L.y+ce]),he.push(["L",R.x,R.y-pt]),pt!==0&&he.push(["A",pt,pt,0,0,0,R.x+pt,R.y]),he.push(["L",U.x-yt,U.y]),yt!==0&&he.push(["A",yt,yt,0,0,0,U.x,U.y-yt]),he.push(["L",G.x,G.y+Ht]),he.push(["z"])):G.x<L.x?(he.push(["M",U.x+yt,U.y]),yt!==0&&he.push(["A",yt,yt,0,0,0,U.x,U.y+yt]),he.push(["L",G.x,G.y-Ht]),Ht!==0&&he.push(["A",Ht,Ht,0,0,0,G.x+Ht,G.y]),he.push(["L",L.x-ce,L.y]),ce!==0&&he.push(["A",ce,ce,0,0,0,L.x,L.y-ce]),he.push(["L",R.x,R.y+pt]),pt!==0&&he.push(["A",pt,pt,0,0,0,R.x-pt,R.y]),he.push(["L",U.x+yt,U.y]),he.push(["z"])):(he.push(["M",R.x,R.y+pt]),pt!==0&&he.push(["A",pt,pt,0,0,1,R.x+pt,R.y]),he.push(["L",U.x-yt,U.y]),yt!==0&&he.push(["A",yt,yt,0,0,1,U.x,U.y+yt]),he.push(["L",G.x,G.y-Ht]),Ht!==0&&he.push(["A",Ht,Ht,0,0,1,G.x-Ht,G.y]),he.push(["L",L.x+ce,L.y]),ce!==0&&he.push(["A",ce,ce,0,0,1,L.x,L.y-ce]),he.push(["L",R.x,R.y+pt]),he.push(["z"])),he}var vO=ro("interval",{defaultShapeType:"rect",getDefaultPoints:function(r){return oy(r)}});va("interval","rect",{draw:function(r,e){var t=Us(r,!1,!0),i=e,u=r==null?void 0:r.background;if(u){i=e.addGroup({name:"interval-group"});var c=Jt(r),p=tE(r,this.parsePoints(r.points),this.coordinate);i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},c),{path:p}),zIndex:-1,name:Es})}var g;t.radius&&this.coordinate.isRect?g=rE(this.parsePoints(r.points),this.coordinate,t.radius):g=this.parsePath($T(r.points,t.lineCap,this.coordinate));var _=i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:g}),name:"interval"});return u?i:_},getMarker:function(r){var e=r.color,t=r.isInPolar;return t?{symbol:"circle",style:{r:4.5,fill:e}}:{symbol:"square",style:{r:4,fill:e}}}});var gO=null;function qT(r,e){var t=r.length,i=r;(0,b.HD)(i[0])&&(i=r.map(function(g){return e.translate(g)}));for(var u=i[1]-i[0],c=2;c<t;c++){var p=i[c]-i[c-1];u>p&&(u=p)}return u}function KT(r,e){if(e){var t=(0,b.xH)(r),i=(0,b.I)(t,e);return i.length}return r.length}function p1(r){var e=r.theme,t=r.coordinate,i=r.getXScale(),u=i.values,c=r.beforeMappingData,p=u.length,g=th(r.coordinate),_=r.intervalPadding,S=r.dodgePadding,k=r.maxColumnWidth||e.maxColumnWidth,L=r.minColumnWidth||e.minColumnWidth,R=r.columnWidthRatio||e.columnWidthRatio,U=r.multiplePieWidthRatio||e.multiplePieWidthRatio,G=r.roseWidthRatio||e.roseWidthRatio;if(i.isLinear&&u.length>1){u.sort();var Q=qT(u,i);p=(i.max-i.min)/Q,u.length>p&&(p=u.length)}var pt=i.range,yt=1/p,Ht=1;if(t.isPolar?t.isTransposed&&p>1?Ht=U:Ht=G:(i.isLinear&&(yt*=pt[1]-pt[0]),Ht=R),!(0,b.UM)(_)&&_>=0){var ce=_/g;yt=(1-(p-1)*ce)/p}else yt*=Ht;if(r.getAdjust("dodge")){var he=r.getAdjust("dodge"),ze=he.dodgeBy,Er=KT(c,ze);if(!(0,b.UM)(S)&&S>=0){var Fr=S/g;yt=(yt-Fr*(Er-1))/Er}else!(0,b.UM)(_)&&_>=0&&(yt*=Ht),yt=yt/Er;yt=yt>=0?yt:0}if(!(0,b.UM)(k)&&k>=0){var zr=k/g;yt>zr&&(yt=zr)}if(!(0,b.UM)(L)&&L>=0){var pn=L/g;yt<pn&&(yt=pn)}return yt}var nE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="interval",i.shapeType="interval",i.generatePoints=!0;var u=t.background;return i.background=u,i}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u,c=this.getAttribute("size");if(c){u=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=th(p);u=u/g}else this.defaultSize||(this.defaultSize=p1(this)),u=this.defaultSize;return i.size=u,i},e.prototype.adjustScale=function(){r.prototype.adjustScale.call(this);var t=this.getYScale();if(this.coordinate.type==="theta")t.change({nice:!1,min:0,max:Dn(t)});else{var i=this.scaleDefs,u=t.field,c=t.min,p=t.max,g=t.type;g!=="time"&&(c>0&&!(0,b.U2)(i,[u,"min"])&&t.change({min:0}),p<=0&&!(0,b.U2)(i,[u,"max"])&&t.change({max:0}))}},e.prototype.getDrawCfg=function(t){var i=r.prototype.getDrawCfg.call(this,t);return i.background=this.background,i},e}(fu),iE=nE,QT=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;i.type="line";var u=t.sortable,c=u===void 0?!1:u;return i.sortable=c,i}return e}(iy),JT=QT,aE=["circle","square","bowtie","diamond","hexagon","triangle","triangle-down"],tM=["cross","tick","plus","hyphen","line"];function d1(r,e,t,i,u){var c,p,g=Us(e,u,!u,"r"),_=r.parsePoints(e.points),S=_[0];if(e.isStack)S=_[1];else if(_.length>1){var k=t.addGroup();try{for(var L=(0,P.XA)(_),R=L.next();!R.done;R=L.next()){var U=R.value;k.addShape({type:"marker",attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{symbol:yc[i]||i}),U)})}}catch(G){c={error:G}}finally{try{R&&!R.done&&(p=L.return)&&p.call(L)}finally{if(c)throw c.error}}return k}return t.addShape({type:"marker",attrs:(0,P.pi)((0,P.pi)((0,P.pi)({},g),{symbol:yc[i]||i}),S)})}var eM=ro("point",{defaultShapeType:"hollow-circle",getDefaultPoints:function(r){return dp(r)}});(0,b.S6)(aE,function(r){va("point","hollow-".concat(r),{draw:function(e,t){return d1(this,e,t,r,!0)},getMarker:function(e){var t=e.color;return{symbol:yc[r]||r,style:{r:4.5,stroke:t,fill:null}}}})});var rM=null,nM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="point",t.shapeType="point",t.generatePoints=!0,t}return e.prototype.getDrawCfg=function(t){var i=r.prototype.getDrawCfg.call(this,t);return(0,P.pi)((0,P.pi)({},i),{isStack:!!this.getAdjust("stack")})},e}(fu),iM=nM;function aM(r){for(var e=r[0],t=1,i=[["M",e.x,e.y]];t<r.length;){var u=r[t];(u.x!==r[t-1].x||u.y!==r[t-1].y)&&(i.push(["L",u.x,u.y]),u.x===e.x&&u.y===e.y&&t<r.length-1&&(e=r[t+1],i.push(["Z"]),i.push(["M",e.x,e.y]),t++)),t++}return(0,b.Xy)((0,b.Z$)(i),e)||i.push(["L",e.x,e.y]),i.push(["Z"]),i}var mO=ro("polygon",{defaultShapeType:"polygon",getDefaultPoints:function(r){var e=[];return(0,b.S6)(r.x,function(t,i){var u=r.y[i];e.push({x:t,y:u})}),e}});va("polygon","polygon",{draw:function(r,e){if(!(0,b.xb)(r.points)){var t=Us(r,!0,!0),i=this.parsePath(aM(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"polygon"})}},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}});var yO=null,oE=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="polygon",t.shapeType="polygon",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u=i.x,c=i.y,p;if(!((0,b.kJ)(u)&&(0,b.kJ)(c))){var g=this.getXScale(),_=this.getYScale(),S=g.values.length,k=_.values.length,L=.5*1/S,R=.5*1/k;g.isCategory&&_.isCategory?(u=[u-L,u-L,u+L,u+L],c=[c-R,c+R,c+R,c-R]):(0,b.kJ)(u)?(p=u,u=[p[0],p[0],p[1],p[1]],c=[c-R/2,c+R/2,c+R/2,c-R/2]):(0,b.kJ)(c)&&(p=c,c=[p[0],p[1],p[1],p[0]],u=[u-L/2,u-L/2,u+L/2,u+L/2]),i.x=u,i.y=c}return i},e}(fu),sE=oE,_O=ro("schema",{defaultShapeType:""}),xO=null,oM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="schema",t.shapeType="schema",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u,c=this.getAttribute("size");if(c){u=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=th(p);u=u/g}else this.defaultSize||(this.defaultSize=p1(this)),u=this.defaultSize;return i.size=u,i},e}(fu),sM=oM;function uM(r){if(!(0,b.kJ)(r))return[];var e=(0,b.Fp)(r);return(0,b.UI)(r,function(t){return t/e})}var lM=ro("violin",{defaultShapeType:"violin",getDefaultPoints:function(r){var e=r.size/2,t=[],i=uM(r._size);return(0,b.S6)(r.y,function(u,c){var p=i[c]*e,g=c===0,_=c===r.y.length-1;t.push({isMin:g,isMax:_,x:r.x-p,y:u}),t.unshift({isMin:g,isMax:_,x:r.x+p,y:u})}),t}});va("violin","violin",{draw:function(r,e){var t=Us(r,!0,!0),i=this.parsePath(Sv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"violin"})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:e}}}});var cM=null,fM=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="violin",t.shapeType="violin",t.generatePoints=!0,t}return e.prototype.createShapePointsCfg=function(t){var i=r.prototype.createShapePointsCfg.call(this,t),u,c=this.getAttribute("size");if(c){u=this.getAttributeValues(c,t)[0];var p=this.coordinate,g=th(p);u=u/g}else this.defaultSize||(this.defaultSize=p1(this)),u=this.defaultSize;return i.size=u,i._size=(0,b.U2)(t[me],[this._sizeField]),i},e.prototype.initAttributes=function(){var t=this.attributeOption,i=t.size?t.size.fields[0]:this._sizeField?this._sizeField:"size";this._sizeField=i,delete t.size,r.prototype.initAttributes.call(this)},e}(fu),hM=fM;va("area","line",{draw:function(r,e){var t=ay(r,!0,!1,this),i=e.addShape({type:"path",attrs:t,name:"area"});return i},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,stroke:e,fill:null}}}}),va("area","smooth",{draw:function(r,e){var t=this.coordinate,i=ay(r,!1,!0,this,$2(t)),u=e.addShape({type:"path",attrs:i,name:"area"});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,fill:e,fillOpacity:1}}}}),va("area","smooth-line",{draw:function(r,e){var t=this.coordinate,i=ay(r,!0,!0,this,$2(t)),u=e.addShape({type:"path",attrs:i,name:"area"});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return u===void 0&&(u=5.5),[["M",t-u,i-4],["L",t+u,i-4],["L",t+u,i+4],["L",t-u,i+4],["Z"]]},style:{r:5,stroke:e,fill:null}}}});function v1(r,e){return["C",r.x*1/2+e.x*1/2,r.y,r.x*1/2+e.x*1/2,e.y,e.x,e.y]}function g1(r,e){var t=[];t.push({x:e.x,y:e.y}),t.push(r);var i=["Q"];return(0,b.S6)(t,function(u){i.push(u.x,u.y)}),i}function pM(r,e,t){var i=g1(e,t),u=[["M",r.x,r.y]];return u.push(i),u}function uE(r,e){var t=g1(r[1],e),i=g1(r[3],e),u=[["M",r[0].x,r[0].y]];return u.push(i),u.push(["L",r[3].x,r[3].y]),u.push(["L",r[2].x,r[2].y]),u.push(t),u.push(["L",r[1].x,r[1].y]),u.push(["L",r[0].x,r[0].y]),u.push(["Z"]),u}va("edge","arc",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=r.points,u=i.length>2?"weight":"normal",c;if(r.isInCircle){var p={x:0,y:1};return u==="normal"?c=pM(i[0],i[1],p):(t.fill=t.stroke,c=uE(i,p)),c=this.parsePath(c),e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})})}else{if(u==="normal")return i=this.parsePoints(i),c=W0((i[1].x+i[0].x)/2,i[0].y,Math.abs(i[1].x-i[0].x)/2,Math.PI,Math.PI*2),e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})});var g=v1(i[1],i[3]),_=v1(i[2],i[0]);return c=[["M",i[0].x,i[0].y],["L",i[1].x,i[1].y],g,["L",i[3].x,i[3].y],["L",i[2].x,i[2].y],_,["Z"]],c=this.parsePath(c),t.fill=t.stroke,e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:c})})}},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});function lE(r,e){var t=v1(r,e),i=[["M",r.x,r.y]];return i.push(t),i}va("edge","smooth",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=r.points,u=this.parsePath(lE(i[0],i[1]));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:u})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}});var sy=1/3;function dM(r,e){var t=[];t.push({x:r.x,y:r.y*(1-sy)+e.y*sy}),t.push({x:e.x,y:r.y*(1-sy)+e.y*sy}),t.push(e);var i=[["M",r.x,r.y]];return(0,b.S6)(t,function(u){i.push(["L",u.x,u.y])}),i}va("edge","vhv",{draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=r.points,u=this.parsePath(dM(i[0],i[1]));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:u})})},getMarker:function(r){return{symbol:"circle",style:{r:4.5,fill:r.color}}}}),va("interval","funnel",{getPoints:function(r){return r.size=r.size*2,oy(r)},draw:function(r,e){var t=Us(r,!1,!0),i=this.parsePath(eE(r.points,r.nextPoints,!1)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return u},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}}),va("interval","hollow-rect",{draw:function(r,e){var t=Us(r,!0,!1),i=e,u=r==null?void 0:r.background;if(u){i=e.addGroup();var c=Jt(r),p=tE(r,this.parsePoints(r.points),this.coordinate);i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},c),{path:p}),zIndex:-1,name:Es})}var g=this.parsePath(h1(r.points)),_=i.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:g}),name:"interval"});return u?i:_},getMarker:function(r){var e=r.color,t=r.isInPolar;return t?{symbol:"circle",style:{r:4.5,stroke:e,fill:null}}:{symbol:"square",style:{r:4,stroke:e,fill:null}}}});function vM(r){var e=r.x,t=r.y,i=r.y0;return(0,b.kJ)(t)?t.map(function(u,c){return{x:(0,b.kJ)(e)?e[c]:e,y:u}}):[{x:e,y:i},{x:e,y:t}]}va("interval","line",{getPoints:function(r){return vM(r)},draw:function(r,e){var t=Us(r,!0,!1,"lineWidth"),i=ic((0,P.pi)({},t),["fill"]),u=this.parsePath(h1(r.points,!1)),c=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},i),{path:u}),name:"interval"});return c},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return[["M",t,i-u],["L",t,i+u]]},style:{r:5,stroke:e}}}}),va("interval","pyramid",{getPoints:function(r){return r.size=r.size*2,oy(r)},draw:function(r,e){var t=Us(r,!1,!0),i=this.parsePath(eE(r.points,r.nextPoints,!0)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return u},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}});function gM(r){var e,t=r.x,i=r.y,u=r.y0,c=r.size,p,g;(0,b.kJ)(i)?(e=(0,P.CR)(i,2),p=e[0],g=e[1]):(p=u,g=i);var _=t+c/2,S=t-c/2;return[{x:t,y:p},{x:t,y:g},{x:S,y:p},{x:_,y:p},{x:S,y:g},{x:_,y:g}]}function mM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["M",r[4].x,r[4].y],["L",r[5].x,r[5].y]]}va("interval","tick",{getPoints:function(r){return gM(r)},draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(mM(r.points)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i}),name:"interval"});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){return[["M",t-u/2,i-u],["L",t+u/2,i-u],["M",t,i-u],["L",t,i+u],["M",t-u/2,i+u],["L",t+u/2,i+u]]},style:{r:5,stroke:e}}}});var cE=function(r,e,t){var i=r.x,u=r.y,c=e.x,p=e.y,g;switch(t){case"hv":g=[{x:c,y:u}];break;case"vh":g=[{x:i,y:p}];break;case"hvh":var _=(c+i)/2;g=[{x:_,y:u},{x:_,y:p}];break;case"vhv":var S=(u+p)/2;g=[{x:i,y:S},{x:c,y:S}];break;default:break}return g};function fE(r,e){var t=[];return(0,b.S6)(r,function(i,u){var c=r[u+1];if(t.push(i),c){var p=cE(i,c,e);t=t.concat(p)}}),t}function hE(r){return r.map(function(e,t){return t===0?["M",e.x,e.y]:["L",e.x,e.y]})}function pE(r,e){var t=td(r.points,r.connectNulls,r.showSinglePoint),i=[];return(0,b.S6)(t,function(u){var c=fE(u,e);i=i.concat(hE(c))}),(0,P.pi)((0,P.pi)({},Us(r,!0,!1,"lineWidth")),{path:i})}(0,b.S6)(["hv","vh","hvh","vhv"],function(r){va("line",r,{draw:function(e,t){var i=pE(e,r),u=t.addShape({type:"path",attrs:i,name:"line"});return u},getMarker:function(e){return vp(e,r)}})}),(0,b.S6)(tM,function(r){va("point",r,{draw:function(e,t){return d1(this,e,t,r,!0)},getMarker:function(e){var t=e.color;return{symbol:yc[r],style:{r:4.5,stroke:t,fill:null}}}})}),va("point","image",{draw:function(r,e){var t,i,u=Us(r,!1,!1,"r").r,c=this.parsePoints(r.points),p=c[0];if(r.isStack)p=c[1];else if(c.length>1){var g=e.addGroup();try{for(var _=(0,P.XA)(c),S=_.next();!S.done;S=_.next()){var k=S.value;g.addShape("image",{attrs:{x:k.x-u/2,y:k.y-u,width:u,height:u,img:r.shape[1]}})}}catch(L){t={error:L}}finally{try{S&&!S.done&&(i=_.return)&&i.call(_)}finally{if(t)throw t.error}}return g}return e.addShape("image",{attrs:{x:p.x-u/2,y:p.y-u,width:u,height:u,img:r.shape[1]}})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4.5,fill:e}}}}),(0,b.S6)(aE,function(r){va("point",r,{draw:function(e,t){return d1(this,e,t,r,!1)},getMarker:function(e){var t=e.color;return{symbol:yc[r]||r,style:{r:4.5,fill:t}}}})});function h0(r){var e=(0,b.kJ)(r)?r:[r],t=e[0],i=e[e.length-1],u=e.length>1?e[1]:t,c=e.length>3?e[3]:i,p=e.length>2?e[2]:u;return{min:t,max:i,min1:u,max1:c,median:p}}function m1(r,e,t){var i=t/2,u;if((0,b.kJ)(e)){var c=h0(e),p=c.min,g=c.max,_=c.median,S=c.min1,k=c.max1,L=r-i,R=r+i;u=[[L,g],[R,g],[r,g],[r,k],[L,S],[L,k],[R,k],[R,S],[r,S],[r,p],[L,p],[R,p],[L,_],[R,_]]}else{e=(0,b.UM)(e)?.5:e;var U=h0(r),p=U.min,g=U.max,_=U.median,S=U.min1,k=U.max1,G=e-i,Q=e+i;u=[[p,G],[p,Q],[p,e],[S,e],[S,G],[S,Q],[k,Q],[k,G],[k,e],[g,e],[g,G],[g,Q],[_,G],[_,Q]]}return u.map(function(pt){return{x:pt[0],y:pt[1]}})}function yM(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["M",r[4].x,r[4].y],["L",r[5].x,r[5].y],["L",r[6].x,r[6].y],["L",r[7].x,r[7].y],["L",r[4].x,r[4].y],["Z"],["M",r[8].x,r[8].y],["L",r[9].x,r[9].y],["M",r[10].x,r[10].y],["L",r[11].x,r[11].y],["M",r[12].x,r[12].y],["L",r[13].x,r[13].y]]}va("schema","box",{getPoints:function(r){var e=r.x,t=r.y,i=r.size;return m1(e,t,i)},draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(yM(r.points)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i,name:"schema"})});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){var c=[i-6,i-3,i,i+3,i+6],p=m1(t,c,u);return[["M",p[0].x+1,p[0].y],["L",p[1].x-1,p[1].y],["M",p[2].x,p[2].y],["L",p[3].x,p[3].y],["M",p[4].x,p[4].y],["L",p[5].x,p[5].y],["L",p[6].x,p[6].y],["L",p[7].x,p[7].y],["L",p[4].x,p[4].y],["Z"],["M",p[8].x,p[8].y],["L",p[9].x,p[9].y],["M",p[10].x+1,p[10].y],["L",p[11].x-1,p[11].y],["M",p[12].x,p[12].y],["L",p[13].x,p[13].y]]},style:{r:6,lineWidth:1,stroke:e}}}});function dE(r){var e=(0,b.kJ)(r)?r:[r],t=e.sort(function(i,u){return u-i});return n0(t,4,t[t.length-1])}function y1(r,e,t){var i=dE(e);return[{x:r,y:i[0]},{x:r,y:i[1]},{x:r-t/2,y:i[2]},{x:r-t/2,y:i[1]},{x:r+t/2,y:i[1]},{x:r+t/2,y:i[2]},{x:r,y:i[2]},{x:r,y:i[3]}]}function _M(r){return[["M",r[0].x,r[0].y],["L",r[1].x,r[1].y],["M",r[2].x,r[2].y],["L",r[3].x,r[3].y],["L",r[4].x,r[4].y],["L",r[5].x,r[5].y],["Z"],["M",r[6].x,r[6].y],["L",r[7].x,r[7].y]]}va("schema","candle",{getPoints:function(r){var e=r.x,t=r.y,i=r.size;return y1(e,t,i)},draw:function(r,e){var t=Us(r,!0,!0),i=this.parsePath(_M(r.points)),u=e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i,name:"schema"})});return u},getMarker:function(r){var e=r.color;return{symbol:function(t,i,u){var c=[i+7.5,i+3,i-3,i-7.5],p=y1(t,c,u);return[["M",p[0].x,p[0].y],["L",p[1].x,p[1].y],["M",p[2].x,p[2].y],["L",p[3].x,p[3].y],["L",p[4].x,p[4].y],["L",p[5].x,p[5].y],["Z"],["M",p[6].x,p[6].y],["L",p[7].x,p[7].y]]},style:{lineWidth:1,stroke:e,fill:e,r:6}}}});function xM(r,e){var t=Math.abs(r[0].x-r[2].x),i=Math.abs(r[0].y-r[2].y),u=Math.min(t,i);e&&(u=(0,b.uZ)(e,0,Math.min(t,i))),u=u/2;var c=(r[0].x+r[2].x)/2,p=(r[0].y+r[2].y)/2;return{x:c-u,y:p-u,width:u*2,height:u*2}}va("polygon","square",{draw:function(r,e){if(!(0,b.xb)(r.points)){var t=Us(r,!0,!0),i=this.parsePoints(r.points);return e.addShape("rect",{attrs:(0,P.pi)((0,P.pi)({},t),xM(i,r.size)),name:"polygon"})}},getMarker:function(r){var e=r.color;return{symbol:"square",style:{r:4,fill:e}}}}),va("violin","smooth",{draw:function(r,e){var t=Us(r,!0,!0),i=this.parsePath(o0(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{stroke:null,r:4,fill:e}}}}),va("violin","hollow",{draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(Sv(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:null,stroke:e}}}}),va("violin","hollow-smooth",{draw:function(r,e){var t=Us(r,!0,!1),i=this.parsePath(o0(r.points));return e.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},t),{path:i})})},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{r:4,fill:null,stroke:e}}}});var bM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelValueDir=function(t){var i="y",u=t.points;return u[0][i]<=u[2][i]?1:-1},e.prototype.getLabelOffsetPoint=function(t,i,u,c){var p,g=r.prototype.getLabelOffsetPoint.call(this,t,i,u),_=this.getCoordinate(),S=_.isTransposed,k=S?"x":"y",L=this.getLabelValueDir(t.mappingData);return g=(0,P.pi)((0,P.pi)({},g),(p={},p[k]=g[k]*L,p)),_.isReflect("x")&&(g=(0,P.pi)((0,P.pi)({},g),{x:g.x*-1})),_.isReflect("y")&&(g=(0,P.pi)((0,P.pi)({},g),{y:g.y*-1})),g},e.prototype.getThemedLabelCfg=function(t){var i=this.geometry,u=this.getDefaultLabelCfg(),c=i.theme;return(0,b.b$)({},u,c.labels,t.position==="middle"?{offset:0}:{},t)},e.prototype.setLabelPosition=function(t,i,u,c){var p=this.getCoordinate(),g=p.isTransposed,_=i.points,S=p.convert(_[0]),k=p.convert(_[2]),L=this.getLabelValueDir(i),R,U,G,Q,pt=(0,b.kJ)(i.shape)?i.shape[0]:i.shape;if(pt==="funnel"||pt==="pyramid"){var yt=(0,b.U2)(i,"nextPoints"),Ht=(0,b.U2)(i,"points");if(yt){var ce=p.convert(Ht[0]),he=p.convert(Ht[1]),ze=p.convert(yt[0]),Er=p.convert(yt[1]);g?(R=Math.min(ze.y,ce.y),G=Math.max(ze.y,ce.y),U=(he.x+Er.x)/2,Q=(ce.x+ze.x)/2):(R=Math.min((he.y+Er.y)/2,(ce.y+ze.y)/2),G=Math.max((he.y+Er.y)/2,(ce.y+ze.y)/2),U=Er.x,Q=ce.x)}else R=Math.min(k.y,S.y),G=Math.max(k.y,S.y),U=k.x,Q=S.x}else R=Math.min(k.y,S.y),G=Math.max(k.y,S.y),U=k.x,Q=S.x;switch(c){case"right":t.x=U,t.y=(R+G)/2,t.textAlign=(0,b.U2)(t,"textAlign",L>0?"left":"right");break;case"left":t.x=Q,t.y=(R+G)/2,t.textAlign=(0,b.U2)(t,"textAlign",L>0?"left":"right");break;case"bottom":g&&(t.x=(U+Q)/2),t.y=G,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline",L>0?"bottom":"top");break;case"middle":g&&(t.x=(U+Q)/2),t.y=(R+G)/2,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline","middle");break;case"top":g&&(t.x=(U+Q)/2),t.y=R,t.textAlign=(0,b.U2)(t,"textAlign","center"),t.textBaseline=(0,b.U2)(t,"textBaseline",L>0?"bottom":"top");break;default:break}},e}(zd),vE=bM,em=Math.PI/2,gE=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelOffset=function(t){var i=this.getCoordinate(),u=0;if((0,b.hj)(t))u=t;else if((0,b.HD)(t)&&t.indexOf("%")!==-1){var c=i.getRadius();i.innerRadius>0&&(c=c*(1-i.innerRadius)),u=parseFloat(t)*.01*c}return u},e.prototype.getLabelItems=function(t){var i=r.prototype.getLabelItems.call(this,t),u=this.geometry.getYScale();return(0,b.UI)(i,function(c){if(c&&u){var p=u.scale((0,b.U2)(c.data,u.field));return(0,P.pi)((0,P.pi)({},c),{percent:p})}return c})},e.prototype.getLabelAlign=function(t){var i=this.getCoordinate(),u;if(t.labelEmit)u=t.angle<=Math.PI/2&&t.angle>=-Math.PI/2?"left":"right";else if(!i.isTransposed)u="center";else{var c=i.getCenter(),p=t.offset;Math.abs(t.x-c.x)<1?u="center":t.angle>Math.PI||t.angle<=0?u=p>0?"left":"right":u=p>0?"right":"left"}return u},e.prototype.getLabelPoint=function(t,i,u){var c=1,p,g=t.content[u];this.isToMiddle(i)?p=this.getMiddlePoint(i.points):(t.content.length===1&&u===0?u=1:u===0&&(c=-1),p=this.getArcPoint(i,u));var _=t.offset*c,S=this.getPointAngle(p),k=t.labelEmit,L=this.getCirclePoint(S,_,p,k);return L.r===0?L.content="":(L.content=g,L.angle=S,L.color=i.color),L.rotate=t.autoRotate?this.getLabelRotate(S,_,k):t.rotate,L.start={x:p.x,y:p.y},L},e.prototype.getArcPoint=function(t,i){return i===void 0&&(i=0),!(0,b.kJ)(t.x)&&!(0,b.kJ)(t.y)?{x:t.x,y:t.y}:{x:(0,b.kJ)(t.x)?t.x[i]:t.x,y:(0,b.kJ)(t.y)?t.y[i]:t.y}},e.prototype.getPointAngle=function(t){return uf(this.getCoordinate(),t)},e.prototype.getCirclePoint=function(t,i,u,c){var p=this.getCoordinate(),g=p.getCenter(),_=$p(p,u);if(_===0)return(0,P.pi)((0,P.pi)({},g),{r:_});var S=t;if(p.isTransposed&&_>i&&!c){var k=Math.asin(i/(2*_));S=t+k*2}else _=_+i;return{x:g.x+_*Math.cos(S),y:g.y+_*Math.sin(S),r:_}},e.prototype.getLabelRotate=function(t,i,u){var c=t+em;return u&&(c-=em),c&&(c>em?c=c-Math.PI:c<-em&&(c=c+Math.PI)),c},e.prototype.getMiddlePoint=function(t){var i=this.getCoordinate(),u=t.length,c={x:0,y:0};return(0,b.S6)(t,function(p){c.x+=p.x,c.y+=p.y}),c.x/=u,c.y/=u,c=i.convert(c),c},e.prototype.isToMiddle=function(t){return t.x.length>2},e}(zd),uy=gE,mE=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.defaultLayout="distribute",t}return e.prototype.getDefaultLabelCfg=function(t,i){var u=r.prototype.getDefaultLabelCfg.call(this,t,i);return(0,b.b$)({},u,(0,b.U2)(this.geometry.theme,"pieLabels",{}))},e.prototype.getLabelOffset=function(t){return r.prototype.getLabelOffset.call(this,t)||0},e.prototype.getLabelRotate=function(t,i,u){var c;return i<0&&(c=t,c>Math.PI/2&&(c=c-Math.PI),c<-Math.PI/2&&(c=c+Math.PI)),c},e.prototype.getLabelAlign=function(t){var i=this.getCoordinate(),u=i.getCenter(),c;return t.angle<=Math.PI/2&&t.x>=u.x?c="left":c="right",t.offset<=0&&(c==="right"?c="left":c="right"),c},e.prototype.getArcPoint=function(t){return t},e.prototype.getPointAngle=function(t){var i=this.getCoordinate(),u={x:(0,b.kJ)(t.x)?t.x[0]:t.x,y:t.y[0]},c={x:(0,b.kJ)(t.x)?t.x[1]:t.x,y:t.y[1]},p,g=uf(i,u);if(t.points&&t.points[0].y===t.points[1].y)p=g;else{var _=uf(i,c);g>=_&&(_=_+Math.PI*2),p=g+(_-g)/2}return p},e.prototype.getCirclePoint=function(t,i){var u=this.getCoordinate(),c=u.getCenter(),p=u.getRadius()+i;return(0,P.pi)((0,P.pi)({},co(c.x,c.y,p,t)),{angle:t,r:p})},e}(uy),EM=mE,yE=4;function wM(r,e,t,i,u,c){var p,g,_=!0,S=i.start,k=i.end,L=Math.min(S.y,k.y),R=Math.abs(S.y-k.y),U,G=0,Q=Number.MIN_VALUE,pt=e.map(function(Fr){return Fr.y>G&&(G=Fr.y),Fr.y<Q&&(Q=Fr.y),{size:t,targets:[Fr.y-L]}});for(Q-=L,G-L>R&&(R=G-L);_;)for(pt.forEach(function(Fr){var zr=(Math.min.apply(Q,Fr.targets)+Math.max.apply(Q,Fr.targets))/2;Fr.pos=Math.min(Math.max(Q,zr-Fr.size/2),R-Fr.size)}),_=!1,U=pt.length;U--;)if(U>0){var yt=pt[U-1],Ht=pt[U];yt.pos+yt.size>Ht.pos&&(yt.size+=Ht.size,yt.targets=yt.targets.concat(Ht.targets),yt.pos+yt.size>R&&(yt.pos=R-yt.size),pt.splice(U,1),_=!0)}U=0,pt.forEach(function(Fr){var zr=L+t/2;Fr.targets.forEach(function(){e[U].y=Fr.pos+zr,zr+=t,U++})});var ce={};try{for(var he=(0,P.XA)(r),ze=he.next();!ze.done;ze=he.next()){var Er=ze.value;ce[Er.get("id")]=Er}}catch(Fr){p={error:Fr}}finally{try{ze&&!ze.done&&(g=he.return)&&g.call(he)}finally{if(p)throw p.error}}e.forEach(function(Fr){var zr=Fr.r*Fr.r,pn=Math.pow(Math.abs(Fr.y-u.y),2);if(zr<pn)Fr.x=u.x;else{var nn=Math.sqrt(zr-pn);c?Fr.x=u.x+nn:Fr.x=u.x-nn}var Pn=ce[Fr.id];Pn.attr("x",Fr.x),Pn.attr("y",Fr.y);var wi=(0,b.sE)(Pn.getChildren(),function(ha){return ha.get("type")==="text"});wi&&(wi.attr("y",Fr.y),wi.attr("x",Fr.x))})}function _E(r,e,t,i){if(!(!r.length||!e.length)){var u=r[0]?r[0].offset:0,c=e[0].get("coordinate"),p=c.getRadius(),g=c.getCenter();if(u>0){var _=14,S=p+u,k=S*2+_*2,L={start:c.start,end:c.end},R=[[],[]];r.forEach(function(U){!U||(U.textAlign==="right"?R[0].push(U):R[1].push(U))}),R.forEach(function(U,G){var Q=k/_;U.length>Q&&(U.sort(function(pt,yt){return yt["..percent"]-pt["..percent"]}),U.splice(Q,U.length-Q)),U.sort(function(pt,yt){return pt.y-yt.y}),wM(e,U,_,L,g,G)})}(0,b.S6)(r,function(U){if(U&&U.labelLine){var G=U.offset,Q=U.angle,pt=co(g.x,g.y,p,Q),yt=co(g.x,g.y,p+G/2,Q),Ht=U.x+(0,b.U2)(U,"offsetX",0),ce=U.y+(0,b.U2)(U,"offsetY",0),he={x:Ht-Math.cos(Q)*yE,y:ce-Math.sin(Q)*yE};(0,b.Kn)(U.labelLine)||(U.labelLine={}),U.labelLine.path=["M ".concat(pt.x),"".concat(pt.y," Q").concat(yt.x),"".concat(yt.y," ").concat(he.x),he.y].join(",")}})}}function xE(r,e,t){var i=r.filter(function(G){return!G.invisible});i.sort(function(G,Q){return G.y-Q.y});var u=!0,c=t.minY,p=t.maxY,g=Math.abs(c-p),_,S=0,k=Number.MIN_VALUE,L=i.map(function(G){return G.y>S&&(S=G.y),G.y<k&&(k=G.y),{content:G.content,size:e,targets:[G.y-c],pos:null}});for(k-=c,S-c>g&&(g=S-c);u;)for(L.forEach(function(G){var Q=(Math.min.apply(k,G.targets)+Math.max.apply(k,G.targets))/2;G.pos=Math.min(Math.max(k,Q-G.size/2),g-G.size),G.pos=Math.max(0,G.pos)}),u=!1,_=L.length;_--;)if(_>0){var R=L[_-1],U=L[_];R.pos+R.size>U.pos&&(R.size+=U.size,R.targets=R.targets.concat(U.targets),R.pos+R.size>g&&(R.pos=g-R.size),L.splice(_,1),u=!0)}_=0,L.forEach(function(G){var Q=c+e/2;G.targets.forEach(function(){i[_].y=G.pos+Q,Q+=e,_++})})}var _1=4;function SM(r,e){var t=e.getCenter(),i=e.getRadius();if(r&&r.labelLine){var u=r.angle,c=r.offset,p=co(t.x,t.y,i,u),g=r.x+(0,b.U2)(r,"offsetX",0)*(Math.cos(u)>0?1:-1),_=r.y+(0,b.U2)(r,"offsetY",0)*(Math.sin(u)>0?1:-1),S={x:g-Math.cos(u)*_1,y:_-Math.sin(u)*_1},k=r.labelLine.smooth,L=[],R=S.x-t.x,U=S.y-t.y,G=Math.atan(U/R);if(R<0&&(G+=Math.PI),k===!1){(0,b.Kn)(r.labelLine)||(r.labelLine={});var Q=0;(u<0&&u>-Math.PI/2||u>Math.PI*1.5)&&S.y>p.y&&(Q=1),u>=0&&u<Math.PI/2&&S.y>p.y&&(Q=1),u>=Math.PI/2&&u<Math.PI&&p.y>S.y&&(Q=1),(u<-Math.PI/2||u>=Math.PI&&u<Math.PI*1.5)&&p.y>S.y&&(Q=1);var pt=c/2>4?4:Math.max(c/2-1,0),yt=co(t.x,t.y,i+pt,u),Ht=co(t.x,t.y,i+c/2,G),ce=0;L.push("M ".concat(p.x," ").concat(p.y)),L.push("L ".concat(yt.x," ").concat(yt.y)),L.push("A ".concat(t.x," ").concat(t.y," 0 ").concat(ce," ").concat(Q," ").concat(Ht.x," ").concat(Ht.y)),L.push("L ".concat(S.x," ").concat(S.y))}else{var yt=co(t.x,t.y,i+(c/2>4?4:Math.max(c/2-1,0)),u),he=p.x<t.x?1:-1;L.push("M ".concat(S.x," ").concat(S.y));var ze=(p.y-t.y)/(p.x-t.x),Er=(S.y-t.y)/(S.x-t.x);Math.abs(ze-Er)>Math.pow(Math.E,-16)&&L.push.apply(L,["C",S.x+he*4,S.y,2*yt.x-p.x,2*yt.y-p.y,p.x,p.y]),L.push("L ".concat(p.x," ").concat(p.y))}r.labelLine.path=L.join(" ")}}function CM(r,e,t,i){var u,c,p=(0,b.hX)(r,function(zr){return!(0,b.UM)(zr)}),g=e[0]&&e[0].get("coordinate");if(!!g){var _=g.getCenter(),S=g.getRadius(),k={};try{for(var L=(0,P.XA)(e),R=L.next();!R.done;R=L.next()){var U=R.value;k[U.get("id")]=U}}catch(zr){u={error:zr}}finally{try{R&&!R.done&&(c=L.return)&&c.call(L)}finally{if(u)throw u.error}}var G=(0,b.U2)(p[0],"labelHeight",14),Q=(0,b.U2)(p[0],"offset",0);if(!(Q<=0)){var pt="left",yt="right",Ht=(0,b.vM)(p,function(zr){return zr.x<_.x?pt:yt}),ce=g.start,he=g.end,ze=Math.min((S+Q+G)*2,g.getHeight()),Er=ze/2,Fr={minX:ce.x,maxX:he.x,minY:_.y-Er,maxY:_.y+Er};(0,b.S6)(Ht,function(zr,pn){var nn=Math.floor(ze/G);zr.length>nn&&(zr.sort(function(Pn,wi){return wi.percent-Pn.percent}),(0,b.S6)(zr,function(Pn,wi){wi+1>nn&&(k[Pn.id].set("visible",!1),Pn.invisible=!0)})),xE(zr,G,Fr)}),(0,b.S6)(Ht,function(zr,pn){(0,b.S6)(zr,function(nn){var Pn=pn===yt,wi=k[nn.id],ha=wi.getChildByIndex(0);if(ha){var Sa=S+Q,_o=nn.y-_.y,Vn=Math.pow(Sa,2),Bi=Math.pow(_o,2),fa=Vn-Bi>0?Vn-Bi:0,Ui=Math.sqrt(fa),Ji=Math.abs(Math.cos(nn.angle)*Sa);Pn?nn.x=_.x+Math.max(Ui,Ji):nn.x=_.x-Math.max(Ui,Ji)}ha&&(ha.attr("y",nn.y),ha.attr("x",nn.x)),SM(nn,g)})})}}}var p0=4,bE=4,ly=4;function bO(r,e,t){var i=e.getCenter(),u=e.getRadius(),c={x:r.x-(t?ly:-ly),y:r.y},p=co(i.x,i.y,u+p0,r.angle),g={x:c.x,y:c.y},_={x:p.x,y:p.y},S=co(i.x,i.y,u,r.angle),k="";if(c.y!==p.y){var L=t?4:-4;g.y=c.y,r.angle<0&&r.angle>=-Math.PI/2&&(g.x=Math.max(p.x,c.x-L),c.y<p.y?_.y=g.y:(_.y=p.y,_.x=Math.max(_.x,g.x-L))),r.angle>0&&r.angle<Math.PI/2&&(g.x=Math.max(p.x,c.x-L),c.y>p.y?_.y=g.y:(_.y=p.y,_.x=Math.max(_.x,g.x-L))),r.angle>Math.PI/2&&(g.x=Math.min(p.x,c.x-L),c.y>p.y?_.y=g.y:(_.y=p.y,_.x=Math.min(_.x,g.x-L))),r.angle<-Math.PI/2&&(g.x=Math.min(p.x,c.x-L),c.y<p.y?_.y=g.y:(_.y=p.y,_.x=Math.min(_.x,g.x-L)))}k=["M ".concat(c.x,",").concat(c.y),"L ".concat(g.x,",").concat(g.y),"L ".concat(_.x,",").concat(_.y),"L ".concat(p.x,",").concat(p.y),"L ".concat(S.x,",").concat(S.y)].join(" "),r.labelLine=(0,b.b$)({},r.labelLine,{path:k})}function sh(r,e,t,i){var u,c,p=e[0]&&e[0].get("coordinate");if(!!p){var g=p.getCenter(),_=p.getRadius(),S={};try{for(var k=(0,P.XA)(e),L=k.next();!L.done;L=k.next()){var R=L.value;S[R.get("id")]=R}}catch(zr){u={error:zr}}finally{try{L&&!L.done&&(c=k.return)&&c.call(k)}finally{if(u)throw u.error}}var U=(0,b.U2)(r[0],"labelHeight",14),G=Math.max((0,b.U2)(r[0],"offset",0),p0);(0,b.S6)(r,function(zr){if(!!zr){var pn=(0,b.U2)(S,[zr.id]);if(!!pn){var nn=zr.x>g.x||zr.x===g.x&&zr.y>g.y,Pn=(0,b.UM)(zr.offsetX)?bE:zr.offsetX,wi=co(g.x,g.y,_+p0,zr.angle),ha=G+Pn;zr.x=g.x+(nn?1:-1)*(_+ha),zr.y=wi.y}}});var Q=p.start,pt=p.end,yt="left",Ht="right",ce=(0,b.vM)(r,function(zr){return zr.x<g.x?yt:Ht}),he=(_+G)*2+U;(0,b.S6)(ce,function(zr){var pn=zr.length*U;pn>he&&(he=Math.min(pn,Math.abs(Q.y-pt.y)))});var ze={minX:Q.x,maxX:pt.x,minY:g.y-he/2,maxY:g.y+he/2};(0,b.S6)(ce,function(zr,pn){var nn=he/U;zr.length>nn&&(zr.sort(function(Pn,wi){return wi.percent-Pn.percent}),(0,b.S6)(zr,function(Pn,wi){wi>nn&&(S[Pn.id].set("visible",!1),Pn.invisible=!0)})),xE(zr,U,ze)});var Er=ze.minY,Fr=ze.maxY;(0,b.S6)(ce,function(zr,pn){var nn=pn===Ht;(0,b.S6)(zr,function(Pn){var wi=(0,b.U2)(S,Pn&&[Pn.id]);if(!!wi){if(Pn.y<Er||Pn.y>Fr){wi.set("visible",!1);return}var ha=wi.getChildByIndex(0),Sa=ha.getCanvasBBox(),_o={x:nn?Sa.x:Sa.maxX,y:Sa.y+Sa.height/2};cf(ha,Pn.x-_o.x,Pn.y-_o.y),Pn.labelLine&&bO(Pn,p,nn)}})})}}function AM(r,e,t,i){(0,b.S6)(e,function(u){var c=i.minX,p=i.minY,g=i.maxX,_=i.maxY,S=u.getCanvasBBox(),k=S.minX,L=S.minY,R=S.maxX,U=S.maxY,G=S.x,Q=S.y,pt=S.width,yt=S.height,Ht=G,ce=Q;(k<c||R<c)&&(Ht=c),(L<p||U<p)&&(ce=p),k>g?Ht=g-pt:R>g&&(Ht=Ht-(R-g)),L>_?ce=_-yt:U>_&&(ce=ce-(U-_)),(Ht!==G||ce!==Q)&&cf(u,Ht-G,ce-Q)})}function TM(r,e,t,i){(0,b.S6)(e,function(u,c){var p=u.getCanvasBBox(),g=t[c].getBBox();(p.minX<g.minX||p.minY<g.minY||p.maxX>g.maxX||p.maxY>g.maxY)&&u.remove(!0)})}var cy=100,EE=function(){function r(e){e===void 0&&(e={}),this.bitmap={};var t=e.xGap,i=t===void 0?1:t,u=e.yGap,c=u===void 0?8:u;this.xGap=i,this.yGap=c}return r.prototype.hasGap=function(e){for(var t=!0,i=this.bitmap,u=Math.round(e.minX),c=Math.round(e.maxX),p=Math.round(e.minY),g=Math.round(e.maxY),_=u;_<=c;_+=1){if(!i[_]){i[_]={};continue}if(_===u||_===c){for(var S=p;S<=g;S++)if(i[_][S]){t=!1;break}}else if(i[_][p]||i[_][g]){t=!1;break}}return t},r.prototype.fillGap=function(e){for(var t=this.bitmap,i=Math.round(e.minX),u=Math.round(e.maxX),c=Math.round(e.minY),p=Math.round(e.maxY),g=i;g<=u;g+=1)t[g]||(t[g]={});for(var g=i;g<=u;g+=this.xGap){for(var _=c;_<=p;_+=this.yGap)t[g][_]=!0;t[g][p]=!0}if(this.yGap!==1)for(var g=c;g<=p;g+=1)t[i][g]=!0,t[u][g]=!0;if(this.xGap!==1)for(var g=i;g<=u;g+=1)t[g][c]=!0,t[g][p]=!0},r.prototype.destroy=function(){this.bitmap={}},r}();function EO(r,e,t){t===void 0&&(t=cy);var i=-1,u=r.attr(),c=u.x,p=u.y,g=r.getCanvasBBox(),_=Math.sqrt(g.width*g.width+g.height*g.height),S,k=-i,L=0,R=0,U=function(yt){var Ht=yt*.1;return[Ht*Math.cos(Ht),Ht*Math.sin(Ht)]};if(e.hasGap(g))return e.fillGap(g),!0;for(var G=!1,Q=0,pt={};Math.min(Math.abs(L),Math.abs(R))<_&&Q<t;)if(S=U(k+=i),L=~~S[0],R=~~S[1],!(!L&&!R||pt["".concat(L,"-").concat(R)])&&(r.attr({x:c+L,y:p+R}),L+R<0&&r.attr("textAlign","right"),Q++,e.hasGap(r.getCanvasBBox()))){e.fillGap(r.getCanvasBBox()),G=!0,pt["".concat(L,"-").concat(R)]=!0;break}return G}function MM(r,e,t,i){var u=r.getCanvasBBox(),c=u.width,p=u.height,g={x:e,y:t,textAlign:"center"};switch(i){case 0:g.y-=p+1,g.x+=1,g.textAlign="left";break;case 1:g.y-=p+1,g.x-=1,g.textAlign="right";break;case 2:g.y+=p+1,g.x-=1,g.textAlign="right";break;case 3:g.y+=p+1,g.x+=1,g.textAlign="left";break;case 5:g.y-=p*2+2;break;case 6:g.y+=p*2+2;break;case 7:g.x+=c+1,g.textAlign="left";break;case 8:g.x-=c+1,g.textAlign="right";break;default:break}return r.attr(g),r.getCanvasBBox()}function wO(r,e,t,i){var u=new EE;(0,b.S6)(e,function(c){var p=c.find(function(g){return g.get("type")==="text"});EO(p,u)||c.remove(!0)}),u.destroy()}function IM(r,e,t,i){var u=new EE;(0,b.S6)(e,function(c){for(var p=c.find(function(U){return U.get("type")==="text"}),g=p.attr(),_=g.x,S=g.y,k=!1,L=0;L<=8;L++){var R=MM(p,_,S,L);if(u.hasGap(R)){u.fillGap(R),k=!0;break}}k||c.remove(!0)}),u.destroy()}function SO(r,e){return(r[0]||0)*(e[0]||0)+(r[1]||0)*(e[1]||0)+(r[2]||0)*(e[2]||0)}function wE(r){if(r.length>4)return[];var e=function(u,c){return[c.x-u.x,c.y-u.y]},t=e(r[0],r[1]),i=e(r[1],r[2]);return[t,i]}function fy(r,e,t){e===void 0&&(e=0),t===void 0&&(t={x:0,y:0});var i=r.x,u=r.y;return{x:(i-t.x)*Math.cos(-e)+(u-t.y)*Math.sin(-e)+t.x,y:(t.x-i)*Math.sin(-e)+(u-t.y)*Math.cos(-e)+t.y}}function kM(r){var e=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],t=r.rotation;return t?[fy(e[0],t,e[0]),fy(e[1],t,e[0]),fy(e[2],t,e[0]),fy(e[3],t,e[0])]:e}function LM(r,e){if(r.length>4)return{min:0,max:0};var t=[];return r.forEach(function(i){t.push(SO([i.x,i.y],e))}),{min:Math.min.apply(Math,(0,P.ev)([],(0,P.CR)(t),!1)),max:Math.max.apply(Math,(0,P.ev)([],(0,P.CR)(t),!1))}}function CO(r,e){return r.max>e.min&&r.min<e.max}function PM(r){return typeof r=="number"&&!Number.isNaN(r)&&r!==1/0&&r!==-1/0}function x1(r){return["x","y","width","height"].every(function(e){return PM(r[e])})}function AO(r,e,t){return t===void 0&&(t=0),!(e.x>r.x+r.width+t||e.x+e.width<r.x-t||e.y>r.y+r.height+t||e.y+e.height<r.y-t)}function OM(r,e,t){if(t===void 0&&(t=0),!x1(r)||!x1(e))return!1;if(!r.rotation&&!e.rotation)return AO(r,e,t);for(var i=kM(r),u=kM(e),c=wE(i).concat(wE(u)),p=0;p<c.length;p++){var g=c[p],_=LM(i,g),S=LM(u,g);if(!CO(_,S))return!1}return!0}var TO=function(){function r(e){var t=this;this.queue=[],this.worker=new Worker(e),this.worker.onmessage=function(i){var u;(u=t.queue.shift())===null||u===void 0||u.resolve(i)},this.worker.onmessageerror=function(i){var u;console.warn("[AntV G2] Web worker is not available"),(u=t.queue.shift())===null||u===void 0||u.reject(i)}}return r.prototype.post=function(e,t){var i=this;return new Promise(function(u,c){i.queue.push({resolve:u,reject:c});try{i.worker.postMessage(e)}catch(p){console.warn("[AntV G2] Web worker is not available"),(0,b.mf)(t)&&t()}})},r.prototype.destroy=function(){this.worker.terminate()},r}();function FM(r){if(typeof window!="undefined"){var e;try{e=new Blob([r.toString()],{type:"application/javascript"})}catch(t){e=new window.BlobBuilder,e.append(r.toString()),e=e.getBlob()}return new TO(URL.createObjectURL(e))}}var MO=function(r){function e(){function S(ce,he){return(ce[0]||0)*(he[0]||0)+(ce[1]||0)*(he[1]||0)+(ce[2]||0)*(he[2]||0)}function k(ce){if(ce.length>4)return[];var he=function(Fr,zr){return[zr.x-Fr.x,zr.y-Fr.y]},ze=he(ce[0],ce[1]),Er=he(ce[1],ce[2]);return[ze,Er]}function L(ce,he,ze){he===void 0&&(he=0),ze===void 0&&(ze={x:0,y:0});var Er=ce.x,Fr=ce.y;return{x:(Er-ze.x)*Math.cos(-he)+(Fr-ze.y)*Math.sin(-he)+ze.x,y:(ze.x-Er)*Math.sin(-he)+(Fr-ze.y)*Math.cos(-he)+ze.y}}function R(ce){var he=[{x:ce.x,y:ce.y},{x:ce.x+ce.width,y:ce.y},{x:ce.x+ce.width,y:ce.y+ce.height},{x:ce.x,y:ce.y+ce.height}],ze=ce.rotation;return ze?[L(he[0],ze,he[0]),L(he[1],ze,he[0]),L(he[2],ze,he[0]),L(he[3],ze,he[0])]:he}function U(ce,he){if(ce.length>4)return{min:0,max:0};var ze=[];return ce.forEach(function(Er){ze.push(S([Er.x,Er.y],he))}),{min:Math.min.apply(null,ze),max:Math.max.apply(null,ze)}}function G(ce,he){return ce.max>he.min&&ce.min<he.max}function Q(ce){return typeof ce=="number"&&!Number.isNaN(ce)&&ce!==1/0&&ce!==-1/0}function pt(ce){return["x","y","width","height"].every(function(he){return Q(ce[he])})}function yt(ce,he,ze){return ze===void 0&&(ze=0),!(he.x>ce.x+ce.width+ze||he.x+he.width<ce.x-ze||he.y>ce.y+ce.height+ze||he.y+he.height<ce.y-ze)}function Ht(ce,he,ze){if(ze===void 0&&(ze=0),!pt(ce)||!pt(he))return!1;if(!ce.rotation&&!he.rotation)return yt(ce,he,ze);for(var Er=R(ce),Fr=R(he),zr=k(Er).concat(k(Fr)),pn=0;pn<zr.length;pn++){var nn=zr[pn],Pn=U(Er,nn),wi=U(Fr,nn);if(!G(Pn,wi))return!1}return!0}return{intersect:Ht}}var t=e().intersect;function i(S){for(var k=S.slice(),L=0;L<k.length;L++){var R=k[L];if(R.visible)for(var U=L+1;U<k.length;U++){var G=k[U];R!==G&&G.visible&&t(R,G)&&(G.visible=!1)}}return k}var u={"hide-overlap":i};try{var c=JSON.parse(r.data);if(!c||!c.type||!u[c.type])return;var p=c.type,g=c.items,_=u[p](g);self.postMessage(_)}catch(S){throw S}},RM=`
   self.onmessage = `.concat(MO.toString(),`
`),b1=function(r){for(var e=r.slice(),t=0;t<e.length;t++){var i=e[t];if(i.visible)for(var u=t+1;u<e.length;u++){var c=e[u];i!==c&&c.visible&&OM(i,c)&&(c.visible=!1)}}return e},E1=new Map,rm=FM(RM);function IO(r,e,t,i){return(0,P.mG)(this,void 0,void 0,function(){var u,c,p,g,_,S;return(0,P.Jh)(this,function(k){switch(k.label){case 0:return u=e.map(function(L,R){return(0,P.pi)((0,P.pi)({},Qp(L,r[R],(0,b.U2)(r[R],"background.padding"))),{visible:!0})}),c=JSON.stringify(u),p=function(L){return E1.set(c,L),(0,b.S6)(L,function(R,U){var G=R.visible,Q=e[U];G?Q==null||Q.show():Q==null||Q.hide()}),L},E1.get(c)?(p(E1.get(c)),[3,7]):[3,1];case 1:if(!rm)return[3,6];k.label=2;case 2:return k.trys.push([2,4,,5]),g=JSON.stringify({type:"hide-overlap",items:u}),[4,rm.post(g,function(){return p(b1(u))})];case 3:return _=k.sent(),p(Array.isArray(_.data)?_.data:[]),[3,5];case 4:return S=k.sent(),console.error(S),p(b1(u)),[3,5];case 5:return[3,7];case 6:p(b1(u)),k.label=7;case 7:return[2]}})})}var DM={"#5B8FF9":!0},wp=function(r){var e=Ya.toRGB(r).toUpperCase();if(DM[e])return DM[e];var t=(0,P.CR)(Ya.rgb2arr(e),3),i=t[0],u=t[1],c=t[2],p=(i*299+u*587+c*114)/1e3<128;return p};function Ps(r,e,t){if(t.length!==0){var i=t[0].get("element"),u=i.geometry.theme,c=u.labels||{},p=c.fillColorLight,g=c.fillColorDark;t.forEach(function(_,S){var k=e[S],L=k.find(function(yt){return yt.get("type")==="text"}),R=Nu.fromObject(_.getBBox()),U=Nu.fromObject(L.getCanvasBBox()),G=!R.contains(U),Q=_.attr("fill"),pt=wp(Q);G?L.attr(u.overflowLabels.style):pt?p&&L.attr("fill",p):g&&L.attr("fill",g)})}}function Rv(r,e,t){var i=r.coordinate,u=fl(e),c=Nu.fromObject(u.getCanvasBBox()),p=Nu.fromObject(t.getBBox());return i.isTransposed?p.height>=c.height:p.width>=c.width}function Vi(r,e,t){var i=!!r.getAdjust("stack");return i||e.every(function(u,c){var p=t[c];return Rv(r,u,p)})}function Sp(r,e,t){var i=r.coordinate,u=Nu.fromObject(t.getBBox()),c=fl(e);i.isTransposed?c.attr({x:u.minX+u.width/2,textAlign:"center"}):c.attr({y:u.minY+u.height/2,textBaseline:"middle"})}function w1(r,e,t){var i;if(t.length!==0){var u=(i=t[0])===null||i===void 0?void 0:i.get("element"),c=u==null?void 0:u.geometry;if(!(!c||c.type!=="interval")){var p=Vi(c,e,t);p&&t.forEach(function(g,_){var S=e[_];Sp(c,S,g)})}}}function d0(r){var e=500,t=[],i=Math.max(Math.floor(r.length/e),1);return(0,b.S6)(r,function(u,c){c%i===0?t.push(u):u.set("visible",!1)}),t}function hy(r,e,t){var i;if(t.length!==0){var u=(i=t[0])===null||i===void 0?void 0:i.get("element"),c=u==null?void 0:u.geometry;if(!(!c||c.type!=="interval")){var p=d0(e),g=(0,P.CR)(c.getXYFields(),1),_=g[0],S=[],k=[],L=(0,b.vM)(p,function(pt){return pt.get("data")[_]}),R=(0,b.jj)((0,b.UI)(p,function(pt){return pt.get("data")[_]})),U;p.forEach(function(pt){pt.set("visible",!0)});var G=function(pt){pt&&(pt.length&&k.push(pt.pop()),k.push.apply(k,(0,P.ev)([],(0,P.CR)(pt),!1)))};for((0,b.dp)(R)>0&&(U=R.shift(),G(L[U])),(0,b.dp)(R)>0&&(U=R.pop(),G(L[U])),(0,b.S6)(R.reverse(),function(pt){G(L[pt])});k.length>0;){var Q=k.shift();Q.get("visible")&&(Lf(Q,S)?Q.set("visible",!1):S.push(Q))}}}}function BM(r,e){var t=r.getXYFields()[1],i=[],u=e.sort(function(c,p){return c.get("data")[t]-c.get("data")[t]});return u.length>0&&i.push(u.shift()),u.length>0&&i.push(u.pop()),i.push.apply(i,(0,P.ev)([],(0,P.CR)(u),!1)),i}function SE(r,e,t){return r.some(function(i){return t(i,e)})}function S1(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),u=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*u}function CE(r,e){return SE(r,e,function(t,i){var u=fl(t),c=fl(i);return S1(u.getCanvasBBox(),c.getCanvasBBox(),2)>0})}function AE(r,e,t,i,u){var c,p;if(t.length!==0){var g=(c=t[0])===null||c===void 0?void 0:c.get("element"),_=g==null?void 0:g.geometry;if(!(!_||_.type!=="point")){var S=(0,P.CR)(_.getXYFields(),2),k=S[0],L=S[1],R=(0,b.vM)(e,function(Q){return Q.get("data")[k]}),U=[],G=u&&u.offset||((p=r[0])===null||p===void 0?void 0:p.offset)||12;(0,b.UI)((0,b.XP)(R).reverse(),function(Q){for(var pt=BM(_,R[Q]);pt.length;){var yt=pt.shift(),Ht=fl(yt);if(SE(U,yt,function(ze,Er){return ze.get("data")[k]===Er.get("data")[k]&&ze.get("data")[L]===Er.get("data")[L]})){Ht.set("visible",!1);continue}var ce=CE(U,yt),he=!1;if(ce&&(Ht.attr("y",Ht.attr("y")+2*G),he=CE(U,yt)),he){Ht.set("visible",!1);continue}U.push(yt)}})}}}function NM(r,e){var t=r.getXYFields()[1],i=[],u=e.sort(function(c,p){return c.get("data")[t]-c.get("data")[t]});return u.length>0&&i.push(u.shift()),u.length>0&&i.push(u.pop()),i.push.apply(i,(0,P.ev)([],(0,P.CR)(u),!1)),i}function TE(r,e,t){return r.some(function(i){return t(i,e)})}function kO(r,e,t){t===void 0&&(t=0);var i=Math.max(0,Math.min(r.x+r.width+t,e.x+e.width+t)-Math.max(r.x-t,e.x-t)),u=Math.max(0,Math.min(r.y+r.height+t,e.y+e.height+t)-Math.max(r.y-t,e.y-t));return i*u}function zM(r,e){return TE(r,e,function(t,i){var u=fl(t),c=fl(i);return kO(u.getCanvasBBox(),c.getCanvasBBox(),2)>0})}function UM(r,e,t,i,u){var c,p;if(t.length!==0){var g=(c=t[0])===null||c===void 0?void 0:c.get("element"),_=g==null?void 0:g.geometry;if(!(!_||["path","line","area"].indexOf(_.type)<0)){var S=(0,P.CR)(_.getXYFields(),2),k=S[0],L=S[1],R=(0,b.vM)(e,function(Q){return Q.get("data")[k]}),U=[],G=u&&u.offset||((p=r[0])===null||p===void 0?void 0:p.offset)||12;(0,b.UI)((0,b.XP)(R).reverse(),function(Q){for(var pt=NM(_,R[Q]);pt.length;){var yt=pt.shift(),Ht=fl(yt);if(TE(U,yt,function(ze,Er){return ze.get("data")[k]===Er.get("data")[k]&&ze.get("data")[L]===Er.get("data")[L]})){Ht.set("visible",!1);continue}var ce=zM(U,yt),he=!1;if(ce&&(Ht.attr("y",Ht.attr("y")+2*G),he=zM(U,yt)),he){Ht.set("visible",!1);continue}U.push(yt)}})}}}var C1;function v0(){return C1||(C1=document.createElement("canvas").getContext("2d")),C1}var py=(0,b.HP)(function(r,e){e===void 0&&(e={});var t=e.fontSize,i=e.fontFamily,u=e.fontWeight,c=e.fontStyle,p=e.fontVariant,g=v0();return g.font=[c,p,u,"".concat(t,"px"),i].join(" "),g.measureText((0,b.HD)(r)?r:"").width},function(r,e){return e===void 0&&(e={}),(0,P.ev)([r],(0,P.CR)((0,b.VO)(e)),!1).join("")}),ZM=function(r,e,t){var i=16,u=py("...",t),c;(0,b.HD)(r)?c=r:c=(0,b.BB)(r);var p=e,g=[],_,S;if(py(r,t)<=e)return r;for(;_=c.substr(0,i),S=py(_,t),!(S+u>p&&S>p);)if(g.push(_),p-=S,c=c.substr(i),!c)return g.join("");for(;_=c.substr(0,1),S=py(_,t),!(S+u>p);)if(g.push(_),p-=S,c=c.substr(1),!c)return g.join("");return"".concat(g.join(""),"...")};function dy(r,e,t,i,u){if(!(e.length<=0)){var c=(u==null?void 0:u.direction)||["top","right","bottom","left"],p=(u==null?void 0:u.action)||"translate",g=(u==null?void 0:u.margin)||0,_=e[0].get("coordinate");if(!!_){var S=Hm(_,g),k=S.minX,L=S.minY,R=S.maxX,U=S.maxY;(0,b.S6)(e,function(G){var Q=G.getCanvasBBox(),pt=Q.minX,yt=Q.minY,Ht=Q.maxX,ce=Q.maxY,he=Q.x,ze=Q.y,Er=Q.width,Fr=Q.height,zr=he,pn=ze;if(c.indexOf("left")>=0&&(pt<k||Ht<k)&&(zr=k),c.indexOf("top")>=0&&(yt<L||ce<L)&&(pn=L),c.indexOf("right")>=0&&(pt>R?zr=R-Er:Ht>R&&(zr=zr-(Ht-R))),c.indexOf("bottom")>=0&&(yt>U?pn=U-Fr:ce>U&&(pn=pn-(ce-U))),zr!==he||pn!==ze){var nn=zr-he;if(p==="translate")cf(G,nn,pn-ze);else if(p==="ellipsis"){var Pn=G.findAll(function(wi){return wi.get("type")==="text"});Pn.forEach(function(wi){var ha=(0,b.ei)(wi.attr(),["fontSize","fontFamily","fontWeight","fontStyle","fontVariant"]),Sa=wi.getCanvasBBox(),_o=ZM(wi.attr("text"),Sa.width-Math.abs(nn),ha);wi.attr("text",_o)})}else G.hide()}})}}}function VM(r,e,t){var i={fillOpacity:(0,b.UM)(r.attr("fillOpacity"))?1:r.attr("fillOpacity"),strokeOpacity:(0,b.UM)(r.attr("strokeOpacity"))?1:r.attr("strokeOpacity"),opacity:(0,b.UM)(r.attr("opacity"))?1:r.attr("opacity")};r.attr({fillOpacity:0,strokeOpacity:0,opacity:0}),r.animate(i,e)}function GM(r,e,t){var i={fillOpacity:0,strokeOpacity:0,opacity:0},u=e.easing,c=e.duration,p=e.delay;r.animate(i,c,u,function(){r.remove(!0)},p)}function ME(r,e,t){var i,u=(0,P.CR)(e,2),c=u[0],p=u[1];return r.applyToMatrix([c,p,1]),t==="x"?(r.setMatrix(ma.vs(r.getMatrix(),[["t",-c,-p],["s",.01,1],["t",c,p]])),i=ma.vs(r.getMatrix(),[["t",-c,-p],["s",100,1],["t",c,p]])):t==="y"?(r.setMatrix(ma.vs(r.getMatrix(),[["t",-c,-p],["s",1,.01],["t",c,p]])),i=ma.vs(r.getMatrix(),[["t",-c,-p],["s",1,100],["t",c,p]])):t==="xy"&&(r.setMatrix(ma.vs(r.getMatrix(),[["t",-c,-p],["s",.01,.01],["t",c,p]])),i=ma.vs(r.getMatrix(),[["t",-c,-p],["s",100,100],["t",c,p]])),i}function A1(r,e,t,i,u){var c=t.start,p=t.end,g=t.getWidth(),_=t.getHeight(),S,k;u==="y"?(S=c.x+g/2,k=i.y<c.y?i.y:c.y):u==="x"?(S=i.x>c.x?i.x:c.x,k=c.y+_/2):u==="xy"&&(t.isPolar?(S=t.getCenter().x,k=t.getCenter().y):(S=(c.x+p.x)/2,k=(c.y+p.y)/2));var L=ME(r,[S,k],u);r.animate({matrix:L},e)}function HM(r,e,t){var i=t.coordinate,u=t.minYPoint;A1(r,e,i,u,"x")}function jM(r,e,t){var i=t.coordinate,u=t.minYPoint;A1(r,e,i,u,"y")}function WM(r,e,t){var i=t.coordinate,u=t.minYPoint;A1(r,e,i,u,"xy")}function XM(r,e,t){var i=r.getTotalLength();r.attr("lineDash",[i]),r.animate(function(u){return{lineDashOffset:(1-u)*i}},e)}function YM(r,e,t){var i=t.toAttrs,u=i.x,c=i.y;delete i.x,delete i.y,r.attr(i),r.animate({x:u,y:c},e)}function Xd(r,e,t){var i=r.getBBox(),u=r.get("origin").mappingData,c=u.points,p=c[0].y-c[1].y>0?i.maxX:i.minX,g=(i.minY+i.maxY)/2;r.applyToMatrix([p,g,1]);var _=ma.vs(r.getMatrix(),[["t",-p,-g],["s",.01,1],["t",p,g]]);r.setMatrix(_),r.animate({matrix:ma.vs(r.getMatrix(),[["t",-p,-g],["s",100,1],["t",p,g]])},e)}function IE(r,e,t){var i=r.getBBox(),u=r.get("origin").mappingData,c=(i.minX+i.maxX)/2,p=u.points,g=p[0].y-p[1].y<=0?i.maxY:i.minY;r.applyToMatrix([c,g,1]);var _=ma.vs(r.getMatrix(),[["t",-c,-g],["s",1,.01],["t",c,g]]);r.setMatrix(_),r.animate({matrix:ma.vs(r.getMatrix(),[["t",-c,-g],["s",1,100],["t",c,g]])},e)}function kE(r,e){var t,i=Tv(r,e),u=i.startAngle,c=i.endAngle;return!(0,b.vQ)(u,-Math.PI*.5)&&u<-Math.PI*.5&&(u+=Math.PI*2),!(0,b.vQ)(c,-Math.PI*.5)&&c<-Math.PI*.5&&(c+=Math.PI*2),e[5]===0&&(t=(0,P.CR)([c,u],2),u=t[0],c=t[1]),(0,b.vQ)(u,Math.PI*1.5)&&(u=Math.PI*-.5),(0,b.vQ)(c,Math.PI*-.5)&&!(0,b.vQ)(u,c)&&(c=Math.PI*1.5),{startAngle:u,endAngle:c}}function LE(r){var e;return r[0]==="M"||r[0]==="L"?e=[r[1],r[2]]:(r[0]==="a"||r[0]==="A"||r[0]==="C")&&(e=[r[r.length-2],r[r.length-1]]),e}function PE(r){var e,t,i,u=r.filter(function(ce){return ce[0]==="A"||ce[0]==="a"});if(u.length===0)return{startAngle:0,endAngle:0,radius:0,innerRadius:0};var c=u[0],p=u.length>1?u[1]:u[0],g=r.indexOf(c),_=r.indexOf(p),S=LE(r[g-1]),k=LE(r[_-1]),L=kE(S,c),R=L.startAngle,U=L.endAngle,G=kE(k,p),Q=G.startAngle,pt=G.endAngle;(0,b.vQ)(R,Q)&&(0,b.vQ)(U,pt)?(t=R,i=U):(t=Math.min(R,Q),i=Math.max(U,pt));var yt=c[1],Ht=u[u.length-1][1];return yt<Ht?(e=(0,P.CR)([Ht,yt],2),yt=e[0],Ht=e[1]):yt===Ht&&(Ht=0),{startAngle:t,endAngle:i,radius:yt,innerRadius:Ht}}function Yd(r,e,t){var i=t.toAttrs,u=t.coordinate,c=i.path||[],p=c.map(function(Ht){return Ht[0]});if(!(c.length<1)){var g=PE(c),_=g.startAngle,S=g.endAngle,k=g.radius,L=g.innerRadius,R=PE(r.attr("path")),U=R.startAngle,G=R.endAngle,Q=u.getCenter(),pt=_-U,yt=S-G;if(pt===0&&yt===0){r.attr("path",c);return}r.animate(function(Ht){var ce=U+Ht*pt,he=G+Ht*yt;return(0,P.pi)((0,P.pi)({},i),{path:(0,b.Xy)(p,["M","A","A","Z"])?W0(Q.x,Q.y,k,ce,he):gu(Q.x,Q.y,k,ce,he,L)})},(0,P.pi)((0,P.pi)({},e),{callback:function(){r.attr("path",c)}}))}}function OE(r,e,t){var i=qp(t.coordinate,20),u=i.type,c=i.startState,p=i.endState,g=r.setClip({type:u,attrs:c});t.toAttrs&&r.attr(t.toAttrs),g.animate(p,(0,P.pi)((0,P.pi)({},e),{callback:function(){r&&!r.get("destroyed")&&r.set("clipShape",null),g.remove(!0)}}))}function T1(r,e,t){if(r.isGroup())(0,b.S6)(r.getChildren(),function(g){T1(g,e,t)});else{var i=r.getBBox(),u=(i.minX+i.maxX)/2,c=(i.minY+i.maxY)/2;if(r.applyToMatrix([u,c,1]),t==="zoomIn"){var p=ma.vs(r.getMatrix(),[["t",-u,-c],["s",.01,.01],["t",u,c]]);r.setMatrix(p),r.animate({matrix:ma.vs(r.getMatrix(),[["t",-u,-c],["s",100,100],["t",u,c]])},e)}else r.animate({matrix:ma.vs(r.getMatrix(),[["t",-u,-c],["s",.01,.01],["t",u,c]])},(0,P.pi)((0,P.pi)({},e),{callback:function(){r.remove(!0)}}))}}function FE(r,e,t){T1(r,e,"zoomIn")}function RE(r,e,t){T1(r,e,"zoomOut")}function bc(r){return[le.TOP,le.BOTTOM].includes(r)?{offsetX:0,offsetY:r===le.TOP?-8:8,style:{textAlign:"center",textBaseline:r===le.TOP?"bottom":"top"}}:[le.LEFT,le.RIGHT].includes(r)?{offsetX:r===le.LEFT?-8:8,offsetY:0,style:{textAlign:r===le.LEFT?"right":"left",textBaseline:"middle",rotate:Math.PI/2}}:{}}function vy(r,e,t){return{x:r.x+e*Math.cos(t),y:r.y+e*Math.sin(t)}}var uh=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"circle",showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.getRegion=function(t,i){var u=.5,c={x:.5,y:.5},p=Math.PI*2/t,g=-1*Math.PI/2+p*i,_=u/(1+1/Math.sin(p/2)),S=vy(c,u-_,g),k=Math.PI*5/4,L=Math.PI*1/4;return{start:vy(S,_,k),end:vy(S,_,L)}},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){var i=this,u=this.cfg,c=u.fields,p=u.type,g=(0,P.CR)(c,1),_=g[0];if(!_)throw new Error("No `fields` specified!");var S=this.getFieldValues(t,_),k=S.length,L=[];return S.forEach(function(R,U){var G=[{field:_,value:R,values:S}],Q=(0,b.hX)(t,i.getFacetDataFilter(G)),pt={type:p,data:Q,region:i.getRegion(k,U),columnValue:R,columnField:_,columnIndex:U,columnValuesLength:k,rowValue:null,rowField:null,rowIndex:0,rowValuesLength:1};L.push(pt)}),L},e.prototype.getXAxisOption=function(t,i,u,c){return u},e.prototype.getYAxisOption=function(t,i,u,c){return u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var u=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(u):u},bc(le.TOP),t.cfg.title);c.annotation().text(g)})},e}(Qn),M1=uh,$M=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"list",cols:null,showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){var i=this,u=this.cfg.fields,c=this.cfg.cols,p=(0,P.CR)(u,1),g=p[0];if(!g)throw new Error("No `fields` specified!");var _=this.getFieldValues(t,g),S=_.length;c=c||S;var k=this.getPageCount(S,c),L=[];return _.forEach(function(R,U){var G=i.getRowCol(U,c),Q=G.row,pt=G.col,yt=[{field:g,value:R,values:_}],Ht=(0,b.hX)(t,i.getFacetDataFilter(yt)),ce={type:i.cfg.type,data:Ht,region:i.getRegion(k,c,pt,Q),columnValue:R,rowValue:R,columnField:g,rowField:null,columnIndex:pt,rowIndex:Q,columnValuesLength:c,rowValuesLength:k,total:S};L.push(ce)}),L},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1&&c.columnValuesLength*c.rowIndex+c.columnIndex+1+c.columnValuesLength<=c.total?(0,P.pi)((0,P.pi)({},u),{label:null,title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var u=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(u):u},bc(le.TOP),t.cfg.title);c.annotation().text(g)})},e.prototype.getPageCount=function(t,i){return Math.floor((t+i-1)/i)},e.prototype.getRowCol=function(t,i){var u=Math.floor(t/i),c=t%i;return{row:u,col:c}},e}(Qn),qM=$M,LO=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"matrix",showTitle:!1,columnTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this)),rowTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this))})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.generateFacets=function(t){for(var i=this.cfg,u=i.fields,c=i.type,p=u.length,g=p,_=[],S=0;S<g;S++)for(var k=u[S],L=0;L<p;L++){var R=u[L],U={type:c,data:t,region:this.getRegion(p,g,S,L),columnValue:k,rowValue:R,columnField:k,rowField:R,columnIndex:S,rowIndex:L,columnValuesLength:g,rowValuesLength:p};_.push(U)}return _},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},u),{label:null,title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,u){var c=i.columnIndex,p=i.rowIndex,g=i.columnValuesLength,_=i.rowValuesLength,S=i.columnValue,k=i.rowValue,L=i.view;if(p===0){var R=(0,b.U2)(t.cfg.columnTitle,"formatter"),U=(0,b.b$)({position:["50%","0%"],content:R?R(S):S},bc(le.TOP),t.cfg.columnTitle);L.annotation().text(U)}if(c===g-1){var R=(0,b.U2)(t.cfg.rowTitle,"formatter"),U=(0,b.b$)({position:["100%","50%"],content:R?R(k):k},bc(le.RIGHT),t.cfg.rowTitle);L.annotation().text(U)}})},e}(Qn),KM=LO,QM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"mirror",showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this),transpose:!1})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.beforeEachView=function(t,i){this.cfg.transpose?i.columnIndex%2===0?t.coordinate().transpose().reflect("x"):t.coordinate().transpose():i.rowIndex%2!==0&&t.coordinate().reflect("y")},e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.generateFacets=function(t){var i=this,u=(0,P.CR)(this.cfg.fields,1),c=u[0],p=[],g=1,_=1,S=[""],k=[""],L,R;return this.cfg.transpose?(L=c,S=this.getFieldValues(t,L).slice(0,2),g=S.length):(R=c,k=this.getFieldValues(t,R).slice(0,2),_=k.length),S.forEach(function(U,G){k.forEach(function(Q,pt){var yt=[{field:L,value:U,values:S},{field:R,value:Q,values:k}],Ht=(0,b.hX)(t,i.getFacetDataFilter(yt)),ce={type:i.cfg.type,data:Ht,region:i.getRegion(_,g,G,pt),columnValue:U,rowValue:Q,columnField:L,rowField:R,columnIndex:G,rowIndex:pt,columnValuesLength:g,rowValuesLength:_};p.push(ce)})}),p},e.prototype.getXAxisOption=function(t,i,u,c){return c.columnIndex===1||c.rowIndex===1?(0,P.pi)((0,P.pi)({},u),{label:null,title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return u},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,u){var c=i.columnValue,p=i.rowValue,g=i.view,_=(0,b.U2)(t.cfg.title,"formatter");if(t.cfg.transpose){var S=(0,b.b$)({position:["50%","0%"],content:_?_(c):c},bc(le.TOP),t.cfg.title);g.annotation().text(S)}else{var S=(0,b.b$)({position:["100%","50%"],content:_?_(p):p},bc(le.RIGHT),t.cfg.title);g.annotation().text(S)}})},e}(Qn),PO=QM,JM=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"rect",columnTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this)),rowTitle:(0,P.pi)({},r.prototype.getDefaultTitleCfg.call(this))})},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.generateFacets=function(t){var i=this,u=(0,P.CR)(this.cfg.fields,2),c=u[0],p=u[1],g=[],_=1,S=1,k=[""],L=[""];return c&&(k=this.getFieldValues(t,c),_=k.length),p&&(L=this.getFieldValues(t,p),S=L.length),k.forEach(function(R,U){L.forEach(function(G,Q){var pt=[{field:c,value:R,values:k},{field:p,value:G,values:L}],yt=(0,b.hX)(t,i.getFacetDataFilter(pt)),Ht={type:i.cfg.type,data:yt,region:i.getRegion(S,_,U,Q),columnValue:R,rowValue:G,columnField:c,rowField:p,columnIndex:U,rowIndex:Q,columnValuesLength:_,rowValuesLength:S};g.push(Ht)})}),g},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i,u){var c=i.columnIndex,p=i.rowIndex,g=i.columnValuesLength,_=i.columnValue,S=i.rowValue,k=i.view;if(p===0){var L=(0,b.U2)(t.cfg.columnTitle,"formatter"),R=(0,b.b$)({position:["50%","0%"],content:L?L(_):_},bc(le.TOP),t.cfg.columnTitle);k.annotation().text(R)}if(c===g-1){var L=(0,b.U2)(t.cfg.rowTitle,"formatter"),R=(0,b.b$)({position:["100%","50%"],content:L?L(S):S},bc(le.RIGHT),t.cfg.rowTitle);k.annotation().text(R)}})},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):c.columnIndex!==Math.floor((c.columnValuesLength-1)/2)?(0,P.pi)((0,P.pi)({},u),{title:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):c.rowIndex!==Math.floor((c.rowValuesLength-1)/2)?(0,P.pi)((0,P.pi)({},u),{title:null}):u},e}(Qn),t3=JM,OO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.afterChartRender=function(){t.facets&&t.cfg.line&&(t.container.clear(),t.drawLines(t.facets))},t}return e.prototype.afterEachView=function(t,i){this.processAxis(t,i)},e.prototype.beforeEachView=function(t,i){},e.prototype.init=function(){r.prototype.init.call(this),this.view.on(It.AFTER_RENDER,this.afterChartRender)},e.prototype.getDefaultCfg=function(){return(0,b.b$)({},r.prototype.getDefaultCfg.call(this),{type:"tree",line:{style:{lineWidth:1,stroke:"#ddd"},smooth:!1},showTitle:!0,title:r.prototype.getDefaultTitleCfg.call(this)})},e.prototype.generateFacets=function(t){var i=this.cfg.fields;if(!i.length)throw new Error("Please specify for the fields for rootFacet!");var u=[],c={type:this.cfg.type,data:t,region:null,rowValuesLength:this.getRows(),columnValuesLength:1,rowIndex:0,columnIndex:0,rowField:"",columnField:"",rowValue:"",columnValue:""};return u.push(c),c.children=this.getChildFacets(t,1,u),this.setRegion(u),u},e.prototype.setRegion=function(t){var i=this;this.forceColIndex(t),t.forEach(function(u){u.region=i.getRegion(u.rowValuesLength,u.columnValuesLength,u.columnIndex,u.rowIndex)})},e.prototype.getRegion=function(t,i,u,c){var p=1/i,g=1/t,_={x:p*u,y:g*c},S={x:_.x+p,y:_.y+g*2/3};return{start:_,end:S}},e.prototype.forceColIndex=function(t){var i,u,c=this,p=[],g=0;t.forEach(function(G){c.isLeaf(G)&&(p.push(G),G.columnIndex=g,g++)}),p.forEach(function(G){G.columnValuesLength=p.length});for(var _=this.cfg.fields.length,S=_-1;S>=0;S--){var k=this.getFacetsByLevel(t,S);try{for(var L=(i=void 0,(0,P.XA)(k)),R=L.next();!R.done;R=L.next()){var U=R.value;this.isLeaf(U)||(U.originColIndex=U.columnIndex,U.columnIndex=this.getRegionIndex(U.children),U.columnValuesLength=p.length)}}catch(G){i={error:G}}finally{try{R&&!R.done&&(u=L.return)&&u.call(L)}finally{if(i)throw i.error}}}},e.prototype.getFacetsByLevel=function(t,i){var u=[];return t.forEach(function(c){c.rowIndex===i&&u.push(c)}),u},e.prototype.getRegionIndex=function(t){var i=t[0],u=t[t.length-1];return(u.columnIndex-i.columnIndex)/2+i.columnIndex},e.prototype.isLeaf=function(t){return!t.children||!t.children.length},e.prototype.getRows=function(){return this.cfg.fields.length+1},e.prototype.getChildFacets=function(t,i,u){var c=this,p=this.cfg.fields,g=p.length;if(!(g<i)){var _=[],S=p[i-1],k=this.getFieldValues(t,S);return k.forEach(function(L,R){var U=[{field:S,value:L,values:k}],G=t.filter(c.getFacetDataFilter(U));if(G.length){var Q={type:c.cfg.type,data:G,region:null,columnValue:L,rowValue:"",columnField:S,rowField:"",columnIndex:R,rowValuesLength:c.getRows(),columnValuesLength:1,rowIndex:i,children:c.getChildFacets(G,i+1,u)};_.push(Q),u.push(Q)}}),_}},e.prototype.render=function(){r.prototype.render.call(this),this.cfg.showTitle&&this.renderTitle()},e.prototype.renderTitle=function(){var t=this;(0,b.S6)(this.facets,function(i){var u=i.columnValue,c=i.view,p=(0,b.U2)(t.cfg.title,"formatter"),g=(0,b.b$)({position:["50%","0%"],content:p?p(u):u},bc(le.TOP),t.cfg.title);c.annotation().text(g)})},e.prototype.drawLines=function(t){var i=this;t.forEach(function(u){if(!i.isLeaf(u)){var c=u.children;i.addFacetLines(u,c)}})},e.prototype.addFacetLines=function(t,i){var u=this,c=t.view,p=c.coordinateBBox,g={x:p.x+p.width/2,y:p.y+p.height};i.forEach(function(_){var S=_.view.coordinateBBox,k={x:S.bl.x+(S.tr.x-S.bl.x)/2,y:S.tr.y},L={x:g.x,y:g.y+(k.y-g.y)/2},R={x:k.x,y:L.y};u.drawLine([g,L,R,k])})},e.prototype.getPath=function(t){var i=[],u=this.cfg.line.smooth;return u?(i.push(["M",t[0].x,t[0].y]),i.push(["C",t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y])):t.forEach(function(c,p){p===0?i.push(["M",c.x,c.y]):i.push(["L",c.x,c.y])}),i},e.prototype.drawLine=function(t){var i=this.getPath(t),u=this.cfg.line.style;this.container.addShape("path",{attrs:(0,b.f0)({path:i},u)})},e.prototype.getXAxisOption=function(t,i,u,c){return c.rowIndex!==c.rowValuesLength-1?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e.prototype.getYAxisOption=function(t,i,u,c){return c.originColIndex!==0&&c.columnIndex!==0?(0,P.pi)((0,P.pi)({},u),{title:null,label:null}):u},e}(Qn),e3=OO;function DE(r){var e=(0,P.ev)([],(0,P.CR)(r),!1);e.sort(function(i,u){return i-u});var t=e.length;return t===0?0:t%2===1?e[(t-1)/2]:(e[t/2]+e[t/2-1])/2}function r3(r){var e=(0,b.u4)(r,function(t,i){return t+=isNaN(i)||!(0,b.hj)(i)?0:i},0);return r.length===0?0:e/r.length}function gy(r,e){if(!e)return null;var t;switch(r){case"start":return 0;case"center":return .5;case"end":return 1;case"median":{t=e.isCategory?DE(e.values.map(function(i,u){return u})):DE(e.values);break}case"mean":{t=e.isCategory?(e.values.length-1)/2:r3(e.values);break}case"min":t=e.isCategory?0:e[r];break;case"max":t=e.isCategory?e.values.length-1:e[r];break;default:t=r;break}return e.scale(t)}var I1=["regionFilter","shape"],n3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.cache=new Map,i.foregroundContainer=i.view.getLayer(X.FORE).addGroup(),i.backgroundContainer=i.view.getLayer(X.BG).addGroup(),i.option=[],i}return Object.defineProperty(e.prototype,"name",{get:function(){return"annotation"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.layout=function(){this.update()},e.prototype.render=function(){},e.prototype.update=function(){var t=this;this.onAfterRender(function(){var u=new Map;(0,b.S6)(t.option,function(c){if((0,b.q9)(I1,c.type)){var p=t.updateOrCreate(c);p&&u.set(t.getCacheKey(c),p)}}),t.cache=t.syncCache(u)});var i=new Map;(0,b.S6)(this.option,function(u){if(!(0,b.q9)(I1,u.type)){var c=t.updateOrCreate(u);c&&i.set(t.getCacheKey(u),c)}}),this.cache=this.syncCache(i)},e.prototype.clear=function(t){t===void 0&&(t=!1),r.prototype.clear.call(this),this.clearComponents(),this.foregroundContainer.clear(),this.backgroundContainer.clear(),t&&(this.option=[])},e.prototype.destroy=function(){this.clear(!0),this.foregroundContainer.remove(!0),this.backgroundContainer.remove(!0)},e.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(i){t.push(i)}),t},e.prototype.clearComponents=function(){this.getComponents().forEach(function(t){t.component.destroy()}),this.cache.clear()},e.prototype.onAfterRender=function(t){var i=!1;this.view.getOptions().animate&&this.view.geometries.forEach(function(u){u.animateOption&&(u.once(rt.AFTER_DRAW_ANIMATE,function(){t()}),i=!0)}),i||this.view.getRootView().once(It.AFTER_RENDER,function(){t()})},e.prototype.createAnnotation=function(t){var i=t.type,u=wt[(0,b.jC)(i)];if(u){var c=this.getAnnotationTheme(i),p=this.getAnnotationCfg(i,t,c);if(!p)return null;var g=new u(p);return{component:g,layer:this.isTop(p)?X.FORE:X.BG,direction:le.NONE,type:Se.ANNOTATION,extra:t}}},e.prototype.annotation=function(t){this.option.push(t)},e.prototype.arc=function(t){return this.annotation((0,P.pi)({type:"arc"},t)),this},e.prototype.image=function(t){return this.annotation((0,P.pi)({type:"image"},t)),this},e.prototype.line=function(t){return this.annotation((0,P.pi)({type:"line"},t)),this},e.prototype.region=function(t){return this.annotation((0,P.pi)({type:"region"},t)),this},e.prototype.text=function(t){return this.annotation((0,P.pi)({type:"text"},t)),this},e.prototype.dataMarker=function(t){return this.annotation((0,P.pi)({type:"dataMarker"},t)),this},e.prototype.dataRegion=function(t){this.annotation((0,P.pi)({type:"dataRegion"},t))},e.prototype.regionFilter=function(t){this.annotation((0,P.pi)({type:"regionFilter"},t))},e.prototype.shape=function(t){this.annotation((0,P.pi)({type:"shape"},t))},e.prototype.html=function(t){this.annotation((0,P.pi)({type:"html"},t))},e.prototype.parsePosition=function(t){var i,u,c=this.view.getXScale(),p=this.view.getScalesByDim("y"),g=(0,b.mf)(t)?t.call(null,c,p):t,_=0,S=0;if((0,b.kJ)(g)){var k=(0,P.CR)(g,2),L=k[0],R=k[1];if((0,b.HD)(L)&&L.indexOf("%")!==-1&&!isNaN(L.slice(0,-1)))return this.parsePercentPosition(g);_=gy(L,c),S=gy(R,Object.values(p)[0])}else if(!(0,b.UM)(g))try{for(var U=(0,P.XA)((0,b.XP)(g)),G=U.next();!G.done;G=U.next()){var Q=G.value,pt=g[Q];Q===c.field&&(_=gy(pt,c)),p[Q]&&(S=gy(pt,p[Q]))}}catch(yt){i={error:yt}}finally{try{G&&!G.done&&(u=U.return)&&u.call(U)}finally{if(i)throw i.error}}return isNaN(_)||isNaN(S)?null:this.view.getCoordinate().convert({x:_,y:S})},e.prototype.getRegionPoints=function(t,i){var u=this,c=this.view.getXScale(),p=this.view.getScalesByDim("y"),g=Object.values(p)[0],_=c.field,S=this.view.getData(),k=(0,b.kJ)(t)?t[0]:t[_],L=(0,b.kJ)(i)?i[0]:i[_],R=[],U;return(0,b.S6)(S,function(G,Q){if(G[_]===k&&(U=Q),Q>=U){var pt=u.parsePosition([G[_],G[g.field]]);pt&&R.push(pt)}if(G[_]===L)return!1}),R},e.prototype.parsePercentPosition=function(t){var i=parseFloat(t[0])/100,u=parseFloat(t[1])/100,c=this.view.getCoordinate(),p=c.start,g=c.end,_={x:Math.min(p.x,g.x),y:Math.min(p.y,g.y)},S=c.getWidth()*i+_.x,k=c.getHeight()*u+_.y;return{x:S,y:k}},e.prototype.getCoordinateBBox=function(){var t=this.view.getCoordinate(),i=t.start,u=t.end,c=t.getWidth(),p=t.getHeight(),g={x:Math.min(i.x,u.x),y:Math.min(i.y,u.y)};return{x:g.x,y:g.y,minX:g.x,minY:g.y,maxX:g.x+c,maxY:g.y+p,width:c,height:p}},e.prototype.getAnnotationCfg=function(t,i,u){var c=this,p=this.view.getCoordinate(),g=this.view.getCanvas(),_={};if((0,b.UM)(i))return null;var S=i.start,k=i.end,L=i.position,R=this.parsePosition(S),U=this.parsePosition(k),G=this.parsePosition(L);if(["arc","image","line","region","regionFilter"].includes(t)&&(!R||!U))return null;if(["text","dataMarker","html"].includes(t)&&!G)return null;if(t==="arc"){var Q=i,pt=Q.start,yt=Q.end,Ht=(0,P._T)(Q,["start","end"]),ce=uf(p,R),he=uf(p,U);ce>he&&(he=Math.PI*2+he),_=(0,P.pi)((0,P.pi)({},Ht),{center:p.getCenter(),radius:$p(p,R),startAngle:ce,endAngle:he})}else if(t==="image"){var ze=i,Er=ze.start,Fr=ze.end,Ht=(0,P._T)(ze,["start","end"]);_=(0,P.pi)((0,P.pi)({},Ht),{start:R,end:U,src:i.src})}else if(t==="line"){var zr=i,pn=zr.start,nn=zr.end,Ht=(0,P._T)(zr,["start","end"]);_=(0,P.pi)((0,P.pi)({},Ht),{start:R,end:U,text:(0,b.U2)(i,"text",null)})}else if(t==="region"){var Pn=i,wi=Pn.start,ha=Pn.end,Ht=(0,P._T)(Pn,["start","end"]);_=(0,P.pi)((0,P.pi)({},Ht),{start:R,end:U})}else if(t==="text"){var Sa=this.view.getData(),_o=i,Vn=_o.position,Bi=_o.content,Ht=(0,P._T)(_o,["position","content"]),fa=Bi;(0,b.mf)(Bi)&&(fa=Bi(Sa)),_=(0,P.pi)((0,P.pi)((0,P.pi)({},G),Ht),{content:fa})}else if(t==="dataMarker"){var Ui=i,Ji=Ui.position,Fa=Ui.point,xo=Ui.line,Mo=Ui.text,ao=Ui.autoAdjust,Io=Ui.direction,Ht=(0,P._T)(Ui,["position","point","line","text","autoAdjust","direction"]);_=(0,P.pi)((0,P.pi)((0,P.pi)({},Ht),G),{coordinateBBox:this.getCoordinateBBox(),point:Fa,line:xo,text:Mo,autoAdjust:ao,direction:Io})}else if(t==="dataRegion"){var hs=i,tl=hs.start,pl=hs.end,pd=hs.region,Mo=hs.text,iv=hs.lineLength,Ht=(0,P._T)(hs,["start","end","region","text","lineLength"]);_=(0,P.pi)((0,P.pi)({},Ht),{points:this.getRegionPoints(tl,pl),region:pd,text:Mo,lineLength:iv})}else if(t==="regionFilter"){var jh=i,Dg=jh.start,Bg=jh.end,qA=jh.apply,OP=jh.color,Ht=(0,P._T)(jh,["start","end","apply","color"]),KA=this.view.geometries,Qb=[],Jb=function(dd){!dd||(dd.isGroup()?dd.getChildren().forEach(function(Dm){return Jb(Dm)}):Qb.push(dd))};(0,b.S6)(KA,function(dd){qA?(0,b.FX)(qA,dd.type)&&(0,b.S6)(dd.elements,function(Dm){Jb(Dm.shape)}):(0,b.S6)(dd.elements,function(Dm){Jb(Dm.shape)})}),_=(0,P.pi)((0,P.pi)({},Ht),{color:OP,shapes:Qb,start:R,end:U})}else if(t==="shape"){var QA=i,FP=QA.render,D_=(0,P._T)(QA,["render"]),JA=function(DP){if((0,b.mf)(i.render))return FP(DP,c.view,{parsePosition:c.parsePosition.bind(c)})};_=(0,P.pi)((0,P.pi)({},D_),{render:JA})}else if(t==="html"){var B_=i,tT=B_.html,BR=B_.position,D_=(0,P._T)(B_,["html","position"]),RP=function(dd){return(0,b.mf)(tT)?tT(dd,c.view):tT};_=(0,P.pi)((0,P.pi)((0,P.pi)({},D_),G),{parent:g.get("el").parentNode,html:RP})}var Kv=(0,b.b$)({},u,(0,P.pi)((0,P.pi)({},_),{top:i.top,style:i.style,offsetX:i.offsetX,offsetY:i.offsetY}));return t!=="html"&&(Kv.container=this.getComponentContainer(Kv)),Kv.animate=this.view.getOptions().animate&&Kv.animate&&(0,b.U2)(i,"animate",Kv.animate),Kv.animateOption=(0,b.b$)({},xa,Kv.animateOption,i.animateOption),Kv},e.prototype.isTop=function(t){return(0,b.U2)(t,"top",!0)},e.prototype.getComponentContainer=function(t){return this.isTop(t)?this.foregroundContainer:this.backgroundContainer},e.prototype.getAnnotationTheme=function(t){return(0,b.U2)(this.view.getTheme(),["components","annotation",t],{})},e.prototype.updateOrCreate=function(t){var i=this.cache.get(this.getCacheKey(t));if(i){var u=t.type,c=this.getAnnotationTheme(u),p=this.getAnnotationCfg(u,t,c);p&&ic(p,["container"]),i.component.update((0,P.pi)((0,P.pi)({},p||{}),{visible:!!p})),(0,b.q9)(I1,t.type)&&i.component.render()}else i=this.createAnnotation(t),i&&(i.component.init(),(0,b.q9)(I1,t.type)&&i.component.render());return i},e.prototype.syncCache=function(t){var i=this,u=new Map(this.cache);return t.forEach(function(c,p){u.set(p,c)}),u.forEach(function(c,p){(0,b.sE)(i.option,function(g){return p===i.getCacheKey(g)})||(c.component.destroy(),u.delete(p))}),u},e.prototype.getCacheKey=function(t){return t},e}(ni),i3=n3;function a3(r,e){var t=(0,b.b$)({},(0,b.U2)(r,["components","axis","common"]),(0,b.U2)(r,["components","axis",e]));return(0,b.U2)(t,["grid"],{})}function yy(r,e,t,i){var u=[],c=e.getTicks();return r.isPolar&&c.push({value:1,text:"",tickValue:""}),c.reduce(function(p,g,_){var S=g.value;if(i)u.push({points:[r.convert(t==="y"?{x:0,y:S}:{x:S,y:0}),r.convert(t==="y"?{x:1,y:S}:{x:S,y:1})]});else if(_){var k=p.value,L=(k+S)/2;u.push({points:[r.convert(t==="y"?{x:0,y:L}:{x:L,y:0}),r.convert(t==="y"?{x:1,y:L}:{x:L,y:1})]})}return g},c[0]),u}function k1(r,e,t,i,u){var c=e.values.length,p=[],g=t.getTicks();return g.reduce(function(_,S){var k=_?_.value:S.value,L=S.value,R=(k+L)/2;return u==="x"?p.push({points:[r.convert({x:i?L:R,y:0}),r.convert({x:i?L:R,y:1})]}):p.push({points:(0,b.UI)(Array(c+1),function(U,G){return r.convert({x:G/c,y:i?L:R})})}),S},g[0]),p}function o3(r,e){var t=(0,b.U2)(e,"grid");if(t===null)return!1;var i=(0,b.U2)(r,"grid");return!(t===void 0&&i===null)}var Dv=["container"],BE=(0,P.pi)((0,P.pi)({},xa),{appear:null}),s3=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.cache=new Map,i.gridContainer=i.view.getLayer(X.BG).addGroup(),i.gridForeContainer=i.view.getLayer(X.FORE).addGroup(),i.axisContainer=i.view.getLayer(X.BG).addGroup(),i.axisForeContainer=i.view.getLayer(X.FORE).addGroup(),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"axis"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.render=function(){this.update()},e.prototype.layout=function(){var t=this,i=this.view.getCoordinate();(0,b.S6)(this.getComponents(),function(u){var c=u.component,p=u.direction,g=u.type,_=u.extra,S=_.dim,k=_.scale,L=_.alignTick,R;if(g===Se.AXIS)i.isPolar?S==="x"?R=i.isTransposed?ii(i,p):dn(i):S==="y"&&(R=i.isTransposed?dn(i):ii(i,p)):R=ii(i,p);else if(g===Se.GRID)if(i.isPolar){var U=void 0;i.isTransposed?U=S==="x"?k1(i,t.view.getYScales()[0],k,L,S):yy(i,k,S,L):U=S==="x"?yy(i,k,S,L):k1(i,t.view.getXScale(),k,L,S),R={items:U,center:t.view.getCoordinate().getCenter()}}else R={items:yy(i,k,S,L)};c.update(R)})},e.prototype.update=function(){this.option=this.view.getOptions().axes;var t=new Map;this.updateXAxes(t),this.updateYAxes(t);var i=new Map;this.cache.forEach(function(u,c){t.has(c)?i.set(c,u):u.component.destroy()}),this.cache=i},e.prototype.clear=function(){r.prototype.clear.call(this),this.cache.clear(),this.gridContainer.clear(),this.gridForeContainer.clear(),this.axisContainer.clear(),this.axisForeContainer.clear()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.gridContainer.remove(!0),this.gridForeContainer.remove(!0),this.axisContainer.remove(!0),this.axisForeContainer.remove(!0)},e.prototype.getComponents=function(){var t=[];return this.cache.forEach(function(i){t.push(i)}),t},e.prototype.updateXAxes=function(t){var i=this.view.getXScale();if(!(!i||i.isIdentity)){var u=Xn(this.option,i.field);if(u!==!1){var c=vi(u,le.BOTTOM),p=X.BG,g="x",_=this.view.getCoordinate(),S=this.getId("axis",i.field),k=this.getId("grid",i.field);if(_.isRect){var L=this.cache.get(S);if(L){var R=this.getLineAxisCfg(i,u,c);ic(R,Dv),L.component.update(R),t.set(S,L)}else L=this.createLineAxis(i,u,p,c,g),this.cache.set(S,L),t.set(S,L);var U=this.cache.get(k);if(U){var R=this.getLineGridCfg(i,u,c,g);ic(R,Dv),U.component.update(R),t.set(k,U)}else U=this.createLineGrid(i,u,p,c,g),U&&(this.cache.set(k,U),t.set(k,U))}else if(_.isPolar){var L=this.cache.get(S);if(L){var R=_.isTransposed?this.getLineAxisCfg(i,u,le.RADIUS):this.getCircleAxisCfg(i,u,c);ic(R,Dv),L.component.update(R),t.set(S,L)}else{if(_.isTransposed){if((0,b.o8)(u))return;L=this.createLineAxis(i,u,p,le.RADIUS,g)}else L=this.createCircleAxis(i,u,p,c,g);this.cache.set(S,L),t.set(S,L)}var U=this.cache.get(k);if(U){var R=_.isTransposed?this.getCircleGridCfg(i,u,le.RADIUS,g):this.getLineGridCfg(i,u,le.CIRCLE,g);ic(R,Dv),U.component.update(R),t.set(k,U)}else{if(_.isTransposed){if((0,b.o8)(u))return;U=this.createCircleGrid(i,u,p,le.RADIUS,g)}else U=this.createLineGrid(i,u,p,le.CIRCLE,g);U&&(this.cache.set(k,U),t.set(k,U))}}}}},e.prototype.updateYAxes=function(t){var i=this,u=this.view.getYScales();(0,b.S6)(u,function(c,p){if(!(!c||c.isIdentity)){var g=c.field,_=Xn(i.option,g);if(_!==!1){var S=X.BG,k="y",L=i.getId("axis",g),R=i.getId("grid",g),U=i.view.getCoordinate();if(U.isRect){var G=vi(_,p===0?le.LEFT:le.RIGHT),Q=i.cache.get(L);if(Q){var pt=i.getLineAxisCfg(c,_,G);ic(pt,Dv),Q.component.update(pt),t.set(L,Q)}else Q=i.createLineAxis(c,_,S,G,k),i.cache.set(L,Q),t.set(L,Q);var yt=i.cache.get(R);if(yt){var pt=i.getLineGridCfg(c,_,G,k);ic(pt,Dv),yt.component.update(pt),t.set(R,yt)}else yt=i.createLineGrid(c,_,S,G,k),yt&&(i.cache.set(R,yt),t.set(R,yt))}else if(U.isPolar){var Q=i.cache.get(L);if(Q){var pt=U.isTransposed?i.getCircleAxisCfg(c,_,le.CIRCLE):i.getLineAxisCfg(c,_,le.RADIUS);ic(pt,Dv),Q.component.update(pt),t.set(L,Q)}else{if(U.isTransposed){if((0,b.o8)(_))return;Q=i.createCircleAxis(c,_,S,le.CIRCLE,k)}else Q=i.createLineAxis(c,_,S,le.RADIUS,k);i.cache.set(L,Q),t.set(L,Q)}var yt=i.cache.get(R);if(yt){var pt=U.isTransposed?i.getLineGridCfg(c,_,le.CIRCLE,k):i.getCircleGridCfg(c,_,le.RADIUS,k);ic(pt,Dv),yt.component.update(pt),t.set(R,yt)}else{if(U.isTransposed){if((0,b.o8)(_))return;yt=i.createLineGrid(c,_,S,le.CIRCLE,k)}else yt=i.createCircleGrid(c,_,S,le.RADIUS,k);yt&&(i.cache.set(R,yt),t.set(R,yt))}}}}})},e.prototype.createLineAxis=function(t,i,u,c,p){var g={component:new nc(this.getLineAxisCfg(t,i,c)),layer:u,direction:c===le.RADIUS?le.NONE:c,type:Se.AXIS,extra:{dim:p,scale:t}};return g.component.set("field",t.field),g.component.init(),g},e.prototype.createLineGrid=function(t,i,u,c,p){var g=this.getLineGridCfg(t,i,c,p);if(g){var _={component:new Ch(g),layer:u,direction:le.NONE,type:Se.GRID,extra:{dim:p,scale:t,alignTick:(0,b.U2)(g,"alignTick",!0)}};return _.component.init(),_}},e.prototype.createCircleAxis=function(t,i,u,c,p){var g={component:new Rd(this.getCircleAxisCfg(t,i,c)),layer:u,direction:c,type:Se.AXIS,extra:{dim:p,scale:t}};return g.component.set("field",t.field),g.component.init(),g},e.prototype.createCircleGrid=function(t,i,u,c,p){var g=this.getCircleGridCfg(t,i,c,p);if(g){var _={component:new Ah(g),layer:u,direction:le.NONE,type:Se.GRID,extra:{dim:p,scale:t,alignTick:(0,b.U2)(g,"alignTick",!0)}};return _.component.init(),_}},e.prototype.getLineAxisCfg=function(t,i,u){var c=(0,b.U2)(i,["top"])?this.axisForeContainer:this.axisContainer,p=this.view.getCoordinate(),g=ii(p,u),_=Rn(t,i),S=ri(this.view.getTheme(),u),k=(0,b.U2)(i,["title"])?(0,b.b$)({title:{style:{text:_}}},{title:Gr(this.view.getTheme(),u,i.title)},i):i,L=(0,b.b$)((0,P.pi)((0,P.pi)({container:c},g),{ticks:t.getTicks().map(function(ce){return{id:"".concat(ce.tickValue),name:ce.text,value:ce.value}}),verticalFactor:p.isPolar?qn(g,p.getCenter())*-1:qn(g,p.getCenter()),theme:S}),S,k),R=this.getAnimateCfg(L),U=R.animate,G=R.animateOption;L.animateOption=G,L.animate=U;var Q=yi(g),pt=(0,b.U2)(L,"verticalLimitLength",Q?1/3:1/2);if(pt<=1){var yt=this.view.getCanvas().get("width"),Ht=this.view.getCanvas().get("height");L.verticalLimitLength=pt*(Q?yt:Ht)}return L},e.prototype.getLineGridCfg=function(t,i,u,c){if(!!o3(ri(this.view.getTheme(),u),i)){var p=a3(this.view.getTheme(),u),g=(0,b.b$)({container:(0,b.U2)(i,["top"])?this.gridForeContainer:this.gridContainer},p,(0,b.U2)(i,"grid"),this.getAnimateCfg(i));return g.items=yy(this.view.getCoordinate(),t,c,(0,b.U2)(g,"alignTick",!0)),g}},e.prototype.getCircleAxisCfg=function(t,i,u){var c=(0,b.U2)(i,["top"])?this.axisForeContainer:this.axisContainer,p=this.view.getCoordinate(),g=t.getTicks().map(function(Q){return{id:"".concat(Q.tickValue),name:Q.text,value:Q.value}});!t.isCategory&&Math.abs(p.endAngle-p.startAngle)===Math.PI*2&&g.pop();var _=Rn(t,i),S=ri(this.view.getTheme(),le.CIRCLE),k=(0,b.U2)(i,["title"])?(0,b.b$)({title:{style:{text:_}}},{title:Gr(this.view.getTheme(),u,i.title)},i):i,L=(0,b.b$)((0,P.pi)((0,P.pi)({container:c},dn(this.view.getCoordinate())),{ticks:g,verticalFactor:1,theme:S}),S,k),R=this.getAnimateCfg(L),U=R.animate,G=R.animateOption;return L.animate=U,L.animateOption=G,L},e.prototype.getCircleGridCfg=function(t,i,u,c){if(!!o3(ri(this.view.getTheme(),u),i)){var p=a3(this.view.getTheme(),le.RADIUS),g=(0,b.b$)({container:(0,b.U2)(i,["top"])?this.gridForeContainer:this.gridContainer,center:this.view.getCoordinate().getCenter()},p,(0,b.U2)(i,"grid"),this.getAnimateCfg(i)),_=(0,b.U2)(g,"alignTick",!0),S=c==="x"?this.view.getYScales()[0]:this.view.getXScale();return g.items=k1(this.view.getCoordinate(),S,t,_,c),g}},e.prototype.getId=function(t,i){var u=this.view.getCoordinate();return"".concat(t,"-").concat(i,"-").concat(u.type)},e.prototype.getAnimateCfg=function(t){return{animate:this.view.getOptions().animate&&(0,b.U2)(t,"animate"),animateOption:t&&t.animateOption?(0,b.b$)({},BE,t.animateOption):BE}},e}(ni),u3=s3;function Bv(r,e,t){return t===le.TOP?[r.minX+r.width/2-e.width/2,r.minY]:t===le.BOTTOM?[r.minX+r.width/2-e.width/2,r.maxY-e.height]:t===le.LEFT?[r.minX,r.minY+r.height/2-e.height/2]:t===le.RIGHT?[r.maxX-e.width,r.minY+r.height/2-e.height/2]:t===le.TOP_LEFT||t===le.LEFT_TOP?[r.tl.x,r.tl.y]:t===le.TOP_RIGHT||t===le.RIGHT_TOP?[r.tr.x-e.width,r.tr.y]:t===le.BOTTOM_LEFT||t===le.LEFT_BOTTOM?[r.bl.x,r.bl.y-e.height]:t===le.BOTTOM_RIGHT||t===le.RIGHT_BOTTOM?[r.br.x-e.width,r.br.y-e.height]:[0,0]}function l3(r,e){if(e.isTransposed)switch(r){case DIRECTION.BOTTOM:return DIRECTION.LEFT;case DIRECTION.LEFT:return DIRECTION.BOTTOM;case DIRECTION.RIGHT:return DIRECTION.TOP;case DIRECTION.TOP:return DIRECTION.RIGHT}return r}function NE(r){return r===DIRECTION.LEFT?DIRECTION.RIGHT:r===DIRECTION.RIGHT?DIRECTION.LEFT:r}function zE(r){return r===DIRECTION.TOP?DIRECTION.BOTTOM:r===DIRECTION.BOTTOM?DIRECTION.TOP:r}function c3(r,e){var t=e.matrix[0],i=e.matrix[4],u=r;return t<0&&(u=NE(u)),i<0&&(u=zE(u)),u}function f3(r,e){var t=r;return e.isReflect("x")&&(t=NE(t)),e.isReflect("y")&&(t=zE(t)),t}function FO(r,e){var t=r;return t=l3(t,e),t=c3(t,e),t=f3(t,e),t}function h3(r,e){return(0,b.jn)(r)?r===!1?!1:{}:(0,b.U2)(r,[e],r)}function _y(r){return(0,b.U2)(r,"position",le.BOTTOM)}var UE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.container=i.view.getLayer(X.FORE).addGroup(),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"legend"},enumerable:!1,configurable:!0}),e.prototype.init=function(){},e.prototype.render=function(){this.update()},e.prototype.layout=function(){var t=this;this.layoutBBox=this.view.viewBBox,(0,b.S6)(this.components,function(i){var u=i.component,c=i.direction,p=Ud(c),g=u.get("maxWidthRatio"),_=u.get("maxHeightRatio"),S=t.getCategoryLegendSizeCfg(p,g,_),k=u.get("maxWidth"),L=u.get("maxHeight");u.update({maxWidth:Math.min(S.maxWidth,k||0),maxHeight:Math.min(S.maxHeight,L||0)});var R=u.get("padding"),U=u.getLayoutBBox(),G=new Nu(U.x,U.y,U.width,U.height).expand(R),Q=(0,P.CR)(Bv(t.view.viewBBox,G,c),2),pt=Q[0],yt=Q[1],Ht=(0,P.CR)(Bv(t.layoutBBox,G,c),2),ce=Ht[0],he=Ht[1],ze=0,Er=0;c.startsWith("top")||c.startsWith("bottom")?(ze=pt,Er=he):(ze=ce,Er=yt),u.setLocation({x:ze+R[3],y:Er+R[0]}),t.layoutBBox=t.layoutBBox.cut(G,c)})},e.prototype.update=function(){var t=this;this.option=this.view.getOptions().legends;var i={},u=function(R,U,G){var Q=t.getId(G.field),pt=t.getComponentById(Q);if(pt){var yt=void 0,Ht=h3(t.option,G.field);Ht!==!1&&((0,b.U2)(Ht,"custom")?yt=t.getCategoryCfg(R,U,G,Ht,!0):G.isLinear?yt=t.getContinuousCfg(R,U,G,Ht):G.isCategory&&(yt=t.getCategoryCfg(R,U,G,Ht))),yt&&(ic(yt,["container"]),pt.direction=_y(Ht),pt.component.update(yt),i[Q]=!0)}else{var ce=t.createFieldLegend(R,U,G);ce&&(ce.component.init(),t.components.push(ce),i[Q]=!0)}};if((0,b.U2)(this.option,"custom")){var c="global-custom",p=this.getComponentById(c);if(p){var g=this.getCategoryCfg(void 0,void 0,void 0,this.option,!0);ic(g,["container"]),p.component.update(g),i[c]=!0}else{var _=this.createCustomLegend(void 0,void 0,void 0,this.option);if(_){_.init();var S=X.FORE,k=_y(this.option);this.components.push({id:c,component:_,layer:S,direction:k,type:Se.LEGEND,extra:void 0}),i[c]=!0}}}else this.loopLegends(u);var L=[];(0,b.S6)(this.getComponents(),function(R){i[R.id]?L.push(R):R.component.destroy()}),this.components=L},e.prototype.clear=function(){r.prototype.clear.call(this),this.container.clear()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.container.remove(!0)},e.prototype.getGeometries=function(t){var i=this,u=t.geometries;return(0,b.S6)(t.views,function(c){u=u.concat(i.getGeometries(c))}),u},e.prototype.loopLegends=function(t){var i=this.view.getRootView()===this.view;if(!!i){var u=this.getGeometries(this.view),c={};(0,b.S6)(u,function(p){var g=p.getGroupAttributes();(0,b.S6)(g,function(_){var S=_.getScale(_.type);!S||S.type==="identity"||c[S.field]||(t(p,_,S),c[S.field]=!0)})})}},e.prototype.createFieldLegend=function(t,i,u){var c,p=h3(this.option,u.field),g=X.FORE,_=_y(p);if(p!==!1&&((0,b.U2)(p,"custom")?c=this.createCustomLegend(t,i,u,p):u.isLinear?c=this.createContinuousLegend(t,i,u,p):u.isCategory&&(c=this.createCategoryLegend(t,i,u,p))),c)return c.set("field",u.field),{id:this.getId(u.field),component:c,layer:g,direction:_,type:Se.LEGEND,extra:{scale:u}}},e.prototype.createCustomLegend=function(t,i,u,c){var p=this.getCategoryCfg(t,i,u,c,!0);return new e0(p)},e.prototype.createContinuousLegend=function(t,i,u,c){var p=this.getContinuousCfg(t,i,u,ic(c,["value"]));return new r0(p)},e.prototype.createCategoryLegend=function(t,i,u,c){var p=this.getCategoryCfg(t,i,u,c);return new e0(p)},e.prototype.getContinuousCfg=function(t,i,u,c){var p=u.getTicks(),g=(0,b.sE)(p,function(Q){return Q.value===0}),_=(0,b.sE)(p,function(Q){return Q.value===1}),S=p.map(function(Q){var pt=Q.value,yt=Q.tickValue,Ht=i.mapping(u.invert(pt)).join("");return{value:yt,attrValue:Ht,color:Ht,scaleValue:pt}});g||S.push({value:u.min,attrValue:i.mapping(u.invert(0)).join(""),color:i.mapping(u.invert(0)).join(""),scaleValue:0}),_||S.push({value:u.max,attrValue:i.mapping(u.invert(1)).join(""),color:i.mapping(u.invert(1)).join(""),scaleValue:1}),S.sort(function(Q,pt){return Q.value-pt.value});var k={min:(0,b.YM)(S).value,max:(0,b.Z$)(S).value,colors:[],rail:{type:i.type},track:{}};i.type==="size"&&(k.track={style:{fill:i.type==="size"?this.view.getTheme().defaultColor:void 0}}),i.type==="color"&&(k.colors=S.map(function(Q){return Q.attrValue}));var L=this.container,R=_y(c),U=Ud(R),G=(0,b.U2)(c,"title");return G&&(G=(0,b.b$)({text:on(u)},G)),k.container=L,k.layout=U,k.title=G,k.animateOption=xa,this.mergeLegendCfg(k,c,"continuous")},e.prototype.getCategoryCfg=function(t,i,u,c,p){var g=this.container,_=(0,b.U2)(c,"position",le.BOTTOM),S=bv(this.view.getTheme(),_),k=(0,b.U2)(S,["marker"]),L=(0,b.U2)(c,"marker"),R=Ud(_),U=(0,b.U2)(S,["pageNavigator"]),G=(0,b.U2)(c,"pageNavigator"),Q=p?xv(k,L,c.items):Zd(this.view,t,i,k,L),pt=(0,b.U2)(c,"title");pt&&(pt=(0,b.b$)({text:u?on(u):""},pt));var yt=(0,b.U2)(c,"maxWidthRatio"),Ht=(0,b.U2)(c,"maxHeightRatio"),ce=this.getCategoryLegendSizeCfg(R,yt,Ht);ce.container=g,ce.layout=R,ce.items=Q,ce.title=pt,ce.animateOption=xa,ce.pageNavigator=(0,b.b$)({},U,G);var he=this.mergeLegendCfg(ce,c,_);he.reversed&&he.items.reverse();var ze=(0,b.U2)(he,"maxItemWidth");return ze&&ze<=1&&(he.maxItemWidth=this.view.viewBBox.width*ze),he},e.prototype.mergeLegendCfg=function(t,i,u){var c=u.split("-")[0],p=bv(this.view.getTheme(),c);return(0,b.b$)({},p,t,i)},e.prototype.getId=function(t){return"".concat(this.name,"-").concat(t)},e.prototype.getComponentById=function(t){return(0,b.sE)(this.components,function(i){return i.id===t})},e.prototype.getCategoryLegendSizeCfg=function(t,i,u){i===void 0&&(i=_e),u===void 0&&(u=_e);var c=this.view.viewBBox,p=c.width,g=c.height;return t==="vertical"?{maxWidth:p*i,maxHeight:g}:{maxWidth:p,maxHeight:g*u}},e}(ni),ZE=UE,VE=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.onChangeFn=b.ZT,i.resetMeasure=function(){i.clear()},i.onValueChange=function(u){var c=(0,P.CR)(u,2),p=c[0],g=c[1];i.start=p,i.end=g,i.changeViewData(p,g)},i.container=i.view.getLayer(X.FORE).addGroup(),i.onChangeFn=(0,b.P2)(i.onValueChange,20,{leading:!0}),i.width=0,i.view.on(It.BEFORE_CHANGE_DATA,i.resetMeasure),i.view.on(It.BEFORE_CHANGE_SIZE,i.resetMeasure),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"slider"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.view.off(It.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(It.BEFORE_CHANGE_SIZE,this.resetMeasure)},e.prototype.init=function(){},e.prototype.render=function(){this.option=this.view.getOptions().slider;var t=this.getSliderCfg(),i=t.start,u=t.end;(0,b.UM)(this.start)&&(this.start=i,this.end=u);var c=this.view.getOptions().data;this.option&&!(0,b.xb)(c)?this.slider?this.slider=this.updateSlider():(this.slider=this.createSlider(),this.slider.component.on("sliderchange",this.onChangeFn)):this.slider&&(this.slider.component.destroy(),this.slider=void 0)},e.prototype.layout=function(){var t=this;if(this.option&&!this.width&&(this.measureSlider(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.start,t.end)},0)),this.slider){var i=this.view.coordinateBBox.width,u=this.slider.component.get("padding"),c=(0,P.CR)(u,4),p=c[0],g=c[1],_=c[2],S=c[3],k=this.slider.component.getLayoutBBox(),L=new Nu(k.x,k.y,Math.min(k.width,i),k.height).expand(u),R=this.getMinMaxText(this.start,this.end),U=R.minText,G=R.maxText,Q=(0,P.CR)(Bv(this.view.viewBBox,L,le.BOTTOM),2),pt=Q[0],yt=Q[1],Ht=(0,P.CR)(Bv(this.view.coordinateBBox,L,le.BOTTOM),2),ce=Ht[0],he=Ht[1];this.slider.component.update((0,P.pi)((0,P.pi)({},this.getSliderCfg()),{x:ce+S,y:yt+p,width:this.width,start:this.start,end:this.end,minText:U,maxText:G})),this.view.viewBBox=this.view.viewBBox.cut(L,le.BOTTOM)}},e.prototype.update=function(){this.render()},e.prototype.createSlider=function(){var t=this.getSliderCfg(),i=new Od((0,P.pi)({container:this.container},t));return i.init(),{component:i,layer:X.FORE,direction:le.BOTTOM,type:Se.SLIDER}},e.prototype.updateSlider=function(){var t=this.getSliderCfg();if(this.width){var i=this.getMinMaxText(this.start,this.end),u=i.minText,c=i.maxText;t=(0,P.pi)((0,P.pi)({},t),{width:this.width,start:this.start,end:this.end,minText:u,maxText:c})}return this.slider.component.update(t),this.slider},e.prototype.measureSlider=function(){var t=this.getSliderCfg().width;this.width=t},e.prototype.getSliderCfg=function(){var t={height:16,start:0,end:1,minText:"",maxText:"",x:0,y:0,width:this.view.coordinateBBox.width};if((0,b.Kn)(this.option)){var i=(0,P.pi)({data:this.getData()},(0,b.U2)(this.option,"trendCfg",{}));t=(0,b.b$)({},t,this.getThemeOptions(),this.option),t=(0,P.pi)((0,P.pi)({},t),{trendCfg:i})}return t.start=(0,b.uZ)(Math.min((0,b.UM)(t.start)?0:t.start,(0,b.UM)(t.end)?1:t.end),0,1),t.end=(0,b.uZ)(Math.max((0,b.UM)(t.start)?0:t.start,(0,b.UM)(t.end)?1:t.end),0,1),t},e.prototype.getData=function(){var t=this.view.getOptions().data,i=(0,P.CR)(this.view.getYScales(),1),u=i[0],c=this.view.getGroupScales();if(c.length){var p=c[0],g=p.field,_=p.ticks;return t.reduce(function(S,k){return k[g]===_[0]&&S.push(k[u.field]),S},[])}return t.map(function(S){return S[u.field]||0})},e.prototype.getThemeOptions=function(){var t=this.view.getTheme();return(0,b.U2)(t,["components","slider","common"],{})},e.prototype.getMinMaxText=function(t,i){var u=this.view.getOptions().data,c=this.view.getXScale(),p=!0,g=(0,b.I)(u,c.field);c.isLinear&&(g=g.sort());var _=p?g:g.reverse(),S=(0,b.dp)(u);if(!c||!S)return{};var k=(0,b.dp)(_),L=Math.round(t*(k-1)),R=Math.round(i*(k-1)),U=(0,b.U2)(_,[L]),G=(0,b.U2)(_,[R]),Q=this.getSliderCfg().formatter;return Q&&(U=Q(U,u[L],L),G=Q(G,u[R],R)),{minText:U,maxText:G}},e.prototype.changeViewData=function(t,i){var u=this.view.getOptions().data,c=this.view.getXScale(),p=(0,b.dp)(u);if(!(!c||!p)){var g=!0,_=(0,b.I)(u,c.field),S=this.view.getXScale().isLinear?_.sort(function(G,Q){return Number(G)-Number(Q)}):_,k=g?S:S.reverse(),L=(0,b.dp)(k),R=Math.round(t*(L-1)),U=Math.round(i*(L-1));this.view.filter(c.field,function(G,Q){var pt=k.indexOf(G);return pt>-1?Yp(pt,R,U):!0}),this.view.render(!0)}},e.prototype.getComponents=function(){return this.slider?[this.slider]:[]},e.prototype.clear=function(){this.slider&&(this.slider.component.destroy(),this.slider=void 0),this.width=0,this.start=void 0,this.end=void 0},e}(ni),nd=VE,xy=0,g0=8,GE=32,L1=20,P1=function(r){(0,P.ZT)(e,r);function e(t){var i=r.call(this,t)||this;return i.onChangeFn=b.ZT,i.resetMeasure=function(){i.clear()},i.onValueChange=function(u){var c=u.ratio,p=i.getValidScrollbarCfg().animate;i.ratio=(0,b.uZ)(c,0,1);var g=i.view.getOptions().animate;p||i.view.animate(!1),i.changeViewData(i.getScrollRange(),!0),i.view.animate(g)},i.container=i.view.getLayer(X.FORE).addGroup(),i.onChangeFn=(0,b.P2)(i.onValueChange,20,{leading:!0}),i.trackLen=0,i.thumbLen=0,i.ratio=0,i.view.on(It.BEFORE_CHANGE_DATA,i.resetMeasure),i.view.on(It.BEFORE_CHANGE_SIZE,i.resetMeasure),i}return Object.defineProperty(e.prototype,"name",{get:function(){return"scrollbar"},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.view.off(It.BEFORE_CHANGE_DATA,this.resetMeasure),this.view.off(It.BEFORE_CHANGE_SIZE,this.resetMeasure)},e.prototype.init=function(){},e.prototype.render=function(){this.option=this.view.getOptions().scrollbar,this.option?this.scrollbar?this.scrollbar=this.updateScrollbar():(this.scrollbar=this.createScrollbar(),this.scrollbar.component.on("scrollchange",this.onChangeFn)):this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0)},e.prototype.layout=function(){var t=this;if(this.option&&!this.trackLen&&(this.measureScrollbar(),setTimeout(function(){t.view.destroyed||t.changeViewData(t.getScrollRange(),!0)})),this.scrollbar){var i=this.view.coordinateBBox.width,u=this.scrollbar.component.get("padding"),c=this.scrollbar.component.getLayoutBBox(),p=new Nu(c.x,c.y,Math.min(c.width,i),c.height).expand(u),g=this.getScrollbarComponentCfg(),_=void 0,S=void 0;if(g.isHorizontal){var k=(0,P.CR)(Bv(this.view.viewBBox,p,le.BOTTOM),2),L=k[0],R=k[1],U=(0,P.CR)(Bv(this.view.coordinateBBox,p,le.BOTTOM),2),G=U[0],Q=U[1];_=G,S=R}else{var pt=(0,P.CR)(Bv(this.view.viewBBox,p,le.RIGHT),2),L=pt[0],R=pt[1],yt=(0,P.CR)(Bv(this.view.viewBBox,p,le.RIGHT),2),G=yt[0],Q=yt[1];_=G,S=R}_+=u[3],S+=u[0],this.trackLen?this.scrollbar.component.update((0,P.pi)((0,P.pi)({},g),{x:_,y:S,trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio})):this.scrollbar.component.update((0,P.pi)((0,P.pi)({},g),{x:_,y:S})),this.view.viewBBox=this.view.viewBBox.cut(p,g.isHorizontal?le.BOTTOM:le.RIGHT)}},e.prototype.update=function(){this.render()},e.prototype.getComponents=function(){return this.scrollbar?[this.scrollbar]:[]},e.prototype.clear=function(){this.scrollbar&&(this.scrollbar.component.destroy(),this.scrollbar=void 0),this.trackLen=0,this.thumbLen=0,this.ratio=0,this.cnt=0,this.step=0,this.data=void 0,this.xScaleCfg=void 0,this.yScalesCfg=[]},e.prototype.setValue=function(t){this.onValueChange({ratio:t})},e.prototype.getValue=function(){return this.ratio},e.prototype.getThemeOptions=function(){var t=this.view.getTheme();return(0,b.U2)(t,["components","scrollbar","common"],{})},e.prototype.getScrollbarTheme=function(t){var i=(0,b.U2)(this.view.getTheme(),["components","scrollbar"]),u=t||{},c=u.thumbHighlightColor,p=(0,P._T)(u,["thumbHighlightColor"]);return{default:(0,b.b$)({},(0,b.U2)(i,["default","style"],{}),p),hover:(0,b.b$)({},(0,b.U2)(i,["hover","style"],{}),{thumbColor:c})}},e.prototype.measureScrollbar=function(){var t=this.view.getXScale(),i=this.view.getYScales().slice();this.data=this.getScrollbarData(),this.step=this.getStep(),this.cnt=this.getCnt();var u=this.getScrollbarComponentCfg(),c=u.trackLen,p=u.thumbLen;this.trackLen=c,this.thumbLen=p,this.xScaleCfg={field:t.field,values:t.values||[]},this.yScalesCfg=i},e.prototype.getScrollRange=function(){var t=Math.floor((this.cnt-this.step)*(0,b.uZ)(this.ratio,0,1)),i=Math.min(t+this.step-1,this.cnt-1);return[t,i]},e.prototype.changeViewData=function(t,i){var u=this,c=(0,P.CR)(t,2),p=c[0],g=c[1],_=this.getValidScrollbarCfg().type,S=_!=="vertical",k=(0,b.I)(this.data,this.xScaleCfg.field),L=this.view.getXScale().isLinear?k.sort(function(U,G){return Number(U)-Number(G)}):k,R=S?L:L.reverse();this.yScalesCfg.forEach(function(U){u.view.scale(U.field,{formatter:U.formatter,type:U.type,min:U.min,max:U.max,tickMethod:U.tickMethod})}),this.view.filter(this.xScaleCfg.field,function(U){var G=R.indexOf(U);return G>-1?Yp(G,p,g):!0}),this.view.render(!0)},e.prototype.createScrollbar=function(){var t=this.getValidScrollbarCfg().type,i=t!=="vertical",u=new t0((0,P.pi)((0,P.pi)({container:this.container},this.getScrollbarComponentCfg()),{x:0,y:0}));return u.init(),{component:u,layer:X.FORE,direction:i?le.BOTTOM:le.RIGHT,type:Se.SCROLLBAR}},e.prototype.updateScrollbar=function(){var t=this.getScrollbarComponentCfg(),i=this.trackLen?(0,P.pi)((0,P.pi)({},t),{trackLen:this.trackLen,thumbLen:this.thumbLen,thumbOffset:(this.trackLen-this.thumbLen)*this.ratio}):(0,P.pi)({},t);return this.scrollbar.component.update(i),this.scrollbar},e.prototype.getStep=function(){if(this.step)return this.step;var t=this.view.coordinateBBox,i=this.getValidScrollbarCfg(),u=i.type,c=i.categorySize,p=u!=="vertical";return Math.floor((p?t.width:t.height)/c)},e.prototype.getCnt=function(){if(this.cnt)return this.cnt;var t=this.view.getXScale(),i=this.getScrollbarData(),u=(0,b.I)(i,t.field);return(0,b.dp)(u)},e.prototype.getScrollbarComponentCfg=function(){var t=this.view,i=t.coordinateBBox,u=t.viewBBox,c=this.getValidScrollbarCfg(),p=c.type,g=c.padding,_=c.width,S=c.height,k=c.style,L=p!=="vertical",R=(0,P.CR)(g,4),U=R[0],G=R[1],Q=R[2],pt=R[3],yt=L?{x:i.minX+pt,y:u.maxY-S-Q}:{x:u.maxX-_-G,y:i.minY+U},Ht=this.getStep(),ce=this.getCnt(),he=L?i.width-pt-G:i.height-U-Q,ze=Math.max(he*(0,b.uZ)(Ht/ce,0,1),L1);return(0,P.pi)((0,P.pi)({},this.getThemeOptions()),{x:yt.x,y:yt.y,size:L?S:_,isHorizontal:L,trackLen:he,thumbLen:ze,thumbOffset:0,theme:this.getScrollbarTheme(k)})},e.prototype.getValidScrollbarCfg=function(){var t={type:"horizontal",categorySize:GE,width:g0,height:g0,padding:[0,0,0,0],animate:!0,style:{}};return(0,b.Kn)(this.option)&&(t=(0,P.pi)((0,P.pi)({},t),this.option)),(!(0,b.Kn)(this.option)||!this.option.padding)&&(t.padding=t.type==="horizontal"?[xy,0,xy,0]:[0,xy,0,xy]),t},e.prototype.getScrollbarData=function(){var t=this.view.getCoordinate(),i=this.getValidScrollbarCfg(),u=this.view.getOptions().data||[];return t.isReflect("y")&&i.type==="vertical"&&(u=(0,P.ev)([],(0,P.CR)(u),!1).reverse()),u},e}(ni),nm=P1,O1={fill:"#CCD6EC",opacity:.3};function HE(r,e,t){var i,u,c,p,g,_,S=d(r,e,t);if(S.length){S=(0,b.xH)(S);try{for(var k=(0,P.XA)(S),L=k.next();!L.done;L=k.next()){var R=L.value;try{for(var U=(c=void 0,(0,P.XA)(R)),G=U.next();!G.done;G=U.next()){var Q=G.value,pt=Q.mappingData,yt=pt.x,Ht=pt.y;Q.x=(0,b.kJ)(yt)?yt[yt.length-1]:yt,Q.y=(0,b.kJ)(Ht)?Ht[Ht.length-1]:Ht}}catch(nn){c={error:nn}}finally{try{G&&!G.done&&(p=U.return)&&p.call(U)}finally{if(c)throw c.error}}}}catch(nn){i={error:nn}}finally{try{L&&!L.done&&(u=k.return)&&u.call(k)}finally{if(i)throw i.error}}var ce=t.shared;if(ce===!1&&S.length>1){var he=S[0],ze=Math.abs(e.y-he[0].y);try{for(var Er=(0,P.XA)(S),Fr=Er.next();!Fr.done;Fr=Er.next()){var zr=Fr.value,pn=Math.abs(e.y-zr[0].y);pn<=ze&&(he=zr,ze=pn)}}catch(nn){g={error:nn}}finally{try{Fr&&!Fr.done&&(_=Er.return)&&_.call(Er)}finally{if(g)throw g.error}}S=[he]}return(0,b.jj)((0,b.xH)(S))}return[]}var p3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.show=function(t){var i=this.context.view,u=this.context.event,c=i.getController("tooltip").getTooltipCfg(),p=HE(i,{x:u.x,y:u.y},c);if(!(0,b.Xy)(p,this.items)&&(this.items=p,p.length)){var g=i.getXScale().field,_=p[0].data[g],S=[],k=i.geometries;if((0,b.S6)(k,function(fa){if(fa.type==="interval"||fa.type==="schema"){var Ui=fa.getElementsBy(function(Ji){var Fa=Ji.getData();return Fa[g]===_});S=S.concat(Ui)}}),S.length){var L=i.getCoordinate(),R=S[0].shape.getCanvasBBox(),U=S[0].shape.getCanvasBBox(),G=R;(0,b.S6)(S,function(fa){var Ui=fa.shape.getCanvasBBox();L.isTransposed?(Ui.minY<R.minY&&(R=Ui),Ui.maxY>U.maxY&&(U=Ui)):(Ui.minX<R.minX&&(R=Ui),Ui.maxX>U.maxX&&(U=Ui)),G.x=Math.min(Ui.minX,G.minX),G.y=Math.min(Ui.minY,G.minY),G.width=Math.max(Ui.maxX,G.maxX)-G.x,G.height=Math.max(Ui.maxY,G.maxY)-G.y});var Q=i.backgroundGroup,pt=i.coordinateBBox,yt=void 0;if(L.isRect){var Ht=i.getXScale(),ce=t||{},he=ce.appendRatio,ze=ce.appendWidth;(0,b.UM)(ze)&&(he=(0,b.UM)(he)?Ht.isLinear?0:.25:he,ze=L.isTransposed?he*U.height:he*R.width);var Er=void 0,Fr=void 0,zr=void 0,pn=void 0;L.isTransposed?(Er=pt.minX,Fr=Math.min(U.minY,R.minY)-ze,zr=pt.width,pn=G.height+ze*2):(Er=Math.min(R.minX,U.minX)-ze,Fr=pt.minY,zr=G.width+ze*2,pn=pt.height),yt=[["M",Er,Fr],["L",Er+zr,Fr],["L",Er+zr,Fr+pn],["L",Er,Fr+pn],["Z"]]}else{var nn=(0,b.YM)(S),Pn=(0,b.Z$)(S),wi=Xp(nn.getModel(),L).startAngle,ha=Xp(Pn.getModel(),L).endAngle,Sa=L.getCenter(),_o=L.getRadius(),Vn=L.innerRadius*_o;yt=gu(Sa.x,Sa.y,_o,wi,ha,Vn)}if(this.regionPath)this.regionPath.attr("path",yt),this.regionPath.show();else{var Bi=(0,b.U2)(t,"style",O1);this.regionPath=Q.addShape({type:"path",name:"active-region",capture:!1,attrs:(0,P.pi)((0,P.pi)({},Bi),{path:yt})})}}}},e.prototype.hide=function(){this.regionPath&&this.regionPath.hide(),this.items=null},e.prototype.destroy=function(){this.hide(),this.regionPath&&this.regionPath.remove(!0),r.prototype.destroy.call(this)},e}(oi),jE=p3,Ff=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.show=function(){var t=this.context,i=t.event,u=t.view,c=u.isTooltipLocked();if(!c){var p=this.timeStamp,g=+new Date,_=(0,b.U2)(t.view.getOptions(),"tooltip.showDelay",16);if(g-p>_){var S=this.location,k={x:i.x,y:i.y};(!S||!(0,b.Xy)(S,k))&&this.showTooltip(u,k),this.timeStamp=g,this.location=k}}},e.prototype.hide=function(){var t=this.context.view,i=t.getController("tooltip"),u=this.context.event,c=u.clientX,p=u.clientY;i.isCursorEntered({x:c,y:p})||t.isTooltipLocked()||(this.hideTooltip(t),this.location=null)},e.prototype.showTooltip=function(t,i){t.showTooltip(i)},e.prototype.hideTooltip=function(t){t.hideTooltip()},e}(oi),WE=Ff,v3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.showTooltip=function(t,i){var u=mr(t);(0,b.S6)(u,function(c){var p=kr(t,c,i);c.showTooltip(p)})},e.prototype.hideTooltip=function(t){var i=mr(t);(0,b.S6)(i,function(u){u.hideTooltip()})},e}(WE),g3=v3,m0=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.show=function(){var t=this.context,i=t.event,u=this.timeStamp,c=+new Date;if(c-u>16){var p=this.location,g={x:i.x,y:i.y};(!p||!(0,b.Xy)(p,g))&&this.showTooltip(g),this.timeStamp=c,this.location=g}},e.prototype.hide=function(){this.hideTooltip(),this.location=null},e.prototype.showTooltip=function(t){var i=this.context,u=i.event,c=u.target;if(c&&c.get("tip")){this.tooltip||this.renderTooltip();var p=c.get("tip");this.tooltip.update((0,P.pi)({title:p},t)),this.tooltip.show()}},e.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=this.context.view,u=i.canvas,c={start:{x:0,y:0},end:{x:u.get("width"),y:u.get("height")}},p=i.getTheme(),g=(0,b.U2)(p,["components","tooltip","domStyles"],{}),_=new lp({parent:u.get("el").parentNode,region:c,visible:!1,crosshairs:null,domStyles:(0,P.pi)({},(0,b.b$)({},g,(t={},t[ef]={"max-width":"50%"},t[Cl]={"word-break":"break-all"},t)))});_.init(),_.setCapture(!1),this.tooltip=_},e}(oi),m3=m0,RO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="",t}return e.prototype.hasState=function(t){return t.hasState(this.stateName)},e.prototype.setElementState=function(t,i){t.setState(this.stateName,i)},e.prototype.setState=function(){this.setStateEnable(!0)},e.prototype.clear=function(){var t=this.context.view;this.clearViewState(t)},e.prototype.clearViewState=function(t){var i=this,u=Je(t,this.stateName);(0,b.S6)(u,function(c){i.setElementState(c,!1)})},e}(oi),XE=RO;function y3(r){return(0,b.U2)(r.get("delegateObject"),"item")}var DO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ignoreListItemStates=["unchecked"],t}return e.prototype.isItemIgnore=function(t,i){var u=this.ignoreListItemStates,c=u.filter(function(p){return i.hasState(t,p)});return!!c.length},e.prototype.setStateByComponent=function(t,i,u){var c=this.context.view,p=t.get("field"),g=wo(c);this.setElementsStateByItem(g,p,i,u)},e.prototype.setStateByElement=function(t,i){this.setElementState(t,i)},e.prototype.isMathItem=function(t,i,u){var c=this.context.view,p=vr(c,i),g=an(t,i);return!(0,b.UM)(g)&&u.name===p.getText(g)},e.prototype.setElementsStateByItem=function(t,i,u,c){var p=this;(0,b.S6)(t,function(g){p.isMathItem(g,i,u)&&g.setState(p.stateName,c)})},e.prototype.setStateEnable=function(t){var i=Jo(this.context);if(i)tu(this.context)&&this.setStateByElement(i,t);else{var u=La(this.context);if(fo(u)){var c=u.item,p=u.component;if(c&&p&&!this.isItemIgnore(c,p)){var g=this.context.event.gEvent;if(g&&g.fromShape&&g.toShape&&y3(g.fromShape)===y3(g.toShape))return;this.setStateByComponent(p,c,t)}}}},e.prototype.toggle=function(){var t=Jo(this.context);if(t){var i=t.hasState(this.stateName);this.setElementState(t,!i)}},e.prototype.reset=function(){this.setStateEnable(!1)},e}(XE),YE=DO,BO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(YE),_3=BO,F1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.cache={},t}return e.prototype.getColorScale=function(t,i){var u=i.geometry.getAttribute("color");if(!u)return null;var c=t.getScaleByField(u.getFields()[0]);return c},e.prototype.getLinkPath=function(t,i){var u=this.context.view,c=u.getCoordinate().isTransposed,p=t.shape.getCanvasBBox(),g=i.shape.getCanvasBBox(),_=c?[["M",p.minX,p.minY],["L",g.minX,g.maxY],["L",g.maxX,g.maxY],["L",p.maxX,p.minY],["Z"]]:[["M",p.maxX,p.minY],["L",g.minX,g.minY],["L",g.minX,g.maxY],["L",p.maxX,p.maxY],["Z"]];return _},e.prototype.addLinkShape=function(t,i,u,c){var p={opacity:.4,fill:i.shape.attr("fill")};t.addShape({type:"path",attrs:(0,P.pi)((0,P.pi)({},(0,b.b$)({},p,(0,b.mf)(c)?c(p,i):c)),{path:this.getLinkPath(i,u)})})},e.prototype.linkByElement=function(t,i){var u=this,c=this.context.view,p=this.getColorScale(c,t);if(!!p){var g=an(t,p.field);if(!this.cache[g]){var _=Po(c,p.field,g),S=this.linkGroup,k=S.addGroup();this.cache[g]=k;var L=_.length;(0,b.S6)(_,function(R,U){if(U<L-1){var G=_[U+1];u.addLinkShape(k,R,G,i)}})}}},e.prototype.removeLink=function(t){var i=this.getColorScale(this.context.view,t);if(!!i){var u=an(t,i.field);this.cache[u]&&(this.cache[u].remove(),this.cache[u]=null)}},e.prototype.link=function(t){var i=this.context;this.linkGroup||(this.linkGroup=i.view.foregroundGroup.addGroup({id:"link-by-color-group",capture:!1}));var u=Jo(i);u&&this.linkByElement(u,t==null?void 0:t.style)},e.prototype.unlink=function(){var t=Jo(this.context);t&&this.removeLink(t)},e.prototype.clear=function(){this.linkGroup&&this.linkGroup.clear(),this.cache={}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.linkGroup&&this.linkGroup.remove()},e}(oi),NO=F1,$E=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.startPoint=null,t.endPoint=null,t.isStarted=!1,t.effectSiblings=!1,t.effectByRecord=!1,t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.start=function(){this.clear(),this.startPoint=this.getCurrentPoint(),this.isStarted=!0},e.prototype.getIntersectElements=function(){var t=null;if(ya(this.context))t=eo(this.context,10);else{var i=this.startPoint,u=this.isStarted?this.getCurrentPoint():this.endPoint;if(!i||!u)return;var c={minX:Math.min(i.x,u.x),minY:Math.min(i.y,u.y),maxX:Math.max(i.x,u.x),maxY:Math.max(i.y,u.y)},p=this.context.view;t=Ri(p,c)}return t},e.prototype.setStateEnable=function(t){if(this.effectSiblings&&!this.effectByRecord)this.setSiblingsState(t);else{var i=wo(this.context.view),u=this.getIntersectElements();u&&u.length?this.effectByRecord?this.setSiblingsStateByRecord(u,t):this.setElementsState(u,t,i):this.clear()}},e.prototype.setSiblingsStateByRecord=function(t,i){var u=this,c=this.context.view,p=mr(c),g=t.map(function(k){return k.getModel().data}),_=c.getXScale().field,S=c.getYScales()[0].field;(0,b.S6)(p,function(k){var L=wo(k),R=L.filter(function(U){var G=U.getModel().data;return Ge(g,G,_,S)});u.setElementsState(R,i,L)})},e.prototype.setSiblingsState=function(t){var i=this,u=this.context.view,c=mr(u);ya(this.context)&&(0,b.S6)(c,function(p){var g=wo(p),_=Eo(i.context,p,10);_&&_.length?i.setElementsState(_,t,g):i.clearViewState(p)})},e.prototype.setElementsState=function(t,i,u){var c=this;(0,b.S6)(u,function(p){t.includes(p)?c.setElementState(p,i):c.setElementState(p,!1)})},e.prototype.end=function(){this.isStarted=!1,this.endPoint=this.getCurrentPoint()},e.prototype.clear=function(){var t=this,i=this.context.view;if(this.effectSiblings){var u=mr(i);(0,b.S6)(u,function(c){t.clearViewState(c)})}else this.clearViewState(i)},e}(XE),R1=$E,zO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(R1),UO=zO,ZO=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setStateEnable=function(t){var i=Jo(this.context);if(i){if(!tu(this.context))return;t?(this.clear(),this.setElementState(i,!0)):this.hasState(i)&&this.setElementState(i,!1)}},e.prototype.toggle=function(){var t=Jo(this.context);if(t){var i=this.hasState(t);i||this.clear(),this.setElementState(t,!i)}},e.prototype.reset=function(){this.setStateEnable(!1)},e}(XE),by=ZO,VO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(by),qE=VO,im="inactive",am="active";function D1(r){var e=wo(r);(0,b.S6)(e,function(t){t.hasState(am)&&t.setState(am,!1),t.hasState(im)&&t.setState(im,!1)})}function KE(r,e,t){(0,b.S6)(r,function(i){e(i)?(i.hasState(im)&&i.setState(im,!1),i.setState(am,t)):(i.hasState(am)&&i.setState(am,!1),i.setState(im,t))})}var Nv=Ae.INACTIVE,$d=Ae.ACTIVE,x3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=$d,t}return e.prototype.setElementsStateByItem=function(t,i,u,c){var p=this,g=function(_){return p.isMathItem(_,i,u)};this.setHighlightBy(t,g,c)},e.prototype.setElementHighlight=function(t,i){i(t)?(t.hasState(Nv)&&t.setState(Nv,!1),t.setState($d,!0)):t.hasState($d)||t.setState(Nv,!0)},e.prototype.setHighlightBy=function(t,i,u){var c=this;if(u)(0,b.S6)(t,function(_){c.setElementHighlight(_,i)});else{var p=Je(this.context.view,$d),g=!0;(0,b.S6)(p,function(_){if(!i(_))return g=!1,!1}),g?this.clear():(0,b.S6)(t,function(_){i(_)&&(_.hasState($d)&&_.setState($d,!1),_.setState(Nv,!0))})}},e.prototype.setElementState=function(t,i){var u=this.context.view,c=wo(u);this.setHighlightBy(c,function(p){return t===p},i)},e.prototype.highlight=function(){this.setState()},e.prototype.clear=function(){var t=this.context.view;D1(t)},e}(YE),B1=x3,b3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setStateByElement=function(t,i){var u=this.context.view,c=t.geometry.getAttribute("color");if(!!c){var p=u.getScaleByField(c.getFields()[0]),g=an(t,p.field),_=wo(u),S=_.filter(function(k){return an(k,p.field)===g});this.setHighlightBy(_,function(k){return S.includes(k)},i)}},e}(B1),E3=b3,w3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setElementHighlight=function(t,i){i(t)?(t.hasState(Nv)&&t.setState(Nv,!1),t.setState($d,!0)):(t.setState(Nv,!0),t.hasState($d)&&t.setState($d,!1))},e.prototype.setStateByElement=function(t,i){var u=this.context.view,c=u.getXScale(),p=an(t,c.field),g=wo(u),_=g.filter(function(S){return an(S,c.field)===p});this.setHighlightBy(g,function(S){return _.includes(S)},i)},e.prototype.toggle=function(){var t=Jo(this.context);if(t){var i=t.hasState(this.stateName);this.setStateByElement(t,!i)}},e}(B1),S3=w3,id;(function(r){r.BEFORE_HIGHLIGHT="element-range-highlight:beforehighlight",r.AFTER_HIGHLIGHT="element-range-highlight:afterhighlight",r.BEFORE_CLEAR="element-range-highlight:beforeclear",r.AFTER_CLEAR="element-range-highlight:afterclear"})(id||(id={}));var N1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.clearViewState=function(t){D1(t)},e.prototype.highlight=function(){var t=this.context,i=t.view,u=t.event,c=this.getIntersectElements(),p={view:i,event:u,highlightElements:c};i.emit(id.BEFORE_HIGHLIGHT,pe.fromData(i,id.BEFORE_HIGHLIGHT,p)),this.setState(),i.emit(id.AFTER_HIGHLIGHT,pe.fromData(i,id.AFTER_HIGHLIGHT,p))},e.prototype.clear=function(){var t=this.context.view;t.emit(id.BEFORE_CLEAR,pe.fromData(t,id.BEFORE_CLEAR,{})),r.prototype.clear.call(this),t.emit(id.AFTER_CLEAR,pe.fromData(t,id.AFTER_CLEAR,{}))},e.prototype.setElementsState=function(t,i,u){KE(u,function(c){return t.indexOf(c)>=0},i)},e}(R1),QE=N1,om=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.highlight=function(){this.setState()},e.prototype.setElementState=function(t,i){var u=this.context.view,c=wo(u);KE(c,function(p){return t===p},i)},e.prototype.clear=function(){var t=this.context.view;D1(t)},e}(by),C3=om,z1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(R1),A3=z1,Ey=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(YE),JE=Ey,U1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(by),Z1=U1,tw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="",t.ignoreItemStates=[],t}return e.prototype.getTriggerListInfo=function(){var t=La(this.context),i=null;return fo(t)&&(i={item:t.item,list:t.component}),i},e.prototype.getAllowComponents=function(){var t=this,i=this.context.view,u=Re(i),c=[];return(0,b.S6)(u,function(p){p.isList()&&t.allowSetStateByElement(p)&&c.push(p)}),c},e.prototype.hasState=function(t,i){return t.hasState(i,this.stateName)},e.prototype.clearAllComponentsState=function(){var t=this,i=this.getAllowComponents();(0,b.S6)(i,function(u){u.clearItemsState(t.stateName)})},e.prototype.allowSetStateByElement=function(t){var i=t.get("field");if(!i)return!1;if(this.cfg&&this.cfg.componentNames){var u=t.get("name");if(this.cfg.componentNames.indexOf(u)===-1)return!1}var c=this.context.view,p=vr(c,i);return p&&p.isCategory},e.prototype.allowSetStateByItem=function(t,i){var u=this.ignoreItemStates;if(u.length){var c=u.filter(function(p){return i.hasState(t,p)});return c.length===0}return!0},e.prototype.setStateByElement=function(t,i,u){var c=t.get("field"),p=this.context.view,g=vr(p,c),_=an(i,c),S=g.getText(_);this.setItemsState(t,S,u)},e.prototype.setStateEnable=function(t){var i=this,u=Jo(this.context);if(u){var c=this.getAllowComponents();(0,b.S6)(c,function(S){i.setStateByElement(S,u,t)})}else{var p=La(this.context);if(fo(p)){var g=p.item,_=p.component;this.allowSetStateByElement(_)&&this.allowSetStateByItem(g,_)&&this.setItemState(_,g,t)}}},e.prototype.setItemsState=function(t,i,u){var c=this,p=t.getItems();(0,b.S6)(p,function(g){g.name===i&&c.setItemState(t,g,u)})},e.prototype.setItemState=function(t,i,u){t.setItemState(i,this.stateName,u)},e.prototype.setState=function(){this.setStateEnable(!0)},e.prototype.reset=function(){this.setStateEnable(!1)},e.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var i=t.list,u=t.item,c=this.hasState(i,u);this.setItemState(i,u,!c)}},e.prototype.clear=function(){var t=this.getTriggerListInfo();t?t.list.clearItemsState(this.stateName):this.clearAllComponentsState()},e}(oi),zv=tw,qd=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="active",t}return e.prototype.active=function(){this.setState()},e}(zv),T3=qd,V1="inactive",G1="active";function H1(r){var e=r.getItems();(0,b.S6)(e,function(t){r.hasState(t,G1)&&r.setItemState(t,G1,!1),r.hasState(t,V1)&&r.setItemState(t,V1,!1)})}var y0="inactive",_0="active",M3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=_0,t.ignoreItemStates=["unchecked"],t}return e.prototype.setItemsState=function(t,i,u){this.setHighlightBy(t,function(c){return c.name===i},u)},e.prototype.setItemState=function(t,i,u){var c=t.getItems();this.setHighlightBy(t,function(p){return p===i},u)},e.prototype.setHighlightBy=function(t,i,u){var c=t.getItems();if(u)(0,b.S6)(c,function(_){i(_)?(t.hasState(_,y0)&&t.setItemState(_,y0,!1),t.setItemState(_,_0,!0)):t.hasState(_,_0)||t.setItemState(_,y0,!0)});else{var p=t.getItemsByState(_0),g=!0;(0,b.S6)(p,function(_){if(!i(_))return g=!1,!1}),g?this.clear():(0,b.S6)(c,function(_){i(_)&&(t.hasState(_,_0)&&t.setItemState(_,_0,!1),t.setItemState(_,y0,!0))})}},e.prototype.highlight=function(){this.setState()},e.prototype.clear=function(){var t=this.getTriggerListInfo();if(t)H1(t.list);else{var i=this.getAllowComponents();(0,b.S6)(i,function(u){u.clearItemsState(_0),u.clearItemsState(y0)})}},e}(zv),j1=M3,ew=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="selected",t}return e.prototype.selected=function(){this.setState()},e}(zv),W1=ew,rw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName="unchecked",t}return e.prototype.unchecked=function(){this.setState()},e}(zv),nw=rw,fg="unchecked",wy="checked",X1=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.stateName=wy,t}return e.prototype.setItemState=function(t,i,u){this.setCheckedBy(t,function(c){return c===i},u)},e.prototype.setCheckedBy=function(t,i,u){var c=t.getItems();u&&(0,b.S6)(c,function(p){i(p)?(t.hasState(p,fg)&&t.setItemState(p,fg,!1),t.setItemState(p,wy,!0)):t.hasState(p,wy)||t.setItemState(p,fg,!0)})},e.prototype.toggle=function(){var t=this.getTriggerListInfo();if(t&&t.item){var i=t.list,u=t.item,c=!(0,b.G)(i.getItems(),function(p){return i.hasState(p,fg)});c||i.hasState(u,fg)?this.setItemState(i,u,!0):this.reset()}},e.prototype.checked=function(){this.setState()},e.prototype.reset=function(){var t=this.getAllowComponents();(0,b.S6)(t,function(i){i.clearItemsState(wy),i.clearItemsState(fg)})},e}(zv),I3=X1,hg="unchecked",Sy=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.toggle=function(){var t,i,u,c,p,g,_,S,k=this.getTriggerListInfo();if(k!=null&&k.item){var L=k.list,R=k.item,U=L.getItems(),G=U.filter(function(nn){return!L.hasState(nn,hg)}),Q=U.filter(function(nn){return L.hasState(nn,hg)}),pt=G[0];if(U.length===G.length)try{for(var yt=(0,P.XA)(U),Ht=yt.next();!Ht.done;Ht=yt.next()){var ce=Ht.value;L.setItemState(ce,hg,ce.id!==R.id)}}catch(nn){t={error:nn}}finally{try{Ht&&!Ht.done&&(i=yt.return)&&i.call(yt)}finally{if(t)throw t.error}}else if(U.length-Q.length===1)if(pt.id===R.id)try{for(var he=(0,P.XA)(U),ze=he.next();!ze.done;ze=he.next()){var ce=ze.value;L.setItemState(ce,hg,!1)}}catch(nn){u={error:nn}}finally{try{ze&&!ze.done&&(c=he.return)&&c.call(he)}finally{if(u)throw u.error}}else try{for(var Er=(0,P.XA)(U),Fr=Er.next();!Fr.done;Fr=Er.next()){var ce=Fr.value;L.setItemState(ce,hg,ce.id!==R.id)}}catch(nn){p={error:nn}}finally{try{Fr&&!Fr.done&&(g=Er.return)&&g.call(Er)}finally{if(p)throw p.error}}else try{for(var zr=(0,P.XA)(U),pn=zr.next();!pn.done;pn=zr.next()){var ce=pn.value;L.setItemState(ce,hg,ce.id!==R.id)}}catch(nn){_={error:nn}}finally{try{pn&&!pn.done&&(S=zr.return)&&S.call(zr)}finally{if(_)throw _.error}}}},e}(zv),Y1=Sy,iw="showRadio",$1="legend-radio-tip",k3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.timeStamp=0,t}return e.prototype.show=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var i=t.list,u=t.item;i.setItemState(u,iw,!0)}},e.prototype.hide=function(){var t=this.getTriggerListInfo();if(t!=null&&t.item){var i=t.list,u=t.item;i.setItemState(u,iw,!1)}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.showTip=function(){var t=this.context,i=t.event,u=this.timeStamp,c=+new Date,p=this.context.event.target;if(c-u>16&&p.get("name")==="legend-item-radio"){var g=this.location,_={x:i.x,y:i.y};this.timeStamp=c,this.location=_,(!g||!(0,b.Xy)(g,_))&&this.showTooltip(_)}},e.prototype.hideTip=function(){this.hideTooltip(),this.location=null},e.prototype.showTooltip=function(t){var i=this.context,u=i.event,c=u.target;if(c&&c.get("tip")){this.tooltip||this.renderTooltip();var p=i.view.getCanvas().get("el").getBoundingClientRect(),g=p.x,_=p.y;this.tooltip.update((0,P.pi)((0,P.pi)({title:c.get("tip")},t),{x:t.x+g,y:t.y+_})),this.tooltip.show()}},e.prototype.hideTooltip=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=(t={},t[ef]={padding:"6px 8px",transform:"translate(-50%, -80%)",background:"rgba(0,0,0,0.75)",color:"#fff","border-radius":"2px","z-index":100},t[Cl]={"font-size":"12px","line-height":"14px","margin-bottom":0,"word-break":"break-all"},t);document.getElementById($1)&&document.body.removeChild(document.getElementById($1));var u=new lp({parent:document.body,region:null,visible:!1,crosshairs:null,domStyles:i,containerId:$1});u.init(),u.setCapture(!1),this.tooltip=u},e}(zv),L3=k3,P3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.maskShape=null,t.points=[],t.starting=!1,t.moving=!1,t.preMovePoint=null,t.shapeType="path",t}return e.prototype.getCurrentPoint=function(){var t=this.context.event;return{x:t.x,y:t.y}},e.prototype.emitEvent=function(t){var i="mask:".concat(t),u=this.context.view,c=this.context.event;u.emit(i,{target:this.maskShape,shape:this.maskShape,points:this.points,x:c.x,y:c.y})},e.prototype.createMask=function(){var t=this.context.view,i=this.getMaskAttrs(),u=t.foregroundGroup.addShape({type:this.shapeType,name:"mask",draggable:!0,attrs:(0,P.pi)({fill:"#C5D4EB",opacity:.3},i)});return u},e.prototype.getMaskPath=function(){return[]},e.prototype.show=function(){this.maskShape&&(this.maskShape.show(),this.emitEvent("show"))},e.prototype.start=function(t){this.starting=!0,this.moving=!1,this.points=[this.getCurrentPoint()],this.maskShape||(this.maskShape=this.createMask(),this.maskShape.set("capture",!1)),this.updateMask(t==null?void 0:t.maskStyle),this.emitEvent("start")},e.prototype.moveStart=function(){this.moving=!0,this.preMovePoint=this.getCurrentPoint()},e.prototype.move=function(){if(!(!this.moving||!this.maskShape)){var t=this.getCurrentPoint(),i=this.preMovePoint,u=t.x-i.x,c=t.y-i.y,p=this.points;(0,b.S6)(p,function(g){g.x+=u,g.y+=c}),this.updateMask(),this.emitEvent("change"),this.preMovePoint=t}},e.prototype.updateMask=function(t){var i=(0,b.b$)({},this.getMaskAttrs(),t);this.maskShape.attr(i)},e.prototype.moveEnd=function(){this.moving=!1,this.preMovePoint=null},e.prototype.end=function(){this.starting=!1,this.emitEvent("end"),this.maskShape&&this.maskShape.set("capture",!0)},e.prototype.hide=function(){this.maskShape&&(this.maskShape.hide(),this.emitEvent("hide"))},e.prototype.resize=function(){this.starting&&this.maskShape&&(this.points.push(this.getCurrentPoint()),this.updateMask(),this.emitEvent("change"))},e.prototype.destroy=function(){this.points=[],this.maskShape&&this.maskShape.remove(),this.maskShape=null,this.preMovePoint=null,r.prototype.destroy.call(this)},e}(oi),q1=P3,O3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="circle",t}return e.prototype.getMaskAttrs=function(){var t=this.points,i=(0,b.Z$)(this.points),u=0,c=0,p=0;if(t.length){var g=t[0];u=yr(g,i)/2,c=(i.x+g.x)/2,p=(i.y+g.y)/2}return{x:c,y:p,r:u}},e}(q1),F3=O3,R3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.shapeType="rect",t}return e.prototype.getRegion=function(){var t=this.points;return{start:(0,b.YM)(t),end:(0,b.Z$)(t)}},e.prototype.getMaskAttrs=function(){var t=this.getRegion(),i=t.start,u=t.end,c=Math.min(i.x,u.x),p=Math.min(i.y,u.y),g=Math.abs(u.x-i.x),_=Math.abs(u.y-i.y);return{x:c,y:p,width:g,height:_}},e}(q1),aw=R3;function ow(r){r.x=(0,b.uZ)(r.x,0,1),r.y=(0,b.uZ)(r.y,0,1)}var sm=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dim="x",t.inPlot=!0,t}return e.prototype.getRegion=function(){var t=null,i=null,u=this.points,c=this.dim,p=this.context.view.getCoordinate(),g=p.invert((0,b.YM)(u)),_=p.invert((0,b.Z$)(u));return this.inPlot&&(ow(g),ow(_)),c==="x"?(t=p.convert({x:g.x,y:0}),i=p.convert({x:_.x,y:1})):(t=p.convert({x:0,y:g.y}),i=p.convert({x:1,y:_.y})),{start:t,end:i}},e}(aw),K1=sm,D3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getMaskPath=function(){var t=this.points,i=[];return t.length&&((0,b.S6)(t,function(u,c){c===0?i.push(["M",u.x,u.y]):i.push(["L",u.x,u.y])}),i.push(["L",t[0].x,t[0].y])),i},e.prototype.getMaskAttrs=function(){return{path:this.getMaskPath()}},e.prototype.addPoint=function(){this.resize()},e}(q1),Cy=D3,B3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getMaskPath=function(){var t=this.points;return Xr(t,!0)},e}(Cy),N3=B3,Q1=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.setCursor=function(t){var i=this.context.view;i.getCanvas().setCursor(t)},e.prototype.default=function(){this.setCursor("default")},e.prototype.pointer=function(){this.setCursor("pointer")},e.prototype.move=function(){this.setCursor("move")},e.prototype.crosshair=function(){this.setCursor("crosshair")},e.prototype.wait=function(){this.setCursor("wait")},e.prototype.help=function(){this.setCursor("help")},e.prototype.text=function(){this.setCursor("text")},e.prototype.eResize=function(){this.setCursor("e-resize")},e.prototype.wResize=function(){this.setCursor("w-resize")},e.prototype.nResize=function(){this.setCursor("n-resize")},e.prototype.sResize=function(){this.setCursor("s-resize")},e.prototype.neResize=function(){this.setCursor("ne-resize")},e.prototype.nwResize=function(){this.setCursor("nw-resize")},e.prototype.seResize=function(){this.setCursor("se-resize")},e.prototype.swResize=function(){this.setCursor("sw-resize")},e.prototype.nsResize=function(){this.setCursor("ns-resize")},e.prototype.ewResize=function(){this.setCursor("ew-resize")},e.prototype.zoomIn=function(){this.setCursor("zoom-in")},e.prototype.zoomOut=function(){this.setCursor("zoom-out")},e}(oi),J1=Q1,tx=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filterView=function(t,i,u){var c=this;t.getScaleByField(i)&&t.filter(i,u),t.views&&t.views.length&&(0,b.S6)(t.views,function(p){c.filterView(p,i,u)})},e.prototype.filter=function(){var t=La(this.context);if(t){var i=this.context.view,u=t.component,c=u.get("field");if(fo(t)){if(c){var p=u.getItemsByState("unchecked"),g=vr(i,c),_=p.map(function(U){return U.name});_.length?this.filterView(i,c,function(U){var G=g.getText(U);return!_.includes(G)}):this.filterView(i,c,null),i.render(!0)}}else if(Mu(t)){var S=u.getValue(),k=(0,P.CR)(S,2),L=k[0],R=k[1];this.filterView(i,c,function(U){return U>=L&&U<=R}),i.render(!0)}}},e}(oi),z3=tx;function sw(r,e,t,i){var u=Math.min(t[e],i[e]),c=Math.max(t[e],i[e]),p=(0,P.CR)(r.range,2),g=p[0],_=p[1];if(u<g&&(u=g),c>_&&(c=_),u===_&&c===_)return null;var S=r.invert(u),k=r.invert(c);if(r.isCategory){var L=r.values.indexOf(S),R=r.values.indexOf(k),U=r.values.slice(L,R+1);return function(G){return U.includes(G)}}else return function(G){return G>=S&&G<=k}}var Bc;(function(r){r.FILTER="brush-filter-processing",r.RESET="brush-filter-reset",r.BEFORE_FILTER="brush-filter:beforefilter",r.AFTER_FILTER="brush-filter:afterfilter",r.BEFORE_RESET="brush-filter:beforereset",r.AFTER_RESET="brush-filter:afterreset"})(Bc||(Bc={}));var ex=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dims=["x","y"],t.startPoint=null,t.isStarted=!1,t}return e.prototype.hasDim=function(t){return this.dims.includes(t)},e.prototype.start=function(){var t=this.context;this.isStarted=!0,this.startPoint=t.getCurrentPoint()},e.prototype.filter=function(){var t,i;if(ya(this.context)){var u=this.context.event.target,c=u.getCanvasBBox();t={x:c.x,y:c.y},i={x:c.maxX,y:c.maxY}}else{if(!this.isStarted)return;t=this.startPoint,i=this.context.getCurrentPoint()}if(!(Math.abs(t.x-i.x)<5||Math.abs(t.x-i.y)<5)){var p=this.context,g=p.view,_=p.event,S={view:g,event:_,dims:this.dims};g.emit(Bc.BEFORE_FILTER,pe.fromData(g,Bc.BEFORE_FILTER,S));var k=g.getCoordinate(),L=k.invert(i),R=k.invert(t);if(this.hasDim("x")){var U=g.getXScale(),G=sw(U,"x",L,R);this.filterView(g,U.field,G)}if(this.hasDim("y")){var Q=g.getYScales()[0],G=sw(Q,"y",L,R);this.filterView(g,Q.field,G)}this.reRender(g,{source:Bc.FILTER}),g.emit(Bc.AFTER_FILTER,pe.fromData(g,Bc.AFTER_FILTER,S))}},e.prototype.end=function(){this.isStarted=!1},e.prototype.reset=function(){var t=this.context.view;if(t.emit(Bc.BEFORE_RESET,pe.fromData(t,Bc.BEFORE_RESET,{})),this.isStarted=!1,this.hasDim("x")){var i=t.getXScale();this.filterView(t,i.field,null)}if(this.hasDim("y")){var u=t.getYScales()[0];this.filterView(t,u.field,null)}this.reRender(t,{source:Bc.RESET}),t.emit(Bc.AFTER_RESET,pe.fromData(t,Bc.AFTER_RESET,{}))},e.prototype.filterView=function(t,i,u){t.filter(i,u)},e.prototype.reRender=function(t,i){t.render(!0,i)},e}(oi),Ay=ex,U3=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filterView=function(t,i,u){var c=mr(t);(0,b.S6)(c,function(p){p.filter(i,u)})},e.prototype.reRender=function(t){var i=mr(t);(0,b.S6)(i,function(u){u.render(!0)})},e}(Ay),uw=U3,lw=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.filter=function(){var t=La(this.context),i=this.context.view,u=wo(i);if(ya(this.context)){var c=eo(this.context,10);c&&(0,b.S6)(u,function(Q){c.includes(Q)?Q.show():Q.hide()})}else if(t){var p=t.component,g=p.get("field");if(fo(t)){if(g){var _=p.getItemsByState("unchecked"),S=vr(i,g),k=_.map(function(Q){return Q.name});(0,b.S6)(u,function(Q){var pt=an(Q,g),yt=S.getText(pt);k.indexOf(yt)>=0?Q.hide():Q.show()})}}else if(Mu(t)){var L=p.getValue(),R=(0,P.CR)(L,2),U=R[0],G=R[1];(0,b.S6)(u,function(Q){var pt=an(Q,g);pt>=U&&pt<=G?Q.show():Q.hide()})}}},e.prototype.clear=function(){var t=wo(this.context.view);(0,b.S6)(t,function(i){i.show()})},e.prototype.reset=function(){this.clear()},e}(oi),Z3=lw,V3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.byRecord=!1,t}return e.prototype.filter=function(){ya(this.context)&&(this.byRecord?this.filterByRecord():this.filterByBBox())},e.prototype.filterByRecord=function(){var t=this.context.view,i=eo(this.context,10);if(!!i){var u=t.getXScale().field,c=t.getYScales()[0].field,p=i.map(function(_){return _.getModel().data}),g=mr(t);(0,b.S6)(g,function(_){var S=wo(_);(0,b.S6)(S,function(k){var L=k.getModel().data;Ge(p,L,u,c)?k.show():k.hide()})})}},e.prototype.filterByBBox=function(){var t=this,i=this.context.view,u=mr(i);(0,b.S6)(u,function(c){var p=Eo(t.context,c,10),g=wo(c);p&&(0,b.S6)(g,function(_){p.includes(_)?_.show():_.hide()})})},e.prototype.reset=function(){var t=mr(this.context.view);(0,b.S6)(t,function(i){var u=wo(i);(0,b.S6)(u,function(c){c.show()})})},e}(oi),cw=V3,G3=10,H3=5,j3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg={name:"button",text:"button",textStyle:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"},padding:[8,10],style:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},activeStyle:{fill:"#e6e6e6"}},t}return e.prototype.getButtonCfg=function(){return(0,b.b$)(this.buttonCfg,this.cfg)},e.prototype.drawButton=function(){var t=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:t.name}),u=i.addShape({type:"text",name:"button-text",attrs:(0,P.pi)({text:t.text},t.textStyle)}),c=u.getBBox(),p=T(t.padding),g=i.addShape({type:"rect",name:"button-rect",attrs:(0,P.pi)({x:c.x-p[3],y:c.y-p[0],width:c.width+p[1]+p[3],height:c.height+p[0]+p[2]},t.style)});g.toBack(),i.on("mouseenter",function(){g.attr(t.activeStyle)}),i.on("mouseleave",function(){g.attr(t.style)}),this.buttonGroup=i},e.prototype.resetPosition=function(){var t=this.context.view,i=t.getCoordinate(),u=i.convert({x:1,y:1}),c=this.buttonGroup,p=c.getBBox(),g=ma.vs(null,[["t",u.x-p.width-G3,u.y+p.height+H3]]);c.setMatrix(g)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),r.prototype.destroy.call(this)},e}(oi),fw=j3,W3=4,X3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.starting=!1,t.dragStart=!1,t}return e.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint()},e.prototype.drag=function(){if(!!this.startPoint){var t=this.context.getCurrentPoint(),i=this.context.view,u=this.context.event;this.dragStart?i.emit("drag",{target:u.target,x:u.x,y:u.y}):yr(t,this.startPoint)>W3&&(i.emit("dragstart",{target:u.target,x:u.x,y:u.y}),this.dragStart=!0)}},e.prototype.end=function(){if(this.dragStart){var t=this.context.view,i=this.context.event;t.emit("dragend",{target:i.target,x:i.x,y:i.y})}this.starting=!1,this.dragStart=!1},e}(oi),rx=X3,Y3=5,hw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.starting=!1,t.isMoving=!1,t.startPoint=null,t.startMatrix=null,t}return e.prototype.start=function(){this.starting=!0,this.startPoint=this.context.getCurrentPoint(),this.startMatrix=this.context.view.middleGroup.getMatrix()},e.prototype.move=function(){if(!!this.starting){var t=this.startPoint,i=this.context.getCurrentPoint(),u=yr(t,i);if(u>Y3&&!this.isMoving&&(this.isMoving=!0),this.isMoving){var c=this.context.view,p=ma.vs(this.startMatrix,[["t",i.x-t.x,i.y-t.y]]);c.backgroundGroup.setMatrix(p),c.foregroundGroup.setMatrix(p),c.middleGroup.setMatrix(p)}}},e.prototype.end=function(){this.isMoving&&(this.isMoving=!1),this.startMatrix=null,this.starting=!1,this.startPoint=null},e.prototype.reset=function(){this.starting=!1,this.startPoint=null,this.isMoving=!1;var t=this.context.view;t.backgroundGroup.resetMatrix(),t.foregroundGroup.resetMatrix(),t.middleGroup.resetMatrix(),this.isMoving=!1},e}(oi),pw=hw,dw="x",$3="y",q3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dims=[dw,$3],t.cfgFields=["dims"],t.cacheScaleDefs={},t}return e.prototype.hasDim=function(t){return this.dims.includes(t)},e.prototype.getScale=function(t){var i=this.context.view;return t==="x"?i.getXScale():i.getYScales()[0]},e.prototype.resetDim=function(t){var i=this.context.view;if(this.hasDim(t)&&this.cacheScaleDefs[t]){var u=this.getScale(t);i.scale(u.field,this.cacheScaleDefs[t]),this.cacheScaleDefs[t]=null}},e.prototype.reset=function(){this.resetDim(dw),this.resetDim($3);var t=this.context.view;t.render(!0)},e}(oi),vw=q3,K3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.startPoint=null,t.starting=!1,t.startCache={},t}return e.prototype.start=function(){var t=this;this.startPoint=this.context.getCurrentPoint(),this.starting=!0;var i=this.dims;(0,b.S6)(i,function(u){var c=t.getScale(u),p=c.min,g=c.max,_=c.values;t.startCache[u]={min:p,max:g,values:_}})},e.prototype.end=function(){this.startPoint=null,this.starting=!1,this.startCache={}},e.prototype.translate=function(){var t=this;if(!!this.starting){var i=this.startPoint,u=this.context.view.getCoordinate(),c=this.context.getCurrentPoint(),p=u.invert(i),g=u.invert(c),_=g.x-p.x,S=g.y-p.y,k=this.context.view,L=this.dims;(0,b.S6)(L,function(R){t.translateDim(R,{x:_*-1,y:S*-1})}),k.render(!0)}},e.prototype.translateDim=function(t,i){if(this.hasDim(t)){var u=this.getScale(t);u.isLinear&&this.translateLinear(t,u,i)}},e.prototype.translateLinear=function(t,i,u){var c=this.context.view,p=this.startCache[t],g=p.min,_=p.max,S=_-g,k=u[t]*S;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:i.nice,min:g,max:_}),c.scale(i.field,{nice:!1,min:g+k,max:_+k})},e.prototype.reset=function(){r.prototype.reset.call(this),this.startPoint=null,this.starting=!1},e}(vw),Q3=K3,J3=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.zoomRatio=.05,t}return e.prototype.zoomIn=function(){this.zoom(this.zoomRatio)},e.prototype.zoom=function(t){var i=this,u=this.dims;(0,b.S6)(u,function(c){i.zoomDim(c,t)}),this.context.view.render(!0)},e.prototype.zoomOut=function(){this.zoom(-1*this.zoomRatio)},e.prototype.zoomDim=function(t,i){if(this.hasDim(t)){var u=this.getScale(t);u.isLinear&&this.zoomLinear(t,u,i)}},e.prototype.zoomLinear=function(t,i,u){var c=this.context.view;this.cacheScaleDefs[t]||(this.cacheScaleDefs[t]={nice:i.nice,min:i.min,max:i.max});var p=this.cacheScaleDefs[t],g=p.max-p.min,_=i.min,S=i.max,k=u*g,L=_-k,R=S+k,U=R-L,G=U/g;R>L&&G<100&&G>.01&&c.scale(i.field,{nice:!1,min:_-k,max:S+k})},e}(vw),gw=J3;function t5(r){var e=r.gEvent.originalEvent;return e.deltaY>0}var e5=1,r5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.scroll=function(t){var i=this.context,u=i.view,c=i.event;if(!!u.getOptions().scrollbar){var p=(t==null?void 0:t.wheelDelta)||e5,g=u.getController("scrollbar"),_=u.getXScale(),S=u.getOptions().data,k=(0,b.dp)((0,b.I)(S,_.field)),L=(0,b.dp)(_.values),R=g.getValue(),U=Math.floor((k-L)*R),G=U+(t5(c)?p:-p),Q=p/(k-L)/1e4,pt=(0,b.uZ)(G/(k-L)+Q,0,1);g.setValue(pt)}},e}(oi),mw=r5,n5="aixs-description-tooltip",i5=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.show=function(){var t=this.context,i=La(t).axis,u=i.cfg.title,c=u.description,p=u.text,g=u.descriptionTooltipStyle,_=t.event,S=_.x,k=_.y;this.tooltip||this.renderTooltip(),this.tooltip.update({title:p||"",customContent:function(){return`
          <div class="`.concat(ef,'" style={').concat(g,`}>
            <div class="`).concat(Cl,`">
              \u5B57\u6BB5\u8BF4\u660E\uFF1A`).concat(c,`
            </div>
          </div>
        `)},x:S,y:k}),this.tooltip.show()},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.tooltip&&this.tooltip.destroy()},e.prototype.hide=function(){this.tooltip&&this.tooltip.hide()},e.prototype.renderTooltip=function(){var t,i=this.context.view,u=i.canvas,c={start:{x:0,y:0},end:{x:u.get("width"),y:u.get("height")}},p=new lp({parent:u.get("el").parentNode,region:c,visible:!1,containerId:n5,domStyles:(0,P.pi)({},(0,b.b$)({},(t={},t[ef]={"max-width":"50%",padding:"10px","line-height":"15px","font-size":"12px",color:"rgba(0, 0, 0, .65)"},t[Cl]={"word-break":"break-all","margin-bottom":"3px"},t)))});p.init(),p.setCapture(!1),this.tooltip=p},e}(oi),a5=i5;ku("dark",Iu(jg)),J("canvas",Ee),J("svg",st),Ar("Polygon",sE),Ar("Interval",iE),Ar("Schema",sM),Ar("Path",iy),Ar("Point",iM),Ar("Line",JT),Ar("Area",K2),Ar("Edge",XT),Ar("Heatmap",Q2),Ar("Violin",hM),lu("base",zd),lu("interval",vE),lu("pie",EM),lu("polar",uy),us("overlap",IM),us("distribute",_E),us("fixed-overlap",wO),us("hide-overlap",IO),us("limit-in-shape",TM),us("limit-in-canvas",AM),us("limit-in-plot",dy),us("pie-outer",CM),us("adjust-color",Ps),us("interval-adjust-position",w1),us("interval-hide-overlap",hy),us("point-adjust-position",AE),us("pie-spider",sh),us("path-adjust-position",UM),Oa("fade-in",VM),Oa("fade-out",GM),Oa("grow-in-x",HM),Oa("grow-in-xy",WM),Oa("grow-in-y",jM),Oa("scale-in-x",Xd),Oa("scale-in-y",IE),Oa("wave-in",OE),Oa("zoom-in",FE),Oa("zoom-out",RE),Oa("position-update",YM),Oa("sector-path-update",Yd),Oa("path-in",XM),_n("rect",t3),_n("mirror",PO),_n("list",qM),_n("matrix",KM),_n("circle",M1),_n("tree",e3),N("axis",u3),N("legend",ZE),N("tooltip",Di),N("annotation",i3),N("slider",nd),N("scrollbar",nm),Yn("tooltip",WE),Yn("sibling-tooltip",g3),Yn("ellipsis-text",m3),Yn("element-active",_3),Yn("element-single-active",qE),Yn("element-range-active",UO),Yn("element-highlight",B1),Yn("element-highlight-by-x",S3),Yn("element-highlight-by-color",E3),Yn("element-single-highlight",C3),Yn("element-range-highlight",QE),Yn("element-sibling-highlight",QE,{effectSiblings:!0,effectByRecord:!0}),Yn("element-selected",JE),Yn("element-single-selected",Z1),Yn("element-range-selected",A3),Yn("element-link-by-color",NO),Yn("active-region",jE),Yn("list-active",T3),Yn("list-selected",W1),Yn("list-highlight",j1),Yn("list-unchecked",nw),Yn("list-checked",I3),Yn("list-focus",Y1),Yn("list-radio",L3),Yn("legend-item-highlight",j1,{componentNames:["legend"]}),Yn("axis-label-highlight",j1,{componentNames:["axis"]}),Yn("axis-description",a5),Yn("rect-mask",aw),Yn("x-rect-mask",K1,{dim:"x"}),Yn("y-rect-mask",K1,{dim:"y"}),Yn("circle-mask",F3),Yn("path-mask",Cy),Yn("smooth-path-mask",N3),Yn("cursor",J1),Yn("data-filter",z3),Yn("brush",Ay),Yn("brush-x",Ay,{dims:["x"]}),Yn("brush-y",Ay,{dims:["y"]}),Yn("sibling-filter",uw),Yn("sibling-x-filter",uw),Yn("sibling-y-filter",uw),Yn("element-filter",Z3),Yn("element-sibling-filter",cw),Yn("element-sibling-filter-record",cw,{byRecord:!0}),Yn("view-drag",rx),Yn("view-move",pw),Yn("scale-translate",Q3),Yn("scale-zoom",gw),Yn("reset-button",fw,{name:"reset-button",text:"reset"}),Yn("mousewheel-scroll",mw);function Uv(r){return r.isInPlot()}kn("tooltip",{start:[{trigger:"plot:mousemove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"plot:touchmove",action:"tooltip:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseleave",action:"tooltip:hide"},{trigger:"plot:leave",action:"tooltip:hide"},{trigger:"plot:touchend",action:"tooltip:hide"}]}),kn("ellipsis-text",{start:[{trigger:"legend-item-name:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"legend-item-name:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:mousemove",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}},{trigger:"axis-label:touchstart",action:"ellipsis-text:show",throttle:{wait:50,leading:!0,trailing:!1}}],end:[{trigger:"legend-item-name:mouseleave",action:"ellipsis-text:hide"},{trigger:"legend-item-name:touchend",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseleave",action:"ellipsis-text:hide"},{trigger:"axis-label:mouseout",action:"ellipsis-text:hide"},{trigger:"axis-label:touchend",action:"ellipsis-text:hide"}]}),kn("element-active",{start:[{trigger:"element:mouseenter",action:"element-active:active"}],end:[{trigger:"element:mouseleave",action:"element-active:reset"}]}),kn("element-selected",{start:[{trigger:"element:click",action:"element-selected:toggle"}]}),kn("element-highlight",{start:[{trigger:"element:mouseenter",action:"element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight:reset"}]}),kn("element-highlight-by-x",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-x:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-x:reset"}]}),kn("element-highlight-by-color",{start:[{trigger:"element:mouseenter",action:"element-highlight-by-color:highlight"}],end:[{trigger:"element:mouseleave",action:"element-highlight-by-color:reset"}]}),kn("legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","element-active:reset"]}]}),kn("legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","element-highlight:reset"]}]}),kn("axis-label-highlight",{start:[{trigger:"axis-label:mouseenter",action:["axis-label-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"axis-label:mouseleave",action:["axis-label-highlight:reset","element-highlight:reset"]}]}),kn("element-list-highlight",{start:[{trigger:"element:mouseenter",action:["list-highlight:highlight","element-highlight:highlight"]}],end:[{trigger:"element:mouseleave",action:["list-highlight:reset","element-highlight:reset"]}]}),kn("element-range-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(r){return!r.isInShape("mask")},action:["rect-mask:start","rect-mask:show"]},{trigger:"mask:dragstart",action:["rect-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:drag",action:["rect-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end"]},{trigger:"mask:dragend",action:["rect-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(r){return!r.isInPlot()},action:["element-range-highlight:clear","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear","rect-mask:hide"]}]}),kn("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Uv,action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:Uv,action:["rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Uv,action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide","reset-button:show"]}],rollback:[{trigger:"reset-button:click",action:["brush:reset","reset-button:hide","cursor:crosshair"]}]}),kn("brush-visible",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:["rect-mask:end","rect-mask:hide","element-filter:filter","element-range-highlight:clear"]}],rollback:[{trigger:"dblclick",action:["element-filter:clear"]}]}),kn("brush-x",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Uv,action:["brush-x:start","x-rect-mask:start","x-rect-mask:show"]}],processing:[{trigger:"mousemove",isEnable:Uv,action:["x-rect-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Uv,action:["brush-x:filter","brush-x:end","x-rect-mask:end","x-rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]}),kn("element-path-highlight",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Uv,action:"path-mask:start"},{trigger:"mousedown",isEnable:Uv,action:"path-mask:show"}],processing:[{trigger:"mousemove",action:"path-mask:addPoint"}],end:[{trigger:"mouseup",action:"path-mask:end"}],rollback:[{trigger:"dblclick",action:"path-mask:hide"}]}),kn("element-single-selected",{start:[{trigger:"element:click",action:"element-single-selected:toggle"}]}),kn("legend-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:["cursor:pointer","list-radio:show"]},{trigger:"legend-item:mouseleave",action:["cursor:default","list-radio:hide"]}],start:[{trigger:"legend-item:click",isEnable:function(r){return!r.isInShape("legend-item-radio")},action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","data-filter:filter","list-radio:show"]},{trigger:"legend-item-radio:mouseenter",action:["list-radio:showTip"]},{trigger:"legend-item-radio:mouseleave",action:["list-radio:hideTip"]},{trigger:"legend-item-radio:click",action:["list-focus:toggle","data-filter:filter","list-radio:show"]}]}),kn("continuous-filter",{start:[{trigger:"legend:valuechanged",action:"data-filter:filter"}]}),kn("continuous-visible-filter",{start:[{trigger:"legend:valuechanged",action:"element-filter:filter"}]}),kn("legend-visible-filter",{showEnable:[{trigger:"legend-item:mouseenter",action:"cursor:pointer"},{trigger:"legend-item:mouseleave",action:"cursor:default"}],start:[{trigger:"legend-item:click",action:["legend-item-highlight:reset","element-highlight:reset","list-unchecked:toggle","element-filter:filter"]}]}),kn("active-region",{start:[{trigger:"plot:mousemove",action:"active-region:show"}],end:[{trigger:"plot:mouseleave",action:"active-region:hide"}]}),kn("axis-description",{start:[{trigger:"axis-description:mousemove",action:"axis-description:show"}],end:[{trigger:"axis-description:mouseleave",action:"axis-description:hide"}]});function yw(r){return r.gEvent.preventDefault(),r.gEvent.originalEvent.deltaY>0}kn("view-zoom",{start:[{trigger:"plot:mousewheel",isEnable:function(r){return yw(r.event)},action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:function(r){return!yw(r.event)},action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]}),kn("sibling-tooltip",{start:[{trigger:"plot:mousemove",action:"sibling-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"sibling-tooltip:hide"}]}),kn("plot-mousewheel-scroll",{start:[{trigger:"plot:mousewheel",action:"mousewheel-scroll:scroll"}]});var Rf=["type","alias","tickCount","tickInterval","min","max","nice","minLimit","maxLimit","range","tickMethod","base","exponent","mask","sync"],Cp;(function(r){r.ERROR="error",r.WARN="warn",r.INFO="log"})(Cp||(Cp={}));var nx="AntV/G2Plot";function _w(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var i=0;return nx+": "+r.replace(/%s/g,function(){return""+e[i++]})}function o5(r,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];if(!r){var u=new Error(_w.apply(void 0,__spreadArrays([e],t)));throw u.name=nx,u}}function Ap(r,e,t){for(var i=[],u=3;u<arguments.length;u++)i[u-3]=arguments[u];e||console[r](_w.apply(void 0,(0,P.pr)([t],i)))}function fs(r,e){var t={};return r!==null&&typeof r=="object"&&e.forEach(function(i){var u=r[i];u!==void 0&&(t[i]=u)}),t}function ix(r,e){if(!r)return{};var t=r.filter(function(c){var p=(0,b.U2)(c,[e]);return(0,b.hj)(p)&&!isNaN(p)}),i=t.every(function(c){return(0,b.U2)(c,[e])>=0}),u=t.every(function(c){return(0,b.U2)(c,[e])<=0});return i?{min:0}:u?{max:0}:{}}function xw(r,e,t,i,u){if(u===void 0&&(u=[]),!Array.isArray(r))return{nodes:[],links:[]};var c=[],p={},g=-1;return r.forEach(function(_){var S=_[e],k=_[t],L=_[i],R=fs(_,u);p[S]||(p[S]=(0,P.pi)({id:++g,name:S},R)),p[k]||(p[k]=(0,P.pi)({id:++g,name:k},R)),c.push((0,P.pi)({source:p[S].id,target:p[k].id,value:L},R))}),{nodes:Object.values(p).sort(function(_,S){return _.id-S.id}),links:c}}function pg(r,e){var t=(0,b.hX)(r,function(i){var u=i[e];return u===null||typeof u=="number"&&!isNaN(u)});return Ap(Cp.WARN,t.length===r.length,"illegal data existed in chart data."),t}var s5=5,u5={}.toString,x0=function(r,e){return u5.call(r)==="[object "+e+"]"},l5=function(r){return x0(r,"Array")},c5=function(r){return typeof r=="object"&&r!==null},bw=function(r){if(!c5(r)||!x0(r,"Object"))return!1;for(var e=r;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e},Ew=function(r,e,t,i){t=t||0,i=i||s5;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var c=e[u];c?bw(c)?(bw(r[u])||(r[u]={}),t<i?Ew(r[u],c,t+1,i):r[u]=e[u]):l5(c)?(r[u]=[],r[u]=r[u].concat(c)):r[u]=c:r[u]=c}},hn=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var i=0;i<e.length;i+=1)Ew(r,e[i]);return r};function ax(r){if(!r)return{width:0,height:0};var e=getComputedStyle(r);return{width:(r.clientWidth||parseInt(e.width,10))-parseInt(e.paddingLeft,10)-parseInt(e.paddingRight,10),height:(r.clientHeight||parseInt(e.height,10))-parseInt(e.paddingTop,10)-parseInt(e.paddingBottom,10)}}function Ga(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return function(t){return r.reduce(function(i,u){return u(i)},t)}}function Ec(r,e){return r.geometries.find(function(t){return t.type===e})}function Zv(r){return(0,b.u4)(r.geometries,function(e,t){return e.concat(t.elements)},[])}function Bh(r){return(0,b.U2)(r,["views","length"],0)<=0?Zv(r):(0,b.u4)(r.views,function(e,t){return e.concat(Bh(t))},Zv(r))}function ox(r){return(0,b.U2)(r,["views","length"],0)<=0?r.geometries:(0,b.u4)(r.views,function(e,t){return e.concat(t.geometries)},r.geometries)}function Os(r){if(!(0,b.P9)(r,"Object"))return r;var e=(0,P.pi)({},r);return e.formatter&&!e.content&&(e.content=e.formatter),e}var sx;function Ty(){return sx||(sx=document.createElement("canvas").getContext("2d")),sx}var f5=(0,b.HP)(function(r,e){e===void 0&&(e={});var t=e.fontSize,i=e.fontFamily,u=i===void 0?"sans-serif":i,c=e.fontWeight,p=e.fontStyle,g=e.fontVariant,_=Ty();_.font=[p,c,g,t+"px",u].join(" ");var S=_.measureText((0,b.HD)(r)?r:"");return S.width},function(r,e){return e===void 0&&(e={}),(0,P.pr)([r],(0,b.VO)(e)).join("")});function b0(r){return typeof r=="number"&&!isNaN(r)}function yu(r,e,t){var i=Math.min(e,t),u=Math.max(e,t);return r>=i&&r<=u}function Vv(r){if((0,b.hj)(r))return[r,r,r,r];if((0,b.kJ)(r)){var e=r.length;if(e===1)return[r[0],r[0],r[0],r[0]];if(e===2)return[r[0],r[1],r[0],r[1]];if(e===3)return[r[0],r[1],r[2],r[1]];if(e===4)return r}return[0,0,0,0]}function My(r,e,t){e===void 0&&(e="bottom"),t===void 0&&(t=25);var i=Vv(r),u=[e.startsWith("top")?t:0,e.startsWith("right")?t:0,e.startsWith("bottom")?t:0,e.startsWith("left")?t:0];return[i[0]+u[0],i[1]+u[1],i[2]+u[2],i[3]+u[3]]}function ux(r){var e=r.map(function(i){return Vv(i)}),t=[0,0,0,0];return e.length>0&&(t=t.map(function(i,u){return e.forEach(function(c,p){i+=e[p][u]}),i})),t}function h5(r,e){var t=[];if(r.length){t.push(["M",r[0].x,r[0].y]);for(var i=1,u=r.length;i<u;i+=1){var c=r[i];t.push(["L",c.x,c.y])}e&&t.push(["Z"])}return t}var p5=function(r,e,t,i){var u=[],c,p,g=!!i,_,S;if(g){_=[1/0,1/0],S=[-1/0,-1/0];for(var k=0,L=r.length;k<L;k++){var R=r[k];_=sa.VV([0,0],_,R),S=sa.Fp([0,0],S,R)}_=sa.VV([0,0],_,i[0]),S=sa.Fp([0,0],S,i[1])}for(var k=0,U=r.length;k<U;k++){var R=r[k];if(t)c=r[k?k-1:U-1],p=r[(k+1)%U];else if(k===0||k===U-1){u.push(R);continue}else c=r[k-1],p=r[k+1];var G=[0,0];G=sa.lu(G,p,c),G=sa.bA(G,G,e);var Q=sa.TE(R,c),pt=sa.TE(R,p),yt=Q+pt;yt!==0&&(Q/=yt,pt/=yt);var Ht=sa.bA([0,0],G,-Q),ce=sa.bA([0,0],G,pt),he=sa.IH([0,0],R,Ht),ze=sa.IH([0,0],R,ce);g&&(he=sa.Fp([0,0],he,_),he=sa.VV([0,0],he,S),ze=sa.Fp([0,0],ze,_),ze=sa.VV([0,0],ze,S)),u.push(he),u.push(ze)}return t&&u.push(u.shift()),u};function d5(r,e,t){for(var i=!!e,u=[],c=0,p=r.length;c<p;c+=2)u.push([r[c],r[c+1]]);for(var g=p5(u,.4,i,t),_=u.length,S=[],k,L,R,c=0;c<_-1;c++)k=g[c*2],L=g[c*2+1],R=u[c+1],S.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]]);return i&&(k=g[_],L=g[_+1],R=u[0],S.push(["C",k[0],k[1],L[0],L[1],R[0],R[1]])),S}function v5(r,e,t){var i=[],u=r[0],c=null;if(r.length<=2)return h5(r,e);for(var p=0,g=r.length;p<g;p++){var _=r[p];(!c||!(c.x===_.x&&c.y===_.y))&&(i.push(_.x),i.push(_.y),c=_)}var S=t||[[0,0],[1,1]],k=d5(i,e,S);return k.unshift(["M",u.x,u.y]),k}function lx(r){if(!r)return r;var e=r.match(/(([A-Z]{0,1}[a-z]*[^A-Z])|([A-Z]{1}))/g);return e.map(function(t){return t.toLowerCase()}).join("-")}function cx(r){var e={overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis",display:"flex",justifyContent:"center",alignItems:"center"},t=["stroke","lineWidth","shadowColor","strokeOpacity","shadowBlur","shadowOffsetX","shadowOffsetY","fill"];(0,b.U2)(r,"fill")&&(e.color=r.fill);var i=fs(r,t),u=i.shadowColor,c=i.shadowBlur,p=c===void 0?0:c,g=i.shadowOffsetX,_=g===void 0?0:g,S=i.shadowOffsetY,k=S===void 0?0:S;e["text-shadow"]=""+[u,_+"px",k+"px",p+"px"].join(" ");var L=fs(r,t),R=L.stroke,U=L.lineWidth,G=U===void 0?0:U;return e["-webkit-text-stroke"]=""+[G+"px",R].join(" "),(0,b.S6)(r,function(Q,pt){["fontSize"].includes(pt)&&(0,b.hj)(Q)?e[lx(pt)]=Q+"px":pt&&!t.includes(pt)&&(e[lx(pt)]=""+Q)}),e}function ww(r,e){r.style["pointer-events"]="none",(0,b.S6)(e,function(t,i){i&&t&&(r.style[i]=t)})}var Iy=function(r,e,t){var i=e.statistic,u=e.plotType,c=i.title,p=i.content;[c,p].forEach(function(g,_){if(!!g){var S="";_===0?S=p?"translate(-50%, -100%)":"translate(-50%, -50%)":S=c?"translate(-50%, 0)":"translate(-50%, -50%)";var k=(0,b.mf)(g.style)?g.style(t):g.style;r.annotation().html((0,P.pi)({position:["50%","50%"],html:function(L,R){var U=R.getCoordinate(),G=0;if(u==="pie"||u==="ring-progress")G=U.getRadius()*U.innerRadius*2;else if(u==="liquid"){var Q=(0,b.U2)(R.geometries,[0,"elements",0,"shape"]);if(Q){var pt=Q.find(function(he){return he.get("name")==="wrap"}),yt=pt.getCanvasBBox().width;G=yt}}else G||(G=U.getWidth());ww(L,(0,P.pi)({width:G+"px",transform:S},cx(k)));var Ht=R.getData();if(g.customHtml)return g.customHtml(L,R,t,Ht);var ce=g.content;return g.formatter&&(ce=g.formatter(t,Ht)),ce?(0,b.HD)(ce)?ce:""+ce:"<div></div>"},key:(_===0?"top":"bottom")+"-statistic"},fs(g,["offsetX","offsetY","rotate","style","formatter"])))}})},g5=function(r,e,t){var i=e.statistic,u=i.title,c=i.content;[u,c].forEach(function(p){if(!!p){var g=(0,b.mf)(p.style)?p.style(t):p.style;r.annotation().html((0,P.pi)({position:["50%","100%"],html:function(_,S){var k=S.getCoordinate(),L=S.views[0].getCoordinate(),R=L.getCenter(),U=L.getRadius(),G=Math.max(Math.sin(L.startAngle),Math.sin(L.endAngle))*U,Q=R.y+G-k.y.start-parseFloat((0,b.U2)(g,"fontSize",0)),pt=k.getRadius()*k.innerRadius*2;ww(_,(0,P.pi)({width:pt+"px",transform:"translate(-50%, "+Q+"px)"},cx(g)));var yt=S.getData();if(p.customHtml)return p.customHtml(_,S,t,yt);var Ht=p.content;return p.formatter&&(Ht=p.formatter(t,yt)),Ht?(0,b.HD)(Ht)?Ht:""+Ht:"<div></div>"}},fs(p,["offsetX","offsetY","rotate","style","formatter"])))}})};function Sw(r,e){return e?(0,b.u4)(e,function(t,i,u){return t.replace(new RegExp("{\\s*"+u+"\\s*}","g"),i)},r):r}function yo(r,e){return r.views.find(function(t){return t.id===e})}function um(r){var e=r.parent;return e?e.views:[]}function fx(r){return um(r).filter(function(e){return e!==r})}function E0(r,e,t){t===void 0&&(t=r.geometries),typeof e=="boolean"?r.animate(e):r.animate(!0),(0,b.S6)(t,function(i){var u;(0,b.mf)(e)?u=e(i.type||i.shapeType,i)||!0:u=e,i.animate(u)})}function lm(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function hx(r,e){e===void 0&&(e=r);var t=document.createElement("canvas"),i=lm();t.width=r*i,t.height=e*i,t.style.width=r+"px",t.style.height=e+"px";var u=t.getContext("2d");return u.scale(i,i),t}function px(r,e,t,i){i===void 0&&(i=t);var u=e.backgroundColor,c=e.opacity;r.globalAlpha=c,r.fillStyle=u,r.beginPath(),r.fillRect(0,0,t,i),r.closePath()}function dx(r,e,t){var i=r+e;return t?i*2:i}function Cw(r,e){var t=e?[[r*.25,r*.25],[r*.75,r*.75]]:[[r*.5,r*.5]];return t}function vx(r,e){var t=e*Math.PI/180,i={a:Math.cos(t)*(1/r),b:Math.sin(t)*(1/r),c:-Math.sin(t)*(1/r),d:Math.cos(t)*(1/r),e:0,f:0};return i}var Aw={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function dg(r,e,t,i){var u=e.size,c=e.fill,p=e.lineWidth,g=e.stroke,_=e.fillOpacity;r.beginPath(),r.globalAlpha=_,r.fillStyle=c,r.strokeStyle=g,r.lineWidth=p,r.arc(t,i,u/2,0,2*Math.PI,!1),r.fill(),p&&r.stroke(),r.closePath()}function Tw(r){var e=hn({},Aw,r),t=e.size,i=e.padding,u=e.isStagger,c=e.rotation,p=dx(t,i,u),g=Cw(p,u),_=hx(p,p),S=_.getContext("2d");px(S,e,p);for(var k=0,L=g;k<L.length;k++){var R=L[k],U=R[0],G=R[1];dg(S,e,U,G)}var Q=S.createPattern(_,"repeat");if(Q){var pt=lm(),yt=vx(pt,c);Q.setTransform(yt)}return Q}var gx={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function Mw(r,e,t){var i=e.stroke,u=e.lineWidth,c=e.strokeOpacity,p=new Path2D(t);r.globalAlpha=c,r.lineCap="square",r.strokeStyle=u?i:"transparent",r.lineWidth=u,r.stroke(p)}function m5(r){var e=hn({},gx,r),t=e.spacing,i=e.rotation,u=e.lineWidth,c=t+u||1,p=t+u||1,g=`
            M 0 0 L `+c+` 0
            M 0 `+p+" L "+c+" "+p+`
            `,_=hx(c,p),S=_.getContext("2d");px(S,e,c,p),Mw(S,e,g);var k=S.createPattern(_,"repeat");if(k){var L=lm(),R=vx(L,i);k.setTransform(R)}return k}var y5={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function Iw(r,e,t,i){var u=e.stroke,c=e.size,p=e.fill,g=e.lineWidth,_=e.fillOpacity;r.globalAlpha=_,r.strokeStyle=u,r.lineWidth=g,r.fillStyle=p,r.strokeRect(t-c/2,i-c/2,c,c),r.fillRect(t-c/2,i-c/2,c,c)}function Ss(r){var e=hn({},y5,r),t=e.size,i=e.padding,u=e.isStagger,c=e.rotation,p=dx(t,i,u),g=Cw(p,u),_=hx(p,p),S=_.getContext("2d");px(S,e,p);for(var k=0,L=g;k<L.length;k++){var R=L[k],U=R[0],G=R[1];Iw(S,e,U,G)}var Q=S.createPattern(_,"repeat");if(Q){var pt=lm(),yt=vx(pt,c);Q.setTransform(yt)}return Q}function mx(r){var e=r.type,t=r.cfg,i;switch(e){case"dot":i=Tw(t);break;case"line":i=m5(t);break;case"square":i=Ss(t);break;default:break}return i}function Nh(r){var e=this;return function(t){var i,u=t.options,c=t.chart,p=u.pattern;if(!p)return t;var g=function(_){for(var S,k,L,R=[],U=1;U<arguments.length;U++)R[U-1]=arguments[U];var G=c.getTheme().defaultColor,Q=G,pt=(k=(S=c.geometries)===null||S===void 0?void 0:S[0])===null||k===void 0?void 0:k.getAttribute("color");if(pt){var yt=pt.getFields()[0],Ht=(0,b.U2)(_,yt);Q=_c.getMappingValue(pt,Ht,((L=pt.values)===null||L===void 0?void 0:L[0])||G)}var ce=p;typeof p=="function"&&(ce=p.call(e,_,Q)),ce instanceof CanvasPattern||(ce=mx(hn({},{cfg:{backgroundColor:Q}},ce)));var he=u[r];return(0,P.pi)((0,P.pi)({},typeof he=="function"?he.call.apply(he,(0,P.pr)([e,_],R)):he||{}),{fill:ce||Q})};return hn({},t,{options:(i={},i[r]=g,i)})}}function vg(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField,c=t.seriesField;return i===!1?e.legend(!1):(u||c)&&e.legend(u||c,i),r}function hl(r){var e=r.chart,t=r.options,i=t.tooltip;return i!==void 0&&e.tooltip(i),r}function Xs(r){var e=r.chart,t=r.options,i=t.interactions;return(0,b.S6)(i,function(u){u.enable===!1?e.removeInteraction(u.type):e.interaction(u.type,u.cfg||{})}),r}function ms(r){var e=r.chart,t=r.options,i=t.animation;return E0(e,i),r}function Bo(r){var e=r.chart,t=r.options,i=t.theme;return i&&e.theme(i),r}function w0(r){var e=r.chart,t=r.options,i=t.state;return i&&(0,b.S6)(e.geometries,function(u){u.state(i)}),r}function Vu(r){var e=r.chart,t=r.options,i=t.slider;return e.option("slider",i),r}function ad(r){var e=r.chart,t=r.options,i=t.scrollbar;return e.option("scrollbar",i),r}function Zs(r,e){return function(t){var i=t.chart,u=t.options,c={};return(0,b.S6)(r,function(p,g){c[g]=fs(p,Rf)}),c=hn({},e,u.meta,c),i.scale(c),t}}function Ys(r){return function(e){var t=e.chart,i=e.options,u=t.getController("annotation");return(0,b.S6)((0,P.pr)(i.annotations||[],r||[]),function(c){u.annotation(c)}),e}}function Df(r){var e=r.chart,t=r.options,i=t.yAxis,u=t.limitInPlot,c=u;return(0,b.Kn)(i)&&(0,b.UM)(u)&&(Object.values(fs(i,["min","max","minLimit","maxLimit"])).some(function(p){return!(0,b.UM)(p)})?c=!0:c=!1),e.limitInPlot=c,r}function S0(r){return r===void 0&&(r="rect"),function(e){var t=e.chart,i=e.options,u=i.coordinate,c=Array.from(u||[]).map(function(p){return p.type==="reflectX"?["reflect","x"]:p.type==="reflectY"?["reflect","y"]:p.type==="transpose"?["transpose"]:null}).filter(function(p){return!!p});return c.length!==0&&t.coordinate({type:r,actions:c}),e}}var ky={locale:"en-US"};function FR(r){each(r,function(e,t){return ky[t]=e})}var Ly={};function So(r,e){Ly[r]=e}function yx(r){return{get:function(e,t){return Sw((0,b.U2)(Ly[r],e)||(0,b.U2)(Ly[ky.locale],e)||(0,b.U2)(Ly["en-US"],e)||e,t)}}}var GO={locale:"en-US",general:{increase:"Increase",decrease:"Decrease",root:"Root"},statistic:{total:"Total"},conversionTag:{label:"Rate"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"Total"}},kw={locale:"zh-CN",general:{increase:"\u589E\u52A0",decrease:"\u51CF\u5C11",root:"\u521D\u59CB"},statistic:{total:"\u603B\u8BA1"},conversionTag:{label:"\u8F6C\u5316\u7387"},legend:{},tooltip:{},slider:{},scrollbar:{},waterfall:{total:"\u603B\u8BA1"}};function zh(r,e){if(r===!1)return{fields:!1};var t=(0,b.U2)(r,"fields"),i=(0,b.U2)(r,"formatter");return i&&!t&&(t=e),{fields:t,formatter:i}}function vf(r,e){var t=r.type,i=r.xField,u=r.yField,c=r.colorField,p=r.shapeField,g=r.sizeField,_=r.styleField,S=r.rawFields,k=[];if(S=((0,b.mf)(S)?S(t,e):S)||[],e==="color")k=(0,P.pr)([c||i],S);else if(e==="shape")k=(0,P.pr)([p||i],S);else if(e==="size")k=(0,P.pr)([g||i],S);else{k=(0,P.pr)([i,u,c,p,g,_],S);var L=["x","y","color","shape","size","style"].indexOf(e),R=k[L];k.splice(L,1),k.unshift(R)}var U=(0,b.jj)(k.filter(function(Q){return!!Q})),G=t==="line"&&[i,u].includes(U.join("*"))?"":U.join("*");return{mappingFields:U,tileMappingField:G}}function Uh(r,e){if(!!e)return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var u={};return r.forEach(function(c,p){u[c]=t[p]}),delete u.undefined,e(u)}}function Fl(r){var e=r.chart,t=r.options,i=t.type,u=t.args,c=t.mapping,p=t.xField,g=t.yField,_=t.colorField,S=t.shapeField,k=t.sizeField,L=t.tooltipFields,R=t.label,U=t.state,G=t.customInfo;if(!c)return r;var Q=c.color,pt=c.shape,yt=c.size,Ht=c.style,ce=c.tooltip,he=e[i](u).position(p+"*"+g);if((0,b.HD)(Q))_?he.color(_,Q):he.color(Q);else if((0,b.mf)(Q)){var ze=vf(t,"color"),Er=ze.mappingFields,Fr=ze.tileMappingField;he.color(Fr,Uh(Er,Q))}else _&&he.color(_,Q);if((0,b.HD)(pt))S?he.shape(S,[pt]):he.shape(pt);else if((0,b.mf)(pt)){var zr=vf(t,"shape"),Er=zr.mappingFields,Fr=zr.tileMappingField;he.shape(Fr,Uh(Er,pt))}else S&&he.shape(S,pt);if((0,b.hj)(yt))k?he.size(k,yt):he.size(yt);else if((0,b.mf)(yt)){var pn=vf(t,"size"),Er=pn.mappingFields,Fr=pn.tileMappingField;he.size(Fr,Uh(Er,yt))}else k&&he.size(k,yt);if((0,b.mf)(Ht)){var nn=vf(t,"style"),Er=nn.mappingFields,Fr=nn.tileMappingField;he.style(Fr,Uh(Er,Ht))}else(0,b.Kn)(Ht)&&he.style(Ht);if(L===!1?he.tooltip(!1):(0,b.xb)(L)||he.tooltip(L.join("*"),Uh(L,ce)),R===!1)he.label(!1);else if(R){var Pn=R.callback,wi=R.fields,ha=(0,P._T)(R,["callback","fields"]);he.label({fields:wi||[g],callback:Pn,cfg:Os(ha)})}return U&&he.state(U),G&&he.customInfo(G),[p,g].filter(function(Sa){return Sa!==_}).forEach(function(Sa){e.legend(Sa,!1)}),(0,P.pi)((0,P.pi)({},r),{ext:{geometry:he}})}function Gv(r){var e=r.options,t=e.area,i=e.xField,u=e.yField,c=e.seriesField,p=e.smooth,g=e.tooltip,_=e.useDeferredLabel,S=zh(g,[i,u,c]),k=S.fields,L=S.formatter;return t?Fl(hn({},r,{options:{type:"area",colorField:c,tooltipFields:k,mapping:(0,P.pi)({shape:p?"smooth":"area",tooltip:L},t),args:{useDeferredLabel:_}}})):r}function _x(r){var e=r.options,t=e.edge,i=e.xField,u=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=zh(p,[i,u,c]),S=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"edge",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:k},t),args:{useDeferredLabel:g}}})):r}function Lw(r){var e=r.chart,t=r.options,i=r.ext,u=t.seriesField,c=t.isGroup,p=t.isStack,g=t.marginRatio,_=t.widthRatio,S=t.groupField,k=t.theme,L=[];if(u&&(c&&L.push({type:"dodge",dodgeBy:S||u,marginRatio:g}),p&&L.push({type:"stack",marginRatio:g})),L.length&&(i==null?void 0:i.geometry)){var R=i==null?void 0:i.geometry;R.adjust(L)}return(0,b.UM)(_)||e.theme(hn({},(0,b.Kn)(k)?k:gv(k),{columnWidthRatio:_})),r}function ac(r){var e=r.options,t=e.xField,i=e.yField,u=e.interval,c=e.seriesField,p=e.tooltip,g=e.minColumnWidth,_=e.maxColumnWidth,S=e.columnBackground,k=e.dodgePadding,L=e.intervalPadding,R=e.useDeferredLabel,U=zh(p,[t,i,c]),G=U.fields,Q=U.formatter,pt=(u?Fl(hn({},r,{options:{type:"interval",colorField:c,tooltipFields:G,mapping:(0,P.pi)({tooltip:Q},u),args:{dodgePadding:k,intervalPadding:L,minColumnWidth:g,maxColumnWidth:_,background:S,useDeferredLabel:R}}})):r).ext;return Lw((0,P.pi)((0,P.pi)({},r),{ext:pt}))}function C0(r){var e=r.options,t=e.line,i=e.stepType,u=e.xField,c=e.yField,p=e.seriesField,g=e.smooth,_=e.connectNulls,S=e.tooltip,k=e.useDeferredLabel,L=zh(S,[u,c,p]),R=L.fields,U=L.formatter;return t?Fl(hn({},r,{options:{type:"line",colorField:p,tooltipFields:R,mapping:(0,b.b$)({shape:i||(g?"smooth":"line"),tooltip:U},t),args:{connectNulls:_,useDeferredLabel:k}}})):r}function Bf(r){var e=r.options,t=e.point,i=e.xField,u=e.yField,c=e.seriesField,p=e.sizeField,g=e.shapeField,_=e.tooltip,S=e.useDeferredLabel,k=zh(_,[i,u,c,p,g]),L=k.fields,R=k.formatter;return t?Fl(hn({},r,{options:{type:"point",colorField:c,shapeField:g,tooltipFields:L,mapping:(0,P.pi)({tooltip:R},t),args:{useDeferredLabel:S}}})):r}function gg(r){var e=r.options,t=e.polygon,i=e.xField,u=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=zh(p,[i,u,c]),S=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"polygon",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:k},t),args:{useDeferredLabel:g}}})):r}function mg(r){var e=r.options,t=e.schema,i=e.xField,u=e.yField,c=e.seriesField,p=e.tooltip,g=e.useDeferredLabel,_=zh(p,[i,u,c]),S=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"schema",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:k},t),args:{useDeferredLabel:g}}})):r}function A0(r){var e=r.options,t=e.violin,i=e.xField,u=e.yField,c=e.seriesField,p=e.sizeField,g=e.tooltip,_=zh(g,[i,u,c,p]),S=_.fields,k=_.formatter;return t?Fl(hn({},r,{options:{type:"violin",colorField:c,tooltipFields:S,mapping:(0,P.pi)({tooltip:k},t)}})):r}var Pw=ot(18587),xx="data-chart-source-type",Ow=["padding","appendPadding","renderer","pixelRatio","syncViewPadding","supportCSSTransform","limitInPlot"],Ha=function(r){(0,P.ZT)(e,r);function e(t,i){var u=r.call(this)||this;return u.container=typeof t=="string"?document.getElementById(t):t,u.options=hn({},u.getDefaultOptions(),i),u.createG2(),u.bindEvents(),u}return e.getDefaultOptions=function(){return{renderer:"canvas",xAxis:{nice:!0,label:{autoRotate:!1,autoHide:{type:"equidistance",cfg:{minGap:6}}}},yAxis:{nice:!0,label:{autoHide:!0,autoRotate:!1}},animation:!0}},e.prototype.createG2=function(){var t=this.options,i=t.width,u=t.height,c=t.defaultInteractions;this.chart=new Fn((0,P.pi)((0,P.pi)((0,P.pi)((0,P.pi)({container:this.container,autoFit:!1},this.getChartSize(i,u)),{localRefresh:!1}),fs(this.options,Ow)),{defaultInteractions:c})),this.container.setAttribute(xx,"G2Plot")},e.prototype.getChartSize=function(t,i){var u=ax(this.container);return{width:t||u.width||400,height:i||u.height||400}},e.prototype.bindEvents=function(){var t=this;this.chart&&this.chart.on("*",function(i){i!=null&&i.type&&t.emit(i.type,i)})},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.render=function(){this.chart.clear(),this.chart.options={data:[],animate:!0},this.chart.views=[],this.execAdaptor(),this.chart.render(),this.bindSizeSensor()},e.prototype.update=function(t){this.updateOption(t),this.render()},e.prototype.updateOption=function(t){this.options=hn({},this.options,t)},e.prototype.setState=function(t,i,u){u===void 0&&(u=!0);var c=Bh(this.chart);(0,b.S6)(c,function(p){i(p.getData())&&p.setState(t,u)})},e.prototype.getStates=function(){var t=Bh(this.chart),i=[];return(0,b.S6)(t,function(u){var c=u.getData(),p=u.getStates();(0,b.S6)(p,function(g){i.push({data:c,state:g,geometry:u.geometry,element:u})})}),i},e.prototype.changeData=function(t){this.update({data:t})},e.prototype.changeSize=function(t,i){this.chart.changeSize(t,i)},e.prototype.addAnnotations=function(t,i){i=i||this.chart;var u=(0,P.pr)(t),c=i.getController("annotation"),p=c.getComponents().map(function(S){return S.extra});c.clear(!0);for(var g=function(S){var k=p[S],L=u.findIndex(function(R){return R.id&&R.id===k.id});L!==-1&&(k=hn({},k,u[L]),u.splice(L,1)),c.annotation(k)},_=0;_<p.length;_++)g(_);u.forEach(function(S){return c.annotation(S)}),i.render(!0)},e.prototype.removeAnnotations=function(t){var i=this.chart.getController("annotation"),u=i.getComponents().map(function(g){return g.extra});i.clear(!0);for(var c=function(g){var _=u[g];t.find(function(S){return S.id&&S.id===_.id})||i.annotation(_)},p=0;p<u.length;p++)c(p);this.chart.render(!0)},e.prototype.destroy=function(){this.unbindSizeSensor(),this.chart.destroy(),this.off(),this.container.removeAttribute(xx)},e.prototype.execAdaptor=function(){var t=this.getSchemaAdaptor(),i=this.options,u=i.padding,c=i.appendPadding;this.chart.padding=u,this.chart.appendPadding=c,t({chart:this.chart,options:this.options})},e.prototype.triggerResize=function(){this.chart.forceFit()},e.prototype.bindSizeSensor=function(){var t=this;if(!this.unbind){var i=this.options.autoFit,u=i===void 0?!0:i;u&&(this.unbind=(0,Pw.ak)(this.container,function(){var c=ax(t.container),p=c.width,g=c.height;(p!==t.chart.width||g!==t.chart.height)&&t.triggerResize()}))}},e.prototype.unbindSizeSensor=function(){this.unbind&&(this.unbind(),this.unbind=void 0)},e}($e.Z);function Fw(r,e,t,i){var u=(0,b.u4)(r,function(c,p){var g=p[t],_=c.has(g)?c.get(g):0,S=p[e];return _=b0(S)?_+S:_,c.set(g,_),c},new Map);return(0,b.UI)(r,function(c){var p,g=c[e],_=c[t],S=b0(g)&&u.get(_)!==0?g/u.get(_):0;return(0,P.pi)((0,P.pi)({},c),(p={},p[i]=S,p))})}function HO(r,e,t,i){var u=(0,b.u4)(r,function(c,p){var g=(0,b.u4)(t,function(k,L){return""+k+p[L]},""),_=c.has(g)?c.get(g):0,S=p[e];return _=b0(S)?_+S:_,c.set(g,_),c},new Map);return(0,b.UI)(r,function(c){var p,g=c[e],_=(0,b.u4)(t,function(k,L){return""+k+c[L]},""),S=b0(g)&&u.get(_)!==0?g/u.get(_):0;return(0,P.pi)((0,P.pi)({},c),(p={},p[i]=S,p))})}function yg(r,e,t,i,u){return u?Fw(r,e,t,i):r}function _g(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.lineStyle,p=t.lineShape,g=t.point,_=t.area,S=t.seriesField,k=g==null?void 0:g.state,L=_==null?void 0:_.state;e.data(i);var R=hn({},r,{options:{shapeField:S,line:{color:u,style:c,shape:p},point:g&&(0,P.pi)({color:u,shape:"circle"},g),area:_&&(0,P.pi)({color:u},_),label:void 0}}),U=hn({},R,{options:{tooltip:!1,state:k}}),G=hn({},R,{options:{tooltip:!1,state:L}});return C0(R),Bf(U),Gv(G),r}function Py(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.data;return Ga(Zs((e={},e[p]=u,e[g]=c,e),(t={},t[p]={type:"cat"},t[g]=ix(_,g),t)))(r)}function _5(r){var e=r.chart,t=r.options,i=t.reflect;if(i){var u=i;(0,b.kJ)(u)||(u=[u]);var c=u.map(function(p){return["reflect",p]});e.coordinate({type:"rect",actions:c})}return r}function xg(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(p,!1):e.axis(p,u),r}function Rw(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField;return i&&u?e.legend(u,i):i===!1&&e.legend(!1),r}function x5(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"line");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:(0,P.pi)({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Os(g))})}return r}function b5(r){var e=r.chart,t=r.options,i=t.isStack;return i&&(0,b.S6)(e.geometries,function(u){u.adjust("stack")}),r}function E5(r){return Ga(_g,Py,b5,Bo,_5,xg,Rw,hl,x5,Vu,ad,Xs,ms,Ys(),Df)(r)}function Oy(r){var e=r.chart,t=r.options,i=t.data,u=t.areaStyle,c=t.color,p=t.point,g=t.line,_=t.isPercent,S=t.xField,k=t.yField,L=t.tooltip,R=t.seriesField,U=t.startOnZero,G=p==null?void 0:p.state,Q=yg(i,k,S,k,_);e.data(Q);var pt=_?(0,P.pi)({formatter:function(he){return{name:he[R]||he[S],value:(Number(he[k])*100).toFixed(2)+"%"}}},L):L,yt=hn({},r,{options:{area:{color:c,style:u},point:p&&(0,P.pi)({color:c},p),tooltip:pt,label:void 0,args:{startOnZero:U}}}),Ht={chart:e,options:hn({line:{size:2}},(0,b.CE)(t,["state"]),{line:g&&(0,P.pi)({color:c},g),sizeField:R,state:g==null?void 0:g.state,tooltip:!1,label:void 0,args:{startOnZero:U}})},ce=hn({},yt,{options:{tooltip:!1,state:G}});return Gv(yt),C0(Ht),Bf(ce),r}function Fy(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"area");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:(0,P.pi)({layout:[{type:"limit-in-plot"},{type:"path-adjust-position"},{type:"point-adjust-position"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Os(g))})}return r}function jO(r){var e=r.chart,t=r.options,i=t.isStack,u=t.isPercent,c=t.seriesField;return(u||i)&&c&&(0,b.S6)(e.geometries,function(p){p.adjust("stack")}),r}function Dw(r){return Ga(Bo,Nh("areaStyle"),S0("rect"),Oy,Py,jO,xg,Rw,hl,Fy,Vu,Ys(),Xs,ms,Df)(r)}var WO=hn({},Ha.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},isStack:!0,line:{},legend:{position:"top-left",radio:{}}}),w5=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="area",t}return e.getDefaultOptions=function(){return WO},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,u=i.isPercent,c=i.xField,p=i.yField,g=this,_=g.chart,S=g.options;Py({chart:_,options:S}),this.chart.changeData(yg(t,p,c,p,u))},e.prototype.getSchemaAdaptor=function(){return Dw},e}(Ha),XO=10,S5=5,Ry={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},YO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg=(0,P.pi)({name:"button"},Ry),t}return e.prototype.getButtonCfg=function(){var t=this.context.view,i=(0,b.U2)(t,["interactions","filter-action","cfg","buttonConfig"]);return hn(this.buttonCfg,i,this.cfg)},e.prototype.drawButton=function(){var t=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:t.name}),u=this.drawText(i);this.drawBackground(i,u.getBBox()),this.buttonGroup=i},e.prototype.drawText=function(t){var i,u=this.getButtonCfg();return t.addShape({type:"text",name:"button-text",attrs:(0,P.pi)({text:u.text},(i=u.textStyle)===null||i===void 0?void 0:i.default)})},e.prototype.drawBackground=function(t,i){var u,c=this.getButtonCfg(),p=Vv(c.padding),g=t.addShape({type:"rect",name:"button-rect",attrs:(0,P.pi)({x:i.x-p[3],y:i.y-p[0],width:i.width+p[1]+p[3],height:i.height+p[0]+p[2]},(u=c.buttonStyle)===null||u===void 0?void 0:u.default)});return g.toBack(),t.on("mouseenter",function(){var _;g.attr((_=c.buttonStyle)===null||_===void 0?void 0:_.active)}),t.on("mouseleave",function(){var _;g.attr((_=c.buttonStyle)===null||_===void 0?void 0:_.default)}),g},e.prototype.resetPosition=function(){var t=this.context.view,i=t.getCoordinate(),u=i.convert({x:1,y:1}),c=this.buttonGroup,p=c.getBBox(),g=_c.transform(null,[["t",u.x-p.width-XO,u.y+p.height+S5]]);c.setMatrix(g)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),r.prototype.destroy.call(this)},e}(oi);Yn("brush-reset-button",YO,{name:"brush-reset-button"}),kn("filter-action",{});function Hv(r){return r.isInPlot()}function T0(r,e,t){var i=t||{},u=i.mask,c=i.isStartEnable,p=e||"rect";switch(r){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Hv,action:["brush:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:u==null?void 0:u.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush:filter","brush:end",p+"-mask:end",p+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mousemove",action:"cursor:default",isEnable:function(g){return c?!c(g):!1}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:u==null?void 0:u.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Hv,action:["brush-x:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:u==null?void 0:u.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush-x:filter","brush-x:end",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:u==null?void 0:u.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:c||Hv,action:["brush-y:start",p+"-mask:start",p+"-mask:show"],arg:[null,{maskStyle:u==null?void 0:u.style}]}],processing:[{trigger:"mousemove",isEnable:Hv,action:[p+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Hv,action:["brush-y:filter","brush-y:end",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair",isEnable:c||function(){return!0}},{trigger:"mask:mouseenter",action:"cursor:move",isEnable:c||function(){return!0}},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:c||function(g){return!g.isInShape("mask")},action:[p+"-mask:start",p+"-mask:show"],arg:[{maskStyle:u==null?void 0:u.style}]},{trigger:"mask:dragstart",action:[p+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[p+"-mask:resize"]},{trigger:"mask:drag",action:[p+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[p+"-mask:end"]},{trigger:"mask:dragend",action:[p+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(g){return!g.isInPlot()},action:["element-range-highlight:clear",p+"-mask:end",p+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",p+"-mask:hide"]}]};default:return{}}}kn("brush",T0("brush")),kn("brush-highlight",T0("brush-highlight")),kn("brush-x",T0("brush-x","x-rect")),kn("brush-y",T0("brush-y","y-rect")),kn("brush-x-highlight",T0("brush-x-highlight","x-rect")),kn("brush-y-highlight",T0("brush-y-highlight","y-rect"));var Bw=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function Nw(r){var e=r.options,t=e.brush,i=(0,b.hX)(e.interactions||[],function(u){return Bw.indexOf(u.type)===-1});return t!=null&&t.enabled&&(Bw.forEach(function(u){var c=!1;switch(t.type){case"x-rect":c=u===(t.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":c=u===(t.action==="highlight"?"brush-y-highlight":"brush-y");break;default:c=u===(t.action==="highlight"?"brush-highlight":"brush");break}var p={type:u,enable:c};t&&(p.cfg=T0(u,t.type,t)),i.push(p)}),(t==null?void 0:t.action)!=="highlight"&&i.push({type:"filter-action",cfg:{buttonConfig:t.button}})),hn({},r,{options:{interactions:i}})}var M0={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},bx=function(r,e){return r==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:e}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:e}]}]};kn(M0.hover,{start:bx(M0.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]}),kn(M0.click,{start:bx(M0.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function C5(r){return r===void 0&&(r=!1),function(e){var t=e.chart,i=e.options,u=i.connectedArea,c=function(){t.removeInteraction(M0.hover),t.removeInteraction(M0.click)};if(!r&&u){var p=u.trigger||"hover";c(),t.interaction(M0[p],{start:bx(p,u.style)})}else c();return e}}function zw(r,e){return!(0,b.hj)(r)||!(0,b.hj)(e)||r===0&&e===0?"-":r===e?"100%":r===0?"\u221E":(100*e/r).toFixed(2)+"%"}function A5(r,e){return hn({size:e?32:80,spacing:e?8:12,offset:e?32:0,arrow:r.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:r.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:zw}},r)}function Dy(r,e){return(0,b.UI)(e.getModel().points,function(t){return r.convertPoint(t)})}function T5(r,e,t){var i=r.view,u=r.geometry,c=r.group,p=r.options,g=r.horizontal,_=p.offset,S=p.size,k=p.arrow,L=i.getCoordinate(),R=Dy(L,e)[3],U=Dy(L,t)[0],G=U.y-R.y,Q=U.x-R.x;if(typeof k!="boolean"){var pt=k.headSize,yt=p.spacing,Ht;g?(Q-pt)/2<yt?(yt=Math.max(1,(Q-pt)/2),Ht=[[R.x+yt,R.y-_],[R.x+yt,R.y-_-S],[U.x-yt,U.y-_-S/2]]):Ht=[[R.x+yt,R.y-_],[R.x+yt,R.y-_-S],[U.x-yt-pt,U.y-_-S],[U.x-yt,U.y-_-S/2],[U.x-yt-pt,U.y-_]]:(G-pt)/2<yt?(yt=Math.max(1,(G-pt)/2),Ht=[[R.x+_,R.y+yt],[R.x+_+S,R.y+yt],[U.x+_+S/2,U.y-yt]]):Ht=[[R.x+_,R.y+yt],[R.x+_+S,R.y+yt],[U.x+_+S,U.y-yt-pt],[U.x+_+S/2,U.y-yt],[U.x+_,U.y-yt-pt]],c.addShape("polygon",{id:i.id+"-conversion-tag-arrow-"+u.getElementId(e.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:e,nextElement:t},attrs:(0,P.pi)((0,P.pi)({},k.style||{}),{points:Ht})})}}function M5(r,e,t){var i,u,c,p=r.view,g=r.geometry,_=r.group,S=r.options,k=r.field,L=r.horizontal,R=S.offset,U=S.size;if(typeof S.text!="boolean"){var G=p.getCoordinate(),Q=((i=S.text)===null||i===void 0?void 0:i.formatter)&&((u=S.text)===null||u===void 0?void 0:u.formatter(e.getData()[k],t.getData()[k])),pt=Dy(G,e)[L?3:0],yt=Dy(G,t)[L?0:3],Ht=_.addShape("text",{id:p.id+"-conversion-tag-text-"+g.getElementId(e.getModel().mappingData),name:"conversion-tag-text",origin:{element:e,nextElement:t},attrs:(0,P.pi)((0,P.pi)({},((c=S.text)===null||c===void 0?void 0:c.style)||{}),{text:Q,x:L?(pt.x+yt.x)/2:pt.x+R+U/2,y:L?pt.y-R-U/2:(pt.y+yt.y)/2})});if(L){var ce=yt.x-pt.x,he=Ht.getBBox().width;if(he>ce){var ze=he/Q.length,Er=Math.max(1,Math.ceil(ce/ze)-1),Fr=Q.slice(0,Er)+"...";Ht.attr("text",Fr)}}}}function I5(r,e,t){T5(r,e,t),M5(r,e,t)}function k5(r,e,t){return e===void 0&&(e=!0),t===void 0&&(t=!1),function(i){var u=i.options,c=i.chart,p=u.conversionTag,g=u.theme;return p&&!t&&(c.theme(hn({},(0,b.Kn)(g)?g:gv(g),{columnWidthRatio:1/3})),c.annotation().shape({render:function(_,S){var k=_.addGroup({id:c.id+"-conversion-tag-group",name:"conversion-tag-group"}),L=(0,b.sE)(c.geometries,function(G){return G.type==="interval"}),R={view:S,geometry:L,group:k,field:r,horizontal:e,options:A5(p,e)},U=L.elements;(0,b.S6)(U,function(G,Q){Q>0&&I5(R,U[Q-1],G)})}})),i}}function L5(r){var e=r.options,t=e.legend,i=e.seriesField,u=e.isStack;return i?t!==!1&&(t=(0,P.pi)({position:u?"right-top":"top-left"},t)):t=!1,r.options.legend=t,r}function P5(r){var e=r.chart,t=r.options,i=t.data,u=t.columnStyle,c=t.color,p=t.columnWidthRatio,g=t.isPercent,_=t.isGroup,S=t.isStack,k=t.xField,L=t.yField,R=t.seriesField,U=t.groupField,G=t.tooltip,Q=t.shape,pt=g&&_&&S?HO(i,L,[k,U],L):yg(i,L,k,L,g),yt=[];S&&R&&!_?pt.forEach(function(he){var ze=yt.find(function(Er){return Er[k]===he[k]&&Er[R]===he[R]});ze?ze[L]+=he[L]||0:yt.push((0,P.pi)({},he))}):yt=pt,e.data(yt);var Ht=g?(0,P.pi)({formatter:function(he){return{name:_&&S?he[R]+" - "+he[U]:he[R]||he[k],value:(Number(he[L])*100).toFixed(2)+"%"}}},G):G,ce=hn({},r,{options:{data:yt,widthRatio:p,tooltip:Ht,interval:{shape:Q,style:u,color:c}}});return ac(ce),ce}function Ex(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.data,S=i.isPercent,k=S?{max:1,min:0,minLimit:0,maxLimit:1}:{};return Ga(Zs((e={},e[p]=u,e[g]=c,e),(t={},t[p]={type:"cat"},t[g]=(0,P.pi)((0,P.pi)({},ix(_,g)),k),t)))(r)}function O5(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(p,!1):e.axis(p,u),r}function F5(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField;return i&&u?e.legend(u,i):i===!1&&e.legend(!1),r}function R5(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=t.isRange,p=Ec(e,"interval");if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:[u],callback:g,cfg:(0,P.pi)({layout:_!=null&&_.position?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Os(c?(0,P.pi)({content:function(S){var k;return(k=S[u])===null||k===void 0?void 0:k.join("-")}},_):_))})}return r}function D5(r){var e=r.chart,t=r.options,i=t.tooltip,u=t.isGroup,c=t.isStack,p=t.groupField,g=t.data,_=t.xField,S=t.yField,k=t.seriesField;if(i===!1)e.tooltip(!1);else{var L=i;if(u&&c){var R=L.customItems,U=(L==null?void 0:L.formatter)||function(G){return{name:G[k]+" - "+G[p],value:G[S]}};L=(0,P.pi)((0,P.pi)({},L),{customItems:function(G){var Q=[];return(0,b.S6)(G,function(pt){var yt=(0,b.hX)(g,function(Ht){return(0,b.BD)(Ht,fs(pt.data,[_,k]))});yt.forEach(function(Ht){Q.push((0,P.pi)((0,P.pi)((0,P.pi)({},pt),{value:Ht[S],data:Ht,mappingData:{_origin:Ht}}),U(Ht)))})}),R?R(Q):Q}})}e.tooltip(L)}return r}function By(r,e){e===void 0&&(e=!1);var t=r.options,i=t.seriesField;return Ga(L5,Bo,Nh("columnStyle"),w0,S0("rect"),P5,Ex,O5,F5,D5,Vu,ad,R5,Nw,Xs,ms,Ys(),k5(t.yField,!e,!!i),C5(!t.isStack),Df)(r)}function B5(r){var e=r.options,t=e.xField,i=e.yField,u=e.xAxis,c=e.yAxis,p={left:"bottom",right:"top",top:"left",bottom:"right"},g=c!==!1?(0,P.pi)({position:p[(c==null?void 0:c.position)||"left"]},c):!1,_=u!==!1?(0,P.pi)({position:p[(u==null?void 0:u.position)||"bottom"]},u):!1;return(0,P.pi)((0,P.pi)({},r),{options:(0,P.pi)((0,P.pi)({},e),{xField:i,yField:t,xAxis:g,yAxis:_})})}function N5(r){var e=r.options,t=e.label;return t&&!t.position&&(t.position="left",t.layout||(t.layout=[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}])),hn({},r,{options:{label:t}})}function z5(r){var e=r.options,t=e.seriesField,i=e.isStack,u=e.legend;return t?u!==!1&&(u=(0,P.pi)({position:i?"top-left":"right-top"},u||{})):u=!1,hn({},r,{options:{legend:u}})}function U5(r){var e=r.options,t=[{type:"transpose"},{type:"reflectY"}].concat(e.coordinate||[]);return hn({},r,{options:{coordinate:t}})}function Z5(r){var e=r.chart,t=r.options,i=t.barStyle,u=t.barWidthRatio,c=t.minBarWidth,p=t.maxBarWidth,g=t.barBackground;return By({chart:e,options:(0,P.pi)((0,P.pi)({},t),{columnStyle:i,columnWidthRatio:u,minColumnWidth:c,maxColumnWidth:p,columnBackground:g})},!0)}function Uw(r){return Ga(B5,N5,z5,hl,U5,Z5)(r)}var V5=hn({},Ha.getDefaultOptions(),{barWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),Zw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bar",t}return e.getDefaultOptions=function(){return V5},e.prototype.changeData=function(t){var i,u;this.updateOption({data:t});var c=this,p=c.chart,g=c.options,_=g.isPercent,S=g.xField,k=g.yField,L=g.xAxis,R=g.yAxis;i=[k,S],S=i[0],k=i[1],u=[R,L],L=u[0],R=u[1];var U=(0,P.pi)((0,P.pi)({},g),{xField:S,yField:k,yAxis:R,xAxis:L});Ex({chart:p,options:U}),p.changeData(yg(t,S,k,S,_))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Uw},e}(Ha),G5=hn({},Ha.getDefaultOptions(),{columnWidthRatio:.6,marginRatio:1/32,tooltip:{shared:!0,showMarkers:!1,offset:20},legend:{radio:{}},interactions:[{type:"active-region"}]}),Vw=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="column",t}return e.getDefaultOptions=function(){return G5},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,u=i.yField,c=i.xField,p=i.isPercent,g=this,_=g.chart,S=g.options;Ex({chart:_,options:S}),this.chart.changeData(yg(t,u,c,u,p))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return By},e}(Ha),Sx,jv="$$percentage$$",Wv="$$mappingValue$$",Kd="$$conversion$$",Cx="$$totalPercentage$$",cm="$$x$$",bg="$$y$$",Eg={appendPadding:[0,80],minSize:0,maxSize:1,meta:(Sx={},Sx[Wv]={min:0,max:1,nice:!1},Sx),label:{style:{fill:"#fff",fontSize:12}},tooltip:{showTitle:!1,showMarkers:!1,shared:!1},conversionTag:{offsetX:10,offsetY:0,style:{fontSize:12,fill:"rgba(0,0,0,0.45)"}}},Ny="CONVERSION_TAG_NAME";function zy(r,e,t){var i=[],u=t.yField,c=t.maxSize,p=t.minSize,g=(0,b.U2)((0,b.UT)(e,u),[u]),_=(0,b.hj)(c)?c:1,S=(0,b.hj)(p)?p:0;return i=(0,b.UI)(r,function(k,L){var R=(k[u]||0)/g;return k[jv]=R,k[Wv]=(_-S)*R+S,k[Kd]=[(0,b.U2)(r,[L-1,u]),k[u]],k}),i}function Ax(r){return function(e){var t=e.chart,i=e.options,u=i.conversionTag,c=i.filteredData,p=c||t.getOptions().data;if(u){var g=u.formatter;p.forEach(function(_,S){if(!(S<=0||Number.isNaN(_[Wv]))){var k=r(_,S,p,{top:!0,name:Ny,text:{content:(0,b.mf)(g)?g(_,p):g,offsetX:u.offsetX,offsetY:u.offsetY,position:"end",autoRotate:!1,style:(0,P.pi)({textAlign:"start",textBaseline:"middle"},u.style)}});t.annotation().line(k)}})}return e}}function H5(r){var e=r.chart,t=r.options,i=t.data,u=i===void 0?[]:i,c=t.yField,p=t.maxSize,g=t.minSize,_=zy(u,u,{yField:c,maxSize:p,minSize:g});return e.data(_),r}function j5(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.color,p=t.tooltip,g=t.label,_=t.shape,S=_===void 0?"funnel":_,k=t.funnelStyle,L=t.state,R=zh(p,[i,u]),U=R.fields,G=R.formatter;Fl({chart:e,options:{type:"interval",xField:i,yField:Wv,colorField:i,tooltipFields:(0,b.kJ)(U)&&U.concat([jv,Kd]),mapping:{shape:S,tooltip:G,color:c,style:k},label:g,state:L}});var Q=Ec(r.chart,"interval");return Q.adjust("symmetric"),r}function W5(r){var e=r.chart,t=r.options,i=t.isTransposed;return e.coordinate({type:"rect",actions:i?[]:[["transpose"],["scale",1,-1]]}),r}function Gw(r){var e=r.options,t=r.chart,i=e.maxSize,u=(0,b.U2)(t,["geometries","0","dataArray"],[]),c=(0,b.U2)(t,["options","data","length"]),p=(0,b.UI)(u,function(_){return(0,b.U2)(_,["0","nextPoints","0","x"])*c-.5}),g=function(_,S,k,L){var R=i-(i-_[Wv])/2;return(0,P.pi)((0,P.pi)({},L),{start:[p[S-1]||S-.5,R],end:[p[S-1]||S-.5,R+.05]})};return Ax(g)(r),r}function Tx(r){return Ga(H5,j5,W5,Gw)(r)}function X5(r){var e,t=r.chart,i=r.options,u=i.data,c=u===void 0?[]:u,p=i.yField;return t.data(c),t.scale((e={},e[p]={sync:!0},e)),r}function Y5(r){var e=r.chart,t=r.options,i=t.data,u=t.xField,c=t.yField,p=t.color,g=t.compareField,_=t.isTransposed,S=t.tooltip,k=t.maxSize,L=t.minSize,R=t.label,U=t.funnelStyle,G=t.state,Q=t.showFacetTitle;return e.facet("mirror",{fields:[g],transpose:!_,padding:_?0:[32,0,0,0],showTitle:Q,eachView:function(pt,yt){var Ht=_?yt.rowIndex:yt.columnIndex;_||pt.coordinate({type:"rect",actions:[["transpose"],["scale",Ht===0?-1:1,-1]]});var ce=zy(yt.data,i,{yField:c,maxSize:k,minSize:L});pt.data(ce);var he=zh(S,[u,c,g]),ze=he.fields,Er=he.formatter,Fr=_?{offset:Ht===0?10:-23,position:Ht===0?"bottom":"top"}:{offset:10,position:"left",style:{textAlign:Ht===0?"end":"start"}};Fl({chart:pt,options:{type:"interval",xField:u,yField:Wv,colorField:u,tooltipFields:(0,b.kJ)(ze)&&ze.concat([jv,Kd]),mapping:{shape:"funnel",tooltip:Er,color:p,style:U},label:R===!1?!1:hn({},Fr,R),state:G}})}}),r}function Mx(r){var e=r.chart,t=r.index,i=r.options,u=i.conversionTag,c=i.isTransposed;((0,b.hj)(t)?[e]:e.views).forEach(function(p,g){var _=(0,b.U2)(p,["geometries","0","dataArray"],[]),S=(0,b.U2)(p,["options","data","length"]),k=(0,b.UI)(_,function(R){return(0,b.U2)(R,["0","nextPoints","0","x"])*S-.5}),L=function(R,U,G,Q){var pt=(t||g)===0?-1:1;return hn({},Q,{start:[k[U-1]||U-.5,R[Wv]],end:[k[U-1]||U-.5,R[Wv]+.05],text:c?{style:{textAlign:"start"}}:{offsetX:u!==!1?pt*u.offsetX:0,style:{textAlign:(t||g)===0?"end":"start"}}})};Ax(L)(hn({},{chart:p,options:i}))})}function $5(r){var e=r.chart;return e.once("beforepaint",function(){return Mx(r)}),r}function q5(r){return Ga(X5,Y5,$5)(r)}function K5(r){var e=r.chart,t=r.options,i=t.data,u=i===void 0?[]:i,c=t.yField,p=(0,b.u4)(u,function(S,k){return S+(k[c]||0)},0),g=(0,b.UT)(u,c)[c],_=(0,b.UI)(u,function(S,k){var L=[],R=[];if(S[Cx]=(S[c]||0)/p,k){var U=u[k-1][cm],G=u[k-1][bg];L[0]=U[3],R[0]=G[3],L[1]=U[2],R[1]=G[2]}else L[0]=-.5,R[0]=1,L[1]=.5,R[1]=1;return R[2]=R[1]-S[Cx],L[2]=(R[2]+1)/4,R[3]=R[2],L[3]=-L[2],S[cm]=L,S[bg]=R,S[jv]=(S[c]||0)/g,S[Kd]=[(0,b.U2)(u,[k-1,c]),S[c]],S});return e.data(_),r}function Q5(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.color,p=t.tooltip,g=t.label,_=t.funnelStyle,S=t.state,k=zh(p,[i,u]),L=k.fields,R=k.formatter;return Fl({chart:e,options:{type:"polygon",xField:cm,yField:bg,colorField:i,tooltipFields:(0,b.kJ)(L)&&L.concat([jv,Kd]),label:g,state:S,mapping:{tooltip:R,color:c,style:_}}}),r}function J5(r){var e=r.chart,t=r.options,i=t.isTransposed;return e.coordinate({type:"rect",actions:i?[["transpose"],["reflect","x"]]:[]}),r}function tI(r){var e=function(t,i,u,c){return(0,P.pi)((0,P.pi)({},c),{start:[t[cm][1],t[bg][1]],end:[t[cm][1]+.05,t[bg][1]]})};return Ax(e)(r),r}function eI(r){return Ga(K5,Q5,J5,tI)(r)}function rI(r){var e,t=r.chart,i=r.options,u=i.data,c=u===void 0?[]:u,p=i.yField;return t.data(c),t.scale((e={},e[p]={sync:!0},e)),r}function nI(r){var e=r.chart,t=r.options,i=t.seriesField,u=t.isTransposed,c=t.showFacetTitle;return e.facet("rect",{fields:[i],padding:[u?0:32,10,0,10],showTitle:c,eachView:function(p,g){Tx(hn({},r,{chart:p,options:{data:g.data}}))}}),r}function Hw(r){return Ga(rI,nI)(r)}var iI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.rendering=!1,t}return e.prototype.change=function(t){var i=this;if(!this.rendering){var u=t.seriesField,c=t.compareField,p=c?Mx:Gw,g=this.context.view,_=u||c?g.views:[g];(0,b.UI)(_,function(S,k){var L=S.getController("annotation"),R=(0,b.hX)((0,b.U2)(L,["option"],[]),function(G){var Q=G.name;return Q!==Ny});L.clear(!0),(0,b.S6)(R,function(G){typeof G=="object"&&S.annotation()[G.type](G)});var U=(0,b.U2)(S,["filteredData"],S.getOptions().data);p({chart:S,index:k,options:(0,P.pi)((0,P.pi)({},t),{filteredData:zy(U,U,t)})}),S.filterData(U),i.rendering=!0,S.render(!0)})}this.rendering=!1},e}(oi),jw="funnel-conversion-tag",Ix="funnel-afterrender",Ww={trigger:"afterrender",action:jw+":change"};Yn(jw,iI),kn(Ix,{start:[Ww]});function aI(r){var e=r.options,t=e.compareField,i=e.xField,u=e.yField,c=e.locale,p=e.funnelStyle,g=e.data,_=yx(c),S={label:t?{fields:[i,u,t,jv,Kd],formatter:function(L){return""+L[u]}}:{fields:[i,u,jv,Kd],offset:0,position:"middle",formatter:function(L){return L[i]+" "+L[u]}},tooltip:{title:i,formatter:function(L){return{name:L[i],value:L[u]}}},conversionTag:{formatter:function(L){return _.get(["conversionTag","label"])+": "+zw.apply(void 0,L[Kd])}}},k;return(t||p)&&(k=function(L){return hn({},t&&{lineWidth:1,stroke:"#fff"},(0,b.mf)(p)?p(L):p)}),hn({options:S},r,{options:{funnelStyle:k,data:(0,b.d9)(g)}})}function oI(r){var e=r.options,t=e.compareField,i=e.dynamicHeight,u=e.seriesField;return u?Hw(r):t?q5(r):i?eI(r):Tx(r)}function sI(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function uI(r){var e=r.chart;return e.axis(!1),r}function lI(r){var e=r.chart,t=r.options,i=t.legend;return i===!1?e.legend(!1):e.legend(i),r}function cI(r){var e=r.chart,t=r.options,i=t.interactions,u=t.dynamicHeight;return(0,b.S6)(i,function(c){c.enable===!1?e.removeInteraction(c.type):e.interaction(c.type,c.cfg||{})}),u?e.removeInteraction(Ix):e.interaction(Ix,{start:[(0,P.pi)((0,P.pi)({},Ww),{arg:t})]}),r}function Xw(r){return Ga(aI,oI,sI,uI,hl,cI,lI,ms,Bo,Ys())(r)}var fI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="funnel",t}return e.getDefaultOptions=function(){return Eg},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Xw},e.prototype.setState=function(t,i,u){u===void 0&&(u=!0);var c=Bh(this.chart);(0,b.S6)(c,function(p){i(p.getData())&&p.setState(t,u)})},e.prototype.getStates=function(){var t=Bh(this.chart),i=[];return(0,b.S6)(t,function(u){var c=u.getData(),p=u.getStates();(0,b.S6)(p,function(g){i.push({data:c,state:g,geometry:u.geometry,element:u})})}),i},e.CONVERSATION_FIELD=Kd,e.PERCENT_FIELD=jv,e.TOTAL_PERCENT_FIELD=Cx,e}(Ha),Uy,kx="range",Yw="type",Qd="percent",hI="#f0f0f0",wg="indicator-view",$w="range-view",pI={percent:0,range:{ticks:[]},innerRadius:.9,radius:.95,startAngle:-7/6*Math.PI,endAngle:1/6*Math.PI,syncViewPadding:!0,axis:{line:null,label:{offset:-24,style:{textAlign:"center",textBaseline:"middle"}},subTickLine:{length:-8},tickLine:{length:-12},grid:null},indicator:{pointer:{style:{lineWidth:5,lineCap:"round"}},pin:{style:{r:9.75,lineWidth:4.5,fill:"#fff"}}},statistic:{title:!1},meta:(Uy={},Uy[kx]={sync:"v"},Uy[Qd]={sync:"v",tickCount:5,tickInterval:.2},Uy),animation:!1};function dI(r,e){return r.map(function(t,i){var u;return u={},u[kx]=t-(r[i-1]||0),u[Yw]=""+i,u[Qd]=e,u})}function qw(r){var e;return[(e={},e[Qd]=(0,b.uZ)(r,0,1),e)]}function Kw(r,e){var t=(0,b.U2)(e,["ticks"],[]),i=(0,b.dp)(t)?(0,b.jj)(t):[0,(0,b.uZ)(r,0,1),1];return i[0]||i.shift(),dI(i,r)}function vI(r){var e=r.chart,t=r.options,i=t.percent,u=t.range,c=t.radius,p=t.innerRadius,g=t.startAngle,_=t.endAngle,S=t.axis,k=t.indicator,L=t.gaugeStyle,R=t.type,U=t.meter,G=u.color,Q=u.width;if(k){var pt=qw(i),yt=e.createView({id:wg});yt.data(pt),yt.point().position(Qd+"*1").shape(k.shape||"gauge-indicator").customInfo({defaultColor:e.getTheme().defaultColor,indicator:k}),yt.coordinate("polar",{startAngle:g,endAngle:_,radius:p*c}),yt.axis(Qd,S),yt.scale(Qd,fs(S,Rf))}var Ht=Kw(i,t.range),ce=e.createView({id:$w});ce.data(Ht);var he=(0,b.HD)(G)?[G,hI]:G,ze=ac({chart:ce,options:{xField:"1",yField:kx,seriesField:Yw,rawFields:[Qd],isStack:!0,interval:{color:he,style:L,shape:R==="meter"?"meter-gauge":null},args:{zIndexReversed:!0,sortZIndex:!0},minColumnWidth:Q,maxColumnWidth:Q}}).ext,Er=ze.geometry;return Er.customInfo({meter:U}),ce.coordinate("polar",{innerRadius:p,radius:c,startAngle:g,endAngle:_}).transpose(),r}function gI(r){var e;return Ga(Zs((e={range:{min:0,max:1,maxLimit:1,minLimit:0}},e[Qd]={},e)))(r)}function Qw(r,e){var t=r.chart,i=r.options,u=i.statistic,c=i.percent;if(t.getController("annotation").clear(!0),u){var p=u.content,g=void 0;p&&(g=hn({},{content:(c*100).toFixed(2)+"%",style:{opacity:.75,fontSize:"30px",lineHeight:1,textAlign:"center",color:"rgba(44,53,66,0.85)"}},p)),g5(t,{statistic:(0,P.pi)((0,P.pi)({},u),{content:g})},{percent:c})}return e&&t.render(!0),r}function mI(r){var e=r.chart,t=r.options,i=t.tooltip;return i?e.tooltip(hn({showTitle:!1,showMarkers:!1,containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',domStyles:{"g2-tooltip":{padding:"4px 8px",fontSize:"10px"}},customContent:function(u,c){var p=(0,b.U2)(c,[0,"data",Qd],0);return(p*100).toFixed(2)+"%"}},i)):e.tooltip(!1),r}function yI(r){var e=r.chart;return e.legend(!1),r}function Jw(r){return Ga(Bo,ms,vI,gI,mI,Qw,Xs,Ys(),yI)(r)}va("point","gauge-indicator",{draw:function(r,e){var t=r.customInfo,i=t.indicator,u=t.defaultColor,c=i,p=c.pointer,g=c.pin,_=e.addGroup(),S=this.parsePoint({x:0,y:0});return p&&_.addShape("line",{name:"pointer",attrs:(0,P.pi)({x1:S.x,y1:S.y,x2:r.x,y2:r.y,stroke:u},p.style)}),g&&_.addShape("circle",{name:"pin",attrs:(0,P.pi)({x:S.x,y:S.y,stroke:u},g.style)}),_}}),va("interval","meter-gauge",{draw:function(r,e){var t=r.customInfo.meter,i=t===void 0?{}:t,u=i.steps,c=u===void 0?50:u,p=i.stepRatio,g=p===void 0?.5:p;c=c<1?1:c,g=(0,b.uZ)(g,0,1);var _=this.coordinate,S=_.startAngle,k=_.endAngle,L=0;if(g>0&&g<1){var R=k-S;L=R/c/(g/(1-g)+1-1/c)}for(var U=L/(1-g)*g,G=e.addGroup(),Q=this.coordinate.getCenter(),pt=this.coordinate.getRadius(),yt=_c.getAngle(r,this.coordinate),Ht=yt.startAngle,ce=yt.endAngle,he=Ht;he<ce;){var ze=void 0,Er=(he-S)%(U+L);Er<U?ze=he+(U-Er):(he+=U+L-Er,ze=he+U);var Fr=_c.getSectorPath(Q.x,Q.y,pt,he,Math.min(ze,ce),pt*this.coordinate.innerRadius);G.addShape("path",{name:"meter-gauge",attrs:{path:Fr,fill:r.color,stroke:r.color,lineWidth:.5}}),he=ze+L}return G}});var _I=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="gauge",t}return e.getDefaultOptions=function(){return pI},e.prototype.changeData=function(t){this.chart.emit(It.BEFORE_CHANGE_DATA,pe.fromData(this.chart,It.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t});var i=this.chart.views.find(function(c){return c.id===wg});i&&i.data(qw(t));var u=this.chart.views.find(function(c){return c.id===$w});u&&u.data(Kw(t,this.options.range)),Qw({chart:this.chart,options:this.options},!0),this.chart.emit(It.AFTER_CHANGE_DATA,pe.fromData(this.chart,It.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Jw},e}(Ha);function tS(r,e,t){if(t===1)return[0,e];var i=Math.floor(r/e);return[e*i,e*(i+1)]}function xI(r){return Math.ceil(Math.log(r.length)/Math.LN2)+1}function Lx(r,e,t,i,u){var c=(0,b.d9)(r);(0,b.MR)(c,e);var p=(0,b.I)(c,e),g=(0,b.rx)(p),_=g.max-g.min,S=t;if(!t&&i&&(S=i>1?_/(i-1):g.max),!t&&!i){var k=xI(p);S=_/k}var L={},R=(0,b.vM)(c,u);(0,b.xb)(R)?(0,b.S6)(c,function(G){var Q=G[e],pt=tS(Q,S,i),yt=pt[0]+"-"+pt[1];(0,b.wH)(L,yt)||(L[yt]={range:pt,count:0}),L[yt].count+=1}):Object.keys(R).forEach(function(G){(0,b.S6)(R[G],function(Q){var pt=Q[e],yt=tS(pt,S,i),Ht=yt[0]+"-"+yt[1],ce=Ht+"-"+G;(0,b.wH)(L,ce)||(L[ce]={range:yt,count:0},L[ce][u]=G),L[ce].count+=1})});var U=[];return(0,b.S6)(L,function(G){U.push(G)}),U}var Zy="range",fm="count",eS=hn({},Ha.getDefaultOptions(),{columnStyle:{stroke:"#FFFFFF"},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]});function bI(r){var e=r.chart,t=r.options,i=t.data,u=t.binField,c=t.binNumber,p=t.binWidth,g=t.color,_=t.stackField,S=t.legend,k=t.columnStyle,L=Lx(i,u,p,c,_);e.data(L);var R=hn({},r,{options:{xField:Zy,yField:fm,seriesField:_,isStack:!0,interval:{color:g,style:k}}});return ac(R),S&&_?e.legend(_,S):e.legend(!1),r}function Px(r){var e,t=r.options,i=t.xAxis,u=t.yAxis;return Ga(Zs((e={},e[Zy]=i,e[fm]=u,e)))(r)}function rS(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis;return i===!1?e.axis(Zy,!1):e.axis(Zy,i),u===!1?e.axis(fm,!1):e.axis(fm,u),r}function EI(r){var e=r.chart,t=r.options,i=t.label,u=Ec(e,"interval");if(!i)u.label(!1);else{var c=i.callback,p=(0,P._T)(i,["callback"]);u.label({fields:[fm],callback:c,cfg:Os(p)})}return r}function nS(r){return Ga(Bo,Nh("columnStyle"),bI,Px,rS,w0,EI,hl,Xs,ms)(r)}var wI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="histogram",t}return e.getDefaultOptions=function(){return eS},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options,u=i.binField,c=i.binNumber,p=i.binWidth,g=i.stackField;this.chart.changeData(Lx(t,u,p,c,g))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return nS},e}(Ha),SI=hn({},Ha.getDefaultOptions(),{tooltip:{shared:!0,showMarkers:!0,showCrosshairs:!0,crosshairs:{type:"x"}},legend:{position:"top-left",radio:{}},isStack:!1}),CI=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.active=function(){var t=this.getView(),i=this.context.event;if(i.data){var u=i.data.items,c=t.geometries.filter(function(p){return p.type==="point"});(0,b.S6)(c,function(p){(0,b.S6)(p.elements,function(g){var _=(0,b.cx)(u,function(S){return S.data===g.data})!==-1;g.setState("active",_)})})}},e.prototype.reset=function(){var t=this.getView(),i=t.geometries.filter(function(u){return u.type==="point"});(0,b.S6)(i,function(u){(0,b.S6)(u.elements,function(c){c.setState("active",!1)})})},e.prototype.getView=function(){return this.context.view},e}(oi);Yn("marker-active",CI),kn("marker-active",{start:[{trigger:"tooltip:show",action:"marker-active:active"}],end:[{trigger:"tooltip:hide",action:"marker-active:reset"}]});var AI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="line",t}return e.getDefaultOptions=function(){return SI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;Py({chart:u,options:c}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return E5},e}(Ha),iS=hn({},Ha.getDefaultOptions(),{legend:{position:"right",radio:{}},tooltip:{shared:!1,showTitle:!1,showMarkers:!1},label:{layout:{type:"limit-in-plot",cfg:{action:"ellipsis"}}},pieStyle:{stroke:"white",lineWidth:1},statistic:{title:{style:{fontWeight:300,color:"#4B535E",textAlign:"center",fontSize:"20px",lineHeight:1}},content:{style:{fontWeight:"bold",color:"rgba(44,53,66,0.85)",textAlign:"center",fontSize:"32px",lineHeight:1}}},theme:{components:{annotation:{text:{animate:!1}}}}}),TI=[1,0,0,0,1,0,0,0,1];function Ox(r,e){var t=e?(0,P.pr)(e):(0,P.pr)(TI);return _c.transform(t,r)}var aS=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getActiveElements=function(){var t=_c.getDelegationObject(this.context);if(t){var i=this.context.view,u=t.component,c=t.item,p=u.get("field");if(p){var g=i.geometries[0].elements;return g.filter(function(_){return _.getModel().data[p]===c.value})}}return[]},e.prototype.getActiveElementLabels=function(){var t=this.context.view,i=this.getActiveElements(),u=t.geometries[0].labelsContainer.getChildren();return u.filter(function(c){return i.find(function(p){return(0,b.Xy)(p.getData(),c.get("data"))})})},e.prototype.transfrom=function(t){t===void 0&&(t=7.5);var i=this.getActiveElements(),u=this.getActiveElementLabels();i.forEach(function(c,p){var g=u[p],_=c.geometry.coordinate;if(_.isPolar&&_.isTransposed){var S=_c.getAngle(c.getModel(),_),k=S.startAngle,L=S.endAngle,R=(k+L)/2,U=t,G=U*Math.cos(R),Q=U*Math.sin(R);c.shape.setMatrix(Ox([["t",G,Q]])),g.setMatrix(Ox([["t",G,Q]]))}})},e.prototype.active=function(){this.transfrom()},e.prototype.reset=function(){this.transfrom(0)},e}(oi);function MI(r){var e=r.event,t,i=e.target;return i&&(t=i.get("element")),t}var II=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getAnnotations=function(t){var i=t||this.context.view;return i.getController("annotation").option},e.prototype.getInitialAnnotation=function(){return this.initialAnnotation},e.prototype.init=function(){var t=this,i=this.context.view;i.removeInteraction("tooltip"),i.on("afterchangesize",function(){var u=t.getAnnotations(i);t.initialAnnotation=u})},e.prototype.change=function(t){var i=this.context,u=i.view,c=i.event;this.initialAnnotation||(this.initialAnnotation=this.getAnnotations());var p=(0,b.U2)(c,["data","data"]);if(c.type.match("legend-item")){var g=_c.getDelegationObject(this.context),_=u.getGroupedFields()[0];if(g&&_){var S=g.item;p=u.getData().find(function(U){return U[_]===S.value})}}if(p){var k=(0,b.U2)(t,"annotations",[]),L=(0,b.U2)(t,"statistic",{});u.getController("annotation").clear(!0),(0,b.S6)(k,function(U){typeof U=="object"&&u.annotation()[U.type](U)}),Iy(u,{statistic:L,plotType:"pie"},p),u.render(!0)}var R=MI(this.context);R&&R.shape.toFront()},e.prototype.reset=function(){var t=this.context.view,i=t.getController("annotation");i.clear(!0);var u=this.getInitialAnnotation();(0,b.S6)(u,function(c){t.annotation()[c.type](c)}),t.render(!0)},e}(oi),oS="pie-statistic";Yn(oS,II),kn("pie-statistic-active",{start:[{trigger:"element:mouseenter",action:"pie-statistic:change"}],end:[{trigger:"element:mouseleave",action:"pie-statistic:reset"}]}),Yn("pie-legend",aS),kn("pie-legend-active",{start:[{trigger:"legend-item:mouseenter",action:"pie-legend:active"}],end:[{trigger:"legend-item:mouseleave",action:"pie-legend:reset"}]});function kI(r,e){var t=null;return(0,b.S6)(r,function(i){typeof i[e]=="number"&&(t+=i[e])}),t}function sS(r,e){var t;switch(r){case"inner":return t="-30%",(0,b.HD)(e)&&e.endsWith("%")?parseFloat(e)*.01>0?t:e:e<0?e:t;case"outer":return t=12,(0,b.HD)(e)&&e.endsWith("%")?parseFloat(e)*.01<0?t:e:e>0?e:t;default:return e}}function hm(r,e){return(0,b.yW)(pg(r,e),function(t){return t[e]===0})}function LI(r){var e=r.chart,t=r.options,i=t.data,u=t.angleField,c=t.colorField,p=t.color,g=t.pieStyle,_=t.shape,S=pg(i,u);if(hm(S,u)){var k="$$percentage$$";S=S.map(function(R){var U;return(0,P.pi)((0,P.pi)({},R),(U={},U[k]=1/S.length,U))}),e.data(S);var L=hn({},r,{options:{xField:"1",yField:k,seriesField:c,isStack:!0,interval:{color:p,shape:_,style:g},args:{zIndexReversed:!0,sortZIndex:!0}}});ac(L)}else{e.data(S);var L=hn({},r,{options:{xField:"1",yField:u,seriesField:c,isStack:!0,interval:{color:p,shape:_,style:g},args:{zIndexReversed:!0,sortZIndex:!0}}});ac(L)}return r}function PI(r){var e,t=r.chart,i=r.options,u=i.meta,c=i.colorField,p=hn({},u);return t.scale(p,(e={},e[c]={type:"cat"},e)),r}function OI(r){var e=r.chart,t=r.options,i=t.radius,u=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"theta",cfg:{radius:i,innerRadius:u,startAngle:c,endAngle:p}}),r}function FI(r){var e=r.chart,t=r.options,i=t.label,u=t.colorField,c=t.angleField,p=e.geometries[0];if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]),S=Os(_);if(S.content){var k=S.content;S.content=function(G,Q,pt){var yt=G[u],Ht=G[c],ce=e.getScaleByField(c),he=ce==null?void 0:ce.scale(Ht);return(0,b.mf)(k)?k((0,P.pi)((0,P.pi)({},G),{percent:he}),Q,pt):(0,b.HD)(k)?Sw(k,{value:Ht,name:yt,percentage:(0,b.hj)(he)&&!(0,b.UM)(Ht)?(he*100).toFixed(2)+"%":null}):k}}var L={inner:"",outer:"pie-outer",spider:"pie-spider"},R=S.type?L[S.type]:"pie-outer",U=S.layout?(0,b.kJ)(S.layout)?S.layout:[S.layout]:[];S.layout=(R?[{type:R}]:[]).concat(U),p.label({fields:u?[c,u]:[c],callback:g,cfg:(0,P.pi)((0,P.pi)({},S),{offset:sS(S.type,S.offset),type:"pie"})})}return r}function uS(r){var e=r.innerRadius,t=r.statistic,i=r.angleField,u=r.colorField,c=r.meta,p=r.locale,g=yx(p);if(e&&t){var _=hn({},iS.statistic,t),S=_.title,k=_.content;return S!==!1&&(S=hn({},{formatter:function(L){var R=L?L[u]:(0,b.UM)(S.content)?g.get(["statistic","total"]):S.content,U=(0,b.U2)(c,[u,"formatter"])||function(G){return G};return U(R)}},S)),k!==!1&&(k=hn({},{formatter:function(L,R){var U=L?L[i]:kI(R,i),G=(0,b.U2)(c,[i,"formatter"])||function(Q){return Q};return L||(0,b.UM)(k.content)?G(U):k.content}},k)),hn({},{statistic:{title:S,content:k}},r)}return r}function lS(r){var e=r.chart,t=r.options,i=uS(t),u=i.innerRadius,c=i.statistic;return e.getController("annotation").clear(!0),Ga(Ys())(r),u&&c&&Iy(e,{statistic:c,plotType:"pie"}),r}function RI(r){var e=r.chart,t=r.options,i=t.tooltip,u=t.colorField,c=t.angleField,p=t.data;if(i===!1)e.tooltip(i);else if(e.tooltip(hn({},i,{shared:!1})),hm(p,c)){var g=(0,b.U2)(i,"fields"),_=(0,b.U2)(i,"formatter");(0,b.xb)((0,b.U2)(i,"fields"))&&(g=[u,c],_=_||function(S){return{name:S[u],value:(0,b.BB)(S[c])}}),e.geometries[0].tooltip(g.join("*"),Uh(g,_))}return r}function DI(r){var e=r.chart,t=r.options,i=uS(t),u=i.interactions,c=i.statistic,p=i.annotations;return(0,b.S6)(u,function(g){var _,S;if(g.enable===!1)e.removeInteraction(g.type);else if(g.type==="pie-statistic-active"){var k=[];!((_=g.cfg)===null||_===void 0)&&_.start||(k=[{trigger:"element:mouseenter",action:oS+":change",arg:{statistic:c,annotations:p}}]),(0,b.S6)((S=g.cfg)===null||S===void 0?void 0:S.start,function(L){k.push((0,P.pi)((0,P.pi)({},L),{arg:{statistic:c,annotations:p}}))}),e.interaction(g.type,hn({},g.cfg,{start:k}))}else e.interaction(g.type,g.cfg||{})}),r}function cS(r){return Ga(Nh("pieStyle"),LI,PI,Bo,OI,vg,RI,FI,w0,lS,DI,ms)(r)}var Fx=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="pie",t}return e.getDefaultOptions=function(){return iS},e.prototype.changeData=function(t){this.chart.emit(It.BEFORE_CHANGE_DATA,pe.fromData(this.chart,It.BEFORE_CHANGE_DATA,null));var i=this.options,u=this.options.angleField,c=pg(i.data,u),p=pg(t,u);hm(c,u)||hm(p,u)?this.update({data:t}):(this.updateOption({data:t}),this.chart.data(p),lS({chart:this.chart,options:this.options}),this.chart.render(!0)),this.chart.emit(It.AFTER_CHANGE_DATA,pe.fromData(this.chart,It.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return cS},e}(Ha),fS=["#FAAD14","#E8EDF3"],BI={percent:.2,color:fS,animation:{}};function Rx(r){var e=(0,b.uZ)(b0(r)?r:0,0,1);return[{current:""+e,type:"current",percent:e},{current:""+e,type:"target",percent:1}]}function Dx(r){var e=r.chart,t=r.options,i=t.percent,u=t.progressStyle,c=t.color,p=t.barWidthRatio;e.data(Rx(i));var g=hn({},r,{options:{xField:"current",yField:"percent",seriesField:"type",widthRatio:p,interval:{style:u,color:(0,b.HD)(c)?[c,fS[1]]:c},args:{zIndexReversed:!0,sortZIndex:!0}}});return ac(g),e.tooltip(!1),e.axis(!1),e.legend(!1),r}function NI(r){var e=r.chart;return e.coordinate("rect").transpose(),r}function hS(r){return Ga(Dx,Zs({}),NI,ms,Bo,Ys())(r)}var pS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="process",t}return e.getDefaultOptions=function(){return BI},e.prototype.changeData=function(t){this.updateOption({percent:t}),this.chart.changeData(Rx(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return hS},e}(Ha);function dS(r){var e=r.chart,t=r.options,i=t.innerRadius,u=t.radius;return e.coordinate("theta",{innerRadius:i,radius:u}),r}function vS(r,e){var t=r.chart,i=r.options,u=i.innerRadius,c=i.statistic,p=i.percent,g=i.meta;if(t.getController("annotation").clear(!0),u&&c){var _=(0,b.U2)(g,["percent","formatter"])||function(k){return(k*100).toFixed(2)+"%"},S=c.content;S&&(S=hn({},S,{content:(0,b.UM)(S.content)?_(p):S.content})),Iy(t,{statistic:(0,P.pi)((0,P.pi)({},c),{content:S}),plotType:"ring-progress"},{percent:p})}return e&&t.render(!0),r}function Bx(r){return Ga(Dx,Zs({}),dS,vS,ms,Bo,Ys())(r)}var gS={percent:.2,innerRadius:.8,radius:.98,color:["#FAAD14","#E8EDF3"],statistic:{title:!1,content:{style:{fontSize:"14px",fontWeight:300,fill:"#4D4D4D",textAlign:"center",textBaseline:"middle"}}},animation:{}},mS=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="ring-process",t}return e.getDefaultOptions=function(){return gS},e.prototype.changeData=function(t){this.chart.emit(It.BEFORE_CHANGE_DATA,pe.fromData(this.chart,It.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(Rx(t)),vS({chart:this.chart,options:this.options},!0),this.chart.emit(It.AFTER_CHANGE_DATA,pe.fromData(this.chart,It.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Bx},e}(Ha),Xv=ot(56645),zI={exp:Xv.regressionExp,linear:Xv.regressionLinear,loess:Xv.regressionLoess,log:Xv.regressionLog,poly:Xv.regressionPoly,pow:Xv.regressionPow,quad:Xv.regressionQuad};function UI(r,e){var t=10,i={regionStyle:[{position:{start:[r,"max"],end:["max",e]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:["min","max"],end:[r,e]},style:{fill:"#a3dda1",opacity:.4}},{position:{start:["min",e],end:[r,"min"]},style:{fill:"#d8d0c0",opacity:.4}},{position:{start:[r,e],end:["max","min"]},style:{fill:"#a3dda1",opacity:.4}}],lineStyle:{stroke:"#9ba29a",lineWidth:1},labelStyle:[{position:["max",e],offsetX:-t,offsetY:-t,style:{textAlign:"right",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",e],offsetX:t,offsetY:-t,style:{textAlign:"left",textBaseline:"bottom",fontSize:14,fill:"#ccc"}},{position:["min",e],offsetX:t,offsetY:t,style:{textAlign:"left",textBaseline:"top",fontSize:14,fill:"#ccc"}},{position:["max",e],offsetX:-t,offsetY:t,style:{textAlign:"right",textBaseline:"top",fontSize:14,fill:"#ccc"}}]};return i}var yS=function(r,e){var t=e.view,i=e.options,u=i.xField,c=i.yField,p=t.getScaleByField(u),g=t.getScaleByField(c),_=r.map(function(S){return t.getCoordinate().convert({x:p.scale(S[0]),y:g.scale(S[1])})});return v5(_,!1)},_S=function(r){var e=r.options,t=e.xField,i=e.yField,u=e.data,c=e.regressionLine,p=c.type,g=p===void 0?"linear":p,_=c.algorithm,S;if(_)S=(0,b.kJ)(_)?_:_(u);else{var k=zI[g]().x(function(L){return L[t]}).y(function(L){return L[i]});S=k(u)}return yS(S,r)},ZI=function(r){var e,t=r.meta,i=t===void 0?{}:t,u=r.xField,c=r.yField,p=r.data,g=p[0][u],_=p[0][c],S=g>0,k=_>0;function L(R,U){var G=(0,b.U2)(i,[R]);function Q(yt){return(0,b.U2)(G,yt)}var pt={};return U==="x"?((0,b.hj)(g)&&((0,b.hj)(Q("min"))||(pt.min=S?0:g*2),(0,b.hj)(Q("max"))||(pt.max=S?g*2:0)),pt):((0,b.hj)(_)&&((0,b.hj)(Q("min"))||(pt.min=k?0:_*2),(0,b.hj)(Q("max"))||(pt.max=k?_*2:0)),pt)}return(0,P.pi)((0,P.pi)({},i),(e={},e[u]=(0,P.pi)((0,P.pi)({},i[u]),L(u,"x")),e[c]=(0,P.pi)((0,P.pi)({},i[c]),L(c,"y")),e))};function xS(r){var e=r.data,t=e===void 0?[]:e,i=r.xField,u=r.yField;if(t.length){for(var c=!0,p=!0,g=t[0],_=void 0,S=1;S<t.length&&(_=t[S],g[i]!==_[i]&&(c=!1),g[u]!==_[u]&&(p=!1),!(!c&&!p));S++)g=_;var k=[];c&&k.push(i),p&&k.push(u);var L=fs(ZI(r),k);return hn({},r,{meta:L})}return r}function bS(r){var e=r.chart,t=r.options,i=t.data,u=t.type,c=t.color,p=t.shape,g=t.pointStyle,_=t.shapeField,S=t.colorField,k=t.xField,L=t.yField,R=t.sizeField,U=t.size,G=t.tooltip;R&&(U||(U=[2,8]),(0,b.hj)(U)&&(U=[U,U])),G&&!G.fields&&(G=(0,P.pi)((0,P.pi)({},G),{fields:[k,L,S,R,_]})),e.data(i),Bf(hn({},r,{options:{seriesField:S,point:{color:c,shape:p,size:U,style:g},tooltip:G}}));var Q=Ec(e,"point");return u&&Q.adjust(u),r}function Vy(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField,g=xS(t);return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(hn({},r,{options:g}))}function VI(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return e.axis(c,i),e.axis(p,u),r}function ES(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField,c=t.shapeField,p=t.sizeField,g=t.shapeLegend,_=t.sizeLegend,S=i!==!1;return u&&e.legend(u,S?i:!1),c&&(g?e.legend(c,g):e.legend(c,g===!1?!1:i)),p&&e.legend(p,_||!1),!S&&!g&&!_&&e.legend(!1),r}function wS(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"point");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:Os(g)})}return r}function SS(r){var e=r.options,t=e.quadrant,i=[];if(t){var u=t.xBaseline,c=u===void 0?0:u,p=t.yBaseline,g=p===void 0?0:p,_=t.labels,S=t.regionStyle,k=t.lineStyle,L=UI(c,g),R=new Array(4).join(",").split(",");R.forEach(function(U,G){i.push((0,P.pi)((0,P.pi)({type:"region",top:!1},L.regionStyle[G].position),{style:hn({},L.regionStyle[G].style,S==null?void 0:S[G])}),(0,P.pi)({type:"text",top:!0},hn({},L.labelStyle[G],_==null?void 0:_[G])))}),i.push({type:"line",top:!1,start:["min",g],end:["max",g],style:hn({},L.lineStyle,k)},{type:"line",top:!1,start:[c,"min"],end:[c,"max"],style:hn({},L.lineStyle,k)})}return Ga(Ys(i))(r)}function CS(r){var e=r.options,t=r.chart,i=e.regressionLine;if(i){var u=i.style,c=i.top,p=c===void 0?!1:c,g={stroke:"#9ba29a",lineWidth:2,opacity:.5};t.annotation().shape({top:p,render:function(_,S){var k=_.addGroup({id:t.id+"-regression-line",name:"regression-line-group"}),L=_S({view:S,options:e});k.addShape("path",{name:"regression-line",attrs:(0,P.pi)((0,P.pi)({path:L},g),u)})}})}return r}function GI(r){var e=r.chart,t=r.options,i=t.tooltip;return i?e.tooltip(i):i===!1&&e.tooltip(!1),r}function AS(r){return Ga(bS,Vy,VI,ES,GI,wS,Nw,Vu,ad,Xs,SS,ms,Bo,CS)(r)}var TS=hn({},Ha.getDefaultOptions(),{size:4,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!0,crosshairs:{type:"xy"}}});kn("drag-move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});var HI=function(r){(0,P.ZT)(e,r);function e(t,i){var u=r.call(this,t,i)||this;return u.type="scatter",u.on(It.BEFORE_RENDER,function(c){var p,g,_=u,S=_.options,k=_.chart;if(((p=c.data)===null||p===void 0?void 0:p.source)===Bc.FILTER){var L=u.chart.filterData(u.chart.getData());Vy({chart:k,options:(0,P.pi)((0,P.pi)({},S),{data:L})})}((g=c.data)===null||g===void 0?void 0:g.source)===Bc.RESET&&Vy({chart:k,options:S})}),u}return e.getDefaultOptions=function(){return TS},e.prototype.changeData=function(t){this.updateOption(xS(hn({},this.options,{data:t})));var i=this,u=i.options,c=i.chart;Vy({chart:c,options:u}),this.chart.changeData(t)},e.prototype.getSchemaAdaptor=function(){return AS},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),pm="$$stock-range$$",dm="trend",Nx="up",zx="down",MS={showMarkers:!1,showCrosshairs:!0,shared:!0,crosshairs:{type:"xy",follow:!0,text:function(r,e,t){var i;if(r==="x"){var u=t[0];i=u?u.title:e}else i=e;return{position:r==="y"?"start":"end",content:i,style:{fill:"#dfdfdf"}}},textBackground:{padding:[2,4],style:{fill:"#666"}}}},IS=hn({},Ha.getDefaultOptions(),{tooltip:MS,interactions:[{type:"tooltip"}],legend:{position:"top-left"},risingFill:"#ef5350",fallingFill:"#26a69a"});function kS(r,e){return(0,b.UI)(r,function(t){var i=t&&(0,P.pi)({},t);if((0,b.kJ)(e)&&i){var u=e[0],c=e[1],p=e[2],g=e[3];i[dm]=i[u]<=i[c]?Nx:zx,i[pm]=[i[u],i[c],i[p],i[g]]}return i})}function jI(r){var e=r.chart,t=r.options,i=t.yField,u=t.data,c=t.risingFill,p=t.fallingFill,g=t.tooltip,_=t.stockStyle;e.data(kS(u,i));var S=g;return S!==!1&&(S=hn({},{fields:i},S)),mg(hn({},r,{options:{schema:{shape:"candle",color:[c,p],style:_},yField:pm,seriesField:dm,rawFields:i,tooltip:S}})),r}function WI(r){var e,t,i=r.chart,u=r.options,c=u.meta,p=u.xAxis,g=u.yAxis,_=u.xField,S=(e={},e[_]={type:"timeCat",tickCount:6},e[dm]={values:[Nx,zx]},e),k=hn(S,c,(t={},t[_]=fs(p,Rf),t[pm]=fs(g,Rf),t));return i.scale(k),r}function XI(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(pm,!1):e.axis(pm,u),r}function YI(r){var e=r.chart,t=r.options,i=t.tooltip;return i!==!1?e.tooltip(i):e.tooltip(!1),r}function $I(r){var e=r.chart,t=r.options,i=t.legend;return i?e.legend(dm,i):i===!1&&e.legend(!1),r}function LS(r){Ga(Bo,jI,WI,XI,YI,$I,Xs,ms,Ys(),Vu)(r)}var qI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="stock",t}return e.getDefaultOptions=function(){return IS},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return LS},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options.yField;this.chart.changeData(kS(t,i))},e}(Ha);function I0(r){return(0,b.UI)(r||[],function(e,t){return{x:""+t,y:e}})}var vm="x",k0="y",PS={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(r,e){return""+(0,b.U2)(e,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}},showCrosshairs:!0,crosshairs:{type:"x"}},KI={appendPadding:2,tooltip:(0,P.pi)({},PS),animation:{}};function Gy(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.areaStyle,p=t.point,g=t.line,_=p==null?void 0:p.state,S=I0(i);e.data(S);var k=hn({},r,{options:{xField:vm,yField:k0,area:{color:u,style:c},line:g,point:p}}),L=hn({},k,{options:{tooltip:!1}}),R=hn({},k,{options:{tooltip:!1,state:_}});return Gv(k),C0(L),Bf(R),e.axis(!1),e.legend(!1),r}function Sg(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.data,g=I0(p);return Ga(Zs((e={},e[vm]=u,e[k0]=c,e),(t={},t[vm]={type:"cat"},t[k0]=ix(g,k0),t)))(r)}function OS(r){return Ga(Nh("areaStyle"),Gy,Sg,hl,Bo,ms,Ys())(r)}var QI={appendPadding:2,tooltip:(0,P.pi)({},PS),color:"l(90) 0:#E5EDFE 1:#ffffff",areaStyle:{fillOpacity:.6},line:{size:1,color:"#5B8FF9"},animation:{}},JI=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-area",t}return e.getDefaultOptions=function(){return QI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;Sg({chart:u,options:c}),u.changeData(I0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return OS},e}(Ha);function tk(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.columnStyle,p=t.columnWidthRatio,g=I0(i);e.data(g);var _=hn({},r,{options:{xField:vm,yField:k0,widthRatio:p,interval:{style:c,color:u}}});return ac(_),e.axis(!1),e.legend(!1),e.interaction("element-active"),r}function FS(r){return Ga(Bo,Nh("columnStyle"),tk,Sg,hl,ms,Ys())(r)}var ek={showTitle:!1,shared:!0,showMarkers:!1,customContent:function(r,e){return""+(0,b.U2)(e,[0,"data","y"],0)},containerTpl:'<div class="g2-tooltip"><div class="g2-tooltip-list"></div></div>',itemTpl:"<span>{value}</span>",domStyles:{"g2-tooltip":{padding:"2px 4px",fontSize:"10px"}}},rk={appendPadding:2,tooltip:(0,P.pi)({},ek),animation:{}},nk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-column",t}return e.getDefaultOptions=function(){return rk},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;Sg({chart:u,options:c}),u.changeData(I0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return FS},e}(Ha);function ik(r){var e=r.chart,t=r.options,i=t.data,u=t.color,c=t.lineStyle,p=t.point,g=p==null?void 0:p.state,_=I0(i);e.data(_);var S=hn({},r,{options:{xField:vm,yField:k0,line:{color:u,style:c},point:p}}),k=hn({},S,{options:{tooltip:!1,state:g}});return C0(S),Bf(k),e.axis(!1),e.legend(!1),r}function RS(r){return Ga(ik,Sg,Bo,hl,ms,Ys())(r)}var ak=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="tiny-line",t}return e.getDefaultOptions=function(){return KI},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this,u=i.chart,c=i.options;Sg({chart:u,options:c}),u.changeData(I0(t))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return RS},e}(Ha),ok={line:E5,pie:cS,column:By,bar:Uw,area:Dw,gauge:Jw,"tiny-line":RS,"tiny-column":FS,"tiny-area":OS,"ring-progress":Bx,progress:hS,scatter:AS,histogram:nS,funnel:Xw,stock:LS},sk={line:AI,pie:Fx,column:Vw,bar:Zw,area:w5,gauge:_I,"tiny-line":ak,"tiny-column":nk,"tiny-area":JI,"ring-progress":mS,progress:pS,scatter:HI,histogram:wI,funnel:fI,stock:qI},uk={pie:{label:!1},column:{tooltip:{showMarkers:!1}},bar:{tooltip:{showMarkers:!1}}};function Ux(r,e,t){var i=sk[r];if(!i){console.error("could not find "+r+" plot");return}var u=ok[r];u({chart:e,options:hn({},i.getDefaultOptions(),(0,b.U2)(uk,r,{}),t)})}function lk(r){var e=r.chart,t=r.options,i=t.views,u=t.legend;return(0,b.S6)(i,function(c){var p=c.region,g=c.data,_=c.meta,S=c.axes,k=c.coordinate,L=c.interactions,R=c.annotations,U=c.tooltip,G=c.geometries,Q=e.createView({region:p});Q.data(g);var pt={};S&&(0,b.S6)(S,function(yt,Ht){pt[Ht]=fs(yt,Rf)}),pt=hn({},_,pt),Q.scale(pt),S?(0,b.S6)(S,function(yt,Ht){Q.axis(Ht,yt)}):Q.axis(!1),Q.coordinate(k),(0,b.S6)(G,function(yt){var Ht=Fl({chart:Q,options:yt}).ext,ce=yt.adjust;ce&&Ht.geometry.adjust(ce)}),(0,b.S6)(L,function(yt){yt.enable===!1?Q.removeInteraction(yt.type):Q.interaction(yt.type,yt.cfg)}),(0,b.S6)(R,function(yt){Q.annotation()[yt.type]((0,P.pi)({},yt))}),typeof c.animation=="boolean"?Q.animate(!1):(Q.animate(!0),(0,b.S6)(Q.geometries,function(yt){yt.animate(c.animation)})),U&&(Q.interaction("tooltip"),Q.tooltip(U))}),u?(0,b.S6)(u,function(c,p){e.legend(p,c)}):e.legend(!1),e.tooltip(t.tooltip),r}function ck(r){var e=r.chart,t=r.options,i=t.plots,u=t.data,c=u===void 0?[]:u;return(0,b.S6)(i,function(p){var g=p.type,_=p.region,S=p.options,k=S===void 0?{}:S,L=p.top,R=k.tooltip;if(L){Ux(g,e,(0,P.pi)((0,P.pi)({},k),{data:c}));return}var U=e.createView((0,P.pi)({region:_},fs(k,Ow)));R&&U.interaction("tooltip"),Ux(g,U,(0,P.pi)({data:c},k))}),r}function fk(r){var e=r.chart,t=r.options;return e.option("slider",t.slider),r}function hk(r){return Ga(ms,lk,ck,Xs,ms,Bo,hl,fk,Ys())(r)}function pk(r,e){var t=r.getModel(),i=t.data,u;return(0,b.kJ)(i)?u=i[0][e]:u=i[e],u}function dk(r){var e=Zv(r);(0,b.S6)(e,function(t){t.hasState("active")&&t.setState("active",!1),t.hasState("selected")&&t.setState("selected",!1),t.hasState("inactive")&&t.setState("inactive",!1)})}var vk=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getAssociationItems=function(t,i){var u,c=this.context.event,p=i||{},g=p.linkField,_=p.dim,S=[];if(!((u=c.data)===null||u===void 0)&&u.data){var k=c.data.data;(0,b.S6)(t,function(L){var R,U,G=g;if(_==="x"?G=L.getXScale().field:_==="y"?G=(R=L.getYScales().find(function(pt){return pt.field===G}))===null||R===void 0?void 0:R.field:G||(G=(U=L.getGroupScales()[0])===null||U===void 0?void 0:U.field),!!G){var Q=(0,b.UI)(Zv(L),function(pt){var yt=!1,Ht=!1,ce=(0,b.kJ)(k)?(0,b.U2)(k[0],G):(0,b.U2)(k,G);return pk(pt,G)===ce?yt=!0:Ht=!0,{element:pt,view:L,active:yt,inactive:Ht}});S.push.apply(S,Q)}})}return S},e.prototype.showTooltip=function(t){var i=fx(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){if(c.active){var p=c.element.shape.getCanvasBBox();c.view.showTooltip({x:p.minX+p.width/2,y:p.minY+p.height/2})}})},e.prototype.hideTooltip=function(){var t=fx(this.context.view);(0,b.S6)(t,function(i){i.hideTooltip()})},e.prototype.active=function(t){var i=um(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){var p=c.active,g=c.element;p&&g.setState("active",!0)})},e.prototype.selected=function(t){var i=um(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){var p=c.active,g=c.element;p&&g.setState("selected",!0)})},e.prototype.highlight=function(t){var i=um(this.context.view),u=this.getAssociationItems(i,t);(0,b.S6)(u,function(c){var p=c.inactive,g=c.element;p&&g.setState("inactive",!0)})},e.prototype.reset=function(){var t=um(this.context.view);(0,b.S6)(t,function(i){dk(i)})},e}(oi);Yn("association",vk),kn("association-active",{start:[{trigger:"element:mouseenter",action:"association:active"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),kn("association-selected",{start:[{trigger:"element:mouseenter",action:"association:selected"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),kn("association-highlight",{start:[{trigger:"element:mouseenter",action:"association:highlight"}],end:[{trigger:"element:mouseleave",action:"association:reset"}]}),kn("association-tooltip",{start:[{trigger:"element:mousemove",action:"association:showTooltip"}],end:[{trigger:"element:mouseleave",action:"association:hideTooltip"}]});var gk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="mix",t}return e.prototype.getSchemaAdaptor=function(){return hk},e}(Ha),Cg;(function(r){r.DEV="DEV",r.BETA="BETA",r.STABLE="STABLE"})(Cg||(Cg={}));function mk(r,e){console.warn(r===Cg.DEV?"Plot '"+e+"' is in DEV stage, just give us issues.":r===Cg.BETA?"Plot '"+e+"' is in BETA stage, DO NOT use it in production env.":r===Cg.STABLE?"Plot '"+e+`' is in STABLE stage, import it by "import { `+e+` } from '@antv/g2plot'".`:"invalid Stage type.")}var $O=function(){function r(){}return Object.defineProperty(r,"MultiView",{get:function(){return mk(Cg.STABLE,"MultiView"),gk},enumerable:!1,configurable:!0}),r}(),od="first-axes-view",sd="second-axes-view",L0="series-field-key";function DS(r,e,t,i,u){var c=[];e.forEach(function(L){i.forEach(function(R){var U,G=(U={},U[r]=R[r],U[t]=L,U[L]=R[L],U);c.push(G)})});var p=Object.values((0,b.vM)(c,t)),g=p[0],_=g===void 0?[]:g,S=p[1],k=S===void 0?[]:S;return u?[_.reverse(),k.reverse()]:[_,k]}function Jd(r){return r!=="vertical"}function yk(r,e,t){var i=e[0],u=e[1],c=i.autoPadding,p=u.autoPadding,g=r.__axisPosition,_=g.layout,S=g.position;if(Jd(_)&&S==="top"&&(i.autoPadding=t.instance(c.top,0,c.bottom,c.left),u.autoPadding=t.instance(p.top,c.left,p.bottom,0)),Jd(_)&&S==="bottom"&&(i.autoPadding=t.instance(c.top,c.right/2+5,c.bottom,c.left),u.autoPadding=t.instance(p.top,p.right,p.bottom,c.right/2+5)),!Jd(_)&&S==="bottom"){var k=c.left>=p.left?c.left:p.left;i.autoPadding=t.instance(c.top,c.right,c.bottom/2+5,k),u.autoPadding=t.instance(c.bottom/2+5,p.right,p.bottom,k)}if(!Jd(_)&&S==="top"){var k=c.left>=p.left?c.left:p.left;i.autoPadding=t.instance(c.top,c.right,0,k),u.autoPadding=t.instance(0,p.right,c.top,k)}}function _k(r){var e=r.chart,t=r.options,i=t.data,u=t.xField,c=t.yField,p=t.color,g=t.barStyle,_=t.widthRatio,S=t.legend,k=t.layout,L=DS(u,c,L0,i,Jd(k));S?e.legend(L0,S):S===!1&&e.legend(!1);var R,U,G=L[0],Q=L[1];Jd(k)?(R=e.createView({region:{start:{x:0,y:0},end:{x:.5,y:1}},id:od}),R.coordinate().transpose().reflect("x"),U=e.createView({region:{start:{x:.5,y:0},end:{x:1,y:1}},id:sd}),U.coordinate().transpose(),R.data(G),U.data(Q)):(R=e.createView({region:{start:{x:0,y:0},end:{x:1,y:.5}},id:od}),U=e.createView({region:{start:{x:0,y:.5},end:{x:1,y:1}},id:sd}),U.coordinate().reflect("y"),R.data(G),U.data(Q));var pt=hn({},r,{chart:R,options:{widthRatio:_,xField:u,yField:c[0],seriesField:L0,interval:{color:p,style:g}}});ac(pt);var yt=hn({},r,{chart:U,options:{xField:u,yField:c[1],seriesField:L0,widthRatio:_,interval:{color:p,style:g}}});return ac(yt),r}function xk(r){var e,t,i,u=r.options,c=r.chart,p=u.xAxis,g=u.yAxis,_=u.xField,S=u.yField,k=yo(c,od),L=yo(c,sd),R={};return(0,b.XP)((u==null?void 0:u.meta)||{}).map(function(U){(0,b.U2)(u==null?void 0:u.meta,[U,"alias"])&&(R[U]=u.meta[U].alias)}),c.scale((e={},e[L0]={sync:!0,formatter:function(U){return(0,b.U2)(R,U,U)}},e)),Zs((t={},t[_]=p,t[S[0]]=g[S[0]],t))(hn({},r,{chart:k})),Zs((i={},i[_]=p,i[S[1]]=g[S[1]],i))(hn({},r,{chart:L})),r}function bk(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField,g=t.layout,_=yo(e,od),S=yo(e,sd);return(i==null?void 0:i.position)==="bottom"?S.axis(c,(0,P.pi)((0,P.pi)({},i),{label:{formatter:function(){return""}}})):S.axis(c,!1),i===!1?_.axis(c,!1):_.axis(c,(0,P.pi)({position:Jd(g)?"top":"bottom"},i)),u===!1?(_.axis(p[0],!1),S.axis(p[1],!1)):(_.axis(p[0],u[p[0]]),S.axis(p[1],u[p[1]])),e.__axisPosition={position:_.getOptions().axes[c].position,layout:g},r}function Ek(r){var e=r.chart;return Xs(hn({},r,{chart:yo(e,od)})),Xs(hn({},r,{chart:yo(e,sd)})),r}function Zx(r){var e=r.chart,t=r.options,i=t.yField,u=t.yAxis;return Df(hn({},r,{chart:yo(e,od),options:{yAxis:u[i[0]]}})),Df(hn({},r,{chart:yo(e,sd),options:{yAxis:u[i[1]]}})),r}function wk(r){var e=r.chart;return Bo(hn({},r,{chart:yo(e,od)})),Bo(hn({},r,{chart:yo(e,sd)})),Bo(r),r}function Sk(r){var e=r.chart;return ms(hn({},r,{chart:yo(e,od)})),ms(hn({},r,{chart:yo(e,sd)})),r}function Ck(r){var e=this,t,i,u=r.chart,c=r.options,p=c.label,g=c.yField,_=c.layout,S=yo(u,od),k=yo(u,sd),L=Ec(S,"interval"),R=Ec(k,"interval");if(!p)L.label(!1),R.label(!1);else{var U=p.callback,G=(0,P._T)(p,["callback"]);G.position||(G.position="middle"),G.offset===void 0&&(G.offset=2);var Q=(0,P.pi)({},G);if(Jd(_)){var pt=((t=Q.style)===null||t===void 0?void 0:t.textAlign)||(G.position==="middle"?"center":"left");G.style=hn({},G.style,{textAlign:pt});var yt={left:"right",right:"left",center:"center"};Q.style=hn({},Q.style,{textAlign:yt[pt]})}else{var Ht={top:"bottom",bottom:"top",middle:"middle"};typeof G.position=="string"?G.position=Ht[G.position]:typeof G.position=="function"&&(G.position=function(){for(var ze=[],Er=0;Er<arguments.length;Er++)ze[Er]=arguments[Er];return Ht[G.position.apply(e,ze)]});var ce=((i=Q.style)===null||i===void 0?void 0:i.textBaseline)||"bottom";Q.style=hn({},Q.style,{textBaseline:ce});var he={top:"bottom",bottom:"top",middle:"middle"};G.style=hn({},G.style,{textBaseline:he[ce]})}L.label({fields:[g[0]],callback:U,cfg:Os(Q)}),R.label({fields:[g[1]],callback:U,cfg:Os(G)})}return r}function Ak(r){return Ga(_k,xk,bk,Zx,wk,Ck,hl,Ek,Sk)(r)}var qO=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bidirectional-bar",t}return e.getDefaultOptions=function(){return hn({},r.getDefaultOptions.call(this),{syncViewPadding:yk})},e.prototype.changeData=function(t){t===void 0&&(t=[]),this.chart.emit(It.BEFORE_CHANGE_DATA,pe.fromData(this.chart,It.BEFORE_CHANGE_DATA,null)),this.updateOption({data:t});var i=this.options,u=i.xField,c=i.yField,p=i.layout,g=DS(u,c,L0,t,Jd(p)),_=g[0],S=g[1],k=yo(this.chart,od),L=yo(this.chart,sd);k.data(_),L.data(S),this.chart.render(!0),this.chart.emit(It.AFTER_CHANGE_DATA,pe.fromData(this.chart,It.AFTER_CHANGE_DATA,null))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ak},e.SERIES_FIELD_KEY=L0,e}(Ha),Vx,Ag="$$range$$",Tk="low-q1-median-q3-high",Mk="$$y_outliers$$",Hy="outliers_view",BS=hn({},Ha.getDefaultOptions(),{meta:(Vx={},Vx[Ag]={min:0,alias:Tk},Vx),interactions:[{type:"active-region"}],tooltip:{showMarkers:!1,shared:!0},boxStyle:{lineWidth:1}}),Gx=function(r,e){var t=r;if(Array.isArray(e)){var i=e[0],u=e[1],c=e[2],p=e[3],g=e[4];t=(0,b.UI)(r,function(_){return _[Ag]=[_[i],_[u],_[c],_[p],_[g]],_})}return t};function NS(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.groupField,p=t.color,g=t.tooltip,_=t.boxStyle;e.data(Gx(t.data,u));var S=(0,b.kJ)(u)?Ag:u,k=u?(0,b.kJ)(u)?u:[u]:[],L=g;L!==!1&&(L=hn({},{fields:(0,b.kJ)(u)?u:[]},L));var R=mg(hn({},r,{options:{xField:i,yField:S,seriesField:c,tooltip:L,rawFields:k,label:!1,schema:{shape:"box",color:p,style:_}}})).ext;return c&&R.geometry.adjust("dodge"),r}function zS(r){var e=r.chart,t=r.options,i=t.xField,u=t.data,c=t.outliersField,p=t.outliersStyle,g=t.padding,_=t.label;if(!c)return r;var S=e.createView({padding:g,id:Hy}),k=u.reduce(function(L,R){var U=R[c];return U.forEach(function(G){var Q;return L.push((0,P.pi)((0,P.pi)({},R),(Q={},Q[c]=G,Q)))}),L},[]);return S.data(k),Bf({chart:S,options:{xField:i,yField:c,point:{shape:"circle",style:p},label:_}}),S.axis(!1),r}function jy(r){var e,t,i=r.chart,u=r.options,c=u.meta,p=u.xAxis,g=u.yAxis,_=u.xField,S=u.yField,k=u.outliersField,L=Array.isArray(S)?Ag:S,R={};if(k){var U=Mk;R=(e={},e[k]={sync:U,nice:!0},e[L]={sync:U,nice:!0},e)}var G=hn(R,c,(t={},t[_]=fs(p,Rf),t[L]=fs(g,Rf),t));return i.scale(G),r}function US(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField,g=Array.isArray(p)?Ag:p;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(Ag,!1):e.axis(g,u),r}function ZS(r){var e=r.chart,t=r.options,i=t.legend,u=t.groupField;return u?i?e.legend(u,i):e.legend(u,{position:"bottom"}):e.legend(!1),r}function Ik(r){return Ga(NS,zS,jy,US,ZS,hl,Ys(),Xs,ms,Bo)(r)}var kk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="box",t}return e.getDefaultOptions=function(){return BS},e.prototype.changeData=function(t){this.updateOption({data:t});var i=this.options.yField,u=this.chart.views.find(function(c){return c.id===Hy});u&&u.data(t),this.chart.changeData(Gx(t,i))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Ik},e}(Ha);function Hx(r,e,t){return r.length>1?e+"_"+t:""+e}function VS(r){var e=r.data,t=r.xField,i=r.measureField,u=r.rangeField,c=r.targetField,p=r.layout,g=[],_=[];e.forEach(function(L,R){var U=[L[u]].flat();U.sort(function(pt,yt){return pt-yt}),U.forEach(function(pt,yt){var Ht,ce=yt===0?pt:U[yt]-U[yt-1];g.push((Ht={rKey:u+"_"+yt},Ht[t]=t?L[t]:String(R),Ht[u]=ce,Ht))});var G=[L[i]].flat();G.forEach(function(pt,yt){var Ht;g.push((Ht={mKey:Hx(G,i,yt)},Ht[t]=t?L[t]:String(R),Ht[i]=pt,Ht))});var Q=[L[c]].flat();Q.forEach(function(pt,yt){var Ht;g.push((Ht={tKey:Hx(Q,c,yt)},Ht[t]=t?L[t]:String(R),Ht[c]=pt,Ht))}),_.push(L[u],L[i],L[c])});var S=Math.min.apply(Math,_.flat(1/0)),k=Math.max.apply(Math,_.flat(1/0));return S=S>0?0:S,p==="vertical"&&g.reverse(),{min:S,max:k,ds:g}}function jx(r){var e=r.chart,t=r.options,i=t.bulletStyle,u=t.targetField,c=t.rangeField,p=t.measureField,g=t.xField,_=t.color,S=t.layout,k=t.size,L=t.label,R=VS(t),U=R.min,G=R.max,Q=R.ds;e.data(Q);var pt=hn({},r,{options:{xField:g,yField:c,seriesField:"rKey",isStack:!0,label:(0,b.U2)(L,"range"),interval:{color:(0,b.U2)(_,"range"),style:(0,b.U2)(i,"range"),size:(0,b.U2)(k,"range")}}});ac(pt),e.geometries[0].tooltip(!1);var yt=hn({},r,{options:{xField:g,yField:p,seriesField:"mKey",isStack:!0,label:(0,b.U2)(L,"measure"),interval:{color:(0,b.U2)(_,"measure"),style:(0,b.U2)(i,"measure"),size:(0,b.U2)(k,"measure")}}});ac(yt);var Ht=hn({},r,{options:{xField:g,yField:u,seriesField:"tKey",label:(0,b.U2)(L,"target"),point:{color:(0,b.U2)(_,"target"),style:(0,b.U2)(i,"target"),size:(0,b.mf)((0,b.U2)(k,"target"))?function(ce){return(0,b.U2)(k,"target")(ce)/2}:(0,b.U2)(k,"target")/2,shape:S==="horizontal"?"line":"hyphen"}}});return Bf(Ht),S==="horizontal"&&e.coordinate().transpose(),(0,P.pi)((0,P.pi)({},r),{ext:{data:{min:U,max:G}}})}function Wx(r){var e,t,i=r.options,u=r.ext,c=i.xAxis,p=i.yAxis,g=i.targetField,_=i.rangeField,S=i.measureField,k=i.xField,L=u.data;return Ga(Zs((e={},e[k]=c,e[S]=p,e),(t={},t[S]={min:L==null?void 0:L.min,max:L==null?void 0:L.max,sync:!0},t[g]={sync:""+S},t[_]={sync:""+S},t)))(r)}function Lk(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.measureField,g=t.rangeField,_=t.targetField;return e.axis(""+g,!1),e.axis(""+_,!1),i===!1?e.axis(""+c,!1):e.axis(""+c,i),u===!1?e.axis(""+p,!1):e.axis(""+p,u),r}function GS(r){var e=r.chart,t=r.options,i=t.legend;return e.removeInteraction("legend-filter"),e.legend(i),e.legend("rKey",!1),e.legend("mKey",!1),e.legend("tKey",!1),r}function Pk(r){var e=r.chart,t=r.options,i=t.label,u=t.measureField,c=t.targetField,p=t.rangeField,g=e.geometries,_=g[0],S=g[1],k=g[2];return(0,b.U2)(i,"range")?_.label(""+p,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Os(i.range))):_.label(!1),(0,b.U2)(i,"measure")?S.label(""+u,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Os(i.measure))):S.label(!1),(0,b.U2)(i,"target")?k.label(""+c,(0,P.pi)({layout:[{type:"limit-in-plot"}]},Os(i.target))):k.label(!1),r}function KO(r){Ga(jx,Wx,Lk,GS,Bo,Pk,hl,Xs,ms)(r)}var Wy=hn({},Ha.getDefaultOptions(),{layout:"horizontal",size:{range:30,measure:20,target:20},xAxis:{tickLine:!1,line:null},bulletStyle:{range:{fillOpacity:.5}},label:{measure:{position:"right"}},tooltip:{showMarkers:!1}}),Ok=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="bullet",t}return e.getDefaultOptions=function(){return Wy},e.prototype.changeData=function(t){this.updateOption({data:t});var i=VS(this.options),u=i.min,c=i.max,p=i.ds;Wx({options:this.options,ext:{data:{min:u,max:c}},chart:this.chart}),this.chart.changeData(p)},e.prototype.getSchemaAdaptor=function(){return KO},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),HS={y:0,nodeWidthRatio:.05,weight:!1,nodePaddingRatio:.1,id:function(r){return r.id},source:function(r){return r.source},target:function(r){return r.target},sourceWeight:function(r){return r.value||1},targetWeight:function(r){return r.value||1},sortBy:null};function QO(r,e,t){(0,b.U5)(r,function(i,u){i.inEdges=e.filter(function(c){return""+t.target(c)==""+u}),i.outEdges=e.filter(function(c){return""+t.source(c)==""+u}),i.edges=i.outEdges.concat(i.inEdges),i.frequency=i.edges.length,i.value=0,i.inEdges.forEach(function(c){i.value+=t.targetWeight(c)}),i.outEdges.forEach(function(c){i.value+=t.sourceWeight(c)})})}function JO(r,e){var t={weight:function(u,c){return c.value-u.value},frequency:function(u,c){return c.frequency-u.frequency},id:function(u,c){return(""+e.id(u)).localeCompare(""+e.id(c))}},i=t[e.sortBy];!i&&(0,b.mf)(e.sortBy)&&(i=e.sortBy),i&&r.sort(i)}function Xx(r,e){var t=r.length;if(!t)throw new TypeError("Invalid nodes: it's empty!");if(e.weight){var i=e.nodePaddingRatio;if(i<0||i>=1)throw new TypeError("Invalid nodePaddingRatio: it must be in range [0, 1)!");var u=i/(2*t),c=e.nodeWidthRatio;if(c<=0||c>=1)throw new TypeError("Invalid nodeWidthRatio: it must be in range (0, 1)!");var p=0;r.forEach(function(_){p+=_.value}),r.forEach(function(_){_.weight=_.value/p,_.width=_.weight*(1-i),_.height=c}),r.forEach(function(_,S){for(var k=0,L=S-1;L>=0;L--)k+=r[L].width+2*u;var R=_.minX=u+k,U=_.maxX=_.minX+_.width,G=_.minY=e.y-c/2,Q=_.maxY=G+c;_.x=[R,U,U,R],_.y=[G,G,Q,Q]})}else{var g=1/t;r.forEach(function(_,S){_.x=(S+.5)*g,_.y=e.y})}return r}function Yx(r,e,t){if(t.weight){var i={};(0,b.U5)(r,function(u,c){i[c]=u.value}),e.forEach(function(u){var c=t.source(u),p=t.target(u),g=r[c],_=r[p];if(g&&_){var S=i[c],k=t.sourceWeight(u),L=g.minX+(g.value-S)/g.value*g.width,R=L+k/g.value*g.width;i[c]-=k;var U=i[p],G=t.targetWeight(u),Q=_.minX+(_.value-U)/_.value*_.width,pt=Q+G/_.value*_.width;i[p]-=G;var yt=t.y;u.x=[L,R,Q,pt],u.y=[yt,yt,yt,yt],u.source=g,u.target=_}})}else e.forEach(function(u){var c=r[t.source(u)],p=r[t.target(u)];c&&p&&(u.x=[c.x,p.x],u.y=[c.y,p.y],u.source=c,u.target=p)});return e}function $x(r){return(0,b.f0)({},HS,r)}function jS(r,e){var t=$x(r),i={},u=e.nodes,c=e.links;u.forEach(function(_){var S=t.id(_);i[S]=_}),QO(i,c,t),JO(u,t);var p=Xx(u,t),g=Yx(i,c,t);return{nodes:p,links:g}}var gm="x",Xy="y",Fk="name",Rk="source",Dk={nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.5,lineWidth:2},label:{fields:["x","name"],callback:function(r,e){var t=(r[0]+r[1])/2,i=t>.5?-4:4;return{offsetX:i,content:e}},labelEmit:!0,style:{fill:"#8c8c8c"}},tooltip:{showTitle:!1,showMarkers:!1,fields:["source","target","value","isNode"],showContent:function(r){return!(0,b.U2)(r,[0,"data","isNode"])},formatter:function(r){var e=r.source,t=r.target,i=r.value;return{name:e+" -> "+t,value:i}}},interactions:[{type:"element-active"}],weight:!0,nodePaddingRatio:.1,nodeWidthRatio:.05};function Bk(r){var e=r.options,t=e.data,i=e.sourceField,u=e.targetField,c=e.weightField,p=e.nodePaddingRatio,g=e.nodeWidthRatio,_=e.rawFields,S=_===void 0?[]:_,k=xw(t,i,u,c),L=jS({weight:!0,nodePaddingRatio:p,nodeWidthRatio:g},k),R=L.nodes,U=L.links,G=R.map(function(pt){return(0,P.pi)((0,P.pi)({},fs(pt,(0,P.pr)(["id","x","y","name"],S))),{isNode:!0})}),Q=U.map(function(pt){return(0,P.pi)((0,P.pi)({source:pt.source.name,target:pt.target.name,name:pt.source.name||pt.target.name},fs(pt,(0,P.pr)(["x","y","value"],S))),{isNode:!1})});return(0,P.pi)((0,P.pi)({},r),{ext:(0,P.pi)((0,P.pi)({},r.ext),{chordData:{nodesData:G,edgesData:Q}})})}function WS(r){var e,t=r.chart;return t.scale((e={x:{sync:!0,nice:!0},y:{sync:!0,nice:!0,max:1}},e[Fk]={sync:"color"},e[Rk]={sync:"color"},e)),r}function Nk(r){var e=r.chart;return e.axis(!1),r}function zk(r){var e=r.chart;return e.legend(!1),r}function qx(r){var e=r.chart,t=r.options,i=t.tooltip;return e.tooltip(i),r}function XS(r){var e=r.chart;return e.coordinate("polar").reflect("y"),r}function Uk(r){var e=r.chart,t=r.options,i=r.ext.chordData.nodesData,u=t.nodeStyle,c=t.label,p=t.tooltip,g=e.createView();return g.data(i),gg({chart:g,options:{xField:gm,yField:Xy,seriesField:Fk,polygon:{style:u},label:c,tooltip:p}}),r}function tF(r){var e=r.chart,t=r.options,i=r.ext.chordData.edgesData,u=t.edgeStyle,c=t.tooltip,p=e.createView();p.data(i);var g={xField:gm,yField:Xy,seriesField:Rk,edge:{style:u,shape:"arc"},tooltip:c};return _x({chart:p,options:g}),r}function Zk(r){var e=r.chart,t=r.options,i=t.animation;return E0(e,i,ox(e)),r}function YS(r){return Ga(Bo,Bk,XS,WS,Nk,zk,qx,tF,Uk,Xs,w0,Zk)(r)}var Vk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="chord",t}return e.getDefaultOptions=function(){return Dk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return YS},e}(Ha),$S=["x","y","r","name","value","path","depth"],Gk={colorField:"name",autoFit:!0,pointStyle:{lineWidth:0,stroke:"#fff"},legend:!1,hierarchyConfig:{size:[1,1],padding:0},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1}},Hk=4,Zh=0,mm=5,Kx="drilldown-bread-crumb",Qx={position:"top-left",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}},Yy="hierarchy-data-transform-params",jk=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.name="drill-down",t.historyCache=[],t.breadCrumbGroup=null,t.breadCrumbCfg=Qx,t}return e.prototype.click=function(){var t=(0,b.U2)(this.context,["event","data","data"]);if(!t)return!1;this.drill(t),this.drawBreadCrumb()},e.prototype.resetPosition=function(){if(!!this.breadCrumbGroup){var t=this.context.view.getCoordinate(),i=this.breadCrumbGroup,u=i.getBBox(),c=this.getButtonCfg().position,p={x:t.start.x,y:t.end.y-(u.height+mm*2)};t.isPolar&&(p={x:0,y:0}),c==="bottom-left"&&(p={x:t.start.x,y:t.start.y});var g=_c.transform(null,[["t",p.x+Zh,p.y+u.height+mm]]);i.setMatrix(g)}},e.prototype.back=function(){(0,b.dp)(this.historyCache)&&this.backTo(this.historyCache.slice(0,-1))},e.prototype.reset=function(){this.historyCache[0]&&this.backTo(this.historyCache.slice(0,1)),this.historyCache=[],this.hideCrumbGroup()},e.prototype.drill=function(t){var i=this.context.view,u=(0,b.U2)(i,["interactions","drill-down","cfg","transformData"],function(S){return S}),c=u((0,P.pi)({data:t.data},t[Yy]));i.changeData(c);for(var p=[],g=t;g;){var _=g.data;p.unshift({id:_.name+"_"+g.height+"_"+g.depth,name:_.name,children:u((0,P.pi)({data:_},t[Yy]))}),g=g.parent}this.historyCache=(this.historyCache||[]).slice(0,-1).concat(p)},e.prototype.backTo=function(t){if(!(!t||t.length<=0)){var i=this.context.view,u=(0,b.Z$)(t).children;i.changeData(u),t.length>1?(this.historyCache=t,this.drawBreadCrumb()):(this.historyCache=[],this.hideCrumbGroup())}},e.prototype.getButtonCfg=function(){var t=this.context.view,i=(0,b.U2)(t,["interactions","drill-down","cfg","drillDownConfig"]);return hn(this.breadCrumbCfg,i==null?void 0:i.breadCrumb,this.cfg)},e.prototype.drawBreadCrumb=function(){this.drawBreadCrumbGroup(),this.resetPosition(),this.breadCrumbGroup.show()},e.prototype.drawBreadCrumbGroup=function(){var t=this,i=this.getButtonCfg(),u=this.historyCache;this.breadCrumbGroup?this.breadCrumbGroup.clear():this.breadCrumbGroup=this.context.view.foregroundGroup.addGroup({name:Kx});var c=0;u.forEach(function(p,g){var _=t.breadCrumbGroup.addShape({type:"text",id:p.id,name:Kx+"_"+p.name+"_text",attrs:(0,P.pi)((0,P.pi)({text:g===0&&!(0,b.UM)(i.rootText)?i.rootText:p.name},i.textStyle),{x:c,y:0})}),S=_.getBBox();if(c+=S.width+Hk,_.on("click",function(R){var U,G=R.target.get("id");if(G!==((U=(0,b.Z$)(u))===null||U===void 0?void 0:U.id)){var Q=u.slice(0,u.findIndex(function(pt){return pt.id===G})+1);t.backTo(Q)}}),_.on("mouseenter",function(R){var U,G=R.target.get("id");G!==((U=(0,b.Z$)(u))===null||U===void 0?void 0:U.id)?_.attr(i.activeTextStyle):_.attr({cursor:"default"})}),_.on("mouseleave",function(){_.attr(i.textStyle)}),g<u.length-1){var k=t.breadCrumbGroup.addShape({type:"text",name:i.name+"_"+p.name+"_divider",attrs:(0,P.pi)((0,P.pi)({text:i.dividerText},i.textStyle),{x:c,y:0})}),L=k.getBBox();c+=L.width+Hk}})},e.prototype.hideCrumbGroup=function(){this.breadCrumbGroup&&this.breadCrumbGroup.hide()},e.prototype.destroy=function(){this.breadCrumbGroup&&this.breadCrumbGroup.remove(),r.prototype.destroy.call(this)},e}(oi);function Wk(r){return ue()(r)==="object"&&"length"in r?r:Array.from(r)}function qS(r){for(var e=r.length,t,i;e;)i=Math.random()*e--|0,t=r[e],r[e]=r[i],r[i]=t;return r}function Jx(r){for(var e=0,t=(r=qS(Array.from(r))).length,i=[],u,c;e<t;)u=r[e],c&&KS(c,u)?++e:(c=JS(i=$y(i,u)),e=0);return c}function $y(r,e){var t,i;if(QS(e,r))return[e];for(t=0;t<r.length;++t)if(ud(e,r[t])&&QS(Tp(r[t],e),r))return[r[t],e];for(t=0;t<r.length-1;++t)for(i=t+1;i<r.length;++i)if(ud(Tp(r[t],r[i]),e)&&ud(Tp(r[t],e),r[i])&&ud(Tp(r[i],e),r[t])&&QS(tv(r[t],r[i],e),r))return[r[t],r[i],e];throw new Error}function ud(r,e){var t=r.r-e.r,i=e.x-r.x,u=e.y-r.y;return t<0||t*t<i*i+u*u}function KS(r,e){var t=r.r-e.r+Math.max(r.r,e.r,1)*1e-9,i=e.x-r.x,u=e.y-r.y;return t>0&&t*t>i*i+u*u}function QS(r,e){for(var t=0;t<e.length;++t)if(!KS(r,e[t]))return!1;return!0}function JS(r){switch(r.length){case 1:return tC(r[0]);case 2:return Tp(r[0],r[1]);case 3:return tv(r[0],r[1],r[2])}}function tC(r){return{x:r.x,y:r.y,r:r.r}}function Tp(r,e){var t=r.x,i=r.y,u=r.r,c=e.x,p=e.y,g=e.r,_=c-t,S=p-i,k=g-u,L=Math.sqrt(_*_+S*S);return{x:(t+c+_/L*k)/2,y:(i+p+S/L*k)/2,r:(L+u+g)/2}}function tv(r,e,t){var i=r.x,u=r.y,c=r.r,p=e.x,g=e.y,_=e.r,S=t.x,k=t.y,L=t.r,R=i-p,U=i-S,G=u-g,Q=u-k,pt=_-c,yt=L-c,Ht=i*i+u*u-c*c,ce=Ht-p*p-g*g+_*_,he=Ht-S*S-k*k+L*L,ze=U*G-R*Q,Er=(G*he-Q*ce)/(ze*2)-i,Fr=(Q*pt-G*yt)/ze,zr=(U*ce-R*he)/(ze*2)-u,pn=(R*yt-U*pt)/ze,nn=Fr*Fr+pn*pn-1,Pn=2*(c+Er*Fr+zr*pn),wi=Er*Er+zr*zr-c*c,ha=-(nn?(Pn+Math.sqrt(Pn*Pn-4*nn*wi))/(2*nn):wi/Pn);return{x:i+Er+Fr*ha,y:u+zr+pn*ha,r:ha}}function tb(r,e,t){var i=r.x-e.x,u,c,p=r.y-e.y,g,_,S=i*i+p*p;S?(c=e.r+t.r,c*=c,_=r.r+t.r,_*=_,c>_?(u=(S+_-c)/(2*S),g=Math.sqrt(Math.max(0,_/S-u*u)),t.x=r.x-u*i-g*p,t.y=r.y-u*p+g*i):(u=(S+c-_)/(2*S),g=Math.sqrt(Math.max(0,c/S-u*u)),t.x=e.x+u*i-g*p,t.y=e.y+u*p+g*i)):(t.x=e.x+t.r,t.y=e.y)}function eb(r,e){var t=r.r+e.r-1e-6,i=e.x-r.x,u=e.y-r.y;return t>0&&t*t>i*i+u*u}function ym(r){var e=r._,t=r.next._,i=e.r+t.r,u=(e.x*t.r+t.x*e.r)/i,c=(e.y*t.r+t.y*e.r)/i;return u*u+c*c}function _m(r){this._=r,this.next=null,this.previous=null}function rb(r){if(!(u=(r=Wk(r)).length))return 0;var e,t,i,u,c,p,g,_,S,k,L;if(e=r[0],e.x=0,e.y=0,!(u>1))return e.r;if(t=r[1],e.x=-t.r,t.x=e.r,t.y=0,!(u>2))return e.r+t.r;tb(t,e,i=r[2]),e=new _m(e),t=new _m(t),i=new _m(i),e.next=i.previous=t,t.next=e.previous=i,i.next=t.previous=e;t:for(g=3;g<u;++g){tb(e._,t._,i=r[g]),i=new _m(i),_=t.next,S=e.previous,k=t._.r,L=e._.r;do if(k<=L){if(eb(_._,i._)){t=_,e.next=t,t.previous=e,--g;continue t}k+=_._.r,_=_.next}else{if(eb(S._,i._)){e=S,e.next=t,t.previous=e,--g;continue t}L+=S._.r,S=S.previous}while(_!==S.next);for(i.previous=e,i.next=t,e.next=t.previous=t=i,c=ym(e);(i=i.next)!==t;)(p=ym(i))<c&&(e=i,c=p);t=e.next}for(e=[t._],i=t;(i=i.next)!==t;)e.push(i._);for(i=Jx(e),g=0;g<u;++g)e=r[g],e.x-=i.x,e.y-=i.y;return i.r}function eF(r){return rb(r),r}function rF(r){return r==null?null:xm(r)}function xm(r){if(typeof r!="function")throw new Error;return r}function P0(){return 0}function ev(r){return function(){return r}}function Xk(r){return Math.sqrt(r.value)}function qy(){var r=null,e=1,t=1,i=P0;function u(c){return c.x=e/2,c.y=t/2,r?c.eachBefore(Ky(r)).eachAfter(nb(i,.5)).eachBefore(eC(1)):c.eachBefore(Ky(Xk)).eachAfter(nb(P0,1)).eachAfter(nb(i,c.r/Math.min(e,t))).eachBefore(eC(Math.min(e,t)/(2*c.r))),c}return u.radius=function(c){return arguments.length?(r=rF(c),u):r},u.size=function(c){return arguments.length?(e=+c[0],t=+c[1],u):[e,t]},u.padding=function(c){return arguments.length?(i=typeof c=="function"?c:ev(+c),u):i},u}function Ky(r){return function(e){e.children||(e.r=Math.max(0,+r(e)||0))}}function nb(r,e){return function(t){if(i=t.children){var i,u,c=i.length,p=r(t)*e||0,g;if(p)for(u=0;u<c;++u)i[u].r+=p;if(g=rb(i),p)for(u=0;u<c;++u)i[u].r-=p;t.r=g+p}}}function eC(r){return function(e){var t=e.parent;e.r*=r,t&&(e.x=t.x+r*e.x,e.y=t.y+r*e.y)}}var Yk=ot(12812),$k=ot.n(Yk);function qk(r){var e=0,t=r.children,i=t&&t.length;if(!i)e=1;else for(;--i>=0;)e+=t[i].value;r.value=e}function ib(){return this.eachAfter(qk)}var Kk=ot(99399),rC=ot.n(Kk);function Qk(r,e){var t=-1,i=rC()(this),u;try{for(i.s();!(u=i.n()).done;){var c=u.value;r.call(e,c,++t,this)}}catch(p){i.e(p)}finally{i.f()}return this}function nC(r,e){for(var t=this,i=[t],u,c,p=-1;t=i.pop();)if(r.call(e,t,++p,this),u=t.children)for(c=u.length-1;c>=0;--c)i.push(u[c]);return this}function Nc(r,e){for(var t=this,i=[t],u=[],c,p,g,_=-1;t=i.pop();)if(u.push(t),c=t.children)for(p=0,g=c.length;p<g;++p)i.push(c[p]);for(;t=u.pop();)r.call(e,t,++_,this);return this}function ab(r,e){var t=-1,i=rC()(this),u;try{for(i.s();!(u=i.n()).done;){var c=u.value;if(r.call(e,c,++t,this))return c}}catch(p){i.e(p)}finally{i.f()}}function iC(r){return this.eachAfter(function(e){for(var t=+r(e.data)||0,i=e.children,u=i&&i.length;--u>=0;)t+=i[u].value;e.value=t})}function Jk(r){return this.eachBefore(function(e){e.children&&e.children.sort(r)})}function t4(r){for(var e=this,t=Qy(e,r),i=[e];e!==t;)e=e.parent,i.push(e);for(var u=i.length;r!==t;)i.splice(u,0,r),r=r.parent;return i}function Qy(r,e){if(r===e)return r;var t=r.ancestors(),i=e.ancestors(),u=null;for(r=t.pop(),e=i.pop();r===e;)u=r,r=t.pop(),e=i.pop();return u}function ob(){for(var r=this,e=[r];r=r.parent;)e.push(r);return e}function aC(){return Array.from(this)}function e4(){var r=[];return this.eachBefore(function(e){e.children||r.push(e)}),r}function Jy(){var r=this,e=[];return r.each(function(t){t!==r&&e.push({source:t.parent,target:t})}),e}var sb=ot(97983),oC=ot.n(sb),t_=oC()().mark(O0);function O0(){var r,e,t,i,u,c;return oC()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:r=this,t=[r];case 1:e=t.reverse(),t=[];case 2:if(!(r=e.pop())){g.next=8;break}return g.next=5,r;case 5:if(i=r.children)for(u=0,c=i.length;u<c;++u)t.push(i[u]);g.next=2;break;case 8:if(t.length){g.next=1;break}case 9:case"end":return g.stop()}},t_,this)}function Tg(r,e){r instanceof Map?(r=[void 0,r],e===void 0&&(e=i4)):e===void 0&&(e=n4);for(var t=new F0(r),i,u=[t],c,p,g,_;i=u.pop();)if((p=e(i.data))&&(_=(p=Array.from(p)).length))for(i.children=p,g=_-1;g>=0;--g)u.push(c=p[g]=new F0(p[g])),c.parent=i,c.depth=i.depth+1;return t.eachBefore(uC)}function r4(){return Tg(this).eachBefore(sC)}function n4(r){return r.children}function i4(r){return Array.isArray(r)?r[1]:null}function sC(r){r.data.value!==void 0&&(r.value=r.data.value),r.data=r.data.data}function uC(r){var e=0;do r.height=e;while((r=r.parent)&&r.height<++e)}function F0(r){this.data=r,this.depth=this.height=0,this.parent=null}F0.prototype=Tg.prototype=$k()({constructor:F0,count:ib,each:Qk,eachAfter:Nc,eachBefore:nC,find:ab,sum:iC,sort:Jk,path:t4,ancestors:ob,descendants:aC,leaves:e4,links:Jy,copy:r4},Symbol.iterator,O0);var ub="nodeIndex",lb="childNodeCount",e_="nodeAncestor",r_="Invalid field: it must be a string!";function cb(r,e){var t=r.field,i=r.fields;if((0,b.HD)(t))return t;if((0,b.kJ)(t))return console.warn(r_),t[0];if(console.warn(r_+" will try to get fields instead."),(0,b.HD)(i))return i;if((0,b.kJ)(i)&&i.length)return i[0];if(e)return e;throw new TypeError(r_)}function Mg(r){var e=[];if(r&&r.each){var t,i;r.each(function(u){var c,p;u.parent!==t?(t=u.parent,i=0):i+=1;var g=(0,b.hX)((((c=u.ancestors)===null||c===void 0?void 0:c.call(u))||[]).map(function(_){return e.find(function(S){return S.name===_.name})||_}),function(_){var S=_.depth;return S>0&&S<u.depth});u[e_]=g,u[lb]=((p=u.children)===null||p===void 0?void 0:p.length)||0,u[ub]=i,e.push(u)})}else r&&r.eachNode&&r.eachNode(function(u){e.push(u)});return e}var fb={field:"value",as:["x","y","r"],sort:function(r,e){return e.value-r.value}};function lC(r,e){e=(0,b.f0)({},fb,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==3)throw new TypeError('Invalid as: it must be an array with 3 strings (e.g. [ "x", "y", "r" ])!');var i;try{i=cb(e)}catch(S){console.warn(S)}var u=function(S){return qy().size(e.size).padding(e.padding)(Tg(S).sum(function(k){return k[i]}).sort(e.sort))},c=u(r),p=t[0],g=t[1],_=t[2];return c.each(function(S){S[p]=S.x,S[g]=S.y,S[_]=S.r}),Mg(c)}function cC(r){var e=r.data,t=r.hierarchyConfig,i=r.rawFields,u=i===void 0?[]:i,c=r.enableDrillDown,p=lC(e,(0,P.pi)((0,P.pi)({},t),{field:"value",as:["x","y","r"]})),g=[];return p.forEach(function(_){for(var S,k=_.data.name,L=(0,P.pi)({},_);L.depth>1;)k=((S=L.parent.data)===null||S===void 0?void 0:S.name)+" / "+k,L=L.parent;if(c&&_.depth>2)return null;var R=hn({},_.data,(0,P.pi)((0,P.pi)((0,P.pi)({},fs(_.data,u)),{path:k}),_));R.ext=t,R[Yy]={hierarchyConfig:t,rawFields:u,enableDrillDown:c},g.push(R)}),g}function fC(r,e,t){var i=ux([r,e]),u=i[0],c=i[1],p=i[2],g=i[3],_=t.width,S=t.height,k=_-(g+c),L=S-(u+p),R=Math.min(k,L),U=(k-R)/2,G=(L-R)/2,Q=u+G,pt=c+U,yt=p+G,Ht=g+U,ce=[Q,pt,yt,Ht],he=R<0?0:R;return{finalPadding:ce,finalSize:he}}function a4(r){var e=r.chart,t=Math.min(e.viewBBox.width,e.viewBBox.height);return hn({options:{size:function(i){var u=i.r;return u*t}}},r)}function o4(r){var e=r.options,t=r.chart,i=t.viewBBox,u=e.padding,c=e.appendPadding,p=e.drilldown,g=c;if(p!=null&&p.enabled){var _=My(t.appendPadding,(0,b.U2)(p,["breadCrumb","position"]));g=ux([_,c])}var S=fC(u,g,i).finalPadding;return t.padding=S,t.appendPadding=0,r}function bm(r){var e=r.chart,t=r.options,i=e.padding,u=e.appendPadding,c=t.color,p=t.colorField,g=t.pointStyle,_=t.hierarchyConfig,S=t.sizeField,k=t.rawFields,L=k===void 0?[]:k,R=t.drilldown,U=cC({data:t.data,hierarchyConfig:_,enableDrillDown:R==null?void 0:R.enabled,rawFields:L});e.data(U);var G=e.viewBBox,Q=fC(i,u,G).finalSize,pt=function(yt){var Ht=yt.r;return Ht*Q};return S&&(pt=function(yt){return yt[S]*Q}),Bf(hn({},r,{options:{xField:"x",yField:"y",seriesField:p,sizeField:S,rawFields:(0,P.pr)($S,L),point:{color:c,style:g,shape:"circle",size:pt}}})),r}function hC(r){return Ga(Zs({},{x:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0},y:{min:0,max:1,minLimit:0,maxLimit:1,nice:!0}}))(r)}function s4(r){var e=r.chart,t=r.options,i=t.tooltip;if(i===!1)e.tooltip(!1);else{var u=i;(0,b.U2)(i,"fields")||(u=hn({},{customItems:function(c){return c.map(function(p){var g=(0,b.U2)(e.getOptions(),"scales"),_=(0,b.U2)(g,["name","formatter"],function(k){return k}),S=(0,b.U2)(g,["value","formatter"],function(k){return k});return(0,P.pi)((0,P.pi)({},p),{name:_(p.data.name),value:S(p.data.value)})})}},u)),e.tooltip(u)}return r}function pC(r){var e=r.chart;return e.axis(!1),r}function dC(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t;return e!=null&&e.enabled?hn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:cC,enableDrillDown:!0}}])}):r}function vC(r){var e=r.chart,t=r.options;return Xs({chart:e,options:dC(t)}),r}function u4(r){return Ga(Nh("pointStyle"),a4,o4,Bo,hC,bm,pC,vg,s4,vC,ms,Ys())(r)}function gC(r){var e=(0,b.U2)(r,["event","data","data"],{});return(0,b.kJ)(e.children)&&e.children.length>0}function mC(r){var e=r.view.getCoordinate(),t=e.innerRadius;if(t){var i=r.event,u=i.x,c=i.y,p=e.center,g=p.x,_=p.y,S=e.getRadius()*t,k=Math.sqrt(Math.pow(g-u,2)+Math.pow(_-c,2));return k<S}return!1}Yn("drill-down-action",jk),kn("drill-down",{showEnable:[{trigger:"element:mouseenter",action:"cursor:pointer",isEnable:gC},{trigger:"element:mouseleave",action:"cursor:default"},{trigger:"element:mouseleave",action:"cursor:pointer",isEnable:mC}],start:[{trigger:"element:click",isEnable:gC,action:["drill-down-action:click"]},{trigger:"afterchangesize",action:["drill-down-action:resetPosition"]},{trigger:"click",isEnable:mC,action:["drill-down-action:back"]}]});var nF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="circle-packing",t}return e.getDefaultOptions=function(){return Gk},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return u4},e.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},e}(Ha),lh="left-axes-view",Nf="right-axes-view",yC={nice:!0,label:{autoHide:!0,autoRotate:!1}},_C=(0,P.pi)((0,P.pi)({},yC),{position:"left"}),xC=(0,P.pi)((0,P.pi)({},yC),{position:"right",grid:null}),R0;(function(r){r.Left="Left",r.Right="Right"})(R0||(R0={}));var D0;(function(r){r.Line="line",r.Column="column"})(D0||(D0={}));function hb(r){return(0,b.U2)(r,"geometry")===D0.Line}function n_(r){return(0,b.U2)(r,"geometry")===D0.Column}function bC(r,e,t){return n_(t)?hn({},{geometry:D0.Column,label:t.label&&t.isRange?{content:function(i){var u;return(u=i[e])===null||u===void 0?void 0:u.join("-")}}:void 0},t):(0,P.pi)({geometry:D0.Line},t)}function EC(r,e){var t=r[0],i=r[1];if((0,b.kJ)(e)){var u=e[0],c=e[1];return[u,c]}var p=(0,b.U2)(e,t),g=(0,b.U2)(e,i);return[p,g]}function wC(r,e){return e===R0.Left?r===!1?!1:hn({},_C,r):e===R0.Right?r===!1?!1:hn({},xC,r):r}function pb(r){var e=r.options,t=r.chart,i=e.geometryOption,u=i.isStack,c=i.color,p=i.seriesField,g=i.groupField,_=i.isGroup,S=["xField","yField"];if(hb(i)){C0(hn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},fs(e,S)),i),{line:{color:i.color,style:i.lineStyle}})})),Bf(hn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},fs(e,S)),i),{point:i.point&&(0,P.pi)({color:c,shape:"circle"},i.point)})}));var k=[];_&&k.push({type:"dodge",dodgeBy:g||p,customOffset:0}),u&&k.push({type:"stack"}),k.length&&(0,b.S6)(t.geometries,function(L){L.adjust(k)})}return n_(i)&&By(hn({},r,{options:(0,P.pi)((0,P.pi)((0,P.pi)({},fs(e,S)),i),{widthRatio:i.columnWidthRatio,interval:(0,P.pi)((0,P.pi)({},fs(i,["color"])),{style:i.columnStyle})})})),r}function l4(r){var e=r.view,t=r.geometryOption,i=r.yField,u=r.legend,c=(0,b.U2)(u,"marker"),p=Ec(e,hb(t)?"line":"interval");if(!t.seriesField){var g=(0,b.U2)(e,"options.scales."+i+".alias")||i,_=p.getAttribute("color"),S=e.getTheme().defaultColor;_&&(S=_c.getMappingValue(_,g,(0,b.U2)(_,["values",0],S)));var k=((0,b.mf)(c)?c:!(0,b.xb)(c)&&hn({},{style:{stroke:S,fill:S}},c))||(hb(t)?{symbol:function(R,U,G){return[["M",R-G,U],["L",R+G,U]]},style:{lineWidth:2,r:6,stroke:S}}:{symbol:"square",style:{fill:S}});return[{value:i,name:g,marker:k,isGeometry:!0,viewId:e.id}]}var L=p.getGroupAttributes();return(0,b.u4)(L,function(R,U){var G=_c.getLegendItems(e,p,U,e.getTheme(),c);return R.concat(G)},[])}var db=function(r,e){var t=e[0],i=e[1],u=r.getOptions().data,c=r.getXScale(),p=(0,b.dp)(u);if(!(!c||!p)){var g=!0,_=(0,b.I)(u,c.field),S=g?_:_.reverse(),k=(0,b.dp)(S),L=Math.floor(t*(k-1)),R=Math.floor(i*(k-1));r.filter(c.field,function(U){var G=S.indexOf(U);return G>-1?yu(G,L,R):!0}),r.getRootView().render(!0)}};function SC(r){var e,t=r.options,i=t.geometryOptions,u=i===void 0?[]:i,c=t.xField,p=t.yField,g=(0,b.yW)(u,function(_){var S=_.geometry;return S===D0.Line||S===void 0});return hn({},{options:{geometryOptions:[],meta:(e={},e[c]={type:"cat",sync:!0,range:g?[0,1]:void 0},e),tooltip:{showMarkers:g,showCrosshairs:g,shared:!0,crosshairs:{type:"x"}},interactions:g?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},r,{options:{yAxis:EC(p,t.yAxis),geometryOptions:[bC(c,p[0],u[0]),bC(c,p[1],u[1])],annotations:EC(p,t.annotations)}})}function CC(r){var e,t,i=r.chart,u=r.options,c=u.geometryOptions,p={line:0,column:1},g=[{type:(e=c[0])===null||e===void 0?void 0:e.geometry,id:lh},{type:(t=c[1])===null||t===void 0?void 0:t.geometry,id:Nf}];return g.sort(function(_,S){return-p[_.type]+p[S.type]}).forEach(function(_){return i.createView({id:_.id})}),r}function vb(r){var e=r.chart,t=r.options,i=t.xField,u=t.yField,c=t.geometryOptions,p=t.data,g=t.tooltip,_=[(0,P.pi)((0,P.pi)({},c[0]),{id:lh,data:p[0],yField:u[0]}),(0,P.pi)((0,P.pi)({},c[1]),{id:Nf,data:p[1],yField:u[1]})];return _.forEach(function(S){var k=S.id,L=S.data,R=S.yField,U=n_(S)&&S.isPercent,G=U?Fw(L,R,i,R):L,Q=yo(e,k).data(G),pt=U?(0,P.pi)({formatter:function(yt){return{name:yt[S.seriesField]||R,value:(Number(yt[R])*100).toFixed(2)+"%"}}},g):g;pb({chart:Q,options:{xField:i,yField:R,tooltip:pt,geometryOption:S}})}),r}function gb(r){var e,t=r.chart,i=r.options,u=i.geometryOptions,c=((e=t.getTheme())===null||e===void 0?void 0:e.colors10)||[],p=0;return t.once("beforepaint",function(){(0,b.S6)(u,function(g,_){var S=yo(t,_===0?lh:Nf);if(!g.color){var k=S.getGroupScales(),L=(0,b.U2)(k,[0,"values","length"],1),R=c.slice(p,p+L).concat(_===0?[]:c);S.geometries.forEach(function(U){g.seriesField?U.color(g.seriesField,R):U.color(R[0])}),p+=L}}),t.render(!0)}),r}function gf(r){var e,t,i=r.chart,u=r.options,c=u.xAxis,p=u.yAxis,g=u.xField,_=u.yField;return Zs((e={},e[g]=c,e[_[0]]=p[0],e))(hn({},r,{chart:yo(i,lh)})),Zs((t={},t[g]=c,t[_[1]]=p[1],t))(hn({},r,{chart:yo(i,Nf)})),r}function mb(r){var e=r.chart,t=r.options,i=yo(e,lh),u=yo(e,Nf),c=t.xField,p=t.yField,g=t.xAxis,_=t.yAxis;return e.axis(c,!1),e.axis(p[0],!1),e.axis(p[1],!1),i.axis(c,g),i.axis(p[0],wC(_[0],R0.Left)),u.axis(c,!1),u.axis(p[1],wC(_[1],R0.Right)),r}function Ig(r){var e=r.chart,t=r.options,i=t.tooltip,u=yo(e,lh),c=yo(e,Nf);return e.tooltip(i),u.tooltip({shared:!0}),c.tooltip({shared:!0}),r}function iF(r){var e=r.chart;return Xs(hn({},r,{chart:yo(e,lh)})),Xs(hn({},r,{chart:yo(e,Nf)})),r}function AC(r){var e=r.chart,t=r.options,i=t.annotations,u=(0,b.U2)(i,[0]),c=(0,b.U2)(i,[1]);return Ys(u)(hn({},r,{chart:yo(e,lh),options:{annotations:u}})),Ys(c)(hn({},r,{chart:yo(e,Nf),options:{annotations:c}})),r}function c4(r){var e=r.chart;return Bo(hn({},r,{chart:yo(e,lh)})),Bo(hn({},r,{chart:yo(e,Nf)})),Bo(r),r}function aF(r){var e=r.chart;return ms(hn({},r,{chart:yo(e,lh)})),ms(hn({},r,{chart:yo(e,Nf)})),r}function i_(r){var e=r.chart,t=r.options,i=t.yAxis;return Df(hn({},r,{chart:yo(e,lh),options:{yAxis:i[0]}})),Df(hn({},r,{chart:yo(e,Nf),options:{yAxis:i[1]}})),r}function Em(r){var e=r.chart,t=r.options,i=t.legend,u=t.geometryOptions,c=t.yField,p=t.data,g=yo(e,lh),_=yo(e,Nf);if(i===!1)e.legend(!1);else if((0,b.Kn)(i)&&i.custom===!0)e.legend(i);else{var S=(0,b.U2)(u,[0,"legend"],i),k=(0,b.U2)(u,[1,"legend"],i);e.once("beforepaint",function(){var L=p[0].length?l4({view:g,geometryOption:u[0],yField:c[0],legend:S}):[],R=p[1].length?l4({view:_,geometryOption:u[1],yField:c[1],legend:k}):[];e.legend(hn({},i,{custom:!0,items:L.concat(R)}))}),u[0].seriesField&&g.legend(u[0].seriesField,S),u[1].seriesField&&_.legend(u[1].seriesField,k),e.on("legend-item:click",function(L){var R=(0,b.U2)(L,"gEvent.delegateObject",{});if(R&&R.item){var U=R.item,G=U.value,Q=U.isGeometry,pt=U.viewId;if(Q){var yt=(0,b.cx)(c,function(he){return he===G});if(yt>-1){var Ht=(0,b.U2)(yo(e,pt),"geometries");(0,b.S6)(Ht,function(he){he.changeVisible(!R.item.unchecked)})}}else{var ce=(0,b.U2)(e.getController("legend"),"option.items",[]);(0,b.S6)(e.views,function(he){var ze=he.getGroupScales();(0,b.S6)(ze,function(Er){Er.values&&Er.values.indexOf(G)>-1&&he.filter(Er.field,function(Fr){var zr=(0,b.sE)(ce,function(pn){return pn.value===Fr});return!zr.unchecked})}),e.render(!0)})}}})}return r}function TC(r){var e=r.chart,t=r.options,i=t.slider,u=yo(e,lh),c=yo(e,Nf);return i&&(u.option("slider",i),u.on("slider:valuechanged",function(p){var g=p.event,_=g.value,S=g.originValue;(0,b.Xy)(_,S)||db(c,_)}),e.once("afterpaint",function(){if(!(0,b.jn)(i)){var p=i.start,g=i.end;(p||g)&&db(c,[p,g])}})),r}function MC(r){return Ga(SC,CC,c4,vb,gf,mb,i_,Ig,iF,AC,aF,gb,Em,TC)(r)}var f4=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="dual-axes",t}return e.prototype.getDefaultOptions=function(){return hn({},r.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},e.prototype.getSchemaAdaptor=function(){return MC},e}(Ha);function B0(r,e){var t=e.data,i=e.coordinate,u=e.interactions,c=e.annotations,p=e.animation,g=e.tooltip,_=e.axes,S=e.meta,k=e.geometries;t&&r.data(t);var L={};_&&(0,b.S6)(_,function(R,U){L[U]=fs(R,Rf)}),L=hn({},S,L),r.scale(L),i&&r.coordinate(i),_===!1?r.axis(!1):(0,b.S6)(_,function(R,U){r.axis(U,R)}),(0,b.S6)(k,function(R){var U=Fl({chart:r,options:R}).ext,G=R.adjust;G&&U.geometry.adjust(G)}),(0,b.S6)(u,function(R){R.enable===!1?r.removeInteraction(R.type):r.interaction(R.type,R.cfg)}),(0,b.S6)(c,function(R){r.annotation()[R.type]((0,P.pi)({},R))}),E0(r,p),g?(r.interaction("tooltip"),r.tooltip(g)):g===!1&&r.removeInteraction("tooltip")}function yb(r){var e=r.chart,t=r.options,i=t.type,u=t.data,c=t.fields,p=t.eachView,g=(0,b.CE)(t,["type","data","fields","eachView","axes","meta","tooltip","coordinate","theme","legend","interactions","annotations"]);return e.data(u),e.facet(i,(0,P.pi)((0,P.pi)({},g),{fields:c,eachView:function(_,S){var k=p(_,S);if(k.geometries)B0(_,k);else{var L=k,R=L.options;R.tooltip&&_.interaction("tooltip"),Ux(L.type,_,R)}}})),r}function a_(r){var e=r.chart,t=r.options,i=t.axes,u=t.meta,c=t.tooltip,p=t.coordinate,g=t.theme,_=t.legend,S=t.interactions,k=t.annotations,L={};return i&&(0,b.S6)(i,function(R,U){L[U]=fs(R,Rf)}),L=hn({},u,L),e.scale(L),e.coordinate(p),i?(0,b.S6)(i,function(R,U){e.axis(U,R)}):e.axis(!1),c?(e.interaction("tooltip"),e.tooltip(c)):c===!1&&e.removeInteraction("tooltip"),e.legend(_),g&&e.theme(g),(0,b.S6)(S,function(R){R.enable===!1?e.removeInteraction(R.type):e.interaction(R.type,R.cfg)}),(0,b.S6)(k,function(R){e.annotation()[R.type]((0,P.pi)({},R))}),r}function h4(r){return Ga(Bo,yb,a_)(r)}var p4={title:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},rowTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}},columnTitle:{style:{fontSize:12,fill:"rgba(0,0,0,0.65)"}}},wm=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="area",t}return e.getDefaultOptions=function(){return p4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return h4},e}(Ha);function d4(r){var e=r.chart,t=r.options,i=t.data,u=t.type,c=t.xField,p=t.yField,g=t.colorField,_=t.sizeField,S=t.sizeRatio,k=t.shape,L=t.color,R=t.tooltip,U=t.heatmapStyle,G=t.meta;e.data(i);var Q="polygon";u==="density"&&(Q="heatmap");var pt=zh(R,[c,p,g]),yt=pt.fields,Ht=pt.formatter,ce=1;return(S||S===0)&&(!k&&!_?console.warn("sizeRatio is not in effect: Must define shape or sizeField first"):S<0||S>1?console.warn("sizeRatio is not in effect: It must be a number in [0,1]"):ce=S),Fl(hn({},r,{options:{type:Q,colorField:g,tooltipFields:yt,shapeField:_||"",label:void 0,mapping:{tooltip:Ht,shape:k&&(_?function(he){var ze=i.map(function(pn){return pn[_]}),Er=(G==null?void 0:G[_])||{},Fr=Er.min,zr=Er.max;return Fr=(0,b.hj)(Fr)?Fr:Math.min.apply(Math,ze),zr=(0,b.hj)(zr)?zr:Math.max.apply(Math,ze),[k,((0,b.U2)(he,_)-Fr)/(zr-Fr),ce]}:function(){return[k,1,ce]}),color:L||g&&e.getTheme().sequenceColors.join("-"),style:U}}})),r}function v4(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function oF(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?e.axis(p,!1):e.axis(p,u),r}function sF(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField,c=t.sizeField,p=t.sizeLegend,g=i!==!1;return u&&e.legend(u,g?i:!1),c&&e.legend(c,p===void 0?i:p),!g&&!p&&e.legend(!1),r}function uF(r){var e=r.chart,t=r.options,i=t.label,u=t.colorField,c=t.type,p=Ec(e,c==="density"?"heatmap":"polygon");if(!i)p.label(!1);else if(u){var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:[u],callback:g,cfg:Os(_)})}return r}function lF(r){var e,t,i=r.chart,u=r.options,c=u.coordinate,p=u.reflect,g=hn({actions:[]},c!=null?c:{type:"rect"});return p&&((t=(e=g.actions)===null||e===void 0?void 0:e.push)===null||t===void 0||t.call(e,["reflect",p])),i.coordinate(g),r}function cF(r){return Ga(Bo,Nh("heatmapStyle"),v4,lF,d4,oF,sF,hl,uF,Ys(),Xs,ms,w0)(r)}var fF=hn({},Ha.getDefaultOptions(),{type:"polygon",legend:!1,coordinate:{type:"rect"},xAxis:{tickLine:null,line:null,grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}},yAxis:{grid:{alignTick:!1,line:{style:{lineWidth:1,lineDash:null,stroke:"#f0f0f0"}}}}});va("polygon","circle",{draw:function(r,e){var t,i,u=r.x,c=r.y,p=this.parsePoints(r.points),g=Math.abs(p[2].x-p[1].x),_=Math.abs(p[1].y-p[0].y),S=Math.min(g,_)/2,k=Number(r.shape[1]),L=Number(r.shape[2]),R=Math.sqrt(L),U=S*R*Math.sqrt(k),G=((t=r.style)===null||t===void 0?void 0:t.fill)||r.color||((i=r.defaultStyle)===null||i===void 0?void 0:i.fill),Q=e.addShape("circle",{attrs:(0,P.pi)((0,P.pi)((0,P.pi)({x:u,y:c,r:U},r.defaultStyle),r.style),{fill:G})});return Q}}),va("polygon","square",{draw:function(r,e){var t,i,u=r.x,c=r.y,p=this.parsePoints(r.points),g=Math.abs(p[2].x-p[1].x),_=Math.abs(p[1].y-p[0].y),S=Math.min(g,_),k=Number(r.shape[1]),L=Number(r.shape[2]),R=Math.sqrt(L),U=S*R*Math.sqrt(k),G=((t=r.style)===null||t===void 0?void 0:t.fill)||r.color||((i=r.defaultStyle)===null||i===void 0?void 0:i.fill),Q=e.addShape("rect",{attrs:(0,P.pi)((0,P.pi)((0,P.pi)({x:u-U/2,y:c-U/2,width:U,height:U},r.defaultStyle),r.style),{fill:G})});return Q}});var RR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="heatmap",t}return e.getDefaultOptions=function(){return fF},e.prototype.getSchemaAdaptor=function(){return cF},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),IC="liquid";function o_(r){return[{percent:r,type:IC}]}function hF(r){var e=r.chart,t=r.options,i=t.percent,u=t.liquidStyle,c=t.radius,p=t.outline,g=t.wave,_=t.shape,S=t.shapeStyle,k=t.animation;e.scale({percent:{min:0,max:1}}),e.data(o_(i));var L=t.color||e.getTheme().defaultColor,R=hn({},r,{options:{xField:"type",yField:"percent",widthRatio:c,interval:{color:L,style:u,shape:"liquid-fill-gauge"}}}),U=ac(R).ext,G=U.geometry,Q=e.getTheme().background,pt={radius:c,outline:p,wave:g,shape:_,shapeStyle:S,background:Q,animation:k};return G.customInfo(pt),e.legend(!1),e.axis(!1),e.tooltip(!1),r}function _b(r,e){var t=r.chart,i=r.options,u=i.statistic,c=i.percent,p=i.meta;t.getController("annotation").clear(!0);var g=(0,b.U2)(p,["percent","formatter"])||function(S){return(S*100).toFixed(2)+"%"},_=u.content;return _&&(_=hn({},_,{content:(0,b.UM)(_.content)?g(c):_.content})),Iy(t,{statistic:(0,P.pi)((0,P.pi)({},u),{content:_}),plotType:"liquid"},{percent:c}),e&&t.render(!0),r}function g4(r){return Ga(Bo,Nh("liquidStyle"),hF,_b,Zs({}),ms,Xs)(r)}var pF={radius:.9,statistic:{title:!1,content:{style:{opacity:.75,fontSize:"30px",lineHeight:"30px",textAlign:"center"}}},outline:{border:2,distance:0},wave:{count:3,length:192},shape:"circle"},xb=5e3;function kC(r,e,t){return r+(e-r)*t}function dF(r){var e=(0,P.pi)({opacity:1},r.style);return r.color&&!e.fill&&(e.fill=r.color),e}function LC(r){var e={fill:"#fff",fillOpacity:0,lineWidth:4},t=(0,b.CD)({},e,r.style);return r.color&&!t.stroke&&(t.stroke=r.color),(0,b.hj)(r.opacity)&&(t.opacity=t.strokeOpacity=r.opacity),t}function m4(r,e,t,i){return e===0?[[r+1/2*t/Math.PI/2,i/2],[r+1/2*t/Math.PI,i],[r+t/4,i]]:e===1?[[r+1/2*t/Math.PI/2*(Math.PI-2),i],[r+1/2*t/Math.PI/2*(Math.PI-1),i/2],[r+t/4,0]]:e===2?[[r+1/2*t/Math.PI/2,-i/2],[r+1/2*t/Math.PI,-i],[r+t/4,-i]]:[[r+1/2*t/Math.PI/2*(Math.PI-2),-i],[r+1/2*t/Math.PI/2*(Math.PI-1),-i/2],[r+t/4,0]]}function vF(r,e,t,i,u,c,p){for(var g=Math.ceil(2*r/t*4)*4,_=[],S=i;S<-Math.PI*2;)S+=Math.PI*2;for(;S>0;)S-=Math.PI*2;S=S/Math.PI/2*t;var k=c-r+S-r*2;_.push(["M",k,e]);for(var L=0,R=0;R<g;++R){var U=R%4,G=m4(R*t/4,U,t,u);_.push(["C",G[0][0]+k,-G[0][1]+e,G[1][0]+k,-G[1][1]+e,G[2][0]+k,-G[2][1]+e]),R===g-1&&(L=G[2][0])}return _.push(["L",L+k,p+r]),_.push(["L",k,p+r]),_.push(["Z"]),_}function s_(r,e,t,i,u,c,p,g,_,S){for(var k=u.fill,L=u.opacity,R=p.getBBox(),U=R.maxX-R.minX,G=R.maxY-R.minY,Q=0;Q<i;Q++){var pt=i<=1?1:Q/(i-1),yt=c.addShape("path",{name:"waterwave-path",attrs:{path:vF(g,R.minY+G*t,_,0,U/32,r,e),fill:k,opacity:kC(.2,.9,pt)*L}});try{if(S===!1)return;var Ht=Ox([["t",_,0]]);yt.stopAnimate(),yt.animate({matrix:Ht},{duration:kC(.5*xb,xb,pt),repeat:!0})}catch(ce){console.warn("off-screen group animate error!")}}}function y4(r,e,t,i){var u=t*2/3,c=Math.max(u,i),p=u/2,g=r,_=p+e-c/2,S=Math.asin(p/((c-p)*.85)),k=Math.sin(S)*p,L=Math.cos(S)*p,R=g-L,U=_+k,G=r,Q=_+p/Math.sin(S);return`
      M `+R+" "+U+`
      A `+p+" "+p+" 0 1 1 "+(R+L*2)+" "+U+`
      Q `+G+" "+Q+" "+r+" "+(e+c/2)+`
      Q `+G+" "+Q+" "+R+" "+U+`
      Z 
    `}function gF(r,e,t,i){var u=t/2,c=i/2;return`
      M `+r+" "+(e-c)+` 
      a `+u+" "+c+" 0 1 0 0 "+c*2+`
      a `+u+" "+c+" 0 1 0 0 "+-c*2+`
      Z
    `}function N0(r,e,t,i){var u=i/2,c=t/2;return`
      M `+r+" "+(e-u)+`
      L `+(r+c)+" "+e+`
      L `+r+" "+(e+u)+`
      L `+(r-c)+" "+e+`
      Z
    `}function PC(r,e,t,i){var u=i/2,c=t/2;return`
      M `+r+" "+(e-u)+`
      L `+(r+c)+" "+(e+u)+`
      L `+(r-c)+" "+(e+u)+`
      Z
    `}function u_(r,e,t,i){var u=.618,c=i/2,p=t/2*u;return`
      M `+(r-p)+" "+(e-c)+`
      L `+(r+p)+" "+(e-c)+`
      L `+(r+p)+" "+(e+c)+`
      L `+(r-p)+" "+(e+c)+`
      Z
    `}var OC={pin:y4,circle:gF,diamond:N0,triangle:PC,rect:u_};va("interval","liquid-fill-gauge",{draw:function(r,e){var t=.5,i=.5,u=r.customInfo,c=u,p=c.radius,g=c.shape,_=c.shapeStyle,S=c.background,k=c.animation,L=u.outline,R=u.wave,U=L.border,G=L.distance,Q=R.count,pt=R.length,yt=(0,b.u4)(r.points,function(ha,Sa){return Math.min(ha,Sa.x)},1/0),Ht=this.parsePoint({x:t,y:i}),ce=this.parsePoint({x:yt,y:i}),he=Ht.x-ce.x,ze=Math.min(he,ce.y*p),Er=dF(r),Fr=LC((0,b.CD)({},r,L)),zr=ze-U/2,pn=typeof g=="function"?g:OC[g]||OC.circle,nn=pn(Ht.x,Ht.y,zr*2,zr*2);_&&e.addShape("path",{name:"shape",attrs:(0,P.pi)({path:nn},_)});var Pn=e.addGroup({name:"waves"}),wi=Pn.setClip({type:"path",attrs:{path:nn}});return s_(Ht.x,Ht.y,1-r.points[1].y,Q,Er,Pn,wi,ze*2,pt,k),e.addShape("path",{name:"distance",attrs:{path:nn,fill:"transparent",lineWidth:U+G*2,stroke:S==="transparent"?"#fff":S}}),e.addShape("path",{name:"wrap",attrs:(0,b.CD)(Fr,{path:nn,fill:"transparent",lineWidth:U})}),e}});var mF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="liquid",t}return e.getDefaultOptions=function(){return pF},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.changeData=function(t){this.chart.emit(It.BEFORE_CHANGE_DATA,pe.fromData(this.chart,It.BEFORE_CHANGE_DATA,null)),this.updateOption({percent:t}),this.chart.data(o_(t)),_b({chart:this.chart,options:this.options},!0),this.chart.emit(It.AFTER_CHANGE_DATA,pe.fromData(this.chart,It.AFTER_CHANGE_DATA,null))},e.prototype.getSchemaAdaptor=function(){return g4},e}(Ha);function kg(r){var e=r.chart,t=r.options,i=t.data,u=t.lineStyle,c=t.color,p=t.point,g=t.area;e.data(i);var _=hn({},r,{options:{line:{style:u,color:c},point:p&&(0,P.pi)({color:c},p),area:g&&(0,P.pi)({color:c},g),label:void 0}}),S=hn({},_,{options:{tooltip:!1}}),k=(p==null?void 0:p.state)||t.state,L=hn({},_,{options:{tooltip:!1,state:k}});return C0(_),Bf(L),Gv(S),r}function _4(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function x4(r){var e=r.chart,t=r.options,i=t.radius,u=t.startAngle,c=t.endAngle;return e.coordinate("polar",{radius:i,startAngle:u,endAngle:c}),r}function yF(r){var e=r.chart,t=r.options,i=t.xField,u=t.xAxis,c=t.yField,p=t.yAxis;return e.axis(i,u),e.axis(c,p),r}function _F(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"line");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:Os(g)})}return r}function xF(r){return Ga(kg,_4,Bo,x4,yF,vg,hl,_F,Xs,ms,Ys())(r)}var bF=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e.prototype,"name",{get:function(){return"radar-tooltip"},enumerable:!1,configurable:!0}),e.prototype.getTooltipItems=function(t){var i=this.getTooltipCfg(),u=i.shared,c=i.title,p=r.prototype.getTooltipItems.call(this,t);if(p.length>0){var g=this.view.geometries[0],_=g.dataArray,S=p[0].name,k=[];return _.forEach(function(L){L.forEach(function(R){var U=_c.getTooltipItems(R,g),G=U[0];if(!u&&G&&G.name===S){var Q=(0,b.UM)(c)?S:c;k.push((0,P.pi)((0,P.pi)({},G),{name:G.title,title:Q}))}else if(u&&G){var Q=(0,b.UM)(c)?G.name||S:c;k.push((0,P.pi)((0,P.pi)({},G),{name:G.title,title:Q}))}})}),k}return[]},e}(Di);N("radar-tooltip",bF);var EF=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.init=function(){var t=this.context.view;t.removeInteraction("tooltip")},e.prototype.show=function(){var t=this.context.event,i=this.getTooltipController();i.showTooltip({x:t.x,y:t.y})},e.prototype.hide=function(){var t=this.getTooltipController();t.hideTooltip()},e.prototype.getTooltipController=function(){var t=this.context.view;return t.getController("radar-tooltip")},e}(oi);Yn("radar-tooltip",EF),kn("radar-tooltip",{start:[{trigger:"plot:mousemove",action:"radar-tooltip:show"}],end:[{trigger:"plot:mouseleave",action:"radar-tooltip:hide"}]});var DR=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="radar",t}return e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return hn({},r.prototype.getDefaultOptions.call(this),{xAxis:{label:{offset:15},grid:{line:{type:"line"}}},yAxis:{grid:{line:{type:"circle"}}},legend:{position:"top"},tooltip:{shared:!0,showCrosshairs:!0,showMarkers:!0,crosshairs:{type:"xy",line:{style:{stroke:"#565656",lineDash:[4]}},follow:!0}}})},e.prototype.getSchemaAdaptor=function(){return xF},e}(Ha);function wF(r,e,t){var i=t.map(function(p){return p[e]}).filter(function(p){return p!==void 0}),u=i.length>0?Math.max.apply(Math,i):0,c=Math.abs(r)%360;return c?u*360/c:u}function FC(r,e,t){var i=[];return r.forEach(function(u){var c=i.find(function(p){return p[e]===u[e]});c?c[t]+=u[t]||null:i.push((0,P.pi)({},u))}),i}function RC(r){var e=r.chart,t=r.options,i=t.barStyle,u=t.color,c=t.tooltip,p=t.colorField,g=t.type,_=t.xField,S=t.yField,k=t.data,L=pg(k,S);e.data(L);var R=hn({},r,{options:{tooltip:c,seriesField:p,interval:{style:i,color:u,shape:g==="line"?"line":"intervel"},minColumnWidth:t.minBarWidth,maxColumnWidth:t.maxBarWidth,columnBackground:t.barBackground}});return ac(R),g==="line"&&Bf({chart:e,options:{xField:_,yField:S,seriesField:p,point:{shape:"circle",color:u}}}),r}function b4(r){var e,t=r.options,i=t.yField,u=t.xField,c=t.data,p=t.isStack,g=t.isGroup,_=t.colorField,S=t.maxAngle,k=p&&!g&&_?FC(c,u,i):c,L=pg(k,i);return Ga(Zs((e={},e[i]={min:0,max:wF(S,i,L)},e)))(r)}function bb(r){var e=r.chart,t=r.options,i=t.radius,u=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"polar",cfg:{radius:i,innerRadius:u,startAngle:c,endAngle:p}}).transpose(),r}function Sm(r){var e=r.chart,t=r.options,i=t.xField,u=t.xAxis;return e.axis(i,u),r}function SF(r){var e=r.chart,t=r.options,i=t.label,u=t.yField,c=Ec(e,"interval");if(!i)c.label(!1);else{var p=i.callback,g=(0,P._T)(i,["callback"]);c.label({fields:[u],callback:p,cfg:(0,P.pi)((0,P.pi)({},Os(g)),{type:"polar"})})}return r}function Eb(r){return Ga(Nh("barStyle"),RC,b4,Sm,bb,Xs,ms,Bo,hl,vg,Ys(),SF)(r)}var wb=hn({},Ha.getDefaultOptions(),{interactions:[{type:"element-active"}],legend:!1,tooltip:{showMarkers:!1},xAxis:{grid:null,tickLine:null,line:null},maxAngle:240}),l_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="radial-bar",t}return e.getDefaultOptions=function(){return wb},e.prototype.changeData=function(t){this.updateOption({data:t}),b4({chart:this.chart,options:this.options}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return Eb},e}(Ha);function E4(r){var e=r.chart,t=r.options,i=t.data,u=t.sectorStyle,c=t.color;return e.data(i),Ga(ac)(hn({},r,{options:{marginRatio:1,interval:{style:u,color:c}}})),r}function DC(r){var e=r.chart,t=r.options,i=t.label,u=t.xField,c=Ec(e,"interval");if(i===!1)c.label(!1);else if((0,b.Kn)(i)){var p=i.callback,g=i.fields,_=(0,P._T)(i,["callback","fields"]),S=_.offset,k=_.layout;(S===void 0||S>=0)&&(k=k?(0,b.kJ)(k)?k:[k]:[],_.layout=(0,b.hX)(k,function(L){return L.type!=="limit-in-shape"}),_.layout.length||delete _.layout),c.label({fields:g||[u],callback:p,cfg:Os(_)})}else Ap(Cp.WARN,i===null,"the label option must be an Object."),c.label({fields:[u]});return r}function oc(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField;return i===!1?e.legend(!1):u&&e.legend(u,i),r}function w4(r){var e=r.chart,t=r.options,i=t.radius,u=t.innerRadius,c=t.startAngle,p=t.endAngle;return e.coordinate({type:"polar",cfg:{radius:i,innerRadius:u,startAngle:c,endAngle:p}}),r}function S4(r){var e,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return Ga(Zs((e={},e[c]=i,e[p]=u,e)))(r)}function Cs(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i?e.axis(c,i):e.axis(c,!1),u?e.axis(p,u):e.axis(p,!1),r}function C4(r){Ga(Nh("sectorStyle"),E4,S4,DC,w4,Cs,oc,hl,Xs,ms,Bo,Ys(),w0)(r)}var Cm=hn({},Ha.getDefaultOptions(),{xAxis:!1,yAxis:!1,legend:{position:"right",radio:{}},sectorStyle:{stroke:"#fff",lineWidth:1},label:{layout:{type:"limit-in-shape"}},tooltip:{shared:!0,showMarkers:!1},interactions:[{type:"active-region"}]}),c_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="rose",t}return e.getDefaultOptions=function(){return Cm},e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(t)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return C4},e}(Ha),BC="x",NC="y",zC="name",f_="nodes",h_="edges";function UC(r,e,t){var i=[];return r.forEach(function(u){var c=u[e],p=u[t];i.includes(c)||i.push(c),i.includes(p)||i.push(p)}),i}function ZC(r,e,t,i){var u={};return e.forEach(function(c){u[c]={},e.forEach(function(p){u[c][p]=0})}),r.forEach(function(c){u[c[t]][c[i]]=1}),u}function A4(r,e,t){if(!(0,b.kJ)(r))return[];var i=[],u=UC(r,e,t),c=ZC(r,u,e,t),p={};u.forEach(function(_){p[_]=0});function g(_){p[_]=1,u.forEach(function(S){if(c[_][S]!=0)if(p[S]==1)i.push(_+"_"+S);else{if(p[S]==-1)return;g(S)}}),p[_]=-1}return u.forEach(function(_){p[_]!=-1&&g(_)}),i.length!==0&&console.warn("sankey data contains circle, "+i.length+" records removed.",i),r.filter(function(_){return i.findIndex(function(S){return S===_[e]+"_"+_[t]})<0})}function T4(r){return r.target.depth}function M4(r){return r.depth}function VC(r,e){return e-1-r.height}function Sb(r,e){return r.sourceLinks.length?r.depth:e-1}function GC(r){return r.targetLinks.length?r.depth:r.sourceLinks.length?(0,b.F)(r.sourceLinks,T4)-1:0}function p_(r){return function(){return r}}function Cb(r,e){for(var t=0,i=0;i<r.length;i++)t+=e(r[i]);return t}function Ab(r,e){for(var t=-1/0,i=0;i<r.length;i++)t=Math.max(e(r[i]),t);return t}function I4(r,e){for(var t=1/0,i=0;i<r.length;i++)t=Math.min(e(r[i]),t);return t}function HC(r,e){return d_(r.source,e.source)||r.index-e.index}function jC(r,e){return d_(r.target,e.target)||r.index-e.index}function d_(r,e){return r.y0-e.y0}function v_(r){return r.value}function k4(r){return r.index}function L4(r){return r.nodes}function P4(r){return r.links}function Tb(r,e){var t=r.get(e);if(!t)throw new Error("missing: "+e);return t}function WC(r){for(var e=r.nodes,t=0,i=e;t<i.length;t++){for(var u=i[t],c=u.y0,p=c,g=0,_=u.sourceLinks;g<_.length;g++){var S=_[g];S.y0=c+S.width/2,c+=S.width}for(var k=0,L=u.targetLinks;k<L.length;k++){var S=L[k];S.y1=p+S.width/2,p+=S.width}}}function O4(){var r=0,e=0,t=1,i=1,u=24,c=8,p,g=k4,_=Sb,S,k,L,R=L4,U=P4,G=6;function Q(Vn){var Bi={nodes:R(Vn),links:U(Vn)};return pt(Bi),yt(Bi),Ht(Bi),ce(Bi),Er(Bi),WC(Bi),Bi}Q.update=function(Vn){return WC(Vn),Vn},Q.nodeId=function(Vn){return arguments.length?(g=typeof Vn=="function"?Vn:p_(Vn),Q):g},Q.nodeAlign=function(Vn){return arguments.length?(_=typeof Vn=="function"?Vn:p_(Vn),Q):_},Q.nodeDepth=function(Vn){return arguments.length?(S=Vn,Q):S},Q.nodeSort=function(Vn){return arguments.length?(k=Vn,Q):k},Q.nodeWidth=function(Vn){return arguments.length?(u=+Vn,Q):u},Q.nodePadding=function(Vn){return arguments.length?(c=p=+Vn,Q):c},Q.nodes=function(Vn){return arguments.length?(R=typeof Vn=="function"?Vn:p_(Vn),Q):R},Q.links=function(Vn){return arguments.length?(U=typeof Vn=="function"?Vn:p_(Vn),Q):U},Q.linkSort=function(Vn){return arguments.length?(L=Vn,Q):L},Q.size=function(Vn){return arguments.length?(r=e=0,t=+Vn[0],i=+Vn[1],Q):[t-r,i-e]},Q.extent=function(Vn){return arguments.length?(r=+Vn[0][0],t=+Vn[1][0],e=+Vn[0][1],i=+Vn[1][1],Q):[[r,e],[t,i]]},Q.iterations=function(Vn){return arguments.length?(G=+Vn,Q):G};function pt(Vn){var Bi=Vn.nodes,fa=Vn.links;Bi.forEach(function(Io,hs){Io.index=hs,Io.sourceLinks=[],Io.targetLinks=[]});var Ui=new Map(Bi.map(function(Io){return[g(Io),Io]}));if(fa.forEach(function(Io,hs){Io.index=hs;var tl=Io.source,pl=Io.target;typeof tl!="object"&&(tl=Io.source=Tb(Ui,tl)),typeof pl!="object"&&(pl=Io.target=Tb(Ui,pl)),tl.sourceLinks.push(Io),pl.targetLinks.push(Io)}),L!=null)for(var Ji=0,Fa=Bi;Ji<Fa.length;Ji++){var xo=Fa[Ji],Mo=xo.sourceLinks,ao=xo.targetLinks;Mo.sort(L),ao.sort(L)}}function yt(Vn){for(var Bi=Vn.nodes,fa=0,Ui=Bi;fa<Ui.length;fa++){var Ji=Ui[fa];Ji.value=Ji.fixedValue===void 0?Math.max(Cb(Ji.sourceLinks,v_),Cb(Ji.targetLinks,v_)):Ji.fixedValue}}function Ht(Vn){for(var Bi=Vn.nodes,fa=Bi.length,Ui=new Set(Bi),Ji=new Set,Fa=0;Ui.size;){if(Ui.forEach(function(Io){Io.depth=Fa;for(var hs=0,tl=Io.sourceLinks;hs<tl.length;hs++){var pl=tl[hs].target;Ji.add(pl)}}),++Fa>fa)throw new Error("circular link");Ui=Ji,Ji=new Set}if(S)for(var xo=Math.max(Ab(Bi,function(Io){return Io.depth})+1,0),Mo=void 0,ao=0;ao<Bi.length;ao++)Mo=Bi[ao],Mo.depth=S.call(null,Mo,xo)}function ce(Vn){for(var Bi=Vn.nodes,fa=Bi.length,Ui=new Set(Bi),Ji=new Set,Fa=0;Ui.size;){if(Ui.forEach(function(xo){xo.height=Fa;for(var Mo=0,ao=xo.targetLinks;Mo<ao.length;Mo++){var Io=ao[Mo].source;Ji.add(Io)}}),++Fa>fa)throw new Error("circular link");Ui=Ji,Ji=new Set}}function he(Vn){for(var Bi=Vn.nodes,fa=Math.max(Ab(Bi,function(pl){return pl.depth})+1,0),Ui=(t-r-u)/(fa-1),Ji=new Array(fa).fill(0).map(function(){return[]}),Fa=0,xo=Bi;Fa<xo.length;Fa++){var Mo=xo[Fa],ao=Math.max(0,Math.min(fa-1,Math.floor(_.call(null,Mo,fa))));Mo.layer=ao,Mo.x0=r+ao*Ui,Mo.x1=Mo.x0+u,Ji[ao]?Ji[ao].push(Mo):Ji[ao]=[Mo]}if(k)for(var Io=0,hs=Ji;Io<hs.length;Io++){var tl=hs[Io];tl.sort(k)}return Ji}function ze(Vn){for(var Bi=I4(Vn,function(pd){return(i-e-(pd.length-1)*p)/Cb(pd,v_)}),fa=0,Ui=Vn;fa<Ui.length;fa++){for(var Ji=Ui[fa],Fa=e,xo=0,Mo=Ji;xo<Mo.length;xo++){var ao=Mo[xo];ao.y0=Fa,ao.y1=Fa+ao.value*Bi,Fa=ao.y1+p;for(var Io=0,hs=ao.sourceLinks;Io<hs.length;Io++){var tl=hs[Io];tl.width=tl.value*Bi}}Fa=(i-Fa+p)/(Ji.length+1);for(var pl=0;pl<Ji.length;++pl){var ao=Ji[pl];ao.y0+=Fa*(pl+1),ao.y1+=Fa*(pl+1)}ha(Ji)}}function Er(Vn){var Bi=he(Vn);p=Math.min(c,(i-e)/(Ab(Bi,function(Fa){return Fa.length})-1)),ze(Bi);for(var fa=0;fa<G;++fa){var Ui=Math.pow(.99,fa),Ji=Math.max(1-Ui,(fa+1)/G);zr(Bi,Ui,Ji),Fr(Bi,Ui,Ji)}}function Fr(Vn,Bi,fa){for(var Ui=1,Ji=Vn.length;Ui<Ji;++Ui){for(var Fa=Vn[Ui],xo=0,Mo=Fa;xo<Mo.length;xo++){for(var ao=Mo[xo],Io=0,hs=0,tl=0,pl=ao.targetLinks;tl<pl.length;tl++){var pd=pl[tl],iv=pd.source,jh=pd.value,Dg=jh*(ao.layer-iv.layer);Io+=Sa(iv,ao)*Dg,hs+=Dg}if(hs>0){var Bg=(Io/hs-ao.y0)*Bi;ao.y0+=Bg,ao.y1+=Bg,wi(ao)}}k===void 0&&Fa.sort(d_),Fa.length&&pn(Fa,fa)}}function zr(Vn,Bi,fa){for(var Ui=Vn.length,Ji=Ui-2;Ji>=0;--Ji){for(var Fa=Vn[Ji],xo=0,Mo=Fa;xo<Mo.length;xo++){for(var ao=Mo[xo],Io=0,hs=0,tl=0,pl=ao.sourceLinks;tl<pl.length;tl++){var pd=pl[tl],iv=pd.target,jh=pd.value,Dg=jh*(iv.layer-ao.layer);Io+=_o(ao,iv)*Dg,hs+=Dg}if(hs>0){var Bg=(Io/hs-ao.y0)*Bi;ao.y0+=Bg,ao.y1+=Bg,wi(ao)}}k===void 0&&Fa.sort(d_),Fa.length&&pn(Fa,fa)}}function pn(Vn,Bi){var fa=Vn.length>>1,Ui=Vn[fa];Pn(Vn,Ui.y0-p,fa-1,Bi),nn(Vn,Ui.y1+p,fa+1,Bi),Pn(Vn,i,Vn.length-1,Bi),nn(Vn,e,0,Bi)}function nn(Vn,Bi,fa,Ui){for(;fa<Vn.length;++fa){var Ji=Vn[fa],Fa=(Bi-Ji.y0)*Ui;Fa>1e-6&&(Ji.y0+=Fa,Ji.y1+=Fa),Bi=Ji.y1+p}}function Pn(Vn,Bi,fa,Ui){for(;fa>=0;--fa){var Ji=Vn[fa],Fa=(Ji.y1-Bi)*Ui;Fa>1e-6&&(Ji.y0-=Fa,Ji.y1-=Fa),Bi=Ji.y0-p}}function wi(Vn){var Bi=Vn.sourceLinks,fa=Vn.targetLinks;if(L===void 0){for(var Ui=0,Ji=fa;Ui<Ji.length;Ui++){var Fa=Ji[Ui].source.sourceLinks;Fa.sort(jC)}for(var xo=0,Mo=Bi;xo<Mo.length;xo++){var ao=Mo[xo].target.targetLinks;ao.sort(HC)}}}function ha(Vn){if(L===void 0)for(var Bi=0,fa=Vn;Bi<fa.length;Bi++){var Ui=fa[Bi],Ji=Ui.sourceLinks,Fa=Ui.targetLinks;Ji.sort(jC),Fa.sort(HC)}}function Sa(Vn,Bi){for(var fa=Vn.y0-(Vn.sourceLinks.length-1)*p/2,Ui=0,Ji=Vn.sourceLinks;Ui<Ji.length;Ui++){var Fa=Ji[Ui],xo=Fa.target,Mo=Fa.width;if(xo===Bi)break;fa+=Mo+p}for(var ao=0,Io=Bi.targetLinks;ao<Io.length;ao++){var hs=Io[ao],xo=hs.source,Mo=hs.width;if(xo===Vn)break;fa-=Mo}return fa}function _o(Vn,Bi){for(var fa=Bi.y0-(Bi.targetLinks.length-1)*p/2,Ui=0,Ji=Bi.targetLinks;Ui<Ji.length;Ui++){var Fa=Ji[Ui],xo=Fa.source,Mo=Fa.width;if(xo===Vn)break;fa+=Mo+p}for(var ao=0,Io=Vn.sourceLinks;ao<Io.length;ao++){var hs=Io[ao],xo=hs.target,Mo=hs.width;if(xo===Bi)break;fa-=Mo}return fa}return Q}var F4={left:M4,right:VC,center:GC,justify:Sb},R4={nodeId:function(r){return r.index},nodeAlign:"justify",nodeWidth:.008,nodePadding:.03,nodeSort:void 0};function D4(r){var e=(0,b.HD)(r)?F4[r]:(0,b.mf)(r)?r:null;return e||Sb}function B4(r){return(0,b.f0)({},R4,r)}function XC(r,e){var t=B4(r),i=t.nodeId,u=t.nodeSort,c=t.nodeAlign,p=t.nodeWidth,g=t.nodePadding,_=t.nodeDepth,S=O4().nodeSort(u).nodeWidth(p).nodePadding(g).nodeDepth(_).nodeAlign(D4(c)).extent([[0,0],[1,1]]).nodeId(i),k=S(e),L=k.nodes.map(function(U){var G=U.x0,Q=U.x1,pt=U.y0,yt=U.y1;return U.x=[G,Q,Q,G],U.y=[pt,pt,yt,yt],U}).filter(function(U){return U.name!==null}),R=k.links.map(function(U){var G=U.source,Q=U.target,pt=G.x1,yt=Q.x0;U.x=[pt,pt,yt,yt];var Ht=U.width/2;return U.y=[U.y0+Ht,U.y0-Ht,U.y1+Ht,U.y1-Ht],U}).filter(function(U){var G=U.source,Q=U.target;return G.name!==null&&Q.name!==null});return{nodes:L,links:R}}function N4(r){return r==="node-link"}function z4(r,e,t){return b0(r)?r/t:e}function U4(r,e,t){return b0(r)?r/t:e}function YC(r,e,t){var i=r.dataType,u=r.data,c=r.sourceField,p=r.targetField,g=r.weightField,_=r.nodeAlign,S=r.nodeSort,k=r.nodePadding,L=r.nodePaddingRatio,R=r.nodeWidth,U=r.nodeWidthRatio,G=r.nodeDepth,Q=r.rawFields,pt=Q===void 0?[]:Q,yt;N4(i)?yt=u:yt=xw(A4(u,c,p),c,p,g,pt);var Ht=XC({nodeAlign:_,nodePadding:U4(k,L,t),nodeWidth:z4(R,U,e),nodeSort:S,nodeDepth:G},yt),ce=Ht.nodes,he=Ht.links;return{nodes:ce.map(function(ze){return(0,P.pi)((0,P.pi)({},fs(ze,(0,P.pr)(["x","y","name"],pt))),{isNode:!0})}),edges:he.map(function(ze){return(0,P.pi)((0,P.pi)({source:ze.source.name,target:ze.target.name,name:ze.source.name||ze.target.name},fs(ze,(0,P.pr)(["x","y","value"],pt))),{isNode:!1})})}}function Z4(r){var e=r.options,t=e.rawFields,i=t===void 0?[]:t;return hn({},{options:{tooltip:{fields:(0,b.jj)((0,P.pr)(["name","source","target","value","isNode"],i))},label:{fields:(0,b.jj)((0,P.pr)(["x","name"],i))}}},r)}function V4(r){var e=r.chart,t=r.options,i=t.color,u=t.nodeStyle,c=t.edgeStyle,p=t.label,g=t.tooltip,_=t.nodeState,S=t.edgeState;e.legend(!1),e.tooltip(g),e.axis(!1),e.coordinate().reflect("y");var k=YC(t,e.width,e.height),L=k.nodes,R=k.edges,U=e.createView({id:h_});U.data(R),_x({chart:U,options:{xField:BC,yField:NC,seriesField:zC,edge:{color:i,style:c,shape:"arc"},tooltip:g,state:S}});var G=e.createView({id:f_});return G.data(L),gg({chart:G,options:{xField:BC,yField:NC,seriesField:zC,polygon:{color:i,style:u},label:p,tooltip:g,state:_}}),e.interaction("element-active"),e.scale({x:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},y:{sync:!0,nice:!0,min:0,max:1,minLimit:0,maxLimit:1},name:{sync:"color",type:"cat"}}),r}function G4(r){var e=r.chart,t=r.options,i=t.animation,u=(0,P.pr)(e.views[0].geometries,e.views[1].geometries);return E0(e,i,u),r}function H4(r){var e=r.chart,t=r.options,i=t.nodeDraggable,u="sankey-node-draggable";return i?e.interaction(u):e.removeInteraction(u),r}function $C(r){var e=r.chart,t=r.options,i=t.interactions,u=i===void 0?[]:i,c=[].concat(u,t.nodeInteractions||[]),p=[].concat(u,t.edgeInteractions||[]),g=yo(e,f_),_=yo(e,h_);return c.forEach(function(S){(S==null?void 0:S.enable)===!1?g.removeInteraction(S.type):g.interaction(S.type,S.cfg||{})}),p.forEach(function(S){(S==null?void 0:S.enable)===!1?_.removeInteraction(S.type):_.interaction(S.type,S.cfg||{})}),r}function j4(r){return Ga(Z4,V4,$C,H4,G4,Bo)(r)}var W4=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isDragging=!1,t}return e.prototype.isNodeElement=function(){var t=(0,b.U2)(this.context,"event.target");if(t){var i=t.get("element");return i&&i.getModel().data.isNode}return!1},e.prototype.getNodeView=function(){return yo(this.context.view,f_)},e.prototype.getEdgeView=function(){return yo(this.context.view,h_)},e.prototype.getCurrentDatumIdx=function(t){return this.getNodeView().geometries[0].elements.indexOf(t)},e.prototype.start=function(){if(this.isNodeElement()){this.prevPoint={x:(0,b.U2)(this.context,"event.x"),y:(0,b.U2)(this.context,"event.y")};var t=this.context.event.target.get("element"),i=this.getCurrentDatumIdx(t);if(i===-1)return;this.currentElementIdx=i,this.context.isDragging=!0,this.isDragging=!0,this.prevNodeAnimateCfg=this.getNodeView().getOptions().animate,this.prevEdgeAnimateCfg=this.getEdgeView().getOptions().animate,this.getNodeView().animate(!1),this.getEdgeView().animate(!1)}},e.prototype.translate=function(){if(this.isDragging){var t=this.context.view,i={x:(0,b.U2)(this.context,"event.x"),y:(0,b.U2)(this.context,"event.y")},u=i.x-this.prevPoint.x,c=i.y-this.prevPoint.y,p=this.getNodeView(),g=p.geometries[0].elements[this.currentElementIdx];if(g&&g.getModel()){var _=g.getModel().data,S=p.getOptions().data,k=p.getCoordinate(),L={x:u/k.getWidth(),y:c/k.getHeight()},R=(0,P.pi)((0,P.pi)({},_),{x:_.x.map(function(yt){return yt+=L.x}),y:_.y.map(function(yt){return yt+=L.y})}),U=(0,P.pr)(S);U[this.currentElementIdx]=R,p.data(U);var G=_.name,Q=this.getEdgeView(),pt=Q.getOptions().data;pt.forEach(function(yt){yt.source===G&&(yt.x[0]+=L.x,yt.x[1]+=L.x,yt.y[0]+=L.y,yt.y[1]+=L.y),yt.target===G&&(yt.x[2]+=L.x,yt.x[3]+=L.x,yt.y[2]+=L.y,yt.y[3]+=L.y)}),Q.data(pt),this.prevPoint=i,t.render(!0)}}},e.prototype.end=function(){this.isDragging=!1,this.context.isDragging=!1,this.prevPoint=null,this.currentElementIdx=null,this.getNodeView().animate(this.prevNodeAnimateCfg),this.getEdgeView().animate(this.prevEdgeAnimateCfg)},e}(oi);Yn("sankey-node-drag",W4),kn("sankey-node-draggable",{showEnable:[{trigger:"polygon:mouseenter",action:"cursor:pointer"},{trigger:"polygon:mouseleave",action:"cursor:default"}],start:[{trigger:"polygon:mousedown",action:"sankey-node-drag:start"}],processing:[{trigger:"plot:mousemove",action:"sankey-node-drag:translate"},{isEnable:function(r){return r.isDragging},trigger:"plot:mousemove",action:"cursor:move"}],end:[{trigger:"plot:mouseup",action:"sankey-node-drag:end"}]});var CF=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="sankey",t}return e.getDefaultOptions=function(){return{appendPadding:8,syncViewPadding:!0,nodeStyle:{opacity:1,fillOpacity:1,lineWidth:1},edgeStyle:{opacity:.3,lineWidth:0},edgeState:{active:{style:{opacity:.8,lineWidth:0}}},label:{formatter:function(t){var i=t.name;return i},callback:function(t){var i=t[1]===1;return{style:{fill:"#545454",textAlign:i?"end":"start"},offsetX:i?-8:8}},layout:[{type:"hide-overlap"}]},tooltip:{showTitle:!1,showMarkers:!1,shared:!1,showContent:function(t){return!(0,b.U2)(t,[0,"data","isNode"])},formatter:function(t){var i=t.source,u=t.target,c=t.value;return{name:i+" -> "+u,value:c}}},nodeWidthRatio:.008,nodePaddingRatio:.01,animation:{appear:{animation:"wave-in"},enter:{animation:"wave-in"}}}},e.prototype.changeData=function(t){this.updateOption({data:t});var i=YC(this.options,this.chart.width,this.chart.height),u=i.nodes,c=i.edges,p=yo(this.chart,f_),g=yo(this.chart,h_);p.changeData(u),g.changeData(c)},e.prototype.getSchemaAdaptor=function(){return j4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),g_="ancestor-node",qC="value",Am="path",X4=[Am,ub,e_,lb,"name","depth","height"],Y4=hn({},Ha.getDefaultOptions(),{innerRadius:0,radius:.85,hierarchyConfig:{field:"value"},tooltip:{shared:!0,showMarkers:!1,offset:20,showTitle:!1},legend:!1,sunburstStyle:{lineWidth:.5,stroke:"#FFF"},drilldown:{enabled:!0}});function KC(r){r.x0=Math.round(r.x0),r.y0=Math.round(r.y0),r.x1=Math.round(r.x1),r.y1=Math.round(r.y1)}function Tm(r,e,t,i,u){for(var c=r.children,p,g=-1,_=c.length,S=r.value&&(i-e)/r.value;++g<_;)p=c[g],p.y0=t,p.y1=u,p.x0=e,p.x1=e+=p.value*S}function Mb(){var r=1,e=1,t=0,i=!1;function u(p){var g=p.height+1;return p.x0=p.y0=t,p.x1=r,p.y1=e/g,p.eachBefore(c(e,g)),i&&p.eachBefore(KC),p}function c(p,g){return function(_){_.children&&Tm(_,_.x0,p*(_.depth+1)/g,_.x1,p*(_.depth+2)/g);var S=_.x0,k=_.y0,L=_.x1-t,R=_.y1-t;L<S&&(S=L=(S+L)/2),R<k&&(k=R=(k+R)/2),_.x0=S,_.y0=k,_.x1=L,_.y1=R}}return u.round=function(p){return arguments.length?(i=!!p,u):i},u.size=function(p){return arguments.length?(r=+p[0],e=+p[1],u):[r,e]},u.padding=function(p){return arguments.length?(t=+p,u):t},u}var $4={field:"value",size:[1,1],round:!1,padding:0,sort:function(r,e){return e.value-r.value},as:["x","y"],ignoreParentValue:!0};function q4(r,e){e=(0,b.f0)({},$4,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var i;try{i=cb(e)}catch(_){console.warn(_)}var u=function(_){return Mb().size(e.size).round(e.round).padding(e.padding)(Tg(_).sum(function(S){return(0,b.dp)(S.children)?e.ignoreParentValue?0:S[i]-(0,b.u4)(S.children,function(k,L){return k+L[i]},0):S[i]}).sort(e.sort))},c=u(r),p=t[0],g=t[1];return c.each(function(_){var S,k;_[p]=[_.x0,_.x1,_.x1,_.x0],_[g]=[_.y1,_.y1,_.y0,_.y0],_.name=_.name||((S=_.data)===null||S===void 0?void 0:S.name)||((k=_.data)===null||k===void 0?void 0:k.label),_.data.name=_.name,["x0","x1","y0","y1"].forEach(function(L){t.indexOf(L)===-1&&delete _[L]})}),Mg(c)}function K4(r,e){return r.parent===e.parent?1:2}function Q4(r){return r.reduce(J4,0)/r.length}function J4(r,e){return r+e.x}function tL(r){return 1+r.reduce(eL,0)}function eL(r,e){return Math.max(r,e.y)}function rL(r){for(var e;e=r.children;)r=e[0];return r}function QC(r){for(var e;e=r.children;)r=e[e.length-1];return r}function JC(){var r=K4,e=1,t=1,i=!1;function u(c){var p,g=0;c.eachAfter(function(R){var U=R.children;U?(R.x=Q4(U),R.y=tL(U)):(R.x=p?g+=r(R,p):0,R.y=0,p=R)});var _=rL(c),S=QC(c),k=_.x-r(_,S)/2,L=S.x+r(S,_)/2;return c.eachAfter(i?function(R){R.x=(R.x-c.x)*e,R.y=(c.y-R.y)*t}:function(R){R.x=(R.x-k)/(L-k)*e,R.y=(1-(c.y?R.y/c.y:1))*t})}return u.separation=function(c){return arguments.length?(r=c,u):r},u.size=function(c){return arguments.length?(i=!1,e=+c[0],t=+c[1],u):i?null:[e,t]},u.nodeSize=function(c){return arguments.length?(i=!0,e=+c[0],t=+c[1],u):i?[e,t]:null},u}var tA={depth:-1},z0={};function eA(r){return r.id}function nL(r){return r.parentId}function iL(){var r=eA,e=nL;function t(i){var u=Array.from(i),c=u.length,p,g,_,S,k,L,R,U=new Map;for(g=0;g<c;++g)p=u[g],k=u[g]=new F0(p),(L=r(p,g,i))!=null&&(L+="")&&(R=k.id=L,U.set(R,U.has(R)?z0:k)),(L=e(p,g,i))!=null&&(L+="")&&(k.parent=L);for(g=0;g<c;++g)if(k=u[g],L=k.parent){if(S=U.get(L),!S)throw new Error("missing: "+L);if(S===z0)throw new Error("ambiguous: "+L);S.children?S.children.push(k):S.children=[k],k.parent=S}else{if(_)throw new Error("multiple roots");_=k}if(!_)throw new Error("no root");if(_.parent=tA,_.eachBefore(function(G){G.depth=G.parent.depth+1,--c}).eachBefore(uC),_.parent=null,c>0)throw new Error("cycle");return _}return t.id=function(i){return arguments.length?(r=xm(i),t):r},t.parentId=function(i){return arguments.length?(e=xm(i),t):e},t}function aL(r,e){return r.parent===e.parent?1:2}function Ib(r){var e=r.children;return e?e[0]:r.t}function U0(r){var e=r.children;return e?e[e.length-1]:r.t}function Mm(r,e,t){var i=t/(e.i-r.i);e.c-=i,e.s+=t,r.c+=i,e.z+=t,e.m+=t}function Im(r){for(var e=0,t=0,i=r.children,u=i.length,c;--u>=0;)c=i[u],c.z+=e,c.m+=e,e+=c.s+(t+=c.c)}function km(r,e,t){return r.a.parent===e.parent?r.a:t}function m_(r,e){this._=r,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}m_.prototype=Object.create(F0.prototype);function rA(r){for(var e=new m_(r,0),t,i=[e],u,c,p,g;t=i.pop();)if(c=t._.children)for(t.children=new Array(g=c.length),p=g-1;p>=0;--p)i.push(u=t.children[p]=new m_(c[p],p)),u.parent=t;return(e.parent=new m_(null,0)).children=[e],e}function kb(){var r=aL,e=1,t=1,i=null;function u(S){var k=rA(S);if(k.eachAfter(c),k.parent.m=-k.z,k.eachBefore(p),i)S.eachBefore(_);else{var L=S,R=S,U=S;S.eachBefore(function(Ht){Ht.x<L.x&&(L=Ht),Ht.x>R.x&&(R=Ht),Ht.depth>U.depth&&(U=Ht)});var G=L===R?1:r(L,R)/2,Q=G-L.x,pt=e/(R.x+G+Q),yt=t/(U.depth||1);S.eachBefore(function(Ht){Ht.x=(Ht.x+Q)*pt,Ht.y=Ht.depth*yt})}return S}function c(S){var k=S.children,L=S.parent.children,R=S.i?L[S.i-1]:null;if(k){Im(S);var U=(k[0].z+k[k.length-1].z)/2;R?(S.z=R.z+r(S._,R._),S.m=S.z-U):S.z=U}else R&&(S.z=R.z+r(S._,R._));S.parent.A=g(S,R,S.parent.A||L[0])}function p(S){S._.x=S.z+S.parent.m,S.m+=S.parent.m}function g(S,k,L){if(k){for(var R=S,U=S,G=k,Q=R.parent.children[0],pt=R.m,yt=U.m,Ht=G.m,ce=Q.m,he;G=U0(G),R=Ib(R),G&&R;)Q=Ib(Q),U=U0(U),U.a=S,he=G.z+Ht-R.z-pt+r(G._,R._),he>0&&(Mm(km(G,S,L),S,he),pt+=he,yt+=he),Ht+=G.m,pt+=R.m,ce+=Q.m,yt+=U.m;G&&!U0(U)&&(U.t=G,U.m+=Ht-yt),R&&!Ib(Q)&&(Q.t=R,Q.m+=pt-ce,L=S)}return L}function _(S){S.x*=e,S.y=S.depth*t}return u.separation=function(S){return arguments.length?(r=S,u):r},u.size=function(S){return arguments.length?(i=!1,e=+S[0],t=+S[1],u):i?null:[e,t]},u.nodeSize=function(S){return arguments.length?(i=!0,e=+S[0],t=+S[1],u):i?[e,t]:null},u}function y_(r,e,t,i,u){for(var c=r.children,p,g=-1,_=c.length,S=r.value&&(u-t)/r.value;++g<_;)p=c[g],p.x0=e,p.x1=i,p.y0=t,p.y1=t+=p.value*S}var nA=(1+Math.sqrt(5))/2;function Lb(r,e,t,i,u,c){for(var p=[],g=e.children,_,S,k=0,L=0,R=g.length,U,G,Q=e.value,pt,yt,Ht,ce,he,ze,Er;k<R;){U=u-t,G=c-i;do pt=g[L++].value;while(!pt&&L<R);for(yt=Ht=pt,ze=Math.max(G/U,U/G)/(Q*r),Er=pt*pt*ze,he=Math.max(Ht/Er,Er/yt);L<R;++L){if(pt+=S=g[L].value,S<yt&&(yt=S),S>Ht&&(Ht=S),Er=pt*pt*ze,ce=Math.max(Ht/Er,Er/yt),ce>he){pt-=S;break}he=ce}p.push(_={value:pt,dice:U<G,children:g.slice(k,L)}),_.dice?Tm(_,t,i,u,Q?i+=G*pt/Q:c):y_(_,t,i,Q?t+=U*pt/Q:u,c),Q-=pt,k=L}return p}var iA=function r(e){function t(i,u,c,p,g){Lb(e,i,u,c,p,g)}return t.ratio=function(i){return r((i=+i)>1?i:1)},t}(nA);function oL(){var r=iA,e=!1,t=1,i=1,u=[0],c=P0,p=P0,g=P0,_=P0,S=P0;function k(R){return R.x0=R.y0=0,R.x1=t,R.y1=i,R.eachBefore(L),u=[0],e&&R.eachBefore(KC),R}function L(R){var U=u[R.depth],G=R.x0+U,Q=R.y0+U,pt=R.x1-U,yt=R.y1-U;pt<G&&(G=pt=(G+pt)/2),yt<Q&&(Q=yt=(Q+yt)/2),R.x0=G,R.y0=Q,R.x1=pt,R.y1=yt,R.children&&(U=u[R.depth+1]=c(R)/2,G+=S(R)-U,Q+=p(R)-U,pt-=g(R)-U,yt-=_(R)-U,pt<G&&(G=pt=(G+pt)/2),yt<Q&&(Q=yt=(Q+yt)/2),r(R,G,Q,pt,yt))}return k.round=function(R){return arguments.length?(e=!!R,k):e},k.size=function(R){return arguments.length?(t=+R[0],i=+R[1],k):[t,i]},k.tile=function(R){return arguments.length?(r=xm(R),k):r},k.padding=function(R){return arguments.length?k.paddingInner(R).paddingOuter(R):k.paddingInner()},k.paddingInner=function(R){return arguments.length?(c=typeof R=="function"?R:ev(+R),k):c},k.paddingOuter=function(R){return arguments.length?k.paddingTop(R).paddingRight(R).paddingBottom(R).paddingLeft(R):k.paddingTop()},k.paddingTop=function(R){return arguments.length?(p=typeof R=="function"?R:ev(+R),k):p},k.paddingRight=function(R){return arguments.length?(g=typeof R=="function"?R:ev(+R),k):g},k.paddingBottom=function(R){return arguments.length?(_=typeof R=="function"?R:ev(+R),k):_},k.paddingLeft=function(R){return arguments.length?(S=typeof R=="function"?R:ev(+R),k):S},k}function __(r,e,t,i,u){var c=r.children,p,g=c.length,_,S=new Array(g+1);for(S[0]=_=p=0;p<g;++p)S[p+1]=_+=c[p].value;k(0,g,r.value,e,t,i,u);function k(L,R,U,G,Q,pt,yt){if(L>=R-1){var Ht=c[L];Ht.x0=G,Ht.y0=Q,Ht.x1=pt,Ht.y1=yt;return}for(var ce=S[L],he=U/2+ce,ze=L+1,Er=R-1;ze<Er;){var Fr=ze+Er>>>1;S[Fr]<he?ze=Fr+1:Er=Fr}he-S[ze-1]<S[ze]-he&&L+1<ze&&--ze;var zr=S[ze]-ce,pn=U-zr;if(pt-G>yt-Q){var nn=U?(G*pn+pt*zr)/U:pt;k(L,ze,zr,G,Q,nn,yt),k(ze,R,pn,nn,Q,pt,yt)}else{var Pn=U?(Q*pn+yt*zr)/U:yt;k(L,ze,zr,G,Q,pt,Pn),k(ze,R,pn,G,Pn,pt,yt)}}}function Lm(r,e,t,i,u){(r.depth&1?y_:Tm)(r,e,t,i,u)}var aA=function r(e){function t(i,u,c,p,g){if((_=i._squarify)&&_.ratio===e)for(var _,S,k,L,R=-1,U,G=_.length,Q=i.value;++R<G;){for(S=_[R],k=S.children,L=S.value=0,U=k.length;L<U;++L)S.value+=k[L].value;S.dice?Tm(S,u,c,p,Q?c+=(g-c)*S.value/Q:g):y_(S,u,c,Q?u+=(p-u)*S.value/Q:p,g),Q-=S.value}else i._squarify=_=Lb(e,i,u,c,p,g),_.ratio=e}return t.ratio=function(i){return r((i=+i)>1?i:1)},t}(nA),sL={field:"value",tile:"treemapSquarify",size:[1,1],round:!1,ignoreParentValue:!0,padding:0,paddingInner:0,paddingOuter:0,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0,as:["x","y"],sort:function(r,e){return e.value-r.value},ratio:.5*(1+Math.sqrt(5))};function uL(r,e){return r==="treemapSquarify"?Zt[r].ratio(e):Zt[r]}function Pb(r,e){e=(0,b.f0)({},sL,e);var t=e.as;if(!(0,b.kJ)(t)||t.length!==2)throw new TypeError('Invalid as: it must be an array with 2 strings (e.g. [ "x", "y" ])!');var i;try{i=cb(e)}catch(S){console.warn(S)}var u=uL(e.tile,e.ratio),c=function(S){return oL().tile(u).size(e.size).round(e.round).padding(e.padding).paddingInner(e.paddingInner).paddingOuter(e.paddingOuter).paddingTop(e.paddingTop).paddingRight(e.paddingRight).paddingBottom(e.paddingBottom).paddingLeft(e.paddingLeft)(Tg(S).sum(function(k){return e.ignoreParentValue&&k.children?0:k[i]}).sort(e.sort))},p=c(r),g=t[0],_=t[1];return p.each(function(S){S[g]=[S.x0,S.x1,S.x1,S.x0],S[_]=[S.y1,S.y1,S.y0,S.y0],["x0","x1","y0","y1"].forEach(function(k){t.indexOf(k)===-1&&delete S[k]})}),Mg(p)}function lL(r){var e=r.data,t=r.colorField,i=r.rawFields,u=r.hierarchyConfig,c=u===void 0?{}:u,p=c.activeDepth,g={partition:q4,treemap:Pb},_=r.seriesField,S=r.type||"partition",k=g[S](e,(0,P.pi)((0,P.pi)({field:_||"value"},(0,b.CE)(c,["activeDepth"])),{type:"hierarchy."+S,as:["x","y"]})),L=[];return k.forEach(function(R){var U,G,Q,pt,yt,Ht;if(R.depth===0||p>0&&R.depth>p)return null;for(var ce=R.data.name,he=(0,P.pi)({},R);he.depth>1;)ce=((G=he.parent.data)===null||G===void 0?void 0:G.name)+" / "+ce,he=he.parent;var ze=(0,P.pi)((0,P.pi)((0,P.pi)({},fs(R.data,(0,P.pr)(i||[],[c.field]))),(U={},U[Am]=ce,U[g_]=he.data.name,U)),R);_&&(ze[_]=R.data[_]||((pt=(Q=R.parent)===null||Q===void 0?void 0:Q.data)===null||pt===void 0?void 0:pt[_])),t&&(ze[t]=R.data[t]||((Ht=(yt=R.parent)===null||yt===void 0?void 0:yt.data)===null||Ht===void 0?void 0:Ht[t])),ze.ext=c,ze[Yy]={hierarchyConfig:c,colorField:t,rawFields:i},L.push(ze)}),L}function cL(r){var e=r.chart,t=r.options,i=t.color,u=t.colorField,c=u===void 0?g_:u,p=t.sunburstStyle,g=t.rawFields,_=g===void 0?[]:g,S=lL(t);e.data(S);var k;return p&&(k=function(L){return hn({},{fillOpacity:Math.pow(.85,L.depth)},(0,b.mf)(p)?p(L):p)}),gg(hn({},r,{options:{xField:"x",yField:"y",seriesField:c,rawFields:(0,b.jj)((0,P.pr)(X4,_)),polygon:{color:i,style:k}}})),r}function x_(r){var e=r.chart;return e.axis(!1),r}function oA(r){var e=r.chart,t=r.options,i=t.label,u=Ec(e,"polygon");if(!i)u.label(!1);else{var c=i.fields,p=c===void 0?["name"]:c,g=i.callback,_=(0,P._T)(i,["fields","callback"]);u.label({fields:p,callback:g,cfg:Os(_)})}return r}function fL(r){var e=r.chart,t=r.options,i=t.innerRadius,u=t.radius,c=t.reflect,p=e.coordinate({type:"polar",cfg:{innerRadius:i,radius:u}});return c&&p.reflect(c),r}function hL(r){var e,t=r.options,i=t.hierarchyConfig,u=t.meta;return Ga(Zs({},(e={},e[qC]=(0,b.U2)(u,(0,b.U2)(i,["field"],"value")),e)))(r)}function sA(r){var e=r.chart,t=r.options,i=t.tooltip;if(i===!1)e.tooltip(!1);else{var u=i;(0,b.U2)(i,"fields")||(u=hn({},{customItems:function(c){return c.map(function(p){var g=(0,b.U2)(e.getOptions(),"scales"),_=(0,b.U2)(g,[Am,"formatter"],function(k){return k}),S=(0,b.U2)(g,[qC,"formatter"],function(k){return k});return(0,P.pi)((0,P.pi)({},p),{name:_(p.data[Am]),value:S(p.data.value)})})}},u)),e.tooltip(u)}return r}function AF(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t;return e!=null&&e.enabled?hn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:lL}}])}):r}function uA(r){var e=r.chart,t=r.options,i=t.drilldown;return Xs({chart:e,options:AF(t)}),i!=null&&i.enabled&&(e.appendPadding=My(e.appendPadding,(0,b.U2)(i,["breadCrumb","position"]))),r}function ch(r){return Ga(Bo,Nh("sunburstStyle"),cL,x_,hL,vg,fL,sA,oA,uA,ms,Ys())(r)}var pL=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="sunburst",t}return e.getDefaultOptions=function(){return Y4},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return ch},e.SUNBURST_ANCESTOR_FIELD=g_,e.SUNBURST_PATH_FIELD=Am,e.NODE_ANCESTORS_FIELD=e_,e}(Ha);function Ob(r,e){if(!!(0,b.kJ)(r))return r.find(function(t){return t.type===e})}function lA(r,e){var t=Ob(r,e);return t&&t.enable!==!1}function Fb(r){var e=r.interactions,t=r.drilldown;return(0,b.U2)(t,"enabled")||lA(e,"treemap-drill-down")}function dL(r){var e=r.interactions["drill-down"];if(!!e){var t=e.context.actions.find(function(i){return i.name==="drill-down-action"});t.reset()}}function b_(r){var e=r.data,t=r.colorField,i=r.enableDrillDown,u=r.hierarchyConfig,c=Pb(e,(0,P.pi)((0,P.pi)({},u),{type:"hierarchy.treemap",field:"value",as:["x","y"]})),p=[];return c.forEach(function(g){if(g.depth===0||i&&g.depth!==1||!i&&g.children)return null;var _=g.ancestors().map(function(R){return{data:R.data,height:R.height,value:R.value}}),S=i&&(0,b.kJ)(e.path)?_.concat(e.path.slice(1)):_,k=Object.assign({},g.data,(0,P.pi)({x:g.x,y:g.y,depth:g.depth,value:g.value,path:S},g));if(!g.data[t]&&g.parent){var L=g.ancestors().find(function(R){return R.data[t]});k[t]=L==null?void 0:L.data[t]}else k[t]=g.data[t];k[Yy]={hierarchyConfig:u,colorField:t,enableDrillDown:i},p.push(k)}),p}function cA(r){var e=r.options,t=e.colorField;return hn({options:{rawFields:["value"],tooltip:{fields:["name","value",t,"path"],formatter:function(i){return{name:i.name,value:i.value}}}}},r)}function vL(r){var e=r.chart,t=r.options,i=t.color,u=t.colorField,c=t.rectStyle,p=t.hierarchyConfig,g=t.rawFields,_=b_({data:t.data,colorField:t.colorField,enableDrillDown:Fb(t),hierarchyConfig:p});return e.data(_),gg(hn({},r,{options:{xField:"x",yField:"y",seriesField:u,rawFields:g,polygon:{color:i,style:c}}})),e.coordinate().reflect("y"),r}function gL(r){var e=r.chart;return e.axis(!1),r}function mL(r){var e=r.drilldown,t=r.interactions,i=t===void 0?[]:t,u=Fb(r);return u?hn({},r,{interactions:(0,P.pr)(i,[{type:"drill-down",cfg:{drillDownConfig:e,transformData:b_}}])}):r}function yL(r){var e=r.chart,t=r.options,i=t.interactions,u=t.drilldown;Xs({chart:e,options:mL(t)});var c=Ob(i,"view-zoom");c&&(c.enable!==!1?e.getCanvas().on("mousewheel",function(g){g.preventDefault()}):e.getCanvas().off("mousewheel"));var p=Fb(t);return p&&(e.appendPadding=My(e.appendPadding,(0,b.U2)(u,["breadCrumb","position"]))),r}function _L(r){return Ga(cA,Bo,Nh("rectStyle"),vL,gL,vg,hl,yL,ms,Ys())(r)}var xL={colorField:"name",rectStyle:{lineWidth:1,stroke:"#fff"},hierarchyConfig:{tile:"treemapSquarify"},label:{fields:["name"],layout:{type:"limit-in-shape"}},tooltip:{showMarkers:!1,showTitle:!1},drilldown:{enabled:!1,breadCrumb:{position:"bottom-left",rootText:"\u521D\u59CB",dividerText:"/",textStyle:{fontSize:12,fill:"rgba(0, 0, 0, 0.65)",cursor:"pointer"},activeTextStyle:{fill:"#87B5FF"}}}},E_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="treemap",t}return e.getDefaultOptions=function(){return xL},e.prototype.changeData=function(t){var i=this.options,u=i.colorField,c=i.interactions,p=i.hierarchyConfig;this.updateOption({data:t});var g=b_({data:t,colorField:u,enableDrillDown:lA(c,"treemap-drill-down"),hierarchyConfig:p});this.chart.changeData(g),dL(this.chart)},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _L},e}(Ha),fh="id",Rb="path",bL={appendPadding:[10,0,20,0],blendMode:"multiply",tooltip:{showTitle:!1,showMarkers:!1,fields:["id","size"],formatter:function(r){return{name:r.id,value:r.size}}},legend:{position:"top-left"},label:{style:{textAlign:"center",fill:"#fff"}},interactions:[{type:"legend-filter",enable:!1}],state:{active:{style:{stroke:"#000"}},selected:{style:{stroke:"#000",lineWidth:2}},inactive:{style:{fillOpacity:.3,strokeOpacity:.3}}},defaultInteractions:["tooltip","venn-legend-active"]};function w_(r){if(!!r){var e=r.geometries[0].elements;e.forEach(function(t){t.shape.toFront()})}}var Z0=Ua("element-active"),EL=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){w_(this.context.view)},e.prototype.active=function(){r.prototype.active.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(Z0),wL=Ua("element-highlight"),S_=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){w_(this.context.view)},e.prototype.highlight=function(){r.prototype.highlight.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.clear=function(){r.prototype.clear.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(wL),SL=Ua("element-selected"),CL=Ua("element-single-selected"),AL=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){w_(this.context.view)},e.prototype.selected=function(){r.prototype.selected.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(SL),TL=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.syncElementsPos=function(){w_(this.context.view)},e.prototype.selected=function(){r.prototype.selected.call(this),this.syncElementsPos()},e.prototype.toggle=function(){r.prototype.toggle.call(this),this.syncElementsPos()},e.prototype.reset=function(){r.prototype.reset.call(this),this.syncElementsPos()},e}(CL);Yn("venn-element-active",EL),Yn("venn-element-highlight",S_),Yn("venn-element-selected",AL),Yn("venn-element-single-selected",TL),kn("venn-element-active",{start:[{trigger:"element:mouseenter",action:"venn-element-active:active"}],end:[{trigger:"element:mouseleave",action:"venn-element-active:reset"}]}),kn("venn-element-highlight",{start:[{trigger:"element:mouseenter",action:"venn-element-highlight:highlight"}],end:[{trigger:"element:mouseleave",action:"venn-element-highlight:reset"}]}),kn("venn-element-selected",{start:[{trigger:"element:click",action:"venn-element-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-selected:reset"]}]}),kn("venn-element-single-selected",{start:[{trigger:"element:click",action:"venn-element-single-selected:toggle"}],rollback:[{trigger:"dblclick",action:["venn-element-single-selected:reset"]}]}),kn("venn-legend-active",{start:[{trigger:"legend-item:mouseenter",action:["list-active:active","venn-element-active:active"]}],end:[{trigger:"legend-item:mouseleave",action:["list-active:reset","venn-element-active:reset"]}]}),kn("venn-legend-highlight",{start:[{trigger:"legend-item:mouseenter",action:["legend-item-highlight:highlight","venn-element-highlight:highlight"]}],end:[{trigger:"legend-item:mouseleave",action:["legend-item-highlight:reset","venn-element-highlight:reset"]}]});var ML=function(r){(0,P.ZT)(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getLabelPoint=function(t,i,u){var c=t.data,p=c.x,g=c.y,_=t.customLabelInfo,S=_.offsetX,k=_.offsetY;return{content:t.content[u],x:p+S,y:g+k}},e}(zd);lu("venn",ML);function IL(r){return hn({},r.defaultStyle,{fill:r.color},r.style)}va("schema","venn",{draw:function(r,e){var t=r.data,i=(0,rf.tr)(t[Rb]),u=IL(r),c=e.addGroup({name:"venn-shape"});c.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},u),{path:i}),name:"venn-path"});var p=r.customInfo,g=p.offsetX,_=p.offsetY,S=_c.transform(null,[["t",g,_]]);return c.setMatrix(S),c},getMarker:function(r){var e=r.color;return{symbol:"circle",style:{lineWidth:0,stroke:e,fill:e,r:4}}}});var kL=function(r){return function(e,t){var i=[];return i[0]=r(e[0],t[0]),i[1]=r(e[1],t[1]),i[2]=r(e[2],t[2]),i}},fA={normal:function(r){return r},multiply:function(r,e){return r*e/255},screen:function(r,e){return 255*(1-(1-r/255)*(1-e/255))},overlay:function(r,e){return e<128?2*r*e/255:255*(1-2*(1-r/255)*(1-e/255))},darken:function(r,e){return r>e?e:r},lighten:function(r,e){return r>e?r:e},dodge:function(r,e){return r===255?255:(r=255*(e/255)/(1-r/255),r>255?255:r)},burn:function(r,e){return e===255?255:r===0?0:255*(1-Math.min(1,(1-e/255)/(r/255)))}},LL=function(r){if(!fA[r])throw new Error("unknown blend mode "+r);return fA[r]};function PL(r,e,t){t===void 0&&(t="normal");var i=kL(LL(t))(C_(r),C_(e)),u=C_(r),c=u[0],p=u[1],g=u[2],_=u[3],S=C_(e),k=S[0],L=S[1],R=S[2],U=S[3],G=Number((_+U*(1-_)).toFixed(2)),Q=Math.round((_*(1-U)*(c/255)+_*U*(i[0]/255)+(1-_)*U*(k/255))/G*255),pt=Math.round((_*(1-U)*(p/255)+_*U*(i[1]/255)+(1-_)*U*(L/255))/G*255),yt=Math.round((_*(1-U)*(g/255)+_*U*(i[2]/255)+(1-_)*U*(R/255))/G*255);return"rgba("+Q+", "+pt+", "+yt+", "+G+")"}function C_(r){var e=r.replace("/s+/g",""),t;return typeof e=="string"&&!e.startsWith("rgba")&&!e.startsWith("#")?t=Ya.rgb2arr(Ya.toRGB(e)).concat([1]):(e.startsWith("rgba")&&(t=e.replace("rgba(","").replace(")","").split(",")),e.startsWith("#")&&(t=Ya.rgb2arr(e).concat([1])),t.map(function(i,u){return u===3?Number(i):i|0}))}var ld=ot(87026),hA=1e-10;function Db(r,e){var t=FL(r),i=t.filter(function(Fr){return OL(Fr,r)}),u=0,c=0,p,g=[];if(i.length>1){var _=Nb(i);for(p=0;p<i.length;++p){var S=i[p];S.angle=Math.atan2(S.x-_.x,S.y-_.y)}i.sort(function(Fr,zr){return zr.angle-Fr.angle});var k=i[i.length-1];for(p=0;p<i.length;++p){var L=i[p];c+=(k.x+L.x)*(L.y-k.y);for(var R={x:(L.x+k.x)/2,y:(L.y+k.y)/2},U=null,G=0;G<L.parentIndex.length;++G)if(k.parentIndex.indexOf(L.parentIndex[G])>-1){var Q=r[L.parentIndex[G]],pt=Math.atan2(L.x-Q.x,L.y-Q.y),yt=Math.atan2(k.x-Q.x,k.y-Q.y),Ht=yt-pt;Ht<0&&(Ht+=2*Math.PI);var ce=yt-Ht/2,he=Mp(R,{x:Q.x+Q.radius*Math.sin(ce),y:Q.y+Q.radius*Math.cos(ce)});he>Q.radius*2&&(he=Q.radius*2),(U===null||U.width>he)&&(U={circle:Q,width:he,p1:L,p2:k})}U!==null&&(g.push(U),u+=Bb(U.circle.radius,U.width),k=L)}}else{var ze=r[0];for(p=1;p<r.length;++p)r[p].radius<ze.radius&&(ze=r[p]);var Er=!1;for(p=0;p<r.length;++p)if(Mp(r[p],ze)>Math.abs(ze.radius-r[p].radius)){Er=!0;break}Er?u=c=0:(u=ze.radius*ze.radius*Math.PI,g.push({circle:ze,p1:{x:ze.x,y:ze.y+ze.radius},p2:{x:ze.x-hA,y:ze.y+ze.radius},width:ze.radius*2}))}return c/=2,e&&(e.area=u+c,e.arcArea=u,e.polygonArea=c,e.arcs=g,e.innerPoints=i,e.intersectionPoints=t),u+c}function OL(r,e){for(var t=0;t<e.length;++t)if(Mp(r,e[t])>e[t].radius+hA)return!1;return!0}function FL(r){for(var e=[],t=0;t<r.length;++t)for(var i=t+1;i<r.length;++i)for(var u=dA(r[t],r[i]),c=0;c<u.length;++c){var p=u[c];p.parentIndex=[t,i],e.push(p)}return e}function Bb(r,e){return r*r*Math.acos(1-e/r)-(r-e)*Math.sqrt(e*(2*r-e))}function Mp(r,e){return Math.sqrt((r.x-e.x)*(r.x-e.x)+(r.y-e.y)*(r.y-e.y))}function pA(r,e,t){if(t>=r+e)return 0;if(t<=Math.abs(r-e))return Math.PI*Math.min(r,e)*Math.min(r,e);var i=r-(t*t-e*e+r*r)/(2*t),u=e-(t*t-r*r+e*e)/(2*t);return Bb(r,i)+Bb(e,u)}function dA(r,e){var t=Mp(r,e),i=r.radius,u=e.radius;if(t>=i+u||t<=Math.abs(i-u))return[];var c=(i*i-u*u+t*t)/(2*t),p=Math.sqrt(i*i-c*c),g=r.x+c*(e.x-r.x)/t,_=r.y+c*(e.y-r.y)/t,S=-(e.y-r.y)*(p/t),k=-(e.x-r.x)*(p/t);return[{x:g+S,y:_-k},{x:g-S,y:_+k}]}function Nb(r){for(var e={x:0,y:0},t=0;t<r.length;++t)e.x+=r[t].x,e.y+=r[t].y;return e.x/=r.length,e.y/=r.length,e}function zb(r,e,t){var i=e[0].radius-Mp(e[0],r),u,c;for(u=1;u<e.length;++u)c=e[u].radius-Mp(e[u],r),c<=i&&(i=c);for(u=0;u<t.length;++u)c=Mp(t[u],r)-t[u].radius,c<=i&&(i=c);return i}function vA(r,e){var t=[],i;for(i=0;i<r.length;++i){var u=r[i];t.push({x:u.x,y:u.y}),t.push({x:u.x+u.radius/2,y:u.y}),t.push({x:u.x-u.radius/2,y:u.y}),t.push({x:u.x,y:u.y+u.radius/2}),t.push({x:u.x,y:u.y-u.radius/2})}var c=t[0],p=zb(t[0],r,e);for(i=1;i<t.length;++i){var g=zb(t[i],r,e);g>=p&&(c=t[i],p=g)}var _=(0,ld.nelderMead)(function(R){return-1*zb({x:R[0],y:R[1]},r,e)},[c.x,c.y],{maxIterations:500,minErrorDelta:1e-10}).x,S={x:_[0],y:_[1]},k=!0;for(i=0;i<r.length;++i)if(Mp(S,r[i])>r[i].radius){k=!1;break}for(i=0;i<e.length;++i)if(Mp(S,e[i])<e[i].radius){k=!1;break}if(!k)if(r.length==1)S={x:r[0].x,y:r[0].y};else{var L={};Db(r,L),L.arcs.length===0?S={x:0,y:-1e3,disjoint:!0}:L.arcs.length==1?S={x:L.arcs[0].circle.x,y:L.arcs[0].circle.y}:e.length?S=vA(r,[]):S=Nb(L.arcs.map(function(R){return R.p1}))}return S}function RL(r){var e={},t=[];for(var i in r)t.push(i),e[i]=[];for(var u=0;u<t.length;u++)for(var c=r[t[u]],p=u+1;p<t.length;++p){var g=r[t[p]],_=Mp(c,g);_+g.radius<=c.radius+1e-10?e[t[p]].push(t[u]):_+c.radius<=g.radius+1e-10&&e[t[u]].push(t[p])}return e}function DL(r,e){for(var t={},i=RL(r),u=0;u<e.length;++u){for(var c=e[u].sets,p={},g={},_=0;_<c.length;++_){p[c[_]]=!0;for(var S=i[c[_]],k=0;k<S.length;++k)g[S[k]]=!0}var L=[],R=[];for(var U in r)U in p?L.push(r[U]):U in g||R.push(r[U]);var G=vA(L,R);t[c]=G,G.disjoint&&e[u].size>0&&console.log("WARNING: area "+c+" not represented on screen")}return t}function BL(r,e,t){var i=[],u=r-t,c=e;return i.push("M",u,c),i.push("A",t,t,0,1,0,u+2*t,c),i.push("A",t,t,0,1,0,u,c),i.join(" ")}function TF(r){var e=r.split(" ");return{x:parseFloat(e[1]),y:parseFloat(e[2]),radius:-parseFloat(e[4])}}function NL(r){var e={};Db(r,e);var t=e.arcs;if(t.length===0)return"M 0 0";if(t.length==1){var i=t[0].circle;return BL(i.x,i.y,i.radius)}else{for(var u=[`
M`,t[0].p2.x,t[0].p2.y],c=0;c<t.length;++c){var p=t[c],g=p.circle.radius,_=p.width>g;u.push(`
A`,g,g,0,_?1:0,1,p.p1.x,p.p1.y)}return u.join(" ")}}function zL(r,e){e=e||{},e.maxIterations=e.maxIterations||500;var t=e.initialLayout||GL,i=e.lossFunction||Pm;r=UL(r);var u=t(r,e),c=[],p=[],g;for(g in u)u.hasOwnProperty(g)&&(c.push(u[g].x),c.push(u[g].y),p.push(g));for(var _=(0,ld.nelderMead)(function(L){for(var R={},U=0;U<p.length;++U){var G=p[U];R[G]={x:L[2*U],y:L[2*U+1],radius:u[G].radius}}return i(R,r)},c,e),S=_.x,k=0;k<p.length;++k)g=p[k],u[g].x=S[2*k],u[g].y=S[2*k+1];return u}var gA=1e-10;function Ub(r,e,t){return Math.min(r,e)*Math.min(r,e)*Math.PI<=t+gA?Math.abs(r-e):(0,ld.bisect)(function(i){return pA(r,e,i)-t},0,r+e)}function UL(r){r=r.slice();var e=[],t={},i,u,c,p;for(i=0;i<r.length;++i){var g=r[i];g.sets.length==1?e.push(g.sets[0]):g.sets.length==2&&(c=g.sets[0],p=g.sets[1],t[[c,p]]=!0,t[[p,c]]=!0)}for(e.sort(function(_,S){return _>S?1:-1}),i=0;i<e.length;++i)for(c=e[i],u=i+1;u<e.length;++u)p=e[u],[c,p]in t||r.push({sets:[c,p],size:0});return r}function ZL(r,e,t){var i=(0,ld.zerosM)(e.length,e.length),u=(0,ld.zerosM)(e.length,e.length);return r.filter(function(c){return c.sets.length==2}).map(function(c){var p=t[c.sets[0]],g=t[c.sets[1]],_=Math.sqrt(e[p].size/Math.PI),S=Math.sqrt(e[g].size/Math.PI),k=Ub(_,S,c.size);i[p][g]=i[g][p]=k;var L=0;c.size+1e-10>=Math.min(e[p].size,e[g].size)?L=1:c.size<=1e-10&&(L=-1),u[p][g]=u[g][p]=L}),{distances:i,constraints:u}}function VL(r,e,t,i){var u=0,c;for(c=0;c<e.length;++c)e[c]=0;for(c=0;c<t.length;++c)for(var p=r[2*c],g=r[2*c+1],_=c+1;_<t.length;++_){var S=r[2*_],k=r[2*_+1],L=t[c][_],R=i[c][_],U=(S-p)*(S-p)+(k-g)*(k-g),G=Math.sqrt(U),Q=U-L*L;R>0&&G<=L||R<0&&G>=L||(u+=2*Q*Q,e[2*c]+=4*Q*(p-S),e[2*c+1]+=4*Q*(g-k),e[2*_]+=4*Q*(S-p),e[2*_+1]+=4*Q*(k-g))}return u}function GL(r,e){var t=jL(r,e),i=e.lossFunction||Pm;if(r.length>=8){var u=HL(r,e),c=i(u,r),p=i(t,r);c+1e-8<p&&(t=u)}return t}function HL(r,e){e=e||{};var t=e.restarts||10,i=[],u={},c;for(c=0;c<r.length;++c){var p=r[c];p.sets.length==1&&(u[p.sets[0]]=i.length,i.push(p))}var g=ZL(r,i,u),_=g.distances,S=g.constraints,k=(0,ld.norm2)(_.map(ld.norm2))/_.length;_=_.map(function(Ht){return Ht.map(function(ce){return ce/k})});var L=function(Ht,ce){return VL(Ht,ce,_,S)},R,U;for(c=0;c<t;++c){var G=(0,ld.zeros)(_.length*2).map(Math.random);U=(0,ld.conjugateGradient)(L,G,e),(!R||U.fx<R.fx)&&(R=U)}var Q=R.x,pt={};for(c=0;c<i.length;++c){var yt=i[c];pt[yt.sets[0]]={x:Q[2*c]*k,y:Q[2*c+1]*k,radius:Math.sqrt(yt.size/Math.PI)}}if(e.history)for(c=0;c<e.history.length;++c)(0,ld.scale)(e.history[c].x,k);return pt}function jL(r,e){for(var t=e&&e.lossFunction?e.lossFunction:Pm,i={},u={},c,p=0;p<r.length;++p){var g=r[p];g.sets.length==1&&(c=g.sets[0],i[c]={x:1e10,y:1e10,rowid:Object.keys(i).length,size:g.size,radius:Math.sqrt(g.size/Math.PI)},u[c]=[])}r=r.filter(function(Vn){return Vn.sets.length==2});for(var p=0;p<r.length;++p){var _=r[p],S=_.hasOwnProperty("weight")?_.weight:1,k=_.sets[0],L=_.sets[1];_.size+gA>=Math.min(i[k].size,i[L].size)&&(S=0),u[k].push({set:L,size:_.size,weight:S}),u[L].push({set:k,size:_.size,weight:S})}var R=[];for(c in u)if(u.hasOwnProperty(c)){for(var U=0,p=0;p<u[c].length;++p)U+=u[c][p].size*u[c][p].weight;R.push({set:c,size:U})}function G(Vn,Bi){return Bi.size-Vn.size}R.sort(G);var Q={};function pt(Vn){return Vn.set in Q}function yt(Vn,Bi){i[Bi].x=Vn.x,i[Bi].y=Vn.y,Q[Bi]=!0}yt({x:0,y:0},R[0].set);for(var p=1;p<R.length;++p){var Ht=R[p].set,ce=u[Ht].filter(pt);if(c=i[Ht],ce.sort(G),ce.length===0)throw"ERROR: missing pairwise overlap information";for(var he=[],ze=0;ze<ce.length;++ze){var Er=i[ce[ze].set],Fr=Ub(c.radius,Er.radius,ce[ze].size);he.push({x:Er.x+Fr,y:Er.y}),he.push({x:Er.x-Fr,y:Er.y}),he.push({y:Er.y+Fr,x:Er.x}),he.push({y:Er.y-Fr,x:Er.x});for(var zr=ze+1;zr<ce.length;++zr)for(var pn=i[ce[zr].set],nn=Ub(c.radius,pn.radius,ce[zr].size),Pn=dA({x:Er.x,y:Er.y,radius:Fr},{x:pn.x,y:pn.y,radius:nn}),wi=0;wi<Pn.length;++wi)he.push(Pn[wi])}for(var ha=1e50,Sa=he[0],ze=0;ze<he.length;++ze){i[Ht].x=he[ze].x,i[Ht].y=he[ze].y;var _o=t(i,r);_o<ha&&(ha=_o,Sa=he[ze])}yt(Sa,Ht)}return i}function Pm(r,e){var t=0;function i(k){return k.map(function(L){return r[L]})}for(var u=0;u<e.length;++u){var c=e[u],p=void 0;if(c.sets.length!=1){if(c.sets.length==2){var g=r[c.sets[0]],_=r[c.sets[1]];p=pA(g.radius,_.radius,Mp(g,_))}else p=Db(i(c.sets));var S=c.hasOwnProperty("weight")?c.weight:1;t+=S*(p-c.size)*(p-c.size)}}return t}function WL(r,e,t){t===null?r.sort(function(Q,pt){return pt.radius-Q.radius}):r.sort(t);var i;if(r.length>0){var u=r[0].x,c=r[0].y;for(i=0;i<r.length;++i)r[i].x-=u,r[i].y-=c}if(r.length==2){var p=distance(r[0],r[1]);p<Math.abs(r[1].radius-r[0].radius)&&(r[1].x=r[0].x+r[0].radius-r[1].radius-1e-10,r[1].y=r[0].y)}if(r.length>1){var g=Math.atan2(r[1].x,r[1].y)-e,_=void 0,S=void 0,k=Math.cos(g),L=Math.sin(g);for(i=0;i<r.length;++i)_=r[i].x,S=r[i].y,r[i].x=k*_-L*S,r[i].y=L*_+k*S}if(r.length>2){for(var R=Math.atan2(r[2].x,r[2].y)-e;R<0;)R+=2*Math.PI;for(;R>2*Math.PI;)R-=2*Math.PI;if(R>Math.PI){var U=r[1].y/(1e-10+r[1].x);for(i=0;i<r.length;++i){var G=(r[i].x+U*r[i].y)/(1+U*U);r[i].x=2*G-r[i].x,r[i].y=2*G*U-r[i].y}}}}function XL(r){r.map(function(S){S.parent=S});function e(S){return S.parent!==S&&(S.parent=e(S.parent)),S.parent}function t(S,k){var L=e(S),R=e(k);L.parent=R}for(var i=0;i<r.length;++i)for(var u=i+1;u<r.length;++u){var c=r[i].radius+r[u].radius;distance(r[i],r[u])+1e-10<c&&t(r[u],r[i])}for(var p={},g,i=0;i<r.length;++i)g=e(r[i]).parent.setid,g in p||(p[g]=[]),p[g].push(r[i]);r.map(function(S){delete S.parent});var _=[];for(g in p)p.hasOwnProperty(g)&&_.push(p[g]);return _}function Zb(r){var e=function(t){var i=Math.max.apply(null,r.map(function(c){return c[t]+c.radius})),u=Math.min.apply(null,r.map(function(c){return c[t]-c.radius}));return{max:i,min:u}};return{xRange:e("x"),yRange:e("y")}}function MF(r,e,t){e===null&&(e=Math.PI/2);var i=[],u,c;for(c in r)if(r.hasOwnProperty(c)){var p=r[c];i.push({x:p.x,y:p.y,radius:p.radius,setid:c})}var g=XL(i);for(u=0;u<g.length;++u){WL(g[u],e,t);var _=Zb(g[u]);g[u].size=(_.xRange.max-_.xRange.min)*(_.yRange.max-_.yRange.min),g[u].bounds=_}g.sort(function(G,Q){return Q.size-G.size}),i=g[0];var S=i.bounds,k=(S.xRange.max-S.xRange.min)/50;function L(G,Q,pt){if(!!G){var yt=G.bounds,Ht,ce,he;Q?Ht=S.xRange.max-yt.xRange.min+k:(Ht=S.xRange.max-yt.xRange.max,he=(yt.xRange.max-yt.xRange.min)/2-(S.xRange.max-S.xRange.min)/2,he<0&&(Ht+=he)),pt?ce=S.yRange.max-yt.yRange.min+k:(ce=S.yRange.max-yt.yRange.max,he=(yt.yRange.max-yt.yRange.min)/2-(S.yRange.max-S.yRange.min)/2,he<0&&(ce+=he));for(var ze=0;ze<G.length;++ze)G[ze].x+=Ht,G[ze].y+=ce,i.push(G[ze])}}for(var R=1;R<g.length;)L(g[R],!0,!1),L(g[R+1],!1,!0),L(g[R+2],!0,!0),R+=3,S=Zb(i);var U={};for(u=0;u<i.length;++u)U[i[u].setid]=i[u];return U}function YL(r,e,t,i){var u=[],c=[];for(var p in r)r.hasOwnProperty(p)&&(c.push(p),u.push(r[p]));e-=2*i,t-=2*i;var g=Zb(u),_=g.xRange,S=g.yRange;if(_.max==_.min||S.max==S.min)return console.log("not scaling solution: zero size detected"),r;for(var k=e/(_.max-_.min),L=t/(S.max-S.min),R=Math.min(L,k),U=(e-(_.max-_.min)*R)/2,G=(t-(S.max-S.min)*R)/2,Q={},pt=0;pt<u.length;++pt){var yt=u[pt];Q[c[pt]]={radius:R*yt.radius,x:i+U+(yt.x-_.min)*R,y:i+G+(yt.y-S.min)*R}}return Q}var $L=(0,b.HP)(function(r,e,t,i){var u=new Map,c=r.length;return e.forEach(function(p,g){if(p[i].length===1)u.set(p[fh],r[(g+c)%c]);else{var _=p[i].map(function(S){return u.get(S)});u.set(p[fh],_.slice(1).reduce(function(S,k){return PL(S,k,t)},_[0]))}}),u},function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return JSON.stringify(r)});function qL(r,e,t,i){i===void 0&&(i=0);var u=r.data,c=r.setsField,p=r.sizeField;if(u.length===0)return Ap(Cp.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),[];var g=u.map(function(L){var R;return(0,P.pi)((0,P.pi)({},L),(R={sets:L[c]||[],size:L[p]},R[Rb]="",R[fh]="",R))});g.sort(function(L,R){return L.sets.length-R.sets.length});var _=zL(g),S=YL(_,e,t,i),k=DL(S,g);return g.forEach(function(L){var R=L.sets,U=R.join(",");L[fh]=U;var G=R.map(function(yt){return S[yt]}),Q=NL(G);/[zZ]$/.test(Q)||(Q+=" Z"),L[Rb]=Q;var pt=k[U]||{x:0,y:0};(0,b.f0)(L,pt)}),g}function KL(r,e){for(var t=0;t<e.length;t++)if(!r.includes(e[t]))return!1;return!0}var QL=40;function mA(r,e,t){var i=r.chart,u=r.options,c=u.blendMode,p=u.setsField,g=i.getTheme(),_=g.colors10,S=g.colors20,k=t;(0,b.kJ)(k)||(k=e.filter(function(R){return R[p].length===1}).length<=10?_:S);var L=$L(k,e,c,p);return function(R){return L.get(R)||k[0]}}function JL(r,e){var t=r.options,i=t.color;if(typeof i!="function"){var u=typeof i=="string"?[i]:i,c=mA(r,e,u);return function(p){return c(p[fh])}}return i}function tP(r){var e=r.chart,t=r.options,i=t.legend,u=t.appendPadding,c=t.padding,p=Vv(u);return i!==!1&&(p=My(u,(0,b.U2)(i,"position"),QL)),e.appendPadding=ux([p,c]),r}function eP(r){var e=r.options,t=e.data;t||(Ap(Cp.WARN,!1,"warn: %s","\u6570\u636E\u4E0D\u80FD\u4E3A\u7A7A"),t=[]);var i=t.filter(function(c){return c.sets.length===1}).map(function(c){return c.sets[0]}),u=t.filter(function(c){var p=c.sets;return KL(i,p)});return(0,b.Xy)(u,t)||Ap(Cp.WARN,!1,"warn: %s","\u4EA4\u96C6\u4E2D\u4E0D\u80FD\u51FA\u73B0\u4E0D\u5B58\u5728\u7684\u96C6\u5408, \u8BF7\u8F93\u5165\u5408\u6CD5\u6570\u636E"),(0,b.b$)({},r,{options:{data:u}})}function rP(r){var e=r.chart,t=r.options,i=t.pointStyle,u=t.setsField,c=t.sizeField,p=Vv(e.appendPadding),g=p[0],_=p[1],S=p[2],k=p[3],L={offsetX:k,offsetY:g},R=e.viewBBox,U=R.width,G=R.height,Q=qL(t,Math.max(U-(_+k),0),Math.max(G-(g+S),0),0);e.data(Q);var pt=mg(hn({},r,{options:{xField:"x",yField:"y",sizeField:c,seriesField:fh,rawFields:[u,c],schema:{shape:"venn",style:i}}})).ext,yt=pt.geometry;yt.customInfo(L);var Ht=JL(r,Q);return typeof Ht=="function"&&yt.color(fh,function(ce){var he=Q.find(function(Er){return Er[fh]===ce}),ze=mA(r,Q)(ce);return Ht(he,ze)}),r}function nP(r){var e=r.chart,t=r.options,i=t.label,u=Vv(e.appendPadding),c=u[0],p=u[3],g={offsetX:p,offsetY:c},_=Ec(e,"schema");if(!i)_.label(!1);else{var S=i.callback,k=(0,P._T)(i,["callback"]);_.label({fields:["id"],callback:S,cfg:(0,b.b$)({},Os(k),{type:"venn",customLabelInfo:g})})}return r}function iP(r){var e=r.chart,t=r.options,i=t.legend,u=t.sizeField;return e.legend(fh,i),e.legend(u,!1),r}function aP(r){var e=r.chart;return e.axis(!1),r}function yA(r){var e=r.options,t=r.chart,i=e.interactions;if(i){var u={"legend-active":"venn-legend-active","legend-highlight":"venn-legend-highlight"};Xs(hn({},r,{options:{interactions:i.map(function(c){return(0,P.pi)((0,P.pi)({},c),{type:u[c.type]||c.type})})}}))}return t.removeInteraction("legend-active"),t.removeInteraction("legend-highlight"),r}function _A(r){return Ga(tP,Bo,eP,rP,nP,Zs({}),iP,aP,hl,yA,ms)(r)}var oP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="venn",t}return e.getDefaultOptions=function(){return bL},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return _A},e.prototype.triggerResize=function(){this.chart.destroyed||(this.chart.forceFit(),this.chart.clear(),this.execAdaptor(),this.chart.render(!0))},e}(Ha),Vh="x",Yv="violinY",xA="violinSize",bA="minMax",Vb="quantile",Gb="median",Hb="violin_view",EA="min_max_view",sP="quantile_view",uP="median_view",lP=hn({},Ha.getDefaultOptions(),{syncViewPadding:!0,kde:{type:"triangular",sampleSize:32,width:3},violinStyle:{lineWidth:1,fillOpacity:.3,strokeOpacity:.75},xAxis:{grid:{line:null},tickLine:{alignTick:!1}},yAxis:{grid:{line:{style:{lineWidth:.5,lineDash:[4,4]}}}},legend:{position:"top-left"},tooltip:{showMarkers:!1}}),cP=ot(53843),fP=ot.n(cP);function jb(r,e){var t=r.length*e;if(r.length===0)throw new Error("quantile requires at least one data point.");if(e<0||e>1)throw new Error("quantiles must be between 0 and 1");return e===1?r[r.length-1]:e===0?r[0]:t%1!==0?r[Math.ceil(t)-1]:r.length%2===0?(r[t-1]+r[t])/2:r[t]}function Lg(r,e,t){var i=r[e];r[e]=r[t],r[t]=i}function A_(r,e,t,i){for(t=t||0,i=i||r.length-1;i>t;){if(i-t>600){var u=i-t+1,c=e-t+1,p=Math.log(u),g=.5*Math.exp(2*p/3),_=.5*Math.sqrt(p*g*(u-g)/u);c-u/2<0&&(_*=-1);var S=Math.max(t,Math.floor(e-c*g/u+_)),k=Math.min(i,Math.floor(e+(u-c)*g/u+_));A_(r,e,S,k)}var L=r[e],R=t,U=i;for(Lg(r,t,e),r[i]>L&&Lg(r,t,i);R<U;){for(Lg(r,R,U),R++,U--;r[R]<L;)R++;for(;r[U]>L;)U--}r[t]===L?Lg(r,t,U):(U++,Lg(r,U,i)),U<=e&&(t=U+1),e<=U&&(i=U-1)}}function Pg(r,e){var t=r.slice();if(Array.isArray(e)){T_(t,e);for(var i=[],u=0;u<e.length;u++)i[u]=jb(t,e[u]);return i}else{var c=wA(t.length,e);return Wb(t,c,0,t.length-1),jb(t,e)}}function Wb(r,e,t,i){e%1===0?A_(r,e,t,i):(e=Math.floor(e),A_(r,e,t,i),A_(r,e+1,e+1,i))}function T_(r,e){for(var t=[0],i=0;i<e.length;i++)t.push(wA(r.length,e[i]));t.push(r.length-1),t.sort(hP);for(var u=[0,t.length-1];u.length;){var c=Math.ceil(u.pop()),p=Math.floor(u.pop());if(!(c-p<=1)){var g=Math.floor((p+c)/2);Wb(r,t[g],Math.floor(t[p]),Math.ceil(t[c])),u.push(p,g,g,c)}}}function hP(r,e){return r-e}function wA(r,e){var t=r*e;return e===1?r-1:e===0?0:t%1!==0?Math.ceil(t)-1:r%2===0?t-.5:t}var SA=function(r){return{low:(0,b.VV)(r),high:(0,b.Fp)(r),q1:Pg(r,.25),q3:Pg(r,.75),median:Pg(r,[.5]),minMax:[(0,b.VV)(r),(0,b.Fp)(r)],quantile:[Pg(r,.25),Pg(r,.75)]}},pP=function(r,e){var t=fP().create(r,e);return{violinSize:t.map(function(i){return i.y}),violinY:t.map(function(i){return i.x})}},Xb=function(r){var e=r.xField,t=r.yField,i=r.seriesField,u=r.data,c=r.kde,p={min:c.min,max:c.max,size:c.sampleSize,width:c.width};if(!i){var g=(0,b.vM)(u,e);return Object.keys(g).map(function(k){var L=g[k],R=L.map(function(U){return U[t]});return(0,P.pi)((0,P.pi)({x:k},pP(R,p)),SA(R))})}var _=[],S=(0,b.vM)(u,i);return Object.keys(S).forEach(function(k){var L=(0,b.vM)(S[k],e);return Object.keys(L).forEach(function(R){var U,G=L[R],Q=G.map(function(pt){return pt[t]});_.push((0,P.pi)((0,P.pi)((U={x:R},U[i]=k,U),pP(Q,p)),SA(Q)))})}),_},Om=["low","high","q1","q3","median"],M_=[{type:"dodge",marginRatio:1/32}];function CA(r){var e=r.chart,t=r.options;return e.data(Xb(t)),r}function AA(r){var e=r.chart,t=r.options,i=t.seriesField,u=t.color,c=t.shape,p=c===void 0?"violin":c,g=t.violinStyle,_=t.tooltip,S=t.state,k=e.createView({id:Hb});return A0({chart:k,options:{xField:Vh,yField:Yv,seriesField:i||Vh,sizeField:xA,tooltip:(0,P.pi)({fields:Om},_),violin:{style:g,color:u,shape:p},state:S}}),k.geometries[0].adjust(M_),r}function TA(r){var e=r.chart,t=r.options,i=t.seriesField,u=t.color,c=t.tooltip,p=t.box;if(p===!1)return r;var g=e.createView({id:EA});ac({chart:g,options:{xField:Vh,yField:bA,seriesField:i||Vh,tooltip:(0,P.pi)({fields:Om},c),state:typeof p=="object"?p.state:{},interval:{color:u,size:1,style:{lineWidth:0}}}}),g.geometries[0].adjust(M_);var _=e.createView({id:sP});ac({chart:_,options:{xField:Vh,yField:Vb,seriesField:i||Vh,tooltip:(0,P.pi)({fields:Om},c),state:typeof p=="object"?p.state:{},interval:{color:u,size:8,style:{fillOpacity:1}}}}),_.geometries[0].adjust(M_);var S=e.createView({id:uP});return Bf({chart:S,options:{xField:Vh,yField:Gb,seriesField:i||Vh,tooltip:(0,P.pi)({fields:Om},c),state:typeof p=="object"?p.state:{},point:{color:u,size:1,style:{fill:"white",lineWidth:0}}}}),S.geometries[0].adjust(M_),_.axis(!1),g.axis(!1),S.axis(!1),S.legend(!1),g.legend(!1),_.legend(!1),r}function MA(r){var e,t=r.chart,i=r.options,u=i.meta,c=i.xAxis,p=i.yAxis,g={},_=hn(g,u,(e={},e[Vh]=(0,P.pi)((0,P.pi)({sync:!0},fs(c,Rf)),{type:"cat"}),e[Yv]=(0,P.pi)({sync:!0},fs(p,Rf)),e[bA]=(0,P.pi)({sync:Yv},fs(p,Rf)),e[Vb]=(0,P.pi)({sync:Yv},fs(p,Rf)),e[Gb]=(0,P.pi)({sync:Yv},fs(p,Rf)),e));return t.scale(_),r}function IA(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=yo(e,Hb);return i===!1?c.axis(Vh,!1):c.axis(Vh,i),u===!1?c.axis(Yv,!1):c.axis(Yv,u),e.axis(!1),r}function kA(r){var e=r.chart,t=r.options,i=t.legend,u=t.seriesField,c=t.shape;if(i===!1)e.legend(!1);else{var p=u||Vh,g=(0,b.CE)(i,["selected"]);(!c||!c.startsWith("hollow"))&&((0,b.U2)(g,["marker","style","lineWidth"])||(0,b.t8)(g,["marker","style","lineWidth"],0)),e.legend(p,g),(0,b.U2)(i,"selected")&&(0,b.S6)(e.views,function(_){return _.legend(p,i)})}return r}function Og(r){var e=r.chart,t=yo(e,Hb);return Ys()((0,P.pi)((0,P.pi)({},r),{chart:t})),r}function LA(r){var e=r.chart,t=r.options,i=t.animation;return(0,b.S6)(e.views,function(u){E0(u,i)}),r}function PA(r){return Ga(Bo,CA,AA,TA,MA,hl,IA,kA,Xs,Og,LA)(r)}var dP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="violin",t}return e.getDefaultOptions=function(){return lP},e.prototype.changeData=function(t){this.updateOption({data:t}),this.chart.changeData(Xb(this.options))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.getSchemaAdaptor=function(){return PA},e}(Ha),hh="$$yField$$",I_="$$diffField$$",k_="$$absoluteField$$",L_="$$isTotal$$",vP={label:{},leaderLine:{style:{lineWidth:1,stroke:"#8c8c8c",lineDash:[4,2]}},total:{style:{fill:"rgba(0, 0, 0, 0.25)"}},interactions:[{type:"element-active"}],risingFill:"#f4664a",fallingFill:"#30bf78",waterfallStyle:{fill:"rgba(0, 0, 0, 0.25)"},yAxis:{grid:{line:{style:{lineDash:[4,2]}}}}};function OA(r){for(var e=[],t=0;t<r.length;t++){var i=r[t];if(i){var u=t===0?"M":"L";e.push([u,i.x,i.y])}}var c=r[0];return e.push(["L",c.x,c.y]),e.push(["z"]),e}function FA(r){return hn({},r.defaultStyle,r.style,{fill:r.color})}va("interval","waterfall",{draw:function(r,e){var t=r.customInfo,i=r.points,u=r.nextPoints,c=e.addGroup(),p=this.parsePath(OA(i)),g=FA(r);c.addShape("path",{attrs:(0,P.pi)((0,P.pi)({},g),{path:p})});var _=(0,b.U2)(t,"leaderLine");if(_&&u){var S=[["M",i[2].x,i[2].y],["L",u[0].x,u[0].y]];i[2].y===u[1].y&&(S[1]=["L",u[1].x,u[1].y]),S=this.parsePath(S),c.addShape("path",{attrs:(0,P.pi)({path:S},_.style||{})})}return c}});function gP(r,e,t,i,u){var c,p=[];if((0,b.u4)(r,function(_,S){var k;Ap(Cp.WARN,(0,b.hj)(S[t]),S[t]+" is not a valid number");var L=(0,b.o8)(S[t])?null:S[t];return p.push((0,P.pi)((0,P.pi)({},S),(k={},k[i]=[_,_+L],k))),_+L},0),p.length&&u){var g=(0,b.U2)(p,[[r.length-1],i,[1]]);p.push((c={},c[e]=u.label,c[t]=g,c[i]=[0,g],c))}return p}function RA(r,e,t,i){var u=gP(r,e,t,hh,i);return u.map(function(c,p){var g;return(0,b.Kn)(c)?(0,P.pi)((0,P.pi)({},c),(g={},g[k_]=c[hh][1],g[I_]=c[hh][1]-c[hh][0],g[L_]=p===r.length,g)):c})}function mP(r){var e=r.options,t=e.locale,i=e.total,u=yx(t).get(["waterfall","total"]);return i&&typeof i.label!="string"&&u&&(r.options.total.label=u),r}function yP(r){var e=r.chart,t=r.options,i=t.data,u=t.xField,c=t.yField,p=t.total,g=t.leaderLine,_=t.columnWidthRatio,S=t.waterfallStyle,k=t.risingFill,L=t.fallingFill,R=t.color;e.data(RA(i,u,c,p));var U=R||function(yt){return(0,b.U2)(yt,[L_])?(0,b.U2)(p,["style","fill"],""):(0,b.U2)(yt,[hh,1])-(0,b.U2)(yt,[hh,0])>0?k:L},G=hn({},r,{options:{xField:u,yField:hh,seriesField:u,rawFields:[c,I_,L_,hh],widthRatio:_,interval:{style:S,shape:"waterfall",color:U}}}),Q=ac(G).ext,pt=Q.geometry;return pt.customInfo({leaderLine:g}),r}function rv(r){var e,t,i=r.options,u=i.xAxis,c=i.yAxis,p=i.xField,g=i.yField,_=i.meta,S=hn({},{alias:g},(0,b.U2)(_,g));return Ga(Zs((e={},e[p]=u,e[g]=c,e[hh]=c,e),hn({},_,(t={},t[hh]=S,t[I_]=S,t[k_]=S,t))))(r)}function Fm(r){var e=r.chart,t=r.options,i=t.xAxis,u=t.yAxis,c=t.xField,p=t.yField;return i===!1?e.axis(c,!1):e.axis(c,i),u===!1?(e.axis(p,!1),e.axis(hh,!1)):(e.axis(p,u),e.axis(hh,u)),r}function nv(r){var e=r.chart,t=r.options,i=t.legend,u=t.total,c=t.risingFill,p=t.fallingFill,g=t.locale,_=yx(g);if(i===!1)e.legend(!1);else{var S=[{name:_.get(["general","increase"]),value:"increase",marker:{symbol:"square",style:{r:5,fill:c}}},{name:_.get(["general","decrease"]),value:"decrease",marker:{symbol:"square",style:{r:5,fill:p}}}];u&&S.push({name:u.label||"",value:"total",marker:{symbol:"square",style:hn({},{r:5},(0,b.U2)(u,"style"))}}),e.legend(hn({},{custom:!0,position:"top",items:S},i)),e.removeInteraction("legend-filter")}return r}function Gh(r){var e=r.chart,t=r.options,i=t.label,u=t.labelMode,c=t.xField,p=Ec(e,"interval");if(!i)p.label(!1);else{var g=i.callback,_=(0,P._T)(i,["callback"]);p.label({fields:u==="absolute"?[k_,c]:[I_,c],callback:g,cfg:Os(_)})}return r}function Rm(r){var e=r.chart,t=r.options,i=t.tooltip,u=t.xField,c=t.yField;if(i!==!1){e.tooltip((0,P.pi)({showCrosshairs:!1,showMarkers:!1,shared:!0,fields:[c]},i));var p=e.geometries[0];i!=null&&i.formatter?p.tooltip(u+"*"+c,i.formatter):p.tooltip(c)}else e.tooltip(!1);return r}function $v(r){return Ga(mP,Bo,yP,rv,Fm,nv,Rm,Gh,w0,Xs,ms,Ys())(r)}var P_=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="waterfall",t}return e.getDefaultOptions=function(){return vP},e.prototype.changeData=function(t){var i=this.options,u=i.xField,c=i.yField,p=i.total;this.updateOption({data:t}),this.chart.changeData(RA(t,u,c,p))},e.prototype.getSchemaAdaptor=function(){return $v},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e}(Ha),Fg="color",cd=hn({},Ha.getDefaultOptions(),{timeInterval:2e3,legend:!1,tooltip:{showTitle:!1,showMarkers:!1,showCrosshairs:!1,fields:["text","value",Fg],formatter:function(r){return{name:r.text,value:r.value}}},wordStyle:{fontFamily:"Verdana",fontWeight:"normal",padding:1,fontSize:[12,60],rotation:[0,90],rotationSteps:2,rotateRatio:.5}}),V0={font:function(){return"serif"},padding:1,size:[500,500],spiral:"archimedean",timeInterval:3e3};function wc(r,e){return e=(0,b.f0)({},V0,e),fd(r,e)}function fd(r,e){var t=SP();["font","fontSize","fontWeight","padding","rotate","size","spiral","timeInterval","random"].forEach(function(_){(0,b.UM)(e[_])||t[_](e[_])}),t.words(r),e.imageMask&&t.createMask(e.imageMask);var i=t.start(),u=i._tags;u.forEach(function(_){_.x+=e.size[0]/2,_.y+=e.size[1]/2});var c=e.size,p=c[0],g=c[1];return u.push({text:"",value:0,x:0,y:0,opacity:0}),u.push({text:"",value:0,x:p,y:g,opacity:0}),u}var Hh=Math.PI/180,qv=1<<11>>5,O_=1<<11;function DA(r){return r.text}function Yb(){return"serif"}function BA(){return"normal"}function _P(r){return r.value}function NA(){return~~(Math.random()*2)*90}function zA(){return 1}function xP(r,e,t,i){if(!e.sprite){var u=r.context,c=r.ratio;u.clearRect(0,0,(qv<<5)/c,O_/c);var p=0,g=0,_=0,S=t.length;for(--i;++i<S;){e=t[i],u.save(),u.font=e.style+" "+e.weight+" "+~~((e.size+1)/c)+"px "+e.font;var k=u.measureText(e.text+"m").width*c,L=e.size<<1;if(e.rotate){var R=Math.sin(e.rotate*Hh),U=Math.cos(e.rotate*Hh),G=k*U,Q=k*R,pt=L*U,yt=L*R;k=Math.max(Math.abs(G+yt),Math.abs(G-yt))+31>>5<<5,L=~~Math.max(Math.abs(Q+pt),Math.abs(Q-pt))}else k=k+31>>5<<5;if(L>_&&(_=L),p+k>=qv<<5&&(p=0,g+=_,_=0),g+L>=O_)break;u.translate((p+(k>>1))/c,(g+(L>>1))/c),e.rotate&&u.rotate(e.rotate*Hh),u.fillText(e.text,0,0),e.padding&&(u.lineWidth=2*e.padding,u.strokeText(e.text,0,0)),u.restore(),e.width=k,e.height=L,e.xoff=p,e.yoff=g,e.x1=k>>1,e.y1=L>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,p+=k}for(var Ht=u.getImageData(0,0,(qv<<5)/c,O_/c).data,ce=[];--i>=0;)if(e=t[i],!!e.hasText){for(var k=e.width,he=k>>5,L=e.y1-e.y0,ze=0;ze<L*he;ze++)ce[ze]=0;if(p=e.xoff,p==null)return;g=e.yoff;for(var Er=0,Fr=-1,zr=0;zr<L;zr++){for(var ze=0;ze<k;ze++){var pn=he*zr+(ze>>5),nn=Ht[(g+zr)*(qv<<5)+(p+ze)<<2]?1<<31-ze%32:0;ce[pn]|=nn,Er|=nn}Er?Fr=zr:(e.y0++,L--,zr--,g++)}e.y1=e.y0+Fr,e.sprite=ce.slice(0,(e.y1-e.y0)*he)}}}function bP(r,e,t){t>>=5;for(var i=r.sprite,u=r.width>>5,c=r.x-(u<<4),p=c&127,g=32-p,_=r.y1-r.y0,S=(r.y+r.y0)*t+(c>>5),k,L=0;L<_;L++){k=0;for(var R=0;R<=u;R++)if((k<<g|(R<u?(k=i[L*u+R])>>>p:0))&e[S+R])return!0;S+=t}return!1}function UA(r,e){var t=r[0],i=r[1];e.x+e.x0<t.x&&(t.x=e.x+e.x0),e.y+e.y0<t.y&&(t.y=e.y+e.y0),e.x+e.x1>i.x&&(i.x=e.x+e.x1),e.y+e.y1>i.y&&(i.y=e.y+e.y1)}function F_(r,e){return r.x+r.x1>e[0].x&&r.x+r.x0<e[1].x&&r.y+r.y1>e[0].y&&r.y+r.y0<e[1].y}function ZA(r){var e=r[0]/r[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function Rg(r){var e=4,t=e*r[0]/r[1],i=0,u=0;return function(c){var p=c<0?-1:1;switch(Math.sqrt(1+4*p*c)-p&3){case 0:i+=t;break;case 1:u+=e;break;case 2:i-=t;break;default:u-=e;break}return[i,u]}}function VA(r){for(var e=[],t=-1;++t<r;)e[t]=0;return e}function EP(){return document.createElement("canvas")}function hd(r){return(0,b.mf)(r)?r:function(){return r}}var wP={archimedean:ZA,rectangular:Rg};function SP(){var r=[256,256],e=Yb,t=_P,i=BA,u=NA,c=zA,p=ZA,g=Math.random,_=[],S=1/0,k=DA,L=BA,R=EP,U={};U.start=function(){var pt=r[0],yt=r[1],Ht=G(R()),ce=U.board?U.board:VA((r[0]>>5)*r[1]),he=_.length,ze=[],Er=_.map(function(nn,Pn,wi){return nn.text=k.call(this,nn,Pn,wi),nn.font=e.call(this,nn,Pn,wi),nn.style=L.call(this,nn,Pn,wi),nn.weight=i.call(this,nn,Pn,wi),nn.rotate=u.call(this,nn,Pn,wi),nn.size=~~t.call(this,nn,Pn,wi),nn.padding=c.call(this,nn,Pn,wi),nn}).sort(function(nn,Pn){return Pn.size-nn.size}),Fr=-1,zr=U.board?[{x:0,y:0},{x:pt,y:yt}]:null;pn();function pn(){for(var nn=Date.now();Date.now()-nn<S&&++Fr<he;){var Pn=Er[Fr];Pn.x=pt*(g()+.5)>>1,Pn.y=yt*(g()+.5)>>1,xP(Ht,Pn,Er,Fr),Pn.hasText&&Q(ce,Pn,zr)&&(ze.push(Pn),zr?U.hasImage||UA(zr,Pn):zr=[{x:Pn.x+Pn.x0,y:Pn.y+Pn.y0},{x:Pn.x+Pn.x1,y:Pn.y+Pn.y1}],Pn.x-=r[0]>>1,Pn.y-=r[1]>>1)}U._tags=ze,U._bounds=zr}return U};function G(pt){pt.width=pt.height=1;var yt=Math.sqrt(pt.getContext("2d").getImageData(0,0,1,1).data.length>>2);pt.width=(qv<<5)/yt,pt.height=O_/yt;var Ht=pt.getContext("2d");return Ht.fillStyle=Ht.strokeStyle="red",Ht.textAlign="center",{context:Ht,ratio:yt}}function Q(pt,yt,Ht){for(var ce=yt.x,he=yt.y,ze=Math.sqrt(r[0]*r[0]+r[1]*r[1]),Er=p(r),Fr=g()<.5?1:-1,zr,pn=-Fr,nn,Pn;(zr=Er(pn+=Fr))&&(nn=~~zr[0],Pn=~~zr[1],!(Math.min(Math.abs(nn),Math.abs(Pn))>=ze));)if(yt.x=ce+nn,yt.y=he+Pn,!(yt.x+yt.x0<0||yt.y+yt.y0<0||yt.x+yt.x1>r[0]||yt.y+yt.y1>r[1])&&(!Ht||!bP(yt,pt,r[0]))&&(!Ht||F_(yt,Ht))){for(var wi=yt.sprite,ha=yt.width>>5,Sa=r[0]>>5,_o=yt.x-(ha<<4),Vn=_o&127,Bi=32-Vn,fa=yt.y1-yt.y0,Ui=void 0,Ji=(yt.y+yt.y0)*Sa+(_o>>5),Fa=0;Fa<fa;Fa++){Ui=0;for(var xo=0;xo<=ha;xo++)pt[Ji+xo]|=Ui<<Bi|(xo<ha?(Ui=wi[Fa*ha+xo])>>>Vn:0);Ji+=Sa}return delete yt.sprite,!0}return!1}return U.createMask=function(pt){var yt=document.createElement("canvas"),Ht=r[0],ce=r[1];if(!(!Ht||!ce)){var he=Ht>>5,ze=VA((Ht>>5)*ce);yt.width=Ht,yt.height=ce;var Er=yt.getContext("2d");Er.drawImage(pt,0,0,pt.width,pt.height,0,0,Ht,ce);for(var Fr=Er.getImageData(0,0,Ht,ce).data,zr=0;zr<ce;zr++)for(var pn=0;pn<Ht;pn++){var nn=he*zr+(pn>>5),Pn=zr*Ht+pn<<2,wi=Fr[Pn]>=250&&Fr[Pn+1]>=250&&Fr[Pn+2]>=250,ha=wi?1<<31-pn%32:0;ze[nn]|=ha}U.board=ze,U.hasImage=!0}},U.timeInterval=function(pt){S=pt==null?1/0:pt},U.words=function(pt){_=pt},U.size=function(pt){r=[+pt[0],+pt[1]]},U.font=function(pt){e=hd(pt)},U.fontWeight=function(pt){i=hd(pt)},U.rotate=function(pt){u=hd(pt)},U.spiral=function(pt){p=wP[pt]||pt},U.fontSize=function(pt){t=hd(pt)},U.padding=function(pt){c=hd(pt)},U.random=function(pt){g=hd(pt)},U}function GA(r){var e=r.options,t=r.chart,i=t,u=i.width,c=i.height,p=i.padding,g=i.appendPadding,_=i.ele,S=e.data,k=e.imageMask,L=e.wordField,R=e.weightField,U=e.colorField,G=e.wordStyle,Q=e.timeInterval,pt=e.random,yt=e.spiral,Ht=e.autoFit,ce=Ht===void 0?!0:Ht,he=e.placementStrategy;if(!S||!S.length)return[];var ze=G.fontFamily,Er=G.fontWeight,Fr=G.padding,zr=G.fontSize,pn=TP(S,R),nn=[IP(pn),WA(pn)],Pn=S.map(function(Sa){return{text:Sa[L],value:Sa[R],color:Sa[U],datum:Sa}}),wi={imageMask:k,font:ze,fontSize:AP(zr,nn),fontWeight:Er,size:HA({width:u,height:c,padding:p,appendPadding:g,autoFit:ce,container:_}),padding:Fr,timeInterval:Q,random:pt,spiral:yt,rotate:$b(e)};if((0,b.mf)(he)){var ha=Pn.map(function(Sa,_o,Vn){return(0,P.pi)((0,P.pi)((0,P.pi)({},Sa),{hasText:!!Sa.text,font:hd(wi.font)(Sa,_o,Vn),weight:hd(wi.fontWeight)(Sa,_o,Vn),rotate:hd(wi.rotate)(Sa,_o,Vn),size:hd(wi.fontSize)(Sa,_o,Vn),style:"normal"}),he.call(t,Sa,_o,Vn))});return ha.push({text:"",value:0,x:0,y:0,opacity:0}),ha.push({text:"",value:0,x:wi.size[0],y:wi.size[1],opacity:0}),ha}return wc(Pn,wi)}function HA(r){var e=r.width,t=r.height,i=r.container,u=r.autoFit,c=r.padding,p=r.appendPadding;if(u){var g=ax(i);e=g.width,t=g.height}e=e||400,t=t||400;var _=jA({padding:c,appendPadding:p}),S=_[0],k=_[1],L=_[2],R=_[3],U=[e-(R+k),t-(S+L)];return U}function jA(r){var e=Vv(r.padding),t=Vv(r.appendPadding),i=e[0]+t[0],u=e[1]+t[1],c=e[2]+t[2],p=e[3]+t[3];return[i,u,c,p]}function CP(r){return new Promise(function(e,t){if(r instanceof HTMLImageElement){e(r);return}if((0,b.HD)(r)){var i=new Image;i.crossOrigin="anonymous",i.src=r,i.onload=function(){e(i)},i.onerror=function(){Ap(Cp.ERROR,!1,"image %s load failed !!!",r),t()};return}Ap(Cp.WARN,r===void 0,"The type of imageMask option must be String or HTMLImageElement."),t()})}function AP(r,e){if((0,b.mf)(r))return r;if((0,b.kJ)(r)){var t=r[0],i=r[1];if(!e)return function(){return(i+t)/2};var u=e[0],c=e[1];return c===u?function(){return(i+t)/2}:function(g){var _=g.value;return(i-t)/(c-u)*(_-u)+t}}return function(){return r}}function TP(r,e){return r.map(function(t){return t[e]}).filter(function(t){return typeof t=="number"&&!isNaN(t)})}function $b(r){var e=MP(r),t=e.rotation,i=e.rotationSteps;if(!(0,b.kJ)(t))return t;var u=t[0],c=t[1],p=i===1?0:(c-u)/(i-1);return function(){return c===u?c:Math.floor(Math.random()*i)*p}}function MP(r){var e=r.wordStyle.rotationSteps;return e<1&&(Ap(Cp.WARN,!1,"The rotationSteps option must be greater than or equal to 1."),e=1),{rotation:r.wordStyle.rotation,rotationSteps:e}}function IP(r){return Math.min.apply(Math,r)}function WA(r){return Math.max.apply(Math,r)}function qb(r){var e=r.chart,t=r.options,i=t.colorField,u=t.color,c=GA(r);e.data(c);var p=hn({},r,{options:{xField:"x",yField:"y",seriesField:i&&Fg,rawFields:(0,b.mf)(u)&&(0,P.pr)((0,b.U2)(t,"rawFields",[]),["datum"]),point:{color:u,shape:"word-cloud"}}}),g=Bf(p).ext;return g.geometry.label(!1),e.coordinate().reflect("y"),e.axis(!1),r}function XA(r){return Ga(Zs({x:{nice:!1},y:{nice:!1}}))(r)}function YA(r){var e=r.chart,t=r.options,i=t.legend,u=t.colorField;return i===!1?e.legend(!1):u&&e.legend(Fg,i),r}function kP(r){Ga(qb,XA,hl,YA,Xs,ms,Bo,w0)(r)}va("point","word-cloud",{draw:function(r,e){var t=r.x,i=r.y,u=e.addShape("text",{attrs:(0,P.pi)((0,P.pi)({},$A(r)),{x:t,y:i})}),c=r.data.rotate;return typeof c=="number"&&_c.rotate(u,c*Math.PI/180),u}});function $A(r){return{fontSize:r.data.size,text:r.data.text,textAlign:"center",fontFamily:r.data.font,fontWeight:r.data.weight,fill:r.color||r.defaultStyle.stroke,textBaseline:"alphabetic"}}var LP=function(r){(0,P.ZT)(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.type="word-cloud",t}return e.getDefaultOptions=function(){return cd},e.prototype.changeData=function(t){this.updateOption({data:t}),this.options.imageMask?this.render():this.chart.changeData(GA({chart:this.chart,options:this.options}))},e.prototype.getDefaultOptions=function(){return e.getDefaultOptions()},e.prototype.render=function(){var t=this;return new Promise(function(i){var u=t.options.imageMask;if(!u){r.prototype.render.call(t),i();return}var c=function(p){t.options=(0,P.pi)((0,P.pi)({},t.options),{imageMask:p||null}),r.prototype.render.call(t),i()};CP(u).then(c).catch(c)})},e.prototype.getSchemaAdaptor=function(){return kP},e.prototype.triggerResize=function(){var t=this;this.chart.destroyed||(this.execAdaptor(),window.setTimeout(function(){r.prototype.triggerResize.call(t)}))},e}(Ha),PP=function(r){(0,P.ZT)(e,r);function e(t,i,u,c){var p=r.call(this,t,hn({},c,i))||this;return p.type="g2-plot",p.defaultOptions=c,p.adaptor=u,p}return e.prototype.getDefaultOptions=function(){return this.defaultOptions},e.prototype.getSchemaAdaptor=function(){return this.adaptor},e}(Ha),R_="2.4.23";So("en-US",GO),So("zh-CN",kw);var Kb={scale:Zs,legend:vg,tooltip:hl,annotation:Ys,interaction:Xs,theme:Bo,animation:ms}},4157:function(){window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',function(vn){try{let et=function(){q||(q=!0,I())},Ee=function(){try{Et.documentElement.doScroll("left")}catch(it){return void setTimeout(Ee,50)}et()};var ht=et,ct=Ee,ot=(ot=document.getElementsByTagName("script"))[ot.length-1],Ft=ot.getAttribute("data-injectcss"),ot=ot.getAttribute("data-disable-injectsvg");if(!ot){var Lt,wt,I,Et,q,lt=function(st,Zt){Zt.parentNode.insertBefore(st,Zt)};if(Ft&&!vn.__iconfont__svg__cssinject__){vn.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(it){console&&console.log(it)}}Lt=function(){var st,Zt=document.createElement("div");Zt.innerHTML=vn._iconfont_svg_string_3580659,(Zt=Zt.getElementsByTagName("svg")[0])&&(Zt.setAttribute("aria-hidden","true"),Zt.style.position="absolute",Zt.style.width=0,Zt.style.height=0,Zt.style.overflow="hidden",Zt=Zt,(st=document.body).firstChild?lt(Zt,st.firstChild):st.appendChild(Zt))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(Lt,0):(wt=function(){document.removeEventListener("DOMContentLoaded",wt,!1),Lt()},document.addEventListener("DOMContentLoaded",wt,!1)):document.attachEvent&&(I=Lt,Et=vn.document,q=!1,Ee(),Et.onreadystatechange=function(){Et.readyState=="complete"&&(Et.onreadystatechange=null,et())})}}catch(et){}}(window)},3876:function(vn,Ft){"use strict";var ot;ot={value:!0},ot=ot=Ft.Tf=Ft.Bc=Ft.jp=Ft.fL=Ft.O6=Ft.rC=void 0,Ft.rC="l7plot-legend l7plot-legend__category",Ft.O6="l7plot-legend__title",Ft.fL="l7plot-legend__category-list",Ft.jp="l7plot-legend__list-item",Ft.Bc="l7plot-legend__category-marker",Ft.Tf="l7plot-legend__category-value",ot='<div class="'.concat(Ft.rC,`">
  <div class="`).concat(Ft.O6,`"></div>
  <ul class="`).concat(Ft.fL,`"></ul>
</div>`),ot='<li class="'.concat(Ft.jp,`" data-index={index}>
  <span class="`).concat(Ft.Bc,`" style="background:{color}"></span>
  <span class="`).concat(Ft.Tf,`">{value}</span>
</li>`)},56992:function(vn,Ft){"use strict";var ot;ot={value:!0},ot=ot=Ft.VI=Ft.bl=Ft.el=Ft.I8=Ft.O6=Ft.rC=void 0,Ft.rC="l7plot-legend l7plot-legend__continue",Ft.O6="l7plot-legend__title",Ft.I8="l7plot-legend__ribbon-container",Ft.el="l7plot-legend__ribbon",Ft.bl="l7plot-legend__gradient-bar",Ft.VI="l7plot-legend__value-range",ot='<div class="'.concat(Ft.rC,`">
  <div class="`).concat(Ft.O6,`"></div>
  <div class="`).concat(Ft.I8,`"></div>
</div>`),ot='<div class="'.concat(Ft.el,`">
  <span class="`).concat(Ft.VI,`">{min}</span>
  <div class="`).concat(Ft.bl,`" style="background-image: {backgroundImage}"></div>
  <span class="`).concat(Ft.VI,`">{max}</span>
</div>`)},77972:function(vn,Ft){"use strict";var ot;ot={value:!0},ot=ot=Ft.Tf=Ft.bX=Ft.jp=Ft.fL=Ft.O6=Ft.rC=void 0,Ft.rC="l7plot-tooltip",Ft.O6="l7plot-tooltip__title",Ft.fL="l7plot-tooltip__list",Ft.jp="l7plot-tooltip__list-item",Ft.bX="l7plot-tooltip__name",Ft.Tf="l7plot-tooltip__value",ot='<div class="'.concat(Ft.rC,`">
  <div class="`).concat(Ft.O6,`"></div>
  <ul class="`).concat(Ft.fL,`"></ul>
</div>`),ot='<li class="'.concat(Ft.jp,`" data-index={index}>
  <span class="`).concat(Ft.bX,`">{name}</span>
  <span class="`).concat(Ft.Tf,`">{value}</span>
</li>`)},31506:function(vn,Ft,ot){"use strict";ot.d(Ft,{Dg:function(){return et},lh:function(){return q},m$:function(){return I},vs:function(){return ht},zu:function(){return Et}});var Lt=ot(35600),wt=ot(31437);function I(it,st,Zt){var P=[0,0,0,0,0,0,0,0,0];return Lt.vc(P,Zt),Lt.Jp(it,P,st)}function Et(it,st,Zt){var P=[0,0,0,0,0,0,0,0,0];return Lt.Us(P,Zt),Lt.Jp(it,P,st)}function q(it,st,Zt){var P=[0,0,0,0,0,0,0,0,0];return Lt.xJ(P,Zt),Lt.Jp(it,P,st)}function lt(it,st,Zt){return Lt.Jp(it,Zt,st)}function ht(it,st){for(var Zt=it?[].concat(it):[1,0,0,0,1,0,0,0,1],P=0,b=st.length;P<b;P++){var X=st[P];switch(X[0]){case"t":I(Zt,Zt,[X[1],X[2]]);break;case"s":q(Zt,Zt,[X[1],X[2]]);break;case"r":Et(Zt,Zt,X[1]);break;case"m":lt(Zt,Zt,X[1]);break;default:break}}return Zt}function ct(it,st){return it[0]*st[1]-st[0]*it[1]}function et(it,st,Zt){var P=wt.EU(it,st),b=ct(it,st)>=0;return Zt?b?Math.PI*2-P:P:b?P:Math.PI*2-P}function Ee(it,st,Zt){return Zt?(it[0]=st[1],it[1]=-1*st[0]):(it[0]=-1*st[1],it[1]=st[0]),it}},39499:function(vn,Ft,ot){"use strict";ot.d(Ft,{e9:function(){return et},Wq:function(){return tt},tr:function(){return X},wb:function(){return Ie},zx:function(){return qt}});var Lt=ot(45098),wt=/[MLHVQTCSAZ]([^MLHVQTCSAZ]*)/ig,I=/[^\s\,]+/ig;function Et(_t){var Xt=_t||[];if((0,Lt.kJ)(Xt))return Xt;if((0,Lt.HD)(Xt))return Xt=Xt.match(wt),(0,Lt.S6)(Xt,function(ve,Wt){if(ve=ve.match(I),ve[0].length>1){var Me=ve[0].charAt(0);ve.splice(1,0,ve[0].substr(1)),ve[0]=Me}(0,Lt.S6)(ve,function(je,Qe){isNaN(je)||(ve[Qe]=+je)}),Xt[Wt]=ve}),Xt}var q=Et,lt=ot(31437);function ht(_t,Xt,ve,Wt){var Me=[],je=!!Wt,Qe,hr,er,Br,Lr,Zr,Tn;if(je){er=Wt[0],Br=Wt[1];for(var rn=0,Nn=_t.length;rn<Nn;rn+=1){var zn=_t[rn];er=lt.VV([0,0],er,zn),Br=lt.Fp([0,0],Br,zn)}}for(var rn=0,jn=_t.length;rn<jn;rn+=1){var zn=_t[rn];if(rn===0&&!ve)Tn=zn;else if(rn===jn-1&&!ve)Zr=zn,Me.push(Tn),Me.push(Zr);else{var wn=[rn?rn-1:jn-1,rn-1][ve?0:1];Qe=_t[wn],hr=_t[ve?(rn+1)%jn:rn+1];var Wn=[0,0];Wn=lt.lu(Wn,hr,Qe),Wn=lt.bA(Wn,Wn,Xt);var Bt=lt.TE(zn,Qe),Yt=lt.TE(zn,hr),oe=Bt+Yt;oe!==0&&(Bt/=oe,Yt/=oe);var Ce=lt.bA([0,0],Wn,-Bt),Ue=lt.bA([0,0],Wn,Yt);Zr=lt.IH([0,0],zn,Ce),Lr=lt.IH([0,0],zn,Ue),Lr=lt.VV([0,0],Lr,lt.Fp([0,0],hr,zn)),Lr=lt.Fp([0,0],Lr,lt.VV([0,0],hr,zn)),Ce=lt.lu([0,0],Lr,zn),Ce=lt.bA([0,0],Ce,-Bt/Yt),Zr=lt.IH([0,0],zn,Ce),Zr=lt.VV([0,0],Zr,lt.Fp([0,0],Qe,zn)),Zr=lt.Fp([0,0],Zr,lt.VV([0,0],Qe,zn)),Ue=lt.lu([0,0],zn,Zr),Ue=lt.bA([0,0],Ue,Yt/Bt),Lr=lt.IH([0,0],zn,Ue),je&&(Zr=lt.Fp([0,0],Zr,er),Zr=lt.VV([0,0],Zr,Br),Lr=lt.Fp([0,0],Lr,er),Lr=lt.VV([0,0],Lr,Br)),Me.push(Tn),Me.push(Zr),Tn=Lr}}return ve&&Me.push(Me.shift()),Me}function ct(_t,Xt,ve){Xt===void 0&&(Xt=!1),ve===void 0&&(ve=[[0,0],[1,1]]);for(var Wt=!!Xt,Me=[],je=0,Qe=_t.length;je<Qe;je+=2)Me.push([_t[je],_t[je+1]]);for(var hr=ht(Me,.4,Wt,ve),er=Me.length,Br=[],Lr,Zr,Tn,je=0;je<er-1;je+=1)Lr=hr[je*2],Zr=hr[je*2+1],Tn=Me[je+1],Br.push(["C",Lr[0],Lr[1],Zr[0],Zr[1],Tn[0],Tn[1]]);return Wt&&(Lr=hr[er],Zr=hr[er+1],Tn=Me[0],Br.push(["C",Lr[0],Lr[1],Zr[0],Zr[1],Tn[0],Tn[1]])),Br}var et=ct;function Ee(_t,Xt,ve){var Wt=null,Me=ve;return Xt<Me&&(Me=Xt,Wt="add"),_t<Me&&(Me=_t,Wt="del"),{type:Wt,min:Me}}var it=function(_t,Xt){var ve=_t.length,Wt=Xt.length,Me,je,Qe=0;if(ve===0||Wt===0)return null;for(var hr=[],er=0;er<=ve;er++)hr[er]=[],hr[er][0]={min:er};for(var Br=0;Br<=Wt;Br++)hr[0][Br]={min:Br};for(var er=1;er<=ve;er++){Me=_t[er-1];for(var Br=1;Br<=Wt;Br++){je=Xt[Br-1],isEqual(Me,je)?Qe=0:Qe=1;var Lr=hr[er-1][Br].min+1,Zr=hr[er][Br-1].min+1,Tn=hr[er-1][Br-1].min+Qe;hr[er][Br]=Ee(Lr,Zr,Tn)}}return hr};function st(_t,Xt){var ve=it(_t,Xt),Wt=_t.length,Me=Xt.length,je=[],Qe=1,hr=1;if(ve[Wt][Me]!==Wt){for(var er=1;er<=Wt;er++){var Br=ve[er][er].min;hr=er;for(var Lr=Qe;Lr<=Me;Lr++)ve[er][Lr].min<Br&&(Br=ve[er][Lr].min,hr=Lr);Qe=hr,ve[er][Qe].type&&je.push({index:er-1,type:ve[er][Qe].type})}for(var er=je.length-1;er>=0;er--)Qe=je[er].index,je[er].type==="add"?_t.splice(Qe,0,[].concat(_t[Qe])):_t.splice(Qe,1)}if(Wt=_t.length,Wt<Me)for(var er=0;er<Me-Wt;er++)_t[Wt-1][0]==="z"||_t[Wt-1][0]==="Z"?_t.splice(Wt-2,0,_t[Wt-2]):_t.push(_t[Wt-1]);return _t}var Zt=`	
\v\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029`,P=new RegExp("([a-z])["+Zt+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+Zt+"]*,?["+Zt+"]*)+)","ig"),b=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+Zt+"]*,?["+Zt+"]*","ig");function X(_t){if(!_t)return null;if((0,Lt.kJ)(_t))return _t;var Xt={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},ve=[];return String(_t).replace(P,function(Wt,Me,je){var Qe=[],hr=Me.toLowerCase();if(je.replace(b,function(er,Br){Br&&Qe.push(+Br)}),hr==="m"&&Qe.length>2&&(ve.push([Me].concat(Qe.splice(0,2))),hr="l",Me=Me==="m"?"l":"L"),hr==="o"&&Qe.length===1&&ve.push([Me,Qe[0]]),hr==="r")ve.push([Me].concat(Qe));else for(;Qe.length>=Xt[hr]&&(ve.push([Me].concat(Qe.splice(0,Xt[hr]))),!!Xt[hr]););return""}),ve}var le=/[a-z]/;function Se(_t,Xt){return[Xt[0]+(Xt[0]-_t[0]),Xt[1]+(Xt[1]-_t[1])]}function Ie(_t){var Xt=X(_t);if(!Xt||!Xt.length)return[["M",0,0]];for(var ve=!1,Wt=0;Wt<Xt.length;Wt++){var Me=Xt[Wt][0];if(le.test(Me)||["V","H","T","S"].indexOf(Me)>=0){ve=!0;break}}if(!ve)return Xt;var je=[],Qe=0,hr=0,er=0,Br=0,Lr=0,Zr,Tn,rn=Xt[0];(rn[0]==="M"||rn[0]==="m")&&(Qe=+rn[1],hr=+rn[2],er=Qe,Br=hr,Lr++,je[0]=["M",Qe,hr]);for(var Wt=Lr,Nn=Xt.length;Wt<Nn;Wt++){var zn=Xt[Wt],jn=je[Wt-1],wn=[],Me=zn[0],Wn=Me.toUpperCase();if(Me!==Wn)switch(wn[0]=Wn,Wn){case"A":wn[1]=zn[1],wn[2]=zn[2],wn[3]=zn[3],wn[4]=zn[4],wn[5]=zn[5],wn[6]=+zn[6]+Qe,wn[7]=+zn[7]+hr;break;case"V":wn[1]=+zn[1]+hr;break;case"H":wn[1]=+zn[1]+Qe;break;case"M":er=+zn[1]+Qe,Br=+zn[2]+hr,wn[1]=er,wn[2]=Br;break;default:for(var Bt=1,Yt=zn.length;Bt<Yt;Bt++)wn[Bt]=+zn[Bt]+(Bt%2?Qe:hr)}else wn=Xt[Wt];switch(Wn){case"Z":Qe=+er,hr=+Br;break;case"H":Qe=wn[1],wn=["L",Qe,hr];break;case"V":hr=wn[1],wn=["L",Qe,hr];break;case"T":Qe=wn[1],hr=wn[2];var oe=Se([jn[1],jn[2]],[jn[3],jn[4]]);wn=["Q",oe[0],oe[1],Qe,hr];break;case"S":Qe=wn[wn.length-2],hr=wn[wn.length-1];var Ce=jn.length,Ue=Se([jn[Ce-4],jn[Ce-3]],[jn[Ce-2],jn[Ce-1]]);wn=["C",Ue[0],Ue[1],wn[1],wn[2],Qe,hr];break;case"M":er=wn[wn.length-2],Br=wn[wn.length-1];break;default:Qe=wn[wn.length-2],hr=wn[wn.length-1]}je.push(wn)}return je}var It=Math.PI*2,rt=function(_t,Xt,ve,Wt,Me,je,Qe){var hr=_t.x,er=_t.y;hr*=Xt,er*=ve;var Br=Wt*hr-Me*er,Lr=Me*hr+Wt*er;return{x:Br+je,y:Lr+Qe}},Dt=function(_t,Xt){var ve=Xt===1.5707963267948966?.551915024494:Xt===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(Xt/4),Wt=Math.cos(_t),Me=Math.sin(_t),je=Math.cos(_t+Xt),Qe=Math.sin(_t+Xt);return[{x:Wt-Me*ve,y:Me+Wt*ve},{x:je+Qe*ve,y:Qe-je*ve},{x:je,y:Qe}]},Ae=function(_t,Xt,ve,Wt){var Me=_t*Wt-Xt*ve<0?-1:1,je=_t*ve+Xt*Wt;return je>1&&(je=1),je<-1&&(je=-1),Me*Math.acos(je)},be=function(_t,Xt,ve,Wt,Me,je,Qe,hr,er,Br,Lr,Zr){var Tn=Math.pow(Me,2),rn=Math.pow(je,2),Nn=Math.pow(Lr,2),zn=Math.pow(Zr,2),jn=Tn*rn-Tn*zn-rn*Nn;jn<0&&(jn=0),jn/=Tn*zn+rn*Nn,jn=Math.sqrt(jn)*(Qe===hr?-1:1);var wn=jn*Me/je*Zr,Wn=jn*-je/Me*Lr,Bt=Br*wn-er*Wn+(_t+ve)/2,Yt=er*wn+Br*Wn+(Xt+Wt)/2,oe=(Lr-wn)/Me,Ce=(Zr-Wn)/je,Ue=(-Lr-wn)/Me,fr=(-Zr-Wn)/je,Sr=Ae(1,0,oe,Ce),Pe=Ae(oe,Ce,Ue,fr);return hr===0&&Pe>0&&(Pe-=It),hr===1&&Pe<0&&(Pe+=It),[Bt,Yt,Sr,Pe]},me=function(_t){var Xt=_t.px,ve=_t.py,Wt=_t.cx,Me=_t.cy,je=_t.rx,Qe=_t.ry,hr=_t.xAxisRotation,er=hr===void 0?0:hr,Br=_t.largeArcFlag,Lr=Br===void 0?0:Br,Zr=_t.sweepFlag,Tn=Zr===void 0?0:Zr,rn=[];if(je===0||Qe===0)return[{x1:0,y1:0,x2:0,y2:0,x:Wt,y:Me}];var Nn=Math.sin(er*It/360),zn=Math.cos(er*It/360),jn=zn*(Xt-Wt)/2+Nn*(ve-Me)/2,wn=-Nn*(Xt-Wt)/2+zn*(ve-Me)/2;if(jn===0&&wn===0)return[{x1:0,y1:0,x2:0,y2:0,x:Wt,y:Me}];je=Math.abs(je),Qe=Math.abs(Qe);var Wn=Math.pow(jn,2)/Math.pow(je,2)+Math.pow(wn,2)/Math.pow(Qe,2);Wn>1&&(je*=Math.sqrt(Wn),Qe*=Math.sqrt(Wn));var Bt=be(Xt,ve,Wt,Me,je,Qe,Lr,Tn,Nn,zn,jn,wn),Yt=Bt[0],oe=Bt[1],Ce=Bt[2],Ue=Bt[3],fr=Math.abs(Ue)/(It/4);Math.abs(1-fr)<1e-7&&(fr=1);var Sr=Math.max(Math.ceil(fr),1);Ue/=Sr;for(var Pe=0;Pe<Sr;Pe++)rn.push(Dt(Ce,Ue)),Ce+=Ue;return rn.map(function(ur){var Wr=rt(ur[0],je,Qe,zn,Nn,Yt,oe),Sn=Wr.x,qr=Wr.y,Qr=rt(ur[1],je,Qe,zn,Nn,Yt,oe),Mn=Qr.x,bi=Qr.y,Si=rt(ur[2],je,Qe,zn,Nn,Yt,oe),Kr=Si.x,ai=Si.y;return{x1:Sn,y1:qr,x2:Mn,y2:bi,x:Kr,y:ai}})};function ee(_t,Xt,ve,Wt,Me,je,Qe,hr,er){var Br=me({px:_t,py:Xt,cx:hr,cy:er,rx:ve,ry:Wt,xAxisRotation:Me,largeArcFlag:je,sweepFlag:Qe});return Br.reduce(function(Lr,Zr){var Tn=Zr.x1,rn=Zr.y1,Nn=Zr.x2,zn=Zr.y2,jn=Zr.x,wn=Zr.y;return Lr.push(Tn,rn,Nn,zn,jn,wn),Lr},[])}function we(_t,Xt){"TQ".indexOf(_t[0])<0&&(Xt.qx=null,Xt.qy=null);var ve=_t.slice(1),Wt=ve[0],Me=ve[1];switch(_t[0]){case"M":return Xt.x=Wt,Xt.y=Me,_t;case"A":return["C"].concat(arcToCubic.apply(0,[Xt.x1,Xt.y1].concat(_t.slice(1))));case"Q":return Xt.qx=Wt,Xt.qy=Me,["C"].concat(quadToCubic.apply(0,[Xt.x1,Xt.y1].concat(_t.slice(1))));case"L":return["C"].concat(lineToCubic(Xt.x1,Xt.y1,_t[1],_t[2]));case"H":return["C"].concat(lineToCubic(Xt.x1,Xt.y1,_t[1],Xt.y1));case"V":return["C"].concat(lineToCubic(Xt.x1,Xt.y1,Xt.x1,_t[1]));case"Z":return["C"].concat(lineToCubic(Xt.x1,Xt.y1,Xt.x,Xt.y));default:}return _t}function _e(_t,Xt){Xt===void 0&&(Xt=!1);for(var ve=path2Absolute(_t),Wt={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null},Me=[],je="",Qe=ve.length,hr,er,Br=[],Lr=0;Lr<Qe;Lr+=1)ve[Lr]&&(je=ve[Lr][0]),Me[Lr]=je,ve[Lr]=segmentToCubic(ve[Lr],Wt),gt(ve,Me,Lr),Qe=ve.length,je==="Z"&&Br.push(Lr),hr=ve[Lr],er=hr.length,Wt.x1=+hr[er-2],Wt.y1=+hr[er-1],Wt.x2=+hr[er-4]||Wt.x1,Wt.y2=+hr[er-3]||Wt.y1;return Xt?[ve,Br]:ve}function gt(_t,Xt,ve){if(_t[ve].length>7){_t[ve].shift();for(var Wt=_t[ve],Me=ve;Wt.length;)Xt[ve]="A",_t.splice(Me+=1,0,["C"].concat(Wt.splice(0,6)));_t.splice(ve,1)}}var Pt=function(_t,Xt,ve,Wt,Me){var je=-3*Xt+9*ve-9*Wt+3*Me,Qe=_t*je+6*Xt-12*ve+6*Wt;return _t*Qe-3*Xt+3*ve},J=function(_t,Xt,ve,Wt,Me,je,Qe,hr,er){er===null&&(er=1),er=er>1?1:er<0?0:er;for(var Br=er/2,Lr=12,Zr=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],Tn=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],rn=0,Nn=0;Nn<Lr;Nn++){var zn=Br*Zr[Nn]+Br,jn=Pt(zn,_t,ve,Me,Qe),wn=Pt(zn,Xt,Wt,je,hr),Wn=jn*jn+wn*wn;rn+=Tn[Nn]*Math.sqrt(Wn)}return Br*rn},vt=function(_t,Xt,ve,Wt,Me,je,Qe,hr){for(var er=[],Br=[[],[]],Lr,Zr,Tn,rn,Nn=0;Nn<2;++Nn){if(Nn===0?(Zr=6*_t-12*ve+6*Me,Lr=-3*_t+9*ve-9*Me+3*Qe,Tn=3*ve-3*_t):(Zr=6*Xt-12*Wt+6*je,Lr=-3*Xt+9*Wt-9*je+3*hr,Tn=3*Wt-3*Xt),Math.abs(Lr)<1e-12){if(Math.abs(Zr)<1e-12)continue;rn=-Tn/Zr,rn>0&&rn<1&&er.push(rn);continue}var zn=Zr*Zr-4*Tn*Lr,jn=Math.sqrt(zn);if(!(zn<0)){var wn=(-Zr+jn)/(2*Lr);wn>0&&wn<1&&er.push(wn);var Wn=(-Zr-jn)/(2*Lr);Wn>0&&Wn<1&&er.push(Wn)}}for(var Bt=er.length,Yt=Bt,oe;Bt--;)rn=er[Bt],oe=1-rn,Br[0][Bt]=oe*oe*oe*_t+3*oe*oe*rn*ve+3*oe*rn*rn*Me+rn*rn*rn*Qe,Br[1][Bt]=oe*oe*oe*Xt+3*oe*oe*rn*Wt+3*oe*rn*rn*je+rn*rn*rn*hr;return Br[0][Yt]=_t,Br[1][Yt]=Xt,Br[0][Yt+1]=Qe,Br[1][Yt+1]=hr,Br[0].length=Br[1].length=Yt+2,{min:{x:Math.min.apply(0,Br[0]),y:Math.min.apply(0,Br[1])},max:{x:Math.max.apply(0,Br[0]),y:Math.max.apply(0,Br[1])}}},W=function(_t,Xt,ve,Wt,Me,je,Qe,hr){if(!(Math.max(_t,ve)<Math.min(Me,Qe)||Math.min(_t,ve)>Math.max(Me,Qe)||Math.max(Xt,Wt)<Math.min(je,hr)||Math.min(Xt,Wt)>Math.max(je,hr))){var er=(_t*Wt-Xt*ve)*(Me-Qe)-(_t-ve)*(Me*hr-je*Qe),Br=(_t*Wt-Xt*ve)*(je-hr)-(Xt-Wt)*(Me*hr-je*Qe),Lr=(_t-ve)*(je-hr)-(Xt-Wt)*(Me-Qe);if(!!Lr){var Zr=er/Lr,Tn=Br/Lr,rn=+Zr.toFixed(2),Nn=+Tn.toFixed(2);if(!(rn<+Math.min(_t,ve).toFixed(2)||rn>+Math.max(_t,ve).toFixed(2)||rn<+Math.min(Me,Qe).toFixed(2)||rn>+Math.max(Me,Qe).toFixed(2)||Nn<+Math.min(Xt,Wt).toFixed(2)||Nn>+Math.max(Xt,Wt).toFixed(2)||Nn<+Math.min(je,hr).toFixed(2)||Nn>+Math.max(je,hr).toFixed(2)))return{x:Zr,y:Tn}}}},dt=function(_t,Xt,ve){return Xt>=_t.x&&Xt<=_t.x+_t.width&&ve>=_t.y&&ve<=_t.y+_t.height},Vt=function(_t,Xt,ve,Wt){return _t===null&&(_t=Xt=ve=Wt=0),Xt===null&&(Xt=_t.y,ve=_t.width,Wt=_t.height,_t=_t.x),{x:_t,y:Xt,width:ve,w:ve,height:Wt,h:Wt,x2:_t+ve,y2:Xt+Wt,cx:_t+ve/2,cy:Xt+Wt/2,r1:Math.min(ve,Wt)/2,r2:Math.max(ve,Wt)/2,r0:Math.sqrt(ve*ve+Wt*Wt)/2,path:rectPath(_t,Xt,ve,Wt),vb:[_t,Xt,ve,Wt].join(" ")}},ne=function(_t,Xt){return _t=Vt(_t),Xt=Vt(Xt),dt(Xt,_t.x,_t.y)||dt(Xt,_t.x2,_t.y)||dt(Xt,_t.x,_t.y2)||dt(Xt,_t.x2,_t.y2)||dt(_t,Xt.x,Xt.y)||dt(_t,Xt.x2,Xt.y)||dt(_t,Xt.x,Xt.y2)||dt(_t,Xt.x2,Xt.y2)||(_t.x<Xt.x2&&_t.x>Xt.x||Xt.x<_t.x2&&Xt.x>_t.x)&&(_t.y<Xt.y2&&_t.y>Xt.y||Xt.y<_t.y2&&Xt.y>_t.y)},ge=function(_t,Xt,ve,Wt,Me,je,Qe,hr){isArray(_t)||(_t=[_t,Xt,ve,Wt,Me,je,Qe,hr]);var er=vt.apply(null,_t);return Vt(er.min.x,er.min.y,er.max.x-er.min.x,er.max.y-er.min.y)},$e=function(_t,Xt,ve,Wt,Me,je,Qe,hr,er){var Br=1-er,Lr=Math.pow(Br,3),Zr=Math.pow(Br,2),Tn=er*er,rn=Tn*er,Nn=Lr*_t+Zr*3*er*ve+Br*3*er*er*Me+rn*Qe,zn=Lr*Xt+Zr*3*er*Wt+Br*3*er*er*je+rn*hr,jn=_t+2*er*(ve-_t)+Tn*(Me-2*ve+_t),wn=Xt+2*er*(Wt-Xt)+Tn*(je-2*Wt+Xt),Wn=ve+2*er*(Me-ve)+Tn*(Qe-2*Me+ve),Bt=Wt+2*er*(je-Wt)+Tn*(hr-2*je+Wt),Yt=Br*_t+er*ve,oe=Br*Xt+er*Wt,Ce=Br*Me+er*Qe,Ue=Br*je+er*hr,fr=90-Math.atan2(jn-Wn,wn-Bt)*180/Math.PI;return{x:Nn,y:zn,m:{x:jn,y:wn},n:{x:Wn,y:Bt},start:{x:Yt,y:oe},end:{x:Ce,y:Ue},alpha:fr}},jt=function(_t,Xt,ve){var Wt=ge(_t),Me=ge(Xt);if(!ne(Wt,Me))return ve?0:[];for(var je=J.apply(0,_t),Qe=J.apply(0,Xt),hr=~~(je/8),er=~~(Qe/8),Br=[],Lr=[],Zr={},Tn=ve?0:[],rn=0;rn<hr+1;rn++){var Nn=$e.apply(0,_t.concat(rn/hr));Br.push({x:Nn.x,y:Nn.y,t:rn/hr})}for(var rn=0;rn<er+1;rn++){var Nn=$e.apply(0,Xt.concat(rn/er));Lr.push({x:Nn.x,y:Nn.y,t:rn/er})}for(var rn=0;rn<hr;rn++)for(var zn=0;zn<er;zn++){var jn=Br[rn],wn=Br[rn+1],Wn=Lr[zn],Bt=Lr[zn+1],Yt=Math.abs(wn.x-jn.x)<.001?"y":"x",oe=Math.abs(Bt.x-Wn.x)<.001?"y":"x",Ce=W(jn.x,jn.y,wn.x,wn.y,Wn.x,Wn.y,Bt.x,Bt.y);if(Ce){if(Zr[Ce.x.toFixed(4)]===Ce.y.toFixed(4))continue;Zr[Ce.x.toFixed(4)]=Ce.y.toFixed(4);var Ue=jn.t+Math.abs((Ce[Yt]-jn[Yt])/(wn[Yt]-jn[Yt]))*(wn.t-jn.t),fr=Wn.t+Math.abs((Ce[oe]-Wn[oe])/(Bt[oe]-Wn[oe]))*(Bt.t-Wn.t);Ue>=0&&Ue<=1&&fr>=0&&fr<=1&&(ve?Tn++:Tn.push({x:Ce.x,y:Ce.y,t1:Ue,t2:fr}))}}return Tn},Qt=function(_t,Xt,ve){_t=path2Curve(_t),Xt=path2Curve(Xt);for(var Wt,Me,je,Qe,hr,er,Br,Lr,Zr,Tn,rn=ve?0:[],Nn=0,zn=_t.length;Nn<zn;Nn++){var jn=_t[Nn];if(jn[0]==="M")Wt=hr=jn[1],Me=er=jn[2];else{jn[0]==="C"?(Zr=[Wt,Me].concat(jn.slice(1)),Wt=Zr[6],Me=Zr[7]):(Zr=[Wt,Me,Wt,Me,hr,er,hr,er],Wt=hr,Me=er);for(var wn=0,Wn=Xt.length;wn<Wn;wn++){var Bt=Xt[wn];if(Bt[0]==="M")je=Br=Bt[1],Qe=Lr=Bt[2];else{Bt[0]==="C"?(Tn=[je,Qe].concat(Bt.slice(1)),je=Tn[6],Qe=Tn[7]):(Tn=[je,Qe,je,Qe,Br,Lr,Br,Lr],je=Br,Qe=Lr);var Yt=jt(Zr,Tn,ve);if(ve)rn+=Yt;else{for(var oe=0,Ce=Yt.length;oe<Ce;oe++)Yt[oe].segment1=Nn,Yt[oe].segment2=wn,Yt[oe].bez1=Zr,Yt[oe].bez2=Tn;rn=rn.concat(Yt)}}}}}return rn};function Te(_t,Xt){return Qt(_t,Xt)}function ae(_t){return Math.sqrt(_t[0]*_t[0]+_t[1]*_t[1])}function Ke(_t,Xt){return ae(_t)*ae(Xt)?(_t[0]*Xt[0]+_t[1]*Xt[1])/(ae(_t)*ae(Xt)):1}function or(_t,Xt){return(_t[0]*Xt[1]<_t[1]*Xt[0]?-1:1)*Math.acos(Ke(_t,Xt))}function ie(_t,Xt){return _t[0]===Xt[0]&&_t[1]===Xt[1]}function te(_t,Xt){var ve=Xt[1],Wt=Xt[2],Me=(0,Lt.wQ)((0,Lt.c$)(Xt[3]),Math.PI*2),je=Xt[4],Qe=Xt[5],hr=_t[0],er=_t[1],Br=Xt[6],Lr=Xt[7],Zr=Math.cos(Me)*(hr-Br)/2+Math.sin(Me)*(er-Lr)/2,Tn=-1*Math.sin(Me)*(hr-Br)/2+Math.cos(Me)*(er-Lr)/2,rn=Zr*Zr/(ve*ve)+Tn*Tn/(Wt*Wt);rn>1&&(ve*=Math.sqrt(rn),Wt*=Math.sqrt(rn));var Nn=ve*ve*(Tn*Tn)+Wt*Wt*(Zr*Zr),zn=Nn?Math.sqrt((ve*ve*(Wt*Wt)-Nn)/Nn):1;je===Qe&&(zn*=-1),isNaN(zn)&&(zn=0);var jn=Wt?zn*ve*Tn/Wt:0,wn=ve?zn*-Wt*Zr/ve:0,Wn=(hr+Br)/2+Math.cos(Me)*jn-Math.sin(Me)*wn,Bt=(er+Lr)/2+Math.sin(Me)*jn+Math.cos(Me)*wn,Yt=[(Zr-jn)/ve,(Tn-wn)/Wt],oe=[(-1*Zr-jn)/ve,(-1*Tn-wn)/Wt],Ce=or([1,0],Yt),Ue=or(Yt,oe);return Ke(Yt,oe)<=-1&&(Ue=Math.PI),Ke(Yt,oe)>=1&&(Ue=0),Qe===0&&Ue>0&&(Ue=Ue-2*Math.PI),Qe===1&&Ue<0&&(Ue=Ue+2*Math.PI),{cx:Wn,cy:Bt,rx:ie(_t,[Br,Lr])?0:ve,ry:ie(_t,[Br,Lr])?0:Wt,startAngle:Ce,endAngle:Ce+Ue,xRotation:Me,arcFlag:je,sweepFlag:Qe}}function St(_t,Xt){return[Xt[0]+(Xt[0]-_t[0]),Xt[1]+(Xt[1]-_t[1])]}function qt(_t){_t=q(_t);for(var Xt=[],ve=null,Wt=null,Me=null,je=0,Qe=_t.length,hr=0;hr<Qe;hr++){var er=_t[hr];Wt=_t[hr+1];var Br=er[0],Lr={command:Br,prePoint:ve,params:er,startTangent:null,endTangent:null};switch(Br){case"M":Me=[er[1],er[2]],je=hr;break;case"A":var Zr=te(ve,er);Lr.arcParams=Zr;break;default:break}if(Br==="Z")ve=Me,Wt=_t[je+1];else{var Tn=er.length;ve=[er[Tn-2],er[Tn-1]]}Wt&&Wt[0]==="Z"&&(Wt=_t[je],Xt[je]&&(Xt[je].prePoint=ve)),Lr.currentPoint=ve,Xt[je]&&ie(ve,Xt[je].currentPoint)&&(Xt[je].prePoint=Lr.prePoint);var rn=Wt?[Wt[Wt.length-2],Wt[Wt.length-1]]:null;Lr.nextPoint=rn;var Nn=Lr.prePoint;if(["L","H","V"].includes(Br))Lr.startTangent=[Nn[0]-ve[0],Nn[1]-ve[1]],Lr.endTangent=[ve[0]-Nn[0],ve[1]-Nn[1]];else if(Br==="Q"){var zn=[er[1],er[2]];Lr.startTangent=[Nn[0]-zn[0],Nn[1]-zn[1]],Lr.endTangent=[ve[0]-zn[0],ve[1]-zn[1]]}else if(Br==="T"){var jn=Xt[hr-1],zn=St(jn.currentPoint,Nn);jn.command==="Q"?(Lr.command="Q",Lr.startTangent=[Nn[0]-zn[0],Nn[1]-zn[1]],Lr.endTangent=[ve[0]-zn[0],ve[1]-zn[1]]):(Lr.command="TL",Lr.startTangent=[Nn[0]-ve[0],Nn[1]-ve[1]],Lr.endTangent=[ve[0]-Nn[0],ve[1]-Nn[1]])}else if(Br==="C"){var wn=[er[1],er[2]],Wn=[er[3],er[4]];Lr.startTangent=[Nn[0]-wn[0],Nn[1]-wn[1]],Lr.endTangent=[ve[0]-Wn[0],ve[1]-Wn[1]],Lr.startTangent[0]===0&&Lr.startTangent[1]===0&&(Lr.startTangent=[wn[0]-Wn[0],wn[1]-Wn[1]]),Lr.endTangent[0]===0&&Lr.endTangent[1]===0&&(Lr.endTangent=[Wn[0]-wn[0],Wn[1]-wn[1]])}else if(Br==="S"){var jn=Xt[hr-1],wn=St(jn.currentPoint,Nn),Wn=[er[1],er[2]];jn.command==="C"?(Lr.command="C",Lr.startTangent=[Nn[0]-wn[0],Nn[1]-wn[1]],Lr.endTangent=[ve[0]-Wn[0],ve[1]-Wn[1]]):(Lr.command="SQ",Lr.startTangent=[Nn[0]-Wn[0],Nn[1]-Wn[1]],Lr.endTangent=[ve[0]-Wn[0],ve[1]-Wn[1]])}else if(Br==="A"){var Bt=.001,Yt=Lr.arcParams||{},oe=Yt.cx,Ce=oe===void 0?0:oe,Ue=Yt.cy,fr=Ue===void 0?0:Ue,Sr=Yt.rx,Pe=Sr===void 0?0:Sr,ur=Yt.ry,Wr=ur===void 0?0:ur,Sn=Yt.sweepFlag,qr=Sn===void 0?0:Sn,Qr=Yt.startAngle,Mn=Qr===void 0?0:Qr,bi=Yt.endAngle,Si=bi===void 0?0:bi;qr===0&&(Bt*=-1);var Kr=Pe*Math.cos(Mn-Bt)+Ce,ai=Wr*Math.sin(Mn-Bt)+fr;Lr.startTangent=[Kr-Me[0],ai-Me[1]];var li=Pe*Math.cos(Mn+Si+Bt)+Ce,hi=Wr*Math.sin(Mn+Si-Bt)+fr;Lr.endTangent=[Nn[0]-li,Nn[1]-hi]}Xt.push(Lr)}return Xt}var $t=1e-6;function Ct(_t){return Math.abs(_t)<$t?0:_t<0?-1:1}function Tt(_t,Xt,ve){return(ve[0]-_t[0])*(Xt[1]-_t[1])===(Xt[0]-_t[0])*(ve[1]-_t[1])&&Math.min(_t[0],Xt[0])<=ve[0]&&ve[0]<=Math.max(_t[0],Xt[0])&&Math.min(_t[1],Xt[1])<=ve[1]&&ve[1]<=Math.max(_t[1],Xt[1])}function ue(_t,Xt,ve){var Wt=!1,Me=_t.length;if(Me<=2)return!1;for(var je=0;je<Me;je++){var Qe=_t[je],hr=_t[(je+1)%Me];if(Tt(Qe,hr,[Xt,ve]))return!0;Ct(Qe[1]-ve)>0!=Ct(hr[1]-ve)>0&&Ct(Xt-(ve-Qe[1])*(Qe[0]-hr[0])/(Qe[1]-hr[1])-Qe[0])<0&&(Wt=!Wt)}return Wt}var Oe=function(_t,Xt,ve){return _t>=Xt&&_t<=ve};function We(_t,Xt,ve,Wt){var Me=.001,je={x:ve.x-_t.x,y:ve.y-_t.y},Qe={x:Xt.x-_t.x,y:Xt.y-_t.y},hr={x:Wt.x-ve.x,y:Wt.y-ve.y},er=Qe.x*hr.y-Qe.y*hr.x,Br=er*er,Lr=Qe.x*Qe.x+Qe.y*Qe.y,Zr=hr.x*hr.x+hr.y*hr.y,Tn=null;if(Br>Me*Lr*Zr){var rn=(je.x*hr.y-je.y*hr.x)/er,Nn=(je.x*Qe.y-je.y*Qe.x)/er;Oe(rn,0,1)&&Oe(Nn,0,1)&&(Tn={x:_t.x+rn*Qe.x,y:_t.y+rn*Qe.y})}return Tn}function zt(_t){for(var Xt=[],ve=_t.length,Wt=0;Wt<ve-1;Wt++){var Me=_t[Wt],je=_t[Wt+1];Xt.push({from:{x:Me[0],y:Me[1]},to:{x:je[0],y:je[1]}})}if(Xt.length>1){var Qe=_t[0],hr=_t[ve-1];Xt.push({from:{x:hr[0],y:hr[1]},to:{x:Qe[0],y:Qe[1]}})}return Xt}function At(_t,Xt){var ve=!1;return(0,Lt.S6)(_t,function(Wt){if(We(Wt.from,Wt.to,Xt.from,Xt.to))return ve=!0,!1}),ve}function Mt(_t){var Xt=_t.map(function(Wt){return Wt[0]}),ve=_t.map(function(Wt){return Wt[1]});return{minX:Math.min.apply(null,Xt),maxX:Math.max.apply(null,Xt),minY:Math.min.apply(null,ve),maxY:Math.max.apply(null,ve)}}function Rt(_t,Xt){return!(Xt.minX>_t.maxX||Xt.maxX<_t.minX||Xt.minY>_t.maxY||Xt.maxY<_t.minY)}function tt(_t,Xt){if(_t.length<2||Xt.length<2)return!1;var ve=Mt(_t),Wt=Mt(Xt);if(!Rt(ve,Wt))return!1;var Me=!1;if((0,Lt.S6)(Xt,function(er){if(ue(_t,er[0],er[1]))return Me=!0,!1}),Me||((0,Lt.S6)(_t,function(er){if(ue(Xt,er[0],er[1]))return Me=!0,!1}),Me))return!0;var je=zt(_t),Qe=zt(Xt),hr=!1;return(0,Lt.S6)(Qe,function(er){if(At(je,er))return hr=!0,!1}),hr}},45098:function(vn,Ft,ot){"use strict";ot.d(Ft,{Ct:function(){return Yl},f0:function(){return Vr},uZ:function(){return Bt},VS:function(){return Hs},d9:function(){return Ou},FX:function(){return Et},Ds:function(){return nu},b$:function(){return Uc},e5:function(){return ct},S6:function(){return Se},yW:function(){return je},hX:function(){return lt},sE:function(){return _e},cx:function(){return Pt},Wx:function(){return vt},ri:function(){return oe},xH:function(){return dt},U5:function(){return vo},U2:function(){return Ln},Lo:function(){return Vc},rx:function(){return Qt},ru:function(){return Tn},vM:function(){return Lr},Ms:function(){return Zr},wH:function(){return to},YM:function(){return Rt},q9:function(){return Et},cq:function(){return sc},kJ:function(){return b},jn:function(){return ns},J_:function(){return Go},kK:function(){return Ho},xb:function(){return uc},Xy:function(){return Y},mf:function(){return st},BD:function(){return Dt},UM:function(){return P},Ft:function(){return Wu},hj:function(){return Ue},vQ:function(){return bi},Kn:function(){return X},PO:function(){return ee},HD:function(){return Oe},P9:function(){return it},o8:function(){return Ma},XP:function(){return It},Z$:function(){return tt},vl:function(){return xe},UI:function(){return se},Q8:function(){return wr},Fp:function(){return ge},UT:function(){return hi},HP:function(){return dl},VV:function(){return $e},F:function(){return ra},CD:function(){return Vr},wQ:function(){return Ba},ZT:function(){return gs},CE:function(){return ba},ei:function(){return Pa},u4:function(){return Ct},Od:function(){return ue},U7:function(){return qo},t8:function(){return Gn},dp:function(){return xu},G:function(){return hr},MR:function(){return zt},ng:function(){return Mr},P2:function(){return uo},qo:function(){return Ca},c$:function(){return Vo},BB:function(){return bo},jj:function(){return At},EL:function(){return qa},jC:function(){return In},VO:function(){return ju},I:function(){return Mt}});var Lt=function(ye){return ye!==null&&typeof ye!="function"&&isFinite(ye.length)},wt=Lt,I=function(ye,ir){return wt(ye)?ye.indexOf(ir)>-1:!1},Et=I,q=function(ye,ir){if(!wt(ye))return ye;for(var Or=[],$r=0;$r<ye.length;$r++){var xn=ye[$r];ir(xn,$r)&&Or.push(xn)}return Or},lt=q,ht=function(ye,ir){return ir===void 0&&(ir=[]),lt(ye,function(Or){return!Et(ir,Or)})},ct=ht,et={}.toString,Ee=function(ye,ir){return et.call(ye)==="[object "+ir+"]"},it=Ee,st=function(ye){return it(ye,"Function")},Zt=function(ye){return ye==null},P=Zt,b=function(ye){return Array.isArray?Array.isArray(ye):it(ye,"Array")},X=function(ye){var ir=typeof ye;return ye!==null&&ir==="object"||ir==="function"};function le(ye,ir){if(!!ye){var Or;if(b(ye))for(var $r=0,xn=ye.length;$r<xn&&(Or=ir(ye[$r],$r),Or!==!1);$r++);else if(X(ye)){for(var _i in ye)if(ye.hasOwnProperty(_i)&&(Or=ir(ye[_i],_i),Or===!1))break}}}var Se=le,Ie=Object.keys?function(ye){return Object.keys(ye)}:function(ye){var ir=[];return Se(ye,function(Or,$r){st(ye)&&$r==="prototype"||ir.push($r)}),ir},It=Ie;function rt(ye,ir){var Or=It(ir),$r=Or.length;if(P(ye))return!$r;for(var xn=0;xn<$r;xn+=1){var _i=Or[xn];if(ir[_i]!==ye[_i]||!(_i in ye))return!1}return!0}var Dt=rt,Ae=function(ye){return typeof ye=="object"&&ye!==null},be=Ae,me=function(ye){if(!be(ye)||!it(ye,"Object"))return!1;if(Object.getPrototypeOf(ye)===null)return!0;for(var ir=ye;Object.getPrototypeOf(ir)!==null;)ir=Object.getPrototypeOf(ir);return Object.getPrototypeOf(ye)===ir},ee=me;function we(ye,ir){if(!b(ye))return null;var Or;if(st(ir)&&(Or=ir),ee(ir)&&(Or=function(xn){return Dt(xn,ir)}),Or){for(var $r=0;$r<ye.length;$r+=1)if(Or(ye[$r]))return ye[$r]}return null}var _e=we;function gt(ye,ir,Or){Or===void 0&&(Or=0);for(var $r=Or;$r<ye.length;$r++)if(ir(ye[$r],$r))return $r;return-1}var Pt=gt,J=function(ye,ir){for(var Or=null,$r=0;$r<ye.length;$r++){var xn=ye[$r],_i=xn[ir];if(!P(_i)){b(_i)?Or=_i[0]:Or=_i;break}}return Or},vt=J,W=function(ye){if(!b(ye))return[];for(var ir=[],Or=0;Or<ye.length;Or++)ir=ir.concat(ye[Or]);return ir},dt=W,Vt=function(ye,ir){if(ir===void 0&&(ir=[]),!isArray(ye))ir.push(ye);else for(var Or=0;Or<ye.length;Or+=1)Vt(ye[Or],ir);return ir},ne=null,ge=function(ye){if(!!b(ye))return ye.reduce(function(ir,Or){return Math.max(ir,Or)},ye[0])},$e=function(ye){if(!!b(ye))return ye.reduce(function(ir,Or){return Math.min(ir,Or)},ye[0])},jt=function(ye){var ir=ye.filter(function(qi){return!isNaN(qi)});if(!ir.length)return{min:0,max:0};if(b(ye[0])){for(var Or=[],$r=0;$r<ye.length;$r++)Or=Or.concat(ye[$r]);ir=Or}var xn=ge(ir),_i=$e(ir);return{min:_i,max:xn}},Qt=jt,Te=Array.prototype,ae=Te.splice,Ke=Te.indexOf,or=function(ye){for(var ir=[],Or=1;Or<arguments.length;Or++)ir[Or-1]=arguments[Or];for(var $r=0;$r<ir.length;$r++)for(var xn=ir[$r],_i=-1;(_i=Ke.call(ye,xn))>-1;)ae.call(ye,_i,1);return ye},ie=null,te=Array.prototype.splice,St=function(ir,Or){if(!wt(ir))return[];for(var $r=ir?Or.length:0,xn=$r-1;$r--;){var _i=void 0,qi=Or[$r];($r===xn||qi!==_i)&&(_i=qi,te.call(ir,qi,1))}return ir},qt=St,$t=function(ye,ir,Or){if(!b(ye)&&!ee(ye))return ye;var $r=Or;return Se(ye,function(xn,_i){$r=ir($r,xn,_i)}),$r},Ct=$t,Tt=function(ye,ir){var Or=[];if(!wt(ye))return Or;for(var $r=-1,xn=[],_i=ye.length;++$r<_i;){var qi=ye[$r];ir(qi,$r,ye)&&(Or.push(qi),xn.push($r))}return qt(ye,xn),Or},ue=Tt,Oe=function(ye){return it(ye,"String")};function We(ye,ir){var Or;if(st(ir))Or=function(xn,_i){return ir(xn)-ir(_i)};else{var $r=[];Oe(ir)?$r.push(ir):b(ir)&&($r=ir),Or=function(xn,_i){for(var qi=0;qi<$r.length;qi+=1){var Ia=$r[qi];if(xn[Ia]>_i[Ia])return 1;if(xn[Ia]<_i[Ia])return-1}return 0}}return ye.sort(Or),ye}var zt=We;function At(ye,ir){ir===void 0&&(ir=new Map);var Or=[];if(Array.isArray(ye))for(var $r=0,xn=ye.length;$r<xn;$r++){var _i=ye[$r];ir.has(_i)||(Or.push(_i),ir.set(_i,!0))}return Or}var Mt=function(ye,ir){for(var Or=[],$r={},xn=0;xn<ye.length;xn++){var _i=ye[xn],qi=_i[ir];if(!P(qi)){b(qi)||(qi=[qi]);for(var Ia=0;Ia<qi.length;Ia++){var du=qi[Ia];$r[du]||(Or.push(du),$r[du]=!0)}}}return Or};function Rt(ye){if(wt(ye))return ye[0]}function tt(ye){if(wt(ye)){var ir=ye;return ir[ir.length-1]}}function _t(ye,ir){return isArray(ye)||isString(ye)?ye[0]===ir:!1}var Xt=null;function ve(ye,ir){return isArray(ye)||isString(ye)?ye[ye.length-1]===ir:!1}var Wt=null,Me=function(ye,ir){for(var Or=0;Or<ye.length;Or++)if(!ir(ye[Or],Or))return!1;return!0},je=Me,Qe=function(ye,ir){for(var Or=0;Or<ye.length;Or++)if(ir(ye[Or],Or))return!0;return!1},hr=Qe,er=Object.prototype.hasOwnProperty;function Br(ye,ir){if(!ir||!b(ye))return{};for(var Or={},$r=st(ir)?ir:function(Ia){return Ia[ir]},xn,_i=0;_i<ye.length;_i++){var qi=ye[_i];xn=$r(qi),er.call(Or,xn)?Or[xn].push(qi):Or[xn]=[qi]}return Or}var Lr=Br;function Zr(ye,ir){if(!ir)return{0:ye};if(!st(ir)){var Or=b(ir)?ir:ir.replace(/\s+/g,"").split("*");ir=function($r){for(var xn="_",_i=0,qi=Or.length;_i<qi;_i++)xn+=$r[Or[_i]]&&$r[Or[_i]].toString();return xn}}return Lr(ye,ir)}var Tn=function(ye,ir){if(!ir)return[ye];var Or=Zr(ye,ir),$r=[];for(var xn in Or)$r.push(Or[xn]);return $r},rn={};function Nn(ye){var ir=rn[ye];if(!ir){for(var Or=ye.toString(16),$r=Or.length;$r<6;$r++)Or="0"+Or;ir="#"+Or,rn[ye]=ir}return ir}var zn=null;function jn(ye){var ir=0,Or=0,$r=0,xn=0;return isArray(ye)?ye.length===1?ir=Or=$r=xn=ye[0]:ye.length===2?(ir=$r=ye[0],Or=xn=ye[1]):ye.length===3?(ir=ye[0],Or=xn=ye[1],$r=ye[2]):(ir=ye[0],Or=ye[1],$r=ye[2],xn=ye[3]):ir=Or=$r=xn=ye,{r1:ir,r2:Or,r3:$r,r4:xn}}var wn=null,Wn=function(ye,ir,Or){return ye<ir?ir:ye>Or?Or:ye},Bt=Wn,Yt=function(ye,ir){var Or=ir.toString(),$r=Or.indexOf(".");if($r===-1)return Math.round(ye);var xn=Or.substr($r+1).length;return xn>20&&(xn=20),parseFloat(ye.toFixed(xn))},oe=Yt,Ce=function(ye){return it(ye,"Number")},Ue=Ce,fr=function(ye){return isNumber(ye)&&ye%1!==0},Sr=null,Pe=function(ye){return isNumber(ye)&&ye%2===0},ur=null,Wr=Number.isInteger?Number.isInteger:function(ye){return Ue(ye)&&ye%1===0},Sn=null,qr=function(ye){return isNumber(ye)&&ye<0},Qr=null,Mn=1e-5;function bi(ye,ir,Or){return Or===void 0&&(Or=Mn),Math.abs(ye-ir)<Or}var Si=function(ye){return isNumber(ye)&&ye%2!==0},Kr=null,ai=function(ye){return isNumber(ye)&&ye>0},li=null,hi=function(ye,ir){if(!!b(ye)){for(var Or,$r=-1/0,xn=0;xn<ye.length;xn++){var _i=ye[xn],qi=st(ir)?ir(_i):_i[ir];qi>$r&&(Or=_i,$r=qi)}return Or}},ra=function(ye,ir){if(!!b(ye)){for(var Or,$r=1/0,xn=0;xn<ye.length;xn++){var _i=ye[xn],qi=st(ir)?ir(_i):_i[ir];qi<$r&&(Or=_i,$r=qi)}return Or}},Ci=function(ye,ir){return(ye%ir+ir)%ir},Ba=Ci,po=180/Math.PI,za=function(ye){return po*ye},Xa=null,Ta=parseInt,ga=Math.PI/180,no=function(ye){return ga*ye},Vo=no,vo=Se,ja=function(ye,ir){return ye.hasOwnProperty(ir)},to=ja,Uo=Object.values?function(ye){return Object.values(ye)}:function(ye){var ir=[];return Se(ye,function(Or,$r){st(ye)&&$r==="prototype"||ir.push(Or)}),ir},ju=Uo,Wo=function(ye,ir){return contains(values(ye),ir)},bo=function(ye){return P(ye)?"":ye.toString()},nr=function(ye){return bo(ye).toLowerCase()},xe=nr;function He(ye,ir){return!ye||!ir?ye:ye.replace(/\\?\{([^{}]+)\}/g,function(Or,$r){return Or.charAt(0)==="\\"?Or.slice(1):ir[$r]===void 0?"":ir[$r]})}var Mr=He,tn=function(ye){var ir=bo(ye);return ir.charAt(0).toUpperCase()+ir.substring(1)},In=tn,Un={}.toString,Cn=function(ye){return Un.call(ye).replace(/^\[object /,"").replace(/]$/,"")},ta=Cn,Wa=function(ye){return isType(ye,"Arguments")},es=null,ko=function(ye){return it(ye,"Boolean")},ns=ko,Ya=function(ye){return it(ye,"Date")},Go=Ya,pu=function(ye){return isType(ye,"Error")},ys=null;function Rl(ye){return isNumber(ye)&&isFinite(ye)}var mf=function(ye){return ye===null},Wu=mf,ke=Object.prototype,Xe=function(ye){var ir=ye&&ye.constructor,Or=typeof ir=="function"&&ir.prototype||ke;return ye===Or},Tr=Xe,un=function(ye){return isType(ye,"RegExp")},si=null,ji=function(ye){return ye===void 0},Ma=ji,ds=function(ye){return ye instanceof Element||ye instanceof HTMLDocument},Ho=ds;function qo(ye){var ir=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(Or){return setTimeout(Or,16)};return ir(ye)}function Hs(ye){var ir=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame||clearTimeout;ir(ye)}var Xu=function(){for(var ye=[],ir=0;ir<arguments.length;ir++)ye[ir]=arguments[ir];for(var Or=ye[0],$r=1;$r<ye.length;$r++){var xn=ye[$r];isFunction(xn)&&(xn=xn.prototype),mix(Or.prototype,xn)}},_s=null,vs=function(ye){if(typeof ye!="object"||ye===null)return ye;var ir;if(b(ye)){ir=[];for(var Or=0,$r=ye.length;Or<$r;Or++)typeof ye[Or]=="object"&&ye[Or]!=null?ir[Or]=vs(ye[Or]):ir[Or]=ye[Or]}else{ir={};for(var xn in ye)typeof ye[xn]=="object"&&ye[xn]!=null?ir[xn]=vs(ye[xn]):ir[xn]=ye[xn]}return ir},Ou=vs;function rl(ye,ir,Or){var $r;return function(){var xn=this,_i=arguments,qi=function(){$r=null,Or||ye.apply(xn,_i)},Ia=Or&&!$r;clearTimeout($r),$r=setTimeout(qi,ir),Ia&&ye.apply(xn,_i)}}var nu=rl,dl=function(ye,ir){if(!st(ye))throw new TypeError("Expected a function");var Or=function(){for(var $r=[],xn=0;xn<arguments.length;xn++)$r[xn]=arguments[xn];var _i=ir?ir.apply(this,$r):$r[0],qi=Or.cache;if(qi.has(_i))return qi.get(_i);var Ia=ye.apply(this,$r);return qi.set(_i,Ia),Ia};return Or.cache=new Map,Or},Fu=5;function Fo(ye,ir,Or,$r){Or=Or||0,$r=$r||Fu;for(var xn in ir)if(ir.hasOwnProperty(xn)){var _i=ir[xn];_i!==null&&ee(_i)?(ee(ye[xn])||(ye[xn]={}),Or<$r?Fo(ye[xn],_i,Or+1,$r):ye[xn]=ir[xn]):b(_i)?(ye[xn]=[],ye[xn]=ye[xn].concat(_i)):_i!==void 0&&(ye[xn]=_i)}}var rs=function(ye){for(var ir=[],Or=1;Or<arguments.length;Or++)ir[Or-1]=arguments[Or];for(var $r=0;$r<ir.length;$r+=1)Fo(ye,ir[$r]);return ye},Uc=rs,_u=function(ye,ir,Or,$r){isFunction(ir)||(Or=ir,ir=ye,ye=function(){});var xn=Object.create?function(qi,Ia){return Object.create(qi,{constructor:{value:Ia}})}:function(qi,Ia){function du(){}du.prototype=qi;var qs=new du;return qs.constructor=Ia,qs},_i=xn(ir.prototype,ye);return ye.prototype=mix(_i,ye.prototype),ye.superclass=xn(ir.prototype,ir),mix(_i,Or),mix(ye,$r),ye},Zc=null,Co=function(ye,ir){if(!wt(ye))return-1;var Or=Array.prototype.indexOf;if(Or)return Or.call(ye,ir);for(var $r=-1,xn=0;xn<ye.length;xn++)if(ye[xn]===ir){$r=xn;break}return $r},sc=Co,Xl=Object.prototype.hasOwnProperty;function nl(ye){if(P(ye))return!0;if(wt(ye))return!ye.length;var ir=ta(ye);if(ir==="Map"||ir==="Set")return!ye.size;if(Tr(ye))return!Object.keys(ye).length;for(var Or in ye)if(Xl.call(ye,Or))return!1;return!0}var uc=nl,D=function(ye,ir){if(ye===ir)return!0;if(!ye||!ir||Oe(ye)||Oe(ir))return!1;if(wt(ye)||wt(ir)){if(ye.length!==ir.length)return!1;for(var Or=!0,$r=0;$r<ye.length&&(Or=D(ye[$r],ir[$r]),!!Or);$r++);return Or}if(be(ye)||be(ir)){var xn=Object.keys(ye),_i=Object.keys(ir);if(xn.length!==_i.length)return!1;for(var Or=!0,$r=0;$r<xn.length&&(Or=D(ye[xn[$r]],ir[xn[$r]]),!!Or);$r++);return Or}return!1},Y=D,bt=function(ye,ir,Or){return isFunction(Or)?!!Or(ye,ir):isEqual(ye,ir)},nt=function(ye,ir){if(!wt(ye))return ye;for(var Or=[],$r=0;$r<ye.length;$r++){var xn=ye[$r];Or.push(ir(xn,$r))}return Or},se=nt,Ve=function(ye){return ye},wr=function(ye,ir){ir===void 0&&(ir=Ve);var Or={};return X(ye)&&!P(ye)&&Object.keys(ye).forEach(function($r){Or[$r]=ir(ye[$r],$r)}),Or};function jr(ye,ir){for(var Or in ir)ir.hasOwnProperty(Or)&&Or!=="constructor"&&ir[Or]!==void 0&&(ye[Or]=ir[Or])}function Vr(ye,ir,Or,$r){return ir&&jr(ye,ir),Or&&jr(ye,Or),$r&&jr(ye,$r),ye}var Ln=function(ye,ir,Or){for(var $r=0,xn=Oe(ir)?ir.split("."):ir;ye&&$r<xn.length;)ye=ye[xn[$r++]];return ye===void 0||$r<xn.length?Or:ye},Gn=function(ye,ir,Or){var $r=ye,xn=Oe(ir)?ir.split("."):ir;return xn.forEach(function(_i,qi){qi<xn.length-1?(X($r[_i])||($r[_i]=Ue(xn[qi+1])?[]:{}),$r=$r[_i]):$r[_i]=Or}),ye},$i=Object.prototype.hasOwnProperty,Pa=function(ye,ir){if(ye===null||!ee(ye))return{};var Or={};return Se(ir,function($r){$i.call(ye,$r)&&(Or[$r]=ye[$r])}),Or},ba=function(ye,ir){return Ct(ye,function(Or,$r,xn){return ir.includes(xn)||(Or[xn]=$r),Or},{})},uo=function(ye,ir,Or){var $r,xn,_i,qi,Ia=0;Or||(Or={});var du=function(){Ia=Or.leading===!1?0:Date.now(),$r=null,qi=ye.apply(xn,_i),$r||(xn=_i=null)},qs=function(){var $a=Date.now();!Ia&&Or.leading===!1&&(Ia=$a);var Dl=ir-($a-Ia);return xn=this,_i=arguments,Dl<=0||Dl>ir?($r&&(clearTimeout($r),$r=null),Ia=$a,qi=ye.apply(xn,_i),$r||(xn=_i=null)):!$r&&Or.trailing!==!1&&($r=setTimeout(du,Dl)),qi};return qs.cancel=function(){clearTimeout($r),Ia=0,$r=xn=_i=null},qs},Ca=function(ye){return wt(ye)?Array.prototype.slice.call(ye):[]},Ao={},qa=function(ye){return ye=ye||"g",Ao[ye]?Ao[ye]+=1:Ao[ye]=1,ye+Ao[ye]},gs=function(){};function xu(ye){return P(ye)?0:wt(ye)?ye.length:Object.keys(ye).length}var il=ot(70655),bu,iu=dl(function(ye,ir){ir===void 0&&(ir={});var Or=ir.fontSize,$r=ir.fontFamily,xn=ir.fontWeight,_i=ir.fontStyle,qi=ir.fontVariant;return bu||(bu=document.createElement("canvas").getContext("2d")),bu.font=[_i,qi,xn,Or+"px",$r].join(" "),bu.measureText(Oe(ye)?ye:"").width},function(ye,ir){return ir===void 0&&(ir={}),(0,il.pr)([ye],ju(ir)).join("")}),Vc=function(ye,ir,Or,$r){$r===void 0&&($r="...");var xn=16,_i=iu($r,Or),qi=Oe(ye)?ye:bo(ye),Ia=ir,du=[],qs,$a;if(iu(ye,Or)<=ir)return ye;for(;qs=qi.substr(0,xn),$a=iu(qs,Or),!($a+_i>Ia&&$a>Ia);)if(du.push(qs),Ia-=$a,qi=qi.substr(xn),!qi)return du.join("");for(;qs=qi.substr(0,1),$a=iu(qs,Or),!($a+_i>Ia);)if(du.push(qs),Ia-=$a,qi=qi.substr(1),!qi)return du.join("");return""+du.join("")+$r},$s=function(){function ye(){this.map={}}return ye.prototype.has=function(ir){return this.map[ir]!==void 0},ye.prototype.get=function(ir,Or){var $r=this.map[ir];return $r===void 0?Or:$r},ye.prototype.set=function(ir,Or){this.map[ir]=Or},ye.prototype.clear=function(){this.map={}},ye.prototype.delete=function(ir){delete this.map[ir]},ye.prototype.size=function(){return Object.keys(this.map).length},ye}(),Yl=$s},38163:function(vn){vn.exports=Ft;function Ft(wt,I){var Et=wt&&wt.type,q;if(Et==="FeatureCollection")for(q=0;q<wt.features.length;q++)Ft(wt.features[q],I);else if(Et==="GeometryCollection")for(q=0;q<wt.geometries.length;q++)Ft(wt.geometries[q],I);else if(Et==="Feature")Ft(wt.geometry,I);else if(Et==="Polygon")ot(wt.coordinates,I);else if(Et==="MultiPolygon")for(q=0;q<wt.coordinates.length;q++)ot(wt.coordinates[q],I);return wt}function ot(wt,I){if(wt.length!==0){Lt(wt[0],I);for(var Et=1;Et<wt.length;Et++)Lt(wt[Et],!I)}}function Lt(wt,I){for(var Et=0,q=0,lt=0,ht=wt.length,ct=ht-1;lt<ht;ct=lt++){var et=(wt[lt][0]-wt[ct][0])*(wt[ct][1]+wt[lt][1]),Ee=Et+et;q+=Math.abs(Et)>=Math.abs(et)?Et-Ee+et:et-Ee+Et,Et=Ee}Et+q>=0!=!!I&&wt.reverse()}},75550:function(vn){"use strict";vn.exports=Ft;function Ft(ot,Lt){this.x=ot,this.y=Lt}Ft.prototype={clone:function(){return new Ft(this.x,this.y)},add:function(ot){return this.clone()._add(ot)},sub:function(ot){return this.clone()._sub(ot)},multByPoint:function(ot){return this.clone()._multByPoint(ot)},divByPoint:function(ot){return this.clone()._divByPoint(ot)},mult:function(ot){return this.clone()._mult(ot)},div:function(ot){return this.clone()._div(ot)},rotate:function(ot){return this.clone()._rotate(ot)},rotateAround:function(ot,Lt){return this.clone()._rotateAround(ot,Lt)},matMult:function(ot){return this.clone()._matMult(ot)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(ot){return this.x===ot.x&&this.y===ot.y},dist:function(ot){return Math.sqrt(this.distSqr(ot))},distSqr:function(ot){var Lt=ot.x-this.x,wt=ot.y-this.y;return Lt*Lt+wt*wt},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(ot){return Math.atan2(this.y-ot.y,this.x-ot.x)},angleWith:function(ot){return this.angleWithSep(ot.x,ot.y)},angleWithSep:function(ot,Lt){return Math.atan2(this.x*Lt-this.y*ot,this.x*ot+this.y*Lt)},_matMult:function(ot){var Lt=ot[0]*this.x+ot[1]*this.y,wt=ot[2]*this.x+ot[3]*this.y;return this.x=Lt,this.y=wt,this},_add:function(ot){return this.x+=ot.x,this.y+=ot.y,this},_sub:function(ot){return this.x-=ot.x,this.y-=ot.y,this},_mult:function(ot){return this.x*=ot,this.y*=ot,this},_div:function(ot){return this.x/=ot,this.y/=ot,this},_multByPoint:function(ot){return this.x*=ot.x,this.y*=ot.y,this},_divByPoint:function(ot){return this.x/=ot.x,this.y/=ot.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var ot=this.y;return this.y=this.x,this.x=-ot,this},_rotate:function(ot){var Lt=Math.cos(ot),wt=Math.sin(ot),I=Lt*this.x-wt*this.y,Et=wt*this.x+Lt*this.y;return this.x=I,this.y=Et,this},_rotateAround:function(ot,Lt){var wt=Math.cos(ot),I=Math.sin(ot),Et=Lt.x+wt*(this.x-Lt.x)-I*(this.y-Lt.y),q=Lt.y+I*(this.x-Lt.x)+wt*(this.y-Lt.y);return this.x=Et,this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ft.convert=function(ot){return ot instanceof Ft?ot:Array.isArray(ot)?new Ft(ot[0],ot[1]):ot}},38929:function(vn,Ft,ot){vn.exports.VectorTile=ot(22779),ot(66024),ot(59701)},22779:function(vn,Ft,ot){"use strict";var Lt=ot(59701);vn.exports=wt;function wt(Et,q){this.layers=Et.readFields(I,{},q)}function I(Et,q,lt){if(Et===3){var ht=new Lt(lt,lt.readVarint()+lt.pos);ht.length&&(q[ht.name]=ht)}}},66024:function(vn,Ft,ot){"use strict";var Lt=ot(75550);vn.exports=wt;function wt(ht,ct,et,Ee,it){this.properties={},this.extent=et,this.type=0,this._pbf=ht,this._geometry=-1,this._keys=Ee,this._values=it,ht.readFields(I,this,ct)}function I(ht,ct,et){ht==1?ct.id=et.readVarint():ht==2?Et(et,ct):ht==3?ct.type=et.readVarint():ht==4&&(ct._geometry=et.pos)}function Et(ht,ct){for(var et=ht.readVarint()+ht.pos;ht.pos<et;){var Ee=ct._keys[ht.readVarint()],it=ct._values[ht.readVarint()];ct.properties[Ee]=it}}wt.types=["Unknown","Point","LineString","Polygon"],wt.prototype.loadGeometry=function(){var ht=this._pbf;ht.pos=this._geometry;for(var ct=ht.readVarint()+ht.pos,et=1,Ee=0,it=0,st=0,Zt=[],P;ht.pos<ct;){if(Ee<=0){var b=ht.readVarint();et=b&7,Ee=b>>3}if(Ee--,et===1||et===2)it+=ht.readSVarint(),st+=ht.readSVarint(),et===1&&(P&&Zt.push(P),P=[]),P.push(new Lt(it,st));else if(et===7)P&&P.push(P[0].clone());else throw new Error("unknown command "+et)}return P&&Zt.push(P),Zt},wt.prototype.bbox=function(){var ht=this._pbf;ht.pos=this._geometry;for(var ct=ht.readVarint()+ht.pos,et=1,Ee=0,it=0,st=0,Zt=1/0,P=-1/0,b=1/0,X=-1/0;ht.pos<ct;){if(Ee<=0){var le=ht.readVarint();et=le&7,Ee=le>>3}if(Ee--,et===1||et===2)it+=ht.readSVarint(),st+=ht.readSVarint(),it<Zt&&(Zt=it),it>P&&(P=it),st<b&&(b=st),st>X&&(X=st);else if(et!==7)throw new Error("unknown command "+et)}return[Zt,b,P,X]},wt.prototype.toGeoJSON=function(ht,ct,et){var Ee=this.extent*Math.pow(2,et),it=this.extent*ht,st=this.extent*ct,Zt=this.loadGeometry(),P=wt.types[this.type],b,X;function le(It){for(var rt=0;rt<It.length;rt++){var Dt=It[rt],Ae=180-(Dt.y+st)*360/Ee;It[rt]=[(Dt.x+it)*360/Ee-180,360/Math.PI*Math.atan(Math.exp(Ae*Math.PI/180))-90]}}switch(this.type){case 1:var Se=[];for(b=0;b<Zt.length;b++)Se[b]=Zt[b][0];Zt=Se,le(Zt);break;case 2:for(b=0;b<Zt.length;b++)le(Zt[b]);break;case 3:for(Zt=q(Zt),b=0;b<Zt.length;b++)for(X=0;X<Zt[b].length;X++)le(Zt[b][X]);break}Zt.length===1?Zt=Zt[0]:P="Multi"+P;var Ie={type:"Feature",geometry:{type:P,coordinates:Zt},properties:this.properties};return"id"in this&&(Ie.id=this.id),Ie};function q(ht){var ct=ht.length;if(ct<=1)return[ht];for(var et=[],Ee,it,st=0;st<ct;st++){var Zt=lt(ht[st]);Zt!==0&&(it===void 0&&(it=Zt<0),it===Zt<0?(Ee&&et.push(Ee),Ee=[ht[st]]):Ee.push(ht[st]))}return Ee&&et.push(Ee),et}function lt(ht){for(var ct=0,et=0,Ee=ht.length,it=Ee-1,st,Zt;et<Ee;it=et++)st=ht[et],Zt=ht[it],ct+=(Zt.x-st.x)*(st.y+Zt.y);return ct}},59701:function(vn,Ft,ot){"use strict";var Lt=ot(66024);vn.exports=wt;function wt(q,lt){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=q,this._keys=[],this._values=[],this._features=[],q.readFields(I,this,lt),this.length=this._features.length}function I(q,lt,ht){q===15?lt.version=ht.readVarint():q===1?lt.name=ht.readString():q===5?lt.extent=ht.readVarint():q===2?lt._features.push(ht.pos):q===3?lt._keys.push(ht.readString()):q===4&&lt._values.push(Et(ht))}function Et(q){for(var lt=null,ht=q.readVarint()+q.pos;q.pos<ht;){var ct=q.readVarint()>>3;lt=ct===1?q.readString():ct===2?q.readFloat():ct===3?q.readDouble():ct===4?q.readVarint64():ct===5?q.readVarint():ct===6?q.readSVarint():ct===7?q.readBoolean():null}return lt}wt.prototype.feature=function(q){if(q<0||q>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[q];var lt=this._pbf.readVarint()+this._pbf.pos;return new Lt(this._pbf,lt,this.extent,this._keys,this._values)}},56645:function(vn,Ft){(function(ot,Lt){Lt(Ft)})(this,function(ot){"use strict";function Lt(we,_e){return wt(we)||I(we,_e)||Et()}function wt(we){if(Array.isArray(we))return we}function I(we,_e){var gt=[],Pt=!0,J=!1,vt=void 0;try{for(var W=we[Symbol.iterator](),dt;!(Pt=(dt=W.next()).done)&&(gt.push(dt.value),!(_e&&gt.length===_e));Pt=!0);}catch(Vt){J=!0,vt=Vt}finally{try{!Pt&&W.return!=null&&W.return()}finally{if(J)throw vt}}return gt}function Et(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function q(we,_e,gt,Pt){we=we.filter(function(Te,ae){var Ke=_e(Te,ae),or=gt(Te,ae);return Ke!=null&&isFinite(Ke)&&or!=null&&isFinite(or)}),Pt&&we.sort(function(Te,ae){return _e(Te)-_e(ae)});for(var J=we.length,vt=new Float64Array(J),W=new Float64Array(J),dt=0,Vt=0,ne,ge,$e,jt=0;jt<J;)$e=we[jt],vt[jt]=ne=+_e($e,jt,we),W[jt]=ge=+gt($e,jt,we),++jt,dt+=(ne-dt)/jt,Vt+=(ge-Vt)/jt;for(var Qt=0;Qt<J;++Qt)vt[Qt]-=dt,W[Qt]-=Vt;return[vt,W,dt,Vt]}function lt(we,_e,gt,Pt){for(var J=0,vt=0,W=we.length;vt<W;vt++){var dt=we[vt],Vt=+_e(dt,vt,we),ne=+gt(dt,vt,we);Vt!=null&&isFinite(Vt)&&ne!=null&&isFinite(ne)&&Pt(Vt,ne,J++)}}function ht(we,_e,gt,Pt,J){var vt=0,W=0;return lt(we,_e,gt,function(dt,Vt){var ne=Vt-J(dt),ge=Vt-Pt;vt+=ne*ne,W+=ge*ge}),1-vt/W}function ct(we){return Math.atan2(we[1][1]-we[0][1],we[1][0]-we[0][0])*180/Math.PI}function et(we){return[(we[0][0]+we[1][0])/2,(we[0][1]+we[1][1])/2]}function Ee(we,_e,gt){for(var Pt=Math.log(_e-we)*Math.LOG10E+1|0,J=1*Math.pow(10,-Pt/2-1),vt=1e4,W=[Vt(we),Vt(_e)],dt=0;ne(W)&&dt<vt;);return W;function Vt(ge){return[ge,gt(ge)]}function ne(ge){dt++;for(var $e=ge.length,jt=!1,Qt=0;Qt<$e-1;Qt++){var Te=ge[Qt],ae=ge[Qt+1],Ke=et([Te,ae]),or=Vt(Ke[0]),ie=ct([Te,Ke]),te=ct([Te,or]),St=Math.abs(ie-te);St>J&&(ge.splice(Qt+1,0,or),jt=!0)}return jt}}function it(we,_e,gt,Pt){var J=Pt-we*we,vt=Math.abs(J)<1e-24?0:(gt-we*_e)/J,W=_e-vt*we;return[W,vt]}function st(){var we=function(vt){return vt[0]},_e=function(vt){return vt[1]},gt;function Pt(J){var vt=0,W=0,dt=0,Vt=0,ne=0,ge=0,$e=gt?+gt[0]:1/0,jt=gt?+gt[1]:-1/0;lt(J,we,_e,function(te,St){var qt=Math.log(St),$t=te*St;++vt,W+=(St-W)/vt,Vt+=($t-Vt)/vt,ge+=(te*$t-ge)/vt,dt+=(St*qt-dt)/vt,ne+=($t*qt-ne)/vt,gt||(te<$e&&($e=te),te>jt&&(jt=te))});var Qt=it(Vt/W,dt/W,ne/W,ge/W),Te=Lt(Qt,2),ae=Te[0],Ke=Te[1];ae=Math.exp(ae);var or=function(St){return ae*Math.exp(Ke*St)},ie=Ee($e,jt,or);return ie.a=ae,ie.b=Ke,ie.predict=or,ie.rSquared=ht(J,we,_e,W,or),ie}return Pt.domain=function(J){return arguments.length?(gt=J,Pt):gt},Pt.x=function(J){return arguments.length?(we=J,Pt):we},Pt.y=function(J){return arguments.length?(_e=J,Pt):_e},Pt}function Zt(){var we=function(vt){return vt[0]},_e=function(vt){return vt[1]},gt;function Pt(J){var vt=0,W=0,dt=0,Vt=0,ne=0,ge=gt?+gt[0]:1/0,$e=gt?+gt[1]:-1/0;lt(J,we,_e,function(ie,te){++vt,W+=(ie-W)/vt,dt+=(te-dt)/vt,Vt+=(ie*te-Vt)/vt,ne+=(ie*ie-ne)/vt,gt||(ie<ge&&(ge=ie),ie>$e&&($e=ie))});var jt=it(W,dt,Vt,ne),Qt=Lt(jt,2),Te=Qt[0],ae=Qt[1],Ke=function(te){return ae*te+Te},or=[[ge,Ke(ge)],[$e,Ke($e)]];return or.a=ae,or.b=Te,or.predict=Ke,or.rSquared=ht(J,we,_e,dt,Ke),or}return Pt.domain=function(J){return arguments.length?(gt=J,Pt):gt},Pt.x=function(J){return arguments.length?(we=J,Pt):we},Pt.y=function(J){return arguments.length?(_e=J,Pt):_e},Pt}function P(we){we.sort(function(gt,Pt){return gt-Pt});var _e=we.length/2;return _e%1===0?(we[_e-1]+we[_e])/2:we[Math.floor(_e)]}var b=2,X=1e-12;function le(){var we=function(vt){return vt[0]},_e=function(vt){return vt[1]},gt=.3;function Pt(J){for(var vt=q(J,we,_e,!0),W=Lt(vt,4),dt=W[0],Vt=W[1],ne=W[2],ge=W[3],$e=dt.length,jt=Math.max(2,~~(gt*$e)),Qt=new Float64Array($e),Te=new Float64Array($e),ae=new Float64Array($e).fill(1),Ke=-1;++Ke<=b;){for(var or=[0,jt-1],ie=0;ie<$e;++ie){for(var te=dt[ie],St=or[0],qt=or[1],$t=te-dt[St]>dt[qt]-te?St:qt,Ct=0,Tt=0,ue=0,Oe=0,We=0,zt=1/Math.abs(dt[$t]-te||1),At=St;At<=qt;++At){var Mt=dt[At],Rt=Vt[At],tt=Se(Math.abs(te-Mt)*zt)*ae[At],_t=Mt*tt;Ct+=tt,Tt+=_t,ue+=Rt*tt,Oe+=Rt*_t,We+=Mt*_t}var Xt=it(Tt/Ct,ue/Ct,Oe/Ct,We/Ct),ve=Lt(Xt,2),Wt=ve[0],Me=ve[1];Qt[ie]=Wt+Me*te,Te[ie]=Math.abs(Vt[ie]-Qt[ie]),Ie(dt,ie+1,or)}if(Ke===b)break;var je=P(Te);if(Math.abs(je)<X)break;for(var Qe=0,hr,er;Qe<$e;++Qe)hr=Te[Qe]/(6*je),ae[Qe]=hr>=1?X:(er=1-hr*hr)*er}return It(dt,Qt,ne,ge)}return Pt.bandwidth=function(J){return arguments.length?(gt=J,Pt):gt},Pt.x=function(J){return arguments.length?(we=J,Pt):we},Pt.y=function(J){return arguments.length?(_e=J,Pt):_e},Pt}function Se(we){return(we=1-we*we*we)*we*we}function Ie(we,_e,gt){var Pt=we[_e],J=gt[0],vt=gt[1]+1;if(!(vt>=we.length))for(;_e>J&&we[vt]-Pt<=Pt-we[J];)gt[0]=++J,gt[1]=vt,++vt}function It(we,_e,gt,Pt){for(var J=we.length,vt=[],W=0,dt=0,Vt=[],ne;W<J;++W)ne=we[W]+gt,Vt[0]===ne?Vt[1]+=(_e[W]-Vt[1])/++dt:(dt=0,Vt[1]+=Pt,Vt=[ne,_e[W]],vt.push(Vt));return Vt[1]+=Pt,vt}function rt(){var we=function(W){return W[0]},_e=function(W){return W[1]},gt=Math.E,Pt;function J(vt){var W=0,dt=0,Vt=0,ne=0,ge=0,$e=Pt?+Pt[0]:1/0,jt=Pt?+Pt[1]:-1/0,Qt=Math.log(gt);lt(vt,we,_e,function(St,qt){var $t=Math.log(St)/Qt;++W,dt+=($t-dt)/W,Vt+=(qt-Vt)/W,ne+=($t*qt-ne)/W,ge+=($t*$t-ge)/W,Pt||(St<$e&&($e=St),St>jt&&(jt=St))});var Te=it(dt,Vt,ne,ge),ae=Lt(Te,2),Ke=ae[0],or=ae[1],ie=function(qt){return or*Math.log(qt)/Qt+Ke},te=Ee($e,jt,ie);return te.a=or,te.b=Ke,te.predict=ie,te.rSquared=ht(vt,we,_e,Vt,ie),te}return J.domain=function(vt){return arguments.length?(Pt=vt,J):Pt},J.x=function(vt){return arguments.length?(we=vt,J):we},J.y=function(vt){return arguments.length?(_e=vt,J):_e},J.base=function(vt){return arguments.length?(gt=vt,J):gt},J}function Dt(){var we=function(vt){return vt[0]},_e=function(vt){return vt[1]},gt;function Pt(J){var vt=q(J,we,_e),W=Lt(vt,4),dt=W[0],Vt=W[1],ne=W[2],ge=W[3],$e=dt.length,jt=0,Qt=0,Te=0,ae=0,Ke=0,or,ie,te,St;for(or=0;or<$e;)ie=dt[or],te=Vt[or++],St=ie*ie,jt+=(St-jt)/or,Qt+=(St*ie-Qt)/or,Te+=(St*St-Te)/or,ae+=(ie*te-ae)/or,Ke+=(St*te-Ke)/or;var qt=0,$t=0,Ct=gt?+gt[0]:1/0,Tt=gt?+gt[1]:-1/0;lt(J,we,_e,function(tt,_t){$t++,qt+=(_t-qt)/$t,gt||(tt<Ct&&(Ct=tt),tt>Tt&&(Tt=tt))});var ue=Te-jt*jt,Oe=jt*ue-Qt*Qt,We=(Ke*jt-ae*Qt)/Oe,zt=(ae*ue-Ke*Qt)/Oe,At=-We*jt,Mt=function(_t){return _t=_t-ne,We*_t*_t+zt*_t+At+ge},Rt=Ee(Ct,Tt,Mt);return Rt.a=We,Rt.b=zt-2*We*ne,Rt.c=At-zt*ne+We*ne*ne+ge,Rt.predict=Mt,Rt.rSquared=ht(J,we,_e,qt,Mt),Rt}return Pt.domain=function(J){return arguments.length?(gt=J,Pt):gt},Pt.x=function(J){return arguments.length?(we=J,Pt):we},Pt.y=function(J){return arguments.length?(_e=J,Pt):_e},Pt}function Ae(){var we=function(W){return W[0]},_e=function(W){return W[1]},gt=3,Pt;function J(vt){if(gt===1){var W=Zt().x(we).y(_e).domain(Pt)(vt);return W.coefficients=[W.b,W.a],delete W.a,delete W.b,W}if(gt===2){var dt=Dt().x(we).y(_e).domain(Pt)(vt);return dt.coefficients=[dt.c,dt.b,dt.a],delete dt.a,delete dt.b,delete dt.c,dt}var Vt=q(vt,we,_e),ne=Lt(Vt,4),ge=ne[0],$e=ne[1],jt=ne[2],Qt=ne[3],Te=ge.length,ae=[],Ke=[],or=gt+1,ie=0,te=0,St=Pt?+Pt[0]:1/0,qt=Pt?+Pt[1]:-1/0;lt(vt,we,_e,function(Mt,Rt){++te,ie+=(Rt-ie)/te,Pt||(Mt<St&&(St=Mt),Mt>qt&&(qt=Mt))});var $t,Ct,Tt,ue,Oe;for($t=0;$t<or;++$t){for(Tt=0,ue=0;Tt<Te;++Tt)ue+=Math.pow(ge[Tt],$t)*$e[Tt];for(ae.push(ue),Oe=new Float64Array(or),Ct=0;Ct<or;++Ct){for(Tt=0,ue=0;Tt<Te;++Tt)ue+=Math.pow(ge[Tt],$t+Ct);Oe[Ct]=ue}Ke.push(Oe)}Ke.push(ae);var We=me(Ke),zt=function(Rt){Rt-=jt;var tt=Qt+We[0]+We[1]*Rt+We[2]*Rt*Rt;for($t=3;$t<or;++$t)tt+=We[$t]*Math.pow(Rt,$t);return tt},At=Ee(St,qt,zt);return At.coefficients=be(or,We,-jt,Qt),At.predict=zt,At.rSquared=ht(vt,we,_e,ie,zt),At}return J.domain=function(vt){return arguments.length?(Pt=vt,J):Pt},J.x=function(vt){return arguments.length?(we=vt,J):we},J.y=function(vt){return arguments.length?(_e=vt,J):_e},J.order=function(vt){return arguments.length?(gt=vt,J):gt},J}function be(we,_e,gt,Pt){var J=Array(we),vt,W,dt,Vt;for(vt=0;vt<we;++vt)J[vt]=0;for(vt=we-1;vt>=0;--vt)for(dt=_e[vt],Vt=1,J[vt]+=dt,W=1;W<=vt;++W)Vt*=(vt+1-W)/W,J[vt-W]+=dt*Math.pow(gt,W)*Vt;return J[0]+=Pt,J}function me(we){var _e=we.length-1,gt=[],Pt,J,vt,W,dt;for(Pt=0;Pt<_e;++Pt){for(W=Pt,J=Pt+1;J<_e;++J)Math.abs(we[Pt][J])>Math.abs(we[Pt][W])&&(W=J);for(vt=Pt;vt<_e+1;++vt)dt=we[vt][Pt],we[vt][Pt]=we[vt][W],we[vt][W]=dt;for(J=Pt+1;J<_e;++J)for(vt=_e;vt>=Pt;vt--)we[vt][J]-=we[vt][Pt]*we[Pt][J]/we[Pt][Pt]}for(J=_e-1;J>=0;--J){for(dt=0,vt=J+1;vt<_e;++vt)dt+=we[vt][J]*gt[vt];gt[J]=(we[_e][J]-dt)/we[J][J]}return gt}function ee(){var we=function(vt){return vt[0]},_e=function(vt){return vt[1]},gt;function Pt(J){var vt=0,W=0,dt=0,Vt=0,ne=0,ge=0,$e=gt?+gt[0]:1/0,jt=gt?+gt[1]:-1/0;lt(J,we,_e,function(te,St){var qt=Math.log(te),$t=Math.log(St);++vt,W+=(qt-W)/vt,dt+=($t-dt)/vt,Vt+=(qt*$t-Vt)/vt,ne+=(qt*qt-ne)/vt,ge+=(St-ge)/vt,gt||(te<$e&&($e=te),te>jt&&(jt=te))});var Qt=it(W,dt,Vt,ne),Te=Lt(Qt,2),ae=Te[0],Ke=Te[1];ae=Math.exp(ae);var or=function(St){return ae*Math.pow(St,Ke)},ie=Ee($e,jt,or);return ie.a=ae,ie.b=Ke,ie.predict=or,ie.rSquared=ht(J,we,_e,ge,or),ie}return Pt.domain=function(J){return arguments.length?(gt=J,Pt):gt},Pt.x=function(J){return arguments.length?(we=J,Pt):we},Pt.y=function(J){return arguments.length?(_e=J,Pt):_e},Pt}ot.regressionExp=st,ot.regressionLinear=Zt,ot.regressionLoess=le,ot.regressionLog=rt,ot.regressionPoly=Ae,ot.regressionPow=ee,ot.regressionQuad=Dt,Object.defineProperty(ot,"__esModule",{value:!0})})},43631:function(vn,Ft,ot){"use strict";ot.d(Ft,{qY:function(){return Zt}});var Lt=ot(34155),wt=function(It,rt,Dt){if(Dt||arguments.length===2)for(var Ae=0,be=rt.length,me;Ae<be;Ae++)(me||!(Ae in rt))&&(me||(me=Array.prototype.slice.call(rt,0,Ae)),me[Ae]=rt[Ae]);return It.concat(me||Array.prototype.slice.call(rt))},I=function(){function It(rt,Dt,Ae){this.name=rt,this.version=Dt,this.os=Ae,this.type="browser"}return It}(),Et=function(){function It(rt){this.version=rt,this.type="node",this.name="node",this.os=Lt.platform}return It}(),q=function(){function It(rt,Dt,Ae,be){this.name=rt,this.version=Dt,this.os=Ae,this.bot=be,this.type="bot-device"}return It}(),lt=function(){function It(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return It}(),ht=function(){function It(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return It}(),ct=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,et=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ee=3,it=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",ct]],st=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Zt(It){return It?X(It):typeof document=="undefined"&&typeof navigator!="undefined"&&navigator.product==="ReactNative"?new ht:typeof navigator!="undefined"?X(navigator.userAgent):Se()}function P(It){return It!==""&&it.reduce(function(rt,Dt){var Ae=Dt[0],be=Dt[1];if(rt)return rt;var me=be.exec(It);return!!me&&[Ae,me]},!1)}function b(It){var rt=P(It);return rt?rt[0]:null}function X(It){var rt=P(It);if(!rt)return null;var Dt=rt[0],Ae=rt[1];if(Dt==="searchbot")return new lt;var be=Ae[1]&&Ae[1].split(".").join("_").split("_").slice(0,3);be?be.length<Ee&&(be=wt(wt([],be,!0),Ie(Ee-be.length),!0)):be=[];var me=be.join("."),ee=le(It),we=et.exec(It);return we&&we[1]?new q(Dt,me,ee,we[1]):new I(Dt,me,ee)}function le(It){for(var rt=0,Dt=st.length;rt<Dt;rt++){var Ae=st[rt],be=Ae[0],me=Ae[1],ee=me.exec(It);if(ee)return be}return null}function Se(){var It=typeof Lt!="undefined"&&Lt.version;return It?new Et(Lt.version.slice(1)):null}function Ie(It){for(var rt=[],Dt=0;Dt<It;Dt++)rt.push("0");return rt}},9187:function(vn){"use strict";vn.exports=Ft,vn.exports.default=Ft;function Ft(J,vt,W){W=W||2;var dt=vt&&vt.length,Vt=dt?vt[0]*W:J.length,ne=ot(J,0,Vt,W,!0),ge=[];if(!ne||ne.next===ne.prev)return ge;var $e,jt,Qt,Te,ae,Ke,or;if(dt&&(ne=ht(J,vt,ne,W)),J.length>80*W){$e=Qt=J[0],jt=Te=J[1];for(var ie=W;ie<Vt;ie+=W)ae=J[ie],Ke=J[ie+1],ae<$e&&($e=ae),Ke<jt&&(jt=Ke),ae>Qt&&(Qt=ae),Ke>Te&&(Te=Ke);or=Math.max(Qt-$e,Te-jt),or=or!==0?32767/or:0}return wt(ne,ge,W,$e,jt,or,0),ge}function ot(J,vt,W,dt,Vt){var ne,ge;if(Vt===Pt(J,vt,W,dt)>0)for(ne=vt;ne<W;ne+=dt)ge=we(ne,J[ne],J[ne+1],ge);else for(ne=W-dt;ne>=vt;ne-=dt)ge=we(ne,J[ne],J[ne+1],ge);return ge&&Ie(ge,ge.next)&&(_e(ge),ge=ge.next),ge}function Lt(J,vt){if(!J)return J;vt||(vt=J);var W=J,dt;do if(dt=!1,!W.steiner&&(Ie(W,W.next)||Se(W.prev,W,W.next)===0)){if(_e(W),W=vt=W.prev,W===W.next)break;dt=!0}else W=W.next;while(dt||W!==vt);return vt}function wt(J,vt,W,dt,Vt,ne,ge){if(!!J){!ge&&ne&&st(J,dt,Vt,ne);for(var $e=J,jt,Qt;J.prev!==J.next;){if(jt=J.prev,Qt=J.next,ne?Et(J,dt,Vt,ne):I(J)){vt.push(jt.i/W|0),vt.push(J.i/W|0),vt.push(Qt.i/W|0),_e(J),J=Qt.next,$e=Qt.next;continue}if(J=Qt,J===$e){ge?ge===1?(J=q(Lt(J),vt,W),wt(J,vt,W,dt,Vt,ne,2)):ge===2&&lt(J,vt,W,dt,Vt,ne):wt(Lt(J),vt,W,dt,Vt,ne,1);break}}}}function I(J){var vt=J.prev,W=J,dt=J.next;if(Se(vt,W,dt)>=0)return!1;for(var Vt=vt.x,ne=W.x,ge=dt.x,$e=vt.y,jt=W.y,Qt=dt.y,Te=Vt<ne?Vt<ge?Vt:ge:ne<ge?ne:ge,ae=$e<jt?$e<Qt?$e:Qt:jt<Qt?jt:Qt,Ke=Vt>ne?Vt>ge?Vt:ge:ne>ge?ne:ge,or=$e>jt?$e>Qt?$e:Qt:jt>Qt?jt:Qt,ie=dt.next;ie!==vt;){if(ie.x>=Te&&ie.x<=Ke&&ie.y>=ae&&ie.y<=or&&X(Vt,$e,ne,jt,ge,Qt,ie.x,ie.y)&&Se(ie.prev,ie,ie.next)>=0)return!1;ie=ie.next}return!0}function Et(J,vt,W,dt){var Vt=J.prev,ne=J,ge=J.next;if(Se(Vt,ne,ge)>=0)return!1;for(var $e=Vt.x,jt=ne.x,Qt=ge.x,Te=Vt.y,ae=ne.y,Ke=ge.y,or=$e<jt?$e<Qt?$e:Qt:jt<Qt?jt:Qt,ie=Te<ae?Te<Ke?Te:Ke:ae<Ke?ae:Ke,te=$e>jt?$e>Qt?$e:Qt:jt>Qt?jt:Qt,St=Te>ae?Te>Ke?Te:Ke:ae>Ke?ae:Ke,qt=P(or,ie,vt,W,dt),$t=P(te,St,vt,W,dt),Ct=J.prevZ,Tt=J.nextZ;Ct&&Ct.z>=qt&&Tt&&Tt.z<=$t;){if(Ct.x>=or&&Ct.x<=te&&Ct.y>=ie&&Ct.y<=St&&Ct!==Vt&&Ct!==ge&&X($e,Te,jt,ae,Qt,Ke,Ct.x,Ct.y)&&Se(Ct.prev,Ct,Ct.next)>=0||(Ct=Ct.prevZ,Tt.x>=or&&Tt.x<=te&&Tt.y>=ie&&Tt.y<=St&&Tt!==Vt&&Tt!==ge&&X($e,Te,jt,ae,Qt,Ke,Tt.x,Tt.y)&&Se(Tt.prev,Tt,Tt.next)>=0))return!1;Tt=Tt.nextZ}for(;Ct&&Ct.z>=qt;){if(Ct.x>=or&&Ct.x<=te&&Ct.y>=ie&&Ct.y<=St&&Ct!==Vt&&Ct!==ge&&X($e,Te,jt,ae,Qt,Ke,Ct.x,Ct.y)&&Se(Ct.prev,Ct,Ct.next)>=0)return!1;Ct=Ct.prevZ}for(;Tt&&Tt.z<=$t;){if(Tt.x>=or&&Tt.x<=te&&Tt.y>=ie&&Tt.y<=St&&Tt!==Vt&&Tt!==ge&&X($e,Te,jt,ae,Qt,Ke,Tt.x,Tt.y)&&Se(Tt.prev,Tt,Tt.next)>=0)return!1;Tt=Tt.nextZ}return!0}function q(J,vt,W){var dt=J;do{var Vt=dt.prev,ne=dt.next.next;!Ie(Vt,ne)&&It(Vt,dt,dt.next,ne)&&be(Vt,ne)&&be(ne,Vt)&&(vt.push(Vt.i/W|0),vt.push(dt.i/W|0),vt.push(ne.i/W|0),_e(dt),_e(dt.next),dt=J=ne),dt=dt.next}while(dt!==J);return Lt(dt)}function lt(J,vt,W,dt,Vt,ne){var ge=J;do{for(var $e=ge.next.next;$e!==ge.prev;){if(ge.i!==$e.i&&le(ge,$e)){var jt=ee(ge,$e);ge=Lt(ge,ge.next),jt=Lt(jt,jt.next),wt(ge,vt,W,dt,Vt,ne,0),wt(jt,vt,W,dt,Vt,ne,0);return}$e=$e.next}ge=ge.next}while(ge!==J)}function ht(J,vt,W,dt){var Vt=[],ne,ge,$e,jt,Qt;for(ne=0,ge=vt.length;ne<ge;ne++)$e=vt[ne]*dt,jt=ne<ge-1?vt[ne+1]*dt:J.length,Qt=ot(J,$e,jt,dt,!1),Qt===Qt.next&&(Qt.steiner=!0),Vt.push(b(Qt));for(Vt.sort(ct),ne=0;ne<Vt.length;ne++)W=et(Vt[ne],W);return W}function ct(J,vt){return J.x-vt.x}function et(J,vt){var W=Ee(J,vt);if(!W)return vt;var dt=ee(W,J);return Lt(dt,dt.next),Lt(W,W.next)}function Ee(J,vt){var W=vt,dt=J.x,Vt=J.y,ne=-1/0,ge;do{if(Vt<=W.y&&Vt>=W.next.y&&W.next.y!==W.y){var $e=W.x+(Vt-W.y)*(W.next.x-W.x)/(W.next.y-W.y);if($e<=dt&&$e>ne&&(ne=$e,ge=W.x<W.next.x?W:W.next,$e===dt))return ge}W=W.next}while(W!==vt);if(!ge)return null;var jt=ge,Qt=ge.x,Te=ge.y,ae=1/0,Ke;W=ge;do dt>=W.x&&W.x>=Qt&&dt!==W.x&&X(Vt<Te?dt:ne,Vt,Qt,Te,Vt<Te?ne:dt,Vt,W.x,W.y)&&(Ke=Math.abs(Vt-W.y)/(dt-W.x),be(W,J)&&(Ke<ae||Ke===ae&&(W.x>ge.x||W.x===ge.x&&it(ge,W)))&&(ge=W,ae=Ke)),W=W.next;while(W!==jt);return ge}function it(J,vt){return Se(J.prev,J,vt.prev)<0&&Se(vt.next,J,J.next)<0}function st(J,vt,W,dt){var Vt=J;do Vt.z===0&&(Vt.z=P(Vt.x,Vt.y,vt,W,dt)),Vt.prevZ=Vt.prev,Vt.nextZ=Vt.next,Vt=Vt.next;while(Vt!==J);Vt.prevZ.nextZ=null,Vt.prevZ=null,Zt(Vt)}function Zt(J){var vt,W,dt,Vt,ne,ge,$e,jt,Qt=1;do{for(W=J,J=null,ne=null,ge=0;W;){for(ge++,dt=W,$e=0,vt=0;vt<Qt&&($e++,dt=dt.nextZ,!!dt);vt++);for(jt=Qt;$e>0||jt>0&&dt;)$e!==0&&(jt===0||!dt||W.z<=dt.z)?(Vt=W,W=W.nextZ,$e--):(Vt=dt,dt=dt.nextZ,jt--),ne?ne.nextZ=Vt:J=Vt,Vt.prevZ=ne,ne=Vt;W=dt}ne.nextZ=null,Qt*=2}while(ge>1);return J}function P(J,vt,W,dt,Vt){return J=(J-W)*Vt|0,vt=(vt-dt)*Vt|0,J=(J|J<<8)&16711935,J=(J|J<<4)&252645135,J=(J|J<<2)&858993459,J=(J|J<<1)&1431655765,vt=(vt|vt<<8)&16711935,vt=(vt|vt<<4)&252645135,vt=(vt|vt<<2)&858993459,vt=(vt|vt<<1)&1431655765,J|vt<<1}function b(J){var vt=J,W=J;do(vt.x<W.x||vt.x===W.x&&vt.y<W.y)&&(W=vt),vt=vt.next;while(vt!==J);return W}function X(J,vt,W,dt,Vt,ne,ge,$e){return(Vt-ge)*(vt-$e)>=(J-ge)*(ne-$e)&&(J-ge)*(dt-$e)>=(W-ge)*(vt-$e)&&(W-ge)*(ne-$e)>=(Vt-ge)*(dt-$e)}function le(J,vt){return J.next.i!==vt.i&&J.prev.i!==vt.i&&!Ae(J,vt)&&(be(J,vt)&&be(vt,J)&&me(J,vt)&&(Se(J.prev,J,vt.prev)||Se(J,vt.prev,vt))||Ie(J,vt)&&Se(J.prev,J,J.next)>0&&Se(vt.prev,vt,vt.next)>0)}function Se(J,vt,W){return(vt.y-J.y)*(W.x-vt.x)-(vt.x-J.x)*(W.y-vt.y)}function Ie(J,vt){return J.x===vt.x&&J.y===vt.y}function It(J,vt,W,dt){var Vt=Dt(Se(J,vt,W)),ne=Dt(Se(J,vt,dt)),ge=Dt(Se(W,dt,J)),$e=Dt(Se(W,dt,vt));return!!(Vt!==ne&&ge!==$e||Vt===0&&rt(J,W,vt)||ne===0&&rt(J,dt,vt)||ge===0&&rt(W,J,dt)||$e===0&&rt(W,vt,dt))}function rt(J,vt,W){return vt.x<=Math.max(J.x,W.x)&&vt.x>=Math.min(J.x,W.x)&&vt.y<=Math.max(J.y,W.y)&&vt.y>=Math.min(J.y,W.y)}function Dt(J){return J>0?1:J<0?-1:0}function Ae(J,vt){var W=J;do{if(W.i!==J.i&&W.next.i!==J.i&&W.i!==vt.i&&W.next.i!==vt.i&&It(W,W.next,J,vt))return!0;W=W.next}while(W!==J);return!1}function be(J,vt){return Se(J.prev,J,J.next)<0?Se(J,vt,J.next)>=0&&Se(J,J.prev,vt)>=0:Se(J,vt,J.prev)<0||Se(J,J.next,vt)<0}function me(J,vt){var W=J,dt=!1,Vt=(J.x+vt.x)/2,ne=(J.y+vt.y)/2;do W.y>ne!=W.next.y>ne&&W.next.y!==W.y&&Vt<(W.next.x-W.x)*(ne-W.y)/(W.next.y-W.y)+W.x&&(dt=!dt),W=W.next;while(W!==J);return dt}function ee(J,vt){var W=new gt(J.i,J.x,J.y),dt=new gt(vt.i,vt.x,vt.y),Vt=J.next,ne=vt.prev;return J.next=vt,vt.prev=J,W.next=Vt,Vt.prev=W,dt.next=W,W.prev=dt,ne.next=dt,dt.prev=ne,dt}function we(J,vt,W,dt){var Vt=new gt(J,vt,W);return dt?(Vt.next=dt.next,Vt.prev=dt,dt.next.prev=Vt,dt.next=Vt):(Vt.prev=Vt,Vt.next=Vt),Vt}function _e(J){J.next.prev=J.prev,J.prev.next=J.next,J.prevZ&&(J.prevZ.nextZ=J.nextZ),J.nextZ&&(J.nextZ.prevZ=J.prevZ)}function gt(J,vt,W){this.i=J,this.x=vt,this.y=W,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ft.deviation=function(J,vt,W,dt){var Vt=vt&&vt.length,ne=Vt?vt[0]*W:J.length,ge=Math.abs(Pt(J,0,ne,W));if(Vt)for(var $e=0,jt=vt.length;$e<jt;$e++){var Qt=vt[$e]*W,Te=$e<jt-1?vt[$e+1]*W:J.length;ge-=Math.abs(Pt(J,Qt,Te,W))}var ae=0;for($e=0;$e<dt.length;$e+=3){var Ke=dt[$e]*W,or=dt[$e+1]*W,ie=dt[$e+2]*W;ae+=Math.abs((J[Ke]-J[ie])*(J[or+1]-J[Ke+1])-(J[Ke]-J[or])*(J[ie+1]-J[Ke+1]))}return ge===0&&ae===0?0:Math.abs((ae-ge)/ge)};function Pt(J,vt,W,dt){for(var Vt=0,ne=vt,ge=W-dt;ne<W;ne+=dt)Vt+=(J[ge]-J[ne])*(J[ne+1]+J[ge+1]),ge=ne;return Vt}Ft.flatten=function(J){for(var vt=J[0][0].length,W={vertices:[],holes:[],dimensions:vt},dt=0,Vt=0;Vt<J.length;Vt++){for(var ne=0;ne<J[Vt].length;ne++)for(var ge=0;ge<vt;ge++)W.vertices.push(J[Vt][ne][ge]);Vt>0&&(dt+=J[Vt-1].length,W.holes.push(dt))}return W}},67709:function(vn){function Ft(Lt){var wt=Lt.target||Lt.srcElement;wt.__resizeRAF__&&cancelAnimationFrame(wt.__resizeRAF__),wt.__resizeRAF__=requestAnimationFrame(function(){var I=wt.__resizeTrigger__,Et=I&&I.__resizeListeners__;Et&&Et.forEach(function(q){q.call(I,Lt)})})}var ot=function(wt,I){var Et=this,q=Et.document,lt,ht=q.attachEvent;typeof navigator!="undefined"&&(lt=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/));function ct(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",Ft)}if(!wt.__resizeListeners__)if(wt.__resizeListeners__=[],ht)wt.__resizeTrigger__=wt,wt.attachEvent("onresize",Ft);else{getComputedStyle(wt).position==="static"&&(wt.style.position="relative");var et=wt.__resizeTrigger__=q.createElement("object");et.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),et.setAttribute("class","resize-sensor"),et.setAttribute("tabindex","-1"),et.setAttribute("title",""),et.__resizeElement__=wt,et.onload=ct,et.type="text/html",lt&&wt.appendChild(et),et.data="about:blank",lt||wt.appendChild(et)}wt.__resizeListeners__.push(I)};vn.exports=typeof window=="undefined"?ot:ot.bind(window),vn.exports.unbind=function(Lt,wt){var I=document.attachEvent,Et=Lt.__resizeListeners__||[];if(wt){var q=Et.indexOf(wt);q!==-1&&Et.splice(q,1)}else Et=Lt.__resizeListeners__=[];if(!Et.length){if(I)Lt.detachEvent("onresize",Ft);else if(Lt.__resizeTrigger__){var lt=Lt.__resizeTrigger__.contentDocument,ht=lt&&lt.defaultView;ht&&(ht.removeEventListener("resize",Ft),delete ht.__resizeTrigger__),Lt.__resizeTrigger__=!Lt.removeChild(Lt.__resizeTrigger__)}delete Lt.__resizeListeners__}}},26729:function(vn){"use strict";var Ft=Object.prototype.hasOwnProperty,ot="~";function Lt(){}Object.create&&(Lt.prototype=Object.create(null),new Lt().__proto__||(ot=!1));function wt(lt,ht,ct){this.fn=lt,this.context=ht,this.once=ct||!1}function I(lt,ht,ct,et,Ee){if(typeof ct!="function")throw new TypeError("The listener must be a function");var it=new wt(ct,et||lt,Ee),st=ot?ot+ht:ht;return lt._events[st]?lt._events[st].fn?lt._events[st]=[lt._events[st],it]:lt._events[st].push(it):(lt._events[st]=it,lt._eventsCount++),lt}function Et(lt,ht){--lt._eventsCount===0?lt._events=new Lt:delete lt._events[ht]}function q(){this._events=new Lt,this._eventsCount=0}q.prototype.eventNames=function(){var ht=[],ct,et;if(this._eventsCount===0)return ht;for(et in ct=this._events)Ft.call(ct,et)&&ht.push(ot?et.slice(1):et);return Object.getOwnPropertySymbols?ht.concat(Object.getOwnPropertySymbols(ct)):ht},q.prototype.listeners=function(ht){var ct=ot?ot+ht:ht,et=this._events[ct];if(!et)return[];if(et.fn)return[et.fn];for(var Ee=0,it=et.length,st=new Array(it);Ee<it;Ee++)st[Ee]=et[Ee].fn;return st},q.prototype.listenerCount=function(ht){var ct=ot?ot+ht:ht,et=this._events[ct];return et?et.fn?1:et.length:0},q.prototype.emit=function(ht,ct,et,Ee,it,st){var Zt=ot?ot+ht:ht;if(!this._events[Zt])return!1;var P=this._events[Zt],b=arguments.length,X,le;if(P.fn){switch(P.once&&this.removeListener(ht,P.fn,void 0,!0),b){case 1:return P.fn.call(P.context),!0;case 2:return P.fn.call(P.context,ct),!0;case 3:return P.fn.call(P.context,ct,et),!0;case 4:return P.fn.call(P.context,ct,et,Ee),!0;case 5:return P.fn.call(P.context,ct,et,Ee,it),!0;case 6:return P.fn.call(P.context,ct,et,Ee,it,st),!0}for(le=1,X=new Array(b-1);le<b;le++)X[le-1]=arguments[le];P.fn.apply(P.context,X)}else{var Se=P.length,Ie;for(le=0;le<Se;le++)switch(P[le].once&&this.removeListener(ht,P[le].fn,void 0,!0),b){case 1:P[le].fn.call(P[le].context);break;case 2:P[le].fn.call(P[le].context,ct);break;case 3:P[le].fn.call(P[le].context,ct,et);break;case 4:P[le].fn.call(P[le].context,ct,et,Ee);break;default:if(!X)for(Ie=1,X=new Array(b-1);Ie<b;Ie++)X[Ie-1]=arguments[Ie];P[le].fn.apply(P[le].context,X)}}return!0},q.prototype.on=function(ht,ct,et){return I(this,ht,ct,et,!1)},q.prototype.once=function(ht,ct,et){return I(this,ht,ct,et,!0)},q.prototype.removeListener=function(ht,ct,et,Ee){var it=ot?ot+ht:ht;if(!this._events[it])return this;if(!ct)return Et(this,it),this;var st=this._events[it];if(st.fn)st.fn===ct&&(!Ee||st.once)&&(!et||st.context===et)&&Et(this,it);else{for(var Zt=0,P=[],b=st.length;Zt<b;Zt++)(st[Zt].fn!==ct||Ee&&!st[Zt].once||et&&st[Zt].context!==et)&&P.push(st[Zt]);P.length?this._events[it]=P.length===1?P[0]:P:Et(this,it)}return this},q.prototype.removeAllListeners=function(ht){var ct;return ht?(ct=ot?ot+ht:ht,this._events[ct]&&Et(this,ct)):(this._events=new Lt,this._eventsCount=0),this},q.prototype.off=q.prototype.removeListener,q.prototype.addListener=q.prototype.on,q.prefixed=ot,q.EventEmitter=q,vn.exports=q},87026:function(vn,Ft){(function(ot,Lt){Lt(Ft)})(this,function(ot){"use strict";function Lt(Zt,P,b,X){X=X||{};var le=X.maxIterations||100,Se=X.tolerance||1e-10,Ie=Zt(P),It=Zt(b),rt=b-P;if(Ie*It>0)throw"Initial bisect points must have opposite signs";if(Ie===0)return P;if(It===0)return b;for(var Dt=0;Dt<le;++Dt){rt/=2;var Ae=P+rt,be=Zt(Ae);if(be*Ie>=0&&(P=Ae),Math.abs(rt)<Se||be===0)return Ae}return P+rt}function wt(Zt){for(var P=new Array(Zt),b=0;b<Zt;++b)P[b]=0;return P}function I(Zt,P){return wt(Zt).map(function(){return wt(P)})}function Et(Zt,P){for(var b=0,X=0;X<Zt.length;++X)b+=Zt[X]*P[X];return b}function q(Zt){return Math.sqrt(Et(Zt,Zt))}function lt(Zt,P,b){for(var X=0;X<P.length;++X)Zt[X]=P[X]*b}function ht(Zt,P,b,X,le){for(var Se=0;Se<Zt.length;++Se)Zt[Se]=P*b[Se]+X*le[Se]}function ct(Zt,P,b){b=b||{};var X=b.maxIterations||P.length*200,le=b.nonZeroDelta||1.05,Se=b.zeroDelta||.001,Ie=b.minErrorDelta||1e-6,It=b.minErrorDelta||1e-5,rt=b.rho!==void 0?b.rho:1,Dt=b.chi!==void 0?b.chi:2,Ae=b.psi!==void 0?b.psi:-.5,be=b.sigma!==void 0?b.sigma:.5,me,ee=P.length,we=new Array(ee+1);we[0]=P,we[0].fx=Zt(P),we[0].id=0;for(var _e=0;_e<ee;++_e){var gt=P.slice();gt[_e]=gt[_e]?gt[_e]*le:Se,we[_e+1]=gt,we[_e+1].fx=Zt(gt),we[_e+1].id=_e+1}function Pt(Te){for(var ae=0;ae<Te.length;ae++)we[ee][ae]=Te[ae];we[ee].fx=Te.fx}for(var J=function(Te,ae){return Te.fx-ae.fx},vt=P.slice(),W=P.slice(),dt=P.slice(),Vt=P.slice(),ne=0;ne<X;++ne){if(we.sort(J),b.history){var ge=we.map(function(Te){var ae=Te.slice();return ae.fx=Te.fx,ae.id=Te.id,ae});ge.sort(function(Te,ae){return Te.id-ae.id}),b.history.push({x:we[0].slice(),fx:we[0].fx,simplex:ge})}for(me=0,_e=0;_e<ee;++_e)me=Math.max(me,Math.abs(we[0][_e]-we[1][_e]));if(Math.abs(we[0].fx-we[ee].fx)<Ie&&me<It)break;for(_e=0;_e<ee;++_e){vt[_e]=0;for(var $e=0;$e<ee;++$e)vt[_e]+=we[$e][_e];vt[_e]/=ee}var jt=we[ee];if(ht(W,1+rt,vt,-rt,jt),W.fx=Zt(W),W.fx<we[0].fx)ht(Vt,1+Dt,vt,-Dt,jt),Vt.fx=Zt(Vt),Vt.fx<W.fx?Pt(Vt):Pt(W);else if(W.fx>=we[ee-1].fx){var Qt=!1;if(W.fx>jt.fx?(ht(dt,1+Ae,vt,-Ae,jt),dt.fx=Zt(dt),dt.fx<jt.fx?Pt(dt):Qt=!0):(ht(dt,1-Ae*rt,vt,Ae*rt,jt),dt.fx=Zt(dt),dt.fx<W.fx?Pt(dt):Qt=!0),Qt){if(be>=1)break;for(_e=1;_e<we.length;++_e)ht(we[_e],1-be,we[0],be,we[_e]),we[_e].fx=Zt(we[_e])}}else Pt(W)}return we.sort(J),{fx:we[0].fx,x:we[0]}}function et(Zt,P,b,X,le,Se,Ie){var It=b.fx,rt=Et(b.fxprime,P),Dt=It,Ae=It,be=rt,me=0;le=le||1,Se=Se||1e-6,Ie=Ie||.1;function ee(_e,gt,Pt){for(var J=0;J<16;++J)if(le=(_e+gt)/2,ht(X.x,1,b.x,le,P),Dt=X.fx=Zt(X.x,X.fxprime),be=Et(X.fxprime,P),Dt>It+Se*le*rt||Dt>=Pt)gt=le;else{if(Math.abs(be)<=-Ie*rt)return le;be*(gt-_e)>=0&&(gt=_e),_e=le,Pt=Dt}return 0}for(var we=0;we<10;++we){if(ht(X.x,1,b.x,le,P),Dt=X.fx=Zt(X.x,X.fxprime),be=Et(X.fxprime,P),Dt>It+Se*le*rt||we&&Dt>=Ae)return ee(me,le,Ae);if(Math.abs(be)<=-Ie*rt)return le;if(be>=0)return ee(le,me,Dt);Ae=Dt,me=le,le*=2}return le}function Ee(Zt,P,b){var X={x:P.slice(),fx:0,fxprime:P.slice()},le={x:P.slice(),fx:0,fxprime:P.slice()},Se=P.slice(),Ie,It,rt=1,Dt;b=b||{},Dt=b.maxIterations||P.length*20,X.fx=Zt(X.x,X.fxprime),Ie=X.fxprime.slice(),lt(Ie,X.fxprime,-1);for(var Ae=0;Ae<Dt;++Ae){if(rt=et(Zt,Ie,X,le,rt),b.history&&b.history.push({x:X.x.slice(),fx:X.fx,fxprime:X.fxprime.slice(),alpha:rt}),!rt)lt(Ie,X.fxprime,-1);else{ht(Se,1,le.fxprime,-1,X.fxprime);var be=Et(X.fxprime,X.fxprime),me=Math.max(0,Et(Se,le.fxprime)/be);ht(Ie,me,Ie,-1,le.fxprime),It=X,X=le,le=It}if(q(X.fxprime)<=1e-5)break}return b.history&&b.history.push({x:X.x.slice(),fx:X.fx,fxprime:X.fxprime.slice(),alpha:rt}),X}function it(Zt,P,b){b=b||{};for(var X=b.maxIterations||P.length*100,le=b.learnRate||.001,Se={x:P.slice(),fx:0,fxprime:P.slice()},Ie=0;Ie<X&&(Se.fx=Zt(Se.x,Se.fxprime),b.history&&b.history.push({x:Se.x.slice(),fx:Se.fx,fxprime:Se.fxprime.slice()}),ht(Se.x,1,Se.x,-le,Se.fxprime),!(q(Se.fxprime)<=1e-5));++Ie);return Se}function st(Zt,P,b){b=b||{};var X={x:P.slice(),fx:0,fxprime:P.slice()},le={x:P.slice(),fx:0,fxprime:P.slice()},Se=b.maxIterations||P.length*100,Ie=b.learnRate||1,It=P.slice(),rt=b.c1||.001,Dt=b.c2||.1,Ae,be=[];if(b.history){var me=Zt;Zt=function(we,_e){return be.push(we.slice()),me(we,_e)}}X.fx=Zt(X.x,X.fxprime);for(var ee=0;ee<Se&&(lt(It,X.fxprime,-1),Ie=et(Zt,It,X,le,Ie,rt,Dt),b.history&&(b.history.push({x:X.x.slice(),fx:X.fx,fxprime:X.fxprime.slice(),functionCalls:be,learnRate:Ie,alpha:Ie}),be=[]),Ae=X,X=le,le=Ae,!(Ie===0||q(X.fxprime)<1e-5));++ee);return X}ot.bisect=Lt,ot.nelderMead=ct,ot.conjugateGradient=Ee,ot.gradientDescent=it,ot.gradientDescentLineSearch=st,ot.zeros=wt,ot.zerosM=I,ot.norm2=q,ot.weightedSum=ht,ot.scale=lt})},49685:function(vn,Ft,ot){"use strict";ot.d(Ft,{FD:function(){return I},Ib:function(){return Lt},WT:function(){return wt}});var Lt=1e-6,wt=typeof Float32Array!="undefined"?Float32Array:Array,I=Math.random;function Et(ct){wt=ct}var q=Math.PI/180;function lt(ct){return ct*q}function ht(ct,et){return Math.abs(ct-et)<=Lt*Math.max(1,Math.abs(ct),Math.abs(et))}Math.hypot||(Math.hypot=function(){for(var ct=0,et=arguments.length;et--;)ct+=arguments[et]*arguments[et];return Math.sqrt(ct)})},35600:function(vn,Ft,ot){"use strict";ot.d(Ft,{Jp:function(){return st},U_:function(){return et},Us:function(){return le},vc:function(){return X},xJ:function(){return Se}});function Lt(){var W=new glMatrix.ARRAY_TYPE(9);return glMatrix.ARRAY_TYPE!=Float32Array&&(W[1]=0,W[2]=0,W[3]=0,W[5]=0,W[6]=0,W[7]=0),W[0]=1,W[4]=1,W[8]=1,W}function wt(W,dt){return W[0]=dt[0],W[1]=dt[1],W[2]=dt[2],W[3]=dt[4],W[4]=dt[5],W[5]=dt[6],W[6]=dt[8],W[7]=dt[9],W[8]=dt[10],W}function I(W){var dt=new glMatrix.ARRAY_TYPE(9);return dt[0]=W[0],dt[1]=W[1],dt[2]=W[2],dt[3]=W[3],dt[4]=W[4],dt[5]=W[5],dt[6]=W[6],dt[7]=W[7],dt[8]=W[8],dt}function Et(W,dt){return W[0]=dt[0],W[1]=dt[1],W[2]=dt[2],W[3]=dt[3],W[4]=dt[4],W[5]=dt[5],W[6]=dt[6],W[7]=dt[7],W[8]=dt[8],W}function q(W,dt,Vt,ne,ge,$e,jt,Qt,Te){var ae=new glMatrix.ARRAY_TYPE(9);return ae[0]=W,ae[1]=dt,ae[2]=Vt,ae[3]=ne,ae[4]=ge,ae[5]=$e,ae[6]=jt,ae[7]=Qt,ae[8]=Te,ae}function lt(W,dt,Vt,ne,ge,$e,jt,Qt,Te,ae){return W[0]=dt,W[1]=Vt,W[2]=ne,W[3]=ge,W[4]=$e,W[5]=jt,W[6]=Qt,W[7]=Te,W[8]=ae,W}function ht(W){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=1,W[5]=0,W[6]=0,W[7]=0,W[8]=1,W}function ct(W,dt){if(W===dt){var Vt=dt[1],ne=dt[2],ge=dt[5];W[1]=dt[3],W[2]=dt[6],W[3]=Vt,W[5]=dt[7],W[6]=ne,W[7]=ge}else W[0]=dt[0],W[1]=dt[3],W[2]=dt[6],W[3]=dt[1],W[4]=dt[4],W[5]=dt[7],W[6]=dt[2],W[7]=dt[5],W[8]=dt[8];return W}function et(W,dt){var Vt=dt[0],ne=dt[1],ge=dt[2],$e=dt[3],jt=dt[4],Qt=dt[5],Te=dt[6],ae=dt[7],Ke=dt[8],or=Ke*jt-Qt*ae,ie=-Ke*$e+Qt*Te,te=ae*$e-jt*Te,St=Vt*or+ne*ie+ge*te;return St?(St=1/St,W[0]=or*St,W[1]=(-Ke*ne+ge*ae)*St,W[2]=(Qt*ne-ge*jt)*St,W[3]=ie*St,W[4]=(Ke*Vt-ge*Te)*St,W[5]=(-Qt*Vt+ge*$e)*St,W[6]=te*St,W[7]=(-ae*Vt+ne*Te)*St,W[8]=(jt*Vt-ne*$e)*St,W):null}function Ee(W,dt){var Vt=dt[0],ne=dt[1],ge=dt[2],$e=dt[3],jt=dt[4],Qt=dt[5],Te=dt[6],ae=dt[7],Ke=dt[8];return W[0]=jt*Ke-Qt*ae,W[1]=ge*ae-ne*Ke,W[2]=ne*Qt-ge*jt,W[3]=Qt*Te-$e*Ke,W[4]=Vt*Ke-ge*Te,W[5]=ge*$e-Vt*Qt,W[6]=$e*ae-jt*Te,W[7]=ne*Te-Vt*ae,W[8]=Vt*jt-ne*$e,W}function it(W){var dt=W[0],Vt=W[1],ne=W[2],ge=W[3],$e=W[4],jt=W[5],Qt=W[6],Te=W[7],ae=W[8];return dt*(ae*$e-jt*Te)+Vt*(-ae*ge+jt*Qt)+ne*(Te*ge-$e*Qt)}function st(W,dt,Vt){var ne=dt[0],ge=dt[1],$e=dt[2],jt=dt[3],Qt=dt[4],Te=dt[5],ae=dt[6],Ke=dt[7],or=dt[8],ie=Vt[0],te=Vt[1],St=Vt[2],qt=Vt[3],$t=Vt[4],Ct=Vt[5],Tt=Vt[6],ue=Vt[7],Oe=Vt[8];return W[0]=ie*ne+te*jt+St*ae,W[1]=ie*ge+te*Qt+St*Ke,W[2]=ie*$e+te*Te+St*or,W[3]=qt*ne+$t*jt+Ct*ae,W[4]=qt*ge+$t*Qt+Ct*Ke,W[5]=qt*$e+$t*Te+Ct*or,W[6]=Tt*ne+ue*jt+Oe*ae,W[7]=Tt*ge+ue*Qt+Oe*Ke,W[8]=Tt*$e+ue*Te+Oe*or,W}function Zt(W,dt,Vt){var ne=dt[0],ge=dt[1],$e=dt[2],jt=dt[3],Qt=dt[4],Te=dt[5],ae=dt[6],Ke=dt[7],or=dt[8],ie=Vt[0],te=Vt[1];return W[0]=ne,W[1]=ge,W[2]=$e,W[3]=jt,W[4]=Qt,W[5]=Te,W[6]=ie*ne+te*jt+ae,W[7]=ie*ge+te*Qt+Ke,W[8]=ie*$e+te*Te+or,W}function P(W,dt,Vt){var ne=dt[0],ge=dt[1],$e=dt[2],jt=dt[3],Qt=dt[4],Te=dt[5],ae=dt[6],Ke=dt[7],or=dt[8],ie=Math.sin(Vt),te=Math.cos(Vt);return W[0]=te*ne+ie*jt,W[1]=te*ge+ie*Qt,W[2]=te*$e+ie*Te,W[3]=te*jt-ie*ne,W[4]=te*Qt-ie*ge,W[5]=te*Te-ie*$e,W[6]=ae,W[7]=Ke,W[8]=or,W}function b(W,dt,Vt){var ne=Vt[0],ge=Vt[1];return W[0]=ne*dt[0],W[1]=ne*dt[1],W[2]=ne*dt[2],W[3]=ge*dt[3],W[4]=ge*dt[4],W[5]=ge*dt[5],W[6]=dt[6],W[7]=dt[7],W[8]=dt[8],W}function X(W,dt){return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=1,W[5]=0,W[6]=dt[0],W[7]=dt[1],W[8]=1,W}function le(W,dt){var Vt=Math.sin(dt),ne=Math.cos(dt);return W[0]=ne,W[1]=Vt,W[2]=0,W[3]=-Vt,W[4]=ne,W[5]=0,W[6]=0,W[7]=0,W[8]=1,W}function Se(W,dt){return W[0]=dt[0],W[1]=0,W[2]=0,W[3]=0,W[4]=dt[1],W[5]=0,W[6]=0,W[7]=0,W[8]=1,W}function Ie(W,dt){return W[0]=dt[0],W[1]=dt[1],W[2]=0,W[3]=dt[2],W[4]=dt[3],W[5]=0,W[6]=dt[4],W[7]=dt[5],W[8]=1,W}function It(W,dt){var Vt=dt[0],ne=dt[1],ge=dt[2],$e=dt[3],jt=Vt+Vt,Qt=ne+ne,Te=ge+ge,ae=Vt*jt,Ke=ne*jt,or=ne*Qt,ie=ge*jt,te=ge*Qt,St=ge*Te,qt=$e*jt,$t=$e*Qt,Ct=$e*Te;return W[0]=1-or-St,W[3]=Ke-Ct,W[6]=ie+$t,W[1]=Ke+Ct,W[4]=1-ae-St,W[7]=te-qt,W[2]=ie-$t,W[5]=te+qt,W[8]=1-ae-or,W}function rt(W,dt){var Vt=dt[0],ne=dt[1],ge=dt[2],$e=dt[3],jt=dt[4],Qt=dt[5],Te=dt[6],ae=dt[7],Ke=dt[8],or=dt[9],ie=dt[10],te=dt[11],St=dt[12],qt=dt[13],$t=dt[14],Ct=dt[15],Tt=Vt*Qt-ne*jt,ue=Vt*Te-ge*jt,Oe=Vt*ae-$e*jt,We=ne*Te-ge*Qt,zt=ne*ae-$e*Qt,At=ge*ae-$e*Te,Mt=Ke*qt-or*St,Rt=Ke*$t-ie*St,tt=Ke*Ct-te*St,_t=or*$t-ie*qt,Xt=or*Ct-te*qt,ve=ie*Ct-te*$t,Wt=Tt*ve-ue*Xt+Oe*_t+We*tt-zt*Rt+At*Mt;return Wt?(Wt=1/Wt,W[0]=(Qt*ve-Te*Xt+ae*_t)*Wt,W[1]=(Te*tt-jt*ve-ae*Rt)*Wt,W[2]=(jt*Xt-Qt*tt+ae*Mt)*Wt,W[3]=(ge*Xt-ne*ve-$e*_t)*Wt,W[4]=(Vt*ve-ge*tt+$e*Rt)*Wt,W[5]=(ne*tt-Vt*Xt-$e*Mt)*Wt,W[6]=(qt*At-$t*zt+Ct*We)*Wt,W[7]=($t*Oe-St*At-Ct*ue)*Wt,W[8]=(St*zt-qt*Oe+Ct*Tt)*Wt,W):null}function Dt(W,dt,Vt){return W[0]=2/dt,W[1]=0,W[2]=0,W[3]=0,W[4]=-2/Vt,W[5]=0,W[6]=-1,W[7]=1,W[8]=1,W}function Ae(W){return"mat3("+W[0]+", "+W[1]+", "+W[2]+", "+W[3]+", "+W[4]+", "+W[5]+", "+W[6]+", "+W[7]+", "+W[8]+")"}function be(W){return Math.hypot(W[0],W[1],W[2],W[3],W[4],W[5],W[6],W[7],W[8])}function me(W,dt,Vt){return W[0]=dt[0]+Vt[0],W[1]=dt[1]+Vt[1],W[2]=dt[2]+Vt[2],W[3]=dt[3]+Vt[3],W[4]=dt[4]+Vt[4],W[5]=dt[5]+Vt[5],W[6]=dt[6]+Vt[6],W[7]=dt[7]+Vt[7],W[8]=dt[8]+Vt[8],W}function ee(W,dt,Vt){return W[0]=dt[0]-Vt[0],W[1]=dt[1]-Vt[1],W[2]=dt[2]-Vt[2],W[3]=dt[3]-Vt[3],W[4]=dt[4]-Vt[4],W[5]=dt[5]-Vt[5],W[6]=dt[6]-Vt[6],W[7]=dt[7]-Vt[7],W[8]=dt[8]-Vt[8],W}function we(W,dt,Vt){return W[0]=dt[0]*Vt,W[1]=dt[1]*Vt,W[2]=dt[2]*Vt,W[3]=dt[3]*Vt,W[4]=dt[4]*Vt,W[5]=dt[5]*Vt,W[6]=dt[6]*Vt,W[7]=dt[7]*Vt,W[8]=dt[8]*Vt,W}function _e(W,dt,Vt,ne){return W[0]=dt[0]+Vt[0]*ne,W[1]=dt[1]+Vt[1]*ne,W[2]=dt[2]+Vt[2]*ne,W[3]=dt[3]+Vt[3]*ne,W[4]=dt[4]+Vt[4]*ne,W[5]=dt[5]+Vt[5]*ne,W[6]=dt[6]+Vt[6]*ne,W[7]=dt[7]+Vt[7]*ne,W[8]=dt[8]+Vt[8]*ne,W}function gt(W,dt){return W[0]===dt[0]&&W[1]===dt[1]&&W[2]===dt[2]&&W[3]===dt[3]&&W[4]===dt[4]&&W[5]===dt[5]&&W[6]===dt[6]&&W[7]===dt[7]&&W[8]===dt[8]}function Pt(W,dt){var Vt=W[0],ne=W[1],ge=W[2],$e=W[3],jt=W[4],Qt=W[5],Te=W[6],ae=W[7],Ke=W[8],or=dt[0],ie=dt[1],te=dt[2],St=dt[3],qt=dt[4],$t=dt[5],Ct=dt[6],Tt=dt[7],ue=dt[8];return Math.abs(Vt-or)<=glMatrix.EPSILON*Math.max(1,Math.abs(Vt),Math.abs(or))&&Math.abs(ne-ie)<=glMatrix.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ie))&&Math.abs(ge-te)<=glMatrix.EPSILON*Math.max(1,Math.abs(ge),Math.abs(te))&&Math.abs($e-St)<=glMatrix.EPSILON*Math.max(1,Math.abs($e),Math.abs(St))&&Math.abs(jt-qt)<=glMatrix.EPSILON*Math.max(1,Math.abs(jt),Math.abs(qt))&&Math.abs(Qt-$t)<=glMatrix.EPSILON*Math.max(1,Math.abs(Qt),Math.abs($t))&&Math.abs(Te-Ct)<=glMatrix.EPSILON*Math.max(1,Math.abs(Te),Math.abs(Ct))&&Math.abs(ae-Tt)<=glMatrix.EPSILON*Math.max(1,Math.abs(ae),Math.abs(Tt))&&Math.abs(Ke-ue)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ke),Math.abs(ue))}var J=null,vt=null},31437:function(vn,Ft,ot){"use strict";ot.d(Ft,{$X:function(){return ct},AK:function(){return me},EU:function(){return dt},Fp:function(){return P},Fv:function(){return be},I6:function(){return ge},IH:function(){return ht},JG:function(){return q},TE:function(){return Se},Ue:function(){return wt},VV:function(){return Zt},al:function(){return Et},bA:function(){return X},kE:function(){return It},kK:function(){return J},lu:function(){return Qt},t7:function(){return we},t8:function(){return lt},tk:function(){return Dt}});var Lt=ot(49685);function wt(){var St=new Lt.WT(2);return Lt.WT!=Float32Array&&(St[0]=0,St[1]=0),St}function I(St){var qt=new glMatrix.ARRAY_TYPE(2);return qt[0]=St[0],qt[1]=St[1],qt}function Et(St,qt){var $t=new Lt.WT(2);return $t[0]=St,$t[1]=qt,$t}function q(St,qt){return St[0]=qt[0],St[1]=qt[1],St}function lt(St,qt,$t){return St[0]=qt,St[1]=$t,St}function ht(St,qt,$t){return St[0]=qt[0]+$t[0],St[1]=qt[1]+$t[1],St}function ct(St,qt,$t){return St[0]=qt[0]-$t[0],St[1]=qt[1]-$t[1],St}function et(St,qt,$t){return St[0]=qt[0]*$t[0],St[1]=qt[1]*$t[1],St}function Ee(St,qt,$t){return St[0]=qt[0]/$t[0],St[1]=qt[1]/$t[1],St}function it(St,qt){return St[0]=Math.ceil(qt[0]),St[1]=Math.ceil(qt[1]),St}function st(St,qt){return St[0]=Math.floor(qt[0]),St[1]=Math.floor(qt[1]),St}function Zt(St,qt,$t){return St[0]=Math.min(qt[0],$t[0]),St[1]=Math.min(qt[1],$t[1]),St}function P(St,qt,$t){return St[0]=Math.max(qt[0],$t[0]),St[1]=Math.max(qt[1],$t[1]),St}function b(St,qt){return St[0]=Math.round(qt[0]),St[1]=Math.round(qt[1]),St}function X(St,qt,$t){return St[0]=qt[0]*$t,St[1]=qt[1]*$t,St}function le(St,qt,$t,Ct){return St[0]=qt[0]+$t[0]*Ct,St[1]=qt[1]+$t[1]*Ct,St}function Se(St,qt){var $t=qt[0]-St[0],Ct=qt[1]-St[1];return Math.hypot($t,Ct)}function Ie(St,qt){var $t=qt[0]-St[0],Ct=qt[1]-St[1];return $t*$t+Ct*Ct}function It(St){var qt=St[0],$t=St[1];return Math.hypot(qt,$t)}function rt(St){var qt=St[0],$t=St[1];return qt*qt+$t*$t}function Dt(St,qt){return St[0]=-qt[0],St[1]=-qt[1],St}function Ae(St,qt){return St[0]=1/qt[0],St[1]=1/qt[1],St}function be(St,qt){var $t=qt[0],Ct=qt[1],Tt=$t*$t+Ct*Ct;return Tt>0&&(Tt=1/Math.sqrt(Tt)),St[0]=qt[0]*Tt,St[1]=qt[1]*Tt,St}function me(St,qt){return St[0]*qt[0]+St[1]*qt[1]}function ee(St,qt,$t){var Ct=qt[0]*$t[1]-qt[1]*$t[0];return St[0]=St[1]=0,St[2]=Ct,St}function we(St,qt,$t,Ct){var Tt=qt[0],ue=qt[1];return St[0]=Tt+Ct*($t[0]-Tt),St[1]=ue+Ct*($t[1]-ue),St}function _e(St,qt){qt=qt||1;var $t=glMatrix.RANDOM()*2*Math.PI;return St[0]=Math.cos($t)*qt,St[1]=Math.sin($t)*qt,St}function gt(St,qt,$t){var Ct=qt[0],Tt=qt[1];return St[0]=$t[0]*Ct+$t[2]*Tt,St[1]=$t[1]*Ct+$t[3]*Tt,St}function Pt(St,qt,$t){var Ct=qt[0],Tt=qt[1];return St[0]=$t[0]*Ct+$t[2]*Tt+$t[4],St[1]=$t[1]*Ct+$t[3]*Tt+$t[5],St}function J(St,qt,$t){var Ct=qt[0],Tt=qt[1];return St[0]=$t[0]*Ct+$t[3]*Tt+$t[6],St[1]=$t[1]*Ct+$t[4]*Tt+$t[7],St}function vt(St,qt,$t){var Ct=qt[0],Tt=qt[1];return St[0]=$t[0]*Ct+$t[4]*Tt+$t[12],St[1]=$t[1]*Ct+$t[5]*Tt+$t[13],St}function W(St,qt,$t,Ct){var Tt=qt[0]-$t[0],ue=qt[1]-$t[1],Oe=Math.sin(Ct),We=Math.cos(Ct);return St[0]=Tt*We-ue*Oe+$t[0],St[1]=Tt*Oe+ue*We+$t[1],St}function dt(St,qt){var $t=St[0],Ct=St[1],Tt=qt[0],ue=qt[1],Oe=Math.sqrt($t*$t+Ct*Ct)*Math.sqrt(Tt*Tt+ue*ue),We=Oe&&($t*Tt+Ct*ue)/Oe;return Math.acos(Math.min(Math.max(We,-1),1))}function Vt(St){return St[0]=0,St[1]=0,St}function ne(St){return"vec2("+St[0]+", "+St[1]+")"}function ge(St,qt){return St[0]===qt[0]&&St[1]===qt[1]}function $e(St,qt){var $t=St[0],Ct=St[1],Tt=qt[0],ue=qt[1];return Math.abs($t-Tt)<=glMatrix.EPSILON*Math.max(1,Math.abs($t),Math.abs(Tt))&&Math.abs(Ct-ue)<=glMatrix.EPSILON*Math.max(1,Math.abs(Ct),Math.abs(ue))}var jt=null,Qt=ct,Te=null,ae=null,Ke=null,or=null,ie=null,te=function(){var St=wt();return function(qt,$t,Ct,Tt,ue,Oe){var We,zt;for($t||($t=2),Ct||(Ct=0),Tt?zt=Math.min(Tt*$t+Ct,qt.length):zt=qt.length,We=Ct;We<zt;We+=$t)St[0]=qt[We],St[1]=qt[We+1],ue(St,St,Oe),qt[We]=St[0],qt[We+1]=St[1];return qt}}()},77160:function(vn,Ft,ot){"use strict";ot.r(Ft),ot.d(Ft,{add:function(){return ct},angle:function(){return ge},bezier:function(){return gt},ceil:function(){return st},clone:function(){return I},copy:function(){return lt},create:function(){return wt},cross:function(){return ee},dist:function(){return ie},distance:function(){return Ie},div:function(){return or},divide:function(){return it},dot:function(){return me},equals:function(){return Te},exactEquals:function(){return Qt},floor:function(){return Zt},forEach:function(){return $t},fromValues:function(){return q},hermite:function(){return _e},inverse:function(){return Ae},len:function(){return St},length:function(){return Et},lerp:function(){return we},max:function(){return b},min:function(){return P},mul:function(){return Ke},multiply:function(){return Ee},negate:function(){return Dt},normalize:function(){return be},random:function(){return Pt},rotateX:function(){return dt},rotateY:function(){return Vt},rotateZ:function(){return ne},round:function(){return X},scale:function(){return le},scaleAndAdd:function(){return Se},set:function(){return ht},sqrDist:function(){return te},sqrLen:function(){return qt},squaredDistance:function(){return It},squaredLength:function(){return rt},str:function(){return jt},sub:function(){return ae},subtract:function(){return et},transformMat3:function(){return vt},transformMat4:function(){return J},transformQuat:function(){return W},zero:function(){return $e}});var Lt=ot(49685);function wt(){var Ct=new Lt.WT(3);return Lt.WT!=Float32Array&&(Ct[0]=0,Ct[1]=0,Ct[2]=0),Ct}function I(Ct){var Tt=new Lt.WT(3);return Tt[0]=Ct[0],Tt[1]=Ct[1],Tt[2]=Ct[2],Tt}function Et(Ct){var Tt=Ct[0],ue=Ct[1],Oe=Ct[2];return Math.hypot(Tt,ue,Oe)}function q(Ct,Tt,ue){var Oe=new Lt.WT(3);return Oe[0]=Ct,Oe[1]=Tt,Oe[2]=ue,Oe}function lt(Ct,Tt){return Ct[0]=Tt[0],Ct[1]=Tt[1],Ct[2]=Tt[2],Ct}function ht(Ct,Tt,ue,Oe){return Ct[0]=Tt,Ct[1]=ue,Ct[2]=Oe,Ct}function ct(Ct,Tt,ue){return Ct[0]=Tt[0]+ue[0],Ct[1]=Tt[1]+ue[1],Ct[2]=Tt[2]+ue[2],Ct}function et(Ct,Tt,ue){return Ct[0]=Tt[0]-ue[0],Ct[1]=Tt[1]-ue[1],Ct[2]=Tt[2]-ue[2],Ct}function Ee(Ct,Tt,ue){return Ct[0]=Tt[0]*ue[0],Ct[1]=Tt[1]*ue[1],Ct[2]=Tt[2]*ue[2],Ct}function it(Ct,Tt,ue){return Ct[0]=Tt[0]/ue[0],Ct[1]=Tt[1]/ue[1],Ct[2]=Tt[2]/ue[2],Ct}function st(Ct,Tt){return Ct[0]=Math.ceil(Tt[0]),Ct[1]=Math.ceil(Tt[1]),Ct[2]=Math.ceil(Tt[2]),Ct}function Zt(Ct,Tt){return Ct[0]=Math.floor(Tt[0]),Ct[1]=Math.floor(Tt[1]),Ct[2]=Math.floor(Tt[2]),Ct}function P(Ct,Tt,ue){return Ct[0]=Math.min(Tt[0],ue[0]),Ct[1]=Math.min(Tt[1],ue[1]),Ct[2]=Math.min(Tt[2],ue[2]),Ct}function b(Ct,Tt,ue){return Ct[0]=Math.max(Tt[0],ue[0]),Ct[1]=Math.max(Tt[1],ue[1]),Ct[2]=Math.max(Tt[2],ue[2]),Ct}function X(Ct,Tt){return Ct[0]=Math.round(Tt[0]),Ct[1]=Math.round(Tt[1]),Ct[2]=Math.round(Tt[2]),Ct}function le(Ct,Tt,ue){return Ct[0]=Tt[0]*ue,Ct[1]=Tt[1]*ue,Ct[2]=Tt[2]*ue,Ct}function Se(Ct,Tt,ue,Oe){return Ct[0]=Tt[0]+ue[0]*Oe,Ct[1]=Tt[1]+ue[1]*Oe,Ct[2]=Tt[2]+ue[2]*Oe,Ct}function Ie(Ct,Tt){var ue=Tt[0]-Ct[0],Oe=Tt[1]-Ct[1],We=Tt[2]-Ct[2];return Math.hypot(ue,Oe,We)}function It(Ct,Tt){var ue=Tt[0]-Ct[0],Oe=Tt[1]-Ct[1],We=Tt[2]-Ct[2];return ue*ue+Oe*Oe+We*We}function rt(Ct){var Tt=Ct[0],ue=Ct[1],Oe=Ct[2];return Tt*Tt+ue*ue+Oe*Oe}function Dt(Ct,Tt){return Ct[0]=-Tt[0],Ct[1]=-Tt[1],Ct[2]=-Tt[2],Ct}function Ae(Ct,Tt){return Ct[0]=1/Tt[0],Ct[1]=1/Tt[1],Ct[2]=1/Tt[2],Ct}function be(Ct,Tt){var ue=Tt[0],Oe=Tt[1],We=Tt[2],zt=ue*ue+Oe*Oe+We*We;return zt>0&&(zt=1/Math.sqrt(zt)),Ct[0]=Tt[0]*zt,Ct[1]=Tt[1]*zt,Ct[2]=Tt[2]*zt,Ct}function me(Ct,Tt){return Ct[0]*Tt[0]+Ct[1]*Tt[1]+Ct[2]*Tt[2]}function ee(Ct,Tt,ue){var Oe=Tt[0],We=Tt[1],zt=Tt[2],At=ue[0],Mt=ue[1],Rt=ue[2];return Ct[0]=We*Rt-zt*Mt,Ct[1]=zt*At-Oe*Rt,Ct[2]=Oe*Mt-We*At,Ct}function we(Ct,Tt,ue,Oe){var We=Tt[0],zt=Tt[1],At=Tt[2];return Ct[0]=We+Oe*(ue[0]-We),Ct[1]=zt+Oe*(ue[1]-zt),Ct[2]=At+Oe*(ue[2]-At),Ct}function _e(Ct,Tt,ue,Oe,We,zt){var At=zt*zt,Mt=At*(2*zt-3)+1,Rt=At*(zt-2)+zt,tt=At*(zt-1),_t=At*(3-2*zt);return Ct[0]=Tt[0]*Mt+ue[0]*Rt+Oe[0]*tt+We[0]*_t,Ct[1]=Tt[1]*Mt+ue[1]*Rt+Oe[1]*tt+We[1]*_t,Ct[2]=Tt[2]*Mt+ue[2]*Rt+Oe[2]*tt+We[2]*_t,Ct}function gt(Ct,Tt,ue,Oe,We,zt){var At=1-zt,Mt=At*At,Rt=zt*zt,tt=Mt*At,_t=3*zt*Mt,Xt=3*Rt*At,ve=Rt*zt;return Ct[0]=Tt[0]*tt+ue[0]*_t+Oe[0]*Xt+We[0]*ve,Ct[1]=Tt[1]*tt+ue[1]*_t+Oe[1]*Xt+We[1]*ve,Ct[2]=Tt[2]*tt+ue[2]*_t+Oe[2]*Xt+We[2]*ve,Ct}function Pt(Ct,Tt){Tt=Tt||1;var ue=Lt.FD()*2*Math.PI,Oe=Lt.FD()*2-1,We=Math.sqrt(1-Oe*Oe)*Tt;return Ct[0]=Math.cos(ue)*We,Ct[1]=Math.sin(ue)*We,Ct[2]=Oe*Tt,Ct}function J(Ct,Tt,ue){var Oe=Tt[0],We=Tt[1],zt=Tt[2],At=ue[3]*Oe+ue[7]*We+ue[11]*zt+ue[15];return At=At||1,Ct[0]=(ue[0]*Oe+ue[4]*We+ue[8]*zt+ue[12])/At,Ct[1]=(ue[1]*Oe+ue[5]*We+ue[9]*zt+ue[13])/At,Ct[2]=(ue[2]*Oe+ue[6]*We+ue[10]*zt+ue[14])/At,Ct}function vt(Ct,Tt,ue){var Oe=Tt[0],We=Tt[1],zt=Tt[2];return Ct[0]=Oe*ue[0]+We*ue[3]+zt*ue[6],Ct[1]=Oe*ue[1]+We*ue[4]+zt*ue[7],Ct[2]=Oe*ue[2]+We*ue[5]+zt*ue[8],Ct}function W(Ct,Tt,ue){var Oe=ue[0],We=ue[1],zt=ue[2],At=ue[3],Mt=Tt[0],Rt=Tt[1],tt=Tt[2],_t=We*tt-zt*Rt,Xt=zt*Mt-Oe*tt,ve=Oe*Rt-We*Mt,Wt=We*ve-zt*Xt,Me=zt*_t-Oe*ve,je=Oe*Xt-We*_t,Qe=At*2;return _t*=Qe,Xt*=Qe,ve*=Qe,Wt*=2,Me*=2,je*=2,Ct[0]=Mt+_t+Wt,Ct[1]=Rt+Xt+Me,Ct[2]=tt+ve+je,Ct}function dt(Ct,Tt,ue,Oe){var We=[],zt=[];return We[0]=Tt[0]-ue[0],We[1]=Tt[1]-ue[1],We[2]=Tt[2]-ue[2],zt[0]=We[0],zt[1]=We[1]*Math.cos(Oe)-We[2]*Math.sin(Oe),zt[2]=We[1]*Math.sin(Oe)+We[2]*Math.cos(Oe),Ct[0]=zt[0]+ue[0],Ct[1]=zt[1]+ue[1],Ct[2]=zt[2]+ue[2],Ct}function Vt(Ct,Tt,ue,Oe){var We=[],zt=[];return We[0]=Tt[0]-ue[0],We[1]=Tt[1]-ue[1],We[2]=Tt[2]-ue[2],zt[0]=We[2]*Math.sin(Oe)+We[0]*Math.cos(Oe),zt[1]=We[1],zt[2]=We[2]*Math.cos(Oe)-We[0]*Math.sin(Oe),Ct[0]=zt[0]+ue[0],Ct[1]=zt[1]+ue[1],Ct[2]=zt[2]+ue[2],Ct}function ne(Ct,Tt,ue,Oe){var We=[],zt=[];return We[0]=Tt[0]-ue[0],We[1]=Tt[1]-ue[1],We[2]=Tt[2]-ue[2],zt[0]=We[0]*Math.cos(Oe)-We[1]*Math.sin(Oe),zt[1]=We[0]*Math.sin(Oe)+We[1]*Math.cos(Oe),zt[2]=We[2],Ct[0]=zt[0]+ue[0],Ct[1]=zt[1]+ue[1],Ct[2]=zt[2]+ue[2],Ct}function ge(Ct,Tt){var ue=Ct[0],Oe=Ct[1],We=Ct[2],zt=Tt[0],At=Tt[1],Mt=Tt[2],Rt=Math.sqrt(ue*ue+Oe*Oe+We*We),tt=Math.sqrt(zt*zt+At*At+Mt*Mt),_t=Rt*tt,Xt=_t&&me(Ct,Tt)/_t;return Math.acos(Math.min(Math.max(Xt,-1),1))}function $e(Ct){return Ct[0]=0,Ct[1]=0,Ct[2]=0,Ct}function jt(Ct){return"vec3("+Ct[0]+", "+Ct[1]+", "+Ct[2]+")"}function Qt(Ct,Tt){return Ct[0]===Tt[0]&&Ct[1]===Tt[1]&&Ct[2]===Tt[2]}function Te(Ct,Tt){var ue=Ct[0],Oe=Ct[1],We=Ct[2],zt=Tt[0],At=Tt[1],Mt=Tt[2];return Math.abs(ue-zt)<=Lt.Ib*Math.max(1,Math.abs(ue),Math.abs(zt))&&Math.abs(Oe-At)<=Lt.Ib*Math.max(1,Math.abs(Oe),Math.abs(At))&&Math.abs(We-Mt)<=Lt.Ib*Math.max(1,Math.abs(We),Math.abs(Mt))}var ae=et,Ke=Ee,or=it,ie=Ie,te=It,St=Et,qt=rt,$t=function(){var Ct=wt();return function(Tt,ue,Oe,We,zt,At){var Mt,Rt;for(ue||(ue=3),Oe||(Oe=0),We?Rt=Math.min(We*ue+Oe,Tt.length):Rt=Tt.length,Mt=Oe;Mt<Rt;Mt+=ue)Ct[0]=Tt[Mt],Ct[1]=Tt[Mt+1],Ct[2]=Tt[Mt+2],zt(Ct,Ct,At),Tt[Mt]=Ct[0],Tt[Mt+1]=Ct[1],Tt[Mt+2]=Ct[2];return Tt}}()},7375:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});var ot=Symbol.for("INJECTION");function Lt(lt,ht,ct,et){function Ee(){return et&&!Reflect.hasMetadata(ot,this,ht)&&Reflect.defineMetadata(ot,ct(),this,ht),Reflect.hasMetadata(ot,this,ht)?Reflect.getMetadata(ot,this,ht):ct()}function it(st){Reflect.defineMetadata(ot,st,this,ht)}Object.defineProperty(lt,ht,{configurable:!0,enumerable:!0,get:Ee,set:it})}function wt(lt,ht){return function(ct){return function(et,Ee){var it=function(){return lt.get(ct)};Lt(et,Ee,it,ht)}}}Ft.makePropertyInjectDecorator=wt;function I(lt,ht){return function(ct,et){return function(Ee,it){var st=function(){return lt.getNamed(ct,et)};Lt(Ee,it,st,ht)}}}Ft.makePropertyInjectNamedDecorator=I;function Et(lt,ht){return function(ct,et,Ee){return function(it,st){var Zt=function(){return lt.getTagged(ct,et,Ee)};Lt(it,st,Zt,ht)}}}Ft.makePropertyInjectTaggedDecorator=Et;function q(lt,ht){return function(ct){return function(et,Ee){var it=function(){return lt.getAll(ct)};Lt(et,Ee,it,ht)}}}Ft.makePropertyMultiInjectDecorator=q},84879:function(vn,Ft,ot){"use strict";var Lt;Lt={value:!0};var wt=ot(7375);function I(Et,q){q===void 0&&(q=!0);var lt=wt.makePropertyInjectDecorator(Et,q),ht=wt.makePropertyInjectNamedDecorator(Et,q),ct=wt.makePropertyInjectTaggedDecorator(Et,q),et=wt.makePropertyMultiInjectDecorator(Et,q);return{lazyInject:lt,lazyInjectNamed:ht,lazyInjectTagged:ct,lazyMultiInject:et}}Ft.Z=I},99934:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.tagProperty=Ft.tagParameter=Ft.decorate=void 0;var Lt=ot(16674),wt=ot(6867);function I(et,Ee,it,st){var Zt=wt.TAGGED;q(Zt,et,Ee,st,it)}Ft.tagParameter=I;function Et(et,Ee,it){var st=wt.TAGGED_PROP;q(st,et.constructor,Ee,it)}Ft.tagProperty=Et;function q(et,Ee,it,st,Zt){var P={},b=typeof Zt=="number",X=Zt!==void 0&&b?Zt.toString():it;if(b&&it!==void 0)throw new Error(Lt.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(et,Ee)&&(P=Reflect.getMetadata(et,Ee));var le=P[X];if(!Array.isArray(le))le=[];else for(var Se=0,Ie=le;Se<Ie.length;Se++){var It=Ie[Se];if(It.key===st.key)throw new Error(Lt.DUPLICATED_METADATA+" "+It.key.toString())}le.push(st),P[X]=le,Reflect.defineMetadata(et,P,Ee)}function lt(et,Ee){Reflect.decorate(et,Ee)}function ht(et,Ee){return function(it,st){Ee(it,st,et)}}function ct(et,Ee,it){typeof it=="number"?lt([ht(it,et)],Ee):typeof it=="string"?Reflect.decorate([et],Ee,it):lt([et],Ee)}Ft.decorate=ct},5744:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.inject=Ft.LazyServiceIdentifer=void 0;var Lt=ot(16674),wt=ot(6867),I=ot(47738),Et=ot(99934),q=function(){function ht(ct){this._cb=ct}return ht.prototype.unwrap=function(){return this._cb()},ht}();Ft.LazyServiceIdentifer=q;function lt(ht){return function(ct,et,Ee){if(ht===void 0)throw new Error(Lt.UNDEFINED_INJECT_ANNOTATION(ct.name));var it=new I.Metadata(wt.INJECT_TAG,ht);typeof Ee=="number"?Et.tagParameter(ct,et,Ee,it):Et.tagProperty(ct,et,it)}}Ft.inject=lt},64315:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.injectable=void 0;var Lt=ot(16674),wt=ot(6867);function I(){return function(Et){if(Reflect.hasOwnMetadata(wt.PARAM_TYPES,Et))throw new Error(Lt.DUPLICATED_INJECTABLE_DECORATOR);var q=Reflect.getMetadata(wt.DESIGN_PARAM_TYPES,Et)||[];return Reflect.defineMetadata(wt.PARAM_TYPES,q,Et),Et}}Ft.injectable=I},71693:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.multiInject=void 0;var Lt=ot(6867),wt=ot(47738),I=ot(99934);function Et(q){return function(lt,ht,ct){var et=new wt.Metadata(Lt.MULTI_INJECT_TAG,q);typeof ct=="number"?I.tagParameter(lt,ht,ct,et):I.tagProperty(lt,ht,et)}}Ft.multiInject=Et},38085:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.named=void 0;var Lt=ot(6867),wt=ot(47738),I=ot(99934);function Et(q){return function(lt,ht,ct){var et=new wt.Metadata(Lt.NAMED_TAG,q);typeof ct=="number"?I.tagParameter(lt,ht,ct,et):I.tagProperty(lt,ht,et)}}Ft.named=Et},6515:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.optional=void 0;var Lt=ot(6867),wt=ot(47738),I=ot(99934);function Et(){return function(q,lt,ht){var ct=new wt.Metadata(Lt.OPTIONAL_TAG,!0);typeof ht=="number"?I.tagParameter(q,lt,ht,ct):I.tagProperty(q,lt,ct)}}Ft.optional=Et},7014:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.postConstruct=void 0;var Lt=ot(16674),wt=ot(6867),I=ot(47738);function Et(){return function(q,lt,ht){var ct=new I.Metadata(wt.POST_CONSTRUCT,lt);if(Reflect.hasOwnMetadata(wt.POST_CONSTRUCT,q.constructor))throw new Error(Lt.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(wt.POST_CONSTRUCT,ct,q.constructor)}}Ft.postConstruct=Et},32052:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.tagged=void 0;var Lt=ot(47738),wt=ot(99934);function I(Et,q){return function(lt,ht,ct){var et=new Lt.Metadata(Et,q);typeof ct=="number"?wt.tagParameter(lt,ht,ct,et):wt.tagProperty(lt,ht,et)}}Ft.tagged=I},55638:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.targetName=void 0;var Lt=ot(6867),wt=ot(47738),I=ot(99934);function Et(q){return function(lt,ht,ct){var et=new wt.Metadata(Lt.NAME_TAG,q);I.tagParameter(lt,ht,ct,et)}}Ft.targetName=Et},86757:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.unmanaged=void 0;var Lt=ot(6867),wt=ot(47738),I=ot(99934);function Et(){return function(q,lt,ht){var ct=new wt.Metadata(Lt.UNMANAGED_TAG,!0);I.tagParameter(q,lt,ht,ct)}}Ft.unmanaged=Et},44290:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Binding=void 0;var Lt=ot(28421),wt=ot(37791),I=function(){function Et(q,lt){this.id=wt.id(),this.activated=!1,this.serviceIdentifier=q,this.scope=lt,this.type=Lt.BindingTypeEnum.Invalid,this.constraint=function(ht){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return Et.prototype.clone=function(){var q=new Et(this.serviceIdentifier,this.scope);return q.activated=q.scope===Lt.BindingScopeEnum.Singleton?this.activated:!1,q.implementationType=this.implementationType,q.dynamicValue=this.dynamicValue,q.scope=this.scope,q.type=this.type,q.factory=this.factory,q.provider=this.provider,q.constraint=this.constraint,q.onActivation=this.onActivation,q.cache=this.cache,q},Et}();Ft.Binding=I},23184:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingCount=void 0;var ot={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};Ft.BindingCount=ot},16674:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.STACK_OVERFLOW=Ft.CIRCULAR_DEPENDENCY_IN_FACTORY=Ft.POST_CONSTRUCT_ERROR=Ft.MULTIPLE_POST_CONSTRUCT_METHODS=Ft.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Ft.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Ft.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Ft.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Ft.ARGUMENTS_LENGTH_MISMATCH=Ft.INVALID_DECORATOR_OPERATION=Ft.INVALID_TO_SELF_VALUE=Ft.INVALID_FUNCTION_BINDING=Ft.INVALID_MIDDLEWARE_RETURN=Ft.NO_MORE_SNAPSHOTS_AVAILABLE=Ft.INVALID_BINDING_TYPE=Ft.NOT_IMPLEMENTED=Ft.CIRCULAR_DEPENDENCY=Ft.UNDEFINED_INJECT_ANNOTATION=Ft.MISSING_INJECT_ANNOTATION=Ft.MISSING_INJECTABLE_ANNOTATION=Ft.NOT_REGISTERED=Ft.CANNOT_UNBIND=Ft.AMBIGUOUS_MATCH=Ft.KEY_NOT_FOUND=Ft.NULL_ARGUMENT=Ft.DUPLICATED_METADATA=Ft.DUPLICATED_INJECTABLE_DECORATOR=void 0,Ft.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",Ft.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",Ft.NULL_ARGUMENT="NULL argument",Ft.KEY_NOT_FOUND="Key Not Found",Ft.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",Ft.CANNOT_UNBIND="Could not unbind serviceIdentifier:",Ft.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",Ft.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",Ft.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var ot=function(Et){return"@inject called with undefined this could mean that the class "+Et+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."};Ft.UNDEFINED_INJECT_ANNOTATION=ot,Ft.CIRCULAR_DEPENDENCY="Circular dependency found:",Ft.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",Ft.INVALID_BINDING_TYPE="Invalid binding type:",Ft.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",Ft.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",Ft.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",Ft.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",Ft.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var Lt=function(){for(var Et=[],q=0;q<arguments.length;q++)Et[q]=arguments[q];return"The number of constructor arguments in the derived class "+(Et[0]+" must be >= than the number of constructor arguments of its base class.")};Ft.ARGUMENTS_LENGTH_MISMATCH=Lt,Ft.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",Ft.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",Ft.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",Ft.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",Ft.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";var wt=function(){for(var Et=[],q=0;q<arguments.length;q++)Et[q]=arguments[q];return"@postConstruct error in class "+Et[0]+": "+Et[1]};Ft.POST_CONSTRUCT_ERROR=wt;var I=function(){for(var Et=[],q=0;q<arguments.length;q++)Et[q]=arguments[q];return"It looks like there is a circular dependency "+("in one of the '"+Et[0]+"' bindings. Please investigate bindings with")+("service identifier '"+Et[1]+"'.")};Ft.CIRCULAR_DEPENDENCY_IN_FACTORY=I,Ft.STACK_OVERFLOW="Maximum call stack size exceeded"},28421:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.TargetTypeEnum=Ft.BindingTypeEnum=Ft.BindingScopeEnum=void 0;var ot={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Ft.BindingScopeEnum=ot;var Lt={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Ft.BindingTypeEnum=Lt;var wt={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Ft.TargetTypeEnum=wt},6867:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.NON_CUSTOM_TAG_KEYS=Ft.POST_CONSTRUCT=Ft.DESIGN_PARAM_TYPES=Ft.PARAM_TYPES=Ft.TAGGED_PROP=Ft.TAGGED=Ft.MULTI_INJECT_TAG=Ft.INJECT_TAG=Ft.OPTIONAL_TAG=Ft.UNMANAGED_TAG=Ft.NAME_TAG=Ft.NAMED_TAG=void 0,Ft.NAMED_TAG="named",Ft.NAME_TAG="name",Ft.UNMANAGED_TAG="unmanaged",Ft.OPTIONAL_TAG="optional",Ft.INJECT_TAG="inject",Ft.MULTI_INJECT_TAG="multi_inject",Ft.TAGGED="inversify:tagged",Ft.TAGGED_PROP="inversify:tagged_props",Ft.PARAM_TYPES="inversify:paramtypes",Ft.DESIGN_PARAM_TYPES="design:paramtypes",Ft.POST_CONSTRUCT="post_construct";function ot(){return[Ft.INJECT_TAG,Ft.MULTI_INJECT_TAG,Ft.NAME_TAG,Ft.UNMANAGED_TAG,Ft.NAMED_TAG,Ft.OPTIONAL_TAG]}Ft.NON_CUSTOM_TAG_KEYS=ot()},51389:function(vn,Ft,ot){"use strict";var Lt=this&&this.__awaiter||function(le,Se,Ie,It){function rt(Dt){return Dt instanceof Ie?Dt:new Ie(function(Ae){Ae(Dt)})}return new(Ie||(Ie=Promise))(function(Dt,Ae){function be(we){try{ee(It.next(we))}catch(_e){Ae(_e)}}function me(we){try{ee(It.throw(we))}catch(_e){Ae(_e)}}function ee(we){we.done?Dt(we.value):rt(we.value).then(be,me)}ee((It=It.apply(le,Se||[])).next())})},wt=this&&this.__generator||function(le,Se){var Ie={label:0,sent:function(){if(Dt[0]&1)throw Dt[1];return Dt[1]},trys:[],ops:[]},It,rt,Dt,Ae;return Ae={next:be(0),throw:be(1),return:be(2)},typeof Symbol=="function"&&(Ae[Symbol.iterator]=function(){return this}),Ae;function be(ee){return function(we){return me([ee,we])}}function me(ee){if(It)throw new TypeError("Generator is already executing.");for(;Ie;)try{if(It=1,rt&&(Dt=ee[0]&2?rt.return:ee[0]?rt.throw||((Dt=rt.return)&&Dt.call(rt),0):rt.next)&&!(Dt=Dt.call(rt,ee[1])).done)return Dt;switch(rt=0,Dt&&(ee=[ee[0]&2,Dt.value]),ee[0]){case 0:case 1:Dt=ee;break;case 4:return Ie.label++,{value:ee[1],done:!1};case 5:Ie.label++,rt=ee[1],ee=[0];continue;case 7:ee=Ie.ops.pop(),Ie.trys.pop();continue;default:if(Dt=Ie.trys,!(Dt=Dt.length>0&&Dt[Dt.length-1])&&(ee[0]===6||ee[0]===2)){Ie=0;continue}if(ee[0]===3&&(!Dt||ee[1]>Dt[0]&&ee[1]<Dt[3])){Ie.label=ee[1];break}if(ee[0]===6&&Ie.label<Dt[1]){Ie.label=Dt[1],Dt=ee;break}if(Dt&&Ie.label<Dt[2]){Ie.label=Dt[2],Ie.ops.push(ee);break}Dt[2]&&Ie.ops.pop(),Ie.trys.pop();continue}ee=Se.call(le,Ie)}catch(we){ee=[6,we],rt=0}finally{It=Dt=0}if(ee[0]&5)throw ee[1];return{value:ee[0]?ee[1]:void 0,done:!0}}},I=this&&this.__spreadArray||function(le,Se){for(var Ie=0,It=Se.length,rt=le.length;Ie<It;Ie++,rt++)le[rt]=Se[Ie];return le};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Container=void 0;var Et=ot(44290),q=ot(16674),lt=ot(28421),ht=ot(6867),ct=ot(51377),et=ot(86311),Ee=ot(31927),it=ot(51860),st=ot(37791),Zt=ot(55800),P=ot(85700),b=ot(80175),X=function(){function le(Se){this._appliedMiddleware=[];var Ie=Se||{};if(typeof Ie!="object")throw new Error(""+q.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(Ie.defaultScope===void 0)Ie.defaultScope=lt.BindingScopeEnum.Transient;else if(Ie.defaultScope!==lt.BindingScopeEnum.Singleton&&Ie.defaultScope!==lt.BindingScopeEnum.Transient&&Ie.defaultScope!==lt.BindingScopeEnum.Request)throw new Error(""+q.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(Ie.autoBindInjectable===void 0)Ie.autoBindInjectable=!1;else if(typeof Ie.autoBindInjectable!="boolean")throw new Error(""+q.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(Ie.skipBaseClassChecks===void 0)Ie.skipBaseClassChecks=!1;else if(typeof Ie.skipBaseClassChecks!="boolean")throw new Error(""+q.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Ie.autoBindInjectable,defaultScope:Ie.defaultScope,skipBaseClassChecks:Ie.skipBaseClassChecks},this.id=st.id(),this._bindingDictionary=new b.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new ct.MetadataReader}return le.merge=function(Se,Ie){for(var It=[],rt=2;rt<arguments.length;rt++)It[rt-2]=arguments[rt];var Dt=new le,Ae=I([Se,Ie],It).map(function(ee){return et.getBindingDictionary(ee)}),be=et.getBindingDictionary(Dt);function me(ee,we){ee.traverse(function(_e,gt){gt.forEach(function(Pt){we.add(Pt.serviceIdentifier,Pt.clone())})})}return Ae.forEach(function(ee){me(ee,be)}),Dt},le.prototype.load=function(){for(var Se=[],Ie=0;Ie<arguments.length;Ie++)Se[Ie]=arguments[Ie];for(var It=this._getContainerModuleHelpersFactory(),rt=0,Dt=Se;rt<Dt.length;rt++){var Ae=Dt[rt],be=It(Ae.id);Ae.registry(be.bindFunction,be.unbindFunction,be.isboundFunction,be.rebindFunction)}},le.prototype.loadAsync=function(){for(var Se=[],Ie=0;Ie<arguments.length;Ie++)Se[Ie]=arguments[Ie];return Lt(this,void 0,void 0,function(){var It,rt,Dt,Ae,be;return wt(this,function(me){switch(me.label){case 0:It=this._getContainerModuleHelpersFactory(),rt=0,Dt=Se,me.label=1;case 1:return rt<Dt.length?(Ae=Dt[rt],be=It(Ae.id),[4,Ae.registry(be.bindFunction,be.unbindFunction,be.isboundFunction,be.rebindFunction)]):[3,4];case 2:me.sent(),me.label=3;case 3:return rt++,[3,1];case 4:return[2]}})})},le.prototype.unload=function(){for(var Se=this,Ie=[],It=0;It<arguments.length;It++)Ie[It]=arguments[It];var rt=function(Dt){return function(Ae){return Ae.moduleId===Dt}};Ie.forEach(function(Dt){var Ae=rt(Dt.id);Se._bindingDictionary.removeByCondition(Ae)})},le.prototype.bind=function(Se){var Ie=this.options.defaultScope||lt.BindingScopeEnum.Transient,It=new Et.Binding(Se,Ie);return this._bindingDictionary.add(Se,It),new it.BindingToSyntax(It)},le.prototype.rebind=function(Se){return this.unbind(Se),this.bind(Se)},le.prototype.unbind=function(Se){try{this._bindingDictionary.remove(Se)}catch(Ie){throw new Error(q.CANNOT_UNBIND+" "+Zt.getServiceIdentifierAsString(Se))}},le.prototype.unbindAll=function(){this._bindingDictionary=new b.Lookup},le.prototype.isBound=function(Se){var Ie=this._bindingDictionary.hasKey(Se);return!Ie&&this.parent&&(Ie=this.parent.isBound(Se)),Ie},le.prototype.isBoundNamed=function(Se,Ie){return this.isBoundTagged(Se,ht.NAMED_TAG,Ie)},le.prototype.isBoundTagged=function(Se,Ie,It){var rt=!1;if(this._bindingDictionary.hasKey(Se)){var Dt=this._bindingDictionary.get(Se),Ae=et.createMockRequest(this,Se,Ie,It);rt=Dt.some(function(be){return be.constraint(Ae)})}return!rt&&this.parent&&(rt=this.parent.isBoundTagged(Se,Ie,It)),rt},le.prototype.snapshot=function(){this._snapshots.push(P.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},le.prototype.restore=function(){var Se=this._snapshots.pop();if(Se===void 0)throw new Error(q.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=Se.bindings,this._middleware=Se.middleware},le.prototype.createChild=function(Se){var Ie=new le(Se||this.options);return Ie.parent=this,Ie},le.prototype.applyMiddleware=function(){for(var Se=[],Ie=0;Ie<arguments.length;Ie++)Se[Ie]=arguments[Ie];this._appliedMiddleware=this._appliedMiddleware.concat(Se);var It=this._middleware?this._middleware:this._planAndResolve();this._middleware=Se.reduce(function(rt,Dt){return Dt(rt)},It)},le.prototype.applyCustomMetadataReader=function(Se){this._metadataReader=Se},le.prototype.get=function(Se){return this._get(!1,!1,lt.TargetTypeEnum.Variable,Se)},le.prototype.getTagged=function(Se,Ie,It){return this._get(!1,!1,lt.TargetTypeEnum.Variable,Se,Ie,It)},le.prototype.getNamed=function(Se,Ie){return this.getTagged(Se,ht.NAMED_TAG,Ie)},le.prototype.getAll=function(Se){return this._get(!0,!0,lt.TargetTypeEnum.Variable,Se)},le.prototype.getAllTagged=function(Se,Ie,It){return this._get(!1,!0,lt.TargetTypeEnum.Variable,Se,Ie,It)},le.prototype.getAllNamed=function(Se,Ie){return this.getAllTagged(Se,ht.NAMED_TAG,Ie)},le.prototype.resolve=function(Se){var Ie=this.createChild();return Ie.bind(Se).toSelf(),this._appliedMiddleware.forEach(function(It){Ie.applyMiddleware(It)}),Ie.get(Se)},le.prototype._getContainerModuleHelpersFactory=function(){var Se=this,Ie=function(be,me){be._binding.moduleId=me},It=function(be){return function(me){var ee=Se.bind.bind(Se),we=ee(me);return Ie(we,be),we}},rt=function(be){return function(me){var ee=Se.unbind.bind(Se);ee(me)}},Dt=function(be){return function(me){var ee=Se.isBound.bind(Se);return ee(me)}},Ae=function(be){return function(me){var ee=Se.rebind.bind(Se),we=ee(me);return Ie(we,be),we}};return function(be){return{bindFunction:It(be),isboundFunction:Dt(be),rebindFunction:Ae(be),unbindFunction:rt(be)}}},le.prototype._get=function(Se,Ie,It,rt,Dt,Ae){var be=null,me={avoidConstraints:Se,contextInterceptor:function(ee){return ee},isMultiInject:Ie,key:Dt,serviceIdentifier:rt,targetType:It,value:Ae};if(this._middleware){if(be=this._middleware(me),be==null)throw new Error(q.INVALID_MIDDLEWARE_RETURN)}else be=this._planAndResolve()(me);return be},le.prototype._planAndResolve=function(){var Se=this;return function(Ie){var It=et.plan(Se._metadataReader,Se,Ie.isMultiInject,Ie.targetType,Ie.serviceIdentifier,Ie.key,Ie.value,Ie.avoidConstraints);It=Ie.contextInterceptor(It);var rt=Ee.resolve(It);return rt}},le}();Ft.Container=X},33244:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.AsyncContainerModule=Ft.ContainerModule=void 0;var Lt=ot(37791),wt=function(){function Et(q){this.id=Lt.id(),this.registry=q}return Et}();Ft.ContainerModule=wt;var I=function(){function Et(q){this.id=Lt.id(),this.registry=q}return Et}();Ft.AsyncContainerModule=I},85700:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.ContainerSnapshot=void 0;var ot=function(){function Lt(){}return Lt.of=function(wt,I){var Et=new Lt;return Et.bindings=wt,Et.middleware=I,Et},Lt}();Ft.ContainerSnapshot=ot},80175:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Lookup=void 0;var Lt=ot(16674),wt=function(){function I(){this._map=new Map}return I.prototype.getMap=function(){return this._map},I.prototype.add=function(Et,q){if(Et==null)throw new Error(Lt.NULL_ARGUMENT);if(q==null)throw new Error(Lt.NULL_ARGUMENT);var lt=this._map.get(Et);lt!==void 0?(lt.push(q),this._map.set(Et,lt)):this._map.set(Et,[q])},I.prototype.get=function(Et){if(Et==null)throw new Error(Lt.NULL_ARGUMENT);var q=this._map.get(Et);if(q!==void 0)return q;throw new Error(Lt.KEY_NOT_FOUND)},I.prototype.remove=function(Et){if(Et==null)throw new Error(Lt.NULL_ARGUMENT);if(!this._map.delete(Et))throw new Error(Lt.KEY_NOT_FOUND)},I.prototype.removeByCondition=function(Et){var q=this;this._map.forEach(function(lt,ht){var ct=lt.filter(function(et){return!Et(et)});ct.length>0?q._map.set(ht,ct):q._map.delete(ht)})},I.prototype.hasKey=function(Et){if(Et==null)throw new Error(Lt.NULL_ARGUMENT);return this._map.has(Et)},I.prototype.clone=function(){var Et=new I;return this._map.forEach(function(q,lt){q.forEach(function(ht){return Et.add(lt,ht.clone())})}),Et},I.prototype.traverse=function(Et){this._map.forEach(function(q,lt){Et(lt,q)})},I}();Ft.Lookup=wt},86700:function(vn,Ft,ot){"use strict";var Lt;Lt={value:!0},Lt=Lt=Lt=Lt=Lt=Lt=Ft.GW=Lt=Lt=Ft.zY=Lt=Lt=Lt=Lt=Lt=Ft.f3=Lt=Lt=Ft.b2=Lt=Lt=Lt=Lt=Lt=Ft.W2=Lt=void 0;var wt=ot(6867);Lt=wt;var I=ot(51389);Object.defineProperty(Ft,"W2",{enumerable:!0,get:function(){return I.Container}});var Et=ot(28421);Lt={enumerable:!0,get:function(){return Et.BindingScopeEnum}},Lt={enumerable:!0,get:function(){return Et.BindingTypeEnum}},Lt={enumerable:!0,get:function(){return Et.TargetTypeEnum}};var q=ot(33244);Lt={enumerable:!0,get:function(){return q.AsyncContainerModule}},Lt={enumerable:!0,get:function(){return q.ContainerModule}};var lt=ot(64315);Object.defineProperty(Ft,"b2",{enumerable:!0,get:function(){return lt.injectable}});var ht=ot(32052);Lt={enumerable:!0,get:function(){return ht.tagged}};var ct=ot(38085);Lt={enumerable:!0,get:function(){return ct.named}};var et=ot(5744);Object.defineProperty(Ft,"f3",{enumerable:!0,get:function(){return et.inject}}),Lt={enumerable:!0,get:function(){return et.LazyServiceIdentifer}};var Ee=ot(6515);Lt={enumerable:!0,get:function(){return Ee.optional}};var it=ot(86757);Lt={enumerable:!0,get:function(){return it.unmanaged}};var st=ot(71693);Lt={enumerable:!0,get:function(){return st.multiInject}};var Zt=ot(55638);Lt={enumerable:!0,get:function(){return Zt.targetName}};var P=ot(7014);Object.defineProperty(Ft,"zY",{enumerable:!0,get:function(){return P.postConstruct}});var b=ot(51377);Lt={enumerable:!0,get:function(){return b.MetadataReader}};var X=ot(37791);Lt={enumerable:!0,get:function(){return X.id}};var le=ot(99934);Object.defineProperty(Ft,"GW",{enumerable:!0,get:function(){return le.decorate}});var Se=ot(80758);Lt={enumerable:!0,get:function(){return Se.traverseAncerstors}},Lt={enumerable:!0,get:function(){return Se.taggedConstraint}},Lt={enumerable:!0,get:function(){return Se.namedConstraint}},Lt={enumerable:!0,get:function(){return Se.typeConstraint}};var Ie=ot(55800);Lt={enumerable:!0,get:function(){return Ie.getServiceIdentifierAsString}};var It=ot(70600);Lt={enumerable:!0,get:function(){return It.multiBindToService}}},95228:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Context=void 0;var Lt=ot(37791),wt=function(){function I(Et){this.id=Lt.id(),this.container=Et}return I.prototype.addPlan=function(Et){this.plan=Et},I.prototype.setCurrentRequest=function(Et){this.currentRequest=Et},I}();Ft.Context=wt},47738:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Metadata=void 0;var Lt=ot(6867),wt=function(){function I(Et,q){this.key=Et,this.value=q}return I.prototype.toString=function(){return this.key===Lt.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},I}();Ft.Metadata=wt},51377:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.MetadataReader=void 0;var Lt=ot(6867),wt=function(){function I(){}return I.prototype.getConstructorMetadata=function(Et){var q=Reflect.getMetadata(Lt.PARAM_TYPES,Et),lt=Reflect.getMetadata(Lt.TAGGED,Et);return{compilerGeneratedMetadata:q,userGeneratedMetadata:lt||{}}},I.prototype.getPropertiesMetadata=function(Et){var q=Reflect.getMetadata(Lt.TAGGED_PROP,Et)||[];return q},I}();Ft.MetadataReader=wt},55314:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Plan=void 0;var ot=function(){function Lt(wt,I){this.parentContext=wt,this.rootRequest=I}return Lt}();Ft.Plan=ot},86311:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.getBindingDictionary=Ft.createMockRequest=Ft.plan=void 0;var Lt=ot(23184),wt=ot(16674),I=ot(28421),Et=ot(6867),q=ot(85265),lt=ot(55800),ht=ot(95228),ct=ot(47738),et=ot(55314),Ee=ot(6e3),it=ot(6748),st=ot(18924);function Zt(rt){return rt._bindingDictionary}Ft.getBindingDictionary=Zt;function P(rt,Dt,Ae,be,me,ee){var we=rt?Et.MULTI_INJECT_TAG:Et.INJECT_TAG,_e=new ct.Metadata(we,Ae),gt=new st.Target(Dt,be,Ae,_e);if(me!==void 0){var Pt=new ct.Metadata(me,ee);gt.metadata.push(Pt)}return gt}function b(rt,Dt,Ae,be,me){var ee=Se(Ae.container,me.serviceIdentifier),we=[];return ee.length===Lt.BindingCount.NoBindingsAvailable&&Ae.container.options.autoBindInjectable&&typeof me.serviceIdentifier=="function"&&rt.getConstructorMetadata(me.serviceIdentifier).compilerGeneratedMetadata&&(Ae.container.bind(me.serviceIdentifier).toSelf(),ee=Se(Ae.container,me.serviceIdentifier)),Dt?we=ee:we=ee.filter(function(_e){var gt=new it.Request(_e.serviceIdentifier,Ae,be,_e,me);return _e.constraint(gt)}),X(me.serviceIdentifier,we,me,Ae.container),we}function X(rt,Dt,Ae,be){switch(Dt.length){case Lt.BindingCount.NoBindingsAvailable:if(Ae.isOptional())return Dt;var me=lt.getServiceIdentifierAsString(rt),ee=wt.NOT_REGISTERED;throw ee+=lt.listMetadataForTarget(me,Ae),ee+=lt.listRegisteredBindingsForServiceIdentifier(be,me,Se),new Error(ee);case Lt.BindingCount.OnlyOneBindingAvailable:if(!Ae.isArray())return Dt;case Lt.BindingCount.MultipleBindingsAvailable:default:if(Ae.isArray())return Dt;var me=lt.getServiceIdentifierAsString(rt),ee=wt.AMBIGUOUS_MATCH+" "+me;throw ee+=lt.listRegisteredBindingsForServiceIdentifier(be,me,Se),new Error(ee)}}function le(rt,Dt,Ae,be,me,ee){var we,_e;if(me===null){we=b(rt,Dt,be,null,ee),_e=new it.Request(Ae,be,null,we,ee);var gt=new et.Plan(be,_e);be.addPlan(gt)}else we=b(rt,Dt,be,me,ee),_e=me.addChildRequest(ee.serviceIdentifier,we,ee);we.forEach(function(Pt){var J=null;if(ee.isArray())J=_e.addChildRequest(Pt.serviceIdentifier,Pt,ee);else{if(Pt.cache)return;J=_e}if(Pt.type===I.BindingTypeEnum.Instance&&Pt.implementationType!==null){var vt=Ee.getDependencies(rt,Pt.implementationType);if(!be.container.options.skipBaseClassChecks){var W=Ee.getBaseClassDependencyCount(rt,Pt.implementationType);if(vt.length<W){var dt=wt.ARGUMENTS_LENGTH_MISMATCH(Ee.getFunctionName(Pt.implementationType));throw new Error(dt)}}vt.forEach(function(Vt){le(rt,!1,Vt.serviceIdentifier,be,J,Vt)})}})}function Se(rt,Dt){var Ae=[],be=Zt(rt);return be.hasKey(Dt)?Ae=be.get(Dt):rt.parent!==null&&(Ae=Se(rt.parent,Dt)),Ae}function Ie(rt,Dt,Ae,be,me,ee,we,_e){_e===void 0&&(_e=!1);var gt=new ht.Context(Dt),Pt=P(Ae,be,me,"",ee,we);try{return le(rt,_e,me,gt,null,Pt),gt}catch(J){throw q.isStackOverflowExeption(J)&&gt.plan&&lt.circularDependencyToException(gt.plan.rootRequest),J}}Ft.plan=Ie;function It(rt,Dt,Ae,be){var me=new st.Target(I.TargetTypeEnum.Variable,"",Dt,new ct.Metadata(Ae,be)),ee=new ht.Context(rt),we=new it.Request(Dt,ee,null,[],me);return we}Ft.createMockRequest=It},88460:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.QueryableString=void 0;var ot=function(){function Lt(wt){this.str=wt}return Lt.prototype.startsWith=function(wt){return this.str.indexOf(wt)===0},Lt.prototype.endsWith=function(wt){var I="",Et=wt.split("").reverse().join("");return I=this.str.split("").reverse().join(""),this.startsWith.call({str:I},Et)},Lt.prototype.contains=function(wt){return this.str.indexOf(wt)!==-1},Lt.prototype.equals=function(wt){return this.str===wt},Lt.prototype.value=function(){return this.str},Lt}();Ft.QueryableString=ot},6e3:function(vn,Ft,ot){"use strict";var Lt=this&&this.__spreadArray||function(b,X){for(var le=0,Se=X.length,Ie=b.length;le<Se;le++,Ie++)b[Ie]=X[le];return b};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.getFunctionName=Ft.getBaseClassDependencyCount=Ft.getDependencies=void 0;var wt=ot(5744),I=ot(16674),Et=ot(28421),q=ot(6867),lt=ot(55800);Object.defineProperty(Ft,"getFunctionName",{enumerable:!0,get:function(){return lt.getFunctionName}});var ht=ot(18924);function ct(b,X){var le=lt.getFunctionName(X),Se=et(b,le,X,!1);return Se}Ft.getDependencies=ct;function et(b,X,le,Se){var Ie=b.getConstructorMetadata(le),It=Ie.compilerGeneratedMetadata;if(It===void 0){var rt=I.MISSING_INJECTABLE_ANNOTATION+" "+X+".";throw new Error(rt)}var Dt=Ie.userGeneratedMetadata,Ae=Object.keys(Dt),be=le.length===0&&Ae.length>0,me=Ae.length>le.length,ee=be||me?Ae.length:le.length,we=it(Se,X,It,Dt,ee),_e=st(b,le),gt=Lt(Lt([],we),_e);return gt}function Ee(b,X,le,Se,Ie){var It=Ie[b.toString()]||[],rt=P(It),Dt=rt.unmanaged!==!0,Ae=Se[b],be=rt.inject||rt.multiInject;if(Ae=be||Ae,Ae instanceof wt.LazyServiceIdentifer&&(Ae=Ae.unwrap()),Dt){var me=Ae===Object,ee=Ae===Function,we=Ae===void 0,_e=me||ee||we;if(!X&&_e){var gt=I.MISSING_INJECT_ANNOTATION+" argument "+b+" in class "+le+".";throw new Error(gt)}var Pt=new ht.Target(Et.TargetTypeEnum.ConstructorArgument,rt.targetName,Ae);return Pt.metadata=It,Pt}return null}function it(b,X,le,Se,Ie){for(var It=[],rt=0;rt<Ie;rt++){var Dt=rt,Ae=Ee(Dt,b,X,le,Se);Ae!==null&&It.push(Ae)}return It}function st(b,X){for(var le=b.getPropertiesMetadata(X),Se=[],Ie=Object.keys(le),It=0,rt=Ie;It<rt.length;It++){var Dt=rt[It],Ae=le[Dt],be=P(le[Dt]),me=be.targetName||Dt,ee=be.inject||be.multiInject,we=new ht.Target(Et.TargetTypeEnum.ClassProperty,me,ee);we.metadata=Ae,Se.push(we)}var _e=Object.getPrototypeOf(X.prototype).constructor;if(_e!==Object){var gt=st(b,_e);Se=Lt(Lt([],Se),gt)}return Se}function Zt(b,X){var le=Object.getPrototypeOf(X.prototype).constructor;if(le!==Object){var Se=lt.getFunctionName(le),Ie=et(b,Se,le,!0),It=Ie.map(function(Ae){return Ae.metadata.filter(function(be){return be.key===q.UNMANAGED_TAG})}),rt=[].concat.apply([],It).length,Dt=Ie.length-rt;return Dt>0?Dt:Zt(b,le)}else return 0}Ft.getBaseClassDependencyCount=Zt;function P(b){var X={};return b.forEach(function(le){X[le.key.toString()]=le.value}),{inject:X[q.INJECT_TAG],multiInject:X[q.MULTI_INJECT_TAG],targetName:X[q.NAME_TAG],unmanaged:X[q.UNMANAGED_TAG]}}},6748:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Request=void 0;var Lt=ot(37791),wt=function(){function I(Et,q,lt,ht,ct){this.id=Lt.id(),this.serviceIdentifier=Et,this.parentContext=q,this.parentRequest=lt,this.target=ct,this.childRequests=[],this.bindings=Array.isArray(ht)?ht:[ht],this.requestScope=lt===null?new Map:null}return I.prototype.addChildRequest=function(Et,q,lt){var ht=new I(Et,this.parentContext,this,q,lt);return this.childRequests.push(ht),ht},I}();Ft.Request=wt},18924:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Target=void 0;var Lt=ot(6867),wt=ot(37791),I=ot(47738),Et=ot(88460),q=function(){function lt(ht,ct,et,Ee){this.id=wt.id(),this.type=ht,this.serviceIdentifier=et,this.name=new Et.QueryableString(ct||""),this.metadata=new Array;var it=null;typeof Ee=="string"?it=new I.Metadata(Lt.NAMED_TAG,Ee):Ee instanceof I.Metadata&&(it=Ee),it!==null&&this.metadata.push(it)}return lt.prototype.hasTag=function(ht){for(var ct=0,et=this.metadata;ct<et.length;ct++){var Ee=et[ct];if(Ee.key===ht)return!0}return!1},lt.prototype.isArray=function(){return this.hasTag(Lt.MULTI_INJECT_TAG)},lt.prototype.matchesArray=function(ht){return this.matchesTag(Lt.MULTI_INJECT_TAG)(ht)},lt.prototype.isNamed=function(){return this.hasTag(Lt.NAMED_TAG)},lt.prototype.isTagged=function(){return this.metadata.some(function(ht){return Lt.NON_CUSTOM_TAG_KEYS.every(function(ct){return ht.key!==ct})})},lt.prototype.isOptional=function(){return this.matchesTag(Lt.OPTIONAL_TAG)(!0)},lt.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(ht){return ht.key===Lt.NAMED_TAG})[0]:null},lt.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(ht){return Lt.NON_CUSTOM_TAG_KEYS.every(function(ct){return ht.key!==ct})}):null},lt.prototype.matchesNamedTag=function(ht){return this.matchesTag(Lt.NAMED_TAG)(ht)},lt.prototype.matchesTag=function(ht){var ct=this;return function(et){for(var Ee=0,it=ct.metadata;Ee<it.length;Ee++){var st=it[Ee];if(st.key===ht&&st.value===et)return!0}return!1}},lt}();Ft.Target=q},52279:function(vn,Ft,ot){"use strict";var Lt=this&&this.__spreadArray||function(et,Ee){for(var it=0,st=Ee.length,Zt=et.length;it<st;it++,Zt++)et[Zt]=Ee[it];return et};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.resolveInstance=void 0;var wt=ot(16674),I=ot(28421),Et=ot(6867);function q(et,Ee,it){var st=Ee.filter(function(P){return P.target!==null&&P.target.type===I.TargetTypeEnum.ClassProperty}),Zt=st.map(it);return st.forEach(function(P,b){var X="";X=P.target.name.value();var le=Zt[b];et[X]=le}),et}function lt(et,Ee){return new(et.bind.apply(et,Lt([void 0],Ee)))}function ht(et,Ee){if(Reflect.hasMetadata(Et.POST_CONSTRUCT,et)){var it=Reflect.getMetadata(Et.POST_CONSTRUCT,et);try{Ee[it.value]()}catch(st){throw new Error(wt.POST_CONSTRUCT_ERROR(et.name,st.message))}}}function ct(et,Ee,it){var st=null;if(Ee.length>0){var Zt=Ee.filter(function(b){return b.target!==null&&b.target.type===I.TargetTypeEnum.ConstructorArgument}),P=Zt.map(it);st=lt(et,P),st=q(st,Ee,it)}else st=new et;return ht(et,st),st}Ft.resolveInstance=ct},31927:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.resolve=void 0;var Lt=ot(16674),wt=ot(28421),I=ot(85265),Et=ot(55800),q=ot(52279),lt=function(et,Ee,it){try{return it()}catch(st){throw I.isStackOverflowExeption(st)?new Error(Lt.CIRCULAR_DEPENDENCY_IN_FACTORY(et,Ee.toString())):st}},ht=function(et){return function(Ee){Ee.parentContext.setCurrentRequest(Ee);var it=Ee.bindings,st=Ee.childRequests,Zt=Ee.target&&Ee.target.isArray(),P=!Ee.parentRequest||!Ee.parentRequest.target||!Ee.target||!Ee.parentRequest.target.matchesArray(Ee.target.serviceIdentifier);if(Zt&&P)return st.map(function(It){var rt=ht(et);return rt(It)});var b=null;if(Ee.target.isOptional()&&it.length===0)return;var X=it[0],le=X.scope===wt.BindingScopeEnum.Singleton,Se=X.scope===wt.BindingScopeEnum.Request;if(le&&X.activated)return X.cache;if(Se&&et!==null&&et.has(X.id))return et.get(X.id);if(X.type===wt.BindingTypeEnum.ConstantValue)b=X.cache,X.activated=!0;else if(X.type===wt.BindingTypeEnum.Function)b=X.cache,X.activated=!0;else if(X.type===wt.BindingTypeEnum.Constructor)b=X.implementationType;else if(X.type===wt.BindingTypeEnum.DynamicValue&&X.dynamicValue!==null)b=lt("toDynamicValue",X.serviceIdentifier,function(){return X.dynamicValue(Ee.parentContext)});else if(X.type===wt.BindingTypeEnum.Factory&&X.factory!==null)b=lt("toFactory",X.serviceIdentifier,function(){return X.factory(Ee.parentContext)});else if(X.type===wt.BindingTypeEnum.Provider&&X.provider!==null)b=lt("toProvider",X.serviceIdentifier,function(){return X.provider(Ee.parentContext)});else if(X.type===wt.BindingTypeEnum.Instance&&X.implementationType!==null)b=q.resolveInstance(X.implementationType,st,ht(et));else{var Ie=Et.getServiceIdentifierAsString(Ee.serviceIdentifier);throw new Error(Lt.INVALID_BINDING_TYPE+" "+Ie)}return typeof X.onActivation=="function"&&(b=X.onActivation(Ee.parentContext,b)),le&&(X.cache=b,X.activated=!0),Se&&et!==null&&!et.has(X.id)&&et.set(X.id,b),b}};function ct(et){var Ee=ht(et.plan.rootRequest.requestScope);return Ee(et.plan.rootRequest)}Ft.resolve=ct},83366:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingInSyntax=void 0;var Lt=ot(28421),wt=ot(71325),I=function(){function Et(q){this._binding=q}return Et.prototype.inRequestScope=function(){return this._binding.scope=Lt.BindingScopeEnum.Request,new wt.BindingWhenOnSyntax(this._binding)},Et.prototype.inSingletonScope=function(){return this._binding.scope=Lt.BindingScopeEnum.Singleton,new wt.BindingWhenOnSyntax(this._binding)},Et.prototype.inTransientScope=function(){return this._binding.scope=Lt.BindingScopeEnum.Transient,new wt.BindingWhenOnSyntax(this._binding)},Et}();Ft.BindingInSyntax=I},99812:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingInWhenOnSyntax=void 0;var Lt=ot(83366),wt=ot(51811),I=ot(98370),Et=function(){function q(lt){this._binding=lt,this._bindingWhenSyntax=new I.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new wt.BindingOnSyntax(this._binding),this._bindingInSyntax=new Lt.BindingInSyntax(lt)}return q.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},q.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},q.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},q.prototype.when=function(lt){return this._bindingWhenSyntax.when(lt)},q.prototype.whenTargetNamed=function(lt){return this._bindingWhenSyntax.whenTargetNamed(lt)},q.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},q.prototype.whenTargetTagged=function(lt,ht){return this._bindingWhenSyntax.whenTargetTagged(lt,ht)},q.prototype.whenInjectedInto=function(lt){return this._bindingWhenSyntax.whenInjectedInto(lt)},q.prototype.whenParentNamed=function(lt){return this._bindingWhenSyntax.whenParentNamed(lt)},q.prototype.whenParentTagged=function(lt,ht){return this._bindingWhenSyntax.whenParentTagged(lt,ht)},q.prototype.whenAnyAncestorIs=function(lt){return this._bindingWhenSyntax.whenAnyAncestorIs(lt)},q.prototype.whenNoAncestorIs=function(lt){return this._bindingWhenSyntax.whenNoAncestorIs(lt)},q.prototype.whenAnyAncestorNamed=function(lt){return this._bindingWhenSyntax.whenAnyAncestorNamed(lt)},q.prototype.whenAnyAncestorTagged=function(lt,ht){return this._bindingWhenSyntax.whenAnyAncestorTagged(lt,ht)},q.prototype.whenNoAncestorNamed=function(lt){return this._bindingWhenSyntax.whenNoAncestorNamed(lt)},q.prototype.whenNoAncestorTagged=function(lt,ht){return this._bindingWhenSyntax.whenNoAncestorTagged(lt,ht)},q.prototype.whenAnyAncestorMatches=function(lt){return this._bindingWhenSyntax.whenAnyAncestorMatches(lt)},q.prototype.whenNoAncestorMatches=function(lt){return this._bindingWhenSyntax.whenNoAncestorMatches(lt)},q.prototype.onActivation=function(lt){return this._bindingOnSyntax.onActivation(lt)},q}();Ft.BindingInWhenOnSyntax=Et},51811:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingOnSyntax=void 0;var Lt=ot(98370),wt=function(){function I(Et){this._binding=Et}return I.prototype.onActivation=function(Et){return this._binding.onActivation=Et,new Lt.BindingWhenSyntax(this._binding)},I}();Ft.BindingOnSyntax=wt},51860:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingToSyntax=void 0;var Lt=ot(16674),wt=ot(28421),I=ot(99812),Et=ot(71325),q=function(){function lt(ht){this._binding=ht}return lt.prototype.to=function(ht){return this._binding.type=wt.BindingTypeEnum.Instance,this._binding.implementationType=ht,new I.BindingInWhenOnSyntax(this._binding)},lt.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+Lt.INVALID_TO_SELF_VALUE);var ht=this._binding.serviceIdentifier;return this.to(ht)},lt.prototype.toConstantValue=function(ht){return this._binding.type=wt.BindingTypeEnum.ConstantValue,this._binding.cache=ht,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=wt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},lt.prototype.toDynamicValue=function(ht){return this._binding.type=wt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=ht,this._binding.implementationType=null,new I.BindingInWhenOnSyntax(this._binding)},lt.prototype.toConstructor=function(ht){return this._binding.type=wt.BindingTypeEnum.Constructor,this._binding.implementationType=ht,this._binding.scope=wt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},lt.prototype.toFactory=function(ht){return this._binding.type=wt.BindingTypeEnum.Factory,this._binding.factory=ht,this._binding.scope=wt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},lt.prototype.toFunction=function(ht){if(typeof ht!="function")throw new Error(Lt.INVALID_FUNCTION_BINDING);var ct=this.toConstantValue(ht);return this._binding.type=wt.BindingTypeEnum.Function,this._binding.scope=wt.BindingScopeEnum.Singleton,ct},lt.prototype.toAutoFactory=function(ht){return this._binding.type=wt.BindingTypeEnum.Factory,this._binding.factory=function(ct){var et=function(){return ct.container.get(ht)};return et},this._binding.scope=wt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},lt.prototype.toProvider=function(ht){return this._binding.type=wt.BindingTypeEnum.Provider,this._binding.provider=ht,this._binding.scope=wt.BindingScopeEnum.Singleton,new Et.BindingWhenOnSyntax(this._binding)},lt.prototype.toService=function(ht){this.toDynamicValue(function(ct){return ct.container.get(ht)})},lt}();Ft.BindingToSyntax=q},71325:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingWhenOnSyntax=void 0;var Lt=ot(51811),wt=ot(98370),I=function(){function Et(q){this._binding=q,this._bindingWhenSyntax=new wt.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Lt.BindingOnSyntax(this._binding)}return Et.prototype.when=function(q){return this._bindingWhenSyntax.when(q)},Et.prototype.whenTargetNamed=function(q){return this._bindingWhenSyntax.whenTargetNamed(q)},Et.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},Et.prototype.whenTargetTagged=function(q,lt){return this._bindingWhenSyntax.whenTargetTagged(q,lt)},Et.prototype.whenInjectedInto=function(q){return this._bindingWhenSyntax.whenInjectedInto(q)},Et.prototype.whenParentNamed=function(q){return this._bindingWhenSyntax.whenParentNamed(q)},Et.prototype.whenParentTagged=function(q,lt){return this._bindingWhenSyntax.whenParentTagged(q,lt)},Et.prototype.whenAnyAncestorIs=function(q){return this._bindingWhenSyntax.whenAnyAncestorIs(q)},Et.prototype.whenNoAncestorIs=function(q){return this._bindingWhenSyntax.whenNoAncestorIs(q)},Et.prototype.whenAnyAncestorNamed=function(q){return this._bindingWhenSyntax.whenAnyAncestorNamed(q)},Et.prototype.whenAnyAncestorTagged=function(q,lt){return this._bindingWhenSyntax.whenAnyAncestorTagged(q,lt)},Et.prototype.whenNoAncestorNamed=function(q){return this._bindingWhenSyntax.whenNoAncestorNamed(q)},Et.prototype.whenNoAncestorTagged=function(q,lt){return this._bindingWhenSyntax.whenNoAncestorTagged(q,lt)},Et.prototype.whenAnyAncestorMatches=function(q){return this._bindingWhenSyntax.whenAnyAncestorMatches(q)},Et.prototype.whenNoAncestorMatches=function(q){return this._bindingWhenSyntax.whenNoAncestorMatches(q)},Et.prototype.onActivation=function(q){return this._bindingOnSyntax.onActivation(q)},Et}();Ft.BindingWhenOnSyntax=I},98370:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.BindingWhenSyntax=void 0;var Lt=ot(51811),wt=ot(80758),I=function(){function Et(q){this._binding=q}return Et.prototype.when=function(q){return this._binding.constraint=q,new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenTargetNamed=function(q){return this._binding.constraint=wt.namedConstraint(q),new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(q){var lt=q.target!==null&&!q.target.isNamed()&&!q.target.isTagged();return lt},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenTargetTagged=function(q,lt){return this._binding.constraint=wt.taggedConstraint(q)(lt),new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenInjectedInto=function(q){return this._binding.constraint=function(lt){return wt.typeConstraint(q)(lt.parentRequest)},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenParentNamed=function(q){return this._binding.constraint=function(lt){return wt.namedConstraint(q)(lt.parentRequest)},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenParentTagged=function(q,lt){return this._binding.constraint=function(ht){return wt.taggedConstraint(q)(lt)(ht.parentRequest)},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorIs=function(q){return this._binding.constraint=function(lt){return wt.traverseAncerstors(lt,wt.typeConstraint(q))},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorIs=function(q){return this._binding.constraint=function(lt){return!wt.traverseAncerstors(lt,wt.typeConstraint(q))},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorNamed=function(q){return this._binding.constraint=function(lt){return wt.traverseAncerstors(lt,wt.namedConstraint(q))},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorNamed=function(q){return this._binding.constraint=function(lt){return!wt.traverseAncerstors(lt,wt.namedConstraint(q))},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorTagged=function(q,lt){return this._binding.constraint=function(ht){return wt.traverseAncerstors(ht,wt.taggedConstraint(q)(lt))},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorTagged=function(q,lt){return this._binding.constraint=function(ht){return!wt.traverseAncerstors(ht,wt.taggedConstraint(q)(lt))},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenAnyAncestorMatches=function(q){return this._binding.constraint=function(lt){return wt.traverseAncerstors(lt,q)},new Lt.BindingOnSyntax(this._binding)},Et.prototype.whenNoAncestorMatches=function(q){return this._binding.constraint=function(lt){return!wt.traverseAncerstors(lt,q)},new Lt.BindingOnSyntax(this._binding)},Et}();Ft.BindingWhenSyntax=I},80758:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.typeConstraint=Ft.namedConstraint=Ft.taggedConstraint=Ft.traverseAncerstors=void 0;var Lt=ot(6867),wt=ot(47738),I=function(ht,ct){var et=ht.parentRequest;return et!==null?ct(et)?!0:I(et,ct):!1};Ft.traverseAncerstors=I;var Et=function(ht){return function(ct){var et=function(Ee){return Ee!==null&&Ee.target!==null&&Ee.target.matchesTag(ht)(ct)};return et.metaData=new wt.Metadata(ht,ct),et}};Ft.taggedConstraint=Et;var q=Et(Lt.NAMED_TAG);Ft.namedConstraint=q;var lt=function(ht){return function(ct){var et=null;if(ct!==null)if(et=ct.bindings[0],typeof ht=="string"){var Ee=et.serviceIdentifier;return Ee===ht}else{var it=ct.bindings[0].implementationType;return ht===it}return!1}};Ft.typeConstraint=lt},70600:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.multiBindToService=void 0;var ot=function(Lt){return function(wt){return function(){for(var I=[],Et=0;Et<arguments.length;Et++)I[Et]=arguments[Et];return I.forEach(function(q){return Lt.bind(q).toService(wt)})}}};Ft.multiBindToService=ot},85265:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.isStackOverflowExeption=void 0;var Lt=ot(16674);function wt(I){return I instanceof RangeError||I.message===Lt.STACK_OVERFLOW}Ft.isStackOverflowExeption=wt},37791:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.id=void 0;var ot=0;function Lt(){return ot++}Ft.id=Lt},55800:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.circularDependencyToException=Ft.listMetadataForTarget=Ft.listRegisteredBindingsForServiceIdentifier=Ft.getServiceIdentifierAsString=Ft.getFunctionName=void 0;var Lt=ot(16674);function wt(et){if(typeof et=="function"){var Ee=et;return Ee.name}else{if(typeof et=="symbol")return et.toString();var Ee=et;return Ee}}Ft.getServiceIdentifierAsString=wt;function I(et,Ee,it){var st="",Zt=it(et,Ee);return Zt.length!==0&&(st=`
Registered bindings:`,Zt.forEach(function(P){var b="Object";P.implementationType!==null&&(b=ct(P.implementationType)),st=st+`
 `+b,P.constraint.metaData&&(st=st+" - "+P.constraint.metaData)})),st}Ft.listRegisteredBindingsForServiceIdentifier=I;function Et(et,Ee){return et.parentRequest===null?!1:et.parentRequest.serviceIdentifier===Ee?!0:Et(et.parentRequest,Ee)}function q(et){function Ee(st,Zt){Zt===void 0&&(Zt=[]);var P=wt(st.serviceIdentifier);return Zt.push(P),st.parentRequest!==null?Ee(st.parentRequest,Zt):Zt}var it=Ee(et);return it.reverse().join(" --> ")}function lt(et){et.childRequests.forEach(function(Ee){if(Et(Ee,Ee.serviceIdentifier)){var it=q(Ee);throw new Error(Lt.CIRCULAR_DEPENDENCY+" "+it)}else lt(Ee)})}Ft.circularDependencyToException=lt;function ht(et,Ee){if(Ee.isTagged()||Ee.isNamed()){var it="",st=Ee.getNamedTag(),Zt=Ee.getCustomTags();return st!==null&&(it+=st.toString()+`
`),Zt!==null&&Zt.forEach(function(P){it+=P.toString()+`
`})," "+et+`
 `+et+" - "+it}else return" "+et}Ft.listMetadataForTarget=ht;function ct(et){if(et.name)return et.name;var Ee=et.toString(),it=Ee.match(/^function\s*([^\s(]+)/);return it?it[1]:"Anonymous function: "+Ee}Ft.getFunctionName=ct},31745:function(vn){"use strict";vn.exports=ot,vn.exports.default=ot;var Ft=1e20;function ot(q,lt,ht,ct,et,Ee){this.fontSize=q||24,this.buffer=lt===void 0?3:lt,this.cutoff=ct||.25,this.fontFamily=et||"sans-serif",this.fontWeight=Ee||"normal",this.radius=ht||8;var it=this.size=this.fontSize+this.buffer*2,st=it+this.buffer*2,Zt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;Zt?this.canvas=my.createOffscreenCanvas(it,it,"2d"):(this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=it),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(st*st),this.gridInner=new Float64Array(st*st),this.f=new Float64Array(st),this.z=new Float64Array(st+1),this.v=new Uint16Array(st),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,Zt?this.middle=Math.round(it/2*1):this.middle=Math.round(it/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Lt(q,lt,ht,ct,et,Ee,it){Ee.fill(Ft,0,lt*ht),it.fill(0,0,lt*ht);for(var st=(lt-ct)/2,Zt=0;Zt<et;Zt++)for(var P=0;P<ct;P++){var b=(Zt+st)*lt+P+st,X=q.data[4*(Zt*ct+P)+3]/255;if(X===1)Ee[b]=0,it[b]=Ft;else if(X===0)Ee[b]=Ft,it[b]=0;else{var le=Math.max(0,.5-X),Se=Math.max(0,X-.5);Ee[b]=le*le,it[b]=Se*Se}}}function wt(q,lt,ht,ct,et,Ee,it){for(var st=0;st<lt*ht;st++){var Zt=Math.sqrt(ct[st])-Math.sqrt(et[st]);q[st]=Math.round(255-255*(Zt/Ee+it))}}ot.prototype._draw=function(q,lt){var ht=this.ctx.measureText(q),ct=ht.width,et=2*this.buffer,Ee,it,st,Zt,P,b,X,le;lt&&this.useMetrics?(P=Math.floor(ht.actualBoundingBoxAscent),le=this.buffer+Math.ceil(ht.actualBoundingBoxAscent),b=this.buffer,X=this.buffer,it=Math.min(this.size,Math.ceil(ht.actualBoundingBoxRight-ht.actualBoundingBoxLeft)),Zt=Math.min(this.size-b,Math.ceil(ht.actualBoundingBoxAscent+ht.actualBoundingBoxDescent)),Ee=it+et,st=Zt+et,this.ctx.textBaseline="alphabetic"):(Ee=it=this.size,st=Zt=this.size,P=19*this.fontSize/24,b=X=0,le=this.middle,this.ctx.textBaseline="middle");var Se;it&&Zt&&(this.ctx.clearRect(X,b,it,Zt),this.ctx.fillText(q,this.buffer,le),Se=this.ctx.getImageData(X,b,it,Zt));var Ie=new Uint8ClampedArray(Ee*st);return Lt(Se,Ee,st,it,Zt,this.gridOuter,this.gridInner),I(this.gridOuter,Ee,st,this.f,this.v,this.z),I(this.gridInner,Ee,st,this.f,this.v,this.z),wt(Ie,Ee,st,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Ie,metrics:{width:it,height:Zt,sdfWidth:Ee,sdfHeight:st,top:P,left:0,advance:ct}}},ot.prototype.draw=function(q){return this._draw(q,!1).data},ot.prototype.drawWithMetrics=function(q){return this._draw(q,!0)};function I(q,lt,ht,ct,et,Ee){for(var it=0;it<lt;it++)Et(q,it,lt,ht,ct,et,Ee);for(var st=0;st<ht;st++)Et(q,st*lt,1,lt,ct,et,Ee)}function Et(q,lt,ht,ct,et,Ee,it){var st,Zt,P,b;for(Ee[0]=0,it[0]=-Ft,it[1]=Ft,st=0;st<ct;st++)et[st]=q[lt+st*ht];for(st=1,Zt=0,P=0;st<ct;st++){do b=Ee[Zt],P=(et[st]-et[b]+st*st-b*b)/(st-b)/2;while(P<=it[Zt]&&--Zt>-1);Zt++,Ee[Zt]=st,it[Zt]=P,it[Zt+1]=Ft}for(st=0,Zt=0;st<ct;st++){for(;it[Zt+1]<st;)Zt++;b=Ee[Zt],q[lt+st*ht]=et[b]+(st-b)*(st-b)}}},12380:function(vn,Ft,ot){"use strict";ot.r(Ft),ot.d(Ft,{Function:function(){return nl},Interpreter:function(){return rs},default:function(){return uc},evaluate:function(){return Xl},vm:function(){return Lt}});var Lt={};ot.r(Lt),ot.d(Lt,{Script:function(){return sc},compileFunction:function(){return _u},createContext:function(){return Uc},runInContext:function(){return Zc},runInNewContext:function(){return Co}});var wt={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},I="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",Et={5:I,"5module":I+" export import",6:I+" const class extends export import super"},q=/^in(stanceof)?$/,lt="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08C7\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\u9FFC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",ht="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF\u1AC0\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F",ct=new RegExp("["+lt+"]"),et=new RegExp("["+lt+ht+"]");lt=ht=null;var Ee=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],it=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function st(D,Y){for(var bt=65536,nt=0;nt<Y.length;nt+=2){if(bt+=Y[nt],bt>D)return!1;if(bt+=Y[nt+1],bt>=D)return!0}}function Zt(D,Y){return D<65?D===36:D<91?!0:D<97?D===95:D<123?!0:D<=65535?D>=170&&ct.test(String.fromCharCode(D)):Y===!1?!1:st(D,Ee)}function P(D,Y){return D<48?D===36:D<58?!0:D<65?!1:D<91?!0:D<97?D===95:D<123?!0:D<=65535?D>=170&&et.test(String.fromCharCode(D)):Y===!1?!1:st(D,Ee)||st(D,it)}var b=function(Y,bt){bt===void 0&&(bt={}),this.label=Y,this.keyword=bt.keyword,this.beforeExpr=!!bt.beforeExpr,this.startsExpr=!!bt.startsExpr,this.isLoop=!!bt.isLoop,this.isAssign=!!bt.isAssign,this.prefix=!!bt.prefix,this.postfix=!!bt.postfix,this.binop=bt.binop||null,this.updateContext=null};function X(D,Y){return new b(D,{beforeExpr:!0,binop:Y})}var le={beforeExpr:!0},Se={startsExpr:!0},Ie={};function It(D,Y){return Y===void 0&&(Y={}),Y.keyword=D,Ie[D]=new b(D,Y)}var rt={num:new b("num",Se),regexp:new b("regexp",Se),string:new b("string",Se),name:new b("name",Se),eof:new b("eof"),bracketL:new b("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new b("]"),braceL:new b("{",{beforeExpr:!0,startsExpr:!0}),braceR:new b("}"),parenL:new b("(",{beforeExpr:!0,startsExpr:!0}),parenR:new b(")"),comma:new b(",",le),semi:new b(";",le),colon:new b(":",le),dot:new b("."),question:new b("?",le),questionDot:new b("?."),arrow:new b("=>",le),template:new b("template"),invalidTemplate:new b("invalidTemplate"),ellipsis:new b("...",le),backQuote:new b("`",Se),dollarBraceL:new b("${",{beforeExpr:!0,startsExpr:!0}),eq:new b("=",{beforeExpr:!0,isAssign:!0}),assign:new b("_=",{beforeExpr:!0,isAssign:!0}),incDec:new b("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new b("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:X("||",1),logicalAND:X("&&",2),bitwiseOR:X("|",3),bitwiseXOR:X("^",4),bitwiseAND:X("&",5),equality:X("==/!=/===/!==",6),relational:X("</>/<=/>=",7),bitShift:X("<</>>/>>>",8),plusMin:new b("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:X("%",10),star:X("*",10),slash:X("/",10),starstar:new b("**",{beforeExpr:!0}),coalesce:X("??",1),_break:It("break"),_case:It("case",le),_catch:It("catch"),_continue:It("continue"),_debugger:It("debugger"),_default:It("default",le),_do:It("do",{isLoop:!0,beforeExpr:!0}),_else:It("else",le),_finally:It("finally"),_for:It("for",{isLoop:!0}),_function:It("function",Se),_if:It("if"),_return:It("return",le),_switch:It("switch"),_throw:It("throw",le),_try:It("try"),_var:It("var"),_const:It("const"),_while:It("while",{isLoop:!0}),_with:It("with"),_new:It("new",{beforeExpr:!0,startsExpr:!0}),_this:It("this",Se),_super:It("super",Se),_class:It("class",Se),_extends:It("extends",le),_export:It("export"),_import:It("import",Se),_null:It("null",Se),_true:It("true",Se),_false:It("false",Se),_in:It("in",{beforeExpr:!0,binop:7}),_instanceof:It("instanceof",{beforeExpr:!0,binop:7}),_typeof:It("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:It("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:It("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Dt=/\r\n?|\n|\u2028|\u2029/,Ae=new RegExp(Dt.source,"g");function be(D,Y){return D===10||D===13||!Y&&(D===8232||D===8233)}var me=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,ee=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,we=Object.prototype,_e=we.hasOwnProperty,gt=we.toString;function Pt(D,Y){return _e.call(D,Y)}var J=Array.isArray||function(D){return gt.call(D)==="[object Array]"};function vt(D){return new RegExp("^(?:"+D.replace(/ /g,"|")+")$")}var W=function(Y,bt){this.line=Y,this.column=bt};W.prototype.offset=function(Y){return new W(this.line,this.column+Y)};var dt=function(Y,bt,nt){this.start=bt,this.end=nt,Y.sourceFile!==null&&(this.source=Y.sourceFile)};function Vt(D,Y){for(var bt=1,nt=0;;){Ae.lastIndex=nt;var se=Ae.exec(D);if(se&&se.index<Y)++bt,nt=se.index+se[0].length;else return new W(bt,Y-nt)}}var ne={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function ge(D){var Y={};for(var bt in ne)Y[bt]=D&&Pt(D,bt)?D[bt]:ne[bt];if(Y.ecmaVersion>=2015&&(Y.ecmaVersion-=2009),Y.allowReserved==null&&(Y.allowReserved=Y.ecmaVersion<5),J(Y.onToken)){var nt=Y.onToken;Y.onToken=function(se){return nt.push(se)}}return J(Y.onComment)&&(Y.onComment=$e(Y,Y.onComment)),Y}function $e(D,Y){return function(bt,nt,se,Ve,wr,jr){var Vr={type:bt?"Block":"Line",value:nt,start:se,end:Ve};D.locations&&(Vr.loc=new dt(this,wr,jr)),D.ranges&&(Vr.range=[se,Ve]),Y.push(Vr)}}var jt=1,Qt=2,Te=jt|Qt,ae=4,Ke=8,or=16,ie=32,te=64,St=128;function qt(D,Y){return Qt|(D?ae:0)|(Y?Ke:0)}var $t=0,Ct=1,Tt=2,ue=3,Oe=4,We=5,zt=function(Y,bt,nt){this.options=Y=ge(Y),this.sourceFile=Y.sourceFile,this.keywords=vt(Et[Y.ecmaVersion>=6?6:Y.sourceType==="module"?"5module":5]);var se="";if(Y.allowReserved!==!0){for(var Ve=Y.ecmaVersion;!(se=wt[Ve]);Ve--);Y.sourceType==="module"&&(se+=" await")}this.reservedWords=vt(se);var wr=(se?se+" ":"")+wt.strict;this.reservedWordsStrict=vt(wr),this.reservedWordsStrictBind=vt(wr+" "+wt.strictBind),this.input=String(bt),this.containsEsc=!1,nt?(this.pos=nt,this.lineStart=this.input.lastIndexOf(`
`,nt-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Dt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=rt.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=Y.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},this.pos===0&&Y.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(jt),this.regexpState=null},At={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};zt.prototype.parse=function(){var Y=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(Y)},At.inFunction.get=function(){return(this.currentVarScope().flags&Qt)>0},At.inGenerator.get=function(){return(this.currentVarScope().flags&Ke)>0},At.inAsync.get=function(){return(this.currentVarScope().flags&ae)>0},At.allowSuper.get=function(){return(this.currentThisScope().flags&te)>0},At.allowDirectSuper.get=function(){return(this.currentThisScope().flags&St)>0},At.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},zt.prototype.inNonArrowFunction=function(){return(this.currentThisScope().flags&Qt)>0},zt.extend=function(){for(var Y=[],bt=arguments.length;bt--;)Y[bt]=arguments[bt];for(var nt=this,se=0;se<Y.length;se++)nt=Y[se](nt);return nt},zt.parse=function(Y,bt){return new this(bt,Y).parse()},zt.parseExpressionAt=function(Y,bt,nt){var se=new this(nt,Y,bt);return se.nextToken(),se.parseExpression()},zt.tokenizer=function(Y,bt){return new this(bt,Y)},Object.defineProperties(zt.prototype,At);var Mt=zt.prototype,Rt=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;Mt.strictDirective=function(D){for(;;){ee.lastIndex=D,D+=ee.exec(this.input)[0].length;var Y=Rt.exec(this.input.slice(D));if(!Y)return!1;if((Y[1]||Y[2])==="use strict"){ee.lastIndex=D+Y[0].length;var bt=ee.exec(this.input),nt=bt.index+bt[0].length,se=this.input.charAt(nt);return se===";"||se==="}"||Dt.test(bt[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(se)||se==="!"&&this.input.charAt(nt+1)==="=")}D+=Y[0].length,ee.lastIndex=D,D+=ee.exec(this.input)[0].length,this.input[D]===";"&&D++}},Mt.eat=function(D){return this.type===D?(this.next(),!0):!1},Mt.isContextual=function(D){return this.type===rt.name&&this.value===D&&!this.containsEsc},Mt.eatContextual=function(D){return this.isContextual(D)?(this.next(),!0):!1},Mt.expectContextual=function(D){this.eatContextual(D)||this.unexpected()},Mt.canInsertSemicolon=function(){return this.type===rt.eof||this.type===rt.braceR||Dt.test(this.input.slice(this.lastTokEnd,this.start))},Mt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},Mt.semicolon=function(){!this.eat(rt.semi)&&!this.insertSemicolon()&&this.unexpected()},Mt.afterTrailingComma=function(D,Y){if(this.type===D)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),Y||this.next(),!0},Mt.expect=function(D){this.eat(D)||this.unexpected()},Mt.unexpected=function(D){this.raise(D!=null?D:this.start,"Unexpected token")};function tt(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}Mt.checkPatternErrors=function(D,Y){if(!!D){D.trailingComma>-1&&this.raiseRecoverable(D.trailingComma,"Comma is not permitted after the rest element");var bt=Y?D.parenthesizedAssign:D.parenthesizedBind;bt>-1&&this.raiseRecoverable(bt,"Parenthesized pattern")}},Mt.checkExpressionErrors=function(D,Y){if(!D)return!1;var bt=D.shorthandAssign,nt=D.doubleProto;if(!Y)return bt>=0||nt>=0;bt>=0&&this.raise(bt,"Shorthand property assignments are valid only in destructuring patterns"),nt>=0&&this.raiseRecoverable(nt,"Redefinition of __proto__ property")},Mt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},Mt.isSimpleAssignTarget=function(D){return D.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(D.expression):D.type==="Identifier"||D.type==="MemberExpression"};var _t=zt.prototype;_t.parseTopLevel=function(D){var Y={};for(D.body||(D.body=[]);this.type!==rt.eof;){var bt=this.parseStatement(null,!0,Y);D.body.push(bt)}if(this.inModule)for(var nt=0,se=Object.keys(this.undefinedExports);nt<se.length;nt+=1){var Ve=se[nt];this.raiseRecoverable(this.undefinedExports[Ve].start,"Export '"+Ve+"' is not defined")}return this.adaptDirectivePrologue(D.body),this.next(),D.sourceType=this.options.sourceType,this.finishNode(D,"Program")};var Xt={kind:"loop"},ve={kind:"switch"};_t.isLet=function(D){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;ee.lastIndex=this.pos;var Y=ee.exec(this.input),bt=this.pos+Y[0].length,nt=this.input.charCodeAt(bt);if(nt===91)return!0;if(D)return!1;if(nt===123)return!0;if(Zt(nt,!0)){for(var se=bt+1;P(this.input.charCodeAt(se),!0);)++se;var Ve=this.input.slice(bt,se);if(!q.test(Ve))return!0}return!1},_t.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;ee.lastIndex=this.pos;var D=ee.exec(this.input),Y=this.pos+D[0].length;return!Dt.test(this.input.slice(this.pos,Y))&&this.input.slice(Y,Y+8)==="function"&&(Y+8===this.input.length||!P(this.input.charAt(Y+8)))},_t.parseStatement=function(D,Y,bt){var nt=this.type,se=this.startNode(),Ve;switch(this.isLet(D)&&(nt=rt._var,Ve="let"),nt){case rt._break:case rt._continue:return this.parseBreakContinueStatement(se,nt.keyword);case rt._debugger:return this.parseDebuggerStatement(se);case rt._do:return this.parseDoStatement(se);case rt._for:return this.parseForStatement(se);case rt._function:return D&&(this.strict||D!=="if"&&D!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(se,!1,!D);case rt._class:return D&&this.unexpected(),this.parseClass(se,!0);case rt._if:return this.parseIfStatement(se);case rt._return:return this.parseReturnStatement(se);case rt._switch:return this.parseSwitchStatement(se);case rt._throw:return this.parseThrowStatement(se);case rt._try:return this.parseTryStatement(se);case rt._const:case rt._var:return Ve=Ve||this.value,D&&Ve!=="var"&&this.unexpected(),this.parseVarStatement(se,Ve);case rt._while:return this.parseWhileStatement(se);case rt._with:return this.parseWithStatement(se);case rt.braceL:return this.parseBlock(!0,se);case rt.semi:return this.parseEmptyStatement(se);case rt._export:case rt._import:if(this.options.ecmaVersion>10&&nt===rt._import){ee.lastIndex=this.pos;var wr=ee.exec(this.input),jr=this.pos+wr[0].length,Vr=this.input.charCodeAt(jr);if(Vr===40||Vr===46)return this.parseExpressionStatement(se,this.parseExpression())}return this.options.allowImportExportEverywhere||(Y||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),nt===rt._import?this.parseImport(se):this.parseExport(se,bt);default:if(this.isAsyncFunction())return D&&this.unexpected(),this.next(),this.parseFunctionStatement(se,!0,!D);var Ln=this.value,Gn=this.parseExpression();return nt===rt.name&&Gn.type==="Identifier"&&this.eat(rt.colon)?this.parseLabeledStatement(se,Ln,Gn,D):this.parseExpressionStatement(se,Gn)}},_t.parseBreakContinueStatement=function(D,Y){var bt=Y==="break";this.next(),this.eat(rt.semi)||this.insertSemicolon()?D.label=null:this.type!==rt.name?this.unexpected():(D.label=this.parseIdent(),this.semicolon());for(var nt=0;nt<this.labels.length;++nt){var se=this.labels[nt];if((D.label==null||se.name===D.label.name)&&(se.kind!=null&&(bt||se.kind==="loop")||D.label&&bt))break}return nt===this.labels.length&&this.raise(D.start,"Unsyntactic "+Y),this.finishNode(D,bt?"BreakStatement":"ContinueStatement")},_t.parseDebuggerStatement=function(D){return this.next(),this.semicolon(),this.finishNode(D,"DebuggerStatement")},_t.parseDoStatement=function(D){return this.next(),this.labels.push(Xt),D.body=this.parseStatement("do"),this.labels.pop(),this.expect(rt._while),D.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(rt.semi):this.semicolon(),this.finishNode(D,"DoWhileStatement")},_t.parseForStatement=function(D){this.next();var Y=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Xt),this.enterScope(0),this.expect(rt.parenL),this.type===rt.semi)return Y>-1&&this.unexpected(Y),this.parseFor(D,null);var bt=this.isLet();if(this.type===rt._var||this.type===rt._const||bt){var nt=this.startNode(),se=bt?"let":this.value;return this.next(),this.parseVar(nt,!0,se),this.finishNode(nt,"VariableDeclaration"),(this.type===rt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&nt.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===rt._in?Y>-1&&this.unexpected(Y):D.await=Y>-1),this.parseForIn(D,nt)):(Y>-1&&this.unexpected(Y),this.parseFor(D,nt))}var Ve=new tt,wr=this.parseExpression(!0,Ve);return this.type===rt._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===rt._in?Y>-1&&this.unexpected(Y):D.await=Y>-1),this.toAssignable(wr,!1,Ve),this.checkLVal(wr),this.parseForIn(D,wr)):(this.checkExpressionErrors(Ve,!0),Y>-1&&this.unexpected(Y),this.parseFor(D,wr))},_t.parseFunctionStatement=function(D,Y,bt){return this.next(),this.parseFunction(D,Me|(bt?0:je),!1,Y)},_t.parseIfStatement=function(D){return this.next(),D.test=this.parseParenExpression(),D.consequent=this.parseStatement("if"),D.alternate=this.eat(rt._else)?this.parseStatement("if"):null,this.finishNode(D,"IfStatement")},_t.parseReturnStatement=function(D){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(rt.semi)||this.insertSemicolon()?D.argument=null:(D.argument=this.parseExpression(),this.semicolon()),this.finishNode(D,"ReturnStatement")},_t.parseSwitchStatement=function(D){this.next(),D.discriminant=this.parseParenExpression(),D.cases=[],this.expect(rt.braceL),this.labels.push(ve),this.enterScope(0);for(var Y,bt=!1;this.type!==rt.braceR;)if(this.type===rt._case||this.type===rt._default){var nt=this.type===rt._case;Y&&this.finishNode(Y,"SwitchCase"),D.cases.push(Y=this.startNode()),Y.consequent=[],this.next(),nt?Y.test=this.parseExpression():(bt&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),bt=!0,Y.test=null),this.expect(rt.colon)}else Y||this.unexpected(),Y.consequent.push(this.parseStatement(null));return this.exitScope(),Y&&this.finishNode(Y,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(D,"SwitchStatement")},_t.parseThrowStatement=function(D){return this.next(),Dt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),D.argument=this.parseExpression(),this.semicolon(),this.finishNode(D,"ThrowStatement")};var Wt=[];_t.parseTryStatement=function(D){if(this.next(),D.block=this.parseBlock(),D.handler=null,this.type===rt._catch){var Y=this.startNode();if(this.next(),this.eat(rt.parenL)){Y.param=this.parseBindingAtom();var bt=Y.param.type==="Identifier";this.enterScope(bt?ie:0),this.checkLVal(Y.param,bt?Oe:Tt),this.expect(rt.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),Y.param=null,this.enterScope(0);Y.body=this.parseBlock(!1),this.exitScope(),D.handler=this.finishNode(Y,"CatchClause")}return D.finalizer=this.eat(rt._finally)?this.parseBlock():null,!D.handler&&!D.finalizer&&this.raise(D.start,"Missing catch or finally clause"),this.finishNode(D,"TryStatement")},_t.parseVarStatement=function(D,Y){return this.next(),this.parseVar(D,!1,Y),this.semicolon(),this.finishNode(D,"VariableDeclaration")},_t.parseWhileStatement=function(D){return this.next(),D.test=this.parseParenExpression(),this.labels.push(Xt),D.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(D,"WhileStatement")},_t.parseWithStatement=function(D){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),D.object=this.parseParenExpression(),D.body=this.parseStatement("with"),this.finishNode(D,"WithStatement")},_t.parseEmptyStatement=function(D){return this.next(),this.finishNode(D,"EmptyStatement")},_t.parseLabeledStatement=function(D,Y,bt,nt){for(var se=0,Ve=this.labels;se<Ve.length;se+=1){var wr=Ve[se];wr.name===Y&&this.raise(bt.start,"Label '"+Y+"' is already declared")}for(var jr=this.type.isLoop?"loop":this.type===rt._switch?"switch":null,Vr=this.labels.length-1;Vr>=0;Vr--){var Ln=this.labels[Vr];if(Ln.statementStart===D.start)Ln.statementStart=this.start,Ln.kind=jr;else break}return this.labels.push({name:Y,kind:jr,statementStart:this.start}),D.body=this.parseStatement(nt?nt.indexOf("label")===-1?nt+"label":nt:"label"),this.labels.pop(),D.label=bt,this.finishNode(D,"LabeledStatement")},_t.parseExpressionStatement=function(D,Y){return D.expression=Y,this.semicolon(),this.finishNode(D,"ExpressionStatement")},_t.parseBlock=function(D,Y,bt){for(D===void 0&&(D=!0),Y===void 0&&(Y=this.startNode()),Y.body=[],this.expect(rt.braceL),D&&this.enterScope(0);this.type!==rt.braceR;){var nt=this.parseStatement(null);Y.body.push(nt)}return bt&&(this.strict=!1),this.next(),D&&this.exitScope(),this.finishNode(Y,"BlockStatement")},_t.parseFor=function(D,Y){return D.init=Y,this.expect(rt.semi),D.test=this.type===rt.semi?null:this.parseExpression(),this.expect(rt.semi),D.update=this.type===rt.parenR?null:this.parseExpression(),this.expect(rt.parenR),D.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(D,"ForStatement")},_t.parseForIn=function(D,Y){var bt=this.type===rt._in;return this.next(),Y.type==="VariableDeclaration"&&Y.declarations[0].init!=null&&(!bt||this.options.ecmaVersion<8||this.strict||Y.kind!=="var"||Y.declarations[0].id.type!=="Identifier")?this.raise(Y.start,(bt?"for-in":"for-of")+" loop variable declaration may not have an initializer"):Y.type==="AssignmentPattern"&&this.raise(Y.start,"Invalid left-hand side in for-loop"),D.left=Y,D.right=bt?this.parseExpression():this.parseMaybeAssign(),this.expect(rt.parenR),D.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(D,bt?"ForInStatement":"ForOfStatement")},_t.parseVar=function(D,Y,bt){for(D.declarations=[],D.kind=bt;;){var nt=this.startNode();if(this.parseVarId(nt,bt),this.eat(rt.eq)?nt.init=this.parseMaybeAssign(Y):bt==="const"&&!(this.type===rt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():nt.id.type!=="Identifier"&&!(Y&&(this.type===rt._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):nt.init=null,D.declarations.push(this.finishNode(nt,"VariableDeclarator")),!this.eat(rt.comma))break}return D},_t.parseVarId=function(D,Y){D.id=this.parseBindingAtom(),this.checkLVal(D.id,Y==="var"?Ct:Tt,!1)};var Me=1,je=2,Qe=4;_t.parseFunction=function(D,Y,bt,nt){this.initFunction(D),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!nt)&&(this.type===rt.star&&Y&je&&this.unexpected(),D.generator=this.eat(rt.star)),this.options.ecmaVersion>=8&&(D.async=!!nt),Y&Me&&(D.id=Y&Qe&&this.type!==rt.name?null:this.parseIdent(),D.id&&!(Y&je)&&this.checkLVal(D.id,this.strict||D.generator||D.async?this.treatFunctionsAsVar?Ct:Tt:ue));var se=this.yieldPos,Ve=this.awaitPos,wr=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(qt(D.async,D.generator)),Y&Me||(D.id=this.type===rt.name?this.parseIdent():null),this.parseFunctionParams(D),this.parseFunctionBody(D,bt,!1),this.yieldPos=se,this.awaitPos=Ve,this.awaitIdentPos=wr,this.finishNode(D,Y&Me?"FunctionDeclaration":"FunctionExpression")},_t.parseFunctionParams=function(D){this.expect(rt.parenL),D.params=this.parseBindingList(rt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},_t.parseClass=function(D,Y){this.next();var bt=this.strict;this.strict=!0,this.parseClassId(D,Y),this.parseClassSuper(D);var nt=this.startNode(),se=!1;for(nt.body=[],this.expect(rt.braceL);this.type!==rt.braceR;){var Ve=this.parseClassElement(D.superClass!==null);Ve&&(nt.body.push(Ve),Ve.type==="MethodDefinition"&&Ve.kind==="constructor"&&(se&&this.raise(Ve.start,"Duplicate constructor in the same class"),se=!0))}return this.strict=bt,this.next(),D.body=this.finishNode(nt,"ClassBody"),this.finishNode(D,Y?"ClassDeclaration":"ClassExpression")},_t.parseClassElement=function(D){var Y=this;if(this.eat(rt.semi))return null;var bt=this.startNode(),nt=function(Vr,Ln){Ln===void 0&&(Ln=!1);var Gn=Y.start,$i=Y.startLoc;return Y.eatContextual(Vr)?Y.type!==rt.parenL&&(!Ln||!Y.canInsertSemicolon())?!0:(bt.key&&Y.unexpected(),bt.computed=!1,bt.key=Y.startNodeAt(Gn,$i),bt.key.name=Vr,Y.finishNode(bt.key,"Identifier"),!1):!1};bt.kind="method",bt.static=nt("static");var se=this.eat(rt.star),Ve=!1;se||(this.options.ecmaVersion>=8&&nt("async",!0)?(Ve=!0,se=this.options.ecmaVersion>=9&&this.eat(rt.star)):nt("get")?bt.kind="get":nt("set")&&(bt.kind="set")),bt.key||this.parsePropertyName(bt);var wr=bt.key,jr=!1;return!bt.computed&&!bt.static&&(wr.type==="Identifier"&&wr.name==="constructor"||wr.type==="Literal"&&wr.value==="constructor")?(bt.kind!=="method"&&this.raise(wr.start,"Constructor can't have get/set modifier"),se&&this.raise(wr.start,"Constructor can't be a generator"),Ve&&this.raise(wr.start,"Constructor can't be an async method"),bt.kind="constructor",jr=D):bt.static&&wr.type==="Identifier"&&wr.name==="prototype"&&this.raise(wr.start,"Classes may not have a static property named prototype"),this.parseClassMethod(bt,se,Ve,jr),bt.kind==="get"&&bt.value.params.length!==0&&this.raiseRecoverable(bt.value.start,"getter should have no params"),bt.kind==="set"&&bt.value.params.length!==1&&this.raiseRecoverable(bt.value.start,"setter should have exactly one param"),bt.kind==="set"&&bt.value.params[0].type==="RestElement"&&this.raiseRecoverable(bt.value.params[0].start,"Setter cannot use rest params"),bt},_t.parseClassMethod=function(D,Y,bt,nt){return D.value=this.parseMethod(Y,bt,nt),this.finishNode(D,"MethodDefinition")},_t.parseClassId=function(D,Y){this.type===rt.name?(D.id=this.parseIdent(),Y&&this.checkLVal(D.id,Tt,!1)):(Y===!0&&this.unexpected(),D.id=null)},_t.parseClassSuper=function(D){D.superClass=this.eat(rt._extends)?this.parseExprSubscripts():null},_t.parseExport=function(D,Y){if(this.next(),this.eat(rt.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(D.exported=this.parseIdent(!0),this.checkExport(Y,D.exported.name,this.lastTokStart)):D.exported=null),this.expectContextual("from"),this.type!==rt.string&&this.unexpected(),D.source=this.parseExprAtom(),this.semicolon(),this.finishNode(D,"ExportAllDeclaration");if(this.eat(rt._default)){this.checkExport(Y,"default",this.lastTokStart);var bt;if(this.type===rt._function||(bt=this.isAsyncFunction())){var nt=this.startNode();this.next(),bt&&this.next(),D.declaration=this.parseFunction(nt,Me|Qe,!1,bt)}else if(this.type===rt._class){var se=this.startNode();D.declaration=this.parseClass(se,"nullableID")}else D.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(D,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())D.declaration=this.parseStatement(null),D.declaration.type==="VariableDeclaration"?this.checkVariableExport(Y,D.declaration.declarations):this.checkExport(Y,D.declaration.id.name,D.declaration.id.start),D.specifiers=[],D.source=null;else{if(D.declaration=null,D.specifiers=this.parseExportSpecifiers(Y),this.eatContextual("from"))this.type!==rt.string&&this.unexpected(),D.source=this.parseExprAtom();else{for(var Ve=0,wr=D.specifiers;Ve<wr.length;Ve+=1){var jr=wr[Ve];this.checkUnreserved(jr.local),this.checkLocalExport(jr.local)}D.source=null}this.semicolon()}return this.finishNode(D,"ExportNamedDeclaration")},_t.checkExport=function(D,Y,bt){!D||(Pt(D,Y)&&this.raiseRecoverable(bt,"Duplicate export '"+Y+"'"),D[Y]=!0)},_t.checkPatternExport=function(D,Y){var bt=Y.type;if(bt==="Identifier")this.checkExport(D,Y.name,Y.start);else if(bt==="ObjectPattern")for(var nt=0,se=Y.properties;nt<se.length;nt+=1){var Ve=se[nt];this.checkPatternExport(D,Ve)}else if(bt==="ArrayPattern")for(var wr=0,jr=Y.elements;wr<jr.length;wr+=1){var Vr=jr[wr];Vr&&this.checkPatternExport(D,Vr)}else bt==="Property"?this.checkPatternExport(D,Y.value):bt==="AssignmentPattern"?this.checkPatternExport(D,Y.left):bt==="RestElement"?this.checkPatternExport(D,Y.argument):bt==="ParenthesizedExpression"&&this.checkPatternExport(D,Y.expression)},_t.checkVariableExport=function(D,Y){if(!!D)for(var bt=0,nt=Y;bt<nt.length;bt+=1){var se=nt[bt];this.checkPatternExport(D,se.id)}},_t.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()},_t.parseExportSpecifiers=function(D){var Y=[],bt=!0;for(this.expect(rt.braceL);!this.eat(rt.braceR);){if(bt)bt=!1;else if(this.expect(rt.comma),this.afterTrailingComma(rt.braceR))break;var nt=this.startNode();nt.local=this.parseIdent(!0),nt.exported=this.eatContextual("as")?this.parseIdent(!0):nt.local,this.checkExport(D,nt.exported.name,nt.exported.start),Y.push(this.finishNode(nt,"ExportSpecifier"))}return Y},_t.parseImport=function(D){return this.next(),this.type===rt.string?(D.specifiers=Wt,D.source=this.parseExprAtom()):(D.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),D.source=this.type===rt.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(D,"ImportDeclaration")},_t.parseImportSpecifiers=function(){var D=[],Y=!0;if(this.type===rt.name){var bt=this.startNode();if(bt.local=this.parseIdent(),this.checkLVal(bt.local,Tt),D.push(this.finishNode(bt,"ImportDefaultSpecifier")),!this.eat(rt.comma))return D}if(this.type===rt.star){var nt=this.startNode();return this.next(),this.expectContextual("as"),nt.local=this.parseIdent(),this.checkLVal(nt.local,Tt),D.push(this.finishNode(nt,"ImportNamespaceSpecifier")),D}for(this.expect(rt.braceL);!this.eat(rt.braceR);){if(Y)Y=!1;else if(this.expect(rt.comma),this.afterTrailingComma(rt.braceR))break;var se=this.startNode();se.imported=this.parseIdent(!0),this.eatContextual("as")?se.local=this.parseIdent():(this.checkUnreserved(se.imported),se.local=se.imported),this.checkLVal(se.local,Tt),D.push(this.finishNode(se,"ImportSpecifier"))}return D},_t.adaptDirectivePrologue=function(D){for(var Y=0;Y<D.length&&this.isDirectiveCandidate(D[Y]);++Y)D[Y].directive=D[Y].expression.raw.slice(1,-1)},_t.isDirectiveCandidate=function(D){return D.type==="ExpressionStatement"&&D.expression.type==="Literal"&&typeof D.expression.value=="string"&&(this.input[D.start]==='"'||this.input[D.start]==="'")};var hr=zt.prototype;hr.toAssignable=function(D,Y,bt){if(this.options.ecmaVersion>=6&&D)switch(D.type){case"Identifier":this.inAsync&&D.name==="await"&&this.raise(D.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":D.type="ObjectPattern",bt&&this.checkPatternErrors(bt,!0);for(var nt=0,se=D.properties;nt<se.length;nt+=1){var Ve=se[nt];this.toAssignable(Ve,Y),Ve.type==="RestElement"&&(Ve.argument.type==="ArrayPattern"||Ve.argument.type==="ObjectPattern")&&this.raise(Ve.argument.start,"Unexpected token")}break;case"Property":D.kind!=="init"&&this.raise(D.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(D.value,Y);break;case"ArrayExpression":D.type="ArrayPattern",bt&&this.checkPatternErrors(bt,!0),this.toAssignableList(D.elements,Y);break;case"SpreadElement":D.type="RestElement",this.toAssignable(D.argument,Y),D.argument.type==="AssignmentPattern"&&this.raise(D.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":D.operator!=="="&&this.raise(D.left.end,"Only '=' operator can be used for specifying default value."),D.type="AssignmentPattern",delete D.operator,this.toAssignable(D.left,Y);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(D.expression,Y,bt);break;case"ChainExpression":this.raiseRecoverable(D.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!Y)break;default:this.raise(D.start,"Assigning to rvalue")}else bt&&this.checkPatternErrors(bt,!0);return D},hr.toAssignableList=function(D,Y){for(var bt=D.length,nt=0;nt<bt;nt++){var se=D[nt];se&&this.toAssignable(se,Y)}if(bt){var Ve=D[bt-1];this.options.ecmaVersion===6&&Y&&Ve&&Ve.type==="RestElement"&&Ve.argument.type!=="Identifier"&&this.unexpected(Ve.argument.start)}return D},hr.parseSpread=function(D){var Y=this.startNode();return this.next(),Y.argument=this.parseMaybeAssign(!1,D),this.finishNode(Y,"SpreadElement")},hr.parseRestBinding=function(){var D=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==rt.name&&this.unexpected(),D.argument=this.parseBindingAtom(),this.finishNode(D,"RestElement")},hr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case rt.bracketL:var D=this.startNode();return this.next(),D.elements=this.parseBindingList(rt.bracketR,!0,!0),this.finishNode(D,"ArrayPattern");case rt.braceL:return this.parseObj(!0)}return this.parseIdent()},hr.parseBindingList=function(D,Y,bt){for(var nt=[],se=!0;!this.eat(D);)if(se?se=!1:this.expect(rt.comma),Y&&this.type===rt.comma)nt.push(null);else{if(bt&&this.afterTrailingComma(D))break;if(this.type===rt.ellipsis){var Ve=this.parseRestBinding();this.parseBindingListItem(Ve),nt.push(Ve),this.type===rt.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(D);break}else{var wr=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(wr),nt.push(wr)}}return nt},hr.parseBindingListItem=function(D){return D},hr.parseMaybeDefault=function(D,Y,bt){if(bt=bt||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(rt.eq))return bt;var nt=this.startNodeAt(D,Y);return nt.left=bt,nt.right=this.parseMaybeAssign(),this.finishNode(nt,"AssignmentPattern")},hr.checkLVal=function(D,Y,bt){switch(Y===void 0&&(Y=$t),D.type){case"Identifier":Y===Tt&&D.name==="let"&&this.raiseRecoverable(D.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(D.name)&&this.raiseRecoverable(D.start,(Y?"Binding ":"Assigning to ")+D.name+" in strict mode"),bt&&(Pt(bt,D.name)&&this.raiseRecoverable(D.start,"Argument name clash"),bt[D.name]=!0),Y!==$t&&Y!==We&&this.declareName(D.name,Y,D.start);break;case"ChainExpression":this.raiseRecoverable(D.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":Y&&this.raiseRecoverable(D.start,"Binding member expression");break;case"ObjectPattern":for(var nt=0,se=D.properties;nt<se.length;nt+=1){var Ve=se[nt];this.checkLVal(Ve,Y,bt)}break;case"Property":this.checkLVal(D.value,Y,bt);break;case"ArrayPattern":for(var wr=0,jr=D.elements;wr<jr.length;wr+=1){var Vr=jr[wr];Vr&&this.checkLVal(Vr,Y,bt)}break;case"AssignmentPattern":this.checkLVal(D.left,Y,bt);break;case"RestElement":this.checkLVal(D.argument,Y,bt);break;case"ParenthesizedExpression":this.checkLVal(D.expression,Y,bt);break;default:this.raise(D.start,(Y?"Binding":"Assigning to")+" rvalue")}};var er=zt.prototype;er.checkPropClash=function(D,Y,bt){if(!(this.options.ecmaVersion>=9&&D.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(D.computed||D.method||D.shorthand))){var nt=D.key,se;switch(nt.type){case"Identifier":se=nt.name;break;case"Literal":se=String(nt.value);break;default:return}var Ve=D.kind;if(this.options.ecmaVersion>=6){se==="__proto__"&&Ve==="init"&&(Y.proto&&(bt?bt.doubleProto<0&&(bt.doubleProto=nt.start):this.raiseRecoverable(nt.start,"Redefinition of __proto__ property")),Y.proto=!0);return}se="$"+se;var wr=Y[se];if(wr){var jr;Ve==="init"?jr=this.strict&&wr.init||wr.get||wr.set:jr=wr.init||wr[Ve],jr&&this.raiseRecoverable(nt.start,"Redefinition of property")}else wr=Y[se]={init:!1,get:!1,set:!1};wr[Ve]=!0}},er.parseExpression=function(D,Y){var bt=this.start,nt=this.startLoc,se=this.parseMaybeAssign(D,Y);if(this.type===rt.comma){var Ve=this.startNodeAt(bt,nt);for(Ve.expressions=[se];this.eat(rt.comma);)Ve.expressions.push(this.parseMaybeAssign(D,Y));return this.finishNode(Ve,"SequenceExpression")}return se},er.parseMaybeAssign=function(D,Y,bt){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(D);this.exprAllowed=!1}var nt=!1,se=-1,Ve=-1;Y?(se=Y.parenthesizedAssign,Ve=Y.trailingComma,Y.parenthesizedAssign=Y.trailingComma=-1):(Y=new tt,nt=!0);var wr=this.start,jr=this.startLoc;(this.type===rt.parenL||this.type===rt.name)&&(this.potentialArrowAt=this.start);var Vr=this.parseMaybeConditional(D,Y);if(bt&&(Vr=bt.call(this,Vr,wr,jr)),this.type.isAssign){var Ln=this.startNodeAt(wr,jr);return Ln.operator=this.value,Ln.left=this.type===rt.eq?this.toAssignable(Vr,!1,Y):Vr,nt||(Y.parenthesizedAssign=Y.trailingComma=Y.doubleProto=-1),Y.shorthandAssign>=Ln.left.start&&(Y.shorthandAssign=-1),this.checkLVal(Vr),this.next(),Ln.right=this.parseMaybeAssign(D),this.finishNode(Ln,"AssignmentExpression")}else nt&&this.checkExpressionErrors(Y,!0);return se>-1&&(Y.parenthesizedAssign=se),Ve>-1&&(Y.trailingComma=Ve),Vr},er.parseMaybeConditional=function(D,Y){var bt=this.start,nt=this.startLoc,se=this.parseExprOps(D,Y);if(this.checkExpressionErrors(Y))return se;if(this.eat(rt.question)){var Ve=this.startNodeAt(bt,nt);return Ve.test=se,Ve.consequent=this.parseMaybeAssign(),this.expect(rt.colon),Ve.alternate=this.parseMaybeAssign(D),this.finishNode(Ve,"ConditionalExpression")}return se},er.parseExprOps=function(D,Y){var bt=this.start,nt=this.startLoc,se=this.parseMaybeUnary(Y,!1);return this.checkExpressionErrors(Y)||se.start===bt&&se.type==="ArrowFunctionExpression"?se:this.parseExprOp(se,bt,nt,-1,D)},er.parseExprOp=function(D,Y,bt,nt,se){var Ve=this.type.binop;if(Ve!=null&&(!se||this.type!==rt._in)&&Ve>nt){var wr=this.type===rt.logicalOR||this.type===rt.logicalAND,jr=this.type===rt.coalesce;jr&&(Ve=rt.logicalAND.binop);var Vr=this.value;this.next();var Ln=this.start,Gn=this.startLoc,$i=this.parseExprOp(this.parseMaybeUnary(null,!1),Ln,Gn,Ve,se),Pa=this.buildBinary(Y,bt,D,$i,Vr,wr||jr);return(wr&&this.type===rt.coalesce||jr&&(this.type===rt.logicalOR||this.type===rt.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(Pa,Y,bt,nt,se)}return D},er.buildBinary=function(D,Y,bt,nt,se,Ve){var wr=this.startNodeAt(D,Y);return wr.left=bt,wr.operator=se,wr.right=nt,this.finishNode(wr,Ve?"LogicalExpression":"BinaryExpression")},er.parseMaybeUnary=function(D,Y){var bt=this.start,nt=this.startLoc,se;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))se=this.parseAwait(),Y=!0;else if(this.type.prefix){var Ve=this.startNode(),wr=this.type===rt.incDec;Ve.operator=this.value,Ve.prefix=!0,this.next(),Ve.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(D,!0),wr?this.checkLVal(Ve.argument):this.strict&&Ve.operator==="delete"&&Ve.argument.type==="Identifier"?this.raiseRecoverable(Ve.start,"Deleting local variable in strict mode"):Y=!0,se=this.finishNode(Ve,wr?"UpdateExpression":"UnaryExpression")}else{if(se=this.parseExprSubscripts(D),this.checkExpressionErrors(D))return se;for(;this.type.postfix&&!this.canInsertSemicolon();){var jr=this.startNodeAt(bt,nt);jr.operator=this.value,jr.prefix=!1,jr.argument=se,this.checkLVal(se),this.next(),se=this.finishNode(jr,"UpdateExpression")}}return!Y&&this.eat(rt.starstar)?this.buildBinary(bt,nt,se,this.parseMaybeUnary(null,!1),"**",!1):se},er.parseExprSubscripts=function(D){var Y=this.start,bt=this.startLoc,nt=this.parseExprAtom(D);if(nt.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return nt;var se=this.parseSubscripts(nt,Y,bt);return D&&se.type==="MemberExpression"&&(D.parenthesizedAssign>=se.start&&(D.parenthesizedAssign=-1),D.parenthesizedBind>=se.start&&(D.parenthesizedBind=-1)),se},er.parseSubscripts=function(D,Y,bt,nt){for(var se=this.options.ecmaVersion>=8&&D.type==="Identifier"&&D.name==="async"&&this.lastTokEnd===D.end&&!this.canInsertSemicolon()&&D.end-D.start===5&&this.potentialArrowAt===D.start,Ve=!1;;){var wr=this.parseSubscript(D,Y,bt,nt,se,Ve);if(wr.optional&&(Ve=!0),wr===D||wr.type==="ArrowFunctionExpression"){if(Ve){var jr=this.startNodeAt(Y,bt);jr.expression=wr,wr=this.finishNode(jr,"ChainExpression")}return wr}D=wr}},er.parseSubscript=function(D,Y,bt,nt,se,Ve){var wr=this.options.ecmaVersion>=11,jr=wr&&this.eat(rt.questionDot);nt&&jr&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Vr=this.eat(rt.bracketL);if(Vr||jr&&this.type!==rt.parenL&&this.type!==rt.backQuote||this.eat(rt.dot)){var Ln=this.startNodeAt(Y,bt);Ln.object=D,Ln.property=Vr?this.parseExpression():this.parseIdent(this.options.allowReserved!=="never"),Ln.computed=!!Vr,Vr&&this.expect(rt.bracketR),wr&&(Ln.optional=jr),D=this.finishNode(Ln,"MemberExpression")}else if(!nt&&this.eat(rt.parenL)){var Gn=new tt,$i=this.yieldPos,Pa=this.awaitPos,ba=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var uo=this.parseExprList(rt.parenR,this.options.ecmaVersion>=8,!1,Gn);if(se&&!jr&&!this.canInsertSemicolon()&&this.eat(rt.arrow))return this.checkPatternErrors(Gn,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=$i,this.awaitPos=Pa,this.awaitIdentPos=ba,this.parseArrowExpression(this.startNodeAt(Y,bt),uo,!0);this.checkExpressionErrors(Gn,!0),this.yieldPos=$i||this.yieldPos,this.awaitPos=Pa||this.awaitPos,this.awaitIdentPos=ba||this.awaitIdentPos;var Ca=this.startNodeAt(Y,bt);Ca.callee=D,Ca.arguments=uo,wr&&(Ca.optional=jr),D=this.finishNode(Ca,"CallExpression")}else if(this.type===rt.backQuote){(jr||Ve)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Ao=this.startNodeAt(Y,bt);Ao.tag=D,Ao.quasi=this.parseTemplate({isTagged:!0}),D=this.finishNode(Ao,"TaggedTemplateExpression")}return D},er.parseExprAtom=function(D){this.type===rt.slash&&this.readRegexp();var Y,bt=this.potentialArrowAt===this.start;switch(this.type){case rt._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),Y=this.startNode(),this.next(),this.type===rt.parenL&&!this.allowDirectSuper&&this.raise(Y.start,"super() call outside constructor of a subclass"),this.type!==rt.dot&&this.type!==rt.bracketL&&this.type!==rt.parenL&&this.unexpected(),this.finishNode(Y,"Super");case rt._this:return Y=this.startNode(),this.next(),this.finishNode(Y,"ThisExpression");case rt.name:var nt=this.start,se=this.startLoc,Ve=this.containsEsc,wr=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Ve&&wr.name==="async"&&!this.canInsertSemicolon()&&this.eat(rt._function))return this.parseFunction(this.startNodeAt(nt,se),0,!1,!0);if(bt&&!this.canInsertSemicolon()){if(this.eat(rt.arrow))return this.parseArrowExpression(this.startNodeAt(nt,se),[wr],!1);if(this.options.ecmaVersion>=8&&wr.name==="async"&&this.type===rt.name&&!Ve)return wr=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(rt.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(nt,se),[wr],!0)}return wr;case rt.regexp:var jr=this.value;return Y=this.parseLiteral(jr.value),Y.regex={pattern:jr.pattern,flags:jr.flags},Y;case rt.num:case rt.string:return this.parseLiteral(this.value);case rt._null:case rt._true:case rt._false:return Y=this.startNode(),Y.value=this.type===rt._null?null:this.type===rt._true,Y.raw=this.type.keyword,this.next(),this.finishNode(Y,"Literal");case rt.parenL:var Vr=this.start,Ln=this.parseParenAndDistinguishExpression(bt);return D&&(D.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Ln)&&(D.parenthesizedAssign=Vr),D.parenthesizedBind<0&&(D.parenthesizedBind=Vr)),Ln;case rt.bracketL:return Y=this.startNode(),this.next(),Y.elements=this.parseExprList(rt.bracketR,!0,!0,D),this.finishNode(Y,"ArrayExpression");case rt.braceL:return this.parseObj(!1,D);case rt._function:return Y=this.startNode(),this.next(),this.parseFunction(Y,0);case rt._class:return this.parseClass(this.startNode(),!1);case rt._new:return this.parseNew();case rt.backQuote:return this.parseTemplate();case rt._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},er.parseExprImport=function(){var D=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var Y=this.parseIdent(!0);switch(this.type){case rt.parenL:return this.parseDynamicImport(D);case rt.dot:return D.meta=Y,this.parseImportMeta(D);default:this.unexpected()}},er.parseDynamicImport=function(D){if(this.next(),D.source=this.parseMaybeAssign(),!this.eat(rt.parenR)){var Y=this.start;this.eat(rt.comma)&&this.eat(rt.parenR)?this.raiseRecoverable(Y,"Trailing comma is not allowed in import()"):this.unexpected(Y)}return this.finishNode(D,"ImportExpression")},er.parseImportMeta=function(D){this.next();var Y=this.containsEsc;return D.property=this.parseIdent(!0),D.property.name!=="meta"&&this.raiseRecoverable(D.property.start,"The only valid meta property for import is 'import.meta'"),Y&&this.raiseRecoverable(D.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&this.raiseRecoverable(D.start,"Cannot use 'import.meta' outside a module"),this.finishNode(D,"MetaProperty")},er.parseLiteral=function(D){var Y=this.startNode();return Y.value=D,Y.raw=this.input.slice(this.start,this.end),Y.raw.charCodeAt(Y.raw.length-1)===110&&(Y.bigint=Y.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(Y,"Literal")},er.parseParenExpression=function(){this.expect(rt.parenL);var D=this.parseExpression();return this.expect(rt.parenR),D},er.parseParenAndDistinguishExpression=function(D){var Y=this.start,bt=this.startLoc,nt,se=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var Ve=this.start,wr=this.startLoc,jr=[],Vr=!0,Ln=!1,Gn=new tt,$i=this.yieldPos,Pa=this.awaitPos,ba;for(this.yieldPos=0,this.awaitPos=0;this.type!==rt.parenR;)if(Vr?Vr=!1:this.expect(rt.comma),se&&this.afterTrailingComma(rt.parenR,!0)){Ln=!0;break}else if(this.type===rt.ellipsis){ba=this.start,jr.push(this.parseParenItem(this.parseRestBinding())),this.type===rt.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}else jr.push(this.parseMaybeAssign(!1,Gn,this.parseParenItem));var uo=this.start,Ca=this.startLoc;if(this.expect(rt.parenR),D&&!this.canInsertSemicolon()&&this.eat(rt.arrow))return this.checkPatternErrors(Gn,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=$i,this.awaitPos=Pa,this.parseParenArrowList(Y,bt,jr);(!jr.length||Ln)&&this.unexpected(this.lastTokStart),ba&&this.unexpected(ba),this.checkExpressionErrors(Gn,!0),this.yieldPos=$i||this.yieldPos,this.awaitPos=Pa||this.awaitPos,jr.length>1?(nt=this.startNodeAt(Ve,wr),nt.expressions=jr,this.finishNodeAt(nt,"SequenceExpression",uo,Ca)):nt=jr[0]}else nt=this.parseParenExpression();if(this.options.preserveParens){var Ao=this.startNodeAt(Y,bt);return Ao.expression=nt,this.finishNode(Ao,"ParenthesizedExpression")}else return nt},er.parseParenItem=function(D){return D},er.parseParenArrowList=function(D,Y,bt){return this.parseArrowExpression(this.startNodeAt(D,Y),bt)};var Br=[];er.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var D=this.startNode(),Y=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(rt.dot)){D.meta=Y;var bt=this.containsEsc;return D.property=this.parseIdent(!0),D.property.name!=="target"&&this.raiseRecoverable(D.property.start,"The only valid meta property for new is 'new.target'"),bt&&this.raiseRecoverable(D.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(D.start,"'new.target' can only be used in functions"),this.finishNode(D,"MetaProperty")}var nt=this.start,se=this.startLoc,Ve=this.type===rt._import;return D.callee=this.parseSubscripts(this.parseExprAtom(),nt,se,!0),Ve&&D.callee.type==="ImportExpression"&&this.raise(nt,"Cannot use new with import()"),this.eat(rt.parenL)?D.arguments=this.parseExprList(rt.parenR,this.options.ecmaVersion>=8,!1):D.arguments=Br,this.finishNode(D,"NewExpression")},er.parseTemplateElement=function(D){var Y=D.isTagged,bt=this.startNode();return this.type===rt.invalidTemplate?(Y||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),bt.value={raw:this.value,cooked:null}):bt.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),bt.tail=this.type===rt.backQuote,this.finishNode(bt,"TemplateElement")},er.parseTemplate=function(D){D===void 0&&(D={});var Y=D.isTagged;Y===void 0&&(Y=!1);var bt=this.startNode();this.next(),bt.expressions=[];var nt=this.parseTemplateElement({isTagged:Y});for(bt.quasis=[nt];!nt.tail;)this.type===rt.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(rt.dollarBraceL),bt.expressions.push(this.parseExpression()),this.expect(rt.braceR),bt.quasis.push(nt=this.parseTemplateElement({isTagged:Y}));return this.next(),this.finishNode(bt,"TemplateLiteral")},er.isAsyncProp=function(D){return!D.computed&&D.key.type==="Identifier"&&D.key.name==="async"&&(this.type===rt.name||this.type===rt.num||this.type===rt.string||this.type===rt.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===rt.star)&&!Dt.test(this.input.slice(this.lastTokEnd,this.start))},er.parseObj=function(D,Y){var bt=this.startNode(),nt=!0,se={};for(bt.properties=[],this.next();!this.eat(rt.braceR);){if(nt)nt=!1;else if(this.expect(rt.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(rt.braceR))break;var Ve=this.parseProperty(D,Y);D||this.checkPropClash(Ve,se,Y),bt.properties.push(Ve)}return this.finishNode(bt,D?"ObjectPattern":"ObjectExpression")},er.parseProperty=function(D,Y){var bt=this.startNode(),nt,se,Ve,wr;if(this.options.ecmaVersion>=9&&this.eat(rt.ellipsis))return D?(bt.argument=this.parseIdent(!1),this.type===rt.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(bt,"RestElement")):(this.type===rt.parenL&&Y&&(Y.parenthesizedAssign<0&&(Y.parenthesizedAssign=this.start),Y.parenthesizedBind<0&&(Y.parenthesizedBind=this.start)),bt.argument=this.parseMaybeAssign(!1,Y),this.type===rt.comma&&Y&&Y.trailingComma<0&&(Y.trailingComma=this.start),this.finishNode(bt,"SpreadElement"));this.options.ecmaVersion>=6&&(bt.method=!1,bt.shorthand=!1,(D||Y)&&(Ve=this.start,wr=this.startLoc),D||(nt=this.eat(rt.star)));var jr=this.containsEsc;return this.parsePropertyName(bt),!D&&!jr&&this.options.ecmaVersion>=8&&!nt&&this.isAsyncProp(bt)?(se=!0,nt=this.options.ecmaVersion>=9&&this.eat(rt.star),this.parsePropertyName(bt,Y)):se=!1,this.parsePropertyValue(bt,D,nt,se,Ve,wr,Y,jr),this.finishNode(bt,"Property")},er.parsePropertyValue=function(D,Y,bt,nt,se,Ve,wr,jr){if((bt||nt)&&this.type===rt.colon&&this.unexpected(),this.eat(rt.colon))D.value=Y?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,wr),D.kind="init";else if(this.options.ecmaVersion>=6&&this.type===rt.parenL)Y&&this.unexpected(),D.kind="init",D.method=!0,D.value=this.parseMethod(bt,nt);else if(!Y&&!jr&&this.options.ecmaVersion>=5&&!D.computed&&D.key.type==="Identifier"&&(D.key.name==="get"||D.key.name==="set")&&this.type!==rt.comma&&this.type!==rt.braceR&&this.type!==rt.eq){(bt||nt)&&this.unexpected(),D.kind=D.key.name,this.parsePropertyName(D),D.value=this.parseMethod(!1);var Vr=D.kind==="get"?0:1;if(D.value.params.length!==Vr){var Ln=D.value.start;D.kind==="get"?this.raiseRecoverable(Ln,"getter should have no params"):this.raiseRecoverable(Ln,"setter should have exactly one param")}else D.kind==="set"&&D.value.params[0].type==="RestElement"&&this.raiseRecoverable(D.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!D.computed&&D.key.type==="Identifier"?((bt||nt)&&this.unexpected(),this.checkUnreserved(D.key),D.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=se),D.kind="init",Y?D.value=this.parseMaybeDefault(se,Ve,D.key):this.type===rt.eq&&wr?(wr.shorthandAssign<0&&(wr.shorthandAssign=this.start),D.value=this.parseMaybeDefault(se,Ve,D.key)):D.value=D.key,D.shorthand=!0):this.unexpected()},er.parsePropertyName=function(D){if(this.options.ecmaVersion>=6){if(this.eat(rt.bracketL))return D.computed=!0,D.key=this.parseMaybeAssign(),this.expect(rt.bracketR),D.key;D.computed=!1}return D.key=this.type===rt.num||this.type===rt.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")},er.initFunction=function(D){D.id=null,this.options.ecmaVersion>=6&&(D.generator=D.expression=!1),this.options.ecmaVersion>=8&&(D.async=!1)},er.parseMethod=function(D,Y,bt){var nt=this.startNode(),se=this.yieldPos,Ve=this.awaitPos,wr=this.awaitIdentPos;return this.initFunction(nt),this.options.ecmaVersion>=6&&(nt.generator=D),this.options.ecmaVersion>=8&&(nt.async=!!Y),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(qt(Y,nt.generator)|te|(bt?St:0)),this.expect(rt.parenL),nt.params=this.parseBindingList(rt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(nt,!1,!0),this.yieldPos=se,this.awaitPos=Ve,this.awaitIdentPos=wr,this.finishNode(nt,"FunctionExpression")},er.parseArrowExpression=function(D,Y,bt){var nt=this.yieldPos,se=this.awaitPos,Ve=this.awaitIdentPos;return this.enterScope(qt(bt,!1)|or),this.initFunction(D),this.options.ecmaVersion>=8&&(D.async=!!bt),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,D.params=this.toAssignableList(Y,!0),this.parseFunctionBody(D,!0,!1),this.yieldPos=nt,this.awaitPos=se,this.awaitIdentPos=Ve,this.finishNode(D,"ArrowFunctionExpression")},er.parseFunctionBody=function(D,Y,bt){var nt=Y&&this.type!==rt.braceL,se=this.strict,Ve=!1;if(nt)D.body=this.parseMaybeAssign(),D.expression=!0,this.checkParams(D,!1);else{var wr=this.options.ecmaVersion>=7&&!this.isSimpleParamList(D.params);(!se||wr)&&(Ve=this.strictDirective(this.end),Ve&&wr&&this.raiseRecoverable(D.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var jr=this.labels;this.labels=[],Ve&&(this.strict=!0),this.checkParams(D,!se&&!Ve&&!Y&&!bt&&this.isSimpleParamList(D.params)),this.strict&&D.id&&this.checkLVal(D.id,We),D.body=this.parseBlock(!1,void 0,Ve&&!se),D.expression=!1,this.adaptDirectivePrologue(D.body.body),this.labels=jr}this.exitScope()},er.isSimpleParamList=function(D){for(var Y=0,bt=D;Y<bt.length;Y+=1){var nt=bt[Y];if(nt.type!=="Identifier")return!1}return!0},er.checkParams=function(D,Y){for(var bt={},nt=0,se=D.params;nt<se.length;nt+=1){var Ve=se[nt];this.checkLVal(Ve,Ct,Y?null:bt)}},er.parseExprList=function(D,Y,bt,nt){for(var se=[],Ve=!0;!this.eat(D);){if(Ve)Ve=!1;else if(this.expect(rt.comma),Y&&this.afterTrailingComma(D))break;var wr=void 0;bt&&this.type===rt.comma?wr=null:this.type===rt.ellipsis?(wr=this.parseSpread(nt),nt&&this.type===rt.comma&&nt.trailingComma<0&&(nt.trailingComma=this.start)):wr=this.parseMaybeAssign(!1,nt),se.push(wr)}return se},er.checkUnreserved=function(D){var Y=D.start,bt=D.end,nt=D.name;if(this.inGenerator&&nt==="yield"&&this.raiseRecoverable(Y,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&nt==="await"&&this.raiseRecoverable(Y,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(nt)&&this.raise(Y,"Unexpected keyword '"+nt+"'"),!(this.options.ecmaVersion<6&&this.input.slice(Y,bt).indexOf("\\")!==-1)){var se=this.strict?this.reservedWordsStrict:this.reservedWords;se.test(nt)&&(!this.inAsync&&nt==="await"&&this.raiseRecoverable(Y,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(Y,"The keyword '"+nt+"' is reserved"))}},er.parseIdent=function(D,Y){var bt=this.startNode();return this.type===rt.name?bt.name=this.value:this.type.keyword?(bt.name=this.type.keyword,(bt.name==="class"||bt.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop()):this.unexpected(),this.next(!!D),this.finishNode(bt,"Identifier"),D||(this.checkUnreserved(bt),bt.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=bt.start)),bt},er.parseYield=function(D){this.yieldPos||(this.yieldPos=this.start);var Y=this.startNode();return this.next(),this.type===rt.semi||this.canInsertSemicolon()||this.type!==rt.star&&!this.type.startsExpr?(Y.delegate=!1,Y.argument=null):(Y.delegate=this.eat(rt.star),Y.argument=this.parseMaybeAssign(D)),this.finishNode(Y,"YieldExpression")},er.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var D=this.startNode();return this.next(),D.argument=this.parseMaybeUnary(null,!1),this.finishNode(D,"AwaitExpression")};var Lr=zt.prototype;Lr.raise=function(D,Y){var bt=Vt(this.input,D);Y+=" ("+bt.line+":"+bt.column+")";var nt=new SyntaxError(Y);throw nt.pos=D,nt.loc=bt,nt.raisedAt=this.pos,nt},Lr.raiseRecoverable=Lr.raise,Lr.curPosition=function(){if(this.options.locations)return new W(this.curLine,this.pos-this.lineStart)};var Zr=zt.prototype,Tn=function(Y){this.flags=Y,this.var=[],this.lexical=[],this.functions=[]};Zr.enterScope=function(D){this.scopeStack.push(new Tn(D))},Zr.exitScope=function(){this.scopeStack.pop()},Zr.treatFunctionsAsVarInScope=function(D){return D.flags&Qt||!this.inModule&&D.flags&jt},Zr.declareName=function(D,Y,bt){var nt=!1;if(Y===Tt){var se=this.currentScope();nt=se.lexical.indexOf(D)>-1||se.functions.indexOf(D)>-1||se.var.indexOf(D)>-1,se.lexical.push(D),this.inModule&&se.flags&jt&&delete this.undefinedExports[D]}else if(Y===Oe){var Ve=this.currentScope();Ve.lexical.push(D)}else if(Y===ue){var wr=this.currentScope();this.treatFunctionsAsVar?nt=wr.lexical.indexOf(D)>-1:nt=wr.lexical.indexOf(D)>-1||wr.var.indexOf(D)>-1,wr.functions.push(D)}else for(var jr=this.scopeStack.length-1;jr>=0;--jr){var Vr=this.scopeStack[jr];if(Vr.lexical.indexOf(D)>-1&&!(Vr.flags&ie&&Vr.lexical[0]===D)||!this.treatFunctionsAsVarInScope(Vr)&&Vr.functions.indexOf(D)>-1){nt=!0;break}if(Vr.var.push(D),this.inModule&&Vr.flags&jt&&delete this.undefinedExports[D],Vr.flags&Te)break}nt&&this.raiseRecoverable(bt,"Identifier '"+D+"' has already been declared")},Zr.checkLocalExport=function(D){this.scopeStack[0].lexical.indexOf(D.name)===-1&&this.scopeStack[0].var.indexOf(D.name)===-1&&(this.undefinedExports[D.name]=D)},Zr.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Zr.currentVarScope=function(){for(var D=this.scopeStack.length-1;;D--){var Y=this.scopeStack[D];if(Y.flags&Te)return Y}},Zr.currentThisScope=function(){for(var D=this.scopeStack.length-1;;D--){var Y=this.scopeStack[D];if(Y.flags&Te&&!(Y.flags&or))return Y}};var rn=function(Y,bt,nt){this.type="",this.start=bt,this.end=0,Y.options.locations&&(this.loc=new dt(Y,nt)),Y.options.directSourceFile&&(this.sourceFile=Y.options.directSourceFile),Y.options.ranges&&(this.range=[bt,0])},Nn=zt.prototype;Nn.startNode=function(){return new rn(this,this.start,this.startLoc)},Nn.startNodeAt=function(D,Y){return new rn(this,D,Y)};function zn(D,Y,bt,nt){return D.type=Y,D.end=bt,this.options.locations&&(D.loc.end=nt),this.options.ranges&&(D.range[1]=bt),D}Nn.finishNode=function(D,Y){return zn.call(this,D,Y,this.lastTokEnd,this.lastTokEndLoc)},Nn.finishNodeAt=function(D,Y,bt,nt){return zn.call(this,D,Y,bt,nt)};var jn=function(Y,bt,nt,se,Ve){this.token=Y,this.isExpr=!!bt,this.preserveSpace=!!nt,this.override=se,this.generator=!!Ve},wn={b_stat:new jn("{",!1),b_expr:new jn("{",!0),b_tmpl:new jn("${",!1),p_stat:new jn("(",!1),p_expr:new jn("(",!0),q_tmpl:new jn("`",!0,!0,function(D){return D.tryReadTemplateToken()}),f_stat:new jn("function",!1),f_expr:new jn("function",!0),f_expr_gen:new jn("function",!0,!1,null,!0),f_gen:new jn("function",!1,!1,null,!0)},Wn=zt.prototype;Wn.initialContext=function(){return[wn.b_stat]},Wn.braceIsBlock=function(D){var Y=this.curContext();return Y===wn.f_expr||Y===wn.f_stat?!0:D===rt.colon&&(Y===wn.b_stat||Y===wn.b_expr)?!Y.isExpr:D===rt._return||D===rt.name&&this.exprAllowed?Dt.test(this.input.slice(this.lastTokEnd,this.start)):D===rt._else||D===rt.semi||D===rt.eof||D===rt.parenR||D===rt.arrow?!0:D===rt.braceL?Y===wn.b_stat:D===rt._var||D===rt._const||D===rt.name?!1:!this.exprAllowed},Wn.inGeneratorContext=function(){for(var D=this.context.length-1;D>=1;D--){var Y=this.context[D];if(Y.token==="function")return Y.generator}return!1},Wn.updateContext=function(D){var Y,bt=this.type;bt.keyword&&D===rt.dot?this.exprAllowed=!1:(Y=bt.updateContext)?Y.call(this,D):this.exprAllowed=bt.beforeExpr},rt.parenR.updateContext=rt.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var D=this.context.pop();D===wn.b_stat&&this.curContext().token==="function"&&(D=this.context.pop()),this.exprAllowed=!D.isExpr},rt.braceL.updateContext=function(D){this.context.push(this.braceIsBlock(D)?wn.b_stat:wn.b_expr),this.exprAllowed=!0},rt.dollarBraceL.updateContext=function(){this.context.push(wn.b_tmpl),this.exprAllowed=!0},rt.parenL.updateContext=function(D){var Y=D===rt._if||D===rt._for||D===rt._with||D===rt._while;this.context.push(Y?wn.p_stat:wn.p_expr),this.exprAllowed=!0},rt.incDec.updateContext=function(){},rt._function.updateContext=rt._class.updateContext=function(D){D.beforeExpr&&D!==rt.semi&&D!==rt._else&&!(D===rt._return&&Dt.test(this.input.slice(this.lastTokEnd,this.start)))&&!((D===rt.colon||D===rt.braceL)&&this.curContext()===wn.b_stat)?this.context.push(wn.f_expr):this.context.push(wn.f_stat),this.exprAllowed=!1},rt.backQuote.updateContext=function(){this.curContext()===wn.q_tmpl?this.context.pop():this.context.push(wn.q_tmpl),this.exprAllowed=!1},rt.star.updateContext=function(D){if(D===rt._function){var Y=this.context.length-1;this.context[Y]===wn.f_expr?this.context[Y]=wn.f_expr_gen:this.context[Y]=wn.f_gen}this.exprAllowed=!0},rt.name.updateContext=function(D){var Y=!1;this.options.ecmaVersion>=6&&D!==rt.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(Y=!0),this.exprAllowed=Y};var Bt="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Yt=Bt+" Extended_Pictographic",oe=Yt,Ce={9:Bt,10:Yt,11:oe},Ue="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",fr="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Sr=fr+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",Pe=Sr+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",ur={9:fr,10:Sr,11:Pe},Wr={};function Sn(D){var Y=Wr[D]={binary:vt(Ce[D]+" "+Ue),nonBinary:{General_Category:vt(Ue),Script:vt(ur[D])}};Y.nonBinary.Script_Extensions=Y.nonBinary.Script,Y.nonBinary.gc=Y.nonBinary.General_Category,Y.nonBinary.sc=Y.nonBinary.Script,Y.nonBinary.scx=Y.nonBinary.Script_Extensions}Sn(9),Sn(10),Sn(11);var qr=zt.prototype,Qr=function(Y){this.parser=Y,this.validFlags="gim"+(Y.options.ecmaVersion>=6?"uy":"")+(Y.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Wr[Y.options.ecmaVersion>=11?11:Y.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};Qr.prototype.reset=function(Y,bt,nt){var se=nt.indexOf("u")!==-1;this.start=Y|0,this.source=bt+"",this.flags=nt,this.switchU=se&&this.parser.options.ecmaVersion>=6,this.switchN=se&&this.parser.options.ecmaVersion>=9},Qr.prototype.raise=function(Y){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+Y)},Qr.prototype.at=function(Y,bt){bt===void 0&&(bt=!1);var nt=this.source,se=nt.length;if(Y>=se)return-1;var Ve=nt.charCodeAt(Y);if(!(bt||this.switchU)||Ve<=55295||Ve>=57344||Y+1>=se)return Ve;var wr=nt.charCodeAt(Y+1);return wr>=56320&&wr<=57343?(Ve<<10)+wr-56613888:Ve},Qr.prototype.nextIndex=function(Y,bt){bt===void 0&&(bt=!1);var nt=this.source,se=nt.length;if(Y>=se)return se;var Ve=nt.charCodeAt(Y),wr;return!(bt||this.switchU)||Ve<=55295||Ve>=57344||Y+1>=se||(wr=nt.charCodeAt(Y+1))<56320||wr>57343?Y+1:Y+2},Qr.prototype.current=function(Y){return Y===void 0&&(Y=!1),this.at(this.pos,Y)},Qr.prototype.lookahead=function(Y){return Y===void 0&&(Y=!1),this.at(this.nextIndex(this.pos,Y),Y)},Qr.prototype.advance=function(Y){Y===void 0&&(Y=!1),this.pos=this.nextIndex(this.pos,Y)},Qr.prototype.eat=function(Y,bt){return bt===void 0&&(bt=!1),this.current(bt)===Y?(this.advance(bt),!0):!1};function Mn(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}qr.validateRegExpFlags=function(D){for(var Y=D.validFlags,bt=D.flags,nt=0;nt<bt.length;nt++){var se=bt.charAt(nt);Y.indexOf(se)===-1&&this.raise(D.start,"Invalid regular expression flag"),bt.indexOf(se,nt+1)>-1&&this.raise(D.start,"Duplicate regular expression flag")}},qr.validateRegExpPattern=function(D){this.regexp_pattern(D),!D.switchN&&this.options.ecmaVersion>=9&&D.groupNames.length>0&&(D.switchN=!0,this.regexp_pattern(D))},qr.regexp_pattern=function(D){D.pos=0,D.lastIntValue=0,D.lastStringValue="",D.lastAssertionIsQuantifiable=!1,D.numCapturingParens=0,D.maxBackReference=0,D.groupNames.length=0,D.backReferenceNames.length=0,this.regexp_disjunction(D),D.pos!==D.source.length&&(D.eat(41)&&D.raise("Unmatched ')'"),(D.eat(93)||D.eat(125))&&D.raise("Lone quantifier brackets")),D.maxBackReference>D.numCapturingParens&&D.raise("Invalid escape");for(var Y=0,bt=D.backReferenceNames;Y<bt.length;Y+=1){var nt=bt[Y];D.groupNames.indexOf(nt)===-1&&D.raise("Invalid named capture referenced")}},qr.regexp_disjunction=function(D){for(this.regexp_alternative(D);D.eat(124);)this.regexp_alternative(D);this.regexp_eatQuantifier(D,!0)&&D.raise("Nothing to repeat"),D.eat(123)&&D.raise("Lone quantifier brackets")},qr.regexp_alternative=function(D){for(;D.pos<D.source.length&&this.regexp_eatTerm(D););},qr.regexp_eatTerm=function(D){return this.regexp_eatAssertion(D)?(D.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(D)&&D.switchU&&D.raise("Invalid quantifier"),!0):(D.switchU?this.regexp_eatAtom(D):this.regexp_eatExtendedAtom(D))?(this.regexp_eatQuantifier(D),!0):!1},qr.regexp_eatAssertion=function(D){var Y=D.pos;if(D.lastAssertionIsQuantifiable=!1,D.eat(94)||D.eat(36))return!0;if(D.eat(92)){if(D.eat(66)||D.eat(98))return!0;D.pos=Y}if(D.eat(40)&&D.eat(63)){var bt=!1;if(this.options.ecmaVersion>=9&&(bt=D.eat(60)),D.eat(61)||D.eat(33))return this.regexp_disjunction(D),D.eat(41)||D.raise("Unterminated group"),D.lastAssertionIsQuantifiable=!bt,!0}return D.pos=Y,!1},qr.regexp_eatQuantifier=function(D,Y){return Y===void 0&&(Y=!1),this.regexp_eatQuantifierPrefix(D,Y)?(D.eat(63),!0):!1},qr.regexp_eatQuantifierPrefix=function(D,Y){return D.eat(42)||D.eat(43)||D.eat(63)||this.regexp_eatBracedQuantifier(D,Y)},qr.regexp_eatBracedQuantifier=function(D,Y){var bt=D.pos;if(D.eat(123)){var nt=0,se=-1;if(this.regexp_eatDecimalDigits(D)&&(nt=D.lastIntValue,D.eat(44)&&this.regexp_eatDecimalDigits(D)&&(se=D.lastIntValue),D.eat(125)))return se!==-1&&se<nt&&!Y&&D.raise("numbers out of order in {} quantifier"),!0;D.switchU&&!Y&&D.raise("Incomplete quantifier"),D.pos=bt}return!1},qr.regexp_eatAtom=function(D){return this.regexp_eatPatternCharacters(D)||D.eat(46)||this.regexp_eatReverseSolidusAtomEscape(D)||this.regexp_eatCharacterClass(D)||this.regexp_eatUncapturingGroup(D)||this.regexp_eatCapturingGroup(D)},qr.regexp_eatReverseSolidusAtomEscape=function(D){var Y=D.pos;if(D.eat(92)){if(this.regexp_eatAtomEscape(D))return!0;D.pos=Y}return!1},qr.regexp_eatUncapturingGroup=function(D){var Y=D.pos;if(D.eat(40)){if(D.eat(63)&&D.eat(58)){if(this.regexp_disjunction(D),D.eat(41))return!0;D.raise("Unterminated group")}D.pos=Y}return!1},qr.regexp_eatCapturingGroup=function(D){if(D.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(D):D.current()===63&&D.raise("Invalid group"),this.regexp_disjunction(D),D.eat(41))return D.numCapturingParens+=1,!0;D.raise("Unterminated group")}return!1},qr.regexp_eatExtendedAtom=function(D){return D.eat(46)||this.regexp_eatReverseSolidusAtomEscape(D)||this.regexp_eatCharacterClass(D)||this.regexp_eatUncapturingGroup(D)||this.regexp_eatCapturingGroup(D)||this.regexp_eatInvalidBracedQuantifier(D)||this.regexp_eatExtendedPatternCharacter(D)},qr.regexp_eatInvalidBracedQuantifier=function(D){return this.regexp_eatBracedQuantifier(D,!0)&&D.raise("Nothing to repeat"),!1},qr.regexp_eatSyntaxCharacter=function(D){var Y=D.current();return bi(Y)?(D.lastIntValue=Y,D.advance(),!0):!1};function bi(D){return D===36||D>=40&&D<=43||D===46||D===63||D>=91&&D<=94||D>=123&&D<=125}qr.regexp_eatPatternCharacters=function(D){for(var Y=D.pos,bt=0;(bt=D.current())!==-1&&!bi(bt);)D.advance();return D.pos!==Y},qr.regexp_eatExtendedPatternCharacter=function(D){var Y=D.current();return Y!==-1&&Y!==36&&!(Y>=40&&Y<=43)&&Y!==46&&Y!==63&&Y!==91&&Y!==94&&Y!==124?(D.advance(),!0):!1},qr.regexp_groupSpecifier=function(D){if(D.eat(63)){if(this.regexp_eatGroupName(D)){D.groupNames.indexOf(D.lastStringValue)!==-1&&D.raise("Duplicate capture group name"),D.groupNames.push(D.lastStringValue);return}D.raise("Invalid group")}},qr.regexp_eatGroupName=function(D){if(D.lastStringValue="",D.eat(60)){if(this.regexp_eatRegExpIdentifierName(D)&&D.eat(62))return!0;D.raise("Invalid capture group name")}return!1},qr.regexp_eatRegExpIdentifierName=function(D){if(D.lastStringValue="",this.regexp_eatRegExpIdentifierStart(D)){for(D.lastStringValue+=Mn(D.lastIntValue);this.regexp_eatRegExpIdentifierPart(D);)D.lastStringValue+=Mn(D.lastIntValue);return!0}return!1},qr.regexp_eatRegExpIdentifierStart=function(D){var Y=D.pos,bt=this.options.ecmaVersion>=11,nt=D.current(bt);return D.advance(bt),nt===92&&this.regexp_eatRegExpUnicodeEscapeSequence(D,bt)&&(nt=D.lastIntValue),Si(nt)?(D.lastIntValue=nt,!0):(D.pos=Y,!1)};function Si(D){return Zt(D,!0)||D===36||D===95}qr.regexp_eatRegExpIdentifierPart=function(D){var Y=D.pos,bt=this.options.ecmaVersion>=11,nt=D.current(bt);return D.advance(bt),nt===92&&this.regexp_eatRegExpUnicodeEscapeSequence(D,bt)&&(nt=D.lastIntValue),Kr(nt)?(D.lastIntValue=nt,!0):(D.pos=Y,!1)};function Kr(D){return P(D,!0)||D===36||D===95||D===8204||D===8205}qr.regexp_eatAtomEscape=function(D){return this.regexp_eatBackReference(D)||this.regexp_eatCharacterClassEscape(D)||this.regexp_eatCharacterEscape(D)||D.switchN&&this.regexp_eatKGroupName(D)?!0:(D.switchU&&(D.current()===99&&D.raise("Invalid unicode escape"),D.raise("Invalid escape")),!1)},qr.regexp_eatBackReference=function(D){var Y=D.pos;if(this.regexp_eatDecimalEscape(D)){var bt=D.lastIntValue;if(D.switchU)return bt>D.maxBackReference&&(D.maxBackReference=bt),!0;if(bt<=D.numCapturingParens)return!0;D.pos=Y}return!1},qr.regexp_eatKGroupName=function(D){if(D.eat(107)){if(this.regexp_eatGroupName(D))return D.backReferenceNames.push(D.lastStringValue),!0;D.raise("Invalid named reference")}return!1},qr.regexp_eatCharacterEscape=function(D){return this.regexp_eatControlEscape(D)||this.regexp_eatCControlLetter(D)||this.regexp_eatZero(D)||this.regexp_eatHexEscapeSequence(D)||this.regexp_eatRegExpUnicodeEscapeSequence(D,!1)||!D.switchU&&this.regexp_eatLegacyOctalEscapeSequence(D)||this.regexp_eatIdentityEscape(D)},qr.regexp_eatCControlLetter=function(D){var Y=D.pos;if(D.eat(99)){if(this.regexp_eatControlLetter(D))return!0;D.pos=Y}return!1},qr.regexp_eatZero=function(D){return D.current()===48&&!Ba(D.lookahead())?(D.lastIntValue=0,D.advance(),!0):!1},qr.regexp_eatControlEscape=function(D){var Y=D.current();return Y===116?(D.lastIntValue=9,D.advance(),!0):Y===110?(D.lastIntValue=10,D.advance(),!0):Y===118?(D.lastIntValue=11,D.advance(),!0):Y===102?(D.lastIntValue=12,D.advance(),!0):Y===114?(D.lastIntValue=13,D.advance(),!0):!1},qr.regexp_eatControlLetter=function(D){var Y=D.current();return ai(Y)?(D.lastIntValue=Y%32,D.advance(),!0):!1};function ai(D){return D>=65&&D<=90||D>=97&&D<=122}qr.regexp_eatRegExpUnicodeEscapeSequence=function(D,Y){Y===void 0&&(Y=!1);var bt=D.pos,nt=Y||D.switchU;if(D.eat(117)){if(this.regexp_eatFixedHexDigits(D,4)){var se=D.lastIntValue;if(nt&&se>=55296&&se<=56319){var Ve=D.pos;if(D.eat(92)&&D.eat(117)&&this.regexp_eatFixedHexDigits(D,4)){var wr=D.lastIntValue;if(wr>=56320&&wr<=57343)return D.lastIntValue=(se-55296)*1024+(wr-56320)+65536,!0}D.pos=Ve,D.lastIntValue=se}return!0}if(nt&&D.eat(123)&&this.regexp_eatHexDigits(D)&&D.eat(125)&&li(D.lastIntValue))return!0;nt&&D.raise("Invalid unicode escape"),D.pos=bt}return!1};function li(D){return D>=0&&D<=1114111}qr.regexp_eatIdentityEscape=function(D){if(D.switchU)return this.regexp_eatSyntaxCharacter(D)?!0:D.eat(47)?(D.lastIntValue=47,!0):!1;var Y=D.current();return Y!==99&&(!D.switchN||Y!==107)?(D.lastIntValue=Y,D.advance(),!0):!1},qr.regexp_eatDecimalEscape=function(D){D.lastIntValue=0;var Y=D.current();if(Y>=49&&Y<=57){do D.lastIntValue=10*D.lastIntValue+(Y-48),D.advance();while((Y=D.current())>=48&&Y<=57);return!0}return!1},qr.regexp_eatCharacterClassEscape=function(D){var Y=D.current();if(hi(Y))return D.lastIntValue=-1,D.advance(),!0;if(D.switchU&&this.options.ecmaVersion>=9&&(Y===80||Y===112)){if(D.lastIntValue=-1,D.advance(),D.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(D)&&D.eat(125))return!0;D.raise("Invalid property name")}return!1};function hi(D){return D===100||D===68||D===115||D===83||D===119||D===87}qr.regexp_eatUnicodePropertyValueExpression=function(D){var Y=D.pos;if(this.regexp_eatUnicodePropertyName(D)&&D.eat(61)){var bt=D.lastStringValue;if(this.regexp_eatUnicodePropertyValue(D)){var nt=D.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(D,bt,nt),!0}}if(D.pos=Y,this.regexp_eatLoneUnicodePropertyNameOrValue(D)){var se=D.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(D,se),!0}return!1},qr.regexp_validateUnicodePropertyNameAndValue=function(D,Y,bt){Pt(D.unicodeProperties.nonBinary,Y)||D.raise("Invalid property name"),D.unicodeProperties.nonBinary[Y].test(bt)||D.raise("Invalid property value")},qr.regexp_validateUnicodePropertyNameOrValue=function(D,Y){D.unicodeProperties.binary.test(Y)||D.raise("Invalid property name")},qr.regexp_eatUnicodePropertyName=function(D){var Y=0;for(D.lastStringValue="";ra(Y=D.current());)D.lastStringValue+=Mn(Y),D.advance();return D.lastStringValue!==""};function ra(D){return ai(D)||D===95}qr.regexp_eatUnicodePropertyValue=function(D){var Y=0;for(D.lastStringValue="";Ci(Y=D.current());)D.lastStringValue+=Mn(Y),D.advance();return D.lastStringValue!==""};function Ci(D){return ra(D)||Ba(D)}qr.regexp_eatLoneUnicodePropertyNameOrValue=function(D){return this.regexp_eatUnicodePropertyValue(D)},qr.regexp_eatCharacterClass=function(D){if(D.eat(91)){if(D.eat(94),this.regexp_classRanges(D),D.eat(93))return!0;D.raise("Unterminated character class")}return!1},qr.regexp_classRanges=function(D){for(;this.regexp_eatClassAtom(D);){var Y=D.lastIntValue;if(D.eat(45)&&this.regexp_eatClassAtom(D)){var bt=D.lastIntValue;D.switchU&&(Y===-1||bt===-1)&&D.raise("Invalid character class"),Y!==-1&&bt!==-1&&Y>bt&&D.raise("Range out of order in character class")}}},qr.regexp_eatClassAtom=function(D){var Y=D.pos;if(D.eat(92)){if(this.regexp_eatClassEscape(D))return!0;if(D.switchU){var bt=D.current();(bt===99||Xa(bt))&&D.raise("Invalid class escape"),D.raise("Invalid escape")}D.pos=Y}var nt=D.current();return nt!==93?(D.lastIntValue=nt,D.advance(),!0):!1},qr.regexp_eatClassEscape=function(D){var Y=D.pos;if(D.eat(98))return D.lastIntValue=8,!0;if(D.switchU&&D.eat(45))return D.lastIntValue=45,!0;if(!D.switchU&&D.eat(99)){if(this.regexp_eatClassControlLetter(D))return!0;D.pos=Y}return this.regexp_eatCharacterClassEscape(D)||this.regexp_eatCharacterEscape(D)},qr.regexp_eatClassControlLetter=function(D){var Y=D.current();return Ba(Y)||Y===95?(D.lastIntValue=Y%32,D.advance(),!0):!1},qr.regexp_eatHexEscapeSequence=function(D){var Y=D.pos;if(D.eat(120)){if(this.regexp_eatFixedHexDigits(D,2))return!0;D.switchU&&D.raise("Invalid escape"),D.pos=Y}return!1},qr.regexp_eatDecimalDigits=function(D){var Y=D.pos,bt=0;for(D.lastIntValue=0;Ba(bt=D.current());)D.lastIntValue=10*D.lastIntValue+(bt-48),D.advance();return D.pos!==Y};function Ba(D){return D>=48&&D<=57}qr.regexp_eatHexDigits=function(D){var Y=D.pos,bt=0;for(D.lastIntValue=0;po(bt=D.current());)D.lastIntValue=16*D.lastIntValue+za(bt),D.advance();return D.pos!==Y};function po(D){return D>=48&&D<=57||D>=65&&D<=70||D>=97&&D<=102}function za(D){return D>=65&&D<=70?10+(D-65):D>=97&&D<=102?10+(D-97):D-48}qr.regexp_eatLegacyOctalEscapeSequence=function(D){if(this.regexp_eatOctalDigit(D)){var Y=D.lastIntValue;if(this.regexp_eatOctalDigit(D)){var bt=D.lastIntValue;Y<=3&&this.regexp_eatOctalDigit(D)?D.lastIntValue=Y*64+bt*8+D.lastIntValue:D.lastIntValue=Y*8+bt}else D.lastIntValue=Y;return!0}return!1},qr.regexp_eatOctalDigit=function(D){var Y=D.current();return Xa(Y)?(D.lastIntValue=Y-48,D.advance(),!0):(D.lastIntValue=0,!1)};function Xa(D){return D>=48&&D<=55}qr.regexp_eatFixedHexDigits=function(D,Y){var bt=D.pos;D.lastIntValue=0;for(var nt=0;nt<Y;++nt){var se=D.current();if(!po(se))return D.pos=bt,!1;D.lastIntValue=16*D.lastIntValue+za(se),D.advance()}return!0};var Ta=function(Y){this.type=Y.type,this.value=Y.value,this.start=Y.start,this.end=Y.end,Y.options.locations&&(this.loc=new dt(Y,Y.startLoc,Y.endLoc)),Y.options.ranges&&(this.range=[Y.start,Y.end])},ga=zt.prototype;ga.next=function(D){!D&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Ta(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},ga.getToken=function(){return this.next(),new Ta(this)},typeof Symbol!="undefined"&&(ga[Symbol.iterator]=function(){var D=this;return{next:function(){var Y=D.getToken();return{done:Y.type===rt.eof,value:Y}}}}),ga.curContext=function(){return this.context[this.context.length-1]},ga.nextToken=function(){var D=this.curContext();if((!D||!D.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(rt.eof);if(D.override)return D.override(this);this.readToken(this.fullCharCodeAtPos())},ga.readToken=function(D){return Zt(D,this.options.ecmaVersion>=6)||D===92?this.readWord():this.getTokenFromCode(D)},ga.fullCharCodeAtPos=function(){var D=this.input.charCodeAt(this.pos);if(D<=55295||D>=57344)return D;var Y=this.input.charCodeAt(this.pos+1);return(D<<10)+Y-56613888},ga.skipBlockComment=function(){var D=this.options.onComment&&this.curPosition(),Y=this.pos,bt=this.input.indexOf("*/",this.pos+=2);if(bt===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=bt+2,this.options.locations){Ae.lastIndex=Y;for(var nt;(nt=Ae.exec(this.input))&&nt.index<this.pos;)++this.curLine,this.lineStart=nt.index+nt[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(Y+2,bt),Y,this.pos,D,this.curPosition())},ga.skipLineComment=function(D){for(var Y=this.pos,bt=this.options.onComment&&this.curPosition(),nt=this.input.charCodeAt(this.pos+=D);this.pos<this.input.length&&!be(nt);)nt=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(Y+D,this.pos),Y,this.pos,bt,this.curPosition())},ga.skipSpace=function(){t:for(;this.pos<this.input.length;){var D=this.input.charCodeAt(this.pos);switch(D){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(D>8&&D<14||D>=5760&&me.test(String.fromCharCode(D)))++this.pos;else break t}}},ga.finishToken=function(D,Y){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var bt=this.type;this.type=D,this.value=Y,this.updateContext(bt)},ga.readToken_dot=function(){var D=this.input.charCodeAt(this.pos+1);if(D>=48&&D<=57)return this.readNumber(!0);var Y=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&D===46&&Y===46?(this.pos+=3,this.finishToken(rt.ellipsis)):(++this.pos,this.finishToken(rt.dot))},ga.readToken_slash=function(){var D=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):D===61?this.finishOp(rt.assign,2):this.finishOp(rt.slash,1)},ga.readToken_mult_modulo_exp=function(D){var Y=this.input.charCodeAt(this.pos+1),bt=1,nt=D===42?rt.star:rt.modulo;return this.options.ecmaVersion>=7&&D===42&&Y===42&&(++bt,nt=rt.starstar,Y=this.input.charCodeAt(this.pos+2)),Y===61?this.finishOp(rt.assign,bt+1):this.finishOp(nt,bt)},ga.readToken_pipe_amp=function(D){var Y=this.input.charCodeAt(this.pos+1);if(Y===D){if(this.options.ecmaVersion>=12){var bt=this.input.charCodeAt(this.pos+2);if(bt===61)return this.finishOp(rt.assign,3)}return this.finishOp(D===124?rt.logicalOR:rt.logicalAND,2)}return Y===61?this.finishOp(rt.assign,2):this.finishOp(D===124?rt.bitwiseOR:rt.bitwiseAND,1)},ga.readToken_caret=function(){var D=this.input.charCodeAt(this.pos+1);return D===61?this.finishOp(rt.assign,2):this.finishOp(rt.bitwiseXOR,1)},ga.readToken_plus_min=function(D){var Y=this.input.charCodeAt(this.pos+1);return Y===D?Y===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Dt.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(rt.incDec,2):Y===61?this.finishOp(rt.assign,2):this.finishOp(rt.plusMin,1)},ga.readToken_lt_gt=function(D){var Y=this.input.charCodeAt(this.pos+1),bt=1;return Y===D?(bt=D===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+bt)===61?this.finishOp(rt.assign,bt+1):this.finishOp(rt.bitShift,bt)):Y===33&&D===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(Y===61&&(bt=2),this.finishOp(rt.relational,bt))},ga.readToken_eq_excl=function(D){var Y=this.input.charCodeAt(this.pos+1);return Y===61?this.finishOp(rt.equality,this.input.charCodeAt(this.pos+2)===61?3:2):D===61&&Y===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(rt.arrow)):this.finishOp(D===61?rt.eq:rt.prefix,1)},ga.readToken_question=function(){var D=this.options.ecmaVersion;if(D>=11){var Y=this.input.charCodeAt(this.pos+1);if(Y===46){var bt=this.input.charCodeAt(this.pos+2);if(bt<48||bt>57)return this.finishOp(rt.questionDot,2)}if(Y===63){if(D>=12){var nt=this.input.charCodeAt(this.pos+2);if(nt===61)return this.finishOp(rt.assign,3)}return this.finishOp(rt.coalesce,2)}}return this.finishOp(rt.question,1)},ga.getTokenFromCode=function(D){switch(D){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(rt.parenL);case 41:return++this.pos,this.finishToken(rt.parenR);case 59:return++this.pos,this.finishToken(rt.semi);case 44:return++this.pos,this.finishToken(rt.comma);case 91:return++this.pos,this.finishToken(rt.bracketL);case 93:return++this.pos,this.finishToken(rt.bracketR);case 123:return++this.pos,this.finishToken(rt.braceL);case 125:return++this.pos,this.finishToken(rt.braceR);case 58:return++this.pos,this.finishToken(rt.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(rt.backQuote);case 48:var Y=this.input.charCodeAt(this.pos+1);if(Y===120||Y===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(Y===111||Y===79)return this.readRadixNumber(8);if(Y===98||Y===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(D);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(D);case 124:case 38:return this.readToken_pipe_amp(D);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(D);case 60:case 62:return this.readToken_lt_gt(D);case 61:case 33:return this.readToken_eq_excl(D);case 63:return this.readToken_question();case 126:return this.finishOp(rt.prefix,1)}this.raise(this.pos,"Unexpected character '"+vo(D)+"'")},ga.finishOp=function(D,Y){var bt=this.input.slice(this.pos,this.pos+Y);return this.pos+=Y,this.finishToken(D,bt)},ga.readRegexp=function(){for(var D,Y,bt=this.pos;;){this.pos>=this.input.length&&this.raise(bt,"Unterminated regular expression");var nt=this.input.charAt(this.pos);if(Dt.test(nt)&&this.raise(bt,"Unterminated regular expression"),D)D=!1;else{if(nt==="[")Y=!0;else if(nt==="]"&&Y)Y=!1;else if(nt==="/"&&!Y)break;D=nt==="\\"}++this.pos}var se=this.input.slice(bt,this.pos);++this.pos;var Ve=this.pos,wr=this.readWord1();this.containsEsc&&this.unexpected(Ve);var jr=this.regexpState||(this.regexpState=new Qr(this));jr.reset(bt,se,wr),this.validateRegExpFlags(jr),this.validateRegExpPattern(jr);var Vr=null;try{Vr=new RegExp(se,wr)}catch(Ln){}return this.finishToken(rt.regexp,{pattern:se,flags:wr,value:Vr})},ga.readInt=function(D,Y,bt){for(var nt=this.options.ecmaVersion>=12&&Y===void 0,se=bt&&this.input.charCodeAt(this.pos)===48,Ve=this.pos,wr=0,jr=0,Vr=0,Ln=Y==null?1/0:Y;Vr<Ln;++Vr,++this.pos){var Gn=this.input.charCodeAt(this.pos),$i=void 0;if(nt&&Gn===95){se&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),jr===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),Vr===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),jr=Gn;continue}if(Gn>=97?$i=Gn-97+10:Gn>=65?$i=Gn-65+10:Gn>=48&&Gn<=57?$i=Gn-48:$i=1/0,$i>=D)break;jr=Gn,wr=wr*D+$i}return nt&&jr===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ve||Y!=null&&this.pos-Ve!==Y?null:wr};function no(D,Y){return Y?parseInt(D,8):parseFloat(D.replace(/_/g,""))}function Vo(D){return typeof BigInt!="function"?null:BigInt(D.replace(/_/g,""))}ga.readRadixNumber=function(D){var Y=this.pos;this.pos+=2;var bt=this.readInt(D);return bt==null&&this.raise(this.start+2,"Expected number in radix "+D),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(bt=Vo(this.input.slice(Y,this.pos)),++this.pos):Zt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(rt.num,bt)},ga.readNumber=function(D){var Y=this.pos;!D&&this.readInt(10,void 0,!0)===null&&this.raise(Y,"Invalid number");var bt=this.pos-Y>=2&&this.input.charCodeAt(Y)===48;bt&&this.strict&&this.raise(Y,"Invalid number");var nt=this.input.charCodeAt(this.pos);if(!bt&&!D&&this.options.ecmaVersion>=11&&nt===110){var se=Vo(this.input.slice(Y,this.pos));return++this.pos,Zt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(rt.num,se)}bt&&/[89]/.test(this.input.slice(Y,this.pos))&&(bt=!1),nt===46&&!bt&&(++this.pos,this.readInt(10),nt=this.input.charCodeAt(this.pos)),(nt===69||nt===101)&&!bt&&(nt=this.input.charCodeAt(++this.pos),(nt===43||nt===45)&&++this.pos,this.readInt(10)===null&&this.raise(Y,"Invalid number")),Zt(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ve=no(this.input.slice(Y,this.pos),bt);return this.finishToken(rt.num,Ve)},ga.readCodePoint=function(){var D=this.input.charCodeAt(this.pos),Y;if(D===123){this.options.ecmaVersion<6&&this.unexpected();var bt=++this.pos;Y=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,Y>1114111&&this.invalidStringToken(bt,"Code point out of bounds")}else Y=this.readHexChar(4);return Y};function vo(D){return D<=65535?String.fromCharCode(D):(D-=65536,String.fromCharCode((D>>10)+55296,(D&1023)+56320))}ga.readString=function(D){for(var Y="",bt=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var nt=this.input.charCodeAt(this.pos);if(nt===D)break;nt===92?(Y+=this.input.slice(bt,this.pos),Y+=this.readEscapedChar(!1),bt=this.pos):(be(nt,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return Y+=this.input.slice(bt,this.pos++),this.finishToken(rt.string,Y)};var ja={};ga.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(D){if(D===ja)this.readInvalidTemplateToken();else throw D}this.inTemplateElement=!1},ga.invalidStringToken=function(D,Y){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw ja;this.raise(D,Y)},ga.readTmplToken=function(){for(var D="",Y=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var bt=this.input.charCodeAt(this.pos);if(bt===96||bt===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===rt.template||this.type===rt.invalidTemplate)?bt===36?(this.pos+=2,this.finishToken(rt.dollarBraceL)):(++this.pos,this.finishToken(rt.backQuote)):(D+=this.input.slice(Y,this.pos),this.finishToken(rt.template,D));if(bt===92)D+=this.input.slice(Y,this.pos),D+=this.readEscapedChar(!0),Y=this.pos;else if(be(bt)){switch(D+=this.input.slice(Y,this.pos),++this.pos,bt){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:D+=`
`;break;default:D+=String.fromCharCode(bt);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),Y=this.pos}else++this.pos}},ga.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(rt.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},ga.readEscapedChar=function(D){var Y=this.input.charCodeAt(++this.pos);switch(++this.pos,Y){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return vo(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(D){var bt=this.pos-1;return this.invalidStringToken(bt,"Invalid escape sequence in template string"),null}default:if(Y>=48&&Y<=55){var nt=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],se=parseInt(nt,8);return se>255&&(nt=nt.slice(0,-1),se=parseInt(nt,8)),this.pos+=nt.length-1,Y=this.input.charCodeAt(this.pos),(nt!=="0"||Y===56||Y===57)&&(this.strict||D)&&this.invalidStringToken(this.pos-1-nt.length,D?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(se)}return be(Y)?"":String.fromCharCode(Y)}},ga.readHexChar=function(D){var Y=this.pos,bt=this.readInt(16,D);return bt===null&&this.invalidStringToken(Y,"Bad character escape sequence"),bt},ga.readWord1=function(){this.containsEsc=!1;for(var D="",Y=!0,bt=this.pos,nt=this.options.ecmaVersion>=6;this.pos<this.input.length;){var se=this.fullCharCodeAtPos();if(P(se,nt))this.pos+=se<=65535?1:2;else if(se===92){this.containsEsc=!0,D+=this.input.slice(bt,this.pos);var Ve=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var wr=this.readCodePoint();(Y?Zt:P)(wr,nt)||this.invalidStringToken(Ve,"Invalid Unicode escape"),D+=vo(wr),bt=this.pos}else break;Y=!1}return D+this.input.slice(bt,this.pos)},ga.readWord=function(){var D=this.readWord1(),Y=rt.name;return this.keywords.test(D)&&(Y=Ie[D]),this.finishToken(Y,D)};var to="7.4.1";zt.acorn={Parser:zt,version:to,defaultOptions:ne,Position:W,SourceLocation:dt,getLineInfo:Vt,Node:rn,TokenType:b,tokTypes:rt,keywordTypes:Ie,TokContext:jn,tokContexts:wn,isIdentifierChar:P,isIdentifierStart:Zt,Token:Ta,isNewLine:be,lineBreak:Dt,lineBreakG:Ae,nonASCIIwhitespace:me};function Uo(D,Y){return zt.parse(D,Y)}function ju(D,Y,bt){return zt.parseExpressionAt(D,Y,bt)}function Wo(D,Y){return zt.tokenizer(D,Y)}function bo(D,Y){D.prototype=Object.create(Y.prototype),D.prototype.constructor=D,D.__proto__=Y}function nr(D){var Y=typeof Map=="function"?new Map:void 0;return nr=function(nt){if(nt===null||!Mr(nt))return nt;if(typeof nt!="function")throw new TypeError("Super expression must either be null or a function");if(typeof Y!="undefined"){if(Y.has(nt))return Y.get(nt);Y.set(nt,se)}function se(){return He(nt,arguments,In(this).constructor)}return se.prototype=Object.create(nt.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),tn(se,nt)},nr(D)}function xe(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(D){return!1}}function He(D,Y,bt){return xe()?He=Reflect.construct:He=function(se,Ve,wr){var jr=[null];jr.push.apply(jr,Ve);var Vr=Function.bind.apply(se,jr),Ln=new Vr;return wr&&tn(Ln,wr.prototype),Ln},He.apply(null,arguments)}function Mr(D){return Function.toString.call(D).indexOf("[native code]")!==-1}function tn(D,Y){return tn=Object.setPrototypeOf||function(nt,se){return nt.__proto__=se,nt},tn(D,Y)}function In(D){return In=Object.setPrototypeOf?Object.getPrototypeOf:function(bt){return bt.__proto__||Object.getPrototypeOf(bt)},In(D)}var Un=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(nr(Error)),Cn=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(nr(SyntaxError)),ta=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(nr(ReferenceError)),Wa=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(nr(TypeError)),es=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(Un),ko=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(Cn),ns=function(D){bo(Y,D);function Y(){return D.apply(this,arguments)||this}return Y}(ta),Ya={UnknownError:[3001,"%0",es],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",es],NodeTypeSyntaxError:[1001,"Unknown node type: %0",ns],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",ns],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",ns],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",ns],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",ns],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",ns],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",ns],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",ns],ParamTypeSyntaxError:[1009,"Unknown param type: %0",ns],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",ns],FunctionUndefinedReferenceError:[2001,"%0 is not a function",ta],VariableUndefinedReferenceError:[2002,"%0 is not defined",ta],IsNotConstructor:[2003,"%0 is not a constructor",Wa]};function Go(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(D){return!1}}function pu(D,Y,bt){return Go()?pu=Reflect.construct:pu=function(se,Ve,wr){var jr=[null];jr.push.apply(jr,Ve);var Vr=Function.bind.apply(se,jr),Ln=new Vr;return wr&&ys(Ln,wr.prototype),Ln},pu.apply(null,arguments)}function ys(D,Y){return ys=Object.setPrototypeOf||function(nt,se){return nt.__proto__=se,nt},ys(D,Y)}var Rl="0.0.3";function mf(D,Y){Object.defineProperty(D,"name",{value:Y,writable:!1,enumerable:!1,configurable:!0})}var Wu=Object.prototype.hasOwnProperty,ke=Symbol("Break"),Xe=Symbol("Continue"),Tr=Symbol("DefaultCase"),un=Symbol("EmptyStatementReturn"),si=Symbol("WithScopeName"),ji=Symbol("SuperScopeName"),Ma=Symbol("RootScopeName"),ds=Symbol("GlobalScopeName");function Ho(D){return typeof D=="function"}var qo=function(){function D(bt){this.interpreter=bt}var Y=D.prototype;return Y.generator=function(){var nt=this.interpreter;function se(){return this.getCurrentScope()}function Ve(){return this.getGlobalScope()}function wr(){return this.getCurrentContext()}return{getOptions:nt.getOptions.bind(nt),getCurrentScope:se.bind(nt),getGlobalScope:Ve.bind(nt),getCurrentContext:wr.bind(nt),getExecStartTime:nt.getExecStartTime.bind(nt)}},D}();function Hs(D,Y,bt){if(bt===void 0&&(bt=!0),!(D instanceof qo))throw new Error("Illegal call");if(typeof Y!="string")return Y;if(!!Y){var nt=D.generator(),se=nt.getOptions(),Ve={timeout:se.timeout,_initEnv:function(){bt||this.setCurrentContext(nt.getCurrentContext()),this.execStartTime=nt.getExecStartTime(),this.execEndTime=this.execStartTime}},wr=bt?nt.getGlobalScope():nt.getCurrentScope(),jr=new rs(wr,Ve);return jr.evaluate(Y)}}Object.defineProperty(Hs,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});function Xu(D){if(!(D instanceof qo))throw new Error("Illegal call");for(var Y=D.generator(),bt=arguments.length,nt=new Array(bt>1?bt-1:0),se=1;se<bt;se++)nt[se-1]=arguments[se];var Ve=nt.pop(),wr=new rs(Y.getGlobalScope(),Y.getOptions()),jr=`
		    (function anonymous(`+nt.join(",")+`){
		        `+Ve+`
		    });
		    `;return wr.evaluate(jr)}Object.defineProperty(Xu,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var _s=function(Y){this.value=Y},vs=function(Y){this.value=Y},Ou=function(Y){this.value=Y},rl=function(Y,bt,nt){bt===void 0&&(bt=null),this.name=nt,this.parent=bt,this.data=Y,this.labelStack=[]};function nu(){}function dl(D,Y){return D===void 0&&(D=null),new rl(Object.create(null),D,Y)}function Fu(D){return Object.create(D)}var Fo={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Float64Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:Hs,Function:Xu};typeof JSON!="undefined"&&(Fo.JSON=JSON),typeof Promise!="undefined"&&(Fo.Promise=Promise),typeof Set!="undefined"&&(Fo.Set=Set),typeof Map!="undefined"&&(Fo.Map=Map),typeof Symbol!="undefined"&&(Fo.Symbol=Symbol),typeof Proxy!="undefined"&&(Fo.Proxy=Proxy),typeof WeakMap!="undefined"&&(Fo.WeakMap=WeakMap),typeof WeakSet!="undefined"&&(Fo.WeakSet=WeakSet),typeof Reflect!="undefined"&&(Fo.Reflect=Reflect);var rs=function(){function D(bt,nt){bt===void 0&&(bt=D.global),nt===void 0&&(nt={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:nt.ecmaVersion||D.ecmaVersion,timeout:nt.timeout||0,rootContext:nt.rootContext,globalContextInFunction:nt.globalContextInFunction===void 0?D.globalContextInFunction:nt.globalContextInFunction,_initEnv:nt._initEnv},this.context=bt||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var Y=D.prototype;return Y.initEnvironment=function(nt){var se;if(nt instanceof rl)se=nt;else{var Ve=null,wr=this.createSuperScope(nt);this.options.rootContext&&(Ve=new rl(Fu(this.options.rootContext),wr,Ma)),se=new rl(nt,Ve||wr,ds)}this.globalScope=se,this.currentScope=this.globalScope,this.globalContext=se.data,this.currentContext=se.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var jr=this.options._initEnv;jr&&jr.call(this)},Y.getExecStartTime=function(){return this.execStartTime},Y.getExecutionTime=function(){return this.execEndTime-this.execStartTime},Y.setExecTimeout=function(nt){nt===void 0&&(nt=0),this.options.timeout=nt},Y.getOptions=function(){return this.options},Y.getGlobalScope=function(){return this.globalScope},Y.getCurrentScope=function(){return this.currentScope},Y.getCurrentContext=function(){return this.currentContext},Y.isInterruptThrow=function(nt){return nt instanceof es||nt instanceof ns||nt instanceof ko},Y.createSuperScope=function(nt){var se=Object.assign({},Fo),Ve=Object.keys(se);return Ve.forEach(function(wr){wr in nt&&delete se[wr]}),new rl(se,null,ji)},Y.setCurrentContext=function(nt){this.currentContext=nt},Y.setCurrentScope=function(nt){this.currentScope=nt},Y.evaluate=function(nt){nt===void 0&&(nt="");var se;if(!!nt)return se=Uo(nt,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||D.ecmaVersion}),this.evaluateNode(se,nt)},Y.appendCode=function(nt){return this.evaluate(nt)},Y.evaluateNode=function(nt,se){var Ve=this;se===void 0&&(se=""),this.value=void 0,this.source=se,this.sourceList.push(se),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var wr=this.getCurrentScope(),jr=this.getCurrentContext(),Vr=wr.labelStack.concat([]),Ln=this.callStack.concat([]),Gn=function(){Ve.setCurrentScope(wr),Ve.setCurrentContext(jr),wr.labelStack=Vr,Ve.callStack=Ln};try{var $i=this.createClosure(nt);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),$i()}catch(Pa){throw Pa}finally{Gn(),this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},Y.createErrorMessage=function(nt,se,Ve){var wr=nt[1].replace("%0",String(se));return Ve!==null&&(wr+=this.getNodePosition(Ve||this.lastExecNode)),wr},Y.createError=function(nt,se){return new se(nt)},Y.createThrowError=function(nt,se){return this.createError(nt,se)},Y.createInternalThrowError=function(nt,se,Ve){return this.createError(this.createErrorMessage(nt,se,Ve),nt[2])},Y.checkTimeout=function(){if(!this.isRunning)return!1;var nt=this.options.timeout||0,se=Date.now();return se-this.execStartTime>nt},Y.getNodePosition=function(nt){if(nt){var se="";return nt.loc?" ["+nt.loc.start.line+":"+nt.loc.start.column+"]"+se:""}return""},Y.createClosure=function(nt){var se=this,Ve;switch(nt.type){case"BinaryExpression":Ve=this.binaryExpressionHandler(nt);break;case"LogicalExpression":Ve=this.logicalExpressionHandler(nt);break;case"UnaryExpression":Ve=this.unaryExpressionHandler(nt);break;case"UpdateExpression":Ve=this.updateExpressionHandler(nt);break;case"ObjectExpression":Ve=this.objectExpressionHandler(nt);break;case"ArrayExpression":Ve=this.arrayExpressionHandler(nt);break;case"CallExpression":Ve=this.callExpressionHandler(nt);break;case"NewExpression":Ve=this.newExpressionHandler(nt);break;case"MemberExpression":Ve=this.memberExpressionHandler(nt);break;case"ThisExpression":Ve=this.thisExpressionHandler(nt);break;case"SequenceExpression":Ve=this.sequenceExpressionHandler(nt);break;case"Literal":Ve=this.literalHandler(nt);break;case"Identifier":Ve=this.identifierHandler(nt);break;case"AssignmentExpression":Ve=this.assignmentExpressionHandler(nt);break;case"FunctionDeclaration":Ve=this.functionDeclarationHandler(nt);break;case"VariableDeclaration":Ve=this.variableDeclarationHandler(nt);break;case"BlockStatement":case"Program":Ve=this.programHandler(nt);break;case"ExpressionStatement":Ve=this.expressionStatementHandler(nt);break;case"EmptyStatement":Ve=this.emptyStatementHandler(nt);break;case"ReturnStatement":Ve=this.returnStatementHandler(nt);break;case"FunctionExpression":Ve=this.functionExpressionHandler(nt);break;case"IfStatement":Ve=this.ifStatementHandler(nt);break;case"ConditionalExpression":Ve=this.conditionalExpressionHandler(nt);break;case"ForStatement":Ve=this.forStatementHandler(nt);break;case"WhileStatement":Ve=this.whileStatementHandler(nt);break;case"DoWhileStatement":Ve=this.doWhileStatementHandler(nt);break;case"ForInStatement":Ve=this.forInStatementHandler(nt);break;case"WithStatement":Ve=this.withStatementHandler(nt);break;case"ThrowStatement":Ve=this.throwStatementHandler(nt);break;case"TryStatement":Ve=this.tryStatementHandler(nt);break;case"ContinueStatement":Ve=this.continueStatementHandler(nt);break;case"BreakStatement":Ve=this.breakStatementHandler(nt);break;case"SwitchStatement":Ve=this.switchStatementHandler(nt);break;case"LabeledStatement":Ve=this.labeledStatementHandler(nt);break;case"DebuggerStatement":Ve=this.debuggerStatementHandler(nt);break;default:throw this.createInternalThrowError(Ya.NodeTypeSyntaxError,nt.type,nt)}return function(){var wr=se.options.timeout;if(wr&&wr>0&&se.checkTimeout())throw se.createInternalThrowError(Ya.ExecutionTimeOutError,wr,null);return se.lastExecNode=nt,Ve.apply(void 0,arguments)}},Y.binaryExpressionHandler=function(nt){var se=this,Ve=this.createClosure(nt.left),wr=this.createClosure(nt.right);return function(){var jr=Ve(),Vr=wr();switch(nt.operator){case"==":return jr==Vr;case"!=":return jr!=Vr;case"===":return jr===Vr;case"!==":return jr!==Vr;case"<":return jr<Vr;case"<=":return jr<=Vr;case">":return jr>Vr;case">=":return jr>=Vr;case"<<":return jr<<Vr;case">>":return jr>>Vr;case">>>":return jr>>>Vr;case"+":return jr+Vr;case"-":return jr-Vr;case"*":return jr*Vr;case"**":return Math.pow(jr,Vr);case"/":return jr/Vr;case"%":return jr%Vr;case"|":return jr|Vr;case"^":return jr^Vr;case"&":return jr&Vr;case"in":return jr in Vr;case"instanceof":return jr instanceof Vr;default:throw se.createInternalThrowError(Ya.BinaryOperatorSyntaxError,nt.operator,nt)}}},Y.logicalExpressionHandler=function(nt){var se=this,Ve=this.createClosure(nt.left),wr=this.createClosure(nt.right);return function(){switch(nt.operator){case"||":return Ve()||wr();case"&&":return Ve()&&wr();default:throw se.createInternalThrowError(Ya.LogicalOperatorSyntaxError,nt.operator,nt)}}},Y.unaryExpressionHandler=function(nt){var se=this;switch(nt.operator){case"delete":var Ve=this.createObjectGetter(nt.argument),wr=this.createNameGetter(nt.argument);return function(){var Gn=Ve(),$i=wr();return delete Gn[$i]};default:var jr;if(nt.operator==="typeof"&&nt.argument.type==="Identifier"){var Vr=this.createObjectGetter(nt.argument),Ln=this.createNameGetter(nt.argument);jr=function(){return Vr()[Ln()]}}else jr=this.createClosure(nt.argument);return function(){var Gn=jr();switch(nt.operator){case"-":return-Gn;case"+":return+Gn;case"!":return!Gn;case"~":return~Gn;case"void":return;case"typeof":return typeof Gn;default:throw se.createInternalThrowError(Ya.UnaryOperatorSyntaxError,nt.operator,nt)}}}},Y.updateExpressionHandler=function(nt){var se=this,Ve=this.createObjectGetter(nt.argument),wr=this.createNameGetter(nt.argument);return function(){var jr=Ve(),Vr=wr();switch(se.assertVariable(jr,Vr,nt),nt.operator){case"++":return nt.prefix?++jr[Vr]:jr[Vr]++;case"--":return nt.prefix?--jr[Vr]:jr[Vr]--;default:throw se.createInternalThrowError(Ya.UpdateOperatorSyntaxError,nt.operator,nt)}}},Y.objectExpressionHandler=function(nt){var se=this,Ve=[];function wr(Vr){return Vr.type==="Identifier"?Vr.name:Vr.type==="Literal"?Vr.value:this.throwError(Ya.ObjectStructureSyntaxError,Vr.type,Vr)}var jr=Object.create(null);return nt.properties.forEach(function(Vr){var Ln=Vr.kind,Gn=wr(Vr.key);(!jr[Gn]||Ln==="init")&&(jr[Gn]={}),jr[Gn][Ln]=se.createClosure(Vr.value),Ve.push({key:Gn,property:Vr})}),function(){for(var Vr={},Ln=Ve.length,Gn=0;Gn<Ln;Gn++){var $i=Ve[Gn],Pa=$i.key,ba=jr[Pa],uo=ba.init?ba.init():void 0,Ca=ba.get?ba.get():function(){},Ao=ba.set?ba.set():function(il){};if("set"in ba||"get"in ba){var qa={configurable:!0,enumerable:!0,get:Ca,set:Ao};Object.defineProperty(Vr,Pa,qa)}else{var gs=$i.property,xu=gs.kind;gs.key.type==="Identifier"&&gs.value.type==="FunctionExpression"&&xu==="init"&&!gs.value.id&&mf(uo,gs.key.name),Vr[Pa]=uo}}return Vr}},Y.arrayExpressionHandler=function(nt){var se=this,Ve=nt.elements.map(function(wr){return wr&&se.createClosure(wr)});return function(){for(var wr=Ve.length,jr=Array(wr),Vr=0;Vr<wr;Vr++){var Ln=Ve[Vr];Ln&&(jr[Vr]=Ln())}return jr}},Y.safeObjectGet=function(nt,se,Ve){return nt[se]},Y.createCallFunctionGetter=function(nt){var se=this;switch(nt.type){case"MemberExpression":var Ve=this.createClosure(nt.object),wr=this.createMemberKeyGetter(nt),jr=this.source;return function(){var Ln=Ve(),Gn=wr(),$i=se.safeObjectGet(Ln,Gn,nt);if(!$i||!Ho($i)){var Pa=jr.slice(nt.start,nt.end);throw se.createInternalThrowError(Ya.FunctionUndefinedReferenceError,Pa,nt)}return $i.__IS_EVAL_FUNC?function(ba){return $i(new qo(se),ba,!0)}:$i.__IS_FUNCTION_FUNC?function(){for(var ba=arguments.length,uo=new Array(ba),Ca=0;Ca<ba;Ca++)uo[Ca]=arguments[Ca];return $i.apply(void 0,[new qo(se)].concat(uo))}:$i.bind(Ln)};default:var Vr=this.createClosure(nt);return function(){var Ln="";nt.type==="Identifier"&&(Ln=nt.name);var Gn=Vr();if(!Gn||!Ho(Gn))throw se.createInternalThrowError(Ya.FunctionUndefinedReferenceError,Ln,nt);if(nt.type==="Identifier"&&Gn.__IS_EVAL_FUNC&&Ln==="eval")return function(ba){var uo=se.getScopeFromName(Ln,se.getCurrentScope()),Ca=uo.name===ji||uo.name===ds||uo.name===Ma;return Gn(new qo(se),ba,!Ca)};if(Gn.__IS_EVAL_FUNC)return function(ba){return Gn(new qo(se),ba,!0)};if(Gn.__IS_FUNCTION_FUNC)return function(){for(var ba=arguments.length,uo=new Array(ba),Ca=0;Ca<ba;Ca++)uo[Ca]=arguments[Ca];return Gn.apply(void 0,[new qo(se)].concat(uo))};var $i=se.options.globalContextInFunction;if(nt.type==="Identifier"){var Pa=se.getIdentifierScope(nt);Pa.name===si&&($i=Pa.data)}return Gn.bind($i)}}},Y.callExpressionHandler=function(nt){var se=this,Ve=this.createCallFunctionGetter(nt.callee),wr=nt.arguments.map(function(jr){return se.createClosure(jr)});return function(){return Ve().apply(void 0,wr.map(function(jr){return jr()}))}},Y.functionExpressionHandler=function(nt){var se=this,Ve=this,wr=this.source,jr=this.collectDeclVars,Vr=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Ln=nt.id?nt.id.name:"",Gn=nt.params.length,$i=nt.params.map(function(Ca){return se.createParamNameGetter(Ca)}),Pa=this.createClosure(nt.body),ba=this.collectDeclVars,uo=this.collectDeclFuncs;return this.collectDeclVars=jr,this.collectDeclFuncs=Vr,function(){var Ca=Ve.getCurrentScope(),Ao=function qa(){for(var gs=arguments.length,xu=new Array(gs),il=0;il<gs;il++)xu[il]=arguments[il];Ve.callStack.push(""+Ln);var bu=Ve.getCurrentScope(),iu=dl(Ca,"FunctionScope("+Ln+")");Ve.setCurrentScope(iu),Ve.addDeclarationsToScope(ba,uo,iu),Ln&&(iu.data[Ln]=qa),iu.data.arguments=arguments,$i.forEach(function(Yl,ye){iu.data[Yl()]=xu[ye]});var Vc=Ve.getCurrentContext();Ve.setCurrentContext(this);var $s=Pa();if(Ve.setCurrentContext(Vc),Ve.setCurrentScope(bu),Ve.callStack.pop(),$s instanceof _s)return $s.value};return mf(Ao,Ln),Object.defineProperty(Ao,"length",{value:Gn,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Ao,"toString",{value:function(){return wr.slice(nt.start,nt.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Ao,"valueOf",{value:function(){return wr.slice(nt.start,nt.end)},writable:!0,configurable:!0,enumerable:!1}),Ao}},Y.newExpressionHandler=function(nt){var se=this,Ve=this.source,wr=this.createClosure(nt.callee),jr=nt.arguments.map(function(Vr){return se.createClosure(Vr)});return function(){var Vr=wr();if(!Ho(Vr)||Vr.__IS_EVAL_FUNC){var Ln=nt.callee,Gn=Ve.slice(Ln.start,Ln.end);throw se.createInternalThrowError(Ya.IsNotConstructor,Gn,nt)}return Vr.__IS_FUNCTION_FUNC?Vr.apply(void 0,[new qo(se)].concat(jr.map(function($i){return $i()}))):pu(Vr,jr.map(function($i){return $i()}))}},Y.memberExpressionHandler=function(nt){var se=this.createClosure(nt.object),Ve=this.createMemberKeyGetter(nt);return function(){var wr=se(),jr=Ve();return wr[jr]}},Y.thisExpressionHandler=function(nt){var se=this;return function(){return se.getCurrentContext()}},Y.sequenceExpressionHandler=function(nt){var se=this,Ve=nt.expressions.map(function(wr){return se.createClosure(wr)});return function(){for(var wr,jr=Ve.length,Vr=0;Vr<jr;Vr++){var Ln=Ve[Vr];wr=Ln()}return wr}},Y.literalHandler=function(nt){return function(){return nt.regex?new RegExp(nt.regex.pattern,nt.regex.flags):nt.value}},Y.identifierHandler=function(nt){var se=this;return function(){var Ve=se.getCurrentScope(),wr=se.getScopeDataFromName(nt.name,Ve);return se.assertVariable(wr,nt.name,nt),wr[nt.name]}},Y.getIdentifierScope=function(nt){var se=this.getCurrentScope(),Ve=this.getScopeFromName(nt.name,se);return Ve},Y.assignmentExpressionHandler=function(nt){var se=this;nt.left.type==="Identifier"&&nt.right.type==="FunctionExpression"&&!nt.right.id&&(nt.right.id={type:"Identifier",name:nt.left.name});var Ve=this.createObjectGetter(nt.left),wr=this.createNameGetter(nt.left),jr=this.createClosure(nt.right);return function(){var Vr=Ve(),Ln=wr(),Gn=jr();switch(nt.operator!=="="&&se.assertVariable(Vr,Ln,nt),nt.operator){case"=":return Vr[Ln]=Gn;case"+=":return Vr[Ln]+=Gn;case"-=":return Vr[Ln]-=Gn;case"*=":return Vr[Ln]*=Gn;case"**=":return Vr[Ln]=Math.pow(Vr[Ln],Gn);case"/=":return Vr[Ln]/=Gn;case"%=":return Vr[Ln]%=Gn;case"<<=":return Vr[Ln]<<=Gn;case">>=":return Vr[Ln]>>=Gn;case">>>=":return Vr[Ln]>>>=Gn;case"&=":return Vr[Ln]&=Gn;case"^=":return Vr[Ln]^=Gn;case"|=":return Vr[Ln]|=Gn;default:throw se.createInternalThrowError(Ya.AssignmentExpressionSyntaxError,nt.type,nt)}}},Y.functionDeclarationHandler=function(nt){if(nt.id){var se=this.functionExpressionHandler(nt);Object.defineProperty(se,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(nt.id.name,se)}return function(){return un}},Y.getVariableName=function(nt){if(nt.type==="Identifier")return nt.name;throw this.createInternalThrowError(Ya.VariableTypeSyntaxError,nt.type,nt)},Y.variableDeclarationHandler=function(nt){for(var se=this,Ve,wr=[],jr=0;jr<nt.declarations.length;jr++){var Vr=nt.declarations[jr];this.varDeclaration(this.getVariableName(Vr.id)),Vr.init&&wr.push({type:"AssignmentExpression",operator:"=",left:Vr.id,right:Vr.init})}return wr.length&&(Ve=this.createClosure({type:"BlockStatement",body:wr})),function(){if(Ve){var Ln=se.isVarDeclMode;se.isVarDeclMode=!0,Ve(),se.isVarDeclMode=Ln}return un}},Y.assertVariable=function(nt,se,Ve){if(nt===this.globalScope.data&&!(se in nt))throw this.createInternalThrowError(Ya.VariableUndefinedReferenceError,se,Ve)},Y.programHandler=function(nt){var se=this,Ve=nt.body.map(function(wr){return se.createClosure(wr)});return function(){for(var wr=un,jr=0;jr<Ve.length;jr++){var Vr=Ve[jr],Ln=se.setValue(Vr());if(Ln!==un&&(wr=Ln,wr instanceof _s||wr instanceof vs||wr instanceof Ou||wr===ke||wr===Xe))break}return wr}},Y.expressionStatementHandler=function(nt){return this.createClosure(nt.expression)},Y.emptyStatementHandler=function(nt){return function(){return un}},Y.returnStatementHandler=function(nt){var se=nt.argument?this.createClosure(nt.argument):nu;return function(){return new _s(se())}},Y.ifStatementHandler=function(nt){var se=this.createClosure(nt.test),Ve=this.createClosure(nt.consequent),wr=nt.alternate?this.createClosure(nt.alternate):function(){return un};return function(){return se()?Ve():wr()}},Y.conditionalExpressionHandler=function(nt){return this.ifStatementHandler(nt)},Y.forStatementHandler=function(nt){var se=this,Ve=nu,wr=nt.test?this.createClosure(nt.test):function(){return!0},jr=nu,Vr=this.createClosure(nt.body);return nt.type==="ForStatement"&&(Ve=nt.init?this.createClosure(nt.init):Ve,jr=nt.update?this.createClosure(nt.update):nu),function(Ln){var Gn,$i=un,Pa=nt.type==="DoWhileStatement";for(Ln&&Ln.type==="LabeledStatement"&&(Gn=Ln.label.name),Ve();Pa||wr();jr()){Pa=!1;var ba=se.setValue(Vr());if(!(ba===un||ba===Xe)){if(ba===ke)break;if($i=ba,$i instanceof Ou&&$i.value===Gn){$i=un;continue}if($i instanceof _s||$i instanceof vs||$i instanceof Ou)break}}return $i}},Y.whileStatementHandler=function(nt){return this.forStatementHandler(nt)},Y.doWhileStatementHandler=function(nt){return this.forStatementHandler(nt)},Y.forInStatementHandler=function(nt){var se=this,Ve=nt.left,wr=this.createClosure(nt.right),jr=this.createClosure(nt.body);return nt.left.type==="VariableDeclaration"&&(this.createClosure(nt.left)(),Ve=nt.left.declarations[0].id),function(Vr){var Ln,Gn=un,$i;Vr&&Vr.type==="LabeledStatement"&&(Ln=Vr.label.name);var Pa=wr();for($i in Pa){se.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Ve,right:{type:"Literal",value:$i}})();var ba=se.setValue(jr());if(!(ba===un||ba===Xe)){if(ba===ke)break;if(Gn=ba,Gn instanceof Ou&&Gn.value===Ln){Gn=un;continue}if(Gn instanceof _s||Gn instanceof vs||Gn instanceof Ou)break}}return Gn}},Y.withStatementHandler=function(nt){var se=this,Ve=this.createClosure(nt.object),wr=this.createClosure(nt.body);return function(){var jr=Ve(),Vr=se.getCurrentScope(),Ln=new rl(jr,Vr,si);se.setCurrentScope(Ln);var Gn=se.setValue(wr());return se.setCurrentScope(Vr),Gn}},Y.throwStatementHandler=function(nt){var se=this,Ve=this.createClosure(nt.argument);return function(){throw se.setValue(void 0),Ve()}},Y.tryStatementHandler=function(nt){var se=this,Ve=this.createClosure(nt.block),wr=nt.handler?this.catchClauseHandler(nt.handler):null,jr=nt.finalizer?this.createClosure(nt.finalizer):null;return function(){var Vr=se.getCurrentScope(),Ln=se.getCurrentContext(),Gn=Vr.labelStack.concat([]),$i=se.callStack.concat([]),Pa=un,ba,uo,Ca=function(){se.setCurrentScope(Vr),se.setCurrentContext(Ln),Vr.labelStack=Gn,se.callStack=$i};try{Pa=se.setValue(Ve()),Pa instanceof _s&&(ba=Pa)}catch(Ao){if(Ca(),se.isInterruptThrow(Ao))throw Ao;if(wr)try{Pa=se.setValue(wr(Ao)),Pa instanceof _s&&(ba=Pa)}catch(qa){if(Ca(),se.isInterruptThrow(qa))throw qa;uo=qa}}if(jr)try{Pa=jr(),Pa instanceof _s&&(ba=Pa)}catch(Ao){if(Ca(),se.isInterruptThrow(Ao))throw Ao;uo=Ao}if(uo)throw uo;return ba||Pa}},Y.catchClauseHandler=function(nt){var se=this,Ve=this.createParamNameGetter(nt.param),wr=this.createClosure(nt.body);return function(jr){var Vr,Ln=se.getCurrentScope(),Gn=Ln.data,$i=Ve(),Pa=Wu.call(Gn,$i),ba=Gn[$i];return Gn[$i]=jr,Vr=wr(),Pa?Gn[$i]=ba:delete Gn[$i],Vr}},Y.continueStatementHandler=function(nt){return function(){return nt.label?new Ou(nt.label.name):Xe}},Y.breakStatementHandler=function(nt){return function(){return nt.label?new vs(nt.label.name):ke}},Y.switchStatementHandler=function(nt){var se=this,Ve=this.createClosure(nt.discriminant),wr=nt.cases.map(function(jr){return se.switchCaseHandler(jr)});return function(){for(var jr=Ve(),Vr=!1,Ln,Gn,$i,Pa=0;Pa<wr.length;Pa++){var ba=wr[Pa](),uo=ba.testClosure();if(uo===Tr){$i=ba;continue}if(Vr||uo===jr){if(Vr=!0,Gn=se.setValue(ba.bodyClosure()),Gn===un)continue;if(Gn===ke||(Ln=Gn,Ln instanceof _s||Ln instanceof vs||Ln instanceof Ou||Ln===Xe))break}}if(!Vr&&$i){Gn=se.setValue($i.bodyClosure());var Ca=Gn===un||Gn===ke||Gn===Xe;Ca||(Ln=Gn)}return Ln}},Y.switchCaseHandler=function(nt){var se=nt.test?this.createClosure(nt.test):function(){return Tr},Ve=this.createClosure({type:"BlockStatement",body:nt.consequent});return function(){return{testClosure:se,bodyClosure:Ve}}},Y.labeledStatementHandler=function(nt){var se=this,Ve=nt.label.name,wr=this.createClosure(nt.body);return function(){var jr,Vr=se.getCurrentScope();return Vr.labelStack.push(Ve),jr=wr(nt),jr instanceof vs&&jr.value===Ve&&(jr=un),Vr.labelStack.pop(),jr}},Y.debuggerStatementHandler=function(nt){return function(){debugger;return un}},Y.createParamNameGetter=function(nt){if(nt.type==="Identifier")return function(){return nt.name};throw this.createInternalThrowError(Ya.ParamTypeSyntaxError,nt.type,nt)},Y.createObjectKeyGetter=function(nt){var se;return nt.type==="Identifier"?se=function(){return nt.name}:se=this.createClosure(nt),function(){return se()}},Y.createMemberKeyGetter=function(nt){return nt.computed?this.createClosure(nt.property):this.createObjectKeyGetter(nt.property)},Y.createObjectGetter=function(nt){var se=this;switch(nt.type){case"Identifier":return function(){return se.getScopeDataFromName(nt.name,se.getCurrentScope())};case"MemberExpression":return this.createClosure(nt.object);default:throw this.createInternalThrowError(Ya.AssignmentTypeSyntaxError,nt.type,nt)}},Y.createNameGetter=function(nt){switch(nt.type){case"Identifier":return function(){return nt.name};case"MemberExpression":return this.createMemberKeyGetter(nt);default:throw this.createInternalThrowError(Ya.AssignmentTypeSyntaxError,nt.type,nt)}},Y.varDeclaration=function(nt){var se=this.collectDeclVars;se[nt]=void 0},Y.funcDeclaration=function(nt,se){var Ve=this.collectDeclFuncs;Ve[nt]=se},Y.addDeclarationsToScope=function(nt,se,Ve){var wr=Ve.data;for(var jr in se){var Vr=se[jr];wr[jr]=Vr&&Vr()}for(var Ln in nt)Ln in wr||(wr[Ln]=void 0)},Y.getScopeValue=function(nt,se){var Ve=this.getScopeFromName(nt,se);return Ve.data[nt]},Y.getScopeDataFromName=function(nt,se){return this.getScopeFromName(nt,se).data},Y.getScopeFromName=function(nt,se){var Ve=se;do if(nt in Ve.data)return Ve;while(Ve=Ve.parent);return this.globalScope},Y.setValue=function(nt){var se=this.callStack.length;return this.isVarDeclMode||se||nt===un||nt===ke||nt===Xe||nt instanceof vs||nt instanceof Ou||(this.value=nt instanceof _s?nt.value:nt),nt},Y.getValue=function(){return this.value},D}();rs.version=Rl,rs.eval=Hs,rs.Function=Xu,rs.ecmaVersion=5,rs.globalContextInFunction=void 0,rs.global=Object.create(null);function Uc(D){return D===void 0&&(D=Object.create(null)),D}function _u(D,Y,bt){Y===void 0&&(Y=[]),bt===void 0&&(bt={});var nt=bt.parsingContext,se=bt.timeout===void 0?0:bt.timeout,Ve=`
    (function anonymous(`+Y.join(",")+`){
         `+D+`
    });
    `,wr=new rs(nt,{ecmaVersion:bt.ecmaVersion,timeout:se,rootContext:bt.rootContext,globalContextInFunction:bt.globalContextInFunction});return wr.evaluate(Ve)}function Zc(D,Y,bt){var nt=new rs(Y,bt);return nt.evaluate(D)}var Co=Zc,sc=function(){function D(bt){this._code=bt}var Y=D.prototype;return Y.runInContext=function(nt){return Zc(this._code,nt)},Y.runInNewContext=function(nt){return Zc(this._code,nt)},D}(),Xl=function(D,Y,bt){return Zc(D,Y,bt)};function nl(){for(var D=arguments.length,Y=new Array(D),bt=0;bt<D;bt++)Y[bt]=arguments[bt];var nt=Y.pop();return _u(nt||"",Y)}var uc=Xl},20396:function(vn,Ft,ot){var Lt;(function(wt,I,Et,q){"use strict";var lt=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ht=typeof wx!="undefined"&&wx!==null&&(typeof wx.request!="undefined"||typeof wx.miniProgram!="undefined"),ct=lt||ht,et=["","webkit","Moz","MS","ms","o"],Ee=ct?"":I.createElement("div"),it="function",st=Math.round,Zt=Math.abs,P=Date.now;function b(ke,Xe,Tr){return setTimeout(Ae(ke,Tr),Xe)}function X(ke,Xe,Tr){return Array.isArray(ke)?(le(ke,Tr[Xe],Tr),!0):!1}function le(ke,Xe,Tr){var un;if(!!ke)if(ke.forEach)ke.forEach(Xe,Tr);else if(ke.length!==q)for(un=0;un<ke.length;)Xe.call(Tr,ke[un],un,ke),un++;else for(un in ke)ke.hasOwnProperty(un)&&Xe.call(Tr,ke[un],un,ke)}function Se(ke,Xe,Tr){var un="DEPRECATED METHOD: "+Xe+`
`+Tr+` AT 
`;return function(){var si=new Error("get-stack-trace"),ji=si&&si.stack?si.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ma=wt.console&&(wt.console.warn||wt.console.log);return Ma&&Ma.call(wt.console,un,ji),ke.apply(this,arguments)}}var Ie;typeof Object.assign!="function"?Ie=function(Xe){if(Xe===q||Xe===null)throw new TypeError("Cannot convert undefined or null to object");for(var Tr=Object(Xe),un=1;un<arguments.length;un++){var si=arguments[un];if(si!==q&&si!==null)for(var ji in si)si.hasOwnProperty(ji)&&(Tr[ji]=si[ji])}return Tr}:Ie=Object.assign;var It=Se(function(Xe,Tr,un){for(var si=Object.keys(Tr),ji=0;ji<si.length;)(!un||un&&Xe[si[ji]]===q)&&(Xe[si[ji]]=Tr[si[ji]]),ji++;return Xe},"extend","Use `assign`."),rt=Se(function(Xe,Tr){return It(Xe,Tr,!0)},"merge","Use `assign`.");function Dt(ke,Xe,Tr){var un=Xe.prototype,si;si=ke.prototype=Object.create(un),si.constructor=ke,si._super=un,Tr&&Ie(si,Tr)}function Ae(ke,Xe){return function(){return ke.apply(Xe,arguments)}}function be(ke,Xe){return typeof ke==it?ke.apply(Xe&&Xe[0]||q,Xe):ke}function me(ke,Xe){return ke===q?Xe:ke}function ee(ke,Xe,Tr){le(Pt(Xe),function(un){ke.addEventListener(un,Tr,!1)})}function we(ke,Xe,Tr){le(Pt(Xe),function(un){ke.removeEventListener(un,Tr,!1)})}function _e(ke,Xe){for(;ke;){if(ke==Xe)return!0;ke=ke.parentNode}return!1}function gt(ke,Xe){return ke.indexOf(Xe)>-1}function Pt(ke){return ke.trim().split(/\s+/g)}function J(ke,Xe,Tr){if(ke.indexOf&&!Tr)return ke.indexOf(Xe);for(var un=0;un<ke.length;){if(Tr&&ke[un][Tr]==Xe||!Tr&&ke[un]===Xe)return un;un++}return-1}function vt(ke){return Array.prototype.slice.call(ke,0)}function W(ke,Xe,Tr){for(var un=[],si=[],ji=0;ji<ke.length;){var Ma=Xe?ke[ji][Xe]:ke[ji];J(si,Ma)<0&&un.push(ke[ji]),si[ji]=Ma,ji++}return Tr&&(Xe?un=un.sort(function(Ho,qo){return Ho[Xe]>qo[Xe]}):un=un.sort()),un}function dt(ke,Xe){for(var Tr,un,si=Xe[0].toUpperCase()+Xe.slice(1),ji=0;ji<et.length;){if(Tr=et[ji],un=Tr?Tr+si:Xe,un in ke)return un;ji++}return q}var Vt=1;function ne(){return Vt++}function ge(ke){var Xe=ke.ownerDocument||ke;return Xe.defaultView||Xe.parentWindow||wt}var $e=/mobile|tablet|ip(ad|hone|od)|android/i,jt="ontouchstart"in wt,Qt=dt(wt,"PointerEvent")!==q,Te=jt&&$e.test(navigator.userAgent),ae="touch",Ke="pen",or="mouse",ie="kinect",te=25,St=1,qt=2,$t=4,Ct=8,Tt=1,ue=2,Oe=4,We=8,zt=16,At=ue|Oe,Mt=We|zt,Rt=At|Mt,tt=["x","y"],_t=["clientX","clientY"];function Xt(ke,Xe){var Tr=this;this.manager=ke,this.callback=Xe,this.element=ke.element,this.target=ke.options.inputTarget,this.domHandler=function(un){be(ke.options.enable,[ke])&&Tr.handler(un)},this.init()}Xt.prototype={handler:function(){},init:function(){this.evEl&&ee(this.element,this.evEl,this.domHandler),this.evTarget&&ee(this.target,this.evTarget,this.domHandler),this.evWin&&ee(ge(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&we(this.element,this.evEl,this.domHandler),this.evTarget&&we(this.target,this.evTarget,this.domHandler),this.evWin&&we(ge(this.element),this.evWin,this.domHandler)}};function ve(ke){var Xe,Tr=ke.options.inputClass;return Tr?Xe=Tr:Qt?Xe=Ue:Te?Xe=Qr:jt?Xe=Kr:Xe=Wn,new Xe(ke,Wt)}function Wt(ke,Xe,Tr){var un=Tr.pointers.length,si=Tr.changedPointers.length,ji=Xe&St&&un-si===0,Ma=Xe&($t|Ct)&&un-si===0;Tr.isFirst=!!ji,Tr.isFinal=!!Ma,ji&&(ke.session={}),Tr.eventType=Xe,Me(ke,Tr),ke.emit("hammer.input",Tr),ke.recognize(Tr),ke.session.prevInput=Tr}function Me(ke,Xe){var Tr=ke.session,un=Xe.pointers,si=un.length;Tr.firstInput||(Tr.firstInput=hr(Xe)),si>1&&!Tr.firstMultiple?Tr.firstMultiple=hr(Xe):si===1&&(Tr.firstMultiple=!1);var ji=Tr.firstInput,Ma=Tr.firstMultiple,ds=Ma?Ma.center:ji.center,Ho=Xe.center=er(un);Xe.timeStamp=P(),Xe.deltaTime=Xe.timeStamp-ji.timeStamp,Xe.angle=Tn(ds,Ho),Xe.distance=Zr(ds,Ho),je(Tr,Xe),Xe.offsetDirection=Lr(Xe.deltaX,Xe.deltaY);var qo=Br(Xe.deltaTime,Xe.deltaX,Xe.deltaY);Xe.overallVelocityX=qo.x,Xe.overallVelocityY=qo.y,Xe.overallVelocity=Zt(qo.x)>Zt(qo.y)?qo.x:qo.y,Xe.scale=Ma?Nn(Ma.pointers,un):1,Xe.rotation=Ma?rn(Ma.pointers,un):0,Xe.maxPointers=Tr.prevInput?Xe.pointers.length>Tr.prevInput.maxPointers?Xe.pointers.length:Tr.prevInput.maxPointers:Xe.pointers.length,Qe(Tr,Xe);var Hs=ke.element;_e(Xe.srcEvent.target,Hs)&&(Hs=Xe.srcEvent.target),Xe.target=Hs}function je(ke,Xe){var Tr=Xe.center,un=ke.offsetDelta||{},si=ke.prevDelta||{},ji=ke.prevInput||{};(Xe.eventType===St||ji.eventType===$t)&&(si=ke.prevDelta={x:ji.deltaX||0,y:ji.deltaY||0},un=ke.offsetDelta={x:Tr.x,y:Tr.y}),Xe.deltaX=si.x+(Tr.x-un.x),Xe.deltaY=si.y+(Tr.y-un.y)}function Qe(ke,Xe){var Tr=ke.lastInterval||Xe,un=Xe.timeStamp-Tr.timeStamp,si,ji,Ma,ds;if(Xe.eventType!=Ct&&(un>te||Tr.velocity===q)){var Ho=Xe.deltaX-Tr.deltaX,qo=Xe.deltaY-Tr.deltaY,Hs=Br(un,Ho,qo);ji=Hs.x,Ma=Hs.y,si=Zt(Hs.x)>Zt(Hs.y)?Hs.x:Hs.y,ds=Lr(Ho,qo),ke.lastInterval=Xe}else si=Tr.velocity,ji=Tr.velocityX,Ma=Tr.velocityY,ds=Tr.direction;Xe.velocity=si,Xe.velocityX=ji,Xe.velocityY=Ma,Xe.direction=ds}function hr(ke){for(var Xe=[],Tr=0;Tr<ke.pointers.length;)Xe[Tr]={clientX:st(ke.pointers[Tr].clientX),clientY:st(ke.pointers[Tr].clientY)},Tr++;return{timeStamp:P(),pointers:Xe,center:er(Xe),deltaX:ke.deltaX,deltaY:ke.deltaY}}function er(ke){var Xe=ke.length;if(Xe===1)return{x:st(ke[0].clientX),y:st(ke[0].clientY)};for(var Tr=0,un=0,si=0;si<Xe;)Tr+=ke[si].clientX,un+=ke[si].clientY,si++;return{x:st(Tr/Xe),y:st(un/Xe)}}function Br(ke,Xe,Tr){return{x:Xe/ke||0,y:Tr/ke||0}}function Lr(ke,Xe){return ke===Xe?Tt:Zt(ke)>=Zt(Xe)?ke<0?ue:Oe:Xe<0?We:zt}function Zr(ke,Xe,Tr){Tr||(Tr=tt);var un=Xe[Tr[0]]-ke[Tr[0]],si=Xe[Tr[1]]-ke[Tr[1]];return Math.sqrt(un*un+si*si)}function Tn(ke,Xe,Tr){Tr||(Tr=tt);var un=Xe[Tr[0]]-ke[Tr[0]],si=Xe[Tr[1]]-ke[Tr[1]];return Math.atan2(si,un)*180/Math.PI}function rn(ke,Xe){return Tn(Xe[1],Xe[0],_t)+Tn(ke[1],ke[0],_t)}function Nn(ke,Xe){return Zr(Xe[0],Xe[1],_t)/Zr(ke[0],ke[1],_t)}var zn={mousedown:St,mousemove:qt,mouseup:$t},jn="mousedown",wn="mousemove mouseup";function Wn(){this.evEl=jn,this.evWin=wn,this.pressed=!1,Xt.apply(this,arguments)}Dt(Wn,Xt,{handler:function(Xe){var Tr=zn[Xe.type];Tr&St&&Xe.button===0&&(this.pressed=!0),Tr&qt&&Xe.which!==1&&(Tr=$t),this.pressed&&(Tr&$t&&(this.pressed=!1),this.callback(this.manager,Tr,{pointers:[Xe],changedPointers:[Xe],pointerType:or,srcEvent:Xe}))}});var Bt={pointerdown:St,pointermove:qt,pointerup:$t,pointercancel:Ct,pointerout:Ct},Yt={2:ae,3:Ke,4:or,5:ie},oe="pointerdown",Ce="pointermove pointerup pointercancel";!ct&&wt.MSPointerEvent&&!wt.PointerEvent&&(oe="MSPointerDown",Ce="MSPointerMove MSPointerUp MSPointerCancel");function Ue(){this.evEl=oe,this.evWin=Ce,Xt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Dt(Ue,Xt,{handler:function(Xe){var Tr=this.store,un=!1,si=Xe.type.toLowerCase().replace("ms",""),ji=Bt[si],Ma=Yt[Xe.pointerType]||Xe.pointerType,ds=Ma==ae,Ho=J(Tr,Xe.pointerId,"pointerId");ji&St&&(Xe.button===0||ds)?Ho<0&&(Tr.push(Xe),Ho=Tr.length-1):ji&($t|Ct)&&(un=!0),!(Ho<0)&&(Tr[Ho]=Xe,this.callback(this.manager,ji,{pointers:Tr,changedPointers:[Xe],pointerType:Ma,srcEvent:Xe}),un&&Tr.splice(Ho,1))}});var fr={touchstart:St,touchmove:qt,touchend:$t,touchcancel:Ct},Sr="touchstart",Pe="touchstart touchmove touchend touchcancel";function ur(){this.evTarget=Sr,this.evWin=Pe,this.started=!1,Xt.apply(this,arguments)}Dt(ur,Xt,{handler:function(Xe){var Tr=fr[Xe.type];if(Tr===St&&(this.started=!0),!!this.started){var un=Wr.call(this,Xe,Tr);Tr&($t|Ct)&&un[0].length-un[1].length===0&&(this.started=!1),this.callback(this.manager,Tr,{pointers:un[0],changedPointers:un[1],pointerType:ae,srcEvent:Xe})}}});function Wr(ke,Xe){var Tr=vt(ke.touches),un=vt(ke.changedTouches);return Xe&($t|Ct)&&(Tr=W(Tr.concat(un),"identifier",!0)),[Tr,un]}var Sn={touchstart:St,touchmove:qt,touchend:$t,touchcancel:Ct},qr="touchstart touchmove touchend touchcancel";function Qr(){this.evTarget=qr,this.targetIds={},Xt.apply(this,arguments)}Dt(Qr,Xt,{handler:function(Xe){var Tr=Sn[Xe.type],un=Mn.call(this,Xe,Tr);!un||this.callback(this.manager,Tr,{pointers:un[0],changedPointers:un[1],pointerType:ae,srcEvent:Xe})}});function Mn(ke,Xe){var Tr=vt(ke.touches),un=this.targetIds;if(Xe&(St|qt)&&Tr.length===1)return un[Tr[0].identifier]=!0,[Tr,Tr];var si,ji,Ma=vt(ke.changedTouches),ds=[],Ho=this.target;if(ji=Tr.filter(function(qo){return _e(qo.target,Ho)}),Xe===St)for(si=0;si<ji.length;)un[ji[si].identifier]=!0,si++;for(si=0;si<Ma.length;)un[Ma[si].identifier]&&ds.push(Ma[si]),Xe&($t|Ct)&&delete un[Ma[si].identifier],si++;if(!!ds.length)return[W(ji.concat(ds),"identifier",!0),ds]}var bi=2500,Si=25;function Kr(){Xt.apply(this,arguments);var ke=Ae(this.handler,this);this.touch=new Qr(this.manager,ke),this.mouse=new Wn(this.manager,ke),this.primaryTouch=null,this.lastTouches=[]}Dt(Kr,Xt,{handler:function(Xe,Tr,un){var si=un.pointerType==ae,ji=un.pointerType==or;if(!(ji&&un.sourceCapabilities&&un.sourceCapabilities.firesTouchEvents)){if(si)ai.call(this,Tr,un);else if(ji&&hi.call(this,un))return;this.callback(Xe,Tr,un)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ai(ke,Xe){ke&St?(this.primaryTouch=Xe.changedPointers[0].identifier,li.call(this,Xe)):ke&($t|Ct)&&li.call(this,Xe)}function li(ke){var Xe=ke.changedPointers[0];if(Xe.identifier===this.primaryTouch){var Tr={x:Xe.clientX,y:Xe.clientY};this.lastTouches.push(Tr);var un=this.lastTouches,si=function(){var ji=un.indexOf(Tr);ji>-1&&un.splice(ji,1)};setTimeout(si,bi)}}function hi(ke){for(var Xe=ke.srcEvent.clientX,Tr=ke.srcEvent.clientY,un=0;un<this.lastTouches.length;un++){var si=this.lastTouches[un],ji=Math.abs(Xe-si.x),Ma=Math.abs(Tr-si.y);if(ji<=Si&&Ma<=Si)return!0}return!1}var ra=ct?q:dt(Ee.style,"touchAction"),Ci=ra!==q,Ba="compute",po="auto",za="manipulation",Xa="none",Ta="pan-x",ga="pan-y",no=ja();function Vo(ke,Xe){this.manager=ke,this.set(Xe)}Vo.prototype={set:function(ke){ke==Ba&&(ke=this.compute()),Ci&&this.manager.element.style&&no[ke]&&(this.manager.element.style[ra]=ke),this.actions=ke.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ke=[];return le(this.manager.recognizers,function(Xe){be(Xe.options.enable,[Xe])&&(ke=ke.concat(Xe.getTouchAction()))}),vo(ke.join(" "))},preventDefaults:function(ke){var Xe=ke.srcEvent,Tr=ke.offsetDirection;if(this.manager.session.prevented){Xe.preventDefault();return}var un=this.actions,si=gt(un,Xa)&&!no[Xa],ji=gt(un,ga)&&!no[ga],Ma=gt(un,Ta)&&!no[Ta];if(si){var ds=ke.pointers.length===1,Ho=ke.distance<2,qo=ke.deltaTime<250;if(ds&&Ho&&qo)return}if(!(Ma&&ji)&&(si||ji&&Tr&At||Ma&&Tr&Mt))return this.preventSrc(Xe)},preventSrc:function(ke){this.manager.session.prevented=!0,ke.preventDefault()}};function vo(ke){if(gt(ke,Xa))return Xa;var Xe=gt(ke,Ta),Tr=gt(ke,ga);return Xe&&Tr?Xa:Xe||Tr?Xe?Ta:ga:gt(ke,za)?za:po}function ja(){if(!Ci)return!1;var ke={};if(ct)return ke;var Xe=wt.CSS&&wt.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Tr){ke[Tr]=Xe?wt.CSS.supports("touch-action",Tr):!0}),ke}var to=1,Uo=2,ju=4,Wo=8,bo=Wo,nr=16,xe=32;function He(ke){this.options=Ie({},this.defaults,ke||{}),this.id=ne(),this.manager=null,this.options.enable=me(this.options.enable,!0),this.state=to,this.simultaneous={},this.requireFail=[]}He.prototype={defaults:{},set:function(ke){return Ie(this.options,ke),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ke){if(X(ke,"recognizeWith",this))return this;var Xe=this.simultaneous;return ke=In(ke,this),Xe[ke.id]||(Xe[ke.id]=ke,ke.recognizeWith(this)),this},dropRecognizeWith:function(ke){return X(ke,"dropRecognizeWith",this)?this:(ke=In(ke,this),delete this.simultaneous[ke.id],this)},requireFailure:function(ke){if(X(ke,"requireFailure",this))return this;var Xe=this.requireFail;return ke=In(ke,this),J(Xe,ke)===-1&&(Xe.push(ke),ke.requireFailure(this)),this},dropRequireFailure:function(ke){if(X(ke,"dropRequireFailure",this))return this;ke=In(ke,this);var Xe=J(this.requireFail,ke);return Xe>-1&&this.requireFail.splice(Xe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ke){return!!this.simultaneous[ke.id]},emit:function(ke){var Xe=this,Tr=this.state;function un(si){Xe.manager.emit(si,ke)}Tr<Wo&&un(Xe.options.event+Mr(Tr)),un(Xe.options.event),ke.additionalEvent&&un(ke.additionalEvent),Tr>=Wo&&un(Xe.options.event+Mr(Tr))},tryEmit:function(ke){if(this.canEmit())return this.emit(ke);this.state=xe},canEmit:function(){for(var ke=0;ke<this.requireFail.length;){if(!(this.requireFail[ke].state&(xe|to)))return!1;ke++}return!0},recognize:function(ke){var Xe=Ie({},ke);if(!be(this.options.enable,[this,Xe])){this.reset(),this.state=xe;return}this.state&(bo|nr|xe)&&(this.state=to),this.state=this.process(Xe),this.state&(Uo|ju|Wo|nr)&&this.tryEmit(Xe)},process:function(ke){},getTouchAction:function(){},reset:function(){}};function Mr(ke){return ke&nr?"cancel":ke&Wo?"end":ke&ju?"move":ke&Uo?"start":""}function tn(ke){return ke==zt?"down":ke==We?"up":ke==ue?"left":ke==Oe?"right":""}function In(ke,Xe){var Tr=Xe.manager;return Tr?Tr.get(ke):ke}function Un(){He.apply(this,arguments)}Dt(Un,He,{defaults:{pointers:1},attrTest:function(ke){var Xe=this.options.pointers;return Xe===0||ke.pointers.length===Xe},process:function(ke){var Xe=this.state,Tr=ke.eventType,un=Xe&(Uo|ju),si=this.attrTest(ke);return un&&(Tr&Ct||!si)?Xe|nr:un||si?Tr&$t?Xe|Wo:Xe&Uo?Xe|ju:Uo:xe}});function Cn(){Un.apply(this,arguments),this.pX=null,this.pY=null}Dt(Cn,Un,{defaults:{event:"pan",threshold:10,pointers:1,direction:Rt},getTouchAction:function(){var ke=this.options.direction,Xe=[];return ke&At&&Xe.push(ga),ke&Mt&&Xe.push(Ta),Xe},directionTest:function(ke){var Xe=this.options,Tr=!0,un=ke.distance,si=ke.direction,ji=ke.deltaX,Ma=ke.deltaY;return si&Xe.direction||(Xe.direction&At?(si=ji===0?Tt:ji<0?ue:Oe,Tr=ji!=this.pX,un=Math.abs(ke.deltaX)):(si=Ma===0?Tt:Ma<0?We:zt,Tr=Ma!=this.pY,un=Math.abs(ke.deltaY))),ke.direction=si,Tr&&un>Xe.threshold&&si&Xe.direction},attrTest:function(ke){return Un.prototype.attrTest.call(this,ke)&&(this.state&Uo||!(this.state&Uo)&&this.directionTest(ke))},emit:function(ke){this.pX=ke.deltaX,this.pY=ke.deltaY;var Xe=tn(ke.direction);Xe&&(ke.additionalEvent=this.options.event+Xe),this._super.emit.call(this,ke)}});function ta(){Un.apply(this,arguments)}Dt(ta,Un,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xa]},attrTest:function(ke){return this._super.attrTest.call(this,ke)&&(Math.abs(ke.scale-1)>this.options.threshold||this.state&Uo)},emit:function(ke){if(ke.scale!==1){var Xe=ke.scale<1?"in":"out";ke.additionalEvent=this.options.event+Xe}this._super.emit.call(this,ke)}});function Wa(){He.apply(this,arguments),this._timer=null,this._input=null}Dt(Wa,He,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[po]},process:function(ke){var Xe=this.options,Tr=ke.pointers.length===Xe.pointers,un=ke.distance<Xe.threshold,si=ke.deltaTime>Xe.time;if(this._input=ke,!un||!Tr||ke.eventType&($t|Ct)&&!si)this.reset();else if(ke.eventType&St)this.reset(),this._timer=b(function(){this.state=bo,this.tryEmit()},Xe.time,this);else if(ke.eventType&$t)return bo;return xe},reset:function(){clearTimeout(this._timer)},emit:function(ke){this.state===bo&&(ke&&ke.eventType&$t?this.manager.emit(this.options.event+"up",ke):(this._input.timeStamp=P(),this.manager.emit(this.options.event,this._input)))}});function es(){Un.apply(this,arguments)}Dt(es,Un,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xa]},attrTest:function(ke){return this._super.attrTest.call(this,ke)&&(Math.abs(ke.rotation)>this.options.threshold||this.state&Uo)}});function ko(){Un.apply(this,arguments)}Dt(ko,Un,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:At|Mt,pointers:1},getTouchAction:function(){return Cn.prototype.getTouchAction.call(this)},attrTest:function(ke){var Xe=this.options.direction,Tr;return Xe&(At|Mt)?Tr=ke.overallVelocity:Xe&At?Tr=ke.overallVelocityX:Xe&Mt&&(Tr=ke.overallVelocityY),this._super.attrTest.call(this,ke)&&Xe&ke.offsetDirection&&ke.distance>this.options.threshold&&ke.maxPointers==this.options.pointers&&Zt(Tr)>this.options.velocity&&ke.eventType&$t},emit:function(ke){var Xe=tn(ke.offsetDirection);Xe&&this.manager.emit(this.options.event+Xe,ke),this.manager.emit(this.options.event,ke)}});function ns(){He.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Dt(ns,He,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[za]},process:function(ke){var Xe=this.options,Tr=ke.pointers.length===Xe.pointers,un=ke.distance<Xe.threshold,si=ke.deltaTime<Xe.time;if(this.reset(),ke.eventType&St&&this.count===0)return this.failTimeout();if(un&&si&&Tr){if(ke.eventType!=$t)return this.failTimeout();var ji=this.pTime?ke.timeStamp-this.pTime<Xe.interval:!0,Ma=!this.pCenter||Zr(this.pCenter,ke.center)<Xe.posThreshold;this.pTime=ke.timeStamp,this.pCenter=ke.center,!Ma||!ji?this.count=1:this.count+=1,this._input=ke;var ds=this.count%Xe.taps;if(ds===0)return this.hasRequireFailures()?(this._timer=b(function(){this.state=bo,this.tryEmit()},Xe.interval,this),Uo):bo}return xe},failTimeout:function(){return this._timer=b(function(){this.state=xe},this.options.interval,this),xe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==bo&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Ya(ke,Xe){return Xe=Xe||{},Xe.recognizers=me(Xe.recognizers,Ya.defaults.preset),new ys(ke,Xe)}Ya.VERSION="2.0.7",Ya.defaults={domEvents:!1,touchAction:Ba,enable:!0,inputTarget:null,inputClass:null,preset:[[es,{enable:!1}],[ta,{enable:!1},["rotate"]],[ko,{direction:At}],[Cn,{direction:At},["swipe"]],[ns],[ns,{event:"doubletap",taps:2},["tap"]],[Wa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Go=1,pu=2;function ys(ke,Xe){this.options=Ie({},Ya.defaults,Xe||{}),this.options.inputTarget=this.options.inputTarget||ke,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ke,this.input=ve(this),this.touchAction=new Vo(this,this.options.touchAction),Rl(this,!0),le(this.options.recognizers,function(Tr){var un=this.add(new Tr[0](Tr[1]));Tr[2]&&un.recognizeWith(Tr[2]),Tr[3]&&un.requireFailure(Tr[3])},this)}ys.prototype={set:function(ke){return Ie(this.options,ke),ke.touchAction&&this.touchAction.update(),ke.inputTarget&&(this.input.destroy(),this.input.target=ke.inputTarget,this.input.init()),this},stop:function(ke){this.session.stopped=ke?pu:Go},recognize:function(ke){var Xe=this.session;if(!Xe.stopped){this.touchAction.preventDefaults(ke);var Tr,un=this.recognizers,si=Xe.curRecognizer;(!si||si&&si.state&bo)&&(si=Xe.curRecognizer=null);for(var ji=0;ji<un.length;)Tr=un[ji],Xe.stopped!==pu&&(!si||Tr==si||Tr.canRecognizeWith(si))?Tr.recognize(ke):Tr.reset(),!si&&Tr.state&(Uo|ju|Wo)&&(si=Xe.curRecognizer=Tr),ji++}},get:function(ke){if(ke instanceof He)return ke;for(var Xe=this.recognizers,Tr=0;Tr<Xe.length;Tr++)if(Xe[Tr].options.event==ke)return Xe[Tr];return null},add:function(ke){if(X(ke,"add",this))return this;var Xe=this.get(ke.options.event);return Xe&&this.remove(Xe),this.recognizers.push(ke),ke.manager=this,this.touchAction.update(),ke},remove:function(ke){if(X(ke,"remove",this))return this;if(ke=this.get(ke),ke){var Xe=this.recognizers,Tr=J(Xe,ke);Tr!==-1&&(Xe.splice(Tr,1),this.touchAction.update())}return this},on:function(ke,Xe){if(ke!==q&&Xe!==q){var Tr=this.handlers;return le(Pt(ke),function(un){Tr[un]=Tr[un]||[],Tr[un].push(Xe)}),this}},off:function(ke,Xe){if(ke!==q){var Tr=this.handlers;return le(Pt(ke),function(un){Xe?Tr[un]&&Tr[un].splice(J(Tr[un],Xe),1):delete Tr[un]}),this}},emit:function(ke,Xe){this.options.domEvents&&mf(ke,Xe);var Tr=this.handlers[ke]&&this.handlers[ke].slice();if(!(!Tr||!Tr.length)){Xe.type=ke,Xe.preventDefault=function(){Xe.srcEvent.preventDefault()};for(var un=0;un<Tr.length;)Tr[un](Xe),un++}},destroy:function(){this.element&&Rl(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Rl(ke,Xe){var Tr=ke.element;if(!!Tr.style){var un;le(ke.options.cssProps,function(si,ji){un=dt(Tr.style,ji),Xe?(ke.oldCssProps[un]=Tr.style[un],Tr.style[un]=si):Tr.style[un]=ke.oldCssProps[un]||""}),Xe||(ke.oldCssProps={})}}function mf(ke,Xe){if(!ct){var Tr=I.createEvent("Event");Tr.initEvent(ke,!0,!0),Tr.gesture=Xe,Xe.target.dispatchEvent(Tr)}}if(!ct){Ie(Ya,{INPUT_START:St,INPUT_MOVE:qt,INPUT_END:$t,INPUT_CANCEL:Ct,STATE_POSSIBLE:to,STATE_BEGAN:Uo,STATE_CHANGED:ju,STATE_ENDED:Wo,STATE_RECOGNIZED:bo,STATE_CANCELLED:nr,STATE_FAILED:xe,DIRECTION_NONE:Tt,DIRECTION_LEFT:ue,DIRECTION_RIGHT:Oe,DIRECTION_UP:We,DIRECTION_DOWN:zt,DIRECTION_HORIZONTAL:At,DIRECTION_VERTICAL:Mt,DIRECTION_ALL:Rt,Manager:ys,Input:Xt,TouchAction:Vo,TouchInput:Qr,MouseInput:Wn,PointerEventInput:Ue,TouchMouseInput:Kr,SingleTouchInput:ur,Recognizer:He,AttrRecognizer:Un,Tap:ns,Pan:Cn,Swipe:ko,Pinch:ta,Rotate:es,Press:Wa,on:ee,off:we,each:le,merge:rt,extend:It,assign:Ie,inherit:Dt,bindFn:Ae,prefixed:dt});var Wu=typeof window!="undefined"?window:typeof self!="undefined"?self:{};Wu.Hammer=Ya,Lt=function(){return Ya}.call(Ft,ot,Ft,vn),Lt!==q&&(vn.exports=Lt)}})(typeof window!="undefined"?window:{console:null,MSPointerEvent:null,PointerEvent:null,CSS:null},document,"Hammer")},88307:function(vn,Ft,ot){(function(Lt,wt){vn.exports=wt(ot(12380))})(this,function(Lt){"use strict";var wt=function(kt){return kt instanceof Uint8Array||kt instanceof Uint16Array||kt instanceof Uint32Array||kt instanceof Int8Array||kt instanceof Int16Array||kt instanceof Int32Array||kt instanceof Float32Array||kt instanceof Float64Array||kt instanceof Uint8ClampedArray},I=function(kt,Ze){for(var dr=Object.keys(Ze),cn=0;cn<dr.length;++cn)kt[dr[cn]]=Ze[dr[cn]];return kt},Et=`
`;function q(kt){return typeof atob!="undefined"?atob(kt):"base64:"+kt}function lt(kt){var Ze=new Error("(regl) "+kt);throw console.error(Ze),Ze}function ht(kt,Ze){kt||lt(Ze)}function ct(kt){return kt?": "+kt:""}function et(kt,Ze,dr){kt in Ze||lt("unknown parameter ("+kt+")"+ct(dr)+". possible values: "+Object.keys(Ze).join())}function Ee(kt,Ze){wt(kt)||lt("invalid parameter type"+ct(Ze)+". must be a typed array")}function it(kt,Ze){switch(Ze){case"number":return typeof kt=="number";case"object":return typeof kt=="object";case"string":return typeof kt=="string";case"boolean":return typeof kt=="boolean";case"function":return typeof kt=="function";case"undefined":return typeof kt=="undefined";case"symbol":return typeof kt=="symbol"}}function st(kt,Ze,dr){it(kt,Ze)||lt("invalid parameter type"+ct(dr)+". expected "+Ze+", got "+typeof kt)}function Zt(kt,Ze){kt>=0&&(kt|0)===kt||lt("invalid parameter type, ("+kt+")"+ct(Ze)+". must be a nonnegative integer")}function P(kt,Ze,dr){Ze.indexOf(kt)<0&&lt("invalid value"+ct(dr)+". must be one of: "+Ze)}var b=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function X(kt){Object.keys(kt).forEach(function(Ze){b.indexOf(Ze)<0&&lt('invalid regl constructor argument "'+Ze+'". must be one of '+b)})}function le(kt,Ze){for(kt=kt+"";kt.length<Ze;)kt=" "+kt;return kt}function Se(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Ie(kt,Ze){this.number=kt,this.line=Ze,this.errors=[]}function It(kt,Ze,dr){this.file=kt,this.line=Ze,this.message=dr}function rt(){var kt=new Error,Ze=(kt.stack||kt).toString(),dr=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(Ze);if(dr)return dr[1];var cn=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(Ze);return cn?cn[1]:"unknown"}function Dt(){var kt=new Error,Ze=(kt.stack||kt).toString(),dr=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(Ze);if(dr)return dr[1];var cn=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(Ze);return cn?cn[1]:"unknown"}function Ae(kt,Ze){var dr=kt.split(`
`),cn=1,On=0,on={unknown:new Se,0:new Se};on.unknown.name=on[0].name=Ze||rt(),on.unknown.lines.push(new Ie(0,""));for(var En=0;En<dr.length;++En){var Dn=dr[En],Hn=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Dn);if(Hn)switch(Hn[1]){case"line":var Jn=/(\d+)(\s+\d+)?/.exec(Hn[2]);Jn&&(cn=Jn[1]|0,Jn[2]&&(On=Jn[2]|0,On in on||(on[On]=new Se)));break;case"define":var ii=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Hn[2]);ii&&(on[On].name=ii[1]?q(ii[2]):ii[2]);break}on[On].lines.push(new Ie(cn++,Dn))}return Object.keys(on).forEach(function(ui){var yi=on[ui];yi.lines.forEach(function(qn){yi.index[qn.number]=qn})}),on}function be(kt){var Ze=[];return kt.split(`
`).forEach(function(dr){if(!(dr.length<5)){var cn=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(dr);cn?Ze.push(new It(cn[1]|0,cn[2]|0,cn[3].trim())):dr.length>0&&Ze.push(new It("unknown",0,dr))}}),Ze}function me(kt,Ze){Ze.forEach(function(dr){var cn=kt[dr.file];if(cn){var On=cn.index[dr.line];if(On){On.errors.push(dr),cn.hasErrors=!0;return}}kt.unknown.hasErrors=!0,kt.unknown.lines[0].errors.push(dr)})}function ee(kt,Ze,dr,cn,On){if(!kt.getShaderParameter(Ze,kt.COMPILE_STATUS)){var on=kt.getShaderInfoLog(Ze),En=cn===kt.FRAGMENT_SHADER?"fragment":"vertex";W(dr,"string",En+" shader source must be a string",On);var Dn=Ae(dr,On),Hn=be(on);me(Dn,Hn),Object.keys(Dn).forEach(function(Jn){var ii=Dn[Jn];if(!ii.hasErrors)return;var ui=[""],yi=[""];function qn(ri,Gr){ui.push(ri),yi.push(Gr||"")}qn("file number "+Jn+": "+ii.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),ii.lines.forEach(function(ri){if(ri.errors.length>0){qn(le(ri.number,4)+"|  ","background-color:yellow; font-weight:bold"),qn(ri.line+Et,"color:red; background-color:yellow; font-weight:bold");var Gr=0;ri.errors.forEach(function(dn){var Xn=dn.message,vi=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Xn);if(vi){var Rn=vi[1];switch(Xn=vi[2],Rn){case"assign":Rn="=";break}Gr=Math.max(ri.line.indexOf(Rn,Gr),0)}else Gr=0;qn(le("| ",6)),qn(le("^^^",Gr+3)+Et,"font-weight:bold"),qn(le("| ",6)),qn(Xn+Et,"font-weight:bold")}),qn(le("| ",6)+Et)}else qn(le(ri.number,4)+"|  "),qn(ri.line+Et,"color:red")}),typeof document!="undefined"&&!window.chrome?(yi[0]=ui.join("%c"),console.log.apply(console,yi)):console.log(ui.join(""))}),ht.raise("Error compiling "+En+" shader, "+Dn[0].name)}}function we(kt,Ze,dr,cn,On){if(!kt.getProgramParameter(Ze,kt.LINK_STATUS)){var on=kt.getProgramInfoLog(Ze),En=Ae(dr,On),Dn=Ae(cn,On),Hn='Error linking program with vertex shader, "'+Dn[0].name+'", and fragment shader "'+En[0].name+'"';typeof document!="undefined"?console.log("%c"+Hn+Et+"%c"+on,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Hn+Et+on),ht.raise(Hn)}}function _e(kt){kt._commandRef=rt()}function gt(kt,Ze,dr,cn){_e(kt);function On(Hn){return Hn?cn.id(Hn):0}kt._fragId=On(kt.static.frag),kt._vertId=On(kt.static.vert);function on(Hn,Jn){Object.keys(Jn).forEach(function(ii){Hn[cn.id(ii)]=!0})}var En=kt._uniformSet={};on(En,Ze.static),on(En,Ze.dynamic);var Dn=kt._attributeSet={};on(Dn,dr.static),on(Dn,dr.dynamic),kt._hasCount="count"in kt.static||"count"in kt.dynamic||"elements"in kt.static||"elements"in kt.dynamic}function Pt(kt,Ze){var dr=Dt();lt(kt+" in command "+(Ze||rt())+(dr==="unknown"?"":" called from "+dr))}function J(kt,Ze,dr){kt||Pt(Ze,dr||rt())}function vt(kt,Ze,dr,cn){kt in Ze||Pt("unknown parameter ("+kt+")"+ct(dr)+". possible values: "+Object.keys(Ze).join(),cn||rt())}function W(kt,Ze,dr,cn){it(kt,Ze)||Pt("invalid parameter type"+ct(dr)+". expected "+Ze+", got "+typeof kt,cn||rt())}function dt(kt){kt()}function Vt(kt,Ze,dr){kt.texture?P(kt.texture._texture.internalformat,Ze,"unsupported texture format for attachment"):P(kt.renderbuffer._renderbuffer.format,dr,"unsupported renderbuffer format for attachment")}var ne=33071,ge=9728,$e=9984,jt=9985,Qt=9986,Te=9987,ae=5120,Ke=5121,or=5122,ie=5123,te=5124,St=5125,qt=5126,$t=32819,Ct=32820,Tt=33635,ue=34042,Oe=36193,We={};We[ae]=We[Ke]=1,We[or]=We[ie]=We[Oe]=We[Tt]=We[$t]=We[Ct]=2,We[te]=We[St]=We[qt]=We[ue]=4;function zt(kt,Ze){return kt===Ct||kt===$t||kt===Tt?2:kt===ue?4:We[kt]*Ze}function At(kt){return!(kt&kt-1)&&!!kt}function Mt(kt,Ze,dr){var cn,On=Ze.width,on=Ze.height,En=Ze.channels;ht(On>0&&On<=dr.maxTextureSize&&on>0&&on<=dr.maxTextureSize,"invalid texture shape"),(kt.wrapS!==ne||kt.wrapT!==ne)&&ht(At(On)&&At(on),"incompatible wrap mode for texture, both width and height must be power of 2"),Ze.mipmask===1?On!==1&&on!==1&&ht(kt.minFilter!==$e&&kt.minFilter!==Qt&&kt.minFilter!==jt&&kt.minFilter!==Te,"min filter requires mipmap"):(ht(At(On)&&At(on),"texture must be a square power of 2 to support mipmapping"),ht(Ze.mipmask===(On<<1)-1,"missing or incomplete mipmap data")),Ze.type===qt&&(dr.extensions.indexOf("oes_texture_float_linear")<0&&ht(kt.minFilter===ge&&kt.magFilter===ge,"filter not supported, must enable oes_texture_float_linear"),ht(!kt.genMipmaps,"mipmap generation not supported with float textures"));var Dn=Ze.images;for(cn=0;cn<16;++cn)if(Dn[cn]){var Hn=On>>cn,Jn=on>>cn;ht(Ze.mipmask&1<<cn,"missing mipmap data");var ii=Dn[cn];if(ht(ii.width===Hn&&ii.height===Jn,"invalid shape for mip images"),ht(ii.format===Ze.format&&ii.internalformat===Ze.internalformat&&ii.type===Ze.type,"incompatible type for mip image"),!ii.compressed)if(ii.data){var ui=Math.ceil(zt(ii.type,En)*Hn/ii.unpackAlignment)*ii.unpackAlignment;ht(ii.data.byteLength===ui*Jn,"invalid data for image, buffer size is inconsistent with image format")}else ii.element||ii.copy}else kt.genMipmaps||ht((Ze.mipmask&1<<cn)===0,"extra mipmap data");Ze.compressed&&ht(!kt.genMipmaps,"mipmap generation for compressed images not supported")}function Rt(kt,Ze,dr,cn){var On=kt.width,on=kt.height,En=kt.channels;ht(On>0&&On<=cn.maxTextureSize&&on>0&&on<=cn.maxTextureSize,"invalid texture shape"),ht(On===on,"cube map must be square"),ht(Ze.wrapS===ne&&Ze.wrapT===ne,"wrap mode not supported by cube map");for(var Dn=0;Dn<dr.length;++Dn){var Hn=dr[Dn];ht(Hn.width===On&&Hn.height===on,"inconsistent cube map face shape"),Ze.genMipmaps&&(ht(!Hn.compressed,"can not generate mipmap for compressed textures"),ht(Hn.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Jn=Hn.images,ii=0;ii<16;++ii){var ui=Jn[ii];if(ui){var yi=On>>ii,qn=on>>ii;ht(Hn.mipmask&1<<ii,"missing mipmap data"),ht(ui.width===yi&&ui.height===qn,"invalid shape for mip images"),ht(ui.format===kt.format&&ui.internalformat===kt.internalformat&&ui.type===kt.type,"incompatible type for mip image"),ui.compressed||(ui.data?ht(ui.data.byteLength===yi*qn*Math.max(zt(ui.type,En),ui.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ui.element||ui.copy)}}}}var tt=I(ht,{optional:dt,raise:lt,commandRaise:Pt,command:J,parameter:et,commandParameter:vt,constructor:X,type:st,commandType:W,isTypedArray:Ee,nni:Zt,oneOf:P,shaderError:ee,linkError:we,callSite:Dt,saveCommandRef:_e,saveDrawInfo:gt,framebufferFormat:Vt,guessCommand:rt,texture2D:Mt,textureCube:Rt}),_t=0,Xt=0,ve=5,Wt=6;function Me(kt,Ze){this.id=_t++,this.type=kt,this.data=Ze}function je(kt){return kt.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Qe(kt){if(kt.length===0)return[];var Ze=kt.charAt(0),dr=kt.charAt(kt.length-1);if(kt.length>1&&Ze===dr&&(Ze==='"'||Ze==="'"))return['"'+je(kt.substr(1,kt.length-2))+'"'];var cn=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(kt);if(cn)return Qe(kt.substr(0,cn.index)).concat(Qe(cn[1])).concat(Qe(kt.substr(cn.index+cn[0].length)));var On=kt.split(".");if(On.length===1)return['"'+je(kt)+'"'];for(var on=[],En=0;En<On.length;++En)on=on.concat(Qe(On[En]));return on}function hr(kt){return"["+Qe(kt).join("][")+"]"}function er(kt,Ze){return new Me(kt,hr(Ze+""))}function Br(kt){return typeof kt=="function"&&!kt._reglType||kt instanceof Me}function Lr(kt,Ze){if(typeof kt=="function")return new Me(Xt,kt);if(typeof kt=="number"||typeof kt=="boolean")return new Me(ve,kt);if(Array.isArray(kt))return new Me(Wt,kt.map(function(dr,cn){return Lr(dr,Ze+"["+cn+"]")}));if(kt instanceof Me)return kt;tt(!1,"invalid option type in uniform "+Ze)}var Zr={DynamicVariable:Me,define:er,isDynamic:Br,unbox:Lr,accessor:hr},Tn={next:typeof requestAnimationFrame=="function"?function(kt){return requestAnimationFrame(kt)}:function(kt){return setTimeout(kt,16)},cancel:typeof cancelAnimationFrame=="function"?function(kt){return cancelAnimationFrame(kt)}:clearTimeout},rn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,Nn=rn?function(){return+new Date}:typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date};function zn(){var kt={"":0},Ze=[""];return{id:function(dr){var cn=kt[dr];return cn||(cn=kt[dr]=Ze.length,Ze.push(dr),cn)},str:function(dr){return Ze[dr]}}}function jn(kt,Ze,dr){var cn=document.createElement("canvas");I(cn.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),kt.appendChild(cn),kt===document.body&&(cn.style.position="absolute",I(kt.style,{margin:0,padding:0}));function On(){var Dn=window.innerWidth,Hn=window.innerHeight;if(kt!==document.body){var Jn=cn.getBoundingClientRect();Dn=Jn.right-Jn.left,Hn=Jn.bottom-Jn.top}cn.width=dr*Dn,cn.height=dr*Hn}var on;kt!==document.body&&typeof ResizeObserver=="function"?(on=new ResizeObserver(function(){setTimeout(On)}),on.observe(kt)):window.addEventListener("resize",On,!1);function En(){on?on.disconnect():window.removeEventListener("resize",On),kt.removeChild(cn)}return On(),{canvas:cn,onDestroy:En}}function wn(kt,Ze){function dr(cn){try{return kt.getContext(cn,Ze)}catch(On){return null}}return dr("webgl")||dr("experimental-webgl")||dr("webgl-experimental")}function Wn(kt){return typeof kt.nodeName=="string"&&typeof kt.appendChild=="function"&&typeof kt.getBoundingClientRect=="function"}function Bt(kt){return typeof kt.drawArrays=="function"||typeof kt.drawElements=="function"}function Yt(kt){return typeof kt=="string"?kt.split():(tt(Array.isArray(kt),"invalid extension array"),kt)}function oe(kt){return typeof kt=="string"?(tt(typeof document!="undefined","not supported outside of DOM"),document.querySelector(kt)):kt}function Ce(kt){var Ze=kt||{},dr,cn,On,on,En={},Dn=[],Hn=[],Jn=typeof window=="undefined"?1:window.devicePixelRatio,ii=!1,ui=function(ri){ri&&tt.raise(ri)},yi=function(){};if(typeof Ze=="string"?(tt(typeof document!="undefined","selector queries only supported in DOM environments"),dr=document.querySelector(Ze),tt(dr,"invalid query string for element")):typeof Ze=="object"?Wn(Ze)?dr=Ze:Bt(Ze)?(on=Ze,On=on.canvas):(tt.constructor(Ze),"gl"in Ze?on=Ze.gl:"canvas"in Ze?On=oe(Ze.canvas):"container"in Ze&&(cn=oe(Ze.container)),"attributes"in Ze&&(En=Ze.attributes,tt.type(En,"object","invalid context attributes")),"extensions"in Ze&&(Dn=Yt(Ze.extensions)),"optionalExtensions"in Ze&&(Hn=Yt(Ze.optionalExtensions)),"onDone"in Ze&&(tt.type(Ze.onDone,"function","invalid or missing onDone callback"),ui=Ze.onDone),"profile"in Ze&&(ii=!!Ze.profile),"pixelRatio"in Ze&&(Jn=+Ze.pixelRatio,tt(Jn>0,"invalid pixel ratio"))):tt.raise("invalid arguments to regl"),dr&&(dr.nodeName.toLowerCase()==="canvas"?On=dr:cn=dr),!on){if(!On){tt(typeof document!="undefined","must manually specify webgl context outside of DOM environments");var qn=jn(cn||document.body,ui,Jn);if(!qn)return null;On=qn.canvas,yi=qn.onDestroy}En.premultipliedAlpha===void 0&&(En.premultipliedAlpha=!0),on=wn(On,En)}return on?{gl:on,canvas:On,container:cn,extensions:Dn,optionalExtensions:Hn,pixelRatio:Jn,profile:ii,onDone:ui,onDestroy:yi}:(yi(),ui("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Ue(kt,Ze){var dr={};function cn(Dn){tt.type(Dn,"string","extension name must be string");var Hn=Dn.toLowerCase(),Jn;try{Jn=dr[Hn]=On(Dn)}catch(ii){}return!!Jn}function On(Dn){return kt.getExtension(Dn)?kt.getExtension(Dn):kt.getExtension(Dn.toLowerCase())?kt.getExtension(Dn.toLowerCase()):null}for(var on=0;on<Ze.extensions.length;++on){var En=Ze.extensions[on];if(!cn(En))return Ze.onDestroy(),Ze.onDone('"'+En+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Ze.optionalExtensions.forEach(cn),{extensions:dr,restore:function(){Object.keys(dr).forEach(function(Dn){if(dr[Dn]&&!cn(Dn))throw new Error("(regl): error restoring extension "+Dn)})}}}function fr(kt,Ze){for(var dr=Array(kt),cn=0;cn<kt;++cn)dr[cn]=Ze(cn);return dr}var Sr=5120,Pe=5121,ur=5122,Wr=5123,Sn=5124,qr=5125,Qr=5126;function Mn(kt){for(var Ze=16;Ze<=1<<28;Ze*=16)if(kt<=Ze)return Ze;return 0}function bi(kt){var Ze,dr;return Ze=(kt>65535)<<4,kt>>>=Ze,dr=(kt>255)<<3,kt>>>=dr,Ze|=dr,dr=(kt>15)<<2,kt>>>=dr,Ze|=dr,dr=(kt>3)<<1,kt>>>=dr,Ze|=dr,Ze|kt>>1}function Si(){var kt=fr(8,function(){return[]});function Ze(on){var En=Mn(on),Dn=kt[bi(En)>>2];return Dn.length>0?Dn.pop():new ArrayBuffer(En)}function dr(on){kt[bi(on.byteLength)>>2].push(on)}function cn(on,En){var Dn=null;switch(on){case Sr:Dn=new Int8Array(Ze(En),0,En);break;case Pe:Dn=new Uint8Array(Ze(En),0,En);break;case ur:Dn=new Int16Array(Ze(2*En),0,En);break;case Wr:Dn=new Uint16Array(Ze(2*En),0,En);break;case Sn:Dn=new Int32Array(Ze(4*En),0,En);break;case qr:Dn=new Uint32Array(Ze(4*En),0,En);break;case Qr:Dn=new Float32Array(Ze(4*En),0,En);break;default:return null}return Dn.length!==En?Dn.subarray(0,En):Dn}function On(on){dr(on.buffer)}return{alloc:Ze,free:dr,allocType:cn,freeType:On}}var Kr=Si();Kr.zero=Si();var ai=3408,li=3410,hi=3411,ra=3412,Ci=3413,Ba=3414,po=3415,za=33901,Xa=33902,Ta=3379,ga=3386,no=34921,Vo=36347,vo=36348,ja=35661,to=35660,Uo=34930,ju=36349,Wo=34076,bo=34024,nr=7936,xe=7937,He=7938,Mr=35724,tn=34047,In=36063,Un=34852,Cn=3553,ta=34067,Wa=34069,es=33984,ko=6408,ns=5126,Ya=5121,Go=36160,pu=36053,ys=36064,Rl=16384,mf=function(kt,Ze){var dr=1;Ze.ext_texture_filter_anisotropic&&(dr=kt.getParameter(tn));var cn=1,On=1;Ze.webgl_draw_buffers&&(cn=kt.getParameter(Un),On=kt.getParameter(In));var on=!!Ze.oes_texture_float;if(on){var En=kt.createTexture();kt.bindTexture(Cn,En),kt.texImage2D(Cn,0,ko,1,1,0,ko,ns,null);var Dn=kt.createFramebuffer();if(kt.bindFramebuffer(Go,Dn),kt.framebufferTexture2D(Go,ys,Cn,En,0),kt.bindTexture(Cn,null),kt.checkFramebufferStatus(Go)!==pu)on=!1;else{kt.viewport(0,0,1,1),kt.clearColor(1,0,0,1),kt.clear(Rl);var Hn=Kr.allocType(ns,4);kt.readPixels(0,0,1,1,ko,ns,Hn),kt.getError()?on=!1:(kt.deleteFramebuffer(Dn),kt.deleteTexture(En),on=Hn[0]===1),Kr.freeType(Hn)}}var Jn=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),ii=!0;if(!Jn){var ui=kt.createTexture(),yi=Kr.allocType(Ya,36);kt.activeTexture(es),kt.bindTexture(ta,ui),kt.texImage2D(Wa,0,ko,3,3,0,ko,Ya,yi),Kr.freeType(yi),kt.bindTexture(ta,null),kt.deleteTexture(ui),ii=!kt.getError()}return{colorBits:[kt.getParameter(li),kt.getParameter(hi),kt.getParameter(ra),kt.getParameter(Ci)],depthBits:kt.getParameter(Ba),stencilBits:kt.getParameter(po),subpixelBits:kt.getParameter(ai),extensions:Object.keys(Ze).filter(function(qn){return!!Ze[qn]}),maxAnisotropic:dr,maxDrawbuffers:cn,maxColorAttachments:On,pointSizeDims:kt.getParameter(za),lineWidthDims:kt.getParameter(Xa),maxViewportDims:kt.getParameter(ga),maxCombinedTextureUnits:kt.getParameter(ja),maxCubeMapSize:kt.getParameter(Wo),maxRenderbufferSize:kt.getParameter(bo),maxTextureUnits:kt.getParameter(Uo),maxTextureSize:kt.getParameter(Ta),maxAttributes:kt.getParameter(no),maxVertexUniforms:kt.getParameter(Vo),maxVertexTextureUnits:kt.getParameter(to),maxVaryingVectors:kt.getParameter(vo),maxFragmentUniforms:kt.getParameter(ju),glsl:kt.getParameter(Mr),renderer:kt.getParameter(xe),vendor:kt.getParameter(nr),version:kt.getParameter(He),readFloat:on,npotTextureCube:ii}};function Wu(kt){return!!kt&&typeof kt=="object"&&Array.isArray(kt.shape)&&Array.isArray(kt.stride)&&typeof kt.offset=="number"&&kt.shape.length===kt.stride.length&&(Array.isArray(kt.data)||wt(kt.data))}var ke=function(kt){return Object.keys(kt).map(function(Ze){return kt[Ze]})},Xe={shape:ds,flatten:Ma};function Tr(kt,Ze,dr){for(var cn=0;cn<Ze;++cn)dr[cn]=kt[cn]}function un(kt,Ze,dr,cn){for(var On=0,on=0;on<Ze;++on)for(var En=kt[on],Dn=0;Dn<dr;++Dn)cn[On++]=En[Dn]}function si(kt,Ze,dr,cn,On,on){for(var En=on,Dn=0;Dn<Ze;++Dn)for(var Hn=kt[Dn],Jn=0;Jn<dr;++Jn)for(var ii=Hn[Jn],ui=0;ui<cn;++ui)On[En++]=ii[ui]}function ji(kt,Ze,dr,cn,On){for(var on=1,En=dr+1;En<Ze.length;++En)on*=Ze[En];var Dn=Ze[dr];if(Ze.length-dr===4){var Hn=Ze[dr+1],Jn=Ze[dr+2],ii=Ze[dr+3];for(En=0;En<Dn;++En)si(kt[En],Hn,Jn,ii,cn,On),On+=on}else for(En=0;En<Dn;++En)ji(kt[En],Ze,dr+1,cn,On),On+=on}function Ma(kt,Ze,dr,cn){var On=1;if(Ze.length)for(var on=0;on<Ze.length;++on)On*=Ze[on];else On=0;var En=cn||Kr.allocType(dr,On);switch(Ze.length){case 0:break;case 1:Tr(kt,Ze[0],En);break;case 2:un(kt,Ze[0],Ze[1],En);break;case 3:si(kt,Ze[0],Ze[1],Ze[2],En,0);break;default:ji(kt,Ze,0,En,0)}return En}function ds(kt){for(var Ze=[],dr=kt;dr.length;dr=dr[0])Ze.push(dr.length);return Ze}var Ho={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},qo=5120,Hs=5122,Xu=5124,_s=5121,vs=5123,Ou=5125,rl=5126,nu=5126,dl={int8:qo,int16:Hs,int32:Xu,uint8:_s,uint16:vs,uint32:Ou,float:rl,float32:nu},Fu=35048,Fo=35040,rs={dynamic:Fu,stream:Fo,static:35044},Uc=Xe.flatten,_u=Xe.shape,Zc=35044,Co=35040,sc=5121,Xl=5126,nl=[];nl[5120]=1,nl[5122]=2,nl[5124]=4,nl[5121]=1,nl[5123]=2,nl[5125]=4,nl[5126]=4;function uc(kt){return Ho[Object.prototype.toString.call(kt)]|0}function D(kt,Ze){for(var dr=0;dr<Ze.length;++dr)kt[dr]=Ze[dr]}function Y(kt,Ze,dr,cn,On,on,En){for(var Dn=0,Hn=0;Hn<dr;++Hn)for(var Jn=0;Jn<cn;++Jn)kt[Dn++]=Ze[On*Hn+on*Jn+En]}function bt(kt,Ze,dr,cn){var On=0,on={};function En(Gr){this.id=On++,this.buffer=kt.createBuffer(),this.type=Gr,this.usage=Zc,this.byteLength=0,this.dimension=1,this.dtype=sc,this.persistentData=null,dr.profile&&(this.stats={size:0})}En.prototype.bind=function(){kt.bindBuffer(this.type,this.buffer)},En.prototype.destroy=function(){yi(this)};var Dn=[];function Hn(Gr,dn){var Xn=Dn.pop();return Xn||(Xn=new En(Gr)),Xn.bind(),ui(Xn,dn,Co,0,1,!1),Xn}function Jn(Gr){Dn.push(Gr)}function ii(Gr,dn,Xn){Gr.byteLength=dn.byteLength,kt.bufferData(Gr.type,dn,Xn)}function ui(Gr,dn,Xn,vi,Rn,Qn){var Ti;if(Gr.usage=Xn,Array.isArray(dn)){if(Gr.dtype=vi||Xl,dn.length>0){var aa;if(Array.isArray(dn[0])){Ti=_u(dn);for(var _n=1,An=1;An<Ti.length;++An)_n*=Ti[An];Gr.dimension=_n,aa=Uc(dn,Ti,Gr.dtype),ii(Gr,aa,Xn),Qn?Gr.persistentData=aa:Kr.freeType(aa)}else if(typeof dn[0]=="number"){Gr.dimension=Rn;var oi=Kr.allocType(Gr.dtype,dn.length);D(oi,dn),ii(Gr,oi,Xn),Qn?Gr.persistentData=oi:Kr.freeType(oi)}else wt(dn[0])?(Gr.dimension=dn[0].length,Gr.dtype=vi||uc(dn[0])||Xl,aa=Uc(dn,[dn.length,dn[0].length],Gr.dtype),ii(Gr,aa,Xn),Qn?Gr.persistentData=aa:Kr.freeType(aa)):tt.raise("invalid buffer data")}}else if(wt(dn))Gr.dtype=vi||uc(dn),Gr.dimension=Rn,ii(Gr,dn,Xn),Qn&&(Gr.persistentData=new Uint8Array(new Uint8Array(dn.buffer)));else if(Wu(dn)){Ti=dn.shape;var Ei=dn.stride,ti=dn.offset,xi=0,Mi=0,Ua=0,Yn=0;Ti.length===1?(xi=Ti[0],Mi=1,Ua=Ei[0],Yn=0):Ti.length===2?(xi=Ti[0],Mi=Ti[1],Ua=Ei[0],Yn=Ei[1]):tt.raise("invalid shape"),Gr.dtype=vi||uc(dn.data)||Xl,Gr.dimension=Mi;var Ii=Kr.allocType(Gr.dtype,xi*Mi);Y(Ii,dn.data,xi,Mi,Ua,Yn,ti),ii(Gr,Ii,Xn),Qn?Gr.persistentData=Ii:Kr.freeType(Ii)}else dn instanceof ArrayBuffer?(Gr.dtype=sc,Gr.dimension=Rn,ii(Gr,dn,Xn),Qn&&(Gr.persistentData=new Uint8Array(new Uint8Array(dn)))):tt.raise("invalid buffer data")}function yi(Gr){Ze.bufferCount--,cn(Gr);var dn=Gr.buffer;tt(dn,"buffer must not be deleted already"),kt.deleteBuffer(dn),Gr.buffer=null,delete on[Gr.id]}function qn(Gr,dn,Xn,vi){Ze.bufferCount++;var Rn=new En(dn);on[Rn.id]=Rn;function Qn(_n){var An=Zc,oi=null,Ei=0,ti=0,xi=1;return Array.isArray(_n)||wt(_n)||Wu(_n)||_n instanceof ArrayBuffer?oi=_n:typeof _n=="number"?Ei=_n|0:_n&&(tt.type(_n,"object","buffer arguments must be an object, a number or an array"),"data"in _n&&(tt(oi===null||Array.isArray(oi)||wt(oi)||Wu(oi),"invalid data for buffer"),oi=_n.data),"usage"in _n&&(tt.parameter(_n.usage,rs,"invalid buffer usage"),An=rs[_n.usage]),"type"in _n&&(tt.parameter(_n.type,dl,"invalid buffer type"),ti=dl[_n.type]),"dimension"in _n&&(tt.type(_n.dimension,"number","invalid dimension"),xi=_n.dimension|0),"length"in _n&&(tt.nni(Ei,"buffer length must be a nonnegative integer"),Ei=_n.length|0)),Rn.bind(),oi?ui(Rn,oi,An,ti,xi,vi):(Ei&&kt.bufferData(Rn.type,Ei,An),Rn.dtype=ti||sc,Rn.usage=An,Rn.dimension=xi,Rn.byteLength=Ei),dr.profile&&(Rn.stats.size=Rn.byteLength*nl[Rn.dtype]),Qn}function Ti(_n,An){tt(An+_n.byteLength<=Rn.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+_n.byteLength+" starting from offset "+An+" to a buffer of size "+Rn.byteLength),kt.bufferSubData(Rn.type,An,_n)}function aa(_n,An){var oi=(An||0)|0,Ei;if(Rn.bind(),wt(_n)||_n instanceof ArrayBuffer)Ti(_n,oi);else if(Array.isArray(_n)){if(_n.length>0)if(typeof _n[0]=="number"){var ti=Kr.allocType(Rn.dtype,_n.length);D(ti,_n),Ti(ti,oi),Kr.freeType(ti)}else if(Array.isArray(_n[0])||wt(_n[0])){Ei=_u(_n);var xi=Uc(_n,Ei,Rn.dtype);Ti(xi,oi),Kr.freeType(xi)}else tt.raise("invalid buffer data")}else if(Wu(_n)){Ei=_n.shape;var Mi=_n.stride,Ua=0,Yn=0,Ii=0,Li=0;Ei.length===1?(Ua=Ei[0],Yn=1,Ii=Mi[0],Li=0):Ei.length===2?(Ua=Ei[0],Yn=Ei[1],Ii=Mi[0],Li=Mi[1]):tt.raise("invalid shape");var wa=Array.isArray(_n.data)?Rn.dtype:uc(_n.data),Da=Kr.allocType(wa,Ua*Yn);Y(Da,_n.data,Ua,Yn,Ii,Li,_n.offset),Ti(Da,oi),Kr.freeType(Da)}else tt.raise("invalid data for buffer subdata");return Qn}return Xn||Qn(Gr),Qn._reglType="buffer",Qn._buffer=Rn,Qn.subdata=aa,dr.profile&&(Qn.stats=Rn.stats),Qn.destroy=function(){yi(Rn)},Qn}function ri(){ke(on).forEach(function(Gr){Gr.buffer=kt.createBuffer(),kt.bindBuffer(Gr.type,Gr.buffer),kt.bufferData(Gr.type,Gr.persistentData||Gr.byteLength,Gr.usage)})}return dr.profile&&(Ze.getTotalBufferSize=function(){var Gr=0;return Object.keys(on).forEach(function(dn){Gr+=on[dn].stats.size}),Gr}),{create:qn,createStream:Hn,destroyStream:Jn,clear:function(){ke(on).forEach(yi),Dn.forEach(yi)},getBuffer:function(Gr){return Gr&&Gr._buffer instanceof En?Gr._buffer:null},restore:ri,_initBuffer:ui}}var nt=0,se=0,Ve=1,wr=1,jr=4,Vr=4,Ln={points:nt,point:se,lines:Ve,line:wr,triangles:jr,triangle:Vr,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Gn=0,$i=1,Pa=4,ba=5120,uo=5121,Ca=5122,Ao=5123,qa=5124,gs=5125,xu=34963,il=35040,bu=35044;function iu(kt,Ze,dr,cn){var On={},on=0,En={uint8:uo,uint16:Ao};Ze.oes_element_index_uint&&(En.uint32=gs);function Dn(ri){this.id=on++,On[this.id]=this,this.buffer=ri,this.primType=Pa,this.vertCount=0,this.type=0}Dn.prototype.bind=function(){this.buffer.bind()};var Hn=[];function Jn(ri){var Gr=Hn.pop();return Gr||(Gr=new Dn(dr.create(null,xu,!0,!1)._buffer)),ui(Gr,ri,il,-1,-1,0,0),Gr}function ii(ri){Hn.push(ri)}function ui(ri,Gr,dn,Xn,vi,Rn,Qn){ri.buffer.bind();var Ti;if(Gr){var aa=Qn;!Qn&&(!wt(Gr)||Wu(Gr)&&!wt(Gr.data))&&(aa=Ze.oes_element_index_uint?gs:Ao),dr._initBuffer(ri.buffer,Gr,dn,aa,3)}else kt.bufferData(xu,Rn,dn),ri.buffer.dtype=Ti||uo,ri.buffer.usage=dn,ri.buffer.dimension=3,ri.buffer.byteLength=Rn;if(Ti=Qn,!Qn){switch(ri.buffer.dtype){case uo:case ba:Ti=uo;break;case Ao:case Ca:Ti=Ao;break;case gs:case qa:Ti=gs;break;default:tt.raise("unsupported type for element array")}ri.buffer.dtype=Ti}ri.type=Ti,tt(Ti!==gs||!!Ze.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var _n=vi;_n<0&&(_n=ri.buffer.byteLength,Ti===Ao?_n>>=1:Ti===gs&&(_n>>=2)),ri.vertCount=_n;var An=Xn;if(Xn<0){An=Pa;var oi=ri.buffer.dimension;oi===1&&(An=Gn),oi===2&&(An=$i),oi===3&&(An=Pa)}ri.primType=An}function yi(ri){cn.elementsCount--,tt(ri.buffer!==null,"must not double destroy elements"),delete On[ri.id],ri.buffer.destroy(),ri.buffer=null}function qn(ri,Gr){var dn=dr.create(null,xu,!0),Xn=new Dn(dn._buffer);cn.elementsCount++;function vi(Rn){if(!Rn)dn(),Xn.primType=Pa,Xn.vertCount=0,Xn.type=uo;else if(typeof Rn=="number")dn(Rn),Xn.primType=Pa,Xn.vertCount=Rn|0,Xn.type=uo;else{var Qn=null,Ti=bu,aa=-1,_n=-1,An=0,oi=0;Array.isArray(Rn)||wt(Rn)||Wu(Rn)?Qn=Rn:(tt.type(Rn,"object","invalid arguments for elements"),"data"in Rn&&(Qn=Rn.data,tt(Array.isArray(Qn)||wt(Qn)||Wu(Qn),"invalid data for element buffer")),"usage"in Rn&&(tt.parameter(Rn.usage,rs,"invalid element buffer usage"),Ti=rs[Rn.usage]),"primitive"in Rn&&(tt.parameter(Rn.primitive,Ln,"invalid element buffer primitive"),aa=Ln[Rn.primitive]),"count"in Rn&&(tt(typeof Rn.count=="number"&&Rn.count>=0,"invalid vertex count for elements"),_n=Rn.count|0),"type"in Rn&&(tt.parameter(Rn.type,En,"invalid buffer type"),oi=En[Rn.type]),"length"in Rn?An=Rn.length|0:(An=_n,oi===Ao||oi===Ca?An*=2:(oi===gs||oi===qa)&&(An*=4))),ui(Xn,Qn,Ti,aa,_n,An,oi)}return vi}return vi(ri),vi._reglType="elements",vi._elements=Xn,vi.subdata=function(Rn,Qn){return dn.subdata(Rn,Qn),vi},vi.destroy=function(){yi(Xn)},vi}return{create:qn,createStream:Jn,destroyStream:ii,getElements:function(ri){return typeof ri=="function"&&ri._elements instanceof Dn?ri._elements:null},clear:function(){ke(On).forEach(yi)}}}var Vc=new Float32Array(1),$s=new Uint32Array(Vc.buffer),Yl=5123;function ye(kt){for(var Ze=Kr.allocType(Yl,kt.length),dr=0;dr<kt.length;++dr)if(isNaN(kt[dr]))Ze[dr]=65535;else if(kt[dr]===1/0)Ze[dr]=31744;else if(kt[dr]===-1/0)Ze[dr]=64512;else{Vc[0]=kt[dr];var cn=$s[0],On=cn>>>31<<15,on=(cn<<1>>>24)-127,En=cn>>13&(1<<10)-1;if(on<-24)Ze[dr]=On;else if(on<-14){var Dn=-14-on;Ze[dr]=On+(En+(1<<10)>>Dn)}else on>15?Ze[dr]=On+31744:Ze[dr]=On+(on+15<<10)+En}return Ze}function ir(kt){return Array.isArray(kt)||wt(kt)}var Or=function(kt){return!(kt&kt-1)&&!!kt},$r=34467,xn=3553,_i=34067,qi=34069,Ia=6408,du=6406,qs=6407,$a=6409,Dl=6410,av=32854,yf=32855,vd=36194,ov=32819,sv=32820,dh=33635,zf=34042,Gc=6402,vh=34041,Uf=35904,lc=35906,al=36193,_f=33776,vl=33777,Eu=33778,Yh=33779,Pp=35986,Sc=35987,gl=34798,$h=35840,qh=35841,Op=35842,Hc=35843,Kh=36196,$l=5121,Qh=5123,Zf=5125,Tl=5126,gd=10242,md=10243,yd=10497,gh=33071,_d=33648,xf=10240,xs=10241,Jh=9728,Vf=9729,Bl=9984,go=9985,is=9986,Yu=9987,Fp=33170,bf=4352,tp=4353,xd=4354,ep=34046,Rp=3317,rp=37440,Ef=37441,au=37443,wf=37444,np=33984,As=[Bl,is,go,Yu],Zi=[0,$a,Dl,qs,Ia],as={};as[$a]=as[du]=as[Gc]=1,as[vh]=as[Dl]=2,as[qs]=as[Uf]=3,as[Ia]=as[lc]=4;function Sf(kt){return"[object "+kt+"]"}var Gf=Sf("HTMLCanvasElement"),cc=Sf("OffscreenCanvas"),ml=Sf("CanvasRenderingContext2D"),Dp=Sf("ImageBitmap"),Ai=Sf("HTMLImageElement"),Hf=Sf("HTMLVideoElement"),Cc=Object.keys(Ho).concat([Gf,cc,ml,Dp,Ai,Hf]),Cf=[];Cf[$l]=1,Cf[Tl]=4,Cf[al]=2,Cf[Qh]=2,Cf[Zf]=4;var ma=[];ma[av]=2,ma[yf]=2,ma[vd]=2,ma[vh]=4,ma[_f]=.5,ma[vl]=.5,ma[Eu]=1,ma[Yh]=1,ma[Pp]=.5,ma[Sc]=1,ma[gl]=1,ma[$h]=.5,ma[qh]=.25,ma[Op]=.5,ma[Hc]=.25,ma[Kh]=.5;function yl(kt){return Array.isArray(kt)&&(kt.length===0||typeof kt[0]=="number")}function jf(kt){if(!Array.isArray(kt))return!1;var Ze=kt.length;return!(Ze===0||!ir(kt[0]))}function fc(kt){return Object.prototype.toString.call(kt)}function _l(kt){return fc(kt)===Gf}function sa(kt){return fc(kt)===cc}function Bp(kt){return fc(kt)===ml}function Np(kt){return fc(kt)===Dp}function bd(kt){return fc(kt)===Ai}function Ed(kt){return fc(kt)===Hf}function Ml(kt){var Ze=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Ze&&kt&&kt.getContext)}function Ko(kt){var Ze=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return!!(Ze&&kt&&"src"in kt&&"crossOrigin"in kt)}function Ka(kt){if(!kt)return!1;if(Ml(kt)||Ko(kt))return!0;var Ze=fc(kt);return Cc.indexOf(Ze)>=0?!0:yl(kt)||jf(kt)||Wu(kt)}function xl(kt){return Ho[Object.prototype.toString.call(kt)]|0}function ql(kt,Ze){var dr=Ze.length;switch(kt.type){case $l:case Qh:case Zf:case Tl:var cn=Kr.allocType(kt.type,dr);cn.set(Ze),kt.data=cn;break;case al:kt.data=ye(Ze);break;default:tt.raise("unsupported texture type, must specify a typed array")}}function Ts(kt,Ze){return Kr.allocType(kt.type===al?Tl:kt.type,Ze)}function jc(kt,Ze){kt.type===al?(kt.data=ye(Ze),Kr.freeType(Ze)):kt.data=Ze}function Nl(kt,Ze,dr,cn,On,on){for(var En=kt.width,Dn=kt.height,Hn=kt.channels,Jn=En*Dn*Hn,ii=Ts(kt,Jn),ui=0,yi=0;yi<Dn;++yi)for(var qn=0;qn<En;++qn)for(var ri=0;ri<Hn;++ri)ii[ui++]=Ze[dr*qn+cn*yi+On*ri+on];jc(kt,ii)}function wu(kt,Ze,dr,cn,On,on){var En;if(typeof ma[kt]!="undefined"?En=ma[kt]:En=as[kt]*Cf[Ze],on&&(En*=6),On){for(var Dn=0,Hn=dr;Hn>=1;)Dn+=En*Hn*Hn,Hn/=2;return Dn}else return En*dr*cn}function Su(kt,Ze,dr,cn,On,on,En){var Dn={"don't care":bf,"dont care":bf,nice:xd,fast:tp},Hn={repeat:yd,clamp:gh,mirror:_d},Jn={nearest:Jh,linear:Vf},ii=I({mipmap:Yu,"nearest mipmap nearest":Bl,"linear mipmap nearest":go,"nearest mipmap linear":is,"linear mipmap linear":Yu},Jn),ui={none:0,browser:wf},yi={uint8:$l,rgba4:ov,rgb565:dh,"rgb5 a1":sv},qn={alpha:du,luminance:$a,"luminance alpha":Dl,rgb:qs,rgba:Ia,rgba4:av,"rgb5 a1":yf,rgb565:vd},ri={};Ze.ext_srgb&&(qn.srgb=Uf,qn.srgba=lc),Ze.oes_texture_float&&(yi.float32=yi.float=Tl),Ze.oes_texture_half_float&&(yi.float16=yi["half float"]=al),Ze.webgl_depth_texture&&(I(qn,{depth:Gc,"depth stencil":vh}),I(yi,{uint16:Qh,uint32:Zf,"depth stencil":zf})),Ze.webgl_compressed_texture_s3tc&&I(ri,{"rgb s3tc dxt1":_f,"rgba s3tc dxt1":vl,"rgba s3tc dxt3":Eu,"rgba s3tc dxt5":Yh}),Ze.webgl_compressed_texture_atc&&I(ri,{"rgb atc":Pp,"rgba atc explicit alpha":Sc,"rgba atc interpolated alpha":gl}),Ze.webgl_compressed_texture_pvrtc&&I(ri,{"rgb pvrtc 4bppv1":$h,"rgb pvrtc 2bppv1":qh,"rgba pvrtc 4bppv1":Op,"rgba pvrtc 2bppv1":Hc}),Ze.webgl_compressed_texture_etc1&&(ri["rgb etc1"]=Kh);var Gr=Array.prototype.slice.call(kt.getParameter($r)||new Uint32Array(0));Object.keys(ri).forEach(function(Je){var an=ri[Je];Gr.indexOf(an)>=0&&(qn[Je]=an)});var dn=Object.keys(qn);dr.textureFormats=dn;var Xn=[];Object.keys(qn).forEach(function(Je){var an=qn[Je];Xn[an]=Je});var vi=[];Object.keys(yi).forEach(function(Je){var an=yi[Je];vi[an]=Je});var Rn=[];Object.keys(Jn).forEach(function(Je){var an=Jn[Je];Rn[an]=Je});var Qn=[];Object.keys(ii).forEach(function(Je){var an=ii[Je];Qn[an]=Je});var Ti=[];Object.keys(Hn).forEach(function(Je){var an=Hn[Je];Ti[an]=Je});var aa=dn.reduce(function(Je,an){var en=qn[an];return en===$a||en===du||en===$a||en===Dl||en===Gc||en===vh||Ze.ext_srgb&&(en===Uf||en===lc)?Je[en]=en:en===yf||an.indexOf("rgba")>=0?Je[en]=Ia:Je[en]=qs,Je},{});function _n(){this.internalformat=Ia,this.format=Ia,this.type=$l,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=wf,this.width=0,this.height=0,this.channels=0}function An(Je,an){Je.internalformat=an.internalformat,Je.format=an.format,Je.type=an.type,Je.compressed=an.compressed,Je.premultiplyAlpha=an.premultiplyAlpha,Je.flipY=an.flipY,Je.unpackAlignment=an.unpackAlignment,Je.colorSpace=an.colorSpace,Je.width=an.width,Je.height=an.height,Je.channels=an.channels}function oi(Je,an){if(!(typeof an!="object"||!an)){if("premultiplyAlpha"in an&&(tt.type(an.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Je.premultiplyAlpha=an.premultiplyAlpha),"flipY"in an&&(tt.type(an.flipY,"boolean","invalid texture flip"),Je.flipY=an.flipY),"alignment"in an&&(tt.oneOf(an.alignment,[1,2,4,8],"invalid texture unpack alignment"),Je.unpackAlignment=an.alignment),"colorSpace"in an&&(tt.parameter(an.colorSpace,ui,"invalid colorSpace"),Je.colorSpace=ui[an.colorSpace]),"type"in an){var en=an.type;tt(Ze.oes_texture_float||!(en==="float"||en==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),tt(Ze.oes_texture_half_float||!(en==="half float"||en==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),tt(Ze.webgl_depth_texture||!(en==="uint16"||en==="uint32"||en==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),tt.parameter(en,yi,"invalid texture type"),Je.type=yi[en]}var Ri=Je.width,so=Je.height,qe=Je.channels,Re=!1;"shape"in an?(tt(Array.isArray(an.shape)&&an.shape.length>=2,"shape must be an array"),Ri=an.shape[0],so=an.shape[1],an.shape.length===3&&(qe=an.shape[2],tt(qe>0&&qe<=4,"invalid number of channels"),Re=!0),tt(Ri>=0&&Ri<=dr.maxTextureSize,"invalid width"),tt(so>=0&&so<=dr.maxTextureSize,"invalid height")):("radius"in an&&(Ri=so=an.radius,tt(Ri>=0&&Ri<=dr.maxTextureSize,"invalid radius")),"width"in an&&(Ri=an.width,tt(Ri>=0&&Ri<=dr.maxTextureSize,"invalid width")),"height"in an&&(so=an.height,tt(so>=0&&so<=dr.maxTextureSize,"invalid height")),"channels"in an&&(qe=an.channels,tt(qe>0&&qe<=4,"invalid number of channels"),Re=!0)),Je.width=Ri|0,Je.height=so|0,Je.channels=qe|0;var yr=!1;if("format"in an){var Xr=an.format;tt(Ze.webgl_depth_texture||!(Xr==="depth"||Xr==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),tt.parameter(Xr,qn,"invalid texture format");var sn=Je.internalformat=qn[Xr];Je.format=aa[sn],Xr in yi&&("type"in an||(Je.type=yi[Xr])),Xr in ri&&(Je.compressed=!0),yr=!0}!Re&&yr?Je.channels=as[Je.format]:Re&&!yr?Je.channels!==Zi[Je.format]&&(Je.format=Je.internalformat=Zi[Je.channels]):yr&&Re&&tt(Je.channels===as[Je.format],"number of channels inconsistent with specified format")}}function Ei(Je){kt.pixelStorei(rp,Je.flipY),kt.pixelStorei(Ef,Je.premultiplyAlpha),kt.pixelStorei(au,Je.colorSpace),kt.pixelStorei(Rp,Je.unpackAlignment)}function ti(){_n.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function xi(Je,an){var en=null;if(Ka(an)?en=an:an&&(tt.type(an,"object","invalid pixel data type"),oi(Je,an),"x"in an&&(Je.xOffset=an.x|0),"y"in an&&(Je.yOffset=an.y|0),Ka(an.data)&&(en=an.data)),tt(!Je.compressed||en instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),an.copy){tt(!en,"can not specify copy and data field for the same texture");var Ri=On.viewportWidth,so=On.viewportHeight;Je.width=Je.width||Ri-Je.xOffset,Je.height=Je.height||so-Je.yOffset,Je.needsCopy=!0,tt(Je.xOffset>=0&&Je.xOffset<Ri&&Je.yOffset>=0&&Je.yOffset<so&&Je.width>0&&Je.width<=Ri&&Je.height>0&&Je.height<=so,"copy texture read out of bounds")}else if(!en)Je.width=Je.width||1,Je.height=Je.height||1,Je.channels=Je.channels||4;else if(wt(en))Je.channels=Je.channels||4,Je.data=en,!("type"in an)&&Je.type===$l&&(Je.type=xl(en));else if(yl(en))Je.channels=Je.channels||4,ql(Je,en),Je.alignment=1,Je.needsFree=!0;else if(Wu(en)){var qe=en.data;!Array.isArray(qe)&&Je.type===$l&&(Je.type=xl(qe));var Re=en.shape,yr=en.stride,Xr,sn,mr,pr,kr,Ge;Re.length===3?(mr=Re[2],Ge=yr[2]):(tt(Re.length===2,"invalid ndarray pixel data, must be 2 or 3D"),mr=1,Ge=1),Xr=Re[0],sn=Re[1],pr=yr[0],kr=yr[1],Je.alignment=1,Je.width=Xr,Je.height=sn,Je.channels=mr,Je.format=Je.internalformat=Zi[mr],Je.needsFree=!0,Nl(Je,qe,pr,kr,Ge,en.offset)}else if(Ml(en)||_l(en)||sa(en)||Bp(en))Ml(en)||_l(en)||sa(en)?Je.element=en:Je.element=en.canvas,Je.width=Je.element.width,Je.height=Je.element.height,Je.channels=4;else if(Np(en))Je.element=en,Je.width=en.width,Je.height=en.height,Je.channels=4;else if(bd(en))Je.element=en,Je.width=en.naturalWidth,Je.height=en.naturalHeight,Je.channels=4;else if(Ko(en))Je.element=en,Je.width=en.width,Je.height=en.height,Je.channels=4;else if(Ed(en))Je.element=en,Je.width=en.videoWidth,Je.height=en.videoHeight,Je.channels=4;else if(jf(en)){var vr=Je.width||en[0].length,tr=Je.height||en.length,Hr=Je.channels;ir(en[0][0])?Hr=Hr||en[0][0].length:Hr=Hr||1;for(var Jr=Xe.shape(en),Bn=1,gi=0;gi<Jr.length;++gi)Bn*=Jr[gi];var mi=Ts(Je,Bn);Xe.flatten(en,Jr,"",mi),jc(Je,mi),Je.alignment=1,Je.width=vr,Je.height=tr,Je.channels=Hr,Je.format=Je.internalformat=Zi[Hr],Je.needsFree=!0}Je.type===Tl?tt(dr.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Je.type===al&&tt(dr.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Mi(Je,an,en){var Ri=Je.element,so=Je.data,qe=Je.internalformat,Re=Je.format,yr=Je.type,Xr=Je.width,sn=Je.height;Ei(Je),Ri?kt.texImage2D(an,en,Re,Re,yr,Ri):Je.compressed?kt.compressedTexImage2D(an,en,qe,Xr,sn,0,so):Je.needsCopy?(cn(),kt.copyTexImage2D(an,en,Re,Je.xOffset,Je.yOffset,Xr,sn,0)):kt.texImage2D(an,en,Re,Xr,sn,0,Re,yr,so||null)}function Ua(Je,an,en,Ri,so){var qe=Je.element,Re=Je.data,yr=Je.internalformat,Xr=Je.format,sn=Je.type,mr=Je.width,pr=Je.height;Ei(Je),qe?kt.texSubImage2D(an,so,en,Ri,Xr,sn,qe):Je.compressed?kt.compressedTexSubImage2D(an,so,en,Ri,yr,mr,pr,Re):Je.needsCopy?(cn(),kt.copyTexSubImage2D(an,so,en,Ri,Je.xOffset,Je.yOffset,mr,pr)):kt.texSubImage2D(an,so,en,Ri,mr,pr,Xr,sn,Re)}var Yn=[];function Ii(){return Yn.pop()||new ti}function Li(Je){Je.needsFree&&Kr.freeType(Je.data),ti.call(Je),Yn.push(Je)}function wa(){_n.call(this),this.genMipmaps=!1,this.mipmapHint=bf,this.mipmask=0,this.images=Array(16)}function Da(Je,an,en){var Ri=Je.images[0]=Ii();Je.mipmask=1,Ri.width=Je.width=an,Ri.height=Je.height=en,Ri.channels=Je.channels=4}function oo(Je,an){var en=null;if(Ka(an))en=Je.images[0]=Ii(),An(en,Je),xi(en,an),Je.mipmask=1;else if(oi(Je,an),Array.isArray(an.mipmap))for(var Ri=an.mipmap,so=0;so<Ri.length;++so)en=Je.images[so]=Ii(),An(en,Je),en.width>>=so,en.height>>=so,xi(en,Ri[so]),Je.mipmask|=1<<so;else en=Je.images[0]=Ii(),An(en,Je),xi(en,an),Je.mipmask=1;An(Je,Je.images[0]),Je.compressed&&(Je.internalformat===_f||Je.internalformat===vl||Je.internalformat===Eu||Je.internalformat===Yh)&&tt(Je.width%4===0&&Je.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Is(Je,an){for(var en=Je.images,Ri=0;Ri<en.length;++Ri){if(!en[Ri])return;Mi(en[Ri],an,Ri)}}var zs=[];function io(){var Je=zs.pop()||new wa;_n.call(Je),Je.mipmask=0;for(var an=0;an<16;++an)Je.images[an]=null;return Je}function Au(Je){for(var an=Je.images,en=0;en<an.length;++en)an[en]&&Li(an[en]),an[en]=null;zs.push(Je)}function Xo(){this.minFilter=Jh,this.magFilter=Jh,this.wrapS=gh,this.wrapT=gh,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=bf}function Qs(Je,an){if("min"in an){var en=an.min;tt.parameter(en,ii),Je.minFilter=ii[en],As.indexOf(Je.minFilter)>=0&&!("faces"in an)&&(Je.genMipmaps=!0)}if("mag"in an){var Ri=an.mag;tt.parameter(Ri,Jn),Je.magFilter=Jn[Ri]}var so=Je.wrapS,qe=Je.wrapT;if("wrap"in an){var Re=an.wrap;typeof Re=="string"?(tt.parameter(Re,Hn),so=qe=Hn[Re]):Array.isArray(Re)&&(tt.parameter(Re[0],Hn),tt.parameter(Re[1],Hn),so=Hn[Re[0]],qe=Hn[Re[1]])}else{if("wrapS"in an){var yr=an.wrapS;tt.parameter(yr,Hn),so=Hn[yr]}if("wrapT"in an){var Xr=an.wrapT;tt.parameter(Xr,Hn),qe=Hn[Xr]}}if(Je.wrapS=so,Je.wrapT=qe,"anisotropic"in an){var sn=an.anisotropic;tt(typeof sn=="number"&&sn>=1&&sn<=dr.maxAnisotropic,"aniso samples must be between 1 and "),Je.anisotropic=an.anisotropic}if("mipmap"in an){var mr=!1;switch(typeof an.mipmap){case"string":tt.parameter(an.mipmap,Dn,"invalid mipmap hint"),Je.mipmapHint=Dn[an.mipmap],Je.genMipmaps=!0,mr=!0;break;case"boolean":mr=Je.genMipmaps=an.mipmap;break;case"object":tt(Array.isArray(an.mipmap),"invalid mipmap type"),Je.genMipmaps=!1,mr=!0;break;default:tt.raise("invalid mipmap type")}mr&&!("min"in an)&&(Je.minFilter=Bl)}}function su(Je,an){kt.texParameteri(an,xs,Je.minFilter),kt.texParameteri(an,xf,Je.magFilter),kt.texParameteri(an,gd,Je.wrapS),kt.texParameteri(an,md,Je.wrapT),Ze.ext_texture_filter_anisotropic&&kt.texParameteri(an,ep,Je.anisotropic),Je.genMipmaps&&(kt.hint(Fp,Je.mipmapHint),kt.generateMipmap(an))}var Tu=0,Js={},zu=dr.maxTextureUnits,Jo=Array(zu).map(function(){return null});function La(Je){_n.call(this),this.mipmask=0,this.internalformat=Ia,this.id=Tu++,this.refCount=1,this.target=Je,this.texture=kt.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Xo,En.profile&&(this.stats={size:0})}function tu(Je){kt.activeTexture(np),kt.bindTexture(Je.target,Je.texture)}function fo(){var Je=Jo[0];Je?kt.bindTexture(Je.target,Je.texture):kt.bindTexture(xn,null)}function Mu(Je){var an=Je.texture;tt(an,"must not double destroy texture");var en=Je.unit,Ri=Je.target;en>=0&&(kt.activeTexture(np+en),kt.bindTexture(Ri,null),Jo[en]=null),kt.deleteTexture(an),Je.texture=null,Je.params=null,Je.pixels=null,Je.refCount=0,delete Js[Je.id],on.textureCount--}I(La.prototype,{bind:function(){var Je=this;Je.bindCount+=1;var an=Je.unit;if(an<0){for(var en=0;en<zu;++en){var Ri=Jo[en];if(Ri){if(Ri.bindCount>0)continue;Ri.unit=-1}Jo[en]=Je,an=en;break}an>=zu&&tt.raise("insufficient number of texture units"),En.profile&&on.maxTextureUnits<an+1&&(on.maxTextureUnits=an+1),Je.unit=an,kt.activeTexture(np+an),kt.bindTexture(Je.target,Je.texture)}return an},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Mu(this)}});function ya(Je,an){var en=new La(xn);Js[en.id]=en,on.textureCount++;function Ri(Re,yr){var Xr=en.texInfo;Xo.call(Xr);var sn=io();return typeof Re=="number"?typeof yr=="number"?Da(sn,Re|0,yr|0):Da(sn,Re|0,Re|0):Re?(tt.type(Re,"object","invalid arguments to regl.texture"),Qs(Xr,Re),oo(sn,Re)):Da(sn,1,1),Xr.genMipmaps&&(sn.mipmask=(sn.width<<1)-1),en.mipmask=sn.mipmask,An(en,sn),tt.texture2D(Xr,sn,dr),en.internalformat=sn.internalformat,Ri.width=sn.width,Ri.height=sn.height,tu(en),Is(sn,xn),su(Xr,xn),fo(),Au(sn),En.profile&&(en.stats.size=wu(en.internalformat,en.type,sn.width,sn.height,Xr.genMipmaps,!1)),Ri.format=Xn[en.internalformat],Ri.type=vi[en.type],Ri.mag=Rn[Xr.magFilter],Ri.min=Qn[Xr.minFilter],Ri.wrapS=Ti[Xr.wrapS],Ri.wrapT=Ti[Xr.wrapT],Ri}function so(Re,yr,Xr,sn){tt(!!Re,"must specify image data");var mr=yr|0,pr=Xr|0,kr=sn|0,Ge=Ii();return An(Ge,en),Ge.width=0,Ge.height=0,xi(Ge,Re),Ge.width=Ge.width||(en.width>>kr)-mr,Ge.height=Ge.height||(en.height>>kr)-pr,tt(en.type===Ge.type&&en.format===Ge.format&&en.internalformat===Ge.internalformat,"incompatible format for texture.subimage"),tt(mr>=0&&pr>=0&&mr+Ge.width<=en.width&&pr+Ge.height<=en.height,"texture.subimage write out of bounds"),tt(en.mipmask&1<<kr,"missing mipmap data"),tt(Ge.data||Ge.element||Ge.needsCopy,"missing image data"),tu(en),Ua(Ge,xn,mr,pr,kr),fo(),Li(Ge),Ri}function qe(Re,yr){var Xr=Re|0,sn=yr|0||Xr;if(Xr===en.width&&sn===en.height)return Ri;Ri.width=en.width=Xr,Ri.height=en.height=sn,tu(en);for(var mr=0;en.mipmask>>mr;++mr){var pr=Xr>>mr,kr=sn>>mr;if(!pr||!kr)break;kt.texImage2D(xn,mr,en.format,pr,kr,0,en.format,en.type,null)}return fo(),En.profile&&(en.stats.size=wu(en.internalformat,en.type,Xr,sn,!1,!1)),Ri}return Ri(Je,an),Ri.subimage=so,Ri.resize=qe,Ri._reglType="texture2d",Ri._texture=en,En.profile&&(Ri.stats=en.stats),Ri.destroy=function(){en.decRef()},Ri}function eo(Je,an,en,Ri,so,qe){var Re=new La(_i);Js[Re.id]=Re,on.cubeCount++;var yr=new Array(6);function Xr(pr,kr,Ge,vr,tr,Hr){var Jr,Bn=Re.texInfo;for(Xo.call(Bn),Jr=0;Jr<6;++Jr)yr[Jr]=io();if(typeof pr=="number"||!pr){var gi=pr|0||1;for(Jr=0;Jr<6;++Jr)Da(yr[Jr],gi,gi)}else if(typeof pr=="object")if(kr)oo(yr[0],pr),oo(yr[1],kr),oo(yr[2],Ge),oo(yr[3],vr),oo(yr[4],tr),oo(yr[5],Hr);else if(Qs(Bn,pr),oi(Re,pr),"faces"in pr){var mi=pr.faces;for(tt(Array.isArray(mi)&&mi.length===6,"cube faces must be a length 6 array"),Jr=0;Jr<6;++Jr)tt(typeof mi[Jr]=="object"&&!!mi[Jr],"invalid input for cube map face"),An(yr[Jr],Re),oo(yr[Jr],mi[Jr])}else for(Jr=0;Jr<6;++Jr)oo(yr[Jr],pr);else tt.raise("invalid arguments to cube map");for(An(Re,yr[0]),tt.optional(function(){dr.npotTextureCube||tt(Or(Re.width)&&Or(Re.height),"your browser does not support non power or two texture dimensions")}),Bn.genMipmaps?Re.mipmask=(yr[0].width<<1)-1:Re.mipmask=yr[0].mipmask,tt.textureCube(Re,Bn,yr,dr),Re.internalformat=yr[0].internalformat,Xr.width=yr[0].width,Xr.height=yr[0].height,tu(Re),Jr=0;Jr<6;++Jr)Is(yr[Jr],qi+Jr);for(su(Bn,_i),fo(),En.profile&&(Re.stats.size=wu(Re.internalformat,Re.type,Xr.width,Xr.height,Bn.genMipmaps,!0)),Xr.format=Xn[Re.internalformat],Xr.type=vi[Re.type],Xr.mag=Rn[Bn.magFilter],Xr.min=Qn[Bn.minFilter],Xr.wrapS=Ti[Bn.wrapS],Xr.wrapT=Ti[Bn.wrapT],Jr=0;Jr<6;++Jr)Au(yr[Jr]);return Xr}function sn(pr,kr,Ge,vr,tr){tt(!!kr,"must specify image data"),tt(typeof pr=="number"&&pr===(pr|0)&&pr>=0&&pr<6,"invalid face");var Hr=Ge|0,Jr=vr|0,Bn=tr|0,gi=Ii();return An(gi,Re),gi.width=0,gi.height=0,xi(gi,kr),gi.width=gi.width||(Re.width>>Bn)-Hr,gi.height=gi.height||(Re.height>>Bn)-Jr,tt(Re.type===gi.type&&Re.format===gi.format&&Re.internalformat===gi.internalformat,"incompatible format for texture.subimage"),tt(Hr>=0&&Jr>=0&&Hr+gi.width<=Re.width&&Jr+gi.height<=Re.height,"texture.subimage write out of bounds"),tt(Re.mipmask&1<<Bn,"missing mipmap data"),tt(gi.data||gi.element||gi.needsCopy,"missing image data"),tu(Re),Ua(gi,qi+pr,Hr,Jr,Bn),fo(),Li(gi),Xr}function mr(pr){var kr=pr|0;if(kr!==Re.width){Xr.width=Re.width=kr,Xr.height=Re.height=kr,tu(Re);for(var Ge=0;Ge<6;++Ge)for(var vr=0;Re.mipmask>>vr;++vr)kt.texImage2D(qi+Ge,vr,Re.format,kr>>vr,kr>>vr,0,Re.format,Re.type,null);return fo(),En.profile&&(Re.stats.size=wu(Re.internalformat,Re.type,Xr.width,Xr.height,!1,!0)),Xr}}return Xr(Je,an,en,Ri,so,qe),Xr.subimage=sn,Xr.resize=mr,Xr._reglType="textureCube",Xr._texture=Re,En.profile&&(Xr.stats=Re.stats),Xr.destroy=function(){Re.decRef()},Xr}function Eo(){for(var Je=0;Je<zu;++Je)kt.activeTexture(np+Je),kt.bindTexture(xn,null),Jo[Je]=null;ke(Js).forEach(Mu),on.cubeCount=0,on.textureCount=0}En.profile&&(on.getTotalTextureSize=function(){var Je=0;return Object.keys(Js).forEach(function(an){Je+=Js[an].stats.size}),Je});function wo(){for(var Je=0;Je<zu;++Je){var an=Jo[Je];an&&(an.bindCount=0,an.unit=-1,Jo[Je]=null)}ke(Js).forEach(function(en){en.texture=kt.createTexture(),kt.bindTexture(en.target,en.texture);for(var Ri=0;Ri<32;++Ri)if((en.mipmask&1<<Ri)!==0)if(en.target===xn)kt.texImage2D(xn,Ri,en.internalformat,en.width>>Ri,en.height>>Ri,0,en.internalformat,en.type,null);else for(var so=0;so<6;++so)kt.texImage2D(qi+so,Ri,en.internalformat,en.width>>Ri,en.height>>Ri,0,en.internalformat,en.type,null);su(en.texInfo,en.target)})}function Po(){for(var Je=0;Je<zu;++Je){var an=Jo[Je];an&&(an.bindCount=0,an.unit=-1,Jo[Je]=null),kt.activeTexture(np+Je),kt.bindTexture(xn,null),kt.bindTexture(_i,null)}}return{create2D:ya,createCube:eo,clear:Eo,getTexture:function(Je){return null},restore:wo,refresh:Po}}var Il=36161,Ki=32854,Wi=32855,Af=36194,ol=33189,sl=36168,Ru=34041,bs=35907,Ac=34836,Tc=34842,No=34843,os=[];os[Ki]=2,os[Wi]=2,os[Af]=2,os[ol]=2,os[sl]=1,os[Ru]=4,os[bs]=4,os[Ac]=16,os[Tc]=8,os[No]=6;function ip(kt,Ze,dr){return os[kt]*Ze*dr}var Wc=function(kt,Ze,dr,cn,On){var on={rgba4:Ki,rgb565:Af,"rgb5 a1":Wi,depth:ol,stencil:sl,"depth stencil":Ru};Ze.ext_srgb&&(on.srgba=bs),Ze.ext_color_buffer_half_float&&(on.rgba16f=Tc,on.rgb16f=No),Ze.webgl_color_buffer_float&&(on.rgba32f=Ac);var En=[];Object.keys(on).forEach(function(qn){var ri=on[qn];En[ri]=qn});var Dn=0,Hn={};function Jn(qn){this.id=Dn++,this.refCount=1,this.renderbuffer=qn,this.format=Ki,this.width=0,this.height=0,On.profile&&(this.stats={size:0})}Jn.prototype.decRef=function(){--this.refCount<=0&&ii(this)};function ii(qn){var ri=qn.renderbuffer;tt(ri,"must not double destroy renderbuffer"),kt.bindRenderbuffer(Il,null),kt.deleteRenderbuffer(ri),qn.renderbuffer=null,qn.refCount=0,delete Hn[qn.id],cn.renderbufferCount--}function ui(qn,ri){var Gr=new Jn(kt.createRenderbuffer());Hn[Gr.id]=Gr,cn.renderbufferCount++;function dn(vi,Rn){var Qn=0,Ti=0,aa=Ki;if(typeof vi=="object"&&vi){var _n=vi;if("shape"in _n){var An=_n.shape;tt(Array.isArray(An)&&An.length>=2,"invalid renderbuffer shape"),Qn=An[0]|0,Ti=An[1]|0}else"radius"in _n&&(Qn=Ti=_n.radius|0),"width"in _n&&(Qn=_n.width|0),"height"in _n&&(Ti=_n.height|0);"format"in _n&&(tt.parameter(_n.format,on,"invalid renderbuffer format"),aa=on[_n.format])}else typeof vi=="number"?(Qn=vi|0,typeof Rn=="number"?Ti=Rn|0:Ti=Qn):vi?tt.raise("invalid arguments to renderbuffer constructor"):Qn=Ti=1;if(tt(Qn>0&&Ti>0&&Qn<=dr.maxRenderbufferSize&&Ti<=dr.maxRenderbufferSize,"invalid renderbuffer size"),!(Qn===Gr.width&&Ti===Gr.height&&aa===Gr.format))return dn.width=Gr.width=Qn,dn.height=Gr.height=Ti,Gr.format=aa,kt.bindRenderbuffer(Il,Gr.renderbuffer),kt.renderbufferStorage(Il,aa,Qn,Ti),tt(kt.getError()===0,"invalid render buffer format"),On.profile&&(Gr.stats.size=ip(Gr.format,Gr.width,Gr.height)),dn.format=En[Gr.format],dn}function Xn(vi,Rn){var Qn=vi|0,Ti=Rn|0||Qn;return Qn===Gr.width&&Ti===Gr.height||(tt(Qn>0&&Ti>0&&Qn<=dr.maxRenderbufferSize&&Ti<=dr.maxRenderbufferSize,"invalid renderbuffer size"),dn.width=Gr.width=Qn,dn.height=Gr.height=Ti,kt.bindRenderbuffer(Il,Gr.renderbuffer),kt.renderbufferStorage(Il,Gr.format,Qn,Ti),tt(kt.getError()===0,"invalid render buffer format"),On.profile&&(Gr.stats.size=ip(Gr.format,Gr.width,Gr.height))),dn}return dn(qn,ri),dn.resize=Xn,dn._reglType="renderbuffer",dn._renderbuffer=Gr,On.profile&&(dn.stats=Gr.stats),dn.destroy=function(){Gr.decRef()},dn}On.profile&&(cn.getTotalRenderbufferSize=function(){var qn=0;return Object.keys(Hn).forEach(function(ri){qn+=Hn[ri].stats.size}),qn});function yi(){ke(Hn).forEach(function(qn){qn.renderbuffer=kt.createRenderbuffer(),kt.bindRenderbuffer(Il,qn.renderbuffer),kt.renderbufferStorage(Il,qn.format,qn.width,qn.height)}),kt.bindRenderbuffer(Il,null)}return{create:ui,clear:function(){ke(Hn).forEach(ii)},restore:yi}},hc=36160,ul=36161,Fs=3553,Ms=34069,$u=36064,Xc=36096,ll=36128,Wf=33306,Mc=36053,mh=36054,Xf=36055,wd=36057,Rs=36061,Ic=36193,ap=5121,bl=5126,zl=6407,op=6408,pc=6402,zp=[zl,op],Yc=[];Yc[op]=4,Yc[zl]=3;var x=[];x[ap]=1,x[bl]=4,x[Ic]=2;var C=32854,w=32855,M=36194,z=33189,H=36168,$=34041,ft=35907,Ut=34836,re=34842,De=34843,Be=[C,w,M,ft,re,De,Ut],Le={};Le[Mc]="complete",Le[mh]="incomplete attachment",Le[wd]="incomplete dimensions",Le[Xf]="incomplete, missing attachment",Le[Rs]="unsupported";function cr(kt,Ze,dr,cn,On,on){var En={cur:null,next:null,dirty:!1,setFBO:null},Dn=["rgba"],Hn=["rgba4","rgb565","rgb5 a1"];Ze.ext_srgb&&Hn.push("srgba"),Ze.ext_color_buffer_half_float&&Hn.push("rgba16f","rgb16f"),Ze.webgl_color_buffer_float&&Hn.push("rgba32f");var Jn=["uint8"];Ze.oes_texture_half_float&&Jn.push("half float","float16"),Ze.oes_texture_float&&Jn.push("float","float32");function ii(ti,xi,Mi){this.target=ti,this.texture=xi,this.renderbuffer=Mi;var Ua=0,Yn=0;xi?(Ua=xi.width,Yn=xi.height):Mi&&(Ua=Mi.width,Yn=Mi.height),this.width=Ua,this.height=Yn}function ui(ti){ti&&(ti.texture&&ti.texture._texture.decRef(),ti.renderbuffer&&ti.renderbuffer._renderbuffer.decRef())}function yi(ti,xi,Mi){if(!!ti)if(ti.texture){var Ua=ti.texture._texture,Yn=Math.max(1,Ua.width),Ii=Math.max(1,Ua.height);tt(Yn===xi&&Ii===Mi,"inconsistent width/height for supplied texture"),Ua.refCount+=1}else{var Li=ti.renderbuffer._renderbuffer;tt(Li.width===xi&&Li.height===Mi,"inconsistent width/height for renderbuffer"),Li.refCount+=1}}function qn(ti,xi){xi&&(xi.texture?kt.framebufferTexture2D(hc,ti,xi.target,xi.texture._texture.texture,0):kt.framebufferRenderbuffer(hc,ti,ul,xi.renderbuffer._renderbuffer.renderbuffer))}function ri(ti){var xi=Fs,Mi=null,Ua=null,Yn=ti;typeof ti=="object"&&(Yn=ti.data,"target"in ti&&(xi=ti.target|0)),tt.type(Yn,"function","invalid attachment data");var Ii=Yn._reglType;return Ii==="texture2d"?(Mi=Yn,tt(xi===Fs)):Ii==="textureCube"?(Mi=Yn,tt(xi>=Ms&&xi<Ms+6,"invalid cube map target")):Ii==="renderbuffer"?(Ua=Yn,xi=ul):tt.raise("invalid regl object for attachment"),new ii(xi,Mi,Ua)}function Gr(ti,xi,Mi,Ua,Yn){if(Mi){var Ii=cn.create2D({width:ti,height:xi,format:Ua,type:Yn});return Ii._texture.refCount=0,new ii(Fs,Ii,null)}else{var Li=On.create({width:ti,height:xi,format:Ua});return Li._renderbuffer.refCount=0,new ii(ul,null,Li)}}function dn(ti){return ti&&(ti.texture||ti.renderbuffer)}function Xn(ti,xi,Mi){ti&&(ti.texture?ti.texture.resize(xi,Mi):ti.renderbuffer&&ti.renderbuffer.resize(xi,Mi),ti.width=xi,ti.height=Mi)}var vi=0,Rn={};function Qn(){this.id=vi++,Rn[this.id]=this,this.framebuffer=kt.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ti(ti){ti.colorAttachments.forEach(ui),ui(ti.depthAttachment),ui(ti.stencilAttachment),ui(ti.depthStencilAttachment)}function aa(ti){var xi=ti.framebuffer;tt(xi,"must not double destroy framebuffer"),kt.deleteFramebuffer(xi),ti.framebuffer=null,on.framebufferCount--,delete Rn[ti.id]}function _n(ti){var xi;kt.bindFramebuffer(hc,ti.framebuffer);var Mi=ti.colorAttachments;for(xi=0;xi<Mi.length;++xi)qn($u+xi,Mi[xi]);for(xi=Mi.length;xi<dr.maxColorAttachments;++xi)kt.framebufferTexture2D(hc,$u+xi,Fs,null,0);kt.framebufferTexture2D(hc,Wf,Fs,null,0),kt.framebufferTexture2D(hc,Xc,Fs,null,0),kt.framebufferTexture2D(hc,ll,Fs,null,0),qn(Xc,ti.depthAttachment),qn(ll,ti.stencilAttachment),qn(Wf,ti.depthStencilAttachment);var Ua=kt.checkFramebufferStatus(hc);!kt.isContextLost()&&Ua!==Mc&&tt.raise("framebuffer configuration not supported, status = "+Le[Ua]),kt.bindFramebuffer(hc,En.next?En.next.framebuffer:null),En.cur=En.next,kt.getError()}function An(ti,xi){var Mi=new Qn;on.framebufferCount++;function Ua(Ii,Li){var wa;tt(En.next!==Mi,"can not update framebuffer which is currently in use");var Da=0,oo=0,Is=!0,zs=!0,io=null,Au=!0,Xo="rgba",Qs="uint8",su=1,Tu=null,Js=null,zu=null,Jo=!1;if(typeof Ii=="number")Da=Ii|0,oo=Li|0||Da;else if(!Ii)Da=oo=1;else{tt.type(Ii,"object","invalid arguments for framebuffer");var La=Ii;if("shape"in La){var tu=La.shape;tt(Array.isArray(tu)&&tu.length>=2,"invalid shape for framebuffer"),Da=tu[0],oo=tu[1]}else"radius"in La&&(Da=oo=La.radius),"width"in La&&(Da=La.width),"height"in La&&(oo=La.height);("color"in La||"colors"in La)&&(io=La.color||La.colors,Array.isArray(io)&&tt(io.length===1||Ze.webgl_draw_buffers,"multiple render targets not supported")),io||("colorCount"in La&&(su=La.colorCount|0,tt(su>0,"invalid color buffer count")),"colorTexture"in La&&(Au=!!La.colorTexture,Xo="rgba4"),"colorType"in La&&(Qs=La.colorType,Au?(tt(Ze.oes_texture_float||!(Qs==="float"||Qs==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),tt(Ze.oes_texture_half_float||!(Qs==="half float"||Qs==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):Qs==="half float"||Qs==="float16"?(tt(Ze.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Xo="rgba16f"):(Qs==="float"||Qs==="float32")&&(tt(Ze.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Xo="rgba32f"),tt.oneOf(Qs,Jn,"invalid color type")),"colorFormat"in La&&(Xo=La.colorFormat,Dn.indexOf(Xo)>=0?Au=!0:Hn.indexOf(Xo)>=0?Au=!1:tt.optional(function(){Au?tt.oneOf(La.colorFormat,Dn,"invalid color format for texture"):tt.oneOf(La.colorFormat,Hn,"invalid color format for renderbuffer")}))),("depthTexture"in La||"depthStencilTexture"in La)&&(Jo=!!(La.depthTexture||La.depthStencilTexture),tt(!Jo||Ze.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in La&&(typeof La.depth=="boolean"?Is=La.depth:(Tu=La.depth,zs=!1)),"stencil"in La&&(typeof La.stencil=="boolean"?zs=La.stencil:(Js=La.stencil,Is=!1)),"depthStencil"in La&&(typeof La.depthStencil=="boolean"?Is=zs=La.depthStencil:(zu=La.depthStencil,Is=!1,zs=!1))}var fo=null,Mu=null,ya=null,eo=null;if(Array.isArray(io))fo=io.map(ri);else if(io)fo=[ri(io)];else for(fo=new Array(su),wa=0;wa<su;++wa)fo[wa]=Gr(Da,oo,Au,Xo,Qs);tt(Ze.webgl_draw_buffers||fo.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),tt(fo.length<=dr.maxColorAttachments,"too many color attachments, not supported"),Da=Da||fo[0].width,oo=oo||fo[0].height,Tu?Mu=ri(Tu):Is&&!zs&&(Mu=Gr(Da,oo,Jo,"depth","uint32")),Js?ya=ri(Js):zs&&!Is&&(ya=Gr(Da,oo,!1,"stencil","uint8")),zu?eo=ri(zu):!Tu&&!Js&&zs&&Is&&(eo=Gr(Da,oo,Jo,"depth stencil","depth stencil")),tt(!!Tu+!!Js+!!zu<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Eo=null;for(wa=0;wa<fo.length;++wa)if(yi(fo[wa],Da,oo),tt(!fo[wa]||fo[wa].texture&&zp.indexOf(fo[wa].texture._texture.format)>=0||fo[wa].renderbuffer&&Be.indexOf(fo[wa].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+wa+" is invalid"),fo[wa]&&fo[wa].texture){var wo=Yc[fo[wa].texture._texture.format]*x[fo[wa].texture._texture.type];Eo===null?Eo=wo:tt(Eo===wo,"all color attachments much have the same number of bits per pixel.")}return yi(Mu,Da,oo),tt(!Mu||Mu.texture&&Mu.texture._texture.format===pc||Mu.renderbuffer&&Mu.renderbuffer._renderbuffer.format===z,"invalid depth attachment for framebuffer object"),yi(ya,Da,oo),tt(!ya||ya.renderbuffer&&ya.renderbuffer._renderbuffer.format===H,"invalid stencil attachment for framebuffer object"),yi(eo,Da,oo),tt(!eo||eo.texture&&eo.texture._texture.format===$||eo.renderbuffer&&eo.renderbuffer._renderbuffer.format===$,"invalid depth-stencil attachment for framebuffer object"),Ti(Mi),Mi.width=Da,Mi.height=oo,Mi.colorAttachments=fo,Mi.depthAttachment=Mu,Mi.stencilAttachment=ya,Mi.depthStencilAttachment=eo,Ua.color=fo.map(dn),Ua.depth=dn(Mu),Ua.stencil=dn(ya),Ua.depthStencil=dn(eo),Ua.width=Mi.width,Ua.height=Mi.height,_n(Mi),Ua}function Yn(Ii,Li){tt(En.next!==Mi,"can not resize a framebuffer which is currently in use");var wa=Math.max(Ii|0,1),Da=Math.max(Li|0||wa,1);if(wa===Mi.width&&Da===Mi.height)return Ua;for(var oo=Mi.colorAttachments,Is=0;Is<oo.length;++Is)Xn(oo[Is],wa,Da);return Xn(Mi.depthAttachment,wa,Da),Xn(Mi.stencilAttachment,wa,Da),Xn(Mi.depthStencilAttachment,wa,Da),Mi.width=Ua.width=wa,Mi.height=Ua.height=Da,_n(Mi),Ua}return Ua(ti,xi),I(Ua,{resize:Yn,_reglType:"framebuffer",_framebuffer:Mi,destroy:function(){aa(Mi),Ti(Mi)},use:function(Ii){En.setFBO({framebuffer:Ua},Ii)}})}function oi(ti){var xi=Array(6);function Mi(Yn){var Ii;tt(xi.indexOf(En.next)<0,"can not update framebuffer which is currently in use");var Li={color:null},wa=0,Da=null,oo="rgba",Is="uint8",zs=1;if(typeof Yn=="number")wa=Yn|0;else if(!Yn)wa=1;else{tt.type(Yn,"object","invalid arguments for framebuffer");var io=Yn;if("shape"in io){var Au=io.shape;tt(Array.isArray(Au)&&Au.length>=2,"invalid shape for framebuffer"),tt(Au[0]===Au[1],"cube framebuffer must be square"),wa=Au[0]}else"radius"in io&&(wa=io.radius|0),"width"in io?(wa=io.width|0,"height"in io&&tt(io.height===wa,"must be square")):"height"in io&&(wa=io.height|0);("color"in io||"colors"in io)&&(Da=io.color||io.colors,Array.isArray(Da)&&tt(Da.length===1||Ze.webgl_draw_buffers,"multiple render targets not supported")),Da||("colorCount"in io&&(zs=io.colorCount|0,tt(zs>0,"invalid color buffer count")),"colorType"in io&&(tt.oneOf(io.colorType,Jn,"invalid color type"),Is=io.colorType),"colorFormat"in io&&(oo=io.colorFormat,tt.oneOf(io.colorFormat,Dn,"invalid color format for texture"))),"depth"in io&&(Li.depth=io.depth),"stencil"in io&&(Li.stencil=io.stencil),"depthStencil"in io&&(Li.depthStencil=io.depthStencil)}var Xo;if(Da)if(Array.isArray(Da))for(Xo=[],Ii=0;Ii<Da.length;++Ii)Xo[Ii]=Da[Ii];else Xo=[Da];else{Xo=Array(zs);var Qs={radius:wa,format:oo,type:Is};for(Ii=0;Ii<zs;++Ii)Xo[Ii]=cn.createCube(Qs)}for(Li.color=Array(Xo.length),Ii=0;Ii<Xo.length;++Ii){var su=Xo[Ii];tt(typeof su=="function"&&su._reglType==="textureCube","invalid cube map"),wa=wa||su.width,tt(su.width===wa&&su.height===wa,"invalid cube map shape"),Li.color[Ii]={target:Ms,data:Xo[Ii]}}for(Ii=0;Ii<6;++Ii){for(var Tu=0;Tu<Xo.length;++Tu)Li.color[Tu].target=Ms+Ii;Ii>0&&(Li.depth=xi[0].depth,Li.stencil=xi[0].stencil,Li.depthStencil=xi[0].depthStencil),xi[Ii]?xi[Ii](Li):xi[Ii]=An(Li)}return I(Mi,{width:wa,height:wa,color:Xo})}function Ua(Yn){var Ii,Li=Yn|0;if(tt(Li>0&&Li<=dr.maxCubeMapSize,"invalid radius for cube fbo"),Li===Mi.width)return Mi;var wa=Mi.color;for(Ii=0;Ii<wa.length;++Ii)wa[Ii].resize(Li);for(Ii=0;Ii<6;++Ii)xi[Ii].resize(Li);return Mi.width=Mi.height=Li,Mi}return Mi(ti),I(Mi,{faces:xi,resize:Ua,_reglType:"framebufferCube",destroy:function(){xi.forEach(function(Yn){Yn.destroy()})}})}function Ei(){En.cur=null,En.next=null,En.dirty=!0,ke(Rn).forEach(function(ti){ti.framebuffer=kt.createFramebuffer(),_n(ti)})}return I(En,{getFramebuffer:function(ti){if(typeof ti=="function"&&ti._reglType==="framebuffer"){var xi=ti._framebuffer;if(xi instanceof Qn)return xi}return null},create:An,createCube:oi,clear:function(){ke(Rn).forEach(aa)},restore:Ei})}var ar=5126,br=34962,rr=34963,xr=["attributes","elements","offset","count","primitive","instances"];function Pr(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=ar,this.offset=0,this.stride=0,this.divisor=0}function Rr(kt,Ze,dr,cn,On,on,En){for(var Dn=dr.maxAttributes,Hn=new Array(Dn),Jn=0;Jn<Dn;++Jn)Hn[Jn]=new Pr;var ii=0,ui={},yi={Record:Pr,scope:{},state:Hn,currentVAO:null,targetVAO:null,restore:ri()?Ti:function(){},createVAO:aa,getVAO:dn,destroyBuffer:qn,setVAO:ri()?Xn:vi,clear:ri()?Rn:function(){}};function qn(_n){for(var An=0;An<Hn.length;++An){var oi=Hn[An];oi.buffer===_n&&(kt.disableVertexAttribArray(An),oi.buffer=null)}}function ri(){return Ze.oes_vertex_array_object}function Gr(){return Ze.angle_instanced_arrays}function dn(_n){return typeof _n=="function"&&_n._vao?_n._vao:null}function Xn(_n){if(_n!==yi.currentVAO){var An=ri();_n?An.bindVertexArrayOES(_n.vao):An.bindVertexArrayOES(null),yi.currentVAO=_n}}function vi(_n){if(_n!==yi.currentVAO){if(_n)_n.bindAttrs();else{for(var An=Gr(),oi=0;oi<Hn.length;++oi){var Ei=Hn[oi];Ei.buffer?(kt.enableVertexAttribArray(oi),Ei.buffer.bind(),kt.vertexAttribPointer(oi,Ei.size,Ei.type,Ei.normalized,Ei.stride,Ei.offfset),An&&Ei.divisor&&An.vertexAttribDivisorANGLE(oi,Ei.divisor)):(kt.disableVertexAttribArray(oi),kt.vertexAttrib4f(oi,Ei.x,Ei.y,Ei.z,Ei.w))}En.elements?kt.bindBuffer(rr,En.elements.buffer.buffer):kt.bindBuffer(rr,null)}yi.currentVAO=_n}}function Rn(){ke(ui).forEach(function(_n){_n.destroy()})}function Qn(){this.id=++ii,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var _n=ri();_n?this.vao=_n.createVertexArrayOES():this.vao=null,ui[this.id]=this,this.buffers=[]}Qn.prototype.bindAttrs=function(){for(var _n=Gr(),An=this.attributes,oi=0;oi<An.length;++oi){var Ei=An[oi];Ei.buffer?(kt.enableVertexAttribArray(oi),kt.bindBuffer(br,Ei.buffer.buffer),kt.vertexAttribPointer(oi,Ei.size,Ei.type,Ei.normalized,Ei.stride,Ei.offset),_n&&Ei.divisor&&_n.vertexAttribDivisorANGLE(oi,Ei.divisor)):(kt.disableVertexAttribArray(oi),kt.vertexAttrib4f(oi,Ei.x,Ei.y,Ei.z,Ei.w))}for(var ti=An.length;ti<Dn;++ti)kt.disableVertexAttribArray(ti);var xi=on.getElements(this.elements);xi?kt.bindBuffer(rr,xi.buffer.buffer):kt.bindBuffer(rr,null)},Qn.prototype.refresh=function(){var _n=ri();_n&&(_n.bindVertexArrayOES(this.vao),this.bindAttrs(),yi.currentVAO=null,_n.bindVertexArrayOES(null))},Qn.prototype.destroy=function(){if(this.vao){var _n=ri();this===yi.currentVAO&&(yi.currentVAO=null,_n.bindVertexArrayOES(null)),_n.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ui[this.id]&&(delete ui[this.id],cn.vaoCount-=1)};function Ti(){var _n=ri();_n&&ke(ui).forEach(function(An){An.refresh()})}function aa(_n){var An=new Qn;cn.vaoCount+=1;function oi(Ei){var ti;if(Array.isArray(Ei))ti=Ei,An.elements&&An.ownsElements&&An.elements.destroy(),An.elements=null,An.ownsElements=!1,An.offset=0,An.count=0,An.instances=-1,An.primitive=4;else{if(tt(typeof Ei=="object","invalid arguments for create vao"),tt("attributes"in Ei,"must specify attributes for vao"),Ei.elements){var xi=Ei.elements;An.ownsElements?typeof xi=="function"&&xi._reglType==="elements"?(An.elements.destroy(),An.ownsElements=!1):(An.elements(xi),An.ownsElements=!1):on.getElements(Ei.elements)?(An.elements=Ei.elements,An.ownsElements=!1):(An.elements=on.create(Ei.elements),An.ownsElements=!0)}else An.elements=null,An.ownsElements=!1;ti=Ei.attributes,An.offset=0,An.count=-1,An.instances=-1,An.primitive=4,An.elements&&(An.count=An.elements._elements.vertCount,An.primitive=An.elements._elements.primType),"offset"in Ei&&(An.offset=Ei.offset|0),"count"in Ei&&(An.count=Ei.count|0),"instances"in Ei&&(An.instances=Ei.instances|0),"primitive"in Ei&&(tt(Ei.primitive in Ln,"bad primitive type: "+Ei.primitive),An.primitive=Ln[Ei.primitive]),tt.optional(function(){for(var Is=Object.keys(Ei),zs=0;zs<Is.length;++zs)tt(xr.indexOf(Is[zs])>=0,'invalid option for vao: "'+Is[zs]+'" valid options are '+xr)}),tt(Array.isArray(ti),"attributes must be an array")}tt(ti.length<Dn,"too many attributes"),tt(ti.length>0,"must specify at least one attribute");var Mi={},Ua=An.attributes;Ua.length=ti.length;for(var Yn=0;Yn<ti.length;++Yn){var Ii=ti[Yn],Li=Ua[Yn]=new Pr,wa=Ii.data||Ii;if(Array.isArray(wa)||wt(wa)||Wu(wa)){var Da;An.buffers[Yn]&&(Da=An.buffers[Yn],wt(wa)&&Da._buffer.byteLength>=wa.byteLength?Da.subdata(wa):(Da.destroy(),An.buffers[Yn]=null)),An.buffers[Yn]||(Da=An.buffers[Yn]=On.create(Ii,br,!1,!0)),Li.buffer=On.getBuffer(Da),Li.size=Li.buffer.dimension|0,Li.normalized=!1,Li.type=Li.buffer.dtype,Li.offset=0,Li.stride=0,Li.divisor=0,Li.state=1,Mi[Yn]=1}else On.getBuffer(Ii)?(Li.buffer=On.getBuffer(Ii),Li.size=Li.buffer.dimension|0,Li.normalized=!1,Li.type=Li.buffer.dtype,Li.offset=0,Li.stride=0,Li.divisor=0,Li.state=1):On.getBuffer(Ii.buffer)?(Li.buffer=On.getBuffer(Ii.buffer),Li.size=(+Ii.size||Li.buffer.dimension)|0,Li.normalized=!!Ii.normalized||!1,"type"in Ii?(tt.parameter(Ii.type,dl,"invalid buffer type"),Li.type=dl[Ii.type]):Li.type=Li.buffer.dtype,Li.offset=(Ii.offset||0)|0,Li.stride=(Ii.stride||0)|0,Li.divisor=(Ii.divisor||0)|0,Li.state=1,tt(Li.size>=1&&Li.size<=4,"size must be between 1 and 4"),tt(Li.offset>=0,"invalid offset"),tt(Li.stride>=0&&Li.stride<=255,"stride must be between 0 and 255"),tt(Li.divisor>=0,"divisor must be positive"),tt(!Li.divisor||!!Ze.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Ii?(tt(Yn>0,"first attribute must not be a constant"),Li.x=+Ii.x||0,Li.y=+Ii.y||0,Li.z=+Ii.z||0,Li.w=+Ii.w||0,Li.state=2):tt(!1,"invalid attribute spec for location "+Yn)}for(var oo=0;oo<An.buffers.length;++oo)!Mi[oo]&&An.buffers[oo]&&(An.buffers[oo].destroy(),An.buffers[oo]=null);return An.refresh(),oi}return oi.destroy=function(){for(var Ei=0;Ei<An.buffers.length;++Ei)An.buffers[Ei]&&An.buffers[Ei].destroy();An.buffers.length=0,An.ownsElements&&(An.elements.destroy(),An.elements=null,An.ownsElements=!1),An.destroy()},oi._vao=An,oi._reglType="vao",oi(_n)}return yi}var gn=35632,ln=35633,bn=35718,Zn=35721;function Kn(kt,Ze,dr,cn){var On={},on={};function En(Gr,dn,Xn,vi){this.name=Gr,this.id=dn,this.location=Xn,this.info=vi}function Dn(Gr,dn){for(var Xn=0;Xn<Gr.length;++Xn)if(Gr[Xn].id===dn.id){Gr[Xn].location=dn.location;return}Gr.push(dn)}function Hn(Gr,dn,Xn){var vi=Gr===gn?On:on,Rn=vi[dn];if(!Rn){var Qn=Ze.str(dn);Rn=kt.createShader(Gr),kt.shaderSource(Rn,Qn),kt.compileShader(Rn),tt.shaderError(kt,Rn,Qn,Gr,Xn),vi[dn]=Rn}return Rn}var Jn={},ii=[],ui=0;function yi(Gr,dn){this.id=ui++,this.fragId=Gr,this.vertId=dn,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,cn.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function qn(Gr,dn,Xn){var vi,Rn,Qn=Hn(gn,Gr.fragId),Ti=Hn(ln,Gr.vertId),aa=Gr.program=kt.createProgram();if(kt.attachShader(aa,Qn),kt.attachShader(aa,Ti),Xn)for(vi=0;vi<Xn.length;++vi){var _n=Xn[vi];kt.bindAttribLocation(aa,_n[0],_n[1])}kt.linkProgram(aa),tt.linkError(kt,aa,Ze.str(Gr.fragId),Ze.str(Gr.vertId),dn);var An=kt.getProgramParameter(aa,bn);cn.profile&&(Gr.stats.uniformsCount=An);var oi=Gr.uniforms;for(vi=0;vi<An;++vi)if(Rn=kt.getActiveUniform(aa,vi),Rn)if(Rn.size>1)for(var Ei=0;Ei<Rn.size;++Ei){var ti=Rn.name.replace("[0]","["+Ei+"]");Dn(oi,new En(ti,Ze.id(ti),kt.getUniformLocation(aa,ti),Rn))}else Dn(oi,new En(Rn.name,Ze.id(Rn.name),kt.getUniformLocation(aa,Rn.name),Rn));var xi=kt.getProgramParameter(aa,Zn);cn.profile&&(Gr.stats.attributesCount=xi);var Mi=Gr.attributes;for(vi=0;vi<xi;++vi)Rn=kt.getActiveAttrib(aa,vi),Rn&&Dn(Mi,new En(Rn.name,Ze.id(Rn.name),kt.getAttribLocation(aa,Rn.name),Rn))}cn.profile&&(dr.getMaxUniformsCount=function(){var Gr=0;return ii.forEach(function(dn){dn.stats.uniformsCount>Gr&&(Gr=dn.stats.uniformsCount)}),Gr},dr.getMaxAttributesCount=function(){var Gr=0;return ii.forEach(function(dn){dn.stats.attributesCount>Gr&&(Gr=dn.stats.attributesCount)}),Gr});function ri(){On={},on={};for(var Gr=0;Gr<ii.length;++Gr)qn(ii[Gr],null,ii[Gr].attributes.map(function(dn){return[dn.location,dn.name]}))}return{clear:function(){var Gr=kt.deleteShader.bind(kt);ke(On).forEach(Gr),On={},ke(on).forEach(Gr),on={},ii.forEach(function(dn){kt.deleteProgram(dn.program)}),ii.length=0,Jn={},dr.shaderCount=0},program:function(Gr,dn,Xn,vi){tt.command(Gr>=0,"missing vertex shader",Xn),tt.command(dn>=0,"missing fragment shader",Xn);var Rn=Jn[dn];Rn||(Rn=Jn[dn]={});var Qn=Rn[Gr];if(Qn&&(Qn.refCount++,!vi))return Qn;var Ti=new yi(dn,Gr);return dr.shaderCount++,qn(Ti,Xn,vi),Qn||(Rn[Gr]=Ti),ii.push(Ti),I(Ti,{destroy:function(){if(Ti.refCount--,Ti.refCount<=0){kt.deleteProgram(Ti.program);var aa=ii.indexOf(Ti);ii.splice(aa,1),dr.shaderCount--}Rn[Ti.vertId].refCount<=0&&(kt.deleteShader(on[Ti.vertId]),delete on[Ti.vertId],delete Jn[Ti.fragId][Ti.vertId]),Object.keys(Jn[Ti.fragId]).length||(kt.deleteShader(On[Ti.fragId]),delete On[Ti.fragId],delete Jn[Ti.fragId])}})},restore:ri,shader:Hn,frag:-1,vert:-1}}var ci=6408,Oi=5121,na=3333,ia=5126;function ua(kt,Ze,dr,cn,On,on,En){function Dn(ii){var ui;Ze.next===null?(tt(On.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ui=Oi):(tt(Ze.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ui=Ze.next.colorAttachments[0].texture._texture.type,tt.optional(function(){on.oes_texture_float?(tt(ui===Oi||ui===ia,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ui===ia&&tt(En.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):tt(ui===Oi,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var yi=0,qn=0,ri=cn.framebufferWidth,Gr=cn.framebufferHeight,dn=null;wt(ii)?dn=ii:ii&&(tt.type(ii,"object","invalid arguments to regl.read()"),yi=ii.x|0,qn=ii.y|0,tt(yi>=0&&yi<cn.framebufferWidth,"invalid x offset for regl.read"),tt(qn>=0&&qn<cn.framebufferHeight,"invalid y offset for regl.read"),ri=(ii.width||cn.framebufferWidth-yi)|0,Gr=(ii.height||cn.framebufferHeight-qn)|0,dn=ii.data||null),dn&&(ui===Oi?tt(dn instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ui===ia&&tt(dn instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),tt(ri>0&&ri+yi<=cn.framebufferWidth,"invalid width for read pixels"),tt(Gr>0&&Gr+qn<=cn.framebufferHeight,"invalid height for read pixels"),dr();var Xn=ri*Gr*4;return dn||(ui===Oi?dn=new Uint8Array(Xn):ui===ia&&(dn=dn||new Float32Array(Xn))),tt.isTypedArray(dn,"data buffer for regl.read() must be a typedarray"),tt(dn.byteLength>=Xn,"data buffer for regl.read() too small"),kt.pixelStorei(na,4),kt.readPixels(yi,qn,ri,Gr,ci,ui,dn),dn}function Hn(ii){var ui;return Ze.setFBO({framebuffer:ii.framebuffer},function(){ui=Dn(ii)}),ui}function Jn(ii){return!ii||!("framebuffer"in ii)?Dn(ii):Hn(ii)}return Jn}function Qa(kt){return Array.prototype.slice.call(kt)}function Fi(kt){return Qa(kt).join("")}function Ra(){var kt=0,Ze=[],dr=[];function cn(ui){for(var yi=0;yi<dr.length;++yi)if(dr[yi]===ui)return Ze[yi];var qn="g"+kt++;return Ze.push(qn),dr.push(ui),qn}function On(){var ui=[];function yi(){ui.push.apply(ui,Qa(arguments))}var qn=[];function ri(){var Gr="v"+kt++;return qn.push(Gr),arguments.length>0&&(ui.push(Gr,"="),ui.push.apply(ui,Qa(arguments)),ui.push(";")),Gr}return I(yi,{def:ri,toString:function(){return Fi([qn.length>0?"var "+qn.join(",")+";":"",Fi(ui)])}})}function on(){var ui=On(),yi=On(),qn=ui.toString,ri=yi.toString;function Gr(dn,Xn){yi(dn,Xn,"=",ui.def(dn,Xn),";")}return I(function(){ui.apply(ui,Qa(arguments))},{def:ui.def,entry:ui,exit:yi,save:Gr,set:function(dn,Xn,vi){Gr(dn,Xn),ui(dn,Xn,"=",vi,";")},toString:function(){return qn()+ri()}})}function En(){var ui=Fi(arguments),yi=on(),qn=on(),ri=yi.toString,Gr=qn.toString;return I(yi,{then:function(){return yi.apply(yi,Qa(arguments)),this},else:function(){return qn.apply(qn,Qa(arguments)),this},toString:function(){var dn=Gr();return dn&&(dn="else{"+dn+"}"),Fi(["if(",ui,"){",ri(),"}",dn])}})}var Dn=On(),Hn={};function Jn(ui,yi){var qn=[];function ri(){var Rn="a"+qn.length;return qn.push(Rn),Rn}yi=yi||0;for(var Gr=0;Gr<yi;++Gr)ri();var dn=on(),Xn=dn.toString,vi=Hn[ui]=I(dn,{arg:ri,toString:function(){return Fi(["function(",qn.join(),"){",Xn(),"}"])}});return vi}function ii(){var ui=['"use strict";',Dn,"return {"];Object.keys(Hn).forEach(function(Gr){ui.push('"',Gr,'":',Hn[Gr].toString(),",")}),ui.push("}");var yi=Fi(ui).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),qn=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,ri=qn?Lt.Function.apply(null,Ze.concat(yi)):Function.apply(null,Ze.concat(yi));return ri.apply(null,dr)}return{global:Dn,link:cn,block:On,proc:Jn,scope:on,cond:En,compile:ii}}var Aa="xyzw".split(""),ka=5121,la=1,Na=2,pa=0,da=1,Ds=2,ss=3,ou=4,Ks=5,ls=6,cs="dither",vu="blend.enable",Du="blend.color",kc="blend.equation",qu="blend.func",Kl="depth.enable",cl="depth.func",yh="depth.range",El="depth.mask",Ql="colorMask",_h="cull.enable",Yf="cull.face",dc="frontFace",xh="lineWidth",Jl="polygonOffset.enable",js="polygonOffset.offset",$c="sample.alpha",Tf="sample.enable",vc="sample.coverage",Lo="stencil.enable",wl="stencil.mask",Ku="stencil.func",qc="stencil.opFront",Kc="stencil.opBack",$f="scissor.enable",Qc="scissor.box",Bu="viewport",bh="profile",tc="framebuffer",Jc="vert",Eh="frag",kl="elements",Cu="primitive",sp="count",Sd="offset",uv="instances",lv="vao",G0="Width",Up="Height",Lc=tc+G0,tf=tc+Up,wh=Bu+G0,cv=Bu+Up,Sl="drawingBuffer",ei=Sl+G0,Cd=Sl+Up,Gm=[qu,kc,Ku,qc,Kc,vc,Bu,Qc,js],Bs=34962,Mf=34963,Zp=35632,ef=35633,Cl=3553,Pc=34067,Vp=2884,Sh=3042,fv=3024,Ns=2960,qf=2929,Ad=3089,gc=32823,hv=32926,Td=32928,pv=5126,Md=35664,Kf=35665,up=35666,Id=5124,Gp=35667,Qf=35668,dv=35669,rf=35670,vv=35671,nf=35672,Hp=35673,Ul=35674,kd=35675,Ld=35676,Pd=35678,jp=35680,af=4,ec=1028,Wp=1029,H0=2304,Qv=2305,If=32775,mc=32776,j0=519,rc=7680,Od=0,Jv=1,of=32774,sf=513,Fd=36160,t0=36064,nc={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Rd=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Ch={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Ah={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},e0={frag:Zp,vert:ef},r0={cw:H0,ccw:Qv};function lp(kt){return Array.isArray(kt)||wt(kt)||Wu(kt)}function Dd(kt){return kt.sort(function(Ze,dr){return Ze===Bu?-1:dr===Bu?1:Ze<dr?-1:1})}function Ro(kt,Ze,dr,cn){this.thisDep=kt,this.contextDep=Ze,this.propDep=dr,this.append=cn}function kf(kt){return kt&&!(kt.thisDep||kt.contextDep||kt.propDep)}function co(kt){return new Ro(!1,!1,!1,kt)}function gu(kt,Ze){var dr=kt.type;if(dr===pa){var cn=kt.data.length;return new Ro(!0,cn>=1,cn>=2,Ze)}else if(dr===ou){var On=kt.data;return new Ro(On.thisDep,On.contextDep,On.propDep,Ze)}else{if(dr===Ks)return new Ro(!1,!1,!1,Ze);if(dr===ls){for(var on=!1,En=!1,Dn=!1,Hn=0;Hn<kt.data.length;++Hn){var Jn=kt.data[Hn];if(Jn.type===da)Dn=!0;else if(Jn.type===Ds)En=!0;else if(Jn.type===ss)on=!0;else if(Jn.type===pa){on=!0;var ii=Jn.data;ii>=1&&(En=!0),ii>=2&&(Dn=!0)}else Jn.type===ou&&(on=on||Jn.data.thisDep,En=En||Jn.data.contextDep,Dn=Dn||Jn.data.propDep)}return new Ro(on,En,Dn,Ze)}else return new Ro(dr===ss,dr===Ds,dr===da,Ze)}}var W0=new Ro(!1,!1,!1,function(){});function Xp(kt,Ze,dr,cn,On,on,En,Dn,Hn,Jn,ii,ui,yi,qn,ri){var Gr=Jn.Record,dn={add:32774,subtract:32778,"reverse subtract":32779};dr.ext_blend_minmax&&(dn.min=If,dn.max=mc);var Xn=dr.angle_instanced_arrays,vi=dr.webgl_draw_buffers,Rn=dr.oes_vertex_array_object,Qn={dirty:!0,profile:ri.profile},Ti={},aa=[],_n={},An={};function oi(qe){return qe.replace(".","_")}function Ei(qe,Re,yr){var Xr=oi(qe);aa.push(qe),Ti[Xr]=Qn[Xr]=!!yr,_n[Xr]=Re}function ti(qe,Re,yr){var Xr=oi(qe);aa.push(qe),Array.isArray(yr)?(Qn[Xr]=yr.slice(),Ti[Xr]=yr.slice()):Qn[Xr]=Ti[Xr]=yr,An[Xr]=Re}Ei(cs,fv),Ei(vu,Sh),ti(Du,"blendColor",[0,0,0,0]),ti(kc,"blendEquationSeparate",[of,of]),ti(qu,"blendFuncSeparate",[Jv,Od,Jv,Od]),Ei(Kl,qf,!0),ti(cl,"depthFunc",sf),ti(yh,"depthRange",[0,1]),ti(El,"depthMask",!0),ti(Ql,Ql,[!0,!0,!0,!0]),Ei(_h,Vp),ti(Yf,"cullFace",Wp),ti(dc,dc,Qv),ti(xh,xh,1),Ei(Jl,gc),ti(js,"polygonOffset",[0,0]),Ei($c,hv),Ei(Tf,Td),ti(vc,"sampleCoverage",[1,!1]),Ei(Lo,Ns),ti(wl,"stencilMask",-1),ti(Ku,"stencilFunc",[j0,0,-1]),ti(qc,"stencilOpSeparate",[ec,rc,rc,rc]),ti(Kc,"stencilOpSeparate",[Wp,rc,rc,rc]),Ei($f,Ad),ti(Qc,"scissor",[0,0,kt.drawingBufferWidth,kt.drawingBufferHeight]),ti(Bu,Bu,[0,0,kt.drawingBufferWidth,kt.drawingBufferHeight]);var xi={gl:kt,context:yi,strings:Ze,next:Ti,current:Qn,draw:ui,elements:on,buffer:On,shader:ii,attributes:Jn.state,vao:Jn,uniforms:Hn,framebuffer:Dn,extensions:dr,timer:qn,isBufferArgs:lp},Mi={primTypes:Ln,compareFuncs:Ch,blendFuncs:nc,blendEquations:dn,stencilOps:Ah,glTypes:dl,orientationType:r0};tt.optional(function(){xi.isArrayLike=ir}),vi&&(Mi.backBuffer=[Wp],Mi.drawBuffer=fr(cn.maxDrawbuffers,function(qe){return qe===0?[0]:fr(qe,function(Re){return t0+Re})}));var Ua=0;function Yn(){var qe=Ra(),Re=qe.link,yr=qe.global;qe.id=Ua++,qe.batchId="0";var Xr=Re(xi),sn=qe.shared={props:"a0"};Object.keys(xi).forEach(function(vr){sn[vr]=yr.def(Xr,".",vr)}),tt.optional(function(){qe.CHECK=Re(tt),qe.commandStr=tt.guessCommand(),qe.command=Re(qe.commandStr),qe.assert=function(vr,tr,Hr){vr("if(!(",tr,"))",this.CHECK,".commandRaise(",Re(Hr),",",this.command,");")},Mi.invalidBlendCombinations=Rd});var mr=qe.next={},pr=qe.current={};Object.keys(An).forEach(function(vr){Array.isArray(Qn[vr])&&(mr[vr]=yr.def(sn.next,".",vr),pr[vr]=yr.def(sn.current,".",vr))});var kr=qe.constants={};Object.keys(Mi).forEach(function(vr){kr[vr]=yr.def(JSON.stringify(Mi[vr]))}),qe.invoke=function(vr,tr){switch(tr.type){case pa:var Hr=["this",sn.context,sn.props,qe.batchId];return vr.def(Re(tr.data),".call(",Hr.slice(0,Math.max(tr.data.length+1,4)),")");case da:return vr.def(sn.props,tr.data);case Ds:return vr.def(sn.context,tr.data);case ss:return vr.def("this",tr.data);case ou:return tr.data.append(qe,vr),tr.data.ref;case Ks:return tr.data.toString();case ls:return tr.data.map(function(Jr){return qe.invoke(vr,Jr)})}},qe.attribCache={};var Ge={};return qe.scopeAttrib=function(vr){var tr=Ze.id(vr);if(tr in Ge)return Ge[tr];var Hr=Jn.scope[tr];Hr||(Hr=Jn.scope[tr]=new Gr);var Jr=Ge[tr]=Re(Hr);return Jr},qe}function Ii(qe){var Re=qe.static,yr=qe.dynamic,Xr;if(bh in Re){var sn=!!Re[bh];Xr=co(function(pr,kr){return sn}),Xr.enable=sn}else if(bh in yr){var mr=yr[bh];Xr=gu(mr,function(pr,kr){return pr.invoke(kr,mr)})}return Xr}function Li(qe,Re){var yr=qe.static,Xr=qe.dynamic;if(tc in yr){var sn=yr[tc];return sn?(sn=Dn.getFramebuffer(sn),tt.command(sn,"invalid framebuffer object"),co(function(pr,kr){var Ge=pr.link(sn),vr=pr.shared;kr.set(vr.framebuffer,".next",Ge);var tr=vr.context;return kr.set(tr,"."+Lc,Ge+".width"),kr.set(tr,"."+tf,Ge+".height"),Ge})):co(function(pr,kr){var Ge=pr.shared;kr.set(Ge.framebuffer,".next","null");var vr=Ge.context;return kr.set(vr,"."+Lc,vr+"."+ei),kr.set(vr,"."+tf,vr+"."+Cd),"null"})}else if(tc in Xr){var mr=Xr[tc];return gu(mr,function(pr,kr){var Ge=pr.invoke(kr,mr),vr=pr.shared,tr=vr.framebuffer,Hr=kr.def(tr,".getFramebuffer(",Ge,")");tt.optional(function(){pr.assert(kr,"!"+Ge+"||"+Hr,"invalid framebuffer object")}),kr.set(tr,".next",Hr);var Jr=vr.context;return kr.set(Jr,"."+Lc,Hr+"?"+Hr+".width:"+Jr+"."+ei),kr.set(Jr,"."+tf,Hr+"?"+Hr+".height:"+Jr+"."+Cd),Hr})}else return null}function wa(qe,Re,yr){var Xr=qe.static,sn=qe.dynamic;function mr(Ge){if(Ge in Xr){var vr=Xr[Ge];tt.commandType(vr,"object","invalid "+Ge,yr.commandStr);var tr=!0,Hr=vr.x|0,Jr=vr.y|0,Bn,gi;return"width"in vr?(Bn=vr.width|0,tt.command(Bn>=0,"invalid "+Ge,yr.commandStr)):tr=!1,"height"in vr?(gi=vr.height|0,tt.command(gi>=0,"invalid "+Ge,yr.commandStr)):tr=!1,new Ro(!tr&&Re&&Re.thisDep,!tr&&Re&&Re.contextDep,!tr&&Re&&Re.propDep,function(fi,Xi){var Pi=fi.shared.context,Gi=Bn;"width"in vr||(Gi=Xi.def(Pi,".",Lc,"-",Hr));var kn=gi;return"height"in vr||(kn=Xi.def(Pi,".",tf,"-",Jr)),[Hr,Jr,Gi,kn]})}else if(Ge in sn){var mi=sn[Ge],pi=gu(mi,function(fi,Xi){var Pi=fi.invoke(Xi,mi);tt.optional(function(){fi.assert(Xi,Pi+"&&typeof "+Pi+'==="object"',"invalid "+Ge)});var Gi=fi.shared.context,kn=Xi.def(Pi,".x|0"),Ni=Xi.def(Pi,".y|0"),Ea=Xi.def('"width" in ',Pi,"?",Pi,".width|0:","(",Gi,".",Lc,"-",kn,")"),jo=Xi.def('"height" in ',Pi,"?",Pi,".height|0:","(",Gi,".",tf,"-",Ni,")");return tt.optional(function(){fi.assert(Xi,Ea+">=0&&"+jo+">=0","invalid "+Ge)}),[kn,Ni,Ea,jo]});return Re&&(pi.thisDep=pi.thisDep||Re.thisDep,pi.contextDep=pi.contextDep||Re.contextDep,pi.propDep=pi.propDep||Re.propDep),pi}else return Re?new Ro(Re.thisDep,Re.contextDep,Re.propDep,function(fi,Xi){var Pi=fi.shared.context;return[0,0,Xi.def(Pi,".",Lc),Xi.def(Pi,".",tf)]}):null}var pr=mr(Bu);if(pr){var kr=pr;pr=new Ro(pr.thisDep,pr.contextDep,pr.propDep,function(Ge,vr){var tr=kr.append(Ge,vr),Hr=Ge.shared.context;return vr.set(Hr,"."+wh,tr[2]),vr.set(Hr,"."+cv,tr[3]),tr})}return{viewport:pr,scissor_box:mr(Qc)}}function Da(qe,Re){var yr=qe.static,Xr=typeof yr[Eh]=="string"&&typeof yr[Jc]=="string";if(Xr){if(Object.keys(Re.dynamic).length>0)return null;var sn=Re.static,mr=Object.keys(sn);if(mr.length>0&&typeof sn[mr[0]]=="number"){for(var pr=[],kr=0;kr<mr.length;++kr)tt(typeof sn[mr[kr]]=="number","must specify all vertex attribute locations when using vaos"),pr.push([sn[mr[kr]]|0,mr[kr]]);return pr}}return null}function oo(qe,Re,yr){var Xr=qe.static,sn=qe.dynamic;function mr(tr){if(tr in Xr){var Hr=Ze.id(Xr[tr]);tt.optional(function(){ii.shader(e0[tr],Hr,tt.guessCommand())});var Jr=co(function(){return Hr});return Jr.id=Hr,Jr}else if(tr in sn){var Bn=sn[tr];return gu(Bn,function(gi,mi){var pi=gi.invoke(mi,Bn),fi=mi.def(gi.shared.strings,".id(",pi,")");return tt.optional(function(){mi(gi.shared.shader,".shader(",e0[tr],",",fi,",",gi.command,");")}),fi})}return null}var pr=mr(Eh),kr=mr(Jc),Ge=null,vr;return kf(pr)&&kf(kr)?(Ge=ii.program(kr.id,pr.id,null,yr),vr=co(function(tr,Hr){return tr.link(Ge)})):vr=new Ro(pr&&pr.thisDep||kr&&kr.thisDep,pr&&pr.contextDep||kr&&kr.contextDep,pr&&pr.propDep||kr&&kr.propDep,function(tr,Hr){var Jr=tr.shared.shader,Bn;pr?Bn=pr.append(tr,Hr):Bn=Hr.def(Jr,".",Eh);var gi;kr?gi=kr.append(tr,Hr):gi=Hr.def(Jr,".",Jc);var mi=Jr+".program("+gi+","+Bn;return tt.optional(function(){mi+=","+tr.command}),Hr.def(mi+")")}),{frag:pr,vert:kr,progVar:vr,program:Ge}}function Is(qe,Re){var yr=qe.static,Xr=qe.dynamic,sn={},mr=!1;function pr(){if(lv in yr){var Xi=yr[lv];return Xi!==null&&Jn.getVAO(Xi)===null&&(Xi=Jn.createVAO(Xi)),mr=!0,sn.vao=Xi,co(function(Gi){var kn=Jn.getVAO(Xi);return kn?Gi.link(kn):"null"})}else if(lv in Xr){mr=!0;var Pi=Xr[lv];return gu(Pi,function(Gi,kn){var Ni=Gi.invoke(kn,Pi);return kn.def(Gi.shared.vao+".getVAO("+Ni+")")})}return null}var kr=pr(),Ge=!1;function vr(){if(kl in yr){var Xi=yr[kl];if(sn.elements=Xi,lp(Xi)){var Pi=sn.elements=on.create(Xi,!0);Xi=on.getElements(Pi),Ge=!0}else Xi&&(Xi=on.getElements(Xi),Ge=!0,tt.command(Xi,"invalid elements",Re.commandStr));var Gi=co(function(Ni,Ea){if(Xi){var jo=Ni.link(Xi);return Ni.ELEMENTS=jo,jo}return Ni.ELEMENTS=null,null});return Gi.value=Xi,Gi}else if(kl in Xr){Ge=!0;var kn=Xr[kl];return gu(kn,function(Ni,Ea){var jo=Ni.shared,Iu=jo.isBufferArgs,_a=jo.elements,mo=Ni.invoke(Ea,kn),Oc=Ea.def("null"),Al=Ea.def(Iu,"(",mo,")"),lf=Ni.cond(Al).then(Oc,"=",_a,".createStream(",mo,");").else(Oc,"=",_a,".getElements(",mo,");");return tt.optional(function(){Ni.assert(lf.else,"!"+mo+"||"+Oc,"invalid elements")}),Ea.entry(lf),Ea.exit(Ni.cond(Al).then(_a,".destroyStream(",Oc,");")),Ni.ELEMENTS=Oc,Oc})}else if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ni,Ea){return Ea.def(Ni.shared.vao+".currentVAO?"+Ni.shared.elements+".getElements("+Ni.shared.vao+".currentVAO.elements):null")});return null}var tr=vr();function Hr(){if(Cu in yr){var Xi=yr[Cu];return sn.primitive=Xi,tt.commandParameter(Xi,Ln,"invalid primitve",Re.commandStr),co(function(Gi,kn){return Ln[Xi]})}else if(Cu in Xr){var Pi=Xr[Cu];return gu(Pi,function(Gi,kn){var Ni=Gi.constants.primTypes,Ea=Gi.invoke(kn,Pi);return tt.optional(function(){Gi.assert(kn,Ea+" in "+Ni,"invalid primitive, must be one of "+Object.keys(Ln))}),kn.def(Ni,"[",Ea,"]")})}else{if(Ge)return kf(tr)?tr.value?co(function(Gi,kn){return kn.def(Gi.ELEMENTS,".primType")}):co(function(){return af}):new Ro(tr.thisDep,tr.contextDep,tr.propDep,function(Gi,kn){var Ni=Gi.ELEMENTS;return kn.def(Ni,"?",Ni,".primType:",af)});if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Gi,kn){return kn.def(Gi.shared.vao+".currentVAO?"+Gi.shared.vao+".currentVAO.primitive:"+af)})}return null}function Jr(Xi,Pi){if(Xi in yr){var Gi=yr[Xi]|0;return Pi?sn.offset=Gi:sn.instances=Gi,tt.command(!Pi||Gi>=0,"invalid "+Xi,Re.commandStr),co(function(Ni,Ea){return Pi&&(Ni.OFFSET=Gi),Gi})}else if(Xi in Xr){var kn=Xr[Xi];return gu(kn,function(Ni,Ea){var jo=Ni.invoke(Ea,kn);return Pi&&(Ni.OFFSET=jo,tt.optional(function(){Ni.assert(Ea,jo+">=0","invalid "+Xi)})),jo})}else if(Pi){if(Ge)return co(function(Ni,Ea){return Ni.OFFSET=0,0});if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ni,Ea){return Ea.def(Ni.shared.vao+".currentVAO?"+Ni.shared.vao+".currentVAO.offset:0")})}else if(mr)return new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ni,Ea){return Ea.def(Ni.shared.vao+".currentVAO?"+Ni.shared.vao+".currentVAO.instances:-1")});return null}var Bn=Jr(Sd,!0);function gi(){if(sp in yr){var Xi=yr[sp]|0;return sn.count=Xi,tt.command(typeof Xi=="number"&&Xi>=0,"invalid vertex count",Re.commandStr),co(function(){return Xi})}else if(sp in Xr){var Pi=Xr[sp];return gu(Pi,function(Ea,jo){var Iu=Ea.invoke(jo,Pi);return tt.optional(function(){Ea.assert(jo,"typeof "+Iu+'==="number"&&'+Iu+">=0&&"+Iu+"===("+Iu+"|0)","invalid vertex count")}),Iu})}else if(Ge)if(kf(tr)){if(tr)return Bn?new Ro(Bn.thisDep,Bn.contextDep,Bn.propDep,function(Ea,jo){var Iu=jo.def(Ea.ELEMENTS,".vertCount-",Ea.OFFSET);return tt.optional(function(){Ea.assert(jo,Iu+">=0","invalid vertex offset/element buffer too small")}),Iu}):co(function(Ea,jo){return jo.def(Ea.ELEMENTS,".vertCount")});var Gi=co(function(){return-1});return tt.optional(function(){Gi.MISSING=!0}),Gi}else{var kn=new Ro(tr.thisDep||Bn.thisDep,tr.contextDep||Bn.contextDep,tr.propDep||Bn.propDep,function(Ea,jo){var Iu=Ea.ELEMENTS;return Ea.OFFSET?jo.def(Iu,"?",Iu,".vertCount-",Ea.OFFSET,":-1"):jo.def(Iu,"?",Iu,".vertCount:-1")});return tt.optional(function(){kn.DYNAMIC=!0}),kn}else if(mr){var Ni=new Ro(kr.thisDep,kr.contextDep,kr.propDep,function(Ea,jo){return jo.def(Ea.shared.vao,".currentVAO?",Ea.shared.vao,".currentVAO.count:-1")});return Ni}return null}var mi=Hr(),pi=gi(),fi=Jr(uv,!1);return{elements:tr,primitive:mi,count:pi,instances:fi,offset:Bn,vao:kr,vaoActive:mr,elementsActive:Ge,static:sn}}function zs(qe,Re){var yr=qe.static,Xr=qe.dynamic,sn={};return aa.forEach(function(mr){var pr=oi(mr);function kr(Ge,vr){if(mr in yr){var tr=Ge(yr[mr]);sn[pr]=co(function(){return tr})}else if(mr in Xr){var Hr=Xr[mr];sn[pr]=gu(Hr,function(Jr,Bn){return vr(Jr,Bn,Jr.invoke(Bn,Hr))})}}switch(mr){case _h:case vu:case cs:case Lo:case Kl:case $f:case Jl:case $c:case Tf:case El:return kr(function(Ge){return tt.commandType(Ge,"boolean",mr,Re.commandStr),Ge},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,"typeof "+tr+'==="boolean"',"invalid flag "+mr,Ge.commandStr)}),tr});case cl:return kr(function(Ge){return tt.commandParameter(Ge,Ch,"invalid "+mr,Re.commandStr),Ch[Ge]},function(Ge,vr,tr){var Hr=Ge.constants.compareFuncs;return tt.optional(function(){Ge.assert(vr,tr+" in "+Hr,"invalid "+mr+", must be one of "+Object.keys(Ch))}),vr.def(Hr,"[",tr,"]")});case yh:return kr(function(Ge){return tt.command(ir(Ge)&&Ge.length===2&&typeof Ge[0]=="number"&&typeof Ge[1]=="number"&&Ge[0]<=Ge[1],"depth range is 2d array",Re.commandStr),Ge},function(Ge,vr,tr){tt.optional(function(){Ge.assert(vr,Ge.shared.isArrayLike+"("+tr+")&&"+tr+".length===2&&typeof "+tr+'[0]==="number"&&typeof '+tr+'[1]==="number"&&'+tr+"[0]<="+tr+"[1]","depth range must be a 2d array")});var Hr=vr.def("+",tr,"[0]"),Jr=vr.def("+",tr,"[1]");return[Hr,Jr]});case qu:return kr(function(Ge){tt.commandType(Ge,"object","blend.func",Re.commandStr);var vr="srcRGB"in Ge?Ge.srcRGB:Ge.src,tr="srcAlpha"in Ge?Ge.srcAlpha:Ge.src,Hr="dstRGB"in Ge?Ge.dstRGB:Ge.dst,Jr="dstAlpha"in Ge?Ge.dstAlpha:Ge.dst;return tt.commandParameter(vr,nc,pr+".srcRGB",Re.commandStr),tt.commandParameter(tr,nc,pr+".srcAlpha",Re.commandStr),tt.commandParameter(Hr,nc,pr+".dstRGB",Re.commandStr),tt.commandParameter(Jr,nc,pr+".dstAlpha",Re.commandStr),tt.command(Rd.indexOf(vr+", "+Hr)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+vr+", "+Hr+")",Re.commandStr),[nc[vr],nc[Hr],nc[tr],nc[Jr]]},function(Ge,vr,tr){var Hr=Ge.constants.blendFuncs;tt.optional(function(){Ge.assert(vr,tr+"&&typeof "+tr+'==="object"',"invalid blend func, must be an object")});function Jr(Pi,Gi){var kn=vr.def('"',Pi,Gi,'" in ',tr,"?",tr,".",Pi,Gi,":",tr,".",Pi);return tt.optional(function(){Ge.assert(vr,kn+" in "+Hr,"invalid "+mr+"."+Pi+Gi+", must be one of "+Object.keys(nc))}),kn}var Bn=Jr("src","RGB"),gi=Jr("dst","RGB");tt.optional(function(){var Pi=Ge.constants.invalidBlendCombinations;Ge.assert(vr,Pi+".indexOf("+Bn+'+", "+'+gi+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var mi=vr.def(Hr,"[",Bn,"]"),pi=vr.def(Hr,"[",Jr("src","Alpha"),"]"),fi=vr.def(Hr,"[",gi,"]"),Xi=vr.def(Hr,"[",Jr("dst","Alpha"),"]");return[mi,fi,pi,Xi]});case kc:return kr(function(Ge){if(typeof Ge=="string")return tt.commandParameter(Ge,dn,"invalid "+mr,Re.commandStr),[dn[Ge],dn[Ge]];if(typeof Ge=="object")return tt.commandParameter(Ge.rgb,dn,mr+".rgb",Re.commandStr),tt.commandParameter(Ge.alpha,dn,mr+".alpha",Re.commandStr),[dn[Ge.rgb],dn[Ge.alpha]];tt.commandRaise("invalid blend.equation",Re.commandStr)},function(Ge,vr,tr){var Hr=Ge.constants.blendEquations,Jr=vr.def(),Bn=vr.def(),gi=Ge.cond("typeof ",tr,'==="string"');return tt.optional(function(){function mi(pi,fi,Xi){Ge.assert(pi,Xi+" in "+Hr,"invalid "+fi+", must be one of "+Object.keys(dn))}mi(gi.then,mr,tr),Ge.assert(gi.else,tr+"&&typeof "+tr+'==="object"',"invalid "+mr),mi(gi.else,mr+".rgb",tr+".rgb"),mi(gi.else,mr+".alpha",tr+".alpha")}),gi.then(Jr,"=",Bn,"=",Hr,"[",tr,"];"),gi.else(Jr,"=",Hr,"[",tr,".rgb];",Bn,"=",Hr,"[",tr,".alpha];"),vr(gi),[Jr,Bn]});case Du:return kr(function(Ge){return tt.command(ir(Ge)&&Ge.length===4,"blend.color must be a 4d array",Re.commandStr),fr(4,function(vr){return+Ge[vr]})},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,Ge.shared.isArrayLike+"("+tr+")&&"+tr+".length===4","blend.color must be a 4d array")}),fr(4,function(Hr){return vr.def("+",tr,"[",Hr,"]")})});case wl:return kr(function(Ge){return tt.commandType(Ge,"number",pr,Re.commandStr),Ge|0},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,"typeof "+tr+'==="number"',"invalid stencil.mask")}),vr.def(tr,"|0")});case Ku:return kr(function(Ge){tt.commandType(Ge,"object",pr,Re.commandStr);var vr=Ge.cmp||"keep",tr=Ge.ref||0,Hr="mask"in Ge?Ge.mask:-1;return tt.commandParameter(vr,Ch,mr+".cmp",Re.commandStr),tt.commandType(tr,"number",mr+".ref",Re.commandStr),tt.commandType(Hr,"number",mr+".mask",Re.commandStr),[Ch[vr],tr,Hr]},function(Ge,vr,tr){var Hr=Ge.constants.compareFuncs;tt.optional(function(){function mi(){Ge.assert(vr,Array.prototype.join.call(arguments,""),"invalid stencil.func")}mi(tr+"&&typeof ",tr,'==="object"'),mi('!("cmp" in ',tr,")||(",tr,".cmp in ",Hr,")")});var Jr=vr.def('"cmp" in ',tr,"?",Hr,"[",tr,".cmp]",":",rc),Bn=vr.def(tr,".ref|0"),gi=vr.def('"mask" in ',tr,"?",tr,".mask|0:-1");return[Jr,Bn,gi]});case qc:case Kc:return kr(function(Ge){tt.commandType(Ge,"object",pr,Re.commandStr);var vr=Ge.fail||"keep",tr=Ge.zfail||"keep",Hr=Ge.zpass||"keep";return tt.commandParameter(vr,Ah,mr+".fail",Re.commandStr),tt.commandParameter(tr,Ah,mr+".zfail",Re.commandStr),tt.commandParameter(Hr,Ah,mr+".zpass",Re.commandStr),[mr===Kc?Wp:ec,Ah[vr],Ah[tr],Ah[Hr]]},function(Ge,vr,tr){var Hr=Ge.constants.stencilOps;tt.optional(function(){Ge.assert(vr,tr+"&&typeof "+tr+'==="object"',"invalid "+mr)});function Jr(Bn){return tt.optional(function(){Ge.assert(vr,'!("'+Bn+'" in '+tr+")||("+tr+"."+Bn+" in "+Hr+")","invalid "+mr+"."+Bn+", must be one of "+Object.keys(Ah))}),vr.def('"',Bn,'" in ',tr,"?",Hr,"[",tr,".",Bn,"]:",rc)}return[mr===Kc?Wp:ec,Jr("fail"),Jr("zfail"),Jr("zpass")]});case js:return kr(function(Ge){tt.commandType(Ge,"object",pr,Re.commandStr);var vr=Ge.factor|0,tr=Ge.units|0;return tt.commandType(vr,"number",pr+".factor",Re.commandStr),tt.commandType(tr,"number",pr+".units",Re.commandStr),[vr,tr]},function(Ge,vr,tr){tt.optional(function(){Ge.assert(vr,tr+"&&typeof "+tr+'==="object"',"invalid "+mr)});var Hr=vr.def(tr,".factor|0"),Jr=vr.def(tr,".units|0");return[Hr,Jr]});case Yf:return kr(function(Ge){var vr=0;return Ge==="front"?vr=ec:Ge==="back"&&(vr=Wp),tt.command(!!vr,pr,Re.commandStr),vr},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,tr+'==="front"||'+tr+'==="back"',"invalid cull.face")}),vr.def(tr,'==="front"?',ec,":",Wp)});case xh:return kr(function(Ge){return tt.command(typeof Ge=="number"&&Ge>=cn.lineWidthDims[0]&&Ge<=cn.lineWidthDims[1],"invalid line width, must be a positive number between "+cn.lineWidthDims[0]+" and "+cn.lineWidthDims[1],Re.commandStr),Ge},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,"typeof "+tr+'==="number"&&'+tr+">="+cn.lineWidthDims[0]+"&&"+tr+"<="+cn.lineWidthDims[1],"invalid line width")}),tr});case dc:return kr(function(Ge){return tt.commandParameter(Ge,r0,pr,Re.commandStr),r0[Ge]},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,tr+'==="cw"||'+tr+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),vr.def(tr+'==="cw"?'+H0+":"+Qv)});case Ql:return kr(function(Ge){return tt.command(ir(Ge)&&Ge.length===4,"color.mask must be length 4 array",Re.commandStr),Ge.map(function(vr){return!!vr})},function(Ge,vr,tr){return tt.optional(function(){Ge.assert(vr,Ge.shared.isArrayLike+"("+tr+")&&"+tr+".length===4","invalid color.mask")}),fr(4,function(Hr){return"!!"+tr+"["+Hr+"]"})});case vc:return kr(function(Ge){tt.command(typeof Ge=="object"&&Ge,pr,Re.commandStr);var vr="value"in Ge?Ge.value:1,tr=!!Ge.invert;return tt.command(typeof vr=="number"&&vr>=0&&vr<=1,"sample.coverage.value must be a number between 0 and 1",Re.commandStr),[vr,tr]},function(Ge,vr,tr){tt.optional(function(){Ge.assert(vr,tr+"&&typeof "+tr+'==="object"',"invalid sample.coverage")});var Hr=vr.def('"value" in ',tr,"?+",tr,".value:1"),Jr=vr.def("!!",tr,".invert");return[Hr,Jr]})}}),sn}function io(qe,Re){var yr=qe.static,Xr=qe.dynamic,sn={};return Object.keys(yr).forEach(function(mr){var pr=yr[mr],kr;if(typeof pr=="number"||typeof pr=="boolean")kr=co(function(){return pr});else if(typeof pr=="function"){var Ge=pr._reglType;Ge==="texture2d"||Ge==="textureCube"?kr=co(function(vr){return vr.link(pr)}):Ge==="framebuffer"||Ge==="framebufferCube"?(tt.command(pr.color.length>0,'missing color attachment for framebuffer sent to uniform "'+mr+'"',Re.commandStr),kr=co(function(vr){return vr.link(pr.color[0])})):tt.commandRaise('invalid data for uniform "'+mr+'"',Re.commandStr)}else ir(pr)?kr=co(function(vr){var tr=vr.global.def("[",fr(pr.length,function(Hr){return tt.command(typeof pr[Hr]=="number"||typeof pr[Hr]=="boolean","invalid uniform "+mr,vr.commandStr),pr[Hr]}),"]");return tr}):tt.commandRaise('invalid or missing data for uniform "'+mr+'"',Re.commandStr);kr.value=pr,sn[mr]=kr}),Object.keys(Xr).forEach(function(mr){var pr=Xr[mr];sn[mr]=gu(pr,function(kr,Ge){return kr.invoke(Ge,pr)})}),sn}function Au(qe,Re){var yr=qe.static,Xr=qe.dynamic,sn={};return Object.keys(yr).forEach(function(mr){var pr=yr[mr],kr=Ze.id(mr),Ge=new Gr;if(lp(pr))Ge.state=la,Ge.buffer=On.getBuffer(On.create(pr,Bs,!1,!0)),Ge.type=0;else{var vr=On.getBuffer(pr);if(vr)Ge.state=la,Ge.buffer=vr,Ge.type=0;else if(tt.command(typeof pr=="object"&&pr,"invalid data for attribute "+mr,Re.commandStr),"constant"in pr){var tr=pr.constant;Ge.buffer="null",Ge.state=Na,typeof tr=="number"?Ge.x=tr:(tt.command(ir(tr)&&tr.length>0&&tr.length<=4,"invalid constant for attribute "+mr,Re.commandStr),Aa.forEach(function(fi,Xi){Xi<tr.length&&(Ge[fi]=tr[Xi])}))}else{lp(pr.buffer)?vr=On.getBuffer(On.create(pr.buffer,Bs,!1,!0)):vr=On.getBuffer(pr.buffer),tt.command(!!vr,'missing buffer for attribute "'+mr+'"',Re.commandStr);var Hr=pr.offset|0;tt.command(Hr>=0,'invalid offset for attribute "'+mr+'"',Re.commandStr);var Jr=pr.stride|0;tt.command(Jr>=0&&Jr<256,'invalid stride for attribute "'+mr+'", must be integer betweeen [0, 255]',Re.commandStr);var Bn=pr.size|0;tt.command(!("size"in pr)||Bn>0&&Bn<=4,'invalid size for attribute "'+mr+'", must be 1,2,3,4',Re.commandStr);var gi=!!pr.normalized,mi=0;"type"in pr&&(tt.commandParameter(pr.type,dl,"invalid type for attribute "+mr,Re.commandStr),mi=dl[pr.type]);var pi=pr.divisor|0;tt.optional(function(){"divisor"in pr&&(tt.command(pi===0||Xn,'cannot specify divisor for attribute "'+mr+'", instancing not supported',Re.commandStr),tt.command(pi>=0,'invalid divisor for attribute "'+mr+'"',Re.commandStr));var fi=Re.commandStr,Xi=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(pr).forEach(function(Pi){tt.command(Xi.indexOf(Pi)>=0,'unknown parameter "'+Pi+'" for attribute pointer "'+mr+'" (valid parameters are '+Xi+")",fi)})}),Ge.buffer=vr,Ge.state=la,Ge.size=Bn,Ge.normalized=gi,Ge.type=mi||vr.dtype,Ge.offset=Hr,Ge.stride=Jr,Ge.divisor=pi}}sn[mr]=co(function(fi,Xi){var Pi=fi.attribCache;if(kr in Pi)return Pi[kr];var Gi={isStream:!1};return Object.keys(Ge).forEach(function(kn){Gi[kn]=Ge[kn]}),Ge.buffer&&(Gi.buffer=fi.link(Ge.buffer),Gi.type=Gi.type||Gi.buffer+".dtype"),Pi[kr]=Gi,Gi})}),Object.keys(Xr).forEach(function(mr){var pr=Xr[mr];function kr(Ge,vr){var tr=Ge.invoke(vr,pr),Hr=Ge.shared,Jr=Ge.constants,Bn=Hr.isBufferArgs,gi=Hr.buffer;tt.optional(function(){Ge.assert(vr,tr+"&&(typeof "+tr+'==="object"||typeof '+tr+'==="function")&&('+Bn+"("+tr+")||"+gi+".getBuffer("+tr+")||"+gi+".getBuffer("+tr+".buffer)||"+Bn+"("+tr+'.buffer)||("constant" in '+tr+"&&(typeof "+tr+'.constant==="number"||'+Hr.isArrayLike+"("+tr+".constant))))",'invalid dynamic attribute "'+mr+'"')});var mi={isStream:vr.def(!1)},pi=new Gr;pi.state=la,Object.keys(pi).forEach(function(Gi){mi[Gi]=vr.def(""+pi[Gi])});var fi=mi.buffer,Xi=mi.type;vr("if(",Bn,"(",tr,")){",mi.isStream,"=true;",fi,"=",gi,".createStream(",Bs,",",tr,");",Xi,"=",fi,".dtype;","}else{",fi,"=",gi,".getBuffer(",tr,");","if(",fi,"){",Xi,"=",fi,".dtype;",'}else if("constant" in ',tr,"){",mi.state,"=",Na,";","if(typeof "+tr+'.constant === "number"){',mi[Aa[0]],"=",tr,".constant;",Aa.slice(1).map(function(Gi){return mi[Gi]}).join("="),"=0;","}else{",Aa.map(function(Gi,kn){return mi[Gi]+"="+tr+".constant.length>"+kn+"?"+tr+".constant["+kn+"]:0;"}).join(""),"}}else{","if(",Bn,"(",tr,".buffer)){",fi,"=",gi,".createStream(",Bs,",",tr,".buffer);","}else{",fi,"=",gi,".getBuffer(",tr,".buffer);","}",Xi,'="type" in ',tr,"?",Jr.glTypes,"[",tr,".type]:",fi,".dtype;",mi.normalized,"=!!",tr,".normalized;");function Pi(Gi){vr(mi[Gi],"=",tr,".",Gi,"|0;")}return Pi("size"),Pi("offset"),Pi("stride"),Pi("divisor"),vr("}}"),vr.exit("if(",mi.isStream,"){",gi,".destroyStream(",fi,");","}"),mi}sn[mr]=gu(pr,kr)}),sn}function Xo(qe){var Re=qe.static,yr=qe.dynamic,Xr={};return Object.keys(Re).forEach(function(sn){var mr=Re[sn];Xr[sn]=co(function(pr,kr){return typeof mr=="number"||typeof mr=="boolean"?""+mr:pr.link(mr)})}),Object.keys(yr).forEach(function(sn){var mr=yr[sn];Xr[sn]=gu(mr,function(pr,kr){return pr.invoke(kr,mr)})}),Xr}function Qs(qe,Re,yr,Xr,sn){var mr=qe.static,pr=qe.dynamic;tt.optional(function(){var Pi=[tc,Jc,Eh,kl,Cu,Sd,sp,uv,bh,lv].concat(aa);function Gi(kn){Object.keys(kn).forEach(function(Ni){tt.command(Pi.indexOf(Ni)>=0,'unknown parameter "'+Ni+'"',sn.commandStr)})}Gi(mr),Gi(pr)});var kr=Da(qe,Re),Ge=Li(qe,sn),vr=wa(qe,Ge,sn),tr=Is(qe,sn),Hr=zs(qe,sn),Jr=oo(qe,sn,kr);function Bn(Pi){var Gi=vr[Pi];Gi&&(Hr[Pi]=Gi)}Bn(Bu),Bn(oi(Qc));var gi=Object.keys(Hr).length>0,mi={framebuffer:Ge,draw:tr,shader:Jr,state:Hr,dirty:gi,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(mi.profile=Ii(qe,sn),mi.uniforms=io(yr,sn),mi.drawVAO=mi.scopeVAO=tr.vao,!mi.drawVAO&&Jr.program&&!kr&&dr.angle_instanced_arrays&&tr.static.elements){var pi=!0,fi=Jr.program.attributes.map(function(Pi){var Gi=Re.static[Pi];return pi=pi&&!!Gi,Gi});if(pi&&fi.length>0){var Xi=Jn.getVAO(Jn.createVAO({attributes:fi,elements:tr.static.elements}));mi.drawVAO=new Ro(null,null,null,function(Pi,Gi){return Pi.link(Xi)}),mi.useVAO=!0}}return kr?mi.useVAO=!0:mi.attributes=Au(Re,sn),mi.context=Xo(Xr,sn),mi}function su(qe,Re,yr){var Xr=qe.shared,sn=Xr.context,mr=qe.scope();Object.keys(yr).forEach(function(pr){Re.save(sn,"."+pr);var kr=yr[pr],Ge=kr.append(qe,Re);Array.isArray(Ge)?mr(sn,".",pr,"=[",Ge.join(),"];"):mr(sn,".",pr,"=",Ge,";")}),Re(mr)}function Tu(qe,Re,yr,Xr){var sn=qe.shared,mr=sn.gl,pr=sn.framebuffer,kr;vi&&(kr=Re.def(sn.extensions,".webgl_draw_buffers"));var Ge=qe.constants,vr=Ge.drawBuffer,tr=Ge.backBuffer,Hr;yr?Hr=yr.append(qe,Re):Hr=Re.def(pr,".next"),Xr||Re("if(",Hr,"!==",pr,".cur){"),Re("if(",Hr,"){",mr,".bindFramebuffer(",Fd,",",Hr,".framebuffer);"),vi&&Re(kr,".drawBuffersWEBGL(",vr,"[",Hr,".colorAttachments.length]);"),Re("}else{",mr,".bindFramebuffer(",Fd,",null);"),vi&&Re(kr,".drawBuffersWEBGL(",tr,");"),Re("}",pr,".cur=",Hr,";"),Xr||Re("}")}function Js(qe,Re,yr){var Xr=qe.shared,sn=Xr.gl,mr=qe.current,pr=qe.next,kr=Xr.current,Ge=Xr.next,vr=qe.cond(kr,".dirty");aa.forEach(function(tr){var Hr=oi(tr);if(!(Hr in yr.state)){var Jr,Bn;if(Hr in pr){Jr=pr[Hr],Bn=mr[Hr];var gi=fr(Qn[Hr].length,function(pi){return vr.def(Jr,"[",pi,"]")});vr(qe.cond(gi.map(function(pi,fi){return pi+"!=="+Bn+"["+fi+"]"}).join("||")).then(sn,".",An[Hr],"(",gi,");",gi.map(function(pi,fi){return Bn+"["+fi+"]="+pi}).join(";"),";"))}else{Jr=vr.def(Ge,".",Hr);var mi=qe.cond(Jr,"!==",kr,".",Hr);vr(mi),Hr in _n?mi(qe.cond(Jr).then(sn,".enable(",_n[Hr],");").else(sn,".disable(",_n[Hr],");"),kr,".",Hr,"=",Jr,";"):mi(sn,".",An[Hr],"(",Jr,");",kr,".",Hr,"=",Jr,";")}}}),Object.keys(yr.state).length===0&&vr(kr,".dirty=false;"),Re(vr)}function zu(qe,Re,yr,Xr){var sn=qe.shared,mr=qe.current,pr=sn.current,kr=sn.gl;Dd(Object.keys(yr)).forEach(function(Ge){var vr=yr[Ge];if(!(Xr&&!Xr(vr))){var tr=vr.append(qe,Re);if(_n[Ge]){var Hr=_n[Ge];kf(vr)?tr?Re(kr,".enable(",Hr,");"):Re(kr,".disable(",Hr,");"):Re(qe.cond(tr).then(kr,".enable(",Hr,");").else(kr,".disable(",Hr,");")),Re(pr,".",Ge,"=",tr,";")}else if(ir(tr)){var Jr=mr[Ge];Re(kr,".",An[Ge],"(",tr,");",tr.map(function(Bn,gi){return Jr+"["+gi+"]="+Bn}).join(";"),";")}else Re(kr,".",An[Ge],"(",tr,");",pr,".",Ge,"=",tr,";")}})}function Jo(qe,Re){Xn&&(qe.instancing=Re.def(qe.shared.extensions,".angle_instanced_arrays"))}function La(qe,Re,yr,Xr,sn){var mr=qe.shared,pr=qe.stats,kr=mr.current,Ge=mr.timer,vr=yr.profile;function tr(){var Pi=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;return Pi||typeof performance=="undefined"?"Date.now()":"performance.now()"}var Hr,Jr;function Bn(Pi){Hr=Re.def(),Pi(Hr,"=",tr(),";"),typeof sn=="string"?Pi(pr,".count+=",sn,";"):Pi(pr,".count++;"),qn&&(Xr?(Jr=Re.def(),Pi(Jr,"=",Ge,".getNumPendingQueries();")):Pi(Ge,".beginQuery(",pr,");"))}function gi(Pi){Pi(pr,".cpuTime+=",tr(),"-",Hr,";"),qn&&(Xr?Pi(Ge,".pushScopeStats(",Jr,",",Ge,".getNumPendingQueries(),",pr,");"):Pi(Ge,".endQuery();"))}function mi(Pi){var Gi=Re.def(kr,".profile");Re(kr,".profile=",Pi,";"),Re.exit(kr,".profile=",Gi,";")}var pi;if(vr){if(kf(vr)){vr.enable?(Bn(Re),gi(Re.exit),mi("true")):mi("false");return}pi=vr.append(qe,Re),mi(pi)}else pi=Re.def(kr,".profile");var fi=qe.block();Bn(fi),Re("if(",pi,"){",fi,"}");var Xi=qe.block();gi(Xi),Re.exit("if(",pi,"){",Xi,"}")}function tu(qe,Re,yr,Xr,sn){var mr=qe.shared;function pr(Ge){switch(Ge){case Md:case Gp:case vv:return 2;case Kf:case Qf:case nf:return 3;case up:case dv:case Hp:return 4;default:return 1}}function kr(Ge,vr,tr){var Hr=mr.gl,Jr=Re.def(Ge,".location"),Bn=Re.def(mr.attributes,"[",Jr,"]"),gi=tr.state,mi=tr.buffer,pi=[tr.x,tr.y,tr.z,tr.w],fi=["buffer","normalized","offset","stride"];function Xi(){Re("if(!",Bn,".buffer){",Hr,".enableVertexAttribArray(",Jr,");}");var Gi=tr.type,kn;if(tr.size?kn=Re.def(tr.size,"||",vr):kn=vr,Re("if(",Bn,".type!==",Gi,"||",Bn,".size!==",kn,"||",fi.map(function(Ea){return Bn+"."+Ea+"!=="+tr[Ea]}).join("||"),"){",Hr,".bindBuffer(",Bs,",",mi,".buffer);",Hr,".vertexAttribPointer(",[Jr,kn,Gi,tr.normalized,tr.stride,tr.offset],");",Bn,".type=",Gi,";",Bn,".size=",kn,";",fi.map(function(Ea){return Bn+"."+Ea+"="+tr[Ea]+";"}).join(""),"}"),Xn){var Ni=tr.divisor;Re("if(",Bn,".divisor!==",Ni,"){",qe.instancing,".vertexAttribDivisorANGLE(",[Jr,Ni],");",Bn,".divisor=",Ni,";}")}}function Pi(){Re("if(",Bn,".buffer){",Hr,".disableVertexAttribArray(",Jr,");",Bn,".buffer=null;","}if(",Aa.map(function(Gi,kn){return Bn+"."+Gi+"!=="+pi[kn]}).join("||"),"){",Hr,".vertexAttrib4f(",Jr,",",pi,");",Aa.map(function(Gi,kn){return Bn+"."+Gi+"="+pi[kn]+";"}).join(""),"}")}gi===la?Xi():gi===Na?Pi():(Re("if(",gi,"===",la,"){"),Xi(),Re("}else{"),Pi(),Re("}"))}Xr.forEach(function(Ge){var vr=Ge.name,tr=yr.attributes[vr],Hr;if(tr){if(!sn(tr))return;Hr=tr.append(qe,Re)}else{if(!sn(W0))return;var Jr=qe.scopeAttrib(vr);tt.optional(function(){qe.assert(Re,Jr+".state","missing attribute "+vr)}),Hr={},Object.keys(new Gr).forEach(function(Bn){Hr[Bn]=Re.def(Jr,".",Bn)})}kr(qe.link(Ge),pr(Ge.info.type),Hr)})}function fo(qe,Re,yr,Xr,sn,mr){for(var pr=qe.shared,kr=pr.gl,Ge,vr=0;vr<Xr.length;++vr){var tr=Xr[vr],Hr=tr.name,Jr=tr.info.type,Bn=yr.uniforms[Hr],gi=qe.link(tr),mi=gi+".location",pi;if(Bn){if(!sn(Bn))continue;if(kf(Bn)){var fi=Bn.value;if(tt.command(fi!==null&&typeof fi!="undefined",'missing uniform "'+Hr+'"',qe.commandStr),Jr===Pd||Jr===jp){tt.command(typeof fi=="function"&&(Jr===Pd&&(fi._reglType==="texture2d"||fi._reglType==="framebuffer")||Jr===jp&&(fi._reglType==="textureCube"||fi._reglType==="framebufferCube")),"invalid texture for uniform "+Hr,qe.commandStr);var Xi=qe.link(fi._texture||fi.color[0]._texture);Re(kr,".uniform1i(",mi,",",Xi+".bind());"),Re.exit(Xi,".unbind();")}else if(Jr===Ul||Jr===kd||Jr===Ld){tt.optional(function(){tt.command(ir(fi),"invalid matrix for uniform "+Hr,qe.commandStr),tt.command(Jr===Ul&&fi.length===4||Jr===kd&&fi.length===9||Jr===Ld&&fi.length===16,"invalid length for matrix uniform "+Hr,qe.commandStr)});var Pi=qe.global.def("new Float32Array(["+Array.prototype.slice.call(fi)+"])"),Gi=2;Jr===kd?Gi=3:Jr===Ld&&(Gi=4),Re(kr,".uniformMatrix",Gi,"fv(",mi,",false,",Pi,");")}else{switch(Jr){case pv:tt.commandType(fi,"number","uniform "+Hr,qe.commandStr),Ge="1f";break;case Md:tt.command(ir(fi)&&fi.length===2,"uniform "+Hr,qe.commandStr),Ge="2f";break;case Kf:tt.command(ir(fi)&&fi.length===3,"uniform "+Hr,qe.commandStr),Ge="3f";break;case up:tt.command(ir(fi)&&fi.length===4,"uniform "+Hr,qe.commandStr),Ge="4f";break;case rf:tt.commandType(fi,"boolean","uniform "+Hr,qe.commandStr),Ge="1i";break;case Id:tt.commandType(fi,"number","uniform "+Hr,qe.commandStr),Ge="1i";break;case vv:tt.command(ir(fi)&&fi.length===2,"uniform "+Hr,qe.commandStr),Ge="2i";break;case Gp:tt.command(ir(fi)&&fi.length===2,"uniform "+Hr,qe.commandStr),Ge="2i";break;case nf:tt.command(ir(fi)&&fi.length===3,"uniform "+Hr,qe.commandStr),Ge="3i";break;case Qf:tt.command(ir(fi)&&fi.length===3,"uniform "+Hr,qe.commandStr),Ge="3i";break;case Hp:tt.command(ir(fi)&&fi.length===4,"uniform "+Hr,qe.commandStr),Ge="4i";break;case dv:tt.command(ir(fi)&&fi.length===4,"uniform "+Hr,qe.commandStr),Ge="4i";break}Re(kr,".uniform",Ge,"(",mi,",",ir(fi)?Array.prototype.slice.call(fi):fi,");")}continue}else pi=Bn.append(qe,Re)}else{if(!sn(W0))continue;pi=Re.def(pr.uniforms,"[",Ze.id(Hr),"]")}Jr===Pd?(tt(!Array.isArray(pi),"must specify a scalar prop for textures"),Re("if(",pi,"&&",pi,'._reglType==="framebuffer"){',pi,"=",pi,".color[0];","}")):Jr===jp&&(tt(!Array.isArray(pi),"must specify a scalar prop for cube maps"),Re("if(",pi,"&&",pi,'._reglType==="framebufferCube"){',pi,"=",pi,".color[0];","}")),tt.optional(function(){function Al(Ll,rh){qe.assert(Re,Ll,'bad data or missing for uniform "'+Hr+'".  '+rh)}function lf(Ll){tt(!Array.isArray(pi),"must not specify an array type for uniform"),Al("typeof "+pi+'==="'+Ll+'"',"invalid type, expected "+Ll)}function Zl(Ll,rh){Array.isArray(pi)?tt(pi.length===Ll,"must have length "+Ll):Al(pr.isArrayLike+"("+pi+")&&"+pi+".length==="+Ll,"invalid vector, should have length "+Ll,qe.commandStr)}function Y0(Ll){tt(!Array.isArray(pi),"must not specify a value type"),Al("typeof "+pi+'==="function"&&'+pi+'._reglType==="texture'+(Ll===Cl?"2d":"Cube")+'"',"invalid texture type",qe.commandStr)}switch(Jr){case Id:lf("number");break;case Gp:Zl(2,"number");break;case Qf:Zl(3,"number");break;case dv:Zl(4,"number");break;case pv:lf("number");break;case Md:Zl(2,"number");break;case Kf:Zl(3,"number");break;case up:Zl(4,"number");break;case rf:lf("boolean");break;case vv:Zl(2,"boolean");break;case nf:Zl(3,"boolean");break;case Hp:Zl(4,"boolean");break;case Ul:Zl(4,"number");break;case kd:Zl(9,"number");break;case Ld:Zl(16,"number");break;case Pd:Y0(Cl);break;case jp:Y0(Pc);break}});var kn=1;switch(Jr){case Pd:case jp:var Ni=Re.def(pi,"._texture");Re(kr,".uniform1i(",mi,",",Ni,".bind());"),Re.exit(Ni,".unbind();");continue;case Id:case rf:Ge="1i";break;case Gp:case vv:Ge="2i",kn=2;break;case Qf:case nf:Ge="3i",kn=3;break;case dv:case Hp:Ge="4i",kn=4;break;case pv:Ge="1f";break;case Md:Ge="2f",kn=2;break;case Kf:Ge="3f",kn=3;break;case up:Ge="4f",kn=4;break;case Ul:Ge="Matrix2fv";break;case kd:Ge="Matrix3fv";break;case Ld:Ge="Matrix4fv";break}if(Ge.charAt(0)==="M"){Re(kr,".uniform",Ge,"(",mi,",");var Ea=Math.pow(Jr-Ul+2,2),jo=qe.global.def("new Float32Array(",Ea,")");Array.isArray(pi)?Re("false,(",fr(Ea,function(Al){return jo+"["+Al+"]="+pi[Al]}),",",jo,")"):Re("false,(Array.isArray(",pi,")||",pi," instanceof Float32Array)?",pi,":(",fr(Ea,function(Al){return jo+"["+Al+"]="+pi+"["+Al+"]"}),",",jo,")"),Re(");")}else if(kn>1){for(var Iu=[],_a=[],mo=0;mo<kn;++mo)Array.isArray(pi)?_a.push(pi[mo]):_a.push(Re.def(pi+"["+mo+"]")),mr&&Iu.push(Re.def());mr&&Re("if(!",qe.batchId,"||",Iu.map(function(Al,lf){return Al+"!=="+_a[lf]}).join("||"),"){",Iu.map(function(Al,lf){return Al+"="+_a[lf]+";"}).join("")),Re(kr,".uniform",Ge,"(",mi,",",_a.join(","),");"),mr&&Re("}")}else{if(tt(!Array.isArray(pi),"uniform value must not be an array"),mr){var Oc=Re.def();Re("if(!",qe.batchId,"||",Oc,"!==",pi,"){",Oc,"=",pi,";")}Re(kr,".uniform",Ge,"(",mi,",",pi,");"),mr&&Re("}")}}}function Mu(qe,Re,yr,Xr){var sn=qe.shared,mr=sn.gl,pr=sn.draw,kr=Xr.draw;function Ge(){var kn=kr.elements,Ni,Ea=Re;return kn?((kn.contextDep&&Xr.contextDynamic||kn.propDep)&&(Ea=yr),Ni=kn.append(qe,Ea),kr.elementsActive&&Ea("if("+Ni+")"+mr+".bindBuffer("+Mf+","+Ni+".buffer.buffer);")):(Ni=Ea.def(),Ea(Ni,"=",pr,".",kl,";","if(",Ni,"){",mr,".bindBuffer(",Mf,",",Ni,".buffer.buffer);}","else if(",sn.vao,".currentVAO){",Ni,"=",qe.shared.elements+".getElements("+sn.vao,".currentVAO.elements);",Rn?"":"if("+Ni+")"+mr+".bindBuffer("+Mf+","+Ni+".buffer.buffer);","}")),Ni}function vr(){var kn=kr.count,Ni,Ea=Re;return kn?((kn.contextDep&&Xr.contextDynamic||kn.propDep)&&(Ea=yr),Ni=kn.append(qe,Ea),tt.optional(function(){kn.MISSING&&qe.assert(Re,"false","missing vertex count"),kn.DYNAMIC&&qe.assert(Ea,Ni+">=0","missing vertex count")})):(Ni=Ea.def(pr,".",sp),tt.optional(function(){qe.assert(Ea,Ni+">=0","missing vertex count")})),Ni}var tr=Ge();function Hr(kn){var Ni=kr[kn];return Ni?Ni.contextDep&&Xr.contextDynamic||Ni.propDep?Ni.append(qe,yr):Ni.append(qe,Re):Re.def(pr,".",kn)}var Jr=Hr(Cu),Bn=Hr(Sd),gi=vr();if(typeof gi=="number"){if(gi===0)return}else yr("if(",gi,"){"),yr.exit("}");var mi,pi;Xn&&(mi=Hr(uv),pi=qe.instancing);var fi=tr+".type",Xi=kr.elements&&kf(kr.elements)&&!kr.vaoActive;function Pi(){function kn(){yr(pi,".drawElementsInstancedANGLE(",[Jr,gi,fi,Bn+"<<(("+fi+"-"+ka+")>>1)",mi],");")}function Ni(){yr(pi,".drawArraysInstancedANGLE(",[Jr,Bn,gi,mi],");")}tr&&tr!=="null"?Xi?kn():(yr("if(",tr,"){"),kn(),yr("}else{"),Ni(),yr("}")):Ni()}function Gi(){function kn(){yr(mr+".drawElements("+[Jr,gi,fi,Bn+"<<(("+fi+"-"+ka+")>>1)"]+");")}function Ni(){yr(mr+".drawArrays("+[Jr,Bn,gi]+");")}tr&&tr!=="null"?Xi?kn():(yr("if(",tr,"){"),kn(),yr("}else{"),Ni(),yr("}")):Ni()}Xn&&(typeof mi!="number"||mi>=0)?typeof mi=="string"?(yr("if(",mi,">0){"),Pi(),yr("}else if(",mi,"<0){"),Gi(),yr("}")):Pi():Gi()}function ya(qe,Re,yr,Xr,sn){var mr=Yn(),pr=mr.proc("body",sn);return tt.optional(function(){mr.commandStr=Re.commandStr,mr.command=mr.link(Re.commandStr)}),Xn&&(mr.instancing=pr.def(mr.shared.extensions,".angle_instanced_arrays")),qe(mr,pr,yr,Xr),mr.compile().body}function eo(qe,Re,yr,Xr){Jo(qe,Re),yr.useVAO?yr.drawVAO?Re(qe.shared.vao,".setVAO(",yr.drawVAO.append(qe,Re),");"):Re(qe.shared.vao,".setVAO(",qe.shared.vao,".targetVAO);"):(Re(qe.shared.vao,".setVAO(null);"),tu(qe,Re,yr,Xr.attributes,function(){return!0})),fo(qe,Re,yr,Xr.uniforms,function(){return!0},!1),Mu(qe,Re,Re,yr)}function Eo(qe,Re){var yr=qe.proc("draw",1);Jo(qe,yr),su(qe,yr,Re.context),Tu(qe,yr,Re.framebuffer),Js(qe,yr,Re),zu(qe,yr,Re.state),La(qe,yr,Re,!1,!0);var Xr=Re.shader.progVar.append(qe,yr);if(yr(qe.shared.gl,".useProgram(",Xr,".program);"),Re.shader.program)eo(qe,yr,Re,Re.shader.program);else{yr(qe.shared.vao,".setVAO(null);");var sn=qe.global.def("{}"),mr=yr.def(Xr,".id"),pr=yr.def(sn,"[",mr,"]");yr(qe.cond(pr).then(pr,".call(this,a0);").else(pr,"=",sn,"[",mr,"]=",qe.link(function(kr){return ya(eo,qe,Re,kr,1)}),"(",Xr,");",pr,".call(this,a0);"))}Object.keys(Re.state).length>0&&yr(qe.shared.current,".dirty=true;"),qe.shared.vao&&yr(qe.shared.vao,".setVAO(null);")}function wo(qe,Re,yr,Xr){qe.batchId="a1",Jo(qe,Re);function sn(){return!0}tu(qe,Re,yr,Xr.attributes,sn),fo(qe,Re,yr,Xr.uniforms,sn,!1),Mu(qe,Re,Re,yr)}function Po(qe,Re,yr,Xr){Jo(qe,Re);var sn=yr.contextDep,mr=Re.def(),pr="a0",kr="a1",Ge=Re.def();qe.shared.props=Ge,qe.batchId=mr;var vr=qe.scope(),tr=qe.scope();Re(vr.entry,"for(",mr,"=0;",mr,"<",kr,";++",mr,"){",Ge,"=",pr,"[",mr,"];",tr,"}",vr.exit);function Hr(fi){return fi.contextDep&&sn||fi.propDep}function Jr(fi){return!Hr(fi)}if(yr.needsContext&&su(qe,tr,yr.context),yr.needsFramebuffer&&Tu(qe,tr,yr.framebuffer),zu(qe,tr,yr.state,Hr),yr.profile&&Hr(yr.profile)&&La(qe,tr,yr,!1,!0),Xr)yr.useVAO?yr.drawVAO?Hr(yr.drawVAO)?tr(qe.shared.vao,".setVAO(",yr.drawVAO.append(qe,tr),");"):vr(qe.shared.vao,".setVAO(",yr.drawVAO.append(qe,vr),");"):vr(qe.shared.vao,".setVAO(",qe.shared.vao,".targetVAO);"):(vr(qe.shared.vao,".setVAO(null);"),tu(qe,vr,yr,Xr.attributes,Jr),tu(qe,tr,yr,Xr.attributes,Hr)),fo(qe,vr,yr,Xr.uniforms,Jr,!1),fo(qe,tr,yr,Xr.uniforms,Hr,!0),Mu(qe,vr,tr,yr);else{var Bn=qe.global.def("{}"),gi=yr.shader.progVar.append(qe,tr),mi=tr.def(gi,".id"),pi=tr.def(Bn,"[",mi,"]");tr(qe.shared.gl,".useProgram(",gi,".program);","if(!",pi,"){",pi,"=",Bn,"[",mi,"]=",qe.link(function(fi){return ya(wo,qe,yr,fi,2)}),"(",gi,");}",pi,".call(this,a0[",mr,"],",mr,");")}}function Je(qe,Re){var yr=qe.proc("batch",2);qe.batchId="0",Jo(qe,yr);var Xr=!1,sn=!0;Object.keys(Re.context).forEach(function(Bn){Xr=Xr||Re.context[Bn].propDep}),Xr||(su(qe,yr,Re.context),sn=!1);var mr=Re.framebuffer,pr=!1;mr?(mr.propDep?Xr=pr=!0:mr.contextDep&&Xr&&(pr=!0),pr||Tu(qe,yr,mr)):Tu(qe,yr,null),Re.state.viewport&&Re.state.viewport.propDep&&(Xr=!0);function kr(Bn){return Bn.contextDep&&Xr||Bn.propDep}Js(qe,yr,Re),zu(qe,yr,Re.state,function(Bn){return!kr(Bn)}),(!Re.profile||!kr(Re.profile))&&La(qe,yr,Re,!1,"a1"),Re.contextDep=Xr,Re.needsContext=sn,Re.needsFramebuffer=pr;var Ge=Re.shader.progVar;if(Ge.contextDep&&Xr||Ge.propDep)Po(qe,yr,Re,null);else{var vr=Ge.append(qe,yr);if(yr(qe.shared.gl,".useProgram(",vr,".program);"),Re.shader.program)Po(qe,yr,Re,Re.shader.program);else{yr(qe.shared.vao,".setVAO(null);");var tr=qe.global.def("{}"),Hr=yr.def(vr,".id"),Jr=yr.def(tr,"[",Hr,"]");yr(qe.cond(Jr).then(Jr,".call(this,a0,a1);").else(Jr,"=",tr,"[",Hr,"]=",qe.link(function(Bn){return ya(Po,qe,Re,Bn,2)}),"(",vr,");",Jr,".call(this,a0,a1);"))}}Object.keys(Re.state).length>0&&yr(qe.shared.current,".dirty=true;"),qe.shared.vao&&yr(qe.shared.vao,".setVAO(null);")}function an(qe,Re){var yr=qe.proc("scope",3);qe.batchId="a2";var Xr=qe.shared,sn=Xr.current;su(qe,yr,Re.context),Re.framebuffer&&Re.framebuffer.append(qe,yr),Dd(Object.keys(Re.state)).forEach(function(pr){var kr=Re.state[pr],Ge=kr.append(qe,yr);ir(Ge)?Ge.forEach(function(vr,tr){yr.set(qe.next[pr],"["+tr+"]",vr)}):yr.set(Xr.next,"."+pr,Ge)}),La(qe,yr,Re,!0,!0),[kl,Sd,sp,uv,Cu].forEach(function(pr){var kr=Re.draw[pr];!kr||yr.set(Xr.draw,"."+pr,""+kr.append(qe,yr))}),Object.keys(Re.uniforms).forEach(function(pr){var kr=Re.uniforms[pr].append(qe,yr);Array.isArray(kr)&&(kr="["+kr.join()+"]"),yr.set(Xr.uniforms,"["+Ze.id(pr)+"]",kr)}),Object.keys(Re.attributes).forEach(function(pr){var kr=Re.attributes[pr].append(qe,yr),Ge=qe.scopeAttrib(pr);Object.keys(new Gr).forEach(function(vr){yr.set(Ge,"."+vr,kr[vr])})}),Re.scopeVAO&&yr.set(Xr.vao,".targetVAO",Re.scopeVAO.append(qe,yr));function mr(pr){var kr=Re.shader[pr];kr&&yr.set(Xr.shader,"."+pr,kr.append(qe,yr))}mr(Jc),mr(Eh),Object.keys(Re.state).length>0&&(yr(sn,".dirty=true;"),yr.exit(sn,".dirty=true;")),yr("a1(",qe.shared.context,",a0,",qe.batchId,");")}function en(qe){if(!(typeof qe!="object"||ir(qe))){for(var Re=Object.keys(qe),yr=0;yr<Re.length;++yr)if(Zr.isDynamic(qe[Re[yr]]))return!0;return!1}}function Ri(qe,Re,yr){var Xr=Re.static[yr];if(!Xr||!en(Xr))return;var sn=qe.global,mr=Object.keys(Xr),pr=!1,kr=!1,Ge=!1,vr=qe.global.def("{}");mr.forEach(function(Hr){var Jr=Xr[Hr];if(Zr.isDynamic(Jr)){typeof Jr=="function"&&(Jr=Xr[Hr]=Zr.unbox(Jr));var Bn=gu(Jr,null);pr=pr||Bn.thisDep,Ge=Ge||Bn.propDep,kr=kr||Bn.contextDep}else{switch(sn(vr,".",Hr,"="),typeof Jr){case"number":sn(Jr);break;case"string":sn('"',Jr,'"');break;case"object":Array.isArray(Jr)&&sn("[",Jr.join(),"]");break;default:sn(qe.link(Jr));break}sn(";")}});function tr(Hr,Jr){mr.forEach(function(Bn){var gi=Xr[Bn];if(!!Zr.isDynamic(gi)){var mi=Hr.invoke(Jr,gi);Jr(vr,".",Bn,"=",mi,";")}})}Re.dynamic[yr]=new Zr.DynamicVariable(ou,{thisDep:pr,contextDep:kr,propDep:Ge,ref:vr,append:tr}),delete Re.static[yr]}function so(qe,Re,yr,Xr,sn){var mr=Yn();mr.stats=mr.link(sn),Object.keys(Re.static).forEach(function(kr){Ri(mr,Re,kr)}),Gm.forEach(function(kr){Ri(mr,qe,kr)});var pr=Qs(qe,Re,yr,Xr,mr);return Eo(mr,pr),an(mr,pr),Je(mr,pr),I(mr.compile(),{destroy:function(){pr.shader.program.destroy()}})}return{next:Ti,current:Qn,procs:function(){var qe=Yn(),Re=qe.proc("poll"),yr=qe.proc("refresh"),Xr=qe.block();Re(Xr),yr(Xr);var sn=qe.shared,mr=sn.gl,pr=sn.next,kr=sn.current;Xr(kr,".dirty=false;"),Tu(qe,Re),Tu(qe,yr,null,!0);var Ge;Xn&&(Ge=qe.link(Xn)),dr.oes_vertex_array_object&&yr(qe.link(dr.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var vr=0;vr<cn.maxAttributes;++vr){var tr=yr.def(sn.attributes,"[",vr,"]"),Hr=qe.cond(tr,".buffer");Hr.then(mr,".enableVertexAttribArray(",vr,");",mr,".bindBuffer(",Bs,",",tr,".buffer.buffer);",mr,".vertexAttribPointer(",vr,",",tr,".size,",tr,".type,",tr,".normalized,",tr,".stride,",tr,".offset);").else(mr,".disableVertexAttribArray(",vr,");",mr,".vertexAttrib4f(",vr,",",tr,".x,",tr,".y,",tr,".z,",tr,".w);",tr,".buffer=null;"),yr(Hr),Xn&&yr(Ge,".vertexAttribDivisorANGLE(",vr,",",tr,".divisor);")}return yr(qe.shared.vao,".currentVAO=null;",qe.shared.vao,".setVAO(",qe.shared.vao,".targetVAO);"),Object.keys(_n).forEach(function(Jr){var Bn=_n[Jr],gi=Xr.def(pr,".",Jr),mi=qe.block();mi("if(",gi,"){",mr,".enable(",Bn,")}else{",mr,".disable(",Bn,")}",kr,".",Jr,"=",gi,";"),yr(mi),Re("if(",gi,"!==",kr,".",Jr,"){",mi,"}")}),Object.keys(An).forEach(function(Jr){var Bn=An[Jr],gi=Qn[Jr],mi,pi,fi=qe.block();if(fi(mr,".",Bn,"("),ir(gi)){var Xi=gi.length;mi=qe.global.def(pr,".",Jr),pi=qe.global.def(kr,".",Jr),fi(fr(Xi,function(Pi){return mi+"["+Pi+"]"}),");",fr(Xi,function(Pi){return pi+"["+Pi+"]="+mi+"["+Pi+"];"}).join("")),Re("if(",fr(Xi,function(Pi){return mi+"["+Pi+"]!=="+pi+"["+Pi+"]"}).join("||"),"){",fi,"}")}else mi=Xr.def(pr,".",Jr),pi=Xr.def(kr,".",Jr),fi(mi,");",kr,".",Jr,"=",mi,";"),Re("if(",mi,"!==",pi,"){",fi,"}");yr(fi)}),qe.compile()}(),compile:so}}function Bd(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var X0=34918,Yp=34919,n0=35007,ic=function(kt,Ze){if(!Ze.ext_disjoint_timer_query)return null;var dr=[];function cn(){return dr.pop()||Ze.ext_disjoint_timer_query.createQueryEXT()}function On(Xn){dr.push(Xn)}var on=[];function En(Xn){var vi=cn();Ze.ext_disjoint_timer_query.beginQueryEXT(n0,vi),on.push(vi),qn(on.length-1,on.length,Xn)}function Dn(){Ze.ext_disjoint_timer_query.endQueryEXT(n0)}function Hn(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Jn=[];function ii(){return Jn.pop()||new Hn}function ui(Xn){Jn.push(Xn)}var yi=[];function qn(Xn,vi,Rn){var Qn=ii();Qn.startQueryIndex=Xn,Qn.endQueryIndex=vi,Qn.sum=0,Qn.stats=Rn,yi.push(Qn)}var ri=[],Gr=[];function dn(){var Xn,vi,Rn=on.length;if(Rn!==0){Gr.length=Math.max(Gr.length,Rn+1),ri.length=Math.max(ri.length,Rn+1),ri[0]=0,Gr[0]=0;var Qn=0;for(Xn=0,vi=0;vi<on.length;++vi){var Ti=on[vi];Ze.ext_disjoint_timer_query.getQueryObjectEXT(Ti,Yp)?(Qn+=Ze.ext_disjoint_timer_query.getQueryObjectEXT(Ti,X0),On(Ti)):on[Xn++]=Ti,ri[vi+1]=Qn,Gr[vi+1]=Xn}for(on.length=Xn,Xn=0,vi=0;vi<yi.length;++vi){var aa=yi[vi],_n=aa.startQueryIndex,An=aa.endQueryIndex;aa.sum+=ri[An]-ri[_n];var oi=Gr[_n],Ei=Gr[An];Ei===oi?(aa.stats.gpuTime+=aa.sum/1e6,ui(aa)):(aa.startQueryIndex=oi,aa.endQueryIndex=Ei,yi[Xn++]=aa)}yi.length=Xn}}return{beginQuery:En,endQuery:Dn,pushScopeStats:qn,update:dn,getNumPendingQueries:function(){return on.length},clear:function(){dr.push.apply(dr,on);for(var Xn=0;Xn<dr.length;Xn++)Ze.ext_disjoint_timer_query.deleteQueryEXT(dr[Xn]);on.length=0,dr.length=0},restore:function(){on.length=0,dr.length=0}}},Th=16384,Nu=256,Ug=1024,Jf=34962,th="webglcontextlost",Qo="webglcontextrestored",$p=1,eh=2,uf=3;function qp(kt,Ze){for(var dr=0;dr<kt.length;++dr)if(kt[dr]===Ze)return dr;return-1}function Hm(kt){var Ze=Ce(kt);if(!Ze)return null;var dr=Ze.gl,cn=dr.getContextAttributes(),On=dr.isContextLost(),on=Ue(dr,Ze);if(!on)return null;var En=zn(),Dn=Bd(),Hn=on.extensions,Jn=ic(dr,Hn),ii=Nn(),ui=dr.drawingBufferWidth,yi=dr.drawingBufferHeight,qn={tick:0,time:0,viewportWidth:ui,viewportHeight:yi,framebufferWidth:ui,framebufferHeight:yi,drawingBufferWidth:ui,drawingBufferHeight:yi,pixelRatio:Ze.pixelRatio},ri={},Gr={elements:null,primitive:4,count:-1,offset:0,instances:-1},dn=mf(dr,Hn),Xn=bt(dr,Dn,Ze,Qn),vi=iu(dr,Hn,Xn,Dn),Rn=Rr(dr,Hn,dn,Dn,Xn,vi,Gr);function Qn(ya){return Rn.destroyBuffer(ya)}var Ti=Kn(dr,En,Dn,Ze),aa=Su(dr,Hn,dn,function(){oi.procs.poll()},qn,Dn,Ze),_n=Wc(dr,Hn,dn,Dn,Ze),An=cr(dr,Hn,dn,aa,_n,Dn),oi=Xp(dr,En,Hn,dn,Xn,vi,aa,An,ri,Rn,Ti,Gr,qn,Jn,Ze),Ei=ua(dr,An,oi.procs.poll,qn,cn,Hn,dn),ti=oi.next,xi=dr.canvas,Mi=[],Ua=[],Yn=[],Ii=[Ze.onDestroy],Li=null;function wa(){if(Mi.length===0){Jn&&Jn.update(),Li=null;return}Li=Tn.next(wa),Jo();for(var ya=Mi.length-1;ya>=0;--ya){var eo=Mi[ya];eo&&eo(qn,null,0)}dr.flush(),Jn&&Jn.update()}function Da(){!Li&&Mi.length>0&&(Li=Tn.next(wa))}function oo(){Li&&(Tn.cancel(wa),Li=null)}function Is(ya){ya.preventDefault(),On=!0,oo(),Ua.forEach(function(eo){eo()})}function zs(ya){dr.getError(),On=!1,on.restore(),Ti.restore(),Xn.restore(),aa.restore(),_n.restore(),An.restore(),Rn.restore(),Jn&&Jn.restore(),oi.procs.refresh(),Da(),Yn.forEach(function(eo){eo()})}var io=typeof my!="undefined"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0;!io&&xi&&(xi.addEventListener(th,Is,!1),xi.addEventListener(Qo,zs,!1));function Au(){Mi.length=0,oo(),!io&&xi&&(xi.removeEventListener(th,Is),xi.removeEventListener(Qo,zs)),Ti.clear(),An.clear(),_n.clear(),Rn.clear(),aa.clear(),vi.clear(),Xn.clear(),Jn&&Jn.clear(),Ii.forEach(function(ya){ya()})}function Xo(ya){tt(!!ya,"invalid args to regl({...})"),tt.type(ya,"object","invalid args to regl({...})");function eo(mr){var pr=I({},mr);delete pr.uniforms,delete pr.attributes,delete pr.context,delete pr.vao,"stencil"in pr&&pr.stencil.op&&(pr.stencil.opBack=pr.stencil.opFront=pr.stencil.op,delete pr.stencil.op);function kr(Ge){if(Ge in pr){var vr=pr[Ge];delete pr[Ge],Object.keys(vr).forEach(function(tr){pr[Ge+"."+tr]=vr[tr]})}}return kr("blend"),kr("depth"),kr("cull"),kr("stencil"),kr("polygonOffset"),kr("scissor"),kr("sample"),"vao"in mr&&(pr.vao=mr.vao),pr}function Eo(mr,pr){var kr={},Ge={};return Object.keys(mr).forEach(function(vr){var tr=mr[vr];if(Zr.isDynamic(tr)){Ge[vr]=Zr.unbox(tr,vr);return}else if(pr&&Array.isArray(tr)){for(var Hr=0;Hr<tr.length;++Hr)if(Zr.isDynamic(tr[Hr])){Ge[vr]=Zr.unbox(tr,vr);return}}kr[vr]=tr}),{dynamic:Ge,static:kr}}var wo=Eo(ya.context||{},!0),Po=Eo(ya.uniforms||{},!0),Je=Eo(ya.attributes||{},!1),an=Eo(eo(ya),!1),en={gpuTime:0,cpuTime:0,count:0},Ri=oi.compile(an,Je,Po,wo,en),so=Ri.draw,qe=Ri.batch,Re=Ri.scope,yr=[];function Xr(mr){for(;yr.length<mr;)yr.push(null);return yr}function sn(mr,pr){var kr;if(On&&tt.raise("context lost"),typeof mr=="function")return Re.call(this,null,mr,0);if(typeof pr=="function")if(typeof mr=="number")for(kr=0;kr<mr;++kr)Re.call(this,null,pr,kr);else if(Array.isArray(mr))for(kr=0;kr<mr.length;++kr)Re.call(this,mr[kr],pr,kr);else return Re.call(this,mr,pr,0);else if(typeof mr=="number"){if(mr>0)return qe.call(this,Xr(mr|0),mr|0)}else if(Array.isArray(mr)){if(mr.length)return qe.call(this,mr,mr.length)}else return so.call(this,mr)}return I(sn,{stats:en,destroy:function(){Ri.destroy()}})}var Qs=An.setFBO=Xo({framebuffer:Zr.define.call(null,$p,"framebuffer")});function su(ya,eo){var Eo=0;oi.procs.poll();var wo=eo.color;wo&&(dr.clearColor(+wo[0]||0,+wo[1]||0,+wo[2]||0,+wo[3]||0),Eo|=Th),"depth"in eo&&(dr.clearDepth(+eo.depth),Eo|=Nu),"stencil"in eo&&(dr.clearStencil(eo.stencil|0),Eo|=Ug),tt(!!Eo,"called regl.clear with no buffer specified"),dr.clear(Eo)}function Tu(ya){if(tt(typeof ya=="object"&&ya,"regl.clear() takes an object as input"),"framebuffer"in ya)if(ya.framebuffer&&ya.framebuffer_reglType==="framebufferCube")for(var eo=0;eo<6;++eo)Qs(I({framebuffer:ya.framebuffer.faces[eo]},ya),su);else Qs(ya,su);else su(null,ya)}function Js(ya){tt.type(ya,"function","regl.frame() callback must be a function"),Mi.push(ya);function eo(){var Eo=qp(Mi,ya);tt(Eo>=0,"cannot cancel a frame twice");function wo(){var Po=qp(Mi,wo);Mi[Po]=Mi[Mi.length-1],Mi.length-=1,Mi.length<=0&&oo()}Mi[Eo]=wo}return Da(),{cancel:eo}}function zu(){var ya=ti.viewport,eo=ti.scissor_box;ya[0]=ya[1]=eo[0]=eo[1]=0,qn.viewportWidth=qn.framebufferWidth=qn.drawingBufferWidth=ya[2]=eo[2]=dr.drawingBufferWidth,qn.viewportHeight=qn.framebufferHeight=qn.drawingBufferHeight=ya[3]=eo[3]=dr.drawingBufferHeight}function Jo(){qn.tick+=1,qn.time=tu(),zu(),oi.procs.poll()}function La(){aa.refresh(),zu(),oi.procs.refresh(),Jn&&Jn.update()}function tu(){return(Nn()-ii)/1e3}La();function fo(ya,eo){tt.type(eo,"function","listener callback must be a function");var Eo;switch(ya){case"frame":return Js(eo);case"lost":Eo=Ua;break;case"restore":Eo=Yn;break;case"destroy":Eo=Ii;break;default:tt.raise("invalid event, must be one of frame,lost,restore,destroy")}return Eo.push(eo),{cancel:function(){for(var wo=0;wo<Eo.length;++wo)if(Eo[wo]===eo){Eo[wo]=Eo[Eo.length-1],Eo.pop();return}}}}var Mu=I(Xo,{clear:Tu,prop:Zr.define.bind(null,$p),context:Zr.define.bind(null,eh),this:Zr.define.bind(null,uf),draw:Xo({}),buffer:function(ya){return Xn.create(ya,Jf,!1,!1)},elements:function(ya){return vi.create(ya,!1)},texture:aa.create2D,cube:aa.createCube,renderbuffer:_n.create,framebuffer:An.create,framebufferCube:An.createCube,vao:Rn.createVAO,attributes:cn,frame:Js,on:fo,limits:dn,hasExtension:function(ya){return dn.extensions.indexOf(ya.toLowerCase())>=0},read:Ei,destroy:Au,_gl:dr,_refresh:La,poll:function(){Jo(),Jn&&Jn.update()},now:tu,stats:Dn});return Ze.onDone(null,Mu),Mu}return Hm})},6158:function(vn){(function(Ft,ot){vn.exports=ot()})(this,function(){"use strict";var Ft,ot,Lt;function wt(I,Et){if(!Ft)Ft=Et;else if(!ot)ot=Et;else{var q="var sharedChunk = {}; ("+Ft+")(sharedChunk); ("+ot+")(sharedChunk);",lt={};Ft(lt),Lt=Et(lt),typeof window!="undefined"&&(Lt.workerUrl=window.URL.createObjectURL(new Blob([q],{type:"text/javascript"})))}}return wt(["exports"],function(I){"use strict";function Et(f,d){return f(d={exports:{}},d.exports),d.exports}var q=lt;function lt(f,d,y,T){this.cx=3*f,this.bx=3*(y-f)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(T-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=f,this.p1y=T,this.p2x=y,this.p2y=T}lt.prototype.sampleCurveX=function(f){return((this.ax*f+this.bx)*f+this.cx)*f},lt.prototype.sampleCurveY=function(f){return((this.ay*f+this.by)*f+this.cy)*f},lt.prototype.sampleCurveDerivativeX=function(f){return(3*this.ax*f+2*this.bx)*f+this.cx},lt.prototype.solveCurveX=function(f,d){var y,T,O,N,Z;for(d===void 0&&(d=1e-6),O=f,Z=0;Z<8;Z++){if(N=this.sampleCurveX(O)-f,Math.abs(N)<d)return O;var K=this.sampleCurveDerivativeX(O);if(Math.abs(K)<1e-6)break;O-=N/K}if((O=f)<(y=0))return y;if(O>(T=1))return T;for(;y<T;){if(N=this.sampleCurveX(O),Math.abs(N-f)<d)return O;f>N?y=O:T=O,O=.5*(T-y)+y}return O},lt.prototype.solve=function(f,d){return this.sampleCurveY(this.solveCurveX(f,d))};var ht=ct;function ct(f,d){this.x=f,this.y=d}ct.prototype={clone:function(){return new ct(this.x,this.y)},add:function(f){return this.clone()._add(f)},sub:function(f){return this.clone()._sub(f)},multByPoint:function(f){return this.clone()._multByPoint(f)},divByPoint:function(f){return this.clone()._divByPoint(f)},mult:function(f){return this.clone()._mult(f)},div:function(f){return this.clone()._div(f)},rotate:function(f){return this.clone()._rotate(f)},rotateAround:function(f,d){return this.clone()._rotateAround(f,d)},matMult:function(f){return this.clone()._matMult(f)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(f){return this.x===f.x&&this.y===f.y},dist:function(f){return Math.sqrt(this.distSqr(f))},distSqr:function(f){var d=f.x-this.x,y=f.y-this.y;return d*d+y*y},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(f){return Math.atan2(this.y-f.y,this.x-f.x)},angleWith:function(f){return this.angleWithSep(f.x,f.y)},angleWithSep:function(f,d){return Math.atan2(this.x*d-this.y*f,this.x*f+this.y*d)},_matMult:function(f){var d=f[2]*this.x+f[3]*this.y;return this.x=f[0]*this.x+f[1]*this.y,this.y=d,this},_add:function(f){return this.x+=f.x,this.y+=f.y,this},_sub:function(f){return this.x-=f.x,this.y-=f.y,this},_mult:function(f){return this.x*=f,this.y*=f,this},_div:function(f){return this.x/=f,this.y/=f,this},_multByPoint:function(f){return this.x*=f.x,this.y*=f.y,this},_divByPoint:function(f){return this.x/=f.x,this.y/=f.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var f=this.y;return this.y=this.x,this.x=-f,this},_rotate:function(f){var d=Math.cos(f),y=Math.sin(f),T=y*this.x+d*this.y;return this.x=d*this.x-y*this.y,this.y=T,this},_rotateAround:function(f,d){var y=Math.cos(f),T=Math.sin(f),O=d.y+T*(this.x-d.x)+y*(this.y-d.y);return this.x=d.x+y*(this.x-d.x)-T*(this.y-d.y),this.y=O,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ct.convert=function(f){return f instanceof ct?f:Array.isArray(f)?new ct(f[0],f[1]):f};var et=typeof self!="undefined"?self:{},Ee=Math.pow(2,53)-1;function it(f,d,y,T){var O=new q(f,d,y,T);return function(N){return O.solve(N)}}var st=it(.25,.1,.25,1);function Zt(f,d,y){return Math.min(y,Math.max(d,f))}function P(f,d,y){var T=y-d,O=((f-d)%T+T)%T+d;return O===d?y:O}function b(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];for(var T=0,O=d;T<O.length;T+=1){var N=O[T];for(var Z in N)f[Z]=N[Z]}return f}var X=1;function le(){return X++}function Se(){return function f(d){return d?(d^16*Math.random()>>d/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,f)}()}function Ie(f){return!!f&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(f)}function It(f,d){f.forEach(function(y){d[y]&&(d[y]=d[y].bind(d))})}function rt(f,d){return f.indexOf(d,f.length-d.length)!==-1}function Dt(f,d,y){var T={};for(var O in f)T[O]=d.call(y||this,f[O],O,f);return T}function Ae(f,d,y){var T={};for(var O in f)d.call(y||this,f[O],O,f)&&(T[O]=f[O]);return T}function be(f){return Array.isArray(f)?f.map(be):typeof f=="object"&&f?Dt(f,be):f}var me={};function ee(f){me[f]||(typeof console!="undefined"&&console.warn(f),me[f]=!0)}function we(f,d,y){return(y.y-f.y)*(d.x-f.x)>(d.y-f.y)*(y.x-f.x)}function _e(f){for(var d=0,y=0,T=f.length,O=T-1,N=void 0,Z=void 0;y<T;O=y++)d+=((Z=f[O]).x-(N=f[y]).x)*(N.y+Z.y);return d}function gt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Pt(f){var d={};if(f.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(T,O,N,Z){var K=N||Z;return d[O]=!K||K.toLowerCase(),""}),d["max-age"]){var y=parseInt(d["max-age"],10);isNaN(y)?delete d["max-age"]:d["max-age"]=y}return d}var J=null;function vt(f){if(J==null){var d=f.navigator?f.navigator.userAgent:null;J=!!f.safari||!(!d||!(/\b(iPad|iPhone|iPod)\b/.test(d)||d.match("Safari")&&!d.match("Chrome")))}return J}function W(f){try{var d=et[f];return d.setItem("_mapbox_test_",1),d.removeItem("_mapbox_test_"),!0}catch(y){return!1}}var dt,Vt,ne,ge,$e=et.performance&&et.performance.now?et.performance.now.bind(et.performance):Date.now.bind(Date),jt=et.requestAnimationFrame||et.mozRequestAnimationFrame||et.webkitRequestAnimationFrame||et.msRequestAnimationFrame,Qt=et.cancelAnimationFrame||et.mozCancelAnimationFrame||et.webkitCancelAnimationFrame||et.msCancelAnimationFrame,Te={now:$e,frame:function(f){var d=jt(f);return{cancel:function(){return Qt(d)}}},getImageData:function(f,d){d===void 0&&(d=0);var y=et.document.createElement("canvas"),T=y.getContext("2d");if(!T)throw new Error("failed to create canvas 2d context");return y.width=f.width,y.height=f.height,T.drawImage(f,0,0,f.width,f.height),T.getImageData(-d,-d,f.width+2*d,f.height+2*d)},resolveURL:function(f){return dt||(dt=et.document.createElement("a")),dt.href=f,dt.href},hardwareConcurrency:et.navigator&&et.navigator.hardwareConcurrency||4,get devicePixelRatio(){return et.devicePixelRatio},get prefersReducedMotion(){return!!et.matchMedia&&(Vt==null&&(Vt=et.matchMedia("(prefers-reduced-motion: reduce)")),Vt.matches)}},ae={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ke={supported:!1,testSupport:function(f){!or&&ge&&(ie?te(f):ne=f)}},or=!1,ie=!1;function te(f){var d=f.createTexture();f.bindTexture(f.TEXTURE_2D,d);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,ge),f.isContextLost())return;Ke.supported=!0}catch(y){}f.deleteTexture(d),or=!0}et.document&&((ge=et.document.createElement("img")).onload=function(){ne&&te(ne),ne=null,ie=!0},ge.onerror=function(){or=!0,ne=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var St="01",qt=function(f,d){this._transformRequestFn=f,this._customAccessToken=d,this._createSkuToken()};function $t(f){return f.indexOf("mapbox:")===0}qt.prototype._createSkuToken=function(){var f=function(){for(var d="",y=0;y<10;y++)d+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",St,d].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=f.token,this._skuTokenExpiresAt=f.tokenExpiresAt},qt.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},qt.prototype.transformRequest=function(f,d){return this._transformRequestFn&&this._transformRequestFn(f,d)||{url:f}},qt.prototype.normalizeStyleURL=function(f,d){if(!$t(f))return f;var y=Oe(f);return y.path="/styles/v1"+y.path,this._makeAPIURL(y,this._customAccessToken||d)},qt.prototype.normalizeGlyphsURL=function(f,d){if(!$t(f))return f;var y=Oe(f);return y.path="/fonts/v1"+y.path,this._makeAPIURL(y,this._customAccessToken||d)},qt.prototype.normalizeSourceURL=function(f,d){if(!$t(f))return f;var y=Oe(f);return y.path="/v4/"+y.authority+".json",y.params.push("secure"),this._makeAPIURL(y,this._customAccessToken||d)},qt.prototype.normalizeSpriteURL=function(f,d,y,T){var O=Oe(f);return $t(f)?(O.path="/styles/v1"+O.path+"/sprite"+d+y,this._makeAPIURL(O,this._customAccessToken||T)):(O.path+=""+d+y,We(O))},qt.prototype.normalizeTileURL=function(f,d){if(this._isSkuTokenExpired()&&this._createSkuToken(),f&&!$t(f))return f;var y=Oe(f);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Te.devicePixelRatio>=2||d===512?"@2x":"")+(Ke.supported?".webp":"$1")),y.path=y.path.replace(/^.+\/v4\//,"/"),y.path="/v4"+y.path;var T=this._customAccessToken||function(O){for(var N=0,Z=O;N<Z.length;N+=1){var K=Z[N].match(/^access_token=(.*)$/);if(K)return K[1]}return null}(y.params)||ae.ACCESS_TOKEN;return ae.REQUIRE_ACCESS_TOKEN&&T&&this._skuToken&&y.params.push("sku="+this._skuToken),this._makeAPIURL(y,T)},qt.prototype.canonicalizeTileURL=function(f,d){var y=Oe(f);if(!y.path.match(/(^\/v4\/)/)||!y.path.match(/\.[\w]+$/))return f;var T="mapbox://tiles/";T+=y.path.replace("/v4/","");var O=y.params;return d&&(O=O.filter(function(N){return!N.match(/^access_token=/)})),O.length&&(T+="?"+O.join("&")),T},qt.prototype.canonicalizeTileset=function(f,d){for(var y=!!d&&$t(d),T=[],O=0,N=f.tiles||[];O<N.length;O+=1){var Z=N[O];Tt(Z)?T.push(this.canonicalizeTileURL(Z,y)):T.push(Z)}return T},qt.prototype._makeAPIURL=function(f,d){var y="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",T=Oe(ae.API_URL);if(f.protocol=T.protocol,f.authority=T.authority,f.protocol==="http"){var O=f.params.indexOf("secure");O>=0&&f.params.splice(O,1)}if(T.path!=="/"&&(f.path=""+T.path+f.path),!ae.REQUIRE_ACCESS_TOKEN)return We(f);if(!(d=d||ae.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+y);if(d[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+y);return f.params=f.params.filter(function(N){return N.indexOf("access_token")===-1}),f.params.push("access_token="+d),We(f)};var Ct=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Tt(f){return Ct.test(f)}var ue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Oe(f){var d=f.match(ue);if(!d)throw new Error("Unable to parse URL object");return{protocol:d[1],authority:d[2],path:d[3]||"/",params:d[4]?d[4].split("&"):[]}}function We(f){var d=f.params.length?"?"+f.params.join("&"):"";return f.protocol+"://"+f.authority+f.path+d}function zt(f){if(!f)return null;var d=f.split(".");if(!d||d.length!==3)return null;try{return JSON.parse(decodeURIComponent(et.atob(d[1]).split("").map(function(y){return"%"+("00"+y.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(y){return null}}var At=function(f){this.type=f,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};At.prototype.getStorageKey=function(f){var d,y=zt(ae.ACCESS_TOKEN);return d=y&&y.u?et.btoa(encodeURIComponent(y.u).replace(/%([0-9A-F]{2})/g,function(T,O){return String.fromCharCode(Number("0x"+O))})):ae.ACCESS_TOKEN||"",f?"mapbox.eventData."+f+":"+d:"mapbox.eventData:"+d},At.prototype.fetchEventData=function(){var f=W("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(f)try{var T=et.localStorage.getItem(d);T&&(this.eventData=JSON.parse(T));var O=et.localStorage.getItem(y);O&&(this.anonId=O)}catch(N){ee("Unable to read from LocalStorage")}},At.prototype.saveEventData=function(){var f=W("localStorage"),d=this.getStorageKey(),y=this.getStorageKey("uuid");if(f)try{et.localStorage.setItem(y,this.anonId),Object.keys(this.eventData).length>=1&&et.localStorage.setItem(d,JSON.stringify(this.eventData))}catch(T){ee("Unable to write to LocalStorage")}},At.prototype.processRequests=function(f){},At.prototype.postEvent=function(f,d,y,T){var O=this;if(ae.EVENTS_URL){var N=Oe(ae.EVENTS_URL);N.params.push("access_token="+(T||ae.ACCESS_TOKEN||""));var Z={event:this.type,created:new Date(f).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:St,userId:this.anonId},K=d?b(Z,d):Z,mt={url:We(N),headers:{"Content-Type":"text/plain"},body:JSON.stringify([K])};this.pendingRequest=Wn(mt,function(Ot){O.pendingRequest=null,y(Ot),O.saveEventData(),O.processRequests(T)})}},At.prototype.queueRequest=function(f,d){this.queue.push(f),this.processRequests(d)};var Mt,Rt,tt=function(f){function d(){f.call(this,"map.load"),this.success={},this.skuToken=""}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.postMapLoadEvent=function(y,T,O,N){this.skuToken=O,(ae.EVENTS_URL&&N||ae.ACCESS_TOKEN&&Array.isArray(y)&&y.some(function(Z){return $t(Z)||Tt(Z)}))&&this.queueRequest({id:T,timestamp:Date.now()},N)},d.prototype.processRequests=function(y){var T=this;if(!this.pendingRequest&&this.queue.length!==0){var O=this.queue.shift(),N=O.id,Z=O.timestamp;N&&this.success[N]||(this.anonId||this.fetchEventData(),Ie(this.anonId)||(this.anonId=Se()),this.postEvent(Z,{skuToken:this.skuToken},function(K){K||N&&(T.success[N]=!0)},y))}},d}(At),_t=new(function(f){function d(y){f.call(this,"appUserTurnstile"),this._customAccessToken=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.postTurnstileEvent=function(y,T){ae.EVENTS_URL&&ae.ACCESS_TOKEN&&Array.isArray(y)&&y.some(function(O){return $t(O)||Tt(O)})&&this.queueRequest(Date.now(),T)},d.prototype.processRequests=function(y){var T=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var O=zt(ae.ACCESS_TOKEN),N=O?O.u:ae.ACCESS_TOKEN,Z=N!==this.eventData.tokenU;Ie(this.anonId)||(this.anonId=Se(),Z=!0);var K=this.queue.shift();if(this.eventData.lastSuccess){var mt=new Date(this.eventData.lastSuccess),Ot=new Date(K),Gt=(K-this.eventData.lastSuccess)/864e5;Z=Z||Gt>=1||Gt<-1||mt.getDate()!==Ot.getDate()}else Z=!0;if(!Z)return this.processRequests();this.postEvent(K,{"enabled.telemetry":!1},function(Kt){Kt||(T.eventData.lastSuccess=K,T.eventData.tokenU=N)},y)}},d}(At)),Xt=_t.postTurnstileEvent.bind(_t),ve=new tt,Wt=ve.postMapLoadEvent.bind(ve),Me=500,je=50;function Qe(){et.caches&&!Mt&&(Mt=et.caches.open("mapbox-tiles"))}function hr(f){var d=f.indexOf("?");return d<0?f:f.slice(0,d)}var er,Br=1/0;function Lr(){return er==null&&(er=et.OffscreenCanvas&&new et.OffscreenCanvas(1,1).getContext("2d")&&typeof et.createImageBitmap=="function"),er}var Zr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Zr);var Tn=function(f){function d(y,T,O){T===401&&Tt(O)&&(y+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),f.call(this,y),this.status=T,this.url=O,this.name=this.constructor.name,this.message=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},d}(Error),rn=gt()?function(){return self.worker&&self.worker.referrer}:function(){return(et.location.protocol==="blob:"?et.parent:et).location.href},Nn,zn,jn=function(f,d){if(!(/^file:/.test(y=f.url)||/^file:/.test(rn())&&!/^\w+:/.test(y))){if(et.fetch&&et.Request&&et.AbortController&&et.Request.prototype.hasOwnProperty("signal"))return function(T,O){var N,Z=new et.AbortController,K=new et.Request(T.url,{method:T.method||"GET",body:T.body,credentials:T.credentials,headers:T.headers,referrer:rn(),signal:Z.signal}),mt=!1,Ot=!1,Gt=(N=K.url).indexOf("sku=")>0&&Tt(N);T.type==="json"&&K.headers.set("Accept","application/json");var Kt=function(Fe,sr,lr){if(!Ot){if(Fe&&Fe.message!=="SecurityError"&&ee(Fe),sr&&lr)return pe(sr);var Cr=Date.now();et.fetch(K).then(function(gr){if(gr.ok){var Ur=Gt?gr.clone():null;return pe(gr,Ur,Cr)}return O(new Tn(gr.statusText,gr.status,T.url))}).catch(function(gr){gr.code!==20&&O(new Error(gr.message))})}},pe=function(Fe,sr,lr){(T.type==="arrayBuffer"?Fe.arrayBuffer():T.type==="json"?Fe.json():Fe.text()).then(function(Cr){Ot||(sr&&lr&&function(gr,Ur,Ar){if(Qe(),Mt){var Dr={status:Ur.status,statusText:Ur.statusText,headers:new et.Headers};Ur.headers.forEach(function(Fn,ni){return Dr.headers.set(ni,Fn)});var mn=Pt(Ur.headers.get("Cache-Control")||"");mn["no-store"]||(mn["max-age"]&&Dr.headers.set("Expires",new Date(Ar+1e3*mn["max-age"]).toUTCString()),new Date(Dr.headers.get("Expires")).getTime()-Ar<42e4||function(Fn,ni){if(Rt===void 0)try{new Response(new ReadableStream),Rt=!0}catch(ki){Rt=!1}Rt?ni(Fn.body):Fn.blob().then(ni)}(Ur,function(Fn){var ni=new et.Response(Fn,Dr);Qe(),Mt&&Mt.then(function(ki){return ki.put(hr(gr.url),ni)}).catch(function(ki){return ee(ki.message)})}))}}(K,sr,lr),mt=!0,O(null,Cr,Fe.headers.get("Cache-Control"),Fe.headers.get("Expires")))}).catch(function(Cr){Ot||O(new Error(Cr.message))})};return Gt?function(Fe,sr){if(Qe(),!Mt)return sr(null);var lr=hr(Fe.url);Mt.then(function(Cr){Cr.match(lr).then(function(gr){var Ur=function(Ar){if(!Ar)return!1;var Dr=new Date(Ar.headers.get("Expires")||0),mn=Pt(Ar.headers.get("Cache-Control")||"");return Dr>Date.now()&&!mn["no-cache"]}(gr);Cr.delete(lr),Ur&&Cr.put(lr,gr.clone()),sr(null,gr,Ur)}).catch(sr)}).catch(sr)}(K,Kt):Kt(null,null),{cancel:function(){Ot=!0,mt||Z.abort()}}}(f,d);if(gt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",f,d,void 0,!0)}var y;return function(T,O){var N=new et.XMLHttpRequest;for(var Z in N.open(T.method||"GET",T.url,!0),T.type==="arrayBuffer"&&(N.responseType="arraybuffer"),T.headers)N.setRequestHeader(Z,T.headers[Z]);return T.type==="json"&&(N.responseType="text",N.setRequestHeader("Accept","application/json")),N.withCredentials=T.credentials==="include",N.onerror=function(){O(new Error(N.statusText))},N.onload=function(){if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){var K=N.response;if(T.type==="json")try{K=JSON.parse(N.response)}catch(mt){return O(mt)}O(null,K,N.getResponseHeader("Cache-Control"),N.getResponseHeader("Expires"))}else O(new Tn(N.statusText,N.status,T.url))},N.send(T.body),{cancel:function(){return N.abort()}}}(f,d)},wn=function(f,d){return jn(b(f,{type:"arrayBuffer"}),d)},Wn=function(f,d){return jn(b(f,{method:"POST"}),d)},Bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";Nn=[],zn=0;var Yt=function(f,d){if(Ke.supported&&(f.headers||(f.headers={}),f.headers.accept="image/webp,*/*"),zn>=ae.MAX_PARALLEL_IMAGE_REQUESTS){var y={requestParameters:f,callback:d,cancelled:!1,cancel:function(){this.cancelled=!0}};return Nn.push(y),y}zn++;var T=!1,O=function(){if(!T)for(T=!0,zn--;Nn.length&&zn<ae.MAX_PARALLEL_IMAGE_REQUESTS;){var Z=Nn.shift();Z.cancelled||(Z.cancel=Yt(Z.requestParameters,Z.callback).cancel)}},N=wn(f,function(Z,K,mt,Ot){O(),Z?d(Z):K&&(Lr()?function(Gt,Kt){var pe=new et.Blob([new Uint8Array(Gt)],{type:"image/png"});et.createImageBitmap(pe).then(function(Fe){Kt(null,Fe)}).catch(function(Fe){Kt(new Error("Could not load image because of "+Fe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(K,d):function(Gt,Kt,pe,Fe){var sr=new et.Image,lr=et.URL;sr.onload=function(){Kt(null,sr),lr.revokeObjectURL(sr.src),sr.onload=null,et.requestAnimationFrame(function(){sr.src=Bt})},sr.onerror=function(){return Kt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Cr=new et.Blob([new Uint8Array(Gt)],{type:"image/png"});sr.cacheControl=pe,sr.expires=Fe,sr.src=Gt.byteLength?lr.createObjectURL(Cr):Bt}(K,d,mt,Ot))});return{cancel:function(){N.cancel(),O()}}};function oe(f,d,y){y[f]&&y[f].indexOf(d)!==-1||(y[f]=y[f]||[],y[f].push(d))}function Ce(f,d,y){if(y&&y[f]){var T=y[f].indexOf(d);T!==-1&&y[f].splice(T,1)}}var Ue=function(f,d){d===void 0&&(d={}),b(this,d),this.type=f},fr=function(f){function d(y,T){T===void 0&&(T={}),f.call(this,"error",b({error:y},T))}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Ue),Sr=function(){};Sr.prototype.on=function(f,d){return this._listeners=this._listeners||{},oe(f,d,this._listeners),this},Sr.prototype.off=function(f,d){return Ce(f,d,this._listeners),Ce(f,d,this._oneTimeListeners),this},Sr.prototype.once=function(f,d){return this._oneTimeListeners=this._oneTimeListeners||{},oe(f,d,this._oneTimeListeners),this},Sr.prototype.fire=function(f,d){typeof f=="string"&&(f=new Ue(f,d||{}));var y=f.type;if(this.listens(y)){f.target=this;for(var T=0,O=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];T<O.length;T+=1)O[T].call(this,f);for(var N=0,Z=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];N<Z.length;N+=1){var K=Z[N];Ce(y,K,this._oneTimeListeners),K.call(this,f)}var mt=this._eventedParent;mt&&(b(f,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),mt.fire(f))}else f instanceof fr&&console.error(f.error);return this},Sr.prototype.listens=function(f){return this._listeners&&this._listeners[f]&&this._listeners[f].length>0||this._oneTimeListeners&&this._oneTimeListeners[f]&&this._oneTimeListeners[f].length>0||this._eventedParent&&this._eventedParent.listens(f)},Sr.prototype.setEventedParent=function(f,d){return this._eventedParent=f,this._eventedParentData=d,this};var Pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},ur=function(f,d,y,T){this.message=(f?f+": ":"")+y,T&&(this.identifier=T),d!=null&&d.__line__&&(this.line=d.__line__)};function Wr(f){var d=f.value;return d?[new ur(f.key,d,"constants have been deprecated as of v8")]:[]}function Sn(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];for(var T=0,O=d;T<O.length;T+=1){var N=O[T];for(var Z in N)f[Z]=N[Z]}return f}function qr(f){return f instanceof Number||f instanceof String||f instanceof Boolean?f.valueOf():f}function Qr(f){if(Array.isArray(f))return f.map(Qr);if(f instanceof Object&&!(f instanceof Number||f instanceof String||f instanceof Boolean)){var d={};for(var y in f)d[y]=Qr(f[y]);return d}return qr(f)}var Mn=function(f){function d(y,T){f.call(this,T),this.message=T,this.key=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Error),bi=function(f,d){d===void 0&&(d=[]),this.parent=f,this.bindings={};for(var y=0,T=d;y<T.length;y+=1){var O=T[y];this.bindings[O[0]]=O[1]}};bi.prototype.concat=function(f){return new bi(this,f)},bi.prototype.get=function(f){if(this.bindings[f])return this.bindings[f];if(this.parent)return this.parent.get(f);throw new Error(f+" not found in scope.")},bi.prototype.has=function(f){return!!this.bindings[f]||!!this.parent&&this.parent.has(f)};var Si={kind:"null"},Kr={kind:"number"},ai={kind:"string"},li={kind:"boolean"},hi={kind:"color"},ra={kind:"object"},Ci={kind:"value"},Ba={kind:"collator"},po={kind:"formatted"},za={kind:"resolvedImage"};function Xa(f,d){return{kind:"array",itemType:f,N:d}}function Ta(f){if(f.kind==="array"){var d=Ta(f.itemType);return typeof f.N=="number"?"array<"+d+", "+f.N+">":f.itemType.kind==="value"?"array":"array<"+d+">"}return f.kind}var ga=[Si,Kr,ai,li,hi,po,ra,Xa(Ci),za];function no(f,d){if(d.kind==="error")return null;if(f.kind==="array"){if(d.kind==="array"&&(d.N===0&&d.itemType.kind==="value"||!no(f.itemType,d.itemType))&&(typeof f.N!="number"||f.N===d.N))return null}else{if(f.kind===d.kind)return null;if(f.kind==="value"){for(var y=0,T=ga;y<T.length;y+=1)if(!no(T[y],d))return null}}return"Expected "+Ta(f)+" but found "+Ta(d)+" instead."}function Vo(f,d){return d.some(function(y){return y.kind===f.kind})}function vo(f,d){return d.some(function(y){return y==="null"?f===null:y==="array"?Array.isArray(f):y==="object"?f&&!Array.isArray(f)&&typeof f=="object":y===typeof f})}var ja=Et(function(f,d){var y={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function T(K){return(K=Math.round(K))<0?0:K>255?255:K}function O(K){return T(K[K.length-1]==="%"?parseFloat(K)/100*255:parseInt(K))}function N(K){return(mt=K[K.length-1]==="%"?parseFloat(K)/100:parseFloat(K))<0?0:mt>1?1:mt;var mt}function Z(K,mt,Ot){return Ot<0?Ot+=1:Ot>1&&(Ot-=1),6*Ot<1?K+(mt-K)*Ot*6:2*Ot<1?mt:3*Ot<2?K+(mt-K)*(2/3-Ot)*6:K}try{d.parseCSSColor=function(K){var mt,Ot=K.replace(/ /g,"").toLowerCase();if(Ot in y)return y[Ot].slice();if(Ot[0]==="#")return Ot.length===4?(mt=parseInt(Ot.substr(1),16))>=0&&mt<=4095?[(3840&mt)>>4|(3840&mt)>>8,240&mt|(240&mt)>>4,15&mt|(15&mt)<<4,1]:null:Ot.length===7&&(mt=parseInt(Ot.substr(1),16))>=0&&mt<=16777215?[(16711680&mt)>>16,(65280&mt)>>8,255&mt,1]:null;var Gt=Ot.indexOf("("),Kt=Ot.indexOf(")");if(Gt!==-1&&Kt+1===Ot.length){var pe=Ot.substr(0,Gt),Fe=Ot.substr(Gt+1,Kt-(Gt+1)).split(","),sr=1;switch(pe){case"rgba":if(Fe.length!==4)return null;sr=N(Fe.pop());case"rgb":return Fe.length!==3?null:[O(Fe[0]),O(Fe[1]),O(Fe[2]),sr];case"hsla":if(Fe.length!==4)return null;sr=N(Fe.pop());case"hsl":if(Fe.length!==3)return null;var lr=(parseFloat(Fe[0])%360+360)%360/360,Cr=N(Fe[1]),gr=N(Fe[2]),Ur=gr<=.5?gr*(Cr+1):gr+Cr-gr*Cr,Ar=2*gr-Ur;return[T(255*Z(Ar,Ur,lr+1/3)),T(255*Z(Ar,Ur,lr)),T(255*Z(Ar,Ur,lr-1/3)),sr];default:return null}}return null}}catch(K){}}).parseCSSColor,to=function(f,d,y,T){T===void 0&&(T=1),this.r=f,this.g=d,this.b=y,this.a=T};to.parse=function(f){if(f){if(f instanceof to)return f;if(typeof f=="string"){var d=ja(f);if(d)return new to(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3])}}},to.prototype.toString=function(){var f=this.toArray(),d=f[1],y=f[2],T=f[3];return"rgba("+Math.round(f[0])+","+Math.round(d)+","+Math.round(y)+","+T+")"},to.prototype.toArray=function(){var f=this.a;return f===0?[0,0,0,0]:[255*this.r/f,255*this.g/f,255*this.b/f,f]},to.black=new to(0,0,0,1),to.white=new to(1,1,1,1),to.transparent=new to(0,0,0,0),to.red=new to(1,0,0,1);var Uo=function(f,d,y){this.sensitivity=f?d?"variant":"case":d?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Uo.prototype.compare=function(f,d){return this.collator.compare(f,d)},Uo.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var ju=function(f,d,y,T,O){this.text=f,this.image=d,this.scale=y,this.fontStack=T,this.textColor=O},Wo=function(f){this.sections=f};Wo.fromString=function(f){return new Wo([new ju(f,null,null,null,null)])},Wo.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(f){return f.text.length!==0||f.image&&f.image.name.length!==0})},Wo.factory=function(f){return f instanceof Wo?f:Wo.fromString(f)},Wo.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(f){return f.text}).join("")},Wo.prototype.serialize=function(){for(var f=["format"],d=0,y=this.sections;d<y.length;d+=1){var T=y[d];if(T.image)f.push(["image",T.image.name]);else{f.push(T.text);var O={};T.fontStack&&(O["text-font"]=["literal",T.fontStack.split(",")]),T.scale&&(O["font-scale"]=T.scale),T.textColor&&(O["text-color"]=["rgba"].concat(T.textColor.toArray())),f.push(O)}}return f};var bo=function(f){this.name=f.name,this.available=f.available};function nr(f,d,y,T){return typeof f=="number"&&f>=0&&f<=255&&typeof d=="number"&&d>=0&&d<=255&&typeof y=="number"&&y>=0&&y<=255?T===void 0||typeof T=="number"&&T>=0&&T<=1?null:"Invalid rgba value ["+[f,d,y,T].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof T=="number"?[f,d,y,T]:[f,d,y]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function xe(f){if(f===null||typeof f=="string"||typeof f=="boolean"||typeof f=="number"||f instanceof to||f instanceof Uo||f instanceof Wo||f instanceof bo)return!0;if(Array.isArray(f)){for(var d=0,y=f;d<y.length;d+=1)if(!xe(y[d]))return!1;return!0}if(typeof f=="object"){for(var T in f)if(!xe(f[T]))return!1;return!0}return!1}function He(f){if(f===null)return Si;if(typeof f=="string")return ai;if(typeof f=="boolean")return li;if(typeof f=="number")return Kr;if(f instanceof to)return hi;if(f instanceof Uo)return Ba;if(f instanceof Wo)return po;if(f instanceof bo)return za;if(Array.isArray(f)){for(var d,y=f.length,T=0,O=f;T<O.length;T+=1){var N=He(O[T]);if(d){if(d===N)continue;d=Ci;break}d=N}return Xa(d||Ci,y)}return ra}function Mr(f){var d=typeof f;return f===null?"":d==="string"||d==="number"||d==="boolean"?String(f):f instanceof to||f instanceof Wo||f instanceof bo?f.toString():JSON.stringify(f)}bo.prototype.toString=function(){return this.name},bo.fromString=function(f){return f?new bo({name:f,available:!1}):null},bo.prototype.serialize=function(){return["image",this.name]};var tn=function(f,d){this.type=f,this.value=d};tn.parse=function(f,d){if(f.length!==2)return d.error("'literal' expression requires exactly one argument, but found "+(f.length-1)+" instead.");if(!xe(f[1]))return d.error("invalid value");var y=f[1],T=He(y),O=d.expectedType;return T.kind!=="array"||T.N!==0||!O||O.kind!=="array"||typeof O.N=="number"&&O.N!==0||(T=O),new tn(T,y)},tn.prototype.evaluate=function(){return this.value},tn.prototype.eachChild=function(){},tn.prototype.outputDefined=function(){return!0},tn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof to?["rgba"].concat(this.value.toArray()):this.value instanceof Wo?this.value.serialize():this.value};var In=function(f){this.name="ExpressionEvaluationError",this.message=f};In.prototype.toJSON=function(){return this.message};var Un={string:ai,number:Kr,boolean:li,object:ra},Cn=function(f,d){this.type=f,this.args=d};Cn.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y,T=1,O=f[0];if(O==="array"){var N,Z;if(f.length>2){var K=f[1];if(typeof K!="string"||!(K in Un)||K==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);N=Un[K],T++}else N=Ci;if(f.length>3){if(f[2]!==null&&(typeof f[2]!="number"||f[2]<0||f[2]!==Math.floor(f[2])))return d.error('The length argument to "array" must be a positive integer literal',2);Z=f[2],T++}y=Xa(N,Z)}else y=Un[O];for(var mt=[];T<f.length;T++){var Ot=d.parse(f[T],T,Ci);if(!Ot)return null;mt.push(Ot)}return new Cn(y,mt)},Cn.prototype.evaluate=function(f){for(var d=0;d<this.args.length;d++){var y=this.args[d].evaluate(f);if(!no(this.type,He(y)))return y;if(d===this.args.length-1)throw new In("Expected value to be of type "+Ta(this.type)+", but found "+Ta(He(y))+" instead.")}return null},Cn.prototype.eachChild=function(f){this.args.forEach(f)},Cn.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},Cn.prototype.serialize=function(){var f=this.type,d=[f.kind];if(f.kind==="array"){var y=f.itemType;if(y.kind==="string"||y.kind==="number"||y.kind==="boolean"){d.push(y.kind);var T=f.N;(typeof T=="number"||this.args.length>1)&&d.push(T)}}return d.concat(this.args.map(function(O){return O.serialize()}))};var ta=function(f){this.type=po,this.sections=f};ta.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y=f[1];if(!Array.isArray(y)&&typeof y=="object")return d.error("First argument must be an image or text section.");for(var T=[],O=!1,N=1;N<=f.length-1;++N){var Z=f[N];if(O&&typeof Z=="object"&&!Array.isArray(Z)){O=!1;var K=null;if(Z["font-scale"]&&!(K=d.parse(Z["font-scale"],1,Kr)))return null;var mt=null;if(Z["text-font"]&&!(mt=d.parse(Z["text-font"],1,Xa(ai))))return null;var Ot=null;if(Z["text-color"]&&!(Ot=d.parse(Z["text-color"],1,hi)))return null;var Gt=T[T.length-1];Gt.scale=K,Gt.font=mt,Gt.textColor=Ot}else{var Kt=d.parse(f[N],1,Ci);if(!Kt)return null;var pe=Kt.type.kind;if(pe!=="string"&&pe!=="value"&&pe!=="null"&&pe!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");O=!0,T.push({content:Kt,scale:null,font:null,textColor:null})}}return new ta(T)},ta.prototype.evaluate=function(f){return new Wo(this.sections.map(function(d){var y=d.content.evaluate(f);return He(y)===za?new ju("",y,null,null,null):new ju(Mr(y),null,d.scale?d.scale.evaluate(f):null,d.font?d.font.evaluate(f).join(","):null,d.textColor?d.textColor.evaluate(f):null)}))},ta.prototype.eachChild=function(f){for(var d=0,y=this.sections;d<y.length;d+=1){var T=y[d];f(T.content),T.scale&&f(T.scale),T.font&&f(T.font),T.textColor&&f(T.textColor)}},ta.prototype.outputDefined=function(){return!1},ta.prototype.serialize=function(){for(var f=["format"],d=0,y=this.sections;d<y.length;d+=1){var T=y[d];f.push(T.content.serialize());var O={};T.scale&&(O["font-scale"]=T.scale.serialize()),T.font&&(O["text-font"]=T.font.serialize()),T.textColor&&(O["text-color"]=T.textColor.serialize()),f.push(O)}return f};var Wa=function(f){this.type=za,this.input=f};Wa.parse=function(f,d){if(f.length!==2)return d.error("Expected two arguments.");var y=d.parse(f[1],1,ai);return y?new Wa(y):d.error("No image name provided.")},Wa.prototype.evaluate=function(f){var d=this.input.evaluate(f),y=bo.fromString(d);return y&&f.availableImages&&(y.available=f.availableImages.indexOf(d)>-1),y},Wa.prototype.eachChild=function(f){f(this.input)},Wa.prototype.outputDefined=function(){return!1},Wa.prototype.serialize=function(){return["image",this.input.serialize()]};var es={"to-boolean":li,"to-color":hi,"to-number":Kr,"to-string":ai},ko=function(f,d){this.type=f,this.args=d};ko.parse=function(f,d){if(f.length<2)return d.error("Expected at least one argument.");var y=f[0];if((y==="to-boolean"||y==="to-string")&&f.length!==2)return d.error("Expected one argument.");for(var T=es[y],O=[],N=1;N<f.length;N++){var Z=d.parse(f[N],N,Ci);if(!Z)return null;O.push(Z)}return new ko(T,O)},ko.prototype.evaluate=function(f){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(f));if(this.type.kind==="color"){for(var d,y,T=0,O=this.args;T<O.length;T+=1){if(y=null,(d=O[T].evaluate(f))instanceof to)return d;if(typeof d=="string"){var N=f.parseColor(d);if(N)return N}else if(Array.isArray(d)&&!(y=d.length<3||d.length>4?"Invalid rbga value "+JSON.stringify(d)+": expected an array containing either three or four numeric values.":nr(d[0],d[1],d[2],d[3])))return new to(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new In(y||"Could not parse color from value '"+(typeof d=="string"?d:String(JSON.stringify(d)))+"'")}if(this.type.kind==="number"){for(var Z=null,K=0,mt=this.args;K<mt.length;K+=1){if((Z=mt[K].evaluate(f))===null)return 0;var Ot=Number(Z);if(!isNaN(Ot))return Ot}throw new In("Could not convert "+JSON.stringify(Z)+" to number.")}return this.type.kind==="formatted"?Wo.fromString(Mr(this.args[0].evaluate(f))):this.type.kind==="resolvedImage"?bo.fromString(Mr(this.args[0].evaluate(f))):Mr(this.args[0].evaluate(f))},ko.prototype.eachChild=function(f){this.args.forEach(f)},ko.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},ko.prototype.serialize=function(){if(this.type.kind==="formatted")return new ta([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Wa(this.args[0]).serialize();var f=["to-"+this.type.kind];return this.eachChild(function(d){f.push(d.serialize())}),f};var ns=["Unknown","Point","LineString","Polygon"],Ya=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ya.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ya.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?ns[this.feature.type]:this.feature.type:null},Ya.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ya.prototype.canonicalID=function(){return this.canonical},Ya.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ya.prototype.parseColor=function(f){var d=this._parseColorCache[f];return d||(d=this._parseColorCache[f]=to.parse(f)),d};var Go=function(f,d,y,T){this.name=f,this.type=d,this._evaluate=y,this.args=T};Go.prototype.evaluate=function(f){return this._evaluate(f,this.args)},Go.prototype.eachChild=function(f){this.args.forEach(f)},Go.prototype.outputDefined=function(){return!1},Go.prototype.serialize=function(){return[this.name].concat(this.args.map(function(f){return f.serialize()}))},Go.parse=function(f,d){var y,T=f[0],O=Go.definitions[T];if(!O)return d.error('Unknown expression "'+T+'". If you wanted a literal array, use ["literal", [...]].',0);for(var N=Array.isArray(O)?O[0]:O.type,Z=Array.isArray(O)?[[O[1],O[2]]]:O.overloads,K=Z.filter(function(ca){var zi=ca[0];return!Array.isArray(zi)||zi.length===f.length-1}),mt=null,Ot=0,Gt=K;Ot<Gt.length;Ot+=1){var Kt=Gt[Ot],pe=Kt[0],Fe=Kt[1];mt=new nu(d.registry,d.path,null,d.scope);for(var sr=[],lr=!1,Cr=1;Cr<f.length;Cr++){var gr=f[Cr],Ur=Array.isArray(pe)?pe[Cr-1]:pe.type,Ar=mt.parse(gr,1+sr.length,Ur);if(!Ar){lr=!0;break}sr.push(Ar)}if(!lr)if(Array.isArray(pe)&&pe.length!==sr.length)mt.error("Expected "+pe.length+" arguments, but found "+sr.length+" instead.");else{for(var Dr=0;Dr<sr.length;Dr++){var mn=Array.isArray(pe)?pe[Dr]:pe.type,Fn=sr[Dr];mt.concat(Dr+1).checkSubtype(mn,Fn.type)}if(mt.errors.length===0)return new Go(T,N,Fe,sr)}}if(K.length===1)(y=d.errors).push.apply(y,mt.errors);else{for(var ni=(K.length?K:Z).map(function(ca){var zi;return zi=ca[0],Array.isArray(zi)?"("+zi.map(Ta).join(", ")+")":"("+Ta(zi.type)+"...)"}).join(" | "),ki=[],oa=1;oa<f.length;oa++){var Di=d.parse(f[oa],1+ki.length);if(!Di)return null;ki.push(Ta(Di.type))}d.error("Expected arguments of type "+ni+", but found ("+ki.join(", ")+") instead.")}return null},Go.register=function(f,d){for(var y in Go.definitions=d,d)f[y]=Go};var pu=function(f,d,y){this.type=Ba,this.locale=y,this.caseSensitive=f,this.diacriticSensitive=d};function ys(f,d){f[0]=Math.min(f[0],d[0]),f[1]=Math.min(f[1],d[1]),f[2]=Math.max(f[2],d[0]),f[3]=Math.max(f[3],d[1])}function Rl(f,d){return!(f[0]<=d[0]||f[2]>=d[2]||f[1]<=d[1]||f[3]>=d[3])}function mf(f,d){var y=(180+f[0])/360,T=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f[1]*Math.PI/360)))/360,O=Math.pow(2,d.z);return[Math.round(y*O*8192),Math.round(T*O*8192)]}function Wu(f,d,y){return d[1]>f[1]!=y[1]>f[1]&&f[0]<(y[0]-d[0])*(f[1]-d[1])/(y[1]-d[1])+d[0]}function ke(f,d){for(var y,T,O,N,Z,K,mt,Ot=!1,Gt=0,Kt=d.length;Gt<Kt;Gt++)for(var pe=d[Gt],Fe=0,sr=pe.length;Fe<sr-1;Fe++){if((N=(y=f)[0]-(T=pe[Fe])[0])*(mt=y[1]-(O=pe[Fe+1])[1])-(K=y[0]-O[0])*(Z=y[1]-T[1])==0&&N*K<=0&&Z*mt<=0)return!1;Wu(f,pe[Fe],pe[Fe+1])&&(Ot=!Ot)}return Ot}function Xe(f,d){for(var y=0;y<d.length;y++)if(ke(f,d[y]))return!0;return!1}function Tr(f,d,y,T){var O=T[0]-y[0],N=T[1]-y[1],Z=(f[0]-y[0])*N-O*(f[1]-y[1]),K=(d[0]-y[0])*N-O*(d[1]-y[1]);return Z>0&&K<0||Z<0&&K>0}function un(f,d,y){for(var T=0,O=y;T<O.length;T+=1)for(var N=O[T],Z=0;Z<N.length-1;++Z)if((Kt=[(Gt=N[Z+1])[0]-(Ot=N[Z])[0],Gt[1]-Ot[1]])[0]*(pe=[(mt=d)[0]-(K=f)[0],mt[1]-K[1]])[1]-Kt[1]*pe[0]!=0&&Tr(K,mt,Ot,Gt)&&Tr(Ot,Gt,K,mt))return!0;var K,mt,Ot,Gt,Kt,pe;return!1}function si(f,d){for(var y=0;y<f.length;++y)if(!ke(f[y],d))return!1;for(var T=0;T<f.length-1;++T)if(un(f[T],f[T+1],d))return!1;return!0}function ji(f,d){for(var y=0;y<d.length;y++)if(si(f,d[y]))return!0;return!1}function Ma(f,d,y){for(var T=[],O=0;O<f.length;O++){for(var N=[],Z=0;Z<f[O].length;Z++){var K=mf(f[O][Z],y);ys(d,K),N.push(K)}T.push(N)}return T}function ds(f,d,y){for(var T=[],O=0;O<f.length;O++){var N=Ma(f[O],d,y);T.push(N)}return T}function Ho(f,d,y,T){if(f[0]<y[0]||f[0]>y[2]){var O=.5*T,N=f[0]-y[0]>O?-T:y[0]-f[0]>O?T:0;N===0&&(N=f[0]-y[2]>O?-T:y[2]-f[0]>O?T:0),f[0]+=N}ys(d,f)}function qo(f,d,y,T){for(var O=8192*Math.pow(2,T.z),N=[8192*T.x,8192*T.y],Z=[],K=0,mt=f;K<mt.length;K+=1)for(var Ot=0,Gt=mt[K];Ot<Gt.length;Ot+=1){var Kt=Gt[Ot],pe=[Kt.x+N[0],Kt.y+N[1]];Ho(pe,d,y,O),Z.push(pe)}return Z}function Hs(f,d,y,T){for(var O,N=8192*Math.pow(2,T.z),Z=[8192*T.x,8192*T.y],K=[],mt=0,Ot=f;mt<Ot.length;mt+=1){for(var Gt=[],Kt=0,pe=Ot[mt];Kt<pe.length;Kt+=1){var Fe=pe[Kt],sr=[Fe.x+Z[0],Fe.y+Z[1]];ys(d,sr),Gt.push(sr)}K.push(Gt)}if(d[2]-d[0]<=N/2){(O=d)[0]=O[1]=1/0,O[2]=O[3]=-1/0;for(var lr=0,Cr=K;lr<Cr.length;lr+=1)for(var gr=0,Ur=Cr[lr];gr<Ur.length;gr+=1)Ho(Ur[gr],d,y,N)}return K}pu.parse=function(f,d){if(f.length!==2)return d.error("Expected one argument.");var y=f[1];if(typeof y!="object"||Array.isArray(y))return d.error("Collator options argument must be an object.");var T=d.parse(y["case-sensitive"]!==void 0&&y["case-sensitive"],1,li);if(!T)return null;var O=d.parse(y["diacritic-sensitive"]!==void 0&&y["diacritic-sensitive"],1,li);if(!O)return null;var N=null;return y.locale&&!(N=d.parse(y.locale,1,ai))?null:new pu(T,O,N)},pu.prototype.evaluate=function(f){return new Uo(this.caseSensitive.evaluate(f),this.diacriticSensitive.evaluate(f),this.locale?this.locale.evaluate(f):null)},pu.prototype.eachChild=function(f){f(this.caseSensitive),f(this.diacriticSensitive),this.locale&&f(this.locale)},pu.prototype.outputDefined=function(){return!1},pu.prototype.serialize=function(){var f={};return f["case-sensitive"]=this.caseSensitive.serialize(),f["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(f.locale=this.locale.serialize()),["collator",f]};var Xu=function(f,d){this.type=li,this.geojson=f,this.geometries=d};function _s(f){if(f instanceof Go&&(f.name==="get"&&f.args.length===1||f.name==="feature-state"||f.name==="has"&&f.args.length===1||f.name==="properties"||f.name==="geometry-type"||f.name==="id"||/^filter-/.test(f.name))||f instanceof Xu)return!1;var d=!0;return f.eachChild(function(y){d&&!_s(y)&&(d=!1)}),d}function vs(f){if(f instanceof Go&&f.name==="feature-state")return!1;var d=!0;return f.eachChild(function(y){d&&!vs(y)&&(d=!1)}),d}function Ou(f,d){if(f instanceof Go&&d.indexOf(f.name)>=0)return!1;var y=!0;return f.eachChild(function(T){y&&!Ou(T,d)&&(y=!1)}),y}Xu.parse=function(f,d){if(f.length!==2)return d.error("'within' expression requires exactly one argument, but found "+(f.length-1)+" instead.");if(xe(f[1])){var y=f[1];if(y.type==="FeatureCollection")for(var T=0;T<y.features.length;++T){var O=y.features[T].geometry.type;if(O==="Polygon"||O==="MultiPolygon")return new Xu(y,y.features[T].geometry)}else if(y.type==="Feature"){var N=y.geometry.type;if(N==="Polygon"||N==="MultiPolygon")return new Xu(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new Xu(y,y)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Xu.prototype.evaluate=function(f){if(f.geometry()!=null&&f.canonicalID()!=null){if(f.geometryType()==="Point")return function(d,y){var T=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(y.type==="Polygon"){var Z=Ma(y.coordinates,O,N),K=qo(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var mt=0,Ot=K;mt<Ot.length;mt+=1)if(!ke(Ot[mt],Z))return!1}if(y.type==="MultiPolygon"){var Gt=ds(y.coordinates,O,N),Kt=qo(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var pe=0,Fe=Kt;pe<Fe.length;pe+=1)if(!Xe(Fe[pe],Gt))return!1}return!0}(f,this.geometries);if(f.geometryType()==="LineString")return function(d,y){var T=[1/0,1/0,-1/0,-1/0],O=[1/0,1/0,-1/0,-1/0],N=d.canonicalID();if(y.type==="Polygon"){var Z=Ma(y.coordinates,O,N),K=Hs(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var mt=0,Ot=K;mt<Ot.length;mt+=1)if(!si(Ot[mt],Z))return!1}if(y.type==="MultiPolygon"){var Gt=ds(y.coordinates,O,N),Kt=Hs(d.geometry(),T,O,N);if(!Rl(T,O))return!1;for(var pe=0,Fe=Kt;pe<Fe.length;pe+=1)if(!ji(Fe[pe],Gt))return!1}return!0}(f,this.geometries)}return!1},Xu.prototype.eachChild=function(){},Xu.prototype.outputDefined=function(){return!0},Xu.prototype.serialize=function(){return["within",this.geojson]};var rl=function(f,d){this.type=d.type,this.name=f,this.boundExpression=d};rl.parse=function(f,d){if(f.length!==2||typeof f[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");var y=f[1];return d.scope.has(y)?new rl(y,d.scope.get(y)):d.error('Unknown variable "'+y+'". Make sure "'+y+'" has been bound in an enclosing "let" expression before using it.',1)},rl.prototype.evaluate=function(f){return this.boundExpression.evaluate(f)},rl.prototype.eachChild=function(){},rl.prototype.outputDefined=function(){return!1},rl.prototype.serialize=function(){return["var",this.name]};var nu=function(f,d,y,T,O){d===void 0&&(d=[]),T===void 0&&(T=new bi),O===void 0&&(O=[]),this.registry=f,this.path=d,this.key=d.map(function(N){return"["+N+"]"}).join(""),this.scope=T,this.errors=O,this.expectedType=y};function dl(f,d){for(var y,T=f.length-1,O=0,N=T,Z=0;O<=N;)if((y=f[Z=Math.floor((O+N)/2)])<=d){if(Z===T||d<f[Z+1])return Z;O=Z+1}else{if(!(y>d))throw new In("Input is not a number.");N=Z-1}return 0}nu.prototype.parse=function(f,d,y,T,O){return O===void 0&&(O={}),d?this.concat(d,y,T)._parse(f,O):this._parse(f,O)},nu.prototype._parse=function(f,d){function y(Ot,Gt,Kt){return Kt==="assert"?new Cn(Gt,[Ot]):Kt==="coerce"?new ko(Gt,[Ot]):Ot}if(f!==null&&typeof f!="string"&&typeof f!="boolean"&&typeof f!="number"||(f=["literal",f]),Array.isArray(f)){if(f.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var T=f[0];if(typeof T!="string")return this.error("Expression name must be a string, but found "+typeof T+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var O=this.registry[T];if(O){var N=O.parse(f,this);if(!N)return null;if(this.expectedType){var Z=this.expectedType,K=N.type;if(Z.kind!=="string"&&Z.kind!=="number"&&Z.kind!=="boolean"&&Z.kind!=="object"&&Z.kind!=="array"||K.kind!=="value")if(Z.kind!=="color"&&Z.kind!=="formatted"&&Z.kind!=="resolvedImage"||K.kind!=="value"&&K.kind!=="string"){if(this.checkSubtype(Z,K))return null}else N=y(N,Z,d.typeAnnotation||"coerce");else N=y(N,Z,d.typeAnnotation||"assert")}if(!(N instanceof tn)&&N.type.kind!=="resolvedImage"&&function Ot(Gt){if(Gt instanceof rl)return Ot(Gt.boundExpression);if(Gt instanceof Go&&Gt.name==="error"||Gt instanceof pu||Gt instanceof Xu)return!1;var Kt=Gt instanceof ko||Gt instanceof Cn,pe=!0;return Gt.eachChild(function(Fe){pe=Kt?pe&&Ot(Fe):pe&&Fe instanceof tn}),!!pe&&_s(Gt)&&Ou(Gt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(N)){var mt=new Ya;try{N=new tn(N.type,N.evaluate(mt))}catch(Ot){return this.error(Ot.message),null}}return N}return this.error('Unknown expression "'+T+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(f===void 0?"'undefined' value invalid. Use null instead.":typeof f=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof f+" instead.")},nu.prototype.concat=function(f,d,y){var T=typeof f=="number"?this.path.concat(f):this.path,O=y?this.scope.concat(y):this.scope;return new nu(this.registry,T,d||null,O,this.errors)},nu.prototype.error=function(f){for(var d=[],y=arguments.length-1;y-- >0;)d[y]=arguments[y+1];var T=""+this.key+d.map(function(O){return"["+O+"]"}).join("");this.errors.push(new Mn(T,f))},nu.prototype.checkSubtype=function(f,d){var y=no(f,d);return y&&this.error(y),y};var Fu=function(f,d,y){this.type=f,this.input=d,this.labels=[],this.outputs=[];for(var T=0,O=y;T<O.length;T+=1){var N=O[T],Z=N[1];this.labels.push(N[0]),this.outputs.push(Z)}};function Fo(f,d,y){return f*(1-y)+d*y}Fu.parse=function(f,d){if(f.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if((f.length-1)%2!=0)return d.error("Expected an even number of arguments.");var y=d.parse(f[1],1,Kr);if(!y)return null;var T=[],O=null;d.expectedType&&d.expectedType.kind!=="value"&&(O=d.expectedType);for(var N=1;N<f.length;N+=2){var Z=N===1?-1/0:f[N],K=f[N+1],mt=N,Ot=N+1;if(typeof Z!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',mt);if(T.length&&T[T.length-1][0]>=Z)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',mt);var Gt=d.parse(K,Ot,O);if(!Gt)return null;O=O||Gt.type,T.push([Z,Gt])}return new Fu(O,y,T)},Fu.prototype.evaluate=function(f){var d=this.labels,y=this.outputs;if(d.length===1)return y[0].evaluate(f);var T=this.input.evaluate(f);if(T<=d[0])return y[0].evaluate(f);var O=d.length;return T>=d[O-1]?y[O-1].evaluate(f):y[dl(d,T)].evaluate(f)},Fu.prototype.eachChild=function(f){f(this.input);for(var d=0,y=this.outputs;d<y.length;d+=1)f(y[d])},Fu.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})},Fu.prototype.serialize=function(){for(var f=["step",this.input.serialize()],d=0;d<this.labels.length;d++)d>0&&f.push(this.labels[d]),f.push(this.outputs[d].serialize());return f};var rs=Object.freeze({__proto__:null,number:Fo,color:function(f,d,y){return new to(Fo(f.r,d.r,y),Fo(f.g,d.g,y),Fo(f.b,d.b,y),Fo(f.a,d.a,y))},array:function(f,d,y){return f.map(function(T,O){return Fo(T,d[O],y)})}}),Uc=6/29*3*(6/29),_u=Math.PI/180,Zc=180/Math.PI;function Co(f){return f>.008856451679035631?Math.pow(f,1/3):f/Uc+4/29}function sc(f){return f>6/29?f*f*f:Uc*(f-4/29)}function Xl(f){return 255*(f<=.0031308?12.92*f:1.055*Math.pow(f,1/2.4)-.055)}function nl(f){return(f/=255)<=.04045?f/12.92:Math.pow((f+.055)/1.055,2.4)}function uc(f){var d=nl(f.r),y=nl(f.g),T=nl(f.b),O=Co((.4124564*d+.3575761*y+.1804375*T)/.95047),N=Co((.2126729*d+.7151522*y+.072175*T)/1);return{l:116*N-16,a:500*(O-N),b:200*(N-Co((.0193339*d+.119192*y+.9503041*T)/1.08883)),alpha:f.a}}function D(f){var d=(f.l+16)/116,y=isNaN(f.a)?d:d+f.a/500,T=isNaN(f.b)?d:d-f.b/200;return d=1*sc(d),y=.95047*sc(y),T=1.08883*sc(T),new to(Xl(3.2404542*y-1.5371385*d-.4985314*T),Xl(-.969266*y+1.8760108*d+.041556*T),Xl(.0556434*y-.2040259*d+1.0572252*T),f.alpha)}function Y(f,d,y){var T=d-f;return f+y*(T>180||T<-180?T-360*Math.round(T/360):T)}var bt={forward:uc,reverse:D,interpolate:function(f,d,y){return{l:Fo(f.l,d.l,y),a:Fo(f.a,d.a,y),b:Fo(f.b,d.b,y),alpha:Fo(f.alpha,d.alpha,y)}}},nt={forward:function(f){var d=uc(f),y=d.l,T=d.a,O=d.b,N=Math.atan2(O,T)*Zc;return{h:N<0?N+360:N,c:Math.sqrt(T*T+O*O),l:y,alpha:f.a}},reverse:function(f){var d=f.h*_u,y=f.c;return D({l:f.l,a:Math.cos(d)*y,b:Math.sin(d)*y,alpha:f.alpha})},interpolate:function(f,d,y){return{h:Y(f.h,d.h,y),c:Fo(f.c,d.c,y),l:Fo(f.l,d.l,y),alpha:Fo(f.alpha,d.alpha,y)}}},se=Object.freeze({__proto__:null,lab:bt,hcl:nt}),Ve=function(f,d,y,T,O){this.type=f,this.operator=d,this.interpolation=y,this.input=T,this.labels=[],this.outputs=[];for(var N=0,Z=O;N<Z.length;N+=1){var K=Z[N],mt=K[1];this.labels.push(K[0]),this.outputs.push(mt)}};function wr(f,d,y,T){var O=T-y,N=f-y;return O===0?0:d===1?N/O:(Math.pow(d,N)-1)/(Math.pow(d,O)-1)}Ve.interpolationFactor=function(f,d,y,T){var O=0;if(f.name==="exponential")O=wr(d,f.base,y,T);else if(f.name==="linear")O=wr(d,1,y,T);else if(f.name==="cubic-bezier"){var N=f.controlPoints;O=new q(N[0],N[1],N[2],N[3]).solve(wr(d,1,y,T))}return O},Ve.parse=function(f,d){var y=f[0],T=f[1],O=f[2],N=f.slice(3);if(!Array.isArray(T)||T.length===0)return d.error("Expected an interpolation type expression.",1);if(T[0]==="linear")T={name:"linear"};else if(T[0]==="exponential"){var Z=T[1];if(typeof Z!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);T={name:"exponential",base:Z}}else{if(T[0]!=="cubic-bezier")return d.error("Unknown interpolation type "+String(T[0]),1,0);var K=T.slice(1);if(K.length!==4||K.some(function(Cr){return typeof Cr!="number"||Cr<0||Cr>1}))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);T={name:"cubic-bezier",controlPoints:K}}if(f.length-1<4)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if((f.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(!(O=d.parse(O,2,Kr)))return null;var mt=[],Ot=null;y==="interpolate-hcl"||y==="interpolate-lab"?Ot=hi:d.expectedType&&d.expectedType.kind!=="value"&&(Ot=d.expectedType);for(var Gt=0;Gt<N.length;Gt+=2){var Kt=N[Gt],pe=N[Gt+1],Fe=Gt+3,sr=Gt+4;if(typeof Kt!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Fe);if(mt.length&&mt[mt.length-1][0]>=Kt)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Fe);var lr=d.parse(pe,sr,Ot);if(!lr)return null;Ot=Ot||lr.type,mt.push([Kt,lr])}return Ot.kind==="number"||Ot.kind==="color"||Ot.kind==="array"&&Ot.itemType.kind==="number"&&typeof Ot.N=="number"?new Ve(Ot,y,T,O,mt):d.error("Type "+Ta(Ot)+" is not interpolatable.")},Ve.prototype.evaluate=function(f){var d=this.labels,y=this.outputs;if(d.length===1)return y[0].evaluate(f);var T=this.input.evaluate(f);if(T<=d[0])return y[0].evaluate(f);var O=d.length;if(T>=d[O-1])return y[O-1].evaluate(f);var N=dl(d,T),Z=Ve.interpolationFactor(this.interpolation,T,d[N],d[N+1]),K=y[N].evaluate(f),mt=y[N+1].evaluate(f);return this.operator==="interpolate"?rs[this.type.kind.toLowerCase()](K,mt,Z):this.operator==="interpolate-hcl"?nt.reverse(nt.interpolate(nt.forward(K),nt.forward(mt),Z)):bt.reverse(bt.interpolate(bt.forward(K),bt.forward(mt),Z))},Ve.prototype.eachChild=function(f){f(this.input);for(var d=0,y=this.outputs;d<y.length;d+=1)f(y[d])},Ve.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})},Ve.prototype.serialize=function(){var f;f=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var d=[this.operator,f,this.input.serialize()],y=0;y<this.labels.length;y++)d.push(this.labels[y],this.outputs[y].serialize());return d};var jr=function(f,d){this.type=f,this.args=d};jr.parse=function(f,d){if(f.length<2)return d.error("Expectected at least one argument.");var y=null,T=d.expectedType;T&&T.kind!=="value"&&(y=T);for(var O=[],N=0,Z=f.slice(1);N<Z.length;N+=1){var K=d.parse(Z[N],1+O.length,y,void 0,{typeAnnotation:"omit"});if(!K)return null;y=y||K.type,O.push(K)}var mt=T&&O.some(function(Ot){return no(T,Ot.type)});return new jr(mt?Ci:y,O)},jr.prototype.evaluate=function(f){for(var d,y=null,T=0,O=0,N=this.args;O<N.length&&(T++,(y=N[O].evaluate(f))&&y instanceof bo&&!y.available&&(d||(d=y.name),y=null,T===this.args.length&&(y=d)),y===null);O+=1);return y},jr.prototype.eachChild=function(f){this.args.forEach(f)},jr.prototype.outputDefined=function(){return this.args.every(function(f){return f.outputDefined()})},jr.prototype.serialize=function(){var f=["coalesce"];return this.eachChild(function(d){f.push(d.serialize())}),f};var Vr=function(f,d){this.type=d.type,this.bindings=[].concat(f),this.result=d};Vr.prototype.evaluate=function(f){return this.result.evaluate(f)},Vr.prototype.eachChild=function(f){for(var d=0,y=this.bindings;d<y.length;d+=1)f(y[d][1]);f(this.result)},Vr.parse=function(f,d){if(f.length<4)return d.error("Expected at least 3 arguments, but found "+(f.length-1)+" instead.");for(var y=[],T=1;T<f.length-1;T+=2){var O=f[T];if(typeof O!="string")return d.error("Expected string, but found "+typeof O+" instead.",T);if(/[^a-zA-Z0-9_]/.test(O))return d.error("Variable names must contain only alphanumeric characters or '_'.",T);var N=d.parse(f[T+1],T+1);if(!N)return null;y.push([O,N])}var Z=d.parse(f[f.length-1],f.length-1,d.expectedType,y);return Z?new Vr(y,Z):null},Vr.prototype.outputDefined=function(){return this.result.outputDefined()},Vr.prototype.serialize=function(){for(var f=["let"],d=0,y=this.bindings;d<y.length;d+=1){var T=y[d];f.push(T[0],T[1].serialize())}return f.push(this.result.serialize()),f};var Ln=function(f,d,y){this.type=f,this.index=d,this.input=y};Ln.parse=function(f,d){if(f.length!==3)return d.error("Expected 2 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Kr),T=d.parse(f[2],2,Xa(d.expectedType||Ci));return y&&T?new Ln(T.type.itemType,y,T):null},Ln.prototype.evaluate=function(f){var d=this.index.evaluate(f),y=this.input.evaluate(f);if(d<0)throw new In("Array index out of bounds: "+d+" < 0.");if(d>=y.length)throw new In("Array index out of bounds: "+d+" > "+(y.length-1)+".");if(d!==Math.floor(d))throw new In("Array index must be an integer, but found "+d+" instead.");return y[d]},Ln.prototype.eachChild=function(f){f(this.index),f(this.input)},Ln.prototype.outputDefined=function(){return!1},Ln.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Gn=function(f,d){this.type=li,this.needle=f,this.haystack=d};Gn.parse=function(f,d){if(f.length!==3)return d.error("Expected 2 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ci),T=d.parse(f[2],2,Ci);return y&&T?Vo(y.type,[li,ai,Kr,Si,Ci])?new Gn(y,T):d.error("Expected first argument to be of type boolean, string, number or null, but found "+Ta(y.type)+" instead"):null},Gn.prototype.evaluate=function(f){var d=this.needle.evaluate(f),y=this.haystack.evaluate(f);if(!y)return!1;if(!vo(d,["boolean","string","number","null"]))throw new In("Expected first argument to be of type boolean, string, number or null, but found "+Ta(He(d))+" instead.");if(!vo(y,["string","array"]))throw new In("Expected second argument to be of type array or string, but found "+Ta(He(y))+" instead.");return y.indexOf(d)>=0},Gn.prototype.eachChild=function(f){f(this.needle),f(this.haystack)},Gn.prototype.outputDefined=function(){return!0},Gn.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var $i=function(f,d,y){this.type=Kr,this.needle=f,this.haystack=d,this.fromIndex=y};$i.parse=function(f,d){if(f.length<=2||f.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ci),T=d.parse(f[2],2,Ci);if(!y||!T)return null;if(!Vo(y.type,[li,ai,Kr,Si,Ci]))return d.error("Expected first argument to be of type boolean, string, number or null, but found "+Ta(y.type)+" instead");if(f.length===4){var O=d.parse(f[3],3,Kr);return O?new $i(y,T,O):null}return new $i(y,T)},$i.prototype.evaluate=function(f){var d=this.needle.evaluate(f),y=this.haystack.evaluate(f);if(!vo(d,["boolean","string","number","null"]))throw new In("Expected first argument to be of type boolean, string, number or null, but found "+Ta(He(d))+" instead.");if(!vo(y,["string","array"]))throw new In("Expected second argument to be of type array or string, but found "+Ta(He(y))+" instead.");if(this.fromIndex){var T=this.fromIndex.evaluate(f);return y.indexOf(d,T)}return y.indexOf(d)},$i.prototype.eachChild=function(f){f(this.needle),f(this.haystack),this.fromIndex&&f(this.fromIndex)},$i.prototype.outputDefined=function(){return!1},$i.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var f=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),f]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Pa=function(f,d,y,T,O,N){this.inputType=f,this.type=d,this.input=y,this.cases=T,this.outputs=O,this.otherwise=N};Pa.parse=function(f,d){if(f.length<5)return d.error("Expected at least 4 arguments, but found only "+(f.length-1)+".");if(f.length%2!=1)return d.error("Expected an even number of arguments.");var y,T;d.expectedType&&d.expectedType.kind!=="value"&&(T=d.expectedType);for(var O={},N=[],Z=2;Z<f.length-1;Z+=2){var K=f[Z],mt=f[Z+1];Array.isArray(K)||(K=[K]);var Ot=d.concat(Z);if(K.length===0)return Ot.error("Expected at least one branch label.");for(var Gt=0,Kt=K;Gt<Kt.length;Gt+=1){var pe=Kt[Gt];if(typeof pe!="number"&&typeof pe!="string")return Ot.error("Branch labels must be numbers or strings.");if(typeof pe=="number"&&Math.abs(pe)>Number.MAX_SAFE_INTEGER)return Ot.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof pe=="number"&&Math.floor(pe)!==pe)return Ot.error("Numeric branch labels must be integer values.");if(y){if(Ot.checkSubtype(y,He(pe)))return null}else y=He(pe);if(O[String(pe)]!==void 0)return Ot.error("Branch labels must be unique.");O[String(pe)]=N.length}var Fe=d.parse(mt,Z,T);if(!Fe)return null;T=T||Fe.type,N.push(Fe)}var sr=d.parse(f[1],1,Ci);if(!sr)return null;var lr=d.parse(f[f.length-1],f.length-1,T);return lr?sr.type.kind!=="value"&&d.concat(1).checkSubtype(y,sr.type)?null:new Pa(y,T,sr,O,N,lr):null},Pa.prototype.evaluate=function(f){var d=this.input.evaluate(f);return(He(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(f)},Pa.prototype.eachChild=function(f){f(this.input),this.outputs.forEach(f),f(this.otherwise)},Pa.prototype.outputDefined=function(){return this.outputs.every(function(f){return f.outputDefined()})&&this.otherwise.outputDefined()},Pa.prototype.serialize=function(){for(var f=this,d=["match",this.input.serialize()],y=[],T={},O=0,N=Object.keys(this.cases).sort();O<N.length;O+=1){var Z=N[O];(Kt=T[this.cases[Z]])===void 0?(T[this.cases[Z]]=y.length,y.push([this.cases[Z],[Z]])):y[Kt][1].push(Z)}for(var K=function(Fe){return f.inputType.kind==="number"?Number(Fe):Fe},mt=0,Ot=y;mt<Ot.length;mt+=1){var Gt=Ot[mt],Kt=Gt[0],pe=Gt[1];d.push(pe.length===1?K(pe[0]):pe.map(K)),d.push(this.outputs[outputIndex$1].serialize())}return d.push(this.otherwise.serialize()),d};var ba=function(f,d,y){this.type=f,this.branches=d,this.otherwise=y};ba.parse=function(f,d){if(f.length<4)return d.error("Expected at least 3 arguments, but found only "+(f.length-1)+".");if(f.length%2!=0)return d.error("Expected an odd number of arguments.");var y;d.expectedType&&d.expectedType.kind!=="value"&&(y=d.expectedType);for(var T=[],O=1;O<f.length-1;O+=2){var N=d.parse(f[O],O,li);if(!N)return null;var Z=d.parse(f[O+1],O+1,y);if(!Z)return null;T.push([N,Z]),y=y||Z.type}var K=d.parse(f[f.length-1],f.length-1,y);return K?new ba(y,T,K):null},ba.prototype.evaluate=function(f){for(var d=0,y=this.branches;d<y.length;d+=1){var T=y[d],O=T[1];if(T[0].evaluate(f))return O.evaluate(f)}return this.otherwise.evaluate(f)},ba.prototype.eachChild=function(f){for(var d=0,y=this.branches;d<y.length;d+=1){var T=y[d],O=T[1];f(T[0]),f(O)}f(this.otherwise)},ba.prototype.outputDefined=function(){return this.branches.every(function(f){return f[1].outputDefined()})&&this.otherwise.outputDefined()},ba.prototype.serialize=function(){var f=["case"];return this.eachChild(function(d){f.push(d.serialize())}),f};var uo=function(f,d,y,T){this.type=f,this.input=d,this.beginIndex=y,this.endIndex=T};function Ca(f,d){return f==="=="||f==="!="?d.kind==="boolean"||d.kind==="string"||d.kind==="number"||d.kind==="null"||d.kind==="value":d.kind==="string"||d.kind==="number"||d.kind==="value"}function Ao(f,d,y,T){return T.compare(d,y)===0}function qa(f,d,y){var T=f!=="=="&&f!=="!=";return function(){function O(N,Z,K){this.type=li,this.lhs=N,this.rhs=Z,this.collator=K,this.hasUntypedArgument=N.type.kind==="value"||Z.type.kind==="value"}return O.parse=function(N,Z){if(N.length!==3&&N.length!==4)return Z.error("Expected two or three arguments.");var K=N[0],mt=Z.parse(N[1],1,Ci);if(!mt)return null;if(!Ca(K,mt.type))return Z.concat(1).error('"'+K+`" comparisons are not supported for type '`+Ta(mt.type)+"'.");var Ot=Z.parse(N[2],2,Ci);if(!Ot)return null;if(!Ca(K,Ot.type))return Z.concat(2).error('"'+K+`" comparisons are not supported for type '`+Ta(Ot.type)+"'.");if(mt.type.kind!==Ot.type.kind&&mt.type.kind!=="value"&&Ot.type.kind!=="value")return Z.error("Cannot compare types '"+Ta(mt.type)+"' and '"+Ta(Ot.type)+"'.");T&&(mt.type.kind==="value"&&Ot.type.kind!=="value"?mt=new Cn(Ot.type,[mt]):mt.type.kind!=="value"&&Ot.type.kind==="value"&&(Ot=new Cn(mt.type,[Ot])));var Gt=null;if(N.length===4){if(mt.type.kind!=="string"&&Ot.type.kind!=="string"&&mt.type.kind!=="value"&&Ot.type.kind!=="value")return Z.error("Cannot use collator to compare non-string types.");if(!(Gt=Z.parse(N[3],3,Ba)))return null}return new O(mt,Ot,Gt)},O.prototype.evaluate=function(N){var Z=this.lhs.evaluate(N),K=this.rhs.evaluate(N);if(T&&this.hasUntypedArgument){var mt=He(Z),Ot=He(K);if(mt.kind!==Ot.kind||mt.kind!=="string"&&mt.kind!=="number")throw new In('Expected arguments for "'+f+'" to be (string, string) or (number, number), but found ('+mt.kind+", "+Ot.kind+") instead.")}if(this.collator&&!T&&this.hasUntypedArgument){var Gt=He(Z),Kt=He(K);if(Gt.kind!=="string"||Kt.kind!=="string")return d(N,Z,K)}return this.collator?y(N,Z,K,this.collator.evaluate(N)):d(N,Z,K)},O.prototype.eachChild=function(N){N(this.lhs),N(this.rhs),this.collator&&N(this.collator)},O.prototype.outputDefined=function(){return!0},O.prototype.serialize=function(){var N=[f];return this.eachChild(function(Z){N.push(Z.serialize())}),N},O}()}uo.parse=function(f,d){if(f.length<=2||f.length>=5)return d.error("Expected 3 or 4 arguments, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1,Ci),T=d.parse(f[2],2,Kr);if(!y||!T)return null;if(!Vo(y.type,[Xa(Ci),ai,Ci]))return d.error("Expected first argument to be of type array or string, but found "+Ta(y.type)+" instead");if(f.length===4){var O=d.parse(f[3],3,Kr);return O?new uo(y.type,y,T,O):null}return new uo(y.type,y,T)},uo.prototype.evaluate=function(f){var d=this.input.evaluate(f),y=this.beginIndex.evaluate(f);if(!vo(d,["string","array"]))throw new In("Expected first argument to be of type array or string, but found "+Ta(He(d))+" instead.");if(this.endIndex){var T=this.endIndex.evaluate(f);return d.slice(y,T)}return d.slice(y)},uo.prototype.eachChild=function(f){f(this.input),f(this.beginIndex),this.endIndex&&f(this.endIndex)},uo.prototype.outputDefined=function(){return!1},uo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var f=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),f]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var gs=qa("==",function(f,d,y){return d===y},Ao),xu=qa("!=",function(f,d,y){return d!==y},function(f,d,y,T){return!Ao(0,d,y,T)}),il=qa("<",function(f,d,y){return d<y},function(f,d,y,T){return T.compare(d,y)<0}),bu=qa(">",function(f,d,y){return d>y},function(f,d,y,T){return T.compare(d,y)>0}),iu=qa("<=",function(f,d,y){return d<=y},function(f,d,y,T){return T.compare(d,y)<=0}),Vc=qa(">=",function(f,d,y){return d>=y},function(f,d,y,T){return T.compare(d,y)>=0}),$s=function(f,d,y,T,O){this.type=ai,this.number=f,this.locale=d,this.currency=y,this.minFractionDigits=T,this.maxFractionDigits=O};$s.parse=function(f,d){if(f.length!==3)return d.error("Expected two arguments.");var y=d.parse(f[1],1,Kr);if(!y)return null;var T=f[2];if(typeof T!="object"||Array.isArray(T))return d.error("NumberFormat options argument must be an object.");var O=null;if(T.locale&&!(O=d.parse(T.locale,1,ai)))return null;var N=null;if(T.currency&&!(N=d.parse(T.currency,1,ai)))return null;var Z=null;if(T["min-fraction-digits"]&&!(Z=d.parse(T["min-fraction-digits"],1,Kr)))return null;var K=null;return T["max-fraction-digits"]&&!(K=d.parse(T["max-fraction-digits"],1,Kr))?null:new $s(y,O,N,Z,K)},$s.prototype.evaluate=function(f){return new Intl.NumberFormat(this.locale?this.locale.evaluate(f):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(f):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(f):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(f):void 0}).format(this.number.evaluate(f))},$s.prototype.eachChild=function(f){f(this.number),this.locale&&f(this.locale),this.currency&&f(this.currency),this.minFractionDigits&&f(this.minFractionDigits),this.maxFractionDigits&&f(this.maxFractionDigits)},$s.prototype.outputDefined=function(){return!1},$s.prototype.serialize=function(){var f={};return this.locale&&(f.locale=this.locale.serialize()),this.currency&&(f.currency=this.currency.serialize()),this.minFractionDigits&&(f["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(f["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),f]};var Yl=function(f){this.type=Kr,this.input=f};Yl.parse=function(f,d){if(f.length!==2)return d.error("Expected 1 argument, but found "+(f.length-1)+" instead.");var y=d.parse(f[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?d.error("Expected argument of type string or array, but found "+Ta(y.type)+" instead."):new Yl(y):null},Yl.prototype.evaluate=function(f){var d=this.input.evaluate(f);if(typeof d=="string"||Array.isArray(d))return d.length;throw new In("Expected value to be of type string or array, but found "+Ta(He(d))+" instead.")},Yl.prototype.eachChild=function(f){f(this.input)},Yl.prototype.outputDefined=function(){return!1},Yl.prototype.serialize=function(){var f=["length"];return this.eachChild(function(d){f.push(d.serialize())}),f};var ye={"==":gs,"!=":xu,">":bu,"<":il,">=":Vc,"<=":iu,array:Cn,at:Ln,boolean:Cn,case:ba,coalesce:jr,collator:pu,format:ta,image:Wa,in:Gn,"index-of":$i,interpolate:Ve,"interpolate-hcl":Ve,"interpolate-lab":Ve,length:Yl,let:Vr,literal:tn,match:Pa,number:Cn,"number-format":$s,object:Cn,slice:uo,step:Fu,string:Cn,"to-boolean":ko,"to-color":ko,"to-number":ko,"to-string":ko,var:rl,within:Xu};function ir(f,d){var y=d[0],T=d[1],O=d[2],N=d[3];y=y.evaluate(f),T=T.evaluate(f),O=O.evaluate(f);var Z=N?N.evaluate(f):1,K=nr(y,T,O,Z);if(K)throw new In(K);return new to(y/255*Z,T/255*Z,O/255*Z,Z)}function Or(f,d){return f in d}function $r(f,d){var y=d[f];return y===void 0?null:y}function xn(f){return{type:f}}function _i(f){return{result:"success",value:f}}function qi(f){return{result:"error",value:f}}function Ia(f){return f["property-type"]==="data-driven"||f["property-type"]==="cross-faded-data-driven"}function du(f){return!!f.expression&&f.expression.parameters.indexOf("zoom")>-1}function qs(f){return!!f.expression&&f.expression.interpolated}function $a(f){return f instanceof Number?"number":f instanceof String?"string":f instanceof Boolean?"boolean":Array.isArray(f)?"array":f===null?"null":typeof f}function Dl(f){return typeof f=="object"&&f!==null&&!Array.isArray(f)}function av(f){return f}function yf(f,d,y){return f!==void 0?f:d!==void 0?d:y!==void 0?y:void 0}function vd(f,d,y,T,O){return yf(typeof y===O?T[y]:void 0,f.default,d.default)}function ov(f,d,y){if($a(y)!=="number")return yf(f.default,d.default);var T=f.stops.length;if(T===1||y<=f.stops[0][0])return f.stops[0][1];if(y>=f.stops[T-1][0])return f.stops[T-1][1];var O=dl(f.stops.map(function(N){return N[0]}),y);return f.stops[O][1]}function sv(f,d,y){var T=f.base!==void 0?f.base:1;if($a(y)!=="number")return yf(f.default,d.default);var O=f.stops.length;if(O===1||y<=f.stops[0][0])return f.stops[0][1];if(y>=f.stops[O-1][0])return f.stops[O-1][1];var N=dl(f.stops.map(function(Kt){return Kt[0]}),y),Z=function(Kt,pe,Fe,sr){var lr=sr-Fe,Cr=Kt-Fe;return lr===0?0:pe===1?Cr/lr:(Math.pow(pe,Cr)-1)/(Math.pow(pe,lr)-1)}(y,T,f.stops[N][0],f.stops[N+1][0]),K=f.stops[N][1],mt=f.stops[N+1][1],Ot=rs[d.type]||av;if(f.colorSpace&&f.colorSpace!=="rgb"){var Gt=se[f.colorSpace];Ot=function(Kt,pe){return Gt.reverse(Gt.interpolate(Gt.forward(Kt),Gt.forward(pe),Z))}}return typeof K.evaluate=="function"?{evaluate:function(){for(var Kt=[],pe=arguments.length;pe--;)Kt[pe]=arguments[pe];var Fe=K.evaluate.apply(void 0,Kt),sr=mt.evaluate.apply(void 0,Kt);if(Fe!==void 0&&sr!==void 0)return Ot(Fe,sr,Z)}}:Ot(K,mt,Z)}function dh(f,d,y){return d.type==="color"?y=to.parse(y):d.type==="formatted"?y=Wo.fromString(y.toString()):d.type==="resolvedImage"?y=bo.fromString(y.toString()):$a(y)===d.type||d.type==="enum"&&d.values[y]||(y=void 0),yf(y,f.default,d.default)}Go.register(ye,{error:[{kind:"error"},[ai],function(f,d){throw new In(d[0].evaluate(f))}],typeof:[ai,[Ci],function(f,d){return Ta(He(d[0].evaluate(f)))}],"to-rgba":[Xa(Kr,4),[hi],function(f,d){return d[0].evaluate(f).toArray()}],rgb:[hi,[Kr,Kr,Kr],ir],rgba:[hi,[Kr,Kr,Kr,Kr],ir],has:{type:li,overloads:[[[ai],function(f,d){return Or(d[0].evaluate(f),f.properties())}],[[ai,ra],function(f,d){var y=d[1];return Or(d[0].evaluate(f),y.evaluate(f))}]]},get:{type:Ci,overloads:[[[ai],function(f,d){return $r(d[0].evaluate(f),f.properties())}],[[ai,ra],function(f,d){var y=d[1];return $r(d[0].evaluate(f),y.evaluate(f))}]]},"feature-state":[Ci,[ai],function(f,d){return $r(d[0].evaluate(f),f.featureState||{})}],properties:[ra,[],function(f){return f.properties()}],"geometry-type":[ai,[],function(f){return f.geometryType()}],id:[Ci,[],function(f){return f.id()}],zoom:[Kr,[],function(f){return f.globals.zoom}],"heatmap-density":[Kr,[],function(f){return f.globals.heatmapDensity||0}],"line-progress":[Kr,[],function(f){return f.globals.lineProgress||0}],accumulated:[Ci,[],function(f){return f.globals.accumulated===void 0?null:f.globals.accumulated}],"+":[Kr,xn(Kr),function(f,d){for(var y=0,T=0,O=d;T<O.length;T+=1)y+=O[T].evaluate(f);return y}],"*":[Kr,xn(Kr),function(f,d){for(var y=1,T=0,O=d;T<O.length;T+=1)y*=O[T].evaluate(f);return y}],"-":{type:Kr,overloads:[[[Kr,Kr],function(f,d){var y=d[1];return d[0].evaluate(f)-y.evaluate(f)}],[[Kr],function(f,d){return-d[0].evaluate(f)}]]},"/":[Kr,[Kr,Kr],function(f,d){var y=d[1];return d[0].evaluate(f)/y.evaluate(f)}],"%":[Kr,[Kr,Kr],function(f,d){var y=d[1];return d[0].evaluate(f)%y.evaluate(f)}],ln2:[Kr,[],function(){return Math.LN2}],pi:[Kr,[],function(){return Math.PI}],e:[Kr,[],function(){return Math.E}],"^":[Kr,[Kr,Kr],function(f,d){var y=d[1];return Math.pow(d[0].evaluate(f),y.evaluate(f))}],sqrt:[Kr,[Kr],function(f,d){return Math.sqrt(d[0].evaluate(f))}],log10:[Kr,[Kr],function(f,d){return Math.log(d[0].evaluate(f))/Math.LN10}],ln:[Kr,[Kr],function(f,d){return Math.log(d[0].evaluate(f))}],log2:[Kr,[Kr],function(f,d){return Math.log(d[0].evaluate(f))/Math.LN2}],sin:[Kr,[Kr],function(f,d){return Math.sin(d[0].evaluate(f))}],cos:[Kr,[Kr],function(f,d){return Math.cos(d[0].evaluate(f))}],tan:[Kr,[Kr],function(f,d){return Math.tan(d[0].evaluate(f))}],asin:[Kr,[Kr],function(f,d){return Math.asin(d[0].evaluate(f))}],acos:[Kr,[Kr],function(f,d){return Math.acos(d[0].evaluate(f))}],atan:[Kr,[Kr],function(f,d){return Math.atan(d[0].evaluate(f))}],min:[Kr,xn(Kr),function(f,d){return Math.min.apply(Math,d.map(function(y){return y.evaluate(f)}))}],max:[Kr,xn(Kr),function(f,d){return Math.max.apply(Math,d.map(function(y){return y.evaluate(f)}))}],abs:[Kr,[Kr],function(f,d){return Math.abs(d[0].evaluate(f))}],round:[Kr,[Kr],function(f,d){var y=d[0].evaluate(f);return y<0?-Math.round(-y):Math.round(y)}],floor:[Kr,[Kr],function(f,d){return Math.floor(d[0].evaluate(f))}],ceil:[Kr,[Kr],function(f,d){return Math.ceil(d[0].evaluate(f))}],"filter-==":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1];return f.properties()[y.value]===T.value}],"filter-id-==":[li,[Ci],function(f,d){var y=d[0];return f.id()===y.value}],"filter-type-==":[li,[ai],function(f,d){var y=d[0];return f.geometryType()===y.value}],"filter-<":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O<N}],"filter-id-<":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T<O}],"filter->":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O>N}],"filter-id->":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T>O}],"filter-<=":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O<=N}],"filter-id-<=":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T<=O}],"filter->=":[li,[ai,Ci],function(f,d){var y=d[0],T=d[1],O=f.properties()[y.value],N=T.value;return typeof O==typeof N&&O>=N}],"filter-id->=":[li,[Ci],function(f,d){var y=d[0],T=f.id(),O=y.value;return typeof T==typeof O&&T>=O}],"filter-has":[li,[Ci],function(f,d){return d[0].value in f.properties()}],"filter-has-id":[li,[],function(f){return f.id()!==null&&f.id()!==void 0}],"filter-type-in":[li,[Xa(ai)],function(f,d){return d[0].value.indexOf(f.geometryType())>=0}],"filter-id-in":[li,[Xa(Ci)],function(f,d){return d[0].value.indexOf(f.id())>=0}],"filter-in-small":[li,[ai,Xa(Ci)],function(f,d){var y=d[0];return d[1].value.indexOf(f.properties()[y.value])>=0}],"filter-in-large":[li,[ai,Xa(Ci)],function(f,d){var y=d[0],T=d[1];return function(O,N,Z,K){for(;Z<=K;){var mt=Z+K>>1;if(N[mt]===O)return!0;N[mt]>O?K=mt-1:Z=mt+1}return!1}(f.properties()[y.value],T.value,0,T.value.length-1)}],all:{type:li,overloads:[[[li,li],function(f,d){var y=d[1];return d[0].evaluate(f)&&y.evaluate(f)}],[xn(li),function(f,d){for(var y=0,T=d;y<T.length;y+=1)if(!T[y].evaluate(f))return!1;return!0}]]},any:{type:li,overloads:[[[li,li],function(f,d){var y=d[1];return d[0].evaluate(f)||y.evaluate(f)}],[xn(li),function(f,d){for(var y=0,T=d;y<T.length;y+=1)if(T[y].evaluate(f))return!0;return!1}]]},"!":[li,[li],function(f,d){return!d[0].evaluate(f)}],"is-supported-script":[li,[ai],function(f,d){var y=f.globals&&f.globals.isSupportedScript;return!y||y(d[0].evaluate(f))}],upcase:[ai,[ai],function(f,d){return d[0].evaluate(f).toUpperCase()}],downcase:[ai,[ai],function(f,d){return d[0].evaluate(f).toLowerCase()}],concat:[ai,xn(Ci),function(f,d){return d.map(function(y){return Mr(y.evaluate(f))}).join("")}],"resolved-locale":[ai,[Ba],function(f,d){return d[0].evaluate(f).resolvedLocale()}]});var zf=function(f,d){this.expression=f,this._warningHistory={},this._evaluator=new Ya,this._defaultValue=d?function(y){return y.type==="color"&&Dl(y.default)?new to(0,0,0,0):y.type==="color"?to.parse(y.default)||null:y.default===void 0?null:y.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null};function Gc(f){return Array.isArray(f)&&f.length>0&&typeof f[0]=="string"&&f[0]in ye}function vh(f,d){var y=new nu(ye,[],d?function(O){var N={color:hi,string:ai,number:Kr,enum:ai,boolean:li,formatted:po,resolvedImage:za};return O.type==="array"?Xa(N[O.value]||Ci,O.length):N[O.type]}(d):void 0),T=y.parse(f,void 0,void 0,void 0,d&&d.type==="string"?{typeAnnotation:"coerce"}:void 0);return T?_i(new zf(T,d)):qi(y.errors)}zf.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._evaluator.globals=f,this._evaluator.feature=d,this._evaluator.featureState=y,this._evaluator.canonical=T,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=N,this.expression.evaluate(this._evaluator)},zf.prototype.evaluate=function(f,d,y,T,O,N){this._evaluator.globals=f,this._evaluator.feature=d||null,this._evaluator.featureState=y||null,this._evaluator.canonical=T,this._evaluator.availableImages=O||null,this._evaluator.formattedSection=N||null;try{var Z=this.expression.evaluate(this._evaluator);if(Z==null||typeof Z=="number"&&Z!=Z)return this._defaultValue;if(this._enumValues&&!(Z in this._enumValues))throw new In("Expected value to be one of "+Object.keys(this._enumValues).map(function(K){return JSON.stringify(K)}).join(", ")+", but found "+JSON.stringify(Z)+" instead.");return Z}catch(K){return this._warningHistory[K.message]||(this._warningHistory[K.message]=!0,typeof console!="undefined"&&console.warn(K.message)),this._defaultValue}};var Uf=function(f,d){this.kind=f,this._styleExpression=d,this.isStateDependent=f!=="constant"&&!vs(d.expression)};Uf.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._styleExpression.evaluateWithoutErrorHandling(f,d,y,T,O,N)},Uf.prototype.evaluate=function(f,d,y,T,O,N){return this._styleExpression.evaluate(f,d,y,T,O,N)};var lc=function(f,d,y,T){this.kind=f,this.zoomStops=y,this._styleExpression=d,this.isStateDependent=f!=="camera"&&!vs(d.expression),this.interpolationType=T};function al(f,d){if((f=vh(f,d)).result==="error")return f;var y=f.value.expression,T=_s(y);if(!T&&!Ia(d))return qi([new Mn("","data expressions not supported")]);var O=Ou(y,["zoom"]);if(!O&&!du(d))return qi([new Mn("","zoom expressions not supported")]);var N=function Z(K){var mt=null;if(K instanceof Vr)mt=Z(K.result);else if(K instanceof jr)for(var Ot=0,Gt=K.args;Ot<Gt.length&&!(mt=Z(Gt[Ot]));Ot+=1);else(K instanceof Fu||K instanceof Ve)&&K.input instanceof Go&&K.input.name==="zoom"&&(mt=K);return mt instanceof Mn||K.eachChild(function(Kt){var pe=Z(Kt);pe instanceof Mn?mt=pe:!mt&&pe?mt=new Mn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):mt&&pe&&mt!==pe&&(mt=new Mn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),mt}(y);return N||O?N instanceof Mn?qi([N]):N instanceof Ve&&!qs(d)?qi([new Mn("",'"interpolate" expressions cannot be used with this property')]):_i(N?new lc(T?"camera":"composite",f.value,N.labels,N instanceof Ve?N.interpolation:void 0):new Uf(T?"constant":"source",f.value)):qi([new Mn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}lc.prototype.evaluateWithoutErrorHandling=function(f,d,y,T,O,N){return this._styleExpression.evaluateWithoutErrorHandling(f,d,y,T,O,N)},lc.prototype.evaluate=function(f,d,y,T,O,N){return this._styleExpression.evaluate(f,d,y,T,O,N)},lc.prototype.interpolationFactor=function(f,d,y){return this.interpolationType?Ve.interpolationFactor(this.interpolationType,f,d,y):0};var _f=function(f,d){this._parameters=f,this._specification=d,Sn(this,function y(T,O){var N,Z,K,mt=O.type==="color",Ot=T.stops&&typeof T.stops[0][0]=="object",Gt=Ot||!(Ot||T.property!==void 0),Kt=T.type||(qs(O)?"exponential":"interval");if(mt&&((T=Sn({},T)).stops&&(T.stops=T.stops.map(function(Di){return[Di[0],to.parse(Di[1])]})),T.default=to.parse(T.default?T.default:O.default)),T.colorSpace&&T.colorSpace!=="rgb"&&!se[T.colorSpace])throw new Error("Unknown color space: "+T.colorSpace);if(Kt==="exponential")N=sv;else if(Kt==="interval")N=ov;else if(Kt==="categorical"){N=vd,Z=Object.create(null);for(var pe=0,Fe=T.stops;pe<Fe.length;pe+=1){var sr=Fe[pe];Z[sr[0]]=sr[1]}K=typeof T.stops[0][0]}else{if(Kt!=="identity")throw new Error('Unknown function type "'+Kt+'"');N=dh}if(Ot){for(var lr={},Cr=[],gr=0;gr<T.stops.length;gr++){var Ur=T.stops[gr],Ar=Ur[0].zoom;lr[Ar]===void 0&&(lr[Ar]={zoom:Ar,type:T.type,property:T.property,default:T.default,stops:[]},Cr.push(Ar)),lr[Ar].stops.push([Ur[0].value,Ur[1]])}for(var Dr=[],mn=0,Fn=Cr;mn<Fn.length;mn+=1){var ni=Fn[mn];Dr.push([lr[ni].zoom,y(lr[ni],O)])}var ki={name:"linear"};return{kind:"composite",interpolationType:ki,interpolationFactor:Ve.interpolationFactor.bind(void 0,ki),zoomStops:Dr.map(function(Di){return Di[0]}),evaluate:function(Di,ca){var zi=Di.zoom;return sv({stops:Dr,base:T.base},O,zi).evaluate(zi,ca)}}}if(Gt){var oa=Kt==="exponential"?{name:"exponential",base:T.base!==void 0?T.base:1}:null;return{kind:"camera",interpolationType:oa,interpolationFactor:Ve.interpolationFactor.bind(void 0,oa),zoomStops:T.stops.map(function(Di){return Di[0]}),evaluate:function(Di){return N(T,O,Di.zoom,Z,K)}}}return{kind:"source",evaluate:function(Di,ca){var zi=ca&&ca.properties?ca.properties[T.property]:void 0;return zi===void 0?yf(T.default,O.default):N(T,O,zi,Z,K)}}}(this._parameters,this._specification))};function vl(f){var d=f.key,y=f.value,T=f.valueSpec||{},O=f.objectElementValidators||{},N=f.style,Z=f.styleSpec,K=[],mt=$a(y);if(mt!=="object")return[new ur(d,y,"object expected, "+mt+" found")];for(var Ot in y){var Gt=Ot.split(".")[0],Kt=T[Gt]||T["*"],pe=void 0;if(O[Gt])pe=O[Gt];else if(T[Gt])pe=go;else if(O["*"])pe=O["*"];else{if(!T["*"]){K.push(new ur(d,y[Ot],'unknown property "'+Ot+'"'));continue}pe=go}K=K.concat(pe({key:(d&&d+".")+Ot,value:y[Ot],valueSpec:Kt,style:N,styleSpec:Z,object:y,objectKey:Ot},y))}for(var Fe in T)O[Fe]||T[Fe].required&&T[Fe].default===void 0&&y[Fe]===void 0&&K.push(new ur(d,y,'missing required property "'+Fe+'"'));return K}function Eu(f){var d=f.value,y=f.valueSpec,T=f.style,O=f.styleSpec,N=f.key,Z=f.arrayElementValidator||go;if($a(d)!=="array")return[new ur(N,d,"array expected, "+$a(d)+" found")];if(y.length&&d.length!==y.length)return[new ur(N,d,"array length "+y.length+" expected, length "+d.length+" found")];if(y["min-length"]&&d.length<y["min-length"])return[new ur(N,d,"array length at least "+y["min-length"]+" expected, length "+d.length+" found")];var K={type:y.value,values:y.values};O.$version<7&&(K.function=y.function),$a(y.value)==="object"&&(K=y.value);for(var mt=[],Ot=0;Ot<d.length;Ot++)mt=mt.concat(Z({array:d,arrayIndex:Ot,value:d[Ot],valueSpec:K,style:T,styleSpec:O,key:N+"["+Ot+"]"}));return mt}function Yh(f){var d=f.key,y=f.value,T=f.valueSpec,O=$a(y);return O==="number"&&y!=y&&(O="NaN"),O!=="number"?[new ur(d,y,"number expected, "+O+" found")]:"minimum"in T&&y<T.minimum?[new ur(d,y,y+" is less than the minimum value "+T.minimum)]:"maximum"in T&&y>T.maximum?[new ur(d,y,y+" is greater than the maximum value "+T.maximum)]:[]}function Pp(f){var d,y,T,O=f.valueSpec,N=qr(f.value.type),Z={},K=N!=="categorical"&&f.value.property===void 0,mt=!K,Ot=$a(f.value.stops)==="array"&&$a(f.value.stops[0])==="array"&&$a(f.value.stops[0][0])==="object",Gt=vl({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(Fe){if(N==="identity")return[new ur(Fe.key,Fe.value,'identity function may not have a "stops" property')];var sr=[],lr=Fe.value;return sr=sr.concat(Eu({key:Fe.key,value:lr,valueSpec:Fe.valueSpec,style:Fe.style,styleSpec:Fe.styleSpec,arrayElementValidator:Kt})),$a(lr)==="array"&&lr.length===0&&sr.push(new ur(Fe.key,lr,"array must have at least one stop")),sr},default:function(Fe){return go({key:Fe.key,value:Fe.value,valueSpec:O,style:Fe.style,styleSpec:Fe.styleSpec})}}});return N==="identity"&&K&&Gt.push(new ur(f.key,f.value,'missing required property "property"')),N==="identity"||f.value.stops||Gt.push(new ur(f.key,f.value,'missing required property "stops"')),N==="exponential"&&f.valueSpec.expression&&!qs(f.valueSpec)&&Gt.push(new ur(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(mt&&!Ia(f.valueSpec)?Gt.push(new ur(f.key,f.value,"property functions not supported")):K&&!du(f.valueSpec)&&Gt.push(new ur(f.key,f.value,"zoom functions not supported"))),N!=="categorical"&&!Ot||f.value.property!==void 0||Gt.push(new ur(f.key,f.value,'"property" property is required')),Gt;function Kt(Fe){var sr=[],lr=Fe.value,Cr=Fe.key;if($a(lr)!=="array")return[new ur(Cr,lr,"array expected, "+$a(lr)+" found")];if(lr.length!==2)return[new ur(Cr,lr,"array length 2 expected, length "+lr.length+" found")];if(Ot){if($a(lr[0])!=="object")return[new ur(Cr,lr,"object expected, "+$a(lr[0])+" found")];if(lr[0].zoom===void 0)return[new ur(Cr,lr,"object stop key must have zoom")];if(lr[0].value===void 0)return[new ur(Cr,lr,"object stop key must have value")];if(T&&T>qr(lr[0].zoom))return[new ur(Cr,lr[0].zoom,"stop zoom values must appear in ascending order")];qr(lr[0].zoom)!==T&&(T=qr(lr[0].zoom),y=void 0,Z={}),sr=sr.concat(vl({key:Cr+"[0]",value:lr[0],valueSpec:{zoom:{}},style:Fe.style,styleSpec:Fe.styleSpec,objectElementValidators:{zoom:Yh,value:pe}}))}else sr=sr.concat(pe({key:Cr+"[0]",value:lr[0],valueSpec:{},style:Fe.style,styleSpec:Fe.styleSpec},lr));return Gc(Qr(lr[1]))?sr.concat([new ur(Cr+"[1]",lr[1],"expressions are not allowed in function stops.")]):sr.concat(go({key:Cr+"[1]",value:lr[1],valueSpec:O,style:Fe.style,styleSpec:Fe.styleSpec}))}function pe(Fe,sr){var lr=$a(Fe.value),Cr=qr(Fe.value),gr=Fe.value!==null?Fe.value:sr;if(d){if(lr!==d)return[new ur(Fe.key,gr,lr+" stop domain type must match previous stop domain type "+d)]}else d=lr;if(lr!=="number"&&lr!=="string"&&lr!=="boolean")return[new ur(Fe.key,gr,"stop domain value must be a number, string, or boolean")];if(lr!=="number"&&N!=="categorical"){var Ur="number expected, "+lr+" found";return Ia(O)&&N===void 0&&(Ur+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ur(Fe.key,gr,Ur)]}return N!=="categorical"||lr!=="number"||isFinite(Cr)&&Math.floor(Cr)===Cr?N!=="categorical"&&lr==="number"&&y!==void 0&&Cr<y?[new ur(Fe.key,gr,"stop domain values must appear in ascending order")]:(y=Cr,N==="categorical"&&Cr in Z?[new ur(Fe.key,gr,"stop domain values must be unique")]:(Z[Cr]=!0,[])):[new ur(Fe.key,gr,"integer expected, found "+Cr)]}}function Sc(f){var d=(f.expressionContext==="property"?al:vh)(Qr(f.value),f.valueSpec);if(d.result==="error")return d.value.map(function(T){return new ur(""+f.key+T.key,f.value,T.message)});var y=d.value.expression||d.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!y.outputDefined())return[new ur(f.key,f.value,'Invalid data expression for "'+f.propertyKey+'". Output values must be contained as literals within the expression.')];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!vs(y))return[new ur(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter"&&!vs(y))return[new ur(f.key,f.value,'"feature-state" data expressions are not supported with filters.')];if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!Ou(y,["zoom","feature-state"]))return[new ur(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!_s(y))return[new ur(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function gl(f){var d=f.key,y=f.value,T=f.valueSpec,O=[];return Array.isArray(T.values)?T.values.indexOf(qr(y))===-1&&O.push(new ur(d,y,"expected one of ["+T.values.join(", ")+"], "+JSON.stringify(y)+" found")):Object.keys(T.values).indexOf(qr(y))===-1&&O.push(new ur(d,y,"expected one of ["+Object.keys(T.values).join(", ")+"], "+JSON.stringify(y)+" found")),O}function $h(f){if(f===!0||f===!1)return!0;if(!Array.isArray(f)||f.length===0)return!1;switch(f[0]){case"has":return f.length>=2&&f[1]!=="$id"&&f[1]!=="$type";case"in":return f.length>=3&&(typeof f[1]!="string"||Array.isArray(f[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return f.length!==3||Array.isArray(f[1])||Array.isArray(f[2]);case"any":case"all":for(var d=0,y=f.slice(1);d<y.length;d+=1){var T=y[d];if(!$h(T)&&typeof T!="boolean")return!1}return!0;default:return!0}}_f.deserialize=function(f){return new _f(f._parameters,f._specification)},_f.serialize=function(f){return{_parameters:f._parameters,_specification:f._specification}};var qh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Op(f){if(f==null)return{filter:function(){return!0},needGeometry:!1};$h(f)||(f=Kh(f));var d=vh(f,qh);if(d.result==="error")throw new Error(d.value.map(function(y){return y.key+": "+y.message}).join(", "));return{filter:function(y,T,O){return d.value.evaluate(y,T,{},O)},needGeometry:function y(T){if(!Array.isArray(T))return!1;if(T[0]==="within")return!0;for(var O=1;O<T.length;O++)if(y(T[O]))return!0;return!1}(f)}}function Hc(f,d){return f<d?-1:f>d?1:0}function Kh(f){if(!f)return!0;var d,y=f[0];return f.length<=1?y!=="any":y==="=="?$l(f[1],f[2],"=="):y==="!="?Tl($l(f[1],f[2],"==")):y==="<"||y===">"||y==="<="||y===">="?$l(f[1],f[2],y):y==="any"?(d=f.slice(1),["any"].concat(d.map(Kh))):y==="all"?["all"].concat(f.slice(1).map(Kh)):y==="none"?["all"].concat(f.slice(1).map(Kh).map(Tl)):y==="in"?Qh(f[1],f.slice(2)):y==="!in"?Tl(Qh(f[1],f.slice(2))):y==="has"?Zf(f[1]):y==="!has"?Tl(Zf(f[1])):y!=="within"||f}function $l(f,d,y){switch(f){case"$type":return["filter-type-"+y,d];case"$id":return["filter-id-"+y,d];default:return["filter-"+y,f,d]}}function Qh(f,d){if(d.length===0)return!1;switch(f){case"$type":return["filter-type-in",["literal",d]];case"$id":return["filter-id-in",["literal",d]];default:return d.length>200&&!d.some(function(y){return typeof y!=typeof d[0]})?["filter-in-large",f,["literal",d.sort(Hc)]]:["filter-in-small",f,["literal",d]]}}function Zf(f){switch(f){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",f]}}function Tl(f){return["!",f]}function gd(f){return $h(Qr(f.value))?Sc(Sn({},f,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function d(y){var T=y.value,O=y.key;if($a(T)!=="array")return[new ur(O,T,"array expected, "+$a(T)+" found")];var N,Z=y.styleSpec,K=[];if(T.length<1)return[new ur(O,T,"filter array must have at least 1 element")];switch(K=K.concat(gl({key:O+"[0]",value:T[0],valueSpec:Z.filter_operator,style:y.style,styleSpec:y.styleSpec})),qr(T[0])){case"<":case"<=":case">":case">=":T.length>=2&&qr(T[1])==="$type"&&K.push(new ur(O,T,'"$type" cannot be use with operator "'+T[0]+'"'));case"==":case"!=":T.length!==3&&K.push(new ur(O,T,'filter array for operator "'+T[0]+'" must have 3 elements'));case"in":case"!in":T.length>=2&&(N=$a(T[1]))!=="string"&&K.push(new ur(O+"[1]",T[1],"string expected, "+N+" found"));for(var mt=2;mt<T.length;mt++)N=$a(T[mt]),qr(T[1])==="$type"?K=K.concat(gl({key:O+"["+mt+"]",value:T[mt],valueSpec:Z.geometry_type,style:y.style,styleSpec:y.styleSpec})):N!=="string"&&N!=="number"&&N!=="boolean"&&K.push(new ur(O+"["+mt+"]",T[mt],"string, number, or boolean expected, "+N+" found"));break;case"any":case"all":case"none":for(var Ot=1;Ot<T.length;Ot++)K=K.concat(d({key:O+"["+Ot+"]",value:T[Ot],style:y.style,styleSpec:y.styleSpec}));break;case"has":case"!has":N=$a(T[1]),T.length!==2?K.push(new ur(O,T,'filter array for "'+T[0]+'" operator must have 2 elements')):N!=="string"&&K.push(new ur(O+"[1]",T[1],"string expected, "+N+" found"));break;case"within":N=$a(T[1]),T.length!==2?K.push(new ur(O,T,'filter array for "'+T[0]+'" operator must have 2 elements')):N!=="object"&&K.push(new ur(O+"[1]",T[1],"object expected, "+N+" found"))}return K}(f)}function md(f,d){var y=f.key,T=f.style,O=f.styleSpec,N=f.value,Z=f.objectKey,K=O[d+"_"+f.layerType];if(!K)return[];var mt=Z.match(/^(.*)-transition$/);if(d==="paint"&&mt&&K[mt[1]]&&K[mt[1]].transition)return go({key:y,value:N,valueSpec:O.transition,style:T,styleSpec:O});var Ot,Gt=f.valueSpec||K[Z];if(!Gt)return[new ur(y,N,'unknown property "'+Z+'"')];if($a(N)==="string"&&Ia(Gt)&&!Gt.tokens&&(Ot=/^{([^}]+)}$/.exec(N)))return[new ur(y,N,'"'+Z+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(Ot[1])+" }`.")];var Kt=[];return f.layerType==="symbol"&&(Z==="text-field"&&T&&!T.glyphs&&Kt.push(new ur(y,N,'use of "text-field" requires a style "glyphs" property')),Z==="text-font"&&Dl(Qr(N))&&qr(N.type)==="identity"&&Kt.push(new ur(y,N,'"text-font" does not support identity functions'))),Kt.concat(go({key:f.key,value:N,valueSpec:Gt,style:T,styleSpec:O,expressionContext:"property",propertyType:d,propertyKey:Z}))}function yd(f){return md(f,"paint")}function gh(f){return md(f,"layout")}function _d(f){var d=[],y=f.value,T=f.key,O=f.style,N=f.styleSpec;y.type||y.ref||d.push(new ur(T,y,'either "type" or "ref" is required'));var Z,K=qr(y.type),mt=qr(y.ref);if(y.id)for(var Ot=qr(y.id),Gt=0;Gt<f.arrayIndex;Gt++){var Kt=O.layers[Gt];qr(Kt.id)===Ot&&d.push(new ur(T,y.id,'duplicate layer id "'+y.id+'", previously used at line '+Kt.id.__line__))}if("ref"in y)["type","source","source-layer","filter","layout"].forEach(function(sr){sr in y&&d.push(new ur(T,y[sr],'"'+sr+'" is prohibited for ref layers'))}),O.layers.forEach(function(sr){qr(sr.id)===mt&&(Z=sr)}),Z?Z.ref?d.push(new ur(T,y.ref,"ref cannot reference another ref layer")):K=qr(Z.type):d.push(new ur(T,y.ref,'ref layer "'+mt+'" not found'));else if(K!=="background")if(y.source){var pe=O.sources&&O.sources[y.source],Fe=pe&&qr(pe.type);pe?Fe==="vector"&&K==="raster"?d.push(new ur(T,y.source,'layer "'+y.id+'" requires a raster source')):Fe==="raster"&&K!=="raster"?d.push(new ur(T,y.source,'layer "'+y.id+'" requires a vector source')):Fe!=="vector"||y["source-layer"]?Fe==="raster-dem"&&K!=="hillshade"?d.push(new ur(T,y.source,"raster-dem source can only be used with layer type 'hillshade'.")):K!=="line"||!y.paint||!y.paint["line-gradient"]||Fe==="geojson"&&pe.lineMetrics||d.push(new ur(T,y,'layer "'+y.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):d.push(new ur(T,y,'layer "'+y.id+'" must specify a "source-layer"')):d.push(new ur(T,y.source,'source "'+y.source+'" not found'))}else d.push(new ur(T,y,'missing required property "source"'));return d=d.concat(vl({key:T,value:y,valueSpec:N.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return go({key:T+".type",value:y.type,valueSpec:N.layer.type,style:f.style,styleSpec:f.styleSpec,object:y,objectKey:"type"})},filter:gd,layout:function(sr){return vl({layer:y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(lr){return gh(Sn({layerType:K},lr))}}})},paint:function(sr){return vl({layer:y,key:sr.key,value:sr.value,style:sr.style,styleSpec:sr.styleSpec,objectElementValidators:{"*":function(lr){return yd(Sn({layerType:K},lr))}}})}}}))}function xf(f){var d=f.value,y=f.key,T=$a(d);return T!=="string"?[new ur(y,d,"string expected, "+T+" found")]:[]}var xs={promoteId:function(f){var d=f.key,y=f.value;if($a(y)==="string")return xf({key:d,value:y});var T=[];for(var O in y)T.push.apply(T,xf({key:d+"."+O,value:y[O]}));return T}};function Jh(f){var d=f.value,y=f.key,T=f.styleSpec,O=f.style;if(!d.type)return[new ur(y,d,'"type" is required')];var N,Z=qr(d.type);switch(Z){case"vector":case"raster":case"raster-dem":return vl({key:y,value:d,valueSpec:T["source_"+Z.replace("-","_")],style:f.style,styleSpec:T,objectElementValidators:xs});case"geojson":if(N=vl({key:y,value:d,valueSpec:T.source_geojson,style:O,styleSpec:T,objectElementValidators:xs}),d.cluster)for(var K in d.clusterProperties){var mt=d.clusterProperties[K],Ot=mt[0],Gt=typeof Ot=="string"?[Ot,["accumulated"],["get",K]]:Ot;N.push.apply(N,Sc({key:y+"."+K+".map",value:mt[1],expressionContext:"cluster-map"})),N.push.apply(N,Sc({key:y+"."+K+".reduce",value:Gt,expressionContext:"cluster-reduce"}))}return N;case"video":return vl({key:y,value:d,valueSpec:T.source_video,style:O,styleSpec:T});case"image":return vl({key:y,value:d,valueSpec:T.source_image,style:O,styleSpec:T});case"canvas":return[new ur(y,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return gl({key:y+".type",value:d.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:O,styleSpec:T})}}function Vf(f){var d=f.value,y=f.styleSpec,T=y.light,O=f.style,N=[],Z=$a(d);if(d===void 0)return N;if(Z!=="object")return N.concat([new ur("light",d,"object expected, "+Z+" found")]);for(var K in d){var mt=K.match(/^(.*)-transition$/);N=N.concat(mt&&T[mt[1]]&&T[mt[1]].transition?go({key:K,value:d[K],valueSpec:y.transition,style:O,styleSpec:y}):T[K]?go({key:K,value:d[K],valueSpec:T[K],style:O,styleSpec:y}):[new ur(K,d[K],'unknown property "'+K+'"')])}return N}var Bl={"*":function(){return[]},array:Eu,boolean:function(f){var d=f.value,y=f.key,T=$a(d);return T!=="boolean"?[new ur(y,d,"boolean expected, "+T+" found")]:[]},number:Yh,color:function(f){var d=f.key,y=f.value,T=$a(y);return T!=="string"?[new ur(d,y,"color expected, "+T+" found")]:ja(y)===null?[new ur(d,y,'color expected, "'+y+'" found')]:[]},constants:Wr,enum:gl,filter:gd,function:Pp,layer:_d,object:vl,source:Jh,light:Vf,string:xf,formatted:function(f){return xf(f).length===0?[]:Sc(f)},resolvedImage:function(f){return xf(f).length===0?[]:Sc(f)}};function go(f){var d=f.value,y=f.valueSpec,T=f.styleSpec;return y.expression&&Dl(qr(d))?Pp(f):y.expression&&Gc(Qr(d))?Sc(f):y.type&&Bl[y.type]?Bl[y.type](f):vl(Sn({},f,{valueSpec:y.type?T[y.type]:y}))}function is(f){var d=f.value,y=f.key,T=xf(f);return T.length||(d.indexOf("{fontstack}")===-1&&T.push(new ur(y,d,'"glyphs" url must include a "{fontstack}" token')),d.indexOf("{range}")===-1&&T.push(new ur(y,d,'"glyphs" url must include a "{range}" token'))),T}function Yu(f,d){d===void 0&&(d=Pe);var y=[];return y=y.concat(go({key:"",value:f,valueSpec:d.$root,styleSpec:d,style:f,objectElementValidators:{glyphs:is,"*":function(){return[]}}})),f.constants&&(y=y.concat(Wr({key:"constants",value:f.constants,style:f,styleSpec:d}))),Fp(y)}function Fp(f){return[].concat(f).sort(function(d,y){return d.line-y.line})}function bf(f){return function(){for(var d=[],y=arguments.length;y--;)d[y]=arguments[y];return Fp(f.apply(this,d))}}Yu.source=bf(Jh),Yu.light=bf(Vf),Yu.layer=bf(_d),Yu.filter=bf(gd),Yu.paintProperty=bf(yd),Yu.layoutProperty=bf(gh);var tp=Yu,xd=tp.light,ep=tp.paintProperty,Rp=tp.layoutProperty;function rp(f,d){var y=!1;if(d&&d.length)for(var T=0,O=d;T<O.length;T+=1)f.fire(new fr(new Error(O[T].message))),y=!0;return y}var Ef=au;function au(f,d,y){var T=this.cells=[];if(f instanceof ArrayBuffer){this.arrayBuffer=f;var O=new Int32Array(this.arrayBuffer);f=O[0],this.d=(d=O[1])+2*(y=O[2]);for(var N=0;N<this.d*this.d;N++){var Z=O[3+N],K=O[3+N+1];T.push(Z===K?null:O.subarray(Z,K))}var mt=O[3+T.length+1];this.keys=O.subarray(O[3+T.length],mt),this.bboxes=O.subarray(mt),this.insert=this._insertReadonly}else{this.d=d+2*y;for(var Ot=0;Ot<this.d*this.d;Ot++)T.push([]);this.keys=[],this.bboxes=[]}this.n=d,this.extent=f,this.padding=y,this.scale=d/f,this.uid=0;var Gt=y/d*f;this.min=-Gt,this.max=f+Gt}au.prototype.insert=function(f,d,y,T,O){this._forEachCell(d,y,T,O,this._insertCell,this.uid++),this.keys.push(f),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(T),this.bboxes.push(O)},au.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},au.prototype._insertCell=function(f,d,y,T,O,N){this.cells[O].push(N)},au.prototype.query=function(f,d,y,T,O){var N=this.min,Z=this.max;if(f<=N&&d<=N&&Z<=y&&Z<=T&&!O)return Array.prototype.slice.call(this.keys);var K=[];return this._forEachCell(f,d,y,T,this._queryCell,K,{},O),K},au.prototype._queryCell=function(f,d,y,T,O,N,Z,K){var mt=this.cells[O];if(mt!==null)for(var Ot=this.keys,Gt=this.bboxes,Kt=0;Kt<mt.length;Kt++){var pe=mt[Kt];if(Z[pe]===void 0){var Fe=4*pe;(K?K(Gt[Fe+0],Gt[Fe+1],Gt[Fe+2],Gt[Fe+3]):f<=Gt[Fe+2]&&d<=Gt[Fe+3]&&y>=Gt[Fe+0]&&T>=Gt[Fe+1])?(Z[pe]=!0,N.push(Ot[pe])):Z[pe]=!1}}},au.prototype._forEachCell=function(f,d,y,T,O,N,Z,K){for(var mt=this._convertToCellCoord(f),Ot=this._convertToCellCoord(d),Gt=this._convertToCellCoord(y),Kt=this._convertToCellCoord(T),pe=mt;pe<=Gt;pe++)for(var Fe=Ot;Fe<=Kt;Fe++){var sr=this.d*Fe+pe;if((!K||K(this._convertFromCellCoord(pe),this._convertFromCellCoord(Fe),this._convertFromCellCoord(pe+1),this._convertFromCellCoord(Fe+1)))&&O.call(this,f,d,y,T,sr,N,Z,K))return}},au.prototype._convertFromCellCoord=function(f){return(f-this.padding)/this.scale},au.prototype._convertToCellCoord=function(f){return Math.max(0,Math.min(this.d-1,Math.floor(f*this.scale)+this.padding))},au.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var f=this.cells,d=3+this.cells.length+1+1,y=0,T=0;T<this.cells.length;T++)y+=this.cells[T].length;var O=new Int32Array(d+y+this.keys.length+this.bboxes.length);O[0]=this.extent,O[1]=this.n,O[2]=this.padding;for(var N=d,Z=0;Z<f.length;Z++){var K=f[Z];O[3+Z]=N,O.set(K,N),N+=K.length}return O[3+f.length]=N,O.set(this.keys,N),O[3+f.length+1]=N+=this.keys.length,O.set(this.bboxes,N),N+=this.bboxes.length,O.buffer};var wf=et.ImageData,np=et.ImageBitmap,As={};function Zi(f,d,y){y===void 0&&(y={}),Object.defineProperty(d,"_classRegistryKey",{value:f,writeable:!1}),As[f]={klass:d,omit:y.omit||[],shallow:y.shallow||[]}}for(var as in Zi("Object",Object),Ef.serialize=function(f,d){var y=f.toArrayBuffer();return d&&d.push(y),{buffer:y}},Ef.deserialize=function(f){return new Ef(f.buffer)},Zi("Grid",Ef),Zi("Color",to),Zi("Error",Error),Zi("ResolvedImage",bo),Zi("StylePropertyFunction",_f),Zi("StyleExpression",zf,{omit:["_evaluator"]}),Zi("ZoomDependentExpression",lc),Zi("ZoomConstantExpression",Uf),Zi("CompoundExpression",Go,{omit:["_evaluate"]}),ye)ye[as]._classRegistryKey||Zi("Expression_"+as,ye[as]);function Sf(f){return f&&typeof ArrayBuffer!="undefined"&&(f instanceof ArrayBuffer||f.constructor&&f.constructor.name==="ArrayBuffer")}function Gf(f){return np&&f instanceof np}function cc(f,d){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp)return f;if(Sf(f)||Gf(f))return d&&d.push(f),f;if(ArrayBuffer.isView(f)){var y=f;return d&&d.push(y.buffer),y}if(f instanceof wf)return d&&d.push(f.data.buffer),f;if(Array.isArray(f)){for(var T=[],O=0,N=f;O<N.length;O+=1)T.push(cc(N[O],d));return T}if(typeof f=="object"){var Z=f.constructor,K=Z._classRegistryKey;if(!K)throw new Error("can't serialize object of unregistered class");var mt=Z.serialize?Z.serialize(f,d):{};if(!Z.serialize){for(var Ot in f)if(f.hasOwnProperty(Ot)&&!(As[K].omit.indexOf(Ot)>=0)){var Gt=f[Ot];mt[Ot]=As[K].shallow.indexOf(Ot)>=0?Gt:cc(Gt,d)}f instanceof Error&&(mt.message=f.message)}if(mt.$name)throw new Error("$name property is reserved for worker serialization logic.");return K!=="Object"&&(mt.$name=K),mt}throw new Error("can't serialize object of type "+typeof f)}function ml(f){if(f==null||typeof f=="boolean"||typeof f=="number"||typeof f=="string"||f instanceof Boolean||f instanceof Number||f instanceof String||f instanceof Date||f instanceof RegExp||Sf(f)||Gf(f)||ArrayBuffer.isView(f)||f instanceof wf)return f;if(Array.isArray(f))return f.map(ml);if(typeof f=="object"){var d=f.$name||"Object",y=As[d].klass;if(!y)throw new Error("can't deserialize unregistered class "+d);if(y.deserialize)return y.deserialize(f);for(var T=Object.create(y.prototype),O=0,N=Object.keys(f);O<N.length;O+=1){var Z=N[O];if(Z!=="$name"){var K=f[Z];T[Z]=As[d].shallow.indexOf(Z)>=0?K:ml(K)}}return T}throw new Error("can't deserialize object of type "+typeof f)}var Dp=function(){this.first=!0};Dp.prototype.update=function(f,d){var y=Math.floor(f);return this.first?(this.first=!1,this.lastIntegerZoom=y,this.lastIntegerZoomTime=0,this.lastZoom=f,this.lastFloorZoom=y,!0):(this.lastFloorZoom>y?(this.lastIntegerZoom=y+1,this.lastIntegerZoomTime=d):this.lastFloorZoom<y&&(this.lastIntegerZoom=y,this.lastIntegerZoomTime=d),f!==this.lastZoom&&(this.lastZoom=f,this.lastFloorZoom=y,!0))};var Ai={"Latin-1 Supplement":function(f){return f>=128&&f<=255},Arabic:function(f){return f>=1536&&f<=1791},"Arabic Supplement":function(f){return f>=1872&&f<=1919},"Arabic Extended-A":function(f){return f>=2208&&f<=2303},"Hangul Jamo":function(f){return f>=4352&&f<=4607},"Unified Canadian Aboriginal Syllabics":function(f){return f>=5120&&f<=5759},Khmer:function(f){return f>=6016&&f<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(f){return f>=6320&&f<=6399},"General Punctuation":function(f){return f>=8192&&f<=8303},"Letterlike Symbols":function(f){return f>=8448&&f<=8527},"Number Forms":function(f){return f>=8528&&f<=8591},"Miscellaneous Technical":function(f){return f>=8960&&f<=9215},"Control Pictures":function(f){return f>=9216&&f<=9279},"Optical Character Recognition":function(f){return f>=9280&&f<=9311},"Enclosed Alphanumerics":function(f){return f>=9312&&f<=9471},"Geometric Shapes":function(f){return f>=9632&&f<=9727},"Miscellaneous Symbols":function(f){return f>=9728&&f<=9983},"Miscellaneous Symbols and Arrows":function(f){return f>=11008&&f<=11263},"CJK Radicals Supplement":function(f){return f>=11904&&f<=12031},"Kangxi Radicals":function(f){return f>=12032&&f<=12255},"Ideographic Description Characters":function(f){return f>=12272&&f<=12287},"CJK Symbols and Punctuation":function(f){return f>=12288&&f<=12351},Hiragana:function(f){return f>=12352&&f<=12447},Katakana:function(f){return f>=12448&&f<=12543},Bopomofo:function(f){return f>=12544&&f<=12591},"Hangul Compatibility Jamo":function(f){return f>=12592&&f<=12687},Kanbun:function(f){return f>=12688&&f<=12703},"Bopomofo Extended":function(f){return f>=12704&&f<=12735},"CJK Strokes":function(f){return f>=12736&&f<=12783},"Katakana Phonetic Extensions":function(f){return f>=12784&&f<=12799},"Enclosed CJK Letters and Months":function(f){return f>=12800&&f<=13055},"CJK Compatibility":function(f){return f>=13056&&f<=13311},"CJK Unified Ideographs Extension A":function(f){return f>=13312&&f<=19903},"Yijing Hexagram Symbols":function(f){return f>=19904&&f<=19967},"CJK Unified Ideographs":function(f){return f>=19968&&f<=40959},"Yi Syllables":function(f){return f>=40960&&f<=42127},"Yi Radicals":function(f){return f>=42128&&f<=42191},"Hangul Jamo Extended-A":function(f){return f>=43360&&f<=43391},"Hangul Syllables":function(f){return f>=44032&&f<=55215},"Hangul Jamo Extended-B":function(f){return f>=55216&&f<=55295},"Private Use Area":function(f){return f>=57344&&f<=63743},"CJK Compatibility Ideographs":function(f){return f>=63744&&f<=64255},"Arabic Presentation Forms-A":function(f){return f>=64336&&f<=65023},"Vertical Forms":function(f){return f>=65040&&f<=65055},"CJK Compatibility Forms":function(f){return f>=65072&&f<=65103},"Small Form Variants":function(f){return f>=65104&&f<=65135},"Arabic Presentation Forms-B":function(f){return f>=65136&&f<=65279},"Halfwidth and Fullwidth Forms":function(f){return f>=65280&&f<=65519}};function Hf(f){for(var d=0,y=f;d<y.length;d+=1)if(Cc(y[d].charCodeAt(0)))return!0;return!1}function Cc(f){return!(f!==746&&f!==747&&(f<4352||!(Ai["Bopomofo Extended"](f)||Ai.Bopomofo(f)||Ai["CJK Compatibility Forms"](f)&&!(f>=65097&&f<=65103)||Ai["CJK Compatibility Ideographs"](f)||Ai["CJK Compatibility"](f)||Ai["CJK Radicals Supplement"](f)||Ai["CJK Strokes"](f)||!(!Ai["CJK Symbols and Punctuation"](f)||f>=12296&&f<=12305||f>=12308&&f<=12319||f===12336)||Ai["CJK Unified Ideographs Extension A"](f)||Ai["CJK Unified Ideographs"](f)||Ai["Enclosed CJK Letters and Months"](f)||Ai["Hangul Compatibility Jamo"](f)||Ai["Hangul Jamo Extended-A"](f)||Ai["Hangul Jamo Extended-B"](f)||Ai["Hangul Jamo"](f)||Ai["Hangul Syllables"](f)||Ai.Hiragana(f)||Ai["Ideographic Description Characters"](f)||Ai.Kanbun(f)||Ai["Kangxi Radicals"](f)||Ai["Katakana Phonetic Extensions"](f)||Ai.Katakana(f)&&f!==12540||!(!Ai["Halfwidth and Fullwidth Forms"](f)||f===65288||f===65289||f===65293||f>=65306&&f<=65310||f===65339||f===65341||f===65343||f>=65371&&f<=65503||f===65507||f>=65512&&f<=65519)||!(!Ai["Small Form Variants"](f)||f>=65112&&f<=65118||f>=65123&&f<=65126)||Ai["Unified Canadian Aboriginal Syllabics"](f)||Ai["Unified Canadian Aboriginal Syllabics Extended"](f)||Ai["Vertical Forms"](f)||Ai["Yijing Hexagram Symbols"](f)||Ai["Yi Syllables"](f)||Ai["Yi Radicals"](f))))}function Cf(f){return!(Cc(f)||function(d){return!!(Ai["Latin-1 Supplement"](d)&&(d===167||d===169||d===174||d===177||d===188||d===189||d===190||d===215||d===247)||Ai["General Punctuation"](d)&&(d===8214||d===8224||d===8225||d===8240||d===8241||d===8251||d===8252||d===8258||d===8263||d===8264||d===8265||d===8273)||Ai["Letterlike Symbols"](d)||Ai["Number Forms"](d)||Ai["Miscellaneous Technical"](d)&&(d>=8960&&d<=8967||d>=8972&&d<=8991||d>=8996&&d<=9e3||d===9003||d>=9085&&d<=9114||d>=9150&&d<=9165||d===9167||d>=9169&&d<=9179||d>=9186&&d<=9215)||Ai["Control Pictures"](d)&&d!==9251||Ai["Optical Character Recognition"](d)||Ai["Enclosed Alphanumerics"](d)||Ai["Geometric Shapes"](d)||Ai["Miscellaneous Symbols"](d)&&!(d>=9754&&d<=9759)||Ai["Miscellaneous Symbols and Arrows"](d)&&(d>=11026&&d<=11055||d>=11088&&d<=11097||d>=11192&&d<=11243)||Ai["CJK Symbols and Punctuation"](d)||Ai.Katakana(d)||Ai["Private Use Area"](d)||Ai["CJK Compatibility Forms"](d)||Ai["Small Form Variants"](d)||Ai["Halfwidth and Fullwidth Forms"](d)||d===8734||d===8756||d===8757||d>=9984&&d<=10087||d>=10102&&d<=10131||d===65532||d===65533)}(f))}function ma(f){return f>=1424&&f<=2303||Ai["Arabic Presentation Forms-A"](f)||Ai["Arabic Presentation Forms-B"](f)}function yl(f,d){return!(!d&&ma(f)||f>=2304&&f<=3583||f>=3840&&f<=4255||Ai.Khmer(f))}function jf(f){for(var d=0,y=f;d<y.length;d+=1)if(ma(y[d].charCodeAt(0)))return!0;return!1}var fc=null,_l="unavailable",sa=null,Bp=function(f){f&&typeof f=="string"&&f.indexOf("NetworkError")>-1&&(_l="error"),fc&&fc(f)};function Np(){bd.fire(new Ue("pluginStateChange",{pluginStatus:_l,pluginURL:sa}))}var bd=new Sr,Ed=function(){return _l},Ml=function(){if(_l!=="deferred"||!sa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");_l="loading",Np(),sa&&wn({url:sa},function(f){f?Bp(f):(_l="loaded",Np())})},Ko={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return _l==="loaded"||Ko.applyArabicShaping!=null},isLoading:function(){return _l==="loading"},setState:function(f){_l=f.pluginStatus,sa=f.pluginURL},isParsed:function(){return Ko.applyArabicShaping!=null&&Ko.processBidirectionalText!=null&&Ko.processStyledBidirectionalText!=null},getPluginURL:function(){return sa}},Ka=function(f,d){this.zoom=f,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.zoomHistory=d.zoomHistory,this.transition=d.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Dp,this.transition={})};Ka.prototype.isSupportedScript=function(f){return function(d,y){for(var T=0,O=d;T<O.length;T+=1)if(!yl(O[T].charCodeAt(0),y))return!1;return!0}(f,Ko.isLoaded())},Ka.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},Ka.prototype.getCrossfadeParameters=function(){var f=this.zoom,d=f-Math.floor(f),y=this.crossFadingFactor();return f>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:d+(1-d)*y}:{fromScale:.5,toScale:1,t:1-(1-y)*d}};var xl=function(f,d){this.property=f,this.value=d,this.expression=function(y,T){if(Dl(y))return new _f(y,T);if(Gc(y)){var O=al(y,T);if(O.result==="error")throw new Error(O.value.map(function(Z){return Z.key+": "+Z.message}).join(", "));return O.value}var N=y;return typeof y=="string"&&T.type==="color"&&(N=to.parse(y)),{kind:"constant",evaluate:function(){return N}}}(d===void 0?f.specification.default:d,f.specification)};xl.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},xl.prototype.possiblyEvaluate=function(f,d,y){return this.property.possiblyEvaluate(this,f,d,y)};var ql=function(f){this.property=f,this.value=new xl(f,void 0)};ql.prototype.transitioned=function(f,d){return new jc(this.property,this.value,d,b({},f.transition,this.transition),f.now)},ql.prototype.untransitioned=function(){return new jc(this.property,this.value,null,{},0)};var Ts=function(f){this._properties=f,this._values=Object.create(f.defaultTransitionablePropertyValues)};Ts.prototype.getValue=function(f){return be(this._values[f].value.value)},Ts.prototype.setValue=function(f,d){this._values.hasOwnProperty(f)||(this._values[f]=new ql(this._values[f].property)),this._values[f].value=new xl(this._values[f].property,d===null?void 0:be(d))},Ts.prototype.getTransition=function(f){return be(this._values[f].transition)},Ts.prototype.setTransition=function(f,d){this._values.hasOwnProperty(f)||(this._values[f]=new ql(this._values[f].property)),this._values[f].transition=be(d)||void 0},Ts.prototype.serialize=function(){for(var f={},d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d],O=this.getValue(T);O!==void 0&&(f[T]=O);var N=this.getTransition(T);N!==void 0&&(f[T+"-transition"]=N)}return f},Ts.prototype.transitioned=function(f,d){for(var y=new Nl(this._properties),T=0,O=Object.keys(this._values);T<O.length;T+=1){var N=O[T];y._values[N]=this._values[N].transitioned(f,d._values[N])}return y},Ts.prototype.untransitioned=function(){for(var f=new Nl(this._properties),d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d];f._values[T]=this._values[T].untransitioned()}return f};var jc=function(f,d,y,T,O){this.property=f,this.value=d,this.begin=O+T.delay||0,this.end=this.begin+T.duration||0,f.specification.transition&&(T.delay||T.duration)&&(this.prior=y)};jc.prototype.possiblyEvaluate=function(f,d,y){var T=f.now||0,O=this.value.possiblyEvaluate(f,d,y),N=this.prior;if(N){if(T>this.end)return this.prior=null,O;if(this.value.isDataDriven())return this.prior=null,O;if(T<this.begin)return N.possiblyEvaluate(f,d,y);var Z=(T-this.begin)/(this.end-this.begin);return this.property.interpolate(N.possiblyEvaluate(f,d,y),O,function(K){if(K<=0)return 0;if(K>=1)return 1;var mt=K*K,Ot=mt*K;return 4*(K<.5?Ot:3*(K-mt)+Ot-.75)}(Z))}return O};var Nl=function(f){this._properties=f,this._values=Object.create(f.defaultTransitioningPropertyValues)};Nl.prototype.possiblyEvaluate=function(f,d,y){for(var T=new Il(this._properties),O=0,N=Object.keys(this._values);O<N.length;O+=1){var Z=N[O];T._values[Z]=this._values[Z].possiblyEvaluate(f,d,y)}return T},Nl.prototype.hasTransition=function(){for(var f=0,d=Object.keys(this._values);f<d.length;f+=1)if(this._values[d[f]].prior)return!0;return!1};var wu=function(f){this._properties=f,this._values=Object.create(f.defaultPropertyValues)};wu.prototype.getValue=function(f){return be(this._values[f].value)},wu.prototype.setValue=function(f,d){this._values[f]=new xl(this._values[f].property,d===null?void 0:be(d))},wu.prototype.serialize=function(){for(var f={},d=0,y=Object.keys(this._values);d<y.length;d+=1){var T=y[d],O=this.getValue(T);O!==void 0&&(f[T]=O)}return f},wu.prototype.possiblyEvaluate=function(f,d,y){for(var T=new Il(this._properties),O=0,N=Object.keys(this._values);O<N.length;O+=1){var Z=N[O];T._values[Z]=this._values[Z].possiblyEvaluate(f,d,y)}return T};var Su=function(f,d,y){this.property=f,this.value=d,this.parameters=y};Su.prototype.isConstant=function(){return this.value.kind==="constant"},Su.prototype.constantOr=function(f){return this.value.kind==="constant"?this.value.value:f},Su.prototype.evaluate=function(f,d,y,T){return this.property.evaluate(this.value,this.parameters,f,d,y,T)};var Il=function(f){this._properties=f,this._values=Object.create(f.defaultPossiblyEvaluatedValues)};Il.prototype.get=function(f){return this._values[f]};var Ki=function(f){this.specification=f};Ki.prototype.possiblyEvaluate=function(f,d){return f.expression.evaluate(d)},Ki.prototype.interpolate=function(f,d,y){var T=rs[this.specification.type];return T?T(f,d,y):f};var Wi=function(f,d){this.specification=f,this.overrides=d};Wi.prototype.possiblyEvaluate=function(f,d,y,T){return new Su(this,f.expression.kind==="constant"||f.expression.kind==="camera"?{kind:"constant",value:f.expression.evaluate(d,null,{},y,T)}:f.expression,d)},Wi.prototype.interpolate=function(f,d,y){if(f.value.kind!=="constant"||d.value.kind!=="constant")return f;if(f.value.value===void 0||d.value.value===void 0)return new Su(this,{kind:"constant",value:void 0},f.parameters);var T=rs[this.specification.type];return T?new Su(this,{kind:"constant",value:T(f.value.value,d.value.value,y)},f.parameters):f},Wi.prototype.evaluate=function(f,d,y,T,O,N){return f.kind==="constant"?f.value:f.evaluate(d,y,T,O,N)};var Af=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(y,T,O,N){if(y.value===void 0)return new Su(this,{kind:"constant",value:void 0},T);if(y.expression.kind==="constant"){var Z=y.expression.evaluate(T,null,{},O,N),K=y.property.specification.type==="resolvedImage"&&typeof Z!="string"?Z.name:Z,mt=this._calculate(K,K,K,T);return new Su(this,{kind:"constant",value:mt},T)}if(y.expression.kind==="camera"){var Ot=this._calculate(y.expression.evaluate({zoom:T.zoom-1}),y.expression.evaluate({zoom:T.zoom}),y.expression.evaluate({zoom:T.zoom+1}),T);return new Su(this,{kind:"constant",value:Ot},T)}return new Su(this,y.expression,T)},d.prototype.evaluate=function(y,T,O,N,Z,K){if(y.kind==="source"){var mt=y.evaluate(T,O,N,Z,K);return this._calculate(mt,mt,mt,T)}return y.kind==="composite"?this._calculate(y.evaluate({zoom:Math.floor(T.zoom)-1},O,N),y.evaluate({zoom:Math.floor(T.zoom)},O,N),y.evaluate({zoom:Math.floor(T.zoom)+1},O,N),T):y.value},d.prototype._calculate=function(y,T,O,N){return N.zoom>N.zoomHistory.lastIntegerZoom?{from:y,to:T}:{from:O,to:T}},d.prototype.interpolate=function(y){return y},d}(Wi),ol=function(f){this.specification=f};ol.prototype.possiblyEvaluate=function(f,d,y,T){if(f.value!==void 0){if(f.expression.kind==="constant"){var O=f.expression.evaluate(d,null,{},y,T);return this._calculate(O,O,O,d)}return this._calculate(f.expression.evaluate(new Ka(Math.floor(d.zoom-1),d)),f.expression.evaluate(new Ka(Math.floor(d.zoom),d)),f.expression.evaluate(new Ka(Math.floor(d.zoom+1),d)),d)}},ol.prototype._calculate=function(f,d,y,T){return T.zoom>T.zoomHistory.lastIntegerZoom?{from:f,to:d}:{from:y,to:d}},ol.prototype.interpolate=function(f){return f};var sl=function(f){this.specification=f};sl.prototype.possiblyEvaluate=function(f,d,y,T){return!!f.expression.evaluate(d,null,{},y,T)},sl.prototype.interpolate=function(){return!1};var Ru=function(f){for(var d in this.properties=f,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],f){var y=f[d];y.specification.overridable&&this.overridableProperties.push(d);var T=this.defaultPropertyValues[d]=new xl(y,void 0),O=this.defaultTransitionablePropertyValues[d]=new ql(y);this.defaultTransitioningPropertyValues[d]=O.untransitioned(),this.defaultPossiblyEvaluatedValues[d]=T.possiblyEvaluate({})}};Zi("DataDrivenProperty",Wi),Zi("DataConstantProperty",Ki),Zi("CrossFadedDataDrivenProperty",Af),Zi("CrossFadedProperty",ol),Zi("ColorRampProperty",sl);var bs=function(f){function d(y,T){if(f.call(this),this.id=y.id,this.type=y.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},y.type!=="custom"&&(this.metadata=(y=y).metadata,this.minzoom=y.minzoom,this.maxzoom=y.maxzoom,y.type!=="background"&&(this.source=y.source,this.sourceLayer=y["source-layer"],this.filter=y.filter),T.layout&&(this._unevaluatedLayout=new wu(T.layout)),T.paint)){for(var O in this._transitionablePaint=new Ts(T.paint),y.paint)this.setPaintProperty(O,y.paint[O],{validate:!1});for(var N in y.layout)this.setLayoutProperty(N,y.layout[N],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Il(T.paint)}}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},d.prototype.getLayoutProperty=function(y){return y==="visibility"?this.visibility:this._unevaluatedLayout.getValue(y)},d.prototype.setLayoutProperty=function(y,T,O){O===void 0&&(O={}),T!=null&&this._validate(Rp,"layers."+this.id+".layout."+y,y,T,O)||(y!=="visibility"?this._unevaluatedLayout.setValue(y,T):this.visibility=T)},d.prototype.getPaintProperty=function(y){return rt(y,"-transition")?this._transitionablePaint.getTransition(y.slice(0,-11)):this._transitionablePaint.getValue(y)},d.prototype.setPaintProperty=function(y,T,O){if(O===void 0&&(O={}),T!=null&&this._validate(ep,"layers."+this.id+".paint."+y,y,T,O))return!1;if(rt(y,"-transition"))return this._transitionablePaint.setTransition(y.slice(0,-11),T||void 0),!1;var N=this._transitionablePaint._values[y],Z=N.property.specification["property-type"]==="cross-faded-data-driven",K=N.value.isDataDriven(),mt=N.value;this._transitionablePaint.setValue(y,T),this._handleSpecialPaintPropertyUpdate(y);var Ot=this._transitionablePaint._values[y].value;return Ot.isDataDriven()||K||Z||this._handleOverridablePaintPropertyUpdate(y,mt,Ot)},d.prototype._handleSpecialPaintPropertyUpdate=function(y){},d.prototype._handleOverridablePaintPropertyUpdate=function(y,T,O){return!1},d.prototype.isHidden=function(y){return!!(this.minzoom&&y<this.minzoom)||!!(this.maxzoom&&y>=this.maxzoom)||this.visibility==="none"},d.prototype.updateTransitions=function(y){this._transitioningPaint=this._transitionablePaint.transitioned(y,this._transitioningPaint)},d.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},d.prototype.recalculate=function(y,T){y.getCrossfadeParameters&&(this._crossfadeParameters=y.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(y,void 0,T)),this.paint=this._transitioningPaint.possiblyEvaluate(y,void 0,T)},d.prototype.serialize=function(){var y={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(y.layout=y.layout||{},y.layout.visibility=this.visibility),Ae(y,function(T,O){return!(T===void 0||O==="layout"&&!Object.keys(T).length||O==="paint"&&!Object.keys(T).length)})},d.prototype._validate=function(y,T,O,N,Z){return Z===void 0&&(Z={}),(!Z||Z.validate!==!1)&&rp(this,y.call(tp,{key:T,layerType:this.type,objectKey:O,value:N,styleSpec:Pe,style:{glyphs:!0,sprite:!0}}))},d.prototype.is3D=function(){return!1},d.prototype.isTileClipped=function(){return!1},d.prototype.hasOffscreenPass=function(){return!1},d.prototype.resize=function(){},d.prototype.isStateDependent=function(){for(var y in this.paint._values){var T=this.paint.get(y);if(T instanceof Su&&Ia(T.property.specification)&&(T.value.kind==="source"||T.value.kind==="composite")&&T.value.isStateDependent)return!0}return!1},d}(Sr),Ac={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Tc=function(f,d){this._structArray=f,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},No=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function os(f,d){d===void 0&&(d=1);var y=0,T=0;return{members:f.map(function(O){var N=Ac[O.type].BYTES_PER_ELEMENT,Z=y=ip(y,Math.max(d,N)),K=O.components||1;return T=Math.max(T,N),y+=N*K,{name:O.name,type:O.type,components:K,offset:Z}}),size:ip(y,Math.max(T,d)),alignment:d}}function ip(f,d){return Math.ceil(f/d)*d}No.serialize=function(f,d){return f._trim(),d&&(f.isTransferred=!0,d.push(f.arrayBuffer)),{length:f.length,arrayBuffer:f.arrayBuffer}},No.deserialize=function(f){var d=Object.create(this.prototype);return d.arrayBuffer=f.arrayBuffer,d.length=f.length,d.capacity=f.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d},No.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},No.prototype.clear=function(){this.length=0},No.prototype.resize=function(f){this.reserve(f),this.length=f},No.prototype.reserve=function(f){if(f>this.capacity){this.capacity=Math.max(f,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}},No.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Wc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.int16[N+0]=T,this.int16[N+1]=O,y},d}(No);Wc.prototype.bytesPerElement=4,Zi("StructArrayLayout2i4",Wc);var hc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var K=4*y;return this.int16[K+0]=T,this.int16[K+1]=O,this.int16[K+2]=N,this.int16[K+3]=Z,y},d}(No);hc.prototype.bytesPerElement=8,Zi("StructArrayLayout4i8",hc);var ul=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K){var mt=this.length;return this.resize(mt+1),this.emplace(mt,y,T,O,N,Z,K)},d.prototype.emplace=function(y,T,O,N,Z,K,mt){var Ot=6*y;return this.int16[Ot+0]=T,this.int16[Ot+1]=O,this.int16[Ot+2]=N,this.int16[Ot+3]=Z,this.int16[Ot+4]=K,this.int16[Ot+5]=mt,y},d}(No);ul.prototype.bytesPerElement=12,Zi("StructArrayLayout2i4i12",ul);var Fs=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K){var mt=this.length;return this.resize(mt+1),this.emplace(mt,y,T,O,N,Z,K)},d.prototype.emplace=function(y,T,O,N,Z,K,mt){var Ot=4*y,Gt=8*y;return this.int16[Ot+0]=T,this.int16[Ot+1]=O,this.uint8[Gt+4]=N,this.uint8[Gt+5]=Z,this.uint8[Gt+6]=K,this.uint8[Gt+7]=mt,y},d}(No);Fs.prototype.bytesPerElement=8,Zi("StructArrayLayout2i4ub8",Fs);var Ms=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.float32[N+0]=T,this.float32[N+1]=O,y},d}(No);Ms.prototype.bytesPerElement=8,Zi("StructArrayLayout2f8",Ms);var $u=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt){var pe=this.length;return this.resize(pe+1),this.emplace(pe,y,T,O,N,Z,K,mt,Ot,Gt,Kt)},d.prototype.emplace=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe){var Fe=10*y;return this.uint16[Fe+0]=T,this.uint16[Fe+1]=O,this.uint16[Fe+2]=N,this.uint16[Fe+3]=Z,this.uint16[Fe+4]=K,this.uint16[Fe+5]=mt,this.uint16[Fe+6]=Ot,this.uint16[Fe+7]=Gt,this.uint16[Fe+8]=Kt,this.uint16[Fe+9]=pe,y},d}(No);$u.prototype.bytesPerElement=20,Zi("StructArrayLayout10ui20",$u);var Xc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe){var sr=this.length;return this.resize(sr+1),this.emplace(sr,y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe)},d.prototype.emplace=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr){var lr=12*y;return this.int16[lr+0]=T,this.int16[lr+1]=O,this.int16[lr+2]=N,this.int16[lr+3]=Z,this.uint16[lr+4]=K,this.uint16[lr+5]=mt,this.uint16[lr+6]=Ot,this.uint16[lr+7]=Gt,this.int16[lr+8]=Kt,this.int16[lr+9]=pe,this.int16[lr+10]=Fe,this.int16[lr+11]=sr,y},d}(No);Xc.prototype.bytesPerElement=24,Zi("StructArrayLayout4i4ui4i24",Xc);var ll=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.float32[Z+0]=T,this.float32[Z+1]=O,this.float32[Z+2]=N,y},d}(No);ll.prototype.bytesPerElement=12,Zi("StructArrayLayout3f12",ll);var Wf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.uint32[1*y+0]=T,y},d}(No);Wf.prototype.bytesPerElement=4,Zi("StructArrayLayout1ul4",Wf);var Mc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K,mt,Ot,Gt){var Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,y,T,O,N,Z,K,mt,Ot,Gt)},d.prototype.emplace=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt){var pe=10*y,Fe=5*y;return this.int16[pe+0]=T,this.int16[pe+1]=O,this.int16[pe+2]=N,this.int16[pe+3]=Z,this.int16[pe+4]=K,this.int16[pe+5]=mt,this.uint32[Fe+3]=Ot,this.uint16[pe+8]=Gt,this.uint16[pe+9]=Kt,y},d}(No);Mc.prototype.bytesPerElement=20,Zi("StructArrayLayout6i1ul2ui20",Mc);var mh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K){var mt=this.length;return this.resize(mt+1),this.emplace(mt,y,T,O,N,Z,K)},d.prototype.emplace=function(y,T,O,N,Z,K,mt){var Ot=6*y;return this.int16[Ot+0]=T,this.int16[Ot+1]=O,this.int16[Ot+2]=N,this.int16[Ot+3]=Z,this.int16[Ot+4]=K,this.int16[Ot+5]=mt,y},d}(No);mh.prototype.bytesPerElement=12,Zi("StructArrayLayout2i2i2i12",mh);var Xf=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z){var K=this.length;return this.resize(K+1),this.emplace(K,y,T,O,N,Z)},d.prototype.emplace=function(y,T,O,N,Z,K){var mt=4*y,Ot=8*y;return this.float32[mt+0]=T,this.float32[mt+1]=O,this.float32[mt+2]=N,this.int16[Ot+6]=Z,this.int16[Ot+7]=K,y},d}(No);Xf.prototype.bytesPerElement=16,Zi("StructArrayLayout2f1f2i16",Xf);var wd=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var K=12*y,mt=3*y;return this.uint8[K+0]=T,this.uint8[K+1]=O,this.float32[mt+1]=N,this.float32[mt+2]=Z,y},d}(No);wd.prototype.bytesPerElement=12,Zi("StructArrayLayout2ub2f12",wd);var Rs=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.uint16[Z+0]=T,this.uint16[Z+1]=O,this.uint16[Z+2]=N,y},d}(No);Rs.prototype.bytesPerElement=6,Zi("StructArrayLayout3ui6",Rs);var Ic=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr,Cr,gr,Ur){var Ar=this.length;return this.resize(Ar+1),this.emplace(Ar,y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr,Cr,gr,Ur)},d.prototype.emplace=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr,Cr,gr,Ur,Ar){var Dr=24*y,mn=12*y,Fn=48*y;return this.int16[Dr+0]=T,this.int16[Dr+1]=O,this.uint16[Dr+2]=N,this.uint16[Dr+3]=Z,this.uint32[mn+2]=K,this.uint32[mn+3]=mt,this.uint32[mn+4]=Ot,this.uint16[Dr+10]=Gt,this.uint16[Dr+11]=Kt,this.uint16[Dr+12]=pe,this.float32[mn+7]=Fe,this.float32[mn+8]=sr,this.uint8[Fn+36]=lr,this.uint8[Fn+37]=Cr,this.uint8[Fn+38]=gr,this.uint32[mn+10]=Ur,this.int16[Dr+22]=Ar,y},d}(No);Ic.prototype.bytesPerElement=48,Zi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ic);var ap=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki,oa,Di,ca,zi,Oa){var xa=this.length;return this.resize(xa+1),this.emplace(xa,y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki,oa,Di,ca,zi,Oa)},d.prototype.emplace=function(y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki,oa,Di,ca,zi,Oa,xa){var Qi=34*y,lo=17*y;return this.int16[Qi+0]=T,this.int16[Qi+1]=O,this.int16[Qi+2]=N,this.int16[Qi+3]=Z,this.int16[Qi+4]=K,this.int16[Qi+5]=mt,this.int16[Qi+6]=Ot,this.int16[Qi+7]=Gt,this.uint16[Qi+8]=Kt,this.uint16[Qi+9]=pe,this.uint16[Qi+10]=Fe,this.uint16[Qi+11]=sr,this.uint16[Qi+12]=lr,this.uint16[Qi+13]=Cr,this.uint16[Qi+14]=gr,this.uint16[Qi+15]=Ur,this.uint16[Qi+16]=Ar,this.uint16[Qi+17]=Dr,this.uint16[Qi+18]=mn,this.uint16[Qi+19]=Fn,this.uint16[Qi+20]=ni,this.uint16[Qi+21]=ki,this.uint16[Qi+22]=oa,this.uint32[lo+12]=Di,this.float32[lo+13]=ca,this.float32[lo+14]=zi,this.float32[lo+15]=Oa,this.float32[lo+16]=xa,y},d}(No);ap.prototype.bytesPerElement=68,Zi("StructArrayLayout8i15ui1ul4f68",ap);var bl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.float32[1*y+0]=T,y},d}(No);bl.prototype.bytesPerElement=4,Zi("StructArrayLayout1f4",bl);var zl=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=3*y;return this.int16[Z+0]=T,this.int16[Z+1]=O,this.int16[Z+2]=N,y},d}(No);zl.prototype.bytesPerElement=6,Zi("StructArrayLayout3i6",zl);var op=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O){var N=this.length;return this.resize(N+1),this.emplace(N,y,T,O)},d.prototype.emplace=function(y,T,O,N){var Z=4*y;return this.uint32[2*y+0]=T,this.uint16[Z+2]=O,this.uint16[Z+3]=N,y},d}(No);op.prototype.bytesPerElement=8,Zi("StructArrayLayout1ul2ui8",op);var pc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T){var O=this.length;return this.resize(O+1),this.emplace(O,y,T)},d.prototype.emplace=function(y,T,O){var N=2*y;return this.uint16[N+0]=T,this.uint16[N+1]=O,y},d}(No);pc.prototype.bytesPerElement=4,Zi("StructArrayLayout2ui4",pc);var zp=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y){var T=this.length;return this.resize(T+1),this.emplace(T,y)},d.prototype.emplace=function(y,T){return this.uint16[1*y+0]=T,y},d}(No);zp.prototype.bytesPerElement=2,Zi("StructArrayLayout1ui2",zp);var Yc=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},d.prototype.emplaceBack=function(y,T,O,N){var Z=this.length;return this.resize(Z+1),this.emplace(Z,y,T,O,N)},d.prototype.emplace=function(y,T,O,N,Z){var K=4*y;return this.float32[K+0]=T,this.float32[K+1]=O,this.float32[K+2]=N,this.float32[K+3]=Z,y},d}(No);Yc.prototype.bytesPerElement=16,Zi("StructArrayLayout4f16",Yc);var x=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return y.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},y.x1.get=function(){return this._structArray.int16[this._pos2+2]},y.y1.get=function(){return this._structArray.int16[this._pos2+3]},y.x2.get=function(){return this._structArray.int16[this._pos2+4]},y.y2.get=function(){return this._structArray.int16[this._pos2+5]},y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},y.anchorPoint.get=function(){return new ht(this.anchorPointX,this.anchorPointY)},Object.defineProperties(d.prototype,y),d}(Tc);x.prototype.size=20;var C=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new x(this,y)},d}(Mc);Zi("CollisionBoxArray",C);var w=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},y.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},y.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},y.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},y.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},y.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},y.segment.get=function(){return this._structArray.uint16[this._pos2+10]},y.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},y.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},y.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},y.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},y.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},y.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},y.placedOrientation.set=function(T){this._structArray.uint8[this._pos1+37]=T},y.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},y.hidden.set=function(T){this._structArray.uint8[this._pos1+38]=T},y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},y.crossTileID.set=function(T){this._structArray.uint32[this._pos4+10]=T},y.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(d.prototype,y),d}(Tc);w.prototype.size=48;var M=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new w(this,y)},d}(Ic);Zi("PlacedSymbolArray",M);var z=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return y.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},y.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},y.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},y.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},y.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},y.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},y.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},y.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},y.key.get=function(){return this._structArray.uint16[this._pos2+8]},y.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},y.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},y.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},y.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},y.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},y.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},y.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},y.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},y.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},y.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},y.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},y.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},y.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},y.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},y.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},y.crossTileID.set=function(T){this._structArray.uint32[this._pos4+12]=T},y.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},y.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},y.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},y.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(d.prototype,y),d}(Tc);z.prototype.size=68;var H=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new z(this,y)},d}(ap);Zi("SymbolInstanceArray",H);var $=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getoffsetX=function(y){return this.float32[1*y+0]},d}(bl);Zi("GlyphOffsetArray",$);var ft=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.getx=function(y){return this.int16[3*y+0]},d.prototype.gety=function(y){return this.int16[3*y+1]},d.prototype.gettileUnitDistanceFromAnchor=function(y){return this.int16[3*y+2]},d}(zl);Zi("SymbolLineVertexArray",ft);var Ut=function(f){function d(){f.apply(this,arguments)}f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d;var y={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return y.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},y.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},y.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(d.prototype,y),d}(Tc);Ut.prototype.size=8;var re=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.get=function(y){return new Ut(this,y)},d}(op);Zi("FeatureIndexArray",re);var De=os([{name:"a_pos",components:2,type:"Int16"}],4).members,Be=function(f){f===void 0&&(f=[]),this.segments=f};function Le(f,d){return 256*(f=Zt(Math.floor(f),0,255))+Zt(Math.floor(d),0,255)}Be.prototype.prepareSegment=function(f,d,y,T){var O=this.segments[this.segments.length-1];return f>Be.MAX_VERTEX_ARRAY_LENGTH&&ee("Max vertices per segment is "+Be.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+f),(!O||O.vertexLength+f>Be.MAX_VERTEX_ARRAY_LENGTH||O.sortKey!==T)&&(O={vertexOffset:d.length,primitiveOffset:y.length,vertexLength:0,primitiveLength:0},T!==void 0&&(O.sortKey=T),this.segments.push(O)),O},Be.prototype.get=function(){return this.segments},Be.prototype.destroy=function(){for(var f=0,d=this.segments;f<d.length;f+=1){var y=d[f];for(var T in y.vaos)y.vaos[T].destroy()}},Be.simpleSegment=function(f,d,y,T){return new Be([{vertexOffset:f,primitiveOffset:d,vertexLength:y,primitiveLength:T,vaos:{},sortKey:0}])},Be.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zi("SegmentVector",Be);var cr=os([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),ar=Et(function(f){f.exports=function(d,y){var T,O,N,Z,K,mt,Ot,Gt;for(O=d.length-(T=3&d.length),N=y,K=3432918353,mt=461845907,Gt=0;Gt<O;)Ot=255&d.charCodeAt(Gt)|(255&d.charCodeAt(++Gt))<<8|(255&d.charCodeAt(++Gt))<<16|(255&d.charCodeAt(++Gt))<<24,++Gt,N=27492+(65535&(Z=5*(65535&(N=(N^=Ot=(65535&(Ot=(Ot=(65535&Ot)*K+(((Ot>>>16)*K&65535)<<16)&4294967295)<<15|Ot>>>17))*mt+(((Ot>>>16)*mt&65535)<<16)&4294967295)<<13|N>>>19))+((5*(N>>>16)&65535)<<16)&4294967295))+((58964+(Z>>>16)&65535)<<16);switch(Ot=0,T){case 3:Ot^=(255&d.charCodeAt(Gt+2))<<16;case 2:Ot^=(255&d.charCodeAt(Gt+1))<<8;case 1:N^=Ot=(65535&(Ot=(Ot=(65535&(Ot^=255&d.charCodeAt(Gt)))*K+(((Ot>>>16)*K&65535)<<16)&4294967295)<<15|Ot>>>17))*mt+(((Ot>>>16)*mt&65535)<<16)&4294967295}return N^=d.length,N=2246822507*(65535&(N^=N>>>16))+((2246822507*(N>>>16)&65535)<<16)&4294967295,N=3266489909*(65535&(N^=N>>>13))+((3266489909*(N>>>16)&65535)<<16)&4294967295,(N^=N>>>16)>>>0}}),br=Et(function(f){f.exports=function(d,y){for(var T,O=d.length,N=y^O,Z=0;O>=4;)T=1540483477*(65535&(T=255&d.charCodeAt(Z)|(255&d.charCodeAt(++Z))<<8|(255&d.charCodeAt(++Z))<<16|(255&d.charCodeAt(++Z))<<24))+((1540483477*(T>>>16)&65535)<<16),N=1540483477*(65535&N)+((1540483477*(N>>>16)&65535)<<16)^(T=1540483477*(65535&(T^=T>>>24))+((1540483477*(T>>>16)&65535)<<16)),O-=4,++Z;switch(O){case 3:N^=(255&d.charCodeAt(Z+2))<<16;case 2:N^=(255&d.charCodeAt(Z+1))<<8;case 1:N=1540483477*(65535&(N^=255&d.charCodeAt(Z)))+((1540483477*(N>>>16)&65535)<<16)}return N=1540483477*(65535&(N^=N>>>13))+((1540483477*(N>>>16)&65535)<<16),(N^=N>>>15)>>>0}}),rr=ar,xr=br;rr.murmur3=ar,rr.murmur2=xr;var Pr=function(){this.ids=[],this.positions=[],this.indexed=!1};Pr.prototype.add=function(f,d,y,T){this.ids.push(gn(f)),this.positions.push(d,y,T)},Pr.prototype.getPositions=function(f){for(var d=gn(f),y=0,T=this.ids.length-1;y<T;){var O=y+T>>1;this.ids[O]>=d?T=O:y=O+1}for(var N=[];this.ids[y]===d;)N.push({index:this.positions[3*y],start:this.positions[3*y+1],end:this.positions[3*y+2]}),y++;return N},Pr.serialize=function(f,d){var y=new Float64Array(f.ids),T=new Uint32Array(f.positions);return function O(N,Z,K,mt){for(;K<mt;){for(var Ot=N[K+mt>>1],Gt=K-1,Kt=mt+1;;){do Gt++;while(N[Gt]<Ot);do Kt--;while(N[Kt]>Ot);if(Gt>=Kt)break;ln(N,Gt,Kt),ln(Z,3*Gt,3*Kt),ln(Z,3*Gt+1,3*Kt+1),ln(Z,3*Gt+2,3*Kt+2)}Kt-K<mt-Kt?(O(N,Z,K,Kt),K=Kt+1):(O(N,Z,Kt+1,mt),mt=Kt)}}(y,T,0,y.length-1),d&&d.push(y.buffer,T.buffer),{ids:y,positions:T}},Pr.deserialize=function(f){var d=new Pr;return d.ids=f.ids,d.positions=f.positions,d.indexed=!0,d};var Rr=Math.pow(2,53)-1;function gn(f){var d=+f;return!isNaN(d)&&d<=Rr?d:rr(String(f))}function ln(f,d,y){var T=f[d];f[d]=f[y],f[y]=T}Zi("FeaturePositionMap",Pr);var bn=function(f,d){this.gl=f.gl,this.location=d},Zn=function(f){function d(y,T){f.call(this,y,T),this.current=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){this.current!==y&&(this.current=y,this.gl.uniform1i(this.location,y))},d}(bn),Kn=function(f){function d(y,T){f.call(this,y,T),this.current=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){this.current!==y&&(this.current=y,this.gl.uniform1f(this.location,y))},d}(bn),ci=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]||(this.current=y,this.gl.uniform2f(this.location,y[0],y[1]))},d}(bn),Oi=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]||(this.current=y,this.gl.uniform3f(this.location,y[0],y[1],y[2]))},d}(bn),na=function(f){function d(y,T){f.call(this,y,T),this.current=[0,0,0,0]}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y[0]===this.current[0]&&y[1]===this.current[1]&&y[2]===this.current[2]&&y[3]===this.current[3]||(this.current=y,this.gl.uniform4f(this.location,y[0],y[1],y[2],y[3]))},d}(bn),ia=function(f){function d(y,T){f.call(this,y,T),this.current=to.transparent}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){y.r===this.current.r&&y.g===this.current.g&&y.b===this.current.b&&y.a===this.current.a||(this.current=y,this.gl.uniform4f(this.location,y.r,y.g,y.b,y.a))},d}(bn),ua=new Float32Array(16),Qa=function(f){function d(y,T){f.call(this,y,T),this.current=ua}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.set=function(y){if(y[12]!==this.current[12]||y[0]!==this.current[0])return this.current=y,void this.gl.uniformMatrix4fv(this.location,!1,y);for(var T=1;T<16;T++)if(y[T]!==this.current[T]){this.current=y,this.gl.uniformMatrix4fv(this.location,!1,y);break}},d}(bn);function Fi(f){return[Le(255*f.r,255*f.g),Le(255*f.b,255*f.a)]}var Ra=function(f,d,y){this.value=f,this.uniformNames=d.map(function(T){return"u_"+T}),this.type=y};Ra.prototype.setUniform=function(f,d,y){f.set(y.constantOr(this.value))},Ra.prototype.getBinding=function(f,d,y){return this.type==="color"?new ia(f,d):new Kn(f,d)};var Aa=function(f,d){this.uniformNames=d.map(function(y){return"u_"+y}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Aa.prototype.setConstantPatternPositions=function(f,d){this.pixelRatioFrom=d.pixelRatio,this.pixelRatioTo=f.pixelRatio,this.patternFrom=d.tlbr,this.patternTo=f.tlbr},Aa.prototype.setUniform=function(f,d,y,T){var O=T==="u_pattern_to"?this.patternTo:T==="u_pattern_from"?this.patternFrom:T==="u_pixel_ratio_to"?this.pixelRatioTo:T==="u_pixel_ratio_from"?this.pixelRatioFrom:null;O&&f.set(O)},Aa.prototype.getBinding=function(f,d,y){return y.substr(0,9)==="u_pattern"?new na(f,d):new Kn(f,d)};var ka=function(f,d,y,T){this.expression=f,this.type=y,this.maxValue=0,this.paintVertexAttributes=d.map(function(O){return{name:"a_"+O,type:"Float32",components:y==="color"?2:1,offset:0}}),this.paintVertexArray=new T};ka.prototype.populatePaintArray=function(f,d,y,T,O){var N=this.paintVertexArray.length,Z=this.expression.evaluate(new Ka(0),d,{},T,[],O);this.paintVertexArray.resize(f),this._setPaintValue(N,f,Z)},ka.prototype.updatePaintArray=function(f,d,y,T){var O=this.expression.evaluate({zoom:0},y,T);this._setPaintValue(f,d,O)},ka.prototype._setPaintValue=function(f,d,y){if(this.type==="color")for(var T=Fi(y),O=f;O<d;O++)this.paintVertexArray.emplace(O,T[0],T[1]);else{for(var N=f;N<d;N++)this.paintVertexArray.emplace(N,y);this.maxValue=Math.max(this.maxValue,Math.abs(y))}},ka.prototype.upload=function(f){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=f.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ka.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var la=function(f,d,y,T,O,N){this.expression=f,this.uniformNames=d.map(function(Z){return"u_"+Z+"_t"}),this.type=y,this.useIntegerZoom=T,this.zoom=O,this.maxValue=0,this.paintVertexAttributes=d.map(function(Z){return{name:"a_"+Z,type:"Float32",components:y==="color"?4:2,offset:0}}),this.paintVertexArray=new N};la.prototype.populatePaintArray=function(f,d,y,T,O){var N=this.expression.evaluate(new Ka(this.zoom),d,{},T,[],O),Z=this.expression.evaluate(new Ka(this.zoom+1),d,{},T,[],O),K=this.paintVertexArray.length;this.paintVertexArray.resize(f),this._setPaintValue(K,f,N,Z)},la.prototype.updatePaintArray=function(f,d,y,T){var O=this.expression.evaluate({zoom:this.zoom},y,T),N=this.expression.evaluate({zoom:this.zoom+1},y,T);this._setPaintValue(f,d,O,N)},la.prototype._setPaintValue=function(f,d,y,T){if(this.type==="color")for(var O=Fi(y),N=Fi(T),Z=f;Z<d;Z++)this.paintVertexArray.emplace(Z,O[0],O[1],N[0],N[1]);else{for(var K=f;K<d;K++)this.paintVertexArray.emplace(K,y,T);this.maxValue=Math.max(this.maxValue,Math.abs(y),Math.abs(T))}},la.prototype.upload=function(f){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=f.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},la.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},la.prototype.setUniform=function(f,d){var y=this.useIntegerZoom?Math.floor(d.zoom):d.zoom,T=Zt(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);f.set(T)},la.prototype.getBinding=function(f,d,y){return new Kn(f,d)};var Na=function(f,d,y,T,O,N){this.expression=f,this.type=d,this.useIntegerZoom=y,this.zoom=T,this.layerId=N,this.zoomInPaintVertexArray=new O,this.zoomOutPaintVertexArray=new O};Na.prototype.populatePaintArray=function(f,d,y){var T=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(f),this.zoomOutPaintVertexArray.resize(f),this._setPaintValues(T,f,d.patterns&&d.patterns[this.layerId],y)},Na.prototype.updatePaintArray=function(f,d,y,T,O){this._setPaintValues(f,d,y.patterns&&y.patterns[this.layerId],O)},Na.prototype._setPaintValues=function(f,d,y,T){if(T&&y){var O=T[y.min],N=T[y.mid],Z=T[y.max];if(O&&N&&Z)for(var K=f;K<d;K++)this.zoomInPaintVertexArray.emplace(K,N.tl[0],N.tl[1],N.br[0],N.br[1],O.tl[0],O.tl[1],O.br[0],O.br[1],N.pixelRatio,O.pixelRatio),this.zoomOutPaintVertexArray.emplace(K,N.tl[0],N.tl[1],N.br[0],N.br[1],Z.tl[0],Z.tl[1],Z.br[0],Z.br[1],N.pixelRatio,Z.pixelRatio)}},Na.prototype.upload=function(f){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=f.createVertexBuffer(this.zoomInPaintVertexArray,cr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=f.createVertexBuffer(this.zoomOutPaintVertexArray,cr.members,this.expression.isStateDependent))},Na.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var pa=function(f,d,y){this.binders={},this._buffers=[];var T=[];for(var O in f.paint._values)if(y(O)){var N=f.paint.get(O);if(N instanceof Su&&Ia(N.property.specification)){var Z=Ds(O,f.type),K=N.value,mt=N.property.specification.type,Ot=N.property.useIntegerZoom,Gt=N.property.specification["property-type"],Kt=Gt==="cross-faded"||Gt==="cross-faded-data-driven";if(K.kind==="constant")this.binders[O]=Kt?new Aa(K.value,Z):new Ra(K.value,Z,mt),T.push("/u_"+O);else if(K.kind==="source"||Kt){var pe=ss(O,mt,"source");this.binders[O]=Kt?new Na(K,mt,Ot,d,pe,f.id):new ka(K,Z,mt,pe),T.push("/a_"+O)}else{var Fe=ss(O,mt,"composite");this.binders[O]=new la(K,Z,mt,Ot,d,Fe),T.push("/z_"+O)}}}this.cacheKey=T.sort().join("")};pa.prototype.getMaxValue=function(f){var d=this.binders[f];return d instanceof ka||d instanceof la?d.maxValue:0},pa.prototype.populatePaintArrays=function(f,d,y,T,O){for(var N in this.binders){var Z=this.binders[N];(Z instanceof ka||Z instanceof la||Z instanceof Na)&&Z.populatePaintArray(f,d,y,T,O)}},pa.prototype.setConstantPatternPositions=function(f,d){for(var y in this.binders){var T=this.binders[y];T instanceof Aa&&T.setConstantPatternPositions(f,d)}},pa.prototype.updatePaintArrays=function(f,d,y,T,O){var N=!1;for(var Z in f)for(var K=0,mt=d.getPositions(Z);K<mt.length;K+=1){var Ot=mt[K],Gt=y.feature(Ot.index);for(var Kt in this.binders){var pe=this.binders[Kt];if((pe instanceof ka||pe instanceof la||pe instanceof Na)&&pe.expression.isStateDependent===!0){var Fe=T.paint.get(Kt);pe.expression=Fe.value,pe.updatePaintArray(Ot.start,Ot.end,Gt,f[Z],O),N=!0}}}return N},pa.prototype.defines=function(){var f=[];for(var d in this.binders){var y=this.binders[d];(y instanceof Ra||y instanceof Aa)&&f.push.apply(f,y.uniformNames.map(function(T){return"#define HAS_UNIFORM_"+T}))}return f},pa.prototype.getBinderAttributes=function(){var f=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof ka||y instanceof la)for(var T=0;T<y.paintVertexAttributes.length;T++)f.push(y.paintVertexAttributes[T].name);else if(y instanceof Na)for(var O=0;O<cr.members.length;O++)f.push(cr.members[O].name)}return f},pa.prototype.getBinderUniforms=function(){var f=[];for(var d in this.binders){var y=this.binders[d];if(y instanceof Ra||y instanceof Aa||y instanceof la)for(var T=0,O=y.uniformNames;T<O.length;T+=1)f.push(O[T])}return f},pa.prototype.getPaintVertexBuffers=function(){return this._buffers},pa.prototype.getUniforms=function(f,d){var y=[];for(var T in this.binders){var O=this.binders[T];if(O instanceof Ra||O instanceof Aa||O instanceof la)for(var N=0,Z=O.uniformNames;N<Z.length;N+=1){var K=Z[N];if(d[K]){var mt=O.getBinding(f,d[K],K);y.push({name:K,property:T,binding:mt})}}}return y},pa.prototype.setUniforms=function(f,d,y,T){for(var O=0,N=d;O<N.length;O+=1){var Z=N[O],K=Z.name,mt=Z.property;this.binders[mt].setUniform(Z.binding,T,y.get(mt),K)}},pa.prototype.updatePaintBuffers=function(f){for(var d in this._buffers=[],this.binders){var y=this.binders[d];if(f&&y instanceof Na){var T=f.fromScale===2?y.zoomInPaintVertexBuffer:y.zoomOutPaintVertexBuffer;T&&this._buffers.push(T)}else(y instanceof ka||y instanceof la)&&y.paintVertexBuffer&&this._buffers.push(y.paintVertexBuffer)}},pa.prototype.upload=function(f){for(var d in this.binders){var y=this.binders[d];(y instanceof ka||y instanceof la||y instanceof Na)&&y.upload(f)}this.updatePaintBuffers()},pa.prototype.destroy=function(){for(var f in this.binders){var d=this.binders[f];(d instanceof ka||d instanceof la||d instanceof Na)&&d.destroy()}};var da=function(f,d,y){y===void 0&&(y=function(){return!0}),this.programConfigurations={};for(var T=0,O=f;T<O.length;T+=1){var N=O[T];this.programConfigurations[N.id]=new pa(N,d,y)}this.needsUpload=!1,this._featureMap=new Pr,this._bufferOffset=0};function Ds(f,d){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[f]||[f.replace(d+"-","").replace(/-/g,"_")]}function ss(f,d,y){var T={color:{source:Ms,composite:Yc},number:{source:bl,composite:Ms}},O=function(N){return{"line-pattern":{source:$u,composite:$u},"fill-pattern":{source:$u,composite:$u},"fill-extrusion-pattern":{source:$u,composite:$u}}[N]}(f);return O&&O[y]||T[d][y]}da.prototype.populatePaintArrays=function(f,d,y,T,O,N){for(var Z in this.programConfigurations)this.programConfigurations[Z].populatePaintArrays(f,d,T,O,N);d.id!==void 0&&this._featureMap.add(d.id,y,this._bufferOffset,f),this._bufferOffset=f,this.needsUpload=!0},da.prototype.updatePaintArrays=function(f,d,y,T){for(var O=0,N=y;O<N.length;O+=1){var Z=N[O];this.needsUpload=this.programConfigurations[Z.id].updatePaintArrays(f,this._featureMap,d,Z,T)||this.needsUpload}},da.prototype.get=function(f){return this.programConfigurations[f]},da.prototype.upload=function(f){if(this.needsUpload){for(var d in this.programConfigurations)this.programConfigurations[d].upload(f);this.needsUpload=!1}},da.prototype.destroy=function(){for(var f in this.programConfigurations)this.programConfigurations[f].destroy()},Zi("ConstantBinder",Ra),Zi("CrossFadedConstantBinder",Aa),Zi("SourceExpressionBinder",ka),Zi("CrossFadedCompositeBinder",Na),Zi("CompositeExpressionBinder",la),Zi("ProgramConfiguration",pa,{omit:["_buffers"]}),Zi("ProgramConfigurationSet",da);var ou=Math.pow(2,14)-1,Ks=-ou-1;function ls(f){for(var d=8192/f.extent,y=f.loadGeometry(),T=0;T<y.length;T++)for(var O=y[T],N=0;N<O.length;N++){var Z=O[N],K=Math.round(Z.x*d),mt=Math.round(Z.y*d);Z.x=Zt(K,Ks,ou),Z.y=Zt(mt,Ks,ou),(K<Z.x||K>Z.x+1||mt<Z.y||mt>Z.y+1)&&ee("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return y}function cs(f,d){return{type:f.type,id:f.id,properties:f.properties,geometry:d?ls(f):[]}}function vu(f,d,y,T,O){f.emplaceBack(2*d+(T+1)/2,2*y+(O+1)/2)}var Du=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.layoutVertexArray=new Wc,this.indexArray=new Rs,this.segments=new Be,this.programConfigurations=new da(f.layers,f.zoom),this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function kc(f,d){for(var y=0;y<f.length;y++)if(dc(d,f[y]))return!0;for(var T=0;T<d.length;T++)if(dc(f,d[T]))return!0;return!!yh(f,d)}function qu(f,d,y){return!!dc(f,d)||!!Ql(d,f,y)}function Kl(f,d){if(f.length===1)return Yf(d,f[0]);for(var y=0;y<d.length;y++)for(var T=d[y],O=0;O<T.length;O++)if(dc(f,T[O]))return!0;for(var N=0;N<f.length;N++)if(Yf(d,f[N]))return!0;for(var Z=0;Z<d.length;Z++)if(yh(f,d[Z]))return!0;return!1}function cl(f,d,y){if(f.length>1){if(yh(f,d))return!0;for(var T=0;T<d.length;T++)if(Ql(d[T],f,y))return!0}for(var O=0;O<f.length;O++)if(Ql(f[O],d,y))return!0;return!1}function yh(f,d){if(f.length===0||d.length===0)return!1;for(var y=0;y<f.length-1;y++)for(var T=f[y],O=f[y+1],N=0;N<d.length-1;N++)if(El(T,O,d[N],d[N+1]))return!0;return!1}function El(f,d,y,T){return we(f,y,T)!==we(d,y,T)&&we(f,d,y)!==we(f,d,T)}function Ql(f,d,y){var T=y*y;if(d.length===1)return f.distSqr(d[0])<T;for(var O=1;O<d.length;O++)if(_h(f,d[O-1],d[O])<T)return!0;return!1}function _h(f,d,y){var T=d.distSqr(y);if(T===0)return f.distSqr(d);var O=((f.x-d.x)*(y.x-d.x)+(f.y-d.y)*(y.y-d.y))/T;return f.distSqr(O<0?d:O>1?y:y.sub(d)._mult(O)._add(d))}function Yf(f,d){for(var y,T,O,N=!1,Z=0;Z<f.length;Z++)for(var K=0,mt=(y=f[Z]).length-1;K<y.length;mt=K++)(T=y[K]).y>d.y!=(O=y[mt]).y>d.y&&d.x<(O.x-T.x)*(d.y-T.y)/(O.y-T.y)+T.x&&(N=!N);return N}function dc(f,d){for(var y=!1,T=0,O=f.length-1;T<f.length;O=T++){var N=f[T],Z=f[O];N.y>d.y!=Z.y>d.y&&d.x<(Z.x-N.x)*(d.y-N.y)/(Z.y-N.y)+N.x&&(y=!y)}return y}function xh(f,d,y){var T=y[0],O=y[2];if(f.x<T.x&&d.x<T.x||f.x>O.x&&d.x>O.x||f.y<T.y&&d.y<T.y||f.y>O.y&&d.y>O.y)return!1;var N=we(f,d,y[0]);return N!==we(f,d,y[1])||N!==we(f,d,y[2])||N!==we(f,d,y[3])}function Jl(f,d,y){var T=d.paint.get(f).value;return T.kind==="constant"?T.value:y.programConfigurations.get(d.id).getMaxValue(f)}function js(f){return Math.sqrt(f[0]*f[0]+f[1]*f[1])}function $c(f,d,y,T,O){if(!d[0]&&!d[1])return f;var N=ht.convert(d)._mult(O);y==="viewport"&&N._rotate(-T);for(var Z=[],K=0;K<f.length;K++)Z.push(f[K].sub(N));return Z}Du.prototype.populate=function(f,d,y){var T=this.layers[0],O=[],N=null;T.type==="circle"&&(N=T.layout.get("circle-sort-key"));for(var Z=0,K=f;Z<K.length;Z+=1){var mt=K[Z],Ot=mt.feature,Gt=mt.id,Kt=mt.index,pe=mt.sourceLayerIndex,Fe=this.layers[0]._featureFilter.needGeometry,sr=cs(Ot,Fe);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),sr,y)){var lr=N?N.evaluate(sr,{},y):void 0,Cr={id:Gt,properties:Ot.properties,type:Ot.type,sourceLayerIndex:pe,index:Kt,geometry:Fe?sr.geometry:ls(Ot),patterns:{},sortKey:lr};O.push(Cr)}}N&&O.sort(function(ki,oa){return ki.sortKey-oa.sortKey});for(var gr=0,Ur=O;gr<Ur.length;gr+=1){var Ar=Ur[gr],Dr=Ar.geometry,mn=Ar.index,Fn=Ar.sourceLayerIndex,ni=f[mn].feature;this.addFeature(Ar,Dr,mn,y),d.featureIndex.insert(ni,Dr,mn,Fn,this.index)}},Du.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Du.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Du.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Du.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,De),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},Du.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Du.prototype.addFeature=function(f,d,y,T){for(var O=0,N=d;O<N.length;O+=1)for(var Z=0,K=N[O];Z<K.length;Z+=1){var mt=K[Z],Ot=mt.x,Gt=mt.y;if(!(Ot<0||Ot>=8192||Gt<0||Gt>=8192)){var Kt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,f.sortKey),pe=Kt.vertexLength;vu(this.layoutVertexArray,Ot,Gt,-1,-1),vu(this.layoutVertexArray,Ot,Gt,1,-1),vu(this.layoutVertexArray,Ot,Gt,1,1),vu(this.layoutVertexArray,Ot,Gt,-1,1),this.indexArray.emplaceBack(pe,pe+1,pe+2),this.indexArray.emplaceBack(pe,pe+3,pe+2),Kt.vertexLength+=4,Kt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,{},T)},Zi("CircleBucket",Du,{omit:["layers"]});var Tf=new Ru({"circle-sort-key":new Wi(Pe.layout_circle["circle-sort-key"])}),vc={paint:new Ru({"circle-radius":new Wi(Pe.paint_circle["circle-radius"]),"circle-color":new Wi(Pe.paint_circle["circle-color"]),"circle-blur":new Wi(Pe.paint_circle["circle-blur"]),"circle-opacity":new Wi(Pe.paint_circle["circle-opacity"]),"circle-translate":new Ki(Pe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ki(Pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ki(Pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ki(Pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wi(Pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wi(Pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wi(Pe.paint_circle["circle-stroke-opacity"])}),layout:Tf},Lo=typeof Float32Array!="undefined"?Float32Array:Array;function wl(f){return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function Ku(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3],K=d[4],mt=d[5],Ot=d[6],Gt=d[7],Kt=d[8],pe=d[9],Fe=d[10],sr=d[11],lr=d[12],Cr=d[13],gr=d[14],Ur=d[15],Ar=y[0],Dr=y[1],mn=y[2],Fn=y[3];return f[0]=Ar*T+Dr*K+mn*Kt+Fn*lr,f[1]=Ar*O+Dr*mt+mn*pe+Fn*Cr,f[2]=Ar*N+Dr*Ot+mn*Fe+Fn*gr,f[3]=Ar*Z+Dr*Gt+mn*sr+Fn*Ur,f[4]=(Ar=y[4])*T+(Dr=y[5])*K+(mn=y[6])*Kt+(Fn=y[7])*lr,f[5]=Ar*O+Dr*mt+mn*pe+Fn*Cr,f[6]=Ar*N+Dr*Ot+mn*Fe+Fn*gr,f[7]=Ar*Z+Dr*Gt+mn*sr+Fn*Ur,f[8]=(Ar=y[8])*T+(Dr=y[9])*K+(mn=y[10])*Kt+(Fn=y[11])*lr,f[9]=Ar*O+Dr*mt+mn*pe+Fn*Cr,f[10]=Ar*N+Dr*Ot+mn*Fe+Fn*gr,f[11]=Ar*Z+Dr*Gt+mn*sr+Fn*Ur,f[12]=(Ar=y[12])*T+(Dr=y[13])*K+(mn=y[14])*Kt+(Fn=y[15])*lr,f[13]=Ar*O+Dr*mt+mn*pe+Fn*Cr,f[14]=Ar*N+Dr*Ot+mn*Fe+Fn*gr,f[15]=Ar*Z+Dr*Gt+mn*sr+Fn*Ur,f}Math.hypot||(Math.hypot=function(){for(var f=arguments,d=0,y=arguments.length;y--;)d+=f[y]*f[y];return Math.sqrt(d)});var qc,Kc=Ku;function $f(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3];return f[0]=y[0]*T+y[4]*O+y[8]*N+y[12]*Z,f[1]=y[1]*T+y[5]*O+y[9]*N+y[13]*Z,f[2]=y[2]*T+y[6]*O+y[10]*N+y[14]*Z,f[3]=y[3]*T+y[7]*O+y[11]*N+y[15]*Z,f}qc=new Lo(3),Lo!=Float32Array&&(qc[0]=0,qc[1]=0,qc[2]=0),function(){var f=new Lo(4);Lo!=Float32Array&&(f[0]=0,f[1]=0,f[2]=0,f[3]=0)}();var Qc=(function(){var f=new Lo(2);Lo!=Float32Array&&(f[0]=0,f[1]=0)}(),function(f){function d(y){f.call(this,y,vc)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new Du(y)},d.prototype.queryRadius=function(y){var T=y;return Jl("circle-radius",this,T)+Jl("circle-stroke-width",this,T)+js(this.paint.get("circle-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,K,mt,Ot){for(var Gt=$c(y,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),K.angle,mt),Kt=this.paint.get("circle-radius").evaluate(T,O)+this.paint.get("circle-stroke-width").evaluate(T,O),pe=this.paint.get("circle-pitch-alignment")==="map",Fe=pe?Gt:function(ni,ki){return ni.map(function(oa){return Bu(oa,ki)})}(Gt,Ot),sr=pe?Kt*mt:Kt,lr=0,Cr=N;lr<Cr.length;lr+=1)for(var gr=0,Ur=Cr[lr];gr<Ur.length;gr+=1){var Ar=Ur[gr],Dr=pe?Ar:Bu(Ar,Ot),mn=sr,Fn=$f([],[Ar.x,Ar.y,0,1],Ot);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mn*=Fn[3]/K.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mn*=K.cameraToCenterDistance/Fn[3]),qu(Fe,Dr,mn))return!0}return!1},d}(bs));function Bu(f,d){var y=$f([],[f.x,f.y,0,1],d);return new ht(y[0]/y[3],y[1]/y[3])}var bh=function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(Du);function tc(f,d,y,T){var O=d.width,N=d.height;if(T){if(T instanceof Uint8ClampedArray)T=new Uint8Array(T.buffer);else if(T.length!==O*N*y)throw new RangeError("mismatched image size")}else T=new Uint8Array(O*N*y);return f.width=O,f.height=N,f.data=T,f}function Jc(f,d,y){var T=d.width,O=d.height;if(T!==f.width||O!==f.height){var N=tc({},{width:T,height:O},y);Eh(f,N,{x:0,y:0},{x:0,y:0},{width:Math.min(f.width,T),height:Math.min(f.height,O)},y),f.width=T,f.height=O,f.data=N.data}}function Eh(f,d,y,T,O,N){if(O.width===0||O.height===0)return d;if(O.width>f.width||O.height>f.height||y.x>f.width-O.width||y.y>f.height-O.height)throw new RangeError("out of range source coordinates for image copy");if(O.width>d.width||O.height>d.height||T.x>d.width-O.width||T.y>d.height-O.height)throw new RangeError("out of range destination coordinates for image copy");for(var Z=f.data,K=d.data,mt=0;mt<O.height;mt++)for(var Ot=((y.y+mt)*f.width+y.x)*N,Gt=((T.y+mt)*d.width+T.x)*N,Kt=0;Kt<O.width*N;Kt++)K[Gt+Kt]=Z[Ot+Kt];return d}Zi("HeatmapBucket",bh,{omit:["layers"]});var kl=function(f,d){tc(this,f,1,d)};kl.prototype.resize=function(f){Jc(this,f,1)},kl.prototype.clone=function(){return new kl({width:this.width,height:this.height},new Uint8Array(this.data))},kl.copy=function(f,d,y,T,O){Eh(f,d,y,T,O,1)};var Cu=function(f,d){tc(this,f,4,d)};Cu.prototype.resize=function(f){Jc(this,f,4)},Cu.prototype.replace=function(f,d){d?this.data.set(f):this.data=f instanceof Uint8ClampedArray?new Uint8Array(f.buffer):f},Cu.prototype.clone=function(){return new Cu({width:this.width,height:this.height},new Uint8Array(this.data))},Cu.copy=function(f,d,y,T,O){Eh(f,d,y,T,O,4)},Zi("AlphaImage",kl),Zi("RGBAImage",Cu);var sp={paint:new Ru({"heatmap-radius":new Wi(Pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wi(Pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ki(Pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new sl(Pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ki(Pe.paint_heatmap["heatmap-opacity"])})};function Sd(f){var d={},y=f.resolution||256,T=f.clips?f.clips.length:1,O=f.image||new Cu({width:y,height:T}),N=function(sr,lr,Cr){d[f.evaluationKey]=Cr;var gr=f.expression.evaluate(d);O.data[sr+lr+0]=Math.floor(255*gr.r/gr.a),O.data[sr+lr+1]=Math.floor(255*gr.g/gr.a),O.data[sr+lr+2]=Math.floor(255*gr.b/gr.a),O.data[sr+lr+3]=Math.floor(255*gr.a)};if(f.clips)for(var Z=0,K=0;Z<T;++Z,K+=4*y)for(var mt=0,Ot=0;mt<y;mt++,Ot+=4){var Gt=mt/(y-1),Kt=f.clips[Z];N(K,Ot,Kt.start*(1-Gt)+Kt.end*Gt)}else for(var pe=0,Fe=0;pe<y;pe++,Fe+=4)N(0,Fe,pe/(y-1));return O}var uv=function(f){function d(y){f.call(this,y,sp),this._updateColorRamp()}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new bh(y)},d.prototype._handleSpecialPaintPropertyUpdate=function(y){y==="heatmap-color"&&this._updateColorRamp()},d.prototype._updateColorRamp=function(){this.colorRamp=Sd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},d.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},d}(bs),lv={paint:new Ru({"hillshade-illumination-direction":new Ki(Pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ki(Pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ki(Pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ki(Pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ki(Pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ki(Pe.paint_hillshade["hillshade-accent-color"])})},G0=function(f){function d(y){f.call(this,y,lv)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},d}(bs),Up=os([{name:"a_pos",components:2,type:"Int16"}],4).members,Lc=wh,tf=wh;function wh(f,d,y){y=y||2;var T,O,N,Z,K,mt,Ot,Gt=d&&d.length,Kt=Gt?d[0]*y:f.length,pe=cv(f,0,Kt,y,!0),Fe=[];if(!pe||pe.next===pe.prev)return Fe;if(Gt&&(pe=function(lr,Cr,gr,Ur){var Ar,Dr,mn,Fn=[];for(Ar=0,Dr=Cr.length;Ar<Dr;Ar++)(mn=cv(lr,Cr[Ar]*Ur,Ar<Dr-1?Cr[Ar+1]*Ur:lr.length,Ur,!1))===mn.next&&(mn.steiner=!0),Fn.push(Vp(mn));for(Fn.sort(Zp),Ar=0;Ar<Fn.length;Ar++)ef(Fn[Ar],gr),gr=Sl(gr,gr.next);return gr}(f,d,pe,y)),f.length>80*y){T=N=f[0],O=Z=f[1];for(var sr=y;sr<Kt;sr+=y)(K=f[sr])<T&&(T=K),(mt=f[sr+1])<O&&(O=mt),K>N&&(N=K),mt>Z&&(Z=mt);Ot=(Ot=Math.max(N-T,Z-O))!==0?1/Ot:0}return ei(pe,Fe,y,T,O,Ot),Fe}function cv(f,d,y,T,O){var N,Z;if(O===Id(f,d,y,T)>0)for(N=d;N<y;N+=T)Z=Md(N,f[N],f[N+1],Z);else for(N=y-T;N>=d;N-=T)Z=Md(N,f[N],f[N+1],Z);return Z&&qf(Z,Z.next)&&(Kf(Z),Z=Z.next),Z}function Sl(f,d){if(!f)return f;d||(d=f);var y,T=f;do if(y=!1,T.steiner||!qf(T,T.next)&&Ns(T.prev,T,T.next)!==0)T=T.next;else{if(Kf(T),(T=d=T.prev)===T.next)break;y=!0}while(y||T!==d);return d}function ei(f,d,y,T,O,N,Z){if(f){!Z&&N&&function(Gt,Kt,pe,Fe){var sr=Gt;do sr.z===null&&(sr.z=Pc(sr.x,sr.y,Kt,pe,Fe)),sr.prevZ=sr.prev,sr.nextZ=sr.next,sr=sr.next;while(sr!==Gt);sr.prevZ.nextZ=null,sr.prevZ=null,function(lr){var Cr,gr,Ur,Ar,Dr,mn,Fn,ni,ki=1;do{for(gr=lr,lr=null,Dr=null,mn=0;gr;){for(mn++,Ur=gr,Fn=0,Cr=0;Cr<ki&&(Fn++,Ur=Ur.nextZ);Cr++);for(ni=ki;Fn>0||ni>0&&Ur;)Fn!==0&&(ni===0||!Ur||gr.z<=Ur.z)?(Ar=gr,gr=gr.nextZ,Fn--):(Ar=Ur,Ur=Ur.nextZ,ni--),Dr?Dr.nextZ=Ar:lr=Ar,Ar.prevZ=Dr,Dr=Ar;gr=Ur}Dr.nextZ=null,ki*=2}while(mn>1)}(sr)}(f,T,O,N);for(var K,mt,Ot=f;f.prev!==f.next;)if(K=f.prev,mt=f.next,N?Gm(f,T,O,N):Cd(f))d.push(K.i/y),d.push(f.i/y),d.push(mt.i/y),Kf(f),f=mt.next,Ot=mt.next;else if((f=mt)===Ot){Z?Z===1?ei(f=Bs(Sl(f),d,y),d,y,T,O,N,2):Z===2&&Mf(f,d,y,T,O,N):ei(Sl(f),d,y,T,O,N,1);break}}}function Cd(f){var d=f.prev,y=f,T=f.next;if(Ns(d,y,T)>=0)return!1;for(var O=f.next.next;O!==f.prev;){if(Sh(d.x,d.y,y.x,y.y,T.x,T.y,O.x,O.y)&&Ns(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function Gm(f,d,y,T){var O=f.prev,N=f,Z=f.next;if(Ns(O,N,Z)>=0)return!1;for(var K=O.x>N.x?O.x>Z.x?O.x:Z.x:N.x>Z.x?N.x:Z.x,mt=O.y>N.y?O.y>Z.y?O.y:Z.y:N.y>Z.y?N.y:Z.y,Ot=Pc(O.x<N.x?O.x<Z.x?O.x:Z.x:N.x<Z.x?N.x:Z.x,O.y<N.y?O.y<Z.y?O.y:Z.y:N.y<Z.y?N.y:Z.y,d,y,T),Gt=Pc(K,mt,d,y,T),Kt=f.prevZ,pe=f.nextZ;Kt&&Kt.z>=Ot&&pe&&pe.z<=Gt;){if(Kt!==f.prev&&Kt!==f.next&&Sh(O.x,O.y,N.x,N.y,Z.x,Z.y,Kt.x,Kt.y)&&Ns(Kt.prev,Kt,Kt.next)>=0||(Kt=Kt.prevZ,pe!==f.prev&&pe!==f.next&&Sh(O.x,O.y,N.x,N.y,Z.x,Z.y,pe.x,pe.y)&&Ns(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;Kt&&Kt.z>=Ot;){if(Kt!==f.prev&&Kt!==f.next&&Sh(O.x,O.y,N.x,N.y,Z.x,Z.y,Kt.x,Kt.y)&&Ns(Kt.prev,Kt,Kt.next)>=0)return!1;Kt=Kt.prevZ}for(;pe&&pe.z<=Gt;){if(pe!==f.prev&&pe!==f.next&&Sh(O.x,O.y,N.x,N.y,Z.x,Z.y,pe.x,pe.y)&&Ns(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function Bs(f,d,y){var T=f;do{var O=T.prev,N=T.next.next;!qf(O,N)&&Ad(O,T,T.next,N)&&Td(O,N)&&Td(N,O)&&(d.push(O.i/y),d.push(T.i/y),d.push(N.i/y),Kf(T),Kf(T.next),T=f=N),T=T.next}while(T!==f);return Sl(T)}function Mf(f,d,y,T,O,N){var Z=f;do{for(var K=Z.next.next;K!==Z.prev;){if(Z.i!==K.i&&fv(Z,K)){var mt=pv(Z,K);return Z=Sl(Z,Z.next),mt=Sl(mt,mt.next),ei(Z,d,y,T,O,N),void ei(mt,d,y,T,O,N)}K=K.next}Z=Z.next}while(Z!==f)}function Zp(f,d){return f.x-d.x}function ef(f,d){if(d=function(T,O){var N,Z=O,K=T.x,mt=T.y,Ot=-1/0;do{if(mt<=Z.y&&mt>=Z.next.y&&Z.next.y!==Z.y){var Gt=Z.x+(mt-Z.y)*(Z.next.x-Z.x)/(Z.next.y-Z.y);if(Gt<=K&&Gt>Ot){if(Ot=Gt,Gt===K){if(mt===Z.y)return Z;if(mt===Z.next.y)return Z.next}N=Z.x<Z.next.x?Z:Z.next}}Z=Z.next}while(Z!==O);if(!N)return null;if(K===Ot)return N;var Kt,pe=N,Fe=N.x,sr=N.y,lr=1/0;Z=N;do K>=Z.x&&Z.x>=Fe&&K!==Z.x&&Sh(mt<sr?K:Ot,mt,Fe,sr,mt<sr?Ot:K,mt,Z.x,Z.y)&&(Kt=Math.abs(mt-Z.y)/(K-Z.x),Td(Z,T)&&(Kt<lr||Kt===lr&&(Z.x>N.x||Z.x===N.x&&Cl(N,Z)))&&(N=Z,lr=Kt)),Z=Z.next;while(Z!==pe);return N}(f,d)){var y=pv(d,f);Sl(d,d.next),Sl(y,y.next)}}function Cl(f,d){return Ns(f.prev,f,d.prev)<0&&Ns(d.next,f,f.next)<0}function Pc(f,d,y,T,O){return(f=1431655765&((f=858993459&((f=252645135&((f=16711935&((f=32767*(f-y)*O)|f<<8))|f<<4))|f<<2))|f<<1))|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=32767*(d-T)*O)|d<<8))|d<<4))|d<<2))|d<<1))<<1}function Vp(f){var d=f,y=f;do(d.x<y.x||d.x===y.x&&d.y<y.y)&&(y=d),d=d.next;while(d!==f);return y}function Sh(f,d,y,T,O,N,Z,K){return(O-Z)*(d-K)-(f-Z)*(N-K)>=0&&(f-Z)*(T-K)-(y-Z)*(d-K)>=0&&(y-Z)*(N-K)-(O-Z)*(T-K)>=0}function fv(f,d){return f.next.i!==d.i&&f.prev.i!==d.i&&!function(y,T){var O=y;do{if(O.i!==y.i&&O.next.i!==y.i&&O.i!==T.i&&O.next.i!==T.i&&Ad(O,O.next,y,T))return!0;O=O.next}while(O!==y);return!1}(f,d)&&(Td(f,d)&&Td(d,f)&&function(y,T){var O=y,N=!1,Z=(y.x+T.x)/2,K=(y.y+T.y)/2;do O.y>K!=O.next.y>K&&O.next.y!==O.y&&Z<(O.next.x-O.x)*(K-O.y)/(O.next.y-O.y)+O.x&&(N=!N),O=O.next;while(O!==y);return N}(f,d)&&(Ns(f.prev,f,d.prev)||Ns(f,d.prev,d))||qf(f,d)&&Ns(f.prev,f,f.next)>0&&Ns(d.prev,d,d.next)>0)}function Ns(f,d,y){return(d.y-f.y)*(y.x-d.x)-(d.x-f.x)*(y.y-d.y)}function qf(f,d){return f.x===d.x&&f.y===d.y}function Ad(f,d,y,T){var O=hv(Ns(f,d,y)),N=hv(Ns(f,d,T)),Z=hv(Ns(y,T,f)),K=hv(Ns(y,T,d));return O!==N&&Z!==K||!(O!==0||!gc(f,y,d))||!(N!==0||!gc(f,T,d))||!(Z!==0||!gc(y,f,T))||!(K!==0||!gc(y,d,T))}function gc(f,d,y){return d.x<=Math.max(f.x,y.x)&&d.x>=Math.min(f.x,y.x)&&d.y<=Math.max(f.y,y.y)&&d.y>=Math.min(f.y,y.y)}function hv(f){return f>0?1:f<0?-1:0}function Td(f,d){return Ns(f.prev,f,f.next)<0?Ns(f,d,f.next)>=0&&Ns(f,f.prev,d)>=0:Ns(f,d,f.prev)<0||Ns(f,f.next,d)<0}function pv(f,d){var y=new up(f.i,f.x,f.y),T=new up(d.i,d.x,d.y),O=f.next,N=d.prev;return f.next=d,d.prev=f,y.next=O,O.prev=y,T.next=y,y.prev=T,N.next=T,T.prev=N,T}function Md(f,d,y,T){var O=new up(f,d,y);return T?(O.next=T.next,O.prev=T,T.next.prev=O,T.next=O):(O.prev=O,O.next=O),O}function Kf(f){f.next.prev=f.prev,f.prev.next=f.next,f.prevZ&&(f.prevZ.nextZ=f.nextZ),f.nextZ&&(f.nextZ.prevZ=f.prevZ)}function up(f,d,y){this.i=f,this.x=d,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Id(f,d,y,T){for(var O=0,N=d,Z=y-T;N<y;N+=T)O+=(f[Z]-f[N])*(f[N+1]+f[Z+1]),Z=N;return O}function Gp(f,d,y,T,O){(function N(Z,K,mt,Ot,Gt){for(;Ot>mt;){if(Ot-mt>600){var Kt=Ot-mt+1,pe=K-mt+1,Fe=Math.log(Kt),sr=.5*Math.exp(2*Fe/3),lr=.5*Math.sqrt(Fe*sr*(Kt-sr)/Kt)*(pe-Kt/2<0?-1:1);N(Z,K,Math.max(mt,Math.floor(K-pe*sr/Kt+lr)),Math.min(Ot,Math.floor(K+(Kt-pe)*sr/Kt+lr)),Gt)}var Cr=Z[K],gr=mt,Ur=Ot;for(Qf(Z,mt,K),Gt(Z[Ot],Cr)>0&&Qf(Z,mt,Ot);gr<Ur;){for(Qf(Z,gr,Ur),gr++,Ur--;Gt(Z[gr],Cr)<0;)gr++;for(;Gt(Z[Ur],Cr)>0;)Ur--}Gt(Z[mt],Cr)===0?Qf(Z,mt,Ur):Qf(Z,++Ur,Ot),Ur<=K&&(mt=Ur+1),K<=Ur&&(Ot=Ur-1)}})(f,d,y||0,T||f.length-1,O||dv)}function Qf(f,d,y){var T=f[d];f[d]=f[y],f[y]=T}function dv(f,d){return f<d?-1:f>d?1:0}function rf(f,d){var y=f.length;if(y<=1)return[f];for(var T,O,N=[],Z=0;Z<y;Z++){var K=_e(f[Z]);K!==0&&(f[Z].area=Math.abs(K),O===void 0&&(O=K<0),O===K<0?(T&&N.push(T),T=[f[Z]]):T.push(f[Z]))}if(T&&N.push(T),d>1)for(var mt=0;mt<N.length;mt++)N[mt].length<=d||(Gp(N[mt],d,1,N[mt].length-1,vv),N[mt]=N[mt].slice(0,d));return N}function vv(f,d){return d.area-f.area}function nf(f,d,y){for(var T=y.patternDependencies,O=!1,N=0,Z=d;N<Z.length;N+=1){var K=Z[N].paint.get(f+"-pattern");K.isConstant()||(O=!0);var mt=K.constantOr(null);mt&&(O=!0,T[mt.to]=!0,T[mt.from]=!0)}return O}function Hp(f,d,y,T,O){for(var N=O.patternDependencies,Z=0,K=d;Z<K.length;Z+=1){var mt=K[Z],Ot=mt.paint.get(f+"-pattern").value;if(Ot.kind!=="constant"){var Gt=Ot.evaluate({zoom:T-1},y,{},O.availableImages),Kt=Ot.evaluate({zoom:T},y,{},O.availableImages),pe=Ot.evaluate({zoom:T+1},y,{},O.availableImages);Kt=Kt&&Kt.name?Kt.name:Kt,pe=pe&&pe.name?pe.name:pe,N[Gt=Gt&&Gt.name?Gt.name:Gt]=!0,N[Kt]=!0,N[pe]=!0,y.patterns[mt.id]={min:Gt,mid:Kt,max:pe}}}return y}wh.deviation=function(f,d,y,T){var O=d&&d.length,N=Math.abs(Id(f,0,O?d[0]*y:f.length,y));if(O)for(var Z=0,K=d.length;Z<K;Z++)N-=Math.abs(Id(f,d[Z]*y,Z<K-1?d[Z+1]*y:f.length,y));var mt=0;for(Z=0;Z<T.length;Z+=3){var Ot=T[Z]*y,Gt=T[Z+1]*y,Kt=T[Z+2]*y;mt+=Math.abs((f[Ot]-f[Kt])*(f[Gt+1]-f[Ot+1])-(f[Ot]-f[Gt])*(f[Kt+1]-f[Ot+1]))}return N===0&&mt===0?0:Math.abs((mt-N)/N)},wh.flatten=function(f){for(var d=f[0][0].length,y={vertices:[],holes:[],dimensions:d},T=0,O=0;O<f.length;O++){for(var N=0;N<f[O].length;N++)for(var Z=0;Z<d;Z++)y.vertices.push(f[O][N][Z]);O>0&&y.holes.push(T+=f[O-1].length)}return y},Lc.default=tf;var Ul=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wc,this.indexArray=new Rs,this.indexArray2=new pc,this.programConfigurations=new da(f.layers,f.zoom),this.segments=new Be,this.segments2=new Be,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};Ul.prototype.populate=function(f,d,y){this.hasPattern=nf("fill",this.layers,d);for(var T=this.layers[0].layout.get("fill-sort-key"),O=[],N=0,Z=f;N<Z.length;N+=1){var K=Z[N],mt=K.feature,Ot=K.id,Gt=K.index,Kt=K.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Fe=cs(mt,pe);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),Fe,y)){var sr=T?T.evaluate(Fe,{},y,d.availableImages):void 0,lr={id:Ot,properties:mt.properties,type:mt.type,sourceLayerIndex:Kt,index:Gt,geometry:pe?Fe.geometry:ls(mt),patterns:{},sortKey:sr};O.push(lr)}}T&&O.sort(function(ni,ki){return ni.sortKey-ki.sortKey});for(var Cr=0,gr=O;Cr<gr.length;Cr+=1){var Ur=gr[Cr],Ar=Ur.geometry,Dr=Ur.index,mn=Ur.sourceLayerIndex;if(this.hasPattern){var Fn=Hp("fill",this.layers,Ur,this.zoom,d);this.patternFeatures.push(Fn)}else this.addFeature(Ur,Ar,Dr,y,{});d.featureIndex.insert(f[Dr].feature,Ar,Dr,mn,this.index)}},Ul.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Ul.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.patternFeatures;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},Ul.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ul.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ul.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Up),this.indexBuffer=f.createIndexBuffer(this.indexArray),this.indexBuffer2=f.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(f),this.uploaded=!0},Ul.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ul.prototype.addFeature=function(f,d,y,T,O){for(var N=0,Z=rf(d,500);N<Z.length;N+=1){for(var K=Z[N],mt=0,Ot=0,Gt=K;Ot<Gt.length;Ot+=1)mt+=Gt[Ot].length;for(var Kt=this.segments.prepareSegment(mt,this.layoutVertexArray,this.indexArray),pe=Kt.vertexLength,Fe=[],sr=[],lr=0,Cr=K;lr<Cr.length;lr+=1){var gr=Cr[lr];if(gr.length!==0){gr!==K[0]&&sr.push(Fe.length/2);var Ur=this.segments2.prepareSegment(gr.length,this.layoutVertexArray,this.indexArray2),Ar=Ur.vertexLength;this.layoutVertexArray.emplaceBack(gr[0].x,gr[0].y),this.indexArray2.emplaceBack(Ar+gr.length-1,Ar),Fe.push(gr[0].x),Fe.push(gr[0].y);for(var Dr=1;Dr<gr.length;Dr++)this.layoutVertexArray.emplaceBack(gr[Dr].x,gr[Dr].y),this.indexArray2.emplaceBack(Ar+Dr-1,Ar+Dr),Fe.push(gr[Dr].x),Fe.push(gr[Dr].y);Ur.vertexLength+=gr.length,Ur.primitiveLength+=gr.length}}for(var mn=Lc(Fe,sr),Fn=0;Fn<mn.length;Fn+=3)this.indexArray.emplaceBack(pe+mn[Fn],pe+mn[Fn+1],pe+mn[Fn+2]);Kt.vertexLength+=mt,Kt.primitiveLength+=mn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},Zi("FillBucket",Ul,{omit:["layers","patternFeatures"]});var kd=new Ru({"fill-sort-key":new Wi(Pe.layout_fill["fill-sort-key"])}),Ld={paint:new Ru({"fill-antialias":new Ki(Pe.paint_fill["fill-antialias"]),"fill-opacity":new Wi(Pe.paint_fill["fill-opacity"]),"fill-color":new Wi(Pe.paint_fill["fill-color"]),"fill-outline-color":new Wi(Pe.paint_fill["fill-outline-color"]),"fill-translate":new Ki(Pe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ki(Pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Af(Pe.paint_fill["fill-pattern"])}),layout:kd},Pd=function(f){function d(y){f.call(this,y,Ld)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.recalculate=function(y,T){f.prototype.recalculate.call(this,y,T);var O=this.paint._values["fill-outline-color"];O.value.kind==="constant"&&O.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},d.prototype.createBucket=function(y){return new Ul(y)},d.prototype.queryRadius=function(){return js(this.paint.get("fill-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,K,mt){return Kl($c(y,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),K.angle,mt),N)},d.prototype.isTileClipped=function(){return!0},d}(bs),jp=os([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,af=ec;function ec(f,d,y,T,O){this.properties={},this.extent=y,this.type=0,this._pbf=f,this._geometry=-1,this._keys=T,this._values=O,f.readFields(Wp,this,d)}function Wp(f,d,y){f==1?d.id=y.readVarint():f==2?function(T,O){for(var N=T.readVarint()+T.pos;T.pos<N;){var Z=O._keys[T.readVarint()],K=O._values[T.readVarint()];O.properties[Z]=K}}(y,d):f==3?d.type=y.readVarint():f==4&&(d._geometry=y.pos)}function H0(f){for(var d,y,T=0,O=0,N=f.length,Z=N-1;O<N;Z=O++)T+=((y=f[Z]).x-(d=f[O]).x)*(d.y+y.y);return T}ec.types=["Unknown","Point","LineString","Polygon"],ec.prototype.loadGeometry=function(){var f=this._pbf;f.pos=this._geometry;for(var d,y=f.readVarint()+f.pos,T=1,O=0,N=0,Z=0,K=[];f.pos<y;){if(O<=0){var mt=f.readVarint();T=7&mt,O=mt>>3}if(O--,T===1||T===2)N+=f.readSVarint(),Z+=f.readSVarint(),T===1&&(d&&K.push(d),d=[]),d.push(new ht(N,Z));else{if(T!==7)throw new Error("unknown command "+T);d&&d.push(d[0].clone())}}return d&&K.push(d),K},ec.prototype.bbox=function(){var f=this._pbf;f.pos=this._geometry;for(var d=f.readVarint()+f.pos,y=1,T=0,O=0,N=0,Z=1/0,K=-1/0,mt=1/0,Ot=-1/0;f.pos<d;){if(T<=0){var Gt=f.readVarint();y=7&Gt,T=Gt>>3}if(T--,y===1||y===2)(O+=f.readSVarint())<Z&&(Z=O),O>K&&(K=O),(N+=f.readSVarint())<mt&&(mt=N),N>Ot&&(Ot=N);else if(y!==7)throw new Error("unknown command "+y)}return[Z,mt,K,Ot]},ec.prototype.toGeoJSON=function(f,d,y){var T,O,N=this.extent*Math.pow(2,y),Z=this.extent*f,K=this.extent*d,mt=this.loadGeometry(),Ot=ec.types[this.type];function Gt(Fe){for(var sr=0;sr<Fe.length;sr++){var lr=Fe[sr];Fe[sr]=[360*(lr.x+Z)/N-180,360/Math.PI*Math.atan(Math.exp((180-360*(lr.y+K)/N)*Math.PI/180))-90]}}switch(this.type){case 1:var Kt=[];for(T=0;T<mt.length;T++)Kt[T]=mt[T][0];Gt(mt=Kt);break;case 2:for(T=0;T<mt.length;T++)Gt(mt[T]);break;case 3:for(mt=function(Fe){var sr=Fe.length;if(sr<=1)return[Fe];for(var lr,Cr,gr=[],Ur=0;Ur<sr;Ur++){var Ar=H0(Fe[Ur]);Ar!==0&&(Cr===void 0&&(Cr=Ar<0),Cr===Ar<0?(lr&&gr.push(lr),lr=[Fe[Ur]]):lr.push(Fe[Ur]))}return lr&&gr.push(lr),gr}(mt),T=0;T<mt.length;T++)for(O=0;O<mt[T].length;O++)Gt(mt[T][O])}mt.length===1?mt=mt[0]:Ot="Multi"+Ot;var pe={type:"Feature",geometry:{type:Ot,coordinates:mt},properties:this.properties};return"id"in this&&(pe.id=this.id),pe};var Qv=If;function If(f,d){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=f,this._keys=[],this._values=[],this._features=[],f.readFields(mc,this,d),this.length=this._features.length}function mc(f,d,y){f===15?d.version=y.readVarint():f===1?d.name=y.readString():f===5?d.extent=y.readVarint():f===2?d._features.push(y.pos):f===3?d._keys.push(y.readString()):f===4&&d._values.push(function(T){for(var O=null,N=T.readVarint()+T.pos;T.pos<N;){var Z=T.readVarint()>>3;O=Z===1?T.readString():Z===2?T.readFloat():Z===3?T.readDouble():Z===4?T.readVarint64():Z===5?T.readVarint():Z===6?T.readSVarint():Z===7?T.readBoolean():null}return O}(y))}function j0(f,d,y){if(f===3){var T=new Qv(y,y.readVarint()+y.pos);T.length&&(d[T.name]=T)}}If.prototype.feature=function(f){if(f<0||f>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[f];var d=this._pbf.readVarint()+this._pbf.pos;return new af(this._pbf,d,this.extent,this._keys,this._values)};var rc={VectorTile:function(f,d){this.layers=f.readFields(j0,{},d)},VectorTileFeature:af,VectorTileLayer:Qv},Od=rc.VectorTileFeature.types,Jv=Math.pow(2,13);function of(f,d,y,T,O,N,Z,K){f.emplaceBack(d,y,2*Math.floor(T*Jv)+Z,O*Jv*2,N*Jv*2,Math.round(K))}var sf=function(f){this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(d){return d.id}),this.index=f.index,this.hasPattern=!1,this.layoutVertexArray=new ul,this.indexArray=new Rs,this.programConfigurations=new da(f.layers,f.zoom),this.segments=new Be,this.stateDependentLayerIds=this.layers.filter(function(d){return d.isStateDependent()}).map(function(d){return d.id})};function Fd(f,d){return f.x===d.x&&(f.x<0||f.x>8192)||f.y===d.y&&(f.y<0||f.y>8192)}sf.prototype.populate=function(f,d,y){this.features=[],this.hasPattern=nf("fill-extrusion",this.layers,d);for(var T=0,O=f;T<O.length;T+=1){var N=O[T],Z=N.feature,K=N.id,mt=N.index,Ot=N.sourceLayerIndex,Gt=this.layers[0]._featureFilter.needGeometry,Kt=cs(Z,Gt);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),Kt,y)){var pe={id:K,sourceLayerIndex:Ot,index:mt,geometry:Gt?Kt.geometry:ls(Z),properties:Z.properties,type:Z.type,patterns:{}};this.hasPattern?this.features.push(Hp("fill-extrusion",this.layers,pe,this.zoom,d)):this.addFeature(pe,pe.geometry,mt,y,{}),d.featureIndex.insert(Z,pe.geometry,mt,Ot,this.index,!0)}}},sf.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.features;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},sf.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},sf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},sf.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},sf.prototype.upload=function(f){this.uploaded||(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,jp),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},sf.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},sf.prototype.addFeature=function(f,d,y,T,O){for(var N=0,Z=rf(d,500);N<Z.length;N+=1){for(var K=Z[N],mt=0,Ot=0,Gt=K;Ot<Gt.length;Ot+=1)mt+=Gt[Ot].length;for(var Kt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),pe=0,Fe=K;pe<Fe.length;pe+=1){var sr=Fe[pe];if(sr.length!==0&&!((lo=sr).every(function(Ja){return Ja.x<0})||lo.every(function(Ja){return Ja.x>8192})||lo.every(function(Ja){return Ja.y<0})||lo.every(function(Ja){return Ja.y>8192})))for(var lr=0,Cr=0;Cr<sr.length;Cr++){var gr=sr[Cr];if(Cr>=1){var Ur=sr[Cr-1];if(!Fd(gr,Ur)){Kt.vertexLength+4>Be.MAX_VERTEX_ARRAY_LENGTH&&(Kt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Ar=gr.sub(Ur)._perp()._unit(),Dr=Ur.dist(gr);lr+Dr>32768&&(lr=0),of(this.layoutVertexArray,gr.x,gr.y,Ar.x,Ar.y,0,0,lr),of(this.layoutVertexArray,gr.x,gr.y,Ar.x,Ar.y,0,1,lr),of(this.layoutVertexArray,Ur.x,Ur.y,Ar.x,Ar.y,0,0,lr+=Dr),of(this.layoutVertexArray,Ur.x,Ur.y,Ar.x,Ar.y,0,1,lr);var mn=Kt.vertexLength;this.indexArray.emplaceBack(mn,mn+2,mn+1),this.indexArray.emplaceBack(mn+1,mn+2,mn+3),Kt.vertexLength+=4,Kt.primitiveLength+=2}}}}if(Kt.vertexLength+mt>Be.MAX_VERTEX_ARRAY_LENGTH&&(Kt=this.segments.prepareSegment(mt,this.layoutVertexArray,this.indexArray)),Od[f.type]==="Polygon"){for(var Fn=[],ni=[],ki=Kt.vertexLength,oa=0,Di=K;oa<Di.length;oa+=1){var ca=Di[oa];if(ca.length!==0){ca!==K[0]&&ni.push(Fn.length/2);for(var zi=0;zi<ca.length;zi++){var Oa=ca[zi];of(this.layoutVertexArray,Oa.x,Oa.y,0,0,1,1,0),Fn.push(Oa.x),Fn.push(Oa.y)}}}for(var xa=Lc(Fn,ni),Qi=0;Qi<xa.length;Qi+=3)this.indexArray.emplaceBack(ki+xa[Qi],ki+xa[Qi+2],ki+xa[Qi+1]);Kt.primitiveLength+=xa.length/3,Kt.vertexLength+=mt}}var lo;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},Zi("FillExtrusionBucket",sf,{omit:["layers","features"]});var t0={paint:new Ru({"fill-extrusion-opacity":new Ki(Pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wi(Pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ki(Pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ki(Pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Af(Pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wi(Pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wi(Pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ki(Pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},nc=function(f){function d(y){f.call(this,y,t0)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.createBucket=function(y){return new sf(y)},d.prototype.queryRadius=function(){return js(this.paint.get("fill-extrusion-translate"))},d.prototype.is3D=function(){return!0},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,K,mt,Ot){var Gt=$c(y,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),K.angle,mt),Kt=this.paint.get("fill-extrusion-height").evaluate(T,O),pe=this.paint.get("fill-extrusion-base").evaluate(T,O),Fe=function(lr,Cr,gr,Ur){for(var Ar=[],Dr=0,mn=lr;Dr<mn.length;Dr+=1){var Fn=mn[Dr],ni=[Fn.x,Fn.y,0,1];$f(ni,ni,Cr),Ar.push(new ht(ni[0]/ni[3],ni[1]/ni[3]))}return Ar}(Gt,Ot),sr=function(lr,Cr,gr,Ur){for(var Ar=[],Dr=[],mn=Ur[8]*Cr,Fn=Ur[9]*Cr,ni=Ur[10]*Cr,ki=Ur[11]*Cr,oa=Ur[8]*gr,Di=Ur[9]*gr,ca=Ur[10]*gr,zi=Ur[11]*gr,Oa=0,xa=lr;Oa<xa.length;Oa+=1){for(var Qi=[],lo=[],Ja=0,To=xa[Oa];Ja<To.length;Ja+=1){var ea=To[Ja],Zo=ea.x,Es=ea.y,uu=Ur[0]*Zo+Ur[4]*Es+Ur[12],Ws=Ur[1]*Zo+Ur[5]*Es+Ur[13],ks=Ur[2]*Zo+Ur[6]*Es+Ur[14],eu=Ur[3]*Zo+Ur[7]*Es+Ur[15],Qu=ks+ni,lu=eu+ki,Gl=uu+oa,us=Ws+Di,Hl=ks+ca,mu=eu+zi,cu=new ht((uu+mn)/lu,(Ws+Fn)/lu);cu.z=Qu/lu,Qi.push(cu);var ro=new ht(Gl/mu,us/mu);ro.z=Hl/mu,lo.push(ro)}Ar.push(Qi),Dr.push(lo)}return[Ar,Dr]}(N,pe,Kt,Ot);return function(lr,Cr,gr){var Ur=1/0;Kl(gr,Cr)&&(Ur=Ch(gr,Cr[0]));for(var Ar=0;Ar<Cr.length;Ar++)for(var Dr=Cr[Ar],mn=lr[Ar],Fn=0;Fn<Dr.length-1;Fn++){var ni=Dr[Fn],ki=[ni,Dr[Fn+1],mn[Fn+1],mn[Fn],ni];kc(gr,ki)&&(Ur=Math.min(Ur,Ch(gr,ki)))}return Ur!==1/0&&Ur}(sr[0],sr[1],Fe)},d}(bs);function Rd(f,d){return f.x*d.x+f.y*d.y}function Ch(f,d){if(f.length===1){for(var y,T=0,O=d[T++];!y||O.equals(y);)if(!(y=d[T++]))return 1/0;for(;T<d.length;T++){var N=d[T],Z=f[0],K=y.sub(O),mt=N.sub(O),Ot=Z.sub(O),Gt=Rd(K,K),Kt=Rd(K,mt),pe=Rd(mt,mt),Fe=Rd(Ot,K),sr=Rd(Ot,mt),lr=Gt*pe-Kt*Kt,Cr=(pe*Fe-Kt*sr)/lr,gr=(Gt*sr-Kt*Fe)/lr,Ur=O.z*(1-Cr-gr)+y.z*Cr+N.z*gr;if(isFinite(Ur))return Ur}return 1/0}for(var Ar=1/0,Dr=0,mn=d;Dr<mn.length;Dr+=1)Ar=Math.min(Ar,mn[Dr].z);return Ar}var Ah=os([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,e0=os([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,r0=rc.VectorTileFeature.types,lp=Math.cos(Math.PI/180*37.5),Dd=Math.pow(2,14)/.5,Ro=function(f){var d=this;this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(y){return y.id}),this.index=f.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(y){d.gradients[y.id]={}}),this.layoutVertexArray=new Fs,this.layoutVertexArray2=new Ms,this.indexArray=new Rs,this.programConfigurations=new da(f.layers,f.zoom),this.segments=new Be,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(y){return y.isStateDependent()}).map(function(y){return y.id})};Ro.prototype.populate=function(f,d,y){this.hasPattern=nf("line",this.layers,d);for(var T=this.layers[0].layout.get("line-sort-key"),O=[],N=0,Z=f;N<Z.length;N+=1){var K=Z[N],mt=K.feature,Ot=K.id,Gt=K.index,Kt=K.sourceLayerIndex,pe=this.layers[0]._featureFilter.needGeometry,Fe=cs(mt,pe);if(this.layers[0]._featureFilter.filter(new Ka(this.zoom),Fe,y)){var sr=T?T.evaluate(Fe,{},y):void 0,lr={id:Ot,properties:mt.properties,type:mt.type,sourceLayerIndex:Kt,index:Gt,geometry:pe?Fe.geometry:ls(mt),patterns:{},sortKey:sr};O.push(lr)}}T&&O.sort(function(ni,ki){return ni.sortKey-ki.sortKey});for(var Cr=0,gr=O;Cr<gr.length;Cr+=1){var Ur=gr[Cr],Ar=Ur.geometry,Dr=Ur.index,mn=Ur.sourceLayerIndex;if(this.hasPattern){var Fn=Hp("line",this.layers,Ur,this.zoom,d);this.patternFeatures.push(Fn)}else this.addFeature(Ur,Ar,Dr,y,{});d.featureIndex.insert(f[Dr].feature,Ar,Dr,mn,this.index)}},Ro.prototype.update=function(f,d,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(f,d,this.stateDependentLayers,y)},Ro.prototype.addFeatures=function(f,d,y){for(var T=0,O=this.patternFeatures;T<O.length;T+=1){var N=O[T];this.addFeature(N,N.geometry,N.index,d,y)}},Ro.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ro.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ro.prototype.upload=function(f){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=f.createVertexBuffer(this.layoutVertexArray2,e0)),this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Ah),this.indexBuffer=f.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(f),this.uploaded=!0},Ro.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ro.prototype.lineFeatureClips=function(f){if(f.properties&&f.properties.hasOwnProperty("mapbox_clip_start")&&f.properties.hasOwnProperty("mapbox_clip_end"))return{start:+f.properties.mapbox_clip_start,end:+f.properties.mapbox_clip_end}},Ro.prototype.addFeature=function(f,d,y,T,O){var N=this.layers[0].layout,Z=N.get("line-join").evaluate(f,{}),K=N.get("line-cap"),mt=N.get("line-miter-limit"),Ot=N.get("line-round-limit");this.lineClips=this.lineFeatureClips(f);for(var Gt=0,Kt=d;Gt<Kt.length;Gt+=1)this.addLine(Kt[Gt],f,Z,K,mt,Ot);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,f,y,O,T)},Ro.prototype.addLine=function(f,d,y,T,O,N){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var Z=0;Z<f.length-1;Z++)this.totalDistance+=f[Z].dist(f[Z+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var K=r0[d.type]==="Polygon",mt=f.length;mt>=2&&f[mt-1].equals(f[mt-2]);)mt--;for(var Ot=0;Ot<mt-1&&f[Ot].equals(f[Ot+1]);)Ot++;if(!(mt<(K?3:2))){y==="bevel"&&(O=1.05);var Gt,Kt=this.overscaling<=16?122880/(512*this.overscaling):0,pe=this.segments.prepareSegment(10*mt,this.layoutVertexArray,this.indexArray),Fe=void 0,sr=void 0,lr=void 0,Cr=void 0;this.e1=this.e2=-1,K&&(Cr=f[Ot].sub(Gt=f[mt-2])._unit()._perp());for(var gr=Ot;gr<mt;gr++)if(!(sr=gr===mt-1?K?f[Ot+1]:void 0:f[gr+1])||!f[gr].equals(sr)){Cr&&(lr=Cr),Gt&&(Fe=Gt),Gt=f[gr],Cr=sr?sr.sub(Gt)._unit()._perp():lr;var Ur=(lr=lr||Cr).add(Cr);Ur.x===0&&Ur.y===0||Ur._unit();var Ar=lr.x*Cr.x+lr.y*Cr.y,Dr=Ur.x*Cr.x+Ur.y*Cr.y,mn=Dr!==0?1/Dr:1/0,Fn=2*Math.sqrt(2-2*Dr),ni=Dr<lp&&Fe&&sr,ki=lr.x*Cr.y-lr.y*Cr.x>0;if(ni&&gr>Ot){var oa=Gt.dist(Fe);if(oa>2*Kt){var Di=Gt.sub(Gt.sub(Fe)._mult(Kt/oa)._round());this.updateDistance(Fe,Di),this.addCurrentVertex(Di,lr,0,0,pe),Fe=Di}}var ca=Fe&&sr,zi=ca?y:K?"butt":T;if(ca&&zi==="round"&&(mn<N?zi="miter":mn<=2&&(zi="fakeround")),zi==="miter"&&mn>O&&(zi="bevel"),zi==="bevel"&&(mn>2&&(zi="flipbevel"),mn<O&&(zi="miter")),Fe&&this.updateDistance(Fe,Gt),zi==="miter")Ur._mult(mn),this.addCurrentVertex(Gt,Ur,0,0,pe);else if(zi==="flipbevel"){if(mn>100)Ur=Cr.mult(-1);else{var Oa=mn*lr.add(Cr).mag()/lr.sub(Cr).mag();Ur._perp()._mult(Oa*(ki?-1:1))}this.addCurrentVertex(Gt,Ur,0,0,pe),this.addCurrentVertex(Gt,Ur.mult(-1),0,0,pe)}else if(zi==="bevel"||zi==="fakeround"){var xa=-Math.sqrt(mn*mn-1),Qi=ki?xa:0,lo=ki?0:xa;if(Fe&&this.addCurrentVertex(Gt,lr,Qi,lo,pe),zi==="fakeround")for(var Ja=Math.round(180*Fn/Math.PI/20),To=1;To<Ja;To++){var ea=To/Ja;if(ea!==.5){var Zo=ea-.5;ea+=ea*Zo*(ea-1)*((1.0904+Ar*(Ar*(3.55645-1.43519*Ar)-3.2452))*Zo*Zo+(.848013+Ar*(.215638*Ar-1.06021)))}var Es=Cr.sub(lr)._mult(ea)._add(lr)._unit()._mult(ki?-1:1);this.addHalfVertex(Gt,Es.x,Es.y,!1,ki,0,pe)}sr&&this.addCurrentVertex(Gt,Cr,-Qi,-lo,pe)}else if(zi==="butt")this.addCurrentVertex(Gt,Ur,0,0,pe);else if(zi==="square"){var uu=Fe?1:-1;this.addCurrentVertex(Gt,Ur,uu,uu,pe)}else zi==="round"&&(Fe&&(this.addCurrentVertex(Gt,lr,0,0,pe),this.addCurrentVertex(Gt,lr,1,1,pe,!0)),sr&&(this.addCurrentVertex(Gt,Cr,-1,-1,pe,!0),this.addCurrentVertex(Gt,Cr,0,0,pe)));if(ni&&gr<mt-1){var Ws=Gt.dist(sr);if(Ws>2*Kt){var ks=Gt.add(sr.sub(Gt)._mult(Kt/Ws)._round());this.updateDistance(Gt,ks),this.addCurrentVertex(ks,Cr,0,0,pe),Gt=ks}}}}},Ro.prototype.addCurrentVertex=function(f,d,y,T,O,N){N===void 0&&(N=!1);var Z=d.y*T-d.x,K=-d.y-d.x*T;this.addHalfVertex(f,d.x+d.y*y,d.y-d.x*y,N,!1,y,O),this.addHalfVertex(f,Z,K,N,!0,-T,O),this.distance>Dd/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(f,d,y,T,O,N))},Ro.prototype.addHalfVertex=function(f,d,y,T,O,N,Z){var K=.5*(this.lineClips?this.scaledDistance*(Dd-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((f.x<<1)+(T?1:0),(f.y<<1)+(O?1:0),Math.round(63*d)+128,Math.round(63*y)+128,1+(N===0?0:N<0?-1:1)|(63&K)<<2,K>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var mt=Z.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,mt),Z.primitiveLength++),O?this.e2=mt:this.e1=mt},Ro.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Ro.prototype.updateDistance=function(f,d){this.distance+=f.dist(d),this.updateScaledDistance()},Zi("LineBucket",Ro,{omit:["layers","patternFeatures"]});var kf=new Ru({"line-cap":new Ki(Pe.layout_line["line-cap"]),"line-join":new Wi(Pe.layout_line["line-join"]),"line-miter-limit":new Ki(Pe.layout_line["line-miter-limit"]),"line-round-limit":new Ki(Pe.layout_line["line-round-limit"]),"line-sort-key":new Wi(Pe.layout_line["line-sort-key"])}),co={paint:new Ru({"line-opacity":new Wi(Pe.paint_line["line-opacity"]),"line-color":new Wi(Pe.paint_line["line-color"]),"line-translate":new Ki(Pe.paint_line["line-translate"]),"line-translate-anchor":new Ki(Pe.paint_line["line-translate-anchor"]),"line-width":new Wi(Pe.paint_line["line-width"]),"line-gap-width":new Wi(Pe.paint_line["line-gap-width"]),"line-offset":new Wi(Pe.paint_line["line-offset"]),"line-blur":new Wi(Pe.paint_line["line-blur"]),"line-dasharray":new ol(Pe.paint_line["line-dasharray"]),"line-pattern":new Af(Pe.paint_line["line-pattern"]),"line-gradient":new sl(Pe.paint_line["line-gradient"])}),layout:kf},gu=new(function(f){function d(){f.apply(this,arguments)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.possiblyEvaluate=function(y,T){return T=new Ka(Math.floor(T.zoom),{now:T.now,fadeDuration:T.fadeDuration,zoomHistory:T.zoomHistory,transition:T.transition}),f.prototype.possiblyEvaluate.call(this,y,T)},d.prototype.evaluate=function(y,T,O,N){return T=b({},T,{zoom:Math.floor(T.zoom)}),f.prototype.evaluate.call(this,y,T,O,N)},d}(Wi))(co.paint.properties["line-width"].specification);gu.useIntegerZoom=!0;var W0=function(f){function d(y){f.call(this,y,co),this.gradientVersion=0}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype._handleSpecialPaintPropertyUpdate=function(y){y==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Fu,this.gradientVersion=(this.gradientVersion+1)%Ee)},d.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},d.prototype.recalculate=function(y,T){f.prototype.recalculate.call(this,y,T),this.paint._values["line-floorwidth"]=gu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,y)},d.prototype.createBucket=function(y){return new Ro(y)},d.prototype.queryRadius=function(y){var T=y,O=Xp(Jl("line-width",this,T),Jl("line-gap-width",this,T)),N=Jl("line-offset",this,T);return O/2+Math.abs(N)+js(this.paint.get("line-translate"))},d.prototype.queryIntersectsFeature=function(y,T,O,N,Z,K,mt){var Ot=$c(y,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),K.angle,mt),Gt=mt/2*Xp(this.paint.get("line-width").evaluate(T,O),this.paint.get("line-gap-width").evaluate(T,O)),Kt=this.paint.get("line-offset").evaluate(T,O);return Kt&&(N=function(pe,Fe){for(var sr=[],lr=new ht(0,0),Cr=0;Cr<pe.length;Cr++){for(var gr=pe[Cr],Ur=[],Ar=0;Ar<gr.length;Ar++){var Dr=gr[Ar],mn=gr[Ar+1],Fn=Ar===0?lr:Dr.sub(gr[Ar-1])._unit()._perp(),ni=Ar===gr.length-1?lr:mn.sub(Dr)._unit()._perp(),ki=Fn._add(ni)._unit();ki._mult(1/(ki.x*ni.x+ki.y*ni.y)),Ur.push(ki._mult(Fe)._add(Dr))}sr.push(Ur)}return sr}(N,Kt*mt)),function(pe,Fe,sr){for(var lr=0;lr<Fe.length;lr++){var Cr=Fe[lr];if(pe.length>=3){for(var gr=0;gr<Cr.length;gr++)if(dc(pe,Cr[gr]))return!0}if(cl(pe,Cr,sr))return!0}return!1}(Ot,N,Gt)},d.prototype.isTileClipped=function(){return!0},d}(bs);function Xp(f,d){return d>0?d+2*f:f}var Bd=os([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),X0=os([{name:"a_projected_pos",components:3,type:"Float32"}],4),Yp=(os([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),os([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),n0=(os([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),os([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),ic=os([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Th(f,d,y){return f.sections.forEach(function(T){T.text=function(O,N,Z){var K=N.layout.get("text-transform").evaluate(Z,{});return K==="uppercase"?O=O.toLocaleUpperCase():K==="lowercase"&&(O=O.toLocaleLowerCase()),Ko.applyArabicShaping&&(O=Ko.applyArabicShaping(O)),O}(T.text,d,y)}),f}os([{name:"triangle",components:3,type:"Uint16"}]),os([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),os([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),os([{type:"Float32",name:"offsetX"}]),os([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Nu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Ug=function(f,d,y,T,O){var N,Z,K=8*O-T-1,mt=(1<<K)-1,Ot=mt>>1,Gt=-7,Kt=y?O-1:0,pe=y?-1:1,Fe=f[d+Kt];for(Kt+=pe,N=Fe&(1<<-Gt)-1,Fe>>=-Gt,Gt+=K;Gt>0;N=256*N+f[d+Kt],Kt+=pe,Gt-=8);for(Z=N&(1<<-Gt)-1,N>>=-Gt,Gt+=T;Gt>0;Z=256*Z+f[d+Kt],Kt+=pe,Gt-=8);if(N===0)N=1-Ot;else{if(N===mt)return Z?NaN:1/0*(Fe?-1:1);Z+=Math.pow(2,T),N-=Ot}return(Fe?-1:1)*Z*Math.pow(2,N-T)},Jf=function(f,d,y,T,O,N){var Z,K,mt,Ot=8*N-O-1,Gt=(1<<Ot)-1,Kt=Gt>>1,pe=O===23?Math.pow(2,-24)-Math.pow(2,-77):0,Fe=T?0:N-1,sr=T?1:-1,lr=d<0||d===0&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(K=isNaN(d)?1:0,Z=Gt):(Z=Math.floor(Math.log(d)/Math.LN2),d*(mt=Math.pow(2,-Z))<1&&(Z--,mt*=2),(d+=Z+Kt>=1?pe/mt:pe*Math.pow(2,1-Kt))*mt>=2&&(Z++,mt/=2),Z+Kt>=Gt?(K=0,Z=Gt):Z+Kt>=1?(K=(d*mt-1)*Math.pow(2,O),Z+=Kt):(K=d*Math.pow(2,Kt-1)*Math.pow(2,O),Z=0));O>=8;f[y+Fe]=255&K,Fe+=sr,K/=256,O-=8);for(Z=Z<<O|K,Ot+=O;Ot>0;f[y+Fe]=255&Z,Fe+=sr,Z/=256,Ot-=8);f[y+Fe-sr]|=128*lr},th=Qo;function Qo(f){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(f)?f:new Uint8Array(f||0),this.pos=0,this.type=0,this.length=this.buf.length}Qo.Varint=0,Qo.Fixed64=1,Qo.Bytes=2,Qo.Fixed32=5;var $p=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function eh(f){return f.type===Qo.Bytes?f.readVarint()+f.pos:f.pos+1}function uf(f,d,y){return y?4294967296*d+(f>>>0):4294967296*(d>>>0)+(f>>>0)}function qp(f,d,y){var T=d<=16383?1:d<=2097151?2:d<=268435455?3:Math.floor(Math.log(d)/(7*Math.LN2));y.realloc(T);for(var O=y.pos-1;O>=f;O--)y.buf[O+T]=y.buf[O]}function Hm(f,d){for(var y=0;y<f.length;y++)d.writeVarint(f[y])}function kt(f,d){for(var y=0;y<f.length;y++)d.writeSVarint(f[y])}function Ze(f,d){for(var y=0;y<f.length;y++)d.writeFloat(f[y])}function dr(f,d){for(var y=0;y<f.length;y++)d.writeDouble(f[y])}function cn(f,d){for(var y=0;y<f.length;y++)d.writeBoolean(f[y])}function On(f,d){for(var y=0;y<f.length;y++)d.writeFixed32(f[y])}function on(f,d){for(var y=0;y<f.length;y++)d.writeSFixed32(f[y])}function En(f,d){for(var y=0;y<f.length;y++)d.writeFixed64(f[y])}function Dn(f,d){for(var y=0;y<f.length;y++)d.writeSFixed64(f[y])}function Hn(f,d){return(f[d]|f[d+1]<<8|f[d+2]<<16)+16777216*f[d+3]}function Jn(f,d,y){f[y]=d,f[y+1]=d>>>8,f[y+2]=d>>>16,f[y+3]=d>>>24}function ii(f,d){return(f[d]|f[d+1]<<8|f[d+2]<<16)+(f[d+3]<<24)}function ui(f,d,y){f===1&&y.readMessage(yi,d)}function yi(f,d,y){if(f===3){var T=y.readMessage(qn,{}),O=T.width,N=T.height,Z=T.left,K=T.top,mt=T.advance;d.push({id:T.id,bitmap:new kl({width:O+6,height:N+6},T.bitmap),metrics:{width:O,height:N,left:Z,top:K,advance:mt}})}}function qn(f,d,y){f===1?d.id=y.readVarint():f===2?d.bitmap=y.readBytes():f===3?d.width=y.readVarint():f===4?d.height=y.readVarint():f===5?d.left=y.readSVarint():f===6?d.top=y.readSVarint():f===7&&(d.advance=y.readVarint())}function ri(f){for(var d=0,y=0,T=0,O=f;T<O.length;T+=1){var N=O[T];d+=N.w*N.h,y=Math.max(y,N.w)}f.sort(function(lr,Cr){return Cr.h-lr.h});for(var Z=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(d/.95)),y),h:1/0}],K=0,mt=0,Ot=0,Gt=f;Ot<Gt.length;Ot+=1)for(var Kt=Gt[Ot],pe=Z.length-1;pe>=0;pe--){var Fe=Z[pe];if(!(Kt.w>Fe.w||Kt.h>Fe.h)){if(Kt.x=Fe.x,Kt.y=Fe.y,mt=Math.max(mt,Kt.y+Kt.h),K=Math.max(K,Kt.x+Kt.w),Kt.w===Fe.w&&Kt.h===Fe.h){var sr=Z.pop();pe<Z.length&&(Z[pe]=sr)}else Kt.h===Fe.h?(Fe.x+=Kt.w,Fe.w-=Kt.w):Kt.w===Fe.w?(Fe.y+=Kt.h,Fe.h-=Kt.h):(Z.push({x:Fe.x+Kt.w,y:Fe.y,w:Fe.w-Kt.w,h:Kt.h}),Fe.y+=Kt.h,Fe.h-=Kt.h);break}}return{w:K,h:mt,fill:d/(K*mt)||0}}Qo.prototype={destroy:function(){this.buf=null},readFields:function(f,d,y){for(y=y||this.length;this.pos<y;){var T=this.readVarint(),O=T>>3,N=this.pos;this.type=7&T,f(O,d,this),this.pos===N&&this.skip(T)}return d},readMessage:function(f,d){return this.readFields(f,d,this.readVarint()+this.pos)},readFixed32:function(){var f=Hn(this.buf,this.pos);return this.pos+=4,f},readSFixed32:function(){var f=ii(this.buf,this.pos);return this.pos+=4,f},readFixed64:function(){var f=Hn(this.buf,this.pos)+4294967296*Hn(this.buf,this.pos+4);return this.pos+=8,f},readSFixed64:function(){var f=Hn(this.buf,this.pos)+4294967296*ii(this.buf,this.pos+4);return this.pos+=8,f},readFloat:function(){var f=Ug(this.buf,this.pos,!0,23,4);return this.pos+=4,f},readDouble:function(){var f=Ug(this.buf,this.pos,!0,52,8);return this.pos+=8,f},readVarint:function(f){var d,y,T=this.buf;return d=127&(y=T[this.pos++]),y<128?d:(d|=(127&(y=T[this.pos++]))<<7,y<128?d:(d|=(127&(y=T[this.pos++]))<<14,y<128?d:(d|=(127&(y=T[this.pos++]))<<21,y<128?d:function(O,N,Z){var K,mt,Ot=Z.buf;if(K=(112&(mt=Ot[Z.pos++]))>>4,mt<128||(K|=(127&(mt=Ot[Z.pos++]))<<3,mt<128)||(K|=(127&(mt=Ot[Z.pos++]))<<10,mt<128)||(K|=(127&(mt=Ot[Z.pos++]))<<17,mt<128)||(K|=(127&(mt=Ot[Z.pos++]))<<24,mt<128)||(K|=(1&(mt=Ot[Z.pos++]))<<31,mt<128))return uf(O,K,N);throw new Error("Expected varint not more than 10 bytes")}(d|=(15&(y=T[this.pos]))<<28,f,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var f=this.readVarint();return f%2==1?(f+1)/-2:f/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var f=this.readVarint()+this.pos,d=this.pos;return this.pos=f,f-d>=12&&$p?function(y,T,O){return $p.decode(y.subarray(T,O))}(this.buf,d,f):function(y,T,O){for(var N="",Z=T;Z<O;){var K,mt,Ot,Gt=y[Z],Kt=null,pe=Gt>239?4:Gt>223?3:Gt>191?2:1;if(Z+pe>O)break;pe===1?Gt<128&&(Kt=Gt):pe===2?(192&(K=y[Z+1]))==128&&(Kt=(31&Gt)<<6|63&K)<=127&&(Kt=null):pe===3?(mt=y[Z+2],(192&(K=y[Z+1]))==128&&(192&mt)==128&&((Kt=(15&Gt)<<12|(63&K)<<6|63&mt)<=2047||Kt>=55296&&Kt<=57343)&&(Kt=null)):pe===4&&(mt=y[Z+2],Ot=y[Z+3],(192&(K=y[Z+1]))==128&&(192&mt)==128&&(192&Ot)==128&&((Kt=(15&Gt)<<18|(63&K)<<12|(63&mt)<<6|63&Ot)<=65535||Kt>=1114112)&&(Kt=null)),Kt===null?(Kt=65533,pe=1):Kt>65535&&(Kt-=65536,N+=String.fromCharCode(Kt>>>10&1023|55296),Kt=56320|1023&Kt),N+=String.fromCharCode(Kt),Z+=pe}return N}(this.buf,d,f)},readBytes:function(){var f=this.readVarint()+this.pos,d=this.buf.subarray(this.pos,f);return this.pos=f,d},readPackedVarint:function(f,d){if(this.type!==Qo.Bytes)return f.push(this.readVarint(d));var y=eh(this);for(f=f||[];this.pos<y;)f.push(this.readVarint(d));return f},readPackedSVarint:function(f){if(this.type!==Qo.Bytes)return f.push(this.readSVarint());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readSVarint());return f},readPackedBoolean:function(f){if(this.type!==Qo.Bytes)return f.push(this.readBoolean());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readBoolean());return f},readPackedFloat:function(f){if(this.type!==Qo.Bytes)return f.push(this.readFloat());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readFloat());return f},readPackedDouble:function(f){if(this.type!==Qo.Bytes)return f.push(this.readDouble());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readDouble());return f},readPackedFixed32:function(f){if(this.type!==Qo.Bytes)return f.push(this.readFixed32());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readFixed32());return f},readPackedSFixed32:function(f){if(this.type!==Qo.Bytes)return f.push(this.readSFixed32());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readSFixed32());return f},readPackedFixed64:function(f){if(this.type!==Qo.Bytes)return f.push(this.readFixed64());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readFixed64());return f},readPackedSFixed64:function(f){if(this.type!==Qo.Bytes)return f.push(this.readSFixed64());var d=eh(this);for(f=f||[];this.pos<d;)f.push(this.readSFixed64());return f},skip:function(f){var d=7&f;if(d===Qo.Varint)for(;this.buf[this.pos++]>127;);else if(d===Qo.Bytes)this.pos=this.readVarint()+this.pos;else if(d===Qo.Fixed32)this.pos+=4;else{if(d!==Qo.Fixed64)throw new Error("Unimplemented type: "+d);this.pos+=8}},writeTag:function(f,d){this.writeVarint(f<<3|d)},realloc:function(f){for(var d=this.length||16;d<this.pos+f;)d*=2;if(d!==this.length){var y=new Uint8Array(d);y.set(this.buf),this.buf=y,this.length=d}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(f){this.realloc(4),Jn(this.buf,f,this.pos),this.pos+=4},writeSFixed32:function(f){this.realloc(4),Jn(this.buf,f,this.pos),this.pos+=4},writeFixed64:function(f){this.realloc(8),Jn(this.buf,-1&f,this.pos),Jn(this.buf,Math.floor(f*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(f){this.realloc(8),Jn(this.buf,-1&f,this.pos),Jn(this.buf,Math.floor(f*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(f){(f=+f||0)>268435455||f<0?function(d,y){var T,O;if(d>=0?(T=d%4294967296|0,O=d/4294967296|0):(O=~(-d/4294967296),4294967295^(T=~(-d%4294967296))?T=T+1|0:(T=0,O=O+1|0)),d>=18446744073709552e3||d<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");y.realloc(10),function(N,Z,K){K.buf[K.pos++]=127&N|128,N>>>=7,K.buf[K.pos++]=127&N|128,N>>>=7,K.buf[K.pos++]=127&N|128,N>>>=7,K.buf[K.pos++]=127&N|128,K.buf[K.pos]=127&(N>>>=7)}(T,0,y),function(N,Z){var K=(7&N)<<4;Z.buf[Z.pos++]|=K|((N>>>=3)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N|((N>>>=7)?128:0),N&&(Z.buf[Z.pos++]=127&N)))))}(O,y)}(f,this):(this.realloc(4),this.buf[this.pos++]=127&f|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=127&(f>>>=7)|(f>127?128:0),f<=127||(this.buf[this.pos++]=f>>>7&127))))},writeSVarint:function(f){this.writeVarint(f<0?2*-f-1:2*f)},writeBoolean:function(f){this.writeVarint(Boolean(f))},writeString:function(f){f=String(f),this.realloc(4*f.length),this.pos++;var d=this.pos;this.pos=function(T,O,N){for(var Z,K,mt=0;mt<O.length;mt++){if((Z=O.charCodeAt(mt))>55295&&Z<57344){if(!K){Z>56319||mt+1===O.length?(T[N++]=239,T[N++]=191,T[N++]=189):K=Z;continue}if(Z<56320){T[N++]=239,T[N++]=191,T[N++]=189,K=Z;continue}Z=K-55296<<10|Z-56320|65536,K=null}else K&&(T[N++]=239,T[N++]=191,T[N++]=189,K=null);Z<128?T[N++]=Z:(Z<2048?T[N++]=Z>>6|192:(Z<65536?T[N++]=Z>>12|224:(T[N++]=Z>>18|240,T[N++]=Z>>12&63|128),T[N++]=Z>>6&63|128),T[N++]=63&Z|128)}return N}(this.buf,f,this.pos);var y=this.pos-d;y>=128&&qp(d,y,this),this.pos=d-1,this.writeVarint(y),this.pos+=y},writeFloat:function(f){this.realloc(4),Jf(this.buf,f,this.pos,!0,23,4),this.pos+=4},writeDouble:function(f){this.realloc(8),Jf(this.buf,f,this.pos,!0,52,8),this.pos+=8},writeBytes:function(f){var d=f.length;this.writeVarint(d),this.realloc(d);for(var y=0;y<d;y++)this.buf[this.pos++]=f[y]},writeRawMessage:function(f,d){this.pos++;var y=this.pos;f(d,this);var T=this.pos-y;T>=128&&qp(y,T,this),this.pos=y-1,this.writeVarint(T),this.pos+=T},writeMessage:function(f,d,y){this.writeTag(f,Qo.Bytes),this.writeRawMessage(d,y)},writePackedVarint:function(f,d){d.length&&this.writeMessage(f,Hm,d)},writePackedSVarint:function(f,d){d.length&&this.writeMessage(f,kt,d)},writePackedBoolean:function(f,d){d.length&&this.writeMessage(f,cn,d)},writePackedFloat:function(f,d){d.length&&this.writeMessage(f,Ze,d)},writePackedDouble:function(f,d){d.length&&this.writeMessage(f,dr,d)},writePackedFixed32:function(f,d){d.length&&this.writeMessage(f,On,d)},writePackedSFixed32:function(f,d){d.length&&this.writeMessage(f,on,d)},writePackedFixed64:function(f,d){d.length&&this.writeMessage(f,En,d)},writePackedSFixed64:function(f,d){d.length&&this.writeMessage(f,Dn,d)},writeBytesField:function(f,d){this.writeTag(f,Qo.Bytes),this.writeBytes(d)},writeFixed32Field:function(f,d){this.writeTag(f,Qo.Fixed32),this.writeFixed32(d)},writeSFixed32Field:function(f,d){this.writeTag(f,Qo.Fixed32),this.writeSFixed32(d)},writeFixed64Field:function(f,d){this.writeTag(f,Qo.Fixed64),this.writeFixed64(d)},writeSFixed64Field:function(f,d){this.writeTag(f,Qo.Fixed64),this.writeSFixed64(d)},writeVarintField:function(f,d){this.writeTag(f,Qo.Varint),this.writeVarint(d)},writeSVarintField:function(f,d){this.writeTag(f,Qo.Varint),this.writeSVarint(d)},writeStringField:function(f,d){this.writeTag(f,Qo.Bytes),this.writeString(d)},writeFloatField:function(f,d){this.writeTag(f,Qo.Fixed32),this.writeFloat(d)},writeDoubleField:function(f,d){this.writeTag(f,Qo.Fixed64),this.writeDouble(d)},writeBooleanField:function(f,d){this.writeVarintField(f,Boolean(d))}};var Gr=function(f,d){var y=d.pixelRatio,T=d.version,O=d.stretchX,N=d.stretchY,Z=d.content;this.paddedRect=f,this.pixelRatio=y,this.stretchX=O,this.stretchY=N,this.content=Z,this.version=T},dn={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};dn.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},dn.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},dn.tlbr.get=function(){return this.tl.concat(this.br)},dn.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Gr.prototype,dn);var Xn=function(f,d){var y={},T={};this.haveRenderCallbacks=[];var O=[];this.addImages(f,y,O),this.addImages(d,T,O);var N=ri(O),Z=new Cu({width:N.w||1,height:N.h||1});for(var K in f){var mt=f[K],Ot=y[K].paddedRect;Cu.copy(mt.data,Z,{x:0,y:0},{x:Ot.x+1,y:Ot.y+1},mt.data)}for(var Gt in d){var Kt=d[Gt],pe=T[Gt].paddedRect,Fe=pe.x+1,sr=pe.y+1,lr=Kt.data.width,Cr=Kt.data.height;Cu.copy(Kt.data,Z,{x:0,y:0},{x:Fe,y:sr},Kt.data),Cu.copy(Kt.data,Z,{x:0,y:Cr-1},{x:Fe,y:sr-1},{width:lr,height:1}),Cu.copy(Kt.data,Z,{x:0,y:0},{x:Fe,y:sr+Cr},{width:lr,height:1}),Cu.copy(Kt.data,Z,{x:lr-1,y:0},{x:Fe-1,y:sr},{width:1,height:Cr}),Cu.copy(Kt.data,Z,{x:0,y:0},{x:Fe+lr,y:sr},{width:1,height:Cr})}this.image=Z,this.iconPositions=y,this.patternPositions=T};Xn.prototype.addImages=function(f,d,y){for(var T in f){var O=f[T],N={x:0,y:0,w:O.data.width+2,h:O.data.height+2};y.push(N),d[T]=new Gr(N,O),O.hasRenderCallback&&this.haveRenderCallbacks.push(T)}},Xn.prototype.patchUpdatedImages=function(f,d){for(var y in f.dispatchRenderCallbacks(this.haveRenderCallbacks),f.updatedImages)this.patchUpdatedImage(this.iconPositions[y],f.getImage(y),d),this.patchUpdatedImage(this.patternPositions[y],f.getImage(y),d)},Xn.prototype.patchUpdatedImage=function(f,d,y){if(f&&d&&f.version!==d.version){f.version=d.version;var T=f.tl;y.update(d.data,void 0,{x:T[0],y:T[1]})}},Zi("ImagePosition",Gr),Zi("ImageAtlas",Xn);var vi={horizontal:1,vertical:2,horizontalOnly:3},Rn=function(){this.scale=1,this.fontStack="",this.imageName=null};Rn.forText=function(f,d){var y=new Rn;return y.scale=f||1,y.fontStack=d,y},Rn.forImage=function(f){var d=new Rn;return d.imageName=f,d};var Qn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ti(f,d,y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr){var Cr,gr=Qn.fromFeature(f,O);Kt===vi.vertical&&gr.verticalizePunctuation();var Ur=Ko.processBidirectionalText,Ar=Ko.processStyledBidirectionalText;if(Ur&&gr.sections.length===1){Cr=[];for(var Dr=0,mn=Ur(gr.toString(),xi(gr,Ot,N,d,T,Fe,sr));Dr<mn.length;Dr+=1){var Fn=mn[Dr],ni=new Qn;ni.text=Fn,ni.sections=gr.sections;for(var ki=0;ki<Fn.length;ki++)ni.sectionIndex.push(0);Cr.push(ni)}}else if(Ar){Cr=[];for(var oa=0,Di=Ar(gr.text,gr.sectionIndex,xi(gr,Ot,N,d,T,Fe,sr));oa<Di.length;oa+=1){var ca=Di[oa],zi=new Qn;zi.text=ca[0],zi.sectionIndex=ca[1],zi.sections=gr.sections,Cr.push(zi)}}else Cr=function(Qi,lo){for(var Ja=[],To=Qi.text,ea=0,Zo=0,Es=lo;Zo<Es.length;Zo+=1){var uu=Es[Zo];Ja.push(Qi.substring(ea,uu)),ea=uu}return ea<To.length&&Ja.push(Qi.substring(ea,To.length)),Ja}(gr,xi(gr,Ot,N,d,T,Fe,sr));var Oa=[],xa={positionedLines:Oa,text:gr.toString(),top:Gt[1],bottom:Gt[1],left:Gt[0],right:Gt[0],writingMode:Kt,iconsInText:!1,verticalizable:!1};return function(Qi,lo,Ja,To,ea,Zo,Es,uu,Ws,ks,eu,Qu){for(var lu=0,Gl=-17,us=0,Hl=0,mu=uu==="right"?1:uu==="left"?0:.5,cu=0,ro=0,va=ea;ro<va.length;ro+=1){var ts=va[ro];ts.trim();var Do=ts.getMaxScale(),jl=24*(Do-1),Uu={positionedGlyphs:[],lineOffset:0};Qi.positionedLines[cu]=Uu;var ws=Uu.positionedGlyphs,Pu=0;if(ts.length()){for(var fu=0;fu<ts.length();fu++){var Oo=ts.getSection(fu),cf=ts.getSectionIndex(fu),ff=ts.getCharCode(fu),nh=0,ru=null,kh=null,fl=null,Qp=24,Pl=!(Ws===vi.horizontal||!eu&&!Cc(ff)||eu&&(aa[ff]||(yc=ff,Ai.Arabic(yc)||Ai["Arabic Supplement"](yc)||Ai["Arabic Extended-A"](yc)||Ai["Arabic Presentation Forms-A"](yc)||Ai["Arabic Presentation Forms-B"](yc))));if(Oo.imageName){var Lf=To[Oo.imageName];if(!Lf)continue;fl=Oo.imageName,Qi.iconsInText=Qi.iconsInText||!0,kh=Lf.paddedRect;var ih=Lf.displaySize;Oo.scale=24*Oo.scale/Qu,nh=jl+(24-ih[1]*Oo.scale),Qp=(ru={width:ih[0],height:ih[1],left:1,top:-3,advance:Pl?ih[1]:ih[0]}).advance;var Nd=Pl?ih[0]*Oo.scale-24*Do:ih[1]*Oo.scale-24*Do;Nd>0&&Nd>Pu&&(Pu=Nd)}else{var a0=Ja[Oo.fontStack],fp=a0&&a0[ff];if(fp&&fp.rect)kh=fp.rect,ru=fp.metrics;else{var yv=lo[Oo.fontStack],zd=yv&&yv[ff];if(!zd)continue;ru=zd.metrics}nh=24*(Do-Oo.scale)}Pl?(Qi.verticalizable=!0,ws.push({glyph:ff,imageName:fl,x:lu,y:Gl+nh,vertical:Pl,scale:Oo.scale,fontStack:Oo.fontStack,sectionIndex:cf,metrics:ru,rect:kh}),lu+=Qp*Oo.scale+ks):(ws.push({glyph:ff,imageName:fl,x:lu,y:Gl+nh,vertical:Pl,scale:Oo.scale,fontStack:Oo.fontStack,sectionIndex:cf,metrics:ru,rect:kh}),lu+=ru.advance*Oo.scale+ks)}ws.length!==0&&(us=Math.max(lu-ks,us),Ua(ws,0,ws.length-1,mu,Pu)),lu=0;var _v=Zo*Do+Pu;Uu.lineOffset=Math.max(Pu,jl),Gl+=_v,Hl=Math.max(_v,Hl),++cu}else Gl+=Zo,++cu}var yc,hp=Gl- -17,Zu=Mi(Es),pp=Zu.horizontalAlign,Jp=Zu.verticalAlign;(function(Ud,Zd,xv,bv,Ev,wv,td,Sv,o0){var Us,Jt=(Zd-xv)*Ev;Us=wv!==td?-Sv*bv- -17:(-bv*o0+.5)*td;for(var dp=0,Cv=Ud;dp<Cv.length;dp+=1)for(var vp=0,Av=Cv[dp].positionedGlyphs;vp<Av.length;vp+=1){var gp=Av[vp];gp.x+=Jt,gp.y+=Us}})(Qi.positionedLines,mu,pp,Jp,us,Hl,Zo,hp,ea.length),Qi.top+=-Jp*hp,Qi.bottom=Qi.top+hp,Qi.left+=-pp*us,Qi.right=Qi.left+us}(xa,d,y,T,Cr,Z,K,mt,Kt,Ot,pe,lr),!function(Qi){for(var lo=0,Ja=Qi;lo<Ja.length;lo+=1)if(Ja[lo].positionedGlyphs.length!==0)return!1;return!0}(Oa)&&xa}Qn.fromFeature=function(f,d){for(var y=new Qn,T=0;T<f.sections.length;T++){var O=f.sections[T];O.image?y.addImageSection(O):y.addTextSection(O,d)}return y},Qn.prototype.length=function(){return this.text.length},Qn.prototype.getSection=function(f){return this.sections[this.sectionIndex[f]]},Qn.prototype.getSectionIndex=function(f){return this.sectionIndex[f]},Qn.prototype.getCharCode=function(f){return this.text.charCodeAt(f)},Qn.prototype.verticalizePunctuation=function(){this.text=function(f){for(var d="",y=0;y<f.length;y++){var T=f.charCodeAt(y+1)||null,O=f.charCodeAt(y-1)||null;d+=T&&Cf(T)&&!Nu[f[y+1]]||O&&Cf(O)&&!Nu[f[y-1]]||!Nu[f[y]]?f[y]:Nu[f[y]]}return d}(this.text)},Qn.prototype.trim=function(){for(var f=0,d=0;d<this.text.length&&aa[this.text.charCodeAt(d)];d++)f++;for(var y=this.text.length,T=this.text.length-1;T>=0&&T>=f&&aa[this.text.charCodeAt(T)];T--)y--;this.text=this.text.substring(f,y),this.sectionIndex=this.sectionIndex.slice(f,y)},Qn.prototype.substring=function(f,d){var y=new Qn;return y.text=this.text.substring(f,d),y.sectionIndex=this.sectionIndex.slice(f,d),y.sections=this.sections,y},Qn.prototype.toString=function(){return this.text},Qn.prototype.getMaxScale=function(){var f=this;return this.sectionIndex.reduce(function(d,y){return Math.max(d,f.sections[y].scale)},0)},Qn.prototype.addTextSection=function(f,d){this.text+=f.text,this.sections.push(Rn.forText(f.scale,f.fontStack||d));for(var y=this.sections.length-1,T=0;T<f.text.length;++T)this.sectionIndex.push(y)},Qn.prototype.addImageSection=function(f){var d=f.image?f.image.name:"";if(d.length!==0){var y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCharCode(y),this.sections.push(Rn.forImage(d)),this.sectionIndex.push(this.sections.length-1)):ee("Reached maximum number of images 6401")}else ee("Can't add FormattedSection with an empty image.")},Qn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var aa={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},_n={};function An(f,d,y,T,O,N){if(d.imageName){var Z=T[d.imageName];return Z?Z.displaySize[0]*d.scale*24/N+O:0}var K=y[d.fontStack],mt=K&&K[f];return mt?mt.metrics.advance*d.scale+O:0}function oi(f,d,y,T){var O=Math.pow(f-d,2);return T?f<d?O/2:2*O:O+Math.abs(y)*y}function Ei(f,d,y){var T=0;return f===10&&(T-=1e4),y&&(T+=150),f!==40&&f!==65288||(T+=50),d!==41&&d!==65289||(T+=50),T}function ti(f,d,y,T,O,N){for(var Z=null,K=oi(d,y,O,N),mt=0,Ot=T;mt<Ot.length;mt+=1){var Gt=Ot[mt],Kt=oi(d-Gt.x,y,O,N)+Gt.badness;Kt<=K&&(Z=Gt,K=Kt)}return{index:f,x:d,priorBreak:Z,badness:K}}function xi(f,d,y,T,O,N,Z){if(N!=="point")return[];if(!f)return[];for(var K,mt=[],Ot=function(Cr,gr,Ur,Ar,Dr,mn){for(var Fn=0,ni=0;ni<Cr.length();ni++){var ki=Cr.getSection(ni);Fn+=An(Cr.getCharCode(ni),ki,Ar,Dr,gr,mn)}return Fn/Math.max(1,Math.ceil(Fn/Ur))}(f,d,y,T,O,Z),Gt=f.text.indexOf("\u200B")>=0,Kt=0,pe=0;pe<f.length();pe++){var Fe=f.getSection(pe),sr=f.getCharCode(pe);if(aa[sr]||(Kt+=An(sr,Fe,T,O,d,Z)),pe<f.length()-1){var lr=!((K=sr)<11904||!(Ai["Bopomofo Extended"](K)||Ai.Bopomofo(K)||Ai["CJK Compatibility Forms"](K)||Ai["CJK Compatibility Ideographs"](K)||Ai["CJK Compatibility"](K)||Ai["CJK Radicals Supplement"](K)||Ai["CJK Strokes"](K)||Ai["CJK Symbols and Punctuation"](K)||Ai["CJK Unified Ideographs Extension A"](K)||Ai["CJK Unified Ideographs"](K)||Ai["Enclosed CJK Letters and Months"](K)||Ai["Halfwidth and Fullwidth Forms"](K)||Ai.Hiragana(K)||Ai["Ideographic Description Characters"](K)||Ai["Kangxi Radicals"](K)||Ai["Katakana Phonetic Extensions"](K)||Ai.Katakana(K)||Ai["Vertical Forms"](K)||Ai["Yi Radicals"](K)||Ai["Yi Syllables"](K)));(_n[sr]||lr||Fe.imageName)&&mt.push(ti(pe+1,Kt,Ot,mt,Ei(sr,f.getCharCode(pe+1),lr&&Gt),!1))}}return function Cr(gr){return gr?Cr(gr.priorBreak).concat(gr.index):[]}(ti(f.length(),Kt,Ot,mt,0,!0))}function Mi(f){var d=.5,y=.5;switch(f){case"right":case"top-right":case"bottom-right":d=1;break;case"left":case"top-left":case"bottom-left":d=0}switch(f){case"bottom":case"bottom-right":case"bottom-left":y=1;break;case"top":case"top-right":case"top-left":y=0}return{horizontalAlign:d,verticalAlign:y}}function Ua(f,d,y,T,O){if(T||O)for(var N=f[y],Z=(f[y].x+N.metrics.advance*N.scale)*T,K=d;K<=y;K++)f[K].x-=Z,f[K].y+=O}function Yn(f,d,y,T,O,N){var Z,K=f.image;if(K.content){var mt=K.content,Ot=K.pixelRatio||1;Z=[mt[0]/Ot,mt[1]/Ot,K.displaySize[0]-mt[2]/Ot,K.displaySize[1]-mt[3]/Ot]}var Gt,Kt,pe,Fe,sr=d.left*N,lr=d.right*N;y==="width"||y==="both"?(Fe=O[0]+sr-T[3],Kt=O[0]+lr+T[1]):Kt=(Fe=O[0]+(sr+lr-K.displaySize[0])/2)+K.displaySize[0];var Cr=d.top*N,gr=d.bottom*N;return y==="height"||y==="both"?(Gt=O[1]+Cr-T[0],pe=O[1]+gr+T[2]):pe=(Gt=O[1]+(Cr+gr-K.displaySize[1])/2)+K.displaySize[1],{image:K,top:Gt,right:Kt,bottom:pe,left:Fe,collisionPadding:Z}}_n[10]=!0,_n[32]=!0,_n[38]=!0,_n[40]=!0,_n[41]=!0,_n[43]=!0,_n[45]=!0,_n[47]=!0,_n[173]=!0,_n[183]=!0,_n[8203]=!0,_n[8208]=!0,_n[8211]=!0,_n[8231]=!0;var Ii=function(f){function d(y,T,O,N){f.call(this,y,T),this.angle=O,N!==void 0&&(this.segment=N)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.clone=function(){return new d(this.x,this.y,this.angle,this.segment)},d}(ht);function Li(f,d){var y=d.expression;if(y.kind==="constant")return{kind:"constant",layoutSize:y.evaluate(new Ka(f+1))};if(y.kind==="source")return{kind:"source"};for(var T=y.zoomStops,O=y.interpolationType,N=0;N<T.length&&T[N]<=f;)N++;for(var Z=N=Math.max(0,N-1);Z<T.length&&T[Z]<f+1;)Z++;Z=Math.min(T.length-1,Z);var K=T[N],mt=T[Z];return y.kind==="composite"?{kind:"composite",minZoom:K,maxZoom:mt,interpolationType:O}:{kind:"camera",minZoom:K,maxZoom:mt,minSize:y.evaluate(new Ka(K)),maxSize:y.evaluate(new Ka(mt)),interpolationType:O}}function wa(f,d,y){var T=d.uSize,O=y.lowerSize;return f.kind==="source"?O/128:f.kind==="composite"?Fo(O/128,y.upperSize/128,d.uSizeT):T}function Da(f,d){var y=0,T=0;if(f.kind==="constant")T=f.layoutSize;else if(f.kind!=="source"){var O=f.interpolationType,N=O?Zt(Ve.interpolationFactor(O,d,f.minZoom,f.maxZoom),0,1):0;f.kind==="camera"?T=Fo(f.minSize,f.maxSize,N):y=N}return{uSizeT:y,uSize:T}}Zi("Anchor",Ii);var oo=Object.freeze({__proto__:null,getSizeData:Li,evaluateSizeForFeature:wa,evaluateSizeForZoom:Da,SIZE_PACK_FACTOR:128});function Is(f,d,y,T,O){if(d.segment===void 0)return!0;for(var N=d,Z=d.segment+1,K=0;K>-y/2;){if(--Z<0)return!1;K-=f[Z].dist(N),N=f[Z]}K+=f[Z].dist(f[Z+1]),Z++;for(var mt=[],Ot=0;K<y/2;){var Gt=f[Z],Kt=f[Z+1];if(!Kt)return!1;var pe=f[Z-1].angleTo(Gt)-Gt.angleTo(Kt);for(pe=Math.abs((pe+3*Math.PI)%(2*Math.PI)-Math.PI),mt.push({distance:K,angleDelta:pe}),Ot+=pe;K-mt[0].distance>T;)Ot-=mt.shift().angleDelta;if(Ot>O)return!1;Z++,K+=Gt.dist(Kt)}return!0}function zs(f){for(var d=0,y=0;y<f.length-1;y++)d+=f[y].dist(f[y+1]);return d}function io(f,d,y){return f?.6*d*y:0}function Au(f,d){return Math.max(f?f.right-f.left:0,d?d.right-d.left:0)}function Xo(f,d,y,T,O,N){for(var Z=io(y,O,N),K=Au(y,T)*N,mt=0,Ot=zs(f)/2,Gt=0;Gt<f.length-1;Gt++){var Kt=f[Gt],pe=f[Gt+1],Fe=Kt.dist(pe);if(mt+Fe>Ot){var sr=(Ot-mt)/Fe,lr=Fo(Kt.x,pe.x,sr),Cr=Fo(Kt.y,pe.y,sr),gr=new Ii(lr,Cr,pe.angleTo(Kt),Gt);return gr._round(),!Z||Is(f,gr,K,Z,d)?gr:void 0}mt+=Fe}}function Qs(f,d,y,T,O,N,Z,K,mt){var Ot=io(T,N,Z),Gt=Au(T,O),Kt=Gt*Z,pe=f[0].x===0||f[0].x===mt||f[0].y===0||f[0].y===mt;return d-Kt<d/4&&(d=Kt+d/4),function Fe(sr,lr,Cr,gr,Ur,Ar,Dr,mn,Fn){for(var ni=Ar/2,ki=zs(sr),oa=0,Di=lr-Cr,ca=[],zi=0;zi<sr.length-1;zi++){for(var Oa=sr[zi],xa=sr[zi+1],Qi=Oa.dist(xa),lo=xa.angleTo(Oa);Di+Cr<oa+Qi;){var Ja=((Di+=Cr)-oa)/Qi,To=Fo(Oa.x,xa.x,Ja),ea=Fo(Oa.y,xa.y,Ja);if(To>=0&&To<Fn&&ea>=0&&ea<Fn&&Di-ni>=0&&Di+ni<=ki){var Zo=new Ii(To,ea,lo,zi);Zo._round(),gr&&!Is(sr,Zo,Ar,gr,Ur)||ca.push(Zo)}}oa+=Qi}return mn||ca.length||Dr||(ca=Fe(sr,oa/2,Cr,gr,Ur,Ar,Dr,!0,Fn)),ca}(f,pe?d/2*K%d:(Gt/2+2*N)*Z*K%d,d,Ot,y,Kt,pe,!1,mt)}function su(f,d,y,T,O){for(var N=[],Z=0;Z<f.length;Z++)for(var K=f[Z],mt=void 0,Ot=0;Ot<K.length-1;Ot++){var Gt=K[Ot],Kt=K[Ot+1];Gt.x<d&&Kt.x<d||(Gt.x<d?Gt=new ht(d,Gt.y+(d-Gt.x)/(Kt.x-Gt.x)*(Kt.y-Gt.y))._round():Kt.x<d&&(Kt=new ht(d,Gt.y+(d-Gt.x)/(Kt.x-Gt.x)*(Kt.y-Gt.y))._round()),Gt.y<y&&Kt.y<y||(Gt.y<y?Gt=new ht(Gt.x+(y-Gt.y)/(Kt.y-Gt.y)*(Kt.x-Gt.x),y)._round():Kt.y<y&&(Kt=new ht(Gt.x+(y-Gt.y)/(Kt.y-Gt.y)*(Kt.x-Gt.x),y)._round()),Gt.x>=T&&Kt.x>=T||(Gt.x>=T?Gt=new ht(T,Gt.y+(T-Gt.x)/(Kt.x-Gt.x)*(Kt.y-Gt.y))._round():Kt.x>=T&&(Kt=new ht(T,Gt.y+(T-Gt.x)/(Kt.x-Gt.x)*(Kt.y-Gt.y))._round()),Gt.y>=O&&Kt.y>=O||(Gt.y>=O?Gt=new ht(Gt.x+(O-Gt.y)/(Kt.y-Gt.y)*(Kt.x-Gt.x),O)._round():Kt.y>=O&&(Kt=new ht(Gt.x+(O-Gt.y)/(Kt.y-Gt.y)*(Kt.x-Gt.x),O)._round()),mt&&Gt.equals(mt[mt.length-1])||N.push(mt=[Gt]),mt.push(Kt)))))}return N}function Tu(f,d,y,T){var O=[],N=f.image,Z=N.pixelRatio,K=N.paddedRect.w-2,mt=N.paddedRect.h-2,Ot=f.right-f.left,Gt=f.bottom-f.top,Kt=N.stretchX||[[0,K]],pe=N.stretchY||[[0,mt]],Fe=function(To,ea){return To+ea[1]-ea[0]},sr=Kt.reduce(Fe,0),lr=pe.reduce(Fe,0),Cr=K-sr,gr=mt-lr,Ur=0,Ar=sr,Dr=0,mn=lr,Fn=0,ni=Cr,ki=0,oa=gr;if(N.content&&T){var Di=N.content;Ur=Js(Kt,0,Di[0]),Dr=Js(pe,0,Di[1]),Ar=Js(Kt,Di[0],Di[2]),mn=Js(pe,Di[1],Di[3]),Fn=Di[0]-Ur,ki=Di[1]-Dr,ni=Di[2]-Di[0]-Ar,oa=Di[3]-Di[1]-mn}var ca=function(To,ea,Zo,Es){var uu=Jo(To.stretch-Ur,Ar,Ot,f.left),Ws=La(To.fixed-Fn,ni,To.stretch,sr),ks=Jo(ea.stretch-Dr,mn,Gt,f.top),eu=La(ea.fixed-ki,oa,ea.stretch,lr),Qu=Jo(Zo.stretch-Ur,Ar,Ot,f.left),lu=La(Zo.fixed-Fn,ni,Zo.stretch,sr),Gl=Jo(Es.stretch-Dr,mn,Gt,f.top),us=La(Es.fixed-ki,oa,Es.stretch,lr),Hl=new ht(uu,ks),mu=new ht(Qu,ks),cu=new ht(Qu,Gl),ro=new ht(uu,Gl),va=new ht(Ws/Z,eu/Z),ts=new ht(lu/Z,us/Z),Do=d*Math.PI/180;if(Do){var jl=Math.sin(Do),Uu=Math.cos(Do),ws=[Uu,-jl,jl,Uu];Hl._matMult(ws),mu._matMult(ws),ro._matMult(ws),cu._matMult(ws)}var Pu=To.stretch+To.fixed,fu=ea.stretch+ea.fixed;return{tl:Hl,tr:mu,bl:ro,br:cu,tex:{x:N.paddedRect.x+1+Pu,y:N.paddedRect.y+1+fu,w:Zo.stretch+Zo.fixed-Pu,h:Es.stretch+Es.fixed-fu},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:va,pixelOffsetBR:ts,minFontScaleX:ni/Z/Ot,minFontScaleY:oa/Z/Gt,isSDF:y}};if(T&&(N.stretchX||N.stretchY))for(var zi=zu(Kt,Cr,sr),Oa=zu(pe,gr,lr),xa=0;xa<zi.length-1;xa++)for(var Qi=zi[xa],lo=zi[xa+1],Ja=0;Ja<Oa.length-1;Ja++)O.push(ca(Qi,Oa[Ja],lo,Oa[Ja+1]));else O.push(ca({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:K+1},{fixed:0,stretch:mt+1}));return O}function Js(f,d,y){for(var T=0,O=0,N=f;O<N.length;O+=1){var Z=N[O];T+=Math.max(d,Math.min(y,Z[1]))-Math.max(d,Math.min(y,Z[0]))}return T}function zu(f,d,y){for(var T=[{fixed:-1,stretch:0}],O=0,N=f;O<N.length;O+=1){var Z=N[O],K=Z[0],mt=Z[1],Ot=T[T.length-1];T.push({fixed:K-Ot.stretch,stretch:Ot.stretch}),T.push({fixed:K-Ot.stretch,stretch:Ot.stretch+(mt-K)})}return T.push({fixed:d+1,stretch:y}),T}function Jo(f,d,y,T){return f/d*y+T}function La(f,d,y,T){return f-d*y/T}var tu=function(f,d,y,T,O,N,Z,K,mt,Ot){if(this.boxStartIndex=f.length,mt){var Gt=N.top,Kt=N.bottom,pe=N.collisionPadding;pe&&(Gt-=pe[1],Kt+=pe[3]);var Fe=Kt-Gt;Fe>0&&(Fe=Math.max(10,Fe),this.circleDiameter=Fe)}else{var sr=N.top*Z-K,lr=N.bottom*Z+K,Cr=N.left*Z-K,gr=N.right*Z+K,Ur=N.collisionPadding;if(Ur&&(Cr-=Ur[0]*Z,sr-=Ur[1]*Z,gr+=Ur[2]*Z,lr+=Ur[3]*Z),Ot){var Ar=new ht(Cr,sr),Dr=new ht(gr,sr),mn=new ht(Cr,lr),Fn=new ht(gr,lr),ni=Ot*Math.PI/180;Ar._rotate(ni),Dr._rotate(ni),mn._rotate(ni),Fn._rotate(ni),Cr=Math.min(Ar.x,Dr.x,mn.x,Fn.x),gr=Math.max(Ar.x,Dr.x,mn.x,Fn.x),sr=Math.min(Ar.y,Dr.y,mn.y,Fn.y),lr=Math.max(Ar.y,Dr.y,mn.y,Fn.y)}f.emplaceBack(d.x,d.y,Cr,sr,gr,lr,y,T,O)}this.boxEndIndex=f.length},fo=function(f,d){if(f===void 0&&(f=[]),d===void 0&&(d=Mu),this.data=f,this.length=this.data.length,this.compare=d,this.length>0)for(var y=(this.length>>1)-1;y>=0;y--)this._down(y)};function Mu(f,d){return f<d?-1:f>d?1:0}function ya(f,d,y){d===void 0&&(d=1),y===void 0&&(y=!1);for(var T=1/0,O=1/0,N=-1/0,Z=-1/0,K=f[0],mt=0;mt<K.length;mt++){var Ot=K[mt];(!mt||Ot.x<T)&&(T=Ot.x),(!mt||Ot.y<O)&&(O=Ot.y),(!mt||Ot.x>N)&&(N=Ot.x),(!mt||Ot.y>Z)&&(Z=Ot.y)}var Gt=Math.min(N-T,Z-O),Kt=Gt/2,pe=new fo([],eo);if(Gt===0)return new ht(T,O);for(var Fe=T;Fe<N;Fe+=Gt)for(var sr=O;sr<Z;sr+=Gt)pe.push(new Eo(Fe+Kt,sr+Kt,Kt,f));for(var lr=function(Ur){for(var Ar=0,Dr=0,mn=0,Fn=Ur[0],ni=0,ki=Fn.length,oa=ki-1;ni<ki;oa=ni++){var Di=Fn[ni],ca=Fn[oa],zi=Di.x*ca.y-ca.x*Di.y;Dr+=(Di.x+ca.x)*zi,mn+=(Di.y+ca.y)*zi,Ar+=3*zi}return new Eo(Dr/Ar,mn/Ar,0,Ur)}(f),Cr=pe.length;pe.length;){var gr=pe.pop();(gr.d>lr.d||!lr.d)&&(lr=gr,y&&console.log("found best %d after %d probes",Math.round(1e4*gr.d)/1e4,Cr)),gr.max-lr.d<=d||(pe.push(new Eo(gr.p.x-(Kt=gr.h/2),gr.p.y-Kt,Kt,f)),pe.push(new Eo(gr.p.x+Kt,gr.p.y-Kt,Kt,f)),pe.push(new Eo(gr.p.x-Kt,gr.p.y+Kt,Kt,f)),pe.push(new Eo(gr.p.x+Kt,gr.p.y+Kt,Kt,f)),Cr+=4)}return y&&(console.log("num probes: "+Cr),console.log("best distance: "+lr.d)),lr.p}function eo(f,d){return d.max-f.max}function Eo(f,d,y,T){this.p=new ht(f,d),this.h=y,this.d=function(O,N){for(var Z=!1,K=1/0,mt=0;mt<N.length;mt++)for(var Ot=N[mt],Gt=0,Kt=Ot.length,pe=Kt-1;Gt<Kt;pe=Gt++){var Fe=Ot[Gt],sr=Ot[pe];Fe.y>O.y!=sr.y>O.y&&O.x<(sr.x-Fe.x)*(O.y-Fe.y)/(sr.y-Fe.y)+Fe.x&&(Z=!Z),K=Math.min(K,_h(O,Fe,sr))}return(Z?1:-1)*Math.sqrt(K)}(this.p,T),this.max=this.d+this.h*Math.SQRT2}fo.prototype.push=function(f){this.data.push(f),this.length++,this._up(this.length-1)},fo.prototype.pop=function(){if(this.length!==0){var f=this.data[0],d=this.data.pop();return this.length--,this.length>0&&(this.data[0]=d,this._down(0)),f}},fo.prototype.peek=function(){return this.data[0]},fo.prototype._up=function(f){for(var d=this.data,y=this.compare,T=d[f];f>0;){var O=f-1>>1,N=d[O];if(y(T,N)>=0)break;d[f]=N,f=O}d[f]=T},fo.prototype._down=function(f){for(var d=this.data,y=this.compare,T=this.length>>1,O=d[f];f<T;){var N=1+(f<<1),Z=d[N],K=N+1;if(K<this.length&&y(d[K],Z)<0&&(N=K,Z=d[K]),y(Z,O)>=0)break;d[f]=Z,f=N}d[f]=O};var wo=Number.POSITIVE_INFINITY;function Po(f,d){return d[1]!==wo?function(y,T,O){var N=0,Z=0;switch(T=Math.abs(T),O=Math.abs(O),y){case"top-right":case"top-left":case"top":Z=O-7;break;case"bottom-right":case"bottom-left":case"bottom":Z=7-O}switch(y){case"top-right":case"bottom-right":case"right":N=-T;break;case"top-left":case"bottom-left":case"left":N=T}return[N,Z]}(f,d[0],d[1]):function(y,T){var O=0,N=0;T<0&&(T=0);var Z=T/Math.sqrt(2);switch(y){case"top-right":case"top-left":N=Z-7;break;case"bottom-right":case"bottom-left":N=7-Z;break;case"bottom":N=7-T;break;case"top":N=T-7}switch(y){case"top-right":case"bottom-right":O=-Z;break;case"top-left":case"bottom-left":O=Z;break;case"left":O=T;break;case"right":O=-T}return[O,N]}(f,d[0])}function Je(f){switch(f){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function an(f,d,y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr){var lr=function(Dr,mn,Fn,ni,ki,oa,Di,ca){for(var zi=ni.layout.get("text-rotate").evaluate(oa,{})*Math.PI/180,Oa=[],xa=0,Qi=mn.positionedLines;xa<Qi.length;xa+=1)for(var lo=Qi[xa],Ja=0,To=lo.positionedGlyphs;Ja<To.length;Ja+=1){var ea=To[Ja];if(ea.rect){var Zo=ea.rect||{},Es=4,uu=!0,Ws=1,ks=0,eu=(ki||ca)&&ea.vertical,Qu=ea.metrics.advance*ea.scale/2;if(ca&&mn.verticalizable&&(ks=lo.lineOffset/2-(ea.imageName?-(24-ea.metrics.width*ea.scale)/2:24*(ea.scale-1))),ea.imageName){var lu=Di[ea.imageName];uu=lu.sdf,Es=1/(Ws=lu.pixelRatio)}var Gl=ki?[ea.x+Qu,ea.y]:[0,0],us=ki?[0,0]:[ea.x+Qu+Fn[0],ea.y+Fn[1]-ks],Hl=[0,0];eu&&(Hl=us,us=[0,0]);var mu=(ea.metrics.left-Es)*ea.scale-Qu+us[0],cu=(-ea.metrics.top-Es)*ea.scale+us[1],ro=mu+Zo.w*ea.scale/Ws,va=cu+Zo.h*ea.scale/Ws,ts=new ht(mu,cu),Do=new ht(ro,cu),jl=new ht(mu,va),Uu=new ht(ro,va);if(eu){var ws=new ht(-Qu,Qu- -17),Pu=-Math.PI/2,fu=12-Qu,Oo=new ht(22-fu,-(ea.imageName?fu:0)),cf=new(Function.prototype.bind.apply(ht,[null].concat(Hl)));ts._rotateAround(Pu,ws)._add(Oo)._add(cf),Do._rotateAround(Pu,ws)._add(Oo)._add(cf),jl._rotateAround(Pu,ws)._add(Oo)._add(cf),Uu._rotateAround(Pu,ws)._add(Oo)._add(cf)}if(zi){var ff=Math.sin(zi),nh=Math.cos(zi),ru=[nh,-ff,ff,nh];ts._matMult(ru),Do._matMult(ru),jl._matMult(ru),Uu._matMult(ru)}var kh=new ht(0,0),fl=new ht(0,0);Oa.push({tl:ts,tr:Do,bl:jl,br:Uu,tex:Zo,writingMode:mn.writingMode,glyphOffset:Gl,sectionIndex:ea.sectionIndex,isSDF:uu,pixelOffsetTL:kh,pixelOffsetBR:fl,minFontScaleX:0,minFontScaleY:0})}}return Oa}(0,y,K,O,N,Z,T,f.allowVerticalPlacement),Cr=f.textSizeData,gr=null;Cr.kind==="source"?(gr=[128*O.layout.get("text-size").evaluate(Z,{})])[0]>32640&&ee(f.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Cr.kind==="composite"&&((gr=[128*Fe.compositeTextSizes[0].evaluate(Z,{},sr),128*Fe.compositeTextSizes[1].evaluate(Z,{},sr)])[0]>32640||gr[1]>32640)&&ee(f.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),f.addSymbols(f.text,lr,gr,K,N,Z,Ot,d,mt.lineStartIndex,mt.lineLength,pe,sr);for(var Ur=0,Ar=Gt;Ur<Ar.length;Ur+=1)Kt[Ar[Ur]]=f.text.placedSymbolArray.length-1;return 4*lr.length}function en(f){for(var d in f)return f[d];return null}function Ri(f,d,y,T){var O=f.compareText;if(d in O){for(var N=O[d],Z=N.length-1;Z>=0;Z--)if(T.dist(N[Z])<y)return!0}else O[d]=[];return O[d].push(T),!1}var so=rc.VectorTileFeature.types,qe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Re(f,d,y,T,O,N,Z,K,mt,Ot,Gt,Kt,pe){var Fe=K?Math.min(32640,Math.round(K[0])):0,sr=K?Math.min(32640,Math.round(K[1])):0;f.emplaceBack(d,y,Math.round(32*T),Math.round(32*O),N,Z,(Fe<<1)+(mt?1:0),sr,16*Ot,16*Gt,256*Kt,256*pe)}function yr(f,d,y){f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y),f.emplaceBack(d.x,d.y,y)}function Xr(f){for(var d=0,y=f.sections;d<y.length;d+=1)if(jf(y[d].text))return!0;return!1}var sn=function(f){this.layoutVertexArray=new Xc,this.indexArray=new Rs,this.programConfigurations=f,this.segments=new Be,this.dynamicLayoutVertexArray=new ll,this.opacityVertexArray=new Wf,this.placedSymbolArray=new M};sn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},sn.prototype.upload=function(f,d,y,T){this.isEmpty()||(y&&(this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,Bd.members),this.indexBuffer=f.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=f.createVertexBuffer(this.dynamicLayoutVertexArray,X0.members,!0),this.opacityVertexBuffer=f.createVertexBuffer(this.opacityVertexArray,qe,!0),this.opacityVertexBuffer.itemSize=1),(y||T)&&this.programConfigurations.upload(f))},sn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Zi("SymbolBuffers",sn);var mr=function(f,d,y){this.layoutVertexArray=new f,this.layoutAttributes=d,this.indexArray=new y,this.segments=new Be,this.collisionVertexArray=new wd};mr.prototype.upload=function(f){this.layoutVertexBuffer=f.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=f.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=f.createVertexBuffer(this.collisionVertexArray,Yp.members,!0)},mr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Zi("CollisionBuffers",mr);var pr=function(f){this.collisionBoxArray=f.collisionBoxArray,this.zoom=f.zoom,this.overscaling=f.overscaling,this.layers=f.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=f.index,this.pixelRatio=f.pixelRatio,this.sourceLayerIndex=f.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=wl([]),this.placementViewportMatrix=wl([]);var d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Li(this.zoom,d["text-size"]),this.iconSizeData=Li(this.zoom,d["icon-size"]);var y=this.layers[0].layout,T=y.get("symbol-sort-key"),O=y.get("symbol-z-order");this.canOverlap=y.get("text-allow-overlap")||y.get("icon-allow-overlap")||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey=O!=="viewport-y"&&T.constantOr(1)!==void 0,this.sortFeaturesByY=(O==="viewport-y"||O==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,y.get("symbol-placement")==="point"&&(this.writingModes=y.get("text-writing-mode").map(function(N){return vi[N]})),this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id}),this.sourceID=f.sourceID};pr.prototype.createArrays=function(){this.text=new sn(new da(this.layers,this.zoom,function(f){return/^text/.test(f)})),this.icon=new sn(new da(this.layers,this.zoom,function(f){return/^icon/.test(f)})),this.glyphOffsetArray=new $,this.lineVertexArray=new ft,this.symbolInstances=new H},pr.prototype.calculateGlyphDependencies=function(f,d,y,T,O){for(var N=0;N<f.length;N++)if(d[f.charCodeAt(N)]=!0,(y||T)&&O){var Z=Nu[f.charAt(N)];Z&&(d[Z.charCodeAt(0)]=!0)}},pr.prototype.populate=function(f,d,y){var T=this.layers[0],O=T.layout,N=O.get("text-font"),Z=O.get("text-field"),K=O.get("icon-image"),mt=(Z.value.kind!=="constant"||Z.value.value instanceof Wo&&!Z.value.value.isEmpty()||Z.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),Ot=K.value.kind!=="constant"||!!K.value.value||Object.keys(K.parameters).length>0,Gt=O.get("symbol-sort-key");if(this.features=[],mt||Ot){for(var Kt=d.iconDependencies,pe=d.glyphDependencies,Fe=d.availableImages,sr=new Ka(this.zoom),lr=0,Cr=f;lr<Cr.length;lr+=1){var gr=Cr[lr],Ur=gr.feature,Ar=gr.id,Dr=gr.index,mn=gr.sourceLayerIndex,Fn=T._featureFilter.needGeometry,ni=cs(Ur,Fn);if(T._featureFilter.filter(sr,ni,y)){Fn||(ni.geometry=ls(Ur));var ki=void 0;if(mt){var oa=T.getValueAndResolveTokens("text-field",ni,y,Fe),Di=Wo.factory(oa);Xr(Di)&&(this.hasRTLText=!0),(!this.hasRTLText||Ed()==="unavailable"||this.hasRTLText&&Ko.isParsed())&&(ki=Th(Di,T,ni))}var ca=void 0;if(Ot){var zi=T.getValueAndResolveTokens("icon-image",ni,y,Fe);ca=zi instanceof bo?zi:bo.fromString(zi)}if(ki||ca){var Oa=this.sortFeaturesByKey?Gt.evaluate(ni,{},y):void 0;if(this.features.push({id:Ar,text:ki,icon:ca,index:Dr,sourceLayerIndex:mn,geometry:ni.geometry,properties:Ur.properties,type:so[Ur.type],sortKey:Oa}),ca&&(Kt[ca.name]=!0),ki){var xa=N.evaluate(ni,{},y).join(","),Qi=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(vi.vertical)>=0;for(var lo=0,Ja=ki.sections;lo<Ja.length;lo+=1){var To=Ja[lo];if(To.image)Kt[To.image.name]=!0;else{var ea=Hf(ki.toString()),Zo=To.fontStack||xa,Es=pe[Zo]=pe[Zo]||{};this.calculateGlyphDependencies(To.text,Es,Qi,this.allowVerticalPlacement,ea)}}}}}}O.get("symbol-placement")==="line"&&(this.features=function(uu){var Ws={},ks={},eu=[],Qu=0;function lu(ws){eu.push(uu[ws]),Qu++}function Gl(ws,Pu,fu){var Oo=ks[ws];return delete ks[ws],ks[Pu]=Oo,eu[Oo].geometry[0].pop(),eu[Oo].geometry[0]=eu[Oo].geometry[0].concat(fu[0]),Oo}function us(ws,Pu,fu){var Oo=Ws[Pu];return delete Ws[Pu],Ws[ws]=Oo,eu[Oo].geometry[0].shift(),eu[Oo].geometry[0]=fu[0].concat(eu[Oo].geometry[0]),Oo}function Hl(ws,Pu,fu){var Oo=fu?Pu[0][Pu[0].length-1]:Pu[0][0];return ws+":"+Oo.x+":"+Oo.y}for(var mu=0;mu<uu.length;mu++){var cu=uu[mu],ro=cu.geometry,va=cu.text?cu.text.toString():null;if(va){var ts=Hl(va,ro),Do=Hl(va,ro,!0);if(ts in ks&&Do in Ws&&ks[ts]!==Ws[Do]){var jl=us(ts,Do,ro),Uu=Gl(ts,Do,eu[jl].geometry);delete Ws[ts],delete ks[Do],ks[Hl(va,eu[Uu].geometry,!0)]=Uu,eu[jl].geometry=null}else ts in ks?Gl(ts,Do,ro):Do in Ws?us(ts,Do,ro):(lu(mu),Ws[ts]=Qu-1,ks[Do]=Qu-1)}else lu(mu)}return eu.filter(function(ws){return ws.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(uu,Ws){return uu.sortKey-Ws.sortKey})}},pr.prototype.update=function(f,d,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(f,d,this.layers,y),this.icon.programConfigurations.updatePaintArrays(f,d,this.layers,y))},pr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},pr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},pr.prototype.upload=function(f){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(f),this.iconCollisionBox.upload(f)),this.text.upload(f,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(f,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},pr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},pr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},pr.prototype.addToLineVertexArray=function(f,d){var y=this.lineVertexArray.length;if(f.segment!==void 0){for(var T=f.dist(d[f.segment+1]),O=f.dist(d[f.segment]),N={},Z=f.segment+1;Z<d.length;Z++)N[Z]={x:d[Z].x,y:d[Z].y,tileUnitDistanceFromAnchor:T},Z<d.length-1&&(T+=d[Z+1].dist(d[Z]));for(var K=f.segment||0;K>=0;K--)N[K]={x:d[K].x,y:d[K].y,tileUnitDistanceFromAnchor:O},K>0&&(O+=d[K-1].dist(d[K]));for(var mt=0;mt<d.length;mt++){var Ot=N[mt];this.lineVertexArray.emplaceBack(Ot.x,Ot.y,Ot.tileUnitDistanceFromAnchor)}}return{lineStartIndex:y,lineLength:this.lineVertexArray.length-y}},pr.prototype.addSymbols=function(f,d,y,T,O,N,Z,K,mt,Ot,Gt,Kt){for(var pe=f.indexArray,Fe=f.layoutVertexArray,sr=f.segments.prepareSegment(4*d.length,Fe,pe,this.canOverlap?N.sortKey:void 0),lr=this.glyphOffsetArray.length,Cr=sr.vertexLength,gr=this.allowVerticalPlacement&&Z===vi.vertical?Math.PI/2:0,Ur=N.text&&N.text.sections,Ar=0;Ar<d.length;Ar++){var Dr=d[Ar],mn=Dr.tl,Fn=Dr.tr,ni=Dr.bl,ki=Dr.br,oa=Dr.tex,Di=Dr.pixelOffsetTL,ca=Dr.pixelOffsetBR,zi=Dr.minFontScaleX,Oa=Dr.minFontScaleY,xa=Dr.glyphOffset,Qi=Dr.isSDF,lo=Dr.sectionIndex,Ja=sr.vertexLength,To=xa[1];Re(Fe,K.x,K.y,mn.x,To+mn.y,oa.x,oa.y,y,Qi,Di.x,Di.y,zi,Oa),Re(Fe,K.x,K.y,Fn.x,To+Fn.y,oa.x+oa.w,oa.y,y,Qi,ca.x,Di.y,zi,Oa),Re(Fe,K.x,K.y,ni.x,To+ni.y,oa.x,oa.y+oa.h,y,Qi,Di.x,ca.y,zi,Oa),Re(Fe,K.x,K.y,ki.x,To+ki.y,oa.x+oa.w,oa.y+oa.h,y,Qi,ca.x,ca.y,zi,Oa),yr(f.dynamicLayoutVertexArray,K,gr),pe.emplaceBack(Ja,Ja+1,Ja+2),pe.emplaceBack(Ja+1,Ja+2,Ja+3),sr.vertexLength+=4,sr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xa[0]),Ar!==d.length-1&&lo===d[Ar+1].sectionIndex||f.programConfigurations.populatePaintArrays(Fe.length,N,N.index,{},Kt,Ur&&Ur[lo])}f.placedSymbolArray.emplaceBack(K.x,K.y,lr,this.glyphOffsetArray.length-lr,Cr,mt,Ot,K.segment,y?y[0]:0,y?y[1]:0,T[0],T[1],Z,0,!1,0,Gt)},pr.prototype._addCollisionDebugVertex=function(f,d,y,T,O,N){return d.emplaceBack(0,0),f.emplaceBack(y.x,y.y,T,O,Math.round(N.x),Math.round(N.y))},pr.prototype.addCollisionDebugVertices=function(f,d,y,T,O,N,Z){var K=O.segments.prepareSegment(4,O.layoutVertexArray,O.indexArray),mt=K.vertexLength,Ot=O.layoutVertexArray,Gt=O.collisionVertexArray,Kt=Z.anchorX,pe=Z.anchorY;this._addCollisionDebugVertex(Ot,Gt,N,Kt,pe,new ht(f,d)),this._addCollisionDebugVertex(Ot,Gt,N,Kt,pe,new ht(y,d)),this._addCollisionDebugVertex(Ot,Gt,N,Kt,pe,new ht(y,T)),this._addCollisionDebugVertex(Ot,Gt,N,Kt,pe,new ht(f,T)),K.vertexLength+=4;var Fe=O.indexArray;Fe.emplaceBack(mt,mt+1),Fe.emplaceBack(mt+1,mt+2),Fe.emplaceBack(mt+2,mt+3),Fe.emplaceBack(mt+3,mt),K.primitiveLength+=4},pr.prototype.addDebugCollisionBoxes=function(f,d,y,T){for(var O=f;O<d;O++){var N=this.collisionBoxArray.get(O);this.addCollisionDebugVertices(N.x1,N.y1,N.x2,N.y2,T?this.textCollisionBox:this.iconCollisionBox,N.anchorPoint,y)}},pr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mr(mh,n0.members,pc),this.iconCollisionBox=new mr(mh,n0.members,pc);for(var f=0;f<this.symbolInstances.length;f++){var d=this.symbolInstances.get(f);this.addDebugCollisionBoxes(d.textBoxStartIndex,d.textBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d,!0),this.addDebugCollisionBoxes(d.iconBoxStartIndex,d.iconBoxEndIndex,d,!1),this.addDebugCollisionBoxes(d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex,d,!1)}},pr.prototype._deserializeCollisionBoxesForSymbol=function(f,d,y,T,O,N,Z,K,mt){for(var Ot={},Gt=d;Gt<y;Gt++){var Kt=f.get(Gt);Ot.textBox={x1:Kt.x1,y1:Kt.y1,x2:Kt.x2,y2:Kt.y2,anchorPointX:Kt.anchorPointX,anchorPointY:Kt.anchorPointY},Ot.textFeatureIndex=Kt.featureIndex;break}for(var pe=T;pe<O;pe++){var Fe=f.get(pe);Ot.verticalTextBox={x1:Fe.x1,y1:Fe.y1,x2:Fe.x2,y2:Fe.y2,anchorPointX:Fe.anchorPointX,anchorPointY:Fe.anchorPointY},Ot.verticalTextFeatureIndex=Fe.featureIndex;break}for(var sr=N;sr<Z;sr++){var lr=f.get(sr);Ot.iconBox={x1:lr.x1,y1:lr.y1,x2:lr.x2,y2:lr.y2,anchorPointX:lr.anchorPointX,anchorPointY:lr.anchorPointY},Ot.iconFeatureIndex=lr.featureIndex;break}for(var Cr=K;Cr<mt;Cr++){var gr=f.get(Cr);Ot.verticalIconBox={x1:gr.x1,y1:gr.y1,x2:gr.x2,y2:gr.y2,anchorPointX:gr.anchorPointX,anchorPointY:gr.anchorPointY},Ot.verticalIconFeatureIndex=gr.featureIndex;break}return Ot},pr.prototype.deserializeCollisionBoxes=function(f){this.collisionArrays=[];for(var d=0;d<this.symbolInstances.length;d++){var y=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(f,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}},pr.prototype.hasTextData=function(){return this.text.segments.get().length>0},pr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},pr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},pr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},pr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},pr.prototype.addIndicesForPlacedSymbol=function(f,d){for(var y=f.placedSymbolArray.get(d),T=y.vertexStartIndex+4*y.numGlyphs,O=y.vertexStartIndex;O<T;O+=4)f.indexArray.emplaceBack(O,O+1,O+2),f.indexArray.emplaceBack(O+1,O+2,O+3)},pr.prototype.getSortedSymbolIndexes=function(f){if(this.sortedAngle===f&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var d=Math.sin(f),y=Math.cos(f),T=[],O=[],N=[],Z=0;Z<this.symbolInstances.length;++Z){N.push(Z);var K=this.symbolInstances.get(Z);T.push(0|Math.round(d*K.anchorX+y*K.anchorY)),O.push(K.featureIndex)}return N.sort(function(mt,Ot){return T[mt]-T[Ot]||O[Ot]-O[mt]}),N},pr.prototype.addToSortKeyRanges=function(f,d){var y=this.sortKeyRanges[this.sortKeyRanges.length-1];y&&y.sortKey===d?y.symbolInstanceEnd=f+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:f,symbolInstanceEnd:f+1})},pr.prototype.sortFeatures=function(f){var d=this;if(this.sortFeaturesByY&&this.sortedAngle!==f&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(f),this.sortedAngle=f,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var y=0,T=this.symbolInstanceIndexes;y<T.length;y+=1){var O=this.symbolInstances.get(T[y]);this.featureSortOrder.push(O.featureIndex),[O.rightJustifiedTextSymbolIndex,O.centerJustifiedTextSymbolIndex,O.leftJustifiedTextSymbolIndex].forEach(function(N,Z,K){N>=0&&K.indexOf(N)===Z&&d.addIndicesForPlacedSymbol(d.text,N)}),O.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,O.verticalPlacedTextSymbolIndex),O.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.placedIconSymbolIndex),O.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,O.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Zi("SymbolBucket",pr,{omit:["layers","collisionBoxArray","features","compareText"]}),pr.MAX_GLYPHS=65535,pr.addDynamicAttributes=yr;var kr=new Ru({"symbol-placement":new Ki(Pe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ki(Pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ki(Pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wi(Pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ki(Pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ki(Pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ki(Pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ki(Pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ki(Pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wi(Pe.layout_symbol["icon-size"]),"icon-text-fit":new Ki(Pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ki(Pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wi(Pe.layout_symbol["icon-image"]),"icon-rotate":new Wi(Pe.layout_symbol["icon-rotate"]),"icon-padding":new Ki(Pe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ki(Pe.layout_symbol["icon-keep-upright"]),"icon-offset":new Wi(Pe.layout_symbol["icon-offset"]),"icon-anchor":new Wi(Pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ki(Pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ki(Pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ki(Pe.layout_symbol["text-rotation-alignment"]),"text-field":new Wi(Pe.layout_symbol["text-field"]),"text-font":new Wi(Pe.layout_symbol["text-font"]),"text-size":new Wi(Pe.layout_symbol["text-size"]),"text-max-width":new Wi(Pe.layout_symbol["text-max-width"]),"text-line-height":new Ki(Pe.layout_symbol["text-line-height"]),"text-letter-spacing":new Wi(Pe.layout_symbol["text-letter-spacing"]),"text-justify":new Wi(Pe.layout_symbol["text-justify"]),"text-radial-offset":new Wi(Pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ki(Pe.layout_symbol["text-variable-anchor"]),"text-anchor":new Wi(Pe.layout_symbol["text-anchor"]),"text-max-angle":new Ki(Pe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ki(Pe.layout_symbol["text-writing-mode"]),"text-rotate":new Wi(Pe.layout_symbol["text-rotate"]),"text-padding":new Ki(Pe.layout_symbol["text-padding"]),"text-keep-upright":new Ki(Pe.layout_symbol["text-keep-upright"]),"text-transform":new Wi(Pe.layout_symbol["text-transform"]),"text-offset":new Wi(Pe.layout_symbol["text-offset"]),"text-allow-overlap":new Ki(Pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ki(Pe.layout_symbol["text-ignore-placement"]),"text-optional":new Ki(Pe.layout_symbol["text-optional"])}),Ge={paint:new Ru({"icon-opacity":new Wi(Pe.paint_symbol["icon-opacity"]),"icon-color":new Wi(Pe.paint_symbol["icon-color"]),"icon-halo-color":new Wi(Pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wi(Pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wi(Pe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ki(Pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ki(Pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wi(Pe.paint_symbol["text-opacity"]),"text-color":new Wi(Pe.paint_symbol["text-color"],{runtimeType:hi,getOverride:function(f){return f.textColor},hasOverride:function(f){return!!f.textColor}}),"text-halo-color":new Wi(Pe.paint_symbol["text-halo-color"]),"text-halo-width":new Wi(Pe.paint_symbol["text-halo-width"]),"text-halo-blur":new Wi(Pe.paint_symbol["text-halo-blur"]),"text-translate":new Ki(Pe.paint_symbol["text-translate"]),"text-translate-anchor":new Ki(Pe.paint_symbol["text-translate-anchor"])}),layout:kr},vr=function(f){this.type=f.property.overrides?f.property.overrides.runtimeType:Si,this.defaultValue=f};vr.prototype.evaluate=function(f){if(f.formattedSection){var d=this.defaultValue.property.overrides;if(d&&d.hasOverride(f.formattedSection))return d.getOverride(f.formattedSection)}return f.feature&&f.featureState?this.defaultValue.evaluate(f.feature,f.featureState):this.defaultValue.property.specification.default},vr.prototype.eachChild=function(f){this.defaultValue.isConstant()||f(this.defaultValue.value._styleExpression.expression)},vr.prototype.outputDefined=function(){return!1},vr.prototype.serialize=function(){return null},Zi("FormatSectionOverride",vr,{omit:["defaultValue"]});var tr=function(f){function d(y){f.call(this,y,Ge)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.recalculate=function(y,T){if(f.prototype.recalculate.call(this,y,T),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var O=this.layout.get("text-writing-mode");if(O){for(var N=[],Z=0,K=O;Z<K.length;Z+=1){var mt=K[Z];N.indexOf(mt)<0&&N.push(mt)}this.layout._values["text-writing-mode"]=N}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},d.prototype.getValueAndResolveTokens=function(y,T,O,N){var Z=this.layout.get(y).evaluate(T,{},O,N),K=this._unevaluatedLayout._values[y];return K.isDataDriven()||Gc(K.value)||!Z?Z:function(mt,Ot){return Ot.replace(/{([^{}]+)}/g,function(Gt,Kt){return Kt in mt?String(mt[Kt]):""})}(T.properties,Z)},d.prototype.createBucket=function(y){return new pr(y)},d.prototype.queryRadius=function(){return 0},d.prototype.queryIntersectsFeature=function(){return!1},d.prototype._setPaintOverrides=function(){for(var y=0,T=Ge.paint.overridableProperties;y<T.length;y+=1){var O=T[y];if(d.hasPaintOverride(this.layout,O)){var N,Z=this.paint.get(O),K=new vr(Z),mt=new zf(K,Z.property.specification);N=Z.value.kind==="constant"||Z.value.kind==="source"?new Uf("source",mt):new lc("composite",mt,Z.value.zoomStops,Z.value._interpolationType),this.paint._values[O]=new Su(Z.property,N,Z.parameters)}}},d.prototype._handleOverridablePaintPropertyUpdate=function(y,T,O){return!(!this.layout||T.isDataDriven()||O.isDataDriven())&&d.hasPaintOverride(this.layout,y)},d.hasPaintOverride=function(y,T){var O=y.get("text-field"),N=Ge.paint.properties[T],Z=!1,K=function(Gt){for(var Kt=0,pe=Gt;Kt<pe.length;Kt+=1)if(N.overrides&&N.overrides.hasOverride(pe[Kt]))return void(Z=!0)};if(O.value.kind==="constant"&&O.value.value instanceof Wo)K(O.value.value.sections);else if(O.value.kind==="source"){var mt=function(Gt){Z||(Gt instanceof tn&&He(Gt.value)===po?K(Gt.value.sections):Gt instanceof ta?K(Gt.sections):Gt.eachChild(mt))},Ot=O.value;Ot._styleExpression&&mt(Ot._styleExpression.expression)}return Z},d}(bs),Hr={paint:new Ru({"background-color":new Ki(Pe.paint_background["background-color"]),"background-pattern":new ol(Pe.paint_background["background-pattern"]),"background-opacity":new Ki(Pe.paint_background["background-opacity"])})},Jr=function(f){function d(y){f.call(this,y,Hr)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(bs),Bn={paint:new Ru({"raster-opacity":new Ki(Pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ki(Pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ki(Pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ki(Pe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ki(Pe.paint_raster["raster-saturation"]),"raster-contrast":new Ki(Pe.paint_raster["raster-contrast"]),"raster-resampling":new Ki(Pe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ki(Pe.paint_raster["raster-fade-duration"])})},gi=function(f){function d(y){f.call(this,y,Bn)}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d}(bs),mi=function(f){function d(y){f.call(this,y,{}),this.implementation=y}return f&&(d.__proto__=f),(d.prototype=Object.create(f&&f.prototype)).constructor=d,d.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},d.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},d.prototype.recalculate=function(){},d.prototype.updateTransitions=function(){},d.prototype.hasTransition=function(){},d.prototype.serialize=function(){},d.prototype.onAdd=function(y){this.implementation.onAdd&&this.implementation.onAdd(y,y.painter.context.gl)},d.prototype.onRemove=function(y){this.implementation.onRemove&&this.implementation.onRemove(y,y.painter.context.gl)},d}(bs),pi={circle:Qc,heatmap:uv,hillshade:G0,fill:Pd,"fill-extrusion":nc,line:W0,symbol:tr,background:Jr,raster:gi},fi=et.HTMLImageElement,Xi=et.HTMLCanvasElement,Pi=et.HTMLVideoElement,Gi=et.ImageData,kn=et.ImageBitmap,Ni=function(f,d,y,T){this.context=f,this.format=y,this.texture=f.gl.createTexture(),this.update(d,T)};Ni.prototype.update=function(f,d,y){var T=f.width,O=f.height,N=!(this.size&&this.size[0]===T&&this.size[1]===O||y),Z=this.context,K=Z.gl;if(this.useMipmap=Boolean(d&&d.useMipmap),K.bindTexture(K.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===K.RGBA&&(!d||d.premultiply!==!1)),N)this.size=[T,O],f instanceof fi||f instanceof Xi||f instanceof Pi||f instanceof Gi||kn&&f instanceof kn?K.texImage2D(K.TEXTURE_2D,0,this.format,this.format,K.UNSIGNED_BYTE,f):K.texImage2D(K.TEXTURE_2D,0,this.format,T,O,0,this.format,K.UNSIGNED_BYTE,f.data);else{var mt=y||{x:0,y:0},Ot=mt.x,Gt=mt.y;f instanceof fi||f instanceof Xi||f instanceof Pi||f instanceof Gi||kn&&f instanceof kn?K.texSubImage2D(K.TEXTURE_2D,0,Ot,Gt,K.RGBA,K.UNSIGNED_BYTE,f):K.texSubImage2D(K.TEXTURE_2D,0,Ot,Gt,T,O,K.RGBA,K.UNSIGNED_BYTE,f.data)}this.useMipmap&&this.isSizePowerOfTwo()&&K.generateMipmap(K.TEXTURE_2D)},Ni.prototype.bind=function(f,d,y){var T=this.context.gl;T.bindTexture(T.TEXTURE_2D,this.texture),y!==T.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=T.LINEAR),f!==this.filter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,f),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,y||f),this.filter=f),d!==this.wrap&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,d),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,d),this.wrap=d)},Ni.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ni.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Ea=function(f){var d=this;this._callback=f,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){d._triggered=!1,d._callback()})};Ea.prototype.trigger=function(){var f=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){f._triggered=!1,f._callback()},0))},Ea.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jo=function(f,d,y){this.target=f,this.parent=d,this.mapId=y,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},It(["receive","process"],this),this.invoker=new Ea(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=gt()?f:et};function Iu(f,d,y){var T=2*Math.PI*6378137/256/Math.pow(2,y);return[f*T-2*Math.PI*6378137/2,d*T-2*Math.PI*6378137/2]}jo.prototype.send=function(f,d,y,T,O){var N=this;O===void 0&&(O=!1);var Z=Math.round(1e18*Math.random()).toString(36).substring(0,10);y&&(this.callbacks[Z]=y);var K=vt(this.globalScope)?void 0:[];return this.target.postMessage({id:Z,type:f,hasCallback:!!y,targetMapId:T,mustQueue:O,sourceMapId:this.mapId,data:cc(d,K)},K),{cancel:function(){y&&delete N.callbacks[Z],N.target.postMessage({id:Z,type:"<cancel>",targetMapId:T,sourceMapId:N.mapId})}}},jo.prototype.receive=function(f){var d=f.data,y=d.id;if(y&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){delete this.tasks[y];var T=this.cancelCallbacks[y];delete this.cancelCallbacks[y],T&&T()}else gt()||d.mustQueue?(this.tasks[y]=d,this.taskQueue.push(y),this.invoker.trigger()):this.processTask(y,d)},jo.prototype.process=function(){if(this.taskQueue.length){var f=this.taskQueue.shift(),d=this.tasks[f];delete this.tasks[f],this.taskQueue.length&&this.invoker.trigger(),d&&this.processTask(f,d)}},jo.prototype.processTask=function(f,d){var y=this;if(d.type==="<response>"){var T=this.callbacks[f];delete this.callbacks[f],T&&(d.error?T(ml(d.error)):T(null,ml(d.data)))}else{var O=!1,N=vt(this.globalScope)?void 0:[],Z=d.hasCallback?function(Gt,Kt){O=!0,delete y.cancelCallbacks[f],y.target.postMessage({id:f,type:"<response>",sourceMapId:y.mapId,error:Gt?cc(Gt):null,data:cc(Kt,N)},N)}:function(Gt){O=!0},K=null,mt=ml(d.data);if(this.parent[d.type])K=this.parent[d.type](d.sourceMapId,mt,Z);else if(this.parent.getWorkerSource){var Ot=d.type.split(".");K=this.parent.getWorkerSource(d.sourceMapId,Ot[0],mt.source)[Ot[1]](mt,Z)}else Z(new Error("Could not find function "+d.type));!O&&K&&K.cancel&&(this.cancelCallbacks[f]=K.cancel)}},jo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var _a=function(f,d){f&&(d?this.setSouthWest(f).setNorthEast(d):f.length===4?this.setSouthWest([f[0],f[1]]).setNorthEast([f[2],f[3]]):this.setSouthWest(f[0]).setNorthEast(f[1]))};_a.prototype.setNorthEast=function(f){return this._ne=f instanceof mo?new mo(f.lng,f.lat):mo.convert(f),this},_a.prototype.setSouthWest=function(f){return this._sw=f instanceof mo?new mo(f.lng,f.lat):mo.convert(f),this},_a.prototype.extend=function(f){var d,y,T=this._sw,O=this._ne;if(f instanceof mo)d=f,y=f;else{if(!(f instanceof _a))return Array.isArray(f)?f.length===4||f.every(Array.isArray)?this.extend(_a.convert(f)):this.extend(mo.convert(f)):this;if(y=f._ne,!(d=f._sw)||!y)return this}return T||O?(T.lng=Math.min(d.lng,T.lng),T.lat=Math.min(d.lat,T.lat),O.lng=Math.max(y.lng,O.lng),O.lat=Math.max(y.lat,O.lat)):(this._sw=new mo(d.lng,d.lat),this._ne=new mo(y.lng,y.lat)),this},_a.prototype.getCenter=function(){return new mo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},_a.prototype.getSouthWest=function(){return this._sw},_a.prototype.getNorthEast=function(){return this._ne},_a.prototype.getNorthWest=function(){return new mo(this.getWest(),this.getNorth())},_a.prototype.getSouthEast=function(){return new mo(this.getEast(),this.getSouth())},_a.prototype.getWest=function(){return this._sw.lng},_a.prototype.getSouth=function(){return this._sw.lat},_a.prototype.getEast=function(){return this._ne.lng},_a.prototype.getNorth=function(){return this._ne.lat},_a.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},_a.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},_a.prototype.isEmpty=function(){return!(this._sw&&this._ne)},_a.prototype.contains=function(f){var d=mo.convert(f),y=d.lng,T=d.lat,O=this._sw.lng<=y&&y<=this._ne.lng;return this._sw.lng>this._ne.lng&&(O=this._sw.lng>=y&&y>=this._ne.lng),this._sw.lat<=T&&T<=this._ne.lat&&O},_a.convert=function(f){return!f||f instanceof _a?f:new _a(f)};var mo=function(f,d){if(isNaN(f)||isNaN(d))throw new Error("Invalid LngLat object: ("+f+", "+d+")");if(this.lng=+f,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};mo.prototype.wrap=function(){return new mo(P(this.lng,-180,180),this.lat)},mo.prototype.toArray=function(){return[this.lng,this.lat]},mo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},mo.prototype.distanceTo=function(f){var d=Math.PI/180,y=this.lat*d,T=f.lat*d,O=Math.sin(y)*Math.sin(T)+Math.cos(y)*Math.cos(T)*Math.cos((f.lng-this.lng)*d);return 63710088e-1*Math.acos(Math.min(O,1))},mo.prototype.toBounds=function(f){f===void 0&&(f=0);var d=360*f/40075017,y=d/Math.cos(Math.PI/180*this.lat);return new _a(new mo(this.lng-y,this.lat-d),new mo(this.lng+y,this.lat+d))},mo.convert=function(f){if(f instanceof mo)return f;if(Array.isArray(f)&&(f.length===2||f.length===3))return new mo(Number(f[0]),Number(f[1]));if(!Array.isArray(f)&&typeof f=="object"&&f!==null)return new mo(Number("lng"in f?f.lng:f.lon),Number(f.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Oc=2*Math.PI*63710088e-1;function Al(f){return Oc*Math.cos(f*Math.PI/180)}function lf(f){return(180+f)/360}function Zl(f){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+f*Math.PI/360)))/360}function Y0(f,d){return f/Al(d)}function Ll(f){return 360/Math.PI*Math.atan(Math.exp((180-360*f)*Math.PI/180))-90}var rh=function(f,d,y){y===void 0&&(y=0),this.x=+f,this.y=+d,this.z=+y};rh.fromLngLat=function(f,d){d===void 0&&(d=0);var y=mo.convert(f);return new rh(lf(y.lng),Zl(y.lat),Y0(d,y.lat))},rh.prototype.toLngLat=function(){return new mo(360*this.x-180,Ll(this.y))},rh.prototype.toAltitude=function(){return this.z*Al(Ll(this.y))},rh.prototype.meterInMercatorCoordinateUnits=function(){return 1/Oc*(f=Ll(this.y),1/Math.cos(f*Math.PI/180));var f};var cp=function(f,d,y){this.z=f,this.x=d,this.y=y,this.key=mv(0,f,f,d,y)};cp.prototype.equals=function(f){return this.z===f.z&&this.x===f.x&&this.y===f.y},cp.prototype.url=function(f,d){var y,T,O,N,Z,K=(T=this.y,O=this.z,N=Iu(256*(y=this.x),256*(T=Math.pow(2,O)-T-1),O),Z=Iu(256*(y+1),256*(T+1),O),N[0]+","+N[1]+","+Z[0]+","+Z[1]),mt=function(Ot,Gt,Kt){for(var pe,Fe="",sr=Ot;sr>0;sr--)Fe+=(Gt&(pe=1<<sr-1)?1:0)+(Kt&pe?2:0);return Fe}(this.z,this.x,this.y);return f[(this.x+this.y)%f.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",mt).replace("{bbox-epsg-3857}",K)},cp.prototype.getTilePoint=function(f){var d=Math.pow(2,this.z);return new ht(8192*(f.x*d-this.x),8192*(f.y*d-this.y))},cp.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var gv=function(f,d){this.wrap=f,this.canonical=d,this.key=mv(f,d.z,d.z,d.x,d.y)},ku=function(f,d,y,T,O){this.overscaledZ=f,this.wrap=d,this.canonical=new cp(y,+T,+O),this.key=mv(d,f,y,T,O)};function mv(f,d,y,T,O){(f*=2)<0&&(f=-1*f-1);var N=1<<y;return(N*N*f+N*O+T).toString(36)+y.toString(36)+d.toString(36)}ku.prototype.equals=function(f){return this.overscaledZ===f.overscaledZ&&this.wrap===f.wrap&&this.canonical.equals(f.canonical)},ku.prototype.scaledTo=function(f){var d=this.canonical.z-f;return f>this.canonical.z?new ku(f,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ku(f,this.wrap,f,this.canonical.x>>d,this.canonical.y>>d)},ku.prototype.calculateScaledKey=function(f,d){var y=this.canonical.z-f;return f>this.canonical.z?mv(this.wrap*+d,f,this.canonical.z,this.canonical.x,this.canonical.y):mv(this.wrap*+d,f,f,this.canonical.x>>y,this.canonical.y>>y)},ku.prototype.isChildOf=function(f){if(f.wrap!==this.wrap)return!1;var d=this.canonical.z-f.canonical.z;return f.overscaledZ===0||f.overscaledZ<this.overscaledZ&&f.canonical.x===this.canonical.x>>d&&f.canonical.y===this.canonical.y>>d},ku.prototype.children=function(f){if(this.overscaledZ>=f)return[new ku(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var d=this.canonical.z+1,y=2*this.canonical.x,T=2*this.canonical.y;return[new ku(d,this.wrap,d,y,T),new ku(d,this.wrap,d,y+1,T),new ku(d,this.wrap,d,y,T+1),new ku(d,this.wrap,d,y+1,T+1)]},ku.prototype.isLessThan=function(f){return this.wrap<f.wrap||!(this.wrap>f.wrap)&&(this.overscaledZ<f.overscaledZ||!(this.overscaledZ>f.overscaledZ)&&(this.canonical.x<f.canonical.x||!(this.canonical.x>f.canonical.x)&&this.canonical.y<f.canonical.y))},ku.prototype.wrapped=function(){return new ku(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ku.prototype.unwrapTo=function(f){return new ku(this.overscaledZ,f,this.canonical.z,this.canonical.x,this.canonical.y)},ku.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ku.prototype.toUnwrapped=function(){return new gv(this.wrap,this.canonical)},ku.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ku.prototype.getTilePoint=function(f){return this.canonical.getTilePoint(new rh(f.x-this.wrap,f.y))},Zi("CanonicalTileID",cp),Zi("OverscaledTileID",ku,{omit:["posMatrix"]});var Mh=function(f,d,y){if(this.uid=f,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(y&&y!=="mapbox"&&y!=="terrarium")return ee('"'+y+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=d.height;var T=this.dim=d.height-2;this.data=new Uint32Array(d.data.buffer),this.encoding=y||"mapbox";for(var O=0;O<T;O++)this.data[this._idx(-1,O)]=this.data[this._idx(0,O)],this.data[this._idx(T,O)]=this.data[this._idx(T-1,O)],this.data[this._idx(O,-1)]=this.data[this._idx(O,0)],this.data[this._idx(O,T)]=this.data[this._idx(O,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)]};Mh.prototype.get=function(f,d){var y=new Uint8Array(this.data.buffer),T=4*this._idx(f,d);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(y[T],y[T+1],y[T+2])},Mh.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Mh.prototype._idx=function(f,d){if(f<-1||f>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(f+1)},Mh.prototype._unpackMapbox=function(f,d,y){return(256*f*256+256*d+y)/10-1e4},Mh.prototype._unpackTerrarium=function(f,d,y){return 256*f+d+y/256-32768},Mh.prototype.getPixels=function(){return new Cu({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Mh.prototype.backfillBorder=function(f,d,y){if(this.dim!==f.dim)throw new Error("dem dimension mismatch");var T=d*this.dim,O=d*this.dim+this.dim,N=y*this.dim,Z=y*this.dim+this.dim;switch(d){case-1:T=O-1;break;case 1:O=T+1}switch(y){case-1:N=Z-1;break;case 1:Z=N+1}for(var K=-d*this.dim,mt=-y*this.dim,Ot=N;Ot<Z;Ot++)for(var Gt=T;Gt<O;Gt++)this.data[this._idx(Gt,Ot)]=f.data[this._idx(Gt+K,Ot+mt)]},Zi("DEMData",Mh);var i0=function(f){this._stringToNumber={},this._numberToString=[];for(var d=0;d<f.length;d++){var y=f[d];this._stringToNumber[y]=d,this._numberToString[d]=y}};i0.prototype.encode=function(f){return this._stringToNumber[f]},i0.prototype.decode=function(f){return this._numberToString[f]};var $0=function(f,d,y,T,O){this.type="Feature",this._vectorTileFeature=f,f._z=d,f._x=y,f._y=T,this.properties=f.properties,this.id=O},Zg={geometry:{configurable:!0}};Zg.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Zg.geometry.set=function(f){this._geometry=f},$0.prototype.toJSON=function(){var f={geometry:this.geometry};for(var d in this)d!=="_geometry"&&d!=="_vectorTileFeature"&&(f[d]=this[d]);return f},Object.defineProperties($0.prototype,Zg);var Kp=function(){this.state={},this.stateChanges={},this.deletedStates={}};Kp.prototype.updateState=function(f,d,y){var T=String(d);if(this.stateChanges[f]=this.stateChanges[f]||{},this.stateChanges[f][T]=this.stateChanges[f][T]||{},b(this.stateChanges[f][T],y),this.deletedStates[f]===null)for(var O in this.deletedStates[f]={},this.state[f])O!==T&&(this.deletedStates[f][O]=null);else if(this.deletedStates[f]&&this.deletedStates[f][T]===null)for(var N in this.deletedStates[f][T]={},this.state[f][T])y[N]||(this.deletedStates[f][T][N]=null);else for(var Z in y)this.deletedStates[f]&&this.deletedStates[f][T]&&this.deletedStates[f][T][Z]===null&&delete this.deletedStates[f][T][Z]},Kp.prototype.removeFeatureState=function(f,d,y){if(this.deletedStates[f]!==null){var T=String(d);if(this.deletedStates[f]=this.deletedStates[f]||{},y&&d!==void 0)this.deletedStates[f][T]!==null&&(this.deletedStates[f][T]=this.deletedStates[f][T]||{},this.deletedStates[f][T][y]=null);else if(d!==void 0)if(this.stateChanges[f]&&this.stateChanges[f][T])for(y in this.deletedStates[f][T]={},this.stateChanges[f][T])this.deletedStates[f][T][y]=null;else this.deletedStates[f][T]=null;else this.deletedStates[f]=null}},Kp.prototype.getState=function(f,d){var y=String(d),T=b({},(this.state[f]||{})[y],(this.stateChanges[f]||{})[y]);if(this.deletedStates[f]===null)return{};if(this.deletedStates[f]){var O=this.deletedStates[f][d];if(O===null)return{};for(var N in O)delete T[N]}return T},Kp.prototype.initializeTileState=function(f,d){f.setFeatureState(this.state,d)},Kp.prototype.coalesceChanges=function(f,d){var y={};for(var T in this.stateChanges){this.state[T]=this.state[T]||{};var O={};for(var N in this.stateChanges[T])this.state[T][N]||(this.state[T][N]={}),b(this.state[T][N],this.stateChanges[T][N]),O[N]=this.state[T][N];y[T]=O}for(var Z in this.deletedStates){this.state[Z]=this.state[Z]||{};var K={};if(this.deletedStates[Z]===null)for(var mt in this.state[Z])K[mt]={},this.state[Z][mt]={};else for(var Ot in this.deletedStates[Z]){if(this.deletedStates[Z][Ot]===null)this.state[Z][Ot]={};else for(var Gt=0,Kt=Object.keys(this.deletedStates[Z][Ot]);Gt<Kt.length;Gt+=1)delete this.state[Z][Ot][Kt[Gt]];K[Ot]=this.state[Z][Ot]}y[Z]=y[Z]||{},b(y[Z],K)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(var pe in f)f[pe].setFeatureState(y,d)};var Ih=function(f,d){this.tileID=f,this.x=f.canonical.x,this.y=f.canonical.y,this.z=f.canonical.z,this.grid=new Ef(8192,16,0),this.grid3D=new Ef(8192,16,0),this.featureIndexArray=new re,this.promoteId=d};function jm(f,d,y,T,O){return Dt(f,function(N,Z){var K=d instanceof Il?d.get(Z):null;return K&&K.evaluate?K.evaluate(y,T,O):K})}function Vg(f){for(var d=1/0,y=1/0,T=-1/0,O=-1/0,N=0,Z=f;N<Z.length;N+=1){var K=Z[N];d=Math.min(d,K.x),y=Math.min(y,K.y),T=Math.max(T,K.x),O=Math.max(O,K.y)}return{minX:d,minY:y,maxX:T,maxY:O}}function Gg(f,d){return d-f}Ih.prototype.insert=function(f,d,y,T,O,N){var Z=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(y,T,O);for(var K=N?this.grid3D:this.grid,mt=0;mt<d.length;mt++){for(var Ot=d[mt],Gt=[1/0,1/0,-1/0,-1/0],Kt=0;Kt<Ot.length;Kt++){var pe=Ot[Kt];Gt[0]=Math.min(Gt[0],pe.x),Gt[1]=Math.min(Gt[1],pe.y),Gt[2]=Math.max(Gt[2],pe.x),Gt[3]=Math.max(Gt[3],pe.y)}Gt[0]<8192&&Gt[1]<8192&&Gt[2]>=0&&Gt[3]>=0&&K.insert(Z,Gt[0],Gt[1],Gt[2],Gt[3])}},Ih.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new rc.VectorTile(new th(this.rawTileData)).layers,this.sourceLayerCoder=new i0(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ih.prototype.query=function(f,d,y,T){var O=this;this.loadVTLayers();for(var N=f.params||{},Z=8192/f.tileSize/f.scale,K=Op(N.filter),mt=f.queryGeometry,Ot=f.queryPadding*Z,Gt=Vg(mt),Kt=this.grid.query(Gt.minX-Ot,Gt.minY-Ot,Gt.maxX+Ot,Gt.maxY+Ot),pe=Vg(f.cameraQueryGeometry),Fe=this.grid3D.query(pe.minX-Ot,pe.minY-Ot,pe.maxX+Ot,pe.maxY+Ot,function(Dr,mn,Fn,ni){return function(ki,oa,Di,ca,zi){for(var Oa=0,xa=ki;Oa<xa.length;Oa+=1){var Qi=xa[Oa];if(oa<=Qi.x&&Di<=Qi.y&&ca>=Qi.x&&zi>=Qi.y)return!0}var lo=[new ht(oa,Di),new ht(oa,zi),new ht(ca,zi),new ht(ca,Di)];if(ki.length>2){for(var Ja=0,To=lo;Ja<To.length;Ja+=1)if(dc(ki,To[Ja]))return!0}for(var ea=0;ea<ki.length-1;ea++)if(xh(ki[ea],ki[ea+1],lo))return!0;return!1}(f.cameraQueryGeometry,Dr-Ot,mn-Ot,Fn+Ot,ni+Ot)}),sr=0,lr=Fe;sr<lr.length;sr+=1)Kt.push(lr[sr]);Kt.sort(Gg);for(var Cr,gr={},Ur=function(Dr){var mn=Kt[Dr];if(mn!==Cr){Cr=mn;var Fn=O.featureIndexArray.get(mn),ni=null;O.loadMatchingFeature(gr,Fn.bucketIndex,Fn.sourceLayerIndex,Fn.featureIndex,K,N.layers,N.availableImages,d,y,T,function(ki,oa,Di){return ni||(ni=ls(ki)),oa.queryIntersectsFeature(mt,ki,Di,ni,O.z,f.transform,Z,f.pixelPosMatrix)})}},Ar=0;Ar<Kt.length;Ar++)Ur(Ar);return gr},Ih.prototype.loadMatchingFeature=function(f,d,y,T,O,N,Z,K,mt,Ot,Gt){var Kt=this.bucketLayerIDs[d];if(!N||function(ki,oa){for(var Di=0;Di<ki.length;Di++)if(oa.indexOf(ki[Di])>=0)return!0;return!1}(N,Kt)){var pe=this.sourceLayerCoder.decode(y),Fe=this.vtLayers[pe].feature(T);if(O.needGeometry){var sr=cs(Fe,!0);if(!O.filter(new Ka(this.tileID.overscaledZ),sr,this.tileID.canonical))return}else if(!O.filter(new Ka(this.tileID.overscaledZ),Fe))return;for(var lr=this.getId(Fe,pe),Cr=0;Cr<Kt.length;Cr++){var gr=Kt[Cr];if(!(N&&N.indexOf(gr)<0)){var Ur=K[gr];if(Ur){var Ar={};lr!==void 0&&Ot&&(Ar=Ot.getState(Ur.sourceLayer||"_geojsonTileLayer",lr));var Dr=b({},mt[gr]);Dr.paint=jm(Dr.paint,Ur.paint,Fe,Ar,Z),Dr.layout=jm(Dr.layout,Ur.layout,Fe,Ar,Z);var mn=!Gt||Gt(Fe,Ur,Ar);if(mn){var Fn=new $0(Fe,this.z,this.x,this.y,lr);Fn.layer=Dr;var ni=f[gr];ni===void 0&&(ni=f[gr]=[]),ni.push({featureIndex:T,feature:Fn,intersectionZ:mn})}}}}}},Ih.prototype.lookupSymbolFeatures=function(f,d,y,T,O,N,Z,K){var mt={};this.loadVTLayers();for(var Ot=Op(O),Gt=0,Kt=f;Gt<Kt.length;Gt+=1)this.loadMatchingFeature(mt,y,T,Kt[Gt],Ot,N,Z,K,d);return mt},Ih.prototype.hasLayer=function(f){for(var d=0,y=this.bucketLayerIDs;d<y.length;d+=1)for(var T=0,O=y[d];T<O.length;T+=1)if(f===O[T])return!0;return!1},Ih.prototype.getId=function(f,d){var y=f.id;return this.promoteId&&typeof(y=f.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[d]])=="boolean"&&(y=Number(y)),y},Zi("FeatureIndex",Ih,{omit:["rawTileData","sourceLayerCoder"]});var Lu=function(f,d){this.tileID=f,this.uid=le(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Lu.prototype.registerFadeDuration=function(f){var d=f+this.timeAdded;d<Te.now()||this.fadeEndTime&&d<this.fadeEndTime||(this.fadeEndTime=d)},Lu.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Lu.prototype.loadVectorData=function(f,d,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",f){for(var T in f.featureIndex&&(this.latestFeatureIndex=f.featureIndex,f.rawTileData?(this.latestRawTileData=f.rawTileData,this.latestFeatureIndex.rawTileData=f.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=f.collisionBoxArray,this.buckets=function(Ot,Gt){var Kt={};if(!Gt)return Kt;for(var pe=function(){var lr=sr[Fe],Cr=lr.layerIds.map(function(Ar){return Gt.getLayer(Ar)}).filter(Boolean);if(Cr.length!==0){lr.layers=Cr,lr.stateDependentLayerIds&&(lr.stateDependentLayers=lr.stateDependentLayerIds.map(function(Ar){return Cr.filter(function(Dr){return Dr.id===Ar})[0]}));for(var gr=0,Ur=Cr;gr<Ur.length;gr+=1)Kt[Ur[gr].id]=lr}},Fe=0,sr=Ot;Fe<sr.length;Fe+=1)pe();return Kt}(f.buckets,d.style),this.hasSymbolBuckets=!1,this.buckets){var O=this.buckets[T];if(O instanceof pr){if(this.hasSymbolBuckets=!0,!y)break;O.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var N in this.buckets){var Z=this.buckets[N];if(Z instanceof pr&&Z.hasRTLText){this.hasRTLText=!0,Ko.isLoading()||Ko.isLoaded()||Ed()!=="deferred"||Ml();break}}for(var K in this.queryPadding=0,this.buckets){var mt=this.buckets[K];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(K).queryRadius(mt))}f.imageAtlas&&(this.imageAtlas=f.imageAtlas),f.glyphAtlasImage&&(this.glyphAtlasImage=f.glyphAtlasImage)}else this.collisionBoxArray=new C},Lu.prototype.unloadVectorData=function(){for(var f in this.buckets)this.buckets[f].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Lu.prototype.getBucket=function(f){return this.buckets[f.id]},Lu.prototype.upload=function(f){for(var d in this.buckets){var y=this.buckets[d];y.uploadPending()&&y.upload(f)}var T=f.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ni(f,this.imageAtlas.image,T.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ni(f,this.glyphAtlasImage,T.ALPHA),this.glyphAtlasImage=null)},Lu.prototype.prepare=function(f){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(f,this.imageAtlasTexture)},Lu.prototype.queryRenderedFeatures=function(f,d,y,T,O,N,Z,K,mt,Ot){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:T,cameraQueryGeometry:O,scale:N,tileSize:this.tileSize,pixelPosMatrix:Ot,transform:K,params:Z,queryPadding:this.queryPadding*mt},f,d,y):{}},Lu.prototype.querySourceFeatures=function(f,d){var y=this.latestFeatureIndex;if(y&&y.rawTileData){var T=y.loadVTLayers(),O=d?d.sourceLayer:"",N=T._geojsonTileLayer||T[O];if(N)for(var Z=Op(d&&d.filter),K=this.tileID.canonical,mt=K.z,Ot=K.x,Gt=K.y,Kt={z:mt,x:Ot,y:Gt},pe=0;pe<N.length;pe++){var Fe=N.feature(pe);if(Z.needGeometry){var sr=cs(Fe,!0);if(!Z.filter(new Ka(this.tileID.overscaledZ),sr,this.tileID.canonical))continue}else if(!Z.filter(new Ka(this.tileID.overscaledZ),Fe))continue;var lr=y.getId(Fe,O),Cr=new $0(Fe,mt,Ot,Gt,lr);Cr.tile=Kt,f.push(Cr)}}},Lu.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Lu.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Lu.prototype.setExpiryData=function(f){var d=this.expirationTime;if(f.cacheControl){var y=Pt(f.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else f.expires&&(this.expirationTime=new Date(f.expires).getTime());if(this.expirationTime){var T=Date.now(),O=!1;if(this.expirationTime>T)O=!1;else if(d)if(this.expirationTime<d)O=!0;else{var N=this.expirationTime-d;N?this.expirationTime=T+Math.max(N,3e4):O=!0}else O=!0;O?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Lu.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Lu.prototype.setFeatureState=function(f,d){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(f).length!==0){var y=this.latestFeatureIndex.loadVTLayers();for(var T in this.buckets)if(d.style.hasLayer(T)){var O=this.buckets[T],N=O.layers[0].sourceLayer||"_geojsonTileLayer",Z=y[N],K=f[N];if(Z&&K&&Object.keys(K).length!==0){O.update(K,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});var mt=d&&d.style&&d.style.getLayer(T);mt&&(this.queryPadding=Math.max(this.queryPadding,mt.queryRadius(O)))}}}},Lu.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Lu.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Te.now()},Lu.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Lu.prototype.setHoldDuration=function(f){this.symbolFadeHoldUntil=Te.now()+f},Lu.prototype.setDependencies=function(f,d){for(var y={},T=0,O=d;T<O.length;T+=1)y[O[T]]=!0;this.dependencies[f]=y},Lu.prototype.hasDependency=function(f,d){for(var y=0,T=f;y<T.length;y+=1){var O=this.dependencies[T[y]];if(O){for(var N=0,Z=d;N<Z.length;N+=1)if(O[Z[N]])return!0}}return!1};var Vl=et.performance,q0=function(f){this._marks={start:[f.url,"start"].join("#"),end:[f.url,"end"].join("#"),measure:f.url.toString()},Vl.mark(this._marks.start)};q0.prototype.finish=function(){Vl.mark(this._marks.end);var f=Vl.getEntriesByName(this._marks.measure);return f.length===0&&(Vl.measure(this._marks.measure,this._marks.start,this._marks.end),f=Vl.getEntriesByName(this._marks.measure),Vl.clearMarks(this._marks.start),Vl.clearMarks(this._marks.end),Vl.clearMeasures(this._marks.measure)),f},I.Actor=jo,I.AlphaImage=kl,I.CanonicalTileID=cp,I.CollisionBoxArray=C,I.Color=to,I.DEMData=Mh,I.DataConstantProperty=Ki,I.DictionaryCoder=i0,I.EXTENT=8192,I.ErrorEvent=fr,I.EvaluationParameters=Ka,I.Event=Ue,I.Evented=Sr,I.FeatureIndex=Ih,I.FillBucket=Ul,I.FillExtrusionBucket=sf,I.ImageAtlas=Xn,I.ImagePosition=Gr,I.LineBucket=Ro,I.LngLat=mo,I.LngLatBounds=_a,I.MercatorCoordinate=rh,I.ONE_EM=24,I.OverscaledTileID=ku,I.Point=ht,I.Point$1=ht,I.Properties=Ru,I.Protobuf=th,I.RGBAImage=Cu,I.RequestManager=qt,I.RequestPerformance=q0,I.ResourceType=Zr,I.SegmentVector=Be,I.SourceFeatureState=Kp,I.StructArrayLayout1ui2=zp,I.StructArrayLayout2f1f2i16=Xf,I.StructArrayLayout2i4=Wc,I.StructArrayLayout3ui6=Rs,I.StructArrayLayout4i8=hc,I.SymbolBucket=pr,I.Texture=Ni,I.Tile=Lu,I.Transitionable=Ts,I.Uniform1f=Kn,I.Uniform1i=Zn,I.Uniform2f=ci,I.Uniform3f=Oi,I.Uniform4f=na,I.UniformColor=ia,I.UniformMatrix4f=Qa,I.UnwrappedTileID=gv,I.ValidationError=ur,I.WritingMode=vi,I.ZoomHistory=Dp,I.add=function(f,d,y){return f[0]=d[0]+y[0],f[1]=d[1]+y[1],f[2]=d[2]+y[2],f},I.addDynamicAttributes=yr,I.asyncAll=function(f,d,y){if(!f.length)return y(null,[]);var T=f.length,O=new Array(f.length),N=null;f.forEach(function(Z,K){d(Z,function(mt,Ot){mt&&(N=mt),O[K]=Ot,--T==0&&y(N,O)})})},I.bezier=it,I.bindAll=It,I.browser=Te,I.cacheEntryPossiblyAdded=function(f){++Br>je&&(f.getActor().send("enforceCacheSizeLimit",Me),Br=0)},I.clamp=Zt,I.clearTileCache=function(f){var d=et.caches.delete("mapbox-tiles");f&&d.catch(f).then(function(){return f()})},I.clipLine=su,I.clone=function(f){var d=new Lo(16);return d[0]=f[0],d[1]=f[1],d[2]=f[2],d[3]=f[3],d[4]=f[4],d[5]=f[5],d[6]=f[6],d[7]=f[7],d[8]=f[8],d[9]=f[9],d[10]=f[10],d[11]=f[11],d[12]=f[12],d[13]=f[13],d[14]=f[14],d[15]=f[15],d},I.clone$1=be,I.clone$2=function(f){var d=new Lo(3);return d[0]=f[0],d[1]=f[1],d[2]=f[2],d},I.collisionCircleLayout=ic,I.config=ae,I.create=function(){var f=new Lo(16);return Lo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0),f[0]=1,f[5]=1,f[10]=1,f[15]=1,f},I.create$1=function(){var f=new Lo(9);return Lo!=Float32Array&&(f[1]=0,f[2]=0,f[3]=0,f[5]=0,f[6]=0,f[7]=0),f[0]=1,f[4]=1,f[8]=1,f},I.create$2=function(){var f=new Lo(4);return Lo!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f},I.createCommonjsModule=Et,I.createExpression=vh,I.createLayout=os,I.createStyleLayer=function(f){return f.type==="custom"?new mi(f):new pi[f.type](f)},I.cross=function(f,d,y){var T=d[0],O=d[1],N=d[2],Z=y[0],K=y[1],mt=y[2];return f[0]=O*mt-N*K,f[1]=N*Z-T*mt,f[2]=T*K-O*Z,f},I.deepEqual=function f(d,y){if(Array.isArray(d)){if(!Array.isArray(y)||d.length!==y.length)return!1;for(var T=0;T<d.length;T++)if(!f(d[T],y[T]))return!1;return!0}if(typeof d=="object"&&d!==null&&y!==null){if(typeof y!="object"||Object.keys(d).length!==Object.keys(y).length)return!1;for(var O in d)if(!f(d[O],y[O]))return!1;return!0}return d===y},I.dot=function(f,d){return f[0]*d[0]+f[1]*d[1]+f[2]*d[2]},I.dot$1=function(f,d){return f[0]*d[0]+f[1]*d[1]+f[2]*d[2]+f[3]*d[3]},I.ease=st,I.emitValidationErrors=rp,I.endsWith=rt,I.enforceCacheSizeLimit=function(f){Qe(),Mt&&Mt.then(function(d){d.keys().then(function(y){for(var T=0;T<y.length-f;T++)d.delete(y[T])})})},I.evaluateSizeForFeature=wa,I.evaluateSizeForZoom=Da,I.evaluateVariableOffset=Po,I.evented=bd,I.extend=b,I.featureFilter=Op,I.filterObject=Ae,I.fromRotation=function(f,d){var y=Math.sin(d),T=Math.cos(d);return f[0]=T,f[1]=y,f[2]=0,f[3]=-y,f[4]=T,f[5]=0,f[6]=0,f[7]=0,f[8]=1,f},I.getAnchorAlignment=Mi,I.getAnchorJustification=Je,I.getArrayBuffer=wn,I.getImage=Yt,I.getJSON=function(f,d){return jn(b(f,{type:"json"}),d)},I.getRTLTextPluginStatus=Ed,I.getReferrer=rn,I.getVideo=function(f,d){var y,T,O=et.document.createElement("video");O.muted=!0,O.onloadstart=function(){d(null,O)};for(var N=0;N<f.length;N++){var Z=et.document.createElement("source");y=f[N],T=void 0,(T=et.document.createElement("a")).href=y,(T.protocol!==et.document.location.protocol||T.host!==et.document.location.host)&&(O.crossOrigin="Anonymous"),Z.src=f[N],O.appendChild(Z)}return{cancel:function(){}}},I.identity=wl,I.invert=function(f,d){var y=d[0],T=d[1],O=d[2],N=d[3],Z=d[4],K=d[5],mt=d[6],Ot=d[7],Gt=d[8],Kt=d[9],pe=d[10],Fe=d[11],sr=d[12],lr=d[13],Cr=d[14],gr=d[15],Ur=y*K-T*Z,Ar=y*mt-O*Z,Dr=y*Ot-N*Z,mn=T*mt-O*K,Fn=T*Ot-N*K,ni=O*Ot-N*mt,ki=Gt*lr-Kt*sr,oa=Gt*Cr-pe*sr,Di=Gt*gr-Fe*sr,ca=Kt*Cr-pe*lr,zi=Kt*gr-Fe*lr,Oa=pe*gr-Fe*Cr,xa=Ur*Oa-Ar*zi+Dr*ca+mn*Di-Fn*oa+ni*ki;return xa?(f[0]=(K*Oa-mt*zi+Ot*ca)*(xa=1/xa),f[1]=(O*zi-T*Oa-N*ca)*xa,f[2]=(lr*ni-Cr*Fn+gr*mn)*xa,f[3]=(pe*Fn-Kt*ni-Fe*mn)*xa,f[4]=(mt*Di-Z*Oa-Ot*oa)*xa,f[5]=(y*Oa-O*Di+N*oa)*xa,f[6]=(Cr*Dr-sr*ni-gr*Ar)*xa,f[7]=(Gt*ni-pe*Dr+Fe*Ar)*xa,f[8]=(Z*zi-K*Di+Ot*ki)*xa,f[9]=(T*Di-y*zi-N*ki)*xa,f[10]=(sr*Fn-lr*Dr+gr*Ur)*xa,f[11]=(Kt*Dr-Gt*Fn-Fe*Ur)*xa,f[12]=(K*oa-Z*ca-mt*ki)*xa,f[13]=(y*ca-T*oa+O*ki)*xa,f[14]=(lr*Ar-sr*mn-Cr*Ur)*xa,f[15]=(Gt*mn-Kt*Ar+pe*Ur)*xa,f):null},I.isChar=Ai,I.isMapboxURL=$t,I.keysDifference=function(f,d){var y=[];for(var T in f)T in d||y.push(T);return y},I.makeRequest=jn,I.mapObject=Dt,I.mercatorXfromLng=lf,I.mercatorYfromLat=Zl,I.mercatorZfromAltitude=Y0,I.mul=Kc,I.multiply=Ku,I.mvt=rc,I.nextPowerOfTwo=function(f){return f<=1?1:Math.pow(2,Math.ceil(Math.log(f)/Math.LN2))},I.normalize=function(f,d){var y=d[0],T=d[1],O=d[2],N=y*y+T*T+O*O;return N>0&&(N=1/Math.sqrt(N)),f[0]=d[0]*N,f[1]=d[1]*N,f[2]=d[2]*N,f},I.number=Fo,I.offscreenCanvasSupported=Lr,I.ortho=function(f,d,y,T,O,N,Z){var K=1/(d-y),mt=1/(T-O),Ot=1/(N-Z);return f[0]=-2*K,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=-2*mt,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=2*Ot,f[11]=0,f[12]=(d+y)*K,f[13]=(O+T)*mt,f[14]=(Z+N)*Ot,f[15]=1,f},I.parseGlyphPBF=function(f){return new th(f).readFields(ui,[])},I.pbf=th,I.performSymbolLayout=function(f,d,y,T,O,N,Z){f.createArrays(),f.tilePixelRatio=8192/(512*f.overscaling),f.compareText={},f.iconsNeedLinear=!1;var K=f.layers[0].layout,mt=f.layers[0]._unevaluatedLayout._values,Ot={};if(f.textSizeData.kind==="composite"){var Gt=f.textSizeData,Kt=Gt.maxZoom;Ot.compositeTextSizes=[mt["text-size"].possiblyEvaluate(new Ka(Gt.minZoom),Z),mt["text-size"].possiblyEvaluate(new Ka(Kt),Z)]}if(f.iconSizeData.kind==="composite"){var pe=f.iconSizeData,Fe=pe.maxZoom;Ot.compositeIconSizes=[mt["icon-size"].possiblyEvaluate(new Ka(pe.minZoom),Z),mt["icon-size"].possiblyEvaluate(new Ka(Fe),Z)]}Ot.layoutTextSize=mt["text-size"].possiblyEvaluate(new Ka(f.zoom+1),Z),Ot.layoutIconSize=mt["icon-size"].possiblyEvaluate(new Ka(f.zoom+1),Z),Ot.textMaxSize=mt["text-size"].possiblyEvaluate(new Ka(18));for(var sr=24*K.get("text-line-height"),lr=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",Cr=K.get("text-keep-upright"),gr=K.get("text-size"),Ur=function(){var mn=Dr[Ar],Fn=K.get("text-font").evaluate(mn,{},Z).join(","),ni=gr.evaluate(mn,{},Z),ki=Ot.layoutTextSize.evaluate(mn,{},Z),oa=Ot.layoutIconSize.evaluate(mn,{},Z),Di={horizontal:{},vertical:void 0},ca=mn.text,zi=[0,0];if(ca){var Oa=ca.toString(),xa=24*K.get("text-letter-spacing").evaluate(mn,{},Z),Qi=function(ro){for(var va=0,ts=ro;va<ts.length;va+=1)if(Do=ts[va].charCodeAt(0),Ai.Arabic(Do)||Ai["Arabic Supplement"](Do)||Ai["Arabic Extended-A"](Do)||Ai["Arabic Presentation Forms-A"](Do)||Ai["Arabic Presentation Forms-B"](Do))return!1;var Do;return!0}(Oa)?xa:0,lo=K.get("text-anchor").evaluate(mn,{},Z),Ja=K.get("text-variable-anchor");if(!Ja){var To=K.get("text-radial-offset").evaluate(mn,{},Z);zi=To?Po(lo,[24*To,wo]):K.get("text-offset").evaluate(mn,{},Z).map(function(ro){return 24*ro})}var ea=lr?"center":K.get("text-justify").evaluate(mn,{},Z),Zo=K.get("symbol-placement"),Es=Zo==="point"?24*K.get("text-max-width").evaluate(mn,{},Z):0,uu=function(){f.allowVerticalPlacement&&Hf(Oa)&&(Di.vertical=Ti(ca,d,y,O,Fn,Es,sr,lo,"left",Qi,zi,vi.vertical,!0,Zo,ki,ni))};if(!lr&&Ja){for(var Ws=ea==="auto"?Ja.map(function(ro){return Je(ro)}):[ea],ks=!1,eu=0;eu<Ws.length;eu++){var Qu=Ws[eu];if(!Di.horizontal[Qu])if(ks)Di.horizontal[Qu]=Di.horizontal[0];else{var lu=Ti(ca,d,y,O,Fn,Es,sr,"center",Qu,Qi,zi,vi.horizontal,!1,Zo,ki,ni);lu&&(Di.horizontal[Qu]=lu,ks=lu.positionedLines.length===1)}}uu()}else{ea==="auto"&&(ea=Je(lo));var Gl=Ti(ca,d,y,O,Fn,Es,sr,lo,ea,Qi,zi,vi.horizontal,!1,Zo,ki,ni);Gl&&(Di.horizontal[ea]=Gl),uu(),Hf(Oa)&&lr&&Cr&&(Di.vertical=Ti(ca,d,y,O,Fn,Es,sr,lo,ea,Qi,zi,vi.vertical,!1,Zo,ki,ni))}}var us=void 0,Hl=!1;if(mn.icon&&mn.icon.name){var mu=T[mn.icon.name];mu&&(us=function(ro,va,ts){var Do=Mi(ts),jl=va[0]-ro.displaySize[0]*Do.horizontalAlign,Uu=va[1]-ro.displaySize[1]*Do.verticalAlign;return{image:ro,top:Uu,bottom:Uu+ro.displaySize[1],left:jl,right:jl+ro.displaySize[0]}}(O[mn.icon.name],K.get("icon-offset").evaluate(mn,{},Z),K.get("icon-anchor").evaluate(mn,{},Z)),Hl=mu.sdf,f.sdfIcons===void 0?f.sdfIcons=mu.sdf:f.sdfIcons!==mu.sdf&&ee("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mu.pixelRatio!==f.pixelRatio||K.get("icon-rotate").constantOr(1)!==0)&&(f.iconsNeedLinear=!0))}var cu=en(Di.horizontal)||Di.vertical;f.iconsInText=!!cu&&cu.iconsInText,(cu||us)&&function(ro,va,ts,Do,jl,Uu,ws,Pu,fu,Oo,cf){var ff=Uu.textMaxSize.evaluate(va,{});ff===void 0&&(ff=ws);var nh,ru=ro.layers[0].layout,kh=ru.get("icon-offset").evaluate(va,{},cf),fl=en(ts.horizontal),Qp=ws/24,Pl=ro.tilePixelRatio*Qp,Lf=ro.tilePixelRatio*ff/24,ih=ro.tilePixelRatio*Pu,Nd=ro.tilePixelRatio*ru.get("symbol-spacing"),a0=ru.get("text-padding")*ro.tilePixelRatio,fp=ru.get("icon-padding")*ro.tilePixelRatio,yv=ru.get("text-max-angle")/180*Math.PI,zd=ru.get("text-rotation-alignment")==="map"&&ru.get("symbol-placement")!=="point",_v=ru.get("icon-rotation-alignment")==="map"&&ru.get("symbol-placement")!=="point",yc=ru.get("symbol-placement"),hp=Nd/2,Zu=ru.get("icon-text-fit");Do&&Zu!=="none"&&(ro.allowVerticalPlacement&&ts.vertical&&(nh=Yn(Do,ts.vertical,Zu,ru.get("icon-text-fit-padding"),kh,Qp)),fl&&(Do=Yn(Do,fl,Zu,ru.get("icon-text-fit-padding"),kh,Qp)));var pp=function(_c,hf){hf.x<0||hf.x>=8192||hf.y<0||hf.y>=8192||function(Va,Ju,Y_,mp,J0,jg,s0,Fc,ah,Lh,tg,u0,eg,Xm,l0,Wg,Wl,Ym,$m,qm,Rc,rg,yp,pf,Xg){var Tv,Pf,Ph,rd,_p,xp=Va.addToLineVertexArray(Ju,Y_),c0=0,Oh=0,Vd=0,Gd=0,Mv=-1,Fh=-1,Dc={},Iv=rr(""),Ol=0,kv=0;if(Fc._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ol=(Tv=Fc.layout.get("text-offset").evaluate(Rc,{},pf).map(function(bp){return 24*bp}))[0],kv=Tv[1]):(Ol=24*Fc.layout.get("text-radial-offset").evaluate(Rc,{},pf),kv=wo),Va.allowVerticalPlacement&&mp.vertical){var Lv=Fc.layout.get("text-rotate").evaluate(Rc,{},pf)+90;rd=new tu(ah,Ju,Lh,tg,u0,mp.vertical,eg,Xm,l0,Lv),s0&&(_p=new tu(ah,Ju,Lh,tg,u0,s0,Wl,Ym,l0,Lv))}if(J0){var Rh=Fc.layout.get("icon-rotate").evaluate(Rc,{}),Yg=Fc.layout.get("icon-text-fit")!=="none",$g=Tu(J0,Rh,yp,Yg),qg=s0?Tu(s0,Rh,yp,Yg):void 0;Ph=new tu(ah,Ju,Lh,tg,u0,J0,Wl,Ym,!1,Rh),c0=4*$g.length;var Kg=Va.iconSizeData,Pv=null;Kg.kind==="source"?(Pv=[128*Fc.layout.get("icon-size").evaluate(Rc,{})])[0]>32640&&ee(Va.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Kg.kind==="composite"&&((Pv=[128*rg.compositeIconSizes[0].evaluate(Rc,{},pf),128*rg.compositeIconSizes[1].evaluate(Rc,{},pf)])[0]>32640||Pv[1]>32640)&&ee(Va.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Va.addSymbols(Va.icon,$g,Pv,qm,$m,Rc,!1,Ju,xp.lineStartIndex,xp.lineLength,-1,pf),Mv=Va.icon.placedSymbolArray.length-1,qg&&(Oh=4*qg.length,Va.addSymbols(Va.icon,qg,Pv,qm,$m,Rc,vi.vertical,Ju,xp.lineStartIndex,xp.lineLength,-1,pf),Fh=Va.icon.placedSymbolArray.length-1)}for(var Ov in mp.horizontal){var Fv=mp.horizontal[Ov];if(!Pf){Iv=rr(Fv.text);var $_=Fc.layout.get("text-rotate").evaluate(Rc,{},pf);Pf=new tu(ah,Ju,Lh,tg,u0,Fv,eg,Xm,l0,$_)}var Of=Fv.positionedLines.length===1;if(Vd+=an(Va,Ju,Fv,jg,Fc,l0,Rc,Wg,xp,mp.vertical?vi.horizontal:vi.horizontalOnly,Of?Object.keys(mp.horizontal):[Ov],Dc,Mv,rg,pf),Of)break}mp.vertical&&(Gd+=an(Va,Ju,mp.vertical,jg,Fc,l0,Rc,Wg,xp,vi.vertical,["vertical"],Dc,Fh,rg,pf));var Km=Pf?Pf.boxStartIndex:Va.collisionBoxArray.length,q_=Pf?Pf.boxEndIndex:Va.collisionBoxArray.length,ng=rd?rd.boxStartIndex:Va.collisionBoxArray.length,K_=rd?rd.boxEndIndex:Va.collisionBoxArray.length,Hd=Ph?Ph.boxStartIndex:Va.collisionBoxArray.length,ig=Ph?Ph.boxEndIndex:Va.collisionBoxArray.length,ag=_p?_p.boxStartIndex:Va.collisionBoxArray.length,Qg=_p?_p.boxEndIndex:Va.collisionBoxArray.length,Ls=-1,df=function(bp,sg){return bp&&bp.circleDiameter?Math.max(bp.circleDiameter,sg):sg};Ls=df(Pf,Ls),Ls=df(rd,Ls),Ls=df(Ph,Ls);var og=(Ls=df(_p,Ls))>-1?1:0;og&&(Ls*=Xg/24),Va.glyphOffsetArray.length>=pr.MAX_GLYPHS&&ee("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Rc.sortKey!==void 0&&Va.addToSortKeyRanges(Va.symbolInstances.length,Rc.sortKey),Va.symbolInstances.emplaceBack(Ju.x,Ju.y,Dc.right>=0?Dc.right:-1,Dc.center>=0?Dc.center:-1,Dc.left>=0?Dc.left:-1,Dc.vertical||-1,Mv,Fh,Iv,Km,q_,ng,K_,Hd,ig,ag,Qg,Lh,Vd,Gd,c0,Oh,og,0,eg,Ol,kv,Ls)}(ro,hf,_c,ts,Do,jl,nh,ro.layers[0],ro.collisionBoxArray,va.index,va.sourceLayerIndex,ro.index,Pl,a0,zd,fu,ih,fp,_v,kh,va,Uu,Oo,cf,ws)};if(yc==="line")for(var Jp=0,Ud=su(va.geometry,0,0,8192,8192);Jp<Ud.length;Jp+=1)for(var Zd=Ud[Jp],xv=0,bv=Qs(Zd,Nd,yv,ts.vertical||fl,Do,24,Lf,ro.overscaling,8192);xv<bv.length;xv+=1){var Ev=bv[xv];fl&&Ri(ro,fl.text,hp,Ev)||pp(Zd,Ev)}else if(yc==="line-center")for(var wv=0,td=va.geometry;wv<td.length;wv+=1){var Sv=td[wv];if(Sv.length>1){var o0=Xo(Sv,yv,ts.vertical||fl,Do,24,Lf);o0&&pp(Sv,o0)}}else if(va.type==="Polygon")for(var Us=0,Jt=rf(va.geometry,0);Us<Jt.length;Us+=1){var dp=Jt[Us],Cv=ya(dp,16);pp(dp[0],new Ii(Cv.x,Cv.y,0))}else if(va.type==="LineString")for(var vp=0,Av=va.geometry;vp<Av.length;vp+=1){var gp=Av[vp];pp(gp,new Ii(gp[0].x,gp[0].y,0))}else if(va.type==="Point")for(var K0=0,Q0=va.geometry;K0<Q0.length;K0+=1)for(var ed=0,Wm=Q0[K0];ed<Wm.length;ed+=1){var Hg=Wm[ed];pp([Hg],new Ii(Hg.x,Hg.y,0))}}(f,mn,Di,us,T,Ot,ki,oa,zi,Hl,Z)},Ar=0,Dr=f.features;Ar<Dr.length;Ar+=1)Ur();N&&f.generateCollisionDebugBuffers()},I.perspective=function(f,d,y,T,O){var N,Z=1/Math.tan(d/2);return f[0]=Z/y,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=Z,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[11]=-1,f[12]=0,f[13]=0,f[15]=0,O!=null&&O!==1/0?(f[10]=(O+T)*(N=1/(T-O)),f[14]=2*O*T*N):(f[10]=-1,f[14]=-2*T),f},I.pick=function(f,d){for(var y={},T=0;T<d.length;T++){var O=d[T];O in f&&(y[O]=f[O])}return y},I.plugin=Ko,I.polygonIntersectsPolygon=kc,I.postMapLoadEvent=Wt,I.postTurnstileEvent=Xt,I.potpack=ri,I.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],I.register=Zi,I.registerForPluginStateChange=function(f){return f({pluginStatus:_l,pluginURL:sa}),bd.on("pluginStateChange",f),f},I.renderColorRamp=Sd,I.rotate=function(f,d,y){var T=d[0],O=d[1],N=d[2],Z=d[3],K=Math.sin(y),mt=Math.cos(y);return f[0]=T*mt+N*K,f[1]=O*mt+Z*K,f[2]=T*-K+N*mt,f[3]=O*-K+Z*mt,f},I.rotateX=function(f,d,y){var T=Math.sin(y),O=Math.cos(y),N=d[4],Z=d[5],K=d[6],mt=d[7],Ot=d[8],Gt=d[9],Kt=d[10],pe=d[11];return d!==f&&(f[0]=d[0],f[1]=d[1],f[2]=d[2],f[3]=d[3],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]),f[4]=N*O+Ot*T,f[5]=Z*O+Gt*T,f[6]=K*O+Kt*T,f[7]=mt*O+pe*T,f[8]=Ot*O-N*T,f[9]=Gt*O-Z*T,f[10]=Kt*O-K*T,f[11]=pe*O-mt*T,f},I.rotateZ=function(f,d,y){var T=Math.sin(y),O=Math.cos(y),N=d[0],Z=d[1],K=d[2],mt=d[3],Ot=d[4],Gt=d[5],Kt=d[6],pe=d[7];return d!==f&&(f[8]=d[8],f[9]=d[9],f[10]=d[10],f[11]=d[11],f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15]),f[0]=N*O+Ot*T,f[1]=Z*O+Gt*T,f[2]=K*O+Kt*T,f[3]=mt*O+pe*T,f[4]=Ot*O-N*T,f[5]=Gt*O-Z*T,f[6]=Kt*O-K*T,f[7]=pe*O-mt*T,f},I.scale=function(f,d,y){var T=y[0],O=y[1],N=y[2];return f[0]=d[0]*T,f[1]=d[1]*T,f[2]=d[2]*T,f[3]=d[3]*T,f[4]=d[4]*O,f[5]=d[5]*O,f[6]=d[6]*O,f[7]=d[7]*O,f[8]=d[8]*N,f[9]=d[9]*N,f[10]=d[10]*N,f[11]=d[11]*N,f[12]=d[12],f[13]=d[13],f[14]=d[14],f[15]=d[15],f},I.scale$1=function(f,d,y){return f[0]=d[0]*y,f[1]=d[1]*y,f[2]=d[2]*y,f[3]=d[3]*y,f},I.scale$2=function(f,d,y){return f[0]=d[0]*y,f[1]=d[1]*y,f[2]=d[2]*y,f},I.setCacheLimits=function(f,d){Me=f,je=d},I.setRTLTextPlugin=function(f,d,y){if(y===void 0&&(y=!1),_l==="deferred"||_l==="loading"||_l==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");sa=Te.resolveURL(f),_l="deferred",fc=d,Np(),y||Ml()},I.sphericalToCartesian=function(f){var d=f[0],y=f[1],T=f[2];return y+=90,y*=Math.PI/180,T*=Math.PI/180,{x:d*Math.cos(y)*Math.sin(T),y:d*Math.sin(y)*Math.sin(T),z:d*Math.cos(T)}},I.sqrLen=function(f){var d=f[0],y=f[1];return d*d+y*y},I.styleSpec=Pe,I.sub=function(f,d,y){return f[0]=d[0]-y[0],f[1]=d[1]-y[1],f[2]=d[2]-y[2],f},I.symbolSize=oo,I.transformMat3=function(f,d,y){var T=d[0],O=d[1],N=d[2];return f[0]=T*y[0]+O*y[3]+N*y[6],f[1]=T*y[1]+O*y[4]+N*y[7],f[2]=T*y[2]+O*y[5]+N*y[8],f},I.transformMat4=$f,I.translate=function(f,d,y){var T,O,N,Z,K,mt,Ot,Gt,Kt,pe,Fe,sr,lr=y[0],Cr=y[1],gr=y[2];return d===f?(f[12]=d[0]*lr+d[4]*Cr+d[8]*gr+d[12],f[13]=d[1]*lr+d[5]*Cr+d[9]*gr+d[13],f[14]=d[2]*lr+d[6]*Cr+d[10]*gr+d[14],f[15]=d[3]*lr+d[7]*Cr+d[11]*gr+d[15]):(O=d[1],N=d[2],Z=d[3],K=d[4],mt=d[5],Ot=d[6],Gt=d[7],Kt=d[8],pe=d[9],Fe=d[10],sr=d[11],f[0]=T=d[0],f[1]=O,f[2]=N,f[3]=Z,f[4]=K,f[5]=mt,f[6]=Ot,f[7]=Gt,f[8]=Kt,f[9]=pe,f[10]=Fe,f[11]=sr,f[12]=T*lr+K*Cr+Kt*gr+d[12],f[13]=O*lr+mt*Cr+pe*gr+d[13],f[14]=N*lr+Ot*Cr+Fe*gr+d[14],f[15]=Z*lr+Gt*Cr+sr*gr+d[15]),f},I.triggerPluginCompletionEvent=Bp,I.uniqueId=le,I.validateCustomStyleLayer=function(f){var d=[],y=f.id;return y===void 0&&d.push({message:"layers."+y+': missing required property "id"'}),f.render===void 0&&d.push({message:"layers."+y+': missing required method "render"'}),f.renderingMode&&f.renderingMode!=="2d"&&f.renderingMode!=="3d"&&d.push({message:"layers."+y+': property "renderingMode" must be either "2d" or "3d"'}),d},I.validateLight=xd,I.validateStyle=tp,I.values=function(f){var d=[];for(var y in f)d.push(f[y]);return d},I.vectorTile=rc,I.version="1.13.2",I.warnOnce=ee,I.webpSupported=Ke,I.window=et,I.wrap=P}),wt(["./shared"],function(I){"use strict";function Et(Bt){var Yt=typeof Bt;if(Yt==="number"||Yt==="boolean"||Yt==="string"||Bt==null)return JSON.stringify(Bt);if(Array.isArray(Bt)){for(var oe="[",Ce=0,Ue=Bt;Ce<Ue.length;Ce+=1)oe+=Et(Ue[Ce])+",";return oe+"]"}for(var fr=Object.keys(Bt).sort(),Sr="{",Pe=0;Pe<fr.length;Pe++)Sr+=JSON.stringify(fr[Pe])+":"+Et(Bt[fr[Pe]])+",";return Sr+"}"}function q(Bt){for(var Yt="",oe=0,Ce=I.refProperties;oe<Ce.length;oe+=1)Yt+="/"+Et(Bt[Ce[oe]]);return Yt}var lt=function(Bt){this.keyCache={},Bt&&this.replace(Bt)};lt.prototype.replace=function(Bt){this._layerConfigs={},this._layers={},this.update(Bt,[])},lt.prototype.update=function(Bt,Yt){for(var oe=this,Ce=0,Ue=Bt;Ce<Ue.length;Ce+=1){var fr=Ue[Ce];this._layerConfigs[fr.id]=fr;var Sr=this._layers[fr.id]=I.createStyleLayer(fr);Sr._featureFilter=I.featureFilter(Sr.filter),this.keyCache[fr.id]&&delete this.keyCache[fr.id]}for(var Pe=0,ur=Yt;Pe<ur.length;Pe+=1){var Wr=ur[Pe];delete this.keyCache[Wr],delete this._layerConfigs[Wr],delete this._layers[Wr]}this.familiesBySource={};for(var Sn=0,qr=function(li,hi){for(var ra={},Ci=0;Ci<li.length;Ci++){var Ba=hi&&hi[li[Ci].id]||q(li[Ci]);hi&&(hi[li[Ci].id]=Ba);var po=ra[Ba];po||(po=ra[Ba]=[]),po.push(li[Ci])}var za=[];for(var Xa in ra)za.push(ra[Xa]);return za}(I.values(this._layerConfigs),this.keyCache);Sn<qr.length;Sn+=1){var Qr=qr[Sn].map(function(li){return oe._layers[li.id]}),Mn=Qr[0];if(Mn.visibility!=="none"){var bi=Mn.source||"",Si=this.familiesBySource[bi];Si||(Si=this.familiesBySource[bi]={});var Kr=Mn.sourceLayer||"_geojsonTileLayer",ai=Si[Kr];ai||(ai=Si[Kr]=[]),ai.push(Qr)}}};var ht=function(Bt){var Yt={},oe=[];for(var Ce in Bt){var Ue=Bt[Ce],fr=Yt[Ce]={};for(var Sr in Ue){var Pe=Ue[+Sr];if(Pe&&Pe.bitmap.width!==0&&Pe.bitmap.height!==0){var ur={x:0,y:0,w:Pe.bitmap.width+2,h:Pe.bitmap.height+2};oe.push(ur),fr[Sr]={rect:ur,metrics:Pe.metrics}}}}var Wr=I.potpack(oe),Sn=new I.AlphaImage({width:Wr.w||1,height:Wr.h||1});for(var qr in Bt){var Qr=Bt[qr];for(var Mn in Qr){var bi=Qr[+Mn];if(bi&&bi.bitmap.width!==0&&bi.bitmap.height!==0){var Si=Yt[qr][Mn].rect;I.AlphaImage.copy(bi.bitmap,Sn,{x:0,y:0},{x:Si.x+1,y:Si.y+1},bi.bitmap)}}}this.image=Sn,this.positions=Yt};I.register("GlyphAtlas",ht);var ct=function(Bt){this.tileID=new I.OverscaledTileID(Bt.tileID.overscaledZ,Bt.tileID.wrap,Bt.tileID.canonical.z,Bt.tileID.canonical.x,Bt.tileID.canonical.y),this.uid=Bt.uid,this.zoom=Bt.zoom,this.pixelRatio=Bt.pixelRatio,this.tileSize=Bt.tileSize,this.source=Bt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Bt.showCollisionBoxes,this.collectResourceTiming=!!Bt.collectResourceTiming,this.returnDependencies=!!Bt.returnDependencies,this.promoteId=Bt.promoteId};function et(Bt,Yt,oe){for(var Ce=new I.EvaluationParameters(Yt),Ue=0,fr=Bt;Ue<fr.length;Ue+=1)fr[Ue].recalculate(Ce,oe)}function Ee(Bt,Yt){var oe=I.getArrayBuffer(Bt.request,function(Ce,Ue,fr,Sr){Ce?Yt(Ce):Ue&&Yt(null,{vectorTile:new I.vectorTile.VectorTile(new I.pbf(Ue)),rawData:Ue,cacheControl:fr,expires:Sr})});return function(){oe.cancel(),Yt()}}ct.prototype.parse=function(Bt,Yt,oe,Ce,Ue){var fr=this;this.status="parsing",this.data=Bt,this.collisionBoxArray=new I.CollisionBoxArray;var Sr=new I.DictionaryCoder(Object.keys(Bt.layers).sort()),Pe=new I.FeatureIndex(this.tileID,this.promoteId);Pe.bucketLayerIDs=[];var ur,Wr,Sn,qr,Qr={},Mn={featureIndex:Pe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe},bi=Yt.familiesBySource[this.source];for(var Si in bi){var Kr=Bt.layers[Si];if(Kr){Kr.version===1&&I.warnOnce('Vector tile source "'+this.source+'" layer "'+Si+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var ai=Sr.encode(Si),li=[],hi=0;hi<Kr.length;hi++){var ra=Kr.feature(hi),Ci=Pe.getId(ra,Si);li.push({feature:ra,id:Ci,index:hi,sourceLayerIndex:ai})}for(var Ba=0,po=bi[Si];Ba<po.length;Ba+=1){var za=po[Ba],Xa=za[0];Xa.minzoom&&this.zoom<Math.floor(Xa.minzoom)||Xa.maxzoom&&this.zoom>=Xa.maxzoom||Xa.visibility!=="none"&&(et(za,this.zoom,oe),(Qr[Xa.id]=Xa.createBucket({index:Pe.bucketLayerIDs.length,layers:za,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ai,sourceID:this.source})).populate(li,Mn,this.tileID.canonical),Pe.bucketLayerIDs.push(za.map(function(vo){return vo.id})))}}}var Ta=I.mapObject(Mn.glyphDependencies,function(vo){return Object.keys(vo).map(Number)});Object.keys(Ta).length?Ce.send("getGlyphs",{uid:this.uid,stacks:Ta},function(vo,ja){ur||(ur=vo,Wr=ja,Vo.call(fr))}):Wr={};var ga=Object.keys(Mn.iconDependencies);ga.length?Ce.send("getImages",{icons:ga,source:this.source,tileID:this.tileID,type:"icons"},function(vo,ja){ur||(ur=vo,Sn=ja,Vo.call(fr))}):Sn={};var no=Object.keys(Mn.patternDependencies);function Vo(){if(ur)return Ue(ur);if(Wr&&Sn&&qr){var vo=new ht(Wr),ja=new I.ImageAtlas(Sn,qr);for(var to in Qr){var Uo=Qr[to];Uo instanceof I.SymbolBucket?(et(Uo.layers,this.zoom,oe),I.performSymbolLayout(Uo,Wr,vo.positions,Sn,ja.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Uo.hasPattern&&(Uo instanceof I.LineBucket||Uo instanceof I.FillBucket||Uo instanceof I.FillExtrusionBucket)&&(et(Uo.layers,this.zoom,oe),Uo.addFeatures(Mn,this.tileID.canonical,ja.patternPositions))}this.status="done",Ue(null,{buckets:I.values(Qr).filter(function(ju){return!ju.isEmpty()}),featureIndex:Pe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:vo.image,imageAtlas:ja,glyphMap:this.returnDependencies?Wr:null,iconMap:this.returnDependencies?Sn:null,glyphPositions:this.returnDependencies?vo.positions:null})}}no.length?Ce.send("getImages",{icons:no,source:this.source,tileID:this.tileID,type:"patterns"},function(vo,ja){ur||(ur=vo,qr=ja,Vo.call(fr))}):qr={},Vo.call(this)};var it=function(Bt,Yt,oe,Ce){this.actor=Bt,this.layerIndex=Yt,this.availableImages=oe,this.loadVectorData=Ce||Ee,this.loading={},this.loaded={}};it.prototype.loadTile=function(Bt,Yt){var oe=this,Ce=Bt.uid;this.loading||(this.loading={});var Ue=!!(Bt&&Bt.request&&Bt.request.collectResourceTiming)&&new I.RequestPerformance(Bt.request),fr=this.loading[Ce]=new ct(Bt);fr.abort=this.loadVectorData(Bt,function(Sr,Pe){if(delete oe.loading[Ce],Sr||!Pe)return fr.status="done",oe.loaded[Ce]=fr,Yt(Sr);var ur=Pe.rawData,Wr={};Pe.expires&&(Wr.expires=Pe.expires),Pe.cacheControl&&(Wr.cacheControl=Pe.cacheControl);var Sn={};if(Ue){var qr=Ue.finish();qr&&(Sn.resourceTiming=JSON.parse(JSON.stringify(qr)))}fr.vectorTile=Pe.vectorTile,fr.parse(Pe.vectorTile,oe.layerIndex,oe.availableImages,oe.actor,function(Qr,Mn){if(Qr||!Mn)return Yt(Qr);Yt(null,I.extend({rawTileData:ur.slice(0)},Mn,Wr,Sn))}),oe.loaded=oe.loaded||{},oe.loaded[Ce]=fr})},it.prototype.reloadTile=function(Bt,Yt){var oe=this,Ce=this.loaded,Ue=Bt.uid,fr=this;if(Ce&&Ce[Ue]){var Sr=Ce[Ue];Sr.showCollisionBoxes=Bt.showCollisionBoxes;var Pe=function(ur,Wr){var Sn=Sr.reloadCallback;Sn&&(delete Sr.reloadCallback,Sr.parse(Sr.vectorTile,fr.layerIndex,oe.availableImages,fr.actor,Sn)),Yt(ur,Wr)};Sr.status==="parsing"?Sr.reloadCallback=Pe:Sr.status==="done"&&(Sr.vectorTile?Sr.parse(Sr.vectorTile,this.layerIndex,this.availableImages,this.actor,Pe):Pe())}},it.prototype.abortTile=function(Bt,Yt){var oe=this.loading,Ce=Bt.uid;oe&&oe[Ce]&&oe[Ce].abort&&(oe[Ce].abort(),delete oe[Ce]),Yt()},it.prototype.removeTile=function(Bt,Yt){var oe=this.loaded,Ce=Bt.uid;oe&&oe[Ce]&&delete oe[Ce],Yt()};var st=I.window.ImageBitmap,Zt=function(){this.loaded={}};function P(Bt,Yt){if(Bt.length!==0){b(Bt[0],Yt);for(var oe=1;oe<Bt.length;oe++)b(Bt[oe],!Yt)}}function b(Bt,Yt){for(var oe=0,Ce=0,Ue=Bt.length,fr=Ue-1;Ce<Ue;fr=Ce++)oe+=(Bt[Ce][0]-Bt[fr][0])*(Bt[fr][1]+Bt[Ce][1]);oe>=0!=!!Yt&&Bt.reverse()}Zt.prototype.loadTile=function(Bt,Yt){var oe=Bt.uid,Ce=Bt.encoding,Ue=Bt.rawImageData,fr=st&&Ue instanceof st?this.getImageData(Ue):Ue,Sr=new I.DEMData(oe,fr,Ce);this.loaded=this.loaded||{},this.loaded[oe]=Sr,Yt(null,Sr)},Zt.prototype.getImageData=function(Bt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Bt.width,Bt.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Bt.width,this.offscreenCanvas.height=Bt.height,this.offscreenCanvasContext.drawImage(Bt,0,0,Bt.width,Bt.height);var Yt=this.offscreenCanvasContext.getImageData(-1,-1,Bt.width+2,Bt.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new I.RGBAImage({width:Yt.width,height:Yt.height},Yt.data)},Zt.prototype.removeTile=function(Bt){var Yt=this.loaded,oe=Bt.uid;Yt&&Yt[oe]&&delete Yt[oe]};var X=I.vectorTile.VectorTileFeature.prototype.toGeoJSON,le=function(Bt){this._feature=Bt,this.extent=I.EXTENT,this.type=Bt.type,this.properties=Bt.tags,"id"in Bt&&!isNaN(Bt.id)&&(this.id=parseInt(Bt.id,10))};le.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Bt=[],Yt=0,oe=this._feature.geometry;Yt<oe.length;Yt+=1){var Ce=oe[Yt];Bt.push([new I.Point$1(Ce[0],Ce[1])])}return Bt}for(var Ue=[],fr=0,Sr=this._feature.geometry;fr<Sr.length;fr+=1){for(var Pe=[],ur=0,Wr=Sr[fr];ur<Wr.length;ur+=1){var Sn=Wr[ur];Pe.push(new I.Point$1(Sn[0],Sn[1]))}Ue.push(Pe)}return Ue},le.prototype.toGeoJSON=function(Bt,Yt,oe){return X.call(this,Bt,Yt,oe)};var Se=function(Bt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=I.EXTENT,this.length=Bt.length,this._features=Bt};Se.prototype.feature=function(Bt){return new le(this._features[Bt])};var Ie=I.vectorTile.VectorTileFeature,It=rt;function rt(Bt,Yt){this.options=Yt||{},this.features=Bt,this.length=Bt.length}function Dt(Bt,Yt){this.id=typeof Bt.id=="number"?Bt.id:void 0,this.type=Bt.type,this.rawGeometry=Bt.type===1?[Bt.geometry]:Bt.geometry,this.properties=Bt.tags,this.extent=Yt||4096}rt.prototype.feature=function(Bt){return new Dt(this.features[Bt],this.options.extent)},Dt.prototype.loadGeometry=function(){var Bt=this.rawGeometry;this.geometry=[];for(var Yt=0;Yt<Bt.length;Yt++){for(var oe=Bt[Yt],Ce=[],Ue=0;Ue<oe.length;Ue++)Ce.push(new I.Point$1(oe[Ue][0],oe[Ue][1]));this.geometry.push(Ce)}return this.geometry},Dt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Bt=this.geometry,Yt=1/0,oe=-1/0,Ce=1/0,Ue=-1/0,fr=0;fr<Bt.length;fr++)for(var Sr=Bt[fr],Pe=0;Pe<Sr.length;Pe++){var ur=Sr[Pe];Yt=Math.min(Yt,ur.x),oe=Math.max(oe,ur.x),Ce=Math.min(Ce,ur.y),Ue=Math.max(Ue,ur.y)}return[Yt,Ce,oe,Ue]},Dt.prototype.toGeoJSON=Ie.prototype.toGeoJSON;var Ae=me,be=It;function me(Bt){var Yt=new I.pbf;return function(oe,Ce){for(var Ue in oe.layers)Ce.writeMessage(3,ee,oe.layers[Ue])}(Bt,Yt),Yt.finish()}function ee(Bt,Yt){var oe;Yt.writeVarintField(15,Bt.version||1),Yt.writeStringField(1,Bt.name||""),Yt.writeVarintField(5,Bt.extent||4096);var Ce={keys:[],values:[],keycache:{},valuecache:{}};for(oe=0;oe<Bt.length;oe++)Ce.feature=Bt.feature(oe),Yt.writeMessage(2,we,Ce);var Ue=Ce.keys;for(oe=0;oe<Ue.length;oe++)Yt.writeStringField(3,Ue[oe]);var fr=Ce.values;for(oe=0;oe<fr.length;oe++)Yt.writeMessage(4,vt,fr[oe])}function we(Bt,Yt){var oe=Bt.feature;oe.id!==void 0&&Yt.writeVarintField(1,oe.id),Yt.writeMessage(2,_e,Bt),Yt.writeVarintField(3,oe.type),Yt.writeMessage(4,J,oe)}function _e(Bt,Yt){var oe=Bt.feature,Ce=Bt.keys,Ue=Bt.values,fr=Bt.keycache,Sr=Bt.valuecache;for(var Pe in oe.properties){var ur=fr[Pe];ur===void 0&&(Ce.push(Pe),fr[Pe]=ur=Ce.length-1),Yt.writeVarint(ur);var Wr=oe.properties[Pe],Sn=typeof Wr;Sn!=="string"&&Sn!=="boolean"&&Sn!=="number"&&(Wr=JSON.stringify(Wr));var qr=Sn+":"+Wr,Qr=Sr[qr];Qr===void 0&&(Ue.push(Wr),Sr[qr]=Qr=Ue.length-1),Yt.writeVarint(Qr)}}function gt(Bt,Yt){return(Yt<<3)+(7&Bt)}function Pt(Bt){return Bt<<1^Bt>>31}function J(Bt,Yt){for(var oe=Bt.loadGeometry(),Ce=Bt.type,Ue=0,fr=0,Sr=oe.length,Pe=0;Pe<Sr;Pe++){var ur=oe[Pe],Wr=1;Ce===1&&(Wr=ur.length),Yt.writeVarint(gt(1,Wr));for(var Sn=Ce===3?ur.length-1:ur.length,qr=0;qr<Sn;qr++){qr===1&&Ce!==1&&Yt.writeVarint(gt(2,Sn-1));var Qr=ur[qr].x-Ue,Mn=ur[qr].y-fr;Yt.writeVarint(Pt(Qr)),Yt.writeVarint(Pt(Mn)),Ue+=Qr,fr+=Mn}Ce===3&&Yt.writeVarint(gt(7,1))}}function vt(Bt,Yt){var oe=typeof Bt;oe==="string"?Yt.writeStringField(1,Bt):oe==="boolean"?Yt.writeBooleanField(7,Bt):oe==="number"&&(Bt%1!=0?Yt.writeDoubleField(3,Bt):Bt<0?Yt.writeSVarintField(6,Bt):Yt.writeVarintField(5,Bt))}function W(Bt,Yt,oe,Ce){dt(Bt,oe,Ce),dt(Yt,2*oe,2*Ce),dt(Yt,2*oe+1,2*Ce+1)}function dt(Bt,Yt,oe){var Ce=Bt[Yt];Bt[Yt]=Bt[oe],Bt[oe]=Ce}function Vt(Bt,Yt,oe,Ce){var Ue=Bt-oe,fr=Yt-Ce;return Ue*Ue+fr*fr}Ae.fromVectorTileJs=me,Ae.fromGeojsonVt=function(Bt,Yt){Yt=Yt||{};var oe={};for(var Ce in Bt)oe[Ce]=new It(Bt[Ce].features,Yt),oe[Ce].name=Ce,oe[Ce].version=Yt.version,oe[Ce].extent=Yt.extent;return me({layers:oe})},Ae.GeoJSONWrapper=be;var ne=function(Bt){return Bt[0]},ge=function(Bt){return Bt[1]},$e=function(Bt,Yt,oe,Ce,Ue){Yt===void 0&&(Yt=ne),oe===void 0&&(oe=ge),Ce===void 0&&(Ce=64),Ue===void 0&&(Ue=Float64Array),this.nodeSize=Ce,this.points=Bt;for(var fr=Bt.length<65536?Uint16Array:Uint32Array,Sr=this.ids=new fr(Bt.length),Pe=this.coords=new Ue(2*Bt.length),ur=0;ur<Bt.length;ur++)Sr[ur]=ur,Pe[2*ur]=Yt(Bt[ur]),Pe[2*ur+1]=oe(Bt[ur]);(function Wr(Sn,qr,Qr,Mn,bi,Si){if(!(bi-Mn<=Qr)){var Kr=Mn+bi>>1;(function ai(li,hi,ra,Ci,Ba,po){for(;Ba>Ci;){if(Ba-Ci>600){var za=Ba-Ci+1,Xa=ra-Ci+1,Ta=Math.log(za),ga=.5*Math.exp(2*Ta/3),no=.5*Math.sqrt(Ta*ga*(za-ga)/za)*(Xa-za/2<0?-1:1);ai(li,hi,ra,Math.max(Ci,Math.floor(ra-Xa*ga/za+no)),Math.min(Ba,Math.floor(ra+(za-Xa)*ga/za+no)),po)}var Vo=hi[2*ra+po],vo=Ci,ja=Ba;for(W(li,hi,Ci,ra),hi[2*Ba+po]>Vo&&W(li,hi,Ci,Ba);vo<ja;){for(W(li,hi,vo,ja),vo++,ja--;hi[2*vo+po]<Vo;)vo++;for(;hi[2*ja+po]>Vo;)ja--}hi[2*Ci+po]===Vo?W(li,hi,Ci,ja):W(li,hi,++ja,Ba),ja<=ra&&(Ci=ja+1),ra<=ja&&(Ba=ja-1)}})(Sn,qr,Kr,Mn,bi,Si%2),Wr(Sn,qr,Qr,Mn,Kr-1,Si+1),Wr(Sn,qr,Qr,Kr+1,bi,Si+1)}})(Sr,Pe,Ce,0,Sr.length-1,0)};$e.prototype.range=function(Bt,Yt,oe,Ce){return function(Ue,fr,Sr,Pe,ur,Wr,Sn){for(var qr,Qr,Mn=[0,Ue.length-1,0],bi=[];Mn.length;){var Si=Mn.pop(),Kr=Mn.pop(),ai=Mn.pop();if(Kr-ai<=Sn)for(var li=ai;li<=Kr;li++)Qr=fr[2*li+1],(qr=fr[2*li])>=Sr&&qr<=ur&&Qr>=Pe&&Qr<=Wr&&bi.push(Ue[li]);else{var hi=Math.floor((ai+Kr)/2);Qr=fr[2*hi+1],(qr=fr[2*hi])>=Sr&&qr<=ur&&Qr>=Pe&&Qr<=Wr&&bi.push(Ue[hi]);var ra=(Si+1)%2;(Si===0?Sr<=qr:Pe<=Qr)&&(Mn.push(ai),Mn.push(hi-1),Mn.push(ra)),(Si===0?ur>=qr:Wr>=Qr)&&(Mn.push(hi+1),Mn.push(Kr),Mn.push(ra))}}return bi}(this.ids,this.coords,Bt,Yt,oe,Ce,this.nodeSize)},$e.prototype.within=function(Bt,Yt,oe){return function(Ce,Ue,fr,Sr,Pe,ur){for(var Wr=[0,Ce.length-1,0],Sn=[],qr=Pe*Pe;Wr.length;){var Qr=Wr.pop(),Mn=Wr.pop(),bi=Wr.pop();if(Mn-bi<=ur)for(var Si=bi;Si<=Mn;Si++)Vt(Ue[2*Si],Ue[2*Si+1],fr,Sr)<=qr&&Sn.push(Ce[Si]);else{var Kr=Math.floor((bi+Mn)/2),ai=Ue[2*Kr],li=Ue[2*Kr+1];Vt(ai,li,fr,Sr)<=qr&&Sn.push(Ce[Kr]);var hi=(Qr+1)%2;(Qr===0?fr-Pe<=ai:Sr-Pe<=li)&&(Wr.push(bi),Wr.push(Kr-1),Wr.push(hi)),(Qr===0?fr+Pe>=ai:Sr+Pe>=li)&&(Wr.push(Kr+1),Wr.push(Mn),Wr.push(hi))}}return Sn}(this.ids,this.coords,Bt,Yt,oe,this.nodeSize)};var jt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Bt){return Bt}},Qt=function(Bt){this.options=St(Object.create(jt),Bt),this.trees=new Array(this.options.maxZoom+1)};function Te(Bt,Yt,oe,Ce,Ue){return{x:Bt,y:Yt,zoom:1/0,id:oe,parentId:-1,numPoints:Ce,properties:Ue}}function ae(Bt,Yt){var oe=Bt.geometry.coordinates,Ce=oe[1];return{x:ie(oe[0]),y:te(Ce),zoom:1/0,index:Yt,parentId:-1}}function Ke(Bt){return{type:"Feature",id:Bt.id,properties:or(Bt),geometry:{type:"Point",coordinates:[(Ce=Bt.x,360*(Ce-.5)),(Yt=Bt.y,oe=(180-360*Yt)*Math.PI/180,360*Math.atan(Math.exp(oe))/Math.PI-90)]}};var Yt,oe,Ce}function or(Bt){var Yt=Bt.numPoints,oe=Yt>=1e4?Math.round(Yt/1e3)+"k":Yt>=1e3?Math.round(Yt/100)/10+"k":Yt;return St(St({},Bt.properties),{cluster:!0,cluster_id:Bt.id,point_count:Yt,point_count_abbreviated:oe})}function ie(Bt){return Bt/360+.5}function te(Bt){var Yt=Math.sin(Bt*Math.PI/180),oe=.5-.25*Math.log((1+Yt)/(1-Yt))/Math.PI;return oe<0?0:oe>1?1:oe}function St(Bt,Yt){for(var oe in Yt)Bt[oe]=Yt[oe];return Bt}function qt(Bt){return Bt.x}function $t(Bt){return Bt.y}function Ct(Bt,Yt,oe,Ce,Ue,fr){var Sr=Ue-oe,Pe=fr-Ce;if(Sr!==0||Pe!==0){var ur=((Bt-oe)*Sr+(Yt-Ce)*Pe)/(Sr*Sr+Pe*Pe);ur>1?(oe=Ue,Ce=fr):ur>0&&(oe+=Sr*ur,Ce+=Pe*ur)}return(Sr=Bt-oe)*Sr+(Pe=Yt-Ce)*Pe}function Tt(Bt,Yt,oe,Ce){var Ue={id:Bt===void 0?null:Bt,type:Yt,geometry:oe,tags:Ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(fr){var Sr=fr.geometry,Pe=fr.type;if(Pe==="Point"||Pe==="MultiPoint"||Pe==="LineString")ue(fr,Sr);else if(Pe==="Polygon"||Pe==="MultiLineString")for(var ur=0;ur<Sr.length;ur++)ue(fr,Sr[ur]);else if(Pe==="MultiPolygon")for(ur=0;ur<Sr.length;ur++)for(var Wr=0;Wr<Sr[ur].length;Wr++)ue(fr,Sr[ur][Wr])}(Ue),Ue}function ue(Bt,Yt){for(var oe=0;oe<Yt.length;oe+=3)Bt.minX=Math.min(Bt.minX,Yt[oe]),Bt.minY=Math.min(Bt.minY,Yt[oe+1]),Bt.maxX=Math.max(Bt.maxX,Yt[oe]),Bt.maxY=Math.max(Bt.maxY,Yt[oe+1])}function Oe(Bt,Yt,oe,Ce){if(Yt.geometry){var Ue=Yt.geometry.coordinates,fr=Yt.geometry.type,Sr=Math.pow(oe.tolerance/((1<<oe.maxZoom)*oe.extent),2),Pe=[],ur=Yt.id;if(oe.promoteId?ur=Yt.properties[oe.promoteId]:oe.generateId&&(ur=Ce||0),fr==="Point")We(Ue,Pe);else if(fr==="MultiPoint")for(var Wr=0;Wr<Ue.length;Wr++)We(Ue[Wr],Pe);else if(fr==="LineString")zt(Ue,Pe,Sr,!1);else if(fr==="MultiLineString"){if(oe.lineMetrics){for(Wr=0;Wr<Ue.length;Wr++)zt(Ue[Wr],Pe=[],Sr,!1),Bt.push(Tt(ur,"LineString",Pe,Yt.properties));return}At(Ue,Pe,Sr,!1)}else if(fr==="Polygon")At(Ue,Pe,Sr,!0);else{if(fr!=="MultiPolygon"){if(fr==="GeometryCollection"){for(Wr=0;Wr<Yt.geometry.geometries.length;Wr++)Oe(Bt,{id:ur,geometry:Yt.geometry.geometries[Wr],properties:Yt.properties},oe,Ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Wr=0;Wr<Ue.length;Wr++){var Sn=[];At(Ue[Wr],Sn,Sr,!0),Pe.push(Sn)}}Bt.push(Tt(ur,fr,Pe,Yt.properties))}}function We(Bt,Yt){Yt.push(Mt(Bt[0])),Yt.push(Rt(Bt[1])),Yt.push(0)}function zt(Bt,Yt,oe,Ce){for(var Ue,fr,Sr=0,Pe=0;Pe<Bt.length;Pe++){var ur=Mt(Bt[Pe][0]),Wr=Rt(Bt[Pe][1]);Yt.push(ur),Yt.push(Wr),Yt.push(0),Pe>0&&(Sr+=Ce?(Ue*Wr-ur*fr)/2:Math.sqrt(Math.pow(ur-Ue,2)+Math.pow(Wr-fr,2))),Ue=ur,fr=Wr}var Sn=Yt.length-3;Yt[2]=1,function qr(Qr,Mn,bi,Si){for(var Kr,ai=Si,li=bi-Mn>>1,hi=bi-Mn,ra=Qr[Mn],Ci=Qr[Mn+1],Ba=Qr[bi],po=Qr[bi+1],za=Mn+3;za<bi;za+=3){var Xa=Ct(Qr[za],Qr[za+1],ra,Ci,Ba,po);if(Xa>ai)Kr=za,ai=Xa;else if(Xa===ai){var Ta=Math.abs(za-li);Ta<hi&&(Kr=za,hi=Ta)}}ai>Si&&(Kr-Mn>3&&qr(Qr,Mn,Kr,Si),Qr[Kr+2]=ai,bi-Kr>3&&qr(Qr,Kr,bi,Si))}(Yt,0,Sn,oe),Yt[Sn+2]=1,Yt.size=Math.abs(Sr),Yt.start=0,Yt.end=Yt.size}function At(Bt,Yt,oe,Ce){for(var Ue=0;Ue<Bt.length;Ue++){var fr=[];zt(Bt[Ue],fr,oe,Ce),Yt.push(fr)}}function Mt(Bt){return Bt/360+.5}function Rt(Bt){var Yt=Math.sin(Bt*Math.PI/180),oe=.5-.25*Math.log((1+Yt)/(1-Yt))/Math.PI;return oe<0?0:oe>1?1:oe}function tt(Bt,Yt,oe,Ce,Ue,fr,Sr,Pe){if(Ce/=Yt,fr>=(oe/=Yt)&&Sr<Ce)return Bt;if(Sr<oe||fr>=Ce)return null;for(var ur=[],Wr=0;Wr<Bt.length;Wr++){var Sn=Bt[Wr],qr=Sn.geometry,Qr=Sn.type,Mn=Ue===0?Sn.minX:Sn.minY,bi=Ue===0?Sn.maxX:Sn.maxY;if(Mn>=oe&&bi<Ce)ur.push(Sn);else if(!(bi<oe||Mn>=Ce)){var Si=[];if(Qr==="Point"||Qr==="MultiPoint")_t(qr,Si,oe,Ce,Ue);else if(Qr==="LineString")Xt(qr,Si,oe,Ce,Ue,!1,Pe.lineMetrics);else if(Qr==="MultiLineString")Wt(qr,Si,oe,Ce,Ue,!1);else if(Qr==="Polygon")Wt(qr,Si,oe,Ce,Ue,!0);else if(Qr==="MultiPolygon")for(var Kr=0;Kr<qr.length;Kr++){var ai=[];Wt(qr[Kr],ai,oe,Ce,Ue,!0),ai.length&&Si.push(ai)}if(Si.length){if(Pe.lineMetrics&&Qr==="LineString"){for(Kr=0;Kr<Si.length;Kr++)ur.push(Tt(Sn.id,Qr,Si[Kr],Sn.tags));continue}Qr!=="LineString"&&Qr!=="MultiLineString"||(Si.length===1?(Qr="LineString",Si=Si[0]):Qr="MultiLineString"),Qr!=="Point"&&Qr!=="MultiPoint"||(Qr=Si.length===3?"Point":"MultiPoint"),ur.push(Tt(Sn.id,Qr,Si,Sn.tags))}}}return ur.length?ur:null}function _t(Bt,Yt,oe,Ce,Ue){for(var fr=0;fr<Bt.length;fr+=3){var Sr=Bt[fr+Ue];Sr>=oe&&Sr<=Ce&&(Yt.push(Bt[fr]),Yt.push(Bt[fr+1]),Yt.push(Bt[fr+2]))}}function Xt(Bt,Yt,oe,Ce,Ue,fr,Sr){for(var Pe,ur,Wr=ve(Bt),Sn=Ue===0?je:Qe,qr=Bt.start,Qr=0;Qr<Bt.length-3;Qr+=3){var Mn=Bt[Qr],bi=Bt[Qr+1],Si=Bt[Qr+2],Kr=Bt[Qr+3],ai=Bt[Qr+4],li=Ue===0?Mn:bi,hi=Ue===0?Kr:ai,ra=!1;Sr&&(Pe=Math.sqrt(Math.pow(Mn-Kr,2)+Math.pow(bi-ai,2))),li<oe?hi>oe&&(ur=Sn(Wr,Mn,bi,Kr,ai,oe),Sr&&(Wr.start=qr+Pe*ur)):li>Ce?hi<Ce&&(ur=Sn(Wr,Mn,bi,Kr,ai,Ce),Sr&&(Wr.start=qr+Pe*ur)):Me(Wr,Mn,bi,Si),hi<oe&&li>=oe&&(ur=Sn(Wr,Mn,bi,Kr,ai,oe),ra=!0),hi>Ce&&li<=Ce&&(ur=Sn(Wr,Mn,bi,Kr,ai,Ce),ra=!0),!fr&&ra&&(Sr&&(Wr.end=qr+Pe*ur),Yt.push(Wr),Wr=ve(Bt)),Sr&&(qr+=Pe)}var Ci=Bt.length-3;Mn=Bt[Ci],bi=Bt[Ci+1],Si=Bt[Ci+2],(li=Ue===0?Mn:bi)>=oe&&li<=Ce&&Me(Wr,Mn,bi,Si),Ci=Wr.length-3,fr&&Ci>=3&&(Wr[Ci]!==Wr[0]||Wr[Ci+1]!==Wr[1])&&Me(Wr,Wr[0],Wr[1],Wr[2]),Wr.length&&Yt.push(Wr)}function ve(Bt){var Yt=[];return Yt.size=Bt.size,Yt.start=Bt.start,Yt.end=Bt.end,Yt}function Wt(Bt,Yt,oe,Ce,Ue,fr){for(var Sr=0;Sr<Bt.length;Sr++)Xt(Bt[Sr],Yt,oe,Ce,Ue,fr,!1)}function Me(Bt,Yt,oe,Ce){Bt.push(Yt),Bt.push(oe),Bt.push(Ce)}function je(Bt,Yt,oe,Ce,Ue,fr){var Sr=(fr-Yt)/(Ce-Yt);return Bt.push(fr),Bt.push(oe+(Ue-oe)*Sr),Bt.push(1),Sr}function Qe(Bt,Yt,oe,Ce,Ue,fr){var Sr=(fr-oe)/(Ue-oe);return Bt.push(Yt+(Ce-Yt)*Sr),Bt.push(fr),Bt.push(1),Sr}function hr(Bt,Yt){for(var oe=[],Ce=0;Ce<Bt.length;Ce++){var Ue,fr=Bt[Ce],Sr=fr.type;if(Sr==="Point"||Sr==="MultiPoint"||Sr==="LineString")Ue=er(fr.geometry,Yt);else if(Sr==="MultiLineString"||Sr==="Polygon"){Ue=[];for(var Pe=0;Pe<fr.geometry.length;Pe++)Ue.push(er(fr.geometry[Pe],Yt))}else if(Sr==="MultiPolygon")for(Ue=[],Pe=0;Pe<fr.geometry.length;Pe++){for(var ur=[],Wr=0;Wr<fr.geometry[Pe].length;Wr++)ur.push(er(fr.geometry[Pe][Wr],Yt));Ue.push(ur)}oe.push(Tt(fr.id,Sr,Ue,fr.tags))}return oe}function er(Bt,Yt){var oe=[];oe.size=Bt.size,Bt.start!==void 0&&(oe.start=Bt.start,oe.end=Bt.end);for(var Ce=0;Ce<Bt.length;Ce+=3)oe.push(Bt[Ce]+Yt,Bt[Ce+1],Bt[Ce+2]);return oe}function Br(Bt,Yt){if(Bt.transformed)return Bt;var oe,Ce,Ue,fr=1<<Bt.z,Sr=Bt.x,Pe=Bt.y;for(oe=0;oe<Bt.features.length;oe++){var ur=Bt.features[oe],Wr=ur.geometry,Sn=ur.type;if(ur.geometry=[],Sn===1)for(Ce=0;Ce<Wr.length;Ce+=2)ur.geometry.push(Lr(Wr[Ce],Wr[Ce+1],Yt,fr,Sr,Pe));else for(Ce=0;Ce<Wr.length;Ce++){var qr=[];for(Ue=0;Ue<Wr[Ce].length;Ue+=2)qr.push(Lr(Wr[Ce][Ue],Wr[Ce][Ue+1],Yt,fr,Sr,Pe));ur.geometry.push(qr)}}return Bt.transformed=!0,Bt}function Lr(Bt,Yt,oe,Ce,Ue,fr){return[Math.round(oe*(Bt*Ce-Ue)),Math.round(oe*(Yt*Ce-fr))]}function Zr(Bt,Yt,oe,Ce,Ue){for(var fr=Yt===Ue.maxZoom?0:Ue.tolerance/((1<<Yt)*Ue.extent),Sr={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:oe,y:Ce,z:Yt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Pe=0;Pe<Bt.length;Pe++){Sr.numFeatures++,Tn(Sr,Bt[Pe],fr,Ue);var ur=Bt[Pe].minX,Wr=Bt[Pe].minY,Sn=Bt[Pe].maxX,qr=Bt[Pe].maxY;ur<Sr.minX&&(Sr.minX=ur),Wr<Sr.minY&&(Sr.minY=Wr),Sn>Sr.maxX&&(Sr.maxX=Sn),qr>Sr.maxY&&(Sr.maxY=qr)}return Sr}function Tn(Bt,Yt,oe,Ce){var Ue=Yt.geometry,fr=Yt.type,Sr=[];if(fr==="Point"||fr==="MultiPoint")for(var Pe=0;Pe<Ue.length;Pe+=3)Sr.push(Ue[Pe]),Sr.push(Ue[Pe+1]),Bt.numPoints++,Bt.numSimplified++;else if(fr==="LineString")rn(Sr,Ue,Bt,oe,!1,!1);else if(fr==="MultiLineString"||fr==="Polygon")for(Pe=0;Pe<Ue.length;Pe++)rn(Sr,Ue[Pe],Bt,oe,fr==="Polygon",Pe===0);else if(fr==="MultiPolygon")for(var ur=0;ur<Ue.length;ur++){var Wr=Ue[ur];for(Pe=0;Pe<Wr.length;Pe++)rn(Sr,Wr[Pe],Bt,oe,!0,Pe===0)}if(Sr.length){var Sn=Yt.tags||null;if(fr==="LineString"&&Ce.lineMetrics){for(var qr in Sn={},Yt.tags)Sn[qr]=Yt.tags[qr];Sn.mapbox_clip_start=Ue.start/Ue.size,Sn.mapbox_clip_end=Ue.end/Ue.size}var Qr={geometry:Sr,type:fr==="Polygon"||fr==="MultiPolygon"?3:fr==="LineString"||fr==="MultiLineString"?2:1,tags:Sn};Yt.id!==null&&(Qr.id=Yt.id),Bt.features.push(Qr)}}function rn(Bt,Yt,oe,Ce,Ue,fr){var Sr=Ce*Ce;if(Ce>0&&Yt.size<(Ue?Sr:Ce))oe.numPoints+=Yt.length/3;else{for(var Pe=[],ur=0;ur<Yt.length;ur+=3)(Ce===0||Yt[ur+2]>Sr)&&(oe.numSimplified++,Pe.push(Yt[ur]),Pe.push(Yt[ur+1])),oe.numPoints++;Ue&&function(Wr,Sn){for(var qr=0,Qr=0,Mn=Wr.length,bi=Mn-2;Qr<Mn;bi=Qr,Qr+=2)qr+=(Wr[Qr]-Wr[bi])*(Wr[Qr+1]+Wr[bi+1]);if(qr>0===Sn)for(Qr=0,Mn=Wr.length;Qr<Mn/2;Qr+=2){var Si=Wr[Qr],Kr=Wr[Qr+1];Wr[Qr]=Wr[Mn-2-Qr],Wr[Qr+1]=Wr[Mn-1-Qr],Wr[Mn-2-Qr]=Si,Wr[Mn-1-Qr]=Kr}}(Pe,fr),Bt.push(Pe)}}function Nn(Bt,Yt){var oe=(Yt=this.options=function(Ue,fr){for(var Sr in fr)Ue[Sr]=fr[Sr];return Ue}(Object.create(this.options),Yt)).debug;if(oe&&console.time("preprocess data"),Yt.maxZoom<0||Yt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Yt.promoteId&&Yt.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ce=function(Ue,fr){var Sr=[];if(Ue.type==="FeatureCollection")for(var Pe=0;Pe<Ue.features.length;Pe++)Oe(Sr,Ue.features[Pe],fr,Pe);else Oe(Sr,Ue.type==="Feature"?Ue:{geometry:Ue},fr);return Sr}(Bt,Yt);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Yt.indexMaxZoom,Yt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(Ce=function(Ue,fr){var Sr=fr.buffer/fr.extent,Pe=Ue,ur=tt(Ue,1,-1-Sr,Sr,0,-1,2,fr),Wr=tt(Ue,1,1-Sr,2+Sr,0,-1,2,fr);return(ur||Wr)&&(Pe=tt(Ue,1,-Sr,1+Sr,0,-1,2,fr)||[],ur&&(Pe=hr(ur,1).concat(Pe)),Wr&&(Pe=Pe.concat(hr(Wr,-1)))),Pe}(Ce,Yt)).length&&this.splitTile(Ce,0,0,0),oe&&(Ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function zn(Bt,Yt,oe){return 32*((1<<Bt)*oe+Yt)+Bt}function jn(Bt,Yt){var oe=Bt.tileID.canonical;if(!this._geoJSONIndex)return Yt(null,null);var Ce=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!Ce)return Yt(null,null);var Ue=new Se(Ce.features),fr=Ae(Ue);fr.byteOffset===0&&fr.byteLength===fr.buffer.byteLength||(fr=new Uint8Array(fr)),Yt(null,{vectorTile:Ue,rawData:fr.buffer})}Qt.prototype.load=function(Bt){var Yt=this.options,oe=Yt.log,Ce=Yt.minZoom,Ue=Yt.maxZoom,fr=Yt.nodeSize;oe&&console.time("total time");var Sr="prepare "+Bt.length+" points";oe&&console.time(Sr),this.points=Bt;for(var Pe=[],ur=0;ur<Bt.length;ur++)Bt[ur].geometry&&Pe.push(ae(Bt[ur],ur));this.trees[Ue+1]=new $e(Pe,qt,$t,fr,Float32Array),oe&&console.timeEnd(Sr);for(var Wr=Ue;Wr>=Ce;Wr--){var Sn=+Date.now();Pe=this._cluster(Pe,Wr),this.trees[Wr]=new $e(Pe,qt,$t,fr,Float32Array),oe&&console.log("z%d: %d clusters in %dms",Wr,Pe.length,+Date.now()-Sn)}return oe&&console.timeEnd("total time"),this},Qt.prototype.getClusters=function(Bt,Yt){var oe=((Bt[0]+180)%360+360)%360-180,Ce=Math.max(-90,Math.min(90,Bt[1])),Ue=Bt[2]===180?180:((Bt[2]+180)%360+360)%360-180,fr=Math.max(-90,Math.min(90,Bt[3]));if(Bt[2]-Bt[0]>=360)oe=-180,Ue=180;else if(oe>Ue){var Sr=this.getClusters([oe,Ce,180,fr],Yt),Pe=this.getClusters([-180,Ce,Ue,fr],Yt);return Sr.concat(Pe)}for(var ur=this.trees[this._limitZoom(Yt)],Wr=[],Sn=0,qr=ur.range(ie(oe),te(fr),ie(Ue),te(Ce));Sn<qr.length;Sn+=1){var Qr=ur.points[qr[Sn]];Wr.push(Qr.numPoints?Ke(Qr):this.points[Qr.index])}return Wr},Qt.prototype.getChildren=function(Bt){var Yt=this._getOriginId(Bt),oe=this._getOriginZoom(Bt),Ce="No cluster with the specified id.",Ue=this.trees[oe];if(!Ue)throw new Error(Ce);var fr=Ue.points[Yt];if(!fr)throw new Error(Ce);for(var Sr=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),Pe=[],ur=0,Wr=Ue.within(fr.x,fr.y,Sr);ur<Wr.length;ur+=1){var Sn=Ue.points[Wr[ur]];Sn.parentId===Bt&&Pe.push(Sn.numPoints?Ke(Sn):this.points[Sn.index])}if(Pe.length===0)throw new Error(Ce);return Pe},Qt.prototype.getLeaves=function(Bt,Yt,oe){var Ce=[];return this._appendLeaves(Ce,Bt,Yt=Yt||10,oe=oe||0,0),Ce},Qt.prototype.getTile=function(Bt,Yt,oe){var Ce=this.trees[this._limitZoom(Bt)],Ue=Math.pow(2,Bt),fr=this.options,Sr=fr.radius/fr.extent,Pe=(oe-Sr)/Ue,ur=(oe+1+Sr)/Ue,Wr={features:[]};return this._addTileFeatures(Ce.range((Yt-Sr)/Ue,Pe,(Yt+1+Sr)/Ue,ur),Ce.points,Yt,oe,Ue,Wr),Yt===0&&this._addTileFeatures(Ce.range(1-Sr/Ue,Pe,1,ur),Ce.points,Ue,oe,Ue,Wr),Yt===Ue-1&&this._addTileFeatures(Ce.range(0,Pe,Sr/Ue,ur),Ce.points,-1,oe,Ue,Wr),Wr.features.length?Wr:null},Qt.prototype.getClusterExpansionZoom=function(Bt){for(var Yt=this._getOriginZoom(Bt)-1;Yt<=this.options.maxZoom;){var oe=this.getChildren(Bt);if(Yt++,oe.length!==1)break;Bt=oe[0].properties.cluster_id}return Yt},Qt.prototype._appendLeaves=function(Bt,Yt,oe,Ce,Ue){for(var fr=0,Sr=this.getChildren(Yt);fr<Sr.length;fr+=1){var Pe=Sr[fr],ur=Pe.properties;if(ur&&ur.cluster?Ue+ur.point_count<=Ce?Ue+=ur.point_count:Ue=this._appendLeaves(Bt,ur.cluster_id,oe,Ce,Ue):Ue<Ce?Ue++:Bt.push(Pe),Bt.length===oe)break}return Ue},Qt.prototype._addTileFeatures=function(Bt,Yt,oe,Ce,Ue,fr){for(var Sr=0,Pe=Bt;Sr<Pe.length;Sr+=1){var ur=Yt[Pe[Sr]],Wr=ur.numPoints,Sn={type:1,geometry:[[Math.round(this.options.extent*(ur.x*Ue-oe)),Math.round(this.options.extent*(ur.y*Ue-Ce))]],tags:Wr?or(ur):this.points[ur.index].properties},qr=void 0;Wr?qr=ur.id:this.options.generateId?qr=ur.index:this.points[ur.index].id&&(qr=this.points[ur.index].id),qr!==void 0&&(Sn.id=qr),fr.features.push(Sn)}},Qt.prototype._limitZoom=function(Bt){return Math.max(this.options.minZoom,Math.min(+Bt,this.options.maxZoom+1))},Qt.prototype._cluster=function(Bt,Yt){for(var oe=[],Ce=this.options,Ue=Ce.reduce,fr=Ce.minPoints,Sr=Ce.radius/(Ce.extent*Math.pow(2,Yt)),Pe=0;Pe<Bt.length;Pe++){var ur=Bt[Pe];if(!(ur.zoom<=Yt)){ur.zoom=Yt;for(var Wr=this.trees[Yt+1],Sn=Wr.within(ur.x,ur.y,Sr),qr=ur.numPoints||1,Qr=qr,Mn=0,bi=Sn;Mn<bi.length;Mn+=1){var Si=Wr.points[bi[Mn]];Si.zoom>Yt&&(Qr+=Si.numPoints||1)}if(Qr>=fr){for(var Kr=ur.x*qr,ai=ur.y*qr,li=Ue&&qr>1?this._map(ur,!0):null,hi=(Pe<<5)+(Yt+1)+this.points.length,ra=0,Ci=Sn;ra<Ci.length;ra+=1){var Ba=Wr.points[Ci[ra]];if(!(Ba.zoom<=Yt)){Ba.zoom=Yt;var po=Ba.numPoints||1;Kr+=Ba.x*po,ai+=Ba.y*po,Ba.parentId=hi,Ue&&(li||(li=this._map(ur,!0)),Ue(li,this._map(Ba)))}}ur.parentId=hi,oe.push(Te(Kr/Qr,ai/Qr,hi,Qr,li))}else if(oe.push(ur),Qr>1)for(var za=0,Xa=Sn;za<Xa.length;za+=1){var Ta=Wr.points[Xa[za]];Ta.zoom<=Yt||(Ta.zoom=Yt,oe.push(Ta))}}}return oe},Qt.prototype._getOriginId=function(Bt){return Bt-this.points.length>>5},Qt.prototype._getOriginZoom=function(Bt){return(Bt-this.points.length)%32},Qt.prototype._map=function(Bt,Yt){if(Bt.numPoints)return Yt?St({},Bt.properties):Bt.properties;var oe=this.points[Bt.index].properties,Ce=this.options.map(oe);return Yt&&Ce===oe?St({},Ce):Ce},Nn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Nn.prototype.splitTile=function(Bt,Yt,oe,Ce,Ue,fr,Sr){for(var Pe=[Bt,Yt,oe,Ce],ur=this.options,Wr=ur.debug;Pe.length;){Ce=Pe.pop(),oe=Pe.pop(),Yt=Pe.pop(),Bt=Pe.pop();var Sn=1<<Yt,qr=zn(Yt,oe,Ce),Qr=this.tiles[qr];if(!Qr&&(Wr>1&&console.time("creation"),Qr=this.tiles[qr]=Zr(Bt,Yt,oe,Ce,ur),this.tileCoords.push({z:Yt,x:oe,y:Ce}),Wr)){Wr>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Yt,oe,Ce,Qr.numFeatures,Qr.numPoints,Qr.numSimplified),console.timeEnd("creation"));var Mn="z"+Yt;this.stats[Mn]=(this.stats[Mn]||0)+1,this.total++}if(Qr.source=Bt,Ue){if(Yt===ur.maxZoom||Yt===Ue)continue;var bi=1<<Ue-Yt;if(oe!==Math.floor(fr/bi)||Ce!==Math.floor(Sr/bi))continue}else if(Yt===ur.indexMaxZoom||Qr.numPoints<=ur.indexMaxPoints)continue;if(Qr.source=null,Bt.length!==0){Wr>1&&console.time("clipping");var Si,Kr,ai,li,hi,ra,Ci=.5*ur.buffer/ur.extent,Ba=.5-Ci,po=.5+Ci,za=1+Ci;Si=Kr=ai=li=null,hi=tt(Bt,Sn,oe-Ci,oe+po,0,Qr.minX,Qr.maxX,ur),ra=tt(Bt,Sn,oe+Ba,oe+za,0,Qr.minX,Qr.maxX,ur),Bt=null,hi&&(Si=tt(hi,Sn,Ce-Ci,Ce+po,1,Qr.minY,Qr.maxY,ur),Kr=tt(hi,Sn,Ce+Ba,Ce+za,1,Qr.minY,Qr.maxY,ur),hi=null),ra&&(ai=tt(ra,Sn,Ce-Ci,Ce+po,1,Qr.minY,Qr.maxY,ur),li=tt(ra,Sn,Ce+Ba,Ce+za,1,Qr.minY,Qr.maxY,ur),ra=null),Wr>1&&console.timeEnd("clipping"),Pe.push(Si||[],Yt+1,2*oe,2*Ce),Pe.push(Kr||[],Yt+1,2*oe,2*Ce+1),Pe.push(ai||[],Yt+1,2*oe+1,2*Ce),Pe.push(li||[],Yt+1,2*oe+1,2*Ce+1)}}},Nn.prototype.getTile=function(Bt,Yt,oe){var Ce=this.options,Ue=Ce.extent,fr=Ce.debug;if(Bt<0||Bt>24)return null;var Sr=1<<Bt,Pe=zn(Bt,Yt=(Yt%Sr+Sr)%Sr,oe);if(this.tiles[Pe])return Br(this.tiles[Pe],Ue);fr>1&&console.log("drilling down to z%d-%d-%d",Bt,Yt,oe);for(var ur,Wr=Bt,Sn=Yt,qr=oe;!ur&&Wr>0;)Wr--,Sn=Math.floor(Sn/2),qr=Math.floor(qr/2),ur=this.tiles[zn(Wr,Sn,qr)];return ur&&ur.source?(fr>1&&console.log("found parent tile z%d-%d-%d",Wr,Sn,qr),fr>1&&console.time("drilling down"),this.splitTile(ur.source,Wr,Sn,qr,Bt,Yt,oe),fr>1&&console.timeEnd("drilling down"),this.tiles[Pe]?Br(this.tiles[Pe],Ue):null):null};var wn=function(Bt){function Yt(oe,Ce,Ue,fr){Bt.call(this,oe,Ce,Ue,jn),fr&&(this.loadGeoJSON=fr)}return Bt&&(Yt.__proto__=Bt),(Yt.prototype=Object.create(Bt&&Bt.prototype)).constructor=Yt,Yt.prototype.loadData=function(oe,Ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Ce,this._pendingLoadDataParams=oe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Yt.prototype._loadData=function(){var oe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Ce=this._pendingCallback,Ue=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var fr=!!(Ue&&Ue.request&&Ue.request.collectResourceTiming)&&new I.RequestPerformance(Ue.request);this.loadGeoJSON(Ue,function(Sr,Pe){if(Sr||!Pe)return Ce(Sr);if(typeof Pe!="object")return Ce(new Error("Input data given to '"+Ue.source+"' is not a valid GeoJSON object."));(function Qr(Mn,bi){var Si,Kr=Mn&&Mn.type;if(Kr==="FeatureCollection")for(Si=0;Si<Mn.features.length;Si++)Qr(Mn.features[Si],bi);else if(Kr==="GeometryCollection")for(Si=0;Si<Mn.geometries.length;Si++)Qr(Mn.geometries[Si],bi);else if(Kr==="Feature")Qr(Mn.geometry,bi);else if(Kr==="Polygon")P(Mn.coordinates,bi);else if(Kr==="MultiPolygon")for(Si=0;Si<Mn.coordinates.length;Si++)P(Mn.coordinates[Si],bi);return Mn})(Pe,!0);try{if(Ue.filter){var ur=I.createExpression(Ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ur.result==="error")throw new Error(ur.value.map(function(Qr){return Qr.key+": "+Qr.message}).join(", "));var Wr=Pe.features.filter(function(Qr){return ur.value.evaluate({zoom:0},Qr)});Pe={type:"FeatureCollection",features:Wr}}oe._geoJSONIndex=Ue.cluster?new Qt(function(Qr){var Mn=Qr.superclusterOptions,bi=Qr.clusterProperties;if(!bi||!Mn)return Mn;for(var Si={},Kr={},ai={accumulated:null,zoom:0},li={properties:null},hi=Object.keys(bi),ra=0,Ci=hi;ra<Ci.length;ra+=1){var Ba=Ci[ra],po=bi[Ba],za=po[0],Xa=I.createExpression(po[1]),Ta=I.createExpression(typeof za=="string"?[za,["accumulated"],["get",Ba]]:za);Si[Ba]=Xa.value,Kr[Ba]=Ta.value}return Mn.map=function(ga){li.properties=ga;for(var no={},Vo=0,vo=hi;Vo<vo.length;Vo+=1){var ja=vo[Vo];no[ja]=Si[ja].evaluate(ai,li)}return no},Mn.reduce=function(ga,no){li.properties=no;for(var Vo=0,vo=hi;Vo<vo.length;Vo+=1){var ja=vo[Vo];ai.accumulated=ga[ja],ga[ja]=Kr[ja].evaluate(ai,li)}},Mn}(Ue)).load(Pe.features):function(Qr,Mn){return new Nn(Qr,Mn)}(Pe,Ue.geojsonVtOptions)}catch(Qr){return Ce(Qr)}oe.loaded={};var Sn={};if(fr){var qr=fr.finish();qr&&(Sn.resourceTiming={},Sn.resourceTiming[Ue.source]=JSON.parse(JSON.stringify(qr)))}Ce(null,Sn)})}},Yt.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Yt.prototype.reloadTile=function(oe,Ce){var Ue=this.loaded;return Ue&&Ue[oe.uid]?Bt.prototype.reloadTile.call(this,oe,Ce):this.loadTile(oe,Ce)},Yt.prototype.loadGeoJSON=function(oe,Ce){if(oe.request)I.getJSON(oe.request,Ce);else{if(typeof oe.data!="string")return Ce(new Error("Input data given to '"+oe.source+"' is not a valid GeoJSON object."));try{return Ce(null,JSON.parse(oe.data))}catch(Ue){return Ce(new Error("Input data given to '"+oe.source+"' is not a valid GeoJSON object."))}}},Yt.prototype.removeSource=function(oe,Ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Ce()},Yt.prototype.getClusterExpansionZoom=function(oe,Ce){try{Ce(null,this._geoJSONIndex.getClusterExpansionZoom(oe.clusterId))}catch(Ue){Ce(Ue)}},Yt.prototype.getClusterChildren=function(oe,Ce){try{Ce(null,this._geoJSONIndex.getChildren(oe.clusterId))}catch(Ue){Ce(Ue)}},Yt.prototype.getClusterLeaves=function(oe,Ce){try{Ce(null,this._geoJSONIndex.getLeaves(oe.clusterId,oe.limit,oe.offset))}catch(Ue){Ce(Ue)}},Yt}(it),Wn=function(Bt){var Yt=this;this.self=Bt,this.actor=new I.Actor(Bt,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:it,geojson:wn},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(oe,Ce){if(Yt.workerSourceTypes[oe])throw new Error('Worker source with name "'+oe+'" already registered.');Yt.workerSourceTypes[oe]=Ce},this.self.registerRTLTextPlugin=function(oe){if(I.plugin.isParsed())throw new Error("RTL text plugin already registered.");I.plugin.applyArabicShaping=oe.applyArabicShaping,I.plugin.processBidirectionalText=oe.processBidirectionalText,I.plugin.processStyledBidirectionalText=oe.processStyledBidirectionalText}};return Wn.prototype.setReferrer=function(Bt,Yt){this.referrer=Yt},Wn.prototype.setImages=function(Bt,Yt,oe){for(var Ce in this.availableImages[Bt]=Yt,this.workerSources[Bt]){var Ue=this.workerSources[Bt][Ce];for(var fr in Ue)Ue[fr].availableImages=Yt}oe()},Wn.prototype.setLayers=function(Bt,Yt,oe){this.getLayerIndex(Bt).replace(Yt),oe()},Wn.prototype.updateLayers=function(Bt,Yt,oe){this.getLayerIndex(Bt).update(Yt.layers,Yt.removedIds),oe()},Wn.prototype.loadTile=function(Bt,Yt,oe){this.getWorkerSource(Bt,Yt.type,Yt.source).loadTile(Yt,oe)},Wn.prototype.loadDEMTile=function(Bt,Yt,oe){this.getDEMWorkerSource(Bt,Yt.source).loadTile(Yt,oe)},Wn.prototype.reloadTile=function(Bt,Yt,oe){this.getWorkerSource(Bt,Yt.type,Yt.source).reloadTile(Yt,oe)},Wn.prototype.abortTile=function(Bt,Yt,oe){this.getWorkerSource(Bt,Yt.type,Yt.source).abortTile(Yt,oe)},Wn.prototype.removeTile=function(Bt,Yt,oe){this.getWorkerSource(Bt,Yt.type,Yt.source).removeTile(Yt,oe)},Wn.prototype.removeDEMTile=function(Bt,Yt){this.getDEMWorkerSource(Bt,Yt.source).removeTile(Yt)},Wn.prototype.removeSource=function(Bt,Yt,oe){if(this.workerSources[Bt]&&this.workerSources[Bt][Yt.type]&&this.workerSources[Bt][Yt.type][Yt.source]){var Ce=this.workerSources[Bt][Yt.type][Yt.source];delete this.workerSources[Bt][Yt.type][Yt.source],Ce.removeSource!==void 0?Ce.removeSource(Yt,oe):oe()}},Wn.prototype.loadWorkerSource=function(Bt,Yt,oe){try{this.self.importScripts(Yt.url),oe()}catch(Ce){oe(Ce.toString())}},Wn.prototype.syncRTLPluginState=function(Bt,Yt,oe){try{I.plugin.setState(Yt);var Ce=I.plugin.getPluginURL();if(I.plugin.isLoaded()&&!I.plugin.isParsed()&&Ce!=null){this.self.importScripts(Ce);var Ue=I.plugin.isParsed();oe(Ue?void 0:new Error("RTL Text Plugin failed to import scripts from "+Ce),Ue)}}catch(fr){oe(fr.toString())}},Wn.prototype.getAvailableImages=function(Bt){var Yt=this.availableImages[Bt];return Yt||(Yt=[]),Yt},Wn.prototype.getLayerIndex=function(Bt){var Yt=this.layerIndexes[Bt];return Yt||(Yt=this.layerIndexes[Bt]=new lt),Yt},Wn.prototype.getWorkerSource=function(Bt,Yt,oe){var Ce=this;return this.workerSources[Bt]||(this.workerSources[Bt]={}),this.workerSources[Bt][Yt]||(this.workerSources[Bt][Yt]={}),this.workerSources[Bt][Yt][oe]||(this.workerSources[Bt][Yt][oe]=new this.workerSourceTypes[Yt]({send:function(Ue,fr,Sr){Ce.actor.send(Ue,fr,Sr,Bt)}},this.getLayerIndex(Bt),this.getAvailableImages(Bt))),this.workerSources[Bt][Yt][oe]},Wn.prototype.getDEMWorkerSource=function(Bt,Yt){return this.demWorkerSources[Bt]||(this.demWorkerSources[Bt]={}),this.demWorkerSources[Bt][Yt]||(this.demWorkerSources[Bt][Yt]=new Zt),this.demWorkerSources[Bt][Yt]},Wn.prototype.enforceCacheSizeLimit=function(Bt,Yt){I.enforceCacheSizeLimit(Yt)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Wn(self)),Wn}),wt(["./shared"],function(I){"use strict";var Et=I.createCommonjsModule(function(x){function C(z){return!w(z)}function w(z){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var $,ft,Ut=new Blob([""],{type:"text/javascript"}),re=URL.createObjectURL(Ut);try{ft=new Worker(re),$=!0}catch(De){$=!1}return ft&&ft.terminate(),URL.revokeObjectURL(re),$}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var $=document.createElement("canvas");$.width=$.height=1;var ft=$.getContext("2d");if(!ft)return!1;var Ut=ft.getImageData(0,0,1,1);return Ut&&Ut.width===$.width}()?(M[H=z&&z.failIfMajorPerformanceCaveat]===void 0&&(M[H]=function($){var ft=function(re){var De=document.createElement("canvas"),Be=Object.create(C.webGLContextAttributes);return Be.failIfMajorPerformanceCaveat=re,De.probablySupportsContext?De.probablySupportsContext("webgl",Be)||De.probablySupportsContext("experimental-webgl",Be):De.supportsContext?De.supportsContext("webgl",Be)||De.supportsContext("experimental-webgl",Be):De.getContext("webgl",Be)||De.getContext("experimental-webgl",Be)}($);if(!ft)return!1;var Ut=ft.createShader(ft.VERTEX_SHADER);return!(!Ut||ft.isContextLost())&&(ft.shaderSource(Ut,"void main() {}"),ft.compileShader(Ut),ft.getShaderParameter(Ut,ft.COMPILE_STATUS)===!0)}(H)),M[H]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var H}x.exports?x.exports=C:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=C,window.mapboxgl.notSupportedReason=w);var M={};C.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),q={create:function(x,C,w){var M=I.window.document.createElement(x);return C!==void 0&&(M.className=C),w&&w.appendChild(M),M},createNS:function(x,C){return I.window.document.createElementNS(x,C)}},lt=I.window.document&&I.window.document.documentElement.style;function ht(x){if(!lt)return x[0];for(var C=0;C<x.length;C++)if(x[C]in lt)return x[C];return x[0]}var ct,et=ht(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);q.disableDrag=function(){lt&&et&&(ct=lt[et],lt[et]="none")},q.enableDrag=function(){lt&&et&&(lt[et]=ct)};var Ee=ht(["transform","WebkitTransform"]);q.setTransform=function(x,C){x.style[Ee]=C};var it=!1;try{var st=Object.defineProperty({},"passive",{get:function(){it=!0}});I.window.addEventListener("test",st,st),I.window.removeEventListener("test",st,st)}catch(x){it=!1}q.addEventListener=function(x,C,w,M){M===void 0&&(M={}),x.addEventListener(C,w,"passive"in M&&it?M:M.capture)},q.removeEventListener=function(x,C,w,M){M===void 0&&(M={}),x.removeEventListener(C,w,"passive"in M&&it?M:M.capture)};var Zt=function(x){x.preventDefault(),x.stopPropagation(),I.window.removeEventListener("click",Zt,!0)};function P(x){var C=x.userImage;return!!(C&&C.render&&C.render())&&(x.data.replace(new Uint8Array(C.data.buffer)),!0)}q.suppressClick=function(){I.window.addEventListener("click",Zt,!0),I.window.setTimeout(function(){I.window.removeEventListener("click",Zt,!0)},0)},q.mousePos=function(x,C){var w=x.getBoundingClientRect();return new I.Point(C.clientX-w.left-x.clientLeft,C.clientY-w.top-x.clientTop)},q.touchPos=function(x,C){for(var w=x.getBoundingClientRect(),M=[],z=0;z<C.length;z++)M.push(new I.Point(C[z].clientX-w.left-x.clientLeft,C[z].clientY-w.top-x.clientTop));return M},q.mouseButton=function(x){return I.window.InstallTrigger!==void 0&&x.button===2&&x.ctrlKey&&I.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:x.button},q.remove=function(x){x.parentNode&&x.parentNode.removeChild(x)};var b=function(x){function C(){x.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new I.RGBAImage({width:1,height:1}),this.dirty=!0}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.isLoaded=function(){return this.loaded},C.prototype.setLoaded=function(w){if(this.loaded!==w&&(this.loaded=w,w)){for(var M=0,z=this.requestors;M<z.length;M+=1){var H=z[M];this._notify(H.ids,H.callback)}this.requestors=[]}},C.prototype.getImage=function(w){return this.images[w]},C.prototype.addImage=function(w,M){this._validate(w,M)&&(this.images[w]=M)},C.prototype._validate=function(w,M){var z=!0;return this._validateStretch(M.stretchX,M.data&&M.data.width)||(this.fire(new I.ErrorEvent(new Error('Image "'+w+'" has invalid "stretchX" value'))),z=!1),this._validateStretch(M.stretchY,M.data&&M.data.height)||(this.fire(new I.ErrorEvent(new Error('Image "'+w+'" has invalid "stretchY" value'))),z=!1),this._validateContent(M.content,M)||(this.fire(new I.ErrorEvent(new Error('Image "'+w+'" has invalid "content" value'))),z=!1),z},C.prototype._validateStretch=function(w,M){if(!w)return!0;for(var z=0,H=0,$=w;H<$.length;H+=1){var ft=$[H];if(ft[0]<z||ft[1]<ft[0]||M<ft[1])return!1;z=ft[1]}return!0},C.prototype._validateContent=function(w,M){return!(w&&(w.length!==4||w[0]<0||M.data.width<w[0]||w[1]<0||M.data.height<w[1]||w[2]<0||M.data.width<w[2]||w[3]<0||M.data.height<w[3]||w[2]<w[0]||w[3]<w[1]))},C.prototype.updateImage=function(w,M){M.version=this.images[w].version+1,this.images[w]=M,this.updatedImages[w]=!0},C.prototype.removeImage=function(w){var M=this.images[w];delete this.images[w],delete this.patterns[w],M.userImage&&M.userImage.onRemove&&M.userImage.onRemove()},C.prototype.listImages=function(){return Object.keys(this.images)},C.prototype.getImages=function(w,M){var z=!0;if(!this.isLoaded())for(var H=0,$=w;H<$.length;H+=1)this.images[$[H]]||(z=!1);this.isLoaded()||z?this._notify(w,M):this.requestors.push({ids:w,callback:M})},C.prototype._notify=function(w,M){for(var z={},H=0,$=w;H<$.length;H+=1){var ft=$[H];this.images[ft]||this.fire(new I.Event("styleimagemissing",{id:ft}));var Ut=this.images[ft];Ut?z[ft]={data:Ut.data.clone(),pixelRatio:Ut.pixelRatio,sdf:Ut.sdf,version:Ut.version,stretchX:Ut.stretchX,stretchY:Ut.stretchY,content:Ut.content,hasRenderCallback:Boolean(Ut.userImage&&Ut.userImage.render)}:I.warnOnce('Image "'+ft+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}M(null,z)},C.prototype.getPixelSize=function(){var w=this.atlasImage;return{width:w.width,height:w.height}},C.prototype.getPattern=function(w){var M=this.patterns[w],z=this.getImage(w);if(!z)return null;if(M&&M.position.version===z.version)return M.position;if(M)M.position.version=z.version;else{var H={w:z.data.width+2,h:z.data.height+2,x:0,y:0},$=new I.ImagePosition(H,z);this.patterns[w]={bin:H,position:$}}return this._updatePatternAtlas(),this.patterns[w].position},C.prototype.bind=function(w){var M=w.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new I.Texture(w,this.atlasImage,M.RGBA),this.atlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE)},C.prototype._updatePatternAtlas=function(){var w=[];for(var M in this.patterns)w.push(this.patterns[M].bin);var z=I.potpack(w),H=z.w,$=z.h,ft=this.atlasImage;for(var Ut in ft.resize({width:H||1,height:$||1}),this.patterns){var re=this.patterns[Ut].bin,De=re.x+1,Be=re.y+1,Le=this.images[Ut].data,cr=Le.width,ar=Le.height;I.RGBAImage.copy(Le,ft,{x:0,y:0},{x:De,y:Be},{width:cr,height:ar}),I.RGBAImage.copy(Le,ft,{x:0,y:ar-1},{x:De,y:Be-1},{width:cr,height:1}),I.RGBAImage.copy(Le,ft,{x:0,y:0},{x:De,y:Be+ar},{width:cr,height:1}),I.RGBAImage.copy(Le,ft,{x:cr-1,y:0},{x:De-1,y:Be},{width:1,height:ar}),I.RGBAImage.copy(Le,ft,{x:0,y:0},{x:De+cr,y:Be},{width:1,height:ar})}this.dirty=!0},C.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},C.prototype.dispatchRenderCallbacks=function(w){for(var M=0,z=w;M<z.length;M+=1){var H=z[M];if(!this.callbackDispatchedThisFrame[H]){this.callbackDispatchedThisFrame[H]=!0;var $=this.images[H];P($)&&this.updateImage(H,$)}}},C}(I.Evented),X=Ie,le=Ie,Se=1e20;function Ie(x,C,w,M,z,H){this.fontSize=x||24,this.buffer=C===void 0?3:C,this.cutoff=M||.25,this.fontFamily=z||"sans-serif",this.fontWeight=H||"normal",this.radius=w||8;var $=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=$,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array($*$),this.gridInner=new Float64Array($*$),this.f=new Float64Array($),this.d=new Float64Array($),this.z=new Float64Array($+1),this.v=new Int16Array($),this.middle=Math.round($/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function It(x,C,w,M,z,H,$){for(var ft=0;ft<C;ft++){for(var Ut=0;Ut<w;Ut++)M[Ut]=x[Ut*C+ft];for(rt(M,z,H,$,w),Ut=0;Ut<w;Ut++)x[Ut*C+ft]=z[Ut]}for(Ut=0;Ut<w;Ut++){for(ft=0;ft<C;ft++)M[ft]=x[Ut*C+ft];for(rt(M,z,H,$,C),ft=0;ft<C;ft++)x[Ut*C+ft]=Math.sqrt(z[ft])}}function rt(x,C,w,M,z){w[0]=0,M[0]=-Se,M[1]=+Se;for(var H=1,$=0;H<z;H++){for(var ft=(x[H]+H*H-(x[w[$]]+w[$]*w[$]))/(2*H-2*w[$]);ft<=M[$];)$--,ft=(x[H]+H*H-(x[w[$]]+w[$]*w[$]))/(2*H-2*w[$]);w[++$]=H,M[$]=ft,M[$+1]=+Se}for(H=0,$=0;H<z;H++){for(;M[$+1]<H;)$++;C[H]=(H-w[$])*(H-w[$])+x[w[$]]}}Ie.prototype.draw=function(x){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(x,this.buffer,this.middle);for(var C=this.ctx.getImageData(0,0,this.size,this.size),w=new Uint8ClampedArray(this.size*this.size),M=0;M<this.size*this.size;M++){var z=C.data[4*M+3]/255;this.gridOuter[M]=z===1?0:z===0?Se:Math.pow(Math.max(0,.5-z),2),this.gridInner[M]=z===1?Se:z===0?0:Math.pow(Math.max(0,z-.5),2)}for(It(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),It(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),M=0;M<this.size*this.size;M++)w[M]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[M]-this.gridInner[M])/this.radius+this.cutoff))));return w},X.default=le;var Dt=function(x,C){this.requestManager=x,this.localIdeographFontFamily=C,this.entries={}};Dt.prototype.setURL=function(x){this.url=x},Dt.prototype.getGlyphs=function(x,C){var w=this,M=[];for(var z in x)for(var H=0,$=x[z];H<$.length;H+=1)M.push({stack:z,id:$[H]});I.asyncAll(M,function(ft,Ut){var re=ft.stack,De=ft.id,Be=w.entries[re];Be||(Be=w.entries[re]={glyphs:{},requests:{},ranges:{}});var Le=Be.glyphs[De];if(Le===void 0){if(Le=w._tinySDF(Be,re,De))return Be.glyphs[De]=Le,void Ut(null,{stack:re,id:De,glyph:Le});var cr=Math.floor(De/256);if(256*cr>65535)Ut(new Error("glyphs > 65535 not supported"));else if(Be.ranges[cr])Ut(null,{stack:re,id:De,glyph:Le});else{var ar=Be.requests[cr];ar||(ar=Be.requests[cr]=[],Dt.loadGlyphRange(re,cr,w.url,w.requestManager,function(br,rr){if(rr){for(var xr in rr)w._doesCharSupportLocalGlyph(+xr)||(Be.glyphs[+xr]=rr[+xr]);Be.ranges[cr]=!0}for(var Pr=0,Rr=ar;Pr<Rr.length;Pr+=1)(0,Rr[Pr])(br,rr);delete Be.requests[cr]})),ar.push(function(br,rr){br?Ut(br):rr&&Ut(null,{stack:re,id:De,glyph:rr[De]||null})})}}else Ut(null,{stack:re,id:De,glyph:Le})},function(ft,Ut){if(ft)C(ft);else if(Ut){for(var re={},De=0,Be=Ut;De<Be.length;De+=1){var Le=Be[De],cr=Le.stack,ar=Le.id,br=Le.glyph;(re[cr]||(re[cr]={}))[ar]=br&&{id:br.id,bitmap:br.bitmap.clone(),metrics:br.metrics}}C(null,re)}})},Dt.prototype._doesCharSupportLocalGlyph=function(x){return!!this.localIdeographFontFamily&&(I.isChar["CJK Unified Ideographs"](x)||I.isChar["Hangul Syllables"](x)||I.isChar.Hiragana(x)||I.isChar.Katakana(x))},Dt.prototype._tinySDF=function(x,C,w){var M=this.localIdeographFontFamily;if(M&&this._doesCharSupportLocalGlyph(w)){var z=x.tinySDF;if(!z){var H="400";/bold/i.test(C)?H="900":/medium/i.test(C)?H="500":/light/i.test(C)&&(H="200"),z=x.tinySDF=new Dt.TinySDF(24,3,8,.25,M,H)}return{id:w,bitmap:new I.AlphaImage({width:30,height:30},z.draw(String.fromCharCode(w))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Dt.loadGlyphRange=function(x,C,w,M,z){var H=256*C,$=H+255,ft=M.transformRequest(M.normalizeGlyphsURL(w).replace("{fontstack}",x).replace("{range}",H+"-"+$),I.ResourceType.Glyphs);I.getArrayBuffer(ft,function(Ut,re){if(Ut)z(Ut);else if(re){for(var De={},Be=0,Le=I.parseGlyphPBF(re);Be<Le.length;Be+=1){var cr=Le[Be];De[cr.id]=cr}z(null,De)}})},Dt.TinySDF=X;var Ae=function(){this.specification=I.styleSpec.light.position};Ae.prototype.possiblyEvaluate=function(x,C){return I.sphericalToCartesian(x.expression.evaluate(C))},Ae.prototype.interpolate=function(x,C,w){return{x:I.number(x.x,C.x,w),y:I.number(x.y,C.y,w),z:I.number(x.z,C.z,w)}};var be=new I.Properties({anchor:new I.DataConstantProperty(I.styleSpec.light.anchor),position:new Ae,color:new I.DataConstantProperty(I.styleSpec.light.color),intensity:new I.DataConstantProperty(I.styleSpec.light.intensity)}),me=function(x){function C(w){x.call(this),this._transitionable=new I.Transitionable(be),this.setLight(w),this._transitioning=this._transitionable.untransitioned()}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getLight=function(){return this._transitionable.serialize()},C.prototype.setLight=function(w,M){if(M===void 0&&(M={}),!this._validate(I.validateLight,w,M))for(var z in w){var H=w[z];I.endsWith(z,"-transition")?this._transitionable.setTransition(z.slice(0,-11),H):this._transitionable.setValue(z,H)}},C.prototype.updateTransitions=function(w){this._transitioning=this._transitionable.transitioned(w,this._transitioning)},C.prototype.hasTransition=function(){return this._transitioning.hasTransition()},C.prototype.recalculate=function(w){this.properties=this._transitioning.possiblyEvaluate(w)},C.prototype._validate=function(w,M,z){return(!z||z.validate!==!1)&&I.emitValidationErrors(this,w.call(I.validateStyle,I.extend({value:M,style:{glyphs:!0,sprite:!0},styleSpec:I.styleSpec})))},C}(I.Evented),ee=function(x,C){this.width=x,this.height=C,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};ee.prototype.getDash=function(x,C){var w=x.join(",")+String(C);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(x,C)),this.dashEntry[w]},ee.prototype.getDashRanges=function(x,C,w){var M=[],z=x.length%2==1?-x[x.length-1]*w:0,H=x[0]*w,$=!0;M.push({left:z,right:H,isDash:$,zeroLength:x[0]===0});for(var ft=x[0],Ut=1;Ut<x.length;Ut++){var re=x[Ut];M.push({left:z=ft*w,right:H=(ft+=re)*w,isDash:$=!$,zeroLength:re===0})}return M},ee.prototype.addRoundDash=function(x,C,w){for(var M=C/2,z=-w;z<=w;z++)for(var H=this.width*(this.nextRow+w+z),$=0,ft=x[$],Ut=0;Ut<this.width;Ut++){Ut/ft.right>1&&(ft=x[++$]);var re=Math.abs(Ut-ft.left),De=Math.abs(Ut-ft.right),Be=Math.min(re,De),Le=void 0,cr=z/w*(M+1);if(ft.isDash){var ar=M-Math.abs(cr);Le=Math.sqrt(Be*Be+ar*ar)}else Le=M-Math.sqrt(Be*Be+cr*cr);this.data[H+Ut]=Math.max(0,Math.min(255,Le+128))}},ee.prototype.addRegularDash=function(x){for(var C=x.length-1;C>=0;--C){var w=x[C],M=x[C+1];w.zeroLength?x.splice(C,1):M&&M.isDash===w.isDash&&(M.left=w.left,x.splice(C,1))}var z=x[0],H=x[x.length-1];z.isDash===H.isDash&&(z.left=H.left-this.width,H.right=z.right+this.width);for(var $=this.width*this.nextRow,ft=0,Ut=x[ft],re=0;re<this.width;re++){re/Ut.right>1&&(Ut=x[++ft]);var De=Math.abs(re-Ut.left),Be=Math.abs(re-Ut.right),Le=Math.min(De,Be);this.data[$+re]=Math.max(0,Math.min(255,(Ut.isDash?Le:-Le)+128))}},ee.prototype.addDash=function(x,C){var w=C?7:0,M=2*w+1;if(this.nextRow+M>this.height)return I.warnOnce("LineAtlas out of space"),null;for(var z=0,H=0;H<x.length;H++)z+=x[H];if(z!==0){var $=this.width/z,ft=this.getDashRanges(x,this.width,$);C?this.addRoundDash(ft,$,w):this.addRegularDash(ft)}var Ut={y:(this.nextRow+w+.5)/this.height,height:2*w/this.height,width:z};return this.nextRow+=M,this.dirty=!0,Ut},ee.prototype.bind=function(x){var C=x.gl;this.texture?(C.bindTexture(C.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,C.texSubImage2D(C.TEXTURE_2D,0,0,0,this.width,this.height,C.ALPHA,C.UNSIGNED_BYTE,this.data))):(this.texture=C.createTexture(),C.bindTexture(C.TEXTURE_2D,this.texture),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,C.REPEAT),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,C.LINEAR),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,C.LINEAR),C.texImage2D(C.TEXTURE_2D,0,C.ALPHA,this.width,this.height,0,C.ALPHA,C.UNSIGNED_BYTE,this.data))};var we=function x(C,w){this.workerPool=C,this.actors=[],this.currentActor=0,this.id=I.uniqueId();for(var M=this.workerPool.acquire(this.id),z=0;z<M.length;z++){var H=new x.Actor(M[z],w,this.id);H.name="Worker "+z,this.actors.push(H)}};function _e(x,C,w){var M=function(z,H){if(z)return w(z);if(H){var $=I.pick(I.extend(H,x),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);H.vector_layers&&($.vectorLayers=H.vector_layers,$.vectorLayerIds=$.vectorLayers.map(function(ft){return ft.id})),$.tiles=C.canonicalizeTileset($,x.url),w(null,$)}};return x.url?I.getJSON(C.transformRequest(C.normalizeSourceURL(x.url),I.ResourceType.Source),M):I.browser.frame(function(){return M(null,x)})}we.prototype.broadcast=function(x,C,w){I.asyncAll(this.actors,function(M,z){M.send(x,C,z)},w=w||function(){})},we.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},we.prototype.remove=function(){this.actors.forEach(function(x){x.remove()}),this.actors=[],this.workerPool.release(this.id)},we.Actor=I.Actor;var gt=function(x,C,w){this.bounds=I.LngLatBounds.convert(this.validateBounds(x)),this.minzoom=C||0,this.maxzoom=w||24};gt.prototype.validateBounds=function(x){return Array.isArray(x)&&x.length===4?[Math.max(-180,x[0]),Math.max(-90,x[1]),Math.min(180,x[2]),Math.min(90,x[3])]:[-180,-90,180,90]},gt.prototype.contains=function(x){var C=Math.pow(2,x.z),w=Math.floor(I.mercatorXfromLng(this.bounds.getWest())*C),M=Math.floor(I.mercatorYfromLat(this.bounds.getNorth())*C),z=Math.ceil(I.mercatorXfromLng(this.bounds.getEast())*C),H=Math.ceil(I.mercatorYfromLat(this.bounds.getSouth())*C);return x.x>=w&&x.x<z&&x.y>=M&&x.y<H};var Pt=function(x){function C(w,M,z,H){if(x.call(this),this.id=w,this.dispatcher=z,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,I.extend(this,I.pick(M,["url","scheme","tileSize","promoteId"])),this._options=I.extend({type:"vector"},M),this._collectResourceTiming=M.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(H)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var w=this;this._loaded=!1,this.fire(new I.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_e(this._options,this.map._requestManager,function(M,z){w._tileJSONRequest=null,w._loaded=!0,M?w.fire(new I.ErrorEvent(M)):z&&(I.extend(w,z),z.bounds&&(w.tileBounds=new gt(z.bounds,w.minzoom,w.maxzoom)),I.postTurnstileEvent(z.tiles,w.map._requestManager._customAccessToken),I.postMapLoadEvent(z.tiles,w.map._getMapId(),w.map._requestManager._skuToken,w.map._requestManager._customAccessToken),w.fire(new I.Event("data",{dataType:"source",sourceDataType:"metadata"})),w.fire(new I.Event("data",{dataType:"source",sourceDataType:"content"})))})},C.prototype.loaded=function(){return this._loaded},C.prototype.hasTile=function(w){return!this.tileBounds||this.tileBounds.contains(w.canonical)},C.prototype.onAdd=function(w){this.map=w,this.load()},C.prototype.setSourceProperty=function(w){this._tileJSONRequest&&this._tileJSONRequest.cancel(),w(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},C.prototype.setTiles=function(w){var M=this;return this.setSourceProperty(function(){M._options.tiles=w}),this},C.prototype.setUrl=function(w){var M=this;return this.setSourceProperty(function(){M.url=w,M._options.url=w}),this},C.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},C.prototype.serialize=function(){return I.extend({},this._options)},C.prototype.loadTile=function(w,M){var z=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme)),H={request:this.map._requestManager.transformRequest(z,I.ResourceType.Tile),uid:w.uid,tileID:w.tileID,zoom:w.tileID.overscaledZ,tileSize:this.tileSize*w.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:I.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function $(ft,Ut){return delete w.request,w.aborted?M(null):ft&&ft.status!==404?M(ft):(Ut&&Ut.resourceTiming&&(w.resourceTiming=Ut.resourceTiming),this.map._refreshExpiredTiles&&Ut&&w.setExpiryData(Ut),w.loadVectorData(Ut,this.map.painter),I.cacheEntryPossiblyAdded(this.dispatcher),M(null),void(w.reloadCallback&&(this.loadTile(w,w.reloadCallback),w.reloadCallback=null)))}H.request.collectResourceTiming=this._collectResourceTiming,w.actor&&w.state!=="expired"?w.state==="loading"?w.reloadCallback=M:w.request=w.actor.send("reloadTile",H,$.bind(this)):(w.actor=this.dispatcher.getActor(),w.request=w.actor.send("loadTile",H,$.bind(this)))},C.prototype.abortTile=function(w){w.request&&(w.request.cancel(),delete w.request),w.actor&&w.actor.send("abortTile",{uid:w.uid,type:this.type,source:this.id},void 0)},C.prototype.unloadTile=function(w){w.unloadVectorData(),w.actor&&w.actor.send("removeTile",{uid:w.uid,type:this.type,source:this.id},void 0)},C.prototype.hasTransition=function(){return!1},C}(I.Evented),J=function(x){function C(w,M,z,H){x.call(this),this.id=w,this.dispatcher=z,this.setEventedParent(H),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=I.extend({type:"raster"},M),I.extend(this,I.pick(M,["url","scheme","tileSize"]))}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var w=this;this._loaded=!1,this.fire(new I.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_e(this._options,this.map._requestManager,function(M,z){w._tileJSONRequest=null,w._loaded=!0,M?w.fire(new I.ErrorEvent(M)):z&&(I.extend(w,z),z.bounds&&(w.tileBounds=new gt(z.bounds,w.minzoom,w.maxzoom)),I.postTurnstileEvent(z.tiles),I.postMapLoadEvent(z.tiles,w.map._getMapId(),w.map._requestManager._skuToken),w.fire(new I.Event("data",{dataType:"source",sourceDataType:"metadata"})),w.fire(new I.Event("data",{dataType:"source",sourceDataType:"content"})))})},C.prototype.loaded=function(){return this._loaded},C.prototype.onAdd=function(w){this.map=w,this.load()},C.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},C.prototype.serialize=function(){return I.extend({},this._options)},C.prototype.hasTile=function(w){return!this.tileBounds||this.tileBounds.contains(w.canonical)},C.prototype.loadTile=function(w,M){var z=this,H=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);w.request=I.getImage(this.map._requestManager.transformRequest(H,I.ResourceType.Tile),function($,ft){if(delete w.request,w.aborted)w.state="unloaded",M(null);else if($)w.state="errored",M($);else if(ft){z.map._refreshExpiredTiles&&w.setExpiryData(ft),delete ft.cacheControl,delete ft.expires;var Ut=z.map.painter.context,re=Ut.gl;w.texture=z.map.painter.getTileTexture(ft.width),w.texture?w.texture.update(ft,{useMipmap:!0}):(w.texture=new I.Texture(Ut,ft,re.RGBA,{useMipmap:!0}),w.texture.bind(re.LINEAR,re.CLAMP_TO_EDGE,re.LINEAR_MIPMAP_NEAREST),Ut.extTextureFilterAnisotropic&&re.texParameterf(re.TEXTURE_2D,Ut.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ut.extTextureFilterAnisotropicMax)),w.state="loaded",I.cacheEntryPossiblyAdded(z.dispatcher),M(null)}})},C.prototype.abortTile=function(w,M){w.request&&(w.request.cancel(),delete w.request),M()},C.prototype.unloadTile=function(w,M){w.texture&&this.map.painter.saveTileTexture(w.texture),M()},C.prototype.hasTransition=function(){return!1},C}(I.Evented),vt=function(x){function C(w,M,z,H){x.call(this,w,M,z,H),this.type="raster-dem",this.maxzoom=22,this._options=I.extend({type:"raster-dem"},M),this.encoding=M.encoding||"mapbox"}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},C.prototype.loadTile=function(w,M){var z=this.map._requestManager.normalizeTileURL(w.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function H($,ft){$&&(w.state="errored",M($)),ft&&(w.dem=ft,w.needsHillshadePrepare=!0,w.state="loaded",M(null))}w.request=I.getImage(this.map._requestManager.transformRequest(z,I.ResourceType.Tile),function($,ft){if(delete w.request,w.aborted)w.state="unloaded",M(null);else if($)w.state="errored",M($);else if(ft){this.map._refreshExpiredTiles&&w.setExpiryData(ft),delete ft.cacheControl,delete ft.expires;var Ut=I.window.ImageBitmap&&ft instanceof I.window.ImageBitmap&&I.offscreenCanvasSupported()?ft:I.browser.getImageData(ft,1),re={uid:w.uid,coord:w.tileID,source:this.id,rawImageData:Ut,encoding:this.encoding};w.actor&&w.state!=="expired"||(w.actor=this.dispatcher.getActor(),w.actor.send("loadDEMTile",re,H.bind(this)))}}.bind(this)),w.neighboringTiles=this._getNeighboringTiles(w.tileID)},C.prototype._getNeighboringTiles=function(w){var M=w.canonical,z=Math.pow(2,M.z),H=(M.x-1+z)%z,$=M.x===0?w.wrap-1:w.wrap,ft=(M.x+1+z)%z,Ut=M.x+1===z?w.wrap+1:w.wrap,re={};return re[new I.OverscaledTileID(w.overscaledZ,$,M.z,H,M.y).key]={backfilled:!1},re[new I.OverscaledTileID(w.overscaledZ,Ut,M.z,ft,M.y).key]={backfilled:!1},M.y>0&&(re[new I.OverscaledTileID(w.overscaledZ,$,M.z,H,M.y-1).key]={backfilled:!1},re[new I.OverscaledTileID(w.overscaledZ,w.wrap,M.z,M.x,M.y-1).key]={backfilled:!1},re[new I.OverscaledTileID(w.overscaledZ,Ut,M.z,ft,M.y-1).key]={backfilled:!1}),M.y+1<z&&(re[new I.OverscaledTileID(w.overscaledZ,$,M.z,H,M.y+1).key]={backfilled:!1},re[new I.OverscaledTileID(w.overscaledZ,w.wrap,M.z,M.x,M.y+1).key]={backfilled:!1},re[new I.OverscaledTileID(w.overscaledZ,Ut,M.z,ft,M.y+1).key]={backfilled:!1}),re},C.prototype.unloadTile=function(w){w.demTexture&&this.map.painter.saveTileTexture(w.demTexture),w.fbo&&(w.fbo.destroy(),delete w.fbo),w.dem&&delete w.dem,delete w.neighboringTiles,w.state="unloaded",w.actor&&w.actor.send("removeDEMTile",{uid:w.uid,source:this.id})},C}(J),W=function(x){function C(w,M,z,H){x.call(this),this.id=w,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=z.getActor(),this.setEventedParent(H),this._data=M.data,this._options=I.extend({},M),this._collectResourceTiming=M.collectResourceTiming,this._resourceTiming=[],M.maxzoom!==void 0&&(this.maxzoom=M.maxzoom),M.type&&(this.type=M.type),M.attribution&&(this.attribution=M.attribution),this.promoteId=M.promoteId;var $=I.EXTENT/this.tileSize;this.workerOptions=I.extend({source:this.id,cluster:M.cluster||!1,geojsonVtOptions:{buffer:(M.buffer!==void 0?M.buffer:128)*$,tolerance:(M.tolerance!==void 0?M.tolerance:.375)*$,extent:I.EXTENT,maxZoom:this.maxzoom,lineMetrics:M.lineMetrics||!1,generateId:M.generateId||!1},superclusterOptions:{maxZoom:M.clusterMaxZoom!==void 0?Math.min(M.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,M.clusterMinPoints||2),extent:I.EXTENT,radius:(M.clusterRadius||50)*$,log:!1,generateId:M.generateId||!1},clusterProperties:M.clusterProperties,filter:M.filter},M.workerOptions)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var w=this;this.fire(new I.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(M){if(M)w.fire(new I.ErrorEvent(M));else{var z={dataType:"source",sourceDataType:"metadata"};w._collectResourceTiming&&w._resourceTiming&&w._resourceTiming.length>0&&(z.resourceTiming=w._resourceTiming,w._resourceTiming=[]),w.fire(new I.Event("data",z))}})},C.prototype.onAdd=function(w){this.map=w,this.load()},C.prototype.setData=function(w){var M=this;return this._data=w,this.fire(new I.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(z){if(z)M.fire(new I.ErrorEvent(z));else{var H={dataType:"source",sourceDataType:"content"};M._collectResourceTiming&&M._resourceTiming&&M._resourceTiming.length>0&&(H.resourceTiming=M._resourceTiming,M._resourceTiming=[]),M.fire(new I.Event("data",H))}}),this},C.prototype.getClusterExpansionZoom=function(w,M){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:w,source:this.id},M),this},C.prototype.getClusterChildren=function(w,M){return this.actor.send("geojson.getClusterChildren",{clusterId:w,source:this.id},M),this},C.prototype.getClusterLeaves=function(w,M,z,H){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:w,limit:M,offset:z},H),this},C.prototype._updateWorkerData=function(w){var M=this;this._loaded=!1;var z=I.extend({},this.workerOptions),H=this._data;typeof H=="string"?(z.request=this.map._requestManager.transformRequest(I.browser.resolveURL(H),I.ResourceType.Source),z.request.collectResourceTiming=this._collectResourceTiming):z.data=JSON.stringify(H),this.actor.send(this.type+".loadData",z,function($,ft){M._removed||ft&&ft.abandoned||(M._loaded=!0,ft&&ft.resourceTiming&&ft.resourceTiming[M.id]&&(M._resourceTiming=ft.resourceTiming[M.id].slice(0)),M.actor.send(M.type+".coalesce",{source:z.source},null),w($))})},C.prototype.loaded=function(){return this._loaded},C.prototype.loadTile=function(w,M){var z=this,H=w.actor?"reloadTile":"loadTile";w.actor=this.actor,w.request=this.actor.send(H,{type:this.type,uid:w.uid,tileID:w.tileID,zoom:w.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:I.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function($,ft){return delete w.request,w.unloadVectorData(),w.aborted?M(null):$?M($):(w.loadVectorData(ft,z.map.painter,H==="reloadTile"),M(null))})},C.prototype.abortTile=function(w){w.request&&(w.request.cancel(),delete w.request),w.aborted=!0},C.prototype.unloadTile=function(w){w.unloadVectorData(),this.actor.send("removeTile",{uid:w.uid,type:this.type,source:this.id})},C.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},C.prototype.serialize=function(){return I.extend({},this._options,{type:this.type,data:this._data})},C.prototype.hasTransition=function(){return!1},C}(I.Evented),dt=I.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Vt=function(x){function C(w,M,z,H){x.call(this),this.id=w,this.dispatcher=z,this.coordinates=M.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(H),this.options=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(w,M){var z=this;this._loaded=!1,this.fire(new I.Event("dataloading",{dataType:"source"})),this.url=this.options.url,I.getImage(this.map._requestManager.transformRequest(this.url,I.ResourceType.Image),function(H,$){z._loaded=!0,H?z.fire(new I.ErrorEvent(H)):$&&(z.image=$,w&&(z.coordinates=w),M&&M(),z._finishLoading())})},C.prototype.loaded=function(){return this._loaded},C.prototype.updateImage=function(w){var M=this;return this.image&&w.url?(this.options.url=w.url,this.load(w.coordinates,function(){M.texture=null}),this):this},C.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new I.Event("data",{dataType:"source",sourceDataType:"metadata"})))},C.prototype.onAdd=function(w){this.map=w,this.load()},C.prototype.setCoordinates=function(w){var M=this;this.coordinates=w;var z=w.map(I.MercatorCoordinate.fromLngLat);this.tileID=function($){for(var ft=1/0,Ut=1/0,re=-1/0,De=-1/0,Be=0,Le=$;Be<Le.length;Be+=1){var cr=Le[Be];ft=Math.min(ft,cr.x),Ut=Math.min(Ut,cr.y),re=Math.max(re,cr.x),De=Math.max(De,cr.y)}var ar=Math.max(re-ft,De-Ut),br=Math.max(0,Math.floor(-Math.log(ar)/Math.LN2)),rr=Math.pow(2,br);return new I.CanonicalTileID(br,Math.floor((ft+re)/2*rr),Math.floor((Ut+De)/2*rr))}(z),this.minzoom=this.maxzoom=this.tileID.z;var H=z.map(function($){return M.tileID.getTilePoint($)._round()});return this._boundsArray=new I.StructArrayLayout4i8,this._boundsArray.emplaceBack(H[0].x,H[0].y,0,0),this._boundsArray.emplaceBack(H[1].x,H[1].y,I.EXTENT,0),this._boundsArray.emplaceBack(H[3].x,H[3].y,0,I.EXTENT),this._boundsArray.emplaceBack(H[2].x,H[2].y,I.EXTENT,I.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new I.Event("data",{dataType:"source",sourceDataType:"content"})),this},C.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var w=this.map.painter.context,M=w.gl;for(var z in this.boundsBuffer||(this.boundsBuffer=w.createVertexBuffer(this._boundsArray,dt.members)),this.boundsSegments||(this.boundsSegments=I.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new I.Texture(w,this.image,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[z];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},C.prototype.loadTile=function(w,M){this.tileID&&this.tileID.equals(w.tileID.canonical)?(this.tiles[String(w.tileID.wrap)]=w,w.buckets={},M(null)):(w.state="errored",M(null))},C.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},C.prototype.hasTransition=function(){return!1},C}(I.Evented),ne=function(x){function C(w,M,z,H){x.call(this,w,M,z,H),this.roundZoom=!0,this.type="video",this.options=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){var w=this;this._loaded=!1;var M=this.options;this.urls=[];for(var z=0,H=M.urls;z<H.length;z+=1)this.urls.push(this.map._requestManager.transformRequest(H[z],I.ResourceType.Source).url);I.getVideo(this.urls,function($,ft){w._loaded=!0,$?w.fire(new I.ErrorEvent($)):ft&&(w.video=ft,w.video.loop=!0,w.video.addEventListener("playing",function(){w.map.triggerRepaint()}),w.map&&w.video.play(),w._finishLoading())})},C.prototype.pause=function(){this.video&&this.video.pause()},C.prototype.play=function(){this.video&&this.video.play()},C.prototype.seek=function(w){if(this.video){var M=this.video.seekable;w<M.start(0)||w>M.end(0)?this.fire(new I.ErrorEvent(new I.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+M.start(0)+" and "+M.end(0)+"-second mark."))):this.video.currentTime=w}},C.prototype.getVideo=function(){return this.video},C.prototype.onAdd=function(w){this.map||(this.map=w,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},C.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var w=this.map.painter.context,M=w.gl;for(var z in this.boundsBuffer||(this.boundsBuffer=w.createVertexBuffer(this._boundsArray,dt.members)),this.boundsSegments||(this.boundsSegments=I.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.texSubImage2D(M.TEXTURE_2D,0,0,0,M.RGBA,M.UNSIGNED_BYTE,this.video)):(this.texture=new I.Texture(w,this.video,M.RGBA),this.texture.bind(M.LINEAR,M.CLAMP_TO_EDGE)),this.tiles){var H=this.tiles[z];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}}},C.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},C.prototype.hasTransition=function(){return this.video&&!this.video.paused},C}(Vt),ge=function(x){function C(w,M,z,H){x.call(this,w,M,z,H),M.coordinates?Array.isArray(M.coordinates)&&M.coordinates.length===4&&!M.coordinates.some(function($){return!Array.isArray($)||$.length!==2||$.some(function(ft){return typeof ft!="number"})})||this.fire(new I.ErrorEvent(new I.ValidationError("sources."+w,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new I.ErrorEvent(new I.ValidationError("sources."+w,null,'missing required property "coordinates"'))),M.animate&&typeof M.animate!="boolean"&&this.fire(new I.ErrorEvent(new I.ValidationError("sources."+w,null,'optional "animate" property must be a boolean value'))),M.canvas?typeof M.canvas=="string"||M.canvas instanceof I.window.HTMLCanvasElement||this.fire(new I.ErrorEvent(new I.ValidationError("sources."+w,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new I.ErrorEvent(new I.ValidationError("sources."+w,null,'missing required property "canvas"'))),this.options=M,this.animate=M.animate===void 0||M.animate}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof I.window.HTMLCanvasElement?this.options.canvas:I.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new I.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},C.prototype.getCanvas=function(){return this.canvas},C.prototype.onAdd=function(w){this.map=w,this.load(),this.canvas&&this.animate&&this.play()},C.prototype.onRemove=function(){this.pause()},C.prototype.prepare=function(){var w=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,w=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,w=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var M=this.map.painter.context,z=M.gl;for(var H in this.boundsBuffer||(this.boundsBuffer=M.createVertexBuffer(this._boundsArray,dt.members)),this.boundsSegments||(this.boundsSegments=I.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(w||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new I.Texture(M,this.canvas,z.RGBA,{premultiply:!0}),this.tiles){var $=this.tiles[H];$.state!=="loaded"&&($.state="loaded",$.texture=this.texture)}}},C.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},C.prototype.hasTransition=function(){return this._playing},C.prototype._hasInvalidDimensions=function(){for(var w=0,M=[this.canvas.width,this.canvas.height];w<M.length;w+=1){var z=M[w];if(isNaN(z)||z<=0)return!0}return!1},C}(Vt),$e={vector:Pt,raster:J,"raster-dem":vt,geojson:W,video:ne,image:Vt,canvas:ge};function jt(x,C){var w=I.identity([]);return I.translate(w,w,[1,1,0]),I.scale(w,w,[.5*x.width,.5*x.height,1]),I.multiply(w,w,x.calculatePosMatrix(C.toUnwrapped()))}function Qt(x,C,w,M,z,H){var $=function(br,rr,xr){if(br)for(var Pr=0,Rr=br;Pr<Rr.length;Pr+=1){var gn=rr[Rr[Pr]];if(gn&&gn.source===xr&&gn.type==="fill-extrusion")return!0}else for(var ln in rr){var bn=rr[ln];if(bn.source===xr&&bn.type==="fill-extrusion")return!0}return!1}(z&&z.layers,C,x.id),ft=H.maxPitchScaleFactor(),Ut=x.tilesIn(M,ft,$);Ut.sort(Te);for(var re=[],De=0,Be=Ut;De<Be.length;De+=1){var Le=Be[De];re.push({wrappedTileID:Le.tileID.wrapped().key,queryResults:Le.tile.queryRenderedFeatures(C,w,x._state,Le.queryGeometry,Le.cameraQueryGeometry,Le.scale,z,H,ft,jt(x.transform,Le.tileID))})}var cr=function(br){for(var rr={},xr={},Pr=0,Rr=br;Pr<Rr.length;Pr+=1){var gn=Rr[Pr],ln=gn.queryResults,bn=gn.wrappedTileID,Zn=xr[bn]=xr[bn]||{};for(var Kn in ln)for(var ci=ln[Kn],Oi=Zn[Kn]=Zn[Kn]||{},na=rr[Kn]=rr[Kn]||[],ia=0,ua=ci;ia<ua.length;ia+=1){var Qa=ua[ia];Oi[Qa.featureIndex]||(Oi[Qa.featureIndex]=!0,na.push(Qa))}}return rr}(re);for(var ar in cr)cr[ar].forEach(function(br){var rr=br.feature,xr=x.getFeatureState(rr.layer["source-layer"],rr.id);rr.source=rr.layer.source,rr.layer["source-layer"]&&(rr.sourceLayer=rr.layer["source-layer"]),rr.state=xr});return cr}function Te(x,C){var w=x.tileID,M=C.tileID;return w.overscaledZ-M.overscaledZ||w.canonical.y-M.canonical.y||w.wrap-M.wrap||w.canonical.x-M.canonical.x}var ae=function(x,C){this.max=x,this.onRemove=C,this.reset()};ae.prototype.reset=function(){for(var x in this.data)for(var C=0,w=this.data[x];C<w.length;C+=1){var M=w[C];M.timeout&&clearTimeout(M.timeout),this.onRemove(M.value)}return this.data={},this.order=[],this},ae.prototype.add=function(x,C,w){var M=this,z=x.wrapped().key;this.data[z]===void 0&&(this.data[z]=[]);var H={value:C,timeout:void 0};if(w!==void 0&&(H.timeout=setTimeout(function(){M.remove(x,H)},w)),this.data[z].push(H),this.order.push(z),this.order.length>this.max){var $=this._getAndRemoveByKey(this.order[0]);$&&this.onRemove($)}return this},ae.prototype.has=function(x){return x.wrapped().key in this.data},ae.prototype.getAndRemove=function(x){return this.has(x)?this._getAndRemoveByKey(x.wrapped().key):null},ae.prototype._getAndRemoveByKey=function(x){var C=this.data[x].shift();return C.timeout&&clearTimeout(C.timeout),this.data[x].length===0&&delete this.data[x],this.order.splice(this.order.indexOf(x),1),C.value},ae.prototype.getByKey=function(x){var C=this.data[x];return C?C[0].value:null},ae.prototype.get=function(x){return this.has(x)?this.data[x.wrapped().key][0].value:null},ae.prototype.remove=function(x,C){if(!this.has(x))return this;var w=x.wrapped().key,M=C===void 0?0:this.data[w].indexOf(C),z=this.data[w][M];return this.data[w].splice(M,1),z.timeout&&clearTimeout(z.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(z.value),this.order.splice(this.order.indexOf(w),1),this},ae.prototype.setMaxSize=function(x){for(this.max=x;this.order.length>this.max;){var C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this},ae.prototype.filter=function(x){var C=[];for(var w in this.data)for(var M=0,z=this.data[w];M<z.length;M+=1){var H=z[M];x(H.value)||C.push(H)}for(var $=0,ft=C;$<ft.length;$+=1){var Ut=ft[$];this.remove(Ut.value.tileID,Ut)}};var Ke=function(x,C,w){this.context=x;var M=x.gl;this.buffer=M.createBuffer(),this.dynamicDraw=Boolean(w),this.context.unbindVAO(),x.bindElementBuffer.set(this.buffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer};Ke.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ke.prototype.updateData=function(x){var C=this.context.gl;this.context.unbindVAO(),this.bind(),C.bufferSubData(C.ELEMENT_ARRAY_BUFFER,0,x.arrayBuffer)},Ke.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var or={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ie=function(x,C,w,M){this.length=C.length,this.attributes=w,this.itemSize=C.bytesPerElement,this.dynamicDraw=M,this.context=x;var z=x.gl;this.buffer=z.createBuffer(),x.bindVertexBuffer.set(this.buffer),z.bufferData(z.ARRAY_BUFFER,C.arrayBuffer,this.dynamicDraw?z.DYNAMIC_DRAW:z.STATIC_DRAW),this.dynamicDraw||delete C.arrayBuffer};ie.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ie.prototype.updateData=function(x){var C=this.context.gl;this.bind(),C.bufferSubData(C.ARRAY_BUFFER,0,x.arrayBuffer)},ie.prototype.enableAttributes=function(x,C){for(var w=0;w<this.attributes.length;w++){var M=C.attributes[this.attributes[w].name];M!==void 0&&x.enableVertexAttribArray(M)}},ie.prototype.setVertexAttribPointers=function(x,C,w){for(var M=0;M<this.attributes.length;M++){var z=this.attributes[M],H=C.attributes[z.name];H!==void 0&&x.vertexAttribPointer(H,z.components,x[or[z.type]],!1,this.itemSize,z.offset+this.itemSize*(w||0))}},ie.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var te=function(x){this.gl=x.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};te.prototype.get=function(){return this.current},te.prototype.set=function(x){},te.prototype.getDefault=function(){return this.default},te.prototype.setDefault=function(){this.set(this.default)};var St=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return I.Color.transparent},C.prototype.set=function(w){var M=this.current;(w.r!==M.r||w.g!==M.g||w.b!==M.b||w.a!==M.a||this.dirty)&&(this.gl.clearColor(w.r,w.g,w.b,w.a),this.current=w,this.dirty=!1)},C}(te),qt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 1},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.clearDepth(w),this.current=w,this.dirty=!1)},C}(te),$t=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 0},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.clearStencil(w),this.current=w,this.dirty=!1)},C}(te),Ct=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return[!0,!0,!0,!0]},C.prototype.set=function(w){var M=this.current;(w[0]!==M[0]||w[1]!==M[1]||w[2]!==M[2]||w[3]!==M[3]||this.dirty)&&(this.gl.colorMask(w[0],w[1],w[2],w[3]),this.current=w,this.dirty=!1)},C}(te),Tt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!0},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.depthMask(w),this.current=w,this.dirty=!1)},C}(te),ue=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 255},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.stencilMask(w),this.current=w,this.dirty=!1)},C}(te),Oe=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},C.prototype.set=function(w){var M=this.current;(w.func!==M.func||w.ref!==M.ref||w.mask!==M.mask||this.dirty)&&(this.gl.stencilFunc(w.func,w.ref,w.mask),this.current=w,this.dirty=!1)},C}(te),We=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var w=this.gl;return[w.KEEP,w.KEEP,w.KEEP]},C.prototype.set=function(w){var M=this.current;(w[0]!==M[0]||w[1]!==M[1]||w[2]!==M[2]||this.dirty)&&(this.gl.stencilOp(w[0],w[1],w[2]),this.current=w,this.dirty=!1)},C}(te),zt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;w?M.enable(M.STENCIL_TEST):M.disable(M.STENCIL_TEST),this.current=w,this.dirty=!1}},C}(te),At=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return[0,1]},C.prototype.set=function(w){var M=this.current;(w[0]!==M[0]||w[1]!==M[1]||this.dirty)&&(this.gl.depthRange(w[0],w[1]),this.current=w,this.dirty=!1)},C}(te),Mt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;w?M.enable(M.DEPTH_TEST):M.disable(M.DEPTH_TEST),this.current=w,this.dirty=!1}},C}(te),Rt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.LESS},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.depthFunc(w),this.current=w,this.dirty=!1)},C}(te),tt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;w?M.enable(M.BLEND):M.disable(M.BLEND),this.current=w,this.dirty=!1}},C}(te),_t=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var w=this.gl;return[w.ONE,w.ZERO]},C.prototype.set=function(w){var M=this.current;(w[0]!==M[0]||w[1]!==M[1]||this.dirty)&&(this.gl.blendFunc(w[0],w[1]),this.current=w,this.dirty=!1)},C}(te),Xt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return I.Color.transparent},C.prototype.set=function(w){var M=this.current;(w.r!==M.r||w.g!==M.g||w.b!==M.b||w.a!==M.a||this.dirty)&&(this.gl.blendColor(w.r,w.g,w.b,w.a),this.current=w,this.dirty=!1)},C}(te),ve=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.FUNC_ADD},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.blendEquation(w),this.current=w,this.dirty=!1)},C}(te),Wt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;w?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),this.current=w,this.dirty=!1}},C}(te),Me=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.BACK},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.cullFace(w),this.current=w,this.dirty=!1)},C}(te),je=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.CCW},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.frontFace(w),this.current=w,this.dirty=!1)},C}(te),Qe=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.useProgram(w),this.current=w,this.dirty=!1)},C}(te),hr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return this.gl.TEXTURE0},C.prototype.set=function(w){(w!==this.current||this.dirty)&&(this.gl.activeTexture(w),this.current=w,this.dirty=!1)},C}(te),er=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){var w=this.gl;return[0,0,w.drawingBufferWidth,w.drawingBufferHeight]},C.prototype.set=function(w){var M=this.current;(w[0]!==M[0]||w[1]!==M[1]||w[2]!==M[2]||w[3]!==M[3]||this.dirty)&&(this.gl.viewport(w[0],w[1],w[2],w[3]),this.current=w,this.dirty=!1)},C}(te),Br=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.bindFramebuffer(M.FRAMEBUFFER,w),this.current=w,this.dirty=!1}},C}(te),Lr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.bindRenderbuffer(M.RENDERBUFFER,w),this.current=w,this.dirty=!1}},C}(te),Zr=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.bindTexture(M.TEXTURE_2D,w),this.current=w,this.dirty=!1}},C}(te),Tn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.bindBuffer(M.ARRAY_BUFFER,w),this.current=w,this.dirty=!1}},C}(te),rn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){var M=this.gl;M.bindBuffer(M.ELEMENT_ARRAY_BUFFER,w),this.current=w,this.dirty=!1},C}(te),Nn=function(x){function C(w){x.call(this,w),this.vao=w.extVertexArrayObject}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C.prototype.set=function(w){this.vao&&(w!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(w),this.current=w,this.dirty=!1)},C}(te),zn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return 4},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_ALIGNMENT,w),this.current=w,this.dirty=!1}},C}(te),jn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w),this.current=w,this.dirty=!1}},C}(te),wn=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return!1},C.prototype.set=function(w){if(w!==this.current||this.dirty){var M=this.gl;M.pixelStorei(M.UNPACK_FLIP_Y_WEBGL,w),this.current=w,this.dirty=!1}},C}(te),Wn=function(x){function C(w,M){x.call(this,w),this.context=w,this.parent=M}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getDefault=function(){return null},C}(te),Bt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.setDirty=function(){this.dirty=!0},C.prototype.set=function(w){if(w!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_2D,w,0),this.current=w,this.dirty=!1}},C}(Wn),Yt=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.set=function(w){if(w!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var M=this.gl;M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,M.RENDERBUFFER,w),this.current=w,this.dirty=!1}},C}(Wn),oe=function(x,C,w,M){this.context=x,this.width=C,this.height=w;var z=this.framebuffer=x.gl.createFramebuffer();this.colorAttachment=new Bt(x,z),M&&(this.depthAttachment=new Yt(x,z))};oe.prototype.destroy=function(){var x=this.context.gl,C=this.colorAttachment.get();if(C&&x.deleteTexture(C),this.depthAttachment){var w=this.depthAttachment.get();w&&x.deleteRenderbuffer(w)}x.deleteFramebuffer(this.framebuffer)};var Ce=function(x,C,w){this.func=x,this.mask=C,this.range=w};Ce.ReadOnly=!1,Ce.ReadWrite=!0,Ce.disabled=new Ce(519,Ce.ReadOnly,[0,1]);var Ue=function(x,C,w,M,z,H){this.test=x,this.ref=C,this.mask=w,this.fail=M,this.depthFail=z,this.pass=H};Ue.disabled=new Ue({func:519,mask:0},0,0,7680,7680,7680);var fr=function(x,C,w){this.blendFunction=x,this.blendColor=C,this.mask=w};fr.disabled=new fr(fr.Replace=[1,0],I.Color.transparent,[!1,!1,!1,!1]),fr.unblended=new fr(fr.Replace,I.Color.transparent,[!0,!0,!0,!0]),fr.alphaBlended=new fr([1,771],I.Color.transparent,[!0,!0,!0,!0]);var Sr=function(x,C,w){this.enable=x,this.mode=C,this.frontFace=w};Sr.disabled=new Sr(!1,1029,2305),Sr.backCCW=new Sr(!0,1029,2305);var Pe=function(x){this.gl=x,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new St(this),this.clearDepth=new qt(this),this.clearStencil=new $t(this),this.colorMask=new Ct(this),this.depthMask=new Tt(this),this.stencilMask=new ue(this),this.stencilFunc=new Oe(this),this.stencilOp=new We(this),this.stencilTest=new zt(this),this.depthRange=new At(this),this.depthTest=new Mt(this),this.depthFunc=new Rt(this),this.blend=new tt(this),this.blendFunc=new _t(this),this.blendColor=new Xt(this),this.blendEquation=new ve(this),this.cullFace=new Wt(this),this.cullFaceSide=new Me(this),this.frontFace=new je(this),this.program=new Qe(this),this.activeTexture=new hr(this),this.viewport=new er(this),this.bindFramebuffer=new Br(this),this.bindRenderbuffer=new Lr(this),this.bindTexture=new Zr(this),this.bindVertexBuffer=new Tn(this),this.bindElementBuffer=new rn(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Nn(this),this.pixelStoreUnpack=new zn(this),this.pixelStoreUnpackPremultiplyAlpha=new jn(this),this.pixelStoreUnpackFlipY=new wn(this),this.extTextureFilterAnisotropic=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=x.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=x.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(x.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=x.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=x.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=x.getParameter(x.MAX_TEXTURE_SIZE)};Pe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Pe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Pe.prototype.createIndexBuffer=function(x,C){return new Ke(this,x,C)},Pe.prototype.createVertexBuffer=function(x,C,w){return new ie(this,x,C,w)},Pe.prototype.createRenderbuffer=function(x,C,w){var M=this.gl,z=M.createRenderbuffer();return this.bindRenderbuffer.set(z),M.renderbufferStorage(M.RENDERBUFFER,x,C,w),this.bindRenderbuffer.set(null),z},Pe.prototype.createFramebuffer=function(x,C,w){return new oe(this,x,C,w)},Pe.prototype.clear=function(x){var C=x.color,w=x.depth,M=this.gl,z=0;C&&(z|=M.COLOR_BUFFER_BIT,this.clearColor.set(C),this.colorMask.set([!0,!0,!0,!0])),w!==void 0&&(z|=M.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(w),this.depthMask.set(!0)),M.clear(z)},Pe.prototype.setCullFace=function(x){x.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(x.mode),this.frontFace.set(x.frontFace))},Pe.prototype.setDepthMode=function(x){x.func!==this.gl.ALWAYS||x.mask?(this.depthTest.set(!0),this.depthFunc.set(x.func),this.depthMask.set(x.mask),this.depthRange.set(x.range)):this.depthTest.set(!1)},Pe.prototype.setStencilMode=function(x){x.test.func!==this.gl.ALWAYS||x.mask?(this.stencilTest.set(!0),this.stencilMask.set(x.mask),this.stencilOp.set([x.fail,x.depthFail,x.pass]),this.stencilFunc.set({func:x.test.func,ref:x.ref,mask:x.test.mask})):this.stencilTest.set(!1)},Pe.prototype.setColorMode=function(x){I.deepEqual(x.blendFunction,fr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(x.blendFunction),this.blendColor.set(x.blendColor)),this.colorMask.set(x.mask)},Pe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ur=function(x){function C(w,M,z){var H=this;x.call(this),this.id=w,this.dispatcher=z,this.on("data",function($){$.dataType==="source"&&$.sourceDataType==="metadata"&&(H._sourceLoaded=!0),H._sourceLoaded&&!H._paused&&$.dataType==="source"&&$.sourceDataType==="content"&&(H.reload(),H.transform&&H.update(H.transform))}),this.on("error",function(){H._sourceErrored=!0}),this._source=function($,ft,Ut,re){var De=new $e[ft.type]($,ft,Ut,re);if(De.id!==$)throw new Error("Expected Source id to be "+$+" instead of "+De.id);return I.bindAll(["load","abort","unload","serialize","prepare"],De),De}(w,M,z,this),this._tiles={},this._cache=new ae(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new I.SourceFeatureState}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.onAdd=function(w){this.map=w,this._maxTileCacheSize=w?w._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(w)},C.prototype.onRemove=function(w){this._source&&this._source.onRemove&&this._source.onRemove(w)},C.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var w in this._tiles){var M=this._tiles[w];if(M.state!=="loaded"&&M.state!=="errored")return!1}return!0},C.prototype.getSource=function(){return this._source},C.prototype.pause=function(){this._paused=!0},C.prototype.resume=function(){if(this._paused){var w=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,w&&this.reload(),this.transform&&this.update(this.transform)}},C.prototype._loadTile=function(w,M){return this._source.loadTile(w,M)},C.prototype._unloadTile=function(w){if(this._source.unloadTile)return this._source.unloadTile(w,function(){})},C.prototype._abortTile=function(w){if(this._source.abortTile)return this._source.abortTile(w,function(){})},C.prototype.serialize=function(){return this._source.serialize()},C.prototype.prepare=function(w){for(var M in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var z=this._tiles[M];z.upload(w),z.prepare(this.map.style.imageManager)}},C.prototype.getIds=function(){return I.values(this._tiles).map(function(w){return w.tileID}).sort(Wr).map(function(w){return w.key})},C.prototype.getRenderableIds=function(w){var M=this,z=[];for(var H in this._tiles)this._isIdRenderable(H,w)&&z.push(this._tiles[H]);return w?z.sort(function($,ft){var Ut=$.tileID,re=ft.tileID,De=new I.Point(Ut.canonical.x,Ut.canonical.y)._rotate(M.transform.angle),Be=new I.Point(re.canonical.x,re.canonical.y)._rotate(M.transform.angle);return Ut.overscaledZ-re.overscaledZ||Be.y-De.y||Be.x-De.x}).map(function($){return $.tileID.key}):z.map(function($){return $.tileID}).sort(Wr).map(function($){return $.key})},C.prototype.hasRenderableParent=function(w){var M=this.findLoadedParent(w,0);return!!M&&this._isIdRenderable(M.tileID.key)},C.prototype._isIdRenderable=function(w,M){return this._tiles[w]&&this._tiles[w].hasData()&&!this._coveredTiles[w]&&(M||!this._tiles[w].holdingForFade())},C.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var w in this._cache.reset(),this._tiles)this._tiles[w].state!=="errored"&&this._reloadTile(w,"reloading")},C.prototype._reloadTile=function(w,M){var z=this._tiles[w];z&&(z.state!=="loading"&&(z.state=M),this._loadTile(z,this._tileLoaded.bind(this,z,w,M)))},C.prototype._tileLoaded=function(w,M,z,H){if(H)return w.state="errored",void(H.status!==404?this._source.fire(new I.ErrorEvent(H,{tile:w})):this.update(this.transform));w.timeAdded=I.browser.now(),z==="expired"&&(w.refreshedUponExpiration=!0),this._setTileReloadTimer(M,w),this.getSource().type==="raster-dem"&&w.dem&&this._backfillDEM(w),this._state.initializeTileState(w,this.map?this.map.painter:null),this._source.fire(new I.Event("data",{dataType:"source",tile:w,coord:w.tileID}))},C.prototype._backfillDEM=function(w){for(var M=this.getRenderableIds(),z=0;z<M.length;z++){var H=M[z];if(w.neighboringTiles&&w.neighboringTiles[H]){var $=this.getTileByID(H);ft(w,$),ft($,w)}}function ft(Ut,re){Ut.needsHillshadePrepare=!0;var De=re.tileID.canonical.x-Ut.tileID.canonical.x,Be=re.tileID.canonical.y-Ut.tileID.canonical.y,Le=Math.pow(2,Ut.tileID.canonical.z),cr=re.tileID.key;De===0&&Be===0||Math.abs(Be)>1||(Math.abs(De)>1&&(Math.abs(De+Le)===1?De+=Le:Math.abs(De-Le)===1&&(De-=Le)),re.dem&&Ut.dem&&(Ut.dem.backfillBorder(re.dem,De,Be),Ut.neighboringTiles&&Ut.neighboringTiles[cr]&&(Ut.neighboringTiles[cr].backfilled=!0)))}},C.prototype.getTile=function(w){return this.getTileByID(w.key)},C.prototype.getTileByID=function(w){return this._tiles[w]},C.prototype._retainLoadedChildren=function(w,M,z,H){for(var $ in this._tiles){var ft=this._tiles[$];if(!(H[$]||!ft.hasData()||ft.tileID.overscaledZ<=M||ft.tileID.overscaledZ>z)){for(var Ut=ft.tileID;ft&&ft.tileID.overscaledZ>M+1;){var re=ft.tileID.scaledTo(ft.tileID.overscaledZ-1);(ft=this._tiles[re.key])&&ft.hasData()&&(Ut=re)}for(var De=Ut;De.overscaledZ>M;)if(w[(De=De.scaledTo(De.overscaledZ-1)).key]){H[Ut.key]=Ut;break}}}},C.prototype.findLoadedParent=function(w,M){if(w.key in this._loadedParentTiles){var z=this._loadedParentTiles[w.key];return z&&z.tileID.overscaledZ>=M?z:null}for(var H=w.overscaledZ-1;H>=M;H--){var $=w.scaledTo(H),ft=this._getLoadedTile($);if(ft)return ft}},C.prototype._getLoadedTile=function(w){var M=this._tiles[w.key];return M&&M.hasData()?M:this._cache.getByKey(w.wrapped().key)},C.prototype.updateCacheSize=function(w){var M=Math.ceil(w.width/this._source.tileSize)+1,z=Math.ceil(w.height/this._source.tileSize)+1,H=Math.floor(M*z*5),$=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,H):H;this._cache.setMaxSize($)},C.prototype.handleWrapJump=function(w){var M=Math.round((w-(this._prevLng===void 0?w:this._prevLng))/360);if(this._prevLng=w,M){var z={};for(var H in this._tiles){var $=this._tiles[H];$.tileID=$.tileID.unwrapTo($.tileID.wrap+M),z[$.tileID.key]=$}for(var ft in this._tiles=z,this._timers)clearTimeout(this._timers[ft]),delete this._timers[ft];for(var Ut in this._tiles)this._setTileReloadTimer(Ut,this._tiles[Ut])}},C.prototype.update=function(w){var M=this;if(this.transform=w,this._sourceLoaded&&!this._paused){var z;this.updateCacheSize(w),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?z=w.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Zn){return new I.OverscaledTileID(Zn.canonical.z,Zn.wrap,Zn.canonical.z,Zn.canonical.x,Zn.canonical.y)}):(z=w.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(z=z.filter(function(Zn){return M._source.hasTile(Zn)}))):z=[];var H=w.coveringZoomLevel(this._source),$=Math.max(H-C.maxOverzooming,this._source.minzoom),ft=Math.max(H+C.maxUnderzooming,this._source.minzoom),Ut=this._updateRetainedTiles(z,H);if(Sn(this._source.type)){for(var re={},De={},Be=0,Le=Object.keys(Ut);Be<Le.length;Be+=1){var cr=Le[Be],ar=Ut[cr],br=this._tiles[cr];if(br&&!(br.fadeEndTime&&br.fadeEndTime<=I.browser.now())){var rr=this.findLoadedParent(ar,$);rr&&(this._addTile(rr.tileID),re[rr.tileID.key]=rr.tileID),De[cr]=ar}}for(var xr in this._retainLoadedChildren(De,H,ft,Ut),re)Ut[xr]||(this._coveredTiles[xr]=!0,Ut[xr]=re[xr])}for(var Pr in Ut)this._tiles[Pr].clearFadeHold();for(var Rr=0,gn=I.keysDifference(this._tiles,Ut);Rr<gn.length;Rr+=1){var ln=gn[Rr],bn=this._tiles[ln];bn.hasSymbolBuckets&&!bn.holdingForFade()?bn.setHoldDuration(this.map._fadeDuration):bn.hasSymbolBuckets&&!bn.symbolFadeFinished()||this._removeTile(ln)}this._updateLoadedParentTileCache()}},C.prototype.releaseSymbolFadeTiles=function(){for(var w in this._tiles)this._tiles[w].holdingForFade()&&this._removeTile(w)},C.prototype._updateRetainedTiles=function(w,M){for(var z={},H={},$=Math.max(M-C.maxOverzooming,this._source.minzoom),ft=Math.max(M+C.maxUnderzooming,this._source.minzoom),Ut={},re=0,De=w;re<De.length;re+=1){var Be=De[re],Le=this._addTile(Be);z[Be.key]=Be,Le.hasData()||M<this._source.maxzoom&&(Ut[Be.key]=Be)}this._retainLoadedChildren(Ut,M,ft,z);for(var cr=0,ar=w;cr<ar.length;cr+=1){var br=ar[cr],rr=this._tiles[br.key];if(!rr.hasData()){if(M+1>this._source.maxzoom){var xr=br.children(this._source.maxzoom)[0],Pr=this.getTile(xr);if(Pr&&Pr.hasData()){z[xr.key]=xr;continue}}else{var Rr=br.children(this._source.maxzoom);if(z[Rr[0].key]&&z[Rr[1].key]&&z[Rr[2].key]&&z[Rr[3].key])continue}for(var gn=rr.wasRequested(),ln=br.overscaledZ-1;ln>=$;--ln){var bn=br.scaledTo(ln);if(H[bn.key]||(H[bn.key]=!0,!(rr=this.getTile(bn))&&gn&&(rr=this._addTile(bn)),rr&&(z[bn.key]=bn,gn=rr.wasRequested(),rr.hasData())))break}}}return z},C.prototype._updateLoadedParentTileCache=function(){for(var w in this._loadedParentTiles={},this._tiles){for(var M=[],z=void 0,H=this._tiles[w].tileID;H.overscaledZ>0;){if(H.key in this._loadedParentTiles){z=this._loadedParentTiles[H.key];break}M.push(H.key);var $=H.scaledTo(H.overscaledZ-1);if(z=this._getLoadedTile($))break;H=$}for(var ft=0,Ut=M;ft<Ut.length;ft+=1)this._loadedParentTiles[Ut[ft]]=z}},C.prototype._addTile=function(w){var M=this._tiles[w.key];if(M)return M;(M=this._cache.getAndRemove(w))&&(this._setTileReloadTimer(w.key,M),M.tileID=w,this._state.initializeTileState(M,this.map?this.map.painter:null),this._cacheTimers[w.key]&&(clearTimeout(this._cacheTimers[w.key]),delete this._cacheTimers[w.key],this._setTileReloadTimer(w.key,M)));var z=Boolean(M);return z||(M=new I.Tile(w,this._source.tileSize*w.overscaleFactor()),this._loadTile(M,this._tileLoaded.bind(this,M,w.key,M.state))),M?(M.uses++,this._tiles[w.key]=M,z||this._source.fire(new I.Event("dataloading",{tile:M,coord:M.tileID,dataType:"source"})),M):null},C.prototype._setTileReloadTimer=function(w,M){var z=this;w in this._timers&&(clearTimeout(this._timers[w]),delete this._timers[w]);var H=M.getExpiryTimeout();H&&(this._timers[w]=setTimeout(function(){z._reloadTile(w,"expired"),delete z._timers[w]},H))},C.prototype._removeTile=function(w){var M=this._tiles[w];M&&(M.uses--,delete this._tiles[w],this._timers[w]&&(clearTimeout(this._timers[w]),delete this._timers[w]),M.uses>0||(M.hasData()&&M.state!=="reloading"?this._cache.add(M.tileID,M,M.getExpiryTimeout()):(M.aborted=!0,this._abortTile(M),this._unloadTile(M))))},C.prototype.clearTiles=function(){for(var w in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(w);this._cache.reset()},C.prototype.tilesIn=function(w,M,z){var H=this,$=[],ft=this.transform;if(!ft)return $;for(var Ut=z?ft.getCameraQueryGeometry(w):w,re=w.map(function(ln){return ft.pointCoordinate(ln)}),De=Ut.map(function(ln){return ft.pointCoordinate(ln)}),Be=this.getIds(),Le=1/0,cr=1/0,ar=-1/0,br=-1/0,rr=0,xr=De;rr<xr.length;rr+=1){var Pr=xr[rr];Le=Math.min(Le,Pr.x),cr=Math.min(cr,Pr.y),ar=Math.max(ar,Pr.x),br=Math.max(br,Pr.y)}for(var Rr=function(ln){var bn=H._tiles[Be[ln]];if(!bn.holdingForFade()){var Zn=bn.tileID,Kn=Math.pow(2,ft.zoom-bn.tileID.overscaledZ),ci=M*bn.queryPadding*I.EXTENT/bn.tileSize/Kn,Oi=[Zn.getTilePoint(new I.MercatorCoordinate(Le,cr)),Zn.getTilePoint(new I.MercatorCoordinate(ar,br))];if(Oi[0].x-ci<I.EXTENT&&Oi[0].y-ci<I.EXTENT&&Oi[1].x+ci>=0&&Oi[1].y+ci>=0){var na=re.map(function(ua){return Zn.getTilePoint(ua)}),ia=De.map(function(ua){return Zn.getTilePoint(ua)});$.push({tile:bn,tileID:Zn,queryGeometry:na,cameraQueryGeometry:ia,scale:Kn})}}},gn=0;gn<Be.length;gn++)Rr(gn);return $},C.prototype.getVisibleCoordinates=function(w){for(var M=this,z=this.getRenderableIds(w).map(function(Ut){return M._tiles[Ut].tileID}),H=0,$=z;H<$.length;H+=1){var ft=$[H];ft.posMatrix=this.transform.calculatePosMatrix(ft.toUnwrapped())}return z},C.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Sn(this._source.type))for(var w in this._tiles){var M=this._tiles[w];if(M.fadeEndTime!==void 0&&M.fadeEndTime>=I.browser.now())return!0}return!1},C.prototype.setFeatureState=function(w,M,z){this._state.updateState(w=w||"_geojsonTileLayer",M,z)},C.prototype.removeFeatureState=function(w,M,z){this._state.removeFeatureState(w=w||"_geojsonTileLayer",M,z)},C.prototype.getFeatureState=function(w,M){return this._state.getState(w=w||"_geojsonTileLayer",M)},C.prototype.setDependencies=function(w,M,z){var H=this._tiles[w];H&&H.setDependencies(M,z)},C.prototype.reloadTilesForDependencies=function(w,M){for(var z in this._tiles)this._tiles[z].hasDependency(w,M)&&this._reloadTile(z,"reloading");this._cache.filter(function(H){return!H.hasDependency(w,M)})},C}(I.Evented);function Wr(x,C){var w=Math.abs(2*x.wrap)-+(x.wrap<0),M=Math.abs(2*C.wrap)-+(C.wrap<0);return x.overscaledZ-C.overscaledZ||M-w||C.canonical.y-x.canonical.y||C.canonical.x-x.canonical.x}function Sn(x){return x==="raster"||x==="image"||x==="video"}function qr(){return new I.window.Worker(Yc.workerUrl)}ur.maxOverzooming=10,ur.maxUnderzooming=3;var Qr="mapboxgl_preloaded_worker_pool",Mn=function(){this.active={}};Mn.prototype.acquire=function(x){if(!this.workers)for(this.workers=[];this.workers.length<Mn.workerCount;)this.workers.push(new qr);return this.active[x]=!0,this.workers.slice()},Mn.prototype.release=function(x){delete this.active[x],this.numActive()===0&&(this.workers.forEach(function(C){C.terminate()}),this.workers=null)},Mn.prototype.isPreloaded=function(){return!!this.active[Qr]},Mn.prototype.numActive=function(){return Object.keys(this.active).length};var bi,Si=Math.floor(I.browser.hardwareConcurrency/2);function Kr(){return bi||(bi=new Mn),bi}function ai(x,C){var w={};for(var M in x)M!=="ref"&&(w[M]=x[M]);return I.refProperties.forEach(function(z){z in C&&(w[z]=C[z])}),w}function li(x){x=x.slice();for(var C=Object.create(null),w=0;w<x.length;w++)C[x[w].id]=x[w];for(var M=0;M<x.length;M++)"ref"in x[M]&&(x[M]=ai(x[M],C[x[M].ref]));return x}Mn.workerCount=Math.max(Math.min(Si,6),1);var hi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ra(x,C,w){w.push({command:hi.addSource,args:[x,C[x]]})}function Ci(x,C,w){C.push({command:hi.removeSource,args:[x]}),w[x]=!0}function Ba(x,C,w,M){Ci(x,w,M),ra(x,C,w)}function po(x,C,w){var M;for(M in x[w])if(x[w].hasOwnProperty(M)&&M!=="data"&&!I.deepEqual(x[w][M],C[w][M]))return!1;for(M in C[w])if(C[w].hasOwnProperty(M)&&M!=="data"&&!I.deepEqual(x[w][M],C[w][M]))return!1;return!0}function za(x,C,w,M,z,H){var $;for($ in C=C||{},x=x||{})x.hasOwnProperty($)&&(I.deepEqual(x[$],C[$])||w.push({command:H,args:[M,$,C[$],z]}));for($ in C)C.hasOwnProperty($)&&!x.hasOwnProperty($)&&(I.deepEqual(x[$],C[$])||w.push({command:H,args:[M,$,C[$],z]}))}function Xa(x){return x.id}function Ta(x,C){return x[C.id]=C,x}var ga=function(x,C){this.reset(x,C)};ga.prototype.reset=function(x,C){this.points=x||[],this._distances=[0];for(var w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(C||0,.5*this.length),this.paddedLength=this.length-2*this.padding},ga.prototype.lerp=function(x){if(this.points.length===1)return this.points[0];x=I.clamp(x,0,1);for(var C=1,w=this._distances[C],M=x*this.paddedLength+this.padding;w<M&&C<this._distances.length;)w=this._distances[++C];var z=C-1,H=this._distances[z],$=w-H,ft=$>0?(M-H)/$:0;return this.points[z].mult(1-ft).add(this.points[C].mult(ft))};var no=function(x,C,w){var M=this.boxCells=[],z=this.circleCells=[];this.xCellCount=Math.ceil(x/w),this.yCellCount=Math.ceil(C/w);for(var H=0;H<this.xCellCount*this.yCellCount;H++)M.push([]),z.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=x,this.height=C,this.xScale=this.xCellCount/x,this.yScale=this.yCellCount/C,this.boxUid=0,this.circleUid=0};function Vo(x,C,w,M,z){var H=I.create();return C?(I.scale(H,H,[1/z,1/z,1]),w||I.rotateZ(H,H,M.angle)):I.multiply(H,M.labelPlaneMatrix,x),H}function vo(x,C,w,M,z){if(C){var H=I.clone(x);return I.scale(H,H,[z,z,1]),w||I.rotateZ(H,H,-M.angle),H}return M.glCoordMatrix}function ja(x,C){var w=[x.x,x.y,0,1];In(w,w,C);var M=w[3];return{point:new I.Point(w[0]/M,w[1]/M),signedDistanceFromCamera:M}}function to(x,C){return .5+x/C*.5}function Uo(x,C){var w=x[0]/x[3],M=x[1]/x[3];return w>=-C[0]&&w<=C[0]&&M>=-C[1]&&M<=C[1]}function ju(x,C,w,M,z,H,$,ft){var Ut=M?x.textSizeData:x.iconSizeData,re=I.evaluateSizeForZoom(Ut,w.transform.zoom),De=[256/w.width*2+1,256/w.height*2+1],Be=M?x.text.dynamicLayoutVertexArray:x.icon.dynamicLayoutVertexArray;Be.clear();for(var Le=x.lineVertexArray,cr=M?x.text.placedSymbolArray:x.icon.placedSymbolArray,ar=w.transform.width/w.transform.height,br=!1,rr=0;rr<cr.length;rr++){var xr=cr.get(rr);if(xr.hidden||xr.writingMode===I.WritingMode.vertical&&!br)tn(xr.numGlyphs,Be);else{br=!1;var Pr=[xr.anchorX,xr.anchorY,0,1];if(I.transformMat4(Pr,Pr,C),Uo(Pr,De)){var Rr=to(w.transform.cameraToCenterDistance,Pr[3]),gn=I.evaluateSizeForFeature(Ut,re,xr),ln=$?gn/Rr:gn*Rr,bn=new I.Point(xr.anchorX,xr.anchorY),Zn=ja(bn,z).point,Kn={},ci=nr(xr,ln,!1,ft,C,z,H,x.glyphOffsetArray,Le,Be,Zn,bn,Kn,ar);br=ci.useVertical,(ci.notEnoughRoom||br||ci.needsFlipping&&nr(xr,ln,!0,ft,C,z,H,x.glyphOffsetArray,Le,Be,Zn,bn,Kn,ar).notEnoughRoom)&&tn(xr.numGlyphs,Be)}else tn(xr.numGlyphs,Be)}}M?x.text.dynamicLayoutVertexBuffer.updateData(Be):x.icon.dynamicLayoutVertexBuffer.updateData(Be)}function Wo(x,C,w,M,z,H,$,ft,Ut,re,De){var Be=ft.glyphStartIndex+ft.numGlyphs,Le=ft.lineStartIndex,cr=ft.lineStartIndex+ft.lineLength,ar=C.getoffsetX(ft.glyphStartIndex),br=C.getoffsetX(Be-1),rr=He(x*ar,w,M,z,H,$,ft.segment,Le,cr,Ut,re,De);if(!rr)return null;var xr=He(x*br,w,M,z,H,$,ft.segment,Le,cr,Ut,re,De);return xr?{first:rr,last:xr}:null}function bo(x,C,w,M){return x===I.WritingMode.horizontal&&Math.abs(w.y-C.y)>Math.abs(w.x-C.x)*M?{useVertical:!0}:(x===I.WritingMode.vertical?C.y<w.y:C.x>w.x)?{needsFlipping:!0}:null}function nr(x,C,w,M,z,H,$,ft,Ut,re,De,Be,Le,cr){var ar,br=C/24,rr=x.lineOffsetX*br,xr=x.lineOffsetY*br;if(x.numGlyphs>1){var Pr=x.glyphStartIndex+x.numGlyphs,Rr=x.lineStartIndex,gn=x.lineStartIndex+x.lineLength,ln=Wo(br,ft,rr,xr,w,De,Be,x,Ut,H,Le);if(!ln)return{notEnoughRoom:!0};var bn=ja(ln.first.point,$).point,Zn=ja(ln.last.point,$).point;if(M&&!w){var Kn=bo(x.writingMode,bn,Zn,cr);if(Kn)return Kn}ar=[ln.first];for(var ci=x.glyphStartIndex+1;ci<Pr-1;ci++)ar.push(He(br*ft.getoffsetX(ci),rr,xr,w,De,Be,x.segment,Rr,gn,Ut,H,Le));ar.push(ln.last)}else{if(M&&!w){var Oi=ja(Be,z).point,na=x.lineStartIndex+x.segment+1,ia=new I.Point(Ut.getx(na),Ut.gety(na)),ua=ja(ia,z),Qa=ua.signedDistanceFromCamera>0?ua.point:xe(Be,ia,Oi,1,z),Fi=bo(x.writingMode,Oi,Qa,cr);if(Fi)return Fi}var Ra=He(br*ft.getoffsetX(x.glyphStartIndex),rr,xr,w,De,Be,x.segment,x.lineStartIndex,x.lineStartIndex+x.lineLength,Ut,H,Le);if(!Ra)return{notEnoughRoom:!0};ar=[Ra]}for(var Aa=0,ka=ar;Aa<ka.length;Aa+=1){var la=ka[Aa];I.addDynamicAttributes(re,la.point,la.angle)}return{}}function xe(x,C,w,M,z){var H=ja(x.add(x.sub(C)._unit()),z).point,$=w.sub(H);return w.add($._mult(M/$.mag()))}function He(x,C,w,M,z,H,$,ft,Ut,re,De,Be){var Le=M?x-C:x+C,cr=Le>0?1:-1,ar=0;M&&(cr*=-1,ar=Math.PI),cr<0&&(ar+=Math.PI);for(var br=cr>0?ft+$:ft+$+1,rr=z,xr=z,Pr=0,Rr=0,gn=Math.abs(Le),ln=[];Pr+Rr<=gn;){if((br+=cr)<ft||br>=Ut)return null;if(xr=rr,ln.push(rr),(rr=Be[br])===void 0){var bn=new I.Point(re.getx(br),re.gety(br)),Zn=ja(bn,De);if(Zn.signedDistanceFromCamera>0)rr=Be[br]=Zn.point;else{var Kn=br-cr;rr=xe(Pr===0?H:new I.Point(re.getx(Kn),re.gety(Kn)),bn,xr,gn-Pr+1,De)}}Pr+=Rr,Rr=xr.dist(rr)}var ci=(gn-Pr)/Rr,Oi=rr.sub(xr),na=Oi.mult(ci)._add(xr);na._add(Oi._unit()._perp()._mult(w*cr));var ia=ar+Math.atan2(rr.y-xr.y,rr.x-xr.x);return ln.push(na),{point:na,angle:ia,path:ln}}no.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},no.prototype.insert=function(x,C,w,M,z){this._forEachCell(C,w,M,z,this._insertBoxCell,this.boxUid++),this.boxKeys.push(x),this.bboxes.push(C),this.bboxes.push(w),this.bboxes.push(M),this.bboxes.push(z)},no.prototype.insertCircle=function(x,C,w,M){this._forEachCell(C-M,w-M,C+M,w+M,this._insertCircleCell,this.circleUid++),this.circleKeys.push(x),this.circles.push(C),this.circles.push(w),this.circles.push(M)},no.prototype._insertBoxCell=function(x,C,w,M,z,H){this.boxCells[z].push(H)},no.prototype._insertCircleCell=function(x,C,w,M,z,H){this.circleCells[z].push(H)},no.prototype._query=function(x,C,w,M,z,H){if(w<0||x>this.width||M<0||C>this.height)return!z&&[];var $=[];if(x<=0&&C<=0&&this.width<=w&&this.height<=M){if(z)return!0;for(var ft=0;ft<this.boxKeys.length;ft++)$.push({key:this.boxKeys[ft],x1:this.bboxes[4*ft],y1:this.bboxes[4*ft+1],x2:this.bboxes[4*ft+2],y2:this.bboxes[4*ft+3]});for(var Ut=0;Ut<this.circleKeys.length;Ut++){var re=this.circles[3*Ut],De=this.circles[3*Ut+1],Be=this.circles[3*Ut+2];$.push({key:this.circleKeys[Ut],x1:re-Be,y1:De-Be,x2:re+Be,y2:De+Be})}return H?$.filter(H):$}return this._forEachCell(x,C,w,M,this._queryCell,$,{hitTest:z,seenUids:{box:{},circle:{}}},H),z?$.length>0:$},no.prototype._queryCircle=function(x,C,w,M,z){var H=x-w,$=x+w,ft=C-w,Ut=C+w;if($<0||H>this.width||Ut<0||ft>this.height)return!M&&[];var re=[];return this._forEachCell(H,ft,$,Ut,this._queryCellCircle,re,{hitTest:M,circle:{x,y:C,radius:w},seenUids:{box:{},circle:{}}},z),M?re.length>0:re},no.prototype.query=function(x,C,w,M,z){return this._query(x,C,w,M,!1,z)},no.prototype.hitTest=function(x,C,w,M,z){return this._query(x,C,w,M,!0,z)},no.prototype.hitTestCircle=function(x,C,w,M){return this._queryCircle(x,C,w,!0,M)},no.prototype._queryCell=function(x,C,w,M,z,H,$,ft){var Ut=$.seenUids,re=this.boxCells[z];if(re!==null)for(var De=this.bboxes,Be=0,Le=re;Be<Le.length;Be+=1){var cr=Le[Be];if(!Ut.box[cr]){Ut.box[cr]=!0;var ar=4*cr;if(x<=De[ar+2]&&C<=De[ar+3]&&w>=De[ar+0]&&M>=De[ar+1]&&(!ft||ft(this.boxKeys[cr]))){if($.hitTest)return H.push(!0),!0;H.push({key:this.boxKeys[cr],x1:De[ar],y1:De[ar+1],x2:De[ar+2],y2:De[ar+3]})}}}var br=this.circleCells[z];if(br!==null)for(var rr=this.circles,xr=0,Pr=br;xr<Pr.length;xr+=1){var Rr=Pr[xr];if(!Ut.circle[Rr]){Ut.circle[Rr]=!0;var gn=3*Rr;if(this._circleAndRectCollide(rr[gn],rr[gn+1],rr[gn+2],x,C,w,M)&&(!ft||ft(this.circleKeys[Rr]))){if($.hitTest)return H.push(!0),!0;var ln=rr[gn],bn=rr[gn+1],Zn=rr[gn+2];H.push({key:this.circleKeys[Rr],x1:ln-Zn,y1:bn-Zn,x2:ln+Zn,y2:bn+Zn})}}}},no.prototype._queryCellCircle=function(x,C,w,M,z,H,$,ft){var Ut=$.circle,re=$.seenUids,De=this.boxCells[z];if(De!==null)for(var Be=this.bboxes,Le=0,cr=De;Le<cr.length;Le+=1){var ar=cr[Le];if(!re.box[ar]){re.box[ar]=!0;var br=4*ar;if(this._circleAndRectCollide(Ut.x,Ut.y,Ut.radius,Be[br+0],Be[br+1],Be[br+2],Be[br+3])&&(!ft||ft(this.boxKeys[ar])))return H.push(!0),!0}}var rr=this.circleCells[z];if(rr!==null)for(var xr=this.circles,Pr=0,Rr=rr;Pr<Rr.length;Pr+=1){var gn=Rr[Pr];if(!re.circle[gn]){re.circle[gn]=!0;var ln=3*gn;if(this._circlesCollide(xr[ln],xr[ln+1],xr[ln+2],Ut.x,Ut.y,Ut.radius)&&(!ft||ft(this.circleKeys[gn])))return H.push(!0),!0}}},no.prototype._forEachCell=function(x,C,w,M,z,H,$,ft){for(var Ut=this._convertToXCellCoord(x),re=this._convertToYCellCoord(C),De=this._convertToXCellCoord(w),Be=this._convertToYCellCoord(M),Le=Ut;Le<=De;Le++)for(var cr=re;cr<=Be;cr++)if(z.call(this,x,C,w,M,this.xCellCount*cr+Le,H,$,ft))return},no.prototype._convertToXCellCoord=function(x){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(x*this.xScale)))},no.prototype._convertToYCellCoord=function(x){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(x*this.yScale)))},no.prototype._circlesCollide=function(x,C,w,M,z,H){var $=M-x,ft=z-C,Ut=w+H;return Ut*Ut>$*$+ft*ft},no.prototype._circleAndRectCollide=function(x,C,w,M,z,H,$){var ft=(H-M)/2,Ut=Math.abs(x-(M+ft));if(Ut>ft+w)return!1;var re=($-z)/2,De=Math.abs(C-(z+re));if(De>re+w)return!1;if(Ut<=ft||De<=re)return!0;var Be=Ut-ft,Le=De-re;return Be*Be+Le*Le<=w*w};var Mr=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function tn(x,C){for(var w=0;w<x;w++){var M=C.length;C.resize(M+4),C.float32.set(Mr,3*M)}}function In(x,C,w){var M=C[0],z=C[1];return x[0]=w[0]*M+w[4]*z+w[12],x[1]=w[1]*M+w[5]*z+w[13],x[3]=w[3]*M+w[7]*z+w[15],x}var Un=function(x,C,w){C===void 0&&(C=new no(x.width+200,x.height+200,25)),w===void 0&&(w=new no(x.width+200,x.height+200,25)),this.transform=x,this.grid=C,this.ignoredGrid=w,this.pitchfactor=Math.cos(x._pitch)*x.cameraToCenterDistance,this.screenRightBoundary=x.width+100,this.screenBottomBoundary=x.height+100,this.gridRightBoundary=x.width+200,this.gridBottomBoundary=x.height+200};function Cn(x,C,w){return C*(I.EXTENT/(x.tileSize*Math.pow(2,w-x.tileID.overscaledZ)))}Un.prototype.placeCollisionBox=function(x,C,w,M,z){var H=this.projectAndGetPerspectiveRatio(M,x.anchorPointX,x.anchorPointY),$=w*H.perspectiveRatio,ft=x.x1*$+H.point.x,Ut=x.y1*$+H.point.y,re=x.x2*$+H.point.x,De=x.y2*$+H.point.y;return!this.isInsideGrid(ft,Ut,re,De)||!C&&this.grid.hitTest(ft,Ut,re,De,z)?{box:[],offscreen:!1}:{box:[ft,Ut,re,De],offscreen:this.isOffscreen(ft,Ut,re,De)}},Un.prototype.placeCollisionCircles=function(x,C,w,M,z,H,$,ft,Ut,re,De,Be,Le){var cr=[],ar=new I.Point(C.anchorX,C.anchorY),br=ja(ar,H),rr=to(this.transform.cameraToCenterDistance,br.signedDistanceFromCamera),xr=(re?z/rr:z*rr)/I.ONE_EM,Pr=ja(ar,$).point,Rr=Wo(xr,M,C.lineOffsetX*xr,C.lineOffsetY*xr,!1,Pr,ar,C,w,$,{}),gn=!1,ln=!1,bn=!0;if(Rr){for(var Zn=.5*Be*rr+Le,Kn=new I.Point(-100,-100),ci=new I.Point(this.screenRightBoundary,this.screenBottomBoundary),Oi=new ga,na=Rr.first,ia=Rr.last,ua=[],Qa=na.path.length-1;Qa>=1;Qa--)ua.push(na.path[Qa]);for(var Fi=1;Fi<ia.path.length;Fi++)ua.push(ia.path[Fi]);var Ra=2.5*Zn;if(ft){var Aa=ua.map(function(cl){return ja(cl,ft)});ua=Aa.some(function(cl){return cl.signedDistanceFromCamera<=0})?[]:Aa.map(function(cl){return cl.point})}var ka=[];if(ua.length>0){for(var la=ua[0].clone(),Na=ua[0].clone(),pa=1;pa<ua.length;pa++)la.x=Math.min(la.x,ua[pa].x),la.y=Math.min(la.y,ua[pa].y),Na.x=Math.max(Na.x,ua[pa].x),Na.y=Math.max(Na.y,ua[pa].y);ka=la.x>=Kn.x&&Na.x<=ci.x&&la.y>=Kn.y&&Na.y<=ci.y?[ua]:Na.x<Kn.x||la.x>ci.x||Na.y<Kn.y||la.y>ci.y?[]:I.clipLine([ua],Kn.x,Kn.y,ci.x,ci.y)}for(var da=0,Ds=ka;da<Ds.length;da+=1){var ss;Oi.reset(Ds[da],.25*Zn),ss=Oi.length<=.5*Zn?1:Math.ceil(Oi.paddedLength/Ra)+1;for(var ou=0;ou<ss;ou++){var Ks=ou/Math.max(ss-1,1),ls=Oi.lerp(Ks),cs=ls.x+100,vu=ls.y+100;cr.push(cs,vu,Zn,0);var Du=cs-Zn,kc=vu-Zn,qu=cs+Zn,Kl=vu+Zn;if(bn=bn&&this.isOffscreen(Du,kc,qu,Kl),ln=ln||this.isInsideGrid(Du,kc,qu,Kl),!x&&this.grid.hitTestCircle(cs,vu,Zn,De)&&(gn=!0,!Ut))return{circles:[],offscreen:!1,collisionDetected:gn}}}}return{circles:!Ut&&gn||!ln?[]:cr,offscreen:bn,collisionDetected:gn}},Un.prototype.queryRenderedSymbols=function(x){if(x.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var C=[],w=1/0,M=1/0,z=-1/0,H=-1/0,$=0,ft=x;$<ft.length;$+=1){var Ut=ft[$],re=new I.Point(Ut.x+100,Ut.y+100);w=Math.min(w,re.x),M=Math.min(M,re.y),z=Math.max(z,re.x),H=Math.max(H,re.y),C.push(re)}for(var De={},Be={},Le=0,cr=this.grid.query(w,M,z,H).concat(this.ignoredGrid.query(w,M,z,H));Le<cr.length;Le+=1){var ar=cr[Le],br=ar.key;if(De[br.bucketInstanceId]===void 0&&(De[br.bucketInstanceId]={}),!De[br.bucketInstanceId][br.featureIndex]){var rr=[new I.Point(ar.x1,ar.y1),new I.Point(ar.x2,ar.y1),new I.Point(ar.x2,ar.y2),new I.Point(ar.x1,ar.y2)];I.polygonIntersectsPolygon(C,rr)&&(De[br.bucketInstanceId][br.featureIndex]=!0,Be[br.bucketInstanceId]===void 0&&(Be[br.bucketInstanceId]=[]),Be[br.bucketInstanceId].push(br.featureIndex))}}return Be},Un.prototype.insertCollisionBox=function(x,C,w,M,z){(C?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:M,collisionGroupID:z},x[0],x[1],x[2],x[3])},Un.prototype.insertCollisionCircles=function(x,C,w,M,z){for(var H=C?this.ignoredGrid:this.grid,$={bucketInstanceId:w,featureIndex:M,collisionGroupID:z},ft=0;ft<x.length;ft+=4)H.insertCircle($,x[ft],x[ft+1],x[ft+2])},Un.prototype.projectAndGetPerspectiveRatio=function(x,C,w){var M=[C,w,0,1];return In(M,M,x),{point:new I.Point((M[0]/M[3]+1)/2*this.transform.width+100,(-M[1]/M[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/M[3]*.5}},Un.prototype.isOffscreen=function(x,C,w,M){return w<100||x>=this.screenRightBoundary||M<100||C>this.screenBottomBoundary},Un.prototype.isInsideGrid=function(x,C,w,M){return w>=0&&x<this.gridRightBoundary&&M>=0&&C<this.gridBottomBoundary},Un.prototype.getViewportMatrix=function(){var x=I.identity([]);return I.translate(x,x,[-100,-100,0]),x};var ta=function(x,C,w,M){this.opacity=x?Math.max(0,Math.min(1,x.opacity+(x.placed?C:-C))):M&&w?1:0,this.placed=w};ta.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Wa=function(x,C,w,M,z){this.text=new ta(x?x.text:null,C,w,z),this.icon=new ta(x?x.icon:null,C,M,z)};Wa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var es=function(x,C,w){this.text=x,this.icon=C,this.skipFade=w},ko=function(){this.invProjMatrix=I.create(),this.viewportMatrix=I.create(),this.circles=[]},ns=function(x,C,w,M,z){this.bucketInstanceId=x,this.featureIndex=C,this.sourceLayerIndex=w,this.bucketIndex=M,this.tileID=z},Ya=function(x){this.crossSourceCollisions=x,this.maxGroupID=0,this.collisionGroups={}};function Go(x,C,w,M,z){var H=I.getAnchorAlignment(x),$=-(H.horizontalAlign-.5)*C,ft=-(H.verticalAlign-.5)*w,Ut=I.evaluateVariableOffset(x,M);return new I.Point($+Ut[0]*z,ft+Ut[1]*z)}function pu(x,C,w,M,z,H){var $=x.x1,ft=x.x2,Ut=x.y1,re=x.y2,De=x.anchorPointX,Be=x.anchorPointY,Le=new I.Point(C,w);return M&&Le._rotate(z?H:-H),{x1:$+Le.x,y1:Ut+Le.y,x2:ft+Le.x,y2:re+Le.y,anchorPointX:De,anchorPointY:Be}}Ya.prototype.get=function(x){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[x]){var C=++this.maxGroupID;this.collisionGroups[x]={ID:C,predicate:function(w){return w.collisionGroupID===C}}}return this.collisionGroups[x]};var ys=function(x,C,w,M){this.transform=x.clone(),this.collisionIndex=new Un(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=C,this.retainedQueryData={},this.collisionGroups=new Ya(w),this.collisionCircleArrays={},this.prevPlacement=M,M&&(M.prevPlacement=void 0),this.placedOrientations={}};function Rl(x,C,w,M,z){x.emplaceBack(C?1:0,w?1:0,M||0,z||0),x.emplaceBack(C?1:0,w?1:0,M||0,z||0),x.emplaceBack(C?1:0,w?1:0,M||0,z||0),x.emplaceBack(C?1:0,w?1:0,M||0,z||0)}ys.prototype.getBucketParts=function(x,C,w,M){var z=w.getBucket(C),H=w.latestFeatureIndex;if(z&&H&&C.id===z.layerIds[0]){var $=w.collisionBoxArray,ft=z.layers[0].layout,Ut=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),re=w.tileSize/I.EXTENT,De=this.transform.calculatePosMatrix(w.tileID.toUnwrapped()),Be=ft.get("text-pitch-alignment")==="map",Le=ft.get("text-rotation-alignment")==="map",cr=Cn(w,1,this.transform.zoom),ar=Vo(De,Be,Le,this.transform,cr),br=null;if(Be){var rr=vo(De,Be,Le,this.transform,cr);br=I.multiply([],this.transform.labelPlaneMatrix,rr)}this.retainedQueryData[z.bucketInstanceId]=new ns(z.bucketInstanceId,H,z.sourceLayerIndex,z.index,w.tileID);var xr={bucket:z,layout:ft,posMatrix:De,textLabelPlaneMatrix:ar,labelToScreenMatrix:br,scale:Ut,textPixelRatio:re,holdingForFade:w.holdingForFade(),collisionBoxArray:$,partiallyEvaluatedTextSize:I.evaluateSizeForZoom(z.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(z.sourceID)};if(M)for(var Pr=0,Rr=z.sortKeyRanges;Pr<Rr.length;Pr+=1){var gn=Rr[Pr];x.push({sortKey:gn.sortKey,symbolInstanceStart:gn.symbolInstanceStart,symbolInstanceEnd:gn.symbolInstanceEnd,parameters:xr})}else x.push({symbolInstanceStart:0,symbolInstanceEnd:z.symbolInstances.length,parameters:xr})}},ys.prototype.attemptAnchorPlacement=function(x,C,w,M,z,H,$,ft,Ut,re,De,Be,Le,cr,ar){var br,rr=[Be.textOffset0,Be.textOffset1],xr=Go(x,w,M,rr,z),Pr=this.collisionIndex.placeCollisionBox(pu(C,xr.x,xr.y,H,$,this.transform.angle),De,ft,Ut,re.predicate);if(!ar||this.collisionIndex.placeCollisionBox(pu(ar,xr.x,xr.y,H,$,this.transform.angle),De,ft,Ut,re.predicate).box.length!==0)return Pr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Be.crossTileID]&&this.prevPlacement.placements[Be.crossTileID]&&this.prevPlacement.placements[Be.crossTileID].text&&(br=this.prevPlacement.variableOffsets[Be.crossTileID].anchor),this.variableOffsets[Be.crossTileID]={textOffset:rr,width:w,height:M,anchor:x,textBoxScale:z,prevAnchor:br},this.markUsedJustification(Le,x,Be,cr),Le.allowVerticalPlacement&&(this.markUsedOrientation(Le,cr,Be),this.placedOrientations[Be.crossTileID]=cr),{shift:xr,placedGlyphBoxes:Pr}):void 0},ys.prototype.placeLayerBucketPart=function(x,C,w){var M=this,z=x.parameters,H=z.bucket,$=z.layout,ft=z.posMatrix,Ut=z.textLabelPlaneMatrix,re=z.labelToScreenMatrix,De=z.textPixelRatio,Be=z.holdingForFade,Le=z.collisionBoxArray,cr=z.partiallyEvaluatedTextSize,ar=z.collisionGroup,br=$.get("text-optional"),rr=$.get("icon-optional"),xr=$.get("text-allow-overlap"),Pr=$.get("icon-allow-overlap"),Rr=$.get("text-rotation-alignment")==="map",gn=$.get("text-pitch-alignment")==="map",ln=$.get("icon-text-fit")!=="none",bn=$.get("symbol-z-order")==="viewport-y",Zn=xr&&(Pr||!H.hasIconData()||rr),Kn=Pr&&(xr||!H.hasTextData()||br);!H.collisionArrays&&Le&&H.deserializeCollisionBoxes(Le);var ci=function(Fi,Ra){if(!C[Fi.crossTileID])if(Be)M.placements[Fi.crossTileID]=new es(!1,!1,!1);else{var Aa,ka=!1,la=!1,Na=!0,pa=null,da={box:null,offscreen:null},Ds={box:null,offscreen:null},ss=null,ou=null,Ks=0,ls=0,cs=0;Ra.textFeatureIndex?Ks=Ra.textFeatureIndex:Fi.useRuntimeCollisionCircles&&(Ks=Fi.featureIndex),Ra.verticalTextFeatureIndex&&(ls=Ra.verticalTextFeatureIndex);var vu=Ra.textBox;if(vu){var Du=function(Lo){var wl=I.WritingMode.horizontal;if(H.allowVerticalPlacement&&!Lo&&M.prevPlacement){var Ku=M.prevPlacement.placedOrientations[Fi.crossTileID];Ku&&(M.placedOrientations[Fi.crossTileID]=Ku,M.markUsedOrientation(H,wl=Ku,Fi))}return wl},kc=function(Lo,wl){if(H.allowVerticalPlacement&&Fi.numVerticalGlyphVertices>0&&Ra.verticalTextBox)for(var Ku=0,qc=H.writingModes;Ku<qc.length&&(qc[Ku]===I.WritingMode.vertical?(da=wl(),Ds=da):da=Lo(),!(da&&da.box&&da.box.length));Ku+=1);else da=Lo()};if($.get("text-variable-anchor")){var qu=$.get("text-variable-anchor");if(M.prevPlacement&&M.prevPlacement.variableOffsets[Fi.crossTileID]){var Kl=M.prevPlacement.variableOffsets[Fi.crossTileID];qu.indexOf(Kl.anchor)>0&&(qu=qu.filter(function(Lo){return Lo!==Kl.anchor})).unshift(Kl.anchor)}var cl=function(Lo,wl,Ku){for(var qc=Lo.x2-Lo.x1,Kc=Lo.y2-Lo.y1,$f=Fi.textBoxScale,Qc=ln&&!Pr?wl:null,Bu={box:[],offscreen:!1},bh=xr?2*qu.length:qu.length,tc=0;tc<bh;++tc){var Jc=M.attemptAnchorPlacement(qu[tc%qu.length],Lo,qc,Kc,$f,Rr,gn,De,ft,ar,tc>=qu.length,Fi,H,Ku,Qc);if(Jc&&(Bu=Jc.placedGlyphBoxes)&&Bu.box&&Bu.box.length){ka=!0,pa=Jc.shift;break}}return Bu};kc(function(){return cl(vu,Ra.iconBox,I.WritingMode.horizontal)},function(){var Lo=Ra.verticalTextBox;return H.allowVerticalPlacement&&!(da&&da.box&&da.box.length)&&Fi.numVerticalGlyphVertices>0&&Lo?cl(Lo,Ra.verticalIconBox,I.WritingMode.vertical):{box:null,offscreen:null}}),da&&(ka=da.box,Na=da.offscreen);var yh=Du(da&&da.box);if(!ka&&M.prevPlacement){var El=M.prevPlacement.variableOffsets[Fi.crossTileID];El&&(M.variableOffsets[Fi.crossTileID]=El,M.markUsedJustification(H,El.anchor,Fi,yh))}}else{var Ql=function(Lo,wl){var Ku=M.collisionIndex.placeCollisionBox(Lo,xr,De,ft,ar.predicate);return Ku&&Ku.box&&Ku.box.length&&(M.markUsedOrientation(H,wl,Fi),M.placedOrientations[Fi.crossTileID]=wl),Ku};kc(function(){return Ql(vu,I.WritingMode.horizontal)},function(){var Lo=Ra.verticalTextBox;return H.allowVerticalPlacement&&Fi.numVerticalGlyphVertices>0&&Lo?Ql(Lo,I.WritingMode.vertical):{box:null,offscreen:null}}),Du(da&&da.box&&da.box.length)}}if(ka=(Aa=da)&&Aa.box&&Aa.box.length>0,Na=Aa&&Aa.offscreen,Fi.useRuntimeCollisionCircles){var _h=H.text.placedSymbolArray.get(Fi.centerJustifiedTextSymbolIndex),Yf=I.evaluateSizeForFeature(H.textSizeData,cr,_h),dc=$.get("text-padding");ss=M.collisionIndex.placeCollisionCircles(xr,_h,H.lineVertexArray,H.glyphOffsetArray,Yf,ft,Ut,re,w,gn,ar.predicate,Fi.collisionCircleDiameter,dc),ka=xr||ss.circles.length>0&&!ss.collisionDetected,Na=Na&&ss.offscreen}if(Ra.iconFeatureIndex&&(cs=Ra.iconFeatureIndex),Ra.iconBox){var xh=function(Lo){var wl=ln&&pa?pu(Lo,pa.x,pa.y,Rr,gn,M.transform.angle):Lo;return M.collisionIndex.placeCollisionBox(wl,Pr,De,ft,ar.predicate)};la=Ds&&Ds.box&&Ds.box.length&&Ra.verticalIconBox?(ou=xh(Ra.verticalIconBox)).box.length>0:(ou=xh(Ra.iconBox)).box.length>0,Na=Na&&ou.offscreen}var Jl=br||Fi.numHorizontalGlyphVertices===0&&Fi.numVerticalGlyphVertices===0,js=rr||Fi.numIconVertices===0;if(Jl||js?js?Jl||(la=la&&ka):ka=la&&ka:la=ka=la&&ka,ka&&Aa&&Aa.box&&M.collisionIndex.insertCollisionBox(Aa.box,$.get("text-ignore-placement"),H.bucketInstanceId,Ds&&Ds.box&&ls?ls:Ks,ar.ID),la&&ou&&M.collisionIndex.insertCollisionBox(ou.box,$.get("icon-ignore-placement"),H.bucketInstanceId,cs,ar.ID),ss&&(ka&&M.collisionIndex.insertCollisionCircles(ss.circles,$.get("text-ignore-placement"),H.bucketInstanceId,Ks,ar.ID),w)){var $c=H.bucketInstanceId,Tf=M.collisionCircleArrays[$c];Tf===void 0&&(Tf=M.collisionCircleArrays[$c]=new ko);for(var vc=0;vc<ss.circles.length;vc+=4)Tf.circles.push(ss.circles[vc+0]),Tf.circles.push(ss.circles[vc+1]),Tf.circles.push(ss.circles[vc+2]),Tf.circles.push(ss.collisionDetected?1:0)}M.placements[Fi.crossTileID]=new es(ka||Zn,la||Kn,Na||H.justReloaded),C[Fi.crossTileID]=!0}};if(bn)for(var Oi=H.getSortedSymbolIndexes(this.transform.angle),na=Oi.length-1;na>=0;--na){var ia=Oi[na];ci(H.symbolInstances.get(ia),H.collisionArrays[ia])}else for(var ua=x.symbolInstanceStart;ua<x.symbolInstanceEnd;ua++)ci(H.symbolInstances.get(ua),H.collisionArrays[ua]);if(w&&H.bucketInstanceId in this.collisionCircleArrays){var Qa=this.collisionCircleArrays[H.bucketInstanceId];I.invert(Qa.invProjMatrix,ft),Qa.viewportMatrix=this.collisionIndex.getViewportMatrix()}H.justReloaded=!1},ys.prototype.markUsedJustification=function(x,C,w,M){var z;z=M===I.WritingMode.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[I.getAnchorJustification(C)];for(var H=0,$=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];H<$.length;H+=1){var ft=$[H];ft>=0&&(x.text.placedSymbolArray.get(ft).crossTileID=z>=0&&ft!==z?0:w.crossTileID)}},ys.prototype.markUsedOrientation=function(x,C,w){for(var M=C===I.WritingMode.horizontal||C===I.WritingMode.horizontalOnly?C:0,z=C===I.WritingMode.vertical?C:0,H=0,$=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];H<$.length;H+=1)x.text.placedSymbolArray.get($[H]).placedOrientation=M;w.verticalPlacedTextSymbolIndex&&(x.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=z)},ys.prototype.commit=function(x){this.commitTime=x,this.zoomAtLastRecencyCheck=this.transform.zoom;var C=this.prevPlacement,w=!1;this.prevZoomAdjustment=C?C.zoomAdjustment(this.transform.zoom):0;var M=C?C.symbolFadeChange(x):1,z=C?C.opacities:{},H=C?C.variableOffsets:{},$=C?C.placedOrientations:{};for(var ft in this.placements){var Ut=this.placements[ft],re=z[ft];re?(this.opacities[ft]=new Wa(re,M,Ut.text,Ut.icon),w=w||Ut.text!==re.text.placed||Ut.icon!==re.icon.placed):(this.opacities[ft]=new Wa(null,M,Ut.text,Ut.icon,Ut.skipFade),w=w||Ut.text||Ut.icon)}for(var De in z){var Be=z[De];if(!this.opacities[De]){var Le=new Wa(Be,M,!1,!1);Le.isHidden()||(this.opacities[De]=Le,w=w||Be.text.placed||Be.icon.placed)}}for(var cr in H)this.variableOffsets[cr]||!this.opacities[cr]||this.opacities[cr].isHidden()||(this.variableOffsets[cr]=H[cr]);for(var ar in $)this.placedOrientations[ar]||!this.opacities[ar]||this.opacities[ar].isHidden()||(this.placedOrientations[ar]=$[ar]);w?this.lastPlacementChangeTime=x:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=C?C.lastPlacementChangeTime:x)},ys.prototype.updateLayerOpacities=function(x,C){for(var w={},M=0,z=C;M<z.length;M+=1){var H=z[M],$=H.getBucket(x);$&&H.latestFeatureIndex&&x.id===$.layerIds[0]&&this.updateBucketOpacities($,w,H.collisionBoxArray)}},ys.prototype.updateBucketOpacities=function(x,C,w){var M=this;x.hasTextData()&&x.text.opacityVertexArray.clear(),x.hasIconData()&&x.icon.opacityVertexArray.clear(),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexArray.clear(),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexArray.clear();var z=x.layers[0].layout,H=new Wa(null,0,!1,!1,!0),$=z.get("text-allow-overlap"),ft=z.get("icon-allow-overlap"),Ut=z.get("text-variable-anchor"),re=z.get("text-rotation-alignment")==="map",De=z.get("text-pitch-alignment")==="map",Be=z.get("icon-text-fit")!=="none",Le=new Wa(null,0,$&&(ft||!x.hasIconData()||z.get("icon-optional")),ft&&($||!x.hasTextData()||z.get("text-optional")),!0);!x.collisionArrays&&w&&(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData())&&x.deserializeCollisionBoxes(w);for(var cr=function(xr,Pr,Rr){for(var gn=0;gn<Pr/4;gn++)xr.opacityVertexArray.emplaceBack(Rr)},ar=function(xr){var Pr=x.symbolInstances.get(xr),Rr=Pr.numHorizontalGlyphVertices,gn=Pr.numVerticalGlyphVertices,ln=Pr.crossTileID,bn=M.opacities[ln];C[ln]?bn=H:bn||(M.opacities[ln]=bn=Le),C[ln]=!0;var Zn=Pr.numIconVertices>0,Kn=M.placedOrientations[Pr.crossTileID],ci=Kn===I.WritingMode.vertical,Oi=Kn===I.WritingMode.horizontal||Kn===I.WritingMode.horizontalOnly;if(Rr>0||gn>0){var na=ji(bn.text);cr(x.text,Rr,ci?Ma:na),cr(x.text,gn,Oi?Ma:na);var ia=bn.text.isHidden();[Pr.rightJustifiedTextSymbolIndex,Pr.centerJustifiedTextSymbolIndex,Pr.leftJustifiedTextSymbolIndex].forEach(function(da){da>=0&&(x.text.placedSymbolArray.get(da).hidden=ia||ci?1:0)}),Pr.verticalPlacedTextSymbolIndex>=0&&(x.text.placedSymbolArray.get(Pr.verticalPlacedTextSymbolIndex).hidden=ia||Oi?1:0);var ua=M.variableOffsets[Pr.crossTileID];ua&&M.markUsedJustification(x,ua.anchor,Pr,Kn);var Qa=M.placedOrientations[Pr.crossTileID];Qa&&(M.markUsedJustification(x,"left",Pr,Qa),M.markUsedOrientation(x,Qa,Pr))}if(Zn){var Fi=ji(bn.icon),Ra=!(Be&&Pr.verticalPlacedIconSymbolIndex&&ci);Pr.placedIconSymbolIndex>=0&&(cr(x.icon,Pr.numIconVertices,Ra?Fi:Ma),x.icon.placedSymbolArray.get(Pr.placedIconSymbolIndex).hidden=bn.icon.isHidden()),Pr.verticalPlacedIconSymbolIndex>=0&&(cr(x.icon,Pr.numVerticalIconVertices,Ra?Ma:Fi),x.icon.placedSymbolArray.get(Pr.verticalPlacedIconSymbolIndex).hidden=bn.icon.isHidden())}if(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData()){var Aa=x.collisionArrays[xr];if(Aa){var ka=new I.Point(0,0);if(Aa.textBox||Aa.verticalTextBox){var la=!0;if(Ut){var Na=M.variableOffsets[ln];Na?(ka=Go(Na.anchor,Na.width,Na.height,Na.textOffset,Na.textBoxScale),re&&ka._rotate(De?M.transform.angle:-M.transform.angle)):la=!1}Aa.textBox&&Rl(x.textCollisionBox.collisionVertexArray,bn.text.placed,!la||ci,ka.x,ka.y),Aa.verticalTextBox&&Rl(x.textCollisionBox.collisionVertexArray,bn.text.placed,!la||Oi,ka.x,ka.y)}var pa=Boolean(!Oi&&Aa.verticalIconBox);Aa.iconBox&&Rl(x.iconCollisionBox.collisionVertexArray,bn.icon.placed,pa,Be?ka.x:0,Be?ka.y:0),Aa.verticalIconBox&&Rl(x.iconCollisionBox.collisionVertexArray,bn.icon.placed,!pa,Be?ka.x:0,Be?ka.y:0)}}},br=0;br<x.symbolInstances.length;br++)ar(br);if(x.sortFeatures(this.transform.angle),this.retainedQueryData[x.bucketInstanceId]&&(this.retainedQueryData[x.bucketInstanceId].featureSortOrder=x.featureSortOrder),x.hasTextData()&&x.text.opacityVertexBuffer&&x.text.opacityVertexBuffer.updateData(x.text.opacityVertexArray),x.hasIconData()&&x.icon.opacityVertexBuffer&&x.icon.opacityVertexBuffer.updateData(x.icon.opacityVertexArray),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexBuffer&&x.iconCollisionBox.collisionVertexBuffer.updateData(x.iconCollisionBox.collisionVertexArray),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexBuffer&&x.textCollisionBox.collisionVertexBuffer.updateData(x.textCollisionBox.collisionVertexArray),x.bucketInstanceId in this.collisionCircleArrays){var rr=this.collisionCircleArrays[x.bucketInstanceId];x.placementInvProjMatrix=rr.invProjMatrix,x.placementViewportMatrix=rr.viewportMatrix,x.collisionCircleArray=rr.circles,delete this.collisionCircleArrays[x.bucketInstanceId]}},ys.prototype.symbolFadeChange=function(x){return this.fadeDuration===0?1:(x-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},ys.prototype.zoomAdjustment=function(x){return Math.max(0,(this.transform.zoom-x)/1.5)},ys.prototype.hasTransitions=function(x){return this.stale||x-this.lastPlacementChangeTime<this.fadeDuration},ys.prototype.stillRecent=function(x,C){var w=this.zoomAtLastRecencyCheck===C?1-this.zoomAdjustment(C):1;return this.zoomAtLastRecencyCheck=C,this.commitTime+this.fadeDuration*w>x},ys.prototype.setStale=function(){this.stale=!0};var mf=Math.pow(2,25),Wu=Math.pow(2,24),ke=Math.pow(2,17),Xe=Math.pow(2,16),Tr=Math.pow(2,9),un=Math.pow(2,8),si=Math.pow(2,1);function ji(x){if(x.opacity===0&&!x.placed)return 0;if(x.opacity===1&&x.placed)return 4294967295;var C=x.placed?1:0,w=Math.floor(127*x.opacity);return w*mf+C*Wu+w*ke+C*Xe+w*Tr+C*un+w*si+C}var Ma=0,ds=function(x){this._sortAcrossTiles=x.layout.get("symbol-z-order")!=="viewport-y"&&x.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ds.prototype.continuePlacement=function(x,C,w,M,z){for(var H=this._bucketParts;this._currentTileIndex<x.length;)if(C.getBucketParts(H,M,x[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,z())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,H.sort(function($,ft){return $.sortKey-ft.sortKey}));this._currentPartIndex<H.length;)if(C.placeLayerBucketPart(H[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,z())return!0;return!1};var Ho=function(x,C,w,M,z,H,$){this.placement=new ys(x,z,H,$),this._currentPlacementIndex=C.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=M,this._done=!1};Ho.prototype.isDone=function(){return this._done},Ho.prototype.continuePlacement=function(x,C,w){for(var M=this,z=I.browser.now(),H=function(){var Ut=I.browser.now()-z;return!M._forceFullPlacement&&Ut>2};this._currentPlacementIndex>=0;){var $=C[x[this._currentPlacementIndex]],ft=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=ft)&&(!$.maxzoom||$.maxzoom>ft)){if(this._inProgressLayer||(this._inProgressLayer=new ds($)),this._inProgressLayer.continuePlacement(w[$.source],this.placement,this._showCollisionBoxes,$,H))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ho.prototype.commit=function(x){return this.placement.commit(x),this.placement};var qo=512/I.EXTENT/2,Hs=function(x,C,w){this.tileID=x,this.indexedSymbolInstances={},this.bucketInstanceId=w;for(var M=0;M<C.length;M++){var z=C.get(M),H=z.key;this.indexedSymbolInstances[H]||(this.indexedSymbolInstances[H]=[]),this.indexedSymbolInstances[H].push({crossTileID:z.crossTileID,coord:this.getScaledCoordinates(z,x)})}};Hs.prototype.getScaledCoordinates=function(x,C){var w=qo/Math.pow(2,C.canonical.z-this.tileID.canonical.z);return{x:Math.floor((C.canonical.x*I.EXTENT+x.anchorX)*w),y:Math.floor((C.canonical.y*I.EXTENT+x.anchorY)*w)}},Hs.prototype.findMatches=function(x,C,w){for(var M=this.tileID.canonical.z<C.canonical.z?1:Math.pow(2,this.tileID.canonical.z-C.canonical.z),z=0;z<x.length;z++){var H=x.get(z);if(!H.crossTileID){var $=this.indexedSymbolInstances[H.key];if($)for(var ft=this.getScaledCoordinates(H,C),Ut=0,re=$;Ut<re.length;Ut+=1){var De=re[Ut];if(Math.abs(De.coord.x-ft.x)<=M&&Math.abs(De.coord.y-ft.y)<=M&&!w[De.crossTileID]){w[De.crossTileID]=!0,H.crossTileID=De.crossTileID;break}}}}};var Xu=function(){this.maxCrossTileID=0};Xu.prototype.generate=function(){return++this.maxCrossTileID};var _s=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};_s.prototype.handleWrapJump=function(x){var C=Math.round((x-this.lng)/360);if(C!==0)for(var w in this.indexes){var M=this.indexes[w],z={};for(var H in M){var $=M[H];$.tileID=$.tileID.unwrapTo($.tileID.wrap+C),z[$.tileID.key]=$}this.indexes[w]=z}this.lng=x},_s.prototype.addBucket=function(x,C,w){if(this.indexes[x.overscaledZ]&&this.indexes[x.overscaledZ][x.key]){if(this.indexes[x.overscaledZ][x.key].bucketInstanceId===C.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(x.overscaledZ,this.indexes[x.overscaledZ][x.key])}for(var M=0;M<C.symbolInstances.length;M++)C.symbolInstances.get(M).crossTileID=0;this.usedCrossTileIDs[x.overscaledZ]||(this.usedCrossTileIDs[x.overscaledZ]={});var z=this.usedCrossTileIDs[x.overscaledZ];for(var H in this.indexes){var $=this.indexes[H];if(Number(H)>x.overscaledZ)for(var ft in $){var Ut=$[ft];Ut.tileID.isChildOf(x)&&Ut.findMatches(C.symbolInstances,x,z)}else{var re=$[x.scaledTo(Number(H)).key];re&&re.findMatches(C.symbolInstances,x,z)}}for(var De=0;De<C.symbolInstances.length;De++){var Be=C.symbolInstances.get(De);Be.crossTileID||(Be.crossTileID=w.generate(),z[Be.crossTileID]=!0)}return this.indexes[x.overscaledZ]===void 0&&(this.indexes[x.overscaledZ]={}),this.indexes[x.overscaledZ][x.key]=new Hs(x,C.symbolInstances,C.bucketInstanceId),!0},_s.prototype.removeBucketCrossTileIDs=function(x,C){for(var w in C.indexedSymbolInstances)for(var M=0,z=C.indexedSymbolInstances[w];M<z.length;M+=1)delete this.usedCrossTileIDs[x][z[M].crossTileID]},_s.prototype.removeStaleBuckets=function(x){var C=!1;for(var w in this.indexes){var M=this.indexes[w];for(var z in M)x[M[z].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,M[z]),delete M[z],C=!0)}return C};var vs=function(){this.layerIndexes={},this.crossTileIDs=new Xu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};vs.prototype.addLayer=function(x,C,w){var M=this.layerIndexes[x.id];M===void 0&&(M=this.layerIndexes[x.id]=new _s);var z=!1,H={};M.handleWrapJump(w);for(var $=0,ft=C;$<ft.length;$+=1){var Ut=ft[$],re=Ut.getBucket(x);re&&x.id===re.layerIds[0]&&(re.bucketInstanceId||(re.bucketInstanceId=++this.maxBucketInstanceId),M.addBucket(Ut.tileID,re,this.crossTileIDs)&&(z=!0),H[re.bucketInstanceId]=!0)}return M.removeStaleBuckets(H)&&(z=!0),z},vs.prototype.pruneUnusedLayers=function(x){var C={};for(var w in x.forEach(function(M){C[M]=!0}),this.layerIndexes)C[w]||delete this.layerIndexes[w]};var Ou=function(x,C){return I.emitValidationErrors(x,C&&C.filter(function(w){return w.identifier!=="source.canvas"}))},rl=I.pick(hi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),nu=I.pick(hi,["setCenter","setZoom","setBearing","setPitch"]),dl=function(){var x={},C=I.styleSpec.$version;for(var w in I.styleSpec.$root){var M,z=I.styleSpec.$root[w];z.required&&(M=w==="version"?C:z.type==="array"?[]:{})!=null&&(x[w]=M)}return x}(),Fu=function(x){function C(w,M){var z=this;M===void 0&&(M={}),x.call(this),this.map=w,this.dispatcher=new we(Kr(),this),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new Dt(w._requestManager,M.localIdeographFontFamily),this.lineAtlas=new ee(256,512),this.crossTileSymbolIndex=new vs,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new I.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",I.getReferrer());var H=this;this._rtlTextPluginCallback=C.registerForPluginStateChange(function($){H.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:$.pluginStatus,pluginURL:$.pluginURL},function(ft,Ut){if(I.triggerPluginCompletionEvent(ft),Ut&&Ut.every(function(De){return De}))for(var re in H.sourceCaches)H.sourceCaches[re].reload()})}),this.on("data",function($){if($.dataType==="source"&&$.sourceDataType==="metadata"){var ft=z.sourceCaches[$.sourceId];if(ft){var Ut=ft.getSource();if(Ut&&Ut.vectorLayerIds)for(var re in z._layers){var De=z._layers[re];De.source===Ut.id&&z._validateLayer(De)}}}})}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.loadURL=function(w,M){var z=this;M===void 0&&(M={}),this.fire(new I.Event("dataloading",{dataType:"style"}));var H=typeof M.validate=="boolean"?M.validate:!I.isMapboxURL(w);w=this.map._requestManager.normalizeStyleURL(w,M.accessToken);var $=this.map._requestManager.transformRequest(w,I.ResourceType.Style);this._request=I.getJSON($,function(ft,Ut){z._request=null,ft?z.fire(new I.ErrorEvent(ft)):Ut&&z._load(Ut,H)})},C.prototype.loadJSON=function(w,M){var z=this;M===void 0&&(M={}),this.fire(new I.Event("dataloading",{dataType:"style"})),this._request=I.browser.frame(function(){z._request=null,z._load(w,M.validate!==!1)})},C.prototype.loadEmpty=function(){this.fire(new I.Event("dataloading",{dataType:"style"})),this._load(dl,!1)},C.prototype._load=function(w,M){if(!M||!Ou(this,I.validateStyle(w))){for(var z in this._loaded=!0,this.stylesheet=w,w.sources)this.addSource(z,w.sources[z],{validate:!1});w.sprite?this._loadSprite(w.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(w.glyphs);var H=li(this.stylesheet.layers);this._order=H.map(function(re){return re.id}),this._layers={},this._serializedLayers={};for(var $=0,ft=H;$<ft.length;$+=1){var Ut=ft[$];(Ut=I.createStyleLayer(Ut)).setEventedParent(this,{layer:{id:Ut.id}}),this._layers[Ut.id]=Ut,this._serializedLayers[Ut.id]=Ut.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new me(this.stylesheet.light),this.fire(new I.Event("data",{dataType:"style"})),this.fire(new I.Event("style.load"))}},C.prototype._loadSprite=function(w){var M=this;this._spriteRequest=function(z,H,$){var ft,Ut,re,De=I.browser.devicePixelRatio>1?"@2x":"",Be=I.getJSON(H.transformRequest(H.normalizeSpriteURL(z,De,".json"),I.ResourceType.SpriteJSON),function(ar,br){Be=null,re||(re=ar,ft=br,cr())}),Le=I.getImage(H.transformRequest(H.normalizeSpriteURL(z,De,".png"),I.ResourceType.SpriteImage),function(ar,br){Le=null,re||(re=ar,Ut=br,cr())});function cr(){if(re)$(re);else if(ft&&Ut){var ar=I.browser.getImageData(Ut),br={};for(var rr in ft){var xr=ft[rr],Pr=xr.width,Rr=xr.height,gn=xr.x,ln=xr.y,bn=xr.sdf,Zn=xr.pixelRatio,Kn=xr.stretchX,ci=xr.stretchY,Oi=xr.content,na=new I.RGBAImage({width:Pr,height:Rr});I.RGBAImage.copy(ar,na,{x:gn,y:ln},{x:0,y:0},{width:Pr,height:Rr}),br[rr]={data:na,pixelRatio:Zn,sdf:bn,stretchX:Kn,stretchY:ci,content:Oi}}$(null,br)}}return{cancel:function(){Be&&(Be.cancel(),Be=null),Le&&(Le.cancel(),Le=null)}}}(w,this.map._requestManager,function(z,H){if(M._spriteRequest=null,z)M.fire(new I.ErrorEvent(z));else if(H)for(var $ in H)M.imageManager.addImage($,H[$]);M.imageManager.setLoaded(!0),M._availableImages=M.imageManager.listImages(),M.dispatcher.broadcast("setImages",M._availableImages),M.fire(new I.Event("data",{dataType:"style"}))})},C.prototype._validateLayer=function(w){var M=this.sourceCaches[w.source];if(M){var z=w.sourceLayer;if(z){var H=M.getSource();(H.type==="geojson"||H.vectorLayerIds&&H.vectorLayerIds.indexOf(z)===-1)&&this.fire(new I.ErrorEvent(new Error('Source layer "'+z+'" does not exist on source "'+H.id+'" as specified by style layer "'+w.id+'"')))}}},C.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var w in this.sourceCaches)if(!this.sourceCaches[w].loaded())return!1;return!!this.imageManager.isLoaded()},C.prototype._serializeLayers=function(w){for(var M=[],z=0,H=w;z<H.length;z+=1){var $=this._layers[H[z]];$.type!=="custom"&&M.push($.serialize())}return M},C.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var w in this.sourceCaches)if(this.sourceCaches[w].hasTransition())return!0;for(var M in this._layers)if(this._layers[M].hasTransition())return!0;return!1},C.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},C.prototype.update=function(w){if(this._loaded){var M=this._changed;if(this._changed){var z=Object.keys(this._updatedLayers),H=Object.keys(this._removedLayers);for(var $ in(z.length||H.length)&&this._updateWorkerLayers(z,H),this._updatedSources){var ft=this._updatedSources[$];ft==="reload"?this._reloadSource($):ft==="clear"&&this._clearSource($)}for(var Ut in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Ut].updateTransitions(w);this.light.updateTransitions(w),this._resetUpdates()}var re={};for(var De in this.sourceCaches){var Be=this.sourceCaches[De];re[De]=Be.used,Be.used=!1}for(var Le=0,cr=this._order;Le<cr.length;Le+=1){var ar=this._layers[cr[Le]];ar.recalculate(w,this._availableImages),!ar.isHidden(w.zoom)&&ar.source&&(this.sourceCaches[ar.source].used=!0)}for(var br in re){var rr=this.sourceCaches[br];re[br]!==rr.used&&rr.fire(new I.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:br}))}this.light.recalculate(w),this.z=w.zoom,M&&this.fire(new I.Event("data",{dataType:"style"}))}},C.prototype._updateTilesForChangedImages=function(){var w=Object.keys(this._changedImages);if(w.length){for(var M in this.sourceCaches)this.sourceCaches[M].reloadTilesForDependencies(["icons","patterns"],w);this._changedImages={}}},C.prototype._updateWorkerLayers=function(w,M){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(w),removedIds:M})},C.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},C.prototype.setState=function(w){var M=this;if(this._checkLoaded(),Ou(this,I.validateStyle(w)))return!1;(w=I.clone$1(w)).layers=li(w.layers);var z=function($,ft){if(!$)return[{command:hi.setStyle,args:[ft]}];var Ut=[];try{if(!I.deepEqual($.version,ft.version))return[{command:hi.setStyle,args:[ft]}];I.deepEqual($.center,ft.center)||Ut.push({command:hi.setCenter,args:[ft.center]}),I.deepEqual($.zoom,ft.zoom)||Ut.push({command:hi.setZoom,args:[ft.zoom]}),I.deepEqual($.bearing,ft.bearing)||Ut.push({command:hi.setBearing,args:[ft.bearing]}),I.deepEqual($.pitch,ft.pitch)||Ut.push({command:hi.setPitch,args:[ft.pitch]}),I.deepEqual($.sprite,ft.sprite)||Ut.push({command:hi.setSprite,args:[ft.sprite]}),I.deepEqual($.glyphs,ft.glyphs)||Ut.push({command:hi.setGlyphs,args:[ft.glyphs]}),I.deepEqual($.transition,ft.transition)||Ut.push({command:hi.setTransition,args:[ft.transition]}),I.deepEqual($.light,ft.light)||Ut.push({command:hi.setLight,args:[ft.light]});var re={},De=[];(function(Le,cr,ar,br){var rr;for(rr in cr=cr||{},Le=Le||{})Le.hasOwnProperty(rr)&&(cr.hasOwnProperty(rr)||Ci(rr,ar,br));for(rr in cr)cr.hasOwnProperty(rr)&&(Le.hasOwnProperty(rr)?I.deepEqual(Le[rr],cr[rr])||(Le[rr].type==="geojson"&&cr[rr].type==="geojson"&&po(Le,cr,rr)?ar.push({command:hi.setGeoJSONSourceData,args:[rr,cr[rr].data]}):Ba(rr,cr,ar,br)):ra(rr,cr,ar))})($.sources,ft.sources,De,re);var Be=[];$.layers&&$.layers.forEach(function(Le){re[Le.source]?Ut.push({command:hi.removeLayer,args:[Le.id]}):Be.push(Le)}),Ut=Ut.concat(De),function(Le,cr,ar){cr=cr||[];var br,rr,xr,Pr,Rr,gn,ln,bn=(Le=Le||[]).map(Xa),Zn=cr.map(Xa),Kn=Le.reduce(Ta,{}),ci=cr.reduce(Ta,{}),Oi=bn.slice(),na=Object.create(null);for(br=0,rr=0;br<bn.length;br++)ci.hasOwnProperty(xr=bn[br])?rr++:(ar.push({command:hi.removeLayer,args:[xr]}),Oi.splice(Oi.indexOf(xr,rr),1));for(br=0,rr=0;br<Zn.length;br++)Oi[Oi.length-1-br]!==(xr=Zn[Zn.length-1-br])&&(Kn.hasOwnProperty(xr)?(ar.push({command:hi.removeLayer,args:[xr]}),Oi.splice(Oi.lastIndexOf(xr,Oi.length-rr),1)):rr++,ar.push({command:hi.addLayer,args:[ci[xr],gn=Oi[Oi.length-br]]}),Oi.splice(Oi.length-br,0,xr),na[xr]=!0);for(br=0;br<Zn.length;br++)if(Pr=Kn[xr=Zn[br]],Rr=ci[xr],!na[xr]&&!I.deepEqual(Pr,Rr))if(I.deepEqual(Pr.source,Rr.source)&&I.deepEqual(Pr["source-layer"],Rr["source-layer"])&&I.deepEqual(Pr.type,Rr.type)){for(ln in za(Pr.layout,Rr.layout,ar,xr,null,hi.setLayoutProperty),za(Pr.paint,Rr.paint,ar,xr,null,hi.setPaintProperty),I.deepEqual(Pr.filter,Rr.filter)||ar.push({command:hi.setFilter,args:[xr,Rr.filter]}),I.deepEqual(Pr.minzoom,Rr.minzoom)&&I.deepEqual(Pr.maxzoom,Rr.maxzoom)||ar.push({command:hi.setLayerZoomRange,args:[xr,Rr.minzoom,Rr.maxzoom]}),Pr)Pr.hasOwnProperty(ln)&&ln!=="layout"&&ln!=="paint"&&ln!=="filter"&&ln!=="metadata"&&ln!=="minzoom"&&ln!=="maxzoom"&&(ln.indexOf("paint.")===0?za(Pr[ln],Rr[ln],ar,xr,ln.slice(6),hi.setPaintProperty):I.deepEqual(Pr[ln],Rr[ln])||ar.push({command:hi.setLayerProperty,args:[xr,ln,Rr[ln]]}));for(ln in Rr)Rr.hasOwnProperty(ln)&&!Pr.hasOwnProperty(ln)&&ln!=="layout"&&ln!=="paint"&&ln!=="filter"&&ln!=="metadata"&&ln!=="minzoom"&&ln!=="maxzoom"&&(ln.indexOf("paint.")===0?za(Pr[ln],Rr[ln],ar,xr,ln.slice(6),hi.setPaintProperty):I.deepEqual(Pr[ln],Rr[ln])||ar.push({command:hi.setLayerProperty,args:[xr,ln,Rr[ln]]}))}else ar.push({command:hi.removeLayer,args:[xr]}),gn=Oi[Oi.lastIndexOf(xr)+1],ar.push({command:hi.addLayer,args:[Rr,gn]})}(Be,ft.layers,Ut)}catch(Le){console.warn("Unable to compute style diff:",Le),Ut=[{command:hi.setStyle,args:[ft]}]}return Ut}(this.serialize(),w).filter(function($){return!($.command in nu)});if(z.length===0)return!1;var H=z.filter(function($){return!($.command in rl)});if(H.length>0)throw new Error("Unimplemented: "+H.map(function($){return $.command}).join(", ")+".");return z.forEach(function($){$.command!=="setTransition"&&M[$.command].apply(M,$.args)}),this.stylesheet=w,!0},C.prototype.addImage=function(w,M){if(this.getImage(w))return this.fire(new I.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(w,M),this._afterImageUpdated(w)},C.prototype.updateImage=function(w,M){this.imageManager.updateImage(w,M)},C.prototype.getImage=function(w){return this.imageManager.getImage(w)},C.prototype.removeImage=function(w){if(!this.getImage(w))return this.fire(new I.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(w),this._afterImageUpdated(w)},C.prototype._afterImageUpdated=function(w){this._availableImages=this.imageManager.listImages(),this._changedImages[w]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new I.Event("data",{dataType:"style"}))},C.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},C.prototype.addSource=function(w,M,z){var H=this;if(z===void 0&&(z={}),this._checkLoaded(),this.sourceCaches[w]!==void 0)throw new Error("There is already a source with this ID");if(!M.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(M).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(M.type)>=0&&this._validate(I.validateStyle.source,"sources."+w,M,null,z))){this.map&&this.map._collectResourceTiming&&(M.collectResourceTiming=!0);var $=this.sourceCaches[w]=new ur(w,M,this.dispatcher);$.style=this,$.setEventedParent(this,function(){return{isSourceLoaded:H.loaded(),source:$.serialize(),sourceId:w}}),$.onAdd(this.map),this._changed=!0}},C.prototype.removeSource=function(w){if(this._checkLoaded(),this.sourceCaches[w]===void 0)throw new Error("There is no source with this ID");for(var M in this._layers)if(this._layers[M].source===w)return this.fire(new I.ErrorEvent(new Error('Source "'+w+'" cannot be removed while layer "'+M+'" is using it.')));var z=this.sourceCaches[w];delete this.sourceCaches[w],delete this._updatedSources[w],z.fire(new I.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w})),z.setEventedParent(null),z.clearTiles(),z.onRemove&&z.onRemove(this.map),this._changed=!0},C.prototype.setGeoJSONSourceData=function(w,M){this._checkLoaded(),this.sourceCaches[w].getSource().setData(M),this._changed=!0},C.prototype.getSource=function(w){return this.sourceCaches[w]&&this.sourceCaches[w].getSource()},C.prototype.addLayer=function(w,M,z){z===void 0&&(z={}),this._checkLoaded();var H=w.id;if(this.getLayer(H))this.fire(new I.ErrorEvent(new Error('Layer with id "'+H+'" already exists on this map')));else{var $;if(w.type==="custom"){if(Ou(this,I.validateCustomStyleLayer(w)))return;$=I.createStyleLayer(w)}else{if(typeof w.source=="object"&&(this.addSource(H,w.source),w=I.clone$1(w),w=I.extend(w,{source:H})),this._validate(I.validateStyle.layer,"layers."+H,w,{arrayIndex:-1},z))return;$=I.createStyleLayer(w),this._validateLayer($),$.setEventedParent(this,{layer:{id:H}}),this._serializedLayers[$.id]=$.serialize()}var ft=M?this._order.indexOf(M):this._order.length;if(M&&ft===-1)this.fire(new I.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.')));else{if(this._order.splice(ft,0,H),this._layerOrderChanged=!0,this._layers[H]=$,this._removedLayers[H]&&$.source&&$.type!=="custom"){var Ut=this._removedLayers[H];delete this._removedLayers[H],Ut.type!==$.type?this._updatedSources[$.source]="clear":(this._updatedSources[$.source]="reload",this.sourceCaches[$.source].pause())}this._updateLayer($),$.onAdd&&$.onAdd(this.map)}}},C.prototype.moveLayer=function(w,M){if(this._checkLoaded(),this._changed=!0,this._layers[w]){if(w!==M){var z=this._order.indexOf(w);this._order.splice(z,1);var H=M?this._order.indexOf(M):this._order.length;M&&H===-1?this.fire(new I.ErrorEvent(new Error('Layer with id "'+M+'" does not exist on this map.'))):(this._order.splice(H,0,w),this._layerOrderChanged=!0)}}else this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be moved.")))},C.prototype.removeLayer=function(w){this._checkLoaded();var M=this._layers[w];if(M){M.setEventedParent(null);var z=this._order.indexOf(w);this._order.splice(z,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[w]=M,delete this._layers[w],delete this._serializedLayers[w],delete this._updatedLayers[w],delete this._updatedPaintProps[w],M.onRemove&&M.onRemove(this.map)}else this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be removed.")))},C.prototype.getLayer=function(w){return this._layers[w]},C.prototype.hasLayer=function(w){return w in this._layers},C.prototype.setLayerZoomRange=function(w,M,z){this._checkLoaded();var H=this.getLayer(w);H?H.minzoom===M&&H.maxzoom===z||(M!=null&&(H.minzoom=M),z!=null&&(H.maxzoom=z),this._updateLayer(H)):this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot have zoom extent.")))},C.prototype.setFilter=function(w,M,z){z===void 0&&(z={}),this._checkLoaded();var H=this.getLayer(w);if(H){if(!I.deepEqual(H.filter,M))return M==null?(H.filter=void 0,void this._updateLayer(H)):void(this._validate(I.validateStyle.filter,"layers."+H.id+".filter",M,null,z)||(H.filter=I.clone$1(M),this._updateLayer(H)))}else this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be filtered.")))},C.prototype.getFilter=function(w){return I.clone$1(this.getLayer(w).filter)},C.prototype.setLayoutProperty=function(w,M,z,H){H===void 0&&(H={}),this._checkLoaded();var $=this.getLayer(w);$?I.deepEqual($.getLayoutProperty(M),z)||($.setLayoutProperty(M,z,H),this._updateLayer($)):this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be styled.")))},C.prototype.getLayoutProperty=function(w,M){var z=this.getLayer(w);if(z)return z.getLayoutProperty(M);this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style.")))},C.prototype.setPaintProperty=function(w,M,z,H){H===void 0&&(H={}),this._checkLoaded();var $=this.getLayer(w);$?I.deepEqual($.getPaintProperty(M),z)||($.setPaintProperty(M,z,H)&&this._updateLayer($),this._changed=!0,this._updatedPaintProps[w]=!0):this.fire(new I.ErrorEvent(new Error("The layer '"+w+"' does not exist in the map's style and cannot be styled.")))},C.prototype.getPaintProperty=function(w,M){return this.getLayer(w).getPaintProperty(M)},C.prototype.setFeatureState=function(w,M){this._checkLoaded();var z=w.source,H=w.sourceLayer,$=this.sourceCaches[z];if($!==void 0){var ft=$.getSource().type;ft==="geojson"&&H?this.fire(new I.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):ft!=="vector"||H?(w.id===void 0&&this.fire(new I.ErrorEvent(new Error("The feature id parameter must be provided."))),$.setFeatureState(H,w.id,M)):this.fire(new I.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new I.ErrorEvent(new Error("The source '"+z+"' does not exist in the map's style.")))},C.prototype.removeFeatureState=function(w,M){this._checkLoaded();var z=w.source,H=this.sourceCaches[z];if(H!==void 0){var $=H.getSource().type,ft=$==="vector"?w.sourceLayer:void 0;$!=="vector"||ft?M&&typeof w.id!="string"&&typeof w.id!="number"?this.fire(new I.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):H.removeFeatureState(ft,w.id,M):this.fire(new I.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new I.ErrorEvent(new Error("The source '"+z+"' does not exist in the map's style.")))},C.prototype.getFeatureState=function(w){this._checkLoaded();var M=w.source,z=w.sourceLayer,H=this.sourceCaches[M];if(H!==void 0){if(H.getSource().type!=="vector"||z)return w.id===void 0&&this.fire(new I.ErrorEvent(new Error("The feature id parameter must be provided."))),H.getFeatureState(z,w.id);this.fire(new I.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new I.ErrorEvent(new Error("The source '"+M+"' does not exist in the map's style.")))},C.prototype.getTransition=function(){return I.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},C.prototype.serialize=function(){return I.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:I.mapObject(this.sourceCaches,function(w){return w.serialize()}),layers:this._serializeLayers(this._order)},function(w){return w!==void 0})},C.prototype._updateLayer=function(w){this._updatedLayers[w.id]=!0,w.source&&!this._updatedSources[w.source]&&this.sourceCaches[w.source].getSource().type!=="raster"&&(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause()),this._changed=!0},C.prototype._flattenAndSortRenderedFeatures=function(w){for(var M=this,z=function(Kn){return M._layers[Kn].type==="fill-extrusion"},H={},$=[],ft=this._order.length-1;ft>=0;ft--){var Ut=this._order[ft];if(z(Ut)){H[Ut]=ft;for(var re=0,De=w;re<De.length;re+=1){var Be=De[re][Ut];if(Be)for(var Le=0,cr=Be;Le<cr.length;Le+=1)$.push(cr[Le])}}}$.sort(function(Kn,ci){return ci.intersectionZ-Kn.intersectionZ});for(var ar=[],br=this._order.length-1;br>=0;br--){var rr=this._order[br];if(z(rr))for(var xr=$.length-1;xr>=0;xr--){var Pr=$[xr].feature;if(H[Pr.layer.id]<br)break;ar.push(Pr),$.pop()}else for(var Rr=0,gn=w;Rr<gn.length;Rr+=1){var ln=gn[Rr][rr];if(ln)for(var bn=0,Zn=ln;bn<Zn.length;bn+=1)ar.push(Zn[bn].feature)}}return ar},C.prototype.queryRenderedFeatures=function(w,M,z){M&&M.filter&&this._validate(I.validateStyle.filter,"queryRenderedFeatures.filter",M.filter,null,M);var H={};if(M&&M.layers){if(!Array.isArray(M.layers))return this.fire(new I.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var $=0,ft=M.layers;$<ft.length;$+=1){var Ut=ft[$],re=this._layers[Ut];if(!re)return this.fire(new I.ErrorEvent(new Error("The layer '"+Ut+"' does not exist in the map's style and cannot be queried for features."))),[];H[re.source]=!0}}var De=[];for(var Be in M.availableImages=this._availableImages,this.sourceCaches)M.layers&&!H[Be]||De.push(Qt(this.sourceCaches[Be],this._layers,this._serializedLayers,w,M,z));return this.placement&&De.push(function(Le,cr,ar,br,rr,xr,Pr){for(var Rr={},gn=xr.queryRenderedSymbols(br),ln=[],bn=0,Zn=Object.keys(gn).map(Number);bn<Zn.length;bn+=1)ln.push(Pr[Zn[bn]]);ln.sort(Te);for(var Kn=function(){var ua=Oi[ci],Qa=ua.featureIndex.lookupSymbolFeatures(gn[ua.bucketInstanceId],cr,ua.bucketIndex,ua.sourceLayerIndex,rr.filter,rr.layers,rr.availableImages,Le);for(var Fi in Qa){var Ra=Rr[Fi]=Rr[Fi]||[],Aa=Qa[Fi];Aa.sort(function(Na,pa){var da=ua.featureSortOrder;if(da){var Ds=da.indexOf(Na.featureIndex);return da.indexOf(pa.featureIndex)-Ds}return pa.featureIndex-Na.featureIndex});for(var ka=0,la=Aa;ka<la.length;ka+=1)Ra.push(la[ka])}},ci=0,Oi=ln;ci<Oi.length;ci+=1)Kn();var na=function(ua){Rr[ua].forEach(function(Qa){var Fi=Qa.feature,Ra=ar[Le[ua].source].getFeatureState(Fi.layer["source-layer"],Fi.id);Fi.source=Fi.layer.source,Fi.layer["source-layer"]&&(Fi.sourceLayer=Fi.layer["source-layer"]),Fi.state=Ra})};for(var ia in Rr)na(ia);return Rr}(this._layers,this._serializedLayers,this.sourceCaches,w,M,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(De)},C.prototype.querySourceFeatures=function(w,M){M&&M.filter&&this._validate(I.validateStyle.filter,"querySourceFeatures.filter",M.filter,null,M);var z=this.sourceCaches[w];return z?function(H,$){for(var ft=H.getRenderableIds().map(function(cr){return H.getTileByID(cr)}),Ut=[],re={},De=0;De<ft.length;De++){var Be=ft[De],Le=Be.tileID.canonical.key;re[Le]||(re[Le]=!0,Be.querySourceFeatures(Ut,$))}return Ut}(z,M):[]},C.prototype.addSourceType=function(w,M,z){return C.getSourceType(w)?z(new Error('A source type called "'+w+'" already exists.')):(C.setSourceType(w,M),M.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:w,url:M.workerSourceURL},z):z(null,null))},C.prototype.getLight=function(){return this.light.getLight()},C.prototype.setLight=function(w,M){M===void 0&&(M={}),this._checkLoaded();var z=this.light.getLight(),H=!1;for(var $ in w)if(!I.deepEqual(w[$],z[$])){H=!0;break}if(H){var ft={now:I.browser.now(),transition:I.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(w,M),this.light.updateTransitions(ft)}},C.prototype._validate=function(w,M,z,H,$){return $===void 0&&($={}),(!$||$.validate!==!1)&&Ou(this,w.call(I.validateStyle,I.extend({key:M,style:this.serialize(),value:z,styleSpec:I.styleSpec},H)))},C.prototype._remove=function(){for(var w in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),I.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[w].setEventedParent(null);for(var M in this.sourceCaches)this.sourceCaches[M].clearTiles(),this.sourceCaches[M].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},C.prototype._clearSource=function(w){this.sourceCaches[w].clearTiles()},C.prototype._reloadSource=function(w){this.sourceCaches[w].resume(),this.sourceCaches[w].reload()},C.prototype._updateSources=function(w){for(var M in this.sourceCaches)this.sourceCaches[M].update(w)},C.prototype._generateCollisionBoxes=function(){for(var w in this.sourceCaches)this._reloadSource(w)},C.prototype._updatePlacement=function(w,M,z,H,$){$===void 0&&($=!1);for(var ft=!1,Ut=!1,re={},De=0,Be=this._order;De<Be.length;De+=1){var Le=this._layers[Be[De]];if(Le.type==="symbol"){if(!re[Le.source]){var cr=this.sourceCaches[Le.source];re[Le.source]=cr.getRenderableIds(!0).map(function(Pr){return cr.getTileByID(Pr)}).sort(function(Pr,Rr){return Rr.tileID.overscaledZ-Pr.tileID.overscaledZ||(Pr.tileID.isLessThan(Rr.tileID)?-1:1)})}var ar=this.crossTileSymbolIndex.addLayer(Le,re[Le.source],w.center.lng);ft=ft||ar}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),(($=$||this._layerOrderChanged||z===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(I.browser.now(),w.zoom))&&(this.pauseablePlacement=new Ho(w,this._order,$,M,z,H,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,re),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(I.browser.now()),Ut=!0),ft&&this.pauseablePlacement.placement.setStale()),Ut||ft)for(var br=0,rr=this._order;br<rr.length;br+=1){var xr=this._layers[rr[br]];xr.type==="symbol"&&this.placement.updateLayerOpacities(xr,re[xr.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(I.browser.now())},C.prototype._releaseSymbolFadeTiles=function(){for(var w in this.sourceCaches)this.sourceCaches[w].releaseSymbolFadeTiles()},C.prototype.getImages=function(w,M,z){this.imageManager.getImages(M.icons,z),this._updateTilesForChangedImages();var H=this.sourceCaches[M.source];H&&H.setDependencies(M.tileID.key,M.type,M.icons)},C.prototype.getGlyphs=function(w,M,z){this.glyphManager.getGlyphs(M.stacks,z)},C.prototype.getResource=function(w,M,z){return I.makeRequest(M,z)},C}(I.Evented);Fu.getSourceType=function(x){return $e[x]},Fu.setSourceType=function(x,C){$e[x]=C},Fu.registerForPluginStateChange=I.registerForPluginStateChange;var Fo=I.createLayout([{name:"a_pos",type:"Int16",components:2}]),rs=qa(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Uc=qa(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),_u=qa(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Zc=qa(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Co=qa("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),sc=qa(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Xl=qa(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),nl=qa("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),uc=qa("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),D=qa("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Y=qa(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),bt=qa(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),nt=qa(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),se=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ve=qa(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),wr=qa(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),jr=qa(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Vr=qa(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ln=qa(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Gn=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),$i=qa(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Pa=qa(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ba=qa(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),uo=qa(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Ca=qa(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),Ao=qa(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function qa(x,C){var w=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,M=C.match(/attribute ([\w]+) ([\w]+)/g),z=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),H=C.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),$=H?H.concat(z):z,ft={};return{fragmentSource:x=x.replace(w,function(Ut,re,De,Be,Le){return ft[Le]=!0,re==="define"?`
#ifndef HAS_UNIFORM_u_`+Le+`
varying `+De+" "+Be+" "+Le+`;
#else
uniform `+De+" "+Be+" u_"+Le+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Le+`
    `+De+" "+Be+" "+Le+" = u_"+Le+`;
#endif
`}),vertexSource:C=C.replace(w,function(Ut,re,De,Be,Le){var cr=Be==="float"?"vec2":"vec4",ar=Le.match(/color/)?"color":cr;return ft[Le]?re==="define"?`
#ifndef HAS_UNIFORM_u_`+Le+`
uniform lowp float u_`+Le+`_t;
attribute `+De+" "+cr+" a_"+Le+`;
varying `+De+" "+Be+" "+Le+`;
#else
uniform `+De+" "+Be+" u_"+Le+`;
#endif
`:ar==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+Le+" = a_"+Le+`;
#else
    `+De+" "+Be+" "+Le+" = u_"+Le+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+Le+" = unpack_mix_"+ar+"(a_"+Le+", u_"+Le+`_t);
#else
    `+De+" "+Be+" "+Le+" = u_"+Le+`;
#endif
`:re==="define"?`
#ifndef HAS_UNIFORM_u_`+Le+`
uniform lowp float u_`+Le+`_t;
attribute `+De+" "+cr+" a_"+Le+`;
#else
uniform `+De+" "+Be+" u_"+Le+`;
#endif
`:ar==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+De+" "+Be+" "+Le+" = a_"+Le+`;
#else
    `+De+" "+Be+" "+Le+" = u_"+Le+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Le+`
    `+De+" "+Be+" "+Le+" = unpack_mix_"+ar+"(a_"+Le+", u_"+Le+`_t);
#else
    `+De+" "+Be+" "+Le+" = u_"+Le+`;
#endif
`}),staticAttributes:M,staticUniforms:$}}var gs=Object.freeze({__proto__:null,prelude:rs,background:Uc,backgroundPattern:_u,circle:Zc,clippingMask:Co,heatmap:sc,heatmapTexture:Xl,collisionBox:nl,collisionCircle:uc,debug:D,fill:Y,fillOutline:bt,fillOutlinePattern:nt,fillPattern:se,fillExtrusion:Ve,fillExtrusionPattern:wr,hillshadePrepare:jr,hillshade:Vr,line:Ln,lineGradient:Gn,linePattern:$i,lineSDF:Pa,raster:ba,symbolIcon:uo,symbolSDF:Ca,symbolTextAndIcon:Ao}),xu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function il(x){for(var C=[],w=0;w<x.length;w++)if(x[w]!==null){var M=x[w].split(" ");C.push(M.pop())}return C}xu.prototype.bind=function(x,C,w,M,z,H,$,ft){this.context=x;for(var Ut=this.boundPaintVertexBuffers.length!==M.length,re=0;!Ut&&re<M.length;re++)this.boundPaintVertexBuffers[re]!==M[re]&&(Ut=!0);x.extVertexArrayObject&&this.vao&&this.boundProgram===C&&this.boundLayoutVertexBuffer===w&&!Ut&&this.boundIndexBuffer===z&&this.boundVertexOffset===H&&this.boundDynamicVertexBuffer===$&&this.boundDynamicVertexBuffer2===ft?(x.bindVertexArrayOES.set(this.vao),$&&$.bind(),z&&z.dynamicDraw&&z.bind(),ft&&ft.bind()):this.freshBind(C,w,M,z,H,$,ft)},xu.prototype.freshBind=function(x,C,w,M,z,H,$){var ft,Ut=x.numAttributes,re=this.context,De=re.gl;if(re.extVertexArrayObject)this.vao&&this.destroy(),this.vao=re.extVertexArrayObject.createVertexArrayOES(),re.bindVertexArrayOES.set(this.vao),ft=0,this.boundProgram=x,this.boundLayoutVertexBuffer=C,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=M,this.boundVertexOffset=z,this.boundDynamicVertexBuffer=H,this.boundDynamicVertexBuffer2=$;else{ft=re.currentNumAttributes||0;for(var Be=Ut;Be<ft;Be++)De.disableVertexAttribArray(Be)}C.enableAttributes(De,x);for(var Le=0,cr=w;Le<cr.length;Le+=1)cr[Le].enableAttributes(De,x);H&&H.enableAttributes(De,x),$&&$.enableAttributes(De,x),C.bind(),C.setVertexAttribPointers(De,x,z);for(var ar=0,br=w;ar<br.length;ar+=1){var rr=br[ar];rr.bind(),rr.setVertexAttribPointers(De,x,z)}H&&(H.bind(),H.setVertexAttribPointers(De,x,z)),M&&M.bind(),$&&($.bind(),$.setVertexAttribPointers(De,x,z)),re.currentNumAttributes=Ut},xu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var bu=function(x,C,w,M,z,H){var $=x.gl;this.program=$.createProgram();for(var ft=il(w.staticAttributes),Ut=M?M.getBinderAttributes():[],re=ft.concat(Ut),De=w.staticUniforms?il(w.staticUniforms):[],Be=M?M.getBinderUniforms():[],Le=[],cr=0,ar=De.concat(Be);cr<ar.length;cr+=1){var br=ar[cr];Le.indexOf(br)<0&&Le.push(br)}var rr=M?M.defines():[];H&&rr.push("#define OVERDRAW_INSPECTOR;");var xr=rr.concat(rs.fragmentSource,w.fragmentSource).join(`
`),Pr=rr.concat(rs.vertexSource,w.vertexSource).join(`
`),Rr=$.createShader($.FRAGMENT_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(Rr,xr),$.compileShader(Rr),$.attachShader(this.program,Rr);var gn=$.createShader($.VERTEX_SHADER);if($.isContextLost())this.failedToCreate=!0;else{$.shaderSource(gn,Pr),$.compileShader(gn),$.attachShader(this.program,gn),this.attributes={};var ln={};this.numAttributes=re.length;for(var bn=0;bn<this.numAttributes;bn++)re[bn]&&($.bindAttribLocation(this.program,bn,re[bn]),this.attributes[re[bn]]=bn);$.linkProgram(this.program),$.deleteShader(gn),$.deleteShader(Rr);for(var Zn=0;Zn<Le.length;Zn++){var Kn=Le[Zn];if(Kn&&!ln[Kn]){var ci=$.getUniformLocation(this.program,Kn);ci&&(ln[Kn]=ci)}}this.fixedUniforms=z(x,ln),this.binderUniforms=M?M.getUniforms(x,ln):[]}}};function iu(x,C,w){var M=1/Cn(w,1,C.transform.tileZoom),z=Math.pow(2,w.tileID.overscaledZ),H=w.tileSize*Math.pow(2,C.transform.tileZoom)/z,$=H*(w.tileID.canonical.x+w.tileID.wrap*z),ft=H*w.tileID.canonical.y;return{u_image:0,u_texsize:w.imageAtlasTexture.size,u_scale:[M,x.fromScale,x.toScale],u_fade:x.t,u_pixel_coord_upper:[$>>16,ft>>16],u_pixel_coord_lower:[65535&$,65535&ft]}}bu.prototype.draw=function(x,C,w,M,z,H,$,ft,Ut,re,De,Be,Le,cr,ar,br){var rr,xr=x.gl;if(!this.failedToCreate){for(var Pr in x.program.set(this.program),x.setDepthMode(w),x.setStencilMode(M),x.setColorMode(z),x.setCullFace(H),this.fixedUniforms)this.fixedUniforms[Pr].set($[Pr]);cr&&cr.setUniforms(x,this.binderUniforms,Be,{zoom:Le});for(var Rr=(rr={},rr[xr.LINES]=2,rr[xr.TRIANGLES]=3,rr[xr.LINE_STRIP]=1,rr)[C],gn=0,ln=De.get();gn<ln.length;gn+=1){var bn=ln[gn],Zn=bn.vaos||(bn.vaos={});(Zn[ft]||(Zn[ft]=new xu)).bind(x,this,Ut,cr?cr.getPaintVertexBuffers():[],re,bn.vertexOffset,ar,br),xr.drawElements(C,bn.primitiveLength*Rr,xr.UNSIGNED_SHORT,bn.primitiveOffset*Rr*2)}}};var Vc=function(x,C,w,M){var z=C.style.light,H=z.properties.get("position"),$=[H.x,H.y,H.z],ft=I.create$1();z.properties.get("anchor")==="viewport"&&I.fromRotation(ft,-C.transform.angle),I.transformMat3($,$,ft);var Ut=z.properties.get("color");return{u_matrix:x,u_lightpos:$,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[Ut.r,Ut.g,Ut.b],u_vertical_gradient:+w,u_opacity:M}},$s=function(x,C,w,M,z,H,$){return I.extend(Vc(x,C,w,M),iu(H,C,$),{u_height_factor:-Math.pow(2,z.overscaledZ)/$.tileSize/8})},Yl=function(x){return{u_matrix:x}},ye=function(x,C,w,M){return I.extend(Yl(x),iu(w,C,M))},ir=function(x,C){return{u_matrix:x,u_world:C}},Or=function(x,C,w,M,z){return I.extend(ye(x,C,w,M),{u_world:z})},$r=function(x,C,w,M){var z,H,$=x.transform;if(M.paint.get("circle-pitch-alignment")==="map"){var ft=Cn(w,1,$.zoom);z=!0,H=[ft,ft]}else z=!1,H=$.pixelsToGLUnits;return{u_camera_to_center_distance:$.cameraToCenterDistance,u_scale_with_map:+(M.paint.get("circle-pitch-scale")==="map"),u_matrix:x.translatePosMatrix(C.posMatrix,w,M.paint.get("circle-translate"),M.paint.get("circle-translate-anchor")),u_pitch_with_map:+z,u_device_pixel_ratio:I.browser.devicePixelRatio,u_extrude_scale:H}},xn=function(x,C,w){var M=Cn(w,1,C.zoom),z=Math.pow(2,C.zoom-w.tileID.overscaledZ),H=w.tileID.overscaleFactor();return{u_matrix:x,u_camera_to_center_distance:C.cameraToCenterDistance,u_pixels_to_tile_units:M,u_extrude_scale:[C.pixelsToGLUnits[0]/(M*z),C.pixelsToGLUnits[1]/(M*z)],u_overscale_factor:H}},_i=function(x,C,w){return{u_matrix:x,u_inv_matrix:C,u_camera_to_center_distance:w.cameraToCenterDistance,u_viewport_size:[w.width,w.height]}},qi=function(x,C,w){return w===void 0&&(w=1),{u_matrix:x,u_color:C,u_overlay:0,u_overlay_scale:w}},Ia=function(x){return{u_matrix:x}},du=function(x,C,w,M){return{u_matrix:x,u_extrude_scale:Cn(C,1,w),u_intensity:M}},qs=function(x,C,w){var M=x.transform;return{u_matrix:vd(x,C,w),u_ratio:1/Cn(C,1,M.zoom),u_device_pixel_ratio:I.browser.devicePixelRatio,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]]}},$a=function(x,C,w,M){return I.extend(qs(x,C,w),{u_image:0,u_image_height:M})},Dl=function(x,C,w,M){var z=x.transform,H=yf(C,z);return{u_matrix:vd(x,C,w),u_texsize:C.imageAtlasTexture.size,u_ratio:1/Cn(C,1,z.zoom),u_device_pixel_ratio:I.browser.devicePixelRatio,u_image:0,u_scale:[H,M.fromScale,M.toScale],u_fade:M.t,u_units_to_pixels:[1/z.pixelsToGLUnits[0],1/z.pixelsToGLUnits[1]]}},av=function(x,C,w,M,z){var H=x.lineAtlas,$=yf(C,x.transform),ft=w.layout.get("line-cap")==="round",Ut=H.getDash(M.from,ft),re=H.getDash(M.to,ft),De=Ut.width*z.fromScale,Be=re.width*z.toScale;return I.extend(qs(x,C,w),{u_patternscale_a:[$/De,-Ut.height/2],u_patternscale_b:[$/Be,-re.height/2],u_sdfgamma:H.width/(256*Math.min(De,Be)*I.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:Ut.y,u_tex_y_b:re.y,u_mix:z.t})};function yf(x,C){return 1/Cn(x,1,C.tileZoom)}function vd(x,C,w){return x.translatePosMatrix(C.tileID.posMatrix,C,w.paint.get("line-translate"),w.paint.get("line-translate-anchor"))}var ov=function(x,C,w,M,z){return{u_matrix:x,u_tl_parent:C,u_scale_parent:w,u_buffer_scale:1,u_fade_t:M.mix,u_opacity:M.opacity*z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:z.paint.get("raster-brightness-min"),u_brightness_high:z.paint.get("raster-brightness-max"),u_saturation_factor:($=z.paint.get("raster-saturation"),$>0?1-1/(1.001-$):-$),u_contrast_factor:(H=z.paint.get("raster-contrast"),H>0?1/(1-H):1+H),u_spin_weights:sv(z.paint.get("raster-hue-rotate"))};var H,$};function sv(x){x*=Math.PI/180;var C=Math.sin(x),w=Math.cos(x);return[(2*w+1)/3,(-Math.sqrt(3)*C-w+1)/3,(Math.sqrt(3)*C-w+1)/3]}var dh,zf=function(x,C,w,M,z,H,$,ft,Ut,re){var De=z.transform;return{u_is_size_zoom_constant:+(x==="constant"||x==="source"),u_is_size_feature_constant:+(x==="constant"||x==="camera"),u_size_t:C?C.uSizeT:0,u_size:C?C.uSize:0,u_camera_to_center_distance:De.cameraToCenterDistance,u_pitch:De.pitch/360*2*Math.PI,u_rotate_symbol:+w,u_aspect_ratio:De.width/De.height,u_fade_change:z.options.fadeDuration?z.symbolFadeChange:1,u_matrix:H,u_label_plane_matrix:$,u_coord_matrix:ft,u_is_text:+Ut,u_pitch_with_map:+M,u_texsize:re,u_texture:0}},Gc=function(x,C,w,M,z,H,$,ft,Ut,re,De){var Be=z.transform;return I.extend(zf(x,C,w,M,z,H,$,ft,Ut,re),{u_gamma_scale:M?Math.cos(Be._pitch)*Be.cameraToCenterDistance:1,u_device_pixel_ratio:I.browser.devicePixelRatio,u_is_halo:+De})},vh=function(x,C,w,M,z,H,$,ft,Ut,re){return I.extend(Gc(x,C,w,M,z,H,$,ft,!0,Ut,!0),{u_texsize_icon:re,u_texture_icon:1})},Uf=function(x,C,w){return{u_matrix:x,u_opacity:C,u_color:w}},lc=function(x,C,w,M,z,H){return I.extend(function($,ft,Ut,re){var De=Ut.imageManager.getPattern($.from.toString()),Be=Ut.imageManager.getPattern($.to.toString()),Le=Ut.imageManager.getPixelSize(),cr=Le.width,ar=Le.height,br=Math.pow(2,re.tileID.overscaledZ),rr=re.tileSize*Math.pow(2,Ut.transform.tileZoom)/br,xr=rr*(re.tileID.canonical.x+re.tileID.wrap*br),Pr=rr*re.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:De.tl,u_pattern_br_a:De.br,u_pattern_tl_b:Be.tl,u_pattern_br_b:Be.br,u_texsize:[cr,ar],u_mix:ft.t,u_pattern_size_a:De.displaySize,u_pattern_size_b:Be.displaySize,u_scale_a:ft.fromScale,u_scale_b:ft.toScale,u_tile_units_to_pixels:1/Cn(re,1,Ut.transform.tileZoom),u_pixel_coord_upper:[xr>>16,Pr>>16],u_pixel_coord_lower:[65535&xr,65535&Pr]}}(M,H,w,z),{u_matrix:x,u_opacity:C})},al={fillExtrusion:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_lightpos:new I.Uniform3f(x,C.u_lightpos),u_lightintensity:new I.Uniform1f(x,C.u_lightintensity),u_lightcolor:new I.Uniform3f(x,C.u_lightcolor),u_vertical_gradient:new I.Uniform1f(x,C.u_vertical_gradient),u_opacity:new I.Uniform1f(x,C.u_opacity)}},fillExtrusionPattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_lightpos:new I.Uniform3f(x,C.u_lightpos),u_lightintensity:new I.Uniform1f(x,C.u_lightintensity),u_lightcolor:new I.Uniform3f(x,C.u_lightcolor),u_vertical_gradient:new I.Uniform1f(x,C.u_vertical_gradient),u_height_factor:new I.Uniform1f(x,C.u_height_factor),u_image:new I.Uniform1i(x,C.u_image),u_texsize:new I.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade),u_opacity:new I.Uniform1f(x,C.u_opacity)}},fill:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},fillPattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_image:new I.Uniform1i(x,C.u_image),u_texsize:new I.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade)}},fillOutline:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_world:new I.Uniform2f(x,C.u_world)}},fillOutlinePattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_world:new I.Uniform2f(x,C.u_world),u_image:new I.Uniform1i(x,C.u_image),u_texsize:new I.Uniform2f(x,C.u_texsize),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade)}},circle:function(x,C){return{u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_scale_with_map:new I.Uniform1i(x,C.u_scale_with_map),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_extrude_scale:new I.Uniform2f(x,C.u_extrude_scale),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},collisionBox:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pixels_to_tile_units:new I.Uniform1f(x,C.u_pixels_to_tile_units),u_extrude_scale:new I.Uniform2f(x,C.u_extrude_scale),u_overscale_factor:new I.Uniform1f(x,C.u_overscale_factor)}},collisionCircle:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_inv_matrix:new I.UniformMatrix4f(x,C.u_inv_matrix),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_viewport_size:new I.Uniform2f(x,C.u_viewport_size)}},debug:function(x,C){return{u_color:new I.UniformColor(x,C.u_color),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_overlay:new I.Uniform1i(x,C.u_overlay),u_overlay_scale:new I.Uniform1f(x,C.u_overlay_scale)}},clippingMask:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},heatmap:function(x,C){return{u_extrude_scale:new I.Uniform1f(x,C.u_extrude_scale),u_intensity:new I.Uniform1f(x,C.u_intensity),u_matrix:new I.UniformMatrix4f(x,C.u_matrix)}},heatmapTexture:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_world:new I.Uniform2f(x,C.u_world),u_image:new I.Uniform1i(x,C.u_image),u_color_ramp:new I.Uniform1i(x,C.u_color_ramp),u_opacity:new I.Uniform1f(x,C.u_opacity)}},hillshade:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_image:new I.Uniform1i(x,C.u_image),u_latrange:new I.Uniform2f(x,C.u_latrange),u_light:new I.Uniform2f(x,C.u_light),u_shadow:new I.UniformColor(x,C.u_shadow),u_highlight:new I.UniformColor(x,C.u_highlight),u_accent:new I.UniformColor(x,C.u_accent)}},hillshadePrepare:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_image:new I.Uniform1i(x,C.u_image),u_dimension:new I.Uniform2f(x,C.u_dimension),u_zoom:new I.Uniform1f(x,C.u_zoom),u_unpack:new I.Uniform4f(x,C.u_unpack)}},line:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels)}},lineGradient:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels),u_image:new I.Uniform1i(x,C.u_image),u_image_height:new I.Uniform1f(x,C.u_image_height)}},linePattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_texsize:new I.Uniform2f(x,C.u_texsize),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_image:new I.Uniform1i(x,C.u_image),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels),u_scale:new I.Uniform3f(x,C.u_scale),u_fade:new I.Uniform1f(x,C.u_fade)}},lineSDF:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_ratio:new I.Uniform1f(x,C.u_ratio),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_units_to_pixels:new I.Uniform2f(x,C.u_units_to_pixels),u_patternscale_a:new I.Uniform2f(x,C.u_patternscale_a),u_patternscale_b:new I.Uniform2f(x,C.u_patternscale_b),u_sdfgamma:new I.Uniform1f(x,C.u_sdfgamma),u_image:new I.Uniform1i(x,C.u_image),u_tex_y_a:new I.Uniform1f(x,C.u_tex_y_a),u_tex_y_b:new I.Uniform1f(x,C.u_tex_y_b),u_mix:new I.Uniform1f(x,C.u_mix)}},raster:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_tl_parent:new I.Uniform2f(x,C.u_tl_parent),u_scale_parent:new I.Uniform1f(x,C.u_scale_parent),u_buffer_scale:new I.Uniform1f(x,C.u_buffer_scale),u_fade_t:new I.Uniform1f(x,C.u_fade_t),u_opacity:new I.Uniform1f(x,C.u_opacity),u_image0:new I.Uniform1i(x,C.u_image0),u_image1:new I.Uniform1i(x,C.u_image1),u_brightness_low:new I.Uniform1f(x,C.u_brightness_low),u_brightness_high:new I.Uniform1f(x,C.u_brightness_high),u_saturation_factor:new I.Uniform1f(x,C.u_saturation_factor),u_contrast_factor:new I.Uniform1f(x,C.u_contrast_factor),u_spin_weights:new I.Uniform3f(x,C.u_spin_weights)}},symbolIcon:function(x,C){return{u_is_size_zoom_constant:new I.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new I.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new I.Uniform1f(x,C.u_size_t),u_size:new I.Uniform1f(x,C.u_size),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new I.Uniform1f(x,C.u_pitch),u_rotate_symbol:new I.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new I.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new I.Uniform1f(x,C.u_fade_change),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new I.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new I.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new I.Uniform1i(x,C.u_is_text),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_texsize:new I.Uniform2f(x,C.u_texsize),u_texture:new I.Uniform1i(x,C.u_texture)}},symbolSDF:function(x,C){return{u_is_size_zoom_constant:new I.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new I.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new I.Uniform1f(x,C.u_size_t),u_size:new I.Uniform1f(x,C.u_size),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new I.Uniform1f(x,C.u_pitch),u_rotate_symbol:new I.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new I.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new I.Uniform1f(x,C.u_fade_change),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new I.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new I.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new I.Uniform1i(x,C.u_is_text),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_texsize:new I.Uniform2f(x,C.u_texsize),u_texture:new I.Uniform1i(x,C.u_texture),u_gamma_scale:new I.Uniform1f(x,C.u_gamma_scale),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_is_halo:new I.Uniform1i(x,C.u_is_halo)}},symbolTextAndIcon:function(x,C){return{u_is_size_zoom_constant:new I.Uniform1i(x,C.u_is_size_zoom_constant),u_is_size_feature_constant:new I.Uniform1i(x,C.u_is_size_feature_constant),u_size_t:new I.Uniform1f(x,C.u_size_t),u_size:new I.Uniform1f(x,C.u_size),u_camera_to_center_distance:new I.Uniform1f(x,C.u_camera_to_center_distance),u_pitch:new I.Uniform1f(x,C.u_pitch),u_rotate_symbol:new I.Uniform1i(x,C.u_rotate_symbol),u_aspect_ratio:new I.Uniform1f(x,C.u_aspect_ratio),u_fade_change:new I.Uniform1f(x,C.u_fade_change),u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_label_plane_matrix:new I.UniformMatrix4f(x,C.u_label_plane_matrix),u_coord_matrix:new I.UniformMatrix4f(x,C.u_coord_matrix),u_is_text:new I.Uniform1i(x,C.u_is_text),u_pitch_with_map:new I.Uniform1i(x,C.u_pitch_with_map),u_texsize:new I.Uniform2f(x,C.u_texsize),u_texsize_icon:new I.Uniform2f(x,C.u_texsize_icon),u_texture:new I.Uniform1i(x,C.u_texture),u_texture_icon:new I.Uniform1i(x,C.u_texture_icon),u_gamma_scale:new I.Uniform1f(x,C.u_gamma_scale),u_device_pixel_ratio:new I.Uniform1f(x,C.u_device_pixel_ratio),u_is_halo:new I.Uniform1i(x,C.u_is_halo)}},background:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_opacity:new I.Uniform1f(x,C.u_opacity),u_color:new I.UniformColor(x,C.u_color)}},backgroundPattern:function(x,C){return{u_matrix:new I.UniformMatrix4f(x,C.u_matrix),u_opacity:new I.Uniform1f(x,C.u_opacity),u_image:new I.Uniform1i(x,C.u_image),u_pattern_tl_a:new I.Uniform2f(x,C.u_pattern_tl_a),u_pattern_br_a:new I.Uniform2f(x,C.u_pattern_br_a),u_pattern_tl_b:new I.Uniform2f(x,C.u_pattern_tl_b),u_pattern_br_b:new I.Uniform2f(x,C.u_pattern_br_b),u_texsize:new I.Uniform2f(x,C.u_texsize),u_mix:new I.Uniform1f(x,C.u_mix),u_pattern_size_a:new I.Uniform2f(x,C.u_pattern_size_a),u_pattern_size_b:new I.Uniform2f(x,C.u_pattern_size_b),u_scale_a:new I.Uniform1f(x,C.u_scale_a),u_scale_b:new I.Uniform1f(x,C.u_scale_b),u_pixel_coord_upper:new I.Uniform2f(x,C.u_pixel_coord_upper),u_pixel_coord_lower:new I.Uniform2f(x,C.u_pixel_coord_lower),u_tile_units_to_pixels:new I.Uniform1f(x,C.u_tile_units_to_pixels)}}};function _f(x,C,w,M,z,H,$){for(var ft=x.context,Ut=ft.gl,re=x.useProgram("collisionBox"),De=[],Be=0,Le=0,cr=0;cr<M.length;cr++){var ar=M[cr],br=C.getTile(ar),rr=br.getBucket(w);if(rr){var xr=ar.posMatrix;z[0]===0&&z[1]===0||(xr=x.translatePosMatrix(ar.posMatrix,br,z,H));var Pr=$?rr.textCollisionBox:rr.iconCollisionBox,Rr=rr.collisionCircleArray;if(Rr.length>0){var gn=I.create(),ln=xr;I.mul(gn,rr.placementInvProjMatrix,x.transform.glCoordMatrix),I.mul(gn,gn,rr.placementViewportMatrix),De.push({circleArray:Rr,circleOffset:Le,transform:ln,invTransform:gn}),Le=Be+=Rr.length/4}Pr&&re.draw(ft,Ut.LINES,Ce.disabled,Ue.disabled,x.colorModeForRenderPass(),Sr.disabled,xn(xr,x.transform,br),w.id,Pr.layoutVertexBuffer,Pr.indexBuffer,Pr.segments,null,x.transform.zoom,null,null,Pr.collisionVertexBuffer)}}if($&&De.length){var bn=x.useProgram("collisionCircle"),Zn=new I.StructArrayLayout2f1f2i16;Zn.resize(4*Be),Zn._trim();for(var Kn=0,ci=0,Oi=De;ci<Oi.length;ci+=1)for(var na=Oi[ci],ia=0;ia<na.circleArray.length/4;ia++){var ua=4*ia,Qa=na.circleArray[ua+0],Fi=na.circleArray[ua+1],Ra=na.circleArray[ua+2],Aa=na.circleArray[ua+3];Zn.emplace(Kn++,Qa,Fi,Ra,Aa,0),Zn.emplace(Kn++,Qa,Fi,Ra,Aa,1),Zn.emplace(Kn++,Qa,Fi,Ra,Aa,2),Zn.emplace(Kn++,Qa,Fi,Ra,Aa,3)}(!dh||dh.length<2*Be)&&(dh=function(ss){var ou=2*ss,Ks=new I.StructArrayLayout3ui6;Ks.resize(ou),Ks._trim();for(var ls=0;ls<ou;ls++){var cs=6*ls;Ks.uint16[cs+0]=4*ls+0,Ks.uint16[cs+1]=4*ls+1,Ks.uint16[cs+2]=4*ls+2,Ks.uint16[cs+3]=4*ls+2,Ks.uint16[cs+4]=4*ls+3,Ks.uint16[cs+5]=4*ls+0}return Ks}(Be));for(var ka=ft.createIndexBuffer(dh,!0),la=ft.createVertexBuffer(Zn,I.collisionCircleLayout.members,!0),Na=0,pa=De;Na<pa.length;Na+=1){var da=pa[Na],Ds=_i(da.transform,da.invTransform,x.transform);bn.draw(ft,Ut.TRIANGLES,Ce.disabled,Ue.disabled,x.colorModeForRenderPass(),Sr.disabled,Ds,w.id,la,ka,I.SegmentVector.simpleSegment(0,2*da.circleOffset,da.circleArray.length,da.circleArray.length/2),null,x.transform.zoom,null,null,null)}la.destroy(),ka.destroy()}}var vl=I.identity(new Float32Array(16));function Eu(x,C,w,M,z,H){var $=I.getAnchorAlignment(x),ft=-($.horizontalAlign-.5)*C,Ut=-($.verticalAlign-.5)*w,re=I.evaluateVariableOffset(x,M);return new I.Point((ft/z+re[0])*H,(Ut/z+re[1])*H)}function Yh(x,C,w,M,z,H,$,ft,Ut,re,De){var Be=x.text.placedSymbolArray,Le=x.text.dynamicLayoutVertexArray,cr=x.icon.dynamicLayoutVertexArray,ar={};Le.clear();for(var br=0;br<Be.length;br++){var rr=Be.get(br),xr=rr.hidden||!rr.crossTileID||x.allowVerticalPlacement&&!rr.placedOrientation?null:M[rr.crossTileID];if(xr){var Pr=new I.Point(rr.anchorX,rr.anchorY),Rr=ja(Pr,w?ft:$),gn=to(H.cameraToCenterDistance,Rr.signedDistanceFromCamera),ln=z.evaluateSizeForFeature(x.textSizeData,re,rr)*gn/I.ONE_EM;w&&(ln*=x.tilePixelRatio/Ut);for(var bn=Eu(xr.anchor,xr.width,xr.height,xr.textOffset,xr.textBoxScale,ln),Zn=w?ja(Pr.add(bn),$).point:Rr.point.add(C?bn.rotate(-H.angle):bn),Kn=x.allowVerticalPlacement&&rr.placedOrientation===I.WritingMode.vertical?Math.PI/2:0,ci=0;ci<rr.numGlyphs;ci++)I.addDynamicAttributes(Le,Zn,Kn);De&&rr.associatedIconIndex>=0&&(ar[rr.associatedIconIndex]={shiftedAnchor:Zn,angle:Kn})}else tn(rr.numGlyphs,Le)}if(De){cr.clear();for(var Oi=x.icon.placedSymbolArray,na=0;na<Oi.length;na++){var ia=Oi.get(na);if(ia.hidden)tn(ia.numGlyphs,cr);else{var ua=ar[na];if(ua)for(var Qa=0;Qa<ia.numGlyphs;Qa++)I.addDynamicAttributes(cr,ua.shiftedAnchor,ua.angle);else tn(ia.numGlyphs,cr)}}x.icon.dynamicLayoutVertexBuffer.updateData(cr)}x.text.dynamicLayoutVertexBuffer.updateData(Le)}function Pp(x,C,w){return w.iconsInText&&C?"symbolTextAndIcon":x?"symbolSDF":"symbolIcon"}function Sc(x,C,w,M,z,H,$,ft,Ut,re,De,Be){for(var Le=x.context,cr=Le.gl,ar=x.transform,br=ft==="map",rr=Ut==="map",xr=br&&w.layout.get("symbol-placement")!=="point",Pr=br&&!rr&&!xr,Rr=w.layout.get("symbol-sort-key").constantOr(1)!==void 0,gn=!1,ln=x.depthModeForSublayer(0,Ce.ReadOnly),bn=w.layout.get("text-variable-anchor"),Zn=[],Kn=0,ci=M;Kn<ci.length;Kn+=1){var Oi=ci[Kn],na=C.getTile(Oi),ia=na.getBucket(w);if(ia){var ua=z?ia.text:ia.icon;if(ua&&ua.segments.get().length){var Qa=ua.programConfigurations.get(w.id),Fi=z||ia.sdfIcons,Ra=z?ia.textSizeData:ia.iconSizeData,Aa=rr||ar.pitch!==0,ka=x.useProgram(Pp(Fi,z,ia),Qa),la=I.evaluateSizeForZoom(Ra,ar.zoom),Na=void 0,pa=[0,0],da=void 0,Ds=void 0,ss=null,ou=void 0;if(z)da=na.glyphAtlasTexture,Ds=cr.LINEAR,Na=na.glyphAtlasTexture.size,ia.iconsInText&&(pa=na.imageAtlasTexture.size,ss=na.imageAtlasTexture,ou=Aa||x.options.rotating||x.options.zooming||Ra.kind==="composite"||Ra.kind==="camera"?cr.LINEAR:cr.NEAREST);else{var Ks=w.layout.get("icon-size").constantOr(0)!==1||ia.iconsNeedLinear;da=na.imageAtlasTexture,Ds=Fi||x.options.rotating||x.options.zooming||Ks||Aa?cr.LINEAR:cr.NEAREST,Na=na.imageAtlasTexture.size}var ls=Cn(na,1,x.transform.zoom),cs=Vo(Oi.posMatrix,rr,br,x.transform,ls),vu=vo(Oi.posMatrix,rr,br,x.transform,ls),Du=bn&&ia.hasTextData(),kc=w.layout.get("icon-text-fit")!=="none"&&Du&&ia.hasIconData();xr&&ju(ia,Oi.posMatrix,x,z,cs,vu,rr,re);var qu=x.translatePosMatrix(Oi.posMatrix,na,H,$),Kl=xr||z&&bn||kc?vl:cs,cl=x.translatePosMatrix(vu,na,H,$,!0),yh=Fi&&w.paint.get(z?"text-halo-width":"icon-halo-width").constantOr(1)!==0,El={program:ka,buffers:ua,uniformValues:Fi?ia.iconsInText?vh(Ra.kind,la,Pr,rr,x,qu,Kl,cl,Na,pa):Gc(Ra.kind,la,Pr,rr,x,qu,Kl,cl,z,Na,!0):zf(Ra.kind,la,Pr,rr,x,qu,Kl,cl,z,Na),atlasTexture:da,atlasTextureIcon:ss,atlasInterpolation:Ds,atlasInterpolationIcon:ou,isSDF:Fi,hasHalo:yh};if(Rr&&ia.canOverlap){gn=!0;for(var Ql=0,_h=ua.segments.get();Ql<_h.length;Ql+=1){var Yf=_h[Ql];Zn.push({segments:new I.SegmentVector([Yf]),sortKey:Yf.sortKey,state:El})}}else Zn.push({segments:ua.segments,sortKey:0,state:El})}}}gn&&Zn.sort(function(Tf,vc){return Tf.sortKey-vc.sortKey});for(var dc=0,xh=Zn;dc<xh.length;dc+=1){var Jl=xh[dc],js=Jl.state;if(Le.activeTexture.set(cr.TEXTURE0),js.atlasTexture.bind(js.atlasInterpolation,cr.CLAMP_TO_EDGE),js.atlasTextureIcon&&(Le.activeTexture.set(cr.TEXTURE1),js.atlasTextureIcon&&js.atlasTextureIcon.bind(js.atlasInterpolationIcon,cr.CLAMP_TO_EDGE)),js.isSDF){var $c=js.uniformValues;js.hasHalo&&($c.u_is_halo=1,gl(js.buffers,Jl.segments,w,x,js.program,ln,De,Be,$c)),$c.u_is_halo=0}gl(js.buffers,Jl.segments,w,x,js.program,ln,De,Be,js.uniformValues)}}function gl(x,C,w,M,z,H,$,ft,Ut){var re=M.context;z.draw(re,re.gl.TRIANGLES,H,$,ft,Sr.disabled,Ut,w.id,x.layoutVertexBuffer,x.indexBuffer,C,w.paint,M.transform.zoom,x.programConfigurations.get(w.id),x.dynamicLayoutVertexBuffer,x.opacityVertexBuffer)}function $h(x,C,w,M,z,H,$){var ft,Ut,re,De,Be,Le=x.context.gl,cr=w.paint.get("fill-pattern"),ar=cr&&cr.constantOr(1),br=w.getCrossfadeParameters();$?(Ut=ar&&!w.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ft=Le.LINES):(Ut=ar?"fillPattern":"fill",ft=Le.TRIANGLES);for(var rr=0,xr=M;rr<xr.length;rr+=1){var Pr=xr[rr],Rr=C.getTile(Pr);if(!ar||Rr.patternsLoaded()){var gn=Rr.getBucket(w);if(gn){var ln=gn.programConfigurations.get(w.id),bn=x.useProgram(Ut,ln);ar&&(x.context.activeTexture.set(Le.TEXTURE0),Rr.imageAtlasTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE),ln.updatePaintBuffers(br));var Zn=cr.constantOr(null);if(Zn&&Rr.imageAtlas){var Kn=Rr.imageAtlas,ci=Kn.patternPositions[Zn.to.toString()],Oi=Kn.patternPositions[Zn.from.toString()];ci&&Oi&&ln.setConstantPatternPositions(ci,Oi)}var na=x.translatePosMatrix(Pr.posMatrix,Rr,w.paint.get("fill-translate"),w.paint.get("fill-translate-anchor"));if($){De=gn.indexBuffer2,Be=gn.segments2;var ia=[Le.drawingBufferWidth,Le.drawingBufferHeight];re=Ut==="fillOutlinePattern"&&ar?Or(na,x,br,Rr,ia):ir(na,ia)}else De=gn.indexBuffer,Be=gn.segments,re=ar?ye(na,x,br,Rr):Yl(na);bn.draw(x.context,ft,z,x.stencilModeForClipping(Pr),H,Sr.disabled,re,w.id,gn.layoutVertexBuffer,De,Be,w.paint,x.transform.zoom,ln)}}}}function qh(x,C,w,M,z,H,$){for(var ft=x.context,Ut=ft.gl,re=w.paint.get("fill-extrusion-pattern"),De=re.constantOr(1),Be=w.getCrossfadeParameters(),Le=w.paint.get("fill-extrusion-opacity"),cr=0,ar=M;cr<ar.length;cr+=1){var br=ar[cr],rr=C.getTile(br),xr=rr.getBucket(w);if(xr){var Pr=xr.programConfigurations.get(w.id),Rr=x.useProgram(De?"fillExtrusionPattern":"fillExtrusion",Pr);De&&(x.context.activeTexture.set(Ut.TEXTURE0),rr.imageAtlasTexture.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE),Pr.updatePaintBuffers(Be));var gn=re.constantOr(null);if(gn&&rr.imageAtlas){var ln=rr.imageAtlas,bn=ln.patternPositions[gn.to.toString()],Zn=ln.patternPositions[gn.from.toString()];bn&&Zn&&Pr.setConstantPatternPositions(bn,Zn)}var Kn=x.translatePosMatrix(br.posMatrix,rr,w.paint.get("fill-extrusion-translate"),w.paint.get("fill-extrusion-translate-anchor")),ci=w.paint.get("fill-extrusion-vertical-gradient"),Oi=De?$s(Kn,x,ci,Le,br,Be,rr):Vc(Kn,x,ci,Le);Rr.draw(ft,ft.gl.TRIANGLES,z,H,$,Sr.backCCW,Oi,w.id,xr.layoutVertexBuffer,xr.indexBuffer,xr.segments,w.paint,x.transform.zoom,Pr)}}}function Op(x,C,w,M,z,H){var $=x.context,ft=$.gl,Ut=C.fbo;if(Ut){var re=x.useProgram("hillshade");$.activeTexture.set(ft.TEXTURE0),ft.bindTexture(ft.TEXTURE_2D,Ut.colorAttachment.get());var De=function(Be,Le,cr){var ar=cr.paint.get("hillshade-shadow-color"),br=cr.paint.get("hillshade-highlight-color"),rr=cr.paint.get("hillshade-accent-color"),xr=cr.paint.get("hillshade-illumination-direction")*(Math.PI/180);cr.paint.get("hillshade-illumination-anchor")==="viewport"&&(xr-=Be.transform.angle);var Pr,Rr,gn,ln=!Be.options.moving;return{u_matrix:Be.transform.calculatePosMatrix(Le.tileID.toUnwrapped(),ln),u_image:0,u_latrange:(Pr=Le.tileID,Rr=Math.pow(2,Pr.canonical.z),gn=Pr.canonical.y,[new I.MercatorCoordinate(0,gn/Rr).toLngLat().lat,new I.MercatorCoordinate(0,(gn+1)/Rr).toLngLat().lat]),u_light:[cr.paint.get("hillshade-exaggeration"),xr],u_shadow:ar,u_highlight:br,u_accent:rr}}(x,C,w);re.draw($,ft.TRIANGLES,M,z,H,Sr.disabled,De,w.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}}function Hc(x,C,w,M,z,H){var $=x.context,ft=$.gl,Ut=C.dem;if(Ut&&Ut.data){var re=Ut.dim,De=Ut.stride,Be=Ut.getPixels();if($.activeTexture.set(ft.TEXTURE1),$.pixelStoreUnpackPremultiplyAlpha.set(!1),C.demTexture=C.demTexture||x.getTileTexture(De),C.demTexture){var Le=C.demTexture;Le.update(Be,{premultiply:!1}),Le.bind(ft.NEAREST,ft.CLAMP_TO_EDGE)}else C.demTexture=new I.Texture($,Be,ft.RGBA,{premultiply:!1}),C.demTexture.bind(ft.NEAREST,ft.CLAMP_TO_EDGE);$.activeTexture.set(ft.TEXTURE0);var cr=C.fbo;if(!cr){var ar=new I.Texture($,{width:re,height:re,data:null},ft.RGBA);ar.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),(cr=C.fbo=$.createFramebuffer(re,re,!0)).colorAttachment.set(ar.texture)}$.bindFramebuffer.set(cr.framebuffer),$.viewport.set([0,0,re,re]),x.useProgram("hillshadePrepare").draw($,ft.TRIANGLES,M,z,H,Sr.disabled,function(br,rr){var xr=rr.stride,Pr=I.create();return I.ortho(Pr,0,I.EXTENT,-I.EXTENT,0,0,1),I.translate(Pr,Pr,[0,-I.EXTENT,0]),{u_matrix:Pr,u_image:1,u_dimension:[xr,xr],u_zoom:br.overscaledZ,u_unpack:rr.getUnpackVector()}}(C.tileID,Ut),w.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments),C.needsHillshadePrepare=!1}}function Kh(x,C,w,M,z){var H=M.paint.get("raster-fade-duration");if(H>0){var $=I.browser.now(),ft=($-x.timeAdded)/H,Ut=C?($-C.timeAdded)/H:-1,re=w.getSource(),De=z.coveringZoomLevel({tileSize:re.tileSize,roundZoom:re.roundZoom}),Be=!C||Math.abs(C.tileID.overscaledZ-De)>Math.abs(x.tileID.overscaledZ-De),Le=Be&&x.refreshedUponExpiration?1:I.clamp(Be?ft:1-Ut,0,1);return x.refreshedUponExpiration&&ft>=1&&(x.refreshedUponExpiration=!1),C?{opacity:1,mix:1-Le}:{opacity:Le,mix:0}}return{opacity:1,mix:0}}var $l=new I.Color(1,0,0,1),Qh=new I.Color(0,1,0,1),Zf=new I.Color(0,0,1,1),Tl=new I.Color(1,0,1,1),gd=new I.Color(0,1,1,1);function md(x,C,w,M){gh(x,0,C+w/2,x.transform.width,w,M)}function yd(x,C,w,M){gh(x,C-w/2,0,w,x.transform.height,M)}function gh(x,C,w,M,z,H){var $=x.context,ft=$.gl;ft.enable(ft.SCISSOR_TEST),ft.scissor(C*I.browser.devicePixelRatio,w*I.browser.devicePixelRatio,M*I.browser.devicePixelRatio,z*I.browser.devicePixelRatio),$.clear({color:H}),ft.disable(ft.SCISSOR_TEST)}function _d(x,C,w){var M=x.context,z=M.gl,H=w.posMatrix,$=x.useProgram("debug"),ft=Ce.disabled,Ut=Ue.disabled,re=x.colorModeForRenderPass();M.activeTexture.set(z.TEXTURE0),x.emptyTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),$.draw(M,z.LINE_STRIP,ft,Ut,re,Sr.disabled,qi(H,I.Color.red),"$debug",x.debugBuffer,x.tileBorderIndexBuffer,x.debugSegments);var De=C.getTileByID(w.key).latestRawTileData,Be=Math.floor((De&&De.byteLength||0)/1024),Le=C.getTile(w).tileSize,cr=512/Math.min(Le,512)*(w.overscaledZ/x.transform.zoom)*.5,ar=w.canonical.toString();w.overscaledZ!==w.canonical.z&&(ar+=" => "+w.overscaledZ),function(br,rr){br.initDebugOverlayCanvas();var xr=br.debugOverlayCanvas,Pr=br.context.gl,Rr=br.debugOverlayCanvas.getContext("2d");Rr.clearRect(0,0,xr.width,xr.height),Rr.shadowColor="white",Rr.shadowBlur=2,Rr.lineWidth=1.5,Rr.strokeStyle="white",Rr.textBaseline="top",Rr.font="bold 36px Open Sans, sans-serif",Rr.fillText(rr,5,5),Rr.strokeText(rr,5,5),br.debugOverlayTexture.update(xr),br.debugOverlayTexture.bind(Pr.LINEAR,Pr.CLAMP_TO_EDGE)}(x,ar+" "+Be+"kb"),$.draw(M,z.TRIANGLES,ft,Ut,fr.alphaBlended,Sr.disabled,qi(H,I.Color.transparent,cr),"$debug",x.debugBuffer,x.quadTriangleIndexBuffer,x.debugSegments)}var xf={symbol:function(x,C,w,M,z){if(x.renderPass==="translucent"){var H=Ue.disabled,$=x.colorModeForRenderPass();w.layout.get("text-variable-anchor")&&function(ft,Ut,re,De,Be,Le,cr){for(var ar=Ut.transform,br=Be==="map",rr=Le==="map",xr=0,Pr=ft;xr<Pr.length;xr+=1){var Rr=Pr[xr],gn=De.getTile(Rr),ln=gn.getBucket(re);if(ln&&ln.text&&ln.text.segments.get().length){var bn=I.evaluateSizeForZoom(ln.textSizeData,ar.zoom),Zn=Cn(gn,1,Ut.transform.zoom),Kn=Vo(Rr.posMatrix,rr,br,Ut.transform,Zn),ci=re.layout.get("icon-text-fit")!=="none"&&ln.hasIconData();if(bn){var Oi=Math.pow(2,ar.zoom-gn.tileID.overscaledZ);Yh(ln,br,rr,cr,I.symbolSize,ar,Kn,Rr.posMatrix,Oi,bn,ci)}}}}(M,x,w,C,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),z),w.paint.get("icon-opacity").constantOr(1)!==0&&Sc(x,C,w,M,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),H,$),w.paint.get("text-opacity").constantOr(1)!==0&&Sc(x,C,w,M,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),H,$),C.map.showCollisionBoxes&&(_f(x,C,w,M,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),_f(x,C,w,M,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))}},circle:function(x,C,w,M){if(x.renderPass==="translucent"){var z=w.paint.get("circle-opacity"),H=w.paint.get("circle-stroke-width"),$=w.paint.get("circle-stroke-opacity"),ft=w.layout.get("circle-sort-key").constantOr(1)!==void 0;if(z.constantOr(1)!==0||H.constantOr(1)!==0&&$.constantOr(1)!==0){for(var Ut=x.context,re=Ut.gl,De=x.depthModeForSublayer(0,Ce.ReadOnly),Be=Ue.disabled,Le=x.colorModeForRenderPass(),cr=[],ar=0;ar<M.length;ar++){var br=M[ar],rr=C.getTile(br),xr=rr.getBucket(w);if(xr){var Pr=xr.programConfigurations.get(w.id),Rr={programConfiguration:Pr,program:x.useProgram("circle",Pr),layoutVertexBuffer:xr.layoutVertexBuffer,indexBuffer:xr.indexBuffer,uniformValues:$r(x,br,rr,w)};if(ft)for(var gn=0,ln=xr.segments.get();gn<ln.length;gn+=1){var bn=ln[gn];cr.push({segments:new I.SegmentVector([bn]),sortKey:bn.sortKey,state:Rr})}else cr.push({segments:xr.segments,sortKey:0,state:Rr})}}ft&&cr.sort(function(na,ia){return na.sortKey-ia.sortKey});for(var Zn=0,Kn=cr;Zn<Kn.length;Zn+=1){var ci=Kn[Zn],Oi=ci.state;Oi.program.draw(Ut,re.TRIANGLES,De,Be,Le,Sr.disabled,Oi.uniformValues,w.id,Oi.layoutVertexBuffer,Oi.indexBuffer,ci.segments,w.paint,x.transform.zoom,Oi.programConfiguration)}}}},heatmap:function(x,C,w,M){if(w.paint.get("heatmap-opacity")!==0)if(x.renderPass==="offscreen"){var z=x.context,H=z.gl,$=Ue.disabled,ft=new fr([H.ONE,H.ONE],I.Color.transparent,[!0,!0,!0,!0]);(function(cr,ar,br){var rr=cr.gl;cr.activeTexture.set(rr.TEXTURE1),cr.viewport.set([0,0,ar.width/4,ar.height/4]);var xr=br.heatmapFbo;if(xr)rr.bindTexture(rr.TEXTURE_2D,xr.colorAttachment.get()),cr.bindFramebuffer.set(xr.framebuffer);else{var Pr=rr.createTexture();rr.bindTexture(rr.TEXTURE_2D,Pr),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_WRAP_S,rr.CLAMP_TO_EDGE),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_WRAP_T,rr.CLAMP_TO_EDGE),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_MIN_FILTER,rr.LINEAR),rr.texParameteri(rr.TEXTURE_2D,rr.TEXTURE_MAG_FILTER,rr.LINEAR),xr=br.heatmapFbo=cr.createFramebuffer(ar.width/4,ar.height/4,!1),function(Rr,gn,ln,bn){var Zn=Rr.gl;Zn.texImage2D(Zn.TEXTURE_2D,0,Zn.RGBA,gn.width/4,gn.height/4,0,Zn.RGBA,Rr.extRenderToTextureHalfFloat?Rr.extTextureHalfFloat.HALF_FLOAT_OES:Zn.UNSIGNED_BYTE,null),bn.colorAttachment.set(ln)}(cr,ar,Pr,xr)}})(z,x,w),z.clear({color:I.Color.transparent});for(var Ut=0;Ut<M.length;Ut++){var re=M[Ut];if(!C.hasRenderableParent(re)){var De=C.getTile(re),Be=De.getBucket(w);if(Be){var Le=Be.programConfigurations.get(w.id);x.useProgram("heatmap",Le).draw(z,H.TRIANGLES,Ce.disabled,$,ft,Sr.disabled,du(re.posMatrix,De,x.transform.zoom,w.paint.get("heatmap-intensity")),w.id,Be.layoutVertexBuffer,Be.indexBuffer,Be.segments,w.paint,x.transform.zoom,Le)}}}z.viewport.set([0,0,x.width,x.height])}else x.renderPass==="translucent"&&(x.context.setColorMode(x.colorModeForRenderPass()),function(cr,ar){var br=cr.context,rr=br.gl,xr=ar.heatmapFbo;if(xr){br.activeTexture.set(rr.TEXTURE0),rr.bindTexture(rr.TEXTURE_2D,xr.colorAttachment.get()),br.activeTexture.set(rr.TEXTURE1);var Pr=ar.colorRampTexture;Pr||(Pr=ar.colorRampTexture=new I.Texture(br,ar.colorRamp,rr.RGBA)),Pr.bind(rr.LINEAR,rr.CLAMP_TO_EDGE),cr.useProgram("heatmapTexture").draw(br,rr.TRIANGLES,Ce.disabled,Ue.disabled,cr.colorModeForRenderPass(),Sr.disabled,function(Rr,gn,ln,bn){var Zn=I.create();I.ortho(Zn,0,Rr.width,Rr.height,0,0,1);var Kn=Rr.context.gl;return{u_matrix:Zn,u_world:[Kn.drawingBufferWidth,Kn.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:gn.paint.get("heatmap-opacity")}}(cr,ar),ar.id,cr.viewportBuffer,cr.quadTriangleIndexBuffer,cr.viewportSegments,ar.paint,cr.transform.zoom)}}(x,w))},line:function(x,C,w,M){if(x.renderPass==="translucent"){var z=w.paint.get("line-opacity"),H=w.paint.get("line-width");if(z.constantOr(1)!==0&&H.constantOr(1)!==0)for(var $=x.depthModeForSublayer(0,Ce.ReadOnly),ft=x.colorModeForRenderPass(),Ut=w.paint.get("line-dasharray"),re=w.paint.get("line-pattern"),De=re.constantOr(1),Be=w.paint.get("line-gradient"),Le=w.getCrossfadeParameters(),cr=De?"linePattern":Ut?"lineSDF":Be?"lineGradient":"line",ar=x.context,br=ar.gl,rr=!0,xr=0,Pr=M;xr<Pr.length;xr+=1){var Rr=Pr[xr],gn=C.getTile(Rr);if(!De||gn.patternsLoaded()){var ln=gn.getBucket(w);if(ln){var bn=ln.programConfigurations.get(w.id),Zn=x.context.program.get(),Kn=x.useProgram(cr,bn),ci=rr||Kn.program!==Zn,Oi=re.constantOr(null);if(Oi&&gn.imageAtlas){var na=gn.imageAtlas,ia=na.patternPositions[Oi.to.toString()],ua=na.patternPositions[Oi.from.toString()];ia&&ua&&bn.setConstantPatternPositions(ia,ua)}var Qa=De?Dl(x,gn,w,Le):Ut?av(x,gn,w,Ut,Le):Be?$a(x,gn,w,ln.lineClipsArray.length):qs(x,gn,w);if(De)ar.activeTexture.set(br.TEXTURE0),gn.imageAtlasTexture.bind(br.LINEAR,br.CLAMP_TO_EDGE),bn.updatePaintBuffers(Le);else if(Ut&&(ci||x.lineAtlas.dirty))ar.activeTexture.set(br.TEXTURE0),x.lineAtlas.bind(ar);else if(Be){var Fi=ln.gradients[w.id],Ra=Fi.texture;if(w.gradientVersion!==Fi.version){var Aa=256;if(w.stepInterpolant){var ka=C.getSource().maxzoom,la=Rr.canonical.z===ka?Math.ceil(1<<x.transform.maxZoom-Rr.canonical.z):1;Aa=I.clamp(I.nextPowerOfTwo(ln.maxLineLength/I.EXTENT*1024*la),256,ar.maxTextureSize)}Fi.gradient=I.renderColorRamp({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:Aa,image:Fi.gradient||void 0,clips:ln.lineClipsArray}),Fi.texture?Fi.texture.update(Fi.gradient):Fi.texture=new I.Texture(ar,Fi.gradient,br.RGBA),Fi.version=w.gradientVersion,Ra=Fi.texture}ar.activeTexture.set(br.TEXTURE0),Ra.bind(w.stepInterpolant?br.NEAREST:br.LINEAR,br.CLAMP_TO_EDGE)}Kn.draw(ar,br.TRIANGLES,$,x.stencilModeForClipping(Rr),ft,Sr.disabled,Qa,w.id,ln.layoutVertexBuffer,ln.indexBuffer,ln.segments,w.paint,x.transform.zoom,bn,ln.layoutVertexBuffer2),rr=!1}}}}},fill:function(x,C,w,M){var z=w.paint.get("fill-color"),H=w.paint.get("fill-opacity");if(H.constantOr(1)!==0){var $=x.colorModeForRenderPass(),ft=w.paint.get("fill-pattern"),Ut=x.opaquePassEnabledForLayer()&&!ft.constantOr(1)&&z.constantOr(I.Color.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(x.renderPass===Ut){var re=x.depthModeForSublayer(1,x.renderPass==="opaque"?Ce.ReadWrite:Ce.ReadOnly);$h(x,C,w,M,re,$,!1)}if(x.renderPass==="translucent"&&w.paint.get("fill-antialias")){var De=x.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,Ce.ReadOnly);$h(x,C,w,M,De,$,!0)}}},"fill-extrusion":function(x,C,w,M){var z=w.paint.get("fill-extrusion-opacity");if(z!==0&&x.renderPass==="translucent"){var H=new Ce(x.context.gl.LEQUAL,Ce.ReadWrite,x.depthRangeFor3D);if(z!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))qh(x,C,w,M,H,Ue.disabled,fr.disabled),qh(x,C,w,M,H,x.stencilModeFor3D(),x.colorModeForRenderPass());else{var $=x.colorModeForRenderPass();qh(x,C,w,M,H,Ue.disabled,$)}}},hillshade:function(x,C,w,M){if(x.renderPass==="offscreen"||x.renderPass==="translucent"){for(var z=x.context,H=x.depthModeForSublayer(0,Ce.ReadOnly),$=x.colorModeForRenderPass(),ft=x.renderPass==="translucent"?x.stencilConfigForOverlap(M):[{},M],Ut=ft[0],re=0,De=ft[1];re<De.length;re+=1){var Be=De[re],Le=C.getTile(Be);Le.needsHillshadePrepare&&x.renderPass==="offscreen"?Hc(x,Le,w,H,Ue.disabled,$):x.renderPass==="translucent"&&Op(x,Le,w,H,Ut[Be.overscaledZ],$)}z.viewport.set([0,0,x.width,x.height])}},raster:function(x,C,w,M){if(x.renderPass==="translucent"&&w.paint.get("raster-opacity")!==0&&M.length)for(var z=x.context,H=z.gl,$=C.getSource(),ft=x.useProgram("raster"),Ut=x.colorModeForRenderPass(),re=$ instanceof Vt?[{},M]:x.stencilConfigForOverlap(M),De=re[0],Be=re[1],Le=Be[Be.length-1].overscaledZ,cr=!x.options.moving,ar=0,br=Be;ar<br.length;ar+=1){var rr=br[ar],xr=x.depthModeForSublayer(rr.overscaledZ-Le,w.paint.get("raster-opacity")===1?Ce.ReadWrite:Ce.ReadOnly,H.LESS),Pr=C.getTile(rr),Rr=x.transform.calculatePosMatrix(rr.toUnwrapped(),cr);Pr.registerFadeDuration(w.paint.get("raster-fade-duration"));var gn=C.findLoadedParent(rr,0),ln=Kh(Pr,gn,C,w,x.transform),bn=void 0,Zn=void 0,Kn=w.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;z.activeTexture.set(H.TEXTURE0),Pr.texture.bind(Kn,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),z.activeTexture.set(H.TEXTURE1),gn?(gn.texture.bind(Kn,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),bn=Math.pow(2,gn.tileID.overscaledZ-Pr.tileID.overscaledZ),Zn=[Pr.tileID.canonical.x*bn%1,Pr.tileID.canonical.y*bn%1]):Pr.texture.bind(Kn,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST);var ci=ov(Rr,Zn||[0,0],bn||1,ln,w);$ instanceof Vt?ft.draw(z,H.TRIANGLES,xr,Ue.disabled,Ut,Sr.disabled,ci,w.id,$.boundsBuffer,x.quadTriangleIndexBuffer,$.boundsSegments):ft.draw(z,H.TRIANGLES,xr,De[rr.overscaledZ],Ut,Sr.disabled,ci,w.id,x.rasterBoundsBuffer,x.quadTriangleIndexBuffer,x.rasterBoundsSegments)}},background:function(x,C,w){var M=w.paint.get("background-color"),z=w.paint.get("background-opacity");if(z!==0){var H=x.context,$=H.gl,ft=x.transform,Ut=ft.tileSize,re=w.paint.get("background-pattern");if(!x.isPatternMissing(re)){var De=!re&&M.a===1&&z===1&&x.opaquePassEnabledForLayer()?"opaque":"translucent";if(x.renderPass===De){var Be=Ue.disabled,Le=x.depthModeForSublayer(0,De==="opaque"?Ce.ReadWrite:Ce.ReadOnly),cr=x.colorModeForRenderPass(),ar=x.useProgram(re?"backgroundPattern":"background"),br=ft.coveringTiles({tileSize:Ut});re&&(H.activeTexture.set($.TEXTURE0),x.imageManager.bind(x.context));for(var rr=w.getCrossfadeParameters(),xr=0,Pr=br;xr<Pr.length;xr+=1){var Rr=Pr[xr],gn=x.transform.calculatePosMatrix(Rr.toUnwrapped()),ln=re?lc(gn,z,x,re,{tileID:Rr,tileSize:Ut},rr):Uf(gn,z,M);ar.draw(H,$.TRIANGLES,Le,Be,cr,Sr.disabled,ln,w.id,x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}}}},debug:function(x,C,w){for(var M=0;M<w.length;M++)_d(x,C,w[M])},custom:function(x,C,w){var M=x.context,z=w.implementation;if(x.renderPass==="offscreen"){var H=z.prerender;H&&(x.setCustomLayerDefaults(),M.setColorMode(x.colorModeForRenderPass()),H.call(z,M.gl,x.transform.customLayerMatrix()),M.setDirty(),x.setBaseState())}else if(x.renderPass==="translucent"){x.setCustomLayerDefaults(),M.setColorMode(x.colorModeForRenderPass()),M.setStencilMode(Ue.disabled);var $=z.renderingMode==="3d"?new Ce(x.context.gl.LEQUAL,Ce.ReadWrite,x.depthRangeFor3D):x.depthModeForSublayer(0,Ce.ReadOnly);M.setDepthMode($),z.render(M.gl,x.transform.customLayerMatrix()),M.setDirty(),x.setBaseState(),M.bindFramebuffer.set(null)}}},xs=function(x,C){this.context=new Pe(x),this.transform=C,this._tileTextures={},this.setup(),this.numSublayers=ur.maxUnderzooming+ur.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new vs,this.gpuTimers={}};xs.prototype.resize=function(x,C){if(this.width=x*I.browser.devicePixelRatio,this.height=C*I.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var w=0,M=this.style._order;w<M.length;w+=1)this.style._layers[M[w]].resize()},xs.prototype.setup=function(){var x=this.context,C=new I.StructArrayLayout2i4;C.emplaceBack(0,0),C.emplaceBack(I.EXTENT,0),C.emplaceBack(0,I.EXTENT),C.emplaceBack(I.EXTENT,I.EXTENT),this.tileExtentBuffer=x.createVertexBuffer(C,Fo.members),this.tileExtentSegments=I.SegmentVector.simpleSegment(0,0,4,2);var w=new I.StructArrayLayout2i4;w.emplaceBack(0,0),w.emplaceBack(I.EXTENT,0),w.emplaceBack(0,I.EXTENT),w.emplaceBack(I.EXTENT,I.EXTENT),this.debugBuffer=x.createVertexBuffer(w,Fo.members),this.debugSegments=I.SegmentVector.simpleSegment(0,0,4,5);var M=new I.StructArrayLayout4i8;M.emplaceBack(0,0,0,0),M.emplaceBack(I.EXTENT,0,I.EXTENT,0),M.emplaceBack(0,I.EXTENT,0,I.EXTENT),M.emplaceBack(I.EXTENT,I.EXTENT,I.EXTENT,I.EXTENT),this.rasterBoundsBuffer=x.createVertexBuffer(M,dt.members),this.rasterBoundsSegments=I.SegmentVector.simpleSegment(0,0,4,2);var z=new I.StructArrayLayout2i4;z.emplaceBack(0,0),z.emplaceBack(1,0),z.emplaceBack(0,1),z.emplaceBack(1,1),this.viewportBuffer=x.createVertexBuffer(z,Fo.members),this.viewportSegments=I.SegmentVector.simpleSegment(0,0,4,2);var H=new I.StructArrayLayout1ui2;H.emplaceBack(0),H.emplaceBack(1),H.emplaceBack(3),H.emplaceBack(2),H.emplaceBack(0),this.tileBorderIndexBuffer=x.createIndexBuffer(H);var $=new I.StructArrayLayout3ui6;$.emplaceBack(0,1,2),$.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=x.createIndexBuffer($),this.emptyTexture=new I.Texture(x,{width:1,height:1,data:new Uint8Array([0,0,0,0])},x.gl.RGBA);var ft=this.context.gl;this.stencilClearMode=new Ue({func:ft.ALWAYS,mask:0},0,255,ft.ZERO,ft.ZERO,ft.ZERO)},xs.prototype.clearStencil=function(){var x=this.context,C=x.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var w=I.create();I.ortho(w,0,this.width,this.height,0,0,1),I.scale(w,w,[C.drawingBufferWidth,C.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(x,C.TRIANGLES,Ce.disabled,this.stencilClearMode,fr.disabled,Sr.disabled,Ia(w),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},xs.prototype._renderTileClippingMasks=function(x,C){if(this.currentStencilSource!==x.source&&x.isTileClipped()&&C&&C.length){this.currentStencilSource=x.source;var w=this.context,M=w.gl;this.nextStencilID+C.length>256&&this.clearStencil(),w.setColorMode(fr.disabled),w.setDepthMode(Ce.disabled);var z=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var H=0,$=C;H<$.length;H+=1){var ft=$[H],Ut=this._tileClippingMaskIDs[ft.key]=this.nextStencilID++;z.draw(w,M.TRIANGLES,Ce.disabled,new Ue({func:M.ALWAYS,mask:0},Ut,255,M.KEEP,M.KEEP,M.REPLACE),fr.disabled,Sr.disabled,Ia(ft.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},xs.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var x=this.nextStencilID++,C=this.context.gl;return new Ue({func:C.NOTEQUAL,mask:255},x,255,C.KEEP,C.KEEP,C.REPLACE)},xs.prototype.stencilModeForClipping=function(x){var C=this.context.gl;return new Ue({func:C.EQUAL,mask:255},this._tileClippingMaskIDs[x.key],0,C.KEEP,C.KEEP,C.REPLACE)},xs.prototype.stencilConfigForOverlap=function(x){var C,w=this.context.gl,M=x.sort(function(Ut,re){return re.overscaledZ-Ut.overscaledZ}),z=M[M.length-1].overscaledZ,H=M[0].overscaledZ-z+1;if(H>1){this.currentStencilSource=void 0,this.nextStencilID+H>256&&this.clearStencil();for(var $={},ft=0;ft<H;ft++)$[ft+z]=new Ue({func:w.GEQUAL,mask:255},ft+this.nextStencilID,255,w.KEEP,w.KEEP,w.REPLACE);return this.nextStencilID+=H,[$,M]}return[(C={},C[z]=Ue.disabled,C),M]},xs.prototype.colorModeForRenderPass=function(){var x=this.context.gl;return this._showOverdrawInspector?new fr([x.CONSTANT_COLOR,x.ONE],new I.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?fr.unblended:fr.alphaBlended},xs.prototype.depthModeForSublayer=function(x,C,w){if(!this.opaquePassEnabledForLayer())return Ce.disabled;var M=1-((1+this.currentLayer)*this.numSublayers+x)*this.depthEpsilon;return new Ce(w||this.context.gl.LEQUAL,C,[M,M])},xs.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},xs.prototype.render=function(x,C){var w=this;this.style=x,this.options=C,this.lineAtlas=x.lineAtlas,this.imageManager=x.imageManager,this.glyphManager=x.glyphManager,this.symbolFadeChange=x.placement.symbolFadeChange(I.browser.now()),this.imageManager.beginFrame();var M=this.style._order,z=this.style.sourceCaches;for(var H in z){var $=z[H];$.used&&$.prepare(this.context)}var ft,Ut,re={},De={},Be={};for(var Le in z){var cr=z[Le];re[Le]=cr.getVisibleCoordinates(),De[Le]=re[Le].slice().reverse(),Be[Le]=cr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var ar=0;ar<M.length;ar++)if(this.style._layers[M[ar]].is3D()){this.opaquePassCutoff=ar;break}this.renderPass="offscreen";for(var br=0,rr=M;br<rr.length;br+=1){var xr=this.style._layers[rr[br]];if(xr.hasOffscreenPass()&&!xr.isHidden(this.transform.zoom)){var Pr=De[xr.source];(xr.type==="custom"||Pr.length)&&this.renderLayer(this,z[xr.source],xr,Pr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:C.showOverdrawInspector?I.Color.black:I.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=C.showOverdrawInspector,this.depthRangeFor3D=[0,1-(x._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){var Rr=this.style._layers[M[this.currentLayer]],gn=z[Rr.source],ln=re[Rr.source];this._renderTileClippingMasks(Rr,ln),this.renderLayer(this,gn,Rr,ln)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){var bn=this.style._layers[M[this.currentLayer]],Zn=z[bn.source],Kn=(bn.type==="symbol"?Be:De)[bn.source];this._renderTileClippingMasks(bn,re[bn.source]),this.renderLayer(this,Zn,bn,Kn)}this.options.showTileBoundaries&&(I.values(this.style._layers).forEach(function(ci){ci.source&&!ci.isHidden(w.transform.zoom)&&(ci.source!==(Ut&&Ut.id)&&(Ut=w.style.sourceCaches[ci.source]),(!ft||ft.getSource().maxzoom<Ut.getSource().maxzoom)&&(ft=Ut))}),ft&&xf.debug(this,ft,ft.getVisibleCoordinates())),this.options.showPadding&&function(ci){var Oi=ci.transform.padding;md(ci,ci.transform.height-(Oi.top||0),3,$l),md(ci,Oi.bottom||0,3,Qh),yd(ci,Oi.left||0,3,Zf),yd(ci,ci.transform.width-(Oi.right||0),3,Tl);var na=ci.transform.centerPoint;(function(ia,ua,Qa,Fi){gh(ia,ua-1,Qa-10,2,20,Fi),gh(ia,ua-10,Qa-1,20,2,Fi)})(ci,na.x,ci.transform.height-na.y,gd)}(this),this.context.setDefault()},xs.prototype.renderLayer=function(x,C,w,M){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="custom"||M.length)&&(this.id=w.id,this.gpuTimingStart(w),xf[w.type](x,C,w,M,this.style.placement.variableOffsets),this.gpuTimingEnd())},xs.prototype.gpuTimingStart=function(x){if(this.options.gpuTiming){var C=this.context.extTimerQuery,w=this.gpuTimers[x.id];w||(w=this.gpuTimers[x.id]={calls:0,cpuTime:0,query:C.createQueryEXT()}),w.calls++,C.beginQueryEXT(C.TIME_ELAPSED_EXT,w.query)}},xs.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var x=this.context.extTimerQuery;x.endQueryEXT(x.TIME_ELAPSED_EXT)}},xs.prototype.collectGpuTimers=function(){var x=this.gpuTimers;return this.gpuTimers={},x},xs.prototype.queryGpuTimers=function(x){var C={};for(var w in x){var M=x[w],z=this.context.extTimerQuery,H=z.getQueryObjectEXT(M.query,z.QUERY_RESULT_EXT)/1e6;z.deleteQueryEXT(M.query),C[w]=H}return C},xs.prototype.translatePosMatrix=function(x,C,w,M,z){if(!w[0]&&!w[1])return x;var H=z?M==="map"?this.transform.angle:0:M==="viewport"?-this.transform.angle:0;if(H){var $=Math.sin(H),ft=Math.cos(H);w=[w[0]*ft-w[1]*$,w[0]*$+w[1]*ft]}var Ut=[z?w[0]:Cn(C,w[0],this.transform.zoom),z?w[1]:Cn(C,w[1],this.transform.zoom),0],re=new Float32Array(16);return I.translate(re,x,Ut),re},xs.prototype.saveTileTexture=function(x){var C=this._tileTextures[x.size[0]];C?C.push(x):this._tileTextures[x.size[0]]=[x]},xs.prototype.getTileTexture=function(x){var C=this._tileTextures[x];return C&&C.length>0?C.pop():null},xs.prototype.isPatternMissing=function(x){if(!x)return!1;if(!x.from||!x.to)return!0;var C=this.imageManager.getPattern(x.from.toString()),w=this.imageManager.getPattern(x.to.toString());return!C||!w},xs.prototype.useProgram=function(x,C){this.cache=this.cache||{};var w=""+x+(C?C.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[w]||(this.cache[w]=new bu(this.context,x,gs[x],C,al[x],this._showOverdrawInspector)),this.cache[w]},xs.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},xs.prototype.setBaseState=function(){var x=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(x.FUNC_ADD)},xs.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=I.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new I.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},xs.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Jh=function(x,C){this.points=x,this.planes=C};Jh.fromInvProjectionMatrix=function(x,C,w){var M=Math.pow(2,w),z=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function($){return I.transformMat4([],$,x)}).map(function($){return I.scale$1([],$,1/$[3]/C*M)}),H=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function($){var ft=I.sub([],z[$[0]],z[$[1]]),Ut=I.sub([],z[$[2]],z[$[1]]),re=I.normalize([],I.cross([],ft,Ut)),De=-I.dot(re,z[$[1]]);return re.concat(De)});return new Jh(z,H)};var Vf=function(x,C){this.min=x,this.max=C,this.center=I.scale$2([],I.add([],this.min,this.max),.5)};Vf.prototype.quadrant=function(x){for(var C=[x%2==0,x<2],w=I.clone$2(this.min),M=I.clone$2(this.max),z=0;z<C.length;z++)w[z]=C[z]?this.min[z]:this.center[z],M[z]=C[z]?this.center[z]:this.max[z];return M[2]=this.max[2],new Vf(w,M)},Vf.prototype.distanceX=function(x){return Math.max(Math.min(this.max[0],x[0]),this.min[0])-x[0]},Vf.prototype.distanceY=function(x){return Math.max(Math.min(this.max[1],x[1]),this.min[1])-x[1]},Vf.prototype.intersects=function(x){for(var C=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],w=!0,M=0;M<x.planes.length;M++){for(var z=x.planes[M],H=0,$=0;$<C.length;$++)H+=I.dot$1(z,C[$])>=0;if(H===0)return 0;H!==C.length&&(w=!1)}if(w)return 2;for(var ft=0;ft<3;ft++){for(var Ut=Number.MAX_VALUE,re=-Number.MAX_VALUE,De=0;De<x.points.length;De++){var Be=x.points[De][ft]-this.min[ft];Ut=Math.min(Ut,Be),re=Math.max(re,Be)}if(re<0||Ut>this.max[ft]-this.min[ft])return 0}return 1};var Bl=function(x,C,w,M){if(x===void 0&&(x=0),C===void 0&&(C=0),w===void 0&&(w=0),M===void 0&&(M=0),isNaN(x)||x<0||isNaN(C)||C<0||isNaN(w)||w<0||isNaN(M)||M<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=x,this.bottom=C,this.left=w,this.right=M};Bl.prototype.interpolate=function(x,C,w){return C.top!=null&&x.top!=null&&(this.top=I.number(x.top,C.top,w)),C.bottom!=null&&x.bottom!=null&&(this.bottom=I.number(x.bottom,C.bottom,w)),C.left!=null&&x.left!=null&&(this.left=I.number(x.left,C.left,w)),C.right!=null&&x.right!=null&&(this.right=I.number(x.right,C.right,w)),this},Bl.prototype.getCenter=function(x,C){var w=I.clamp((this.left+x-this.right)/2,0,x),M=I.clamp((this.top+C-this.bottom)/2,0,C);return new I.Point(w,M)},Bl.prototype.equals=function(x){return this.top===x.top&&this.bottom===x.bottom&&this.left===x.left&&this.right===x.right},Bl.prototype.clone=function(){return new Bl(this.top,this.bottom,this.left,this.right)},Bl.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var go=function(x,C,w,M,z){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=z===void 0||z,this._minZoom=x||0,this._maxZoom=C||22,this._minPitch=w==null?0:w,this._maxPitch=M==null?60:M,this.setMaxBounds(),this.width=0,this.height=0,this._center=new I.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Bl,this._posMatrixCache={},this._alignedPosMatrixCache={}},is={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};go.prototype.clone=function(){var x=new go(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return x.tileSize=this.tileSize,x.latRange=this.latRange,x.width=this.width,x.height=this.height,x._center=this._center,x.zoom=this.zoom,x.angle=this.angle,x._fov=this._fov,x._pitch=this._pitch,x._unmodified=this._unmodified,x._edgeInsets=this._edgeInsets.clone(),x._calcMatrices(),x},is.minZoom.get=function(){return this._minZoom},is.minZoom.set=function(x){this._minZoom!==x&&(this._minZoom=x,this.zoom=Math.max(this.zoom,x))},is.maxZoom.get=function(){return this._maxZoom},is.maxZoom.set=function(x){this._maxZoom!==x&&(this._maxZoom=x,this.zoom=Math.min(this.zoom,x))},is.minPitch.get=function(){return this._minPitch},is.minPitch.set=function(x){this._minPitch!==x&&(this._minPitch=x,this.pitch=Math.max(this.pitch,x))},is.maxPitch.get=function(){return this._maxPitch},is.maxPitch.set=function(x){this._maxPitch!==x&&(this._maxPitch=x,this.pitch=Math.min(this.pitch,x))},is.renderWorldCopies.get=function(){return this._renderWorldCopies},is.renderWorldCopies.set=function(x){x===void 0?x=!0:x===null&&(x=!1),this._renderWorldCopies=x},is.worldSize.get=function(){return this.tileSize*this.scale},is.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},is.size.get=function(){return new I.Point(this.width,this.height)},is.bearing.get=function(){return-this.angle/Math.PI*180},is.bearing.set=function(x){var C=-I.wrap(x,-180,180)*Math.PI/180;this.angle!==C&&(this._unmodified=!1,this.angle=C,this._calcMatrices(),this.rotationMatrix=I.create$2(),I.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},is.pitch.get=function(){return this._pitch/Math.PI*180},is.pitch.set=function(x){var C=I.clamp(x,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==C&&(this._unmodified=!1,this._pitch=C,this._calcMatrices())},is.fov.get=function(){return this._fov/Math.PI*180},is.fov.set=function(x){x=Math.max(.01,Math.min(60,x)),this._fov!==x&&(this._unmodified=!1,this._fov=x/180*Math.PI,this._calcMatrices())},is.zoom.get=function(){return this._zoom},is.zoom.set=function(x){var C=Math.min(Math.max(x,this.minZoom),this.maxZoom);this._zoom!==C&&(this._unmodified=!1,this._zoom=C,this.scale=this.zoomScale(C),this.tileZoom=Math.floor(C),this.zoomFraction=C-this.tileZoom,this._constrain(),this._calcMatrices())},is.center.get=function(){return this._center},is.center.set=function(x){x.lat===this._center.lat&&x.lng===this._center.lng||(this._unmodified=!1,this._center=x,this._constrain(),this._calcMatrices())},is.padding.get=function(){return this._edgeInsets.toJSON()},is.padding.set=function(x){this._edgeInsets.equals(x)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,x,1),this._calcMatrices())},is.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},go.prototype.isPaddingEqual=function(x){return this._edgeInsets.equals(x)},go.prototype.interpolatePadding=function(x,C,w){this._unmodified=!1,this._edgeInsets.interpolate(x,C,w),this._constrain(),this._calcMatrices()},go.prototype.coveringZoomLevel=function(x){var C=(x.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/x.tileSize));return Math.max(0,C)},go.prototype.getVisibleUnwrappedCoordinates=function(x){var C=[new I.UnwrappedTileID(0,x)];if(this._renderWorldCopies)for(var w=this.pointCoordinate(new I.Point(0,0)),M=this.pointCoordinate(new I.Point(this.width,0)),z=this.pointCoordinate(new I.Point(this.width,this.height)),H=this.pointCoordinate(new I.Point(0,this.height)),$=Math.floor(Math.min(w.x,M.x,z.x,H.x)),ft=Math.floor(Math.max(w.x,M.x,z.x,H.x)),Ut=$-1;Ut<=ft+1;Ut++)Ut!==0&&C.push(new I.UnwrappedTileID(Ut,x));return C},go.prototype.coveringTiles=function(x){var C=this.coveringZoomLevel(x),w=C;if(x.minzoom!==void 0&&C<x.minzoom)return[];x.maxzoom!==void 0&&C>x.maxzoom&&(C=x.maxzoom);var M=I.MercatorCoordinate.fromLngLat(this.center),z=Math.pow(2,C),H=[z*M.x,z*M.y,0],$=Jh.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C),ft=x.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ft=C);var Ut=function(ci){return{aabb:new Vf([ci*z,0,0],[(ci+1)*z,z,0]),zoom:0,x:0,y:0,wrap:ci,fullyVisible:!1}},re=[],De=[],Be=C,Le=x.reparseOverscaled?w:C;if(this._renderWorldCopies)for(var cr=1;cr<=3;cr++)re.push(Ut(-cr)),re.push(Ut(cr));for(re.push(Ut(0));re.length>0;){var ar=re.pop(),br=ar.x,rr=ar.y,xr=ar.fullyVisible;if(!xr){var Pr=ar.aabb.intersects($);if(Pr===0)continue;xr=Pr===2}var Rr=ar.aabb.distanceX(H),gn=ar.aabb.distanceY(H),ln=Math.max(Math.abs(Rr),Math.abs(gn));if(ar.zoom===Be||ln>3+(1<<Be-ar.zoom)-2&&ar.zoom>=ft)De.push({tileID:new I.OverscaledTileID(ar.zoom===Be?Le:ar.zoom,ar.wrap,ar.zoom,br,rr),distanceSq:I.sqrLen([H[0]-.5-br,H[1]-.5-rr])});else for(var bn=0;bn<4;bn++){var Zn=(br<<1)+bn%2,Kn=(rr<<1)+(bn>>1);re.push({aabb:ar.aabb.quadrant(bn),zoom:ar.zoom+1,x:Zn,y:Kn,wrap:ar.wrap,fullyVisible:xr})}}return De.sort(function(ci,Oi){return ci.distanceSq-Oi.distanceSq}).map(function(ci){return ci.tileID})},go.prototype.resize=function(x,C){this.width=x,this.height=C,this.pixelsToGLUnits=[2/x,-2/C],this._constrain(),this._calcMatrices()},is.unmodified.get=function(){return this._unmodified},go.prototype.zoomScale=function(x){return Math.pow(2,x)},go.prototype.scaleZoom=function(x){return Math.log(x)/Math.LN2},go.prototype.project=function(x){var C=I.clamp(x.lat,-this.maxValidLatitude,this.maxValidLatitude);return new I.Point(I.mercatorXfromLng(x.lng)*this.worldSize,I.mercatorYfromLat(C)*this.worldSize)},go.prototype.unproject=function(x){return new I.MercatorCoordinate(x.x/this.worldSize,x.y/this.worldSize).toLngLat()},is.point.get=function(){return this.project(this.center)},go.prototype.setLocationAtPoint=function(x,C){var w=this.pointCoordinate(C),M=this.pointCoordinate(this.centerPoint),z=this.locationCoordinate(x),H=new I.MercatorCoordinate(z.x-(w.x-M.x),z.y-(w.y-M.y));this.center=this.coordinateLocation(H),this._renderWorldCopies&&(this.center=this.center.wrap())},go.prototype.locationPoint=function(x){return this.coordinatePoint(this.locationCoordinate(x))},go.prototype.pointLocation=function(x){return this.coordinateLocation(this.pointCoordinate(x))},go.prototype.locationCoordinate=function(x){return I.MercatorCoordinate.fromLngLat(x)},go.prototype.coordinateLocation=function(x){return x.toLngLat()},go.prototype.pointCoordinate=function(x){var C=[x.x,x.y,0,1],w=[x.x,x.y,1,1];I.transformMat4(C,C,this.pixelMatrixInverse),I.transformMat4(w,w,this.pixelMatrixInverse);var M=C[3],z=w[3],H=C[1]/M,$=w[1]/z,ft=C[2]/M,Ut=w[2]/z,re=ft===Ut?0:(0-ft)/(Ut-ft);return new I.MercatorCoordinate(I.number(C[0]/M,w[0]/z,re)/this.worldSize,I.number(H,$,re)/this.worldSize)},go.prototype.coordinatePoint=function(x){var C=[x.x*this.worldSize,x.y*this.worldSize,0,1];return I.transformMat4(C,C,this.pixelMatrix),new I.Point(C[0]/C[3],C[1]/C[3])},go.prototype.getBounds=function(){return new I.LngLatBounds().extend(this.pointLocation(new I.Point(0,0))).extend(this.pointLocation(new I.Point(this.width,0))).extend(this.pointLocation(new I.Point(this.width,this.height))).extend(this.pointLocation(new I.Point(0,this.height)))},go.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new I.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},go.prototype.setMaxBounds=function(x){x?(this.lngRange=[x.getWest(),x.getEast()],this.latRange=[x.getSouth(),x.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},go.prototype.calculatePosMatrix=function(x,C){C===void 0&&(C=!1);var w=x.key,M=C?this._alignedPosMatrixCache:this._posMatrixCache;if(M[w])return M[w];var z=x.canonical,H=this.worldSize/this.zoomScale(z.z),$=z.x+Math.pow(2,z.z)*x.wrap,ft=I.identity(new Float64Array(16));return I.translate(ft,ft,[$*H,z.y*H,0]),I.scale(ft,ft,[H/I.EXTENT,H/I.EXTENT,1]),I.multiply(ft,C?this.alignedProjMatrix:this.projMatrix,ft),M[w]=new Float32Array(ft),M[w]},go.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},go.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var x,C,w,M,z=-90,H=90,$=-180,ft=180,Ut=this.size,re=this._unmodified;if(this.latRange){var De=this.latRange;z=I.mercatorYfromLat(De[1])*this.worldSize,x=(H=I.mercatorYfromLat(De[0])*this.worldSize)-z<Ut.y?Ut.y/(H-z):0}if(this.lngRange){var Be=this.lngRange;$=I.mercatorXfromLng(Be[0])*this.worldSize,C=(ft=I.mercatorXfromLng(Be[1])*this.worldSize)-$<Ut.x?Ut.x/(ft-$):0}var Le=this.point,cr=Math.max(C||0,x||0);if(cr)return this.center=this.unproject(new I.Point(C?(ft+$)/2:Le.x,x?(H+z)/2:Le.y)),this.zoom+=this.scaleZoom(cr),this._unmodified=re,void(this._constraining=!1);if(this.latRange){var ar=Le.y,br=Ut.y/2;ar-br<z&&(M=z+br),ar+br>H&&(M=H-br)}if(this.lngRange){var rr=Le.x,xr=Ut.x/2;rr-xr<$&&(w=$+xr),rr+xr>ft&&(w=ft-xr)}w===void 0&&M===void 0||(this.center=this.unproject(new I.Point(w!==void 0?w:Le.x,M!==void 0?M:Le.y))),this._unmodified=re,this._constraining=!1}},go.prototype._calcMatrices=function(){if(this.height){var x=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var C=Math.PI/2+this._pitch,w=this._fov*(.5+x.y/this.height),M=Math.sin(w)*this.cameraToCenterDistance/Math.sin(I.clamp(Math.PI-C-w,.01,Math.PI-.01)),z=this.point,H=z.x,$=z.y,ft=1.01*(Math.cos(Math.PI/2-this._pitch)*M+this.cameraToCenterDistance),Ut=this.height/50,re=new Float64Array(16);I.perspective(re,this._fov,this.width/this.height,Ut,ft),re[8]=2*-x.x/this.width,re[9]=2*x.y/this.height,I.scale(re,re,[1,-1,1]),I.translate(re,re,[0,0,-this.cameraToCenterDistance]),I.rotateX(re,re,this._pitch),I.rotateZ(re,re,this.angle),I.translate(re,re,[-H,-$,0]),this.mercatorMatrix=I.scale([],re,[this.worldSize,this.worldSize,this.worldSize]),I.scale(re,re,[1,1,I.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=re,this.invProjMatrix=I.invert([],this.projMatrix);var De=this.width%2/2,Be=this.height%2/2,Le=Math.cos(this.angle),cr=Math.sin(this.angle),ar=H-Math.round(H)+Le*De+cr*Be,br=$-Math.round($)+Le*Be+cr*De,rr=new Float64Array(re);if(I.translate(rr,rr,[ar>.5?ar-1:ar,br>.5?br-1:br,0]),this.alignedProjMatrix=rr,re=I.create(),I.scale(re,re,[this.width/2,-this.height/2,1]),I.translate(re,re,[1,-1,0]),this.labelPlaneMatrix=re,re=I.create(),I.scale(re,re,[1,-1,1]),I.translate(re,re,[-1,-1,0]),I.scale(re,re,[2/this.width,2/this.height,1]),this.glCoordMatrix=re,this.pixelMatrix=I.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(re=I.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=re,this._posMatrixCache={},this._alignedPosMatrixCache={}}},go.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var x=this.pointCoordinate(new I.Point(0,0)),C=[x.x*this.worldSize,x.y*this.worldSize,0,1];return I.transformMat4(C,C,this.pixelMatrix)[3]/this.cameraToCenterDistance},go.prototype.getCameraPoint=function(){var x=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new I.Point(0,x))},go.prototype.getCameraQueryGeometry=function(x){var C=this.getCameraPoint();if(x.length===1)return[x[0],C];for(var w=C.x,M=C.y,z=C.x,H=C.y,$=0,ft=x;$<ft.length;$+=1){var Ut=ft[$];w=Math.min(w,Ut.x),M=Math.min(M,Ut.y),z=Math.max(z,Ut.x),H=Math.max(H,Ut.y)}return[new I.Point(w,M),new I.Point(z,M),new I.Point(z,H),new I.Point(w,H),new I.Point(w,M)]},Object.defineProperties(go.prototype,is);var Yu=function(x){var C,w,M,z;this._hashName=x&&encodeURIComponent(x),I.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(C=this._updateHashUnthrottled.bind(this),w=!1,M=null,z=function(){M=null,w&&(C(),M=setTimeout(z,300),w=!1)},function(){return w=!0,M||z(),M})};Yu.prototype.addTo=function(x){return this._map=x,I.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Yu.prototype.remove=function(){return I.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Yu.prototype.getHashString=function(x){var C=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,M=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),z=Math.pow(10,M),H=Math.round(C.lng*z)/z,$=Math.round(C.lat*z)/z,ft=this._map.getBearing(),Ut=this._map.getPitch(),re="";if(re+=x?"/"+H+"/"+$+"/"+w:w+"/"+$+"/"+H,(ft||Ut)&&(re+="/"+Math.round(10*ft)/10),Ut&&(re+="/"+Math.round(Ut)),this._hashName){var De=this._hashName,Be=!1,Le=I.window.location.hash.slice(1).split("&").map(function(cr){var ar=cr.split("=")[0];return ar===De?(Be=!0,ar+"="+re):cr}).filter(function(cr){return cr});return Be||Le.push(De+"="+re),"#"+Le.join("&")}return"#"+re},Yu.prototype._getCurrentHash=function(){var x,C=this,w=I.window.location.hash.replace("#","");return this._hashName?(w.split("&").map(function(M){return M.split("=")}).forEach(function(M){M[0]===C._hashName&&(x=M)}),(x&&x[1]||"").split("/")):w.split("/")},Yu.prototype._onHashChange=function(){var x=this._getCurrentHash();if(x.length>=3&&!x.some(function(w){return isNaN(w)})){var C=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(x[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+x[2],+x[1]],zoom:+x[0],bearing:C,pitch:+(x[4]||0)}),!0}return!1},Yu.prototype._updateHashUnthrottled=function(){var x=I.window.location.href.replace(/(#.+)?$/,this.getHashString());try{I.window.history.replaceState(I.window.history.state,null,x)}catch(C){}};var Fp={linearity:.3,easing:I.bezier(0,0,.3,1)},bf=I.extend({deceleration:2500,maxSpeed:1400},Fp),tp=I.extend({deceleration:20,maxSpeed:1400},Fp),xd=I.extend({deceleration:1e3,maxSpeed:360},Fp),ep=I.extend({deceleration:1e3,maxSpeed:90},Fp),Rp=function(x){this._map=x,this.clear()};function rp(x,C){(!x.duration||x.duration<C.duration)&&(x.duration=C.duration,x.easing=C.easing)}function Ef(x,C,w){var M=w.maxSpeed,z=w.linearity,H=w.deceleration,$=I.clamp(x*z/(C/1e3),-M,M),ft=Math.abs($)/(H*z);return{easing:w.easing,duration:1e3*ft,amount:$*(ft/2)}}Rp.prototype.clear=function(){this._inertiaBuffer=[]},Rp.prototype.record=function(x){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:I.browser.now(),settings:x})},Rp.prototype._drainInertiaBuffer=function(){for(var x=this._inertiaBuffer,C=I.browser.now();x.length>0&&C-x[0].time>160;)x.shift()},Rp.prototype._onMoveEnd=function(x){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var C={zoom:0,bearing:0,pitch:0,pan:new I.Point(0,0),pinchAround:void 0,around:void 0},w=0,M=this._inertiaBuffer;w<M.length;w+=1){var z=M[w].settings;C.zoom+=z.zoomDelta||0,C.bearing+=z.bearingDelta||0,C.pitch+=z.pitchDelta||0,z.panDelta&&C.pan._add(z.panDelta),z.around&&(C.around=z.around),z.pinchAround&&(C.pinchAround=z.pinchAround)}var H=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,$={};if(C.pan.mag()){var ft=Ef(C.pan.mag(),H,I.extend({},bf,x||{}));$.offset=C.pan.mult(ft.amount/C.pan.mag()),$.center=this._map.transform.center,rp($,ft)}if(C.zoom){var Ut=Ef(C.zoom,H,tp);$.zoom=this._map.transform.zoom+Ut.amount,rp($,Ut)}if(C.bearing){var re=Ef(C.bearing,H,xd);$.bearing=this._map.transform.bearing+I.clamp(re.amount,-179,179),rp($,re)}if(C.pitch){var De=Ef(C.pitch,H,ep);$.pitch=this._map.transform.pitch+De.amount,rp($,De)}if($.zoom||$.bearing){var Be=C.pinchAround===void 0?C.around:C.pinchAround;$.around=Be?this._map.unproject(Be):this._map.getCenter()}return this.clear(),I.extend($,{noMoveStart:!0})}};var au=function(x){function C(M,z,H,$){$===void 0&&($={});var ft=q.mousePos(z.getCanvasContainer(),H),Ut=z.unproject(ft);x.call(this,M,I.extend({point:ft,lngLat:Ut,originalEvent:H},$)),this._defaultPrevented=!1,this.target=z}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var w={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},w.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,w),C}(I.Event),wf=function(x){function C(M,z,H){var $=M==="touchend"?H.changedTouches:H.touches,ft=q.touchPos(z.getCanvasContainer(),$),Ut=ft.map(function(Be){return z.unproject(Be)}),re=ft.reduce(function(Be,Le,cr,ar){return Be.add(Le.div(ar.length))},new I.Point(0,0)),De=z.unproject(re);x.call(this,M,{points:ft,point:re,lngLats:Ut,lngLat:De,originalEvent:H}),this._defaultPrevented=!1}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var w={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},w.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,w),C}(I.Event),np=function(x){function C(M,z,H){x.call(this,M,{originalEvent:H}),this._defaultPrevented=!1}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var w={defaultPrevented:{configurable:!0}};return C.prototype.preventDefault=function(){this._defaultPrevented=!0},w.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(C.prototype,w),C}(I.Event),As=function(x,C){this._map=x,this._clickTolerance=C.clickTolerance};As.prototype.reset=function(){delete this._mousedownPos},As.prototype.wheel=function(x){return this._firePreventable(new np(x.type,this._map,x))},As.prototype.mousedown=function(x,C){return this._mousedownPos=C,this._firePreventable(new au(x.type,this._map,x))},As.prototype.mouseup=function(x){this._map.fire(new au(x.type,this._map,x))},As.prototype.click=function(x,C){this._mousedownPos&&this._mousedownPos.dist(C)>=this._clickTolerance||this._map.fire(new au(x.type,this._map,x))},As.prototype.dblclick=function(x){return this._firePreventable(new au(x.type,this._map,x))},As.prototype.mouseover=function(x){this._map.fire(new au(x.type,this._map,x))},As.prototype.mouseout=function(x){this._map.fire(new au(x.type,this._map,x))},As.prototype.touchstart=function(x){return this._firePreventable(new wf(x.type,this._map,x))},As.prototype.touchmove=function(x){this._map.fire(new wf(x.type,this._map,x))},As.prototype.touchend=function(x){this._map.fire(new wf(x.type,this._map,x))},As.prototype.touchcancel=function(x){this._map.fire(new wf(x.type,this._map,x))},As.prototype._firePreventable=function(x){if(this._map.fire(x),x.defaultPrevented)return{}},As.prototype.isEnabled=function(){return!0},As.prototype.isActive=function(){return!1},As.prototype.enable=function(){},As.prototype.disable=function(){};var Zi=function(x){this._map=x};Zi.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Zi.prototype.mousemove=function(x){this._map.fire(new au(x.type,this._map,x))},Zi.prototype.mousedown=function(){this._delayContextMenu=!0},Zi.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new au("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Zi.prototype.contextmenu=function(x){this._delayContextMenu?this._contextMenuEvent=x:this._map.fire(new au(x.type,this._map,x)),this._map.listens("contextmenu")&&x.preventDefault()},Zi.prototype.isEnabled=function(){return!0},Zi.prototype.isActive=function(){return!1},Zi.prototype.enable=function(){},Zi.prototype.disable=function(){};var as=function(x,C){this._map=x,this._el=x.getCanvasContainer(),this._container=x.getContainer(),this._clickTolerance=C.clickTolerance||1};function Sf(x,C){for(var w={},M=0;M<x.length;M++)w[x[M].identifier]=C[M];return w}as.prototype.isEnabled=function(){return!!this._enabled},as.prototype.isActive=function(){return!!this._active},as.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},as.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},as.prototype.mousedown=function(x,C){this.isEnabled()&&x.shiftKey&&x.button===0&&(q.disableDrag(),this._startPos=this._lastPos=C,this._active=!0)},as.prototype.mousemoveWindow=function(x,C){if(this._active){var w=C;if(!(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)){var M=this._startPos;this._lastPos=w,this._box||(this._box=q.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",x));var z=Math.min(M.x,w.x),H=Math.max(M.x,w.x),$=Math.min(M.y,w.y),ft=Math.max(M.y,w.y);q.setTransform(this._box,"translate("+z+"px,"+$+"px)"),this._box.style.width=H-z+"px",this._box.style.height=ft-$+"px"}}},as.prototype.mouseupWindow=function(x,C){var w=this;if(this._active&&x.button===0){var M=this._startPos,z=C;if(this.reset(),q.suppressClick(),M.x!==z.x||M.y!==z.y)return this._map.fire(new I.Event("boxzoomend",{originalEvent:x})),{cameraAnimation:function(H){return H.fitScreenCoordinates(M,z,w._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",x)}},as.prototype.keydown=function(x){this._active&&x.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",x))},as.prototype.blur=function(){this.reset()},as.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(q.remove(this._box),this._box=null),q.enableDrag(),delete this._startPos,delete this._lastPos},as.prototype._fireEvent=function(x,C){return this._map.fire(new I.Event(x,{originalEvent:C}))};var Gf=function(x){this.reset(),this.numTouches=x.numTouches};Gf.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Gf.prototype.touchstart=function(x,C,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=x.timeStamp),w.length===this.numTouches&&(this.centroid=function(M){for(var z=new I.Point(0,0),H=0,$=M;H<$.length;H+=1)z._add($[H]);return z.div(M.length)}(C),this.touches=Sf(w,C)))},Gf.prototype.touchmove=function(x,C,w){if(!this.aborted&&this.centroid){var M=Sf(w,C);for(var z in this.touches){var H=M[z];(!H||H.dist(this.touches[z])>30)&&(this.aborted=!0)}}},Gf.prototype.touchend=function(x,C,w){if((!this.centroid||x.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){var M=!this.aborted&&this.centroid;if(this.reset(),M)return M}};var cc=function(x){this.singleTap=new Gf(x),this.numTaps=x.numTaps,this.reset()};cc.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},cc.prototype.touchstart=function(x,C,w){this.singleTap.touchstart(x,C,w)},cc.prototype.touchmove=function(x,C,w){this.singleTap.touchmove(x,C,w)},cc.prototype.touchend=function(x,C,w){var M=this.singleTap.touchend(x,C,w);if(M){var z=x.timeStamp-this.lastTime<500,H=!this.lastTap||this.lastTap.dist(M)<30;if(z&&H||this.reset(),this.count++,this.lastTime=x.timeStamp,this.lastTap=M,this.count===this.numTaps)return this.reset(),M}};var ml=function(){this._zoomIn=new cc({numTouches:1,numTaps:2}),this._zoomOut=new cc({numTouches:2,numTaps:1}),this.reset()};ml.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},ml.prototype.touchstart=function(x,C,w){this._zoomIn.touchstart(x,C,w),this._zoomOut.touchstart(x,C,w)},ml.prototype.touchmove=function(x,C,w){this._zoomIn.touchmove(x,C,w),this._zoomOut.touchmove(x,C,w)},ml.prototype.touchend=function(x,C,w){var M=this,z=this._zoomIn.touchend(x,C,w),H=this._zoomOut.touchend(x,C,w);return z?(this._active=!0,x.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function($){return $.easeTo({duration:300,zoom:$.getZoom()+1,around:$.unproject(z)},{originalEvent:x})}}):H?(this._active=!0,x.preventDefault(),setTimeout(function(){return M.reset()},0),{cameraAnimation:function($){return $.easeTo({duration:300,zoom:$.getZoom()-1,around:$.unproject(H)},{originalEvent:x})}}):void 0},ml.prototype.touchcancel=function(){this.reset()},ml.prototype.enable=function(){this._enabled=!0},ml.prototype.disable=function(){this._enabled=!1,this.reset()},ml.prototype.isEnabled=function(){return this._enabled},ml.prototype.isActive=function(){return this._active};var Dp={0:1,2:2},Ai=function(x){this.reset(),this._clickTolerance=x.clickTolerance||1};Ai.prototype.blur=function(){this.reset()},Ai.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ai.prototype._correctButton=function(x,C){return!1},Ai.prototype._move=function(x,C){return{}},Ai.prototype.mousedown=function(x,C){if(!this._lastPoint){var w=q.mouseButton(x);this._correctButton(x,w)&&(this._lastPoint=C,this._eventButton=w)}},Ai.prototype.mousemoveWindow=function(x,C){var w=this._lastPoint;if(w){if(x.preventDefault(),function(M,z){var H=Dp[z];return M.buttons===void 0||(M.buttons&H)!==H}(x,this._eventButton))this.reset();else if(this._moved||!(C.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=C,this._move(w,C)}},Ai.prototype.mouseupWindow=function(x){this._lastPoint&&q.mouseButton(x)===this._eventButton&&(this._moved&&q.suppressClick(),this.reset())},Ai.prototype.enable=function(){this._enabled=!0},Ai.prototype.disable=function(){this._enabled=!1,this.reset()},Ai.prototype.isEnabled=function(){return this._enabled},Ai.prototype.isActive=function(){return this._active};var Hf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.mousedown=function(w,M){x.prototype.mousedown.call(this,w,M),this._lastPoint&&(this._active=!0)},C.prototype._correctButton=function(w,M){return M===0&&!w.ctrlKey},C.prototype._move=function(w,M){return{around:M,panDelta:M.sub(w)}},C}(Ai),Cc=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype._correctButton=function(w,M){return M===0&&w.ctrlKey||M===2},C.prototype._move=function(w,M){var z=.8*(M.x-w.x);if(z)return this._active=!0,{bearingDelta:z}},C.prototype.contextmenu=function(w){w.preventDefault()},C}(Ai),Cf=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype._correctButton=function(w,M){return M===0&&w.ctrlKey||M===2},C.prototype._move=function(w,M){var z=-.5*(M.y-w.y);if(z)return this._active=!0,{pitchDelta:z}},C.prototype.contextmenu=function(w){w.preventDefault()},C}(Ai),ma=function(x){this._minTouches=1,this._clickTolerance=x.clickTolerance||1,this.reset()};ma.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new I.Point(0,0)},ma.prototype.touchstart=function(x,C,w){return this._calculateTransform(x,C,w)},ma.prototype.touchmove=function(x,C,w){if(this._active&&!(w.length<this._minTouches))return x.preventDefault(),this._calculateTransform(x,C,w)},ma.prototype.touchend=function(x,C,w){this._calculateTransform(x,C,w),this._active&&w.length<this._minTouches&&this.reset()},ma.prototype.touchcancel=function(){this.reset()},ma.prototype._calculateTransform=function(x,C,w){w.length>0&&(this._active=!0);var M=Sf(w,C),z=new I.Point(0,0),H=new I.Point(0,0),$=0;for(var ft in M){var Ut=M[ft],re=this._touches[ft];re&&(z._add(Ut),H._add(Ut.sub(re)),$++,M[ft]=Ut)}if(this._touches=M,!($<this._minTouches)&&H.mag()){var De=H.div($);if(this._sum._add(De),!(this._sum.mag()<this._clickTolerance))return{around:z.div($),panDelta:De}}},ma.prototype.enable=function(){this._enabled=!0},ma.prototype.disable=function(){this._enabled=!1,this.reset()},ma.prototype.isEnabled=function(){return this._enabled},ma.prototype.isActive=function(){return this._active};var yl=function(){this.reset()};function jf(x,C,w){for(var M=0;M<x.length;M++)if(x[M].identifier===w)return C[M]}function fc(x,C){return Math.log(x/C)/Math.LN2}yl.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},yl.prototype._start=function(x){},yl.prototype._move=function(x,C,w){return{}},yl.prototype.touchstart=function(x,C,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([C[0],C[1]]))},yl.prototype.touchmove=function(x,C,w){if(this._firstTwoTouches){x.preventDefault();var M=this._firstTwoTouches,z=M[1],H=jf(w,C,M[0]),$=jf(w,C,z);if(H&&$){var ft=this._aroundCenter?null:H.add($).div(2);return this._move([H,$],ft,x)}}},yl.prototype.touchend=function(x,C,w){if(this._firstTwoTouches){var M=this._firstTwoTouches,z=M[1],H=jf(w,C,M[0]),$=jf(w,C,z);H&&$||(this._active&&q.suppressClick(),this.reset())}},yl.prototype.touchcancel=function(){this.reset()},yl.prototype.enable=function(x){this._enabled=!0,this._aroundCenter=!!x&&x.around==="center"},yl.prototype.disable=function(){this._enabled=!1,this.reset()},yl.prototype.isEnabled=function(){return this._enabled},yl.prototype.isActive=function(){return this._active};var _l=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),delete this._distance,delete this._startDistance},C.prototype._start=function(w){this._startDistance=this._distance=w[0].dist(w[1])},C.prototype._move=function(w,M){var z=this._distance;if(this._distance=w[0].dist(w[1]),this._active||!(Math.abs(fc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:fc(this._distance,z),pinchAround:M}},C}(yl);function sa(x,C){return 180*x.angleWith(C)/Math.PI}var Bp=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},C.prototype._start=function(w){this._startVector=this._vector=w[0].sub(w[1]),this._minDiameter=w[0].dist(w[1])},C.prototype._move=function(w,M){var z=this._vector;if(this._vector=w[0].sub(w[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:sa(this._vector,z),pinchAround:M}},C.prototype._isBelowThreshold=function(w){this._minDiameter=Math.min(this._minDiameter,w.mag());var M=25/(Math.PI*this._minDiameter)*360,z=sa(w,this._startVector);return Math.abs(z)<M},C}(yl);function Np(x){return Math.abs(x.y)>Math.abs(x.x)}var bd=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.reset=function(){x.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},C.prototype._start=function(w){this._lastPoints=w,Np(w[0].sub(w[1]))&&(this._valid=!1)},C.prototype._move=function(w,M,z){var H=w[0].sub(this._lastPoints[0]),$=w[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(H,$,z.timeStamp),this._valid)return this._lastPoints=w,this._active=!0,{pitchDelta:(H.y+$.y)/2*-.5}},C.prototype.gestureBeginsVertically=function(w,M,z){if(this._valid!==void 0)return this._valid;var H=w.mag()>=2,$=M.mag()>=2;if(H||$){if(!H||!$)return this._firstMove===void 0&&(this._firstMove=z),z-this._firstMove<100&&void 0;var ft=w.y>0==M.y>0;return Np(w)&&Np(M)&&ft}},C}(yl),Ed={panStep:100,bearingStep:15,pitchStep:10},Ml=function(){var x=Ed;this._panStep=x.panStep,this._bearingStep=x.bearingStep,this._pitchStep=x.pitchStep,this._rotationDisabled=!1};function Ko(x){return x*(2-x)}Ml.prototype.blur=function(){this.reset()},Ml.prototype.reset=function(){this._active=!1},Ml.prototype.keydown=function(x){var C=this;if(!(x.altKey||x.ctrlKey||x.metaKey)){var w=0,M=0,z=0,H=0,$=0;switch(x.keyCode){case 61:case 107:case 171:case 187:w=1;break;case 189:case 109:case 173:w=-1;break;case 37:x.shiftKey?M=-1:(x.preventDefault(),H=-1);break;case 39:x.shiftKey?M=1:(x.preventDefault(),H=1);break;case 38:x.shiftKey?z=1:(x.preventDefault(),$=-1);break;case 40:x.shiftKey?z=-1:(x.preventDefault(),$=1);break;default:return}return this._rotationDisabled&&(M=0,z=0),{cameraAnimation:function(ft){var Ut=ft.getZoom();ft.easeTo({duration:300,easeId:"keyboardHandler",easing:Ko,zoom:w?Math.round(Ut)+w*(x.shiftKey?2:1):Ut,bearing:ft.getBearing()+M*C._bearingStep,pitch:ft.getPitch()+z*C._pitchStep,offset:[-H*C._panStep,-$*C._panStep],center:ft.getCenter()},{originalEvent:x})}}}},Ml.prototype.enable=function(){this._enabled=!0},Ml.prototype.disable=function(){this._enabled=!1,this.reset()},Ml.prototype.isEnabled=function(){return this._enabled},Ml.prototype.isActive=function(){return this._active},Ml.prototype.disableRotation=function(){this._rotationDisabled=!0},Ml.prototype.enableRotation=function(){this._rotationDisabled=!1};var Ka=function(x,C){this._map=x,this._el=x.getCanvasContainer(),this._handler=C,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,I.bindAll(["_onTimeout"],this)};Ka.prototype.setZoomRate=function(x){this._defaultZoomRate=x},Ka.prototype.setWheelZoomRate=function(x){this._wheelZoomRate=x},Ka.prototype.isEnabled=function(){return!!this._enabled},Ka.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ka.prototype.isZooming=function(){return!!this._zooming},Ka.prototype.enable=function(x){this.isEnabled()||(this._enabled=!0,this._aroundCenter=x&&x.around==="center")},Ka.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ka.prototype.wheel=function(x){if(this.isEnabled()){var C=x.deltaMode===I.window.WheelEvent.DOM_DELTA_LINE?40*x.deltaY:x.deltaY,w=I.browser.now(),M=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,C!==0&&C%4.000244140625==0?this._type="wheel":C!==0&&Math.abs(C)<4?this._type="trackpad":M>400?(this._type=null,this._lastValue=C,this._timeout=setTimeout(this._onTimeout,40,x)):this._type||(this._type=Math.abs(M*C)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,C+=this._lastValue)),x.shiftKey&&C&&(C/=4),this._type&&(this._lastWheelEvent=x,this._delta-=C,this._active||this._start(x)),x.preventDefault()}},Ka.prototype._onTimeout=function(x){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(x)},Ka.prototype._start=function(x){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var C=q.mousePos(this._el,x);this._around=I.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(C)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ka.prototype.renderFrame=function(){var x=this;if(this._frameId&&(this._frameId=null,this.isActive())){var C=this._map.transform;if(this._delta!==0){var w=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,M=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&M!==0&&(M=1/M);var z=typeof this._targetZoom=="number"?C.zoomScale(this._targetZoom):C.scale;this._targetZoom=Math.min(C.maxZoom,Math.max(C.minZoom,C.scaleZoom(z*M))),this._type==="wheel"&&(this._startZoom=C.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var H,$=typeof this._targetZoom=="number"?this._targetZoom:C.zoom,ft=this._startZoom,Ut=this._easing,re=!1;if(this._type==="wheel"&&ft&&Ut){var De=Math.min((I.browser.now()-this._lastWheelEventTime)/200,1),Be=Ut(De);H=I.number(ft,$,Be),De<1?this._frameId||(this._frameId=!0):re=!0}else H=$,re=!0;return this._active=!0,re&&(this._active=!1,this._finishTimeout=setTimeout(function(){x._zooming=!1,x._handler._triggerRenderFrame(),delete x._targetZoom,delete x._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!re,zoomDelta:H-C.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ka.prototype._smoothOutEasing=function(x){var C=I.ease;if(this._prevEase){var w=this._prevEase,M=(I.browser.now()-w.start)/w.duration,z=w.easing(M+.01)-w.easing(M),H=.27/Math.sqrt(z*z+1e-4)*.01,$=Math.sqrt(.0729-H*H);C=I.bezier(H,$,.25,1)}return this._prevEase={start:I.browser.now(),duration:x,easing:C},C},Ka.prototype.blur=function(){this.reset()},Ka.prototype.reset=function(){this._active=!1};var xl=function(x,C){this._clickZoom=x,this._tapZoom=C};xl.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},xl.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},xl.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},xl.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ql=function(){this.reset()};ql.prototype.reset=function(){this._active=!1},ql.prototype.blur=function(){this.reset()},ql.prototype.dblclick=function(x,C){return x.preventDefault(),{cameraAnimation:function(w){w.easeTo({duration:300,zoom:w.getZoom()+(x.shiftKey?-1:1),around:w.unproject(C)},{originalEvent:x})}}},ql.prototype.enable=function(){this._enabled=!0},ql.prototype.disable=function(){this._enabled=!1,this.reset()},ql.prototype.isEnabled=function(){return this._enabled},ql.prototype.isActive=function(){return this._active};var Ts=function(){this._tap=new cc({numTouches:1,numTaps:1}),this.reset()};Ts.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ts.prototype.touchstart=function(x,C,w){this._swipePoint||(this._tapTime&&x.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=C[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(x,C,w))},Ts.prototype.touchmove=function(x,C,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;var M=C[0],z=M.y-this._swipePoint.y;return this._swipePoint=M,x.preventDefault(),this._active=!0,{zoomDelta:z/128}}}else this._tap.touchmove(x,C,w)},Ts.prototype.touchend=function(x,C,w){this._tapTime?this._swipePoint&&w.length===0&&this.reset():this._tap.touchend(x,C,w)&&(this._tapTime=x.timeStamp)},Ts.prototype.touchcancel=function(){this.reset()},Ts.prototype.enable=function(){this._enabled=!0},Ts.prototype.disable=function(){this._enabled=!1,this.reset()},Ts.prototype.isEnabled=function(){return this._enabled},Ts.prototype.isActive=function(){return this._active};var jc=function(x,C,w){this._el=x,this._mousePan=C,this._touchPan=w};jc.prototype.enable=function(x){this._inertiaOptions=x||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},jc.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},jc.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},jc.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Nl=function(x,C,w){this._pitchWithRotate=x.pitchWithRotate,this._mouseRotate=C,this._mousePitch=w};Nl.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Nl.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Nl.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Nl.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var wu=function(x,C,w,M){this._el=x,this._touchZoom=C,this._touchRotate=w,this._tapDragZoom=M,this._rotationDisabled=!1,this._enabled=!0};wu.prototype.enable=function(x){this._touchZoom.enable(x),this._rotationDisabled||this._touchRotate.enable(x),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},wu.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},wu.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},wu.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},wu.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},wu.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Su=function(x){return x.zoom||x.drag||x.pitch||x.rotate},Il=function(x){function C(){x.apply(this,arguments)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C}(I.Event);function Ki(x){return x.panDelta&&x.panDelta.mag()||x.zoomDelta||x.bearingDelta||x.pitchDelta}var Wi=function(x,C){this._map=x,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Rp(x),this._bearingSnap=C.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(C),I.bindAll(["handleEvent","handleWindowEvent"],this);var w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[I.window.document,"mousemove",{capture:!0}],[I.window.document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[I.window,"blur",void 0]];for(var M=0,z=this._listeners;M<z.length;M+=1){var H=z[M],$=H[0];q.addEventListener($,H[1],$===I.window.document?this.handleWindowEvent:this.handleEvent,H[2])}};Wi.prototype.destroy=function(){for(var x=0,C=this._listeners;x<C.length;x+=1){var w=C[x],M=w[0];q.removeEventListener(M,w[1],M===I.window.document?this.handleWindowEvent:this.handleEvent,w[2])}},Wi.prototype._addDefaultHandlers=function(x){var C=this._map,w=C.getCanvasContainer();this._add("mapEvent",new As(C,x));var M=C.boxZoom=new as(C,x);this._add("boxZoom",M);var z=new ml,H=new ql;C.doubleClickZoom=new xl(H,z),this._add("tapZoom",z),this._add("clickZoom",H);var $=new Ts;this._add("tapDragZoom",$);var ft=C.touchPitch=new bd;this._add("touchPitch",ft);var Ut=new Cc(x),re=new Cf(x);C.dragRotate=new Nl(x,Ut,re),this._add("mouseRotate",Ut,["mousePitch"]),this._add("mousePitch",re,["mouseRotate"]);var De=new Hf(x),Be=new ma(x);C.dragPan=new jc(w,De,Be),this._add("mousePan",De),this._add("touchPan",Be,["touchZoom","touchRotate"]);var Le=new Bp,cr=new _l;C.touchZoomRotate=new wu(w,cr,Le,$),this._add("touchRotate",Le,["touchPan","touchZoom"]),this._add("touchZoom",cr,["touchPan","touchRotate"]);var ar=C.scrollZoom=new Ka(C,this);this._add("scrollZoom",ar,["mousePan"]);var br=C.keyboard=new Ml;this._add("keyboard",br),this._add("blockableMapEvent",new Zi(C));for(var rr=0,xr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];rr<xr.length;rr+=1){var Pr=xr[rr];x.interactive&&x[Pr]&&C[Pr].enable(x[Pr])}},Wi.prototype._add=function(x,C,w){this._handlers.push({handlerName:x,handler:C,allowed:w}),this._handlersById[x]=C},Wi.prototype.stop=function(x){if(!this._updatingCamera){for(var C=0,w=this._handlers;C<w.length;C+=1)w[C].handler.reset();this._inertia.clear(),this._fireEvents({},{},x),this._changes=[]}},Wi.prototype.isActive=function(){for(var x=0,C=this._handlers;x<C.length;x+=1)if(C[x].handler.isActive())return!0;return!1},Wi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Wi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Wi.prototype.isMoving=function(){return Boolean(Su(this._eventsInProgress))||this.isZooming()},Wi.prototype._blockedByActive=function(x,C,w){for(var M in x)if(M!==w&&(!C||C.indexOf(M)<0))return!0;return!1},Wi.prototype.handleWindowEvent=function(x){this.handleEvent(x,x.type+"Window")},Wi.prototype._getMapTouches=function(x){for(var C=[],w=0,M=x;w<M.length;w+=1){var z=M[w];this._el.contains(z.target)&&C.push(z)}return C},Wi.prototype.handleEvent=function(x,C){this._updatingCamera=!0;for(var w=x.type==="renderFrame"?void 0:x,M={needsRenderFrame:!1},z={},H={},$=x.touches?this._getMapTouches(x.touches):void 0,ft=$?q.touchPos(this._el,$):q.mousePos(this._el,x),Ut=0,re=this._handlers;Ut<re.length;Ut+=1){var De=re[Ut],Be=De.handlerName,Le=De.handler,cr=De.allowed;if(Le.isEnabled()){var ar=void 0;this._blockedByActive(H,cr,Be)?Le.reset():Le[C||x.type]&&(ar=Le[C||x.type](x,ft,$),this.mergeHandlerResult(M,z,ar,Be,w),ar&&ar.needsRenderFrame&&this._triggerRenderFrame()),(ar||Le.isActive())&&(H[Be]=Le)}}var br={};for(var rr in this._previousActiveHandlers)H[rr]||(br[rr]=w);this._previousActiveHandlers=H,(Object.keys(br).length||Ki(M))&&(this._changes.push([M,z,br]),this._triggerRenderFrame()),(Object.keys(H).length||Ki(M))&&this._map._stop(!0),this._updatingCamera=!1;var xr=M.cameraAnimation;xr&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],xr(this._map))},Wi.prototype.mergeHandlerResult=function(x,C,w,M,z){if(w){I.extend(x,w);var H={handlerName:M,originalEvent:w.originalEvent||z};w.zoomDelta!==void 0&&(C.zoom=H),w.panDelta!==void 0&&(C.drag=H),w.pitchDelta!==void 0&&(C.pitch=H),w.bearingDelta!==void 0&&(C.rotate=H)}},Wi.prototype._applyChanges=function(){for(var x={},C={},w={},M=0,z=this._changes;M<z.length;M+=1){var H=z[M],$=H[0],ft=H[1],Ut=H[2];$.panDelta&&(x.panDelta=(x.panDelta||new I.Point(0,0))._add($.panDelta)),$.zoomDelta&&(x.zoomDelta=(x.zoomDelta||0)+$.zoomDelta),$.bearingDelta&&(x.bearingDelta=(x.bearingDelta||0)+$.bearingDelta),$.pitchDelta&&(x.pitchDelta=(x.pitchDelta||0)+$.pitchDelta),$.around!==void 0&&(x.around=$.around),$.pinchAround!==void 0&&(x.pinchAround=$.pinchAround),$.noInertia&&(x.noInertia=$.noInertia),I.extend(C,ft),I.extend(w,Ut)}this._updateMapTransform(x,C,w),this._changes=[]},Wi.prototype._updateMapTransform=function(x,C,w){var M=this._map,z=M.transform;if(!Ki(x))return this._fireEvents(C,w,!0);var H=x.panDelta,$=x.zoomDelta,ft=x.bearingDelta,Ut=x.pitchDelta,re=x.around,De=x.pinchAround;De!==void 0&&(re=De),M._stop(!0),re=re||M.transform.centerPoint;var Be=z.pointLocation(H?re.sub(H):re);ft&&(z.bearing+=ft),Ut&&(z.pitch+=Ut),$&&(z.zoom+=$),z.setLocationAtPoint(Be,re),this._map._update(),x.noInertia||this._inertia.record(x),this._fireEvents(C,w,!0)},Wi.prototype._fireEvents=function(x,C,w){var M=this,z=Su(this._eventsInProgress),H=Su(x),$={};for(var ft in x)this._eventsInProgress[ft]||($[ft+"start"]=x[ft].originalEvent),this._eventsInProgress[ft]=x[ft];for(var Ut in!z&&H&&this._fireEvent("movestart",H.originalEvent),$)this._fireEvent(Ut,$[Ut]);for(var re in H&&this._fireEvent("move",H.originalEvent),x)this._fireEvent(re,x[re].originalEvent);var De,Be={};for(var Le in this._eventsInProgress){var cr=this._eventsInProgress[Le],ar=cr.handlerName,br=cr.originalEvent;this._handlersById[ar].isActive()||(delete this._eventsInProgress[Le],Be[Le+"end"]=De=C[ar]||br)}for(var rr in Be)this._fireEvent(rr,Be[rr]);var xr=Su(this._eventsInProgress);if(w&&(z||H)&&!xr){this._updatingCamera=!0;var Pr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Rr=function(gn){return gn!==0&&-M._bearingSnap<gn&&gn<M._bearingSnap};Pr?(Rr(Pr.bearing||this._map.getBearing())&&(Pr.bearing=0),this._map.easeTo(Pr,{originalEvent:De})):(this._map.fire(new I.Event("moveend",{originalEvent:De})),Rr(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Wi.prototype._fireEvent=function(x,C){this._map.fire(new I.Event(x,C?{originalEvent:C}:{}))},Wi.prototype._requestFrame=function(){var x=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(C){delete x._frameId,x.handleEvent(new Il("renderFrame",{timeStamp:C})),x._applyChanges()})},Wi.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Af=function(x){function C(w,M){x.call(this),this._moving=!1,this._zooming=!1,this.transform=w,this._bearingSnap=M.bearingSnap,I.bindAll(["_renderFrameCallback"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.getCenter=function(){return new I.LngLat(this.transform.center.lng,this.transform.center.lat)},C.prototype.setCenter=function(w,M){return this.jumpTo({center:w},M)},C.prototype.panBy=function(w,M,z){return w=I.Point.convert(w).mult(-1),this.panTo(this.transform.center,I.extend({offset:w},M),z)},C.prototype.panTo=function(w,M,z){return this.easeTo(I.extend({center:w},M),z)},C.prototype.getZoom=function(){return this.transform.zoom},C.prototype.setZoom=function(w,M){return this.jumpTo({zoom:w},M),this},C.prototype.zoomTo=function(w,M,z){return this.easeTo(I.extend({zoom:w},M),z)},C.prototype.zoomIn=function(w,M){return this.zoomTo(this.getZoom()+1,w,M),this},C.prototype.zoomOut=function(w,M){return this.zoomTo(this.getZoom()-1,w,M),this},C.prototype.getBearing=function(){return this.transform.bearing},C.prototype.setBearing=function(w,M){return this.jumpTo({bearing:w},M),this},C.prototype.getPadding=function(){return this.transform.padding},C.prototype.setPadding=function(w,M){return this.jumpTo({padding:w},M),this},C.prototype.rotateTo=function(w,M,z){return this.easeTo(I.extend({bearing:w},M),z)},C.prototype.resetNorth=function(w,M){return this.rotateTo(0,I.extend({duration:1e3},w),M),this},C.prototype.resetNorthPitch=function(w,M){return this.easeTo(I.extend({bearing:0,pitch:0,duration:1e3},w),M),this},C.prototype.snapToNorth=function(w,M){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(w,M):this},C.prototype.getPitch=function(){return this.transform.pitch},C.prototype.setPitch=function(w,M){return this.jumpTo({pitch:w},M),this},C.prototype.cameraForBounds=function(w,M){w=I.LngLatBounds.convert(w);var z=M&&M.bearing||0;return this._cameraForBoxAndBearing(w.getNorthWest(),w.getSouthEast(),z,M)},C.prototype._cameraForBoxAndBearing=function(w,M,z,H){var $={top:0,bottom:0,right:0,left:0};if(typeof(H=I.extend({padding:$,offset:[0,0],maxZoom:this.transform.maxZoom},H)).padding=="number"){var ft=H.padding;H.padding={top:ft,bottom:ft,right:ft,left:ft}}H.padding=I.extend($,H.padding);var Ut=this.transform,re=Ut.padding,De=Ut.project(I.LngLat.convert(w)),Be=Ut.project(I.LngLat.convert(M)),Le=De.rotate(-z*Math.PI/180),cr=Be.rotate(-z*Math.PI/180),ar=new I.Point(Math.max(Le.x,cr.x),Math.max(Le.y,cr.y)),br=new I.Point(Math.min(Le.x,cr.x),Math.min(Le.y,cr.y)),rr=ar.sub(br),xr=(Ut.width-(re.left+re.right+H.padding.left+H.padding.right))/rr.x,Pr=(Ut.height-(re.top+re.bottom+H.padding.top+H.padding.bottom))/rr.y;if(!(Pr<0||xr<0)){var Rr=Math.min(Ut.scaleZoom(Ut.scale*Math.min(xr,Pr)),H.maxZoom),gn=typeof H.offset.x=="number"?new I.Point(H.offset.x,H.offset.y):I.Point.convert(H.offset),ln=new I.Point((H.padding.left-H.padding.right)/2,(H.padding.top-H.padding.bottom)/2).rotate(z*Math.PI/180),bn=gn.add(ln).mult(Ut.scale/Ut.zoomScale(Rr));return{center:Ut.unproject(De.add(Be).div(2).sub(bn)),zoom:Rr,bearing:z}}I.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},C.prototype.fitBounds=function(w,M,z){return this._fitInternal(this.cameraForBounds(w,M),M,z)},C.prototype.fitScreenCoordinates=function(w,M,z,H,$){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(I.Point.convert(w)),this.transform.pointLocation(I.Point.convert(M)),z,H),H,$)},C.prototype._fitInternal=function(w,M,z){return w?(delete(M=I.extend(w,M)).padding,M.linear?this.easeTo(M,z):this.flyTo(M,z)):this},C.prototype.jumpTo=function(w,M){this.stop();var z=this.transform,H=!1,$=!1,ft=!1;return"zoom"in w&&z.zoom!==+w.zoom&&(H=!0,z.zoom=+w.zoom),w.center!==void 0&&(z.center=I.LngLat.convert(w.center)),"bearing"in w&&z.bearing!==+w.bearing&&($=!0,z.bearing=+w.bearing),"pitch"in w&&z.pitch!==+w.pitch&&(ft=!0,z.pitch=+w.pitch),w.padding==null||z.isPaddingEqual(w.padding)||(z.padding=w.padding),this.fire(new I.Event("movestart",M)).fire(new I.Event("move",M)),H&&this.fire(new I.Event("zoomstart",M)).fire(new I.Event("zoom",M)).fire(new I.Event("zoomend",M)),$&&this.fire(new I.Event("rotatestart",M)).fire(new I.Event("rotate",M)).fire(new I.Event("rotateend",M)),ft&&this.fire(new I.Event("pitchstart",M)).fire(new I.Event("pitch",M)).fire(new I.Event("pitchend",M)),this.fire(new I.Event("moveend",M))},C.prototype.easeTo=function(w,M){var z=this;this._stop(!1,w.easeId),((w=I.extend({offset:[0,0],duration:500,easing:I.ease},w)).animate===!1||!w.essential&&I.browser.prefersReducedMotion)&&(w.duration=0);var H=this.transform,$=this.getZoom(),ft=this.getBearing(),Ut=this.getPitch(),re=this.getPadding(),De="zoom"in w?+w.zoom:$,Be="bearing"in w?this._normalizeBearing(w.bearing,ft):ft,Le="pitch"in w?+w.pitch:Ut,cr="padding"in w?w.padding:H.padding,ar=I.Point.convert(w.offset),br=H.centerPoint.add(ar),rr=H.pointLocation(br),xr=I.LngLat.convert(w.center||rr);this._normalizeCenter(xr);var Pr,Rr,gn=H.project(rr),ln=H.project(xr).sub(gn),bn=H.zoomScale(De-$);w.around&&(Pr=I.LngLat.convert(w.around),Rr=H.locationPoint(Pr));var Zn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||De!==$,this._rotating=this._rotating||ft!==Be,this._pitching=this._pitching||Le!==Ut,this._padding=!H.isPaddingEqual(cr),this._easeId=w.easeId,this._prepareEase(M,w.noMoveStart,Zn),this._ease(function(Kn){if(z._zooming&&(H.zoom=I.number($,De,Kn)),z._rotating&&(H.bearing=I.number(ft,Be,Kn)),z._pitching&&(H.pitch=I.number(Ut,Le,Kn)),z._padding&&(H.interpolatePadding(re,cr,Kn),br=H.centerPoint.add(ar)),Pr)H.setLocationAtPoint(Pr,Rr);else{var ci=H.zoomScale(H.zoom-$),Oi=De>$?Math.min(2,bn):Math.max(.5,bn),na=Math.pow(Oi,1-Kn),ia=H.unproject(gn.add(ln.mult(Kn*na)).mult(ci));H.setLocationAtPoint(H.renderWorldCopies?ia.wrap():ia,br)}z._fireMoveEvents(M)},function(Kn){z._afterEase(M,Kn)},w),this},C.prototype._prepareEase=function(w,M,z){z===void 0&&(z={}),this._moving=!0,M||z.moving||this.fire(new I.Event("movestart",w)),this._zooming&&!z.zooming&&this.fire(new I.Event("zoomstart",w)),this._rotating&&!z.rotating&&this.fire(new I.Event("rotatestart",w)),this._pitching&&!z.pitching&&this.fire(new I.Event("pitchstart",w))},C.prototype._fireMoveEvents=function(w){this.fire(new I.Event("move",w)),this._zooming&&this.fire(new I.Event("zoom",w)),this._rotating&&this.fire(new I.Event("rotate",w)),this._pitching&&this.fire(new I.Event("pitch",w))},C.prototype._afterEase=function(w,M){if(!this._easeId||!M||this._easeId!==M){delete this._easeId;var z=this._zooming,H=this._rotating,$=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,z&&this.fire(new I.Event("zoomend",w)),H&&this.fire(new I.Event("rotateend",w)),$&&this.fire(new I.Event("pitchend",w)),this.fire(new I.Event("moveend",w))}},C.prototype.flyTo=function(w,M){var z=this;if(!w.essential&&I.browser.prefersReducedMotion){var H=I.pick(w,["center","zoom","bearing","pitch","around"]);return this.jumpTo(H,M)}this.stop(),w=I.extend({offset:[0,0],speed:1.2,curve:1.42,easing:I.ease},w);var $=this.transform,ft=this.getZoom(),Ut=this.getBearing(),re=this.getPitch(),De=this.getPadding(),Be="zoom"in w?I.clamp(+w.zoom,$.minZoom,$.maxZoom):ft,Le="bearing"in w?this._normalizeBearing(w.bearing,Ut):Ut,cr="pitch"in w?+w.pitch:re,ar="padding"in w?w.padding:$.padding,br=$.zoomScale(Be-ft),rr=I.Point.convert(w.offset),xr=$.centerPoint.add(rr),Pr=$.pointLocation(xr),Rr=I.LngLat.convert(w.center||Pr);this._normalizeCenter(Rr);var gn=$.project(Pr),ln=$.project(Rr).sub(gn),bn=w.curve,Zn=Math.max($.width,$.height),Kn=Zn/br,ci=ln.mag();if("minZoom"in w){var Oi=I.clamp(Math.min(w.minZoom,ft,Be),$.minZoom,$.maxZoom),na=Zn/$.zoomScale(Oi-ft);bn=Math.sqrt(na/ci*2)}var ia=bn*bn;function ua(pa){var da=(Kn*Kn-Zn*Zn+(pa?-1:1)*ia*ia*ci*ci)/(2*(pa?Kn:Zn)*ia*ci);return Math.log(Math.sqrt(da*da+1)-da)}function Qa(pa){return(Math.exp(pa)-Math.exp(-pa))/2}function Fi(pa){return(Math.exp(pa)+Math.exp(-pa))/2}var Ra=ua(0),Aa=function(pa){return Fi(Ra)/Fi(Ra+bn*pa)},ka=function(pa){return Zn*((Fi(Ra)*(Qa(da=Ra+bn*pa)/Fi(da))-Qa(Ra))/ia)/ci;var da},la=(ua(1)-Ra)/bn;if(Math.abs(ci)<1e-6||!isFinite(la)){if(Math.abs(Zn-Kn)<1e-6)return this.easeTo(w,M);var Na=Kn<Zn?-1:1;la=Math.abs(Math.log(Kn/Zn))/bn,ka=function(){return 0},Aa=function(pa){return Math.exp(Na*bn*pa)}}return w.duration="duration"in w?+w.duration:1e3*la/("screenSpeed"in w?+w.screenSpeed/bn:+w.speed),w.maxDuration&&w.duration>w.maxDuration&&(w.duration=0),this._zooming=!0,this._rotating=Ut!==Le,this._pitching=cr!==re,this._padding=!$.isPaddingEqual(ar),this._prepareEase(M,!1),this._ease(function(pa){var da=pa*la,Ds=1/Aa(da);$.zoom=pa===1?Be:ft+$.scaleZoom(Ds),z._rotating&&($.bearing=I.number(Ut,Le,pa)),z._pitching&&($.pitch=I.number(re,cr,pa)),z._padding&&($.interpolatePadding(De,ar,pa),xr=$.centerPoint.add(rr));var ss=pa===1?Rr:$.unproject(gn.add(ln.mult(ka(da))).mult(Ds));$.setLocationAtPoint($.renderWorldCopies?ss.wrap():ss,xr),z._fireMoveEvents(M)},function(){return z._afterEase(M)},w),this},C.prototype.isEasing=function(){return!!this._easeFrameId},C.prototype.stop=function(){return this._stop()},C.prototype._stop=function(w,M){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var z=this._onEaseEnd;delete this._onEaseEnd,z.call(this,M)}if(!w){var H=this.handlers;H&&H.stop(!1)}return this},C.prototype._ease=function(w,M,z){z.animate===!1||z.duration===0?(w(1),M()):(this._easeStart=I.browser.now(),this._easeOptions=z,this._onEaseFrame=w,this._onEaseEnd=M,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},C.prototype._renderFrameCallback=function(){var w=Math.min((I.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(w)),w<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},C.prototype._normalizeBearing=function(w,M){w=I.wrap(w,-180,180);var z=Math.abs(w-M);return Math.abs(w-360-M)<z&&(w-=360),Math.abs(w+360-M)<z&&(w+=360),w},C.prototype._normalizeCenter=function(w){var M=this.transform;if(M.renderWorldCopies&&!M.lngRange){var z=w.lng-M.center.lng;w.lng+=z>180?-360:z<-180?360:0}},C}(I.Evented),ol=function(x){x===void 0&&(x={}),this.options=x,I.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};ol.prototype.getDefaultPosition=function(){return"bottom-right"},ol.prototype.onAdd=function(x){var C=this.options&&this.options.compact;return this._map=x,this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=q.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=q.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),C&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),C===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},ol.prototype.onRemove=function(){q.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},ol.prototype._setElementTitle=function(x,C){var w=this._map._getUIString("AttributionControl."+C);x.title=w,x.setAttribute("aria-label",w)},ol.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},ol.prototype._updateEditLink=function(){var x=this._editLink;x||(x=this._editLink=this._container.querySelector(".mapbox-improve-map"));var C=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||I.config.ACCESS_TOKEN}];if(x){var w=C.reduce(function(M,z,H){return z.value&&(M+=z.key+"="+z.value+(H<C.length-1?"&":"")),M},"?");x.href=I.config.FEEDBACK_URL+"/"+w+(this._map._hash?this._map._hash.getHashString(!0):""),x.rel="noopener nofollow",this._setElementTitle(x,"MapFeedback")}},ol.prototype._updateData=function(x){!x||x.sourceDataType!=="metadata"&&x.sourceDataType!=="visibility"&&x.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},ol.prototype._updateAttributions=function(){if(this._map.style){var x=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?x=x.concat(this.options.customAttribution.map(function(ft){return typeof ft!="string"?"":ft})):typeof this.options.customAttribution=="string"&&x.push(this.options.customAttribution)),this._map.style.stylesheet){var C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}var w=this._map.style.sourceCaches;for(var M in w){var z=w[M];if(z.used){var H=z.getSource();H.attribution&&x.indexOf(H.attribution)<0&&x.push(H.attribution)}}x.sort(function(ft,Ut){return ft.length-Ut.length});var $=(x=x.filter(function(ft,Ut){for(var re=Ut+1;re<x.length;re++)if(x[re].indexOf(ft)>=0)return!1;return!0})).join(" | ");$!==this._attribHTML&&(this._attribHTML=$,x.length?(this._innerContainer.innerHTML=$,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},ol.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var sl=function(){I.bindAll(["_updateLogo"],this),I.bindAll(["_updateCompact"],this)};sl.prototype.onAdd=function(x){this._map=x,this._container=q.create("div","mapboxgl-ctrl");var C=q.create("a","mapboxgl-ctrl-logo");return C.target="_blank",C.rel="noopener nofollow",C.href="https://www.mapbox.com/",C.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),C.setAttribute("rel","noopener nofollow"),this._container.appendChild(C),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},sl.prototype.onRemove=function(){q.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},sl.prototype.getDefaultPosition=function(){return"bottom-left"},sl.prototype._updateLogo=function(x){x&&x.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},sl.prototype._logoRequired=function(){if(this._map.style){var x=this._map.style.sourceCaches;for(var C in x)if(x[C].getSource().mapbox_logo)return!0;return!1}},sl.prototype._updateCompact=function(){var x=this._container.children;if(x.length){var C=x[0];this._map.getCanvasContainer().offsetWidth<250?C.classList.add("mapboxgl-compact"):C.classList.remove("mapboxgl-compact")}};var Ru=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Ru.prototype.add=function(x){var C=++this._id;return this._queue.push({callback:x,id:C,cancelled:!1}),C},Ru.prototype.remove=function(x){for(var C=this._currentlyRunning,w=0,M=C?this._queue.concat(C):this._queue;w<M.length;w+=1){var z=M[w];if(z.id===x)return void(z.cancelled=!0)}},Ru.prototype.run=function(x){x===void 0&&(x=0);var C=this._currentlyRunning=this._queue;this._queue=[];for(var w=0,M=C;w<M.length;w+=1){var z=M[w];if(!z.cancelled&&(z.callback(x),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Ru.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var bs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Ac=I.window.HTMLImageElement,Tc=I.window.HTMLElement,No=I.window.ImageBitmap,os={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ip=function(x){function C(M){var z=this;if((M=I.extend({},os,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var H=new go(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies);if(x.call(this,H,M),this._interactive=M.interactive,this._maxTileCacheSize=M.maxTileCacheSize,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new Ru,this._controls=[],this._mapId=I.uniqueId(),this._locale=I.extend({},bs,M.locale),this._clickTolerance=M.clickTolerance,this._requestManager=new I.RequestManager(M.transformRequest,M.accessToken),typeof M.container=="string"){if(this._container=I.window.document.getElementById(M.container),!this._container)throw new Error("Container '"+M.container+"' not found.")}else{if(!(M.container instanceof Tc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),I.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return z._update(!1)}),this.on("moveend",function(){return z._update(!1)}),this.on("zoom",function(){return z._update(!0)}),I.window!==void 0&&(I.window.addEventListener("online",this._onWindowOnline,!1),I.window.addEventListener("resize",this._onWindowResize,!1),I.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Wi(this,M),this._hash=M.hash&&new Yu(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,I.extend({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new ol({customAttribution:M.customAttribution})),this.addControl(new sl,M.logoPosition),this.on("style.load",function(){z.transform.unmodified&&z.jumpTo(z.style.stylesheet)}),this.on("data",function($){z._update($.dataType==="style"),z.fire(new I.Event($.dataType+"data",$))}),this.on("dataloading",function($){z.fire(new I.Event($.dataType+"dataloading",$))})}x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C;var w={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return C.prototype._getMapId=function(){return this._mapId},C.prototype.addControl=function(M,z){if(z===void 0&&(z=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new I.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var H=M.onAdd(this);this._controls.push(M);var $=this._controlPositions[z];return z.indexOf("bottom")!==-1?$.insertBefore(H,$.firstChild):$.appendChild(H),this},C.prototype.removeControl=function(M){if(!M||!M.onRemove)return this.fire(new I.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var z=this._controls.indexOf(M);return z>-1&&this._controls.splice(z,1),M.onRemove(this),this},C.prototype.hasControl=function(M){return this._controls.indexOf(M)>-1},C.prototype.resize=function(M){var z=this._containerDimensions(),H=z[0],$=z[1];if(H===this.transform.width&&$===this.transform.height)return this;this._resizeCanvas(H,$),this.transform.resize(H,$),this.painter.resize(H,$);var ft=!this._moving;return ft&&this.fire(new I.Event("movestart",M)).fire(new I.Event("move",M)),this.fire(new I.Event("resize",M)),ft&&this.fire(new I.Event("moveend",M)),this},C.prototype.getBounds=function(){return this.transform.getBounds()},C.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},C.prototype.setMaxBounds=function(M){return this.transform.setMaxBounds(I.LngLatBounds.convert(M)),this._update()},C.prototype.setMinZoom=function(M){if((M=M==null?-2:M)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},C.prototype.getMinZoom=function(){return this.transform.minZoom},C.prototype.setMaxZoom=function(M){if((M=M==null?22:M)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")},C.prototype.getMaxZoom=function(){return this.transform.maxZoom},C.prototype.setMinPitch=function(M){if((M=M==null?0:M)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},C.prototype.getMinPitch=function(){return this.transform.minPitch},C.prototype.setMaxPitch=function(M){if((M=M==null?60:M)>60)throw new Error("maxPitch must be less than or equal to 60");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")},C.prototype.getMaxPitch=function(){return this.transform.maxPitch},C.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},C.prototype.setRenderWorldCopies=function(M){return this.transform.renderWorldCopies=M,this._update()},C.prototype.project=function(M){return this.transform.locationPoint(I.LngLat.convert(M))},C.prototype.unproject=function(M){return this.transform.pointLocation(I.Point.convert(M))},C.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},C.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},C.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},C.prototype._createDelegatedListener=function(M,z,H){var $,ft=this;if(M==="mouseenter"||M==="mouseover"){var Ut=!1;return{layer:z,listener:H,delegates:{mousemove:function(De){var Be=ft.getLayer(z)?ft.queryRenderedFeatures(De.point,{layers:[z]}):[];Be.length?Ut||(Ut=!0,H.call(ft,new au(M,ft,De.originalEvent,{features:Be}))):Ut=!1},mouseout:function(){Ut=!1}}}}if(M==="mouseleave"||M==="mouseout"){var re=!1;return{layer:z,listener:H,delegates:{mousemove:function(De){(ft.getLayer(z)?ft.queryRenderedFeatures(De.point,{layers:[z]}):[]).length?re=!0:re&&(re=!1,H.call(ft,new au(M,ft,De.originalEvent)))},mouseout:function(De){re&&(re=!1,H.call(ft,new au(M,ft,De.originalEvent)))}}}}return{layer:z,listener:H,delegates:($={},$[M]=function(De){var Be=ft.getLayer(z)?ft.queryRenderedFeatures(De.point,{layers:[z]}):[];Be.length&&(De.features=Be,H.call(ft,De),delete De.features)},$)}},C.prototype.on=function(M,z,H){if(H===void 0)return x.prototype.on.call(this,M,z);var $=this._createDelegatedListener(M,z,H);for(var ft in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push($),$.delegates)this.on(ft,$.delegates[ft]);return this},C.prototype.once=function(M,z,H){if(H===void 0)return x.prototype.once.call(this,M,z);var $=this._createDelegatedListener(M,z,H);for(var ft in $.delegates)this.once(ft,$.delegates[ft]);return this},C.prototype.off=function(M,z,H){var $=this;return H===void 0?x.prototype.off.call(this,M,z):(this._delegatedListeners&&this._delegatedListeners[M]&&function(ft){for(var Ut=ft[M],re=0;re<Ut.length;re++){var De=Ut[re];if(De.layer===z&&De.listener===H){for(var Be in De.delegates)$.off(Be,De.delegates[Be]);return Ut.splice(re,1),$}}}(this._delegatedListeners),this)},C.prototype.queryRenderedFeatures=function(M,z){if(!this.style)return[];var H;if(z!==void 0||M===void 0||M instanceof I.Point||Array.isArray(M)||(z=M,M=void 0),z=z||{},(M=M||[[0,0],[this.transform.width,this.transform.height]])instanceof I.Point||typeof M[0]=="number")H=[I.Point.convert(M)];else{var $=I.Point.convert(M[0]),ft=I.Point.convert(M[1]);H=[$,new I.Point(ft.x,$.y),ft,new I.Point($.x,ft.y),$]}return this.style.queryRenderedFeatures(H,z,this.transform)},C.prototype.querySourceFeatures=function(M,z){return this.style.querySourceFeatures(M,z)},C.prototype.setStyle=function(M,z){return(z=I.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},z)).diff!==!1&&z.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,z),this):(this._localIdeographFontFamily=z.localIdeographFontFamily,this._updateStyle(M,z))},C.prototype._getUIString=function(M){var z=this._locale[M];if(z==null)throw new Error("Missing UI string '"+M+"'");return z},C.prototype._updateStyle=function(M,z){return this.style&&(this.style.setEventedParent(null),this.style._remove()),M?(this.style=new Fu(this,z||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M):this.style.loadJSON(M),this):(delete this.style,this)},C.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Fu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},C.prototype._diffStyle=function(M,z){var H=this;if(typeof M=="string"){var $=this._requestManager.normalizeStyleURL(M),ft=this._requestManager.transformRequest($,I.ResourceType.Style);I.getJSON(ft,function(Ut,re){Ut?H.fire(new I.ErrorEvent(Ut)):re&&H._updateDiff(re,z)})}else typeof M=="object"&&this._updateDiff(M,z)},C.prototype._updateDiff=function(M,z){try{this.style.setState(M)&&this._update(!0)}catch(H){I.warnOnce("Unable to perform style diff: "+(H.message||H.error||H)+".  Rebuilding the style from scratch."),this._updateStyle(M,z)}},C.prototype.getStyle=function(){if(this.style)return this.style.serialize()},C.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():I.warnOnce("There is no style added to the map.")},C.prototype.addSource=function(M,z){return this._lazyInitEmptyStyle(),this.style.addSource(M,z),this._update(!0)},C.prototype.isSourceLoaded=function(M){var z=this.style&&this.style.sourceCaches[M];if(z!==void 0)return z.loaded();this.fire(new I.ErrorEvent(new Error("There is no source with ID '"+M+"'")))},C.prototype.areTilesLoaded=function(){var M=this.style&&this.style.sourceCaches;for(var z in M){var H=M[z]._tiles;for(var $ in H){var ft=H[$];if(ft.state!=="loaded"&&ft.state!=="errored")return!1}}return!0},C.prototype.addSourceType=function(M,z,H){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,z,H)},C.prototype.removeSource=function(M){return this.style.removeSource(M),this._update(!0)},C.prototype.getSource=function(M){return this.style.getSource(M)},C.prototype.addImage=function(M,z,H){H===void 0&&(H={});var $=H.pixelRatio;$===void 0&&($=1);var ft=H.sdf;ft===void 0&&(ft=!1);var Ut=H.stretchX,re=H.stretchY,De=H.content;if(this._lazyInitEmptyStyle(),z instanceof Ac||No&&z instanceof No){var Be=I.browser.getImageData(z);this.style.addImage(M,{data:new I.RGBAImage({width:Be.width,height:Be.height},Be.data),pixelRatio:$,stretchX:Ut,stretchY:re,content:De,sdf:ft,version:0})}else{if(z.width===void 0||z.height===void 0)return this.fire(new I.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Le=z;this.style.addImage(M,{data:new I.RGBAImage({width:z.width,height:z.height},new Uint8Array(z.data)),pixelRatio:$,stretchX:Ut,stretchY:re,content:De,sdf:ft,version:0,userImage:Le}),Le.onAdd&&Le.onAdd(this,M)}},C.prototype.updateImage=function(M,z){var H=this.style.getImage(M);if(!H)return this.fire(new I.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var $=z instanceof Ac||No&&z instanceof No?I.browser.getImageData(z):z,ft=$.width,Ut=$.height,re=$.data;return ft===void 0||Ut===void 0?this.fire(new I.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):ft!==H.data.width||Ut!==H.data.height?this.fire(new I.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(H.data.replace(re,!(z instanceof Ac||No&&z instanceof No)),void this.style.updateImage(M,H))},C.prototype.hasImage=function(M){return M?!!this.style.getImage(M):(this.fire(new I.ErrorEvent(new Error("Missing required image id"))),!1)},C.prototype.removeImage=function(M){this.style.removeImage(M)},C.prototype.loadImage=function(M,z){I.getImage(this._requestManager.transformRequest(M,I.ResourceType.Image),z)},C.prototype.listImages=function(){return this.style.listImages()},C.prototype.addLayer=function(M,z){return this._lazyInitEmptyStyle(),this.style.addLayer(M,z),this._update(!0)},C.prototype.moveLayer=function(M,z){return this.style.moveLayer(M,z),this._update(!0)},C.prototype.removeLayer=function(M){return this.style.removeLayer(M),this._update(!0)},C.prototype.getLayer=function(M){return this.style.getLayer(M)},C.prototype.setLayerZoomRange=function(M,z,H){return this.style.setLayerZoomRange(M,z,H),this._update(!0)},C.prototype.setFilter=function(M,z,H){return H===void 0&&(H={}),this.style.setFilter(M,z,H),this._update(!0)},C.prototype.getFilter=function(M){return this.style.getFilter(M)},C.prototype.setPaintProperty=function(M,z,H,$){return $===void 0&&($={}),this.style.setPaintProperty(M,z,H,$),this._update(!0)},C.prototype.getPaintProperty=function(M,z){return this.style.getPaintProperty(M,z)},C.prototype.setLayoutProperty=function(M,z,H,$){return $===void 0&&($={}),this.style.setLayoutProperty(M,z,H,$),this._update(!0)},C.prototype.getLayoutProperty=function(M,z){return this.style.getLayoutProperty(M,z)},C.prototype.setLight=function(M,z){return z===void 0&&(z={}),this._lazyInitEmptyStyle(),this.style.setLight(M,z),this._update(!0)},C.prototype.getLight=function(){return this.style.getLight()},C.prototype.setFeatureState=function(M,z){return this.style.setFeatureState(M,z),this._update()},C.prototype.removeFeatureState=function(M,z){return this.style.removeFeatureState(M,z),this._update()},C.prototype.getFeatureState=function(M){return this.style.getFeatureState(M)},C.prototype.getContainer=function(){return this._container},C.prototype.getCanvasContainer=function(){return this._canvasContainer},C.prototype.getCanvas=function(){return this._canvas},C.prototype._containerDimensions=function(){var M=0,z=0;return this._container&&(M=this._container.clientWidth||400,z=this._container.clientHeight||300),[M,z]},C.prototype._detectMissingCSS=function(){I.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&I.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},C.prototype._setupContainer=function(){var M=this._container;M.classList.add("mapboxgl-map"),(this._missingCSSCanary=q.create("div","mapboxgl-canary",M)).style.visibility="hidden",this._detectMissingCSS();var z=this._canvasContainer=q.create("div","mapboxgl-canvas-container",M);this._interactive&&z.classList.add("mapboxgl-interactive"),this._canvas=q.create("canvas","mapboxgl-canvas",z),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var H=this._containerDimensions();this._resizeCanvas(H[0],H[1]);var $=this._controlContainer=q.create("div","mapboxgl-control-container",M),ft=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ut){ft[Ut]=q.create("div","mapboxgl-ctrl-"+Ut,$)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},C.prototype._resizeCanvas=function(M,z){var H=I.browser.devicePixelRatio||1;this._canvas.width=H*M,this._canvas.height=H*z,this._canvas.style.width=M+"px",this._canvas.style.height=z+"px"},C.prototype._setupPainter=function(){var M=I.extend({},Et.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),z=this._canvas.getContext("webgl",M)||this._canvas.getContext("experimental-webgl",M);z?(this.painter=new xs(z,this.transform),I.webpSupported.testSupport(z)):this.fire(new I.ErrorEvent(new Error("Failed to initialize WebGL")))},C.prototype._contextLost=function(M){M.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new I.Event("webglcontextlost",{originalEvent:M}))},C.prototype._contextRestored=function(M){this._setupPainter(),this.resize(),this._update(),this.fire(new I.Event("webglcontextrestored",{originalEvent:M}))},C.prototype._onMapScroll=function(M){if(M.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},C.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},C.prototype._update=function(M){return this.style?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this},C.prototype._requestRenderFrame=function(M){return this._update(),this._renderTaskQueue.add(M)},C.prototype._cancelRenderFrame=function(M){this._renderTaskQueue.remove(M)},C.prototype._render=function(M){var z,H=this,$=0,ft=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(z=ft.createQueryEXT(),ft.beginQueryEXT(ft.TIME_ELAPSED_EXT,z),$=I.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),!this._removed){var Ut=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var re=this.transform.zoom,De=I.browser.now();this.style.zoomHistory.update(re,De);var Be=new I.EvaluationParameters(re,{now:De,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Le=Be.crossFadingFactor();Le===1&&Le===this._crossFadingFactor||(Ut=!0,this._crossFadingFactor=Le),this.style.update(Be)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new I.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new I.Event("load"))),this.style&&(this.style.hasTransitions()||Ut)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var cr=I.browser.now()-$;ft.endQueryEXT(ft.TIME_ELAPSED_EXT,z),setTimeout(function(){var rr=ft.getQueryObjectEXT(z,ft.QUERY_RESULT_EXT)/1e6;ft.deleteQueryEXT(z),H.fire(new I.Event("gpu-timing-frame",{cpuTime:cr,gpuTime:rr}))},50)}if(this.listens("gpu-timing-layer")){var ar=this.painter.collectGpuTimers();setTimeout(function(){var rr=H.painter.queryGpuTimers(ar);H.fire(new I.Event("gpu-timing-layer",{layerTimes:rr}))},50)}var br=this._sourcesDirty||this._styleDirty||this._placementDirty;return br||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new I.Event("idle")),!this._loaded||this._fullyLoaded||br||(this._fullyLoaded=!0),this}},C.prototype.remove=function(){this._hash&&this._hash.remove();for(var M=0,z=this._controls;M<z.length;M+=1)z[M].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),I.window!==void 0&&(I.window.removeEventListener("resize",this._onWindowResize,!1),I.window.removeEventListener("orientationchange",this._onWindowResize,!1),I.window.removeEventListener("online",this._onWindowOnline,!1));var H=this.painter.context.gl.getExtension("WEBGL_lose_context");H&&H.loseContext(),Wc(this._canvasContainer),Wc(this._controlContainer),Wc(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new I.Event("remove"))},C.prototype.triggerRepaint=function(){var M=this;this.style&&!this._frame&&(this._frame=I.browser.frame(function(z){M._frame=null,M._render(z)}))},C.prototype._onWindowOnline=function(){this._update()},C.prototype._onWindowResize=function(M){this._trackResize&&this.resize({originalEvent:M})._update()},w.showTileBoundaries.get=function(){return!!this._showTileBoundaries},w.showTileBoundaries.set=function(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())},w.showPadding.get=function(){return!!this._showPadding},w.showPadding.set=function(M){this._showPadding!==M&&(this._showPadding=M,this._update())},w.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},w.showCollisionBoxes.set=function(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())},w.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},w.showOverdrawInspector.set=function(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())},w.repaint.get=function(){return!!this._repaint},w.repaint.set=function(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())},w.vertices.get=function(){return!!this._vertices},w.vertices.set=function(M){this._vertices=M,this._update()},C.prototype._setCacheLimits=function(M,z){I.setCacheLimits(M,z)},w.version.get=function(){return I.version},Object.defineProperties(C.prototype,w),C}(Af);function Wc(x){x.parentNode&&x.parentNode.removeChild(x)}var hc={showCompass:!0,showZoom:!0,visualizePitch:!1},ul=function(x){var C=this;this.options=I.extend({},hc,x),this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(w){return w.preventDefault()}),this.options.showZoom&&(I.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(w){return C._map.zoomIn({},{originalEvent:w})}),q.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(w){return C._map.zoomOut({},{originalEvent:w})}),q.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(I.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(w){C.options.visualizePitch?C._map.resetNorthPitch({},{originalEvent:w}):C._map.resetNorth({},{originalEvent:w})}),this._compassIcon=q.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ul.prototype._updateZoomButtons=function(){var x=this._map.getZoom(),C=x===this._map.getMaxZoom(),w=x===this._map.getMinZoom();this._zoomInButton.disabled=C,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",C.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},ul.prototype._rotateCompassArrow=function(){var x=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=x},ul.prototype.onAdd=function(x){return this._map=x,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Fs(this._map,this._compass,this.options.visualizePitch)),this._container},ul.prototype.onRemove=function(){q.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ul.prototype._createButton=function(x,C){var w=q.create("button",x,this._container);return w.type="button",w.addEventListener("click",C),w},ul.prototype._setButtonTitle=function(x,C){var w=this._map._getUIString("NavigationControl."+C);x.title=w,x.setAttribute("aria-label",w)};var Fs=function(x,C,w){w===void 0&&(w=!1),this._clickTolerance=10,this.element=C,this.mouseRotate=new Cc({clickTolerance:x.dragRotate._mouseRotate._clickTolerance}),this.map=x,w&&(this.mousePitch=new Cf({clickTolerance:x.dragRotate._mousePitch._clickTolerance})),I.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),q.addEventListener(C,"mousedown",this.mousedown),q.addEventListener(C,"touchstart",this.touchstart,{passive:!1}),q.addEventListener(C,"touchmove",this.touchmove),q.addEventListener(C,"touchend",this.touchend),q.addEventListener(C,"touchcancel",this.reset)};function Ms(x,C,w){if(x=new I.LngLat(x.lng,x.lat),C){var M=new I.LngLat(x.lng-360,x.lat),z=new I.LngLat(x.lng+360,x.lat),H=w.locationPoint(x).distSqr(C);w.locationPoint(M).distSqr(C)<H?x=M:w.locationPoint(z).distSqr(C)<H&&(x=z)}for(;Math.abs(x.lng-w.center.lng)>180;){var $=w.locationPoint(x);if($.x>=0&&$.y>=0&&$.x<=w.width&&$.y<=w.height)break;x.lng>w.center.lng?x.lng-=360:x.lng+=360}return x}Fs.prototype.down=function(x,C){this.mouseRotate.mousedown(x,C),this.mousePitch&&this.mousePitch.mousedown(x,C),q.disableDrag()},Fs.prototype.move=function(x,C){var w=this.map,M=this.mouseRotate.mousemoveWindow(x,C);if(M&&M.bearingDelta&&w.setBearing(w.getBearing()+M.bearingDelta),this.mousePitch){var z=this.mousePitch.mousemoveWindow(x,C);z&&z.pitchDelta&&w.setPitch(w.getPitch()+z.pitchDelta)}},Fs.prototype.off=function(){var x=this.element;q.removeEventListener(x,"mousedown",this.mousedown),q.removeEventListener(x,"touchstart",this.touchstart,{passive:!1}),q.removeEventListener(x,"touchmove",this.touchmove),q.removeEventListener(x,"touchend",this.touchend),q.removeEventListener(x,"touchcancel",this.reset),this.offTemp()},Fs.prototype.offTemp=function(){q.enableDrag(),q.removeEventListener(I.window,"mousemove",this.mousemove),q.removeEventListener(I.window,"mouseup",this.mouseup)},Fs.prototype.mousedown=function(x){this.down(I.extend({},x,{ctrlKey:!0,preventDefault:function(){return x.preventDefault()}}),q.mousePos(this.element,x)),q.addEventListener(I.window,"mousemove",this.mousemove),q.addEventListener(I.window,"mouseup",this.mouseup)},Fs.prototype.mousemove=function(x){this.move(x,q.mousePos(this.element,x))},Fs.prototype.mouseup=function(x){this.mouseRotate.mouseupWindow(x),this.mousePitch&&this.mousePitch.mouseupWindow(x),this.offTemp()},Fs.prototype.touchstart=function(x){x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=q.touchPos(this.element,x.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return x.preventDefault()}},this._startPos))},Fs.prototype.touchmove=function(x){x.targetTouches.length!==1?this.reset():(this._lastPos=q.touchPos(this.element,x.targetTouches)[0],this.move({preventDefault:function(){return x.preventDefault()}},this._lastPos))},Fs.prototype.touchend=function(x){x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Fs.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var $u={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Xc(x,C,w){var M=x.classList;for(var z in $u)M.remove("mapboxgl-"+w+"-anchor-"+z);M.add("mapboxgl-"+w+"-anchor-"+C)}var ll,Wf=function(x){function C(w,M){if(x.call(this),(w instanceof I.window.HTMLElement||M)&&(w=I.extend({element:w},M)),I.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=w&&w.anchor||"center",this._color=w&&w.color||"#3FB1CE",this._scale=w&&w.scale||1,this._draggable=w&&w.draggable||!1,this._clickTolerance=w&&w.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=w&&w.rotation||0,this._rotationAlignment=w&&w.rotationAlignment||"auto",this._pitchAlignment=w&&w.pitchAlignment&&w.pitchAlignment!=="auto"?w.pitchAlignment:this._rotationAlignment,w&&w.element)this._element=w.element,this._offset=I.Point.convert(w&&w.offset||[0,0]);else{this._defaultMarker=!0,this._element=q.create("div"),this._element.setAttribute("aria-label","Map marker");var z=q.createNS("http://www.w3.org/2000/svg","svg");z.setAttributeNS(null,"display","block"),z.setAttributeNS(null,"height","41px"),z.setAttributeNS(null,"width","27px"),z.setAttributeNS(null,"viewBox","0 0 27 41");var H=q.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"stroke","none"),H.setAttributeNS(null,"stroke-width","1"),H.setAttributeNS(null,"fill","none"),H.setAttributeNS(null,"fill-rule","evenodd");var $=q.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"fill-rule","nonzero");var ft=q.createNS("http://www.w3.org/2000/svg","g");ft.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ft.setAttributeNS(null,"fill","#000000");for(var Ut=0,re=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];Ut<re.length;Ut+=1){var De=re[Ut],Be=q.createNS("http://www.w3.org/2000/svg","ellipse");Be.setAttributeNS(null,"opacity","0.04"),Be.setAttributeNS(null,"cx","10.5"),Be.setAttributeNS(null,"cy","5.80029008"),Be.setAttributeNS(null,"rx",De.rx),Be.setAttributeNS(null,"ry",De.ry),ft.appendChild(Be)}var Le=q.createNS("http://www.w3.org/2000/svg","g");Le.setAttributeNS(null,"fill",this._color);var cr=q.createNS("http://www.w3.org/2000/svg","path");cr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Le.appendChild(cr);var ar=q.createNS("http://www.w3.org/2000/svg","g");ar.setAttributeNS(null,"opacity","0.25"),ar.setAttributeNS(null,"fill","#000000");var br=q.createNS("http://www.w3.org/2000/svg","path");br.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),ar.appendChild(br);var rr=q.createNS("http://www.w3.org/2000/svg","g");rr.setAttributeNS(null,"transform","translate(6.0, 7.0)"),rr.setAttributeNS(null,"fill","#FFFFFF");var xr=q.createNS("http://www.w3.org/2000/svg","g");xr.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Pr=q.createNS("http://www.w3.org/2000/svg","circle");Pr.setAttributeNS(null,"fill","#000000"),Pr.setAttributeNS(null,"opacity","0.25"),Pr.setAttributeNS(null,"cx","5.5"),Pr.setAttributeNS(null,"cy","5.5"),Pr.setAttributeNS(null,"r","5.4999962");var Rr=q.createNS("http://www.w3.org/2000/svg","circle");Rr.setAttributeNS(null,"fill","#FFFFFF"),Rr.setAttributeNS(null,"cx","5.5"),Rr.setAttributeNS(null,"cy","5.5"),Rr.setAttributeNS(null,"r","5.4999962"),xr.appendChild(Pr),xr.appendChild(Rr),$.appendChild(ft),$.appendChild(Le),$.appendChild(ar),$.appendChild(rr),$.appendChild(xr),z.appendChild($),z.setAttributeNS(null,"height",41*this._scale+"px"),z.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(z),this._offset=I.Point.convert(w&&w.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(gn){gn.preventDefault()}),this._element.addEventListener("mousedown",function(gn){gn.preventDefault()}),Xc(this._element,this._anchor,"marker"),this._popup=null}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.addTo=function(w){return this.remove(),this._map=w,w.getCanvasContainer().appendChild(this._element),w.on("move",this._update),w.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},C.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),q.remove(this._element),this._popup&&this._popup.remove(),this},C.prototype.getLngLat=function(){return this._lngLat},C.prototype.setLngLat=function(w){return this._lngLat=I.LngLat.convert(w),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},C.prototype.getElement=function(){return this._element},C.prototype.setPopup=function(w){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),w){if(!("offset"in w.options)){var M=Math.sqrt(Math.pow(13.5,2)/2);w.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[M,-1*(24.6+M)],"bottom-right":[-M,-1*(24.6+M)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=w,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},C.prototype._onKeyPress=function(w){var M=w.code,z=w.charCode||w.keyCode;M!=="Space"&&M!=="Enter"&&z!==32&&z!==13||this.togglePopup()},C.prototype._onMapClick=function(w){var M=w.originalEvent.target,z=this._element;this._popup&&(M===z||z.contains(M))&&this.togglePopup()},C.prototype.getPopup=function(){return this._popup},C.prototype.togglePopup=function(){var w=this._popup;return w?(w.isOpen()?w.remove():w.addTo(this._map),this):this},C.prototype._update=function(w){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ms(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var M="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?M="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(M="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var z="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?z="rotateX(0deg)":this._pitchAlignment==="map"&&(z="rotateX("+this._map.getPitch()+"deg)"),w&&w.type!=="moveend"||(this._pos=this._pos.round()),q.setTransform(this._element,$u[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+z+" "+M)}},C.prototype.getOffset=function(){return this._offset},C.prototype.setOffset=function(w){return this._offset=I.Point.convert(w),this._update(),this},C.prototype._onMove=function(w){if(!this._isDragging){var M=this._clickTolerance||this._map._clickTolerance;this._isDragging=w.point.dist(this._pointerdownPos)>=M}this._isDragging&&(this._pos=w.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new I.Event("dragstart"))),this.fire(new I.Event("drag")))},C.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new I.Event("dragend")),this._state="inactive"},C.prototype._addDragHandler=function(w){this._element.contains(w.originalEvent.target)&&(w.preventDefault(),this._positionDelta=w.point.sub(this._pos).add(this._offset),this._pointerdownPos=w.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},C.prototype.setDraggable=function(w){return this._draggable=!!w,this._map&&(w?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},C.prototype.isDraggable=function(){return this._draggable},C.prototype.setRotation=function(w){return this._rotation=w||0,this._update(),this},C.prototype.getRotation=function(){return this._rotation},C.prototype.setRotationAlignment=function(w){return this._rotationAlignment=w||"auto",this._update(),this},C.prototype.getRotationAlignment=function(){return this._rotationAlignment},C.prototype.setPitchAlignment=function(w){return this._pitchAlignment=w&&w!=="auto"?w:this._rotationAlignment,this._update(),this},C.prototype.getPitchAlignment=function(){return this._pitchAlignment},C}(I.Evented),Mc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},mh=0,Xf=!1,wd=function(x){function C(w){x.call(this),this.options=I.extend({},Mc,w),I.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.onAdd=function(w){var M;return this._map=w,this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),M=this._setupUI,ll!==void 0?M(ll):I.window.navigator.permissions!==void 0?I.window.navigator.permissions.query({name:"geolocation"}).then(function(z){M(ll=z.state!=="denied")}):M(ll=!!I.window.navigator.geolocation),this._container},C.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(I.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),q.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,mh=0,Xf=!1},C.prototype._isOutOfMapMaxBounds=function(w){var M=this._map.getMaxBounds(),z=w.coords;return M&&(z.longitude<M.getWest()||z.longitude>M.getEast()||z.latitude<M.getSouth()||z.latitude>M.getNorth())},C.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},C.prototype._onSuccess=function(w){if(this._map){if(this._isOutOfMapMaxBounds(w))return this._setErrorState(),this.fire(new I.Event("outofmaxbounds",w)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=w,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(w),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(w),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new I.Event("geolocate",w)),this._finish()}},C.prototype._updateCamera=function(w){var M=new I.LngLat(w.coords.longitude,w.coords.latitude),z=w.coords.accuracy,H=this._map.getBearing(),$=I.extend({bearing:H},this.options.fitBoundsOptions);this._map.fitBounds(M.toBounds(z),$,{geolocateSource:!0})},C.prototype._updateMarker=function(w){if(w){var M=new I.LngLat(w.coords.longitude,w.coords.latitude);this._accuracyCircleMarker.setLngLat(M).addTo(this._map),this._userLocationDotMarker.setLngLat(M).addTo(this._map),this._accuracy=w.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},C.prototype._updateCircleRadius=function(){var w=this._map._container.clientHeight/2,M=this._map.unproject([0,w]),z=this._map.unproject([1,w]),H=M.distanceTo(z),$=Math.ceil(2*this._accuracy/H);this._circleElement.style.width=$+"px",this._circleElement.style.height=$+"px"},C.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},C.prototype._onError=function(w){if(this._map){if(this.options.trackUserLocation)if(w.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var M=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(w.code===3&&Xf)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new I.Event("error",w)),this._finish()}},C.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},C.prototype._setupUI=function(w){var M=this;if(this._container.addEventListener("contextmenu",function($){return $.preventDefault()}),this._geolocateButton=q.create("button","mapboxgl-ctrl-geolocate",this._container),q.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",w===!1){I.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var z=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=z,this._geolocateButton.setAttribute("aria-label",z)}else{var H=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=H,this._geolocateButton.setAttribute("aria-label",H)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=q.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Wf(this._dotElement),this._circleElement=q.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function($){$.geolocateSource||M._watchState!=="ACTIVE_LOCK"||$.originalEvent&&$.originalEvent.type==="resize"||(M._watchState="BACKGROUND",M._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),M._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),M.fire(new I.Event("trackuserlocationend")))})},C.prototype.trigger=function(){if(!this._setup)return I.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new I.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":mh--,Xf=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new I.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new I.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var w;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++mh>1?(w={maximumAge:6e5,timeout:0},Xf=!0):(w=this.options.positionOptions,Xf=!1),this._geolocationWatchID=I.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else I.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},C.prototype._clearWatch=function(){I.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},C}(I.Evented),Rs={maxWidth:100,unit:"metric"},Ic=function(x){this.options=I.extend({},Rs,x),I.bindAll(["_onMove","setUnit"],this)};function ap(x,C,w){var M=w&&w.maxWidth||100,z=x._container.clientHeight/2,H=x.unproject([0,z]),$=x.unproject([M,z]),ft=H.distanceTo($);if(w&&w.unit==="imperial"){var Ut=3.2808*ft;Ut>5280?bl(C,M,Ut/5280,x._getUIString("ScaleControl.Miles")):bl(C,M,Ut,x._getUIString("ScaleControl.Feet"))}else w&&w.unit==="nautical"?bl(C,M,ft/1852,x._getUIString("ScaleControl.NauticalMiles")):ft>=1e3?bl(C,M,ft/1e3,x._getUIString("ScaleControl.Kilometers")):bl(C,M,ft,x._getUIString("ScaleControl.Meters"))}function bl(x,C,w,M){var z,H,$,ft=(z=w,(H=Math.pow(10,(""+Math.floor(z)).length-1))*($=($=z/H)>=10?10:$>=5?5:$>=3?3:$>=2?2:$>=1?1:function(Ut){var re=Math.pow(10,Math.ceil(-Math.log(Ut)/Math.LN10));return Math.round(Ut*re)/re}($)));x.style.width=C*(ft/w)+"px",x.innerHTML=ft+"&nbsp;"+M}Ic.prototype.getDefaultPosition=function(){return"bottom-left"},Ic.prototype._onMove=function(){ap(this._map,this._container,this.options)},Ic.prototype.onAdd=function(x){return this._map=x,this._container=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",x.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ic.prototype.onRemove=function(){q.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ic.prototype.setUnit=function(x){this.options.unit=x,ap(this._map,this._container,this.options)};var zl=function(x){this._fullscreen=!1,x&&x.container&&(x.container instanceof I.window.HTMLElement?this._container=x.container:I.warnOnce("Full screen control 'container' must be a DOM element.")),I.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in I.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in I.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in I.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in I.window.document&&(this._fullscreenchange="MSFullscreenChange")};zl.prototype.onAdd=function(x){return this._map=x,this._container||(this._container=this._map.getContainer()),this._controlContainer=q.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",I.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},zl.prototype.onRemove=function(){q.remove(this._controlContainer),this._map=null,I.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},zl.prototype._checkFullscreenSupport=function(){return!!(I.window.document.fullscreenEnabled||I.window.document.mozFullScreenEnabled||I.window.document.msFullscreenEnabled||I.window.document.webkitFullscreenEnabled)},zl.prototype._setupUI=function(){var x=this._fullscreenButton=q.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);q.create("span","mapboxgl-ctrl-icon",x).setAttribute("aria-hidden",!0),x.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),I.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},zl.prototype._updateTitle=function(){var x=this._getTitle();this._fullscreenButton.setAttribute("aria-label",x),this._fullscreenButton.title=x},zl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},zl.prototype._isFullscreen=function(){return this._fullscreen},zl.prototype._changeIcon=function(){(I.window.document.fullscreenElement||I.window.document.mozFullScreenElement||I.window.document.webkitFullscreenElement||I.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},zl.prototype._onClickFullscreen=function(){this._isFullscreen()?I.window.document.exitFullscreen?I.window.document.exitFullscreen():I.window.document.mozCancelFullScreen?I.window.document.mozCancelFullScreen():I.window.document.msExitFullscreen?I.window.document.msExitFullscreen():I.window.document.webkitCancelFullScreen&&I.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var op={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),zp=function(x){function C(w){x.call(this),this.options=I.extend(Object.create(op),w),I.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return x&&(C.__proto__=x),(C.prototype=Object.create(x&&x.prototype)).constructor=C,C.prototype.addTo=function(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new I.Event("open")),this},C.prototype.isOpen=function(){return!!this._map},C.prototype.remove=function(){return this._content&&q.remove(this._content),this._container&&(q.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new I.Event("close")),this},C.prototype.getLngLat=function(){return this._lngLat},C.prototype.setLngLat=function(w){return this._lngLat=I.LngLat.convert(w),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},C.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},C.prototype.getElement=function(){return this._container},C.prototype.setText=function(w){return this.setDOMContent(I.window.document.createTextNode(w))},C.prototype.setHTML=function(w){var M,z=I.window.document.createDocumentFragment(),H=I.window.document.createElement("body");for(H.innerHTML=w;M=H.firstChild;)z.appendChild(M);return this.setDOMContent(z)},C.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},C.prototype.setMaxWidth=function(w){return this.options.maxWidth=w,this._update(),this},C.prototype.setDOMContent=function(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=q.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this},C.prototype.addClassName=function(w){this._container&&this._container.classList.add(w)},C.prototype.removeClassName=function(w){this._container&&this._container.classList.remove(w)},C.prototype.setOffset=function(w){return this.options.offset=w,this._update(),this},C.prototype.toggleClassName=function(w){if(this._container)return this._container.classList.toggle(w)},C.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=q.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},C.prototype._onMouseUp=function(w){this._update(w.point)},C.prototype._onMouseMove=function(w){this._update(w.point)},C.prototype._onDrag=function(w){this._update(w.point)},C.prototype._update=function(w){var M=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=q.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=q.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Be){return M._container.classList.add(Be)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ms(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||w)){var z=this._pos=this._trackPointer&&w?w:this._map.project(this._lngLat),H=this.options.anchor,$=function Be(Le){if(Le){if(typeof Le=="number"){var cr=Math.round(Math.sqrt(.5*Math.pow(Le,2)));return{center:new I.Point(0,0),top:new I.Point(0,Le),"top-left":new I.Point(cr,cr),"top-right":new I.Point(-cr,cr),bottom:new I.Point(0,-Le),"bottom-left":new I.Point(cr,-cr),"bottom-right":new I.Point(-cr,-cr),left:new I.Point(Le,0),right:new I.Point(-Le,0)}}if(Le instanceof I.Point||Array.isArray(Le)){var ar=I.Point.convert(Le);return{center:ar,top:ar,"top-left":ar,"top-right":ar,bottom:ar,"bottom-left":ar,"bottom-right":ar,left:ar,right:ar}}return{center:I.Point.convert(Le.center||[0,0]),top:I.Point.convert(Le.top||[0,0]),"top-left":I.Point.convert(Le["top-left"]||[0,0]),"top-right":I.Point.convert(Le["top-right"]||[0,0]),bottom:I.Point.convert(Le.bottom||[0,0]),"bottom-left":I.Point.convert(Le["bottom-left"]||[0,0]),"bottom-right":I.Point.convert(Le["bottom-right"]||[0,0]),left:I.Point.convert(Le.left||[0,0]),right:I.Point.convert(Le.right||[0,0])}}return Be(new I.Point(0,0))}(this.options.offset);if(!H){var ft,Ut=this._container.offsetWidth,re=this._container.offsetHeight;ft=z.y+$.bottom.y<re?["top"]:z.y>this._map.transform.height-re?["bottom"]:[],z.x<Ut/2?ft.push("left"):z.x>this._map.transform.width-Ut/2&&ft.push("right"),H=ft.length===0?"bottom":ft.join("-")}var De=z.add($[H]).round();q.setTransform(this._container,$u[H]+" translate("+De.x+"px,"+De.y+"px)"),Xc(this._container,H,"popup")}},C.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var w=this._container.querySelector(pc);w&&w.focus()}},C.prototype._onClose=function(){this.remove()},C}(I.Evented),Yc={version:I.version,supported:Et,setRTLTextPlugin:I.setRTLTextPlugin,getRTLTextPluginStatus:I.getRTLTextPluginStatus,Map:ip,NavigationControl:ul,GeolocateControl:wd,AttributionControl:ol,ScaleControl:Ic,FullscreenControl:zl,Popup:zp,Marker:Wf,Style:Fu,LngLat:I.LngLat,LngLatBounds:I.LngLatBounds,Point:I.Point,MercatorCoordinate:I.MercatorCoordinate,Evented:I.Evented,config:I.config,prewarm:function(){Kr().acquire(Qr)},clearPrewarmedResources:function(){var x=bi;x&&(x.isPreloaded()&&x.numActive()===1?(x.release(Qr),bi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return I.config.ACCESS_TOKEN},set accessToken(x){I.config.ACCESS_TOKEN=x},get baseApiUrl(){return I.config.API_URL},set baseApiUrl(x){I.config.API_URL=x},get workerCount(){return Mn.workerCount},set workerCount(x){Mn.workerCount=x},get maxParallelImageRequests(){return I.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(x){I.config.MAX_PARALLEL_IMAGE_REQUESTS=x},clearStorage:function(x){I.clearTileCache(x)},workerUrl:""};return Yc}),Lt})},3614:function(vn,Ft,ot){"use strict";vn.exports=wt;var Lt=ot(80645);function wt(gt){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(gt)?gt:new Uint8Array(gt||0),this.pos=0,this.type=0,this.length=this.buf.length}wt.Varint=0,wt.Fixed64=1,wt.Bytes=2,wt.Fixed32=5;var I=(1<<16)*(1<<16),Et=1/I,q=12,lt=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");wt.prototype={destroy:function(){this.buf=null},readFields:function(gt,Pt,J){for(J=J||this.length;this.pos<J;){var vt=this.readVarint(),W=vt>>3,dt=this.pos;this.type=vt&7,gt(W,Pt,this),this.pos===dt&&this.skip(vt)}return Pt},readMessage:function(gt,Pt){return this.readFields(gt,Pt,this.readVarint()+this.pos)},readFixed32:function(){var gt=Ae(this.buf,this.pos);return this.pos+=4,gt},readSFixed32:function(){var gt=me(this.buf,this.pos);return this.pos+=4,gt},readFixed64:function(){var gt=Ae(this.buf,this.pos)+Ae(this.buf,this.pos+4)*I;return this.pos+=8,gt},readSFixed64:function(){var gt=Ae(this.buf,this.pos)+me(this.buf,this.pos+4)*I;return this.pos+=8,gt},readFloat:function(){var gt=Lt.read(this.buf,this.pos,!0,23,4);return this.pos+=4,gt},readDouble:function(){var gt=Lt.read(this.buf,this.pos,!0,52,8);return this.pos+=8,gt},readVarint:function(gt){var Pt=this.buf,J,vt;return vt=Pt[this.pos++],J=vt&127,vt<128||(vt=Pt[this.pos++],J|=(vt&127)<<7,vt<128)||(vt=Pt[this.pos++],J|=(vt&127)<<14,vt<128)||(vt=Pt[this.pos++],J|=(vt&127)<<21,vt<128)?J:(vt=Pt[this.pos],J|=(vt&15)<<28,ht(J,gt,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var gt=this.readVarint();return gt%2===1?(gt+1)/-2:gt/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var gt=this.readVarint()+this.pos,Pt=this.pos;return this.pos=gt,gt-Pt>=q&&lt?we(this.buf,Pt,gt):ee(this.buf,Pt,gt)},readBytes:function(){var gt=this.readVarint()+this.pos,Pt=this.buf.subarray(this.pos,gt);return this.pos=gt,Pt},readPackedVarint:function(gt,Pt){if(this.type!==wt.Bytes)return gt.push(this.readVarint(Pt));var J=ct(this);for(gt=gt||[];this.pos<J;)gt.push(this.readVarint(Pt));return gt},readPackedSVarint:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readSVarint());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readSVarint());return gt},readPackedBoolean:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readBoolean());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readBoolean());return gt},readPackedFloat:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readFloat());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readFloat());return gt},readPackedDouble:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readDouble());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readDouble());return gt},readPackedFixed32:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readFixed32());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readFixed32());return gt},readPackedSFixed32:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readSFixed32());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readSFixed32());return gt},readPackedFixed64:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readFixed64());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readFixed64());return gt},readPackedSFixed64:function(gt){if(this.type!==wt.Bytes)return gt.push(this.readSFixed64());var Pt=ct(this);for(gt=gt||[];this.pos<Pt;)gt.push(this.readSFixed64());return gt},skip:function(gt){var Pt=gt&7;if(Pt===wt.Varint)for(;this.buf[this.pos++]>127;);else if(Pt===wt.Bytes)this.pos=this.readVarint()+this.pos;else if(Pt===wt.Fixed32)this.pos+=4;else if(Pt===wt.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+Pt)},writeTag:function(gt,Pt){this.writeVarint(gt<<3|Pt)},realloc:function(gt){for(var Pt=this.length||16;Pt<this.pos+gt;)Pt*=2;if(Pt!==this.length){var J=new Uint8Array(Pt);J.set(this.buf),this.buf=J,this.length=Pt}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(gt){this.realloc(4),be(this.buf,gt,this.pos),this.pos+=4},writeSFixed32:function(gt){this.realloc(4),be(this.buf,gt,this.pos),this.pos+=4},writeFixed64:function(gt){this.realloc(8),be(this.buf,gt&-1,this.pos),be(this.buf,Math.floor(gt*Et),this.pos+4),this.pos+=8},writeSFixed64:function(gt){this.realloc(8),be(this.buf,gt&-1,this.pos),be(this.buf,Math.floor(gt*Et),this.pos+4),this.pos+=8},writeVarint:function(gt){if(gt=+gt||0,gt>268435455||gt<0){Ee(gt,this);return}this.realloc(4),this.buf[this.pos++]=gt&127|(gt>127?128:0),!(gt<=127)&&(this.buf[this.pos++]=(gt>>>=7)&127|(gt>127?128:0),!(gt<=127)&&(this.buf[this.pos++]=(gt>>>=7)&127|(gt>127?128:0),!(gt<=127)&&(this.buf[this.pos++]=gt>>>7&127)))},writeSVarint:function(gt){this.writeVarint(gt<0?-gt*2-1:gt*2)},writeBoolean:function(gt){this.writeVarint(Boolean(gt))},writeString:function(gt){gt=String(gt),this.realloc(gt.length*4),this.pos++;var Pt=this.pos;this.pos=_e(this.buf,gt,this.pos);var J=this.pos-Pt;J>=128&&Zt(Pt,J,this),this.pos=Pt-1,this.writeVarint(J),this.pos+=J},writeFloat:function(gt){this.realloc(4),Lt.write(this.buf,gt,this.pos,!0,23,4),this.pos+=4},writeDouble:function(gt){this.realloc(8),Lt.write(this.buf,gt,this.pos,!0,52,8),this.pos+=8},writeBytes:function(gt){var Pt=gt.length;this.writeVarint(Pt),this.realloc(Pt);for(var J=0;J<Pt;J++)this.buf[this.pos++]=gt[J]},writeRawMessage:function(gt,Pt){this.pos++;var J=this.pos;gt(Pt,this);var vt=this.pos-J;vt>=128&&Zt(J,vt,this),this.pos=J-1,this.writeVarint(vt),this.pos+=vt},writeMessage:function(gt,Pt,J){this.writeTag(gt,wt.Bytes),this.writeRawMessage(Pt,J)},writePackedVarint:function(gt,Pt){Pt.length&&this.writeMessage(gt,P,Pt)},writePackedSVarint:function(gt,Pt){Pt.length&&this.writeMessage(gt,b,Pt)},writePackedBoolean:function(gt,Pt){Pt.length&&this.writeMessage(gt,Se,Pt)},writePackedFloat:function(gt,Pt){Pt.length&&this.writeMessage(gt,X,Pt)},writePackedDouble:function(gt,Pt){Pt.length&&this.writeMessage(gt,le,Pt)},writePackedFixed32:function(gt,Pt){Pt.length&&this.writeMessage(gt,Ie,Pt)},writePackedSFixed32:function(gt,Pt){Pt.length&&this.writeMessage(gt,It,Pt)},writePackedFixed64:function(gt,Pt){Pt.length&&this.writeMessage(gt,rt,Pt)},writePackedSFixed64:function(gt,Pt){Pt.length&&this.writeMessage(gt,Dt,Pt)},writeBytesField:function(gt,Pt){this.writeTag(gt,wt.Bytes),this.writeBytes(Pt)},writeFixed32Field:function(gt,Pt){this.writeTag(gt,wt.Fixed32),this.writeFixed32(Pt)},writeSFixed32Field:function(gt,Pt){this.writeTag(gt,wt.Fixed32),this.writeSFixed32(Pt)},writeFixed64Field:function(gt,Pt){this.writeTag(gt,wt.Fixed64),this.writeFixed64(Pt)},writeSFixed64Field:function(gt,Pt){this.writeTag(gt,wt.Fixed64),this.writeSFixed64(Pt)},writeVarintField:function(gt,Pt){this.writeTag(gt,wt.Varint),this.writeVarint(Pt)},writeSVarintField:function(gt,Pt){this.writeTag(gt,wt.Varint),this.writeSVarint(Pt)},writeStringField:function(gt,Pt){this.writeTag(gt,wt.Bytes),this.writeString(Pt)},writeFloatField:function(gt,Pt){this.writeTag(gt,wt.Fixed32),this.writeFloat(Pt)},writeDoubleField:function(gt,Pt){this.writeTag(gt,wt.Fixed64),this.writeDouble(Pt)},writeBooleanField:function(gt,Pt){this.writeVarintField(gt,Boolean(Pt))}};function ht(gt,Pt,J){var vt=J.buf,W,dt;if(dt=vt[J.pos++],W=(dt&112)>>4,dt<128||(dt=vt[J.pos++],W|=(dt&127)<<3,dt<128)||(dt=vt[J.pos++],W|=(dt&127)<<10,dt<128)||(dt=vt[J.pos++],W|=(dt&127)<<17,dt<128)||(dt=vt[J.pos++],W|=(dt&127)<<24,dt<128)||(dt=vt[J.pos++],W|=(dt&1)<<31,dt<128))return et(gt,W,Pt);throw new Error("Expected varint not more than 10 bytes")}function ct(gt){return gt.type===wt.Bytes?gt.readVarint()+gt.pos:gt.pos+1}function et(gt,Pt,J){return J?Pt*4294967296+(gt>>>0):(Pt>>>0)*4294967296+(gt>>>0)}function Ee(gt,Pt){var J,vt;if(gt>=0?(J=gt%4294967296|0,vt=gt/4294967296|0):(J=~(-gt%4294967296),vt=~(-gt/4294967296),J^4294967295?J=J+1|0:(J=0,vt=vt+1|0)),gt>=18446744073709552e3||gt<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Pt.realloc(10),it(J,vt,Pt),st(vt,Pt)}function it(gt,Pt,J){J.buf[J.pos++]=gt&127|128,gt>>>=7,J.buf[J.pos++]=gt&127|128,gt>>>=7,J.buf[J.pos++]=gt&127|128,gt>>>=7,J.buf[J.pos++]=gt&127|128,gt>>>=7,J.buf[J.pos]=gt&127}function st(gt,Pt){var J=(gt&7)<<4;Pt.buf[Pt.pos++]|=J|((gt>>>=3)?128:0),gt&&(Pt.buf[Pt.pos++]=gt&127|((gt>>>=7)?128:0),gt&&(Pt.buf[Pt.pos++]=gt&127|((gt>>>=7)?128:0),gt&&(Pt.buf[Pt.pos++]=gt&127|((gt>>>=7)?128:0),gt&&(Pt.buf[Pt.pos++]=gt&127|((gt>>>=7)?128:0),gt&&(Pt.buf[Pt.pos++]=gt&127)))))}function Zt(gt,Pt,J){var vt=Pt<=16383?1:Pt<=2097151?2:Pt<=268435455?3:Math.floor(Math.log(Pt)/(Math.LN2*7));J.realloc(vt);for(var W=J.pos-1;W>=gt;W--)J.buf[W+vt]=J.buf[W]}function P(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeVarint(gt[J])}function b(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeSVarint(gt[J])}function X(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeFloat(gt[J])}function le(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeDouble(gt[J])}function Se(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeBoolean(gt[J])}function Ie(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeFixed32(gt[J])}function It(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeSFixed32(gt[J])}function rt(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeFixed64(gt[J])}function Dt(gt,Pt){for(var J=0;J<gt.length;J++)Pt.writeSFixed64(gt[J])}function Ae(gt,Pt){return(gt[Pt]|gt[Pt+1]<<8|gt[Pt+2]<<16)+gt[Pt+3]*16777216}function be(gt,Pt,J){gt[J]=Pt,gt[J+1]=Pt>>>8,gt[J+2]=Pt>>>16,gt[J+3]=Pt>>>24}function me(gt,Pt){return(gt[Pt]|gt[Pt+1]<<8|gt[Pt+2]<<16)+(gt[Pt+3]<<24)}function ee(gt,Pt,J){for(var vt="",W=Pt;W<J;){var dt=gt[W],Vt=null,ne=dt>239?4:dt>223?3:dt>191?2:1;if(W+ne>J)break;var ge,$e,jt;ne===1?dt<128&&(Vt=dt):ne===2?(ge=gt[W+1],(ge&192)===128&&(Vt=(dt&31)<<6|ge&63,Vt<=127&&(Vt=null))):ne===3?(ge=gt[W+1],$e=gt[W+2],(ge&192)===128&&($e&192)===128&&(Vt=(dt&15)<<12|(ge&63)<<6|$e&63,(Vt<=2047||Vt>=55296&&Vt<=57343)&&(Vt=null))):ne===4&&(ge=gt[W+1],$e=gt[W+2],jt=gt[W+3],(ge&192)===128&&($e&192)===128&&(jt&192)===128&&(Vt=(dt&15)<<18|(ge&63)<<12|($e&63)<<6|jt&63,(Vt<=65535||Vt>=1114112)&&(Vt=null))),Vt===null?(Vt=65533,ne=1):Vt>65535&&(Vt-=65536,vt+=String.fromCharCode(Vt>>>10&1023|55296),Vt=56320|Vt&1023),vt+=String.fromCharCode(Vt),W+=ne}return vt}function we(gt,Pt,J){return lt.decode(gt.subarray(Pt,J))}function _e(gt,Pt,J){for(var vt=0,W,dt;vt<Pt.length;vt++){if(W=Pt.charCodeAt(vt),W>55295&&W<57344)if(dt)if(W<56320){gt[J++]=239,gt[J++]=191,gt[J++]=189,dt=W;continue}else W=dt-55296<<10|W-56320|65536,dt=null;else{W>56319||vt+1===Pt.length?(gt[J++]=239,gt[J++]=191,gt[J++]=189):dt=W;continue}else dt&&(gt[J++]=239,gt[J++]=191,gt[J++]=189,dt=null);W<128?gt[J++]=W:(W<2048?gt[J++]=W>>6|192:(W<65536?gt[J++]=W>>12|224:(gt[J++]=W>>18|240,gt[J++]=W>>12&63|128),gt[J++]=W>>6&63|128),gt[J++]=W&63|128)}return J}},73807:function(vn){"use strict";var Ft=vn.exports;vn.exports.isNumber=function(ot){return typeof ot=="number"},vn.exports.findMin=function(ot){if(ot.length===0)return 1/0;for(var Lt=ot[0],wt=1;wt<ot.length;wt++)Lt=Math.min(Lt,ot[wt]);return Lt},vn.exports.findMax=function(ot){if(ot.length===0)return-1/0;for(var Lt=ot[0],wt=1;wt<ot.length;wt++)Lt=Math.max(Lt,ot[wt]);return Lt},vn.exports.findMinMulti=function(ot){for(var Lt=Ft.findMin(ot[0]),wt=1;wt<ot.length;wt++)Lt=Math.min(Lt,Ft.findMin(ot[wt]));return Lt},vn.exports.findMaxMulti=function(ot){for(var Lt=Ft.findMax(ot[0]),wt=1;wt<ot.length;wt++)Lt=Math.max(Lt,Ft.findMax(ot[wt]));return Lt},vn.exports.inside=function(ot,Lt,wt){return ot<=wt&&wt<=Lt}},53843:function(vn,Ft,ot){"use strict";var Lt=50,wt=2,I=Math.log(2),Et=vn.exports,q=ot(73807);function lt(ct){return 1-Math.abs(ct)}vn.exports.getUnifiedMinMax=function(ct,et){return Et.getUnifiedMinMaxMulti([ct],et)},vn.exports.getUnifiedMinMaxMulti=function(ct,et){et=et||{};var Ee=!1,it=!1,st=q.isNumber(et.width)?et.width:wt,Zt=q.isNumber(et.size)?et.size:Lt,P=q.isNumber(et.min)?et.min:(Ee=!0,q.findMinMulti(ct)),b=q.isNumber(et.max)?et.max:(it=!0,q.findMaxMulti(ct)),X=b-P,le=X/(Zt-1);return Ee&&(P=P-2*st*le),it&&(b=b+2*st*le),{min:P,max:b}},vn.exports.create=function(ct,et){if(et=et||{},!ct||ct.length===0)return[];var Ee=q.isNumber(et.size)?et.size:Lt,it=q.isNumber(et.width)?et.width:wt,st=Et.getUnifiedMinMax(ct,{size:Ee,width:it,min:et.min,max:et.max}),Zt=st.min,P=st.max,b=P-Zt,X=b/(Ee-1);if(b===0)return[{x:Zt,y:1}];for(var le=[],Se=0;Se<Ee;Se++)le.push({x:Zt+Se*X,y:0});var Ie=function(we){return Math.floor((we-Zt)/X)},It=ht(lt,it),rt=It[it],Dt=It[it-1]-It[it-2],Ae=0;ct.forEach(function(we){var _e=Ie(we);if(!(_e+it<0||_e-it>=le.length)){var gt=Math.max(_e-it,0),Pt=_e,J=Math.min(_e+it,le.length-1),vt=gt-(_e-it),W=_e+it-J,dt=It[-it-1+vt]||0,Vt=It[-it-1+W]||0,ne=rt/(rt-dt-Vt);vt>0&&(Ae+=ne*(vt-1)*Dt);var ge=Math.max(0,_e-it+1);q.inside(0,le.length-1,ge)&&(le[ge].y+=ne*1*Dt),q.inside(0,le.length-1,Pt+1)&&(le[Pt+1].y-=ne*2*Dt),q.inside(0,le.length-1,J+1)&&(le[J+1].y+=ne*1*Dt)}});var be=Ae,me=0,ee=0;return le.forEach(function(we){me+=we.y,be+=me,we.y=be,ee+=be}),ee>0&&le.forEach(function(we){we.y/=ee}),le};function ht(ct,et){for(var Ee={},it=0,st=-et;st<=et;st++)it+=ct(st/et),Ee[st]=it;return Ee}vn.exports.getExpectedValueFromPdf=function(ct){if(!(!ct||ct.length===0)){var et=0;return ct.forEach(function(Ee){et+=Ee.x*Ee.y}),et}},vn.exports.getXWithLeftTailArea=function(ct,et){if(!(!ct||ct.length===0)){for(var Ee=0,it=0,st=0;st<ct.length&&(it=st,Ee+=ct[st].y,!(Ee>=et));st++);return ct[it].x}},vn.exports.getPerplexity=function(ct){if(!(!ct||ct.length===0)){var et=0;return ct.forEach(function(Ee){var it=Math.log(Ee.y);isFinite(it)&&(et+=Ee.y*it)}),et=-et/I,Math.pow(2,et)}}},32676:function(vn,Ft,ot){var Lt=ot(34155);(function(wt,I){vn.exports=I()})(this,function(){"use strict";function wt(zt,At){if(!(zt instanceof At))throw new TypeError("Cannot call a class as a function")}function I(zt,At){for(var Mt=0;Mt<At.length;Mt++){var Rt=At[Mt];Rt.enumerable=Rt.enumerable||!1,Rt.configurable=!0,"value"in Rt&&(Rt.writable=!0),Object.defineProperty(zt,Rt.key,Rt)}}function Et(zt,At,Mt){return At&&I(zt.prototype,At),Mt&&I(zt,Mt),zt}var q=function(){function zt(At,Mt){this.next=null,this.key=At,this.data=Mt,this.left=null,this.right=null}return zt}();function lt(zt,At){return zt>At?1:zt<At?-1:0}function ht(zt,At,Mt){for(var Rt=new q(null,null),tt=Rt,_t=Rt;;){var Xt=Mt(zt,At.key);if(Xt<0){if(At.left===null)break;if(Mt(zt,At.left.key)<0){var ve=At.left;if(At.left=ve.right,ve.right=At,At=ve,At.left===null)break}_t.left=At,_t=At,At=At.left}else if(Xt>0){if(At.right===null)break;if(Mt(zt,At.right.key)>0){var ve=At.right;if(At.right=ve.left,ve.left=At,At=ve,At.right===null)break}tt.right=At,tt=At,At=At.right}else break}return tt.right=At.left,_t.left=At.right,At.left=Rt.right,At.right=Rt.left,At}function ct(zt,At,Mt,Rt){var tt=new q(zt,At);if(Mt===null)return tt.left=tt.right=null,tt;Mt=ht(zt,Mt,Rt);var _t=Rt(zt,Mt.key);return _t<0?(tt.left=Mt.left,tt.right=Mt,Mt.left=null):_t>=0&&(tt.right=Mt.right,tt.left=Mt,Mt.right=null),tt}function et(zt,At,Mt){var Rt=null,tt=null;if(At){At=ht(zt,At,Mt);var _t=Mt(At.key,zt);_t===0?(Rt=At.left,tt=At.right):_t<0?(tt=At.right,At.right=null,Rt=At):(Rt=At.left,At.left=null,tt=At)}return{left:Rt,right:tt}}function Ee(zt,At,Mt){return At===null?zt:(zt===null||(At=ht(zt.key,At,Mt),At.left=zt),At)}function it(zt,At,Mt,Rt,tt){if(zt){Rt(""+At+(Mt?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+tt(zt)+`
`);var _t=At+(Mt?"    ":"\u2502   ");zt.left&&it(zt.left,_t,!1,Rt,tt),zt.right&&it(zt.right,_t,!0,Rt,tt)}}var st=function(){function zt(At){At===void 0&&(At=lt),this._root=null,this._size=0,this._comparator=At}return zt.prototype.insert=function(At,Mt){return this._size++,this._root=ct(At,Mt,this._root,this._comparator)},zt.prototype.add=function(At,Mt){var Rt=new q(At,Mt);this._root===null&&(Rt.left=Rt.right=null,this._size++,this._root=Rt);var tt=this._comparator,_t=ht(At,this._root,tt),Xt=tt(At,_t.key);return Xt===0?this._root=_t:(Xt<0?(Rt.left=_t.left,Rt.right=_t,_t.left=null):Xt>0&&(Rt.right=_t.right,Rt.left=_t,_t.right=null),this._size++,this._root=Rt),this._root},zt.prototype.remove=function(At){this._root=this._remove(At,this._root,this._comparator)},zt.prototype._remove=function(At,Mt,Rt){var tt;if(Mt===null)return null;Mt=ht(At,Mt,Rt);var _t=Rt(At,Mt.key);return _t===0?(Mt.left===null?tt=Mt.right:(tt=ht(At,Mt.left,Rt),tt.right=Mt.right),this._size--,tt):Mt},zt.prototype.pop=function(){var At=this._root;if(At){for(;At.left;)At=At.left;return this._root=ht(At.key,this._root,this._comparator),this._root=this._remove(At.key,this._root,this._comparator),{key:At.key,data:At.data}}return null},zt.prototype.findStatic=function(At){for(var Mt=this._root,Rt=this._comparator;Mt;){var tt=Rt(At,Mt.key);if(tt===0)return Mt;tt<0?Mt=Mt.left:Mt=Mt.right}return null},zt.prototype.find=function(At){return this._root&&(this._root=ht(At,this._root,this._comparator),this._comparator(At,this._root.key)!==0)?null:this._root},zt.prototype.contains=function(At){for(var Mt=this._root,Rt=this._comparator;Mt;){var tt=Rt(At,Mt.key);if(tt===0)return!0;tt<0?Mt=Mt.left:Mt=Mt.right}return!1},zt.prototype.forEach=function(At,Mt){for(var Rt=this._root,tt=[],_t=!1;!_t;)Rt!==null?(tt.push(Rt),Rt=Rt.left):tt.length!==0?(Rt=tt.pop(),At.call(Mt,Rt),Rt=Rt.right):_t=!0;return this},zt.prototype.range=function(At,Mt,Rt,tt){for(var _t=[],Xt=this._comparator,ve=this._root,Wt;_t.length!==0||ve;)if(ve)_t.push(ve),ve=ve.left;else{if(ve=_t.pop(),Wt=Xt(ve.key,Mt),Wt>0)break;if(Xt(ve.key,At)>=0&&Rt.call(tt,ve))return this;ve=ve.right}return this},zt.prototype.keys=function(){var At=[];return this.forEach(function(Mt){var Rt=Mt.key;return At.push(Rt)}),At},zt.prototype.values=function(){var At=[];return this.forEach(function(Mt){var Rt=Mt.data;return At.push(Rt)}),At},zt.prototype.min=function(){return this._root?this.minNode(this._root).key:null},zt.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},zt.prototype.minNode=function(At){if(At===void 0&&(At=this._root),At)for(;At.left;)At=At.left;return At},zt.prototype.maxNode=function(At){if(At===void 0&&(At=this._root),At)for(;At.right;)At=At.right;return At},zt.prototype.at=function(At){for(var Mt=this._root,Rt=!1,tt=0,_t=[];!Rt;)if(Mt)_t.push(Mt),Mt=Mt.left;else if(_t.length>0){if(Mt=_t.pop(),tt===At)return Mt;tt++,Mt=Mt.right}else Rt=!0;return null},zt.prototype.next=function(At){var Mt=this._root,Rt=null;if(At.right){for(Rt=At.right;Rt.left;)Rt=Rt.left;return Rt}for(var tt=this._comparator;Mt;){var _t=tt(At.key,Mt.key);if(_t===0)break;_t<0?(Rt=Mt,Mt=Mt.left):Mt=Mt.right}return Rt},zt.prototype.prev=function(At){var Mt=this._root,Rt=null;if(At.left!==null){for(Rt=At.left;Rt.right;)Rt=Rt.right;return Rt}for(var tt=this._comparator;Mt;){var _t=tt(At.key,Mt.key);if(_t===0)break;_t<0?Mt=Mt.left:(Rt=Mt,Mt=Mt.right)}return Rt},zt.prototype.clear=function(){return this._root=null,this._size=0,this},zt.prototype.toList=function(){return b(this._root)},zt.prototype.load=function(At,Mt,Rt){Mt===void 0&&(Mt=[]),Rt===void 0&&(Rt=!1);var tt=At.length,_t=this._comparator;if(Rt&&Se(At,Mt,0,tt-1,_t),this._root===null)this._root=Zt(At,Mt,0,tt),this._size=tt;else{var Xt=le(this.toList(),P(At,Mt),_t);tt=this._size+tt,this._root=X({head:Xt},0,tt)}return this},zt.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(zt.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(zt.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),zt.prototype.toString=function(At){At===void 0&&(At=function(tt){return String(tt.key)});var Mt=[];return it(this._root,"",!0,function(Rt){return Mt.push(Rt)},At),Mt.join("")},zt.prototype.update=function(At,Mt,Rt){var tt=this._comparator,_t=et(At,this._root,tt),Xt=_t.left,ve=_t.right;tt(At,Mt)<0?ve=ct(Mt,Rt,ve,tt):Xt=ct(Mt,Rt,Xt,tt),this._root=Ee(Xt,ve,tt)},zt.prototype.split=function(At){return et(At,this._root,this._comparator)},zt}();function Zt(zt,At,Mt,Rt){var tt=Rt-Mt;if(tt>0){var _t=Mt+Math.floor(tt/2),Xt=zt[_t],ve=At[_t],Wt=new q(Xt,ve);return Wt.left=Zt(zt,At,Mt,_t),Wt.right=Zt(zt,At,_t+1,Rt),Wt}return null}function P(zt,At){for(var Mt=new q(null,null),Rt=Mt,tt=0;tt<zt.length;tt++)Rt=Rt.next=new q(zt[tt],At[tt]);return Rt.next=null,Mt.next}function b(zt){for(var At=zt,Mt=[],Rt=!1,tt=new q(null,null),_t=tt;!Rt;)At?(Mt.push(At),At=At.left):Mt.length>0?(At=_t=_t.next=Mt.pop(),At=At.right):Rt=!0;return _t.next=null,tt.next}function X(zt,At,Mt){var Rt=Mt-At;if(Rt>0){var tt=At+Math.floor(Rt/2),_t=X(zt,At,tt),Xt=zt.head;return Xt.left=_t,zt.head=zt.head.next,Xt.right=X(zt,tt+1,Mt),Xt}return null}function le(zt,At,Mt){for(var Rt=new q(null,null),tt=Rt,_t=zt,Xt=At;_t!==null&&Xt!==null;)Mt(_t.key,Xt.key)<0?(tt.next=_t,_t=_t.next):(tt.next=Xt,Xt=Xt.next),tt=tt.next;return _t!==null?tt.next=_t:Xt!==null&&(tt.next=Xt),Rt.next}function Se(zt,At,Mt,Rt,tt){if(!(Mt>=Rt)){for(var _t=zt[Mt+Rt>>1],Xt=Mt-1,ve=Rt+1;;){do Xt++;while(tt(zt[Xt],_t)<0);do ve--;while(tt(zt[ve],_t)>0);if(Xt>=ve)break;var Wt=zt[Xt];zt[Xt]=zt[ve],zt[ve]=Wt,Wt=At[Xt],At[Xt]=At[ve],At[ve]=Wt}Se(zt,At,Mt,ve,tt),Se(zt,At,ve+1,Rt,tt)}}var Ie=function(At,Mt){return At.ll.x<=Mt.x&&Mt.x<=At.ur.x&&At.ll.y<=Mt.y&&Mt.y<=At.ur.y},It=function(At,Mt){if(Mt.ur.x<At.ll.x||At.ur.x<Mt.ll.x||Mt.ur.y<At.ll.y||At.ur.y<Mt.ll.y)return null;var Rt=At.ll.x<Mt.ll.x?Mt.ll.x:At.ll.x,tt=At.ur.x<Mt.ur.x?At.ur.x:Mt.ur.x,_t=At.ll.y<Mt.ll.y?Mt.ll.y:At.ll.y,Xt=At.ur.y<Mt.ur.y?At.ur.y:Mt.ur.y;return{ll:{x:Rt,y:_t},ur:{x:tt,y:Xt}}},rt=Number.EPSILON;rt===void 0&&(rt=Math.pow(2,-52));var Dt=rt*rt,Ae=function(At,Mt){if(-rt<At&&At<rt&&-rt<Mt&&Mt<rt)return 0;var Rt=At-Mt;return Rt*Rt<Dt*At*Mt?0:At<Mt?-1:1},be=function(){function zt(){wt(this,zt),this.reset()}return Et(zt,[{key:"reset",value:function(){this.xRounder=new me,this.yRounder=new me}},{key:"round",value:function(Mt,Rt){return{x:this.xRounder.round(Mt),y:this.yRounder.round(Rt)}}}]),zt}(),me=function(){function zt(){wt(this,zt),this.tree=new st,this.round(0)}return Et(zt,[{key:"round",value:function(Mt){var Rt=this.tree.add(Mt),tt=this.tree.prev(Rt);if(tt!==null&&Ae(Rt.key,tt.key)===0)return this.tree.remove(Mt),tt.key;var _t=this.tree.next(Rt);return _t!==null&&Ae(Rt.key,_t.key)===0?(this.tree.remove(Mt),_t.key):Mt}}]),zt}(),ee=new be,we=function(At,Mt){return At.x*Mt.y-At.y*Mt.x},_e=function(At,Mt){return At.x*Mt.x+At.y*Mt.y},gt=function(At,Mt,Rt){var tt={x:Mt.x-At.x,y:Mt.y-At.y},_t={x:Rt.x-At.x,y:Rt.y-At.y},Xt=we(tt,_t);return Ae(Xt,0)},Pt=function(At){return Math.sqrt(_e(At,At))},J=function(At,Mt,Rt){var tt={x:Mt.x-At.x,y:Mt.y-At.y},_t={x:Rt.x-At.x,y:Rt.y-At.y};return we(_t,tt)/Pt(_t)/Pt(tt)},vt=function(At,Mt,Rt){var tt={x:Mt.x-At.x,y:Mt.y-At.y},_t={x:Rt.x-At.x,y:Rt.y-At.y};return _e(_t,tt)/Pt(_t)/Pt(tt)},W=function(At,Mt,Rt){return Mt.y===0?null:{x:At.x+Mt.x/Mt.y*(Rt-At.y),y:Rt}},dt=function(At,Mt,Rt){return Mt.x===0?null:{x:Rt,y:At.y+Mt.y/Mt.x*(Rt-At.x)}},Vt=function(At,Mt,Rt,tt){if(Mt.x===0)return dt(Rt,tt,At.x);if(tt.x===0)return dt(At,Mt,Rt.x);if(Mt.y===0)return W(Rt,tt,At.y);if(tt.y===0)return W(At,Mt,Rt.y);var _t=we(Mt,tt);if(_t==0)return null;var Xt={x:Rt.x-At.x,y:Rt.y-At.y},ve=we(Xt,Mt)/_t,Wt=we(Xt,tt)/_t,Me=At.x+Wt*Mt.x,je=Rt.x+ve*tt.x,Qe=At.y+Wt*Mt.y,hr=Rt.y+ve*tt.y,er=(Me+je)/2,Br=(Qe+hr)/2;return{x:er,y:Br}},ne=function(){Et(zt,null,[{key:"compare",value:function(Mt,Rt){var tt=zt.comparePoints(Mt.point,Rt.point);return tt!==0?tt:(Mt.point!==Rt.point&&Mt.link(Rt),Mt.isLeft!==Rt.isLeft?Mt.isLeft?1:-1:$e.compare(Mt.segment,Rt.segment))}},{key:"comparePoints",value:function(Mt,Rt){return Mt.x<Rt.x?-1:Mt.x>Rt.x?1:Mt.y<Rt.y?-1:Mt.y>Rt.y?1:0}}]);function zt(At,Mt){wt(this,zt),At.events===void 0?At.events=[this]:At.events.push(this),this.point=At,this.isLeft=Mt}return Et(zt,[{key:"link",value:function(Mt){if(Mt.point===this.point)throw new Error("Tried to link already linked events");for(var Rt=Mt.point.events,tt=0,_t=Rt.length;tt<_t;tt++){var Xt=Rt[tt];this.point.events.push(Xt),Xt.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var Mt=this.point.events.length,Rt=0;Rt<Mt;Rt++){var tt=this.point.events[Rt];if(tt.segment.consumedBy===void 0)for(var _t=Rt+1;_t<Mt;_t++){var Xt=this.point.events[_t];Xt.consumedBy===void 0&&tt.otherSE.point.events===Xt.otherSE.point.events&&tt.segment.consume(Xt.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var Mt=[],Rt=0,tt=this.point.events.length;Rt<tt;Rt++){var _t=this.point.events[Rt];_t!==this&&!_t.segment.ringOut&&_t.segment.isInResult()&&Mt.push(_t)}return Mt}},{key:"getLeftmostComparator",value:function(Mt){var Rt=this,tt=new Map,_t=function(ve){var Wt=ve.otherSE;tt.set(ve,{sine:J(Rt.point,Mt.point,Wt.point),cosine:vt(Rt.point,Mt.point,Wt.point)})};return function(Xt,ve){tt.has(Xt)||_t(Xt),tt.has(ve)||_t(ve);var Wt=tt.get(Xt),Me=Wt.sine,je=Wt.cosine,Qe=tt.get(ve),hr=Qe.sine,er=Qe.cosine;return Me>=0&&hr>=0?je<er?1:je>er?-1:0:Me<0&&hr<0?je<er?-1:je>er?1:0:hr<Me?-1:hr>Me?1:0}}}]),zt}(),ge=0,$e=function(){Et(zt,null,[{key:"compare",value:function(Mt,Rt){var tt=Mt.leftSE.point.x,_t=Rt.leftSE.point.x,Xt=Mt.rightSE.point.x,ve=Rt.rightSE.point.x;if(ve<tt)return 1;if(Xt<_t)return-1;var Wt=Mt.leftSE.point.y,Me=Rt.leftSE.point.y,je=Mt.rightSE.point.y,Qe=Rt.rightSE.point.y;if(tt<_t){if(Me<Wt&&Me<je)return 1;if(Me>Wt&&Me>je)return-1;var hr=Mt.comparePoint(Rt.leftSE.point);if(hr<0)return 1;if(hr>0)return-1;var er=Rt.comparePoint(Mt.rightSE.point);return er!==0?er:-1}if(tt>_t){if(Wt<Me&&Wt<Qe)return-1;if(Wt>Me&&Wt>Qe)return 1;var Br=Rt.comparePoint(Mt.leftSE.point);if(Br!==0)return Br;var Lr=Mt.comparePoint(Rt.rightSE.point);return Lr<0?1:Lr>0?-1:1}if(Wt<Me)return-1;if(Wt>Me)return 1;if(Xt<ve){var Zr=Rt.comparePoint(Mt.rightSE.point);if(Zr!==0)return Zr}if(Xt>ve){var Tn=Mt.comparePoint(Rt.rightSE.point);if(Tn<0)return 1;if(Tn>0)return-1}if(Xt!==ve){var rn=je-Wt,Nn=Xt-tt,zn=Qe-Me,jn=ve-_t;if(rn>Nn&&zn<jn)return 1;if(rn<Nn&&zn>jn)return-1}return Xt>ve?1:Xt<ve||je<Qe?-1:je>Qe?1:Mt.id<Rt.id?-1:Mt.id>Rt.id?1:0}}]);function zt(At,Mt,Rt,tt){wt(this,zt),this.id=++ge,this.leftSE=At,At.segment=this,At.otherSE=Mt,this.rightSE=Mt,Mt.segment=this,Mt.otherSE=At,this.rings=Rt,this.windings=tt}return Et(zt,[{key:"replaceRightSE",value:function(Mt){this.rightSE=Mt,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var Mt=this.leftSE.point.y,Rt=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:Mt<Rt?Mt:Rt},ur:{x:this.rightSE.point.x,y:Mt>Rt?Mt:Rt}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(Mt){return Mt.x===this.leftSE.point.x&&Mt.y===this.leftSE.point.y||Mt.x===this.rightSE.point.x&&Mt.y===this.rightSE.point.y}},{key:"comparePoint",value:function(Mt){if(this.isAnEndpoint(Mt))return 0;var Rt=this.leftSE.point,tt=this.rightSE.point,_t=this.vector();if(Rt.x===tt.x)return Mt.x===Rt.x?0:Mt.x<Rt.x?1:-1;var Xt=(Mt.y-Rt.y)/_t.y,ve=Rt.x+Xt*_t.x;if(Mt.x===ve)return 0;var Wt=(Mt.x-Rt.x)/_t.x,Me=Rt.y+Wt*_t.y;return Mt.y===Me?0:Mt.y<Me?-1:1}},{key:"getIntersection",value:function(Mt){var Rt=this.bbox(),tt=Mt.bbox(),_t=It(Rt,tt);if(_t===null)return null;var Xt=this.leftSE.point,ve=this.rightSE.point,Wt=Mt.leftSE.point,Me=Mt.rightSE.point,je=Ie(Rt,Wt)&&this.comparePoint(Wt)===0,Qe=Ie(tt,Xt)&&Mt.comparePoint(Xt)===0,hr=Ie(Rt,Me)&&this.comparePoint(Me)===0,er=Ie(tt,ve)&&Mt.comparePoint(ve)===0;if(Qe&&je)return er&&!hr?ve:!er&&hr?Me:null;if(Qe)return hr&&Xt.x===Me.x&&Xt.y===Me.y?null:Xt;if(je)return er&&ve.x===Wt.x&&ve.y===Wt.y?null:Wt;if(er&&hr)return null;if(er)return ve;if(hr)return Me;var Br=Vt(Xt,this.vector(),Wt,Mt.vector());return Br===null||!Ie(_t,Br)?null:ee.round(Br.x,Br.y)}},{key:"split",value:function(Mt){var Rt=[],tt=Mt.events!==void 0,_t=new ne(Mt,!0),Xt=new ne(Mt,!1),ve=this.rightSE;this.replaceRightSE(Xt),Rt.push(Xt),Rt.push(_t);var Wt=new zt(_t,ve,this.rings.slice(),this.windings.slice());return ne.comparePoints(Wt.leftSE.point,Wt.rightSE.point)>0&&Wt.swapEvents(),ne.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),tt&&(_t.checkForConsuming(),Xt.checkForConsuming()),Rt}},{key:"swapEvents",value:function(){var Mt=this.rightSE;this.rightSE=this.leftSE,this.leftSE=Mt,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var Rt=0,tt=this.windings.length;Rt<tt;Rt++)this.windings[Rt]*=-1}},{key:"consume",value:function(Mt){for(var Rt=this,tt=Mt;Rt.consumedBy;)Rt=Rt.consumedBy;for(;tt.consumedBy;)tt=tt.consumedBy;var _t=zt.compare(Rt,tt);if(_t!==0){if(_t>0){var Xt=Rt;Rt=tt,tt=Xt}if(Rt.prev===tt){var ve=Rt;Rt=tt,tt=ve}for(var Wt=0,Me=tt.rings.length;Wt<Me;Wt++){var je=tt.rings[Wt],Qe=tt.windings[Wt],hr=Rt.rings.indexOf(je);hr===-1?(Rt.rings.push(je),Rt.windings.push(Qe)):Rt.windings[hr]+=Qe}tt.rings=null,tt.windings=null,tt.consumedBy=Rt,tt.leftSE.consumedBy=Rt.leftSE,tt.rightSE.consumedBy=Rt.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var Mt=this.prev.consumedBy||this.prev;this._beforeState=Mt.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var Mt=this.beforeState();this._afterState={rings:Mt.rings.slice(0),windings:Mt.windings.slice(0),multiPolys:[]};for(var Rt=this._afterState.rings,tt=this._afterState.windings,_t=this._afterState.multiPolys,Xt=0,ve=this.rings.length;Xt<ve;Xt++){var Wt=this.rings[Xt],Me=this.windings[Xt],je=Rt.indexOf(Wt);je===-1?(Rt.push(Wt),tt.push(Me)):tt[je]+=Me}for(var Qe=[],hr=[],er=0,Br=Rt.length;er<Br;er++)if(tt[er]!==0){var Lr=Rt[er],Zr=Lr.poly;if(hr.indexOf(Zr)===-1)if(Lr.isExterior)Qe.push(Zr);else{hr.indexOf(Zr)===-1&&hr.push(Zr);var Tn=Qe.indexOf(Lr.poly);Tn!==-1&&Qe.splice(Tn,1)}}for(var rn=0,Nn=Qe.length;rn<Nn;rn++){var zn=Qe[rn].multiPoly;_t.indexOf(zn)===-1&&_t.push(zn)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var Mt=this.beforeState().multiPolys,Rt=this.afterState().multiPolys;switch($t.type){case"union":{var tt=Mt.length===0,_t=Rt.length===0;this._isInResult=tt!==_t;break}case"intersection":{var Xt,ve;Mt.length<Rt.length?(Xt=Mt.length,ve=Rt.length):(Xt=Rt.length,ve=Mt.length),this._isInResult=ve===$t.numMultiPolys&&Xt<ve;break}case"xor":{var Wt=Math.abs(Mt.length-Rt.length);this._isInResult=Wt%2===1;break}case"difference":{var Me=function(Qe){return Qe.length===1&&Qe[0].isSubject};this._isInResult=Me(Mt)!==Me(Rt);break}default:throw new Error("Unrecognized operation type found ".concat($t.type))}return this._isInResult}}],[{key:"fromRing",value:function(Mt,Rt,tt){var _t,Xt,ve,Wt=ne.comparePoints(Mt,Rt);if(Wt<0)_t=Mt,Xt=Rt,ve=1;else if(Wt>0)_t=Rt,Xt=Mt,ve=-1;else throw new Error("Tried to create degenerate segment at [".concat(Mt.x,", ").concat(Mt.y,"]"));var Me=new ne(_t,!0),je=new ne(Xt,!1);return new zt(Me,je,[tt],[ve])}}]),zt}(),jt=function(){function zt(At,Mt,Rt){if(wt(this,zt),!Array.isArray(At)||At.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=Mt,this.isExterior=Rt,this.segments=[],typeof At[0][0]!="number"||typeof At[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var tt=ee.round(At[0][0],At[0][1]);this.bbox={ll:{x:tt.x,y:tt.y},ur:{x:tt.x,y:tt.y}};for(var _t=tt,Xt=1,ve=At.length;Xt<ve;Xt++){if(typeof At[Xt][0]!="number"||typeof At[Xt][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var Wt=ee.round(At[Xt][0],At[Xt][1]);Wt.x===_t.x&&Wt.y===_t.y||(this.segments.push($e.fromRing(_t,Wt,this)),Wt.x<this.bbox.ll.x&&(this.bbox.ll.x=Wt.x),Wt.y<this.bbox.ll.y&&(this.bbox.ll.y=Wt.y),Wt.x>this.bbox.ur.x&&(this.bbox.ur.x=Wt.x),Wt.y>this.bbox.ur.y&&(this.bbox.ur.y=Wt.y),_t=Wt)}(tt.x!==_t.x||tt.y!==_t.y)&&this.segments.push($e.fromRing(_t,tt,this))}return Et(zt,[{key:"getSweepEvents",value:function(){for(var Mt=[],Rt=0,tt=this.segments.length;Rt<tt;Rt++){var _t=this.segments[Rt];Mt.push(_t.leftSE),Mt.push(_t.rightSE)}return Mt}}]),zt}(),Qt=function(){function zt(At,Mt){if(wt(this,zt),!Array.isArray(At))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new jt(At[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var Rt=1,tt=At.length;Rt<tt;Rt++){var _t=new jt(At[Rt],this,!1);_t.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=_t.bbox.ll.x),_t.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=_t.bbox.ll.y),_t.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=_t.bbox.ur.x),_t.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=_t.bbox.ur.y),this.interiorRings.push(_t)}this.multiPoly=Mt}return Et(zt,[{key:"getSweepEvents",value:function(){for(var Mt=this.exteriorRing.getSweepEvents(),Rt=0,tt=this.interiorRings.length;Rt<tt;Rt++)for(var _t=this.interiorRings[Rt].getSweepEvents(),Xt=0,ve=_t.length;Xt<ve;Xt++)Mt.push(_t[Xt]);return Mt}}]),zt}(),Te=function(){function zt(At,Mt){if(wt(this,zt),!Array.isArray(At))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof At[0][0][0]=="number"&&(At=[At])}catch(Xt){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var Rt=0,tt=At.length;Rt<tt;Rt++){var _t=new Qt(At[Rt],this);_t.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=_t.bbox.ll.x),_t.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=_t.bbox.ll.y),_t.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=_t.bbox.ur.x),_t.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=_t.bbox.ur.y),this.polys.push(_t)}this.isSubject=Mt}return Et(zt,[{key:"getSweepEvents",value:function(){for(var Mt=[],Rt=0,tt=this.polys.length;Rt<tt;Rt++)for(var _t=this.polys[Rt].getSweepEvents(),Xt=0,ve=_t.length;Xt<ve;Xt++)Mt.push(_t[Xt]);return Mt}}]),zt}(),ae=function(){Et(zt,null,[{key:"factory",value:function(Mt){for(var Rt=[],tt=0,_t=Mt.length;tt<_t;tt++){var Xt=Mt[tt];if(!(!Xt.isInResult()||Xt.ringOut)){for(var ve=null,Wt=Xt.leftSE,Me=Xt.rightSE,je=[Wt],Qe=Wt.point,hr=[];ve=Wt,Wt=Me,je.push(Wt),Wt.point!==Qe;)for(;;){var er=Wt.getAvailableLinkedEvents();if(er.length===0){var Br=je[0].point,Lr=je[je.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(Br.x,",")+" ".concat(Br.y,"]. Last matching segment found ends at")+" [".concat(Lr.x,", ").concat(Lr.y,"]."))}if(er.length===1){Me=er[0].otherSE;break}for(var Zr=null,Tn=0,rn=hr.length;Tn<rn;Tn++)if(hr[Tn].point===Wt.point){Zr=Tn;break}if(Zr!==null){var Nn=hr.splice(Zr)[0],zn=je.splice(Nn.index);zn.unshift(zn[0].otherSE),Rt.push(new zt(zn.reverse()));continue}hr.push({index:je.length,point:Wt.point});var jn=Wt.getLeftmostComparator(ve);Me=er.sort(jn)[0].otherSE;break}Rt.push(new zt(je))}}return Rt}}]);function zt(At){wt(this,zt),this.events=At;for(var Mt=0,Rt=At.length;Mt<Rt;Mt++)At[Mt].segment.ringOut=this;this.poly=null}return Et(zt,[{key:"getGeom",value:function(){for(var Mt=this.events[0].point,Rt=[Mt],tt=1,_t=this.events.length-1;tt<_t;tt++){var Xt=this.events[tt].point,ve=this.events[tt+1].point;gt(Xt,Mt,ve)!==0&&(Rt.push(Xt),Mt=Xt)}if(Rt.length===1)return null;var Wt=Rt[0],Me=Rt[1];gt(Wt,Mt,Me)===0&&Rt.shift(),Rt.push(Rt[0]);for(var je=this.isExteriorRing()?1:-1,Qe=this.isExteriorRing()?0:Rt.length-1,hr=this.isExteriorRing()?Rt.length:-1,er=[],Br=Qe;Br!=hr;Br+=je)er.push([Rt[Br].x,Rt[Br].y]);return er}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var Mt=this.enclosingRing();this._isExteriorRing=Mt?!Mt.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var Mt=this.events[0],Rt=1,tt=this.events.length;Rt<tt;Rt++){var _t=this.events[Rt];ne.compare(Mt,_t)>0&&(Mt=_t)}for(var Xt=Mt.segment.prevInResult(),ve=Xt?Xt.prevInResult():null;;){if(!Xt)return null;if(!ve)return Xt.ringOut;if(ve.ringOut!==Xt.ringOut)return ve.ringOut.enclosingRing()!==Xt.ringOut?Xt.ringOut:Xt.ringOut.enclosingRing();Xt=ve.prevInResult(),ve=Xt?Xt.prevInResult():null}}}]),zt}(),Ke=function(){function zt(At){wt(this,zt),this.exteriorRing=At,At.poly=this,this.interiorRings=[]}return Et(zt,[{key:"addInterior",value:function(Mt){this.interiorRings.push(Mt),Mt.poly=this}},{key:"getGeom",value:function(){var Mt=[this.exteriorRing.getGeom()];if(Mt[0]===null)return null;for(var Rt=0,tt=this.interiorRings.length;Rt<tt;Rt++){var _t=this.interiorRings[Rt].getGeom();_t!==null&&Mt.push(_t)}return Mt}}]),zt}(),or=function(){function zt(At){wt(this,zt),this.rings=At,this.polys=this._composePolys(At)}return Et(zt,[{key:"getGeom",value:function(){for(var Mt=[],Rt=0,tt=this.polys.length;Rt<tt;Rt++){var _t=this.polys[Rt].getGeom();_t!==null&&Mt.push(_t)}return Mt}},{key:"_composePolys",value:function(Mt){for(var Rt=[],tt=0,_t=Mt.length;tt<_t;tt++){var Xt=Mt[tt];if(!Xt.poly)if(Xt.isExteriorRing())Rt.push(new Ke(Xt));else{var ve=Xt.enclosingRing();ve.poly||Rt.push(new Ke(ve)),ve.poly.addInterior(Xt)}}return Rt}}]),zt}(),ie=function(){function zt(At){var Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$e.compare;wt(this,zt),this.queue=At,this.tree=new st(Mt),this.segments=[]}return Et(zt,[{key:"process",value:function(Mt){var Rt=Mt.segment,tt=[];if(Mt.consumedBy)return Mt.isLeft?this.queue.remove(Mt.otherSE):this.tree.remove(Rt),tt;var _t=Mt.isLeft?this.tree.insert(Rt):this.tree.find(Rt);if(!_t)throw new Error("Unable to find segment #".concat(Rt.id," ")+"[".concat(Rt.leftSE.point.x,", ").concat(Rt.leftSE.point.y,"] -> ")+"[".concat(Rt.rightSE.point.x,", ").concat(Rt.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var Xt=_t,ve=_t,Wt=void 0,Me=void 0;Wt===void 0;)Xt=this.tree.prev(Xt),Xt===null?Wt=null:Xt.key.consumedBy===void 0&&(Wt=Xt.key);for(;Me===void 0;)ve=this.tree.next(ve),ve===null?Me=null:ve.key.consumedBy===void 0&&(Me=ve.key);if(Mt.isLeft){var je=null;if(Wt){var Qe=Wt.getIntersection(Rt);if(Qe!==null&&(Rt.isAnEndpoint(Qe)||(je=Qe),!Wt.isAnEndpoint(Qe)))for(var hr=this._splitSafely(Wt,Qe),er=0,Br=hr.length;er<Br;er++)tt.push(hr[er])}var Lr=null;if(Me){var Zr=Me.getIntersection(Rt);if(Zr!==null&&(Rt.isAnEndpoint(Zr)||(Lr=Zr),!Me.isAnEndpoint(Zr)))for(var Tn=this._splitSafely(Me,Zr),rn=0,Nn=Tn.length;rn<Nn;rn++)tt.push(Tn[rn])}if(je!==null||Lr!==null){var zn=null;if(je===null)zn=Lr;else if(Lr===null)zn=je;else{var jn=ne.comparePoints(je,Lr);zn=jn<=0?je:Lr}this.queue.remove(Rt.rightSE),tt.push(Rt.rightSE);for(var wn=Rt.split(zn),Wn=0,Bt=wn.length;Wn<Bt;Wn++)tt.push(wn[Wn])}tt.length>0?(this.tree.remove(Rt),tt.push(Mt)):(this.segments.push(Rt),Rt.prev=Wt)}else{if(Wt&&Me){var Yt=Wt.getIntersection(Me);if(Yt!==null){if(!Wt.isAnEndpoint(Yt))for(var oe=this._splitSafely(Wt,Yt),Ce=0,Ue=oe.length;Ce<Ue;Ce++)tt.push(oe[Ce]);if(!Me.isAnEndpoint(Yt))for(var fr=this._splitSafely(Me,Yt),Sr=0,Pe=fr.length;Sr<Pe;Sr++)tt.push(fr[Sr])}}this.tree.remove(Rt)}return tt}},{key:"_splitSafely",value:function(Mt,Rt){this.tree.remove(Mt);var tt=Mt.rightSE;this.queue.remove(tt);var _t=Mt.split(Rt);return _t.push(tt),Mt.consumedBy===void 0&&this.tree.insert(Mt),_t}}]),zt}(),te=typeof Lt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,St=typeof Lt!="undefined"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,qt=function(){function zt(){wt(this,zt)}return Et(zt,[{key:"run",value:function(Mt,Rt,tt){$t.type=Mt,ee.reset();for(var _t=[new Te(Rt,!0)],Xt=0,ve=tt.length;Xt<ve;Xt++)_t.push(new Te(tt[Xt],!1));if($t.numMultiPolys=_t.length,$t.type==="difference")for(var Wt=_t[0],Me=1;Me<_t.length;)It(_t[Me].bbox,Wt.bbox)!==null?Me++:_t.splice(Me,1);if($t.type==="intersection"){for(var je=0,Qe=_t.length;je<Qe;je++)for(var hr=_t[je],er=je+1,Br=_t.length;er<Br;er++)if(It(hr.bbox,_t[er].bbox)===null)return[]}for(var Lr=new st(ne.compare),Zr=0,Tn=_t.length;Zr<Tn;Zr++)for(var rn=_t[Zr].getSweepEvents(),Nn=0,zn=rn.length;Nn<zn;Nn++)if(Lr.insert(rn[Nn]),Lr.size>te)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var jn=new ie(Lr),wn=Lr.size,Wn=Lr.pop();Wn;){var Bt=Wn.key;if(Lr.size===wn){var Yt=Bt.segment;throw new Error("Unable to pop() ".concat(Bt.isLeft?"left":"right"," SweepEvent ")+"[".concat(Bt.point.x,", ").concat(Bt.point.y,"] from segment #").concat(Yt.id," ")+"[".concat(Yt.leftSE.point.x,", ").concat(Yt.leftSE.point.y,"] -> ")+"[".concat(Yt.rightSE.point.x,", ").concat(Yt.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(Lr.size>te)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(jn.segments.length>St)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var oe=jn.process(Bt),Ce=0,Ue=oe.length;Ce<Ue;Ce++){var fr=oe[Ce];fr.consumedBy===void 0&&Lr.insert(fr)}wn=Lr.size,Wn=Lr.pop()}ee.reset();var Sr=ae.factory(jn.segments),Pe=new or(Sr);return Pe.getGeom()}}]),zt}(),$t=new qt,Ct=function(At){for(var Mt=arguments.length,Rt=new Array(Mt>1?Mt-1:0),tt=1;tt<Mt;tt++)Rt[tt-1]=arguments[tt];return $t.run("union",At,Rt)},Tt=function(At){for(var Mt=arguments.length,Rt=new Array(Mt>1?Mt-1:0),tt=1;tt<Mt;tt++)Rt[tt-1]=arguments[tt];return $t.run("intersection",At,Rt)},ue=function(At){for(var Mt=arguments.length,Rt=new Array(Mt>1?Mt-1:0),tt=1;tt<Mt;tt++)Rt[tt-1]=arguments[tt];return $t.run("xor",At,Rt)},Oe=function(At){for(var Mt=arguments.length,Rt=new Array(Mt>1?Mt-1:0),tt=1;tt<Mt;tt++)Rt[tt-1]=arguments[tt];return $t.run("difference",At,Rt)},We={union:Ct,intersection:Tt,xor:ue,difference:Oe};return We})},24561:function(vn,Ft,ot){"use strict";var Lt=ot(67294);var wt=function(){return wt=Object.assign||function(Zt){for(var P,b=1,X=arguments.length;b<X;b++){P=arguments[b];for(var le in P)Object.prototype.hasOwnProperty.call(P,le)&&(Zt[le]=P[le])}return Zt},wt.apply(this,arguments)};function I(st,Zt){var P={};for(var b in st)Object.prototype.hasOwnProperty.call(st,b)&&Zt.indexOf(b)<0&&(P[b]=st[b]);if(st!=null&&typeof Object.getOwnPropertySymbols=="function")for(var X=0,b=Object.getOwnPropertySymbols(st);X<b.length;X++)Zt.indexOf(b[X])<0&&Object.prototype.propertyIsEnumerable.call(st,b[X])&&(P[b[X]]=st[b[X]]);return P}var Et=function(){return Math.random().toString(36).substring(6)},q=function(st){var Zt=st.animate,P=st.backgroundColor,b=st.backgroundOpacity,X=st.baseUrl,le=st.children,Se=st.foregroundColor,Ie=st.foregroundOpacity,It=st.gradientRatio,rt=st.uniqueKey,Dt=st.interval,Ae=st.rtl,be=st.speed,me=st.style,ee=st.title,we=I(st,["animate","backgroundColor","backgroundOpacity","baseUrl","children","foregroundColor","foregroundOpacity","gradientRatio","uniqueKey","interval","rtl","speed","style","title"]),_e=rt||Et(),gt=_e+"-diff",Pt=_e+"-animated-diff",J=_e+"-aria",vt=Ae?{transform:"scaleX(-1)"}:null,W="0; "+Dt+"; 1",dt=be+"s";return(0,Lt.createElement)("svg",wt({"aria-labelledby":J,role:"img",style:wt(wt({},me),vt)},we),ee?(0,Lt.createElement)("title",{id:J},ee):null,(0,Lt.createElement)("rect",{role:"presentation",x:"0",y:"0",width:"100%",height:"100%",clipPath:"url("+X+"#"+gt+")",style:{fill:"url("+X+"#"+Pt+")"}}),(0,Lt.createElement)("defs",{role:"presentation"},(0,Lt.createElement)("clipPath",{id:gt},le),(0,Lt.createElement)("linearGradient",{id:Pt},(0,Lt.createElement)("stop",{offset:"0%",stopColor:P,stopOpacity:b},Zt&&(0,Lt.createElement)("animate",{attributeName:"offset",values:-It+"; "+-It+"; 1",keyTimes:W,dur:dt,repeatCount:"indefinite"})),(0,Lt.createElement)("stop",{offset:"50%",stopColor:Se,stopOpacity:Ie},Zt&&(0,Lt.createElement)("animate",{attributeName:"offset",values:-It/2+"; "+-It/2+"; "+(1+It/2),keyTimes:W,dur:dt,repeatCount:"indefinite"})),(0,Lt.createElement)("stop",{offset:"100%",stopColor:P,stopOpacity:b},Zt&&(0,Lt.createElement)("animate",{attributeName:"offset",values:"0; 0; "+(1+It),keyTimes:W,dur:dt,repeatCount:"indefinite"})))))};q.defaultProps={animate:!0,backgroundColor:"#f5f6f7",backgroundOpacity:1,baseUrl:"",foregroundColor:"#eee",foregroundOpacity:1,gradientRatio:2,id:null,interval:.25,rtl:!1,speed:1.2,style:{},title:"Loading..."};var lt=function(st){return st.children?(0,Lt.createElement)(q,wt({},st)):(0,Lt.createElement)(ht,wt({},st))},ht=function(st){return(0,Lt.createElement)(lt,wt({viewBox:"0 0 476 124"},st),(0,Lt.createElement)("rect",{x:"48",y:"8",width:"88",height:"6",rx:"3"}),(0,Lt.createElement)("rect",{x:"48",y:"26",width:"52",height:"6",rx:"3"}),(0,Lt.createElement)("rect",{x:"0",y:"56",width:"410",height:"6",rx:"3"}),(0,Lt.createElement)("rect",{x:"0",y:"72",width:"380",height:"6",rx:"3"}),(0,Lt.createElement)("rect",{x:"0",y:"88",width:"178",height:"6",rx:"3"}),(0,Lt.createElement)("circle",{cx:"20",cy:"20",r:"20"}))},ct=function(st){return createElement(lt,wt({viewBox:"0 0 400 460"},st),createElement("circle",{cx:"31",cy:"31",r:"15"}),createElement("rect",{x:"58",y:"18",rx:"2",ry:"2",width:"140",height:"10"}),createElement("rect",{x:"58",y:"34",rx:"2",ry:"2",width:"140",height:"10"}),createElement("rect",{x:"0",y:"60",rx:"2",ry:"2",width:"400",height:"400"}))},et=function(st){return createElement(lt,wt({viewBox:"0 0 340 84"},st),createElement("rect",{x:"0",y:"0",width:"67",height:"11",rx:"3"}),createElement("rect",{x:"76",y:"0",width:"140",height:"11",rx:"3"}),createElement("rect",{x:"127",y:"48",width:"53",height:"11",rx:"3"}),createElement("rect",{x:"187",y:"48",width:"72",height:"11",rx:"3"}),createElement("rect",{x:"18",y:"48",width:"100",height:"11",rx:"3"}),createElement("rect",{x:"0",y:"71",width:"37",height:"11",rx:"3"}),createElement("rect",{x:"18",y:"23",width:"140",height:"11",rx:"3"}),createElement("rect",{x:"166",y:"23",width:"173",height:"11",rx:"3"}))},Ee=function(st){return createElement(lt,wt({viewBox:"0 0 400 110"},st),createElement("rect",{x:"0",y:"0",rx:"3",ry:"3",width:"250",height:"10"}),createElement("rect",{x:"20",y:"20",rx:"3",ry:"3",width:"220",height:"10"}),createElement("rect",{x:"20",y:"40",rx:"3",ry:"3",width:"170",height:"10"}),createElement("rect",{x:"0",y:"60",rx:"3",ry:"3",width:"250",height:"10"}),createElement("rect",{x:"20",y:"80",rx:"3",ry:"3",width:"200",height:"10"}),createElement("rect",{x:"20",y:"100",rx:"3",ry:"3",width:"80",height:"10"}))},it=function(st){return createElement(lt,wt({viewBox:"0 0 245 125"},st),createElement("circle",{cx:"10",cy:"20",r:"8"}),createElement("rect",{x:"25",y:"15",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"50",r:"8"}),createElement("rect",{x:"25",y:"45",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"80",r:"8"}),createElement("rect",{x:"25",y:"75",rx:"5",ry:"5",width:"220",height:"10"}),createElement("circle",{cx:"10",cy:"110",r:"8"}),createElement("rect",{x:"25",y:"105",rx:"5",ry:"5",width:"220",height:"10"}))};Ft.ZP=lt},28660:function(vn,Ft,ot){var Lt=ot(34155);var wt;(function(I){(function(Et){var q=typeof ot.g=="object"?ot.g:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),lt=ht(I);typeof q.Reflect=="undefined"?q.Reflect=I:lt=ht(q.Reflect,lt),Et(lt);function ht(ct,et){return function(Ee,it){typeof ct[Ee]!="function"&&Object.defineProperty(ct,Ee,{configurable:!0,writable:!0,value:it}),et&&et(Ee,it)}}})(function(Et){var q=Object.prototype.hasOwnProperty,lt=typeof Symbol=="function",ht=lt&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",ct=lt&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",et=typeof Object.create=="function",Ee={__proto__:[]}instanceof Array,it=!et&&!Ee,st={create:et?function(){return ve(Object.create(null))}:Ee?function(){return ve({__proto__:null})}:function(){return ve({})},has:it?function(Wt,Me){return q.call(Wt,Me)}:function(Wt,Me){return Me in Wt},get:it?function(Wt,Me){return q.call(Wt,Me)?Wt[Me]:void 0}:function(Wt,Me){return Wt[Me]}},Zt=Object.getPrototypeOf(Function),P=typeof Lt=="object"&&{NODE_ENV:"production",PUBLIC_PATH:"/"}&&{NODE_ENV:"production",PUBLIC_PATH:"/"}.REFLECT_METADATA_USE_MAP_POLYFILL==="true",b=!P&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:tt(),X=!P&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:_t(),le=!P&&typeof WeakMap=="function"?WeakMap:Xt(),Se=new le;function Ie(Wt,Me,je,Qe){if(Qt(je)){if(!$t(Wt))throw new TypeError;if(!Tt(Me))throw new TypeError;return gt(Wt,Me)}else{if(!$t(Wt))throw new TypeError;if(!Ke(Me))throw new TypeError;if(!Ke(Qe)&&!Qt(Qe)&&!Te(Qe))throw new TypeError;return Te(Qe)&&(Qe=void 0),je=qt(je),Pt(Wt,Me,je,Qe)}}Et("decorate",Ie);function It(Wt,Me){function je(Qe,hr){if(!Ke(Qe))throw new TypeError;if(!Qt(hr)&&!ue(hr))throw new TypeError;ne(Wt,Me,Qe,hr)}return je}Et("metadata",It);function rt(Wt,Me,je,Qe){if(!Ke(je))throw new TypeError;return Qt(Qe)||(Qe=qt(Qe)),ne(Wt,Me,je,Qe)}Et("defineMetadata",rt);function Dt(Wt,Me,je){if(!Ke(Me))throw new TypeError;return Qt(je)||(je=qt(je)),vt(Wt,Me,je)}Et("hasMetadata",Dt);function Ae(Wt,Me,je){if(!Ke(Me))throw new TypeError;return Qt(je)||(je=qt(je)),W(Wt,Me,je)}Et("hasOwnMetadata",Ae);function be(Wt,Me,je){if(!Ke(Me))throw new TypeError;return Qt(je)||(je=qt(je)),dt(Wt,Me,je)}Et("getMetadata",be);function me(Wt,Me,je){if(!Ke(Me))throw new TypeError;return Qt(je)||(je=qt(je)),Vt(Wt,Me,je)}Et("getOwnMetadata",me);function ee(Wt,Me){if(!Ke(Wt))throw new TypeError;return Qt(Me)||(Me=qt(Me)),ge(Wt,Me)}Et("getMetadataKeys",ee);function we(Wt,Me){if(!Ke(Wt))throw new TypeError;return Qt(Me)||(Me=qt(Me)),$e(Wt,Me)}Et("getOwnMetadataKeys",we);function _e(Wt,Me,je){if(!Ke(Me))throw new TypeError;Qt(je)||(je=qt(je));var Qe=J(Me,je,!1);if(Qt(Qe)||!Qe.delete(Wt))return!1;if(Qe.size>0)return!0;var hr=Se.get(Me);return hr.delete(je),hr.size>0||Se.delete(Me),!0}Et("deleteMetadata",_e);function gt(Wt,Me){for(var je=Wt.length-1;je>=0;--je){var Qe=Wt[je],hr=Qe(Me);if(!Qt(hr)&&!Te(hr)){if(!Tt(hr))throw new TypeError;Me=hr}}return Me}function Pt(Wt,Me,je,Qe){for(var hr=Wt.length-1;hr>=0;--hr){var er=Wt[hr],Br=er(Me,je,Qe);if(!Qt(Br)&&!Te(Br)){if(!Ke(Br))throw new TypeError;Qe=Br}}return Qe}function J(Wt,Me,je){var Qe=Se.get(Wt);if(Qt(Qe)){if(!je)return;Qe=new b,Se.set(Wt,Qe)}var hr=Qe.get(Me);if(Qt(hr)){if(!je)return;hr=new b,Qe.set(Me,hr)}return hr}function vt(Wt,Me,je){var Qe=W(Wt,Me,je);if(Qe)return!0;var hr=Rt(Me);return Te(hr)?!1:vt(Wt,hr,je)}function W(Wt,Me,je){var Qe=J(Me,je,!1);return Qt(Qe)?!1:te(Qe.has(Wt))}function dt(Wt,Me,je){var Qe=W(Wt,Me,je);if(Qe)return Vt(Wt,Me,je);var hr=Rt(Me);if(!Te(hr))return dt(Wt,hr,je)}function Vt(Wt,Me,je){var Qe=J(Me,je,!1);if(!Qt(Qe))return Qe.get(Wt)}function ne(Wt,Me,je,Qe){var hr=J(je,Qe,!0);hr.set(Wt,Me)}function ge(Wt,Me){var je=$e(Wt,Me),Qe=Rt(Wt);if(Qe===null)return je;var hr=ge(Qe,Me);if(hr.length<=0)return je;if(je.length<=0)return hr;for(var er=new X,Br=[],Lr=0,Zr=je;Lr<Zr.length;Lr++){var Tn=Zr[Lr],rn=er.has(Tn);rn||(er.add(Tn),Br.push(Tn))}for(var Nn=0,zn=hr;Nn<zn.length;Nn++){var Tn=zn[Nn],rn=er.has(Tn);rn||(er.add(Tn),Br.push(Tn))}return Br}function $e(Wt,Me){var je=[],Qe=J(Wt,Me,!1);if(Qt(Qe))return je;for(var hr=Qe.keys(),er=We(hr),Br=0;;){var Lr=At(er);if(!Lr)return je.length=Br,je;var Zr=zt(Lr);try{je[Br]=Zr}catch(Tn){try{Mt(er)}finally{throw Tn}}Br++}}function jt(Wt){if(Wt===null)return 1;switch(typeof Wt){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Wt===null?1:6;default:return 6}}function Qt(Wt){return Wt===void 0}function Te(Wt){return Wt===null}function ae(Wt){return typeof Wt=="symbol"}function Ke(Wt){return typeof Wt=="object"?Wt!==null:typeof Wt=="function"}function or(Wt,Me){switch(jt(Wt)){case 0:return Wt;case 1:return Wt;case 2:return Wt;case 3:return Wt;case 4:return Wt;case 5:return Wt}var je=Me===3?"string":Me===5?"number":"default",Qe=Oe(Wt,ht);if(Qe!==void 0){var hr=Qe.call(Wt,je);if(Ke(hr))throw new TypeError;return hr}return ie(Wt,je==="default"?"number":je)}function ie(Wt,Me){if(Me==="string"){var je=Wt.toString;if(Ct(je)){var Qe=je.call(Wt);if(!Ke(Qe))return Qe}var hr=Wt.valueOf;if(Ct(hr)){var Qe=hr.call(Wt);if(!Ke(Qe))return Qe}}else{var hr=Wt.valueOf;if(Ct(hr)){var Qe=hr.call(Wt);if(!Ke(Qe))return Qe}var er=Wt.toString;if(Ct(er)){var Qe=er.call(Wt);if(!Ke(Qe))return Qe}}throw new TypeError}function te(Wt){return!!Wt}function St(Wt){return""+Wt}function qt(Wt){var Me=or(Wt,3);return ae(Me)?Me:St(Me)}function $t(Wt){return Array.isArray?Array.isArray(Wt):Wt instanceof Object?Wt instanceof Array:Object.prototype.toString.call(Wt)==="[object Array]"}function Ct(Wt){return typeof Wt=="function"}function Tt(Wt){return typeof Wt=="function"}function ue(Wt){switch(jt(Wt)){case 3:return!0;case 4:return!0;default:return!1}}function Oe(Wt,Me){var je=Wt[Me];if(je!=null){if(!Ct(je))throw new TypeError;return je}}function We(Wt){var Me=Oe(Wt,ct);if(!Ct(Me))throw new TypeError;var je=Me.call(Wt);if(!Ke(je))throw new TypeError;return je}function zt(Wt){return Wt.value}function At(Wt){var Me=Wt.next();return Me.done?!1:Me}function Mt(Wt){var Me=Wt.return;Me&&Me.call(Wt)}function Rt(Wt){var Me=Object.getPrototypeOf(Wt);if(typeof Wt!="function"||Wt===Zt||Me!==Zt)return Me;var je=Wt.prototype,Qe=je&&Object.getPrototypeOf(je);if(Qe==null||Qe===Object.prototype)return Me;var hr=Qe.constructor;return typeof hr!="function"||hr===Wt?Me:hr}function tt(){var Wt={},Me=[],je=function(){function Br(Lr,Zr,Tn){this._index=0,this._keys=Lr,this._values=Zr,this._selector=Tn}return Br.prototype["@@iterator"]=function(){return this},Br.prototype[ct]=function(){return this},Br.prototype.next=function(){var Lr=this._index;if(Lr>=0&&Lr<this._keys.length){var Zr=this._selector(this._keys[Lr],this._values[Lr]);return Lr+1>=this._keys.length?(this._index=-1,this._keys=Me,this._values=Me):this._index++,{value:Zr,done:!1}}return{value:void 0,done:!0}},Br.prototype.throw=function(Lr){throw this._index>=0&&(this._index=-1,this._keys=Me,this._values=Me),Lr},Br.prototype.return=function(Lr){return this._index>=0&&(this._index=-1,this._keys=Me,this._values=Me),{value:Lr,done:!0}},Br}();return function(){function Br(){this._keys=[],this._values=[],this._cacheKey=Wt,this._cacheIndex=-2}return Object.defineProperty(Br.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Br.prototype.has=function(Lr){return this._find(Lr,!1)>=0},Br.prototype.get=function(Lr){var Zr=this._find(Lr,!1);return Zr>=0?this._values[Zr]:void 0},Br.prototype.set=function(Lr,Zr){var Tn=this._find(Lr,!0);return this._values[Tn]=Zr,this},Br.prototype.delete=function(Lr){var Zr=this._find(Lr,!1);if(Zr>=0){for(var Tn=this._keys.length,rn=Zr+1;rn<Tn;rn++)this._keys[rn-1]=this._keys[rn],this._values[rn-1]=this._values[rn];return this._keys.length--,this._values.length--,Lr===this._cacheKey&&(this._cacheKey=Wt,this._cacheIndex=-2),!0}return!1},Br.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Wt,this._cacheIndex=-2},Br.prototype.keys=function(){return new je(this._keys,this._values,Qe)},Br.prototype.values=function(){return new je(this._keys,this._values,hr)},Br.prototype.entries=function(){return new je(this._keys,this._values,er)},Br.prototype["@@iterator"]=function(){return this.entries()},Br.prototype[ct]=function(){return this.entries()},Br.prototype._find=function(Lr,Zr){return this._cacheKey!==Lr&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Lr)),this._cacheIndex<0&&Zr&&(this._cacheIndex=this._keys.length,this._keys.push(Lr),this._values.push(void 0)),this._cacheIndex},Br}();function Qe(Br,Lr){return Br}function hr(Br,Lr){return Lr}function er(Br,Lr){return[Br,Lr]}}function _t(){return function(){function Wt(){this._map=new b}return Object.defineProperty(Wt.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Wt.prototype.has=function(Me){return this._map.has(Me)},Wt.prototype.add=function(Me){return this._map.set(Me,Me),this},Wt.prototype.delete=function(Me){return this._map.delete(Me)},Wt.prototype.clear=function(){this._map.clear()},Wt.prototype.keys=function(){return this._map.keys()},Wt.prototype.values=function(){return this._map.values()},Wt.prototype.entries=function(){return this._map.entries()},Wt.prototype["@@iterator"]=function(){return this.keys()},Wt.prototype[ct]=function(){return this.keys()},Wt}()}function Xt(){var Wt=16,Me=st.create(),je=Qe();return function(){function Zr(){this._key=Qe()}return Zr.prototype.has=function(Tn){var rn=hr(Tn,!1);return rn!==void 0?st.has(rn,this._key):!1},Zr.prototype.get=function(Tn){var rn=hr(Tn,!1);return rn!==void 0?st.get(rn,this._key):void 0},Zr.prototype.set=function(Tn,rn){var Nn=hr(Tn,!0);return Nn[this._key]=rn,this},Zr.prototype.delete=function(Tn){var rn=hr(Tn,!1);return rn!==void 0?delete rn[this._key]:!1},Zr.prototype.clear=function(){this._key=Qe()},Zr}();function Qe(){var Zr;do Zr="@@WeakMap@@"+Lr();while(st.has(Me,Zr));return Me[Zr]=!0,Zr}function hr(Zr,Tn){if(!q.call(Zr,je)){if(!Tn)return;Object.defineProperty(Zr,je,{value:st.create()})}return Zr[je]}function er(Zr,Tn){for(var rn=0;rn<Tn;++rn)Zr[rn]=Math.random()*255|0;return Zr}function Br(Zr){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(Zr)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(Zr)):er(new Uint8Array(Zr),Zr):er(new Array(Zr),Zr)}function Lr(){var Zr=Br(Wt);Zr[6]=Zr[6]&79|64,Zr[8]=Zr[8]&191|128;for(var Tn="",rn=0;rn<Wt;++rn){var Nn=Zr[rn];(rn===4||rn===6||rn===8)&&(Tn+="-"),Nn<16&&(Tn+="0"),Tn+=Nn.toString(16).toLowerCase()}return Tn}}function ve(Wt){return Wt.__=void 0,delete Wt.__,Wt}})})(wt||(wt={}))},55168:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.SensorTabIndex=Ft.SensorClassName=Ft.SizeSensorId=void 0;var ot="size-sensor-id";Ft.SizeSensorId=ot;var Lt="size-sensor-object";Ft.SensorClassName=Lt;var wt="-1";Ft.SensorTabIndex=wt},12177:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.default=void 0;var ot=function(wt){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:60,Et=null;return function(){for(var q=this,lt=arguments.length,ht=new Array(lt),ct=0;ct<lt;ct++)ht[ct]=arguments[ct];clearTimeout(Et),Et=setTimeout(function(){wt.apply(q,ht)},I)}};Ft.default=ot},15378:function(vn,Ft){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.default=void 0;var ot=1,Lt=function(){return"".concat(ot++)};Ft.default=Lt},18587:function(vn,Ft,ot){"use strict";var Lt;Lt={value:!0},Lt=Lt=Ft.ak=void 0;var wt=ot(12955),I=function(ht,ct){var et=(0,wt.getSensor)(ht);return et.bind(ct),function(){et.unbind(ct)}};Ft.ak=I;var Et=function(ht){var ct=(0,wt.getSensor)(ht);(0,wt.removeSensor)(ct)};Lt=Et;var q="1.0.1";Lt=q},12955:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.removeSensor=Ft.getSensor=void 0;var Lt=Et(ot(15378)),wt=ot(82578),I=ot(55168);function Et(ct){return ct&&ct.__esModule?ct:{default:ct}}var q={},lt=function(et){var Ee=et.getAttribute(I.SizeSensorId);if(Ee&&q[Ee])return q[Ee];var it=(0,Lt.default)();et.setAttribute(I.SizeSensorId,it);var st=(0,wt.createSensor)(et);return q[it]=st,st};Ft.getSensor=lt;var ht=function(et){var Ee=et.element.getAttribute(I.SizeSensorId);et.element.removeAttribute(I.SizeSensorId),et.destroy(),Ee&&q[Ee]&&delete q[Ee]};Ft.removeSensor=ht},82578:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.createSensor=void 0;var Lt=ot(27643),wt=ot(31743),I=typeof ResizeObserver!="undefined"?wt.createSensor:Lt.createSensor;Ft.createSensor=I},27643:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.createSensor=void 0;var Lt=I(ot(12177)),wt=ot(55168);function I(q){return q&&q.__esModule?q:{default:q}}var Et=function(lt){var ht=void 0,ct=[],et=function(){getComputedStyle(lt).position==="static"&&(lt.style.position="relative");var b=document.createElement("object");return b.onload=function(){b.contentDocument.defaultView.addEventListener("resize",Ee),Ee()},b.style.display="block",b.style.position="absolute",b.style.top="0",b.style.left="0",b.style.height="100%",b.style.width="100%",b.style.overflow="hidden",b.style.pointerEvents="none",b.style.zIndex="-1",b.style.opacity="0",b.setAttribute("class",wt.SensorClassName),b.setAttribute("tabindex",wt.SensorTabIndex),b.type="text/html",lt.appendChild(b),b.data="about:blank",b},Ee=(0,Lt.default)(function(){ct.forEach(function(P){P(lt)})}),it=function(b){ht||(ht=et()),ct.indexOf(b)===-1&&ct.push(b)},st=function(){ht&&ht.parentNode&&(ht.contentDocument&&ht.contentDocument.defaultView.removeEventListener("resize",Ee),ht.parentNode.removeChild(ht),ht=void 0,ct=[])},Zt=function(b){var X=ct.indexOf(b);X!==-1&&ct.splice(X,1),ct.length===0&&ht&&st()};return{element:lt,bind:it,destroy:st,unbind:Zt}};Ft.createSensor=Et},31743:function(vn,Ft,ot){"use strict";Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.createSensor=void 0;var Lt=wt(ot(12177));function wt(Et){return Et&&Et.__esModule?Et:{default:Et}}var I=function(q){var lt=void 0,ht=[],ct=(0,Lt.default)(function(){ht.forEach(function(Zt){Zt(q)})}),et=function(){var P=new ResizeObserver(ct);return P.observe(q),ct(),P},Ee=function(P){lt||(lt=et()),ht.indexOf(P)===-1&&ht.push(P)},it=function(){lt.disconnect(),ht=[],lt=void 0},st=function(P){var b=ht.indexOf(P);b!==-1&&ht.splice(b,1),ht.length===0&&lt&&it()};return{element:q,bind:Ee,destroy:it,unbind:st}};Ft.createSensor=I},69848:function(vn){(function(Ft,ot){vn.exports=ot()})(this,function(){"use strict";function Ft(Ae,be,me,ee,we,_e){if(!(we-ee<=me)){var gt=ee+we>>1;ot(Ae,be,gt,ee,we,_e%2),Ft(Ae,be,me,ee,gt-1,_e+1),Ft(Ae,be,me,gt+1,we,_e+1)}}function ot(Ae,be,me,ee,we,_e){for(;we>ee;){if(we-ee>600){var gt=we-ee+1,Pt=me-ee+1,J=Math.log(gt),vt=.5*Math.exp(2*J/3),W=.5*Math.sqrt(J*vt*(gt-vt)/gt)*(Pt-gt/2<0?-1:1),dt=Math.max(ee,Math.floor(me-Pt*vt/gt+W)),Vt=Math.min(we,Math.floor(me+(gt-Pt)*vt/gt+W));ot(Ae,be,me,dt,Vt,_e)}var ne=be[2*me+_e],ge=ee,$e=we;for(Lt(Ae,be,ee,me),be[2*we+_e]>ne&&Lt(Ae,be,ee,we);ge<$e;){for(Lt(Ae,be,ge,$e),ge++,$e--;be[2*ge+_e]<ne;)ge++;for(;be[2*$e+_e]>ne;)$e--}be[2*ee+_e]===ne?Lt(Ae,be,ee,$e):($e++,Lt(Ae,be,$e,we)),$e<=me&&(ee=$e+1),me<=$e&&(we=$e-1)}}function Lt(Ae,be,me,ee){wt(Ae,me,ee),wt(be,2*me,2*ee),wt(be,2*me+1,2*ee+1)}function wt(Ae,be,me){var ee=Ae[be];Ae[be]=Ae[me],Ae[me]=ee}function I(Ae,be,me,ee,we,_e,gt){for(var Pt=[0,Ae.length-1,0],J=[],vt,W;Pt.length;){var dt=Pt.pop(),Vt=Pt.pop(),ne=Pt.pop();if(Vt-ne<=gt){for(var ge=ne;ge<=Vt;ge++)vt=be[2*ge],W=be[2*ge+1],vt>=me&&vt<=we&&W>=ee&&W<=_e&&J.push(Ae[ge]);continue}var $e=Math.floor((ne+Vt)/2);vt=be[2*$e],W=be[2*$e+1],vt>=me&&vt<=we&&W>=ee&&W<=_e&&J.push(Ae[$e]);var jt=(dt+1)%2;(dt===0?me<=vt:ee<=W)&&(Pt.push(ne),Pt.push($e-1),Pt.push(jt)),(dt===0?we>=vt:_e>=W)&&(Pt.push($e+1),Pt.push(Vt),Pt.push(jt))}return J}function Et(Ae,be,me,ee,we,_e){for(var gt=[0,Ae.length-1,0],Pt=[],J=we*we;gt.length;){var vt=gt.pop(),W=gt.pop(),dt=gt.pop();if(W-dt<=_e){for(var Vt=dt;Vt<=W;Vt++)q(be[2*Vt],be[2*Vt+1],me,ee)<=J&&Pt.push(Ae[Vt]);continue}var ne=Math.floor((dt+W)/2),ge=be[2*ne],$e=be[2*ne+1];q(ge,$e,me,ee)<=J&&Pt.push(Ae[ne]);var jt=(vt+1)%2;(vt===0?me-we<=ge:ee-we<=$e)&&(gt.push(dt),gt.push(ne-1),gt.push(jt)),(vt===0?me+we>=ge:ee+we>=$e)&&(gt.push(ne+1),gt.push(W),gt.push(jt))}return Pt}function q(Ae,be,me,ee){var we=Ae-me,_e=be-ee;return we*we+_e*_e}var lt=function(Ae){return Ae[0]},ht=function(Ae){return Ae[1]},ct=function(be,me,ee,we,_e){me===void 0&&(me=lt),ee===void 0&&(ee=ht),we===void 0&&(we=64),_e===void 0&&(_e=Float64Array),this.nodeSize=we,this.points=be;for(var gt=be.length<65536?Uint16Array:Uint32Array,Pt=this.ids=new gt(be.length),J=this.coords=new _e(be.length*2),vt=0;vt<be.length;vt++)Pt[vt]=vt,J[2*vt]=me(be[vt]),J[2*vt+1]=ee(be[vt]);Ft(Pt,J,we,0,Pt.length-1,0)};ct.prototype.range=function(be,me,ee,we){return I(this.ids,this.coords,be,me,ee,we,this.nodeSize)},ct.prototype.within=function(be,me,ee){return Et(this.ids,this.coords,be,me,ee,this.nodeSize)};var et={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ae){return Ae}},Ee=Math.fround||function(Ae){return function(be){return Ae[0]=+be,Ae[0]}}(new Float32Array(1)),it=function(be){this.options=It(Object.create(et),be),this.trees=new Array(this.options.maxZoom+1)};it.prototype.load=function(be){var me=this.options,ee=me.log,we=me.minZoom,_e=me.maxZoom,gt=me.nodeSize;ee&&console.time("total time");var Pt="prepare "+be.length+" points";ee&&console.time(Pt),this.points=be;for(var J=[],vt=0;vt<be.length;vt++)!be[vt].geometry||J.push(Zt(be[vt],vt));this.trees[_e+1]=new ct(J,rt,Dt,gt,Float32Array),ee&&console.timeEnd(Pt);for(var W=_e;W>=we;W--){var dt=+Date.now();J=this._cluster(J,W),this.trees[W]=new ct(J,rt,Dt,gt,Float32Array),ee&&console.log("z%d: %d clusters in %dms",W,J.length,+Date.now()-dt)}return ee&&console.timeEnd("total time"),this},it.prototype.getClusters=function(be,me){var ee=((be[0]+180)%360+360)%360-180,we=Math.max(-90,Math.min(90,be[1])),_e=be[2]===180?180:((be[2]+180)%360+360)%360-180,gt=Math.max(-90,Math.min(90,be[3]));if(be[2]-be[0]>=360)ee=-180,_e=180;else if(ee>_e){var Pt=this.getClusters([ee,we,180,gt],me),J=this.getClusters([-180,we,_e,gt],me);return Pt.concat(J)}for(var vt=this.trees[this._limitZoom(me)],W=vt.range(X(ee),le(gt),X(_e),le(we)),dt=[],Vt=0,ne=W;Vt<ne.length;Vt+=1){var ge=ne[Vt],$e=vt.points[ge];dt.push($e.numPoints?P($e):this.points[$e.index])}return dt},it.prototype.getChildren=function(be){var me=this._getOriginId(be),ee=this._getOriginZoom(be),we="No cluster with the specified id.",_e=this.trees[ee];if(!_e)throw new Error(we);var gt=_e.points[me];if(!gt)throw new Error(we);for(var Pt=this.options.radius/(this.options.extent*Math.pow(2,ee-1)),J=_e.within(gt.x,gt.y,Pt),vt=[],W=0,dt=J;W<dt.length;W+=1){var Vt=dt[W],ne=_e.points[Vt];ne.parentId===be&&vt.push(ne.numPoints?P(ne):this.points[ne.index])}if(vt.length===0)throw new Error(we);return vt},it.prototype.getLeaves=function(be,me,ee){me=me||10,ee=ee||0;var we=[];return this._appendLeaves(we,be,me,ee,0),we},it.prototype.getTile=function(be,me,ee){var we=this.trees[this._limitZoom(be)],_e=Math.pow(2,be),gt=this.options,Pt=gt.extent,J=gt.radius,vt=J/Pt,W=(ee-vt)/_e,dt=(ee+1+vt)/_e,Vt={features:[]};return this._addTileFeatures(we.range((me-vt)/_e,W,(me+1+vt)/_e,dt),we.points,me,ee,_e,Vt),me===0&&this._addTileFeatures(we.range(1-vt/_e,W,1,dt),we.points,_e,ee,_e,Vt),me===_e-1&&this._addTileFeatures(we.range(0,W,vt/_e,dt),we.points,-1,ee,_e,Vt),Vt.features.length?Vt:null},it.prototype.getClusterExpansionZoom=function(be){for(var me=this._getOriginZoom(be)-1;me<=this.options.maxZoom;){var ee=this.getChildren(be);if(me++,ee.length!==1)break;be=ee[0].properties.cluster_id}return me},it.prototype._appendLeaves=function(be,me,ee,we,_e){for(var gt=this.getChildren(me),Pt=0,J=gt;Pt<J.length;Pt+=1){var vt=J[Pt],W=vt.properties;if(W&&W.cluster?_e+W.point_count<=we?_e+=W.point_count:_e=this._appendLeaves(be,W.cluster_id,ee,we,_e):_e<we?_e++:be.push(vt),be.length===ee)break}return _e},it.prototype._addTileFeatures=function(be,me,ee,we,_e,gt){for(var Pt=0,J=be;Pt<J.length;Pt+=1){var vt=J[Pt],W=me[vt],dt=W.numPoints,Vt=void 0,ne=void 0,ge=void 0;if(dt)Vt=b(W),ne=W.x,ge=W.y;else{var $e=this.points[W.index];Vt=$e.properties,ne=X($e.geometry.coordinates[0]),ge=le($e.geometry.coordinates[1])}var jt={type:1,geometry:[[Math.round(this.options.extent*(ne*_e-ee)),Math.round(this.options.extent*(ge*_e-we))]],tags:Vt},Qt=void 0;dt?Qt=W.id:this.options.generateId?Qt=W.index:this.points[W.index].id&&(Qt=this.points[W.index].id),Qt!==void 0&&(jt.id=Qt),gt.features.push(jt)}},it.prototype._limitZoom=function(be){return Math.max(this.options.minZoom,Math.min(Math.floor(+be),this.options.maxZoom+1))},it.prototype._cluster=function(be,me){for(var ee=[],we=this.options,_e=we.radius,gt=we.extent,Pt=we.reduce,J=we.minPoints,vt=_e/(gt*Math.pow(2,me)),W=0;W<be.length;W++){var dt=be[W];if(!(dt.zoom<=me)){dt.zoom=me;for(var Vt=this.trees[me+1],ne=Vt.within(dt.x,dt.y,vt),ge=dt.numPoints||1,$e=ge,jt=0,Qt=ne;jt<Qt.length;jt+=1){var Te=Qt[jt],ae=Vt.points[Te];ae.zoom>me&&($e+=ae.numPoints||1)}if($e>ge&&$e>=J){for(var Ke=dt.x*ge,or=dt.y*ge,ie=Pt&&ge>1?this._map(dt,!0):null,te=(W<<5)+(me+1)+this.points.length,St=0,qt=ne;St<qt.length;St+=1){var $t=qt[St],Ct=Vt.points[$t];if(!(Ct.zoom<=me)){Ct.zoom=me;var Tt=Ct.numPoints||1;Ke+=Ct.x*Tt,or+=Ct.y*Tt,Ct.parentId=te,Pt&&(ie||(ie=this._map(dt,!0)),Pt(ie,this._map(Ct)))}}dt.parentId=te,ee.push(st(Ke/$e,or/$e,te,$e,ie))}else if(ee.push(dt),$e>1)for(var ue=0,Oe=ne;ue<Oe.length;ue+=1){var We=Oe[ue],zt=Vt.points[We];zt.zoom<=me||(zt.zoom=me,ee.push(zt))}}}return ee},it.prototype._getOriginId=function(be){return be-this.points.length>>5},it.prototype._getOriginZoom=function(be){return(be-this.points.length)%32},it.prototype._map=function(be,me){if(be.numPoints)return me?It({},be.properties):be.properties;var ee=this.points[be.index].properties,we=this.options.map(ee);return me&&we===ee?It({},we):we};function st(Ae,be,me,ee,we){return{x:Ee(Ae),y:Ee(be),zoom:1/0,id:me,parentId:-1,numPoints:ee,properties:we}}function Zt(Ae,be){var me=Ae.geometry.coordinates,ee=me[0],we=me[1];return{x:Ee(X(ee)),y:Ee(le(we)),zoom:1/0,index:be,parentId:-1}}function P(Ae){return{type:"Feature",id:Ae.id,properties:b(Ae),geometry:{type:"Point",coordinates:[Se(Ae.x),Ie(Ae.y)]}}}function b(Ae){var be=Ae.numPoints,me=be>=1e4?Math.round(be/1e3)+"k":be>=1e3?Math.round(be/100)/10+"k":be;return It(It({},Ae.properties),{cluster:!0,cluster_id:Ae.id,point_count:be,point_count_abbreviated:me})}function X(Ae){return Ae/360+.5}function le(Ae){var be=Math.sin(Ae*Math.PI/180),me=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return me<0?0:me>1?1:me}function Se(Ae){return(Ae-.5)*360}function Ie(Ae){var be=(180-Ae*360)*Math.PI/180;return 360*Math.atan(Math.exp(be))/Math.PI-90}function It(Ae,be){for(var me in be)Ae[me]=be[me];return Ae}function rt(Ae){return Ae.x}function Dt(Ae){return Ae.y}return it})},70655:function(vn,Ft,ot){"use strict";ot.d(Ft,{CR:function(){return Zt},Jh:function(){return et},XA:function(){return st},ZT:function(){return wt},_T:function(){return Et},ev:function(){return X},mG:function(){return ct},pi:function(){return I},pr:function(){return b}});var Lt=function(_e,gt){return Lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Pt,J){Pt.__proto__=J}||function(Pt,J){for(var vt in J)Object.prototype.hasOwnProperty.call(J,vt)&&(Pt[vt]=J[vt])},Lt(_e,gt)};function wt(_e,gt){if(typeof gt!="function"&&gt!==null)throw new TypeError("Class extends value "+String(gt)+" is not a constructor or null");Lt(_e,gt);function Pt(){this.constructor=_e}_e.prototype=gt===null?Object.create(gt):(Pt.prototype=gt.prototype,new Pt)}var I=function(){return I=Object.assign||function(gt){for(var Pt,J=1,vt=arguments.length;J<vt;J++){Pt=arguments[J];for(var W in Pt)Object.prototype.hasOwnProperty.call(Pt,W)&&(gt[W]=Pt[W])}return gt},I.apply(this,arguments)};function Et(_e,gt){var Pt={};for(var J in _e)Object.prototype.hasOwnProperty.call(_e,J)&&gt.indexOf(J)<0&&(Pt[J]=_e[J]);if(_e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var vt=0,J=Object.getOwnPropertySymbols(_e);vt<J.length;vt++)gt.indexOf(J[vt])<0&&Object.prototype.propertyIsEnumerable.call(_e,J[vt])&&(Pt[J[vt]]=_e[J[vt]]);return Pt}function q(_e,gt,Pt,J){var vt=arguments.length,W=vt<3?gt:J===null?J=Object.getOwnPropertyDescriptor(gt,Pt):J,dt;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")W=Reflect.decorate(_e,gt,Pt,J);else for(var Vt=_e.length-1;Vt>=0;Vt--)(dt=_e[Vt])&&(W=(vt<3?dt(W):vt>3?dt(gt,Pt,W):dt(gt,Pt))||W);return vt>3&&W&&Object.defineProperty(gt,Pt,W),W}function lt(_e,gt){return function(Pt,J){gt(Pt,J,_e)}}function ht(_e,gt){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(_e,gt)}function ct(_e,gt,Pt,J){function vt(W){return W instanceof Pt?W:new Pt(function(dt){dt(W)})}return new(Pt||(Pt=Promise))(function(W,dt){function Vt($e){try{ge(J.next($e))}catch(jt){dt(jt)}}function ne($e){try{ge(J.throw($e))}catch(jt){dt(jt)}}function ge($e){$e.done?W($e.value):vt($e.value).then(Vt,ne)}ge((J=J.apply(_e,gt||[])).next())})}function et(_e,gt){var Pt={label:0,sent:function(){if(W[0]&1)throw W[1];return W[1]},trys:[],ops:[]},J,vt,W,dt;return dt={next:Vt(0),throw:Vt(1),return:Vt(2)},typeof Symbol=="function"&&(dt[Symbol.iterator]=function(){return this}),dt;function Vt(ge){return function($e){return ne([ge,$e])}}function ne(ge){if(J)throw new TypeError("Generator is already executing.");for(;dt&&(dt=0,ge[0]&&(Pt=0)),Pt;)try{if(J=1,vt&&(W=ge[0]&2?vt.return:ge[0]?vt.throw||((W=vt.return)&&W.call(vt),0):vt.next)&&!(W=W.call(vt,ge[1])).done)return W;switch(vt=0,W&&(ge=[ge[0]&2,W.value]),ge[0]){case 0:case 1:W=ge;break;case 4:return Pt.label++,{value:ge[1],done:!1};case 5:Pt.label++,vt=ge[1],ge=[0];continue;case 7:ge=Pt.ops.pop(),Pt.trys.pop();continue;default:if(W=Pt.trys,!(W=W.length>0&&W[W.length-1])&&(ge[0]===6||ge[0]===2)){Pt=0;continue}if(ge[0]===3&&(!W||ge[1]>W[0]&&ge[1]<W[3])){Pt.label=ge[1];break}if(ge[0]===6&&Pt.label<W[1]){Pt.label=W[1],W=ge;break}if(W&&Pt.label<W[2]){Pt.label=W[2],Pt.ops.push(ge);break}W[2]&&Pt.ops.pop(),Pt.trys.pop();continue}ge=gt.call(_e,Pt)}catch($e){ge=[6,$e],vt=0}finally{J=W=0}if(ge[0]&5)throw ge[1];return{value:ge[0]?ge[1]:void 0,done:!0}}}var Ee=Object.create?function(_e,gt,Pt,J){J===void 0&&(J=Pt);var vt=Object.getOwnPropertyDescriptor(gt,Pt);(!vt||("get"in vt?!gt.__esModule:vt.writable||vt.configurable))&&(vt={enumerable:!0,get:function(){return gt[Pt]}}),Object.defineProperty(_e,J,vt)}:function(_e,gt,Pt,J){J===void 0&&(J=Pt),_e[J]=gt[Pt]};function it(_e,gt){for(var Pt in _e)Pt!=="default"&&!Object.prototype.hasOwnProperty.call(gt,Pt)&&Ee(gt,_e,Pt)}function st(_e){var gt=typeof Symbol=="function"&&Symbol.iterator,Pt=gt&&_e[gt],J=0;if(Pt)return Pt.call(_e);if(_e&&typeof _e.length=="number")return{next:function(){return _e&&J>=_e.length&&(_e=void 0),{value:_e&&_e[J++],done:!_e}}};throw new TypeError(gt?"Object is not iterable.":"Symbol.iterator is not defined.")}function Zt(_e,gt){var Pt=typeof Symbol=="function"&&_e[Symbol.iterator];if(!Pt)return _e;var J=Pt.call(_e),vt,W=[],dt;try{for(;(gt===void 0||gt-- >0)&&!(vt=J.next()).done;)W.push(vt.value)}catch(Vt){dt={error:Vt}}finally{try{vt&&!vt.done&&(Pt=J.return)&&Pt.call(J)}finally{if(dt)throw dt.error}}return W}function P(){for(var _e=[],gt=0;gt<arguments.length;gt++)_e=_e.concat(Zt(arguments[gt]));return _e}function b(){for(var _e=0,gt=0,Pt=arguments.length;gt<Pt;gt++)_e+=arguments[gt].length;for(var J=Array(_e),vt=0,gt=0;gt<Pt;gt++)for(var W=arguments[gt],dt=0,Vt=W.length;dt<Vt;dt++,vt++)J[vt]=W[dt];return J}function X(_e,gt,Pt){if(Pt||arguments.length===2)for(var J=0,vt=gt.length,W;J<vt;J++)(W||!(J in gt))&&(W||(W=Array.prototype.slice.call(gt,0,J)),W[J]=gt[J]);return _e.concat(W||Array.prototype.slice.call(gt))}function le(_e){return this instanceof le?(this.v=_e,this):new le(_e)}function Se(_e,gt,Pt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J=Pt.apply(_e,gt||[]),vt,W=[];return vt={},dt("next"),dt("throw"),dt("return"),vt[Symbol.asyncIterator]=function(){return this},vt;function dt(Qt){J[Qt]&&(vt[Qt]=function(Te){return new Promise(function(ae,Ke){W.push([Qt,Te,ae,Ke])>1||Vt(Qt,Te)})})}function Vt(Qt,Te){try{ne(J[Qt](Te))}catch(ae){jt(W[0][3],ae)}}function ne(Qt){Qt.value instanceof le?Promise.resolve(Qt.value.v).then(ge,$e):jt(W[0][2],Qt)}function ge(Qt){Vt("next",Qt)}function $e(Qt){Vt("throw",Qt)}function jt(Qt,Te){Qt(Te),W.shift(),W.length&&Vt(W[0][0],W[0][1])}}function Ie(_e){var gt,Pt;return gt={},J("next"),J("throw",function(vt){throw vt}),J("return"),gt[Symbol.iterator]=function(){return this},gt;function J(vt,W){gt[vt]=_e[vt]?function(dt){return(Pt=!Pt)?{value:le(_e[vt](dt)),done:vt==="return"}:W?W(dt):dt}:W}}function It(_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var gt=_e[Symbol.asyncIterator],Pt;return gt?gt.call(_e):(_e=typeof st=="function"?st(_e):_e[Symbol.iterator](),Pt={},J("next"),J("throw"),J("return"),Pt[Symbol.asyncIterator]=function(){return this},Pt);function J(W){Pt[W]=_e[W]&&function(dt){return new Promise(function(Vt,ne){dt=_e[W](dt),vt(Vt,ne,dt.done,dt.value)})}}function vt(W,dt,Vt,ne){Promise.resolve(ne).then(function(ge){W({value:ge,done:Vt})},dt)}}function rt(_e,gt){return Object.defineProperty?Object.defineProperty(_e,"raw",{value:gt}):_e.raw=gt,_e}var Dt=Object.create?function(_e,gt){Object.defineProperty(_e,"default",{enumerable:!0,value:gt})}:function(_e,gt){_e.default=gt};function Ae(_e){if(_e&&_e.__esModule)return _e;var gt={};if(_e!=null)for(var Pt in _e)Pt!=="default"&&Object.prototype.hasOwnProperty.call(_e,Pt)&&Ee(gt,_e,Pt);return Dt(gt,_e),gt}function be(_e){return _e&&_e.__esModule?_e:{default:_e}}function me(_e,gt,Pt,J){if(Pt==="a"&&!J)throw new TypeError("Private accessor was defined without a getter");if(typeof gt=="function"?_e!==gt||!J:!gt.has(_e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return Pt==="m"?J:Pt==="a"?J.call(_e):J?J.value:gt.get(_e)}function ee(_e,gt,Pt,J,vt){if(J==="m")throw new TypeError("Private method is not writable");if(J==="a"&&!vt)throw new TypeError("Private accessor was defined without a setter");if(typeof gt=="function"?_e!==gt||!vt:!gt.has(_e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return J==="a"?vt.call(_e,Pt):vt?vt.value=Pt:gt.set(_e,Pt),Pt}function we(_e,gt){if(gt===null||typeof gt!="object"&&typeof gt!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof _e=="function"?gt===_e:_e.has(gt)}},17061:function(vn,Ft,ot){var Lt=ot(18698).default;function wt(){"use strict";vn.exports=wt=function(){return I},vn.exports.__esModule=!0,vn.exports.default=vn.exports;var I={},Et=Object.prototype,q=Et.hasOwnProperty,lt=Object.defineProperty||function(J,vt,W){J[vt]=W.value},ht=typeof Symbol=="function"?Symbol:{},ct=ht.iterator||"@@iterator",et=ht.asyncIterator||"@@asyncIterator",Ee=ht.toStringTag||"@@toStringTag";function it(J,vt,W){return Object.defineProperty(J,vt,{value:W,enumerable:!0,configurable:!0,writable:!0}),J[vt]}try{it({},"")}catch(J){it=function(W,dt,Vt){return W[dt]=Vt}}function st(J,vt,W,dt){var Vt=vt&&vt.prototype instanceof b?vt:b,ne=Object.create(Vt.prototype),ge=new _e(dt||[]);return lt(ne,"_invoke",{value:be(J,W,ge)}),ne}function Zt(J,vt,W){try{return{type:"normal",arg:J.call(vt,W)}}catch(dt){return{type:"throw",arg:dt}}}I.wrap=st;var P={};function b(){}function X(){}function le(){}var Se={};it(Se,ct,function(){return this});var Ie=Object.getPrototypeOf,It=Ie&&Ie(Ie(gt([])));It&&It!==Et&&q.call(It,ct)&&(Se=It);var rt=le.prototype=b.prototype=Object.create(Se);function Dt(J){["next","throw","return"].forEach(function(vt){it(J,vt,function(W){return this._invoke(vt,W)})})}function Ae(J,vt){function W(Vt,ne,ge,$e){var jt=Zt(J[Vt],J,ne);if(jt.type!=="throw"){var Qt=jt.arg,Te=Qt.value;return Te&&Lt(Te)=="object"&&q.call(Te,"__await")?vt.resolve(Te.__await).then(function(ae){W("next",ae,ge,$e)},function(ae){W("throw",ae,ge,$e)}):vt.resolve(Te).then(function(ae){Qt.value=ae,ge(Qt)},function(ae){return W("throw",ae,ge,$e)})}$e(jt.arg)}var dt;lt(this,"_invoke",{value:function(ne,ge){function $e(){return new vt(function(jt,Qt){W(ne,ge,jt,Qt)})}return dt=dt?dt.then($e,$e):$e()}})}function be(J,vt,W){var dt="suspendedStart";return function(Vt,ne){if(dt==="executing")throw new Error("Generator is already running");if(dt==="completed"){if(Vt==="throw")throw ne;return Pt()}for(W.method=Vt,W.arg=ne;;){var ge=W.delegate;if(ge){var $e=me(ge,W);if($e){if($e===P)continue;return $e}}if(W.method==="next")W.sent=W._sent=W.arg;else if(W.method==="throw"){if(dt==="suspendedStart")throw dt="completed",W.arg;W.dispatchException(W.arg)}else W.method==="return"&&W.abrupt("return",W.arg);dt="executing";var jt=Zt(J,vt,W);if(jt.type==="normal"){if(dt=W.done?"completed":"suspendedYield",jt.arg===P)continue;return{value:jt.arg,done:W.done}}jt.type==="throw"&&(dt="completed",W.method="throw",W.arg=jt.arg)}}}function me(J,vt){var W=vt.method,dt=J.iterator[W];if(dt===void 0)return vt.delegate=null,W==="throw"&&J.iterator.return&&(vt.method="return",vt.arg=void 0,me(J,vt),vt.method==="throw")||W!=="return"&&(vt.method="throw",vt.arg=new TypeError("The iterator does not provide a '"+W+"' method")),P;var Vt=Zt(dt,J.iterator,vt.arg);if(Vt.type==="throw")return vt.method="throw",vt.arg=Vt.arg,vt.delegate=null,P;var ne=Vt.arg;return ne?ne.done?(vt[J.resultName]=ne.value,vt.next=J.nextLoc,vt.method!=="return"&&(vt.method="next",vt.arg=void 0),vt.delegate=null,P):ne:(vt.method="throw",vt.arg=new TypeError("iterator result is not an object"),vt.delegate=null,P)}function ee(J){var vt={tryLoc:J[0]};1 in J&&(vt.catchLoc=J[1]),2 in J&&(vt.finallyLoc=J[2],vt.afterLoc=J[3]),this.tryEntries.push(vt)}function we(J){var vt=J.completion||{};vt.type="normal",delete vt.arg,J.completion=vt}function _e(J){this.tryEntries=[{tryLoc:"root"}],J.forEach(ee,this),this.reset(!0)}function gt(J){if(J){var vt=J[ct];if(vt)return vt.call(J);if(typeof J.next=="function")return J;if(!isNaN(J.length)){var W=-1,dt=function Vt(){for(;++W<J.length;)if(q.call(J,W))return Vt.value=J[W],Vt.done=!1,Vt;return Vt.value=void 0,Vt.done=!0,Vt};return dt.next=dt}}return{next:Pt}}function Pt(){return{value:void 0,done:!0}}return X.prototype=le,lt(rt,"constructor",{value:le,configurable:!0}),lt(le,"constructor",{value:X,configurable:!0}),X.displayName=it(le,Ee,"GeneratorFunction"),I.isGeneratorFunction=function(J){var vt=typeof J=="function"&&J.constructor;return!!vt&&(vt===X||(vt.displayName||vt.name)==="GeneratorFunction")},I.mark=function(J){return Object.setPrototypeOf?Object.setPrototypeOf(J,le):(J.__proto__=le,it(J,Ee,"GeneratorFunction")),J.prototype=Object.create(rt),J},I.awrap=function(J){return{__await:J}},Dt(Ae.prototype),it(Ae.prototype,et,function(){return this}),I.AsyncIterator=Ae,I.async=function(J,vt,W,dt,Vt){Vt===void 0&&(Vt=Promise);var ne=new Ae(st(J,vt,W,dt),Vt);return I.isGeneratorFunction(vt)?ne:ne.next().then(function(ge){return ge.done?ge.value:ne.next()})},Dt(rt),it(rt,Ee,"Generator"),it(rt,ct,function(){return this}),it(rt,"toString",function(){return"[object Generator]"}),I.keys=function(J){var vt=Object(J),W=[];for(var dt in vt)W.push(dt);return W.reverse(),function Vt(){for(;W.length;){var ne=W.pop();if(ne in vt)return Vt.value=ne,Vt.done=!1,Vt}return Vt.done=!0,Vt}},I.values=gt,_e.prototype={constructor:_e,reset:function(vt){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(we),!vt)for(var W in this)W.charAt(0)==="t"&&q.call(this,W)&&!isNaN(+W.slice(1))&&(this[W]=void 0)},stop:function(){this.done=!0;var vt=this.tryEntries[0].completion;if(vt.type==="throw")throw vt.arg;return this.rval},dispatchException:function(vt){if(this.done)throw vt;var W=this;function dt(Qt,Te){return ge.type="throw",ge.arg=vt,W.next=Qt,Te&&(W.method="next",W.arg=void 0),!!Te}for(var Vt=this.tryEntries.length-1;Vt>=0;--Vt){var ne=this.tryEntries[Vt],ge=ne.completion;if(ne.tryLoc==="root")return dt("end");if(ne.tryLoc<=this.prev){var $e=q.call(ne,"catchLoc"),jt=q.call(ne,"finallyLoc");if($e&&jt){if(this.prev<ne.catchLoc)return dt(ne.catchLoc,!0);if(this.prev<ne.finallyLoc)return dt(ne.finallyLoc)}else if($e){if(this.prev<ne.catchLoc)return dt(ne.catchLoc,!0)}else{if(!jt)throw new Error("try statement without catch or finally");if(this.prev<ne.finallyLoc)return dt(ne.finallyLoc)}}}},abrupt:function(vt,W){for(var dt=this.tryEntries.length-1;dt>=0;--dt){var Vt=this.tryEntries[dt];if(Vt.tryLoc<=this.prev&&q.call(Vt,"finallyLoc")&&this.prev<Vt.finallyLoc){var ne=Vt;break}}ne&&(vt==="break"||vt==="continue")&&ne.tryLoc<=W&&W<=ne.finallyLoc&&(ne=null);var ge=ne?ne.completion:{};return ge.type=vt,ge.arg=W,ne?(this.method="next",this.next=ne.finallyLoc,P):this.complete(ge)},complete:function(vt,W){if(vt.type==="throw")throw vt.arg;return vt.type==="break"||vt.type==="continue"?this.next=vt.arg:vt.type==="return"?(this.rval=this.arg=vt.arg,this.method="return",this.next="end"):vt.type==="normal"&&W&&(this.next=W),P},finish:function(vt){for(var W=this.tryEntries.length-1;W>=0;--W){var dt=this.tryEntries[W];if(dt.finallyLoc===vt)return this.complete(dt.completion,dt.afterLoc),we(dt),P}},catch:function(vt){for(var W=this.tryEntries.length-1;W>=0;--W){var dt=this.tryEntries[W];if(dt.tryLoc===vt){var Vt=dt.completion;if(Vt.type==="throw"){var ne=Vt.arg;we(dt)}return ne}}throw new Error("illegal catch attempt")},delegateYield:function(vt,W,dt){return this.delegate={iterator:gt(vt),resultName:W,nextLoc:dt},this.method==="next"&&(this.arg=void 0),P}},I}vn.exports=wt,vn.exports.__esModule=!0,vn.exports.default=vn.exports},64687:function(vn,Ft,ot){var Lt=ot(17061)();vn.exports=Lt;try{regeneratorRuntime=Lt}catch(wt){typeof globalThis=="object"?globalThis.regeneratorRuntime=Lt:Function("r","regeneratorRuntime = r")(Lt)}}}]);
